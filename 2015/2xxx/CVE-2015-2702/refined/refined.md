Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability stems from the lack of proper encoding of user-supplied input when displayed in the Websense Email Security audit log details view. Specifically, email message data, such as the sender address, is not sanitized before being rendered in the web interface.

**Weaknesses/Vulnerabilities Present:**
- **Persistent Cross-Site Scripting (XSS):**  The primary vulnerability is persistent XSS. Malicious JavaScript code injected within email data is stored and then executed in the browsers of users who view the corresponding audit log entries.

**Impact of Exploitation:**
- **Session Hijacking:** Attackers can steal session tokens of legitimate users, allowing them to impersonate those users.
- **Credential Theft:** Attackers can capture login credentials of users.
- **Arbitrary Actions:** Attackers can perform actions within the application on behalf of the victims.
- **Keystroke Logging:** Attackers can log the keystrokes of victim users, potentially capturing sensitive information.

**Attack Vectors:**
- **Specially Crafted Emails:** An attacker can send an email with a malicious payload embedded in parts of the message, such as the sender's address.
- **HTTP Request via Websense Proxy:** An attacker can send a specially crafted HTTP request through the Websense proxy to achieve the same outcome.

**Required Attacker Capabilities/Position:**
- **Ability to Send Emails or HTTP Requests:** The attacker needs to be able to send emails that will be processed by Websense Email Security or send crafted HTTP requests through the Websense proxy.
- **No Direct Access to Application Required:** The attacker does not need direct access to the Websense application itself, they can exploit the vulnerability through the processing of malicious emails or HTTP requests and cause the exploit to execute when an authenticated user views logs.

**Additional Notes:**
- The vulnerability affects Websense Triton v7.8.3 and Websense appliance modules V-Series v7.7, but other versions may also be vulnerable.
- The issue is resolved in TRITON APX Version 8.0.