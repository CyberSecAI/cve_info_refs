=== Content from gerrit.wikimedia.org_8806050c_20250126_055143.html ===




=== Content from phabricator.wikimedia.org_cdd819ab_20250126_055142.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT85855)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T85855
# Custom JavaScript may yield privilege escalationClosed, Resolved[Public](/policy/explain/PHID-TASK-k6u2wucnfsjyqbkhlkyo/view/)Actions

* [Edit Task](/maniphest/task/edit/85855/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/85855/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* [Protect as security issue](/wmf/escalate-task/85855/)
* [Award Token](/token/give/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
* [Flag For Later](/flag/edit/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)

Assigned To

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

Authored By

|  | [• csteipp](/p/csteipp/) |
| --- | --- |
| Jan 5 2015, 8:52 PM2015-01-05 20:52:57 (UTC+0) |

Tags

* [MediaWiki-Core-Team](/tag/mediawiki-core-team/)
* [Patch-For-Review](/tag/patch-for-review/)
* [Vuln-XSS](/tag/vuln-xss/)
* [Security](/tag/security/)
Referenced Files

|  | [F106179: T85855-REL1\_23.patch](/F106179) |
| --- | --- |
| Mar 27 2015, 10:02 PM2015-03-27 22:02:13 (UTC+0) |

|  | [F106178: T85855-REL1\_19.patch](/F106178) |
| --- | --- |
| Mar 27 2015, 10:02 PM2015-03-27 22:02:13 (UTC+0) |

|  | [F39117: 0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch](/F39117) |
| --- | --- |
| Feb 10 2015, 10:12 PM2015-02-10 22:12:33 (UTC+0) |

|  | [F26664: SECURITY:\_Don\_t\_execute\_another\_user\_s\_CSS\_or\_JS\_on\_preview](/F26664) |
| --- | --- |
| Jan 5 2015, 9:34 PM2015-01-05 21:34:28 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [• Deskana](/p/Deskana/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [Grunny](/p/Grunny/) |
| --- | --- |

|  | [He7d3r](/p/He7d3r/) |
| --- | --- |

[View All 14 Subscribers](/subscriptions/list/PHID-TASK-k6u2wucnfsjyqbkhlkyo/)
# Description

FINDING ID: iSEC-WMF1214-10

TARGETS: Users custom scripts, such as <http://devwiki/w/index.php?title=User:Foo/common.js&action=>

submit .

DESCRIPTION: When editing any user's custom JavaScript, the script is executed whenever the ``Show

Preview'' or ``Show Changes'' buttons are clicked. This could allow an attacker to trick another user

into executing JavaScript which hijacks their session. Because privileged users can edit the JavaScript

of lower privileged users, this could lead to privilege escalation.

EXPLOIT SCENARIO: A low-privileged user adds some complex custom JavaScript to their account,

with malicious code embedded within that directs people to a fake login screen or performs actions on

the victim's behalf. The user complains to an Administrator that they are having difficulty with their

custom ``skin'', and asks the Administrator to change a small portion of the script for them. Upon pre-

viewing the edit or viewing changes, the malicious code executes in the context of the Administrator's

session.

SHORT TERM SOLUTION: Do not include another user's custom script when previewing or showing

changes. These pages should only allow users to edit and view code.

LONG TERM SOLUTION: The custom JavaScript system has several deficiencies. Consider deprecating

this functionality and allowing users to customize the site using client-side code instead

---

**Patches**: 0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/zfkiph7gooqtr6fhqndt/PHID-FILE-mryaysfn5h5mjoludkqo/0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch)

* 1.24: 0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/zfkiph7gooqtr6fhqndt/PHID-FILE-mryaysfn5h5mjoludkqo/0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch)
* 1.23: T85855-REL1\_23.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/kawqjvib743ajtnxr5zr/PHID-FILE-rcldhmcpgrfo7gjcxome/T85855-REL1_23.patch)
* 1.19: T85855-REL1\_19.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/a65u6ctt7wttt3vxlxrt/PHID-FILE-r554tfamuu6fqkna3vsn/T85855-REL1_19.patch)

**Affected Versions**:

**Type**: XSS

**CVE**: CVE-2015-2938

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Don't execute another user's CSS or JS on preview](https://gerrit.wikimedia.org/r/c/201221) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/master) | +18 -12 |
|  | [SECURITY: Don't execute another user's CSS or JS on preview](https://gerrit.wikimedia.org/r/c/201036) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_19](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_19) | +14 -5 |
|  | [SECURITY: Don't execute another user's CSS or JS on preview](https://gerrit.wikimedia.org/r/c/201026) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_23](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_23) | +12 -6 |
|  | [SECURITY: Don't execute another user's CSS or JS on preview](https://gerrit.wikimedia.org/r/c/201015) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_24](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_24) | +18 -12 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T85855)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T88120 [Release MW 1.24.2 and 1.23.9 tarballs](/T88120) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85862 [Make iSec assessment public](/T85862) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T87275 [MediaWiki Security release 1.24.2](/T87275) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85855 [Custom JavaScript may yield privilege escalation](/T85855) |

Mentioned In [rMWff95a95437fd: SECURITY: Don't execute another user's CSS or JS on preview](/rMWff95a95437fd4ba2272e06a959e5f9ab9c2b636d)
[rMWee735e8a8886: SECURITY: Don't execute another user's CSS or JS on preview](/rMWee735e8a88863b738a94cb3d60f96b73737783d4)
[rMWcf580155d82e: SECURITY: Don't execute another user's CSS or JS on preview](/rMWcf580155d82edfd66f7965b10635efad07e36d60)
[rMWe01a4b53f15a: SECURITY: Don't execute another user's CSS or JS on preview](/rMWe01a4b53f15aafc7fb74aec1892a9486fd3fd536)
### Event Timeline

[• csteipp](/p/csteipp/) created this task.[Jan 5 2015, 8:52 PM2015-01-05 20:52:57 (UTC+0)](#956134)[• csteipp](/p/csteipp/) raised the priority of this task from  to Medium.[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-kaolmcyph4h4k5v/)[• csteipp](/p/csteipp/) added projects: [acl\*security](/tag/acl_security/), [MediaWiki-Core-Team](/tag/mediawiki-core-team/).[• csteipp](/p/csteipp/) changed the visibility from "Public (No Login Required)" to "[acl\*security](/tag/acl_security/) (Project)".[• csteipp](/p/csteipp/) changed the edit policy from "All Users" to "[acl\*security](/tag/acl_security/) (Project)".[• csteipp](/p/csteipp/) changed Security from None to Software security bug.[• csteipp](/p/csteipp/) subscribed.Restricted Application changed the visibility from "[acl\*security](/tag/acl_security/) (Project)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-uchpcib4ynduxnd/)".  · [View Herald Transcript](/herald/transcript/535185/)[Jan 5 2015, 8:52 PM2015-01-05 20:52:57 (UTC+0)](#956143)Restricted Application changed the edit policy from "[acl\*security](/tag/acl_security/) (Project)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-jq35l63vs3u75i3/)".  · [View Herald Transcript](/herald/transcript/535185/)[• csteipp](/p/csteipp/) added a comment.[Jan 5 2015, 8:54 PM2015-01-05 20:54:31 (UTC+0)](#956151)Comment Actions

I don't think this is very exploitable, but I think the short term solution is a good idea that we should implement.

Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-jatrg63jonljson/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-jatrg63jonljson/)".  · [View Herald Transcript](/herald/transcript/535190/)[Jan 5 2015, 8:54 PM2015-01-05 20:54:31 (UTC+0)](#956152)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-hncgoqwfpm6oykk/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-hncgoqwfpm6oykk/)".  · [View Herald Transcript](/herald/transcript/535190/)

[Anomie](/p/Anomie/) subscribed.[Jan 5 2015, 9:14 PM2015-01-05 21:14:28 (UTC+0)](#956191)Comment Actions
> LONG TERM SOLUTION: The custom JavaScript system has several deficiencies. Consider deprecating this functionality and allowing users to customize the site using client-side code instead

I don't think telling everyone to use [Greasemonkey](https://en.wikipedia.org/wiki/Greasemonkey) would go over all that well with "the community", if that's what they meant there.

Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-fkedm73nemt6hsc/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-fkedm73nemt6hsc/)".  · [View Herald Transcript](/herald/transcript/535206/)[Jan 5 2015, 9:14 PM2015-01-05 21:14:28 (UTC+0)](#956192)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-ss753kr63fvzlw7/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-ss753kr63fvzlw7/)".  · [View Herald Transcript](/herald/transcript/535206/)

[Anomie](/p/Anomie/) added a comment.[Jan 5 2015, 9:34 PM2015-01-05 21:34:28 (UTC+0)](#956292)Comment Actions

SECURITY:\_Don\_t\_execute\_another\_user\_s\_CSS\_or\_JS\_on\_preview1 KB[Download](https://phab.wmfusercontent.org/file/download/5w6aeueverswat7gd3zf/PHID-FILE-a4rheqxn4lpu5t3l3v36/SECURITY%3A_Don_t_execute_another_user_s_CSS_or_JS_on_preview)

[Anomie](/p/Anomie/) moved this task from [Backlog](/project/board/37/) to [Needs Review/Feedback](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Jan 5 2015, 9:34 PM2015-01-05 21:34:49 (UTC+0)](#956293)[Krenair](/p/Krenair/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Jan 21 2015, 2:44 PM2015-01-21 14:44:40 (UTC+0)](#989046)[Krenair](/p/Krenair/) subscribed.[• csteipp](/p/csteipp/) claimed this task.[Feb 9 2015, 10:20 PM2015-02-09 22:20:04 (UTC+0)](#1026221)[• csteipp](/p/csteipp/) added a comment.[Feb 10 2015, 9:29 PM2015-02-10 21:29:58 (UTC+0)](#1029167)Comment Actions
> In [T85855#956292](/T85855#956292), [@Anomie](/p/Anomie/) wrote:
>
> SECURITY:\_Don\_t\_execute\_another\_user\_s\_CSS\_or\_JS\_on\_preview1 KB[Download](https://phab.wmfusercontent.org/file/download/5w6aeueverswat7gd3zf/PHID-FILE-a4rheqxn4lpu5t3l3v36/SECURITY%3A_Don_t_execute_another_user_s_CSS_or_JS_on_preview)

I'm wondering if this feature is useful for a site's common.js-- if admins on a site will use preview to test their changes before saving.

I think we should only prevent the preview if the title is also not in the project namespace.

Also, the "Tip: Use the "Show preview" button to test your new JavaScript before saving." message still shows up.

[Anomie](/p/Anomie/) added a comment.[Feb 10 2015, 10:12 PM2015-02-10 22:12:33 (UTC+0)](#1029269)Comment Actions
> In [T85855#1029167](/T85855#1029167), [@csteipp](/p/csteipp/) wrote:
> > In [T85855#956292](/T85855#956292), [@Anomie](/p/Anomie/) wrote:
> >
> > SECURITY:\_Don\_t\_execute\_another\_user\_s\_CSS\_or\_JS\_on\_preview1 KB[Download](https://phab.wmfusercontent.org/file/download/5w6aeueverswat7gd3zf/PHID-FILE-a4rheqxn4lpu5t3l3v36/SECURITY%3A_Don_t_execute_another_user_s_CSS_or_JS_on_preview)
>
> I'm wondering if this feature is useful for a site's common.js-- if admins on a site will use preview to test their changes before saving.
>
> I think we should only prevent the preview if the title is also not in the project namespace.

This function is only called for previews of user CSS and JS subpages.

A feature request for previewing changes to site scripts might not be a bad idea, but since it doesn't seem to currently exist I don't think it should hold up this patch.

> Also, the "Tip: Use the "Show preview" button to test your new JavaScript before saving." message still shows up.

New version to take care of that: 0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/zfkiph7gooqtr6fhqndt/PHID-FILE-mryaysfn5h5mjoludkqo/0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch)

[• csteipp](/p/csteipp/) added a subscriber: [• Tnegrin](/p/Tnegrin/).[Feb 13 2015, 2:15 AM2015-02-13 02:15:55 (UTC+0)](#1035955)Comment Actions

Thinking more about this, I'd like to get a product-y perspective on if/who this change might bother, so we can communicate in advance or find a better solution if it's going to affect too many people. [@Tnegrin](/p/Tnegrin/), do you know of anyone who might be good to review this?

[Krenair](/p/Krenair/) added a comment.[Feb 13 2015, 3:06 AM2015-02-13 03:06:59 (UTC+0)](#1036003)Comment Actions

Can [@Tnegrin](/p/Tnegrin/) actually see this task? Phabricator shows them greyed out.

[Krenair](/p/Krenair/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-4x4r57ojb4zrbt2/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-4x4r57ojb4zrbt2/)".[Feb 13 2015, 2:19 PM2015-02-13 14:19:34 (UTC+0)](#1036658)[Krenair](/p/Krenair/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-ieob6bvl7oyapvj/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-ieob6bvl7oyapvj/)".[• Tnegrin](/p/Tnegrin/) added a comment.[Feb 13 2015, 2:40 PM2015-02-13 14:40:52 (UTC+0)](#1036682)Comment Actions

Hi Chris, Krenair --

Let me ping the product and community liason teams. This seems like a good chance to understand who feels like they represent admins (who I'm thinking are the primary group who will be impacted by this change)

What's the timeframe on a decision here?

-Toby

[• csteipp](/p/csteipp/) added a comment.[Feb 13 2015, 6:13 PM2015-02-13 18:13:22 (UTC+0)](#1037132)Comment Actions
> In [T85855#1036682](/T85855#1036682), [@Tnegrin](/p/Tnegrin/) wrote:
>
> Hi Chris, Krenair --
>
> Let me ping the product and community liason teams. This seems like a good chance to understand who feels like they represent admins (who I'm thinking are the primary group who will be impacted by this change)
>
> What's the timeframe on a decision here?
>
> -Toby

Great! By the middle of next week would be nice.

[• csteipp](/p/csteipp/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-e5wizaynfpf5vfn/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-e5wizaynfpf5vfn/)".[Feb 14 2015, 12:24 AM2015-02-14 00:24:13 (UTC+0)](#1038216)[• csteipp](/p/csteipp/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-gddfax6krhfocgt/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-gddfax6krhfocgt/)".[• csteipp](/p/csteipp/) added a subscriber: [• Deskana](/p/Deskana/).[• Deskana](/p/Deskana/) added a comment.[Feb 14 2015, 12:32 AM2015-02-14 00:32:08 (UTC+0)](#1038224)Comment Actions

I spoke with Chris about this. Here's my product opinion.

The circumstances in which this feature would actually be a security risk are rare. That said, the feature where previewing someone's JS actually executes it in your session is very obscure, and there are other, better ways that you can test JS that someone else is intended to use.

I think that he can remove this feature to fix this security problem.

[• csteipp](/p/csteipp/) added a comment.[Feb 14 2015, 12:35 AM2015-02-14 00:35:18 (UTC+0)](#1038231)Comment Actions
> In [T85855#1029269](/T85855#1029269), [@Anomie](/p/Anomie/) wrote:
>
> New version to take care of that: 0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/zfkiph7gooqtr6fhqndt/PHID-FILE-mryaysfn5h5mjoludkqo/0001-SECURITY-Don-t-execute-another-user-s-CSS-or-JS-on-p.patch)

Tested. I'll deploy this early next week.

[• csteipp](/p/csteipp/) closed this task as Resolved.[Feb 18 2015, 1:12 AM2015-02-18 01:12:32 (UTC+0)](#1045412)Comment Actions

deployed

[bd808](/p/bd808/) moved this task from [Needs Review/Feedback](/project/board/37/) to [Done](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 18 2015, 10:14 PM2015-02-18 22:14:44 (UTC+0)](#1048261)[bd808](/p/bd808/) moved this task from [Done](/project/board/37/) to [Archive](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 23 2015, 11:58 PM2015-02-23 23:58:22 (UTC+0)](#1060981)[• csteipp](/p/csteipp/) added a parent task: [T87275: MediaWiki Security release 1.24.2](/T87275).[Mar 25 2015, 10:35 PM2015-03-25 22:35:42 (UTC+0)](#1151338)[• csteipp](/p/csteipp/) added a comment.[Mar 27 2015, 10:02 PM2015-03-27 22:02:13 (UTC+0)](#1158485)Comment Actions

T85855-REL1\_23.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/kawqjvib743ajtnxr5zr/PHID-FILE-rcldhmcpgrfo7gjcxome/T85855-REL1_23.patch)

T85855-REL1\_19.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/a65u6ctt7wttt3vxlxrt/PHID-FILE-r554tfamuu6fqkna3vsn/T85855-REL1_19.patch)

[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-v2fqhrigupatu4y/)[Mar 27 2015, 10:03 PM2015-03-27 22:03:04 (UTC+0)](#1158487)[• csteipp](/p/csteipp/) added subscribers: [Grunny](/p/Grunny/), [ProgramCeltic](/p/ProgramCeltic/).[Mar 30 2015, 7:59 PM2015-03-30 19:59:11 (UTC+0)](#1164324)[• csteipp](/p/csteipp/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-462r7zmnazrrapz/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-462r7zmnazrrapz/)".[Mar 31 2015, 12:34 PM2015-03-31 12:34:05 (UTC+0)](#1166650)[• csteipp](/p/csteipp/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-m4eg4cmrji4k5hg/)" to "Public (No Login Required)".[Mar 31 2015, 9:13 PM2015-03-31 21:13:51 (UTC+0)](#1168298)[• csteipp](/p/csteipp/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-btvjg2a6fhuuksz/)" to "All Users".[• csteipp](/p/csteipp/) changed Security from Software security bug to None.[gerritbot](/p/gerritbot/) subscribed.[Mar 31 2015, 9:22 PM2015-03-31 21:22:24 (UTC+0)](#1168370)Comment Actions

Change 201015 had a related patch set uploaded (by CSteipp):

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201015>

[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 9:30 PM2015-03-31 21:30:02 (UTC+0)](#1168411)Comment Actions

Change 201026 had a related patch set uploaded (by CSteipp):

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201026>

[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 9:35 PM2015-03-31 21:35:34 (UTC+0)](#1168436)Comment Actions

Change 201036 had a related patch set uploaded (by CSteipp):

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201036>

[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 9:59 PM2015-03-31 21:59:51 (UTC+0)](#1168495)Comment Actions

Change 201015 merged by jenkins-bot:

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201015>

[• csteipp](/p/csteipp/) mentioned this in [rMWe01a4b53f15a: SECURITY: Don't execute another user's CSS or JS on preview](/rMWe01a4b53f15aafc7fb74aec1892a9486fd3fd536).[Mar 31 2015, 10:00 PM2015-03-31 22:00:05 (UTC+0)](#1168498)[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 10:21 PM2015-03-31 22:21:53 (UTC+0)](#1168589)Comment Actions

Change 201026 merged by jenkins-bot:

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201026>

[• csteipp](/p/csteipp/) mentioned this in [rMWcf580155d82e: SECURITY: Don't execute another user's CSS or JS on preview](/rMWcf580155d82edfd66f7965b10635efad07e36d60).[Mar 31 2015, 10:22 PM2015-03-31 22:22:16 (UTC+0)](#1168601)[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 10:22 PM2015-03-31 22:22:19 (UTC+0)](#1168614)Comment Actions

Change 201036 merged by jenkins-bot:

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201036>

[• csteipp](/p/csteipp/) mentioned this in [rMWee735e8a8886: SECURITY: Don't execute another user's CSS or JS on preview](/rMWee735e8a88863b738a94cb3d60f96b73737783d4).[Mar 31 2015, 10:22 PM2015-03-31 22:22:48 (UTC+0)](#1168621)[He7d3r](/p/He7d3r/) subscribed.[Apr 1 2015, 12:47 AM2015-04-01 00:47:08 (UTC+0)](#1168994)Comment Actions

I assume the fix works for edit links with the URL parameter &preview=yes too?

[• csteipp](/p/csteipp/) added a comment.[Apr 1 2015, 12:57 AM2015-04-01 00:57:26 (UTC+0)](#1169023)Comment Actions
> In [T85855#1168994](/T85855#1168994), [@He7d3r](/p/He7d3r/) wrote:
>
> I assume the fix works for edit links with the URL parameter &preview=yes too?

I don't think edit links with preview=yes previewed javascript before. But should not be allowed now in either case. If you're seeing different, please report it.

[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2015, 4:57 PM2015-04-01 16:57:20 (UTC+0)](#1170741)Comment Actions

Change 201221 had a related patch set uploaded (by CSteipp):

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201221>

[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2015, 5:31 PM2015-04-01 17:31:59 (UTC+0)](#1170914)Comment Actions

Change 201221 merged by jenkins-bot:

SECURITY: Don't execute another user's CSS or JS on preview

<https://gerrit.wikimedia.org/r/201221>

[• csteipp](/p/csteipp/) mentioned this in [rMWff95a95437fd: SECURITY: Don't execute another user's CSS or JS on preview](/rMWff95a95437fd4ba2272e06a959e5f9ab9c2b636d).[Apr 1 2015, 5:32 PM2015-04-01 17:32:18 (UTC+0)](#1170917)[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-xbe2znv3cnyyxca/)[Apr 9 2015, 11:11 PM2015-04-09 23:11:26 (UTC+0)](#1196384)[• csteipp](/p/csteipp/) added a project: [Vuln-XSS](/tag/vuln-xss/).[• MZMcBride](/p/MZMcBride/) subscribed.[Apr 11 2015, 4:02 AM2015-04-11 04:02:48 (UTC+0)](#1200653)[Rich\_Farmbrough](/p/Rich_Farmbrough/) subscribed.[Apr 26 2015, 7:15 PM2015-04-26 19:15:15 (UTC+0)](#1237034)[Verdy\_p](/p/Verdy_p/) subscribed.Edited · [Apr 27 2015, 1:54 AM2015-04-27 01:54:37 (UTC+0)](#1237337)Comment Actions

Please don't follow the advice given in "LONG TERM SOLUTION". Custom javascripts are useful for many users that want it even if they are not supported as standard gadgets (gadgets are shared to be used by anyone without lot of inspection: users adopt them with a basic click in a checkbox and don't need to understand how they work, so only privileged users can transform a custom javascript or CSS into a plain gadget).

Custom javascript and CSS is also vbery useful for developing gadgets or experimenting changes.

The last solution given by gerribot above is enough to avoid executing another user's public CSS or JS just when editing, and submitting or previewing it (in any editor).

---

May be we'll also have custom Lua code in User's namespace (in that case, the same restriction will apply to avoid executing it, including when eding or viewing wiki pages #invoking these user's Lua extensions), instead of being stored in the "Module:" namespace (where we find now modules named "Module:User:XXXX/foo.lua" that pollute this shared namespace).

In that case, do not expand "{{#invoke:User:XXX/foo}}" and render it in "nowiki" or clear it completely, unless the viewing user is the same (but accept to render something like "{{#invoke:My user:foo}}" or within the profile of the current viewing user).

[Parent5446](/p/Parent5446/) subscribed.[Apr 27 2015, 4:17 AM2015-04-27 04:17:23 (UTC+0)](#1237421)Comment Actions

I'd like to note there are solutions for adding custom JS to sites outside of MediaWiki, e.g., Greasemonkey. Such solutions are safer and more performant than storing and loading such code to/from MediaWiki.

[Verdy\_p](/p/Verdy_p/) added a comment.[Apr 27 2015, 8:39 AM2015-04-27 08:39:48 (UTC+0)](#1237632)Comment Actions

"safer"? Not really. There are good arguments for not allowing MediaWiki sites to reference foreign scripts located outside of sites that are not members of the same realm of wikis, because the wiki has absolutely no way to control how they are managed.

Also, MediaWiki is very efficient in loading javascripts using raw API requests across multiple wikis, and at least there's a possible control with improved security and a possible inspection by global admins: MediaWiki does not need to parse raw API requests, even if it has to perform a (single) database query to get their content.

But note that the issue discussed here is \*only\* about custom JS added to wiki sites that are running MediaWiki, and only MediaWiki.

Nothing is said in this security issue:

* about how to load custom scripts on sites running other software than MediaWiki (such as blogs, or Facebook pages): these sites have their own way to permit such inclusion (or not) and define their own restrictions (or their own local security issues) ;
* or about using external servers to retrieve custom JS to be used when viewing MediaWiki pages : this possibility could be restricted in MediaWiki by inspecting the target URL (notably the authorized domain names, or the interwiki prefixes if we can have external URLs built with them using some MediaWiki syntax for resolving wikilinks)
[Verdy\_p](/p/Verdy_p/) added a comment.[Apr 27 2015, 8:49 AM2015-04-27 08:49:32 (UTC+0)](#1237644)Comment Actions

Also the "client-side" proposed "LONG TERM SOLUTION" is not portable across devices (notably because it requires preinstalling the code in them and copying it in multiple locations: a real maintenance problem for users that want to connect to Wiki using a guest access on a temporary device, including in cybercafés where users don't own their PC): this is impossible to do when using an external PC with resticted local installations.

And some devices don't have the necessary storage for allowing that: the "client" here being either a web browser, or a mobile wiki application for various mobile OSes (Android, iOS, Windows mobile... Additionally browsers won't let visited wiki sites to instruct them to load locally stored scripts (this would be a severe XSS issue in these browsers, if this is not restricted)

[Bawolff](/p/Bawolff/) subscribed.[Apr 27 2015, 9:08 AM2015-04-27 09:08:47 (UTC+0)](#1237673)Comment Actions
> Please don't follow the advice given in "LONG TERM SOLUTION"

As anomie said above, I think we're all aware that doing that would go over like a pound of bricks. I'm highly doubtful we'd do that, and if we did there would be a lot of discussion about it. Thus lets save the pitch forks until somebody (not counting iSEC) actually makes a serious proposal to kill the feature.

[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:59 PM2020-02-10 22:59:42 (UTC+0)](#5869834) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:18 PM2020-02-20 20:18:02 (UTC+0)](#5904850) · [Aklapper](/p/Aklapper/) removed a subscriber: [Anomie](/p/Anomie/).[Oct 16 2020, 5:42 PM2020-10-16 17:42:33 (UTC+0)](#6555195) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from phab.wmfusercontent.org_2887e680_20250126_055143.html ===
From 5e022b1869946bfd7f3da4a2e235fc671b264096 Mon Sep 17 00:00:00 2001
From: csteipp
Date: Fri, 27 Mar 2015 14:57:28 -0700
Subject: [PATCH] SECURITY: Don't execute another user's CSS or JS on preview
Someone could theoretically try to hide malicious code in their user
common.js and then trick an admin into previewing it by asking for help.
Bug: T85855
Change-Id: I5a7a75306695859df5d848f6105b81bea0098f0a
---
includes/EditPage.php | 15 ++++++++++-----
includes/OutputPage.php | 4 ++++
2 files changed, 14 insertions(+), 5 deletions(-)
diff --git a/includes/EditPage.php b/includes/EditPage.php
index d00d911..07a5a07 100644
--- a/includes/EditPage.php
+++ b/includes/EditPage.php
@@ -1988,11 +1988,16 @@ class EditPage {
if ( $this->isWrongCaseCssJsPage ) {
$wgOut->wrapWikiMsg( "\n$1\n", array( 'userinvalidcssjstitle', $this->mTitle->getSkinFromCssJsSubpage() ) );
}
- if ( $this->formtype !== 'preview' ) {
- if ( $this->isCssSubpage )
- $wgOut->wrapWikiMsg( "\n$1\n", array( 'usercssyoucanpreview' ) );
- if ( $this->isJsSubpage )
- $wgOut->wrapWikiMsg( "\n$1\n", array( 'userjsyoucanpreview' ) );
+ if ( $this->getTitle()->isSubpageOf( $wgUser->getUserPage() ) ) {
+ if ( $this->formtype !== 'preview' ) {
+ if ( $this->isCssSubpage ) {
+ $wgOut->wrapWikiMsg( "\n$1\n", array( 'usercssyoucanpreview' ) );
+ }
+
+ if ( $this->isJsSubpage ) {
+ $wgOut->wrapWikiMsg( "\n$1\n", array( 'userjsyoucanpreview' ) );
+ }
+ }
}
}
}
diff --git a/includes/OutputPage.php b/includes/OutputPage.php
index e658c0e..20520bc 100644
--- a/includes/OutputPage.php
+++ b/includes/OutputPage.php
@@ -2975,6 +2975,10 @@ $templates
if ( !$this->getTitle()->isJsSubpage() && !$this->getTitle()->isCssSubpage() ) {
return false;
}
+ if ( !$this->getTitle()->isSubpageOf( $this->getUser()->getUserPage() ) ) {
+ // Don't execute another user's CSS or JS on preview (T85855)
+ return false;
+ }
return !count( $this->getTitle()->getUserPermissionsErrors( 'edit', $this->getUser() ) );
}
--
1.8.4.5


=== Content from security.gentoo.org_ee772b69_20250125_040749.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# MediaWiki: Multiple vulnerabilities — GLSA **201510-05**

Multiple vulnerabilities have been found in MediaWiki, the worst of
which may allow remote attackers to cause a Denial of Service.

### Affected packages

| Package | **www-apps/mediawiki** on all architectures |
| --- | --- |
| Affected versions | < **1.25.2** |
| Unaffected versions | >= **1.25.2**revision >= **1.24.3**revision >= **1.23.10** |

### Background

MediaWiki is a collaborative editing software used by large projects
such as Wikipedia.

### Description

Multiple vulnerabilities have been discovered in MediaWiki. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker may be able to create a Denial of Service condition,
obtain sensitive information, bypass security restrictions, and inject
arbitrary web script or HTML.

### Workaround

There is no known workaround at this time.

### Resolution

All MediaWiki 1.25 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.25.2"

```

All MediaWiki 1.24 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.24.3"

```

All MediaWiki 1.23 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.23.10"

```
### References

* [CVE-2015-2931](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2931)
* [CVE-2015-2932](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2932)
* [CVE-2015-2933](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2933)
* [CVE-2015-2934](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2934)
* [CVE-2015-2935](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2935)
* [CVE-2015-2936](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2936)
* [CVE-2015-2937](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2937)
* [CVE-2015-2938](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2938)
* [CVE-2015-2939](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2939)
* [CVE-2015-2940](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2940)
* [CVE-2015-2941](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2941)
* [CVE-2015-2942](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2942)
* [CVE-2015-6728](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6728)
* [CVE-2015-6729](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6729)
* [CVE-2015-6730](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6730)
* [CVE-2015-6731](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6731)
* [CVE-2015-6732](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6732)
* [CVE-2015-6733](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6733)
* [CVE-2015-6734](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6734)
* [CVE-2015-6735](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6735)
* [CVE-2015-6736](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6736)
* [CVE-2015-6737](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6737)

**Release date**

October 31, 2015

**Latest revision**

October 31, 2015: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [545944](https://bugs.gentoo.org/show_bug.cgi?id=545944)
* [557844](https://bugs.gentoo.org/show_bug.cgi?id=557844)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.openwall.com_697f15b9_20250125_040746.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2015/04/01/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150407073412.354C26C0003@smtpvmsrv1.mitre.org>
Date: Tue,  7 Apr 2015 03:34:12 -0400 (EDT)
From: cve-assign@...re.org
To: csteipp@...imedia.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: MediaWiki 1.24.2/1.23.9/1.19.24

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> * iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
> embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
> JavaScript in the SVG. The issue was additionally identified by Mario
> Heiderich / Cure53. MIME types are now whitelisted.
> <https://phabricator.wikimedia.org/T85850>

Use CVE-2015-2931 for this issue involving an incomplete list of
disallowed MIME types for data: URIs (the application/xml type wasn't
in this list). In other words, CVE-2015-2931 does not refer more
generally to the desirability of the "MIME types are now whitelisted"
decision.

> * MediaWiki user Bawolff pointed out that the SVG filter to prevent
> injecting JavaScript using animate elements was incorrect.
> <https://phabricator.wikimedia.org/T86711>

Use CVE-2015-2932 for this issue involving an incomplete list of
dangerous parts of HTML5. (The list is supposed to include all uses of
'animate attributename="xlink:href"' in SVG documents.)

> * MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
> attributes were expanded in MediaWiki's Html class, in combination with
> LanguageConverter substitutions.
> <https://phabricator.wikimedia.org/T73394>

Use CVE-2015-2933 for this XSS issue.

Also, this part of T73394 seems potentially interesting although it is
apparently neither a MediaWiki bug nor a PHP bug:

  <https://phabricator.wikimedia.org/T73394#750588>
  preg_match() silently returns false on limit exhaustion

In other words, if a PHP application uses
"ini_set('pcre.recursion_limit'" and does not properly handle the
preg_match return value, then a hard-to-find XSS vulnerability might
exist.

> * Internal review discovered that MediaWiki's SVG filtering could be
> bypassed with entity encoding under the Zend interpreter. This could be
> used to inject JavaScript. This issue was also discovered by Mario Gomes /
> Beyond Security.
> <https://phabricator.wikimedia.org/T88310>

Use CVE-2015-2934 for this interaction issue in which (roughly
speaking) secure operation of MediaWiki had been relying on a libxml
behavior that was removed for unrelated security reasons. (In other
words, it's apparently an usual type of vulnerability whose avoidance
requires studying all "improvements" in new releases of library code,
and determining whether any of them have unintended adverse
consequences.)

> * iSEC Partners discovered a way to bypass the style filtering for SVG
> files (iSEC-WMF1214-3) to load external resource. This could violate the
> anonymity of users viewing the SVG.
> <https://phabricator.wikimedia.org/T85349>

Use CVE-2015-2935 for this issue of information leaks observable in
log files on an attacker-controlled web server. This issue exists
because of an incomplete fix for CVE-2014-7199.

> * Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
> MediaWiki versions using PBKDF2 for password hashing (the default since
> 1.24) are vulnerable to DoS attacks using extremely long passwords.
> <https://phabricator.wikimedia.org/T64685>

Use CVE-2015-2936 for this vulnerability with a CPU consumption impact.

> * Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
> DoS attacks, under both HHVM and Zend PHP.
> <https://phabricator.wikimedia.org/T71210>

Use CVE-2015-2937. This is a quadratic issue and isn't the same as the
CVE-2015-2942 exponential issue affecting only HHVM (see below).

> * iSEC Partners reported that the MediaWiki feature allowing a user to
> preview another user's custom JavaScript could be abused for privilege
> escalation (iSEC-WMF1214-10). This feature has been removed.
> <https://phabricator.wikimedia.org/T85855>

Use CVE-2015-2938 for this XSS issue.

> * Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
> names were sanitized in Lua error backtraces, which could lead to XSS.
> <https://phabricator.wikimedia.org/T85113>

Use CVE-2015-2939 for this XSS issue. In the above quoted text, "were
sanitized" should be "were not sanitized" instead.

> * Extension:CheckUser - iSEC Partners discovered that the CheckUser
> extension did not prevent CSRF attacks on the form allowing checkusers to
> look up sensitive information about other users (iSEC-WMF1214-6). Since the
> use of CheckUser is logged, the CSRF could be abused to defame a trusted
> user or flood the logs with noise.
> <https://phabricator.wikimedia.org/T85858>

For purposes of CVE, we'll accept reports from a software's author
stating that there is a CSRF vulnerability for a request to read data.
Use CVE-2015-2940. This does not mean that similar reports from
arbitrary researchers about arbitrary products would have CVE IDs
assigned. For many products, the implied security policy does not
include a CSRF protection mechanism that prevents all
undesirable/confusing log entries.

> I'm not sure if CVE's are assigned for specific runtime
> configurations? For MediaWiki, we say that HHVM support is experimental,
> although we do run Wikipedia on it.

There isn't a general rule that CVE IDs are assigned for arbitrary
unsupported deployments of a product. Our impression is that users may
realistically decide that the HHVM support is "complete enough" for
their purposes. Also, in some cases, HHVM support is referenced or
documented in places that don't directly discuss the experimental
nature, such as on the <http://www.mediawiki.org/wiki/HHVM> and
[http://www.mediawiki.org/wiki/Manual:How_to_debug](http://www.mediawiki.org/wiki/Manual%3AHow_to_debug) pages. So, here, we
do want to assign CVE IDs applicable only to HHVM deployments.

> * iSEC Partners discovered a XSS vulnerability in the way api errors were
> reflected under HHVM versions before 3.6.1 (iSEC-WMF1214-8). MediaWiki now
> detects and mitigates this issue on older versions of HHVM.
> <https://phabricator.wikimedia.org/T85851>

It seems that the major concern here is the HHVM vulnerability fixed
by the
<https://github.com/facebook/hhvm/commit/324701c9fd31beb4f070f1b7ef78b115fbdfec34>
commit. Use CVE-2014-9714 for that HHVM vulnerability.

As far as we can tell, T85851 is recommending
<https://gerrit.wikimedia.org/r/#/c/201020/1/includes/api/ApiFormatWddx.php,unified>
as a vulnerability fix for MediaWiki deployments that use an older
version of HHVM. Use CVE-2015-2941 for this MediaWiki vulnerability in
which unsafe calls to wddx_serialize_value can occur.

> * iSEC Partners discovered that MediaWiki's SVG and XMP parsing running
> under HHVM was susceptible to "Billion Laughs" DoS attacks
> (iSEC-WMF1214-13).
> <https://phabricator.wikimedia.org/T85848>

Use CVE-2015-2942 for this exponential issue, which is different from
the CVE-2015-2937 quadratic issue mentioned above.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVI4etAAoJEKllVAevmvmsxk0H/R0orjbDyN56mEOJ9a/rlowS
D5cuaiDe4dzWbqEOzii8g+3d2iVsb1BUJHxfuGOFjf0zstb2KhJP5iaKN6hsXcHn
HKdtHE8uKMzs5DYxxeGsbphrp/J/Uff1+G7vwPmBTG3Z+tcLNXstuoIO18Pg3HuP
yT/P37KKJvlyhn5l325M4h0ln3kRu7egDHEctsJGNnb0IHoSoT8VmaiMYs/OwdP/
GT0XZVc7iNIBpXx0Ao03HxaSMgEfFs5X8PNnO95j9V9ngcP7zKQVT9ycsBHAhawP
dP+etPml55OJJKViqVZji5Dvv6BxZWnBACgzDI9ZcNFSHSykgr6Y3E+6nxmEKWY=
=vxIE
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.mandriva.com_3c30de47_20250125_040746.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from lists.wikimedia.org_c65686ea_20250125_040747.html ===


[lists.wikimedia.org](/hyperkitty/)

[Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)
[Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)

* [Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)
* [Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)

* [Manage this list](/postorius/lists/mediawiki-announce.lists.wikimedia.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2025/1/)

### 2024

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/1/)

### 2023

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/1/)

### 2022

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/1/)

### 2021

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/1/)

### 2020

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/1/)

### 2019

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/1/)

### 2018

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/1/)

### 2017

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/1/)

### 2016

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/1/)

### 2015

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/1/)

### 2014

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/1/)

### 2013

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/1/)

### 2012

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/1/)

### 2011

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/1/)

### 2010

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/1/)

### 2009

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/1/)

### 2008

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/1/)

### 2007

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/1/)

### 2006

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/1/)

### 2005

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/1/)

### 2004

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2004/12/)

[List overview](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

[Download](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/export/mediawiki-announce%40lists.wikimedia.org-OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN.mbox.gz?message=OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN "This message in gzipped mbox format")

[thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/#OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN)

# [MediaWiki-announce] MediaWiki Security and Maintenance Releases: 1.19.24, 1.23.9, and 1.24.2

[Chris Steipp](/hyperkitty/users/dd272b532a8d4667a37daa128483ef95/ "See the profile for Chris Steipp")

31 Mar
2015

31 Mar
'15

10:20 p.m.

I would like to announce the release of MediaWiki 1.24.2, 1.23.9 and
1.19.24. These releases fix 10 security issues, in addition to other bug
fixes. Download links are given at the end of this email.

== Security fixes ==

\* iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
JavaScript in the SVG. The issue was additionally identified by Mario
Heiderich / Cure53. MIME types are now whitelisted.
<https://phabricator.wikimedia.org/T85850>

\* MediaWiki user Bawolff pointed out that the SVG filter to prevent
injecting JavaScript using animate elements was incorrect.
<https://phabricator.wikimedia.org/T86711>

\* MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
attributes were expanded in MediaWiki's Html class, in combination with
LanguageConverter substitutions.
<https://phabricator.wikimedia.org/T73394>

\* Internal review discovered that MediaWiki's SVG filtering could be
bypassed with entity encoding under the Zend interpreter. This could be
used to inject JavaScript. This issue was also discovered by Mario Gomes
from Beyond Security.
<https://phabricator.wikimedia.org/T88310>

\* iSEC Partners discovered a XSS vulnerability in the way api errors were
reflected when running under HHVM versions before 3.6.1 (iSEC-WMF1214-8).
MediaWiki now detects and mitigates this issue on older versions of HHVM.
<https://phabricator.wikimedia.org/T85851>

\* Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
MediaWiki versions using PBKDF2 for password hashing (the default since
1.24) are vulnerable to DoS attacks using extremely long passwords.
<https://phabricator.wikimedia.org/T64685>

\* iSEC Partners discovered that MediaWiki's SVG and XMP parsing, running
under HHVM, was susceptible to "Billion Laughs" DoS attacks
(iSEC-WMF1214-13).
<https://phabricator.wikimedia.org/T85848>

\* Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
DoS attacks, under both HHVM and Zend PHP.
<https://phabricator.wikimedia.org/T71210>

\* iSEC Partners discovered a way to bypass the style filtering for SVG
files (iSEC-WMF1214-3). This could violate the anonymity of users viewing
the SVG.
<https://phabricator.wikimedia.org/T85349>

\* iSEC Partners reported that the MediaWiki feature allowing a user to
preview another user's custom JavaScript could be abused for privilege
escalation (iSEC-WMF1214-10). This feature has been removed.
<https://phabricator.wikimedia.org/T85855>

Additionally, the following extensions have been updated to fix security
issues:

\* Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
names were not sanitized in Lua error backtraces, which could lead to XSS.
<https://phabricator.wikimedia.org/T85113>

\* Extension:CheckUser - iSEC Partners discovered that the CheckUser
extension did not prevent CSRF attacks on the form allowing checkusers to
look up sensitive information about other users (iSEC-WMF1214-6). Since the
use of CheckUser is logged, the CSRF could be abused to defame a trusted
user or flood the logs with noise.
<https://phabricator.wikimedia.org/T85858>

== Bug fixes ==

=== 1.24 ===

\* Fix case of SpecialAllPages/SpecialAllMessages in SpecialPageFactory to
fix loading these special pages when $wgAutoloadAttemptLowercase is false.
\* (bug T76254) Fix deleting of pages with PostgreSQL. Requires a schema
change and running update.php to fix.

== 1.23 & 1.24 ==

\* (bug T70087) Fix Special:ActiveUsers page for installations using
PostgreSQL.

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

Full release notes:
<https://www.mediawiki.org/wiki/Release_notes/1.24>
<https://www.mediawiki.org/wiki/Release_notes/1.23>
<https://www.mediawiki.org/wiki/Release_notes/1.19>

Download:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.tar.gz>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.tar.gz>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.tar.gz>

Patch to previous version:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.patch.gz>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.patch.gz>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.patch.gz.sig>

Extensions:
[http://www.mediawiki.org/wiki/Extension:Scribunto](http://www.mediawiki.org/wiki/Extension%3AScribunto)
[http://www.mediawiki.org/wiki/Extension:CheckUser](http://www.mediawiki.org/wiki/Extension%3ACheckUser)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/#OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN)

[Back to the list](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from www.openwall.com_473cc16a_20250125_040746.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2015/03/31/9) [[next>]](2) [[thread-next>]](../../../2015/04/07/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAKcmtDzP7GhQWdTNb2XaVD1dzfDPXzyjWRhoYaKPrZy+NALygA@mail.gmail.com>
Date: Tue, 31 Mar 2015 18:34:21 -0700
From: Chris Steipp <csteipp@...imedia.org>
To: oss-security@...ts.openwall.com
Subject: CVE request: MediaWiki 1.24.2/1.23.9/1.19.24

Hi, we patched several security issues in MediaWiki today. Could we get
CVE's assigned?

* iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
JavaScript in the SVG. The issue was additionally identified by Mario
Heiderich / Cure53. MIME types are now whitelisted.
<<https://phabricator.wikimedia.org/T85850>>

* MediaWiki user Bawolff pointed out that the SVG filter to prevent
injecting JavaScript using animate elements was incorrect.
<<https://phabricator.wikimedia.org/T86711>>

* MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
attributes were expanded in MediaWiki's Html class, in combination with
LanguageConverter substitutions.
<<https://phabricator.wikimedia.org/T73394>>

* Internal review discovered that MediaWiki's SVG filtering could be
bypassed with entity encoding under the Zend interpreter. This could be
used to inject JavaScript. This issue was also discovered by Mario Gomes /
Beyond Security.
<<https://phabricator.wikimedia.org/T88310>>

* iSEC Partners discovered a way to bypass the style filtering for SVG
files (iSEC-WMF1214-3) to load external resource. This could violate the
anonymity of users viewing the SVG.
<<https://phabricator.wikimedia.org/T85349>>

* Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
MediaWiki versions using PBKDF2 for password hashing (the default since
1.24) are vulnerable to DoS attacks using extremely long passwords.
<<https://phabricator.wikimedia.org/T64685>>

* Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
DoS attacks, under both HHVM and Zend PHP.
<<https://phabricator.wikimedia.org/T71210>>

* iSEC Partners reported that the MediaWiki feature allowing a user to
preview another user's custom JavaScript could be abused for privilege
escalation (iSEC-WMF1214-10). This feature has been removed.
<<https://phabricator.wikimedia.org/T85855>>

* Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
names were sanitized in Lua error backtraces, which could lead to XSS.
<<https://phabricator.wikimedia.org/T85113>>

* Extension:CheckUser - iSEC Partners discovered that the CheckUser
extension did not prevent CSRF attacks on the form allowing checkusers to
look up sensitive information about other users (iSEC-WMF1214-6). Since the
use of CheckUser is logged, the CSRF could be abused to defame a trusted
user or flood the logs with noise.
<<https://phabricator.wikimedia.org/T85858>>

These next issues came up because of the difference in how HHVM handles PHP
code vs Zend. I'm not sure if CVE's are assigned for specific runtime
configurations? For MediaWiki, we say that HHVM support is experimental,
although we do run Wikipedia on it.

* iSEC Partners discovered a XSS vulnerability in the way api errors were
reflected under HHVM versions before 3.6.1 (iSEC-WMF1214-8). MediaWiki now
detects and mitigates this issue on older versions of HHVM.
<<https://phabricator.wikimedia.org/T85851>>

* iSEC Partners discovered that MediaWiki's SVG and XMP parsing running
under HHVM was susceptible to "Billion Laughs" DoS attacks
(iSEC-WMF1214-13).
<<https://phabricator.wikimedia.org/T85848>>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


