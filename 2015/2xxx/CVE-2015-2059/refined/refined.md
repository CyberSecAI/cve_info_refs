```
{
  "CVE-2015-2059": {
    "description": "The stringprep_utf8_to_ucs4 function in libin before 1.31, as used in jabberd2, allows context-dependent attackers to read system memory and possibly have other unspecified impact via invalid UTF-8 characters in a string, which triggers an out-of-bounds read.",
    "vulnerability_details": {
      "root_cause": "The `stringprep_utf8_to_ucs4` function in libidn did not properly validate UTF-8 input, leading to an out-of-bounds read when processing invalid UTF-8 sequences.",
       "weaknesses": [
        "Improper input validation",
        "Out-of-bounds read"
      ],
      "impact": "A remote attacker could read sensitive information from memory or cause a denial of service by providing crafted, invalid UTF-8 input. The impact could extend to applications using the vulnerable library. Specifically, applications which rely on stringprep functions of libidn with potentially malformed UTF-8 inputs.",
      "attack_vector": "Remote, network based attack vector. By sending a network message containing specifically crafted invalid UTF-8 input.",
      "attacker_capabilities": "An attacker needs to be able to send network messages which are parsed by applications using the vulnerable libidn library.  No authentication is required."
    },
    "affected_products": [
      "libidn < 1.31",
      "jabberd2 (affected by usage of libidn)",
      "Ubuntu 12.04 LTS",
      "Ubuntu 14.04 LTS",
      "openSUSE 13.1",
       "openSUSE 13.2",
      "openSUSE Leap 42.1",
      "SUSE Linux Enterprise products",
      "Debian jessie",
       "Debian unstable (sid)",
       "Debian testing (stretch)"
    ],
     "additional_notes": "The vulnerability is triggered when `stringprep_utf8_to_ucs4` receives invalid UTF-8 input. While the documentation of libidn states that functions will not read or write outside of the specified size, this is incorrect as the function continues reading beyond the intended buffer if it encounters an incomplete multi-byte UTF-8 sequence until it finds a null byte. This allows attackers to read random memory locations, potentially disclosing sensitive information. The fix involved modifying `stringprep_utf8_to_ucs4` to validate UTF-8 input before processing it and introducing a new error code `STRINGPREP_ICONV_ERROR` for failed string conversion. Also, the update fixed an ‘Invalid read of size 4’ valgrind error."
  }
}
```