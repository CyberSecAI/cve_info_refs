=== Content from www.openwall.com_731eaf28_20250125_004820.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](12) [[next>]](14) [[thread-next>]](../../../2015/02/20/21) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <5EAC8776-84E0-4502-AFFA-7DC61DF0812E@thijsalkema.de>
Date: Mon, 9 Feb 2015 22:55:11 +0100
From: Thijs Alkemade <me@...jsalkema.de>
To: oss-security@...ts.openwall.com
Subject: CVE Request: jabberd remote information disclosure

Hello,

A buffer overflow was found in the XMPP server jabberd2 when normalizing
strings that can lead to remote information disclosure [1]. When parsing a
JID, jabberd2 version 2.3.2 and below truncate the data but do not verify
whether the result is valid UTF8 before passing it to libidn. If the data ends
with an unterminated multi-byte UTF8 sequence then libidn may copy data past
the buffer into the result. This can be exploited by remote clients or remote
servers.

Could you please assign a CVE for this issue?

[1] = <https://github.com/jabberd2/jabberd2/issues/85>

Best regards,
Thijs Alkemade

Download attachment "[signature.asc](13/1)" of type "application/pgp-signature" (842 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_dc8de5a6_20250125_004821.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](24) [[next>]](../../../2015/02/24/1) [[<thread-prev]](18) [[thread-next>]](../../../2015/06/17/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150223211638.C124242E00E@smtpvbsrv1.mitre.org>
Date: Mon, 23 Feb 2015 16:16:38 -0500 (EST)
From: cve-assign@...re.org
To: me@...jsalkema.de
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: jabberd remote information disclosure

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> When parsing a JID, jabberd2 version 2.3.2 and below truncate the data
> but do not verify whether the result is valid UTF8 before passing it
> to libidn.

Use CVE-2015-2058 for this jabberd2 vulnerability in which truncation
fails to preserve the validity of the input, because the truncation
occurs on a byte boundary that is not necessarily a character
boundary. (The resulting invalid input has security-relevant
mishandling within the current version of a required library, and it's
reasonable to expect that security-relevant mishandling could occur in
other cases.)

> If the data ends with an unterminated multi-byte UTF8
> sequence then libidn may copy data past the buffer into the result.

> <https://github.com/jabberd2/jabberd2/issues/85>

> the stringprep functions from libidn require the input to be valid UTF8

> The libidn documentation claims "This function will not read or write
> to characters outside that size." about the length of the buffer that
> needs to be specified, but this is not true,

Use CVE-2015-2059 for this libidn out-of-bounds read issue. Possibly
it could be argued that this is a borderline case for a CVE. However,
the documentation says "This function will not read or write to
characters outside that size" rather than "If the input is valid
UTF-8, then this function will not read or write to characters outside
that size." If the input is not valid UTF-8, then the function is
entitled to undefined behavior within the bounds of the buffer.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJU65hlAAoJEKllVAevmvmsW34H/ipX4VQsrkAIbksSpkx4Q22i
ClWlsfzlzu7cgqyvuLbgVVt5FqHRqM6aSjcDwkWcB0gXUH/WzzyyHS4iOIomTxld
GUQQ1J+1G2/cuwLKdlpjeFM9Gs9E5wNoVPv7VZwBoFegWmyipfr7afZ9AHn9BmP4
FPe5Md6smDf7x5g/mecqlQQ28YyYBDNWWvYG9Q0HaKoc1fpUP4hPA3hznx/5xb+V
2ln4SGQu/62sZJySzNhw4Y70xJ5lEXL8C5pnS4KA6kslNYEEsVPT6hiNMcrsQEUM
zgB5HJuLnoB2FuCl1ZihCXVDwz7HA/YyvX6S4u/XAS0DEspi0B89SkRTMjDDzCI=
=cEQY
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_3b344a35_20250125_004823.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjabberd2%2Fjabberd2%2Fissues%2F85)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjabberd2%2Fjabberd2%2Fissues%2F85)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=jabberd2%2Fjabberd2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Feb 12, 2019. It is now read-only.

[jabberd2](/jabberd2)
/
**[jabberd2](/jabberd2/jabberd2)**
Public archive

* [Notifications](/login?return_to=%2Fjabberd2%2Fjabberd2) You must be signed in to change notification settings
* [Fork
  171](/login?return_to=%2Fjabberd2%2Fjabberd2)
* [Star
   438](/login?return_to=%2Fjabberd2%2Fjabberd2)

* [Code](/jabberd2/jabberd2)
* [Issues
  52](/jabberd2/jabberd2/issues)
* [Pull requests
  3](/jabberd2/jabberd2/pulls)
* [Actions](/jabberd2/jabberd2/actions)
* [Projects
  0](/jabberd2/jabberd2/projects)
* [Wiki](/jabberd2/jabberd2/wiki)
* [Security](/jabberd2/jabberd2/security)
* [Insights](/jabberd2/jabberd2/pulse)

Additional navigation options

* [Code](/jabberd2/jabberd2)
* [Issues](/jabberd2/jabberd2/issues)
* [Pull requests](/jabberd2/jabberd2/pulls)
* [Actions](/jabberd2/jabberd2/actions)
* [Projects](/jabberd2/jabberd2/projects)
* [Wiki](/jabberd2/jabberd2/wiki)
* [Security](/jabberd2/jabberd2/security)
* [Insights](/jabberd2/jabberd2/pulse)

This repository has been archived by the owner on Feb 12, 2019. It is now read-only.

# Stringprep calls may reveal random memory #85

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[Stringprep calls may reveal random memory](#top)#85Copy linkLabels[Bug](https://github.com/jabberd2/jabberd2/issues?q=state%3Aopen%20label%3A%22Bug%22)[![@xnyhps](https://avatars.githubusercontent.com/u/85089?v=4&size=80)](/xnyhps)
## Description

[![@xnyhps](https://avatars.githubusercontent.com/u/85089?v=4&size=48)](/xnyhps)[xnyhps](https://github.com/xnyhps)opened [on Oct 22, 2014](https://github.com/jabberd2/jabberd2/issues/85#issue-46526372)

When a bind iq comes in, the following happens:

1. [c2s/c2s.c#L285](https://github.com/jabberd2/jabberd2/blob/fca57e6207c21469943e1546427d534b5799e848/c2s/c2s.c#L285) grabs the bytes of the chosen resource. If the resource was > 1023 bytes, only the first 1023 bytes are copied.
2. That calls `jid_reset_components`, which eventually ends up in [`jid_prep_pieces`](https://github.com/jabberd2/jabberd2/blob/f6225f9cc5af93835285a0a788479978d271ee38/util/jid.c#L28).
3. That calls `stringprep_xmpp_resourceprep(resource, 1024)`. However, the `stringprep` functions from libidn [require the input to be valid UTF8](https://www.gnu.org/software/libidn/doxygen/stringprep_8h.html#a5e815a0ce15b7e34a44a5ac7e5539012). Nothing has checked whether the resource is still UTF8 after trimming it to 1023 characters.
4. If the resource ends with just a part of a multi-byte character (so is not valid UTF-8) then **`stringprep` skips over the terminating `NULL`-byte**. This means data past the resource buffer will be also read as if they are part of the resource.

   The libidn documentation claims "This function will not **read** or write to characters outside that size." about the length of the buffer that needs to be specified, but this is not true, it will continue reading until it finds a terminating `NULL`-byte. It will only not *write* outside that size. Therefore it is possible to cause the data after the resource buffer to become part of the result. By including some characters that should be removed according to the XMPP resource stringprep profile, it is possible to make sure random data in the server's memory ends up in the returned resource.

For example:

C: `<iq type='set' id='bind'><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'><resource>\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200D\u200DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAрф</resource></bind></iq>`

`\u200D` shown here escaped, it is mapped to nothing by the stringprep profile. The string is exactly long enough such that the `ф` gets cut into two when taking the first 1023 bytes.

S: `<iq xmlns='jabber:client' id='bind' type='result'><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'><jid>test@localhost.localdomain/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAррlocalhost.localdomain</jid></bind></iq>`

The data in this case is harmless as it is the domain, but the same trick likely works for the domain and node parts of a JID. Different compilers and different architectures may also lead to different results.

What should happen is making sure the different components are valid UTF-8 *before* calling any of the `stringprep` functions.

## Metadata

### Assignees

No one assigned

### Labels

[Bug](https://github.com/jabberd2/jabberd2/issues?q=state%3Aopen%20label%3A%22Bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


