=== Content from github.com_04312a01_20250124_200241.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquassel%2Fquassel%2Fcommit%2Fb5e38970ffd55e2dd9f706ce75af9a8d7730b1b8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquassel%2Fquassel%2Fcommit%2Fb5e38970ffd55e2dd9f706ce75af9a8d7730b1b8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=quassel%2Fquassel)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[quassel](/quassel)
/
**[quassel](/quassel/quassel)**
Public

* [Notifications](/login?return_to=%2Fquassel%2Fquassel) You must be signed in to change notification settings
* [Fork
  222](/login?return_to=%2Fquassel%2Fquassel)
* [Star
   731](/login?return_to=%2Fquassel%2Fquassel)

* [Code](/quassel/quassel)
* [Pull requests
  32](/quassel/quassel/pulls)
* [Actions](/quassel/quassel/actions)
* [Projects
  0](/quassel/quassel/projects)
* [Security](/quassel/quassel/security)
* [Insights](/quassel/quassel/pulse)

Additional navigation options

* [Code](/quassel/quassel)
* [Pull requests](/quassel/quassel/pulls)
* [Actions](/quassel/quassel/actions)
* [Projects](/quassel/quassel/projects)
* [Security](/quassel/quassel/security)
* [Insights](/quassel/quassel/pulse)

## Commit

[Permalink](/quassel/quassel/commit/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Improve the message-splitting algorithm for PRIVMSG and CTCP

[Browse files](/quassel/quassel/tree/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8)
Browse the repository at this point in the history

```
This introduces a new message splitting algorithm based on
QTextBoundaryFinder.  It works by first starting with the entire
message to be sent, encoding it, and checking to see if it is over
the maximum message length.  If it is, it uses QTBF to find the
word boundary most immediately preceding the maximum length.  If no
suitable boundary can be found, it falls back to searching for
grapheme boundaries.  It repeats this process until the entire
message has been sent.

Unlike what it replaces, the new splitting code is not recursive
and cannot cause stack overflows.  Additionally, if it is unable
to split a string, it will give up gracefully and not crash the
core or cause a thread to run away.

This patch fixes two bugs.  The first is garbage characters caused
by accidentally splitting the string in the middle of a multibyte
character.  Since the new code splits at a character level instead
of a byte level, this will no longer be an issue.  The second is
the core crash caused by sending an overlength CTCP query ("/me")
containing only multibyte characters.  This bug was caused by the
old CTCP splitter using the byte index from lastParamOverrun() as
a character index for a QString.
```

* Loading branch information

[![@mamarley](https://avatars.githubusercontent.com/u/1039758?s=40&v=4)](/mamarley)

[mamarley](/quassel/quassel/commits?author=mamarley "View all commits by mamarley")
committed
Feb 27, 2015

1 parent
[05b9069](/quassel/quassel/commit/05b9069b0df2cbfd71bd138ccde2c95378f11e89)

commit b5e3897

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**124 additions**
and
**71 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/core

  + src/core/corebasichandler.cpp
    [corebasichandler.cpp](#diff-041dec70680a29b23b69b139096023b98724e210a7ced821103bc9224d8e42d4)
  + src/core/corebasichandler.h
    [corebasichandler.h](#diff-84b07121f184b37eef18ce6901a77bc3dc08cc8d14f3d7a8517205b4f15ce151)
  + src/core/corenetwork.cpp
    [corenetwork.cpp](#diff-933818b357e24af0a2b28dd5728a20d7db323a320c07fb05c8e52532645050b7)
  + src/core/corenetwork.h
    [corenetwork.h](#diff-7e67bbcb6e4f9c8667076c1cc0cefa58eb013459644b8dc6018eab02ce643345)
  + src/core/coreuserinputhandler.cpp
    [coreuserinputhandler.cpp](#diff-a035992fd2be89304dbfe2d2faf2164f021fa367c3fd1958b5e47d1a4d877afc)
  + src/core/coreuserinputhandler.h
    [coreuserinputhandler.h](#diff-0a94d86d73e87aa1b99e7cd6844677a44a8424f5831d65873baa340c0993afb4)
  + src/core/ctcpparser.cpp
    [ctcpparser.cpp](#diff-6f0f2609b2f82d6978e83e3498c9b8292f8ae60d3dda9149a47013d4e102e387)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[src/core/corebasichandler.cpp](#diff-041dec70680a29b23b69b139096023b98724e210a7ced821103bc9224d8e42d4 "src/core/corebasichandler.cpp")

Show comments

[View file](/quassel/quassel/blob/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8/src/core/corebasichandler.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,9 @@ CoreBasicHandler::CoreBasicHandler(CoreNetwork \*parent) |
|  |  | connect(this, SIGNAL(putCmd(QString, const QList<QByteArray> &, const QByteArray &)), |
|  |  | network(), SLOT(putCmd(QString, const QList<QByteArray> &, const QByteArray &))); |
|  |  |  |
|  |  | connect(this, SIGNAL(putCmd(QString, const QList<QList<QByteArray>> &, const QByteArray &)), |
|  |  | network(), SLOT(putCmd(QString, const QList<QList<QByteArray>> &, const QByteArray &))); |
|  |  |  |
|  |  | connect(this, SIGNAL(putRawLine(const QByteArray &)), |
|  |  | network(), SLOT(putRawLine(const QByteArray &))); |
|  |  | } |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[src/core/corebasichandler.h](#diff-84b07121f184b37eef18ce6901a77bc3dc08cc8d14f3d7a8517205b4f15ce151 "src/core/corebasichandler.h")

Show comments

[View file](/quassel/quassel/blob/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8/src/core/corebasichandler.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,6 +55,7 @@ class CoreBasicHandler : public BasicHandler |
|  |  | signals: |
|  |  | void displayMsg(Message::Type, BufferInfo::Type, const QString &target, const QString &text, const QString &sender = "", Message::Flags flags = Message::None); |
|  |  | void putCmd(const QString &cmd, const QList<QByteArray> &params, const QByteArray &prefix = QByteArray()); |
|  |  | void putCmd(const QString &cmd, const QList<QList<QByteArray>> &params, const QByteArray &prefix = QByteArray()); |
|  |  | void putRawLine(const QByteArray &msg); |
|  |  |  |
|  |  | protected: |
| Expand Down | |  |

86 changes: 86 additions & 0 deletions

86
[src/core/corenetwork.cpp](#diff-933818b357e24af0a2b28dd5728a20d7db323a320c07fb05c8e52532645050b7 "src/core/corenetwork.cpp")

Show comments

[View file](/quassel/quassel/blob/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8/src/core/corenetwork.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -284,6 +284,16 @@ void CoreNetwork::putCmd(const QString &cmd, const QList<QByteArray> &params, co |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | void CoreNetwork::putCmd(const QString &cmd, const QList<QList<QByteArray>> &params, const QByteArray &prefix) |
|  |  | { |
|  |  | QListIterator<QList<QByteArray>> i(params); |
|  |  | while (i.hasNext()) { |
|  |  | QList<QByteArray> msg = i.next(); |
|  |  | putCmd(cmd, msg, prefix); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | void CoreNetwork::setChannelJoined(const QString &channel) |
|  |  | { |
|  |  | \_autoWhoQueue.prepend(channel.toLower()); // prepend so this new chan is the first to be checked |
| Expand Down  Expand Up | | @@ -980,3 +990,79 @@ void CoreNetwork::requestSetNetworkInfo(const NetworkInfo &info) |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | QList<QList<QByteArray>> CoreNetwork::splitMessage(const QString &cmd, const QString &message, std::function<QList<QByteArray>(QString &)> cmdGenerator) |
|  |  | { |
|  |  | QString wrkMsg(message); |
|  |  | QList<QList<QByteArray>> msgsToSend; |
|  |  |  |
|  |  | // do while (wrkMsg.size() > 0) |
|  |  | do { |
|  |  | // First, check to see if the whole message can be sent at once. The |
|  |  | // cmdGenerator function is passed in by the caller and is used to encode |
|  |  | // and encrypt (if applicable) the message, since different callers might |
|  |  | // want to use different encoding or encode different values. |
|  |  | int splitPos = wrkMsg.size(); |
|  |  | QList<QByteArray> initialSplitMsgEnc = cmdGenerator(wrkMsg); |
|  |  | int initialOverrun = userInputHandler()->lastParamOverrun(cmd, initialSplitMsgEnc); |
|  |  |  |
|  |  | if (initialOverrun) { |
|  |  | // If the message was too long to be sent, first try splitting it along |
|  |  | // word boundaries with QTextBoundaryFinder. |
|  |  | QString splitMsg(wrkMsg); |
|  |  | QTextBoundaryFinder qtbf(QTextBoundaryFinder::Word, splitMsg); |
|  |  | qtbf.setPosition(initialSplitMsgEnc[1].size() - initialOverrun); |
|  |  | QList<QByteArray> splitMsgEnc; |
|  |  | int overrun = initialOverrun; |
|  |  |  |
|  |  | while (overrun) { |
|  |  | splitPos = qtbf.toPreviousBoundary(); |
|  |  |  |
|  |  | // splitPos==-1 means the QTBF couldn't find a split point at all and |
|  |  | // splitPos==0 means the QTBF could only find a boundary at the beginning of |
|  |  | // the string. Neither one of these works for us. |
|  |  | if (splitPos > 0) { |
|  |  | // If a split point could be found, split the message there, calculate the |
|  |  | // overrun, and continue with the loop. |
|  |  | splitMsg = splitMsg.left(splitPos); |
|  |  | splitMsgEnc = cmdGenerator(splitMsg); |
|  |  | overrun = userInputHandler()->lastParamOverrun(cmd, splitMsgEnc); |
|  |  | } |
|  |  | else { |
|  |  | // If a split point could not be found (the beginning of the message |
|  |  | // is reached without finding a split point short enough to send) and we |
|  |  | // are still in Word mode, switch to Grapheme mode. We also need to restore |
|  |  | // the full wrkMsg to splitMsg, since splitMsg may have been cut down during |
|  |  | // the previous attempt to find a split point. |
|  |  | if (qtbf.type() == QTextBoundaryFinder::Word) { |
|  |  | splitMsg = wrkMsg; |
|  |  | splitPos = splitMsg.size(); |
|  |  | QTextBoundaryFinder graphemeQtbf(QTextBoundaryFinder::Grapheme, splitMsg); |
|  |  | graphemeQtbf.setPosition(initialSplitMsgEnc[1].size() - initialOverrun); |
|  |  | qtbf = graphemeQtbf; |
|  |  | } |
|  |  | else { |
|  |  | // If the QTBF fails to find a split point in Grapheme mode, we give up. |
|  |  | // This should never happen, but it should be handled anyway. |
|  |  | qWarning() << "Unexpected failure to split message!"; |
|  |  | return msgsToSend; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // Once a message of sendable length has been found, remove it from the wrkMsg and |
|  |  | // add it to the list of messages to be sent. |
|  |  | wrkMsg.remove(0, splitPos); |
|  |  | msgsToSend.append(splitMsgEnc); |
|  |  | } |
|  |  | else{ |
|  |  | // If the entire remaining message is short enough to be sent all at once, remove |
|  |  | // it from the wrkMsg and add it to the list of messages to be sent. |
|  |  | wrkMsg.remove(0, splitPos); |
|  |  | msgsToSend.append(initialSplitMsgEnc); |
|  |  | } |
|  |  | } while (wrkMsg.size() > 0); |
|  |  |  |
|  |  | return msgsToSend; |
|  |  | } |

5 changes: 5 additions & 0 deletions

5
[src/core/corenetwork.h](#diff-7e67bbcb6e4f9c8667076c1cc0cefa58eb013459644b8dc6018eab02ce643345 "src/core/corenetwork.h")

Show comments

[View file](/quassel/quassel/blob/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8/src/core/corenetwork.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -40,6 +40,8 @@ |
|  |  |  |
|  |  | #include "coresession.h" |
|  |  |  |
|  |  | #include <functional> |
|  |  |  |
|  |  | class CoreIdentity; |
|  |  | class CoreUserInputHandler; |
|  |  | class CoreIgnoreListManager; |
| Expand Down  Expand Up | | @@ -93,6 +95,8 @@ class CoreNetwork : public Network |
|  |  | inline quint16 localPort() const { return socket.localPort(); } |
|  |  | inline quint16 peerPort() const { return socket.peerPort(); } |
|  |  |  |
|  |  | QList<QList<QByteArray>> splitMessage(const QString &cmd, const QString &message, std::function<QList<QByteArray>(QString &)> cmdGenerator); |
|  |  |  |
|  |  | public slots: |
|  |  | virtual void setMyNick(const QString &mynick); |
|  |  |  |
| Expand All | | @@ -112,6 +116,7 @@ public slots: |
|  |  | void userInput(BufferInfo bufferInfo, QString msg); |
|  |  | void putRawLine(QByteArray input); |
|  |  | void putCmd(const QString &cmd, const QList<QByteArray> &params, const QByteArray &prefix = QByteArray()); |
|  |  | void putCmd(const QString &cmd, const QList<QList<QByteArray>> &params, const QByteArray &prefix = QByteArray()); |
|  |  |  |
|  |  | void setChannelJoined(const QString &channel); |
|  |  | void setChannelParted(const QString &channel); |
| Expand Down | |  |

72 changes: 23 additions & 49 deletions

72
[src/core/coreuserinputhandler.cpp](#diff-a035992fd2be89304dbfe2d2faf2164f021fa367c3fd1958b5e47d1a4d877afc "src/core/coreuserinputhandler.cpp")

Show comments

[View file](/quassel/quassel/blob/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8/src/core/coreuserinputhandler.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -473,12 +473,16 @@ void CoreUserInputHandler::handleMsg(const BufferInfo &bufferInfo, const QString |
|  |  | return; |
|  |  |  |
|  |  | QString target = msg.section(' ', 0, 0); |
|  |  | QByteArray encMsg = userEncode(target, msg.section(' ', 1)); |
|  |  | QString msgSection = msg.section(' ', 1); |
|  |  |  |
|  |  | std::function<QByteArray(const QString &, const QString &)> encodeFunc = [this] (const QString &target, const QString &message) -> QByteArray { |
|  |  | return userEncode(target, message); |
|  |  | }; |
|  |  |  |
|  |  | #ifdef HAVE\_QCA2 |
|  |  | putPrivmsg(serverEncode(target), encMsg, network()->cipher(target)); |
|  |  | putPrivmsg(target, msgSection, encodeFunc, network()->cipher(target)); |
|  |  | #else |
|  |  | putPrivmsg(serverEncode(target), encMsg); |
|  |  | putPrivmsg(target, msgSection, encodeFunc); |
|  |  | #endif |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -594,11 +598,14 @@ void CoreUserInputHandler::handleSay(const BufferInfo &bufferInfo, const QString |
|  |  | if (bufferInfo.bufferName().isEmpty() || !bufferInfo.acceptsRegularMessages()) |
|  |  | return; // server buffer |
|  |  |  |
|  |  | QByteArray encMsg = channelEncode(bufferInfo.bufferName(), msg); |
|  |  | std::function<QByteArray(const QString &, const QString &)> encodeFunc = [this] (const QString &target, const QString &message) -> QByteArray { |
|  |  | return channelEncode(target, message); |
|  |  | }; |
|  |  |  |
|  |  | #ifdef HAVE\_QCA2 |
|  |  | putPrivmsg(serverEncode(bufferInfo.bufferName()), encMsg, network()->cipher(bufferInfo.bufferName())); |
|  |  | putPrivmsg(bufferInfo.bufferName(), msg, encodeFunc, network()->cipher(bufferInfo.bufferName())); |
|  |  | #else |
|  |  | putPrivmsg(serverEncode(bufferInfo.bufferName()), encMsg); |
|  |  | putPrivmsg(bufferInfo.bufferName(), msg, encodeFunc); |
|  |  | #endif |
|  |  | emit displayMsg(Message::Plain, bufferInfo.type(), bufferInfo.bufferName(), msg, network()->myNick(), Message::Self); |
|  |  | } |
| Expand Down  Expand Up | | @@ -763,56 +770,23 @@ void CoreUserInputHandler::defaultHandler(QString cmd, const BufferInfo &bufferI |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | void CoreUserInputHandler::putPrivmsg(const QByteArray &target, const QByteArray &message, Cipher \*cipher) |
|  |  | void CoreUserInputHandler::putPrivmsg(const QString &target, const QString &message, std::function<QByteArray(const QString &, const QString &)> encodeFunc, Cipher \*cipher) |
|  |  | { |
|  |  | // Encrypted messages need special care. There's no clear relation between cleartext and encrypted message length, |
|  |  | // so we can't just compute the maxSplitPos. Instead, we need to loop through the splitpoints until the crypted |
|  |  | // version is short enough... |
|  |  | // TODO: check out how the various possible encryption methods behave length-wise and make |
|  |  | // this clean by predicting the length of the crypted msg. |
|  |  | // For example, blowfish-ebc seems to create 8-char chunks. |
|  |  | QString cmd("PRIVMSG"); |
|  |  | QByteArray targetEnc = serverEncode(target); |
|  |  |  |
|  |  | static const char \*cmd = "PRIVMSG"; |
|  |  | static const char \*splitter = " .,-!?"; |
|  |  | std::function<QList<QByteArray>(QString &)> cmdGenerator = [&] (QString &splitMsg) -> QList<QByteArray> { |
|  |  | QByteArray splitMsgEnc = encodeFunc(target, splitMsg); |
|  |  |  |
|  |  | int maxSplitPos = message.count(); |
|  |  | int splitPos = maxSplitPos; |
|  |  | forever { |
|  |  | QByteArray crypted = message.left(splitPos); |
|  |  | bool isEncrypted = false; |
|  |  | #ifdef HAVE\_QCA2 |
|  |  | if (cipher && !cipher->key().isEmpty() && !message.isEmpty()) { |
|  |  | isEncrypted = cipher->encrypt(crypted); |
|  |  | if (cipher && !cipher->key().isEmpty() && !splitMsg.isEmpty()) { |
|  |  | cipher->encrypt(splitMsgEnc); |
|  |  | } |
|  |  | #endif |
|  |  | int overrun = lastParamOverrun(cmd, QList<QByteArray>() << target << crypted); |
|  |  | if (overrun) { |
|  |  | // In case this is not an encrypted msg, we can just cut off at the end |
|  |  | if (!isEncrypted) |
|  |  | maxSplitPos = message.count() - overrun; |
|  |  |  |
|  |  | splitPos = -1; |
|  |  | for (const char \*splitChar = splitter; \*splitChar != 0; splitChar++) { |
|  |  | splitPos = qMax(splitPos, message.lastIndexOf(\*splitChar, maxSplitPos) + 1); // keep split char on old line |
|  |  | } |
|  |  | if (splitPos <= 0 || splitPos > maxSplitPos) |
|  |  | splitPos = maxSplitPos; |
|  |  |  |
|  |  | maxSplitPos = splitPos - 1; |
|  |  | if (maxSplitPos <= 0) { // this should never happen, but who knows... |
|  |  | qWarning() << tr("[Error] Could not encrypt your message: %1").arg(message.data()); |
|  |  | return; |
|  |  | } |
|  |  | continue; // we never come back here for !encrypted! |
|  |  | } |
|  |  |  |
|  |  | // now we have found a valid splitpos (or didn't need to split to begin with) |
|  |  | putCmd(cmd, QList<QByteArray>() << target << crypted); |
|  |  | if (splitPos < message.count()) |
|  |  | putPrivmsg(target, message.mid(splitPos), cipher); |
|  |  | return QList<QByteArray>() << targetEnc << splitMsgEnc; |
|  |  | }; |
|  |  |  |
|  |  | return; |
|  |  | } |
|  |  | putCmd(cmd, network()->splitMessage(cmd, message, cmdGenerator)); |
|  |  | } |
|  |  |  |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/core/coreuserinputhandler.h](#diff-0a94d86d73e87aa1b99e7cd6844677a44a8424f5831d65873baa340c0993afb4 "src/core/coreuserinputhandler.h")

Show comments

[View file](/quassel/quassel/blob/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8/src/core/coreuserinputhandler.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -88,7 +88,7 @@ public slots: |
|  |  | private: |
|  |  | void doMode(const BufferInfo& bufferInfo, const QChar &addOrRemove, const QChar &mode, const QString &nickList); |
|  |  | void banOrUnban(const BufferInfo &bufferInfo, const QString &text, bool ban); |
|  |  | void putPrivmsg(const QByteArray &target, const QByteArray &message, Cipher \*cipher = 0); |
|  |  | void putPrivmsg(const QString &target, const QString &message, std::function<QByteArray(const QString &, const QString &)> encodeFunc, Cipher \*cipher = 0); |
|  |  |  |
|  |  | #ifdef HAVE\_QCA2 |
|  |  | QByteArray encrypt(const QString &target, const QByteArray &message, bool \*didEncrypt = 0) const; |
| Expand Down | |  |

26 changes: 5 additions & 21 deletions

26
[src/core/ctcpparser.cpp](#diff-6f0f2609b2f82d6978e83e3498c9b8292f8ae60d3dda9149a47013d4e102e387 "src/core/ctcpparser.cpp")

Show comments

[View file](/quassel/quassel/blob/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8/src/core/ctcpparser.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -312,29 +312,13 @@ QByteArray CtcpParser::pack(const QByteArray &ctcpTag, const QByteArray &message |
|  |  |  |
|  |  | void CtcpParser::query(CoreNetwork \*net, const QString &bufname, const QString &ctcpTag, const QString &message) |
|  |  | { |
|  |  | QList<QByteArray> params; |
|  |  | params << net->serverEncode(bufname) << lowLevelQuote(pack(net->serverEncode(ctcpTag), net->userEncode(bufname, message))); |
|  |  |  |
|  |  | static const char \*splitter = " .,-!?"; |
|  |  | int maxSplitPos = message.count(); |
|  |  | int splitPos = maxSplitPos; |
|  |  | QString cmd("PRIVMSG"); |
|  |  |  |
|  |  | int overrun = net->userInputHandler()->lastParamOverrun("PRIVMSG", params); |
|  |  | if (overrun) { |
|  |  | maxSplitPos = message.count() - overrun -2; |
|  |  | splitPos = -1; |
|  |  | for (const char \*splitChar = splitter; \*splitChar != 0; splitChar++) { |
|  |  | splitPos = qMax(splitPos, message.lastIndexOf(\*splitChar, maxSplitPos) + 1); // keep split char on old line |
|  |  | } |
|  |  | if (splitPos <= 0 || splitPos > maxSplitPos) |
|  |  | splitPos = maxSplitPos; |
|  |  |  |
|  |  | params = params.mid(0, 1) << lowLevelQuote(pack(net->serverEncode(ctcpTag), net->userEncode(bufname, message.left(splitPos)))); |
|  |  | } |
|  |  | net->putCmd("PRIVMSG", params); |
|  |  | std::function<QList<QByteArray>(QString &)> cmdGenerator = [&] (QString &splitMsg) -> QList<QByteArray> { |
|  |  | return QList<QByteArray>() << net->serverEncode(bufname) << lowLevelQuote(pack(net->serverEncode(ctcpTag), net->userEncode(bufname, splitMsg))); |
|  |  | }; |
|  |  |  |
|  |  | if (splitPos < message.count()) |
|  |  | query(net, bufname, ctcpTag, message.mid(splitPos)); |
|  |  | net->putCmd(cmd, net->splitMessage(cmd, message, cmdGenerator)); |
|  |  | } |
|  |  |  |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b5e3897`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquassel%2Fquassel%2Fcommit%2Fb5e38970ffd55e2dd9f706ce75af9a8d7730b1b8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.opensuse.org_49a9c09d_20250124_200239.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B/#OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B)

# openSUSE-SU-2015:0687-1: moderate: Security update for quassel

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

8 Apr
2015

8 Apr
'15

14:07

openSUSE Security Update: Security update for quassel
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2015:0687-1
Rating: moderate
References: #924930 #924933
Cross-References: CVE-2015-2778 CVE-2015-2779
Affected Products:
openSUSE 13.2
openSUSE 13.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
The IRC client quassel was updated to fix two security issues.
The following vulnerabilities were fixed:
\* quassel could crash when receiving an overlength CTCP query containing
only multibyte characters (bnc#924930 CVE-2015-2778)
\* quassel could incorrectly split a message in the middle of a multibyte
character, leading to DoS (bnc#924933 CVE-2015-2779)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 13.2:
zypper in -t patch openSUSE-2015-294=1
- openSUSE 13.1:
zypper in -t patch openSUSE-2015-294=1
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 13.2 (i586 x86\_64):
quassel-base-0.10.0-3.7.1
quassel-client-0.10.0-3.7.1
quassel-client-debuginfo-0.10.0-3.7.1
quassel-core-0.10.0-3.7.1
quassel-core-debuginfo-0.10.0-3.7.1
quassel-debugsource-0.10.0-3.7.1
quassel-mono-0.10.0-3.7.1
quassel-mono-debuginfo-0.10.0-3.7.1
- openSUSE 13.1 (i586 x86\_64):
quassel-base-0.9.2-19.1
quassel-client-0.9.2-19.1
quassel-client-debuginfo-0.9.2-19.1
quassel-core-0.9.2-19.1
quassel-core-debuginfo-0.9.2-19.1
quassel-debugsource-0.9.2-19.1
quassel-mono-0.9.2-19.1
quassel-mono-debuginfo-0.9.2-19.1
References:
<https://www.suse.com/security/cve/CVE-2015-2778.html>
<https://www.suse.com/security/cve/CVE-2015-2779.html>
<https://bugzilla.suse.com/924930>
<https://bugzilla.suse.com/924933>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B/#OJ7TNZXQN6DEGLXYH6NGMRBVAFTR553B)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.openwall.com_14d21f5b_20250124_200239.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](11) [[next>]](13) [[thread-next>]](../../../2015/03/27/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <550C495D.9030204@reactos.org>
Date: Fri, 20 Mar 2015 17:22:53 +0100
From: Pierre Schweitzer <pierre@...ctos.org>
To: OSS Security List <oss-security@...ts.openwall.com>,
 cve-assign@...re.org
Subject: CVE request: denial of service in Quassel

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear all,

The following commit fixed a denial of service in quassel:
<https://github.com/quassel/quassel/commit/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8>

It allows a connected client to cause a core crash by sending a CTCP
request which would be too long and multibyte.

This is mitigated by the fact that it requires an authed user.

With my best regards,
- --
Pierre Schweitzer <pierre@...ctos.org>
System & Network Administrator
Senior Kernel Developer
ReactOS Deutschland e.V.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJVDEldAAoJEHVFVWw9WFsLeaQP/0zUGaXiZUsJRbZod5ZqrMXb
oUJ+FVfhDTyWZNFbyNb6Pi76STyQHCZwggzR90ay/oBqn7toya9SLHASamjHSBY4
VeJI7q+KaM2/T9YwTVMU0WLB6gPjkR4/jQf0aE1Fdf5yRGejybybA5ffdvbJjYSs
du+uwsWOCztIohbm9vAH+bQCIPD+BjJzpAgsJ88SgfGMa3JZSah1pYfKh4StesYR
7SCx/R6WTJBqrrnfvUldUdcvF/5S8LGOtJoTAZi2QJZNZNBmZhntJ9QadCWuYTfX
mcxRZVuZrmcZ5mH4jiP4J8KoFdGzoHO4mTT2vc8g8EGkGcQ8aflAbA9Ngg4z/vyR
yZT0A+4fEYH5qh1QyIYiz2j+i4GXshcr/hS+NKStb30inj8fE5fnN8OAMjOPxd7O
gVZJv38XHurPtCDUuo/BTWX2CKgyRvikK33sJXN0eDx/tQCnMk+W+g1Ur+ujCgpO
vPW/Sv+301goGHZoobmWBic0gR2zUFeb/8FbTBnqA979DzUUCY712P/TX6vvhwnB
oryfwvuLNPGjsbT2KyLi9u3jyJnO5dAw2gmFsVSz2hk+874kkuV/cYq28HEdLTe/
1kSbEkEBZx7y5ksUZzp514j9RUUGNK/ZXZZz9GJkIEDlO19pmF/7SpgdFW/de6Kr
Jpv+YbGqoIljb8c79IbX
=GmZ8
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.suse.com_4f452509_20250126_031340.html ===


| Bugzilla – Bug 924930 | VUL-0: CVE-2015-2778: quassel: core crash caused by sending an overlength CTCP query containing only multibyte characters. | Last modified: 2015-04-08 14:08:06 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D924930)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 924930**](show_bug.cgi?id=924930)
(CVE-2015-2778)
- VUL-0: CVE-2015-2778: quassel: core crash caused by sending an overlength CTCP query containing only multibyte characters.

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2015-2778: quassel: core crash caused by sending an overlength CTC...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-2778 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other openSUSE 13.1 | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/115293/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2015-03-30 12:27 UTC by Marcus Meissner | | --- | --- | | Modified: | 2015-04-08 14:08 UTC ([History](show_activity.cgi?id=924930)) | | CC List: | 2 users (show)  astieger smash\_bz | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=924930) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=924930&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=924930&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=924930#c0)  Marcus Meissner   2015-03-30 12:27:23 UTC  ``` rh#1204855  The following commit fixed a denial of service in quassel: <https://github.com/quassel/quassel/commit/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8>  It allows a connected client to cause a core crash by sending a CTCP request which would be too long and multibyte.  This is mitigated by the fact that it requires an authed user.  CVE request: <http://seclists.org/oss-sec/2015/q1/903>  References: <https://bugzilla.redhat.com/show_bug.cgi?id=1204855> <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-2778> <http://seclists.org/oss-sec/2015/q1/1030> ``` [Comment 1](show_bug.cgi?id=924930#c1)  Swamp Workflow Management   2015-03-30 22:01:34 UTC  ``` bugbot adjusting priority ``` [Comment 2](show_bug.cgi?id=924930#c2)  Tomáš Chvátal   2015-04-01 11:08:53 UTC  ``` Submit request sent. ``` [Comment 3](show_bug.cgi?id=924930#c3)  Andreas Stieger   2015-04-08 13:31:50 UTC  ``` releasing ``` [Comment 4](show_bug.cgi?id=924930#c4)  Swamp Workflow Management   2015-04-08 14:08:06 UTC  ``` openSUSE-SU-2015:0687-1: An update that fixes two vulnerabilities is now available.  Category: security (moderate) Bug References: 924930,924933 CVE References: CVE-2015-2778,CVE-2015-2779 Sources used: openSUSE 13.2 (src):    quassel-0.10.0-3.7.1 openSUSE 13.1 (src):    quassel-0.9.2-19.1 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=924930)
* - [XML](show_bug.cgi?ctype=xml&id=924930)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=924930)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D924930)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from www.suse.com_d54fa8e8_20250126_031341.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2015-2779.html)
[English](https://www.suse.com/security/cve/CVE-2015-2779.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2015-2779.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2015-2779.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2015-2779.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2015-2779.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2015-2779.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2015-2779.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2015-2779

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2015-2778.html) [[Index]](index.html) [[Next]](CVE-2015-2782.html)

### Upstream information

[CVE-2015-2779 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2779)

#### Description

Stack consumption vulnerability in the message splitting functionality in Quassel before 0.12-rc1 allows remote attackers to cause a denial of service (uncontrolled recursion) via a crafted massage.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Does not affect SUSE products

This issue is currently rated as having [moderate](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 5 |
| Vector | AV:N/AC:L/Au:N/C:N/I:N/A:P |
| Access Vector | Network |
| Access Complexity | Low |
| Authentication | None |
| Confidentiality Impact | None |
| Integrity Impact | None |
| Availability Impact | Partial |

SUSE Bugzilla entry: [924933](https://bugzilla.suse.com/show_bug.cgi?id=924933) [RESOLVED / FIXED]
### SUSE Security Advisories:

openSUSE-SU-2015:0687-1

---

### SUSE Timeline for this CVE

CVE page created: Sat Mar 28 07:44:02 2015

CVE page last modified: Thu Dec 7 13:08:37 2023

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from bugzilla.suse.com_9621a9af_20250126_031340.html ===


| Bugzilla – Bug 924933 | VUL-0: CVE-2015-2779: quassel: incorrect message splitting leading to DoS | Last modified: 2015-04-08 14:08:15 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D924933)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 924933**](show_bug.cgi?id=924933)
(CVE-2015-2779)
- VUL-0: CVE-2015-2779: quassel: incorrect message splitting leading to DoS

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2015-2779: quassel: incorrect message splitting leading to DoS

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-2779 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other openSUSE 13.1 | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/115292/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2015-03-30 12:29 UTC by Marcus Meissner | | --- | --- | | Modified: | 2015-04-08 14:08 UTC ([History](show_activity.cgi?id=924933)) | | CC List: | 2 users (show)  astieger smash\_bz | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=924933) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=924933&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=924933&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=924933#c0)  Marcus Meissner   2015-03-30 12:29:31 UTC  ``` rh#1205130  A denial-of-service flaw was found in Quassel IRC, a distributed IRC client:  This patch fixes two bugs. The first is garbage characters caused by accidentally splitting the string in the middle of a multibyte character. Since the new code splits at a character level instead of a byte level, this will no longer be an issue. The second is the core crash caused by sending an overlength CTCP query ("/me") containing only multibyte characters. This bug was caused by the old CTCP splitter using the byte index from lastParamOverrun() as a character index for a QString.  <https://github.com/quassel/quassel/commit/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8>  References: <https://bugzilla.redhat.com/show_bug.cgi?id=1205130> <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-2779> <http://seclists.org/oss-sec/2015/q1/1030> ``` [Comment 1](show_bug.cgi?id=924933#c1)  Swamp Workflow Management   2015-03-30 22:01:43 UTC  ``` bugbot adjusting priority ``` [Comment 2](show_bug.cgi?id=924933#c2)  Tomáš Chvátal   2015-04-01 11:09:13 UTC  ``` Submit request sent. ``` [Comment 3](show_bug.cgi?id=924933#c3)  Andreas Stieger   2015-04-08 13:31:59 UTC  ``` releasing ``` [Comment 4](show_bug.cgi?id=924933#c4)  Swamp Workflow Management   2015-04-08 14:08:15 UTC  ``` openSUSE-SU-2015:0687-1: An update that fixes two vulnerabilities is now available.  Category: security (moderate) Bug References: 924930,924933 CVE References: CVE-2015-2778,CVE-2015-2779 Sources used: openSUSE 13.2 (src):    quassel-0.10.0-3.7.1 openSUSE 13.1 (src):    quassel-0.9.2-19.1 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=924933)
* - [XML](show_bug.cgi?ctype=xml&id=924933)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=924933)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D924933)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from www.suse.com_2ca3593a_20250126_031341.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2015-2778.html)
[English](https://www.suse.com/security/cve/CVE-2015-2778.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2015-2778.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2015-2778.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2015-2778.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2015-2778.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2015-2778.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2015-2778.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2015-2778

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2015-2776.html) [[Index]](index.html) [[Next]](CVE-2015-2779.html)

### Upstream information

[CVE-2015-2778 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2778)

#### Description

Quassel before 0.12-rc1 uses an incorrect data-type size when splitting a message, which allows remote attackers to cause a denial of service (crash) via a long CTCP query containing only multibyte characters.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Does not affect SUSE products

This issue is currently rated as having [moderate](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 5 |
| Vector | AV:N/AC:L/Au:N/C:N/I:N/A:P |
| Access Vector | Network |
| Access Complexity | Low |
| Authentication | None |
| Confidentiality Impact | None |
| Integrity Impact | None |
| Availability Impact | Partial |

SUSE Bugzilla entry: [924930](https://bugzilla.suse.com/show_bug.cgi?id=924930) [RESOLVED / FIXED]
### SUSE Security Advisories:

openSUSE-SU-2015:0687-1

---

### SUSE Timeline for this CVE

CVE page created: Sat Mar 28 07:44:03 2015

CVE page last modified: Thu Dec 7 13:08:37 2023

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from www.openwall.com_6819de51_20250124_200240.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](10) [[thread-next>]](../../../2015/03/28/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5515B83C.6080506@reactos.org>
Date: Fri, 27 Mar 2015 21:06:20 +0100
From: Pierre Schweitzer <pierre@...ctos.org>
To: cve-assign@...re.org
CC: oss-security@...ts.openwall.com
Subject: Re: CVE request: denial of service in Quassel

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Thanks for your detailed answer, please find my answers inlined.

On 27/03/2015 19:16, cve-assign@...re.org wrote:
> 2
>> Unlike what it replaces, the new splitting code is not recursive
>> and cannot cause stack overflows.
>
> If an attacker sends a crafted message and this leads to excessive
> stack consumption in an IRC client, making the client crash or
> hang, then that is relevant for a CVE. (We are expecting that it is
> a "normal" IRC client that supports independent sessions with
> messages from different channels or different persons.) However,
> b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8 doesn't actually state
> that the client would ever crash or hang.

This wouldn't affect the client. All the patch here only affects the
core component, so the stack overflow would happen in the core.

I'm indeed not sure about what would happen in case of a stack
overflow. But, be it a crash or a hang, it would cause a denial of
service for any client connected to core.

> 3
>> The first is garbage characters caused by accidentally splitting
>> the string in the middle of a multibyte character. Since the new
>> code splits at a character level instead of a byte level, this
>> will no longer be an issue.
>
> This one seems to be inherently about multibyte characters because
> it's an issue of string display (or string interpretation) if
> whole characters aren't preserved. However, it doesn't seem to be
> announced as a security issue. Although someone might be sending
> security-critical messages over IRC and would not want those
> messages to be misinterpreted, that's generally too much of a leap
> to have a CVE. If nobody else has other analysis, we will probably
> treat this as a non-security bug.

I don't believe this is to be considered as a security bug.
Especially, because due to the recursive, it would cause
reinterpreting the left string. It's unlikely it would be something
relevant that the core would dispatch to clients or server.

> 4
>> if it is unable to split a string, it will give up gracefully and
>> not crash the core or cause a thread to run away.
>
> As far as we can tell, this is about:
>
> // If the QTBF fails to find a split point in Grapheme mode, we
> give up. // This should never happen, but it should be handled
> anyway. qWarning() << "Unexpected failure to split message!";
> return msgsToSend;
>
> in the patched code. If nobody else has other analysis, we will
> probably treat this as a defense-in-depth measure that doesn't
> address any known vulnerability, and therefore has no CVE.

I believe this is more about in the removed code:
<https://github.com/quassel/quassel/commit/b5e38970ffd55e2dd9f706ce75af9a8d7730b1b8#diff-2b819a1018ddf6b5fa4b750553df0742L801>

But I'm not sure about how it could cause a crash, or a thread leak.

- --
Pierre Schweitzer <pierre at reactos.org>
System & Network Administrator
Senior Kernel Developer
ReactOS Deutschland e.V.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBAgAGBQJVFbg8AAoJEHVFVWw9WFsLpEQP+gJ8V1Z+i1RyQPuM6FiGNwqL
FOkAX+wC2ijGKpJgUvX6Hbi3g2SZma1tcSbCVxOX6aisrrDaDAK6c5SYBCSP+1bf
/8+1qIgbUd8kV16KdGLFDD2R9mrBxpIwUPGiBUK690B9GSec2Xl1ONo/FX4PXLdm
mwdSrTeVBimE2F4EE9Q15HJHE4KPeObSoqB3DaozVRI+GPcVEsu5S03wBMG/9zxY
DKxMpnR8WgTnW7wIXxSoiol8J3iDLj5PZ4NIRDu9k9SPwSGkR+61QaHUHlbew4mx
HF1znvAMeogut7VLKpnB2+uJDz99zKlYZ5ndkBbWeCuRH8CHrsRwv2seuSInzKOC
231xxtkrgg4RRuxGxMAo4r3fo0yERpe1r6n+swZy5Bpcgt1q96YCQjGF7iK12gcf
1dYpmff35hI1FDXl3Jxz+uTZ3SZJPNX1Jp1mh22BEDHtcdHhlntujOtdQNe/pPtU
GeTTv3l9CvbvWnh496Hn3QRw1u2S1Qntmn0OG2Y1v1JuUvhMxNWBTdQTZlI23Vzu
E9q2yf1RlYtXcUJUhlQlsw90h9/V8dbKJob3p+cYkW/bMrE/Nh9FAJCPWpl+uYGu
bFHIsmtPhk8qYp61mHIMipWE68iC0fTMjjXMLNkATQ2Vj3H6Ue8qACrM9aGaFmmI
V4jfpn2tBe7/VDKU7PwA
=k/fm
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_17551cd3_20250124_200240.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2015/03/27/11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150328054452.571E472E218@smtpvbsrv1.mitre.org>
Date: Sat, 28 Mar 2015 01:44:52 -0400 (EDT)
From: cve-assign@...re.org
To: pierre@...ctos.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: denial of service in Quassel

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

>> The second is
>> the core crash caused by sending an overlength CTCP query ("/me")
>> containing only multibyte characters. This bug was caused by the
>> old CTCP splitter using the byte index from lastParamOverrun() as
>> a character index for a QString.

> This seems to be, very roughly, an issue of incorrectly determining a
> data-structure length by using a wrong-sized data type for counting.
> It happens to be about multibyte characters but that's of secondary
> importance. This will almost certainly have a unique CVE ID ...

Use CVE-2015-2778.

>> Unlike what it replaces, the new splitting code is not recursive
>> and cannot cause stack overflows.

>>> But, be it a crash or a hang, it would cause a denial of
>>> service for any client connected to core.

Use CVE-2015-2779.

> The first is garbage characters caused
> by accidentally splitting the string in the middle of a multibyte
> character.

As suggested earlier, this has no CVE ID.

> if it is unable
> to split a string, it will give up gracefully and not crash the
> core or cause a thread to run away.

As suggested earlier, this has no CVE ID.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVFj9MAAoJEKllVAevmvmshfkH/0fpuId3QRMrFZW+S6Of4+Lc
jRGjVNJDUVnSkkIvAPFtSpRZv0Xwx/Tff255Nx4OByaNGpVv6ocrdggHKXhxQq4G
AMD2qNpBuIx7esTqTA40w6B70GPQOZF35+nOzNP0tsK7SFI+cPmyfDY/sB2JCzP2
fAmyCzX2JD1G9I7/5OyrhCYlV0RySzuMjdSC/LD0ikdEwkNP9V/IKm5HeufYvvyh
BAQKItg1kRsKIVFMajTU2oXEqrPVTXsj/dNI6u6fpwOwidxv5jdBw0ggWFeAyb5W
UYlRDPVBjMiMox5tLqC+2yC3vkykkBVlNgE1BBGQOmkBpgEQnzz8iQfJPSybw9w=
=czV4
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


