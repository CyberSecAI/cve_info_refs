=== Content from www.freebsd.org_ca9019be_20250124_132004.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-15:09.ipv6 Security Advisory
The FreeBSD Project
Topic: Denial of Service with IPv6 Router Advertisements
Category: core
Module: ipv6
Announced: 2015-04-07
Credits: Dennis Ljungmark
Affects: All supported versions of FreeBSD.
Corrected: 2015-04-07 20:20:24 UTC (stable/10, 10.1-STABLE)
2015-04-07 20:21:01 UTC (releng/10.1, 10.1-RELEASE-p9)
2015-04-07 20:20:44 UTC (stable/9, 9.3-STABLE)
2015-04-07 20:21:23 UTC (releng/9.3, 9.3-RELEASE-p13)
2015-04-07 20:20:44 UTC (stable/8, 8.4-STABLE)
2015-04-07 20:21:23 UTC (releng/8.4, 8.4-RELEASE-p27)
CVE Name: CVE-2015-2923
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
IPv6 nodes use the Neighbor Discovery protocol to determine the link-layer
address of other nodes, find routers, and maintain reachability information.
Routers advertise their presence together with various link and Internet
parameters either periodically, or in response to a Router Solicitation
message, using Router Advertisement (ICMPv6 type 134).
II. Problem Description
The Neighbor Discover Protocol allows a local router to advertise a
suggested Current Hop Limit value of a link, which will replace
Current Hop Limit on an interface connected to the link on the FreeBSD
system.
III. Impact
When the Current Hop Limit (similar to IPv4's TTL) is small, IPv6 packets
may get dropped before they reached their destinations.
By sending specifically crafted Router Advertisement packets, an attacker
on the local network can cause the FreeBSD system to lose the ability to
communicate with another IPv6 node on a different network.
IV. Workaround
Only systems that are manually configured to use "accept\_rtadv"
ifconfig(8) flag on an interface are affected.
The system administrator may decide to disable acceptance of Router
Advertisements from untrusted network in a per-interface basis, by
removing accept\_rtadv flag at run time using ifconfig(8):
ifconfig em0 inet6 -accept\_rtadv
Note that an interface does not accept Router Advertisement messages
by default even if an IPv6 address is configured. One can know
whether an interface is accepting Router Advertisement message or not
from existence of ACCEPT\_RTADV in "nd6 options" line in an output of
ifconfig(8):
nd6 options=23
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-15:09/ipv6.patch
# fetch https://security.FreeBSD.org/patches/SA-15:09/ipv6.patch.asc
# gpg --verify ipv6.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile your kernel as described in
 and reboot the
system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/8/ r281231
releng/8.4/ r281233
stable/9/ r281231
releng/9.3/ r281233
stable/10/ r281230
releng/10.1/ r281232
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.1.2 (FreeBSD)
iQIcBAEBCgAGBQJVJD4CAAoJEO1n7NZdz2rn13cQANJCk2LXSX8GDHGzWnD+D5gN
rNC4Q8n9CnN80ZO/0Pk0Xx2VAtr3CKxflBTXBKISKuY+dWOzNvuUuUUkrB9SlyTj
MYpqAljnBT0JkosGGBKJwt39DjW34HWlaj9wEPr1SdIq5vQO0cXS2glVPI/CQuy3
NwnpaAmftAG4eMSYojOeodXniha/ZasFap5Zj+1dgofFHEP87zxefP2IamG1Cq72
d8YJSCD8yy51mZ7dVFM29R3FAFdMpponci31dXGb5p8pj0yzVfvI/HF1MRK+x8Nz
R0/jFOHY4TR26BfKsc4Nc6Ze7jdZHUP1qWoL2O6HiLVqws0nQp3jma7FkMrUMuui
H9kAQaIc27tJOkSK4Gdc/dwzHgb3xr2fNfOjvbUv3VNjzijTzbzKfRlVH77EAxAi
sQfUcql/toGdC/QaOlhC8+v5jHdwkLdpfRc4QdsV1rKDAA8mj068sJQS/yAig8E8
QUNmB3UK1QsX3tmy0JuDJk7tr/jjnhl2Jt9Skvm70xUiA7G05Z1qouErkIAjwikY
zQSPpSQebi3am9TtK/GViOjEVpWLYzLFYo6laR8wMw9eJsj0xlF8Qqz+0HudqfSt
lMOfpVfUmBSIxlFdiIzMBfbpLdD1gSo4oBLIYA/xw7UtDMiWi2Iji/mBY1Jg/i5V
ZCTwZmnmaVuPcsGOzv5W
=A2Am
-----END PGP SIGNATURE-----


=== Content from git.kernel.org_eb1745ec_20250124_132003.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | D.S. Ljungmark <ljungmark@modio.se> | 2015-03-25 09:28:15 +0100 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2015-03-25 11:41:08 -0400 |
| commit | [6fd99094de2b83d1d4c8457f2c83483b2828e75a](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a)) | |
| tree | [8cc339316cfde4b3fba16784a44ebff573f44078](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a) | |
| parent | [1452db764c279f8b329f1b3b9469bd01d9e21afd](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1452db764c279f8b329f1b3b9469bd01d9e21afd) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a&id2=1452db764c279f8b329f1b3b9469bd01d9e21afd)) | |
| download | [linux-6fd99094de2b83d1d4c8457f2c83483b2828e75a.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-6fd99094de2b83d1d4c8457f2c83483b2828e75a.tar.gz) | |

ipv6: Don't reduce hop limit for an interfaceA local route may have a lower hop\_limit set than global routes do.
RFC 3756, Section 4.2.7, "Parameter Spoofing"
> 1. The attacker includes a Current Hop Limit of one or another small
> number which the attacker knows will cause legitimate packets to
> be dropped before they reach their destination.
> As an example, one possible approach to mitigate this threat is to
> ignore very small hop limits. The nodes could implement a
> configurable minimum hop limit, and ignore attempts to set it below
> said limit.
Signed-off-by: D.S. Ljungmark <ljungmark@modio.se>
Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a)

| -rw-r--r-- | [net/ipv6/ndisc.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/ipv6/ndisc.c?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 1 deletions

| diff --git a/net/ipv6/ndisc.c b/net/ipv6/ndisc.cindex 471ed24aabaec4..14ecdaf06bf749 100644--- a/[net/ipv6/ndisc.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/ipv6/ndisc.c?id=1452db764c279f8b329f1b3b9469bd01d9e21afd)+++ b/[net/ipv6/ndisc.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/ipv6/ndisc.c?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a)@@ -1218,7 +1218,14 @@ static void ndisc\_router\_discovery(struct sk\_buff \*skb) if (rt) rt6\_set\_expires(rt, jiffies + (HZ \* lifetime)); if (ra\_msg->icmph.icmp6\_hop\_limit) {- in6\_dev->cnf.hop\_limit = ra\_msg->icmph.icmp6\_hop\_limit;+ /\* Only set hop\_limit on the interface if it is higher than+ \* the current hop\_limit.+ \*/+ if (in6\_dev->cnf.hop\_limit < ra\_msg->icmph.icmp6\_hop\_limit) {+ in6\_dev->cnf.hop\_limit = ra\_msg->icmph.icmp6\_hop\_limit;+ } else {+ ND\_PRINTK(2, warn, "RA: Got route advertisement with lower hop\_limit than current\n");+ } if (rt) dst\_metric\_set(&rt->dst, RTAX\_HOPLIMIT, ra\_msg->icmph.icmp6\_hop\_limit); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-24 13:18:40 +0000



=== Content from lists.freebsd.org_c47d8552_20250124_132003.html ===

# [oss-security] CVE Request : IPv6 Hop limit lowering via RA messages

**Loganaden Velvindron**
loganaden at gmail.com

*Fri Apr 3 09:57:04 UTC 2015*

* Previous message (by thread): [[oss-security] CVE Request : IPv6 Hop limit lowering via RA messages](041933.html)
* Next message (by thread): [Programmatically Creating VLAN in the Kernel](041937.html)
* **Messages sorted by:**
  [[ date ]](date.html#41934)
  [[ thread ]](thread.html#41934)
  [[ subject ]](subject.html#41934)
  [[ author ]](author.html#41934)

---

```
On Fri, Apr 3, 2015 at 1:54 PM, D.S. Ljungmark <[ljungmark at modio.se](http://lists.freebsd.org/mailman/listinfo/freebsd-net)> wrote:
> On Fri, Apr 3, 2015 at 6:06 AM, Jim Thompson <[jim at netgate.com](http://lists.freebsd.org/mailman/listinfo/freebsd-net)> wrote:
>> have you considered that there might not be a relevant patch because FreeBSD’s implementation isn’t affected?
>
> sys/netinet6/nd6_rtr.c
>
>     300         if (nd_ra->nd_ra_curhoplimit)
>     301                 ndi->chlim = nd_ra->nd_ra_curhoplimit;
>
> The only "OUT" in that function I see are tests for:
>   Not accepting RA
>   hoplimit on current packet != 255
>   not link-local
>   No extended ipv6 header

It is vulnerable. Harrison Grundy and I worked on a patch, and sent it
to [secteam at .](http://lists.freebsd.org/mailman/listinfo/freebsd-net)

>
>
> Based on previous testing ( early March 2015), and reading of the
> source, I say that FreeBSD is vulnerable.
>
>
> Regards,
>   D.S. Ljungmark
>
>
>>
>> Jim
>>
>>> On Apr 2, 2015, at 9:15 PM, Eitan Adler <[lists at eitanadler.com](http://lists.freebsd.org/mailman/listinfo/freebsd-net)> wrote:
>>>
>>> + FreeBSD lists since I haven't seen any relevant patches (although I
>>> might have missed them).
>>>
>>> ---------- Forwarded message ----------
>>> From: D.S. Ljungmark <[ljungmark at modio.se](http://lists.freebsd.org/mailman/listinfo/freebsd-net)>
>>> Date: 2 April 2015 at 10:19
>>> Subject: [oss-security] CVE Request : IPv6 Hop limit lowering via RA messages
>>> To: [oss-security at lists.openwall.com](http://lists.freebsd.org/mailman/listinfo/freebsd-net)
>>>
>>>
>>> An unprivileged user on a local network can use IPv6 Neighbour
>>> Discovery ICMP to broadcast a non-route with a low hop limit, this
>>> causing machines to lower the hop limit on existing IPv6 routes.
>>>
>>> Linux Patch: <http://www.spinics.net/lists/netdev/msg322361.html>
>>> Redhat bugzilla: <https://bugzilla.redhat.com/show_bug.cgi?id=1203712>
>>>
>>> Projects impacted:  Linux kernel,  NetworkManager, FreeBSD Kernel
>>>
>>>
>>> Regards,
>>>  D.S. Ljungmark
>>>
>>>
>>> --
>>> Eitan Adler
>>> _______________________________________________
>>> [freebsd-net at freebsd.org](http://lists.freebsd.org/mailman/listinfo/freebsd-net) mailing list
>>> <http://lists.freebsd.org/mailman/listinfo/freebsd-net>
>>> To unsubscribe, send any mail to "[freebsd-net-unsubscribe at freebsd.org](http://lists.freebsd.org/mailman/listinfo/freebsd-net)"
>>

--
This message is strictly personal and the opinions expressed do not
represent those of my employers, either past or present.

```

---

* Previous message (by thread): [[oss-security] CVE Request : IPv6 Hop limit lowering via RA messages](041933.html)
* Next message (by thread): [Programmatically Creating VLAN in the Kernel](041937.html)
* **Messages sorted by:**
  [[ date ]](date.html#41934)
  [[ thread ]](thread.html#41934)
  [[ subject ]](subject.html#41934)
  [[ author ]](author.html#41934)

---

[More information about the freebsd-net
mailing list](http://lists.freebsd.org/mailman/listinfo/freebsd-net)



=== Content from openwall.com_d7f55716_20250124_132002.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2015/04/03/6) [[thread-next>]](../../../2015/04/07/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150404072749.B0AF66C0033@smtpvmsrv1.mitre.org>
Date: Sat,  4 Apr 2015 03:27:49 -0400 (EDT)
From: cve-assign@...re.org
To: ljungmark@...io.se
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request : IPv6 Hop limit lowering via RA messages

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> An unprivileged user on a local network can use IPv6 Neighbour
> Discovery ICMP to broadcast a non-route with a low hop limit, this
> causing machines to lower the hop limit on existing IPv6 routes.

> Projects impacted:  Linux kernel,  NetworkManager, FreeBSD Kernel

> <https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6fd99094de2b83d1d4c8457f2c83483b2828e75a>

Use CVE-2015-2922 for the Linux kernel vulnerability.

> <https://lists.freebsd.org/pipermail/freebsd-net/2015-April/041934.html>

Use CVE-2015-2923 for the FreeBSD vulnerability.

> ,  NetworkManager

This might refer to
<http://cgit.freedesktop.org/NetworkManager/NetworkManager/tree/src/rdisc/nm-lndp-rdisc.c>

  hop_limit = ndp_msgra_curhoplimit (msgra);
  if (rdisc->hop_limit != hop_limit) {
          rdisc->hop_limit = hop_limit;
          changed |= NM_RDISC_CONFIG_HOP_LIMIT;

however, the MITRE CVE team is not directly familiar with this part of
the NetworkManager code and has not researched any changes to the
"rdisc->hop_limit != hop_limit" test. There is apparently no commit
available yet at:

  <http://cgit.freedesktop.org/NetworkManager/NetworkManager/log/src/rdisc/nm-lndp-rdisc.c>

but, again, we don't know whether changes would need to occur there.

Use CVE-2015-2924 for the NetworkManager vulnerability.

Also, note that

  <http://patchwork.ozlabs.org/patch/453995/>

refers to affected closed-source products. (CVE IDs for closed-source
products would be announced elsewhere.) It also refers to Android. We
don't know whether Android was listed only because of a
shared-codebase issue, e.g.,

  [https://android.googlesource.com/kernel/common/+/android-3.18/net/ipv6/ndisc.c](https://android.googlesource.com/kernel/common/%2B/android-3.18/net/ipv6/ndisc.c)

(there is no commit at
[https://android.googlesource.com/kernel/common/+log/android-3.18/net/ipv6/ndisc.c](https://android.googlesource.com/kernel/common/%2Blog/android-3.18/net/ipv6/ndisc.c)
currently)

or whether Android is affected in other ways. Unless there is
incorrect hop_limit processing in code that is specific to Android,
Android would not have a unique CVE ID.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVH5GoAAoJEKllVAevmvmsL4EH/3oXUCv+ibZ7VXqeLpvkcmeq
R6dPpU6QJVLvirY/2Huoq0eLlSm9l6Tg9Z0h8WoWJpa8nQjrEthXc0XnWh6l4aoW
GzcRAJLjh21WZGTF4euTVMTSyR+ftw2jNp5WkfiI4BxCvikyDlrktj1qYVgsB7AK
3Svrv9jUDDjQX8Xd2gAqCEcSiRe9OO+JWErRD9ZyKSia9KcgFmmw3XQgUgefz6Ra
oKWuc0nZbYKq80JwIiiX8ThRyETuoNOtT4w7JdRVJfhFlUml8+FNh1hFiz52GsBF
iOOninmlM0i1EZw2v8JV/V+ihHB071YbT3K7xdoOu65CZymDy5qq+fc2ok5IOFY=
=qiwd
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


