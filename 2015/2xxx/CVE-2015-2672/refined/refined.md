```
Root cause of vulnerability:
The xsave/xrstor (and their alternative instructions) were not properly protected against faults in kernel space. The `xstate_fault` macro was using a label in the `.altinstr_replacement` section instead of the corresponding instruction in the `.text` section. This meant that when a fault occurred, the kernel couldn't find the proper entry in the `__ex_table` and would lead to a crash instead of handling the fault.

Weaknesses/vulnerabilities present:
- Improper exception handling: The exception table was not correctly populated for faulting `xsave/xrstor` instructions.
- The use of `altinstr_replacement` for exception handling was incorrect and resulted in ineffective protection.
- Lack of proper protection against faults on `xsave/xrstor` instructions when used in the kernel

Impact of exploitation:
- Kernel crash: If a user-space process could trigger a fault on an `xsave/xrstor` instruction, it would result in an unhandled exception in the kernel and a kernel crash, leading to a denial of service.
- Unprivileged users can cause a denial of service.

Attack vectors:
- Triggering a fault on an xsave/xrstor instruction.

Required attacker capabilities/position:
- The attacker needs to be able to trigger a fault on an `xsave/xrstor` instruction, typically by providing invalid memory operands.
- Requires the capability to execute code that could lead to a fault in kernel space.
```