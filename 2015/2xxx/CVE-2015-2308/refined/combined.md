=== Content from symfony.com_7b9c114e_20250126_063117.html ===

[Skip to content](#main-content)

Close

* About
  + [What is Symfony?](/what-is-symfony)
  + [Community](/community)
  + [News](/blog/)
  + [Contributing](/doc/current/contributing/index.html)
  + [Support](/support)
* Documentation
  + [Symfony Docs](/doc/current/index.html)
  + [Symfony Book](/book)
  + [Screencasts](https://symfonycasts.com)
  + [Symfony Bundles](/bundles)
  + [Symfony Cloud](/doc/cloud/)
  + [Training](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_submenu&utm_campaign=permanent_referral)
* Services
  + [Platform.sh for Symfony](/cloud/)
    Best platform to deploy Symfony apps
  + [SymfonyInsight](https://insight.symfony.com)
    Automatic quality checks for your apps
  + [Symfony Certification](https://certification.symfony.com)
    Prove your knowledge and boost your career
  + [SensioLabs](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_submenu&utm_campaign=permanent_referral)
    Professional services to help you with Symfony
  + [Blackfire](https://www.blackfire.io/?utm_source=symfony&utm_medium=symfonycom_footer&utm_campaign=profiler)
    Profile and monitor performance of your apps
* Other
* [Blog](/blog/)
* [Download](/download)

sponsored by

1. [Home](https://symfony.com/)
2. [Blog](/blog/)
3. CVE-2015-2308: Esi Code Injection

# CVE-2015-2308: Esi Code Injection

April 1, 2015

â€¢
Published by
[![Avatar of Fabien Potencier](https://connect.symfony.com/api/images/4aed4f5d-e0cb-4320-902f-885fddaa7d15.png?format=28x28)](https://connect.symfony.com/api/alternates/4aed4f5d-e0cb-4320-902f-885fddaa7d15)
[Fabien Potencier](https://connect.symfony.com/api/alternates/4aed4f5d-e0cb-4320-902f-885fddaa7d15)

## [Affected Versions](#affected-versions "Permalink to this headline")

All 2.0.X, 2.1.X, 2.2.X, 2.3.X, 2.4.X, 2.5.X, and 2.6.X versions of the Symfony HttpKernel component are affected by this security issue.

This issue has been fixed in Symfony 2.3.27, 2.5.11, and 2.6.6. Note that no fixes are provided for Symfony 2.0, 2.1, 2.2, and 2.4 as they are not maintained anymore.

## [Description](#description "Permalink to this headline")

Applications with ESI support (and SSI support as of Symfony 2.6) enabled and
using the Symfony built-in reverse proxy (the
``Symfony\Component\HttpKernel\HttpCache` class) are vulnerable to PHP code injection; a malicious user can inject PHP code that will be executed by the server.

`HttpCache` uses `eval()` to execute files in its cache when they contain ESI tags (and only when ESI is enabled). The vulnerability comes from the fact that PHP allows contents of `<script language="php">` tags to be executed (and this kind of PHP tags is always available [regardless of the configuration](http://php.net/manual/en/language.basic-syntax.phpmode.php)), but there were not escaped before the evaluation.

A possible exploit comes from websites also vulnerable to Cross-Site Scripting as an attacker can successfully conduct a PHP code injection attack by passing such a tag in a user submitted variable (for which proper output escaping was not applied).

## [Resolution](#resolution "Permalink to this headline")

The fix implements a much stricter escaping on user submitted values to remove the possibility to inject PHP code.

The patch for this issue is available [here](https://github.com/symfony/symfony/pull/14167).

## [Credits](#credits "Permalink to this headline")

I would like to thank Takeshi Terada of Mitsui Bussan Secure Directions, Inc. for reporting this security issue and Nicolas Grekas of [Blackfire.io](https://blackfire.io/) for providing a fix.

[Log in](/connect/login?target=https://symfony.com/blog/cve-2015-2308-esi-code-injection) to add a reaction to this post

add a reaction â¤ï¸ ðŸ‘ ðŸš€

Published in
[#Security Advisories](/blog/category/security-advisories)

Have found a security issue in Symfony? Send the details to
**security [at] symfony.com** and don't
disclose it publicly until we can provide a fix for it.

[Manage your notification preferences](/account/notifications)
to receive an email as soon as a Symfony security release is published.

**Help the Symfony project!**

As with any Open-Source project, [contributing](/doc/current/contributing.html)
code or documentation is the most common way to help, but we also have a wide range of
[sponsoring opportunities](/sponsor).

## [Comments](#comments "Permanent link to this headline")

[![Avatar of Patrik Karisch](https://connect.symfony.com/api/images/d880aaff-85e6-4f23-90bf-80339940996b.png?format=48x48)](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)

[Patrik Karisch](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)
said on Apr 1, 2015
at 19:49

[#1](/blog/cve-2015-2308-esi-code-injection#comment-19644 "Permalink to this comment")

The affected versions in the vulnerabilities seems wrong. It states

[>=2.0.0, <2.1.0] [>=2.1.0, <2.2.0] [>=2.2.0, <2.3.0] [>=2.3.0, <2.3.19] [>=2.4.0, <2.4.9] [>=2.5.0, <2.5.4]

but this would allow for insecure version, if you say all versions are affected.

I think it should be

[>=2.0.0, <2.1.0] [>=2.1.0, <2.2.0] [>=2.2.0, <2.3.0] [>=2.3.0, <2.3.27] [>=2.4.0, <2.4.0] [>=2.5.0, <2.5.11] [>=2.6.0, <2.6.6]

[![Avatar of Patrik Karisch](https://connect.symfony.com/api/images/d880aaff-85e6-4f23-90bf-80339940996b.png?format=48x48)](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)

[Patrik Karisch](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)
said on Apr 1, 2015
at 19:49

[#2](/blog/cve-2015-2308-esi-code-injection#comment-19645 "Permalink to this comment")

Sorry, meant

[>=2.0.0, <2.1.0] [>=2.1.0, <2.2.0] [>=2.2.0, <2.3.0] [>=2.3.0, <2.3.27] [>=2.4.0, <2.5.0] [>=2.5.0, <2.5.11] [>=2.6.0, <2.6.6]

[![Avatar of Patrik Karisch](https://connect.symfony.com/api/images/d880aaff-85e6-4f23-90bf-80339940996b.png?format=48x48)](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)

[Patrik Karisch](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)
said on Apr 1, 2015
at 19:51

[#3](/blog/cve-2015-2308-esi-code-injection#comment-19646 "Permalink to this comment")

Oh damn, I should read better. I saw only ESI in the one, but it was a ESI vulnerability from last year. Shame on me :O!

[![Avatar of Ghost](https://connect.symfony.com/api/images/6d0e0568-d191-4f5a-a5d5-21b1920dd99a.png?format=48x48)](https://connect.symfony.com/api/alternates/6d0e0568-d191-4f5a-a5d5-21b1920dd99a)

[Ghost](https://connect.symfony.com/api/alternates/6d0e0568-d191-4f5a-a5d5-21b1920dd99a)
said on Apr 1, 2015
at 21:04

[#4](/blog/cve-2015-2308-esi-code-injection#comment-19647 "Permalink to this comment")

it would be nice to add this to the security advisory database so it's catched by the security scanner
(looks like a pull request is there - <https://github.com/xabbuh/security-advisories/commit/61935bd2f125e54c3907a40f91b2bc7f4fe9e7d6>)

[![Avatar of Julien Nicolas](https://connect.symfony.com/api/images/3936df55-346c-4e8e-8d06-d2dbb8926029.png?format=48x48)](https://connect.symfony.com/api/alternates/3936df55-346c-4e8e-8d06-d2dbb8926029)

[Julien Nicolas](https://connect.symfony.com/api/alternates/3936df55-346c-4e8e-8d06-d2dbb8926029)
said on Apr 6, 2015
at 20:55

[#5](/blog/cve-2015-2308-esi-code-injection#comment-19654 "Permalink to this comment")

This is huge ! I didn't know the

Comments are closed.

To ensure that comments stay relevant, they are closed for old posts.

* [All Blog Posts](/blog/)
* [A Week of Symfony](/blog/category/a-week-of-symfony)
* [Case Studies](/blog/category/case-studies)
* [Cloud](/blog/category/cloud)
* [Community](/blog/category/community)
* [Conferences](/blog/category/conferences)
* [Diversity](/blog/category/diversity)
* [Living on the edge](/blog/category/living-on-the-edge)
* [Releases](/blog/category/releases)
* [Security Advisories](/blog/category/security-advisories)
* [Symfony Insight](/blog/category/symfony-insight)
* [Twig](/blog/category/twig)
* [SensioLabs Blog](https://sensiolabs.com/blog?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)

[Archives](/blog/archives/2025/1)

[Blog Posts RSS](https://feeds.feedburner.com/symfony/blog "Symfony Blog RSS feed")

[Blog Comments RSS](https://feeds.feedburner.com/symfony/blog/comments "RSS Feed for Symfony Blog comments")

[![Show your Sylius expertise](/images/network/sy1certif_02.webp)](https://certification.symfony.com/exams/sylius.html?utm_source=ad&utm_medium=banner&utm_campaign=certification&utm_content=syliusexpertise)

[Show your Sylius expertise](https://certification.symfony.com/exams/sylius.html?utm_source=ad&utm_medium=banner&utm_campaign=certification&utm_content=syliusexpertise)

[![Be trained by SensioLabs experts (2 to 6 day sessions -- French or English).](/images/network/sltraining_01.webp)](https://training.sensiolabs.com/en/courses?q=symfony)

[Be trained by SensioLabs experts (2 to 6 day sessions -- French or English).](https://training.sensiolabs.com/en/courses?q=symfony)

[![No stress: we've got you covered with our 116 automated quality checks of your code](/images/network/sfinsight_01.png)](https://insight.symfony.com/?utm_source=ad&utm_medium=banner&utm_campaign=insight&utm_content=stress)

[No stress: we've got you covered with our 116 automated quality checks of your code](https://insight.symfony.com/?utm_source=ad&utm_medium=banner&utm_campaign=insight&utm_content=stress)

## Symfony footer

![Avatar of Julien Bonnier, a Symfony contributor](https://connect.symfony.com/api/images/fdf65747-48ca-4d77-9d52-a53696322c58.png?format=48x48)

Thanks
**[Julien Bonnier](https://connect.symfony.com/profile/jbonnier)**
(**@jbonnier**)
for being a Symfony contributor

[**1** commit](https://github.com/jbonnier)
â€¢
**6** lines changed

[View all contributors](/contributors) that help us make Symfony

### Become a Symfony contributor

Be an active part of the community and contribute ideas, code and bug fixes.
Both experts and newcomers are welcome.

[Learn how to contribute](/doc/current/contributing/index.html)

**Symfony**â„¢ is a trademark of Symfony SAS. [All rights reserved](/trademark).

* [What is Symfony?](/what-is-symfony)

  + [What is Symfony?](/what-is-symfony)
  + [Symfony at a Glance](/at-a-glance)
  + [Symfony Components](/components)
  + [Symfony Releases](/releases)
  + [Security Policy](/doc/current/contributing/code/security.html)
  + [Logo & Screenshots](/logo)
  + [Trademark & Licenses](/license)
  + [symfony1 Legacy](/legacy)
* [Learn Symfony](/doc/current/index.html)

  + [Symfony Docs](/doc/current/index.html)
  + [Symfony Book](/book)
  + [Reference](/doc/current/reference/index.html)
  + [Bundles](/bundles)
  + [Best Practices](/doc/current/best_practices.html)
  + [Training](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [eLearning Platform](https://university.sensiolabs.com/e-learning-platform?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Certification](https://certification.symfony.com/)
* [Screencasts](https://symfonycasts.com/)

  + [Learn Symfony](https://symfonycasts.com/tracks/symfony)
  + [Learn PHP](https://symfonycasts.com/tracks/php)
  + [Learn JavaScript](https://symfonycasts.com/tracks/javascript)
  + [Learn Drupal](https://symfonycasts.com/tracks/drupal)
  + [Learn RESTful APIs](https://symfonycasts.com/tracks/rest)
* [Community](/community)

  + [Symfony Community](/community)
  + [SymfonyConnect](https://connect.symfony.com/)
  + [Events & Meetups](/events/)
  + [Projects using Symfony](/projects)
  + [Contributors](/contributors)
  + [Symfony Jobs](/jobs)
  + [Backers](/backers)
  + [Code of Conduct](/doc/current/contributing/code_of_conduct/code_of_conduct.html)
  + [Downloads Stats](/stats/downloads)
  + [Support](/support)
* [Blog](/blog/)

  + [All Blog Posts](/blog/)
  + [A Week of Symfony](/blog/category/a-week-of-symfony)
  + [Case Studies](/blog/category/case-studies)
  + [Cloud](/blog/category/cloud)
  + [Community](/blog/category/community)
  + [Conferences](/blog/category/conferences)
  + [Diversity](/blog/category/diversity)
  + [Living on the edge](/blog/category/living-on-the-edge)
  + [Releases](/blog/category/releases)
  + [Security Advisories](/blog/category/security-advisories)
  + [Symfony Insight](/blog/category/symfony-insight)
  + [Twig](/blog/category/twig)
  + [SensioLabs Blog](https://sensiolabs.com/blog?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
* [Services](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)

  + [SensioLabs services](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Train developers](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Manage your project quality](https://insight.symfony.com/)
  + [Improve your project performance](https://www.blackfire.io/?utm_source=symfony&utm_medium=symfonycom_footer&utm_campaign=profiler)
  + [Host Symfony projects](/cloud/)

  [Powered by](/cloud/)

### Follow Symfony

Site appearance:

Light mode
Dark mode
Sync with system

CLOSE
Search Symfony Docs

Search



=== Content from jvndb.jvn.jp_264fe45a_20250125_055926.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2015/06/25

| [[Japanese]](/ja/contents/2015/JVNDB-2015-000089.html) | |
| --- | --- |
| JVNDB-2015-000089 | |
| Symfony vulnerable to code injection | |
| Overview | |
| Symfony is an open source web application framework provided by SensioLabs. Symfony contains a code injection vulnerability. Applications with ESI support enabled and using the Symfony built-in reverse proxy (the HttpCache class) are affected. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V2 Severity:Base Metrics [6.8](/cvss/en/v2.html#AV:N/AC:M/Au:N/C:P/I:P/A:P) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Medium * Authentication: None * Confidentiality Impact: Partial * Integrity Impact: Partial * Availability Impact: Partial | |
| Affected Products | |
|  | |
| Sensio Labs  * Symfony 2.0.x, 2.1.x, 2.2.x, 2.3.x, 2.4.x, 2.5.x, 2.6.x | |
|  | |
| Impact | |
| Arbitrary PHP code may be executed on the server where an application using Symfony resides. | |
| Solution | |
| [Update the software] | |
| Vendor Information | |
| Sensio Labs  * Sensio Labs : [CVE-2015-2308: Esi Code Injection](https://symfony.com/blog/cve-2015-2308-esi-code-injection) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [CodeÂ Injection](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE94)(CWE-94) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2015-2308](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2308) | |
| References | |
| 1. JVN : [JVN#19578958](http://jvn.jp/en/jp/JVN19578958/index.html) 2. National Vulnerability Database (NVD) : [CVE-2015-2308](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-2308) 3. IPA SECURITY ALERTS : [Security Alert for Vulnerability in Symfony (JVN#19578958)](http://www.ipa.go.jp/security/ciadr/vul/20150623-jvn.html) (in Japanese) | |
| Revision History | |
| * [2015/06/23] | |

| --- | |
| --- | --- |
| Date Public | 2015/06/23 |
| Date First Published | 2015/06/23 |
| Date Last Updated | 2015/06/25 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright Â© 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from symfony.com_7b9c114e_20250125_055927.html ===

[Skip to content](#main-content)

Close

* About
  + [What is Symfony?](/what-is-symfony)
  + [Community](/community)
  + [News](/blog/)
  + [Contributing](/doc/current/contributing/index.html)
  + [Support](/support)
* Documentation
  + [Symfony Docs](/doc/current/index.html)
  + [Symfony Book](/book)
  + [Screencasts](https://symfonycasts.com)
  + [Symfony Bundles](/bundles)
  + [Symfony Cloud](/doc/cloud/)
  + [Training](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_submenu&utm_campaign=permanent_referral)
* Services
  + [Platform.sh for Symfony](/cloud/)
    Best platform to deploy Symfony apps
  + [SymfonyInsight](https://insight.symfony.com)
    Automatic quality checks for your apps
  + [Symfony Certification](https://certification.symfony.com)
    Prove your knowledge and boost your career
  + [SensioLabs](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_submenu&utm_campaign=permanent_referral)
    Professional services to help you with Symfony
  + [Blackfire](https://www.blackfire.io/?utm_source=symfony&utm_medium=symfonycom_footer&utm_campaign=profiler)
    Profile and monitor performance of your apps
* Other
* [Blog](/blog/)
* [Download](/download)

sponsored by

1. [Home](https://symfony.com/)
2. [Blog](/blog/)
3. CVE-2015-2308: Esi Code Injection

# CVE-2015-2308: Esi Code Injection

April 1, 2015

â€¢
Published by
[![Avatar of Fabien Potencier](https://connect.symfony.com/api/images/4aed4f5d-e0cb-4320-902f-885fddaa7d15.png?format=28x28)](https://connect.symfony.com/api/alternates/4aed4f5d-e0cb-4320-902f-885fddaa7d15)
[Fabien Potencier](https://connect.symfony.com/api/alternates/4aed4f5d-e0cb-4320-902f-885fddaa7d15)

## [Affected Versions](#affected-versions "Permalink to this headline")

All 2.0.X, 2.1.X, 2.2.X, 2.3.X, 2.4.X, 2.5.X, and 2.6.X versions of the Symfony HttpKernel component are affected by this security issue.

This issue has been fixed in Symfony 2.3.27, 2.5.11, and 2.6.6. Note that no fixes are provided for Symfony 2.0, 2.1, 2.2, and 2.4 as they are not maintained anymore.

## [Description](#description "Permalink to this headline")

Applications with ESI support (and SSI support as of Symfony 2.6) enabled and
using the Symfony built-in reverse proxy (the
``Symfony\Component\HttpKernel\HttpCache` class) are vulnerable to PHP code injection; a malicious user can inject PHP code that will be executed by the server.

`HttpCache` uses `eval()` to execute files in its cache when they contain ESI tags (and only when ESI is enabled). The vulnerability comes from the fact that PHP allows contents of `<script language="php">` tags to be executed (and this kind of PHP tags is always available [regardless of the configuration](http://php.net/manual/en/language.basic-syntax.phpmode.php)), but there were not escaped before the evaluation.

A possible exploit comes from websites also vulnerable to Cross-Site Scripting as an attacker can successfully conduct a PHP code injection attack by passing such a tag in a user submitted variable (for which proper output escaping was not applied).

## [Resolution](#resolution "Permalink to this headline")

The fix implements a much stricter escaping on user submitted values to remove the possibility to inject PHP code.

The patch for this issue is available [here](https://github.com/symfony/symfony/pull/14167).

## [Credits](#credits "Permalink to this headline")

I would like to thank Takeshi Terada of Mitsui Bussan Secure Directions, Inc. for reporting this security issue and Nicolas Grekas of [Blackfire.io](https://blackfire.io/) for providing a fix.

[Log in](/connect/login?target=https://symfony.com/blog/cve-2015-2308-esi-code-injection) to add a reaction to this post

add a reaction â¤ï¸ ðŸ‘ ðŸš€

Published in
[#Security Advisories](/blog/category/security-advisories)

Have found a security issue in Symfony? Send the details to
**security [at] symfony.com** and don't
disclose it publicly until we can provide a fix for it.

[Manage your notification preferences](/account/notifications)
to receive an email as soon as a Symfony security release is published.

**Help the Symfony project!**

As with any Open-Source project, [contributing](/doc/current/contributing.html)
code or documentation is the most common way to help, but we also have a wide range of
[sponsoring opportunities](/sponsor).

## [Comments](#comments "Permanent link to this headline")

[![Avatar of Patrik Karisch](https://connect.symfony.com/api/images/d880aaff-85e6-4f23-90bf-80339940996b.png?format=48x48)](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)

[Patrik Karisch](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)
said on Apr 1, 2015
at 19:49

[#1](/blog/cve-2015-2308-esi-code-injection#comment-19644 "Permalink to this comment")

The affected versions in the vulnerabilities seems wrong. It states

[>=2.0.0, <2.1.0] [>=2.1.0, <2.2.0] [>=2.2.0, <2.3.0] [>=2.3.0, <2.3.19] [>=2.4.0, <2.4.9] [>=2.5.0, <2.5.4]

but this would allow for insecure version, if you say all versions are affected.

I think it should be

[>=2.0.0, <2.1.0] [>=2.1.0, <2.2.0] [>=2.2.0, <2.3.0] [>=2.3.0, <2.3.27] [>=2.4.0, <2.4.0] [>=2.5.0, <2.5.11] [>=2.6.0, <2.6.6]

[![Avatar of Patrik Karisch](https://connect.symfony.com/api/images/d880aaff-85e6-4f23-90bf-80339940996b.png?format=48x48)](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)

[Patrik Karisch](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)
said on Apr 1, 2015
at 19:49

[#2](/blog/cve-2015-2308-esi-code-injection#comment-19645 "Permalink to this comment")

Sorry, meant

[>=2.0.0, <2.1.0] [>=2.1.0, <2.2.0] [>=2.2.0, <2.3.0] [>=2.3.0, <2.3.27] [>=2.4.0, <2.5.0] [>=2.5.0, <2.5.11] [>=2.6.0, <2.6.6]

[![Avatar of Patrik Karisch](https://connect.symfony.com/api/images/d880aaff-85e6-4f23-90bf-80339940996b.png?format=48x48)](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)

[Patrik Karisch](https://connect.symfony.com/api/alternates/d880aaff-85e6-4f23-90bf-80339940996b)
said on Apr 1, 2015
at 19:51

[#3](/blog/cve-2015-2308-esi-code-injection#comment-19646 "Permalink to this comment")

Oh damn, I should read better. I saw only ESI in the one, but it was a ESI vulnerability from last year. Shame on me :O!

[![Avatar of Ghost](https://connect.symfony.com/api/images/6d0e0568-d191-4f5a-a5d5-21b1920dd99a.png?format=48x48)](https://connect.symfony.com/api/alternates/6d0e0568-d191-4f5a-a5d5-21b1920dd99a)

[Ghost](https://connect.symfony.com/api/alternates/6d0e0568-d191-4f5a-a5d5-21b1920dd99a)
said on Apr 1, 2015
at 21:04

[#4](/blog/cve-2015-2308-esi-code-injection#comment-19647 "Permalink to this comment")

it would be nice to add this to the security advisory database so it's catched by the security scanner
(looks like a pull request is there - <https://github.com/xabbuh/security-advisories/commit/61935bd2f125e54c3907a40f91b2bc7f4fe9e7d6>)

[![Avatar of Julien Nicolas](https://connect.symfony.com/api/images/3936df55-346c-4e8e-8d06-d2dbb8926029.png?format=48x48)](https://connect.symfony.com/api/alternates/3936df55-346c-4e8e-8d06-d2dbb8926029)

[Julien Nicolas](https://connect.symfony.com/api/alternates/3936df55-346c-4e8e-8d06-d2dbb8926029)
said on Apr 6, 2015
at 20:55

[#5](/blog/cve-2015-2308-esi-code-injection#comment-19654 "Permalink to this comment")

This is huge ! I didn't know the

Comments are closed.

To ensure that comments stay relevant, they are closed for old posts.

* [All Blog Posts](/blog/)
* [A Week of Symfony](/blog/category/a-week-of-symfony)
* [Case Studies](/blog/category/case-studies)
* [Cloud](/blog/category/cloud)
* [Community](/blog/category/community)
* [Conferences](/blog/category/conferences)
* [Diversity](/blog/category/diversity)
* [Living on the edge](/blog/category/living-on-the-edge)
* [Releases](/blog/category/releases)
* [Security Advisories](/blog/category/security-advisories)
* [Symfony Insight](/blog/category/symfony-insight)
* [Twig](/blog/category/twig)
* [SensioLabs Blog](https://sensiolabs.com/blog?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)

[Archives](/blog/archives/2025/1)

[Blog Posts RSS](https://feeds.feedburner.com/symfony/blog "Symfony Blog RSS feed")

[Blog Comments RSS](https://feeds.feedburner.com/symfony/blog/comments "RSS Feed for Symfony Blog comments")

[![Take the exam at home](/images/network/sf7certif_01.webp)](https://certification.symfony.com/?utm_source=ad&utm_medium=banner&utm_campaign=certification&utm_content=examhome)

[Take the exam at home](https://certification.symfony.com/?utm_source=ad&utm_medium=banner&utm_campaign=certification&utm_content=examhome)

[![Peruse our complete Symfony & PHP solutions catalog for your web development needs.](/images/network/slsolutions_01.webp)](https://sensiolabs.com/services?utm_source=symfony&utm_medium=ad_visual&utm_campaign=permanent_referral)

[Peruse our complete Symfony & PHP solutions catalog for your web development needs.](https://sensiolabs.com/services?utm_source=symfony&utm_medium=ad_visual&utm_campaign=permanent_referral)

[![Save your teams and projects before they sink](/images/network/sfinsight_02.png)](https://insight.symfony.com/?utm_source=ad&utm_medium=banner&utm_campaign=insight&utm_content=sink)

[Save your teams and projects before they sink](https://insight.symfony.com/?utm_source=ad&utm_medium=banner&utm_campaign=insight&utm_content=sink)

## Symfony footer

![Avatar of Ali Zahedi, a Symfony contributor](https://connect.symfony.com/api/images/371aa9b4-c81a-4f6a-9c18-acdf0fe10fd0.png?format=48x48)

Thanks
**[Ali Zahedi](https://connect.symfony.com/profile/aliz9271)**
(**@aliz9271**)
for being a Symfony contributor

**1** commit
â€¢
**4** lines changed

[View all contributors](/contributors) that help us make Symfony

### Become a Symfony contributor

Be an active part of the community and contribute ideas, code and bug fixes.
Both experts and newcomers are welcome.

[Learn how to contribute](/doc/current/contributing/index.html)

**Symfony**â„¢ is a trademark of Symfony SAS. [All rights reserved](/trademark).

* [What is Symfony?](/what-is-symfony)

  + [What is Symfony?](/what-is-symfony)
  + [Symfony at a Glance](/at-a-glance)
  + [Symfony Components](/components)
  + [Symfony Releases](/releases)
  + [Security Policy](/doc/current/contributing/code/security.html)
  + [Logo & Screenshots](/logo)
  + [Trademark & Licenses](/license)
  + [symfony1 Legacy](/legacy)
* [Learn Symfony](/doc/current/index.html)

  + [Symfony Docs](/doc/current/index.html)
  + [Symfony Book](/book)
  + [Reference](/doc/current/reference/index.html)
  + [Bundles](/bundles)
  + [Best Practices](/doc/current/best_practices.html)
  + [Training](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [eLearning Platform](https://university.sensiolabs.com/e-learning-platform?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Certification](https://certification.symfony.com/)
* [Screencasts](https://symfonycasts.com/)

  + [Learn Symfony](https://symfonycasts.com/tracks/symfony)
  + [Learn PHP](https://symfonycasts.com/tracks/php)
  + [Learn JavaScript](https://symfonycasts.com/tracks/javascript)
  + [Learn Drupal](https://symfonycasts.com/tracks/drupal)
  + [Learn RESTful APIs](https://symfonycasts.com/tracks/rest)
* [Community](/community)

  + [Symfony Community](/community)
  + [SymfonyConnect](https://connect.symfony.com/)
  + [Events & Meetups](/events/)
  + [Projects using Symfony](/projects)
  + [Contributors](/contributors)
  + [Symfony Jobs](/jobs)
  + [Backers](/backers)
  + [Code of Conduct](/doc/current/contributing/code_of_conduct/code_of_conduct.html)
  + [Downloads Stats](/stats/downloads)
  + [Support](/support)
* [Blog](/blog/)

  + [All Blog Posts](/blog/)
  + [A Week of Symfony](/blog/category/a-week-of-symfony)
  + [Case Studies](/blog/category/case-studies)
  + [Cloud](/blog/category/cloud)
  + [Community](/blog/category/community)
  + [Conferences](/blog/category/conferences)
  + [Diversity](/blog/category/diversity)
  + [Living on the edge](/blog/category/living-on-the-edge)
  + [Releases](/blog/category/releases)
  + [Security Advisories](/blog/category/security-advisories)
  + [Symfony Insight](/blog/category/symfony-insight)
  + [Twig](/blog/category/twig)
  + [SensioLabs Blog](https://sensiolabs.com/blog?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
* [Services](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)

  + [SensioLabs services](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Train developers](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Manage your project quality](https://insight.symfony.com/)
  + [Improve your project performance](https://www.blackfire.io/?utm_source=symfony&utm_medium=symfonycom_footer&utm_campaign=profiler)
  + [Host Symfony projects](/cloud/)

  [Powered by](/cloud/)

### Follow Symfony

Site appearance:

Light mode
Dark mode
Sync with system

CLOSE
Search Symfony Docs

Search



=== Content from symfony.com_cb1aa356_20250126_063117.html ===

[Skip to content](#main-content)

Close

* About
  + [What is Symfony?](/what-is-symfony)
  + [Community](/community)
  + [News](/blog/)
  + [Contributing](/doc/current/contributing/index.html)
  + [Support](/support)
* Documentation
  + [Symfony Docs](/doc/current/index.html)
  + [Symfony Book](/book)
  + [Screencasts](https://symfonycasts.com)
  + [Symfony Bundles](/bundles)
  + [Symfony Cloud](/doc/cloud/)
  + [Training](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_submenu&utm_campaign=permanent_referral)
* Services
  + [Platform.sh for Symfony](/cloud/)
    Best platform to deploy Symfony apps
  + [SymfonyInsight](https://insight.symfony.com)
    Automatic quality checks for your apps
  + [Symfony Certification](https://certification.symfony.com)
    Prove your knowledge and boost your career
  + [SensioLabs](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_submenu&utm_campaign=permanent_referral)
    Professional services to help you with Symfony
  + [Blackfire](https://www.blackfire.io/?utm_source=symfony&utm_medium=symfonycom_footer&utm_campaign=profiler)
    Profile and monitor performance of your apps
* Other
* [Blog](/blog/)
* [Download](/download)

sponsored by

New
[**Symfony Jobs**: find a new job or post your job for free to discover new talent](/jobs)

# [Symfony](#symfony "Permanent link to this headline")

## Symfony is a set of reusable PHP *components*...

The standard foundation on which the best PHP applications
are built. Choose any of the 50 stand-alone components
available for your own applications.

[Browse components](/components)

## ... and a PHP *framework* for web projects

Speed up the creation and maintenance of your PHP web
applications. End repetitive coding tasks and enjoy the
power of controlling your code.

[What is Symfony](/what-is-symfony)

### Getting Started with Symfony

* Read [the docs](/doc/current/setup.html)
* Read [the official book](/book) (translated into many languages)
* Watch [the video course](https://symfonycasts.com/tracks/symfony7)

## , the creator of Symfony, helps you solve every stage of your development project

### Start

* [Feasibility Study](https://sensiolabs.com/services/feasibility-study?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)
* [Agile Bootstrap Workshop](https://sensiolabs.com/services/agile-bootstrap-workshop?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)

### Design

* [Architecture Workshop](https://sensiolabs.com/services/architecture-workshop?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)
* [Migration Workshop](https://sensiolabs.com/services/migration-workshop?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)

### Build

* [Symfony Coaching](https://sensiolabs.com/services/symfony-coaching?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)
* [Code Auditing](https://sensiolabs.com/services/quality-performance-security-audits?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)

### Run

* [Version Upgrade](https://sensiolabs.com/services/version-upgrade?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)
* [Rescue Mission](https://sensiolabs.com/services/rescue-mission?utm_source=symfony&utm_medium=homepage_banner&utm_campaign=permanent_referral)

The best way to host your Symfony projects â€” powered by
[Platform.sh](https://platform.sh/marketplace/symfony/?utm_source=website&utm_medium=website&utm_campaign=symfonycloud_symfony)

[GET STARTED](/cloud/)

[Read the docs](/cloud/get-started)

### Training

* [Symfony Certification Coaching](https://training.sensiolabs.com/en/courses/SF7PRECERTIF-preparation-symfony-7-certification-online-sensiolabs-university?utm_source=symfony&utm_medium=symfony_homepage&utm_campaign=permanent_referral)
* [Symfony 7 Training Courses](https://training.sensiolabs.com/en/?utm_source=symfony&utm_medium=symfony_homepage&utm_campaign=permanent_referral)
* [SensioLabs University eLearning platform](https://university.sensiolabs.com/e-learning-platform?utm_source=symfony&utm_medium=symfony_homepage&utm_campaign=permanent_referral)

[View all sessions](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_homepage_allsessions&utm_campaign=permanent_referral "SensioLabs training sessions")

---

### Popular Screencasts

* [Design Patterns Episode 2](https://symfonycasts.com/screencast/design-patterns-2)
* [Cosmic Coding with Symfony 7](https://symfonycasts.com/screencast/symfony)
* [API Platform 3 Part 1: Mythically Good RESTful APIs](https://symfonycasts.com/screencast/api-platform)

[Subscribe](https://symfonycasts.com/signup/ "Subscribe to SymfonyCasts")

---

### Certifications

[![Symfony certifications logo](/images/home/logo-certification.svg)](https://certification.symfony.com/)

* [Symfony Certification](https://certification.symfony.com/exams/symfony.html)

  Exams available for all Symfony versions!
* [Twig Certification](https://certification.symfony.com/exams/twig.html)

  Created for designers with Twig experience.

[Register](https://certification.symfony.com/purchase.html "Register for the Symfony and Twig certifications")

## Symfony footer

![Avatar of Berat DoÄŸan, a Symfony contributor](https://www.gravatar.com/avatar/bad824a1ecf3056592e7e56535d3685d?size=48&rating=g&default=retro)

Thanks
**Berat DoÄŸan**
for being a Symfony contributor

**1** commit
â€¢
**31** lines changed

[View all contributors](/contributors) that help us make Symfony

### Become a Symfony contributor

Be an active part of the community and contribute ideas, code and bug fixes.
Both experts and newcomers are welcome.

[Learn how to contribute](/doc/current/contributing/index.html)

**Symfony**â„¢ is a trademark of Symfony SAS. [All rights reserved](/trademark).

* [What is Symfony?](/what-is-symfony)

  + [What is Symfony?](/what-is-symfony)
  + [Symfony at a Glance](/at-a-glance)
  + [Symfony Components](/components)
  + [Symfony Releases](/releases)
  + [Security Policy](/doc/current/contributing/code/security.html)
  + [Logo & Screenshots](/logo)
  + [Trademark & Licenses](/license)
  + [symfony1 Legacy](/legacy)
* [Learn Symfony](/doc/current/index.html)

  + [Symfony Docs](/doc/current/index.html)
  + [Symfony Book](/book)
  + [Reference](/doc/current/reference/index.html)
  + [Bundles](/bundles)
  + [Best Practices](/doc/current/best_practices.html)
  + [Training](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [eLearning Platform](https://university.sensiolabs.com/e-learning-platform?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Certification](https://certification.symfony.com/)
* [Screencasts](https://symfonycasts.com/)

  + [Learn Symfony](https://symfonycasts.com/tracks/symfony)
  + [Learn PHP](https://symfonycasts.com/tracks/php)
  + [Learn JavaScript](https://symfonycasts.com/tracks/javascript)
  + [Learn Drupal](https://symfonycasts.com/tracks/drupal)
  + [Learn RESTful APIs](https://symfonycasts.com/tracks/rest)
* [Community](/community)

  + [Symfony Community](/community)
  + [SymfonyConnect](https://connect.symfony.com/)
  + [Events & Meetups](/events/)
  + [Projects using Symfony](/projects)
  + [Contributors](/contributors)
  + [Symfony Jobs](/jobs)
  + [Backers](/backers)
  + [Code of Conduct](/doc/current/contributing/code_of_conduct/code_of_conduct.html)
  + [Downloads Stats](/stats/downloads)
  + [Support](/support)
* [Blog](/blog/)

  + [All Blog Posts](/blog/)
  + [A Week of Symfony](/blog/category/a-week-of-symfony)
  + [Case Studies](/blog/category/case-studies)
  + [Cloud](/blog/category/cloud)
  + [Community](/blog/category/community)
  + [Conferences](/blog/category/conferences)
  + [Diversity](/blog/category/diversity)
  + [Living on the edge](/blog/category/living-on-the-edge)
  + [Releases](/blog/category/releases)
  + [Security Advisories](/blog/category/security-advisories)
  + [Symfony Insight](/blog/category/symfony-insight)
  + [Twig](/blog/category/twig)
  + [SensioLabs Blog](https://sensiolabs.com/blog?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
* [Services](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)

  + [SensioLabs services](https://sensiolabs.com/?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Train developers](https://sensiolabs.com/training?utm_source=symfony&utm_medium=symfony_footer&utm_campaign=permanent_referral)
  + [Manage your project quality](https://insight.symfony.com/)
  + [Improve your project performance](https://www.blackfire.io/?utm_source=symfony&utm_medium=symfonycom_footer&utm_campaign=profiler)
  + [Host Symfony projects](/cloud/)

  [Powered by](/cloud/)

### Follow Symfony

Site appearance:

Light mode
Dark mode
Sync with system

CLOSE
Search Symfony Docs

Search



=== Content from jvn.jp_f373d1a8_20250125_055923.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2015/06/23Â Â Last Updated:2015/06/23
# JVN#19578958 Symfony vulnerable to code injection

## Overview

Symfony provided by SensioLabs contains a code injection vulnerability.

## Products Affected

* Symfony 2.0.x, 2.1.x, 2.2.x, 2.3.x, 2.4.x, 2.5.x, 2.6.x

## Description

Symfony is an open source web application framework provided by SensioLabs. Symfony contains a code injection vulnerability. Applications with ESI support enabled and using the Symfony built-in reverse proxy (the HttpCache class) are affected.

## Impact

Arbitrary PHP code may be executed on the server where an application using Symfony resides.

## Solution

**Update the software**

Update to the appropriate version according to the information provided by the developer.

This vulnerability has been addressed in Symfony 2.3.27, 2.5.11 and 2.6.6.

Note that Symfony 2.0, 2.1, 2.2 and 2.4 are no longer being developed or supported therefore this issue has not been fixed in these versions.

## Vendor Status

| Vendor | Link |
| --- | --- |
| SensioLabs | [CVE-2015-2308: Esi Code Injection](https://symfony.com/blog/cve-2015-2308-esi-code-injection) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

**Analyzed on 2015.06.23 (CVSS Base Metrics)**

[What is CVSS?](/en/nav/jvnhelp.html#cvssv2)

| Measures | Severity | | | Description |
| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) | A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access. Such a vulnerability is often termed "remotely exploitable". |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) | The access conditions are somewhat specialized. |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) | Authentication is not required to exploit the vulnerability. |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) | There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained. |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) | Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited. |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) | There is reduced performance or interruptions in resource availability. |

Base Score:6.8

## Credit

Takeshi Terada of Mitsui Bussan Secure Directions, Inc. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2015-2308](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2308) |
| JVN iPedia | [JVNDB-2015-000089](http://jvndb.jvn.jp/jvndb/JVNDB-2015-000089) |

* JVN
* HOME
* What is JVN ?
* Instructions
* List of Vulnerability Report
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* TRnotes
* JVN iPedia
* MyJVN
* JVNJS/RSS
* Vendor List
* List of unreachable developers
* Contact

Copyright (c) 2000-2015 JPCERT/CC and IPA. All rights reserved.


