=== Content from bugzilla.redhat.com_c004ee37_20250125_210612.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1252096)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1252096)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1252096)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1252096

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1252096**](show_bug.cgi?id=1252096)
(CVE-2015-2877)
- [CVE-2015-2877](https://access.redhat.com/security/cve/CVE-2015-2877) Kernel: Cross-VM ASL INtrospection (CAIN)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-2877 Kernel: Cross-VM ASL INtrospection (CAIN)

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-2877 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1251874](show_bug.cgi?id=1251874) | | TreeView+ | [depends on](buglist.cgi?bug_id=1252096&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1252096&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-08-10 17:20 UTC by Kurt Seifried | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 05:03 UTC ([History](show_activity.cgi?id=1252096)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  agordeev aquini carnil dhoward fhrbata joelsmith kernel-mgr kstutsma lwang mguzik nmurray pholasek plougher rvrbovsk vgoyal | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-08-10 17:48:31 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1252096#c0)  Kurt Seifried    2015-08-10 17:20:03 UTC  ``` Antonio Barresi reports:  We discovered a new attack vector against memory deduplication in Virtual Machine Monitors (VMM) where attackers can effectively leak randomized base addresses of libraries and executables in processes of neighboring Virtual Machines (VM).  The details are described in the security advisory below and in our WOOT'15 paper: <https://www.usenix.org/conference/woot15/workshop-program/presentation/barresi>  Several vendors were notified about this issue in the beginning of June. This issue has [CVE-2015-2877](https://access.redhat.com/security/cve/CVE-2015-2877) assigned.  An overview can also be found here: <http://www.antoniobarresi.com/security/cloud/2015/07/30/cain/>   ```  [Comment 1](show_bug.cgi?id=1252096#c1)  Kurt Seifried    2015-08-10 17:48:31 UTC  ``` There are four suggested workarounds for this issue. Please note that several have a potentially significant impact on system performance ans stability, and should be carefully tested prior to deployment:  VMM layer: Deactivation of memory deduplication Deactivating memory deduplication will effectively mitigate all attack vectors. This measure unfortunately eliminates all the highly appreciated benefits of memory deduplication, namely the increase of operational cost-effectiveness through inter-VM memory sharing.   Deactivating memory deduplication is the simplest way to prevent exploitation of this attack. However this will cause an increase in the amount of memory required and in some situations may adversely impact performance (e.g. due to slower swap space being used). It is recommended that customers test this workaround before using it in production.   VMM layer: Attack detection Instead of preventing the attack directly, the VMM can observe the guest VM and detect an ongoing attack based on memory creation and page fault behavior. We do not propose any specific heuristic but we suggest the concept of detecting the attack instead of preventing it.   Using cgroups to limit or warn when a large number of memory IO operations occur is possible in certain situations however setting the appropriate upper bounds will be dependant on each use case, as such it is recommended that administrators profile applications through all use cases before considering this workaround in order to limit the false positives that may be generated.   ASLR layer: Increase ASLR entropy One of the factors making the attack feasible is the limited entropy in RBAs. We suggest to further increase ASLR entropy to not only mitigate the attack described here, but to continue making ASLR more effective.   Unfortunately this solution would require a  significant number of changes to the Linux system (Kernel, GCC, userspace, etc.) and as such is unlikely to be implemented at this time.   Process layer: More entropy in sensitive memory pages The pages we use in the attack are good candidates because their entropy consists solely on the ASLR entropy i.e., we can reliably construct the page once a base address is known or guessed. Increasing entropy in these pages or making sure that no such pages exist can mitigate the issue.  Unfortunately this solution would require a  significant number of changes to the Linux system (Kernel, GCC, userspace, etc.) and as such is unlikely to be implemented at this time.   ```  [Comment 2](show_bug.cgi?id=1252096#c2)  Martin Prpič    2015-08-11 13:40:46 UTC  ``` External References:  <http://www.antoniobarresi.com/files/cain_advisory.txt>   ```  [Comment 3](show_bug.cgi?id=1252096#c3)  Kurt Seifried    2015-08-11 17:20:11 UTC  ``` Statement:  This issue affects the versions of the Linux Kernel as shipped with Red Hat Enterprise Linux 4, 5, 6 and 7. Red Hat Product Security has rated this issue as having Low security impact. Additionally a workaround is available. A future update may address this issue. For additional information, refer to the Issue Severity Classification: <https://access.redhat.com/security/updates/classification/>.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1252096&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.kb.cert.org_c26e46d6_20250125_210611.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#935424

## Virtual Machine Monitors (VMM) contain a memory deduplication vulnerability

#### Vulnerability Note VU#935424

Original Release Date: 2015-10-20 | Last Revised: 2015-10-21

---

### Overview

Multiple vendors' implementations of Virtual Machine Monitors (VMM) are vulnerable to a memory deduplication attack.

### Description

| As reported in the "Cross-VM ASL INtrospection (CAIN)" paper, an attacker with basic user rights within the attacking Virtual Machine (VM) can leverage memory deduplication within Virtual Machine Monitors (VMM). This effectively leaks the randomized base addresses of libraries and executables in the processes of neighboring VMs. Granting the attacker the ability to leak the Address-Space Layout of a process within a neighboring VM results in the potential to bypass ASLR. |
| --- |

### Impact

| A malicious attacker with only user rights within the attacking VM can reliably determine the base address of a process within a neighboring VM. This information can be used to develop a code-reuse or return oriented programming exploit for a known vulnerability in a target process. Attacking the target process is outside the scope of the CAIN attack.. |
| --- |

### Solution

| Deactivation of memory deduplication is the only known way to completely defend against the CAIN attack. |
| --- |

| See CAIN paper for a list of other mitigations. |
| --- |

### Vendor Information

935424
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23935424/) to view vendors.**
### [Linux KVM](#BLUU-9ZAHZH) Affected

Notified:  August 11, 2015  Updated: September 14, 2015

### Status

Affected

### Vendor Statement

Basically if you care about this attack vector, disable deduplication.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Parallels Holdings Ltd](#BLUU-9ZAHRZ) Affected

Notified:  August 11, 2015  Updated: September 09, 2015

### Status

Affected

### Vendor Statement

- Virtuozzo 6 (formerly Parallels Cloud Server 6) Virtual Machines are
not affected since our hypervisor does not utilize page sharing.
- Virtuozzo 6 Containers are affected through "pfcache" feature (enabled
by default), in the sense that from inside a Container you can find out
whether any other container on the host has (or ever had) the particular
application/file (of the particular version). We are considering this
information leak a minor issue, which comes as a price for memory
deduplication. We have no plans for fixing it. If this is considered a
major threat by user, then it could be mitigated by disabling the
"pfcache" functionality.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Red Hat, Inc.](#BGAR-A2CNKG) Affected

Notified:  August 11, 2015  Updated: October 06, 2015

**Statement Date:   August 11, 2015**

### Status

Affected

### Vendor Statement

This issue affects the versions of the Linux Kernel as shipped with Red Hat
Enterprise Linux 4, 5, 6 and 7. Red Hat Product Security has rated this issue
as having Low security impact. Additionally a workaround is available. A future
update may address this issue.

VMM layer: Deactivation of memory deduplication Deactivating memory
deduplication will effectively mitigate all attack vectors. This measure
unfortunately eliminates all the highly appreciated benefits of memory
deduplication, namely the increase of operational cost-effectiveness through
inter-VM memory sharing.

Deactivating memory deduplication is the simplest way to prevent exploitation
of this attack. However this will cause an increase in the amount of memory
required and in some situations may adversely impact performance (e.g. due to
slower swap space being used). It is recommended that customers test this
workaround before using it in production.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2877>
* <https://access.redhat.com/security/updates/classification/>

### [Microsoft Corporation](#BLUU-9YPS6R) Not Affected

Notified:  July 23, 2015  Updated: September 09, 2015

**Statement Date:   July 24, 2015**

### Status

Not Affected

### Vendor Statement

There is no impact..

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Xen](#BGAR-A2CP6Y) Not Affected

Notified:  July 12, 2015  Updated: September 14, 2015

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Oracle Corporation](#BGAR-A2CP7C) Unknown

Notified:  July 12, 2015  Updated: September 14, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [QEMU](#BGAR-A2CNAW) Unknown

Notified:  August 11, 2015  Updated: October 06, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [VMware](#BGAR-A2CP4V) Unknown

Updated:  September 14, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 1.5 | AV:L/AC:M/Au:S/C:P/I:N/A:N |
| Temporal | 1.4 | E:F/RL:W/RC:C |
| Environmental | 1.0 | CDP:N/TD:M/CR:ND/IR:ND/AR:ND |

### References

<https://www.usenix.org/conference/woot15/workshop-program/presentation/barresi>

### Acknowledgements

Thanks to Antonio Barresi, Kaveh Razavi, Mathias Payer, and Thomas R. Gross for reporting this vulnerability.

This document was written by Brian Gardiner.

### Other Information

| **CVE IDs:** | [CVE-2015-2877](http://web.nvd.nist.gov/vuln/detail/CVE-2015-2877) |
| --- | --- |
| **Date Public:** | 2015-07-30 |
| **Date First Published:** | 2015-10-20 |
| **Date Last Updated:** | 2015-10-21 16:53 UTC |
| **Document Revision:** | 42 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from access.redhat.com_ba84faef_20250126_115822.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)

  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Product Documentation](https://access.redhat.com/documentation)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)

  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform)
  [All Product Docs](//docs.redhat.com/en/products/)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)

  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Classifications](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Severety Ratings](https://access.redhat.com/security/security-updates/#/cve)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)

  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

 Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

# Severity ratings

## Understanding Red Hat security ratings

Red Hat Product Security rates the severity of security issues found
in Red Hat products using a four-point scale (Low, Moderate,
Important, and Critical), as well as including a separate Common
Vulnerability Scoring System (CVSS) base score. These scoring systems
provide a prioritized risk assessment to help you understand and
schedule upgrades to your systems, enabling informed decisions on the
risk each issue places on your unique environment.

The four-point scale tells you how serious Red Hat considers an issue
to be, helping you judge the severity and determine the most important
updates. The scale takes into account the potential risk based on a technical analysis of the exact flaw and its type. The risk level of a flaw does not change if an exploit or worm is later released for a flaw, or if one is available before the release of a fix. A flaw will only be re-evaluated if new technical details emerge.

The following table provides severity ratings for Red Hat products and systems. For flaws specific to AI models, see [Red Hat security ratings for AI models](https://access.redhat.com/security/ai).

| **Severity ratings** | **Security flaw description** |
| --- | --- |
| **Critical impact** | This rating is given to flaws that could be easily exploited by a remote unauthenticated attacker and lead to system compromise (arbitrary code execution) without requiring user interaction, or easily cause system compromise via inference end points on AI systems. Flaws that require authentication, local or physical access to a system, or an unlikely configuration are not classified as Critical impact. These are the types of vulnerabilities that can be exploited by worms. |
| **Important impact** | This rating is given to flaws that can easily compromise the confidentiality, integrity or availability of resources. These are the types of vulnerabilities that allow local or authenticated users to gain additional privileges, allow unauthenticated remote users to view resources that should otherwise be protected by authentication or other controls, allow authenticated remote users to execute arbitrary code, allow remote users to cause a denial of service, or can cause system compromise via inference end points on AI systems. |
| **Moderate impact** | This rating is given to flaws that may be more difficult to exploit but could still lead to some compromise of the confidentiality, integrity or availability of resources under certain circumstances. It is also given to flaws that could be exploited to cause denial of service-like conditions on AI systems via an inference end point, or allow attackers to steal other users’ data from the AI system without authorization. These are the types of vulnerabilities that could have had a Critical or Important impact but are less easily exploited based on a technical evaluation of the flaw and/or affect unlikely configurations. || **Low impact** | This rating is given to all other issues that may have a security impact. These are the types of vulnerabilities that are believed to require unlikely circumstances to be able to be exploited, or where a successful exploit would give minimal consequences. This includes flaws that are present in a program’s source code but to which no current or theoretically possible, but unproven, exploitation vectors exist or were found during the technical analysis of the flaw. |

A Red Hat security advisory can contain fixes for more than one
vulnerability and for packages for more than one product (such as both
Red Hat Enterprise Linux 7 and 8). Each issue in an advisory has a
severity rating for each product. The overall severity of an advisory
is the highest severity out of all the individual issues, across all
the products the advisory targets. For simplicity, advisories only
show the overall severity. The advisories contain links to the
relevant entries in Red Hat's bug-tracking system, where you can
examine individual severity ratings and additional commentary, as well
as links to the relevant pages in Red Hat’s CVE database.

When a technology—enabled and most likely used by default—completely
blocks the exploitation of a particular vulnerability across all
architectures, we will adjust the severity level. When a technology
reduces the risk of a vulnerability, we may adjust the severity level
and give an explanation of the decision in the bug-tracking  and CVE
database entries.

## Common Vulnerability Scoring System (CVSS)

Common Vulnerability Scoring System (CVSS) base scores provide
additional guidance about a vulnerability, giving a detailed severity
rating by scoring the constant aspects of a vulnerability: Attack
Vector, Attack Complexity, User Interaction, Privileges Required,
Scope, Confidentiality, Integrity, and Availability.

CVSS version 2 base metrics are available for all vulnerabilities from
2009-2016, as well as selected earlier vulnerabilities. In 2016, Red
Hat adopted the CVSS v3 standard, and all vulnerabilities going
forward will use version 3.1 for scoring. These scores are found on
the
[CVE pages](https://access.redhat.com/security/security-updates/#/cve)
(linked from the References section of each Red Hat Security Advisory).

Red Hat does not solely use the CVSS rating to determine the priority
with which flaws are fixed, or to determine the severity rating of the
vulnerability. It is used as a guideline to identify and describe key
metrics of a flaw, however the priority for which flaws are fixed is
determined by the overall severity of the flaw using the
aforementioned four-point scale.  CVSS is meant to help customers
prioritize the order in which they remediate flaws.

### CVSS v3 Base Metrics

The CVSS v3 base metrics group covers the constant aspects of a
vulnerability:

* Attack Vector (AV) - Expresses the "remoteness" of the attack and
  how the vulnerability is exploited.
* Attack Complexity (AC) - Speaks to the difficulty of executing an
  attack and what factors are needed for it to be successful. (Along
  with User Interaction, Attack Complexity was formerly part of the
  Access Complexity metric.).
* User Interaction (UI) - Determines whether the attack requires an
  active human to participate or if the attack can be automated.
* Privileges Required (PR) - Documents the level of user
  authentication required for the attack to be successful. (This
  replaces the former Authentication metric.).
* Scope (S) - Determines whether an attacker can impact a component
  beyond its security scope/authority.
* Confidentiality (C) - Determines whether unauthorized parties can
  access data and to what extent.
* Integrity (I) - Measures the impact to the trustworthiness and
  veracity of data.
* Availability (A) - Refers to the impact to accessibility of data or
  services for authorized users.

A formula translates these measurements into a single, numerical base
score, ranging from 0.0 (no risk) to 10.0 (highest risk). Refer to
[Common Vulnerability Scoring System v3.1: User Guide](https://www.first.org/cvss/user-guide)
for detailed descriptions of the base metrics. It is important to note
that the CVSS base metrics were designed to be used with the other
CVSS metric groups, notably the Temporal and Environmental metrics, to
provide an accurate representation of risk in customer environments.
Alone, the Base metrics offer a shallow view of the vulnerability
itself without accounting for deployment or the environment.

### How Red Hat Uses CVSS v3 Base Metrics

We aim to comply with the CVSS v3 standard when assigning base scores,
and Red Hat uses base metrics that reflect how a vulnerability affects
our products specifically.  In addition, we do not use the Qualitative
Severity Rating Scale in the CVSS v3.1 User Guide to rate severity,
and our severity ratings are always based on the aforementioned
four-point scale.  In some circumstances, it may not be obvious why a
flaw received a particular score. The following are some common
vulnerability types with our interpretation and typical scoring:

#### Libraries

It is not always possible to know how third-party applications use
libraries, making it difficult to give accurate CVSS v3 base metrics
for flaws in system libraries. When rating these flaws, we take into
account the way the library is used by applications that we ship, and
also look at other popular software that may use the library in a way
that would cause an issue to be of higher severity, and adjust the
score appropriately.

#### Other Common Scores

Flaws where a local, unprivileged user can cause a kernel to crash
(denial of service) typically score 5.5 (for example,
[CVE-2019-9213](https://access.redhat.com/security/cve/CVE-2019-9213)).

Flaws that allow a local, unprivileged user to escalate their
privileges to root typically score 7.8 (for example,
[CVE-2019-18634](https://access.redhat.com/security/cve/CVE-2019-18634)).

Cross-site scripting flaws are generally scored as having Low impact
to Integrity and/or Confidentiality, with no impact to Availability,
in line with scoring from other vendors and NVD. A typical score for
these flaws is 6.1 (for example,
[CVE-2020-11023](https://access.redhat.com/security/cve/CVE-2020-11023)).

### Base Score Variations Across Products

It is common for a given CVE-named vulnerability to have several
different CVSS base metrics, depending on the product, version, and
architecture. Examples of this include:

* A vulnerability that only affected some architectures. For example,
  [CVE-2019-15031](https://access.redhat.com/security/cve/CVE-2019-15031)
  only affected PowerPC.
* A vulnerability that is mitigated by source code protection
  mechanisms on some platforms. For example,
  [CVE-2018-1125](https://access.redhat.com/security/cve/CVE-2018-1125)
  could have led to arbitrary code execution on Red Hat Enterprise
  Linux, but it is only a denial of service because it was compiled
  with FORTIFY protections.
* A vulnerability that affected more than one product.  For example,
  [CVE-2020-14060](https://access.redhat.com/security/cve/CVE-2020-14060)
  affected a component in both OpenShift and OpenStack.  The severity
  to OpenStack was lower (Low) as compared to OpenShift (Moderate)
  based on its usage; the overall vulnerability itself was rated
  Important.

If CVSS v3 base scores are significantly different across products, we
note that separately wherever possible. If we do not split the score,
we report the metric that gives the highest CVSS v3 base score (the
worst-case outcome).

### Differences Between NVD and Red Hat Scores

For open source software shipped by multiple vendors, the CVSS base
scores may vary for each vendor's version, depending on the version
they ship, how they ship it, the platform, and even how the software
is compiled. This makes scoring vulnerabilities difficult for
third-party vulnerability databases, such as NVD, who can give only a
single CVSS base score to each vulnerability, or when comparing to
other vendors who score based on the characteristics of use in their
own products. See the
[National Vulnerability Database](https://nvd.nist.gov/vuln-metrics/cvss)
for more information regarding NVD security ratings.

These differences can cause the scores to vary widely. Other reasons
may include how the source code was compiled with certain compiler
flags or hardening technologies that reduce or eliminate the security
severity of a flaw, or how the software is used within the product.
Software running standalone may suffer from a flaw, but its use within
a product may preclude the vulnerable code from ever being used in a
way that could be exploited.

For example, NVD may rate a flaw in a particular service as having
High Impact on the CVSS CIA Triad (Confidentiality, Integrity,
Availability) where the service in question is typically run as the
root user with full privileges on a system. However, in a Red Hat
product, the service may be specifically configured to run as a
dedicated non-privileged user running entirely in a SELinux sandbox,
greatly reducing the immediate impact from compromise, resulting in
Low impact.

For these reasons, we recommend that, whenever possible, you use a
CVSS base score provided by Red Hat in preference to a score from a
third party. Please
[let us know](https://access.redhat.com/site/security/team/contact/)
if you believe we have given an incorrect CVSS v3 base score for a
particular vulnerability. We are happy to discuss and update if
needed.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com)

### Help

* [Contact Customer Portal](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Systems Status

### About

* [Red Hat Subscription Value](https://access.redhat.com/subscription-value)
* [About Red Hat](https://www.redhat.com/about/)
* [Red Hat Jobs](http://jobs.redhat.com)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

Copyright © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)

×
### Formatting Tips

Here are the common uses of Markdown.

Code blocks
```
~~~
Code surrounded in tildes is easier to read
~~~
```

Links/URLs`[Red Hat Customer Portal](https://access.redhat.com)`

[Learn more](/help/markdown)
Close



=== Content from bugzilla.redhat.com_d26075ce_20250126_115823.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2015-2877)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2015-2877)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2015-2877)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1252096

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1252096**](show_bug.cgi?id=1252096)
(CVE-2015-2877)
- [CVE-2015-2877](https://access.redhat.com/security/cve/CVE-2015-2877) Kernel: Cross-VM ASL INtrospection (CAIN)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-2877 Kernel: Cross-VM ASL INtrospection (CAIN)

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-2877 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1251874](show_bug.cgi?id=1251874) | | TreeView+ | [depends on](buglist.cgi?bug_id=1252096&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1252096&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-08-10 17:20 UTC by Kurt Seifried | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 05:03 UTC ([History](show_activity.cgi?id=1252096)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  agordeev aquini carnil dhoward fhrbata joelsmith kernel-mgr kstutsma lwang mguzik nmurray pholasek plougher rvrbovsk vgoyal | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-08-10 17:48:31 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1252096#c0)  Kurt Seifried    2015-08-10 17:20:03 UTC  ``` Antonio Barresi reports:  We discovered a new attack vector against memory deduplication in Virtual Machine Monitors (VMM) where attackers can effectively leak randomized base addresses of libraries and executables in processes of neighboring Virtual Machines (VM).  The details are described in the security advisory below and in our WOOT'15 paper: <https://www.usenix.org/conference/woot15/workshop-program/presentation/barresi>  Several vendors were notified about this issue in the beginning of June. This issue has [CVE-2015-2877](https://access.redhat.com/security/cve/CVE-2015-2877) assigned.  An overview can also be found here: <http://www.antoniobarresi.com/security/cloud/2015/07/30/cain/>   ```  [Comment 1](show_bug.cgi?id=1252096#c1)  Kurt Seifried    2015-08-10 17:48:31 UTC  ``` There are four suggested workarounds for this issue. Please note that several have a potentially significant impact on system performance ans stability, and should be carefully tested prior to deployment:  VMM layer: Deactivation of memory deduplication Deactivating memory deduplication will effectively mitigate all attack vectors. This measure unfortunately eliminates all the highly appreciated benefits of memory deduplication, namely the increase of operational cost-effectiveness through inter-VM memory sharing.   Deactivating memory deduplication is the simplest way to prevent exploitation of this attack. However this will cause an increase in the amount of memory required and in some situations may adversely impact performance (e.g. due to slower swap space being used). It is recommended that customers test this workaround before using it in production.   VMM layer: Attack detection Instead of preventing the attack directly, the VMM can observe the guest VM and detect an ongoing attack based on memory creation and page fault behavior. We do not propose any specific heuristic but we suggest the concept of detecting the attack instead of preventing it.   Using cgroups to limit or warn when a large number of memory IO operations occur is possible in certain situations however setting the appropriate upper bounds will be dependant on each use case, as such it is recommended that administrators profile applications through all use cases before considering this workaround in order to limit the false positives that may be generated.   ASLR layer: Increase ASLR entropy One of the factors making the attack feasible is the limited entropy in RBAs. We suggest to further increase ASLR entropy to not only mitigate the attack described here, but to continue making ASLR more effective.   Unfortunately this solution would require a  significant number of changes to the Linux system (Kernel, GCC, userspace, etc.) and as such is unlikely to be implemented at this time.   Process layer: More entropy in sensitive memory pages The pages we use in the attack are good candidates because their entropy consists solely on the ASLR entropy i.e., we can reliably construct the page once a base address is known or guessed. Increasing entropy in these pages or making sure that no such pages exist can mitigate the issue.  Unfortunately this solution would require a  significant number of changes to the Linux system (Kernel, GCC, userspace, etc.) and as such is unlikely to be implemented at this time.   ```  [Comment 2](show_bug.cgi?id=1252096#c2)  Martin Prpič    2015-08-11 13:40:46 UTC  ``` External References:  <http://www.antoniobarresi.com/files/cain_advisory.txt>   ```  [Comment 3](show_bug.cgi?id=1252096#c3)  Kurt Seifried    2015-08-11 17:20:11 UTC  ``` Statement:  This issue affects the versions of the Linux Kernel as shipped with Red Hat Enterprise Linux 4, 5, 6 and 7. Red Hat Product Security has rated this issue as having Low security impact. Additionally a workaround is available. A future update may address this issue. For additional information, refer to the Issue Severity Classification: <https://access.redhat.com/security/updates/classification/>.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1252096&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_32cb2b72_20250126_115815.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.antoniobarresi.com_828db232_20250125_210609.html ===
Security Advisory - "Cross-VM ASL INtrospection (CAIN)"
-------------------------------------------------------
Date: July 30, 2015
Description
-----------
We discovered a new attack vector against memory deduplication in
Virtual Machine Monitors (VMM) where attackers can effectively leak
randomized base addresses of libraries and executables in processes of
neighboring Virtual Machines (VM). The attack takes advantage of the
well known memory deduplication side-channel [1, 2]. VMMs that perform
memory deduplication enable malicious VMs to detect shared pages as
deduplicated pages usually incur higher write times because of the
required copy-on-write.
Our attack relies on a combination of the available side-channel, the
ASLR implementation characteristics and the existence of suitable pages
with certain properties (see below).
We found memory pages in Windows and Linux systems that allow a
malicious VM to silently brute force all possible base addresses.
These pages are mostly static, long-lived and their entropy is directly
derived from the randomized base address of a library or executable,
making it possible to probe for the right randomized base address.
Our PoC attack against the default configuration of KVM breaks ASLR of a
neighboring Windows Server 2012 (x86\_64) VM in less than 5 hours. We
estimate an attack against Linux based systems (x86\_64) to take around
18 days (with the same configuration).
We expect a more determined attacker to further reduce attack time. The
attack time also depends on the memory available to an attacker (more
memory reduces attack time).
Note: the attacker only needs user rights within the attacking VM thus
no root/Administrator/elevated privileges are required.
Attack variants
---------------
It is important to note that although the availability of the mentioned
pages is existential for the attack, different data or code pages might
be suitable for CAIN-like attacks. We cannot exclude that other pages
(data or code) might be used by attackers to leak randomized base
addresses. Therefore all mitigations that aim at specific pages are only
effective as long as no other pages are available to be misused by
attackers.
Impact
------
A malicious attacker can reliably leak the randomized base addresses of
libraries and the executable of a process within a neighboring VM thus
completely bypassing ASLR.
Affected VMMs (Side-channel)
----------------------------
Verified: KVM (on Ubuntu Server 14.04.2 with Linux Kernel 3.16.1)
Most probably also affected:
- All KVM versions with KSM (Kernel Same-Page Merging)
- VMware products with TPS (Transparent Page Sharing) enabled (NOT enabled by default)
- VirtualBox supporting Page Fusion
- Any other VMM that uses page based same content memory deduplication
Not affected:
- Microsoft Hyper-V products (does not perform page sharing, see also [3])
Affected Operating Systems (Victims)
------------------------------------
Verified: Windows Sever 2012 Datacenter (6.2.9200 Build 9200)
Existence of suitable pages also verified on: Ubuntu Linux 14.04 x86\_64
Most probably also affected:
- Most 64-bit and 32-bit x86 Windows operating systems
- Most 64-bit and 32-bit x86 GNU/Linux distributions
- Other operating systems like OpenBSD, FreeBSD, etc. as well
Mitigation
----------
- Deactivation of memory deduplication.
- Improvement of ASLR in victim systems by increasing entropy.
- Increase of entropy in memory pages of processes that are mainly
static, long-lived and that contain base addresses (or can be directly
derived by them).
- Increase size of shared pages i.e., use large pages for deduplication
(e.g., 2MB). Reducing entropy with larger pages takes much longer due
to the increase in the memory requirements of the attacker.
- VMMs can try to detect if an attack is going on based on memory
allocation and page fault characteristics. This requires further
investigation.
Information related to Windows systems
--------------------------------------
Windows operating systems seem to be the most feasible targets. Even
under High-Entropy ASLR, entropy for DLL base addresses is 19-bits. This
number of bits and everything below can reliably be brute forced through
the memory deduplication side-channel.
The pages that make the attack possible are the first PE file pages
mapped into the virtual address space of a process. These pages are
static except for the ImageBase field within the Optional Header. The
ImageBase field will be updated with the run-time base address of the
DLL. Attackers can use this page to reliably brute force the ImageBase
field to recover the randomized run-time base addresses of specific
DLLs. As Windows employs system-wide ASLR the recovered base addresses
can be used in attacks against all processes.
Mitigations:
- Increase of ASLR entropy for code pages (DLLs and executables)
- Increase of entropy within the first page of a mapped PE file
(to mitigate the PoC attack vector)
- Elimination of all suitable pages
Information related to Linux systems
------------------------------------
Linux based operating systems usually make use of the GNU tool chain. In
GNU based systems, ELF shared libraries are usually deployed as PIC
(Position-Independent Code). Thus most code pages have the same content
despite their randomized base address. However, some pages still exist
that are mapped from the ELF file's disk image to memory that contain
base address relocations (R\_X86\_64\_RELATIVE). These pages can be used by
attackers to brute force the base address of a shared library in memory
(e.g, libc). We found pages within the GNU\_RELRO segment to be suitable.
An attack against Linux based x86\_64 systems can take around 18 days
(estimate) with 4GB of attacker memory when running on a default KVM
VMM. With 8GB attacker memory we estimate an attack time of 8.7 days.
Attacks against x86 32-bit systems take considerably less (around hours).
As Linux employs process-wide ASLR the recovered base addresses still
need to be linked to a specific process within a victim VM.
Mitigation:
- Increase entropy within GNU\_RELRO pages
- Elimination of all suitable pages
Information related to KVM
--------------------------
We implemented a PoC against KVM that is able to reliably recover the
ntdll.dll randomized base address of a x86\_64 Windows Sever 2012 victim
VM. The attack takes less than 5 hours with the default KVM
configuration of a Ubuntu Server 14.04.2 (sleep\_millisecs = 200).
Increasing sleep\_millisecs slows down the attack, but does not prevent
it. The attack also works when multiple victim VMs are running on the
same KVM (we tested it with up to 6 victim VMs). While increasing the
number of running VMs, attack time increases as well.
As the attack is made possible as a combination of the side-channel and
of victim VM characteristics, mitigations can be implemented on the VMM
or victim VM side.
For VMMs we see 2 possible remedies:
- Deactivation of memory deduplication.
- Detection of ongoing attacks based on memory allocation and page
fault characteristics. This needs to be further investigated.
Slowing down detection and merging of same-content pages might also be
partly effective as attack time will inevitably increase.
Disvovered by:
--------------
Antonio Barresi, Kaveh Razavi, Mathias Payer, Thomas R. Gross
References:
-----------
[1]: "Memory Deduplication as a Threat to the Guest OS"
https://staff.aist.go.jp/c.artho/papers/EuroSec2011-suzaki.pdf
[2]: "Security Implications of Memory Deduplication in a Virtualized
Environment" http://www.cs.wm.edu/~hnw/paper/memdedup.pdf
[3]: "Mastering Hyper-V 2012 R2 with System Center and Windows Azure"
Section "Memory Resources", "Why Page Sharing Technologies Are Not Used
with Hyper-V"


=== Content from www.kb.cert.org_1965a40e_20250125_210614.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#935424

## Virtual Machine Monitors (VMM) contain a memory deduplication vulnerability

#### Vulnerability Note VU#935424

Original Release Date: 2015-10-20 | Last Revised: 2015-10-21

---

### Overview

Multiple vendors' implementations of Virtual Machine Monitors (VMM) are vulnerable to a memory deduplication attack.

### Description

| As reported in the "Cross-VM ASL INtrospection (CAIN)" paper, an attacker with basic user rights within the attacking Virtual Machine (VM) can leverage memory deduplication within Virtual Machine Monitors (VMM). This effectively leaks the randomized base addresses of libraries and executables in the processes of neighboring VMs. Granting the attacker the ability to leak the Address-Space Layout of a process within a neighboring VM results in the potential to bypass ASLR. |
| --- |

### Impact

| A malicious attacker with only user rights within the attacking VM can reliably determine the base address of a process within a neighboring VM. This information can be used to develop a code-reuse or return oriented programming exploit for a known vulnerability in a target process. Attacking the target process is outside the scope of the CAIN attack.. |
| --- |

### Solution

| Deactivation of memory deduplication is the only known way to completely defend against the CAIN attack. |
| --- |

| See CAIN paper for a list of other mitigations. |
| --- |

### Vendor Information

935424
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23935424/) to view vendors.**
### [Linux KVM](#BLUU-9ZAHZH) Affected

Notified:  August 11, 2015  Updated: September 14, 2015

### Status

Affected

### Vendor Statement

Basically if you care about this attack vector, disable deduplication.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Parallels Holdings Ltd](#BLUU-9ZAHRZ) Affected

Notified:  August 11, 2015  Updated: September 09, 2015

### Status

Affected

### Vendor Statement

- Virtuozzo 6 (formerly Parallels Cloud Server 6) Virtual Machines are
not affected since our hypervisor does not utilize page sharing.
- Virtuozzo 6 Containers are affected through "pfcache" feature (enabled
by default), in the sense that from inside a Container you can find out
whether any other container on the host has (or ever had) the particular
application/file (of the particular version). We are considering this
information leak a minor issue, which comes as a price for memory
deduplication. We have no plans for fixing it. If this is considered a
major threat by user, then it could be mitigated by disabling the
"pfcache" functionality.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Red Hat, Inc.](#BGAR-A2CNKG) Affected

Notified:  August 11, 2015  Updated: October 06, 2015

**Statement Date:   August 11, 2015**

### Status

Affected

### Vendor Statement

This issue affects the versions of the Linux Kernel as shipped with Red Hat
Enterprise Linux 4, 5, 6 and 7. Red Hat Product Security has rated this issue
as having Low security impact. Additionally a workaround is available. A future
update may address this issue.

VMM layer: Deactivation of memory deduplication Deactivating memory
deduplication will effectively mitigate all attack vectors. This measure
unfortunately eliminates all the highly appreciated benefits of memory
deduplication, namely the increase of operational cost-effectiveness through
inter-VM memory sharing.

Deactivating memory deduplication is the simplest way to prevent exploitation
of this attack. However this will cause an increase in the amount of memory
required and in some situations may adversely impact performance (e.g. due to
slower swap space being used). It is recommended that customers test this
workaround before using it in production.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2877>
* <https://access.redhat.com/security/updates/classification/>

### [Microsoft Corporation](#BLUU-9YPS6R) Not Affected

Notified:  July 23, 2015  Updated: September 09, 2015

**Statement Date:   July 24, 2015**

### Status

Not Affected

### Vendor Statement

There is no impact..

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Xen](#BGAR-A2CP6Y) Not Affected

Notified:  July 12, 2015  Updated: September 14, 2015

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Oracle Corporation](#BGAR-A2CP7C) Unknown

Notified:  July 12, 2015  Updated: September 14, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [QEMU](#BGAR-A2CNAW) Unknown

Notified:  August 11, 2015  Updated: October 06, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [VMware](#BGAR-A2CP4V) Unknown

Updated:  September 14, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 1.5 | AV:L/AC:M/Au:S/C:P/I:N/A:N |
| Temporal | 1.4 | E:F/RL:W/RC:C |
| Environmental | 1.0 | CDP:N/TD:M/CR:ND/IR:ND/AR:ND |

### References

<https://www.usenix.org/conference/woot15/workshop-program/presentation/barresi>

### Acknowledgements

Thanks to Antonio Barresi, Kaveh Razavi, Mathias Payer, and Thomas R. Gross for reporting this vulnerability.

This document was written by Brian Gardiner.

### Other Information

| **CVE IDs:** | [CVE-2015-2877](http://web.nvd.nist.gov/vuln/detail/CVE-2015-2877) |
| --- | --- |
| **Date Public:** | 2015-07-30 |
| **Date First Published:** | 2015-10-20 |
| **Date Last Updated:** | 2015-10-21 16:53 UTC |
| **Document Revision:** | 42 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.usenix.org_94b3bd66_20250125_210615.html ===
CAIN: Silently Breaking ASLR in the Cloud

Antonio Barresi
ETH Zurich

Kaveh Razavi
VU University Amsterdam

Mathias Payer
Purdue University

Thomas R. Gross
ETH Zurich

Abstract

Modern systems rely on Address-Space Layout Ran-
domization (ASLR) and Data Execution Prevention (DEP)
to protect software against memory corruption vulnera-
bilities. The security of ASLR depends on randomizing
regions in memory which can be broken by leaking ad-
dresses. While information leaks are common for client
applications, server software has been hardened to reduce
such information leaks.

Memory deduplication is a common feature of Virtual
Machine Monitors (VMMs) that reduces the memory
footprint and increases the cost-effectiveness of virtual
machines (VMs) running on the same host. Memory
pages with the same content are merged into one read-only
memory page. Writing to these pages is expensive due
to page faults caused by the memory protection, and this
cost can be used by an attacker as a side-channel to detect
whether a page has been shared. Leveraging this memory
side-channel, we craft an attack that leaks the address-
space layouts of the neighboring VMs, and hence, defeats
ASLR. Our proof-of-concept exploit, CAIN (Cross-VM
ASL INtrospection) defeats ASLR of a 64-bit Windows
Server 2012 victim VM in less than 5 hours (for 64-bit
Linux victims the attack takes several days). Further, we
show that CAIN reliably defeats ASLR, regardless of the
number of victim VMs or the system load.

1

Introduction

Virtualizing at machine boundaries provides strong
isolation guarantees. Public Infrastructure-as-a-Service
(IaaS) clouds leverage this isolation to securely multiplex
physical resources between different tenants, each run-
ning their own customized operating system (OS) and
applications for their unique needs. Running multiple
instances of the same type of OS, often with similar soft-
ware stacks, leads to multiple copies of the same data on
memory and disk. Techniques have been developed to
reduce the duplication of data (i.e., deduplication). Dupli-
cate pages (for memory) or duplicate ﬁle system blocks

(for disks) are shared among VMs. Deduplication directly
reduces the required resources for VMs, allowing to run
more VMs on the same hardware conﬁguration.

While deduplication reduces resource requirements of
VMs, it also introduces a side-channel that allows other
VMs to probe for the existence of speciﬁc memory pages.
This attack vector operates by crafting a memory page
with equal contents to a memory page that exists on neigh-
boring VMs (victims). If this page indeed exists on a
victim VM, then the deduplication process merges this
crafted page with the page residing on the victim’s mem-
ory. This page is then marked as read-only and gets shared
by the attacker and the victim. Measuring write times al-
lows the detection of merged pages. If the merge has
happened, writing to the page takes much longer because
of the page-fault on the read-only shared page, and the re-
sulting CoW (Copy-on-Write) for creating a private copy
of the modiﬁed page. This attack has previously been
used to leak binary versions of software [20]. Further,
this attack has also been used to detect the location of
sensitive data structures in a victim’s memory [9], leading
to successful AES [5] key retrieval.

We show that this side-channel attack allows attackers
to break the core defense mechanism, Address-Space Lay-
out Randomization (ASLR), of popular operating systems
against memory-related security vulnerabilities. Com-
mon systems like Windows or Linux use Data Execution
Prevention (DEP) to prohibit execution of data on the
stack or heap regions of a process. The only regions
that remain executable are program code and its (dynami-
cally linked) libraries. ASLR randomizes the locations of
these regions, making it probabilistically unlikely for an
attacker to gain code execution or perform a code-reuse
attack using a memory error, such as a stack or heap
overﬂow. ASLR and DEP heavily rely on each other:
Without DEP, an attacker can inject new executable code
into the address space of a process and without ASLR,
the attacker can mount code-reuse attacks through return-
oriented programming (ROP) [15, 19] or other related

techniques [2, 4, 3, 21]. Hence, breaking only one of the
two defenses is enough to compromise the main line of
defense against memory-error attacks. While information
leaks are abundant on clients, e.g., through a memory
corruption vulnerability and client-side scripting (like
JavaScript), they are much harder to ﬁnd on servers.

We show that it is possible to “leak” (or recover) the
randomized base addresses (RBAs) of libraries and exe-
cutables loaded within user space processes in neighbor-
ing VMs by leveraging the memory page deduplication
side-channel.

Using KVM [13], an off-the-shelf VM monitor (VMM)
that employs memory deduplication, we show the effec-
tiveness of our attack in a realistic setting. Our proof of
concept exploit, CAIN, breaks ASLR of a 64 bit Win-
dows Server 2012 victim VM in less than 5 hours using
default conﬁgurations. We estimate a successful attack
to take several days on a recent 64 bit Linux system, de-
pending on how much memory is available (e.g., with
4GB of memory we estimate an attack time of around 18
days). Using a webserver scenario, we show that CAIN
can reliably break ASLR even when the VM is under
various degrees of system load. Further, we show that
breaking ASLR of multiple neighboring VMs is also fea-
sible and increasing the number of VMs running on the
same physical hardware does mainly affect the required
attack time. These results show that memory deduplica-
tion in a cloud setting compromises the current defense
against memory-error attacks on popular systems. We
will discuss mitigations against this attack, but we believe
that additional research in this area is necessary due to
the increasing popularity of IaaS clouds [1].

2 Threat Landscape in Public Clouds

In public clouds, systems are not only subject to attacks
from the outside but also from malicious neighbors run-
ning on the same physical hardware. VMs of different
organizations and companies are deployed right next to
VMs of potentially untrusted parties (e.g., anyone with a
credit card). Weak and vulnerable systems running on the
same physical hardware pose a security risk for all their
co-located neighbors. In this paper, we describe an attack
that can be used to break ASLR of neighboring VMs. This
attack abuses the sharing of physical memory resources
between multiple VMs. Before delving into the low-level
details of the attack, we give a brief overview of ASLR
in modern systems and we discuss how memory sharing
is done in KVM, one of the most popular VM monitors.
While we focus on KVM in this paper, the same attack
vector exists on other VM monitors as well [14, 22].

2.1 Address Space Layout Randomization
Windows Microsoft recently introduced improvements
to ASLR with Windows 8 [12]. Microsoft Windows

x86 64 OSes have High Entropy ASLR providing up
to 33 bits of entropy for stacks and 24 bits for heaps [12].
Despite these improvements, base addresses of executa-
bles (17 bits) or DLLs (19 bits) still have limited amount
of entropy. Another particularity of Windows ASLR
is its per-system randomization of DLL base addresses.
As PE ﬁles usually contain many relocations, ASLR is
only done once per system boot. Thus, most DLLs (e.g.,
ntdll.dll) share the same virtual address between all
processes on the same system. This setup allows Windows
to keep only one copy of the DLL in memory, reducing
memory consumption.

Linux
In Linux based systems, ASLR for shared li-
braries is provided by mmap(). The user-space dy-
namic linker and loader, ld-linux,
loads ELF dy-
namic shared objects by mapping the binary images
from disk over mmap() into the process’ virtual address
space. mmap() randomizes the addresses of mappings
over mmap_rnd() [8]. For 32 bit x86 Linux systems,
mmap_rnd() provides 8 bits of entropy and for 64 bit
x86 28 bits. Linux based systems deploy PIC (Position-
Independent Code) for shared libraries. With PIC, base
addresses can still be randomized individually for each
process without having to duplicate the executable pages.
However, the main executables are often prelinked for
speed (e.g., on 32bit x86). These executable images are
loaded at well-known addresses. Recent x86 64 Linux
Distributions have started to ship executables as PIC,
which allows full ASLR (randomizing every region of
a process). On 32 bit x86 systems, PIC still incurs major
performance overhead [17], making full ASLR costly.

2.2 Kernel Same-page Merging (KSM)

KSM is the memory deduplication implementa-
tion of the Linux kernel which is used by KVM.
KSM’s behavior can be conﬁgured over sysfs
(/sys/kernel/mm/ksm/). Over run KSM can be
in
enabled ’1’ or disabled ’0’.
sleep_millisecs and pages_to_scan deﬁne how of-
ten KSM will be invoked (e.g., sleep_millisecs = 200,
5 times per second) and how many pages KSM scans
per invocation (e.g., pages_to_scan = 100, 100 pages)
which would result in 500 pages per second. Depending
on the workload, different values are optimal [18].

The values

When KSM is active, a kernel thread regularly inspects
memory pages that are subject to memory deduplication.
When two equal pages are found, they are merged and
both page table entries will from now on point to the same
physical page. The page is marked as read only and a
write to it triggers a CoW operation.

Internally KSM uses two red-black trees with page
hashes, a stable tree that holds all shared pages, and an
unstable tree that keeps track of all potential candidates.
When scanning, KSM looks at one page at a time. If there

2

is a match in the stable tree, the page is merged. If not,
and the page was not modiﬁed since the last scan, the
page is put into the unstable tree. If a page with the same
content already exists in the unstable tree, the pages are
merged as well. The unstable tree is then purged when all
pages were scanned, and the next iteration starts.

3 Breaking ASLR with CAIN

Our proof-of-concept implementation of the attack
called CAIN (Cross-VM ASL INtrospection) is imple-
mented as a C++ program that runs as an unprivileged
user space process on Linux. We make the following
assumptions in the design of CAIN:

• There is a measurable and noticeable difference in the
time a memory write operation takes depending on
whether the page at the write address is shared or not.
• Noise will not eliminate these differences, i.e., when
write operations take generally longer, writing to a
CoW page will still be noticeable.

• There is a duration M which is smaller than any CoW
operation. Depending on the architecture and the OS,
we can assume that a CoW will take at least M cycles.
• The probability that two or more randomized base ad-
dresses (RBAs) over all running VMs are exactly the
same, or with adjacent addresses is negligible.

• The probability that the same false positive is subse-
quently affected by noise multiple times such that it
will always be identiﬁed as a correct guess is negligible.

Only the ﬁrst assumption must hold for the attack to
succeed. The others are important to merely increase the
reliability and speed of CAIN.

3.1 Attack Overview

We designed the attack to be automated and indepen-
dent of the VMM, the VMM’s underlying memory dedu-
plication implementation, and the memory architecture.
Conceptually, we brute force all possible randomized
base addresses (RBAs) by taking advantage of time differ-
ences in memory write operations to deduplicated mem-
ory pages that are marked as read-only. These time dif-
ferences provide us with a side-channel that reveals if a
page is shared between VMs or not. To get correct results,
the attacker must wait a certain amount of time for the
crafted page to get merged. The right amount of time is
not known upfront and the attack becomes unsuccessful
if the attacker does not wait until after the merge. Further-
more, the side-channel contains noise, resulting in false
positives and false negatives.

To brute force the RBA, we construct guesses that con-
sist of entire pages that we know must exist in the victim
VMs. The entropy of these pages should depend entirely
on the RBA. We can therefore create all possible pages
with one base address guess per page and then derive its

Figure 1: PE ﬁle format on disk and in memory.

existence over the memory deduplication side-channel,
effectively derandomizing ASLR.

There are two main challenges. First, we need to con-
struct pages that are suitable for the attack. We discuss
how to construct these pages for Windows in Section 3.2,
and for Linux in Section 3.3. Second, the attack must be
automated and reliable, requiring handling noise that is
present within the memory deduplication side-channel.
To address these challenges, CAIN runs in three distinct
phases that we discuss in Section 3.4.

3.2 Attacking Windows

To attack ASLR on Windows, we need a page that con-
tains the ASLR base address of a speciﬁc library, i.e., the
page’s entropy has to be exactly the entropy of ASLR. In
addition, the page should be mostly static or, ideally, read-
only on the victim VM such that it is reliably merged with
our guess (given enough time). Data pages on the stack
or heap are therefore not suitable as they are (i) highly
dynamic and (ii) contain high entropy. When examin-
ing a Windows process in memory, we see that similar
to other systems, executable ﬁle images (PE executables
and DLLs) are memory mapped into the process’ address
space. These mappings usually contain code pages, data
pages, and information required by the loader to setup
the memory layout of the process and to perform all the
required relocations. Examining the very ﬁrst page of a
PE ﬁle (e.g., ntdll.dll) reveals an interesting property:
it is entirely static except for the ImageBase ﬁeld in the
optional header.

As illustrated in Figure 1 when a PE ﬁle is mapped into
memory during process creation, the ﬁrst page contains
the DOS, COFF, and Optional Header. Within the Op-
tional Header, there is a ﬁeld ImageBase that contains
0x180000000 on the disk image of the ﬁle. But once
loaded in memory, this ﬁeld will be updated with the load
address of the PE ﬁle in memory, i.e., the RBA. We can
easily extract this ﬁrst page given any DLL or executable
image. Given this page, we can now brute force the RBA
with the technique described in Section 3.1.

Note that when running multiple Windows VMs with
the exact same OS version,
the ﬁrst page of, e.g.,
ntdll.dll will be exactly the same (except for the dif-
ferent system-wide RBA). By detecting all RBAs, the

3

3.4 Attack Phases

CAIN operates in these three phases in order to ﬁnd
the RBAs: (i) sleep time detection, (ii) ﬁltering, and (iii)
veriﬁcation.

To automate the attack wait time for the underlying
memory deduplication implementation to merge pages
has to be estimated. Section 3.5 describes this step in
more detail. Next, we eliminate as many guesses with as
little memory as possible. Bruteforcing the entire ASLR
entropy space requires a lot of memory. As we need one
page per guess, this step would at least require the creation
of 219 × PAGESIZE = 2 GB to attack a 64 bit Windows
or 228 × PAGESIZE = 1024 GB to attack a 64 bit Linux.
Depending on the available memory, ﬁltering can be done
in one round (at least against Windows) or multiple rounds
by splitting up the search space. More on ﬁltering can be
found in Section 3.6. The last step consists of verifying
the remaining guesses in a more reliable way and thus
eliminating false positives, by using more memory per
guess. This is described in Section 3.7.

3.5 Sleep Time Detection

To perform a fully automated attack, CAIN estimates
the amount of time it waits (the attack’s sleep time per
round) for the guess (crafted page) to be merged with the
target page. This is important as waiting too little would
miss a correct guess and waiting too long would unneces-
sarily extend attack time. The required sleep time for the
memory deduplication implementation to merge pages
varies and depends on several factors. First, it depends
on the algorithms and data structures used by the imple-
mentation. Second, run-time factors like total amount of
memory subject to deduplication, CPU load, and other
characteristics can inﬂuence the required sleep time. We
consider the memory deduplication implementation to be
a blackbox and propose a simple iterative approach to
estimate the required sleep time.

We ﬁrst allocate a buffer and within it we generate a
large number of random pages. We then copy every sec-
ond page of the ﬁrst half of the buffer to the same location
in the second half of the buffer. The buffer now consists
of N pairs of pages (that contain random bytes) with the
same content (R-1, R-2,..., R-N) and unique random
pages between these pages. We now try a ﬁrst estimate
and wait, e.g., 10min. After that time, we start touching
all the pages within the ﬁrst half of the buffer by moving
a pointer over the ﬁrst byte of every page and write to it.
During this sweep, we measure write times and when the
write time of every second page is signiﬁcantly longer
than the ones of the adjacent random pages we mark the
page as potentially merged. The page was either merged
or accidentally detected as merged because of noise. De-
pending on the detection rate, we do the following:

Figure 2: Attacker memory when attacking Windows.

attacker can reveal the exact number of Windows VMs
running on the same physical machine.

To brute force the RBA of a speciﬁc DLL, we recon-
struct the exact ﬁrst page of that DLL in the attacker’s
memory and adapt the RBA within the ImageBase ﬁeld.
Figure 2 shows how attacker memory looks like. The high-
lighted pages contain the same contents (the attacker’s
guess and the ﬁrst page of the target DLL in the vic-
tim’s memory), which is then merged at some point in
time. This is the attacker’s goal, and writing to this page
triggers a CoW, which allows the attacker to detect the ex-
istence of the same page and the exact RBA of the victim
VM.

3.3 Attacking Linux

Attacking Linux based VMs requires more effort and is
less effective due to the different ASLR design. The 64 bit
Linux ASLR implementation uses 28 bits of entropy for
mmap() [8].

Mapped code pages of ELF ﬁles under Linux are
mostly identical due to PIC (Position-Independent Code)
support (at least for ELF shared objects). Other pages like
data pages are not suitable under Linux because of their
high entropy characteristics. Looking closer at the ELF
ﬁle mappings of Linux processes, we can see mappings
with different protection ﬂags. The GNU_RELRO segment
provides some pages that are mapped into a process as
r--. Before the pages are actually marked read-only
relocations are performed. Many R_X86_64_RELATIVE
relocations point exactly to sections in the GNU_RELRO
segment. These relocation entries instruct the dynamic
linker to add the base address of the ELF binary image to
the value found at these locations (originally loaded from
the ELF disk image). This is exactly what the attacker
needs as it is now possible to reconstruct these pages,
given the binary image and a guess for the RBA of that
speciﬁc ELF shared object (e.g., the libc.so).

Once such a page is found, the attacker mounts the
same attack as for Windows by taking advantage of the
memory deduplication side-channel. However, because
of the additional entropy bits in Linux for mmap (28 bits
compared to 19 bits on Windows), the attacker either
needs more memory or more time to brute force this
signiﬁcantly larger space.

4

Figure 3: Attacker memory during ﬁltering.

• if detection rate is greater than 95%, we add a safety
margin of 20% to the last sleep time estimate and return
this as the result;

• if detection rate is less than 50%, we double the last
time estimate, and rerun the algorithm with the new
(twice as large) estimate;

• if detection rate is in between 50% and 95%, we multi-
ply the last time estimate with the inverse of the detec-
tion rate, and rerun the algorithm with the new estimate.

This simple search will return a sleep time that has a
high detection rate. Depending on the memory dedupli-
cation implementation this technique might not produce
optimal results. In this case the attacker can either come
up with a better way to estimate sleep time, or just use a
conservatively long wait time (e.g., 10 hours).

3.6 Filtering

Depending on the number of entropy bits and the
memory available for the attack, R ﬁltering rounds with
R = 2(Entropy−log2(Memory/PAGESIZE)) are necessary.
Assuming the attacker has 2 GB of available memory, at-
tacking Windows with 19 bits of ASLR entropy requires
only one ﬁltering round because all the crafted guesses ﬁt
into one memory buffer of 2GB.

During ﬁltering we construct the memory layout shown
in Figure 3. We ﬁll all the available memory with guess
pages. For Windows this is the ﬁrst page of the DLL that
we want to derandomize. For all the base address guesses,
we create a page and adapt the ImageBase ﬁeld of these
pages, with one guess for each base address. We then
wait for the estimated sleep time.

Next, we touch all pages by writing to each page’s
ﬁrst byte, measuring how long each write takes. If we
encounter a page with a signiﬁcantly higher write time
than its neighbors, we mark it as a potential candidate,
admitting it to the next phase. We deﬁne signiﬁcantly
higher write time as at least two times greater than the
average write time of the adjacent pages. In Figure 3,
the highlighted page has a measured write access time of
2,667 cycles, whereas the neighbor pages have an average
access time of (29 + 34)/2 = 31.5 cycles. We found a
threshold factor of two to be very conservative. Write
times that trigger a CoW often take much longer than non-
CoW write times. However, to avoid false negatives the

Figure 4: Attacker memory during veriﬁcation.

threshold factor should not be too large. Furthermore, we
also check the write time to be above a certain minimal
write time (M) for CoW operations to avoid false positives.
In our implementation we use 1,000 cycles, but this value
can be adapted according to the underlying architecture
and system. The exact same parameters worked well in
our tests on a Workstation setup (Intel i7-4770 CPU, 8
cores, 8 GB memory) and a Server setup (AMD Opteron
6272 Dual CPU, 32 cores, 32 GB memory). An attacker
can select alternative values if our heuristics do not work.
Last, we check if the adjacent write times do not di-
verge signiﬁcantly from each other. We verify that the
differences between write times is not greater than a third
of the larger write time of both. We noticed that when
write access times are affected by noise, they start to di-
verge. This additional criteria helps us ﬁlter out such
cases. These detection heuristics may cause false nega-
tives and false positives. False negatives happen when
noise results in a write of an adjacent page to a page with
the correct guess. The probability of this is low, but if it
happens, CAIN terminates without ﬁnding a result. The
attacker can then run CAIN again. In our experiments,
false negatives occurred rarely (usually due to short wait
times). False positives are, however, more common due to
noise. We deal with them in the next phase of the attack.
At the end of all ﬁltering rounds, we have a set of
potential guesses that contain all the RBAs. Note that
every guess is checked exactly once during ﬁltering.

3.7 Veriﬁcation

We now have to verify each of the remaining guesses
to remove false positives. Because most candidates are
already eliminated, we now have more memory at our
disposal. We again craft pages with the corresponding
guesses. This time, we allocate random pages in between
these pages. Figure 4 shows the memory layout during
veriﬁcation rounds.

After waiting the estimated sleep time, we try again to
detect all merged pages. Candidates that are not detected
as being shared are removed. The number of rounds de-
pends on the results. We continue verifying candidates as
long as the set of candidates between veriﬁcation rounds
differ. As soon as the set between veriﬁcation rounds does
not change, or there is only one candidate left, we stop the

5

attack. This convergence usually happens after 2 to 3 ver-
iﬁcation rounds. The main purpose of veriﬁcation rounds
is to reliably ﬁlter out false positives caused by noise. We
can assume that if a page is falsely detected as a candidate
because of noise, the page will with high probability not
be affected by noise again in the next veriﬁcation round.
The attack completes after the last veriﬁcation round, and
all the remaining guesses are reported as hits.

3.8 Post-CAIN Attack

Depending on the victim OS and the number of victims,
at the end of the CAIN phase the attacker will have one
or a set of derandomized base addresses for a speciﬁc
library module like e.g., ntdll.dll or libc.so. In the
case of multiple Windows victims or one or more Linux
victims the base addresses are not linked to speciﬁc VMs
(Windows and Linux) or processes (Linux). First, note
that code-reuse attacks do not require more code or gad-
gets than usually found in one large library [19]. It is
therefore sufﬁcient to derandomize the base address of
ntdll.dll (Windows) or libc.so (Linux) to perform a
code-reuse attack and thus fully bypass ASLR. Second, in
most cases attacked processes or threads will restart after
a failed attack attempt. Thus trying out all derandomized
base addresses will work in case the memory layout is not
re-randomized. Even in the presence of ASLR brute-force
protections that limit the number of process restarts, since
the number of required trials is very low, these protec-
tions are likely not effective. Third, attackers can also
just derandomize a library or the executable itself that
is known to be used only in the targeted VM or process
thereby eliminating the need to guess at all. An extension
of CAIN further uses the derandomized base addresses
to link the base addresses to a speciﬁc VM or process by
constructing pages that contain values derived from the de-
randomized base address of e.g., ntdll.dll or libc.so
and that are known to only exist in a speciﬁc VM or pro-
cess. With the knowledge of a library’s base address and
the software running on the host, CAIN constructs tar-
geted pages that are only used by that software to identify
the correct base address. Possible candidates are pages
containing the Import Address Table (IAT) in Windows
or the PLT (Process Linkage Table) entries in the GOT
(Global Offset Table) .got.plt in Linux. These pages
contain pointers to libraries, allowing CAIN to further
link a base address to a process or even a VM in case the
process is known to only exist in one VM.

4 Evaluation

We evaluate CAIN attacks in different scenarios.
All experiments run on a dual CPU blade server
with two AMD Opteron 6272 CPUs (16 cores each)
and 32 GB of RAM. The system runs on Ubuntu
Server 14.04.2 LTS x86 64 (Linux Kernel 3.16.0), us-

ing the standard KVM software in its default conﬁg-
uration as VMM. Except for the sleep_millisecs
(/sys/kernel/mm/ksm/sleep_millisecs) parameter
that instructs KSM how many milliseconds it must sleep
in-between scan cycles, we keep all the parameters at
their default values. All the VMs are conﬁgured with 4
virtual CPUs and 4 GB of memory. We run one attacker
VM with Ubuntu Linux 14.04, and up to 7 VMs with
Windows Server 2012 Datacenter (6.2.9200).

4.1 Attacking a Single Windows VM

We ﬁrst evaluate the attack against a single vic-
tim. For the default conﬁguration of sleep_millisecs
(200 milliseconds), a total successful attack takes 288
minutes, i.e., less than 5 hours: Our sleep time estimate is
96 minutes per round, and the attack requires one ﬁlter-
ing round and two veriﬁcation rounds. From the initial
524’288 (19 bits of entropy) possible base addresses 6179
(12.6 bits of entropy) advance to the veriﬁcation phase.
The ﬁrst veriﬁcation round eliminates 6172, and the last
round eliminates the remaining 6 false positives. We ver-
iﬁed that the remaining candidate is the correct RBA of
ntdll.dll in the victim VM.

Figure 5 shows the attack duration with different values
for sleep_millisecs. Each dot represents one com-
pleted round. After each round the set of base addresses
and therefore the ASLR entropy is reduced till the cor-
rect base address is found (i.e., ASLR entropy = 0). As
expected, the shorter the KSM cycles (more pages are
potentially merged within the same amount of time), the
faster the attack. The ASLR entropy is effectively re-
duced from 19 bits to 0 bits, i.e., the exact value. In
our experiments, the attack always takes 3 rounds de-
spite the sleep_millisecs value. Depending on noise
the number of rounds can vary. For sleep_millisecs
20 milliseconds, the attack takes only 36 min (12 min
per round). Note that our sleep time estimation is not
optimal, and an attacker could invest more time and effort
to optimize it, resulting in even shorter attack times. This
becomes clear when looking at the attack time for 120,
160, and 200 milliseconds. All these conﬁgurations result
in the same sleep time estimation and thus the exact same
overall attack time. A more ﬁne-grained sleep time esti-
mation would probably reduce the attack time for these
sleep_millisecs conﬁgurations. The continuous lines
in Figure 5 denote fully performed and veriﬁed attacks
whereas the dotted lines denote only estimations.

Next, we look at how a system under load reacts to the
attack. We use a victim VM running a Internet Informa-
tion Services (IIS) webserver and a different system to
generate web requests with ab (the Apache Benchmark
tool). The IIS webserver hosts two ﬁles. One static html
ﬁle of size 56 KB and one jpg ﬁle of size 1054 KB. The
ﬁles correspond to average html and jpg ﬁle sizes hosted

6

Figure 5: Attacking a single Windows VM.

Figure 7: Attacking multiple Windows VMs. sleep ms = 20

times our attack recovered the RBAs of all co-located
Windows VMs (no false negatives and no false positives).

4.3 Attacking a Single Linux VM

We propose using the page described in Section 3.3
to mount attacks against Linux victims. Linux RBAs
of shared libraries have higher entropy, resulting in in-
creased memory requirements on the attacker side. We
can not expect to be able to allocate 228 ∗ PAGESIZE
(=1 TB) of memory, but we can divide the attack into
multiple ﬁltering rounds. Assuming 4 GB of memory we
estimate an attack against a 64 bit Linux VM to require
2(28−log2(4GB/4096)) = 256 ﬁltering rounds. Assuming
the average elimination rate for ﬁltering rounds in our
experiments, additionally, four veriﬁcation rounds are
required (last one for convergence). The 261 rounds in
total with the default sleep_millisecs conﬁguration
(200 milliseconds i.e., 96 minutes per round) will result
in a total estimated attack time of 261 × 96 minutes =
25056 minutes = 17.4 days. Doubling the available at-
tacker memory will reduce the required attack time by
half. With 8 GB of memory, we therefore estimate an
attack time of 8.7 days and with 16 GB, 4.35 days. As-
suming a Linux victim VM with a reasonable uptime this
attack becomes feasible.

4.4 Attacking Real-World Environments

Based on our experimental setup, we believe that
CAIN-like attacks are highly feasible in real cloud en-
vironments. Our setup uses standard software and server-
grade hardware. Still, it is crucial that memory dedupli-
cation is enabled within the VMM for our attack. We
contacted a number of commercial cloud providers with
a questionnaire to investigate the popularity of memory
deduplication in real-world settings. Based on the re-
sponses we received, it is clear that memory deduplication
is indeed used in public cloud settings. Some providers
use it as their default conﬁguration and some providers
do not use it at all: i.e., they explicitly disable it or their
underlying VMM does not support it.

Further, the resources available to an attacker and the
number of VMs running have an impact on attack time.
As most commercial IaaS offerings have more than 4 GBs
of RAM, memory availability is not an issue. As we

Figure 6: Attacking a Windows VM under load. sleep ms = 20

by webservers [6]. We use the following conﬁgurations:

1. 1 request per second per ﬁle (“1 req/sec”);
2. 10 requests per second per ﬁle (“10 req/sec”);
3. 100,000,000 requests with 1,000 concurrent connec-

tions kept alive per second per ﬁle (“max”).

Figure 6 shows that the attack is not inﬂuenced by the
generated load. We successfully leaked the correct RBA
for all load scenarios in 36 minutes per attack. Note that
we use sleep_millisecs 20 to reduce the required time
for testing.

4.2 Attacking Multiple Windows VMs

We run the attack against multiple victim VMs with
sleep_millisecs 20. The scenarios consist of up to
six concurrently running victims. Figure 7 shows that
increasing the number of concurrent VMs also increases
the required attack time (due to the additional memory
which requires longer sleep times). The attack against
six running victim VMs takes 384 minutes in total, with
one ﬁltering and three veriﬁcation rounds. Compared
to the single victim attack (two veriﬁcation rounds), the
attack requires one additional veriﬁcation round to make
sure the set of candidates converges (last horizontal step
where entropy stabilizes). The remaining 6 candidates
are the correct ntdll.dll RBAs of all running victim
VMs. Note that due to the nature of our attack, all RBAs
of all co-located VMs are leaked during a single run of
our attack. In Figure 7, we assume the attacker targets
any of the co-located Windows VMs (i.e., in case of 6
victims, of the 219 = 524288 base addresses 524288 - 5
= 524283 have to be eliminated). In all reported attack

7

performed our experiments with up to 6 victim VMs,
concurrently running VMs should not be an issue either.
One point to consider is operational noise, e.g., due to
the migration of VMs to different hosts (e.g., for a host
kernel update or to rebalance load). These events can
not be excluded and might prevent an ongoing attack,
especially when attack time is in the order of weeks. As
these maintenance tasks are mostly performed in larger
intervals, we do not consider this a serious problem for a
determined attacker.

5 Mitigations

The CAIN issue cannot be accounted to one speciﬁc
vulnerability in the VMM or system that can be punctually
ﬁxed. We describe multiple potential mitigations for the
attack and discuss their effectiveness and implications.

VMM layer: Deactivation of memory deduplication
Deactivating memory deduplication will effectively mit-
igate all attack vectors. This measure unfortunately
eliminates all the highly appreciated beneﬁts of mem-
ory deduplication, namely the increase of operational
cost-effectiveness through inter-VM memory sharing.

VMM layer: Attack detection Instead of preventing
the attack directly, the VMM can observe the guest VM
and detect an ongoing attack based on memory creation
and page fault behavior. We do not propose any speciﬁc
heuristic but we suggest the concept of detecting the attack
instead of preventing it.

ASLR layer: Increase ASLR entropy One of the fac-
tors making the attack feasible is the limited entropy in
RBAs. We suggest to further increase ASLR entropy to
not only mitigate the attack described here, but to continue
making ASLR more effective.

Process layer: More entropy in sensitive memory
pages The pages we use in the attack are good can-
didates because their entropy consists solely on the ASLR
entropy i.e., we can reliably construct the page once a
base address is known or guessed. Increasing entropy in
these pages or making sure that no such pages exist can
mitigate the issue.

6 Related Work

There are a number of studies that use a similar side-
channel attack on memory deduplication for different
purposes as ours. Suzaki et al. [20] showed that it is
possible to identify running applications in neighboring
VMs. Owens and Wang [16] ﬁngerprinted neighboring
OSes with a similar attack, and Irazoqui et al. [10] man-
aged to detect cryptographic libraries along with the IP
addresses of the neighboring VMs. Xiao et al. [23] cre-
ated a covert channel in virtualized environments using
this side-channel to create a stealthy backdoor.

There has been a large body of work around side-
channel attacks over shared CPU caches. Most notably
FLUSH+RELOAD [25] showed that it is possible to leak
data from a sensitive process such as one that does crypto-
graphic primitives. Irazoqui et al. [9] improved the attack,
retrieving AES cryptographic key in the cloud through a
combination of FLUSH+RELOAD and a memory dedupli-
cation side-channel. They recently improved their attack
to successfully retrieve private keys from other crypto-
graphic libraries [11]. Using a similar attack, Zhang et
al. [26] could leak sensitive application-level data to hi-
jack user accounts, and to break SAML single sign-on.

Hund et al. [7] propose a technique based on shared
CPU cache timing side channels to leak kernel space
ASLR from user space.

Recent work showed that the VMM can force page-
faults in the guest VMs in order to retrieve sensitive infor-
mation from the VMs, such as RBAs [24]. In this paper,
we showed that we can retrieve RBAs without the VMM
privileges required for inducing page-faults in the guest
VM. Instead, our exploit, CAIN, relies on the page-faults
resulting from the memory deduplication process.

7 Conclusion

We described CAIN (Cross-VM ASL INtrospection),
an attack against memory deduplication in virtualized
environments that breaks ASLR of Windows and Linux
targets running on the same physical hardware. Our attack
prepares well-known memory pages that contain the ran-
domized base address and uses the memory deduplication
side-channel to detect if the page exists on the target VM.
Our proof-of-concept exploit against KSM, the memory
deduplication implementation used by KVM, a popular
VMM, breaks ASLR of a 64 bit Windows in less than
5 hours, and of a 64 bit recent Linux system in around
18 days. We have shown that the attack time depends on
attacker available memory, the number of co-located VMs
and the memory deduplication conﬁguration in place.

We discussed possible mitigations and their implica-
tions, but given the great interest to support multiple ten-
ants in cloud-based environments, we think that addi-
tional investigation of CAIN-like attacks and defenses is
urgently required.

We have notiﬁed the affected vendors about CAIN; the

issue is tracked under CVE-2015-2877.

Acknowledgments

We thank Andrew Honig from Google, Hanieh Bagheri,
Nuno Tavares and Robert van der Meulen from LeaseWeb
and all the other anonymous cloud providers that helped
us better understand real productive cloud setups. We
would also like to thank Lucas Davi and the anonymous
reviewers for feedback on improving the paper.

8

References

[1] Gartner Forecast Overview: Public Cloud Services, Worldwide,
2011-2016, 4Q12 Update, published February 2013 and Alsbridge
Analysis, G00247462.

[2] BLETSCH, T., JIANG, X., FREEH, V. W., AND LIANG, Z. Jump-
In
oriented programming: a new class of code-reuse attack.
Proceedings of the 6th ACM Symposium on Information, Computer
and Communications Security (2011), ASIA CCS ’11.

[3] CARLINI, N., BARRESI, A., PAYER, M., WAGNER, D., AND
GROSS, T. R. Control-Flow Bending: On the Effectiveness of
Control-Flow Integrity. In SEC’15: 24th Usenix Security Sympo-
sium (2015).

[4] CHECKOWAY, S., DAVI, L., DMITRIENKO, A., SADEGHI, A.-R.,
SHACHAM, H., AND WINANDY, M. Return-oriented program-
ming without returns. In Proceedings of the 2012 ACM Conference
on Computer and Communications Security (2010).

[5] DAEMEN, J., DAEMEN, J., DAEMEN, J., RIJMEN, V., AND

RIJMEN, V. Aes proposal: Rijndael, 1998.

[6] HTTP ARCHIVE. Http archive - interesting stats - average sizes
of web sites and objects, 2014. http://httparchive.org/
interesting.php?a=All&l=Mar%201%202014.

[7] HUND, R., WILLEMS, C., AND HOLZ, T. Practical timing side
channel attacks against kernel space aslr. In Proceedings of the
2013 IEEE Symposium on Security and Privacy (Washington, DC,
USA, 2013), SP ’13, IEEE Computer Society, pp. 191–205.
[8] INGO MOLNAR, ANDI KLEEN. Linux cross reference: mmap.c,
http://lxr.free-electrons.com/source/arch/

2009.
x86/mm/mmap.c#L68.

[9] IRAZOQUI, G., INCI, M., EISENBARTH, T., AND SUNAR, B.
Wait a Minute! A fast, Cross-VM Attack on AES. In Proceed-
ings of the 17th International Symposium on Research in Attacks,
Intrusions and Defenses (2014), RAID ’14.

[10] IRAZOQUI, G., INCI, M. S., EISENBARTH, T., AND SUNAR,
B. Know Thy Neighbor: Crypto Library Detection in Cloud.
Proceedings on Privacy Enhancing Technologies (2015).

[11] IRAZOQUI, G., INCI, M. S., EISENBARTH, T., AND SUNAR, B.
Lucky 13 Strikes Back. In Proceedings of the 10th ACM Sym-
posium on Information, Computer and Communications Security
(2015), ASIA CCS ’15.

[12] KEN JOHNSON, MATT MILLER.

Exploit mitigation im-
provements in windows 8, 2012. http://media.blackhat.
com/bh-us-12/Briefings/M_Miller/BH_US_12_Miller_
Exploit_Mitigation_Slides.pdf.

[13] QEMU’s Kernel Virtual Machine. http://wiki.qemu.org/

KVM. [Online; accessed 17-05-2015].

[14] MILOS, G. Memory CoW in Xen, 2007. http://goo.gl/

zxfMTD.

[15] NERGAL. The advanced return-into-lib(c) exploits. Phrack 11
(2007), http://phrack.com/issues.html?issue=67&id=
8.

[16] OWENS, R., AND WANG, W. Non-interactive OS ﬁngerprinting
through memory de-duplication technique in virtual machines. In
In the Proceedings of Performance Computing and Communica-
tions Conference (2011), IPCCC ’11.

[17] PAYER, M. Too much PIE is bad for performance. Technical
report, ETH Zurich. http://nebelwelt.net/publications/
12TRpie, 2012.

[18] RACHAMALLA, S., MISHRA, D., AND KULKARNI, P. Share-
o-meter: An empirical analysis of ksm based memory sharing
in virtualized systems. In High Performance Computing (HiPC),
2013 20th International Conference on (2013).

[19] SHACHAM, H. The geometry of innocent ﬂesh on the bone:
Return-into-libc without function calls (on the x86). In Proceed-
ings of the 2007 ACM Conference on Computer and Communica-
tions Security (2007), CCS ’07.

[20] SUZAKI, K., IIJIMA, K., YAGI, T., AND ARTHO, C. Memory
Deduplication As a Threat to the Guest OS. In Proceedings of the
4th European Workshop on System Security (2011), EUROSEC
’11.

[21] SZEKERES, L., PAYER, M., WEI, T., AND SONG, D. SoK: Eter-
nal War in Memory. In Proceedings of the 2013 IEEE Symposium
on Security and Privacy (2013), IEEE S&P ’13.

[22] VMWARE. Understanding Memory Resource Management in

VMware vSphere 5.0, 2011. goo.gl/6Oaq17.

[23] XIAO, J., XU, Z., HUANG, H., AND WANG, H. A Covert Chan-
nel Construction in a Virtualized Environment. In Proceedings
of the 2012 ACM Conference on Computer and Communications
Security, CCS ’12.

[24] XU, Y., CUI, W., AND PEINADO, M. Controlled-channel attacks:
Deterministic side-channels for untrusted operating systems. In
Proceedings of the 2015 IEEE Symposium on Security and Privacy
(2015), IEEE S&P ’15.

[25] YAROM, Y., AND FALKNER, K. FLUSH+RELOAD: A High
Resolution, Low Noise, L3 Cache Side-channel Attack. In Pro-
ceedings of the 23rd USENIX Conference on Security Symposium
(2014), SEC’14.

[26] ZHANG, Y., JUELS, A., REITER, M. K., AND RISTENPART,
T. Cross-Tenant Side-Channel Attacks in PaaS Clouds. In Pro-
ceedings of the 2014 ACM SIGSAC Conference on Computer and
Communications Security (2014), CCS ’14.

9



=== Content from www.kb.cert.org_070def12_20250125_210613.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#935424

## Virtual Machine Monitors (VMM) contain a memory deduplication vulnerability

#### Vulnerability Note VU#935424

Original Release Date: 2015-10-20 | Last Revised: 2015-10-21

---

### Overview

Multiple vendors' implementations of Virtual Machine Monitors (VMM) are vulnerable to a memory deduplication attack.

### Description

| As reported in the "Cross-VM ASL INtrospection (CAIN)" paper, an attacker with basic user rights within the attacking Virtual Machine (VM) can leverage memory deduplication within Virtual Machine Monitors (VMM). This effectively leaks the randomized base addresses of libraries and executables in the processes of neighboring VMs. Granting the attacker the ability to leak the Address-Space Layout of a process within a neighboring VM results in the potential to bypass ASLR. |
| --- |

### Impact

| A malicious attacker with only user rights within the attacking VM can reliably determine the base address of a process within a neighboring VM. This information can be used to develop a code-reuse or return oriented programming exploit for a known vulnerability in a target process. Attacking the target process is outside the scope of the CAIN attack.. |
| --- |

### Solution

| Deactivation of memory deduplication is the only known way to completely defend against the CAIN attack. |
| --- |

| See CAIN paper for a list of other mitigations. |
| --- |

### Vendor Information

935424
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23935424/) to view vendors.**
### [Linux KVM](#BLUU-9ZAHZH) Affected

Notified:  August 11, 2015  Updated: September 14, 2015

### Status

Affected

### Vendor Statement

Basically if you care about this attack vector, disable deduplication.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Parallels Holdings Ltd](#BLUU-9ZAHRZ) Affected

Notified:  August 11, 2015  Updated: September 09, 2015

### Status

Affected

### Vendor Statement

- Virtuozzo 6 (formerly Parallels Cloud Server 6) Virtual Machines are
not affected since our hypervisor does not utilize page sharing.
- Virtuozzo 6 Containers are affected through "pfcache" feature (enabled
by default), in the sense that from inside a Container you can find out
whether any other container on the host has (or ever had) the particular
application/file (of the particular version). We are considering this
information leak a minor issue, which comes as a price for memory
deduplication. We have no plans for fixing it. If this is considered a
major threat by user, then it could be mitigated by disabling the
"pfcache" functionality.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Red Hat, Inc.](#BGAR-A2CNKG) Affected

Notified:  August 11, 2015  Updated: October 06, 2015

**Statement Date:   August 11, 2015**

### Status

Affected

### Vendor Statement

This issue affects the versions of the Linux Kernel as shipped with Red Hat
Enterprise Linux 4, 5, 6 and 7. Red Hat Product Security has rated this issue
as having Low security impact. Additionally a workaround is available. A future
update may address this issue.

VMM layer: Deactivation of memory deduplication Deactivating memory
deduplication will effectively mitigate all attack vectors. This measure
unfortunately eliminates all the highly appreciated benefits of memory
deduplication, namely the increase of operational cost-effectiveness through
inter-VM memory sharing.

Deactivating memory deduplication is the simplest way to prevent exploitation
of this attack. However this will cause an increase in the amount of memory
required and in some situations may adversely impact performance (e.g. due to
slower swap space being used). It is recommended that customers test this
workaround before using it in production.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2877>
* <https://access.redhat.com/security/updates/classification/>

### [Microsoft Corporation](#BLUU-9YPS6R) Not Affected

Notified:  July 23, 2015  Updated: September 09, 2015

**Statement Date:   July 24, 2015**

### Status

Not Affected

### Vendor Statement

There is no impact..

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Xen](#BGAR-A2CP6Y) Not Affected

Notified:  July 12, 2015  Updated: September 14, 2015

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Oracle Corporation](#BGAR-A2CP7C) Unknown

Notified:  July 12, 2015  Updated: September 14, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [QEMU](#BGAR-A2CNAW) Unknown

Notified:  August 11, 2015  Updated: October 06, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [VMware](#BGAR-A2CP4V) Unknown

Updated:  September 14, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 1.5 | AV:L/AC:M/Au:S/C:P/I:N/A:N |
| Temporal | 1.4 | E:F/RL:W/RC:C |
| Environmental | 1.0 | CDP:N/TD:M/CR:ND/IR:ND/AR:ND |

### References

<https://www.usenix.org/conference/woot15/workshop-program/presentation/barresi>

### Acknowledgements

Thanks to Antonio Barresi, Kaveh Razavi, Mathias Payer, and Thomas R. Gross for reporting this vulnerability.

This document was written by Brian Gardiner.

### Other Information

| **CVE IDs:** | [CVE-2015-2877](http://web.nvd.nist.gov/vuln/detail/CVE-2015-2877) |
| --- | --- |
| **Date Public:** | 2015-07-30 |
| **Date First Published:** | 2015-10-20 |
| **Date Last Updated:** | 2015-10-21 16:53 UTC |
| **Document Revision:** | 42 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.usenix.org_a926a6ca_20250126_115816.html ===

[Skip to main content](#main-content)

[USENIX](/)

* [Conferences](/conferences)
* [Students](/students)

[Sign in](/user?destination=node/191961)

* [Home](/conference/woot15)
* [Attend](/conference/usenixsecurity15/registration-information)
  + [Registration Information](/conference/usenixsecurity15/registration-information)
  + [Registration Discounts](/conference/usenixsecurity15/registration-discounts)
  + [Venue, Hotel, and Travel](/conference/usenixsecurity15/venue-hotel-and-travel)
  + [Students and Grants](/conference/usenixsecurity15/students-and-grants)
  + [Co-Located Workshops](/conference/usenixsecurity15/co-located-workshops)
* [Program](/conference/woot15/workshop-program)
* [Participate](/conference/woot15/call-for-papers)
  + [Instructions for Participants](/conference/woot15/instructions-participants)
  + [Call for Papers](/conference/woot15/call-for-papers)
* [Sponsorship](/conference/woot15/sponsorship)
* [About](/conference/woot15/workshop-organizers)
  + [Workshop Organizers](/conference/woot15/workshop-organizers)
  + [Services](/conference/usenixsecurity15/services)
  + [Questions](/conference/usenixsecurity15/questions)
  + [Help Promote!](/conference/woot15/help-promote-woot-15)
  + [Past Workshops](https://www.usenix.org/conferences/byname/202)

* [Home](/conference/woot15)
* [Attend](/conference/usenixsecurity15/registration-information)
* [Program](/conference/woot15/workshop-program)
* [Participate](/conference/woot15/call-for-papers)
  + [Instructions for Participants](/conference/woot15/instructions-participants)
  + [Call for Papers](/conference/woot15/call-for-papers)
* [Sponsorship](/conference/woot15/sponsorship)
* [About](/conference/woot15/workshop-organizers)
  + [Workshop Organizers](/conference/woot15/workshop-organizers)
  + [Services](/conference/usenixsecurity15/services)
  + [Questions](/conference/usenixsecurity15/questions)
  + [Help Promote!](/conference/woot15/help-promote-woot-15)
  + [Past Workshops](https://www.usenix.org/conferences/byname/202)

## sponsors

 Bronze Sponsor
 [![](https://www.usenix.org/sites/default/files/styles/sponsor_slideshow_front/public/sponsor_images/google_150x50_0.png?itok=dkKWiFPK)](http://research.google.com)

## help promote

![WOOT '16 button](/sites/default/files/conference-files/woot16_button.png)

## connect with us

* [![](https://www.usenix.org/sites/all/themes/waves/css/images/twitter-icon.jpeg) Twitter](http://twitter.com/usenix)
* [![](https://www.usenix.org/sites/all/themes/waves/css/images/facebook-icon.jpeg) Facebook](https://www.facebook.com/usenixassociation)
* [![](https://www.usenix.org/sites/all/themes/waves/css/images/in-icon.jpeg) LinkedIn](http://www.linkedin.com/groups/USENIX-Association-49559/about)
* [![](https://www.usenix.org/sites/all/themes/waves/css/images/googleplus-icon.jpg) Google+](https://plus.google.com/%2BUsenixOrg/posts)
* [![](https://www.usenix.org/sites/all/themes/waves/css/images/youtube-icon.jpg) YouTube](http://www.youtube.com/user/USENIXAssociation)

## twitter

[Tweets by @usenix](https://twitter.com/usenix)

## usenix conference policies

* [Event Code of Conduct](/conferences/coc)
* [Conference Network Policy](/conferences/network-policy)
* [Statement on Environmental Responsibility Policy](/conferences/environmental-responsibility)

## You are here

[Home](/) » **CAIN: Silently Breaking ASLR in the Cloud**

[Tweet](https://twitter.com/share)

#### connect with us

# CAIN: Silently Breaking ASLR in the Cloud

Authors:

Antonio Barresi, *ETH Zürich;* Kaveh Razavi, *VU University Amsterdam;* Mathias Payer, *Purdue University;* Thomas R. Gross, *ETH Zürich*

Abstract:

Modern systems rely on Address-Space Layout Randomization (ASLR) and Data Execution Prevention (DEP) to protect software against memory corruption vulnerabilities. The security of ASLR depends on randomizing
regions in memory which can be broken by leaking addresses. While information leaks are common for client applications, server software has been hardened to reduce such information leaks.

Memory deduplication is a common feature of Virtual Machine Monitors (VMMs) that reduces the memory footprint and increases the cost-effectiveness of virtual machines (VMs) running on the same host. Memory pages with the same content are merged into one read-only memory page. Writing to these pages is expensive due to page faults caused by the memory protection, and this cost can be used by an attacker as a side-channel to detect whether a page has been shared. Leveraging this memory side-channel, we craft an attack that leaks the address space layouts of the neighboring VMs, and hence, defeats ASLR. Our proof-of-concept exploit, CAIN (Cross-VM ASL INtrospection) defeats ASLR of a 64-bit Windows Server 2012 victim VM in less than 5 hours (for 64-bit Linux victims the attack takes several days). Further, we show that CAIN reliably defeats ASLR, regardless of the number of victim VMs or the system load.

## [Antonio Barresi, ETH Zürich](/conference/woot15/speaker-or-organizer/antonio-barresi-eth-z%C3%BCrich)

## [Kaveh Razavi, VU University Amsterdam](/conference/woot15/speaker-or-organizer/kaveh-razavi-vu-university-amsterdam)

## [Mathias Payer, Purdue University](/conference/woot15/speaker-or-organizer/mathias-payer-purdue-university)

## [Thomas R. Gross, ETH Zürich](/conference/woot15/speaker-or-organizer/thomas-r-gross-eth-z%C3%BCrich)

## Open Access Media

USENIX is committed to Open Access to the research presented at our events. Papers and proceedings are freely available to everyone once the event begins. Any video, audio, and/or slides that are posted after the event are also free and open to everyone. [Support USENIX](/annual-fund) and our commitment to Open Access.

BibTeX@inproceedings {191960,
[Download](/biblio/export/bibtex/191960) [Barresi PDF](https://www.usenix.org/system/files/conference/woot15/woot15-paper-barresi.pdf "woot15-paper-barresi.pdf")[View the slides](https://www.usenix.org/sites/default/files/conference/protected-files/woot15_slides_barresi.pdf)

* [Log in](/user/login?destination=comment/reply/191961%23comment-form) or    [Register](/user/register?destination=comment/reply/191961%23comment-form) to post comments

## Bronze Sponsors

[![](https://www.usenix.org/sites/default/files/styles/sponsor_interest_color/public/sponsor_images/google_150x50_0.png?itok=B7pLUz_N)](http://research.google.com)

© USENIX

* [Privacy Policy](/privacy-policy)
* [Contact Us](/contact)


