=== Content from security-tracker.debian.org_1dc07bf2_20250126_020540.html ===

# CVE-2015-2311

| **Name** | CVE-2015-2311 |
| --- | --- |
| **Description** | Integer underflow in Sandstorm Cap'n Proto before 0.4.1.1 and 0.5.x before 0.5.1.1 might allow remote peers to cause a denial of service or possibly obtain sensitive information from memory or execute arbitrary code via a crafted message. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-2311) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-2311); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-2311), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-2311), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-2311), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-2311), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2311), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-2311), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-2311), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-2311)/[CVE](https://www.suse.com/security/cve/CVE-2015-2311/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-2311)/[code](https://github.com/search?type=Code&q=%22CVE-2015-2311%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-2311%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-2311%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [780566](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780566) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto)) | bullseye | 0.7.0-7 | fixed |
|  | bookworm | 0.9.2-2 | fixed |
|  | sid, trixie | 1.1.0-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) | source | (unstable) | 0.4.1-3 |  |  | [780566](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780566) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from security-tracker.debian.org_76d6097c_20250126_020537.html ===

# CVE-2015-2312

| **Name** | CVE-2015-2312 |
| --- | --- |
| **Description** | Sandstorm Cap'n Proto before 0.4.1.1 and 0.5.x before 0.5.1.1 allows remote peers to cause a denial of service (CPU and possibly general resource consumption) via a list with a large number of elements. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-2312) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-2312); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-2312), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-2312), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-2312), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-2312), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2312), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-2312), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-2312), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-2312)/[CVE](https://www.suse.com/security/cve/CVE-2015-2312/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-2312)/[code](https://github.com/search?type=Code&q=%22CVE-2015-2312%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-2312%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-2312%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [780567](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780567) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto)) | bullseye | 0.7.0-7 | fixed |
|  | bookworm | 0.9.2-2 | fixed |
|  | sid, trixie | 1.1.0-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) | source | (unstable) | 0.4.1-3 |  |  | [780567](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780567) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from github.com_0f0f3b53_20250124_160403.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-02-2-all-cpu-amplification.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-02-2-all-cpu-amplification.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=capnproto%2Fcapnproto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capnproto](/capnproto)
/
**[capnproto](/capnproto/capnproto)**
Public

* [Notifications](/login?return_to=%2Fcapnproto%2Fcapnproto) You must be signed in to change notification settings
* [Fork
  934](/login?return_to=%2Fcapnproto%2Fcapnproto)
* [Star
   11.9k](/login?return_to=%2Fcapnproto%2Fcapnproto)

* [Code](/capnproto/capnproto/tree/master)
* [Issues
  180](/capnproto/capnproto/issues)
* [Pull requests
  72](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects
  0](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

Additional navigation options

* [Code](/capnproto/capnproto/tree/master)
* [Issues](/capnproto/capnproto/issues)
* [Pull requests](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

## Files

 master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-02-2-all-cpu-amplification.md

Copy path Blame  Blame
## Latest commit

## History

[History](/capnproto/capnproto/commits/master/security-advisories/2015-03-02-2-all-cpu-amplification.md)74 lines (55 loc) · 2.61 KB master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-02-2-all-cpu-amplification.md

Top
## File metadata and controls

* Preview
* Code
* Blame

74 lines (55 loc) · 2.61 KB[Raw](https://github.com/capnproto/capnproto/raw/refs/heads/master/security-advisories/2015-03-02-2-all-cpu-amplification.md)
# Problem

CPU usage amplification attack.

# Discovered by

Ben Laurie <ben@links.org> using [American Fuzzy Lop](http://lcamtuf.coredump.cx/afl/)

# Announced

2015-03-02

# CVE

CVE-2015-2312

# Impact

* Remotely cause a peer to use excessive CPU time and other resources to
  process a very small message, possibly enabling a DoS attack.

# Fixed in

* git commit [104870608fde3c698483fdef6b97f093fc15685d](https://github.com/capnproto/capnproto/commit/104870608fde3c698483fdef6b97f093fc15685d)
* release 0.5.1.1:
  + Unix: [https://capnproto.org/capnproto-c++-0.5.1.1.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.5.1.1.tar.gz)
  + Windows: [https://capnproto.org/capnproto-c++-win32-0.5.1.1.zip](https://capnproto.org/capnproto-c%2B%2B-win32-0.5.1.1.zip)
* release 0.4.1.1:
  + Unix: [https://capnproto.org/capnproto-c++-0.4.1.1.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.4.1.1.tar.gz)
* release 0.6 (future)

# Details

The Cap'n Proto list pointer format allows encoding a list whose elements are
claimed each to have a size of zero. Such a list could claim to have up to
2^29-1 elements while only taking 8 or 16 bytes on the wire. The receiving
application may expect, say, a list of structs. A zero-size struct is a
perfectly legal (and, in fact, canonical) encoding for a struct whose fields
are all set to their default values. Therefore, the application may notice
nothing wrong and proceed to iterate through and handle each element in the
list, potentially taking a lot of time and resources to do so.

Note that this kind of vulnerability is very common in other systems. Any
system which accepts compressed input can allow an attacker to deliver an
arbitrarily large uncompressed message using very little compressed bandwidth.
Applications should do their own validation to ensure that lists and blobs
inside a message have reasonable size. However, Cap'n Proto takes the
philosophy that any security mistake that is likely to be common in
naively-written application code is in fact a bug in Cap'n Proto -- we should
provide defenses so that the application developer doesn't have to.

To fix the problem, this change institutes the policy that, for the purpose of
the "message traversal limit", a list of zero-sized elements will be counted as
if each element were instead one word wide. The message traversal limit is an
existing anti-amplification measure implemented by Cap'n Proto; see:

<https://capnproto.org/encoding.html#amplification-attack>

# Preventative measures

This problem was discovered through fuzz testing using American Fuzzy Lop,
which identified the problem as a "hang", although in fact the test case just
took a very long time to complete. We are incorporating testing with AFL into
our release process going forward.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.debian.org_7b20653b_20250124_160402.html ===

# Debian Bug report logs - #780567 capnproto: CVE-2015-2312: CPU usage amplification attack

[![version graph](version.cgi?height=2;fixed=capnproto%2F0.4.1-3;collapse=1;found=capnproto%2F0.4.1-2;width=2;absolute=0;package=capnproto)](version.cgi?collapse=1;package=capnproto;absolute=0;fixed=capnproto%2F0.4.1-3;info=1;found=capnproto%2F0.4.1-2)

Package:
[capnproto](pkgreport.cgi?package=capnproto);
Maintainer for [capnproto](pkgreport.cgi?package=capnproto) is [Tom Lee <debian@tomlee.co>](pkgreport.cgi?maint=debian%40tomlee.co); Source for [capnproto](pkgreport.cgi?package=capnproto) is [src:capnproto](pkgreport.cgi?src=capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto), [buildd](https://buildd.debian.org/capnproto), [popcon](https://qa.debian.org/popcon.php?package=capnproto)).

Reported by: [Tom Lee <debian@tomlee.co>](pkgreport.cgi?submitter=debian%40tomlee.co)

Date: Mon, 16 Mar 2015 04:48:01 UTC

Severity: *grave*

Tags: security

Found in version capnproto/0.4.1-2

Fixed in version capnproto/0.4.1-3

**Done:** Tom Lee <debian@tomlee.co>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=780567;mbox=yes), [status mbox](bugreport.cgi?bug=780567;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=780567;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#780567`; Package `capnproto`.
(Mon, 16 Mar 2015 04:48:06 GMT) ([full text](bugreport.cgi?bug=780567;msg=2), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Tom Lee <debian@tomlee.co>`:

New Bug report received and forwarded.
(Mon, 16 Mar 2015 04:48:06 GMT) ([full text](bugreport.cgi?bug=780567;msg=4), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=780567;msg=5), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: submit@bugs.debian.org
Subject: CPU usage amplification attack
Date: Sun, 15 Mar 2015 21:44:41 -0700
```
[[Message part 1](bugreport.cgi?att=0;bug=780567;msg=5) (text/plain, inline)]
```
```
Package: capnproto
Version: 0.4.1-2
Severity: critical

Upstream has reported a number of security issues in capnproto 0.4.1.
Creating bugs to track these issues while I work on getting them fixed.

This bug is tracking the "CPU usage amplification attack" bug reported on
2015-03-02.

Full details + patch:
<https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-2-all-cpu-amplification.md>

--
*Tom Lee */ <http://tomlee.co> / @tglee <<http://twitter.com/tglee>>

```
```
[[Message part 2](bugreport.cgi?att=1;bug=780567;msg=5) (text/html, inline)]
```

---

**Added tag(s) security.**
Request was from `Paul Wise <pabs@debian.org>`
to `control@bugs.debian.org`.
(Mon, 16 Mar 2015 05:00:06 GMT) ([full text](bugreport.cgi?bug=780567;msg=7), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=7), [link](#6)).

---

**Changed Bug title to 'capnproto: CVE-2015-2312: CPU usage amplification attack' from 'CPU usage amplification attack'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 17 Mar 2015 05:06:10 GMT) ([full text](bugreport.cgi?bug=780567;msg=9), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=9), [link](#8)).

---

**Severity set to 'grave' from 'critical'**
Request was from `Tom Lee <debian@tomlee.co>`
to `control@bugs.debian.org`.
(Wed, 18 Mar 2015 03:27:11 GMT) ([full text](bugreport.cgi?bug=780567;msg=11), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=11), [link](#10)).

---

**Reply sent**
to `Tom Lee <debian@tomlee.co>`:

You have taken responsibility.
(Sat, 28 Mar 2015 10:06:19 GMT) ([full text](bugreport.cgi?bug=780567;msg=13), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=13), [link](#12)).

---

**Notification sent**
to `Tom Lee <debian@tomlee.co>`:

Bug acknowledged by developer.
(Sat, 28 Mar 2015 10:06:19 GMT) ([full text](bugreport.cgi?bug=780567;msg=15), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=15), [link](#14)).

---

[Message #16](#16) received at 780567-close@bugs.debian.org ([full text](bugreport.cgi?bug=780567;msg=16), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=16), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: 780567-close@bugs.debian.org
Subject: Bug#780567: fixed in capnproto 0.4.1-3
Date: Sat, 28 Mar 2015 10:04:31 +0000
```
Source: capnproto
Source-Version: 0.4.1-3

We believe that the bug you reported is fixed in the latest version of
capnproto, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 780567@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Tom Lee <debian@tomlee.co> (supplier of updated capnproto package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Tue, 17 Mar 2015 19:53:24 -0800
Source: capnproto
Binary: libcapnp-0.4.1 libcapnp-dev capnproto
Architecture: source amd64
Version: 0.4.1-3
Distribution: unstable
Urgency: high
Maintainer: Tom Lee <debian@tomlee.co>
Changed-By: Tom Lee <debian@tomlee.co>
Description:
 capnproto  - tool for working with the Cap'n Proto data interchange format
 libcapnp-0.4.1 - Cap'n Proto C++ library
 libcapnp-dev - Cap'n Proto C++ library (development files)
Closes: [780565](bugreport.cgi?bug=780565) [780566](bugreport.cgi?bug=780566) [780567](bugreport.cgi?bug=780567) [780568](bugreport.cgi?bug=780568)
Changes:
 capnproto (0.4.1-3) unstable; urgency=high
 .
   * Fix [CVE-2015-2310](https://security-tracker.debian.org/tracker/CVE-2015-2310): Integer overflow in pointer validation (Closes: [780565](bugreport.cgi?bug=780565))
   * Fix [CVE-2015-2311](https://security-tracker.debian.org/tracker/CVE-2015-2311): Integer underflow in pointer validation (Closes: [780566](bugreport.cgi?bug=780566))
   * Fix [CVE-2015-2312](https://security-tracker.debian.org/tracker/CVE-2015-2312): CPU usage amplification attack (Closes: [780567](bugreport.cgi?bug=780567))
   * Fix [CVE-2015-2313](https://security-tracker.debian.org/tracker/CVE-2015-2313): CPU usage amplification attack #2 (Closes: [780568](bugreport.cgi?bug=780568))
Checksums-Sha1:
 bfe5a1cea8070a5dee0121ecd7068e87ef7f6c9d 2054 capnproto_0.4.1-3.dsc
 2f251b205c665c7b72817ae6d4c52f047f5c0282 10984 capnproto_0.4.1-3.debian.tar.xz
 9cde11cd029b8767494d450fb4979853af4bcbaa 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 2da025c247379fdb44705116e11a921b65bcfe69 745964 libcapnp-dev_0.4.1-3_amd64.deb
 9ef5ca198cad87de6501049ca92ddf4ec44ac910 170350 capnproto_0.4.1-3_amd64.deb
Checksums-Sha256:
 32f86d39b12d26d0edeb36a8df51ce4be6a431f579f6b415edeb9b9900d5d300 2054 capnproto_0.4.1-3.dsc
 d2855bd37291847b7dea7a9d0c9aa632088da6ec16a038ece0ba403d4b12cfe5 10984 capnproto_0.4.1-3.debian.tar.xz
 0cc882278276f9c09eb7bcec86e5f9a35f5896f78a5595d1b87df17eeeb4608b 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 1054d6f3d786748edd83fb59a0c840a7f03212b44c9137aee51108fd2fd228b7 745964 libcapnp-dev_0.4.1-3_amd64.deb
 22b6714c52a57d29670320c0746e6f68627f1dc963e16edcbf5d1ee15befa0b8 170350 capnproto_0.4.1-3_amd64.deb
Files:
 eb595ceebeb49db8ecdd480acebc34f0 2054 devel optional capnproto_0.4.1-3.dsc
 41613a343a27107b43f7cc7d4439601c 10984 devel optional capnproto_0.4.1-3.debian.tar.xz
 96655f2e7aeb70fe31105e401dbb0547 526256 libs optional libcapnp-0.4.1_0.4.1-3_amd64.deb
 0ae5bbd903cab58907f25d1e798c6d36 745964 libdevel optional libcapnp-dev_0.4.1-3_amd64.deb
 43056c2e59c9ada3d7999d585593d2ab 170350 devel optional capnproto_0.4.1-3_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJVFlyVAAoJEJWkL+g1NSX51QgP/3+VZopWCBf4EVHsMnuuVvZP
iQ2DyQ7dLLzwsoRiipjd1dP22sfqH6JN0Ac1stPxkHS9vt4QO/sTYi4KoydM9Mp3
qbbEJt9ivGo4l/gEcDA9wKR0FV1V40KYy0WXHwvXK16s6t3VU14Caf3wt8zSnAxA
b4ZZDGac8LNrI5Q2cViGU11FRa16UuJVI4EfWhyPxsb9OxH+2bKlOwGCcTdnqXw1
tPZrMuFv88pWCG7G7H/vUazu4GJD/V3AsIqYRKdF1bIHVcLkfSKtasJ89c2GE3jm
urKCcdJs0UcjJRa3yAxUGPtCwerubfLxUyYVacciC0g5UcJgcfM+im8xbqT0h4CP
cYpGe2xs5thVo426tfoO/JBxqDKhf/2sQb63axOECmsHliRjgcQmHx9pz9Am/mIO
ZKKEvPq9DZNr2zhC/NG0kdMJDCYzDC2+Je0ttNbIXY98rKqeAe/u3h1ffaX2IN95
c56VA7Pjjto03Nqd0di4mudtSwNSwvJ8auiFqetRjfD+OZaJPyGEDBCN2wCDjU6u
Rsybuqx8v/j0B39E9yGcmzrxnaahm2jfFg1yy4GCob0txQ2eX4ukqwIdB8kZJjfK
8CKnjzpV4xSYrqcVnK8AS0UMiFkZ7owRNbW+G2zMGXy1O7uIj2ebb+mnzDEgkN+3
A717zs6cgpIwyHp+UAxu
=GxxL
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 11 May 2015 07:28:38 GMT) ([full text](bugreport.cgi?bug=780567;msg=18), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=18), [link](#17)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=780567).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 16:04:02 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_5cc83c25_20250126_020539.html ===

# CVE-2015-2313

| **Name** | CVE-2015-2313 |
| --- | --- |
| **Description** | Sandstorm Cap'n Proto before 0.4.1.1 and 0.5.x before 0.5.1.2, when an application invokes the totalSize method on an object reader, allows remote peers to cause a denial of service (CPU consumption) via a crafted small message, which triggers a "tight" for loop. NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-2312. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-2313) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-2313); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-2313), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-2313), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-2313), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-2313), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2313), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-2313), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-2313), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-2313)/[CVE](https://www.suse.com/security/cve/CVE-2015-2313/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-2313)/[code](https://github.com/search?type=Code&q=%22CVE-2015-2313%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-2313%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-2313%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [780568](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780568) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto)) | bullseye | 0.7.0-7 | fixed |
|  | bookworm | 0.9.2-2 | fixed |
|  | sid, trixie | 1.1.0-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) | source | (unstable) | 0.4.1-3 |  |  | [780568](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780568) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from github.com_e24e7adb_20250126_020540.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-05-0-c%252B%252B-addl-cpu-amplification.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-05-0-c%252B%252B-addl-cpu-amplification.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=capnproto%2Fcapnproto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capnproto](/capnproto)
/
**[capnproto](/capnproto/capnproto)**
Public

* [Notifications](/login?return_to=%2Fcapnproto%2Fcapnproto) You must be signed in to change notification settings
* [Fork
  934](/login?return_to=%2Fcapnproto%2Fcapnproto)
* [Star
   11.9k](/login?return_to=%2Fcapnproto%2Fcapnproto)

* [Code](/capnproto/capnproto/tree/master)
* [Issues
  180](/capnproto/capnproto/issues)
* [Pull requests
  71](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects
  0](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

Additional navigation options

* [Code](/capnproto/capnproto/tree/master)
* [Issues](/capnproto/capnproto/issues)
* [Pull requests](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

## Files

 master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-05-0-c++-addl-cpu-amplification.md

Copy path Blame  Blame
## Latest commit

## History

[History](/capnproto/capnproto/commits/master/security-advisories/2015-03-05-0-c%2B%2B-addl-cpu-amplification.md)67 lines (48 loc) · 1.94 KB master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-05-0-c++-addl-cpu-amplification.md

Top
## File metadata and controls

* Preview
* Code
* Blame

67 lines (48 loc) · 1.94 KB[Raw](https://github.com/capnproto/capnproto/raw/refs/heads/master/security-advisories/2015-03-05-0-c%2B%2B-addl-cpu-amplification.md)
# Problem

CPU usage amplification attack, similar to previous vulnerability
[2015-03-02-2](https://github.com/capnproto/capnproto/blob/master/security-advisories/2015-03-02-2-all-cpu-amplification.md).

# Discovered by

David Renshaw <david@sandstorm.io>

# Announced

2015-03-05

# CVE

CVE-2015-2313

# Impact

* Remotely cause a peer to execute a tight `for` loop counting from 0 to
  2^29, possibly repeatedly, by sending it a small message. This could enable
  a DoS attack by consuming CPU resources.

# Fixed in

* git commit [80149744bdafa3ad4eedc83f8ab675e27baee868](https://github.com/capnproto/capnproto/commit/80149744bdafa3ad4eedc83f8ab675e27baee868)
* release 0.5.1.2:
  + Unix: [https://capnproto.org/capnproto-c++-0.5.1.2.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.5.1.2.tar.gz)
  + Windows: [https://capnproto.org/capnproto-c++-win32-0.5.1.2.zip](https://capnproto.org/capnproto-c%2B%2B-win32-0.5.1.2.zip)
* release 0.4.1.1:
  + Unix: [https://capnproto.org/capnproto-c++-0.4.1.2.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.4.1.2.tar.gz)
* release 0.6 (future)

# Details

Advisory [2015-03-02-2](https://github.com/capnproto/capnproto/blob/master/security-advisories/2015-03-02-2-all-cpu-amplification.md) described a bug allowing a remote attacker to
consume excessive CPU time or other resources using a specially-crafted message.
The present advisory is simply another case of the same bug which was initially
missed.

The new case occurs only if the application invokes the `totalSize()` method
on an object reader.

The new case is somewhat less severe, in that it only spins in a tight `for`
loop that doesn't call any application code. Only CPU time is possibly
consumed, not RAM or other resources. However, it is still possible to create
significant delays for the receiver with a specially-crafted message.

# Preventative measures

Our fuzz test actually covered this case, but we didn't notice the problem
because the loop actually completes in less than a second. We've added a new
test case which is more demanding, and will make sure that when we do extended
testing with American Fuzzy Lop, we treat unexpectedly long run times as
failures.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_589485ad_20250124_160405.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fcommit%2F104870608fde3c698483fdef6b97f093fc15685d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fcommit%2F104870608fde3c698483fdef6b97f093fc15685d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=capnproto%2Fcapnproto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capnproto](/capnproto)
/
**[capnproto](/capnproto/capnproto)**
Public

* [Notifications](/login?return_to=%2Fcapnproto%2Fcapnproto) You must be signed in to change notification settings
* [Fork
  934](/login?return_to=%2Fcapnproto%2Fcapnproto)
* [Star
   11.9k](/login?return_to=%2Fcapnproto%2Fcapnproto)

* [Code](/capnproto/capnproto)
* [Issues
  180](/capnproto/capnproto/issues)
* [Pull requests
  72](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects
  0](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

Additional navigation options

* [Code](/capnproto/capnproto)
* [Issues](/capnproto/capnproto/issues)
* [Pull requests](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

## Commit

[Permalink](/capnproto/capnproto/commit/104870608fde3c698483fdef6b97f093fc15685d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

SECURITY: CPU usage amplification attack.

[Browse files](/capnproto/capnproto/tree/104870608fde3c698483fdef6b97f093fc15685d)
Browse the repository at this point in the history

```
Details: <https://github.com/sandstorm-io/capnproto/tree/master/security-advisories/2014-03-02-0-all-cpu-amplification.md>
```

* Loading branch information

[![@kentonv](https://avatars.githubusercontent.com/u/4001805?s=40&v=4)](/kentonv)

[kentonv](/capnproto/capnproto/commits?author=kentonv "View all commits by kentonv")
committed
Mar 2, 2015

1 parent
[26bcced](/capnproto/capnproto/commit/26bcceda72372211063d62aab7e45665faa83633)

commit 1048706

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**87 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CONTRIBUTORS
  [CONTRIBUTORS](#diff-ade7d2f0db76f7dc0eef2e96386859ee766b144d13448e2e177a049ffbbdc02a)
* c++/src/capnp

  + c++/src/capnp/arena.h
    [arena.h](#diff-dbf0c264e23e0a4896cb31f47052986af0eb18b4ddf92ebb538446b70daa22f5)
  + c++/src/capnp/encoding-test.c++
    [encoding-test.c++](#diff-8a92553c316004f581e5da839d7a67dbde212077719626af66cfe74b35f3c428)
  + c++/src/capnp/layout.c++
    [layout.c++](#diff-aaaac703062430549c1acd93e348a76eb2ddc42aabdcd0ecc04df1696f884d5b)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[CONTRIBUTORS](#diff-ade7d2f0db76f7dc0eef2e96386859ee766b144d13448e2e177a049ffbbdc02a "CONTRIBUTORS")

Show comments

[View file](/capnproto/capnproto/blob/104870608fde3c698483fdef6b97f093fc15685d/CONTRIBUTORS)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,6 +10,7 @@ Scott Purdy <scott@fer.io>: kj/std iostream interface |
|  |  | Bryan Borham <bjboreham@gmail.com>: Initial MSVC support |
|  |  | Philip Quinn <p@partylemon.com>: cmake build and other assorted bits |
|  |  | Brian Taylor <el.wubo@gmail.com>: emacs syntax highlighting |
|  |  | Ben Laurie <ben@links.org>: discovered and responsibly disclosed security bugs |
|  |  |  |
|  |  | This file does not list people who maintain their own Cap'n Proto |
|  |  | implementations as separate projects. Those people are awesome too! :) |

11 changes: 11 additions & 0 deletions

11
[c++/src/capnp/arena.h](#diff-dbf0c264e23e0a4896cb31f47052986af0eb18b4ddf92ebb538446b70daa22f5 "c++/src/capnp/arena.h")

Show comments

[View file](/capnproto/capnproto/blob/104870608fde3c698483fdef6b97f093fc15685d/c%2B%2B/src/capnp/arena.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -117,6 +117,13 @@ class SegmentReader { |
|  |  |  |
|  |  | KJ\_ALWAYS\_INLINE(bool containsInterval(const void\* from, const void\* to)); |
|  |  |  |
|  |  | KJ\_ALWAYS\_INLINE(bool amplifiedRead(WordCount virtualAmount)); |
|  |  | // Indicates that the reader should pretend that `virtualAmount` additional data was read even |
|  |  | // though no actual pointer was traversed. This is used e.g. when reading a struct list pointer |
|  |  | // where the element sizes are zero -- the sender could set the list size arbitrarily high and |
|  |  | // cause the receiver to iterate over this list even though the message itself is small, so we |
|  |  | // need to defend agaisnt DoS attacks based on this. |
|  |  |  |
|  |  | inline Arena\* getArena(); |
|  |  | inline SegmentId getSegmentId(); |
|  |  |  |
| Expand Down  Expand Up | | @@ -367,6 +374,10 @@ inline bool SegmentReader::containsInterval(const void\* from, const void\* to) { |
|  |  | arena); |
|  |  | } |
|  |  |  |
|  |  | inline bool SegmentReader::amplifiedRead(WordCount virtualAmount) { |
|  |  | return readLimiter->canRead(virtualAmount, arena); |
|  |  | } |
|  |  |  |
|  |  | inline Arena\* SegmentReader::getArena() { return arena; } |
|  |  | inline SegmentId SegmentReader::getSegmentId() { return id; } |
|  |  | inline const word\* SegmentReader::getStartPtr() { return ptr.begin(); } |
| Expand Down | |  |

30 changes: 30 additions & 0 deletions

30
[c++/src/capnp/encoding-test.c++](#diff-8a92553c316004f581e5da839d7a67dbde212077719626af66cfe74b35f3c428 "c++/src/capnp/encoding-test.c++")

Show comments

[View file](/capnproto/capnproto/blob/104870608fde3c698483fdef6b97f093fc15685d/c%2B%2B/src/capnp/encoding-test.c%2B%2B)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1410,6 +1410,36 @@ TEST(Encoding, Has) { |
|  |  | EXPECT\_TRUE(root.asReader().hasInt32List()); |
|  |  | } |
|  |  |  |
|  |  | TEST(Encoding, VoidListAmplification) { |
|  |  | MallocMessageBuilder builder; |
|  |  | builder.initRoot<test::TestAnyPointer>().getAnyPointerField().initAs<List<Void>>(1u << 28); |
|  |  |  |
|  |  | auto segments = builder.getSegmentsForOutput(); |
|  |  | EXPECT\_EQ(1, segments.size()); |
|  |  | EXPECT\_LT(segments[0].size(), 16); // quite small for such a big list! |
|  |  |  |
|  |  | SegmentArrayMessageReader reader(builder.getSegmentsForOutput()); |
|  |  | auto root = reader.getRoot<test::TestAnyPointer>().getAnyPointerField(); |
|  |  | EXPECT\_NONFATAL\_FAILURE(root.getAs<List<TestAllTypes>>()); |
|  |  |  |
|  |  | MallocMessageBuilder copy; |
|  |  | EXPECT\_NONFATAL\_FAILURE(copy.setRoot(reader.getRoot<AnyPointer>())); |
|  |  | } |
|  |  |  |
|  |  | TEST(Encoding, EmptyStructListAmplification) { |
|  |  | MallocMessageBuilder builder; |
|  |  | builder.initRoot<test::TestAnyPointer>().getAnyPointerField() |
|  |  | .initAs<List<test::TestEmptyStruct>>(1u << 28); |
|  |  |  |
|  |  | auto segments = builder.getSegmentsForOutput(); |
|  |  | EXPECT\_EQ(1, segments.size()); |
|  |  | EXPECT\_LT(segments[0].size(), 16); // quite small for such a big list! |
|  |  |  |
|  |  | SegmentArrayMessageReader reader(builder.getSegmentsForOutput()); |
|  |  | auto root = reader.getRoot<test::TestAnyPointer>().getAnyPointerField(); |
|  |  | EXPECT\_NONFATAL\_FAILURE(root.getAs<List<TestAllTypes>>()); |
|  |  | } |
|  |  |  |
|  |  | TEST(Encoding, Constants) { |
|  |  | EXPECT\_EQ(VOID, test::TestConstants::VOID\_CONST); |
|  |  | EXPECT\_EQ(true, test::TestConstants::BOOL\_CONST); |
| Expand Down | |  |

48 changes: 45 additions & 3 deletions

48
[c++/src/capnp/layout.c++](#diff-aaaac703062430549c1acd93e348a76eb2ddc42aabdcd0ecc04df1696f884d5b "c++/src/capnp/layout.c++")

Show comments

[View file](/capnproto/capnproto/blob/104870608fde3c698483fdef6b97f093fc15685d/c%2B%2B/src/capnp/layout.c%2B%2B)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -308,6 +308,11 @@ struct WireHelpers { |
|  |  | return segment == nullptr || segment->containsInterval(start, end); |
|  |  | } |
|  |  |  |
|  |  | static KJ\_ALWAYS\_INLINE(bool amplifiedRead(SegmentReader\* segment, WordCount virtualAmount)) { |
|  |  | // If segment is null, this is an unchecked message, so we don't do read limiter checks. |
|  |  | return segment == nullptr || segment->amplifiedRead(virtualAmount); |
|  |  | } |
|  |  |  |
|  |  | static KJ\_ALWAYS\_INLINE(word\* allocate( |
|  |  | WirePointer\*& ref, SegmentBuilder\*& segment, WordCount amount, |
|  |  | WirePointer::Kind kind, BuilderArena\* orphanArena)) { |
| Expand Down  Expand Up | | @@ -1675,6 +1680,15 @@ struct WireHelpers { |
|  |  | goto useDefault; |
|  |  | } |
|  |  |  |
|  |  | if (wordsPerElement \* (1 \* ELEMENTS) == 0 \* WORDS) { |
|  |  | // Watch out for lists of zero-sized structs, which can claim to be arbitrarily large |
|  |  | // without having sent actual data. |
|  |  | KJ\_REQUIRE(amplifiedRead(srcSegment, elementCount \* (1 \* WORDS / ELEMENTS)), |
|  |  | "Message contains amplified list pointer.") { |
|  |  | goto useDefault; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return setListPointer(dstSegment, dst, |
|  |  | ListReader(srcSegment, ptr, elementCount, wordsPerElement \* BITS\_PER\_WORD, |
|  |  | tag->structRef.dataSize.get() \* BITS\_PER\_WORD, |
| Expand All | | @@ -1693,6 +1707,15 @@ struct WireHelpers { |
|  |  | goto useDefault; |
|  |  | } |
|  |  |  |
|  |  | if (elementSize == ElementSize::VOID) { |
|  |  | // Watch out for lists of void, which can claim to be arbitrarily large without having |
|  |  | // sent actual data. |
|  |  | KJ\_REQUIRE(amplifiedRead(srcSegment, elementCount \* (1 \* WORDS / ELEMENTS)), |
|  |  | "Message contains amplified list pointer.") { |
|  |  | goto useDefault; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return setListPointer(dstSegment, dst, |
|  |  | ListReader(srcSegment, ptr, elementCount, step, dataSize, pointerCount, elementSize, |
|  |  | nestingLimit - 1), |
| Expand Down  Expand Up | | @@ -1931,6 +1954,15 @@ struct WireHelpers { |
|  |  | goto useDefault; |
|  |  | } |
|  |  |  |
|  |  | if (wordsPerElement \* (1 \* ELEMENTS) == 0 \* WORDS) { |
|  |  | // Watch out for lists of zero-sized structs, which can claim to be arbitrarily large |
|  |  | // without having sent actual data. |
|  |  | KJ\_REQUIRE(amplifiedRead(segment, size \* (1 \* WORDS / ELEMENTS)), |
|  |  | "Message contains amplified list pointer.") { |
|  |  | goto useDefault; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (checkElementSize) { |
|  |  | // If a struct list was not expected, then presumably a non-struct list was upgraded to a |
|  |  | // struct list. We need to manipulate the pointer to point at the first field of the |
| Expand Down  Expand Up | | @@ -1988,14 +2020,24 @@ struct WireHelpers { |
|  |  | BitCount dataSize = dataBitsPerElement(ref->listRef.elementSize()) \* ELEMENTS; |
|  |  | WirePointerCount pointerCount = |
|  |  | pointersPerElement(ref->listRef.elementSize()) \* ELEMENTS; |
|  |  | ElementCount elementCount = ref->listRef.elementCount(); |
|  |  | auto step = (dataSize + pointerCount \* BITS\_PER\_POINTER) / ELEMENTS; |
|  |  |  |
|  |  | KJ\_REQUIRE(boundsCheck(segment, ptr, ptr + |
|  |  | roundBitsUpToWords(ElementCount64(ref->listRef.elementCount()) \* step)), |
|  |  | WordCount wordCount = roundBitsUpToWords(ElementCount64(elementCount) \* step); |
|  |  | KJ\_REQUIRE(boundsCheck(segment, ptr, ptr + wordCount), |
|  |  | "Message contains out-of-bounds list pointer.") { |
|  |  | goto useDefault; |
|  |  | } |
|  |  |  |
|  |  | if (elementSize == ElementSize::VOID) { |
|  |  | // Watch out for lists of void, which can claim to be arbitrarily large without having sent |
|  |  | // actual data. |
|  |  | KJ\_REQUIRE(amplifiedRead(segment, elementCount \* (1 \* WORDS / ELEMENTS)), |
|  |  | "Message contains amplified list pointer.") { |
|  |  | goto useDefault; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (checkElementSize) { |
|  |  | if (elementSize == ElementSize::BIT && expectedElementSize != ElementSize::BIT) { |
|  |  | KJ\_FAIL\_REQUIRE( |
| Expand Down  Expand Up | | @@ -2025,7 +2067,7 @@ struct WireHelpers { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return ListReader(segment, ptr, ref->listRef.elementCount(), step, |
|  |  | return ListReader(segment, ptr, elementCount, step, |
|  |  | dataSize, pointerCount, elementSize, nestingLimit - 1); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `1048706`

[![@YankieGurl75](https://avatars.githubusercontent.com/u/84052602?s=80&v=4)](/YankieGurl75)

Copy link

### @YankieGurl75 **[YankieGurl75](/YankieGurl75)** commented on `[1048706](/capnproto/capnproto/commit/104870608fde3c698483fdef6b97f093fc15685d)` [Jun 29, 2021](#commitcomment-52824100)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

108967

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fcommit%2F104870608fde3c698483fdef6b97f093fc15685d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_cc6ca536_20250124_160359.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2015/03/16/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150317045059.C7BA842E06C@smtpvbsrv1.mitre.org>
Date: Tue, 17 Mar 2015 00:50:59 -0400 (EDT)
From: cve-assign@...re.org
To: carnil@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, debian@...lee.co, bernat@...ian.org
Subject: Re: CVE Request: Cap'n Proto: Several issues

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Can you assign CVEs for the following issues in Cap'n Proto? Details
> and fixing commits are referenced in upstream problem descriptions:

> 1/ Integer overflow in pointer validation
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-0-c%2B%2B-integer-overflow.md>
>   - <https://bugs.debian.org/780565>

> Discovered by Ben Laurie

> KJ_REQUIRE(elementTag->structRef.wordSize() / ELEMENTS * ElementCount64(count) <= wordCount,

> KJ_REQUIRE(wordsPerElement * ElementCount64(elementCount) <= wordCount,

> KJ_REQUIRE(ElementCount64(size) * wordsPerElement <= wordCount,

Use CVE-2015-2310.

> 2/ Integer underflow in pointer validation
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-1-c%2B%2B-integer-underflow.md>
>   - <https://bugs.debian.org/780566>

> Discovered by Kenton Varda

> KJ_REQUIRE(size > 0

Use CVE-2015-2311.

> 3/ CPU usage amplification attack
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-2-all-cpu-amplification.md>
>   - <https://bugs.debian.org/780567>

> Discovered by Ben Laurie

> Cap'n Proto takes the philosophy that any security mistake that is
> likely to be common in naively-written application code is in fact a
> bug in Cap'n Proto

> list could claim to have up to 2^29-1 elements while only taking 8 or
> 16 bytes on the wire

> application may notice nothing wrong and proceed to iterate through
> and handle each element in the list, potentially taking a lot of time
> and resources

Use CVE-2015-2312.

> 4/ CPU usage amplification attack #2
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-05-0-c%2B%2B-addl-cpu-amplification.md>
>   - <https://bugs.debian.org/780568>

> Discovered by David Renshaw

> The new case occurs only if the application invokes the totalSize()
> method on an object reader.

Use CVE-2015-2313.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVB7HrAAoJEKllVAevmvms508IAKyyZQLBjgtp7bTd7lpZ5bKQ
tkHPwBKJLt5AyjkgFN+J1lF0ijW1sInbuzs/n35R/yDk7y1LByOqSUqacPiQma2T
XU+yaK13+7H4Cn3w3t9Vukix6CdhvRTlTKpK5ijF9o3PK+oWgFhcvwSiNvQ7H5nW
V3L7cxYOjUlJabqvWI60rHW1mrVSLc5GMOSFrH7Aau39KbDJAa8EkfkRITYz2Ip2
XZWvqobldBY9wgRvDGdDgpgFGvZM5nMv7irNtSnU3va8eEWXTmh5Mzu1IaKwIuZZ
LH5uX91LbcCeRSRgxfHSIn9xuyMhoQrE+GvfXVzzO54U8r6WgitKD3OguALaXU8=
=9zKY
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


