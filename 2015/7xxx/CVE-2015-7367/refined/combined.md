=== Content from github.com_4b5e0875_20250126_042800.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F13d8181f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F13d8181f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=revive-adserver%2Frevive-adserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[revive-adserver](/revive-adserver)
/
**[revive-adserver](/revive-adserver/revive-adserver)**
Public

* [Notifications](/login?return_to=%2Frevive-adserver%2Frevive-adserver) You must be signed in to change notification settings
* [Fork
  568](/login?return_to=%2Frevive-adserver%2Frevive-adserver)
* [Star
   1.3k](/login?return_to=%2Frevive-adserver%2Frevive-adserver)

* [Code](/revive-adserver/revive-adserver)
* [Issues
  153](/revive-adserver/revive-adserver/issues)
* [Pull requests
  23](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

Additional navigation options

* [Code](/revive-adserver/revive-adserver)
* [Issues](/revive-adserver/revive-adserver/issues)
* [Pull requests](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

## Commit

[Permalink](/revive-adserver/revive-adserver/commit/13d8181f90de36de948d2ccbc3b92e9edbc78c74)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix [CVE-2015-7366](https://github.com/advisories/GHSA-rjjr-365w-f42w "CVE-2015-7366")

[Browse files](/revive-adserver/revive-adserver/tree/13d8181f90de36de948d2ccbc3b92e9edbc78c74)
Browse the repository at this point in the history

```
Cross-Site Request Forgery (CSRF)
---------------------------------

N B Sri Harshа has discovered that some plugin actions (e.g. enabling,
disabling) could be performed via GET without any CSRF protection mechanism.
Succesful CSRF attacks could potentially lead to service disruptions in case
some core plugins are disabled. He also discovered that the account-user-*.php
scripts were not actuallly checking the CSRF token sent via POST, allowing
minor attacks, such as changing the victim's contact name and language.

CWE: CWE-532
CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)
```

* Loading branch information

[![@mbeccati](https://avatars.githubusercontent.com/u/282388?s=40&v=4)](/mbeccati)

[mbeccati](/revive-adserver/revive-adserver/commits?author=mbeccati "View all commits by mbeccati")
committed
Oct 6, 2015

1 parent
[b584880](/revive-adserver/revive-adserver/commit/b58488082c5ed3a68c5542a80b2681d525964be2)

commit 13d8181

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**42 additions**
and
**12 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + OA

    - lib/OA/Permission.php
      [Permission.php](#diff-25aaa5a144d2321289838ac9589bf0a4ce8e8d0f0bb3b05e6a132f36c9ff1af6)
  + OX/Plugin

    - lib/OX/Plugin/PluginManager.php
      [PluginManager.php](#diff-ef883d827a5d0b2f3340fae03cf77957f068aa8cc0ec667498f8e31ff2e5c192)
  + templates/admin

    - lib/templates/admin/plugin-index.html
      [plugin-index.html](#diff-00bb98756f37c836370f5b435c7c151674f01c07bf6bb81e18d414dac2c945fc)
    - lib/templates/admin/plugin-uninstall.html
      [plugin-uninstall.html](#diff-7417cff5aad97e397ea205f19b069c82d933389f2d9166ec3c3ca3d2258676bb)
* www/admin

  + www/admin/account-user-email.php
    [account-user-email.php](#diff-2f84509218ea46ce9615b58f95672b3fd7da374919760fd83bef32e4aebbad4d)
  + www/admin/account-user-name-language-timezone.php
    [account-user-name-language-timezone.php](#diff-5556943077e4b4d2030d78e74377de1bdecb78874e932c7b9f68b4d63202ee87)
  + www/admin/account-user-name-language.php
    [account-user-name-language.php](#diff-aee987c347b2dc136d3de02af098c312756b0ea73247e2057ac5fe3c08f1834b)
  + www/admin/account-user-password.php
    [account-user-password.php](#diff-b812508e356af36d1876af51e23c1e560b20688037aa58b8c62e304585a579f7)
  + www/admin/plugin-index.php
    [plugin-index.php](#diff-6e074c819efa627382fdfb9414ab7da2fb3f9196ceeddb116bad6f23355029f9)

## There are no files selected for viewing

7 changes: 6 additions & 1 deletion

7
[lib/OA/Permission.php](#diff-25aaa5a144d2321289838ac9589bf0a4ce8e8d0f0bb3b05e6a132f36c9ff1af6 "lib/OA/Permission.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/lib/OA/Permission.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -93,7 +93,12 @@ class OA\_Permission |
|  |  | \*/ |
|  |  | public static function checkSessionToken() |
|  |  | { |
|  |  | $token = isset($\_GET['token']) ? $\_GET['token'] : false; |
|  |  | if ($\_SERVER['REQUEST\_METHOD'] == 'POST') { |
|  |  | $token = isset($\_POST['token']) ? $\_POST['token'] : false; |
|  |  | } else { |
|  |  | $token = isset($\_GET['token']) ? $\_GET['token'] : false; |
|  |  | } |
|  |  |  |
|  |  | OA\_Permission::enforceTrue( |
|  |  | phpAds\_SessionValidateToken($token) |
|  |  | ); |
| Expand Down | |  |

5 changes: 0 additions & 5 deletions

5
[lib/OX/Plugin/PluginManager.php](#diff-ef883d827a5d0b2f3340fae03cf77957f068aa8cc0ec667498f8e31ff2e5c192 "lib/OX/Plugin/PluginManager.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/lib/OX/Plugin/PluginManager.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -235,11 +235,6 @@ function unpackPlugin($aFile, $overwrite = true, $checkOnly = false) |
|  |  | //OA::logMem('enter unpackPlugin'); |
|  |  | $this->\_switchToPluginLog(); |
|  |  | try { |
|  |  | phpAds\_registerGlobalUnslashed('token'); |
|  |  | if ((OA\_INSTALLATION\_STATUS == OA\_INSTALLATION\_STATUS\_INSTALLED) && !phpAds\_SessionValidateToken($GLOBALS['token'])) |
|  |  | { |
|  |  | throw new Exception('Invalid request token'); |
|  |  | } |
|  |  | if ($this->configLocked) { |
|  |  | throw new Exception('Configuration file is locked unable to unpack'.$aFile['name']); |
|  |  | } |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[lib/templates/admin/plugin-index.html](#diff-00bb98756f37c836370f5b435c7c151674f01c07bf6bb81e18d414dac2c945fc "lib/templates/admin/plugin-index.html")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/lib/templates/admin/plugin-index.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -106,17 +106,17 @@ <h2>Install new plugin</h2> |
|  |  | </td> |
|  |  | <td>{if {$aitem.authoremail}<a href="mailto:{$aitem.authoremail}">{/if}{$aitem.author}{if {$aitem.authoremail}</a>{/if}</td> |
|  |  | <td>{if $aitem.enabled > 0}Enabled{else}Disabled{/if}</td> |
|  |  | <td><a href='plugin-index.php?action=info&package={$name}' ><span class="action icon details">Details</span></a></td> |
|  |  | <td><a href='plugin-index.php?action=info&amp;package={$name}' ><span class="action icon details">Details</span></a></td> |
|  |  | <td> |
|  |  | {if $configLocked}&nbsp;{else} |
|  |  | {if $aitem.enabled > 0} |
|  |  | <a href='plugin-index.php?action=disable&package={$name}' ><span class="action icon disable">Disable</span></a> |
|  |  | <a href='plugin-index.php?action=disable&amp;package={$name}&amp;{rv\_add\_session\_token}' ><span class="action icon disable">Disable</span></a> |
|  |  | {else} |
|  |  | <a href='plugin-index.php?action=enable&package={$name}' ><span class="action icon enable">Enable</span></a> |
|  |  | <a href='plugin-index.php?action=enable&amp;package={$name}&amp;{rv\_add\_session\_token}' ><span class="action icon enable">Enable</span></a> |
|  |  | {/if} |
|  |  | {/if} |
|  |  | </td> |
|  |  | {if $configLocked}&nbsp;{else}<td><a href='plugin-index.php?action=uninstall&package={$name}' ><span class="action icon uninstall">Uninstall</span></a></td>{/if} |
|  |  | {if $configLocked}&nbsp;{else}<td><a href='plugin-index.php?action=uninstall&amp;package={$name}&amp;{rv\_add\_session\_token}' ><span class="action icon uninstall">Uninstall</span></a></td>{/if} |
|  |  | </tr> |
|  |  | {/if} |
|  |  | {/foreach} |
| Expand Down | |  |

5 changes: 3 additions & 2 deletions

5
[lib/templates/admin/plugin-uninstall.html](#diff-7417cff5aad97e397ea205f19b069c82d933389f2d9166ec3c3ca3d2258676bb "lib/templates/admin/plugin-uninstall.html")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/lib/templates/admin/plugin-uninstall.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,7 +41,8 @@ |
|  |  | <br /> |
|  |  | <form name="packageform" id="packageform" method="post" action="plugin-index.php" enctype="multipart/form-data"> |
|  |  | <input name="package" value="{$aPackage.name}" type="hidden"> |
|  |  | <input value="< Back" name="back" tabindex="0" type="submit"> |
|  |  | <input value="Uninstall" name="uninstallConfirmed" tabindex="1" type="submit"> |
|  |  | <input name="token" value="{$token}" type="hidden"> |
|  |  | <input value="< Back" name="back" tabindex="0" type="button" onclick="location.href='plugin-index.php'"> |
|  |  | <input value="Uninstall" name="uninstallConfirmed" tabindex="1" type="submit"> |
|  |  | </form> |
|  |  | </div> |

2 changes: 2 additions & 0 deletions

2
[www/admin/account-user-email.php](#diff-2f84509218ea46ce9615b58f95672b3fd7da374919760fd83bef32e4aebbad4d "www/admin/account-user-email.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/www/admin/account-user-email.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,6 +39,8 @@ |
|  |  | 'email\_address' |
|  |  | ); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | // Get the DB\_DataObject for the current user |
|  |  | $doUsers = OA\_Dal::factoryDO('users'); |
|  |  | $doUsers->get(OA\_Permission::getUserId()); |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/account-user-name-language-timezone.php](#diff-5556943077e4b4d2030d78e74377de1bdecb78874e932c7b9f68b4d63202ee87 "www/admin/account-user-name-language-timezone.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/www/admin/account-user-name-language-timezone.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,6 +39,8 @@ |
|  |  | 'language' |
|  |  | ); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | // Get the DB\_DataObject for the current user |
|  |  | $doUsers = OA\_Dal::factoryDO('users'); |
|  |  | $doUsers->get(OA\_Permission::getUserId()); |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/account-user-name-language.php](#diff-aee987c347b2dc136d3de02af098c312756b0ea73247e2057ac5fe3c08f1834b "www/admin/account-user-name-language.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/www/admin/account-user-name-language.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,6 +42,8 @@ |
|  |  | 'language' |
|  |  | ); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | // Get the DB\_DataObject for the current user |
|  |  | $doUsers = OA\_Dal::factoryDO('users'); |
|  |  | $doUsers->get(OA\_Permission::getUserId()); |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[www/admin/account-user-password.php](#diff-b812508e356af36d1876af51e23c1e560b20688037aa58b8c62e304585a579f7 "www/admin/account-user-password.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/www/admin/account-user-password.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,6 +39,9 @@ |
|  |  | 'pw', |
|  |  | 'pw2' |
|  |  | ); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | // Get the DB\_DataObject for the current user |
|  |  | $doUsers = OA\_Dal::factoryDO('users'); |
|  |  | $doUsers->get(OA\_Permission::getUserId()); |
| Expand Down | |  |

20 changes: 20 additions & 0 deletions

20
[www/admin/plugin-index.php](#diff-6e074c819efa627382fdfb9414ab7da2fb3f9196ceeddb116bad6f23355029f9 "www/admin/plugin-index.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/13d8181f90de36de948d2ccbc3b92e9edbc78c74/www/admin/plugin-index.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,20 +34,26 @@ |
|  |  | //install |
|  |  | if (array\_key\_exists('install',$\_POST)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (array\_key\_exists('filename',$\_FILES)) |
|  |  | { |
|  |  | $oPluginManager->installPackage($\_FILES['filename']); |
|  |  | } |
|  |  | } |
|  |  | else if (array\_key\_exists('import',$\_POST)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (array\_key\_exists('filename',$\_FILES)) |
|  |  | { |
|  |  | $oPluginManager->installPackageCodeOnly($\_FILES['filename']); |
|  |  | } |
|  |  | } |
|  |  | else if (array\_key\_exists('upgrade',$\_POST)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (array\_key\_exists('filename',$\_FILES)) |
|  |  | { |
|  |  | $oPluginManager->upgradePackage($\_FILES['filename'],$plugin); |
| Expand All | | @@ -71,6 +77,8 @@ |
|  |  | } |
|  |  | else if (array\_key\_exists('diagnose',$\_POST)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $oTpl = new OA\_Admin\_Template('plugin-view.html'); |
|  |  | $aPackageInfo = $oPluginManager->getPackageInfo($plugin); |
|  |  | $aComponents = $aPackageInfo['contents']; |
| Expand All | | @@ -96,6 +104,8 @@ |
|  |  | } |
|  |  | else if (array\_key\_exists('export',$\_POST)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | require\_once LIB\_PATH.'/Plugin/PluginExport.php'; |
|  |  | $oExporter = new OX\_PluginExport(); |
|  |  | if ($file = $oExporter->exportPlugin($plugin)) |
| Expand All | | @@ -121,6 +131,8 @@ |
|  |  | } |
|  |  | else if (array\_key\_exists('backup',$\_POST)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | require\_once LIB\_PATH.'/Plugin/PluginExport.php'; |
|  |  | $oExporter = new OX\_PluginExport(); |
|  |  | $oExporter->init($plugin); |
| Expand All | | @@ -145,6 +157,8 @@ |
|  |  | //actions |
|  |  | else if ('uninstall' == $action) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $oTpl = new OA\_Admin\_Template('plugin-uninstall.html'); |
|  |  | $aPackageInfo = $oPluginManager->getPackageInfo($plugin); |
|  |  | $aComponents = $aPackageInfo['contents']; |
| Expand All | | @@ -161,6 +175,8 @@ |
|  |  | } |
|  |  | else if (array\_key\_exists('uninstallConfirmed',$\_POST)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $oPluginManager->uninstallPackage($plugin); |
|  |  | if (!($oPluginManager->countErrors() || $oPluginManager->countWarnings())) |
|  |  | { |
| Expand All | | @@ -169,6 +185,8 @@ |
|  |  | } |
|  |  | else if ('enable' == $action) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if ($plugin) |
|  |  | { |
|  |  | $oPluginManager->enablePackage($plugin); |
| Expand All | | @@ -180,6 +198,8 @@ |
|  |  | } |
|  |  | else if ('disable' == $action) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if ($plugin) |
|  |  | { |
|  |  | $oPluginManager->disablePackage($plugin); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `13d8181`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F13d8181f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.revive-adserver.com_0fb5f14b_20250124_232506.html ===


* [Facebook](https://www.facebook.com/WeAreReviveAdserver/)
* [RSS](https://www.revive-adserver.com/feed/)

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sec_menu "Hosted edition of Revive Adserver – sign up and get started in no time!")
* [Community Forum](https://forum.revive-adserver.com/)
* [Documentation](https://documentation.revive-adserver.com/)
* [Github](https://github.com/revive-adserver/revive-adserver/)
* [Patreon](https://patreon.com/revive_adserver "Sponsor us on Patreon")

[![Revive Adserver](https://www.revive-adserver.com/media/Revive-Adserver-logo.png)
# Download edition](https://www.revive-adserver.com/)

* [Download](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Features](https://www.revive-adserver.com/features/ "Features of Revive Adserver")
  + [Inventory](https://www.revive-adserver.com/features/#inventory "Managing inventory")
  + [Statistics](https://www.revive-adserver.com/features/#statistics "Review your Statistics")
  + [Open Source](https://www.revive-adserver.com/features/#open_source "Free, Open Source, Privacy Proof")
* [How to](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver")
  + [Get Started](https://www.revive-adserver.com/how-to/get-started/ "How to Get started with Revive Adserver")
  + [Manage Advertisers](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manage Advertisers in Revive Adserver")
    - [Create an Advertiser](https://www.revive-adserver.com/how-to/create-an-advertiser/ "How to Create an Advertiser in Revive Adserver")
    - [More about Advertisers…](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manager Advertisers in Revive Adserver")
  + [Manage Campaigns](https://www.revive-adserver.com/how-to/manage-campaigns/ "How to create and manage campaigns in Revive Adserver")
    - [Create a Campaign](https://www.revive-adserver.com/how-to/create-a-campaign/ "How to create a Campaign in Revive Adserver")
    - [Link a campaign to zones](https://www.revive-adserver.com/how-to/link-a-campaign-to-zones/ "How to link a campaign to zones in Revive Adserver")
    - [More about Campaigns…](https://www.revive-adserver.com/how-to/manage-campaigns/)
  + [Manage Banners](https://www.revive-adserver.com/how-to/manage-banners/ "How to manage banners in Revive Adserver")
    - [Create a Banner](https://www.revive-adserver.com/how-to/create-a-banner/ "How to create a banner in Revive Adserver")
    - [Define Delivery Rules](https://www.revive-adserver.com/how-to/define-delivery-rules-for-a-banner/ "How to define Delivery Rules for a Banner in Revive Adserver")
    - [More about Banners…](https://www.revive-adserver.com/how-to/manage-banners/ "More articles about managing banners in Revive Adserver")
  + [Manage Websites](https://www.revive-adserver.com/how-to/manage-websites/ "How to manage websites in Revive Adserver")
    - [Create a Website](https://www.revive-adserver.com/how-to/create-a-website/ "How to Create a Website in Revive Adserver")
  + [Manage Zones](https://www.revive-adserver.com/how-to/manage-zones/ "How to manage Zones in Revive Adserver")
    - [Create a Zone](https://www.revive-adserver.com/how-to/create-a-zone/ "How to create a Zone in Revive Adserver")
    - [Create Zone Invocation Code](https://www.revive-adserver.com/how-to/create-zone-invocation-code/ "How to Create Zone Invocation Code in Revive Adserver")
    - [More about Zones…](https://www.revive-adserver.com/how-to/manage-zones/)
  + [Manage Preferences](https://www.revive-adserver.com/how-to/manage-preferences/ "Manage Preferences in Revive Adserver")
    - [Create Delivery Rule Sets](https://www.revive-adserver.com/how-to/create-delivery-rule-sets/ "Create Delivery Rule Sets in Revive Adserver")
  + [Install and Update](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating Revive Adserver")
    - [Install Revive Adserver](https://www.revive-adserver.com/how-to/install/ "How to Install Revive Adserver on your server")
    - [Update Revive Adserver](https://www.revive-adserver.com/how-to/update/ "How to Update Revive Adserver to a new version")
    - [More about Installation and Updating…](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating the Revive Adserver software")
  + [Manage Configuration](https://www.revive-adserver.com/how-to/manage-configuration/ "Articles about How to Configure Revive Adserver")
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions about Revive Adserver")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
  + [Can I sponsor Revive Adserver?](https://www.revive-adserver.com/about/our-sponsors/)
  + [Using Google AdSense with Revive Adserver](https://www.revive-adserver.com/faq/using-google-adsense-with-revive-adserver/)
  + [Geotargeting with Revive Adserver](https://www.revive-adserver.com/faq/geotargeting-with-revive-adserver/)
  + [Troubleshooting banner delivery](https://www.revive-adserver.com/faq/troubleshooting-banner-delivery/)
* [Support](https://www.revive-adserver.com/support/ "Support for Revive Adserver")
  + [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
  + [Documentation](https://documentation.revive-adserver.com/)
  + [Forums](https://forum.revive-adserver.com/ "Revive Adserver Community Forums")
  + [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
  + [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
* [About](https://www.revive-adserver.com/about/ "About Revive Adserver")
  + [Our sponsors](https://www.revive-adserver.com/about/our-sponsors/)
  + [Active Revive Adserver instances](https://www.revive-adserver.com/about/active-revive-adserver-instances/)
  + [User Reviews](https://www.revive-adserver.com/about/user-reviews-about-revive-adserver/ "User Reviews about Revive Adserver")
* [Blog](https://www.revive-adserver.com/blog/ "Revive Adserver blog")

Select Page

# Revive Adserver Security Advisory REVIVE-SA-2015-001

## Revive Adserver Security Advisory REVIVE-SA-2015-001

* Advisory ID: [REVIVE-SA-2015-001](https://www.revive-adserver.com/security/revive-sa-2015-001/)
* CVE-IDs: CVE-2015-7364, CVE-2015-7365, CVE-2015-7366, CVE-2015-7367, CVE-2015-7368, CVE-2015-7369, CVE-2015-7370, CVE-2015-7371, CVE-2015-7372, CVE-2015-7373
* Date: 2015-10-07
* Risk Level: Medium
* Applications affected: Revive Adserver
* Versions affected: <= 3.2.1
* Versions not affected: >= 3.2.2
* Website: <https://www.revive-adserver.com/>

## Vulnerability 1 – Cross-Site Request Forgery (CSRF)

* CVE-ID: CVE-2015-7364
* CWE-ID: CWE-352
* CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)

### Description

Abdullah Hussam Gazi discovered that the CSRF protection mechanism introduced a few years ago to secure the forms generated with the HTML\_Quickform library (most of the forms in Revive Adserver’s admin UI) could be easily bypassed by sending an empty token along with the POST data. The range of malicious actions includes, but is not limited to, modifying entities like banners and zones and altering preferences and settings.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7364
* http://cwe.mitre.org/data/definitions/352.html
* https://github.com/revive-adserver/revive-adserver/commit/288f81cc

## Vulnerability 2 – Reflected XSS

* CVE-ID: CVE-2015-7365
* CWE-ID: CWE-79
* CVSSv2: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)

### Description

Abdullah Hussam Gazi has discovered that the plugin upgrade form was not properly escaping filenames before displaying them when uploading a file containing errors. Exploiting the vulnerability required a specifically crafted multipart POST message.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7365
* http://cwe.mitre.org/data/definitions/79.html
* https://github.com/revive-adserver/revive-adserver/commit/b5848808

## Vulnerability 3 – Cross-Site Request Forgery (CSRF)

* CVE-ID: CVE-2015-7366
* CWE-ID: CWE-532
* CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)

### Description

N B Sri Harsha has discovered that some plugin actions (e.g. enabling, disabling) could be performed via GET without any CSRF protection mechanism. Successful CSRF attacks could potentially lead to service disruptions in the case of core plugins being disabled. He also discovered that the account-user-\*.php scripts were not checking the CSRF token sent via POST, allowing minor attacks, such as changing the victim’s contact name and language.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7366
* http://cwe.mitre.org/data/definitions/352.html
* https://github.com/revive-adserver/revive-adserver/commit/13d8181f

## Vulnerability 4 – Improper Access Control

* CVE-ID: CVE-2015-7367
* CWE-ID: CWE-284
* CVSSv2: 4.6 (AV:N/AC:H/Au:S/C:P/I:P/A:P)

### Description

N B Sri Harsha discovered that deleting or unlinking users with an active session didn’t have any effect until the session was expired, potentially allowing the users to perform undesired actions while such sessions were still active.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7367
* http://cwe.mitre.org/data/definitions/284.html
* https://github.com/revive-adserver/revive-adserver/commit/ccbd1cc5

## Vulnerability 5 – Information Exposure Through Browser Caching

* CVE-ID: CVE-2015-7368
* CWE-ID: CWE-525
* CVSSv2: 2.1 (AV:L/AC:L/Au:N/C:P/I:N/A:N)

### Description

N B Sri Harsha has discovered that the cached copies of pages visited in Revive Adserver’s admin UI were still reachable via the browser history after successfully logging out. This potentially allowed expose of sensitive information to unauthorised parties.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7368
* http://cwe.mitre.org/data/definitions/525.html
* https://github.com/revive-adserver/revive-adserver/commit/15aac363
* https://github.com/revive-adserver/revive-adserver/commit/c76f675d

## Vulnerability 6 – Overly Permissive Cross-domain Whitelist

* CVE-ID: CVE-2015-7369
* CWE-ID: CWE-942
* CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)

### Description

Sergey Markov has reported that the crossdomain.xml files shipped with Revive Adserver are overly permissive. On a default installation they could in fact be exploited with malicious intents, e.g. to steal session cookies.

## References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7369
* http://cwe.mitre.org/data/definitions/942.html
* https://github.com/revive-adserver/revive-adserver/commit/4be0aa55

## Vulnerability 7 – Reflected XSS

* CVE-ID: CVE-2015-7370
* CWE-ID: CWE-79
* CVSSv2: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)

### Description

Sergey Markov has discovered that the open-flash-chart.swf file, used by the VideoAds plugin in Revive Adserver, was vulnerable to reflected XSS attacks on the id and data-file parameters. This file was included via the third party LGPLv2 graphing library, Open Flash Chart 2, which appears to be currently unmaintained. The Revive Adserver team has therefore decided to fix the vulnerabilities that had been reported and to publish a github repository for the library, containing its history and the vulnerability fixes, for the benefit of everyone else using it: https://github.com/revive-adserver/open-flash-chart

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7370
* http://cwe.mitre.org/data/definitions/79.html
* https://github.com/revive-adserver/revive-adserver/commit/202eb15c
* https://github.com/revive-adserver/revive-adserver/commit/e9cda5a4
* https://github.com/revive-adserver/open-flash-chart/commit/0a181c56

## Vulnerability 8 – Improper Access Control

* CVE-ID: CVE-2015-7371
* CWE-ID: CWE-284
* CVSSv2: 5.0 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

Krzysztof K. Wasielewski reported that run-mpe.php, a script used by the admin UI to asynchronously trigger a run of the Maintenance Priority Engine when necessary, was lacking proper authentication and access control and could therefore be called by any third party. Running maintenance is a resource intensive task, although a locking mechanism prevents it from being run multiple times concurrently; thus, run-mpe.php cannot be used alone for a resource exhaustion attack.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7371
* http://cwe.mitre.org/data/definitions/284.html
* https://github.com/revive-adserver/revive-adserver/commit/12cefa6f

## Vulnerability 9 – Local File Inclusion

* CVE-ID: CVE-2015-7372
* CWE-ID: CWE-98
* CVSSv2: 7.6 (AV:N/AC:H/Au:N/C:C/I:C/A:C)

### Description

Krzysztof K. Wasielewski reported that the layerstyle parameter in al.php was not properly sanitized, causing a potential LFI vulnerability. Under normal circumstances, an attacker would need to place a file named layerstyle.inc.php in an arbitrary directory on the server and craft the layerstyle parameter accordingly to load it. If an old version of PHP is being used the server, other attack techniques might be possible, e.g. NULL-byte truncation.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7372
* http://cwe.mitre.org/data/definitions/98.html
* https://github.com/revive-adserver/revive-adserver/commit/86b623f8
* https://github.com/revive-adserver/revive-adserver/commit/c76f675d

## Vulnerability 10 – Reflected XSS (Cross-site scripting)

* CVE-ID: CVE-2015-7373
* CWE-ID: CWE-79
* CVSSv2: 7.6 (AV:N/AC:H/Au:N/C:C/I:C/A:C)

### Description

A feature called “magic-macros” in Revive Adserver allows dynamic data to be displayed in the banner output. There is a predefined set of such macros (e.g. {random}, {clickurl}, etc.), but the feature also allows the display of arbitrary GET parameters. A user reported that the values coming from GET parameters were not properly escaped before being displayed, thus making banners using such magic-macros a potential vector for XSS attacks.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7373
* http://cwe.mitre.org/data/definitions/79.html
* https://github.com/revive-adserver/revive-adserver/commit/c40abff6
* https://github.com/revive-adserver/revive-adserver/commit/c76f675d

## Solution

We strongly advise people to upgrade to the most recent 3.2.2 release of Revive Adserver, including those running OpenX Source or older versions of the application.

## Contact Information

The security contact for Revive Adserver can be reached at: <security AT revive-adserver DOT com>

Please review [https://www.revive-adserver.com/security/](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team") before doing so.

#### Current Stable Release

* [Version 5.5.2](https://www.revive-adserver.com/download/ "Download the latest stable version of Revive Adserver")
#### How can we help?

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sidebar "Hosted edition of Revive Adserver – Subscribe to get started in no time!")
* [Download edition](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
* [Documentation](https://documentation.revive-adserver.com/)
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions")
* [Forums](https://forum.revive-adserver.com/)
* [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
#### How can you help?

* [Sponsor Us](https://www.revive-adserver.com/about/our-sponsors/)
* [Translate to your language](https://translations.revive-adserver.com/ "Help us by translating the Revive Adserver software to your language")
#### Other information

* [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
* [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and privacy")

#### Current Stable Release

**v5.5.2** · [Download now](https://www.revive-adserver.com/download/)
released April 17, 2024
Read our [Release notes](https://www.revive-adserver.com/categories/release-notes/) blog posts.

#### How to use Revive Adserver

We have a collection of [articles explaining how to use the Revive Adserver software](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver"), with tips and best practices.

#### Hosted edition

Revive Adserver is also available as a [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=page_footer "Revive Adserver Hosted edition"), with costs as low as $10 per month.

#### Project Information

Revive Adserver is a project by

**[Aqua Platform](http://www.aquaplatform.com/ "Aqua Platform")**.

* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")
#### Become a sponsor

You can be a sponsor of the Revive Adserver open source project, by [contributing to our project on Patreon](https://www.patreon.com/revive_adserver). Even just $10 per month will help.

[![](https://www.revive-adserver.com/media/become_a_patron_button.png)](https://www.patreon.com/revive_adserver)

We also have other [sponsors](https://www.revive-adserver.com/about/our-sponsors/ "A list of companies and individuals who have sponsored our project").

#### Website hosting

This website is hosted by [Aqua Platform](https://www.aquaplatform.com/), specialists in next generation cloud based [Revive Adserver Hosting](https://www.aquaplatform.com/revive-adserver-hosting/), systems and technology.

* [Home](https://www.revive-adserver.com/)
* [Privacy](https://www.revive-adserver.com/privacy/ "Privacy and Revive Adserver")
* [Security](https://www.revive-adserver.com/security/)

[Revive Adserver Download edition](https://www.revive-adserver.com/) is © 2013-2025 by [Aqua Platform](https://www.aquaplatform.com/) · All Rights Reserved.

* [Follow](https://github.com/revive-adserver/revive-adserver/ "Follow on GitHub")
* [Follow](https://www.patreon.com/revive_adserver "Follow on Patreon")
* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")



=== Content from seclists.org_33cccdb0_20250124_232500.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](31)
[By Date](date.html#32)
[![Next](/images/right-icon-16x16.png)](39)

[![Previous](/images/left-icon-16x16.png)](31)
[By Thread](index.html#32)
[![Next](/images/right-icon-16x16.png)](39)

![](/shared/images/nst-icons.svg#search)

# [REVIVE-SA-2015-001] Revive Adserver - Multiple vulnerabilities

---

*From*: Matteo Beccati <matteo () beccati com>

*Date*: Wed, 7 Oct 2015 14:41:04 +0200

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

========================================================================
Revive Adserver Security Advisory                     REVIVE-SA-2015-001
========================================================================
<http://www.revive-adserver.com/security/revive-sa-2015-001>
========================================================================
CVE-IDs:               CVE-2015-7364, CVE-2015-7365, CVE-2015-7366,
                       CVE-2015-7367, CVE-2015-7368, CVE-2015-7369,
                       CVE-2015-7370, CVE-2015-7371, CVE-2015-7372,
                       CVE-2015-7373
Date:                  2015-10-07
Risk Level:            Medium
Applications affected: Revive Adserver
Versions affected:     <= 3.2.1
Versions not affected: >= 3.2.2
Website:               <http://www.revive-adserver.com/>
========================================================================

========================================================================
Vulnerability 1 - Cross-Site Request Forgery (CSRF)
========================================================================
CVE-ID: CVE-2015-7364
CWE-ID: CWE-352
CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)
========================================================================

Abdullah Hussam Gazi discovered that the CSRF protection mechanism
introduced a few years ago to secure the forms generated with the
HTML_Quickform library (most of the forms in Revive Adserver's admin
UI) could be easily bypassed by sending an empty token along with the
POST data. The range of malicious actions includes, but is not limited
to, modifying entities like banners and zones and altering preferences
and settings.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7364>
<http://cwe.mitre.org/data/definitions/352.html>
<https://github.com/revive-adserver/revive-adserver/commit/288f81cc>

========================================================================
Vulnerability 2 - Reflected XSS
========================================================================
CVE-ID: CVE-2015-7365
CWE-ID: CWE-79
CVSSv2: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)
========================================================================

Abdullah Hussam Gazi has discovered that the plugin upgrade form was
not properly escaping filenames before displaying them when uploading
a file containing errors. Exploiting the vulnerability required a
specifically crafted multipart POST message.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7365>
<http://cwe.mitre.org/data/definitions/79.html>
<https://github.com/revive-adserver/revive-adserver/commit/b5848808>

========================================================================
Vulnerability 3 - Cross-Site Request Forgery (CSRF)
========================================================================
CVE-ID: CVE-2015-7366
CWE-ID: CWE-532
CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)
========================================================================

N B Sri Harsha has discovered that some plugin actions (e.g. enabling,
disabling) could be performed via GET without any CSRF protection
mechanism. Successful CSRF attacks could potentially lead to service
disruptions in the case of core plugins being disabled. He also
discovered that the account-user-*.php scripts were not checking the
CSRF token sent via POST, allowing minor attacks, such as changing the
victim's contact name and language.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7366>
<http://cwe.mitre.org/data/definitions/352.html>
<https://github.com/revive-adserver/revive-adserver/commit/13d8181f>

========================================================================
Vulnerability 4 - Improper Access Control
========================================================================
CVE-ID: CVE-2015-7367
CWE-ID: CWE-284
CVSSv2: 4.6 (AV:N/AC:H/Au:S/C:P/I:P/A:P)
========================================================================

N B Sri Harsha discovered that deleting or unlinking users with an
active session didn't have any effect until the session was expired,
potentially allowing the users to perform undesired actions while such
sessions were still active.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7367>
<http://cwe.mitre.org/data/definitions/284.html>
<https://github.com/revive-adserver/revive-adserver/commit/ccbd1cc5>

========================================================================
Vulnerability 5 - Information Exposure Through Browser Caching
========================================================================
CVE-ID: CVE-2015-7368
CWE-ID: CWE-525
CVSSv2: 2.1 (AV:L/AC:L/Au:N/C:P/I:N/A:N)
========================================================================

N B Sri Harsha has discovered that the cached copies of pages visited
in Revive Adserver's admin UI were still reachable via the browser
history after successfully logging out. This potentially allowed
exposuse of sensitive information to unauthorised parties.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7368>
<http://cwe.mitre.org/data/definitions/525.html>
<https://github.com/revive-adserver/revive-adserver/commit/15aac363>
<https://github.com/revive-adserver/revive-adserver/commit/c76f675d>

========================================================================
Vulnerability 6 - Overly Permissive Cross-domain Whitelist
========================================================================
CVE-ID: CVE-2015-7369
CWE-ID: CWE-942
CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)
========================================================================

Sergey Markov has reported that the crossdomain.xml files shipped with
Revive Adserver are overly permissive. On a default installation they
could in fact be exploited with malicious intents, e.g. to steal
session cookies.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7369>
<http://cwe.mitre.org/data/definitions/942.html>
<https://github.com/revive-adserver/revive-adserver/commit/4be0aa55>

========================================================================
Vulnerability 7 - Reflected XSS
========================================================================
CVE-ID: CVE-2015-7370
CWE-ID: CWE-79
CVSSv2: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)
========================================================================

Sergey Markov has discovered that the open-flash-chart.swf file, used
by the VideoAds plugin in Revive Adserver, was vulnerable to reflected
XSS attacks on the id and data-file parameters. This file was included
via the third party LGPLv2 graphing library, Open Flash Chart 2, which
appears to be currently unmaintained. The Revive Adserver team has
therefore decided to fix the vulnerabilities that had been reported
and to publish a github repository for the library, containing its
history and the vulnerability fixes, for the benefit of everyone else
using it:

<https://github.com/revive-adserver/open-flash-chart>

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7370>
<http://cwe.mitre.org/data/definitions/79.html>
<https://github.com/revive-adserver/revive-adserver/commit/202eb15c>
<https://github.com/revive-adserver/revive-adserver/commit/e9cda5a4>
<https://github.com/revive-adserver/open-flash-chart/commit/0a181c56>

========================================================================
Vulnerability 8 - Improper Access Control
========================================================================
CVE-ID: CVE-2015-7371
CWE-ID: CWE-284
CVSSv2: 5.0 (AV:N/AC:L/Au:N/C:N/I:N/A:P)
========================================================================

Krzysztof K. Wasielewski reported that run-mpe.php, a script used by
the admin UI to asynchronously trigger a run of the Maintenance
Priority Engine when necessary, was lacking proper authentication and
access control and could therefore be called by any third party.
Running maintenance is a resource intensive task, although a locking
mechanism prevents it from being run multiple times concurrently;
thus, run-mpe.php cannot be used alone for a resource exhaustion attack.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7371>
<http://cwe.mitre.org/data/definitions/284.html>
<https://github.com/revive-adserver/revive-adserver/commit/12cefa6f>

========================================================================
Vulnerability 9 - Local File Inclusion
========================================================================
CVE-ID: CVE-2015-7372
CWE-ID: CWE-98
CVSSv2: 7.6 (AV:N/AC:H/Au:N/C:C/I:C/A:C)
========================================================================

Krzysztof K. Wasielewski reported that the layerstyle parameter in
al.php was not properly sanitized, causing a potential LFI
vulnerability. Under normal circumstances, an attacker would need to
place a file named layerstyle.inc.php in an arbitrary directory on the
server and craft the layerstyle parameter accordingly to load it. If
an old version of PHP is being used the server, other attack
techniques might be possible, e.g. NULL-byte truncation.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7372>
<http://cwe.mitre.org/data/definitions/98.html>
<https://github.com/revive-adserver/revive-adserver/commit/86b623f8>
<https://github.com/revive-adserver/revive-adserver/commit/c76f675d>

========================================================================
Vulnerability 10 - Reflected XSS (Cross-site scripting)
========================================================================
CVE-ID: CVE-2015-7373
CWE-ID: CWE-79
CVSSv2: 7.6 (AV:N/AC:H/Au:N/C:C/I:C/A:C)
========================================================================

A feature called "magic-macros" in Revive Adserver allows dynamic data
to be displayed in the banner output. There is a predefined set of
such macros (e.g. {random}, {clickurl}, etc.), but the feature also
allows the display of arbitrary GET parameters. A user reported that
the values coming from GET parameters were not properly escaped before
being displayed, thus making banners using such magic-macros a
potential vector for XSS attacks.

References
==========
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7373>
<http://cwe.mitre.org/data/definitions/79.html>
<https://github.com/revive-adserver/revive-adserver/commit/c40abff6>
<https://github.com/revive-adserver/revive-adserver/commit/c76f675d>

========================================================================
Solution
========================================================================

We strongly advise people to upgrade to the most recent 3.2.2 release
of Revive Adserver, including those running OpenX Source or older
versions of the application.

========================================================================
Contact Information
========================================================================

The security contact for Revive Adserver can be reached at:
<security AT revive-adserver DOT com>.

Please review <http://www.revive-adserver.com/security/> before doing so.

- --
Matteo Beccati
On behalf of the Revive Adserver Team
<http://www.revive-adserver.com/>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJWFRLgAAoJEHlDnsQiEkAuOBgP/2IgkP38ImnuYPPI5XvOh9MY
cU58ZRg7kNcmhTljuX2k53Pm5hDjaYJyGXHPe2vjscTavWDmBlfugd5l8d0qDrHD
VptB+ItlMvynhaBU18P/EeKL/cJ8xZh7k0NpGJbW7An2ZbCp2c238QBcces/BfDH
2monCBCifZkT0lLsEIQMaVU84Cj3WR5jFOR3+aK+JZ4vk7FvZ1Vc1Fl8FvkZMSVy
RAGlRsnHTga2Yw4k8Lcg6dYynSZt34x85VUXiUHISN7O8vnJq0LPDfdQy0CYKhzO
p/Ffj75KX78qwdEf/kvz57LrkGXnw5fbkrlpysIun5NRhmgaY25t5KS/jovjdKdO
wf0eScDTKJG1VJngIWQVJc2din7dYNJkD53Sl28HOm37BeZJ/adAZl68vU0KJFe9
T62YzbHlsQnmScdZELv/CWdbbCxJIy+5XQKYDUuXPPA9sz6HlYmMg2CE4MsD/Ns9
Dzgd1DI2Y1GRN0u4SWG+GSYf63IWPg/taQSkztHdzxTCoRHVWWoCiDRK8lnM7+7M
10U1ZSX8kalQx/eUpsSDsS7W3HZlCuj/F/ZAu5GUqnmfjgxC1Hx0vDsei3zKCfpC
xgIOfXbGF1K+DwQAhMpjIq24++m3/HhlEw+JC8KF5nk2AF2cP5V8svq1Lcn6nNas
xoKaYisRwrRzEyFVEtt+
=8xHk
-----END PGP SIGNATURE-----

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](31)
[By Date](date.html#32)
[![Next](/images/right-icon-16x16.png)](39)

[![Previous](/images/left-icon-16x16.png)](31)
[By Thread](index.html#32)
[![Next](/images/right-icon-16x16.png)](39)

### Current thread:

* **[REVIVE-SA-2015-001] Revive Adserver - Multiple vulnerabilities** *Matteo Beccati (Oct 08)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.revive-adserver.com_83cdb2fc_20250126_042757.html ===


* [Facebook](https://www.facebook.com/WeAreReviveAdserver/)
* [RSS](https://www.revive-adserver.com/feed/)

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sec_menu "Hosted edition of Revive Adserver – sign up and get started in no time!")
* [Community Forum](https://forum.revive-adserver.com/)
* [Documentation](https://documentation.revive-adserver.com/)
* [Github](https://github.com/revive-adserver/revive-adserver/)
* [Patreon](https://patreon.com/revive_adserver "Sponsor us on Patreon")

[![Revive Adserver](https://www.revive-adserver.com/media/Revive-Adserver-logo.png)
# Download edition](https://www.revive-adserver.com/)

* [Download](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Features](https://www.revive-adserver.com/features/ "Features of Revive Adserver")
  + [Inventory](https://www.revive-adserver.com/features/#inventory "Managing inventory")
  + [Statistics](https://www.revive-adserver.com/features/#statistics "Review your Statistics")
  + [Open Source](https://www.revive-adserver.com/features/#open_source "Free, Open Source, Privacy Proof")
* [How to](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver")
  + [Get Started](https://www.revive-adserver.com/how-to/get-started/ "How to Get started with Revive Adserver")
  + [Manage Advertisers](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manage Advertisers in Revive Adserver")
    - [Create an Advertiser](https://www.revive-adserver.com/how-to/create-an-advertiser/ "How to Create an Advertiser in Revive Adserver")
    - [More about Advertisers…](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manager Advertisers in Revive Adserver")
  + [Manage Campaigns](https://www.revive-adserver.com/how-to/manage-campaigns/ "How to create and manage campaigns in Revive Adserver")
    - [Create a Campaign](https://www.revive-adserver.com/how-to/create-a-campaign/ "How to create a Campaign in Revive Adserver")
    - [Link a campaign to zones](https://www.revive-adserver.com/how-to/link-a-campaign-to-zones/ "How to link a campaign to zones in Revive Adserver")
    - [More about Campaigns…](https://www.revive-adserver.com/how-to/manage-campaigns/)
  + [Manage Banners](https://www.revive-adserver.com/how-to/manage-banners/ "How to manage banners in Revive Adserver")
    - [Create a Banner](https://www.revive-adserver.com/how-to/create-a-banner/ "How to create a banner in Revive Adserver")
    - [Define Delivery Rules](https://www.revive-adserver.com/how-to/define-delivery-rules-for-a-banner/ "How to define Delivery Rules for a Banner in Revive Adserver")
    - [More about Banners…](https://www.revive-adserver.com/how-to/manage-banners/ "More articles about managing banners in Revive Adserver")
  + [Manage Websites](https://www.revive-adserver.com/how-to/manage-websites/ "How to manage websites in Revive Adserver")
    - [Create a Website](https://www.revive-adserver.com/how-to/create-a-website/ "How to Create a Website in Revive Adserver")
  + [Manage Zones](https://www.revive-adserver.com/how-to/manage-zones/ "How to manage Zones in Revive Adserver")
    - [Create a Zone](https://www.revive-adserver.com/how-to/create-a-zone/ "How to create a Zone in Revive Adserver")
    - [Create Zone Invocation Code](https://www.revive-adserver.com/how-to/create-zone-invocation-code/ "How to Create Zone Invocation Code in Revive Adserver")
    - [More about Zones…](https://www.revive-adserver.com/how-to/manage-zones/)
  + [Manage Preferences](https://www.revive-adserver.com/how-to/manage-preferences/ "Manage Preferences in Revive Adserver")
    - [Create Delivery Rule Sets](https://www.revive-adserver.com/how-to/create-delivery-rule-sets/ "Create Delivery Rule Sets in Revive Adserver")
  + [Install and Update](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating Revive Adserver")
    - [Install Revive Adserver](https://www.revive-adserver.com/how-to/install/ "How to Install Revive Adserver on your server")
    - [Update Revive Adserver](https://www.revive-adserver.com/how-to/update/ "How to Update Revive Adserver to a new version")
    - [More about Installation and Updating…](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating the Revive Adserver software")
  + [Manage Configuration](https://www.revive-adserver.com/how-to/manage-configuration/ "Articles about How to Configure Revive Adserver")
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions about Revive Adserver")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
  + [Can I sponsor Revive Adserver?](https://www.revive-adserver.com/about/our-sponsors/)
  + [Using Google AdSense with Revive Adserver](https://www.revive-adserver.com/faq/using-google-adsense-with-revive-adserver/)
  + [Geotargeting with Revive Adserver](https://www.revive-adserver.com/faq/geotargeting-with-revive-adserver/)
  + [Troubleshooting banner delivery](https://www.revive-adserver.com/faq/troubleshooting-banner-delivery/)
* [Support](https://www.revive-adserver.com/support/ "Support for Revive Adserver")
  + [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
  + [Documentation](https://documentation.revive-adserver.com/)
  + [Forums](https://forum.revive-adserver.com/ "Revive Adserver Community Forums")
  + [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
  + [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
* [About](https://www.revive-adserver.com/about/ "About Revive Adserver")
  + [Our sponsors](https://www.revive-adserver.com/about/our-sponsors/)
  + [Active Revive Adserver instances](https://www.revive-adserver.com/about/active-revive-adserver-instances/)
  + [User Reviews](https://www.revive-adserver.com/about/user-reviews-about-revive-adserver/ "User Reviews about Revive Adserver")
* [Blog](https://www.revive-adserver.com/blog/ "Revive Adserver blog")

Select Page

# Revive Adserver Security Advisory REVIVE-SA-2015-001

## Revive Adserver Security Advisory REVIVE-SA-2015-001

* Advisory ID: [REVIVE-SA-2015-001](https://www.revive-adserver.com/security/revive-sa-2015-001/)
* CVE-IDs: CVE-2015-7364, CVE-2015-7365, CVE-2015-7366, CVE-2015-7367, CVE-2015-7368, CVE-2015-7369, CVE-2015-7370, CVE-2015-7371, CVE-2015-7372, CVE-2015-7373
* Date: 2015-10-07
* Risk Level: Medium
* Applications affected: Revive Adserver
* Versions affected: <= 3.2.1
* Versions not affected: >= 3.2.2
* Website: <https://www.revive-adserver.com/>

## Vulnerability 1 – Cross-Site Request Forgery (CSRF)

* CVE-ID: CVE-2015-7364
* CWE-ID: CWE-352
* CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)

### Description

Abdullah Hussam Gazi discovered that the CSRF protection mechanism introduced a few years ago to secure the forms generated with the HTML\_Quickform library (most of the forms in Revive Adserver’s admin UI) could be easily bypassed by sending an empty token along with the POST data. The range of malicious actions includes, but is not limited to, modifying entities like banners and zones and altering preferences and settings.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7364
* http://cwe.mitre.org/data/definitions/352.html
* https://github.com/revive-adserver/revive-adserver/commit/288f81cc

## Vulnerability 2 – Reflected XSS

* CVE-ID: CVE-2015-7365
* CWE-ID: CWE-79
* CVSSv2: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)

### Description

Abdullah Hussam Gazi has discovered that the plugin upgrade form was not properly escaping filenames before displaying them when uploading a file containing errors. Exploiting the vulnerability required a specifically crafted multipart POST message.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7365
* http://cwe.mitre.org/data/definitions/79.html
* https://github.com/revive-adserver/revive-adserver/commit/b5848808

## Vulnerability 3 – Cross-Site Request Forgery (CSRF)

* CVE-ID: CVE-2015-7366
* CWE-ID: CWE-532
* CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)

### Description

N B Sri Harsha has discovered that some plugin actions (e.g. enabling, disabling) could be performed via GET without any CSRF protection mechanism. Successful CSRF attacks could potentially lead to service disruptions in the case of core plugins being disabled. He also discovered that the account-user-\*.php scripts were not checking the CSRF token sent via POST, allowing minor attacks, such as changing the victim’s contact name and language.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7366
* http://cwe.mitre.org/data/definitions/352.html
* https://github.com/revive-adserver/revive-adserver/commit/13d8181f

## Vulnerability 4 – Improper Access Control

* CVE-ID: CVE-2015-7367
* CWE-ID: CWE-284
* CVSSv2: 4.6 (AV:N/AC:H/Au:S/C:P/I:P/A:P)

### Description

N B Sri Harsha discovered that deleting or unlinking users with an active session didn’t have any effect until the session was expired, potentially allowing the users to perform undesired actions while such sessions were still active.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7367
* http://cwe.mitre.org/data/definitions/284.html
* https://github.com/revive-adserver/revive-adserver/commit/ccbd1cc5

## Vulnerability 5 – Information Exposure Through Browser Caching

* CVE-ID: CVE-2015-7368
* CWE-ID: CWE-525
* CVSSv2: 2.1 (AV:L/AC:L/Au:N/C:P/I:N/A:N)

### Description

N B Sri Harsha has discovered that the cached copies of pages visited in Revive Adserver’s admin UI were still reachable via the browser history after successfully logging out. This potentially allowed expose of sensitive information to unauthorised parties.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7368
* http://cwe.mitre.org/data/definitions/525.html
* https://github.com/revive-adserver/revive-adserver/commit/15aac363
* https://github.com/revive-adserver/revive-adserver/commit/c76f675d

## Vulnerability 6 – Overly Permissive Cross-domain Whitelist

* CVE-ID: CVE-2015-7369
* CWE-ID: CWE-942
* CVSSv2: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)

### Description

Sergey Markov has reported that the crossdomain.xml files shipped with Revive Adserver are overly permissive. On a default installation they could in fact be exploited with malicious intents, e.g. to steal session cookies.

## References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7369
* http://cwe.mitre.org/data/definitions/942.html
* https://github.com/revive-adserver/revive-adserver/commit/4be0aa55

## Vulnerability 7 – Reflected XSS

* CVE-ID: CVE-2015-7370
* CWE-ID: CWE-79
* CVSSv2: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)

### Description

Sergey Markov has discovered that the open-flash-chart.swf file, used by the VideoAds plugin in Revive Adserver, was vulnerable to reflected XSS attacks on the id and data-file parameters. This file was included via the third party LGPLv2 graphing library, Open Flash Chart 2, which appears to be currently unmaintained. The Revive Adserver team has therefore decided to fix the vulnerabilities that had been reported and to publish a github repository for the library, containing its history and the vulnerability fixes, for the benefit of everyone else using it: https://github.com/revive-adserver/open-flash-chart

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7370
* http://cwe.mitre.org/data/definitions/79.html
* https://github.com/revive-adserver/revive-adserver/commit/202eb15c
* https://github.com/revive-adserver/revive-adserver/commit/e9cda5a4
* https://github.com/revive-adserver/open-flash-chart/commit/0a181c56

## Vulnerability 8 – Improper Access Control

* CVE-ID: CVE-2015-7371
* CWE-ID: CWE-284
* CVSSv2: 5.0 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

Krzysztof K. Wasielewski reported that run-mpe.php, a script used by the admin UI to asynchronously trigger a run of the Maintenance Priority Engine when necessary, was lacking proper authentication and access control and could therefore be called by any third party. Running maintenance is a resource intensive task, although a locking mechanism prevents it from being run multiple times concurrently; thus, run-mpe.php cannot be used alone for a resource exhaustion attack.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7371
* http://cwe.mitre.org/data/definitions/284.html
* https://github.com/revive-adserver/revive-adserver/commit/12cefa6f

## Vulnerability 9 – Local File Inclusion

* CVE-ID: CVE-2015-7372
* CWE-ID: CWE-98
* CVSSv2: 7.6 (AV:N/AC:H/Au:N/C:C/I:C/A:C)

### Description

Krzysztof K. Wasielewski reported that the layerstyle parameter in al.php was not properly sanitized, causing a potential LFI vulnerability. Under normal circumstances, an attacker would need to place a file named layerstyle.inc.php in an arbitrary directory on the server and craft the layerstyle parameter accordingly to load it. If an old version of PHP is being used the server, other attack techniques might be possible, e.g. NULL-byte truncation.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7372
* http://cwe.mitre.org/data/definitions/98.html
* https://github.com/revive-adserver/revive-adserver/commit/86b623f8
* https://github.com/revive-adserver/revive-adserver/commit/c76f675d

## Vulnerability 10 – Reflected XSS (Cross-site scripting)

* CVE-ID: CVE-2015-7373
* CWE-ID: CWE-79
* CVSSv2: 7.6 (AV:N/AC:H/Au:N/C:C/I:C/A:C)

### Description

A feature called “magic-macros” in Revive Adserver allows dynamic data to be displayed in the banner output. There is a predefined set of such macros (e.g. {random}, {clickurl}, etc.), but the feature also allows the display of arbitrary GET parameters. A user reported that the values coming from GET parameters were not properly escaped before being displayed, thus making banners using such magic-macros a potential vector for XSS attacks.

### References

* http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7373
* http://cwe.mitre.org/data/definitions/79.html
* https://github.com/revive-adserver/revive-adserver/commit/c40abff6
* https://github.com/revive-adserver/revive-adserver/commit/c76f675d

## Solution

We strongly advise people to upgrade to the most recent 3.2.2 release of Revive Adserver, including those running OpenX Source or older versions of the application.

## Contact Information

The security contact for Revive Adserver can be reached at: <security AT revive-adserver DOT com>

Please review [https://www.revive-adserver.com/security/](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team") before doing so.

#### Current Stable Release

* [Version 5.5.2](https://www.revive-adserver.com/download/ "Download the latest stable version of Revive Adserver")
#### How can we help?

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sidebar "Hosted edition of Revive Adserver – Subscribe to get started in no time!")
* [Download edition](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
* [Documentation](https://documentation.revive-adserver.com/)
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions")
* [Forums](https://forum.revive-adserver.com/)
* [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
#### How can you help?

* [Sponsor Us](https://www.revive-adserver.com/about/our-sponsors/)
* [Translate to your language](https://translations.revive-adserver.com/ "Help us by translating the Revive Adserver software to your language")
#### Other information

* [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
* [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and privacy")

#### Current Stable Release

**v5.5.2** · [Download now](https://www.revive-adserver.com/download/)
released April 17, 2024
Read our [Release notes](https://www.revive-adserver.com/categories/release-notes/) blog posts.

#### How to use Revive Adserver

We have a collection of [articles explaining how to use the Revive Adserver software](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver"), with tips and best practices.

#### Hosted edition

Revive Adserver is also available as a [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=page_footer "Revive Adserver Hosted edition"), with costs as low as $10 per month.

#### Project Information

Revive Adserver is a project by

**[Aqua Platform](http://www.aquaplatform.com/ "Aqua Platform")**.

* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")
#### Become a sponsor

You can be a sponsor of the Revive Adserver open source project, by [contributing to our project on Patreon](https://www.patreon.com/revive_adserver). Even just $10 per month will help.

[![](https://www.revive-adserver.com/media/become_a_patron_button.png)](https://www.patreon.com/revive_adserver)

We also have other [sponsors](https://www.revive-adserver.com/about/our-sponsors/ "A list of companies and individuals who have sponsored our project").

#### Website hosting

This website is hosted by [Aqua Platform](https://www.aquaplatform.com/), specialists in next generation cloud based [Revive Adserver Hosting](https://www.aquaplatform.com/revive-adserver-hosting/), systems and technology.

* [Home](https://www.revive-adserver.com/)
* [Privacy](https://www.revive-adserver.com/privacy/ "Privacy and Revive Adserver")
* [Security](https://www.revive-adserver.com/security/)

[Revive Adserver Download edition](https://www.revive-adserver.com/) is © 2013-2025 by [Aqua Platform](https://www.aquaplatform.com/) · All Rights Reserved.

* [Follow](https://github.com/revive-adserver/revive-adserver/ "Follow on GitHub")
* [Follow](https://www.patreon.com/revive_adserver "Follow on Patreon")
* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")



=== Content from github.com_2e794947_20250126_042801.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2Fccbd1cc5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2Fccbd1cc5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=revive-adserver%2Frevive-adserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[revive-adserver](/revive-adserver)
/
**[revive-adserver](/revive-adserver/revive-adserver)**
Public

* [Notifications](/login?return_to=%2Frevive-adserver%2Frevive-adserver) You must be signed in to change notification settings
* [Fork
  568](/login?return_to=%2Frevive-adserver%2Frevive-adserver)
* [Star
   1.3k](/login?return_to=%2Frevive-adserver%2Frevive-adserver)

* [Code](/revive-adserver/revive-adserver)
* [Issues
  153](/revive-adserver/revive-adserver/issues)
* [Pull requests
  23](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

Additional navigation options

* [Code](/revive-adserver/revive-adserver)
* [Issues](/revive-adserver/revive-adserver/issues)
* [Pull requests](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

## Commit

[Permalink](/revive-adserver/revive-adserver/commit/ccbd1cc5ea3e15efdfc82ed28530a0efaffc579a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix [CVE-2015-7367](https://github.com/advisories/GHSA-h4xc-rp2v-7893 "CVE-2015-7367")

[Browse files](/revive-adserver/revive-adserver/tree/ccbd1cc5ea3e15efdfc82ed28530a0efaffc579a)
Browse the repository at this point in the history

```
Improper Access Control
-----------------------

N B Sri Harshа discovered that deleting or unlinking users with an active
session didn't have any effect until the session was expired, potentially
allowing them to perform undesired actions until such session was kept active.

CWE: CWE-284
CVSSv2: 4.6 (AV:N/AC:H/Au:S/C:P/I:P/A:P)
```

* Loading branch information

[![@mbeccati](https://avatars.githubusercontent.com/u/282388?s=40&v=4)](/mbeccati)

[mbeccati](/revive-adserver/revive-adserver/commits?author=mbeccati "View all commits by mbeccati")
committed
Oct 6, 2015

1 parent
[13d8181](/revive-adserver/revive-adserver/commit/13d8181f90de36de948d2ccbc3b92e9edbc78c74)

commit ccbd1cc

Showing
**1 changed file**
with
**26 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

26 changes: 26 additions & 0 deletions

26
[lib/OA/Permission/User.php](#diff-f8cf1dcf45e2c1206e46baa90f00d6dbc57573497df10010cb85c71763fc82ff "lib/OA/Permission/User.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/ccbd1cc5ea3e15efdfc82ed28530a0efaffc579a/lib/OA/Permission/User.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,6 +60,32 @@ function \_\_construct($doUsers, $skipDatabaseAccess = false) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function \_\_wakeup() |
|  |  | { |
|  |  | $aAccounts[$this->aAccount['account\_id']] = true; |
|  |  |  |
|  |  | if (!empty($this->aUser['is\_admin'])) { |
|  |  | $adminAccountId = OA\_Dal\_ApplicationVariables::get('admin\_account\_id'); |
|  |  | $aAccounts[$adminAccountId] = true; |
|  |  | } |
|  |  |  |
|  |  | $doAUA = OA\_Dal::factoryDO('account\_user\_assoc'); |
|  |  | $doAUA->whereInAdd('account\_id', array\_keys($aAccounts)); |
|  |  | $doAUA->user\_id = $this->aUser['user\_id']; |
|  |  |  |
|  |  | $doAUA->find(); |
|  |  |  |
|  |  | while ($doAUA->fetch()) { |
|  |  | unset($aAccounts[$doAUA->account\_id]); |
|  |  | } |
|  |  |  |
|  |  | if (!empty($this->aUser['is\_admin']) && isset($aAccounts[$adminAccountId])) { |
|  |  | $this->aUser['is\_admin'] = false; |
|  |  | } |
|  |  |  |
|  |  | OA\_Permission::enforceTrue($this->aUser['is\_admin'] || !isset($aAccounts[$this->aAccount['account\_id']])); |
|  |  | } |
|  |  |  |
|  |  | function loadAccountData($accountId) |
|  |  | { |
|  |  | if (!empty($accountId)) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ccbd1cc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2Fccbd1cc5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_b3bf7013_20250124_232458.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


