```
{
  "CVE-2015-7972": {
    "description": "The (1) libxl_set_memory_target function in tools/libxl/libxl.c and (2) libxl__build_post function in tools/libxl/libxl_dom.c in Xen 3.4.x through 4.6.x do not properly calculate the balloon size when using the populate-on-demand (PoD) system, which allows local HVM guest users to cause a denial of service (guest crash) via unspecified vectors related to \"heavy memory pressure.\"",
    "affected_versions": [
      "Xen 3.4.x",
      "Xen 4.6.x"
    ],
    "root_cause": "Improper calculation of balloon size in libxl when using the populate-on-demand (PoD) system.",
    "vulnerabilities": [
      "Incorrect memory target calculation leading to outstanding PoD pages.",
      "Lack of validation on level 2 page table entries which can lead to privileged operations."
     ],
    "impact": "Local HVM guest users can cause a denial of service resulting in guest crash, and potentially, a denial of service affecting the host through exercising another vulnerability.",
    "attack_vectors": [
      "By triggering memory pressure within the guest to exploit memory ballooning mechanisms.",
     "Local PV guest administrators can gain privileges via a crafted superpage mapping."

    ],
    "attacker_capabilities": "Local HVM guest users or local PV guest administrators within a guest that's been configured with PoD.",
    "additional_information": [
      "The vulnerability is restricted to HVM guests which have been constructed in Populate-on-Demand mode (i.e., with memory < maxmem).",
        "x86 PV VMs are not vulnerable.",
      "x86 HVM domains without PoD are not vulnerable.",
      "Systems using libxl or xend are vulnerable.",
       "Migration is not capable of creating a guest with outstanding PoD; migrating a vulnerable guest might crash it.",
      "Xen versions back to 3.4.x are affected." ,
        "The memory/target value is in decimal, and is a number of kilobytes; it must be a multiple of 4, since a page is 4 Kb on affected systems."
      ,
       "A guest without a working balloon driver will be unstable in PoD mode."
    ],
    "mitigation": [
          "Reducing the guest's memory target after guest startup can eliminate the PoD discrepancy.",
         "On systems using libxl, this can be done with `xl mem-set`."
      ,
      "It is possible for a host administrator to bypass the toolstack code and give ballooning instructions directly to the guest."
         ]
  }
}
```