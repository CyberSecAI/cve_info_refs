```json
[
  {
    "cve": "CVE-2015-7540",
    "content": "The LDAP server in the AD domain controller in Samba 4.x before 4.1.22 does not check return values to ensure successful ASN.1 memory allocation, which allows remote attackers to cause a denial of service (memory consumption and daemon crash) via crafted packets.\n\nSpecifically, the vulnerability is present in the `samldb_check_user_account_control_acl` function in `dsdb/samdb/ldb_modules/samldb.c` within Samba. The lack of proper checking for administrative privileges during machine account creation can be exploited by remote authenticated users to bypass intended access restrictions, especially in environments with both Samba and Windows domain controllers.\n\nA remote attacker could send crafted packets to the Samba LDAP server causing it to consume excessive memory which leads to a daemon crash (DoS).",
    "vulnerability": {
      "root_cause": "Insufficient validation of return values after ASN.1 memory allocation and incorrect check of administrative privileges during creation of machine accounts.",
      "weaknesses": [
        "Improper check of administrative privileges",
          "Inadequate handling of string lengths.",
          "Missing memory allocation checks."

      ],
      "impact": "Denial of service (memory consumption and daemon crash) and the potential bypass of access restrictions.",
      "attack_vectors": "Sending crafted packets to the Samba LDAP server; exploiting the creation of machine accounts in mixed environments with Samba and Windows domain controllers.",
      "attacker_capabilities": "Remote attacker with network access. For bypassing intended access restrictions, a remote authenticated user with valid credentials is required."
    }
  },
 {
    "cve": "CVE-2015-7540",
    "content": "ldb before 1.1.24, as used in the AD LDAP server in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, mishandles string lengths, which allows remote attackers to obtain sensitive information from daemon heap memory by sending crafted packets and then reading (1) an error message or (2) a database value.",
    "vulnerability": {
      "root_cause": "Mishandling of string lengths in ldb library.",
      "weaknesses": [
        "Incorrect string length handling.",
         "Improper handling of memory.",
          "Missing memory allocation checks."
      ],
       "impact": "Exposure of sensitive information from daemon heap memory.",
      "attack_vectors": "Sending crafted packets to the vulnerable service.",
      "attacker_capabilities": "Remote attacker with network access."
     }
  }
]
```