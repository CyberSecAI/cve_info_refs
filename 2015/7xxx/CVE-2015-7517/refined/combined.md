=== Content from www.vapidlabs.com_1c5b0a76_20250124_203850.html ===


| Advisory #: 157 |
| --- |
| **Title:** SQL injection in wordpress plugin double-opt-in-for-download v2.0.8 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2015-11-24 |
| **CVE-ID:**[[CVE-2015-7517](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7517)] |
| **CWE:** |
| **Download Site:** <https://wordpress.org/plugins/double-opt-in-for-download/> |
| **Vendor:** https://profiles.wordpress.org/andyba45/ http://www.labwebdesigns.com |
| **Vendor Notified:**  2015-11-24 |
| **Vendor Contact:** |
| **Advisory:** <http://www.vapidlabs.com/advisory.php?v=157> |
| **Description:** Capture visitors names and email addresses by offering FREE downloads to your visitors in exchange for their email address with our Double Opt-In Plug |
| **Vulnerability:**The file double-opt-in-for-download/public/includes/class-doifd-download.php the lines 61 & 110: 38 $ver = $\_GET[ 'ver' ]; . . 61 $checkallowed = $wpdb->get\_row ( "SELECT doifd\_downloads \_allowed FROM " . $wpdb->prefix . "doifd\_lab\_subscribers WHERE doifd\_verifi cation\_number = '$ver' " ); . . 110 $wpdb->query ( 111 " 112 UPDATE $wpdb->doifd\_subscribers 113 SET doifd\_downloads\_allowed = doifd\_downloads\_allowe d+1 WHERE doifd\_verification\_number = '$ver' 114 " 115 ); Allows Blind SQL injection at the $ver parameter as it is not properly sanitized or passed through a prepare() function first. In file double-opt-in-for-download/public/includes/class-doifd-landing-page.php line 71 allows for SQL injection via the $ver parameter. 26 public function getVerification() { 27 $this->verification = $\_GET[ 'ver' ]; 28 return $this->verification; 29 } . . 71 $sql = "SELECT \* 72 FROM {$wpdb->prefix}doifd\_lab\_subscribers 73 INNER JOIN {$wpdb->prefix}doifd\_lab\_downloads 74 ON {$wpdb->prefix}doifd\_lab\_downloads.doifd\_download\_id = {$ wpdb->prefix}doifd\_lab\_subscribers.doifd\_download\_id 75 WHERE doifd\_verification\_number = '$this->verification'"; 76 77 $this->data = $wpdb->get\_row( $sql, ARRAY\_A ); |
| **Export:** [JSON](export_mitre_v4.py?id=157) [TEXT](txt.php?v=157) [XML](xml.php?s=157) |
| **Exploit Code:** ```     ``` |
| **Screen Shots:** |
| **Notes:** |



=== Content from wordpress.org_1a17360d_20250126_032447.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Double Opt-In for Download

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdouble-opt-in-for-download&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdouble-opt-in-for-download&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/double-opt-in-for-download_676167.svg)
# double-opt-in-for-download

By [LAB Web Development](http://www.labwebdevelopment.com)

* [Details](https://wordpress.org/plugins/double-opt-in-for-download/#description)
* [Reviews](https://wordpress.org/plugins/double-opt-in-for-download/#reviews)
* [Development](https://wordpress.org/plugins/double-opt-in-for-download/#developers)

[Support](https://wordpress.org/support/plugin/double-opt-in-for-download/)

## Description

This plugin has been closed as of April 9, 2017 and is not available for download. Reason: Unknown.

## Reviews

![](https://secure.gravatar.com/avatar/3bc7749bafe750dec9dafb5bf14991bfaec8d997cb267cea510182eb0e35bace?s=60&d=retro&r=g)
### [Even the Paid Version provides the worst support ever! 3 weeks with no response!](https://wordpress.org/support/topic/even-the-paid-version-provides-the-worst-support-ever-3-weeks-with-no-response/)

[alluremm](https://profiles.wordpress.org/alluremm/ "Posts by alluremm")
August 25, 2017

Really have nothing else so say… Refund will be requested…

![](https://secure.gravatar.com/avatar/8bae0215ce23798c30010fc241da16d55ccd95de74c9d6ed904ca5517fa0dde3?s=60&d=retro&r=g)
### [Good plugin but terrible customer service](https://wordpress.org/support/topic/good-plugin-but-terrible-customer-service/)

[Krissieg](https://profiles.wordpress.org/krissieg/ "Posts by Krissieg")
May 23, 2017

We really enjoy using this plugin, so upgraded to pro version. However, there was a bug in the ‘resend’ email and we’ve been waiting for support but we’ve had a poor response.
We had one email asking which PHP we were running and it’s now been over a month and still nothing. If we were ‘free’ customers I would understand to a point, but we paid for this plugin. Based on the customer service alone I would not recommend this plugin. Sorry, peeps but customer service is just as important as a working plugin!

![](https://secure.gravatar.com/avatar/155deb1b58709fbee4f55632063b1f4b800692274b4c07e17ea137aa421ac13e?s=60&d=retro&r=g)
### [Awesome Support](https://wordpress.org/support/topic/awesome-support-133/)

[villacastellamonte](https://profiles.wordpress.org/villacastellamonte/ "Posts by villacastellamonte")
September 3, 2016
1 reply

Recently upgraded to 4.6 and needed an update. Had some trouble getting the plugin to update. Andy jumped on it and had a solution within a few hours. Perfect support for a PRO product!

![](https://secure.gravatar.com/avatar/8a3ed47047b142006b73541cb8063d4f3de685ee57e878fe6f627e2c35cd2535?s=60&d=retro&r=g)
### [Does not work](https://wordpress.org/support/topic/does-not-work-680/)

[asimones](https://profiles.wordpress.org/asimones/ "Posts by asimones")
September 3, 2016
1 reply

We were supposed to go live today with our marketing campaign to send a link to this free download.
A couple weeks ago I noticed there was a bug where you couldn’t update a download after you created it. But, you could create a new one I emailed support, got a response with a question, and then never heard anything back after I answered.
Today I tried to create a new download. Error. It’s looking for a JS file that doesn’t exist. I thought maybe I need to just remove the free version plugin (out of desperation). Yep that deleted all my customizations.
I’m guessing that there’s some kind of conflict with the security that I’ve put in place, which implies that there’s some “hard coding” going on??? Maybe? Maybe not.
Needless to say we aren’t going to meet our goal and now I have to look for a new plugin.

![](https://secure.gravatar.com/avatar/35e78231cc376a36be942ac04bfcdb07de25ac260df0c2c5b2465f0c041c585c?s=60&d=retro&r=g)
### [Very neat. Very easy to use](https://wordpress.org/support/topic/very-neat-very-easy-to-use/)

[rishigangoly](https://profiles.wordpress.org/rishigangoly/ "Posts by rishigangoly")
September 3, 2016
2 replies

Thank you for creating this plugin.

![](https://secure.gravatar.com/avatar/eb192ad7845602d4c0499db001e7bb48fdb6f8cfb7cb29f8424ee09f8530b64e?s=60&d=retro&r=g)
### [Great Plugin](https://wordpress.org/support/topic/great-plugin-9823/)

[Wbryan123](https://profiles.wordpress.org/wbryan123/ "Posts by Wbryan123")
September 3, 2016

Beautiful plugin. I will definitely by buying the premium.

[Read all 44 reviews](https://wordpress.org/support/plugin/double-opt-in-for-download/reviews/)
## Contributors & Developers

“Double Opt-In for Download” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/468ce06f686b139c7568531461b8a87be9a3a164881a9d3c184f6a27e732e6c5?s=32&d=mm&r=g) [Andy](https://profiles.wordpress.org/andyba45/)

[Translate “Double Opt-In for Download” into your language.](https://translate.wordpress.org/projects/wp-plugins/double-opt-in-for-download)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/double-opt-in-for-download/), check out the [SVN repository](https://plugins.svn.wordpress.org/double-opt-in-for-download/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/double-opt-in-for-download/) by [RSS](https://plugins.trac.wordpress.org/log/double-opt-in-for-download/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **2.1.6**
* Last updated **8 years ago**
* Active installations **N/A**
* WordPress version **4.0 or higher**
* Tested up to **4.8.25**
* [Advanced View](https://wordpress.org/plugins/double-opt-in-for-download/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from profiles.wordpress.org_d8503c3d_20250126_032448.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

# [Profiles](https://profiles.wordpress.org/andyba45/)

* [Register](https://login.wordpress.org/register?locale=en_US&redirect_to=https%3A%2F%2Fprofiles.wordpress.org%2Fandyba45%2F)
* [Log In](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fprofiles.wordpress.org%2Fandyba45%2F&locale=en_US)

![](https://secure.gravatar.com/avatar/468ce06f686b139c7568531461b8a87be9a3a164881a9d3c184f6a27e732e6c5?s=100&d=mm&r=g)
## [Andy](https://profiles.wordpress.org/andyba45/)

@andyba45 on WordPress.org

### Bio

All Things Web Development Developer

* Member Since:
  **February 17th, 2013**
* Location:
  **Benicia, CA**
* Website:
  **[labwebdesigns.com](https://profiles.wordpress.org/website-redirect/andyba45)**
* Job Title:
  **Owner / Developer**
* Employer:
  **LAB Web Designs & Hosting**
* Find me on:

* [Activity](#content-activity)

* Committed [[1705112]](https://plugins.trac.wordpress.org/changeset/1705112) to Plugins SVN:
  Compatible with 4.8

  7 years ago
* Committed [[1633253]](https://plugins.trac.wordpress.org/changeset/1633253) to Plugins SVN:
  Version 2.1.6

  8 years ago
* Committed [[1608014]](https://plugins.trac.wordpress.org/changeset/1608014) to Plugins SVN:
  adjusted file path for save error

  8 years ago
* Committed [[1607451]](https://plugins.trac.wordpress.org/changeset/1607451) to Plugins SVN:
  corrections to 2.1.5

  8 years ago
* Committed [[1603293]](https://plugins.trac.wordpress.org/changeset/1603293) to Plugins SVN:
  Version 2.1.5

  8 years ago
* Posted a [reply](https://wordpress.org/support/topic/send-button-doesnt-work-with-recaptcha-doid/#post-8810059) to *Send button doesn’t work with Recaptcha & DOID*, on the site WordPress.org Forums:
  Hi Barbara, I have all three of those installed on several sites with no problems.…

  8 years ago
* Committed [[1589507]](https://plugins.trac.wordpress.org/changeset/1589507) to Plugins SVN:
  Updated Wordpress Tested Version tag

  8 years ago
* Committed [[1545533]](https://plugins.trac.wordpress.org/changeset/1545533) to Plugins SVN:
  Version 2.1.4

  8 years ago
* Created a topic, *[Very Useful and Working](https://wordpress.org/support/topic/very-useful-and-working-2/)*, on the site WordPress.org Forums:
  I appreciate all the effort that is put into it. Good …

  8 years ago
* Committed [[1490559]](https://plugins.trac.wordpress.org/changeset/1490559) to Plugins SVN:
  Version 2.1.3

  8 years ago
* Committed [[1477462]](https://plugins.trac.wordpress.org/changeset/1477462) to Plugins SVN:
  Version 2.1.2

  8 years ago
* Wrote a [comment](https://make.wordpress.org/meta/2016/07/12/plugin-directory-v3-open-beta/#comment-8478) on the post Plugin Directory v3 Open Beta, on the site Make WordPress.org:
  I really like the new look and the effort that has gone into it. Maybe…

  9 years ago
* Committed [[1440570]](https://plugins.trac.wordpress.org/changeset/1440570) to Plugins SVN:
  Updated Screen shots

  9 years ago
* Committed [[1438934]](https://plugins.trac.wordpress.org/changeset/1438934) to Plugins SVN:
  Updated Readme file

  9 years ago
* Committed [[1438932]](https://plugins.trac.wordpress.org/changeset/1438932) to Plugins SVN:
  Updated Wordpress compatible version number

  9 years ago
* Committed [[1438920]](https://plugins.trac.wordpress.org/changeset/1438920) to Plugins SVN:
  Corrected some spelling errors.... Im the product of a California ...

  9 years ago
* Committed [[1438919]](https://plugins.trac.wordpress.org/changeset/1438919) to Plugins SVN:
  version 2.1.1

  9 years ago
* Committed [[1438918]](https://plugins.trac.wordpress.org/changeset/1438918) to Plugins SVN:
  Version 2.1.1

  9 years ago
* Committed [[1391669]](https://plugins.trac.wordpress.org/changeset/1391669) to Plugins SVN:
  updated version to 4.5

  9 years ago
* Committed [[1301151]](https://plugins.trac.wordpress.org/changeset/1301151) to Plugins SVN:
  Version 2.1.0

  9 years ago
* Committed [[1294543]](https://plugins.trac.wordpress.org/changeset/1294543) to Plugins SVN:
  Version 2.0.9 - Security Fix

  9 years ago
* Committed [[1291813]](https://plugins.trac.wordpress.org/changeset/1291813) to Plugins SVN:
  Version 2.0.8

  9 years ago
* Committed [[1214563]](https://plugins.trac.wordpress.org/changeset/1214563) to Plugins SVN:
  Version 2.0.7

  9 years ago
* Committed [[1207033]](https://plugins.trac.wordpress.org/changeset/1207033) to Plugins SVN:
  Version 2.0.6

  10 years ago
* Committed [[1145805]](https://plugins.trac.wordpress.org/changeset/1145805) to Plugins SVN:
  Tested with Wordpress version 4.2

  10 years ago
* Committed [[1079797]](https://plugins.trac.wordpress.org/changeset/1079797) to Plugins SVN:
  Version 2.0.5

  10 years ago
* Committed [[1059253]](https://plugins.trac.wordpress.org/changeset/1059253) to Plugins SVN:
  Updateing screen shots Adding Icons

  10 years ago
* Committed [[1057793]](https://plugins.trac.wordpress.org/changeset/1057793) to Plugins SVN:
  No longer needed or supported.

  10 years ago
* Committed [[1057792]](https://plugins.trac.wordpress.org/changeset/1057792) to Plugins SVN:
  No Longer supported or needed. Mailing lists now included in DOIFD

  10 years ago
* Committed [[1057246]](https://plugins.trac.wordpress.org/changeset/1057246) to Plugins SVN:
  Version 2.0.4

  10 years ago
* Committed [[1054775]](https://plugins.trac.wordpress.org/changeset/1054775) to Plugins SVN:
  Version 2.0.3

  10 years ago
* Committed [[1049901]](https://plugins.trac.wordpress.org/changeset/1049901) to Plugins SVN:
  Version 2.0.2 - Update routine fix

  10 years ago
* Committed [[1044264]](https://plugins.trac.wordpress.org/changeset/1044264) to Plugins SVN:
  Fix - Subscriber table pagination

  10 years ago
* Committed [[1044201]](https://plugins.trac.wordpress.org/changeset/1044201) to Plugins SVN:
  Added - Upgrade Notice in readme.txt

  10 years ago
* Committed [[1044200]](https://plugins.trac.wordpress.org/changeset/1044200) to Plugins SVN:
  Version 2.0.0

  10 years ago
* Committed [[1013910]](https://plugins.trac.wordpress.org/changeset/1013910) to Plugins SVN:
  Version 1.1.7

  10 years ago
* Committed [[976788]](https://plugins.trac.wordpress.org/changeset/976788) to Plugins SVN:
  Tested and Works with Wordpress 4.0

  10 years ago
* Committed [[943724]](https://plugins.trac.wordpress.org/changeset/943724) to Plugins SVN:
  updated readme.txt version number

  11 years ago
* Committed [[943720]](https://plugins.trac.wordpress.org/changeset/943720) to Plugins SVN:
  Version 1.0.1

  11 years ago
* Committed [[943719]](https://plugins.trac.wordpress.org/changeset/943719) to Plugins SVN:
  version 1.1.6 tags

  11 years ago
* Committed [[943718]](https://plugins.trac.wordpress.org/changeset/943718) to Plugins SVN:
  version 1.1.6

  11 years ago
* Committed [[921441]](https://plugins.trac.wordpress.org/changeset/921441) to Plugins SVN:
  Put the correct URL in

  11 years ago
* Committed [[921438]](https://plugins.trac.wordpress.org/changeset/921438) to Plugins SVN:
  Fixed link in readme file. Added lead and lead capture tags

  11 years ago
* Committed [[920938]](https://plugins.trac.wordpress.org/changeset/920938) to Plugins SVN:
  Version 1.1.5 tags

  11 years ago
* Committed [[920937]](https://plugins.trac.wordpress.org/changeset/920937) to Plugins SVN:
  Version 1.1.5

  11 years ago
* Committed [[899041]](https://plugins.trac.wordpress.org/changeset/899041) to Plugins SVN:
  Removed redundant lines

  11 years ago
* Committed [[899037]](https://plugins.trac.wordpress.org/changeset/899037) to Plugins SVN:
  Moved setup instructions to installation section

  11 years ago
* Committed [[899025]](https://plugins.trac.wordpress.org/changeset/899025) to Plugins SVN:
  Rearranged Readme Text Subscription

  11 years ago
* Committed [[899022]](https://plugins.trac.wordpress.org/changeset/899022) to Plugins SVN:
  Removed space from readme text

  11 years ago
* Committed [[898522]](https://plugins.trac.wordpress.org/changeset/898522) to Plugins SVN:
  Updated contributer in readme.txt

  11 years ago

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


