=== Content from bugs.launchpad.net_c2c965d6_20250126_012935.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2015-021] secgroup rules doesn't work for instance immediately (CVE-2015-7713)

Bug #1491307 reported by
[suntao](https://launchpad.net/~244914362-q)
on 2015-09-02

[276](/%2Bhelp-bugs/bug-heat.html)

This bug affects 4 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [Sreekumar S](https://launchpad.net/~sreesiv) | [OpenStack Compute (nova) 12.0.0 "liberty"](https://launchpad.net/nova/%2Bmilestone/12.0.0) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray) |  |

### Bug Description

I have an OpenStack kilo setup on RHEL7.1 with a controller and a compute node (network-compute + network-network)，the config is following:

# /etc/nova.nova.conf on contrller node

[DEFAULT]

network\_api\_class = nova.network.api.API

security\_group\_api = nova

# /etc/nova/nova.conf on compute node

[DEFAULT]

network\_api\_class = nova.network.api.API

security\_group\_api = nova

firewall\_driver = nova.virt.libvirt.firewall.IptablesFirewallDriver

network\_manager = nova.network.manager.FlatDHCPManager

network\_size = 254

allow\_same\_net\_traffic = False

multi\_host = True

send\_arp\_for\_ha = True

share\_dhcp\_address = True

force\_dhcp\_release = True

flat\_network\_bridge = br100

flat\_interface = eth0

public\_interface = eth0

steps for test 1:

1) create and start VM instance-1 with secgroup default;

2) VM instance-1 ping br100: OK;

3) br100 ping VM instance-1: operation not permitted (because of no secgroup-rules for ICMP)

4) nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0

5) br100 ping VM instance-1: i got the same wrong message, not expected.

steps for test 2:

1) nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0;

2) create and start VM instance-2 with secgroup default;

3) br100 ping instance-2: OK

It seems that command "nova secgroup-add-rule ..." doesn't work immediately for the existed or running VM instances?

Tags:

[security](/nova/%2Bbugs?field.tag=security)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-02: |  |  | [#1](/nova/%2Bbug/1491307/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

So does new nova net security-group-rules are supposed to be applied on existing instance ?

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.
So does new nova net security-group-rules are supposed to be applied on existing instance ?

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-09-07: |  |  | [#2](/nova/%2Bbug/1491307/comments/2) |
| --- | --- | --- | --- |

I'm switching this bug to public security since it's been independently reported in public security [bug 1492961](/bugs/1492961) today.

I'm switching this bug to public security since it's been independently reported in public security bug 1492961 today.

| **information type**: | Private Security → Public Security |
| --- | --- |

[Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv)
on 2015-09-08

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Sreekumar S (sreesiv) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-08: |  |  | [#3](/nova/%2Bbug/1491307/comments/3) |
| --- | --- | --- | --- |

>> So does new nova net security-group-rules are supposed to be applied on existing instance ?

I believe it should, especially important in cases where new rules are added to make the group more restrictive. The admin would think that his rule is applied and safe, whereas actually he needs to manually re-associate that group with 'one of the instances' for it to be applied across all VMs. More details can be seen in the public security [bug 1492961](/bugs/1492961) raised be me.

I think it has to do something with the sec group rules not being refreshed in the code path... "refresh\_security\_group\_rules" func not being called I suppose!

I am new to OpenStack and would like to work on investigating and fixing this issue. I've assigned this to myself. Request reviewers to confirm and discuss the vulnerabilities and possible solutions.

>> So does new nova net security-group-rules are supposed to be applied on existing instance ?
I believe it should, especially important in cases where new rules are added to make the group more restrictive. The admin would think that his rule is applied and safe, whereas actually he needs to manually re-associate that group with 'one of the instances' for it to be applied across all VMs. More details can be seen in the public security bug 1492961 raised be me.
I think it has to do something with the sec group rules not being refreshed in the code path... "refresh\_security\_group\_rules" func not being called I suppose!
I am new to OpenStack and would like to work on investigating and fixing this issue. I've assigned this to myself. Request reviewers to confirm and discuss the vulnerabilities and possible solutions.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-08: |  |  | [#4](/nova/%2Bbug/1491307/comments/4) |
| --- | --- | --- | --- |

Can someone familiar with nova-net security group please confirm the issue here ?

Can someone familiar with nova-net security group please confirm the issue here ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-11: |  |  | [#5](/nova/%2Bbug/1491307/comments/5) |
| --- | --- | --- | --- |

I've found the root cause of this issue.

The call chain goes like this...

In "./nova/compute/api.py"

add\_rules() AND remove\_rules() calls

 trigger\_rules\_refresh() which in turn calls refresh\_instance\_security\_rules() [RPC]

This ends up in ./nova/compute/manager.py

[RPC] \_ComputeV4Proxy::refresh\_instance\_security\_rules() which calls ComputeManager::refresh\_instance\_security\_rules(). But the manager's function decorated with '@object\_compat' calls decorated\_function()

  which calls \_load\_instance(kwargs['instance']). This fails since there is no 'instance' key there and once again calls \_load\_instance from the except catch...

        except KeyError:

            args = (\_load\_instance(args[0]),) + args[1:]

From there it calls objects.Instance.\_from\_db\_object() with argument 'expected\_attrs=metas' which is initialized to

metas = ['metadata', 'system\_metadata']

The db instance dict doesn't have the keys in 'metas' because in trigger\_rules\_refresh() the sec groups are got from db by joining on the instances column, but it doesn't join on the metadata/system\_metadata fields.

This again causes 'KeyError' because when db instance dict is converted to the Instance object, it expects fields that aren't in the dict. So the manager's function do not call refresh\_instance\_security\_rules() on the LibvirtDriver and thereby IptablesFirewallDriver.

This same issue is mentioned in [bug 1484738](/bugs/1484738), although the end problems they cause differ. I've verified the fix proposed by Matt Riedemann and it resolves the issue.

More details: [https://bugs.launchpad.net/nova/+bug/1484738/comments/11](https://bugs.launchpad.net/nova/%2Bbug/1484738/comments/11)

Why this is not repro'ed in Liberty and why can't those changes be backported: [https://bugs.launchpad.net/nova/+bug/1484738/comments/13](https://bugs.launchpad.net/nova/%2Bbug/1484738/comments/13)

More details in commit msg: [https://bugs.launchpad.net/nova/+bug/1484738/comments/17](https://bugs.launchpad.net/nova/%2Bbug/1484738/comments/17)

So once the fix for [bug 1484738](/bugs/1484738) is merged to stable/kilo, it will resolve this issue as well.

I've found the root cause of this issue.
The call chain goes like this...
In "./nova/compute/api.py"
add\_rules() AND remove\_rules() calls
trigger\_rules\_refresh() which in turn calls refresh\_instance\_security\_rules() [RPC]
This ends up in ./nova/compute/manager.py
[RPC] \_ComputeV4Proxy::refresh\_instance\_security\_rules() which calls ComputeManager::refresh\_instance\_security\_rules(). But the manager's function decorated with '@object\_compat' calls decorated\_function()
which calls \_load\_instance(kwargs['instance']). This fails since there is no 'instance' key there and once again calls \_load\_instance from the except catch...
except KeyError:
args = (\_load\_instance(args[0]),) + args[1:]
From there it calls objects.Instance.\_from\_db\_object() with argument 'expected\_attrs=metas' which is initialized to
metas = ['metadata', 'system\_metadata']
The db instance dict doesn't have the keys in 'metas' because in trigger\_rules\_refresh() the sec groups are got from db by joining on the instances column, but it doesn't join on the metadata/system\_metadata fields.
This again causes 'KeyError' because when db instance dict is converted to the Instance object, it expects fields that aren't in the dict. So the manager's function do not call refresh\_instance\_security\_rules() on the LibvirtDriver and thereby IptablesFirewallDriver.
This same issue is mentioned in bug 1484738, although the end problems they cause differ. I've verified the fix proposed by Matt Riedemann and it resolves the issue.
More details: https://bugs.launchpad.net/nova/+bug/1484738/comments/11
Why this is not repro'ed in Liberty and why can't those changes be backported: https://bugs.launchpad.net/nova/+bug/1484738/comments/13
More details in commit msg: https://bugs.launchpad.net/nova/+bug/1484738/comments/17
So once the fix for bug 1484738 is merged to stable/kilo, it will resolve this issue as well.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-11: |  |  | [#6](/nova/%2Bbug/1491307/comments/6) |
| --- | --- | --- | --- |

Per comment 5, this sounds like a duplicate of [bug 1484738](/bugs/1484738). Before comment 5 I was going to ask if there were any errors in the logs, but comment 5 seems to confirm that. So I wouldn't consider this a security issue per se, it's just a code bug that was preventing things from working properly and is now fixed in master (liberty) and backport to stable/kilo and stable/juno. As of this morning it's merged in stable/juno and the fix in stable/kilo is going through the gate.

Per comment 5, this sounds like a duplicate of bug 1484738. Before comment 5 I was going to ask if there were any errors in the logs, but comment 5 seems to confirm that. So I wouldn't consider this a security issue per se, it's just a code bug that was preventing things from working properly and is now fixed in master (liberty) and backport to stable/kilo and stable/juno. As of this morning it's merged in stable/juno and the fix in stable/kilo is going through the gate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-09-11: |  |  | [#7](/nova/%2Bbug/1491307/comments/7) |
| --- | --- | --- | --- |

It sounds like the extent of the risk here is that a user may extend a security group with a change to block some malicious traffic or close off a vulnerable service, then assume they're protected from it without double-checking.

It sounds like the extent of the risk here is that a user may extend a security group with a change to block some malicious traffic or close off a vulnerable service, then assume they're protected from it without double-checking.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-11: |  |  | [#8](/nova/%2Bbug/1491307/comments/8) |
| --- | --- | --- | --- |

Looking at the 2 security group APIs in nova, in the case of nova-network when you add a new secgroup rule it gets into the db but doesn't get down to the virt driver which actually does the iptables stuff (in the case of libvirt) if you hit the KeyError when it calls refresh\_instance\_security\_rules. That failure doesn't get back to the user because the nova-network secgroup API does a cast to refresh the rules. So, yeah, the operation from the CLI would not return an error, but the rules aren't applied for the guest if you hit the KeyError, so you might have a false sense of security.

Looking at the 2 security group APIs in nova, in the case of nova-network when you add a new secgroup rule it gets into the db but doesn't get down to the virt driver which actually does the iptables stuff (in the case of libvirt) if you hit the KeyError when it calls refresh\_instance\_security\_rules. That failure doesn't get back to the user because the nova-network secgroup API does a cast to refresh the rules. So, yeah, the operation from the CLI would not return an error, but the rules aren't applied for the guest if you hit the KeyError, so you might have a false sense of security.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-11: |  |  | [#9](/nova/%2Bbug/1491307/comments/9) |
| --- | --- | --- | --- |

I wouldn't consider Neutron affected by this since it doesn't do the cast to refresh\_instance\_security\_rules.

I wouldn't consider Neutron affected by this since it doesn't do the cast to refresh\_instance\_security\_rules.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-14: |  |  | [#10](/nova/%2Bbug/1491307/comments/10) |
| --- | --- | --- | --- |

I am new to OpenStack and Python in general, so didn't understand the 'cast' part.

But as I mentioned in the bug I raised ([bug 1492961](/bugs/1492961), which was marked duplicate to this one) I've verified the same with neutron network and is working fine there. So it's nova-network only and is resolved with mriedem's changes to [bug 1484738](/bugs/1484738).

I am new to OpenStack and Python in general, so didn't understand the 'cast' part.
But as I mentioned in the bug I raised (bug 1492961, which was marked duplicate to this one) I've verified the same with neutron network and is working fine there. So it's nova-network only and is resolved with mriedem's changes to bug 1484738.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-14: |  |  | [#11](/nova/%2Bbug/1491307/comments/11) |
| --- | --- | --- | --- |

Since it's quite a security defect, and already fixed in supported stable release, I suggest we issue an OSSA with this impact description:

Title: Nova network security group changes are not applied to running instances

Products: Nova

Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1

Description:

Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.

Now about attributions, It seems like this was independently reported by suntao, Sreekumar S. Are those your name and is there affiliations to mention along or are you independent contributors ?

Since it's quite a security defect, and already fixed in supported stable release, I suggest we issue an OSSA with this impact description:
Title: Nova network security group changes are not applied to running instances
Products: Nova
Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1
Description:
Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.
Now about attributions, It seems like this was independently reported by suntao, Sreekumar S. Are those your name and is there affiliations to mention along or are you independent contributors ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-15: |  |  | [#12](/nova/%2Bbug/1491307/comments/12) |
| --- | --- | --- | --- |

Yes, 'Sreekumar S' is my name, and I am an independent contributor.

Yes, 'Sreekumar S' is my name, and I am an independent contributor.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-09-21

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-23: |  |  | [#13](/nova/%2Bbug/1491307/comments/13) |
| --- | --- | --- | --- |

Tristan, this was fixed under [bug 1484738](/bugs/1484738) but the OSSA is on this bug - how do we resolve that? Should the OSSA move to 1484738?

Tristan, this was fixed under bug 1484738 but the OSSA is on this bug - how do we resolve that? Should the OSSA move to 1484738?

| Changed in nova: | |
| --- | --- |
| **status**: | New → Fix Committed |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-23: |  |  | [#14](/nova/%2Bbug/1491307/comments/14) |
| --- | --- | --- | --- |

Matt, that is fine to me, this bug describe the security impact of [bug 1484738](/bugs/1484738), and I propose to use it for the OSSA tasks. The advisory can reference the former [bug 1484738](/bugs/1484738).

@suntao, can you confirm your attribution is correct:

Title: Nova network security group changes are not applied to running instances

Reporter: Sreekumar S and Suntao

Products: Nova

Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1

Description:

Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.

Matt, that is fine to me, this bug describe the security impact of bug 1484738, and I propose to use it for the OSSA tasks. The advisory can reference the former bug 1484738.
@suntao, can you confirm your attribution is correct:
Title: Nova network security group changes are not applied to running instances
Reporter: Sreekumar S and Suntao
Products: Nova
Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1
Description:
Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-23: |  |  | [#15](/nova/%2Bbug/1491307/comments/15) |
| --- | --- | --- | --- |

Oups, forgot to update the affect line:

Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1

Oups, forgot to update the affect line:
Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-09-24

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → liberty-rc1 |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Grant Murphy (gmurphy)](https://launchpad.net/~gmurphy) wrote on 2015-10-05: |  |  | [#16](/nova/%2Bbug/1491307/comments/16) |
| --- | --- | --- | --- |

+1 with affects line update

+1 with affects line update

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-10-05: |  |  | [#17](/nova/%2Bbug/1491307/comments/17) |
| --- | --- | --- | --- |

Also a slight phrasing improvement to suggest over the second sentence of Tristan's impact description from comment #14:

"Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group."

Otherwise looks good to me.

Also a slight phrasing improvement to suggest over the second sentence of Tristan's impact description from comment #14:
"Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group."
Otherwise looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-10-05: |  |  | [#18](/nova/%2Bbug/1491307/comments/18) |
| --- | --- | --- | --- |

Thanks, CVE requested with:

Title: Nova network security group changes are not applied to running instances

Reporter: Sreekumar S and Suntao

Products: Nova

Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1

Description:

Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group. All Nova network setups are affected.

Thanks, CVE requested with:
Title: Nova network security group changes are not applied to running instances
Reporter: Sreekumar S and Suntao
Products: Nova
Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1
Description:
Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group. All Nova network setups are affected.

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |
| **assignee**: | nobody → Tristan Cacqueray (tristan-cacqueray) |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-10-06

| **summary**: | - secgroup rules doesn't work for instance immediately+ secgroup rules doesn't work for instance immediately (CVE-2015-7713) |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-10-07

| **summary**: | - secgroup rules doesn't work for instance immediately (CVE-2015-7713)+ [OSSA 2015-021] secgroup rules doesn't work for instance immediately+ (CVE-2015-7713) |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-10-07

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-10-15

| Changed in nova: | |
| --- | --- |
| **milestone**: | liberty-rc1 → 12.0.0 |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1492264](https://bugs.launchpad.net/nova/%2Bbug/1492264 "Updating the security group rules does not reflected in the applicable running instances")
* [Bug #1492961](https://bugs.launchpad.net/nova/%2Bbug/1492961 "Security Group Rules not effective immediately")

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1491307/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_d3487b3b_20250124_141346.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1492961/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# Security Group Rules not effective immediately

Bug #1492961 reported by
[Sreekumar S](https://launchpad.net/~sreesiv)
on 2015-09-07

This bug report is a duplicate of:
[Bug #1491307: [OSSA 2015-021] secgroup rules doesn't work for instance immediately (CVE-2015-7713).](/bugs/1491307 "[OSSA 2015-021] secgroup rules doesn't work for instance immediately (CVE-2015-7713)")

[Edit](%2Bduplicate "Edit or remove linked duplicate bug")
[Remove](%2Bduplicate "Remove linked duplicate bug")

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | New | Undecided | [Sreekumar S](https://launchpad.net/~sreesiv) |  |

### Bug Description

Exact version of Nova/OpenStack you are running:

devstack@dev0:~/devstack$ git log -1

commit 28247f3511b2eedfc740cf822f04dc8cb1ae7b08

Merge: 9d113a2 03a19bc

Author: Jenkins <email address hidden>

Date: Fri Jul 31 20:12:34 2015 +0000

Merge "ceilometer: add tempest option to test events" into stable/kilo

devstack@dev0:~/devstack$ cd -

/opt/stack/nova

devstack@dev0:/opt/stack/nova$ git log -1

commit 90e1eacee8da05bed2b061b8df5fc4fbf5057bb2

Author: Alan Pevec <email address hidden>

Date: Tue Jul 28 21:25:51 2015 +0200

Bump stable/kilo next version to 2015.1.2

Change-Id: I180de9d4f1f4ae385682ce40a3a695eb3acc4c43

devstack@dev0:/opt/stack/nova$

Summary:

After editing sec group to add/remove rules, those changes are not reflected on the instances immediately. The changes take effect only after one of the instance's security group is removed and added back. Once this is done, all the instances where the particular security group is associated is updated with the new rules. Now the iptables routing rules get updated as well.

Reproduce steps (CLI):

-- ./stack.sh with nova-network configured.

-- Once the services are running, and horizon starts responding; Launch 2 instances from Horizon.

   These instances will have default sec group associated to them

-- Associate Floating IP to both of these instances...

devstack@dev0:~/devstack$ nova list

+--------------------------------------+-------+--------+------------+-------------+--------------------------------+

| ID | Name | Status | Task State | Power State | Networks |

+--------------------------------------+-------+--------+------------+-------------+--------------------------------+

| 7cf44867-42f4-44de-aba5-019113d52612 | test0 | ACTIVE | - | Running | private=172.31.1.2, 10.0.2.249 |

| 0696c57e-7704-4d51-a3f2-627049946052 | test1 | ACTIVE | - | Running | private=172.31.1.3, 10.0.2.250 |

+--------------------------------------+-------+--------+------------+-------------+--------------------------------+

-- From another node on the external network ping both the node on the FIPs. Ping will not go through...

-- Allow ICMP from all IPs...

devstack@dev0:~/devstack$ nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0

+-------------+-----------+---------+-----------+--------------+

| IP Protocol | From Port | To Port | IP Range | Source Group |

+-------------+-----------+---------+-----------+--------------+

| icmp | -1 | -1 | 0.0.0.0/0 | |

+-------------+-----------+---------+-----------+--------------+

devstack@dev0:~/devstack$ nova secgroup-list-rules 1

+-------------+-----------+---------+-----------+--------------+

| IP Protocol | From Port | To Port | IP Range | Source Group |

+-------------+-----------+---------+-----------+--------------+

| icmp | -1 | -1 | 0.0.0.0/0 | |

+-------------+-----------+---------+-----------+--------------+

-- Ping again, still will not go through!!!

-- Remove the default group from one of the instances... Now the other node will start pinging, because now the new rule is applied to all instances.

nova remove-secgroup "0696c57e-7704-4d51-a3f2-627049946052" default

-- Add back the the default group to the instance, whose sec group was removed in the first place. Now that node starts pinging as well.

nova add-secgroup "0696c57e-7704-4d51-a3f2-627049946052" default

-- Same is the case with deletion of rules from sec group as well. Once you delete the ping allow rule, it will still allow pings until 'one of the instances is re-associated' with the sec group. This seems quite dangerous!!!

This bug is seen with both the CLI and Horizon Webapp with devstack running nova-network. I haven't checked the issue with nova-network on a multi node setup, although it should most probably be there as well.

    But I do have checked whether the same issue happens with neutron, in both devstack, and a 3 node (controller, network, compute1) setup as mentioned in the official installation guide for Kilo. In neutron the rules are immediately reflected.

Expected result: The new rules should be updated in iptables immediately after the sec group rules are modified and saved. All the instances associated to a sec group should immediately get affected by a rule change in that group. The admin/user need not have to manually detach and reattach the sec group to the instance.

Actual result: The modified rules don't immediately take effect.

Tags:

[network](/nova/%2Bbugs?field.tag=network)
[security](/nova/%2Bbugs?field.tag=security)

[Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv)
on 2015-09-07

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Sreekumar S (sreesiv) |

[Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv)
on 2015-09-07

| **information type**: | Private Security → Public Security |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1492961/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

* Duplicate of
  [bug #1491307](/bugs/1491307 "[OSSA 2015-021] secgroup rules doesn't work for instance immediately (CVE-2015-7713)")

  [Remove](%2Bduplicate "Remove linked duplicate bug")

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1492961/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1492961/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1492961/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from security.openstack.org_112cff3f_20250124_141347.html ===


Toggle navigation

 Search

* [Software](https://www.openstack.org/software/)
  + [Overview](https://www.openstack.org/software/)
  + [OpenStack Components](https://www.openstack.org/software/project-navigator/openstack-components)
  + [SDKs](https://www.openstack.org/software/project-navigator/sdks)
  + [Deployment Tools](https://www.openstack.org/software/project-navigator/deployment-tools)
  + [OpenStack Map](https://www.openstack.org/assets/software/projectmap/openstack-map.pdf)
  + [Sample Configs](https://www.openstack.org/software/sample-configs/)
* [Use Cases](https://www.openstack.org/use-cases/)
  + [Users in Production](https://www.openstack.org/use-cases/)
  + [Ironic Bare Metal](https://www.openstack.org/use-cases/bare-metal/)
  + [Edge Computing](https://www.openstack.org/use-cases/edge-computing/)
  + [Telecom & NFV](https://www.openstack.org/use-cases/telecoms-and-nfv/)
  + [Science and HPC](https://www.openstack.org/use-cases/science/)
  + [Containers](https://www.openstack.org/use-cases/containers/)
  + [Enterprise](https://www.openstack.org/use-cases/enterprise/)
  + [User Survey](https://www.openstack.org/surveys/landing)
* [Events](https://openinfra.dev/summit)
  + [OpenInfra Summit](https://openinfra.dev/summit)
  + [Project Teams Gathering](https://www.openstack.org/ptg/)
  + [OpenDev](https://www.openstack.org/events/opendev-2020/)
  + [Community Events](https://www.openstack.org/events/community-events/)
  + [OpenStack & OpenInfra Days](https://www.openstack.org/events/openstackdays)
  + [Summit Videos](https://www.openstack.org/videos/)
* [Community](https://www.openstack.org/community/)
  + [Welcome! Start Here](https://www.openstack.org/community/)
  + [OpenStack Technical Committee](https://www.openstack.org/community/tech-committee)
  + [Speakers Bureau](https://www.openstack.org/community/speakers/)
  + [OpenStack Wiki](http://wiki.openstack.org)
  + [Get Certified (COA)](https://www.openstack.org/coa/)
  + [Jobs](https://www.openstack.org/community/jobs/)
  + [Marketing Resources](https://www.openstack.org/marketing/)
  + [Community News](https://www.openstack.org/news/)
  + [Superuser Magazine](http://superuser.openstack.org)
  + [OpenInfra Foundation Supporting Organizations](https://www.openstack.org/community/supporting-organizations/)
  + [OpenInfra Foundation](https://openinfra.dev)
* [Marketplace](https://www.openstack.org/marketplace/)
  + [Training](https://www.openstack.org/marketplace/training/)
  + [Distros & Appliances](https://www.openstack.org/marketplace/distros/)
  + [Public Clouds](https://www.openstack.org/marketplace/public-clouds/)
  + [Hosted Private Clouds](https://www.openstack.org/marketplace/hosted-private-clouds/)
  + [Remotely Managed Private Clouds](https://www.openstack.org/marketplace/remotely-managed-private-clouds/)
  + [Consulting & Integrators](https://www.openstack.org/marketplace/consulting/)
  + [Drivers](https://www.openstack.org/marketplace/drivers/)
* [Blog](https://www.openstack.org/blog/)
* [Docs](http://docs.openstack.org/)
* [Join](https://openinfra.dev/join/)
  + [Sign up for Foundation Membership](https://openinfra.dev/join/)
  + [Sponsor the Foundation](https://openinfra.dev/join/)
  + [More about the Foundation](https://openinfra.dev)
* [Log In](https://www.openstack.org/Security/login/?BackURL=/home/)

# OSSA-2015-021: Nova network security group changes are not applied to running instances

# OSSA-2015-021: Nova network security group changes are not applied to running instances[Â¶](#ossa-2015-021-nova-network-security-group-changes-are-not-applied-to-running-instances "Link to this heading")

Date:

October 06, 2015

CVE:

CVE-2015-7713

## Affects[Â¶](#affects "Link to this heading")

* Nova: <=2014.2.3, >=2015.1.0, <=2015.1.1

## Description[Â¶](#description "Link to this heading")

Sreekumar S. and Suntao independently reported a vulnerability in Nova network. Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group. All Nova network setups are affected.

## Patches[Â¶](#patches "Link to this heading")

* <https://review.openstack.org/222026> (Juno)
* <https://review.openstack.org/222023> (Kilo)
* <https://review.openstack.org/222022> (Liberty)

## Credits[Â¶](#credits "Link to this heading")

* Sreekumar S. (CVE-2015-7713)
* Suntao (CVE-2015-7713)

## References[Â¶](#references "Link to this heading")

* <https://bugs.launchpad.net/bugs/1491307>
* <https://bugs.launchpad.net/bugs/1484738>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7713>

## Notes[Â¶](#notes "Link to this heading")

* This fix will be included in future 2014.2.4 (juno) and 2015.1.2
  (kilo) releases.

this page last updated: 2025-01-07 18:17:35

[![Creative Commons Attribution 3.0 License](../_static/images/docs/license.png)](https://creativecommons.org/licenses/by/3.0/)

Except where otherwise noted, this document is licensed under
[Creative Commons
Attribution 3.0 License](https://creativecommons.org/licenses/by/3.0/). See all [OpenStack Legal Documents](https://www.openstack.org/legal).

found an error? report a bug

OpenStack Documentation

* Guides
* [Install Guides](https://docs.openstack.org/index.html#install-guides)
* [User Guides](https://docs.openstack.org/index.html#user-guides)
* [Configuration Guides](https://docs.openstack.org/index.html#configuration-guides)
* [Operations and Administration Guides](https://docs.openstack.org/index.html#ops-and-admin-guides)
* [API Guides](https://docs.openstack.org/index.html#api-guides)
* [Contributor Guides](https://docs.openstack.org/index.html#contributor-guides)
* Languages
* [Deutsch (German)](https://docs.openstack.org/de/)
* [FranÃ§ais (French)](https://docs.openstack.org/fr/)
* [Bahasa Indonesia (Indonesian)](https://docs.openstack.org/id/)
* [Italiano (Italian)](https://docs.openstack.org/it/)
* [æ¥æ¬èª (Japanese)](https://docs.openstack.org/ja/)
* [íêµ­ì´ (Korean)](https://docs.openstack.org/ko_KR/)
* [PortuguÃªs (Portuguese)](https://docs.openstack.org/pt_BR/)
* [TÃ¼rkÃ§e (TÃ¼rkiye)](https://docs.openstack.org/tr_TR/)
* [ç®ä½ä¸­æ (Simplified Chinese)](https://docs.openstack.org/zh_CN/)

#### Contents

* OSSA-2015-021: Nova network security group changes are not applied to running instances
  + [Affects](#affects)
  + [Description](#description)
  + [Patches](#patches)
  + [Credits](#credits)
  + [References](#references)
  + [Notes](#notes)

### OpenStack

* [Projects](https://www.openstack.org/software/project-navigator/)
* [OpenStack Security](https://security.openstack.org/)
* [Blog](https://openstack.org/blog/)
* [News](https://openstack.org/news/)

### Community

* [User Groups](https://www.meetup.com/pro/openinfradev/)
* [Events](https://openstack.org/community/events/)
* [Jobs](https://openstack.org/community/jobs/)
* [Companies](https://openinfra.dev/members/)
* [Contribute](https://docs.openstack.org/contributors)

### Documentation

* [OpenStack Manuals](https://docs.openstack.org)
* [Getting Started](https://openstack.org/software/start/)
* [API Documentation](https://developer.openstack.org)
* [Wiki](https://wiki.openstack.org)

### Branding & Legal

* [Legal Docs](https://openinfra.dev/legal)
* [Logos & Guidelines](https://openstack.org/brand/)
* [Trademark Policy](https://openinfra.dev/legal/trademark-policy)
* [Privacy Policy](https://openinfra.dev/privacy-policy)
* [OpenInfra CLA](https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement)

### Stay In Touch

The OpenStack project is provided under the
[Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0). Docs.openstack.org is powered by
[Rackspace Cloud Computing](https://rackspace.com).



=== Content from bugzilla.redhat.com_5e13094f_20250126_012940.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1268051)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1268051)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1268051)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1268051

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1268051**](show_bug.cgi?id=1268051)
- volume attach failed with iser

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
volume attach failed with iser

| | [Keywords](describekeywords.cgi): | OtherQA  Triaged  ZStream | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Red Hat OpenStack | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Red Hat | | [Component:](describecomponents.cgi?product=Red Hat OpenStack "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | openstack-nova | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 7.0 (Kilo) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86\_64 | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | z3 | | [Target Release](page.cgi?id=fields.html#target_release): | 7.0 (Kilo) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Lee Yarwood | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | nlevinki | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1268051&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1268051&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-10-01 17:01 UTC by Lenny Verkhovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-02-22 23:02 UTC ([History](show_activity.cgi?id=1268051)) | | [CC List:](page.cgi?id=fields.html#cclist) | 16 users (show)  berrange dasmith dron eglynn kchamart lennyb lyarwood moshele ndipanov pbrady rbiba sbauza sferdjao sgordon vromanso yeylon | | Fixed In Version: | openstack-nova-2015.1.2-4.el7ost | | | Doc Type: | Bug Fix | | | Doc Text: | The fix for bug 1228295 changed the return value when no host devices were found when connecting to an iSCSI or iSER volume. As a consequence, when no host devices were found, an exception was thrown as os.path.exists(None) was called. This in turn caused the connect volume attempt to fail. This update reverts the return value when no host devices are present, and adds an additional check to ensure os.path.exists(None) is never called. As a result, an exception is no longer thrown when no host devices are present and the connect logic correctly retries finding any host devices present. | | | Clone Of: |  | | | Environment: | openstack-kilo RHEL7.1 | | | Last Closed: | 2015-12-21 17:06:20 UTC | | | Target Upstream Version: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**patch**](attachment.cgi?id=1080290 "View the content of the attachment") (694 bytes, patch)  [2015-10-06 15:34 UTC](#attach_1080290 "Go to the comment associated with the attachment"), Lenny Verkhovsky | *no flags* | [Details](attachment.cgi?id=1080290&action=edit) | [Diff](attachment.cgi?id=1080290&action=diff) | | [**logs and confs**](attachment.cgi?id=1081770 "View the content of the attachment") (648.24 KB, application/x-bzip)  [2015-10-11 07:02 UTC](#attach_1081770 "Go to the comment associated with the attachment"), Lenny Verkhovsky | *no flags* | [Details](attachment.cgi?id=1081770&action=edit) | | [**logs**](attachment.cgi?id=1084157 "View the content of the attachment") (48.22 KB, application/x-gzip)  [2015-10-18 12:50 UTC](#attach_1084157 "Go to the comment associated with the attachment"), Lenny Verkhovsky | *no flags* | [Details](attachment.cgi?id=1084157&action=edit) | | [**logs**](attachment.cgi?id=1085089 "View the content of the attachment") (40.61 KB, application/x-gzip)  [2015-10-21 11:00 UTC](#attach_1085089 "Go to the comment associated with the attachment"), Lenny Verkhovsky | *no flags* | [Details](attachment.cgi?id=1085089&action=edit) | | [**logs**](attachment.cgi?id=1085414 "View the content of the attachment") (138.38 KB, application/x-gzip)  [2015-10-22 06:50 UTC](#attach_1085414 "Go to the comment associated with the attachment"), Lenny Verkhovsky | *no flags* | [Details](attachment.cgi?id=1085414&action=edit) | | [View All](attachment.cgi?bugid=1268051&action=viewall) | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Issue Tracker | [OSP-16693](https://issues.redhat.com/browse/OSP-16693) | 0 | None | None | None | 2022-07-09 08:01:49 UTC | | Red Hat Product Errata | [RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-nova security and bug fix advisory | 2015-12-21 21:51:35 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1268051#c0)  Lenny Verkhovsky    2015-10-01 17:01:31 UTC  ``` Description of problem:   Regarding code in /usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py          # Check host_device only when transport is used, since otherwise it is         # directly derived from properties. Only needed for unit tests         # Loop until at least 1 path becomes available         while ((self._get_transport() != "default" and not host_devices)                or all(map(lambda x: not os.path.exists(x), host_devices))):   Since in Nova kilo host_device initialized to None, and stays None in case /dev/disk/by-path wasn’t updated on the first try (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume.py#L842-L846>), but in packstack code host_device modified to a list, then it won’t pass the os.path.exists() for the None initialized host_device param like in (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume.py#L446-L447>) since os.path.exists crash for None values.  One solution is to remove all the None values from the host_devices  Version-Release number of selected component (if applicable): openstack-kilo  Actual results: volume attach fails    Expected results: volume attach passes and set to be 'in-use'  Additional info:   ```  [Comment 2](show_bug.cgi?id=1268051#c2)  Lenny Verkhovsky    2015-10-06 15:34:39 UTC  ``` Created [attachment 1080290](attachment.cgi?id=1080290&action=diff "patch") [[details]](attachment.cgi?id=1080290&action=edit "patch") patch   ```  [Comment 3](show_bug.cgi?id=1268051#c3)  Eoghan Glynn    2015-10-09 11:13:33 UTC  ``` Please provide logs and proper NVR versioning of the nova RPMs in use, i.e.:    $ sudo rpm -qa | grep nova   ```  [Comment 4](show_bug.cgi?id=1268051#c4)  Lenny Verkhovsky    2015-10-11 07:02:50 UTC  ``` Created [attachment 1081770](attachment.cgi?id=1081770 "logs and confs") [[details]](attachment.cgi?id=1081770&action=edit "logs and confs") logs and confs  logs and confs   ```  [Comment 5](show_bug.cgi?id=1268051#c5)  Lenny Verkhovsky    2015-10-11 07:03:13 UTC  ``` # sudo rpm -qa | grep nova python-novaclient-2.23.0-1.el7ost.noarch openstack-nova-console-2015.1.0-18.el7ost.noarch openstack-nova-common-2015.1.0-18.el7ost.noarch openstack-nova-scheduler-2015.1.0-18.el7ost.noarch openstack-nova-conductor-2015.1.0-18.el7ost.noarch openstack-nova-api-2015.1.0-18.el7ost.noarch openstack-nova-cert-2015.1.0-18.el7ost.noarch openstack-nova-compute-2015.1.0-18.el7ost.noarch python-nova-2015.1.0-18.el7ost.noarch openstack-nova-novncproxy-2015.1.0-18.el7ost.noarch   ```  [Comment 6](show_bug.cgi?id=1268051#c6)  Lee Yarwood    2015-10-16 15:14:39 UTC  ``` (In reply to Lenny Verkhovsky from [comment #0](show_bug.cgi?id=1268051#c0)) > Description of problem: >  >  > Regarding code in > /usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py >  >         # Check host_device only when transport is used, since otherwise it > is >         # directly derived from properties. Only needed for unit tests >         # Loop until at least 1 path becomes available >         while ((self._get_transport() != "default" and not host_devices) >                or all(map(lambda x: not os.path.exists(x), host_devices))): >  >  > Since in Nova kilo host_device initialized to None, and stays None in case > /dev/disk/by-path wasn’t updated on the first try > (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume>. > py#L842-L846), but in packstack code host_device modified to a list, then it > won’t pass the os.path.exists() for the None initialized host_device param > like in > (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume>. > py#L446-L447) since os.path.exists crash for None values. >  > One solution is to remove all the None values from the host_devices  I might be missing something here but all I see in the logs is an incorrect rootwrap filter due to pci identifiers for the HBA being included in the paths :  21982 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher ProcessExecutionError: Unexpected error while running command. 21983 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Command: sudo nova-rootwrap /etc/nova/rootwrap.conf ln --symbolic --force /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0  /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 21984 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Exit code: 99 21985 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Stdout: u'' 21986 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Stderr: u'/usr/bin/nova-rootwrap: Unauthorized command: ln --symbolic --force /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 (no filter matched)\n'  With the following filter set by default in OSP 7 for ln :  /usr/share/nova/rootwrap/compute.filters:212:ln: RegExpFilter, ln, root, ln, --symbolic, --force, /dev/mapper/ip-.*-iscsi-iqn.*, /dev/disk/by-path/ip-.*-iscsi-iqn.*  Changed upstream here :  rootwrap: update ln --symbolic filter for FS and FC type volume drivers <https://review.openstack.org/#/c/197713/>  Lenny, does the following filter regex work for you instead of the default in /usr/share/nova/rootwrap/compute.filters or do you still see issues ?  ln: RegExpFilter, ln, root, ln, --symbolic, --force, /dev/mapper/.*, .*   ```  [Comment 7](show_bug.cgi?id=1268051#c7)  Lenny Verkhovsky    2015-10-18 12:50:27 UTC  ``` Created [attachment 1084157](attachment.cgi?id=1084157 "logs") [[details]](attachment.cgi?id=1084157&action=edit "logs") logs   Reproduce:  testr run tempest.scenario.test_minimum_basic.TestMinimumBasicScenario   Traceback  2015-10-18 15:42:21.204 29999 TRACE oslo_messaging.rpc.dispatcher     or all(map(lambda x: not os.path.exists(x), host_devices))): 2015-10-18 15:42:21.204 29999 TRACE oslo_messaging.rpc.dispatcher   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py", line 476, in <lambda> 2015-10-18 15:42:21.204 29999 TRACE oslo_messaging.rpc.dispatcher     or all(map(lambda x: not os.path.exists(x), host_devices))): 2015-10-18 15:42:21.204 29999 TRACE oslo_messaging.rpc.dispatcher   File "/usr/lib64/python2.7/genericpath.py", line 18, in exists 2015-10-18 15:42:21.204 29999 TRACE oslo_messaging.rpc.dispatcher     os.stat(path) 20   ```  [Comment 8](show_bug.cgi?id=1268051#c8)  Lenny Verkhovsky    2015-10-18 13:08:02 UTC  ``` (In reply to Lee Yarwood from [comment #6](show_bug.cgi?id=1268051#c6)) > (In reply to Lenny Verkhovsky from [comment #0](show_bug.cgi?id=1268051#c0)) > > Description of problem: > >  > >  > > Regarding code in > > /usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py > >  > >         # Check host_device only when transport is used, since otherwise it > > is > >         # directly derived from properties. Only needed for unit tests > >         # Loop until at least 1 path becomes available > >         while ((self._get_transport() != "default" and not host_devices) > >                or all(map(lambda x: not os.path.exists(x), host_devices))): > >  > >  > > Since in Nova kilo host_device initialized to None, and stays None in case > > /dev/disk/by-path wasn’t updated on the first try > > (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume>. > > py#L842-L846), but in packstack code host_device modified to a list, then it > > won’t pass the os.path.exists() for the None initialized host_device param > > like in > > (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume>. > > py#L446-L447) since os.path.exists crash for None values. > >  > > One solution is to remove all the None values from the host_devices >  > I might be missing something here but all I see in the logs is an incorrect > rootwrap filter due to pci identifiers for the HBA being included in the > paths : >  > 21982 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > ProcessExecutionError: Unexpected error while running command. > 21983 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > Command: sudo nova-rootwrap /etc/nova/rootwrap.conf ln --symbolic --force > /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack: > volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0  > /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org. > openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 > 21984 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Exit > code: 99 > 21985 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > Stdout: u'' > 21986 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > Stderr: u'/usr/bin/nova-rootwrap: Unauthorized command: ln --symbolic > --force > /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack: > volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 > /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org. > openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 (no filter > matched)\n' >  > With the following filter set by default in OSP 7 for ln : >  > /usr/share/nova/rootwrap/compute.filters:212:ln: RegExpFilter, ln, root, ln, > --symbolic, --force, /dev/mapper/ip-.*-iscsi-iqn.*, > /dev/disk/by-path/ip-.*-iscsi-iqn.* >  > Changed upstream here : >  > rootwrap: update ln --symbolic filter for FS and FC type volume drivers > <https://review.openstack.org/#/c/197713/> >  > Lenny, does the following filter regex work for you instead of the default > in /usr/share/nova/rootwrap/compute.filters or do you still see issues ? >  > ln: RegExpFilter, ln, root, ln, --symbolic, --force, /dev/mapper/.*, .*  This is indeed another issue ( encrypt/decrypt ). We are checking this and will open another bug if needed. Those logs were also created with pacthed volume.py.  I've attached new logs with reproduction of the issue in the next comment.   ```  [Comment 9](show_bug.cgi?id=1268051#c9)  Lenny Verkhovsky    2015-10-19 07:00:47 UTC  ``` (In reply to Lenny Verkhovsky from [comment #8](show_bug.cgi?id=1268051#c8)) > (In reply to Lee Yarwood from [comment #6](show_bug.cgi?id=1268051#c6)) > > (In reply to Lenny Verkhovsky from [comment #0](show_bug.cgi?id=1268051#c0)) > > > Description of problem: > > >  > > >  > > > Regarding code in > > > /usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py > > >  > > >         # Check host_device only when transport is used, since otherwise it > > > is > > >         # directly derived from properties. Only needed for unit tests > > >         # Loop until at least 1 path becomes available > > >         while ((self._get_transport() != "default" and not host_devices) > > >                or all(map(lambda x: not os.path.exists(x), host_devices))): > > >  > > >  > > > Since in Nova kilo host_device initialized to None, and stays None in case > > > /dev/disk/by-path wasn’t updated on the first try > > > (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume>. > > > py#L842-L846), but in packstack code host_device modified to a list, then it > > > won’t pass the os.path.exists() for the None initialized host_device param > > > like in > > > (<https://github.com/openstack/nova/blob/stable/kilo/nova/virt/libvirt/volume>. > > > py#L446-L447) since os.path.exists crash for None values. > > >  > > > One solution is to remove all the None values from the host_devices > >  > > I might be missing something here but all I see in the logs is an incorrect > > rootwrap filter due to pci identifiers for the HBA being included in the > > paths : > >  > > 21982 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > > ProcessExecutionError: Unexpected error while running command. > > 21983 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > > Command: sudo nova-rootwrap /etc/nova/rootwrap.conf ln --symbolic --force > > /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack: > > volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0  > > /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org. > > openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 > > 21984 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Exit > > code: 99 > > 21985 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > > Stdout: u'' > > 21986 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher > > Stderr: u'/usr/bin/nova-rootwrap: Unauthorized command: ln --symbolic > > --force > > /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack: > > volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 > > /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org. > > openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 (no filter > > matched)\n' > >  > > With the following filter set by default in OSP 7 for ln : > >  > > /usr/share/nova/rootwrap/compute.filters:212:ln: RegExpFilter, ln, root, ln, > > --symbolic, --force, /dev/mapper/ip-.*-iscsi-iqn.*, > > /dev/disk/by-path/ip-.*-iscsi-iqn.* > >  > > Changed upstream here : > >  > > rootwrap: update ln --symbolic filter for FS and FC type volume drivers > > <https://review.openstack.org/#/c/197713/> > >  > > Lenny, does the following filter regex work for you instead of the default > > in /usr/share/nova/rootwrap/compute.filters or do you still see issues ? > >  > > ln: RegExpFilter, ln, root, ln, --symbolic, --force, /dev/mapper/.*, .* >  > This is indeed another issue ( encrypt/decrypt ). We are checking this and > will open another bug if needed. Those logs were also created with pacthed > volume.py. >  > I've attached new logs with reproduction of the issue in the next comment.  <https://review.openstack.org/#/c/197713> fixed the encryption issue tempest.scenario.test_encrypted_cinder_volumes.TestEncryptedCinderVolumes  is passing now.   ```  [Comment 10](show_bug.cgi?id=1268051#c10)  Lee Yarwood    2015-10-20 13:40:14 UTC  ``` (In reply to Lenny Verkhovsky from [comment #9](show_bug.cgi?id=1268051#c9)) > <https://review.openstack.org/#/c/197713> fixed the encryption issue > tempest.scenario.test_encrypted_cinder_volumes.TestEncryptedCinderVolumes  > is passing now.  Thanks, apologies for the delay, I've opened the following RHBZ to track this into RHEL OSP 7.0.z :  Nova volume encryptors attach volume fails for NFS and FC (rootwrap)  [https://bugzilla.redhat.com/show_bug.cgi?id=1273466](show_bug.cgi?id=1273466 "CLOSED ERRATA - Nova volume encryptors attach volume fails for NFS and FC (rootwrap)")  (In reply to Lenny Verkhovsky from [comment #8](show_bug.cgi?id=1268051#c8)) > This is indeed another issue ( encrypt/decrypt ). We are checking this and > will open another bug if needed. Those logs were also created with pacthed > volume.py. >  > I've attached new logs with reproduction of the issue in the next comment.  Thanks that's better, as you've pointed out we have additionally backported the now abandoned Nova iscsi-multipath-enhancement [1] blueprint into RHEL OSP 7 [2].  As a result _get_host_devices can return a list containing a _single_ None value.   IMHO there's no need to loop over all host_devices and we can just address this within the lambda function while testing if the path exists :  # git diff diff --git a/nova/virt/libvirt/volume.py b/nova/virt/libvirt/volume.py index 3f3cc2b..7f668de 100644 --- a/nova/virt/libvirt/volume.py +++ b/nova/virt/libvirt/volume.py @@ -470,7 +470,8 @@ class LibvirtISCSIVolumeDriver(LibvirtBaseVolumeDriver):          # directly derived from properties. Only needed for unit tests          # Loop until at least 1 path becomes available          while ((self._get_transport() != "default" and not host_devices) -               or all(map(lambda x: not os.path.exists(x), host_devices))): +               or all(map(lambda x: x is None or not os.path.exists(x), +                           host_devices))):              if tries >= self.num_scan_tries:                  raise exception.NovaException(_("iSCSI device not found at %s")                                                % (host_devices))  Can you test this and confirm that it works as expected for you? Happy to reconsider your original patch if you feel I've missed something here.  Thanks in advance,  Lee  [1] <https://review.openstack.org/#/c/134683/> [2] [https://bugzilla.redhat.com/show_bug.cgi?id=1228295](show_bug.cgi?id=1228295)   ```  [Comment 11](show_bug.cgi?id=1268051#c11)  Lenny Verkhovsky    2015-10-21 06:29:00 UTC  ``` Lee, the proposed patch is not enough. the while loop keeps scanning until it fails at  if tries >= self.num_scan_tries:  2015-10-21 09:06:30.120 12553 TRACE oslo_messaging.rpc.dispatcher   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py", line 480, in connect_volume 2015-10-21 09:06:30.120 12553 TRACE oslo_messaging.rpc.dispatcher     % (host_devices)) 2015-10-21 09:06:30.120 12553 TRACE oslo_messaging.rpc.dispatcher NovaException: iSCSI device not found at [None]   Please, consider the following patch that fixes the root cause:  --- a/nova/virt/libvirt/volume.py +++ b/nova/virt/libvirt/volume.py +++ /tmp/volume.py      2015-10-21 09:21:03.957542634 +0300 @@ -900,11 +900,11 @@ class LibvirtISCSIVolumeDriver(LibvirtBa          if self._get_transport() == "default":              return [("/dev/disk/by-path/%s" % device)]          else: -            host_device = None +            host_device = []              look_for_device = glob.glob('/dev/disk/by-path/*%s' % device)              if look_for_device: -                host_device = look_for_device[0] -            return [host_device] +                host_device = [look_for_device[0]] +            return host_device       def _reconnect(self, iscsi_properties):          # Note: iscsiadm does not support changing iface.iscsi_ifacename   ```  [Comment 12](show_bug.cgi?id=1268051#c12)  Lee Yarwood    2015-10-21 10:17:54 UTC  ``` (In reply to Lenny Verkhovsky from [comment #11](show_bug.cgi?id=1268051#c11)) > Lee, the proposed patch is not enough. > the while loop keeps scanning until it fails at  > if tries >= self.num_scan_tries: >  > 2015-10-21 09:06:30.120 12553 TRACE oslo_messaging.rpc.dispatcher   File > "/usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py", line 480, in > connect_volume > 2015-10-21 09:06:30.120 12553 TRACE oslo_messaging.rpc.dispatcher     % > (host_devices)) > 2015-10-21 09:06:30.120 12553 TRACE oslo_messaging.rpc.dispatcher > NovaException: iSCSI device not found at [None]  Thanks Lenny, can you provide the full log including the retries prior to this? Also the current iscsi_iface setting with `openstack-config --get /etc/nova/nova.conf libvirt iscsi_iface`.  > Please, consider the following patch that fixes the root cause: >  > --- a/nova/virt/libvirt/volume.py > +++ b/nova/virt/libvirt/volume.py > +++ /tmp/volume.py      2015-10-21 09:21:03.957542634 +0300 > @@ -900,11 +900,11 @@ class LibvirtISCSIVolumeDriver(LibvirtBa >          if self._get_transport() == "default": >              return [("/dev/disk/by-path/%s" % device)] >          else: > -            host_device = None > +            host_device = [] >              look_for_device = glob.glob('/dev/disk/by-path/*%s' % device) >              if look_for_device: > -                host_device = look_for_device[0] > -            return [host_device] > +                host_device = [look_for_device[0]] > +            return host_device >  >      def _reconnect(self, iscsi_properties): >          # Note: iscsiadm does not support changing iface.iscsi_ifacename  While this corrects the issue of os.path.exists() being called with a None value I think you're missing the impact of _get_host_devices not returning None during connect_volumes when no device paths are present.  The following will ensure that the retry loop is used correctly, without calling os.path.exists with None while still allowing host_devices to be refreshed at the end of each iteration :  # git diff diff --git a/nova/virt/libvirt/volume.py b/nova/virt/libvirt/volume.py index 3f3cc2b..caefef4 100644 --- a/nova/virt/libvirt/volume.py +++ b/nova/virt/libvirt/volume.py @@ -469,7 +469,7 @@ class LibvirtISCSIVolumeDriver(LibvirtBaseVolumeDriver):          # Check host_device only when transport is used, since otherwise it is          # directly derived from properties. Only needed for unit tests          # Loop until at least 1 path becomes available -        while ((self._get_transport() != "default" and not host_devices) +        while ((self._get_transport() != "default" and host_devices == [None])                 or all(map(lambda x: not os.path.exists(x), host_devices))):              if tries >= self.num_scan_tries:                  raise exception.NovaException(_("iSCSI device not found at %s") @@ -488,12 +488,13 @@ class LibvirtISCSIVolumeDriver(LibvirtBaseVolumeDriver):              # For offloaded open-iscsi transports, host_device cannot be              # guessed unlike iscsi_tcp where it can be obtained from              # properties, so try and get it again. -            if not host_devices and self._get_transport() != "default": +            if host_devices == [None] and self._get_transport() != "default":                  host_devices = self._get_host_devices(iscsi_properties)                tries = tries + 1   -            if all(map(lambda x: not os.path.exists(x), host_devices)): +            if (host_devices == [None] or +                    all(map(lambda x: not os.path.exists(x), host_devices))):                  time.sleep(tries ** 2)              else:                  break  Can you revert your changes and test the above in your environment?  If this fails please provide a full DEBUG enabled log from nova-compute.  Thanks in advance,  Lee   ```  [Comment 13](show_bug.cgi?id=1268051#c13)  Lenny Verkhovsky    2015-10-21 10:39:44 UTC  ``` Hi Lee,  your latest patch was applied and verified as working. ( Do you still need logs for patch with retries error ? )   ```  [Comment 14](show_bug.cgi?id=1268051#c14)  Lee Yarwood    2015-10-21 10:46:43 UTC  ``` (In reply to Lenny Verkhovsky from [comment #13](show_bug.cgi?id=1268051#c13)) > Hi Lee,  > your latest patch was applied and verified as working. > ( Do you still need logs for patch with retries error ? )  Please, just to review and ensure I've not missed anything here as I don't have an ISER environment to hand.   ```  [Comment 15](show_bug.cgi?id=1268051#c15)  Lenny Verkhovsky    2015-10-21 11:00:42 UTC  ``` Created [attachment 1085089](attachment.cgi?id=1085089 "logs") [[details]](attachment.cgi?id=1085089&action=edit "logs") logs  Small update in patch ( see below ) log and dmesg log attached   --- volume.py    +++ volume.py     @@ -470,7 +470,8 @@ class LibvirtISCSIVolumeDriver(LibvirtBa          # directly derived from properties. Only needed for unit tests          # Loop until at least 1 path becomes available          while ((self._get_transport() != "default" and not host_devices) -               or all(map(lambda x: not os.path.exists(x), host_devices))): +               or all(map(lambda x: x is None or not os.path.exists(x), +                           host_devices))):              if tries >= self.num_scan_tries:                  raise exception.NovaException(_("iSCSI device not found at %s")                                                % (host_devices)) @@ -493,7 +494,8 @@ class LibvirtISCSIVolumeDriver(LibvirtBa               tries = tries + 1  -            if all(map(lambda x: not os.path.exists(x), host_devices)): +            if all(map(lambda x: x is None or not os.path.exists(x), +                        host_devices)):                  time.sleep(tries ** 2)              else:                  break   ```  [Comment 16](show_bug.cgi?id=1268051#c16)  Lee Yarwood    2015-10-21 11:15:24 UTC  ``` (In reply to Lenny Verkhovsky from [comment #15](show_bug.cgi?id=1268051#c15)) > Created [attachment 1085089](attachment.cgi?id=1085089 "logs") [[details]](attachment.cgi?id=1085089&action=edit "logs") > logs >  > Small update in patch ( see below ) > log and dmesg log attached  I don't see a successful attach in the logs, are these the correct logs?  333 2015-10-21 13:53:19.358 30448 TRACE oslo_messaging.rpc.dispatcher NovaException: iSCSI device not found at [None]  Can you also provide output for the following commands :  # openstack-config --get /etc/nova/nova.conf libvirt iscsi_iface # ll /dev/disk/by-path/*ip-*-iscsi-*-lun-*   ```  [Comment 17](show_bug.cgi?id=1268051#c17)  Lenny Verkhovsky    2015-10-21 11:30:05 UTC  ``` I believe that logs are correct. I've re-run it with the same result.    # openstack-config --get /etc/nova/nova.conf libvirt iscsi_iface Parameter not found: iscsi_iface [root@r-ufm173 openstack-tempest-kilo]# ll /dev/disk/by-path/*ip-*-iscsi-*-lun-* lrwxrwxrwx. 1 root root 9 Oct 18 16:30 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-23b19a42-d9ee-4d32-bea8-6aea8b75faf6-lun-0 -> ../../sdb lrwxrwxrwx. 1 root root 9 Oct 20 21:48 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-2774e7f0-b163-4a11-b703-c85ac6a3dbe0-lun-0 -> ../../sdl lrwxrwxrwx. 1 root root 9 Oct 21 09:05 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-2dd18dfd-f805-45fd-ab33-6cc9b4b9a728-lun-0 -> ../../sdn lrwxrwxrwx. 1 root root 9 Oct 20 17:24 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-4349d98a-7119-4014-9cb3-6cc9fee06517-lun-0 -> ../../sdf lrwxrwxrwx. 1 root root 9 Oct 20 17:55 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-4bb04f8e-6cbc-4695-86b3-93e32e7fac9f-lun-0 -> ../../sdi lrwxrwxrwx. 1 root root 9 Oct 20 17:18 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-53b7d22a-913c-45a1-a19a-c77a39580d50-lun-0 -> ../../sde lrwxrwxrwx. 1 root root 9 Oct 20 17:48 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-8aedc697-126a-4adb-a674-ed9719acdf1f-lun-0 -> ../../sdh lrwxrwxrwx. 1 root root 9 Oct 20 21:23 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-9096d9d3-1fd3-4f1b-8c93-1aa2c8268f07-lun-0 -> ../../sdj lrwxrwxrwx. 1 root root 9 Oct 20 17:36 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-9dc5477b-4ae2-4e88-b8c4-f69da6b647bd-lun-0 -> ../../sdg lrwxrwxrwx. 1 root root 9 Oct 21 13:52 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b766c2e3-3a43-4ca9-a674-5bfa87eda1e0-lun-0 -> ../../sdo lrwxrwxrwx. 1 root root 9 Oct 21 08:53 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-c4329d31-23d2-45f4-aee3-3fa220cc9f85-lun-0 -> ../../sdm lrwxrwxrwx. 1 root root 9 Oct 20 21:30 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-d94eb716-84f1-4142-8bf7-97ec2fde95f4-lun-0 -> ../../sdk   ```  [Comment 18](show_bug.cgi?id=1268051#c18)  Lee Yarwood    2015-10-21 13:36:58 UTC  ``` (In reply to Lenny Verkhovsky from [comment #17](show_bug.cgi?id=1268051#c17)) > I believe that logs are correct. I've re-run it with the same result.  The following snippet from the logs clearly shows a failure to attach the b766c2e3 volume to the 1d1485ff instance. Was this volume and instance part of your test run that succeeded?  223 2015-10-21 13:52:12.670 30448 INFO nova.compute.manager [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] Attaching volume b766c2e3-3a43-4ca9-a674-5bfa87eda1e0 to /dev/vdb 224 2015-10-21 13:52:22.781 30448 WARNING nova.virt.libvirt.volume [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] ISCSI volume not yet found at: vdb. Will rescan & retry.  Try number: 0 225 2015-10-21 13:52:23.904 30448 WARNING nova.virt.libvirt.volume [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] ISCSI volume not yet found at: vdb. Will rescan & retry.  Try number: 1 226 2015-10-21 13:52:28.029 30448 WARNING nova.virt.libvirt.volume [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] ISCSI volume not yet found at: vdb. Will rescan & retry.  Try number: 2 227 2015-10-21 13:52:37.153 30448 WARNING nova.virt.libvirt.volume [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] ISCSI volume not yet found at: vdb. Will rescan & retry.  Try number: 3 [..] 233 2015-10-21 13:52:53.286 30448 WARNING nova.virt.libvirt.volume [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] ISCSI volume not yet found at: vdb. Will rescan & retry.  Try number: 4 234 2015-10-21 13:53:18.410 30448 ERROR nova.virt.block_device [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] Driver failed to attach volume b766c2e3-3a43-4ca9-a674-5bfa87eda1e0 at /dev/vdb 235 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] Traceback (most recent call last): 236 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/block_device.py", line 253, in attach 237 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     device_type=self['device_type'], encryption=encryption) 238 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py", line 1070, in attach_volume 239 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     self._connect_volume(connection_info, disk_info) 240 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py", line 1021, in _connect_volume 241 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     driver.connect_volume(connection_info, disk_info) 242 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py", line 445, in inner 243 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     return f(*args, **kwargs) 244 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py", line 477, in connect_volume 245 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     % (host_devices)) 246 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] NovaException: iSCSI device not found at [None] 247 2015-10-21 13:53:18.410 30448 TRACE nova.virt.block_device [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] 248 2015-10-21 13:53:19.127 30448 ERROR nova.compute.manager [req-0e6ae146-2388-4521-9d86-a425dfbf3b70 3ca462dfcecd4c77b0745169f1088755 54f794084de847658a57b2033b4320d5 - - -] [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] Failed to attach b766c2e3-3a43-4ca9-a674-5bfa87eda1e0 at /dev/vdb 249 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] Traceback (most recent call last): 250 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/compute/manager.py", line 4798, in _attach_volume 251 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     do_check_attach=False, do_driver_attach=True) 252 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/block_device.py", line 49, in wrapped 253 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     ret_val = method(obj, context, *args, **kwargs) 254 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/block_device.py", line 262, in attach 255 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     connector) 256 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/oslo_utils/excutils.py", line 85, in __exit__ 257 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     six.reraise(self.type_, self.value, self.tb) 258 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/block_device.py", line 253, in attach 259 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     device_type=self['device_type'], encryption=encryption) 260 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py", line 1070, in attach_volume 261 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     self._connect_volume(connection_info, disk_info) 262 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py", line 1021, in _connect_volume 263 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     driver.connect_volume(connection_info, disk_info) 264 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py", line 445, in inner 265 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     return f(*args, **kwargs) 266 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]   File "/usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py", line 477, in connect_volume 267 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]     % (host_devices)) 268 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d] NovaException: iSCSI device not found at [None] 269 2015-10-21 13:53:19.127 30448 TRACE nova.compute.manager [instance: 1d1485ff-030f-45e6-a0eb-330ddea4f41d]  We can see this volume listed under /dev/disk/by-path/ below :  lrwxrwxrwx. 1 root root 9 Oct 21 13:52 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b766c2e3-3a43-4ca9-a674-5bfa87eda1e0-lun-0 -> ../../sdo  So either the path used during _get_host_devices to find this device is wrong _or_ we are not giving enough time for this device to come online in your environment.  Can you add iscsi_properties and host_devices to the output of the LOG.warn() line within the retry loop? This should provide some more context here once reproduced :  # git diff diff --git a/nova/virt/libvirt/volume.py b/nova/virt/libvirt/volume.py index 3f3cc2b..97fe542 100644 --- a/nova/virt/libvirt/volume.py +++ b/nova/virt/libvirt/volume.py @@ -469,15 +469,18 @@ class LibvirtISCSIVolumeDriver(LibvirtBaseVolumeDriver):          # Check host_device only when transport is used, since otherwise it is          # directly derived from properties. Only needed for unit tests          # Loop until at least 1 path becomes available -        while ((self._get_transport() != "default" and not host_devices) +        while ((self._get_transport() != "default" and host_devices == [None])                 or all(map(lambda x: not os.path.exists(x), host_devices))):              if tries >= self.num_scan_tries:                  raise exception.NovaException(_("iSCSI device not found at %s")                                                % (host_devices))   -            LOG.warn(_LW("ISCSI volume not yet found at: %(disk_dev)s. " +            LOG.warn(_LW("ISCSI volume not yet found for: %(disk_dev)s with" +                         "iscsi_properties: %(iscsi_props), " +                         "host_devices returned: %(host_devices)."                           "Will rescan & retry.  Try number: %(tries)s"), -                     {'disk_dev': disk_dev, 'tries': tries}) +                     {'disk_dev': disk_dev, 'iscsi_props':iscsi_properties, +                      'host_devices': host_devices, 'tries': tries})                # The rescan isn't documented as being necessary(?), but it helps              if self.use_multipath: @@ -488,12 +491,13 @@ class LibvirtISCSIVolumeDriver(LibvirtBaseVolumeDriver):              # For offloaded open-iscsi transports, host_device cannot be              # guessed unlike iscsi_tcp where it can be obtained from              # properties, so try and get it again. -            if not host_devices and self._get_transport() != "default": +            if host_devices == [None] and self._get_transport() != "default":                  host_devices = self._get_host_devices(iscsi_properties)                tries = tries + 1   -            if all(map(lambda x: not os.path.exists(x), host_devices)): +            if (host_devices == [None] or +                    all(map(lambda x: not os.path.exists(x), host_devices))):                  time.sleep(tries ** 2)              else:                  break   ```  [Comment 19](show_bug.cgi?id=1268051#c19)  Lenny Verkhovsky    2015-10-22 06:50:54 UTC  ``` Created [attachment 1085414](attachment.cgi?id=1085414 "logs") [[details]](attachment.cgi?id=1085414&action=edit "logs") logs  I've attached logs.  1. the following dev was attached and left after test  /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-03a54fcb-d13b-44fc-a78e-b0c5353b2f99-lun-0 -> ../../sdq  2. I've used my patch from c#15 with log message from c#18   ```  [Comment 20](show_bug.cgi?id=1268051#c20)  Lee Yarwood    2015-10-22 08:03:54 UTC  ``` (In reply to Lenny Verkhovsky from [comment #19](show_bug.cgi?id=1268051#c19)) > Created [attachment 1085414](attachment.cgi?id=1085414 "logs") [[details]](attachment.cgi?id=1085414&action=edit "logs") > logs >  > I've attached logs.  You have missed nova-compute.log for this run, can you please provide it?  > 1. the following dev was attached and left after test  > /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org. > openstack:volume-03a54fcb-d13b-44fc-a78e-b0c5353b2f99-lun-0 -> ../../sdq  In the tempest logs we can see volume 03a54fcb fail to reach an in-use (attached) status :  tmp/20151022_tempest.scenario.test_minimum_basic.TestMinimumBasicScenario.log  3453 Traceback (most recent call last): 3454   File "/usr/share/openstack-tempest-kilo/tempest/test.py", line 126, in wrapper 3455     return f(self, *func_args, **func_kwargs) 3456   File "/usr/share/openstack-tempest-kilo/tempest/scenario/test_minimum_basic.py", line 134, in test_minimum_basic_scenario 3457     self.nova_volume_attach() 3458   File "/usr/share/openstack-tempest-kilo/tempest/scenario/test_minimum_basic.py", line 84, in nova_volume_attach 3459     self.volumes_client.wait_for_volume_status(volume['id'], 'in-use') 3460   File "/usr/share/openstack-tempest-kilo/tempest/services/volume/json/volumes_client.py", line 182, in wait_for_volume_status 3461     raise exceptions.TimeoutException(message) 3462 TimeoutException: Request timed out 3463 Details: Volume 03a54fcb-d13b-44fc-a78e-b0c5353b2f99 failed to reach in-use status (current: available) within the required time (196 s). 3464 Ran 1 tests in 237.729s (+169.925s)   > 2. I've used my patch from c#15 with log message from c#18  The patch in c#15 is not required here. Can you please attach nova-compute logs from this run for review with the additional logging provided by the patch in c#18?   ```  [Comment 21](show_bug.cgi?id=1268051#c21)  Lee Yarwood    2015-10-22 10:38:55 UTC  ``` Thanks again for your time on the phone Lenny.Removing the NEEDINFO against you.  Just to confirm that the patch in c#18 does correct this for you. The logs provided in c#19 are using your patch from c#15. Apologies again for the confusion.  Unfortunately this fix is going to be a downstream-only given the use of the now abandoned Nova iscsi-multipath-enhancement blueprint in RHEL OSP 7. I'll propose this internally now and aim to get you a test build later today.   ```  [Comment 22](show_bug.cgi?id=1268051#c22)  Lee Yarwood    2015-10-30 16:49:19 UTC  ``` *** [Bug 1272884](show_bug.cgi?id=1272884 "CLOSED DUPLICATE - EncryptedCinderVolumes Tempest fails with iSER") has been marked as a duplicate of this bug. ***   ```  [Comment 27](show_bug.cgi?id=1268051#c27)  nlevinki    2015-12-01 13:22:12 UTC  ``` The fix is in the code. the ticket has been verified by third party. (see [comment 25](show_bug.cgi?id=1268051#c25))   ```  [Comment 29](show_bug.cgi?id=1268051#c29)  errata-xmlrpc    2015-12-21 17:06:20 UTC  ``` Since the problem described in this bug report should be resolved in a recent advisory, it has been closed with a resolution of ERRATA.  For information on the advisory, and where to find the updated files, follow the link below.  If the solution does not work for you, open a new bug report.  [https://access.redhat.com/errata/RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1268051&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from launchpad.net_ddee79b3_20250126_012940.html ===

[Log in / Register](https://launchpad.net/nova/kilo/2015.1.2/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# OpenStack Compute (nova) 2015.1.2

1. [Series kilo](https://launchpad.net/nova/kilo)
2. 2015.1.2

## Milestone information

Project:
[OpenStack Compute (nova)](/nova)

Series:
[kilo](/nova/kilo)

Version:
2015.1.2

Released:
2015-10-13

Registrant:
[Chuck Short](/~zulcss)

Release registered:
2015-10-13

Active:
No. Drivers cannot target bugs and blueprints to this milestone.

[Download RDF metadata](https://launchpad.net/nova/kilo/2015.1.2/%2Brdf)

## Activities

Assigned to you:
No blueprints or bugs assigned to you.

Assignees:
No users assigned to blueprints and bugs.

Blueprints:
No blueprints are targeted to this milestone.

Bugs:
No bugs are targeted to this milestone.

## Download files for this release

After you've downloaded a file, you can verify its authenticity
using its MD5 sum or signature.
([How do I
verify a download?](/%2Bhelp-registry/verify-downloads.html))

| File | Description | Downloads |
| --- | --- | --- |
| download icon **[nova-2015.1.2.tar.gz](https://launchpad.net/nova/kilo/2015.1.2/%2Bdownload/nova-2015.1.2.tar.gz "Nova 2015.1.2 release (4.4 MiB)")** ([md5](https://launchpad.net/nova/kilo/2015.1.2/%2Bdownload/nova-2015.1.2.tar.gz/%2Bmd5), [sig](https://launchpad.net/nova/kilo/2015.1.2/%2Bdownload/nova-2015.1.2.tar.gz.asc)) | Nova 2015.1.2 release | 632  last downloaded **8 days ago** |
| Total downloads: | | 632 |
| --- | --- | --- |

## Release notes

This is Nova 2015.1.2 release.

## Changelog

*This release does not have a changelog.*

## 0 blueprints and 0 bugs targeted

There are no feature specifications or bug tasks targeted to this
milestone. The project's maintainer, driver, or bug supervisor
can target specifications and bug tasks to this milestone to track
the things that are expected to be completed for the release.

## Related milestones and releases

* [View
  milestones for
  OpenStack Compute (nova)](https://launchpad.net/nova/%2Bmilestones)
* [View
  milestones for
  OpenStack](https://launchpad.net/openstack/%2Bmilestones)
* [View
  releases for the
  OpenStack Compute (nova)
  kilo
  series](/nova/kilo)

This milestone
contains **Public** information
Everyone can see this information.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_5b3f305d_20250126_012933.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1484738/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# keyerror when refreshing instance security groups

Bug #1484738 reported by
[Sam Morrison](https://launchpad.net/~sorrison)
on 2015-08-13

[10](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [Matt Riedemann](https://launchpad.net/~mriedem) | [OpenStack Compute (nova) 12.0.0 "liberty"](https://launchpad.net/nova/%2Bmilestone/12.0.0) |
|  | [Juno](https://bugs.launchpad.net/nova/juno) | Fix Released | High | [Matt Riedemann](https://launchpad.net/~mriedem) | [OpenStack Compute (nova) 2014.2.4](https://launchpad.net/nova/%2Bmilestone/2014.2.4) |
|  | [Kilo](https://bugs.launchpad.net/nova/kilo) | Fix Released | High | [Matt Riedemann](https://launchpad.net/~mriedem) | [OpenStack Compute (nova) 2015.1.3](https://launchpad.net/nova/%2Bmilestone/2015.1.3) |

### Bug Description

On a clean kilo install using source security groups I am seeing the following trace on boot and delete

a2413f7] Deallocating network for instance \_deallocate\_network /usr/lib/python2.7/dist-packages/nova/compute/manager.py:2098

2015-08-14 09:46:06.688 11618 ERROR oslo\_messaging.rpc.dispatcher [req-b8f44d34-96b2-4e40-ac22-15ccc6e44e59 - - - - -] Exception during message handling: 'metadata'

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher Traceback (most recent call last):

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 142, in \_dispatch\_and\_reply

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher executor\_callback))

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 186, in \_dispatch

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher executor\_callback)

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 130, in \_do\_dispatch

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher result = func(ctxt, \*\*new\_args)

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 6772, in refresh\_instance\_security\_rules

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher return self.manager.refresh\_instance\_security\_rules(ctxt, instance)

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 434, in decorated\_function

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher args = (\_load\_instance(args[0]),) + args[1:]

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 425, in \_load\_instance

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher expected\_attrs=metas)

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/objects/instance.py", line 506, in \_from\_db\_object

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher instance['metadata'] = utils.instance\_meta(db\_inst)

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/utils.py", line 817, in instance\_meta

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher if isinstance(instance['metadata'], dict):

2015-08-14 09:46:06.688 11618 TRACE oslo\_messaging.rpc.dispatcher KeyError: 'metadata'

Tags:

[compute](/nova/%2Bbugs?field.tag=compute)
[security-groups](/nova/%2Bbugs?field.tag=security-groups)

[Zhenzan Zhou (zhenzan-zhou)](https://launchpad.net/~zhenzan-zhou)
on 2015-08-14

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Zhenzan Zhou (zhenzan-zhou) |

[Markus Zoeller (markus\_z) (mzoeller)](https://launchpad.net/~mzoeller)
on 2015-08-17

| **tags**: | added: security-groups |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Markus Zoeller (markus\_z) (mzoeller)](https://launchpad.net/~mzoeller) wrote on 2015-08-17: |  |  | [#1](/nova/%2Bbug/1484738/comments/1) |
| --- | --- | --- | --- |

@Sam Morrison:

Could you please add more information about how this can reproduced? What does your setup look like? Are all services running on the Kilo release or is it mixed Kilo/Liberty code? Can you reproduce it on Liberty as well?

@Sam Morrison:
Could you please add more information about how this can reproduced? What does your setup look like? Are all services running on the Kilo release or is it mixed Kilo/Liberty code? Can you reproduce it on Liberty as well?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Zhenzan Zhou (zhenzan-zhou)](https://launchpad.net/~zhenzan-zhou) wrote on 2015-08-18: |  |  | [#2](/nova/%2Bbug/1484738/comments/2) |
| --- | --- | --- | --- |

I tried on my devstack environment with latest Liberty code, cannot reproduce it. Need more info as asked by Markus.

I tried on my devstack environment with latest Liberty code, cannot reproduce it. Need more info as asked by Markus.

| Changed in nova: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sam Morrison (sorrison)](https://launchpad.net/~sorrison) wrote on 2015-08-18: |  |  | [#3](/nova/%2Bbug/1484738/comments/3) |
| --- | --- | --- | --- |

This is using stable/kilo and happens when I boot or delete an instance with source security groups and an instance with the source exists already.

Liberty isn't released yet so haven't looked at that.

This is using stable/kilo and happens when I boot or delete an instance with source security groups and an instance with the source exists already.
Liberty isn't released yet so haven't looked at that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sam Morrison (sorrison)](https://launchpad.net/~sorrison) wrote on 2015-08-18: |  |  | [#4](/nova/%2Bbug/1484738/comments/4) |
| --- | --- | --- | --- |

info provided

info provided

| Changed in nova: | |
| --- | --- |
| **status**: | Incomplete → New |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Andrew Bogott (andrewbogott)](https://launchpad.net/~andrewbogott) wrote on 2015-09-09: |  |  | [#5](/nova/%2Bbug/1484738/comments/5) |
| --- | --- | --- | --- |

This happens to me each time I try to create or delete an instance. It appears to be preventing any notifications from being sent, which is playing hell with designate.

This happens to me each time I try to create or delete an instance. It appears to be preventing any notifications from being sent, which is playing hell with designate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Andrew Bogott (andrewbogott)](https://launchpad.net/~andrewbogott) wrote on 2015-09-09: |  |  | [#6](/nova/%2Bbug/1484738/comments/6) |
| --- | --- | --- | --- |

Running a kilo/stable install which I just now upgraded from (working) Juno.

Running a kilo/stable install which I just now upgraded from (working) Juno.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-10: |  |  | [#7](/nova/%2Bbug/1484738/comments/7) |
| --- | --- | --- | --- |

Looks similar to [bug 1452510](/bugs/1452510) which was invalidated for some reason, no explanation.

Looks similar to bug 1452510 which was invalidated for some reason, no explanation.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-10: |  |  | [#8](/nova/%2Bbug/1484738/comments/8) |
| --- | --- | --- | --- |

Andrews trace from comment 6:

2015-09-10 02:20:20.408 6436 INFO nova.virt.libvirt.driver [req-b79a0b96-5fee-4178-8db6-6516305307c5 novaadmin testlabs - - -] [instance: d8ebcc1b-b1bf-461b-9c13-592b02848ff5] Creating image

2015-09-10 02:20:20.559 6436 ERROR oslo\_messaging.rpc.dispatcher [req-dd34a875-8f3d-4dbd-bf85-87ddddc53189 - - - - -] Exception during message handling: 'metadata'

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher Traceback (most recent call last):

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 142, in \_dispatch\_and\_reply

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher executor\_callback))

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 186, in \_dispatch

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher executor\_callback)

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 130, in \_do\_dispatch

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher result = func(ctxt, \*\*new\_args)

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 6772, in refresh\_instance\_security\_rules

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher return self.manager.refresh\_instance\_security\_rules(ctxt, instance)

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 434, in decorated\_function

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher args = (\_load\_instance(args[0]),) + args[1:]

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 425, in \_load\_instance

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher expected\_attrs=metas)

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/objects/instance.py", line 506, in \_from\_db\_object

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher instance['metadata'] = utils.instance\_meta(db\_inst)

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/utils.py", line 817, in instance\_meta

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher if isinstance(instance['metadata'], dict):

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher KeyError: 'metadata'

2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher

Andrews trace from comment 6:
2015-09-10 02:20:20.408 6436 INFO nova.virt.libvirt.driver [req-b79a0b96-5fee-4178-8db6-6516305307c5 novaadmin testlabs - - -] [instance: d8ebcc1b-b1bf-461b-9c13-592b02848ff5] Creating image
2015-09-10 02:20:20.559 6436 ERROR oslo\_messaging.rpc.dispatcher [req-dd34a875-8f3d-4dbd-bf85-87ddddc53189 - - - - -] Exception during message handling: 'metadata'
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher Traceback (most recent call last):
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 142, in \_dispatch\_and\_reply
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher executor\_callback))
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 186, in \_dispatch
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher executor\_callback)
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/oslo\_messaging/rpc/dispatcher.py", line 130, in \_do\_dispatch
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher result = func(ctxt, \*\*new\_args)
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 6772, in refresh\_instance\_security\_rules
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher return self.manager.refresh\_instance\_security\_rules(ctxt, instance)
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 434, in decorated\_function
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher args = (\_load\_instance(args[0]),) + args[1:]
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 425, in \_load\_instance
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher expected\_attrs=metas)
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/objects/instance.py", line 506, in \_from\_db\_object
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher instance['metadata'] = utils.instance\_meta(db\_inst)
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher File "/usr/lib/python2.7/dist-packages/nova/utils.py", line 817, in instance\_meta
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher if isinstance(instance['metadata'], dict):
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher KeyError: 'metadata'
2015-09-10 02:20:20.559 6436 TRACE oslo\_messaging.rpc.dispatcher

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-10: |  |  | [#9](/nova/%2Bbug/1484738/comments/9) |
| --- | --- | --- | --- |

Andrew/Sam - which version of kilo? trunk stable/kilo or 2015.1? 2015.1.1?

Also, using neutron or nova-network?

Andrew/Sam - which version of kilo? trunk stable/kilo or 2015.1? 2015.1.1?
Also, using neutron or nova-network?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-10: |  |  | [#10](/nova/%2Bbug/1484738/comments/10) |
| --- | --- | --- | --- |

(9:32:31 PM) mriedem: andrewbogott: btw, are you on trunk stable/kilo or like 2015.1?

(9:32:43 PM) andrewbogott: I’m using the cloud archive

(9:32:58 PM) andrewbogott: nova-compute 1:2015.1.1-0ubuntu1~cloud2

(9:34:00 PM) mriedem: nova-network?

(9:34:14 PM) andrewbogott: afraid so :(

(9:35:43 PM) mriedem: i was wondering if it was <https://review.openstack.org/#/c/211162/>

(9:36:32 PM) mriedem: i think that was actually an AttributeError though, not a KeyError

(9:32:31 PM) mriedem: andrewbogott: btw, are you on trunk stable/kilo or like 2015.1?
(9:32:43 PM) andrewbogott: I’m using the cloud archive
(9:32:58 PM) andrewbogott: nova-compute 1:2015.1.1-0ubuntu1~cloud2
(9:34:00 PM) mriedem: nova-network?
(9:34:14 PM) andrewbogott: afraid so :(
(9:35:43 PM) mriedem: i was wondering if it was https://review.openstack.org/#/c/211162/
(9:36:32 PM) mriedem: i think that was actually an AttributeError though, not a KeyError

| Changed in nova: | |
| --- | --- |
| **status**: | New → Confirmed |
| **importance**: | Undecided → High |
| **tags**: | added: kilo-backport-potential |
| **tags**: | added: network |

[Matt Riedemann (mriedem)](https://launchpad.net/~mriedem)
on 2015-09-10

| **tags**: | added: unified-objects |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-10: |  |  | [#11](/nova/%2Bbug/1484738/comments/11) |
| --- | --- | --- | --- |

The code obviously looks wrong, if you look at the call chain, we're in:

<https://github.com/openstack/nova/blob/stable/kilo/nova/compute/manager.py#L6798>

Which is calling the method in the compute manager which has the object\_compat decorator:

<https://github.com/openstack/nova/blob/stable/kilo/nova/compute/manager.py#L1345>

Then we get here:

<https://github.com/openstack/nova/blob/stable/kilo/nova/compute/manager.py#L421>

And metas is:

metas = ['metadata', 'system\_metadata'] and used above:

expected\_attrs=metas

But metas wouldn't be set there?

So we get the KeyError and then try this:

args = (\_load\_instance(args[0]),) + args[1:]

but again metas isn't set, right?

I guess it must be in scope though otherwise there would be a different error.

Plus we get here:

<https://github.com/openstack/nova/blob/stable/kilo/nova/objects/instance.py#L506>

Which means metadata was asked for, but it's not in the instance from the database so it blows up. Which means that whatever in the nova-api was calling refresh\_instance\_security\_rules wasn't originally asking for 'metadata' so it's not in the db instance passed to refresh\_instance\_security\_rules which goes into the object\_compat decorator and we fail.

The code obviously looks wrong, if you look at the call chain, we're in:
https://github.com/openstack/nova/blob/stable/kilo/nova/compute/manager.py#L6798
Which is calling the method in the compute manager which has the object\_compat decorator:
https://github.com/openstack/nova/blob/stable/kilo/nova/compute/manager.py#L1345
Then we get here:
https://github.com/openstack/nova/blob/stable/kilo/nova/compute/manager.py#L421
And metas is:
metas = ['metadata', 'system\_metadata'] and used above:
expected\_attrs=metas
But metas wouldn't be set there?
So we get the KeyError and then try this:
args = (\_load\_instance(args[0]),) + args[1:]
but again metas isn't set, right?
I guess it must be in scope though otherwise there would be a different error.
Plus we get here:
https://github.com/openstack/nova/blob/stable/kilo/nova/objects/instance.py#L506
Which means metadata was asked for, but it's not in the instance from the database so it blows up. Which means that whatever in the nova-api was calling refresh\_instance\_security\_rules wasn't originally asking for 'metadata' so it's not in the db instance passed to refresh\_instance\_security\_rules which goes into the object\_compat decorator and we fail.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sam Morrison (sorrison)](https://launchpad.net/~sorrison) wrote on 2015-09-10: |  |  | [#12](/nova/%2Bbug/1484738/comments/12) |
| --- | --- | --- | --- |

We're using stable/kilo, haven't resynced from upstream for about a week but having a look I can't see anything that we're missing that would fix it.

We're using stable/kilo, haven't resynced from upstream for about a week but having a look I can't see anything that we're missing that would fix it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-10: |  |  | [#13](/nova/%2Bbug/1484738/comments/13) |
| --- | --- | --- | --- |

<https://review.openstack.org/#/c/187537/> is the reason why this isn't a problem in liberty - because we pass an instance object from compute API to the compute manager so when the object\_compat decorator is hit, we already have an instance object and we don't need to call \_from\_db\_object.

That change has RPC API version changes though so we can't backport it to stable/kilo.

We should just have checks in the object\_compat decorator to not try and load attributes that aren't actually in the db instance (dict).

https://review.openstack.org/#/c/187537/ is the reason why this isn't a problem in liberty - because we pass an instance object from compute API to the compute manager so when the object\_compat decorator is hit, we already have an instance object and we don't need to call \_from\_db\_object.
That change has RPC API version changes though so we can't backport it to stable/kilo.
We should just have checks in the object\_compat decorator to not try and load attributes that aren't actually in the db instance (dict).

[Matt Riedemann (mriedem)](https://launchpad.net/~mriedem)
on 2015-09-10

| Changed in nova: | |
| --- | --- |
| **status**: | Confirmed → In Progress |
| **assignee**: | Zhenzan Zhou (zhenzan-zhou) → Matt Riedemann (mriedem) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-10:  [**Fix proposed to nova (master)**](/nova/%2Bbug/1484738/comments/14) |  |  | [#14](/nova/%2Bbug/1484738/comments/14) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/222022>

Fix proposed to branch: master
Review: https://review.openstack.org/222022

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-10:  [**Fix proposed to nova (stable/kilo)**](/nova/%2Bbug/1484738/comments/15) |  |  | [#15](/nova/%2Bbug/1484738/comments/15) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/222023>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/222023

[Matt Riedemann (mriedem)](https://launchpad.net/~mriedem)
on 2015-09-10

| **tags**: | removed: kilo-backport-potential |
| --- | --- |
| **tags**: | added: computeremoved: network security-groups unified-objects |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-10:  [**Fix proposed to nova (stable/juno)**](/nova/%2Bbug/1484738/comments/16) |  |  | [#16](/nova/%2Bbug/1484738/comments/16) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/juno

Review: <https://review.openstack.org/222026>

Fix proposed to branch: stable/juno
Review: https://review.openstack.org/222026

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-10:  [**Fix merged to nova (master)**](/nova/%2Bbug/1484738/comments/17) |  |  | [#17](/nova/%2Bbug/1484738/comments/17) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/222022>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=9369aab04e37b7818d49b00e65857be8b3564e9e>

Submitter: Jenkins

Branch: master

commit 9369aab04e37b7818d49b00e65857be8b3564e9e

Author: Matt Riedemann <email address hidden>

Date: Wed Sep 9 20:29:09 2015 -0700

Don't expect meta attributes in object\_compat that aren't in the db obj

The object\_compat decorator expects to get the Instance object with

    'metadata' and 'system\_metadata' attributes but if those aren't in the

    db instance dict object, Instance.\_from\_db\_object will fail with a

    KeyError.

In Kilo this happens per refresh\_instance\_security\_rules because in the

    compute API code, the instance passed to refresh\_instance\_security\_rules

    comes from the call to get the security group(s) which joins on the

    instances column, but that doesn't join on the metadata/system\_metadata

    fields for the instances. So when the instances get to object\_compat in

    the compute manager and the db instance dict is converted to the

    Instance object, it expects fields that aren't in the dict and we get

    the KeyError.

The refresh\_instance\_security\_rules case is fixed in Liberty per commit

    12fbe6f082ef9b70b89302e15daa12e851e507a7 - in that case the compute API

    passes Instance objects to the compute manager so object\_compat doesn't

    have anything to do, \_load\_instance just sees instance\_or\_dict isn't a

    dict and ignores it.

We're making this change since (1) it's an obviously wrong assumption in

    object\_compat and should be fixed and (2) we need to backport this fix

    to stable/kilo since it's an upgrade impact for users there.

Closes-Bug: #1484738

Change-Id: I36a954c095a9aa35879200784dc18e35edf689e6

Reviewed: https://review.openstack.org/222022
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=9369aab04e37b7818d49b00e65857be8b3564e9e
Submitter: Jenkins
Branch: master
commit 9369aab04e37b7818d49b00e65857be8b3564e9e
Author: Matt Riedemann <mriedem@us.ibm.com>
Date: Wed Sep 9 20:29:09 2015 -0700
Don't expect meta attributes in object\_compat that aren't in the db obj
The object\_compat decorator expects to get the Instance object with
'metadata' and 'system\_metadata' attributes but if those aren't in the
db instance dict object, Instance.\_from\_db\_object will fail with a
KeyError.
In Kilo this happens per refresh\_instance\_security\_rules because in the
compute API code, the instance passed to refresh\_instance\_security\_rules
comes from the call to get the security group(s) which joins on the
instances column, but that doesn't join on the metadata/system\_metadata
fields for the instances. So when the instances get to object\_compat in
the compute manager and the db instance dict is converted to the
Instance object, it expects fields that aren't in the dict and we get
the KeyError.
The refresh\_instance\_security\_rules case is fixed in Liberty per commit
12fbe6f082ef9b70b89302e15daa12e851e507a7 - in that case the compute API
passes Instance objects to the compute manager so object\_compat doesn't
have anything to do, \_load\_instance just sees instance\_or\_dict isn't a
dict and ignores it.
We're making this change since (1) it's an obviously wrong assumption in
object\_compat and should be fixed and (2) we need to backport this fix
to stable/kilo since it's an upgrade impact for users there.
Closes-Bug: #1484738
Change-Id: I36a954c095a9aa35879200784dc18e35edf689e6

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-11:  [**Fix merged to nova (stable/juno)**](/nova/%2Bbug/1484738/comments/18) |  |  | [#18](/nova/%2Bbug/1484738/comments/18) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/222026>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=dc5ced25c61fc742c513abc03b92e2d8f8042d8c>

Submitter: Jenkins

Branch: stable/juno

commit dc5ced25c61fc742c513abc03b92e2d8f8042d8c

Author: Matt Riedemann <email address hidden>

Date: Wed Sep 9 20:29:09 2015 -0700

Don't expect meta attributes in object\_compat that aren't in the db obj

The object\_compat decorator expects to get the Instance object with

    'metadata' and 'system\_metadata' attributes but if those aren't in the

    db instance dict object, Instance.\_from\_db\_object will fail with a

    KeyError.

In Kilo this happens per refresh\_instance\_security\_rules because in the

    compute API code, the instance passed to refresh\_instance\_security\_rules

    comes from the call to get the security group(s) which joins on the

    instances column, but that doesn't join on the metadata/system\_metadata

    fields for the instances. So when the instances get to object\_compat in

    the compute manager and the db instance dict is converted to the

    Instance object, it expects fields that aren't in the dict and we get

    the KeyError.

The refresh\_instance\_security\_rules case is fixed in Liberty per commit

    12fbe6f082ef9b70b89302e15daa12e851e507a7 - in that case the compute API

    passes Instance objects to the compute manager so object\_compat doesn't

    have anything to do, \_load\_instance just sees instance\_or\_dict isn't a

    dict and ignores it.

We're making this change since (1) it's an obviously wrong assumption in

    object\_compat and should be fixed and (2) we need to backport this fix

    to stable/kilo since it's an upgrade impact for users there.

Closes-Bug: #1484738

Conflicts:

            nova/tests/unit/compute/test\_compute.py

NOTE(mriedem): The conflict is due to the unit tests being moved in

    kilo, otherwise this is unchanged.

Change-Id: I36a954c095a9aa35879200784dc18e35edf689e6

    (cherry picked from commit 9369aab04e37b7818d49b00e65857be8b3564e9e)

    (cherry picked from commit 08d1153d3be9f8d59aa0acc03eedd45a1697ed7b)

Reviewed: https://review.openstack.org/222026
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=dc5ced25c61fc742c513abc03b92e2d8f8042d8c
Submitter: Jenkins
Branch: stable/juno
commit dc5ced25c61fc742c513abc03b92e2d8f8042d8c
Author: Matt Riedemann <mriedem@us.ibm.com>
Date: Wed Sep 9 20:29:09 2015 -0700
Don't expect meta attributes in object\_compat that aren't in the db obj
The object\_compat decorator expects to get the Instance object with
'metadata' and 'system\_metadata' attributes but if those aren't in the
db instance dict object, Instance.\_from\_db\_object will fail with a
KeyError.
In Kilo this happens per refresh\_instance\_security\_rules because in the
compute API code, the instance passed to refresh\_instance\_security\_rules
comes from the call to get the security group(s) which joins on the
instances column, but that doesn't join on the metadata/system\_metadata
fields for the instances. So when the instances get to object\_compat in
the compute manager and the db instance dict is converted to the
Instance object, it expects fields that aren't in the dict and we get
the KeyError.
The refresh\_instance\_security\_rules case is fixed in Liberty per commit
12fbe6f082ef9b70b89302e15daa12e851e507a7 - in that case the compute API
passes Instance objects to the compute manager so object\_compat doesn't
have anything to do, \_load\_instance just sees instance\_or\_dict isn't a
dict and ignores it.
We're making this change since (1) it's an obviously wrong assumption in
object\_compat and should be fixed and (2) we need to backport this fix
to stable/kilo since it's an upgrade impact for users there.
Closes-Bug: #1484738
Conflicts:
nova/tests/unit/compute/test\_compute.py
NOTE(mriedem): The conflict is due to the unit tests being moved in
kilo, otherwise this is unchanged.
Change-Id: I36a954c095a9aa35879200784dc18e35edf689e6
(cherry picked from commit 9369aab04e37b7818d49b00e65857be8b3564e9e)
(cherry picked from commit 08d1153d3be9f8d59aa0acc03eedd45a1697ed7b)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-11: |  |  | [#19](/nova/%2Bbug/1484738/comments/19) |
| --- | --- | --- | --- |

Interesting, we've actually hit this in the gate:

<http://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiS2V5RXJyb3I6ICdtZXRhZGF0YSdcIiBBTkQgbWVzc2FnZTpcInJlZnJlc2hfaW5zdGFuY2Vfc2VjdXJpdHlfcnVsZXNcIiBBTkQgdGFnczpcInNjcmVlbi1uLWNwdS50eHRcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQ0MTk3ODU4MzAyMywibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==>

Interesting, we've actually hit this in the gate:
http://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiS2V5RXJyb3I6ICdtZXRhZGF0YSdcIiBBTkQgbWVzc2FnZTpcInJlZnJlc2hfaW5zdGFuY2Vfc2VjdXJpdHlfcnVsZXNcIiBBTkQgdGFnczpcInNjcmVlbi1uLWNwdS50eHRcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQ0MTk3ODU4MzAyMywibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-14:  [**Fix merged to nova (stable/kilo)**](/nova/%2Bbug/1484738/comments/20) |  |  | [#20](/nova/%2Bbug/1484738/comments/20) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/222023>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=08d1153d3be9f8d59aa0acc03eedd45a1697ed7b>

Submitter: Jenkins

Branch: stable/kilo

commit 08d1153d3be9f8d59aa0acc03eedd45a1697ed7b

Author: Matt Riedemann <email address hidden>

Date: Wed Sep 9 20:29:09 2015 -0700

Don't expect meta attributes in object\_compat that aren't in the db obj

The object\_compat decorator expects to get the Instance object with

    'metadata' and 'system\_metadata' attributes but if those aren't in the

    db instance dict object, Instance.\_from\_db\_object will fail with a

    KeyError.

In Kilo this happens per refresh\_instance\_security\_rules because in the

    compute API code, the instance passed to refresh\_instance\_security\_rules

    comes from the call to get the security group(s) which joins on the

    instances column, but that doesn't join on the metadata/system\_metadata

    fields for the instances. So when the instances get to object\_compat in

    the compute manager and the db instance dict is converted to the

    Instance object, it expects fields that aren't in the dict and we get

    the KeyError.

The refresh\_instance\_security\_rules case is fixed in Liberty per commit

    12fbe6f082ef9b70b89302e15daa12e851e507a7 - in that case the compute API

    passes Instance objects to the compute manager so object\_compat doesn't

    have anything to do, \_load\_instance just sees instance\_or\_dict isn't a

    dict and ignores it.

We're making this change since (1) it's an obviously wrong assumption in

    object\_compat and should be fixed and (2) we need to backport this fix

    to stable/kilo since it's an upgrade impact for users there.

Closes-Bug: #1484738

Change-Id: I36a954c095a9aa35879200784dc18e35edf689e6

    (cherry picked from commit 9369aab04e37b7818d49b00e65857be8b3564e9e)

Reviewed: https://review.openstack.org/222023
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=08d1153d3be9f8d59aa0acc03eedd45a1697ed7b
Submitter: Jenkins
Branch: stable/kilo
commit 08d1153d3be9f8d59aa0acc03eedd45a1697ed7b
Author: Matt Riedemann <mriedem@us.ibm.com>
Date: Wed Sep 9 20:29:09 2015 -0700
Don't expect meta attributes in object\_compat that aren't in the db obj
The object\_compat decorator expects to get the Instance object with
'metadata' and 'system\_metadata' attributes but if those aren't in the
db instance dict object, Instance.\_from\_db\_object will fail with a
KeyError.
In Kilo this happens per refresh\_instance\_security\_rules because in the
compute API code, the instance passed to refresh\_instance\_security\_rules
comes from the call to get the security group(s) which joins on the
instances column, but that doesn't join on the metadata/system\_metadata
fields for the instances. So when the instances get to object\_compat in
the compute manager and the db instance dict is converted to the
Instance object, it expects fields that aren't in the dict and we get
the KeyError.
The refresh\_instance\_security\_rules case is fixed in Liberty per commit
12fbe6f082ef9b70b89302e15daa12e851e507a7 - in that case the compute API
passes Instance objects to the compute manager so object\_compat doesn't
have anything to do, \_load\_instance just sees instance\_or\_dict isn't a
dict and ignores it.
We're making this change since (1) it's an obviously wrong assumption in
object\_compat and should be fixed and (2) we need to backport this fix
to stable/kilo since it's an upgrade impact for users there.
Closes-Bug: #1484738
Change-Id: I36a954c095a9aa35879200784dc18e35edf689e6
(cherry picked from commit 9369aab04e37b7818d49b00e65857be8b3564e9e)

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-09-24

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → liberty-rc1 |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-25: |  |  | [#21](/nova/%2Bbug/1484738/comments/21) |
| --- | --- | --- | --- |

OSSA [bug 1491307](/bugs/1491307) is fixed by the same fix for this bug.

OSSA bug 1491307 is fixed by the same fix for this bug.

| **tags**: | added: security-groups |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-10-15

| Changed in nova: | |
| --- | --- |
| **milestone**: | liberty-rc1 → 12.0.0 |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1484738/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1484738/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1484738/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1484738/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from translations.launchpad.net_13b83fdf_20250126_012946.html ===

[Log in / Register](https://translations.launchpad.net/nova/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* Translations
* [Answers](https://answers.launchpad.net/nova)

# Translation overview

[Help for translations](https://help.launchpad.net/Translations)

### Translation details

Launchpad currently recommends translating
[OpenStack Compute (nova) trunk series](/nova/trunk).

To see all the translation files that are waiting to be
imported, please look at
[OpenStack Compute (nova) import queue](/nova/%2Bimports).

### Permissions

[OpenStack Compute (nova)](https://launchpad.net/nova) is translated
with [Open](/%2Bhelp-translations/permissions-policies.html)
permissions.

### All translatable series

* [OpenStack Compute (nova) trunk series](/nova/trunk/%2Btranslations)
* [OpenStack Compute (nova) bexar series](/nova/bexar/%2Btranslations)
* [OpenStack Compute (nova) cactus series](/nova/cactus/%2Btranslations)

### All translatable distribution packages

* [nova source package in Plucky](/ubuntu/plucky/%2Bsources/nova/%2Btranslations)
* [nova source package in Oracular](/ubuntu/oracular/%2Bsources/nova/%2Btranslations)
* [nova source package in Noble](/ubuntu/noble/%2Bsources/nova/%2Btranslations)
* [nova source package in Mantic](/ubuntu/mantic/%2Bsources/nova/%2Btranslations)
* [nova source package in Lunar](/ubuntu/lunar/%2Bsources/nova/%2Btranslations)
* [nova source package in Kinetic](/ubuntu/kinetic/%2Bsources/nova/%2Btranslations)
* [nova source package in Jammy](/ubuntu/jammy/%2Bsources/nova/%2Btranslations)
* [nova source package in Impish](/ubuntu/impish/%2Bsources/nova/%2Btranslations)
* [nova source package in Hirsute](/ubuntu/hirsute/%2Bsources/nova/%2Btranslations)
* [nova source package in Groovy](/ubuntu/groovy/%2Bsources/nova/%2Btranslations)
* [nova source package in Focal](/ubuntu/focal/%2Bsources/nova/%2Btranslations)
* [nova source package in Eoan](/ubuntu/eoan/%2Bsources/nova/%2Btranslations)
* [nova source package in Disco](/ubuntu/disco/%2Bsources/nova/%2Btranslations)
* [nova source package in Cosmic](/ubuntu/cosmic/%2Bsources/nova/%2Btranslations)
* [nova source package in Bionic](/ubuntu/bionic/%2Bsources/nova/%2Btranslations)
* [nova source package in Artful](/ubuntu/artful/%2Bsources/nova/%2Btranslations)
* [nova source package in Zesty](/ubuntu/zesty/%2Bsources/nova/%2Btranslations)
* [nova source package in Yakkety](/ubuntu/yakkety/%2Bsources/nova/%2Btranslations)
* [nova source package in Xenial](/ubuntu/xenial/%2Bsources/nova/%2Btranslations)
* [nova source package in Wily](/ubuntu/wily/%2Bsources/nova/%2Btranslations)
* [nova source package in Vivid](/ubuntu/vivid/%2Bsources/nova/%2Btranslations)
* [nova source package in Utopic](/ubuntu/utopic/%2Bsources/nova/%2Btranslations)
* [nova source package in Trusty](/ubuntu/trusty/%2Bsources/nova/%2Btranslations)
* [nova source package in Saucy](/ubuntu/saucy/%2Bsources/nova/%2Btranslations)
* [nova source package in Raring](/ubuntu/raring/%2Bsources/nova/%2Btranslations)
* [nova source package in Quantal](/ubuntu/quantal/%2Bsources/nova/%2Btranslations)
* [nova source package in Precise](/ubuntu/precise/%2Bsources/nova/%2Btranslations)

## Translation for trunk

| Language | Status | Untranslated | Needs review | Last Changed |
| --- | --- | --- | --- | --- |
| [Afrikaans](/nova/trunk/%2Bpots/nova/af/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/af/%2Btranslate?show=untranslated) | 254 [254](/nova/trunk/%2Bpots/nova/af/%2Btranslate?show=new_suggestions) | 2022-09-12 03:14:23 UTC 2022-09-12 |
| [Albanian](/nova/trunk/%2Bpots/nova/sq/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/sq/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:19 UTC 2014-04-02 |
| [Arabic](/nova/trunk/%2Bpots/nova/ar/%2Btranslate) | 13 099.14  0.8563899868247694% translated  99.14361001317523% untranslated | 1505 [1505](/nova/trunk/%2Bpots/nova/ar/%2Btranslate?show=untranslated) | 0 0 | 2013-02-16 21:33:39 UTC 2013-02-16 |
| [Asturian](/nova/trunk/%2Bpots/nova/ast/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/ast/%2Btranslate?show=untranslated) | 0 0 | 2011-01-12 19:50:20 UTC 2011-01-12 |
| [Azerbaijani](/nova/trunk/%2Bpots/nova/az/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/az/%2Btranslate?show=untranslated) | 5 [5](/nova/trunk/%2Bpots/nova/az/%2Btranslate?show=new_suggestions) | 2013-04-03 14:46:02 UTC 2013-04-03 |
| [Basque](/nova/trunk/%2Bpots/nova/eu/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/eu/%2Btranslate?show=untranslated) | 0 0 | 2013-12-05 23:09:27 UTC 2013-12-05 |
| [Belarusian](/nova/trunk/%2Bpots/nova/be/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/be/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/be/%2Btranslate?show=new_suggestions) | 2020-05-03 16:45:18 UTC 2020-05-03 |
| [Bosnian](/nova/trunk/%2Bpots/nova/bs/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/bs/%2Btranslate?show=untranslated) | 914 [914](/nova/trunk/%2Bpots/nova/bs/%2Btranslate?show=new_suggestions) | 2012-01-19 20:22:10 UTC 2012-01-19 |
| [Brazilian Portuguese](/nova/trunk/%2Bpots/nova/pt_BR/%2Btranslate) | 815 046.31  53.689064558629774% translated  46.31093544137022% untranslated | 703 [703](/nova/trunk/%2Bpots/nova/pt_BR/%2Btranslate?show=untranslated) | 84 [84](/nova/trunk/%2Bpots/nova/pt_BR/%2Btranslate?show=new_suggestions) | 2013-02-06 03:43:42 UTC 2013-02-06 |
| [Catalan](/nova/trunk/%2Bpots/nova/ca/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ca/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:32 UTC 2013-06-07 |
| [Chechen](/nova/trunk/%2Bpots/nova/ce/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ce/%2Btranslate?show=untranslated) | 0 0 | 2014-08-13 08:13:14 UTC 2014-08-13 |
| [Chinese (Hong Kong)](/nova/trunk/%2Bpots/nova/zh_HK/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/zh_HK/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:31 UTC 2013-06-07 |
| [Chinese (Simplified)](/nova/trunk/%2Bpots/nova/zh_CN/%2Btranslate) | 1518 000.00  100.0% translated | 0 0 | 106 [106](/nova/trunk/%2Bpots/nova/zh_CN/%2Btranslate?show=new_suggestions) | 2013-06-05 09:20:38 UTC 2013-06-05 |
| [Chinese (Traditional)](/nova/trunk/%2Bpots/nova/zh_TW/%2Btranslate) | 294 080.63  19.367588932806324% translated  80.63241106719367% untranslated | 1224 [1224](/nova/trunk/%2Bpots/nova/zh_TW/%2Btranslate?show=untranslated) | 30 [30](/nova/trunk/%2Bpots/nova/zh_TW/%2Btranslate?show=new_suggestions) | 2012-08-15 07:46:05 UTC 2012-08-15 |
| [Croatian](/nova/trunk/%2Bpots/nova/hr/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/hr/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:33 UTC 2013-06-07 |
| [Czech](/nova/trunk/%2Bpots/nova/cs/%2Btranslate) | 1518 000.00  100.0% translated | 0 0 | 4 [4](/nova/trunk/%2Bpots/nova/cs/%2Btranslate?show=new_suggestions) | 2013-05-12 21:44:53 UTC 2013-05-12 |
| [Danish](/nova/trunk/%2Bpots/nova/da/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/da/%2Btranslate?show=untranslated) | 2 [2](/nova/trunk/%2Bpots/nova/da/%2Btranslate?show=new_suggestions) | 2011-01-15 21:46:58 UTC 2011-01-15 |
| [English (Australia)](/nova/trunk/%2Bpots/nova/en_AU/%2Btranslate) | 350 076.94  23.056653491436098% translated  76.9433465085639% untranslated | 1168 [1168](/nova/trunk/%2Bpots/nova/en_AU/%2Btranslate?show=untranslated) | 1166 [1166](/nova/trunk/%2Bpots/nova/en_AU/%2Btranslate?show=new_suggestions) | 2012-06-17 06:35:56 UTC 2012-06-17 |
| [English (Canada)](/nova/trunk/%2Bpots/nova/en_CA/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/en_CA/%2Btranslate?show=untranslated) | 0 0 | 2013-09-10 14:44:32 UTC 2013-09-10 |
| [English (United Kingdom)](/nova/trunk/%2Bpots/nova/en_GB/%2Btranslate) | 1518 000.00  100.0% translated | 0 0 | 10 [10](/nova/trunk/%2Bpots/nova/en_GB/%2Btranslate?show=new_suggestions) | 2013-06-04 15:36:12 UTC 2013-06-04 |
| [Filipino](/nova/trunk/%2Bpots/nova/fil/%2Btranslate) | 30 098.02  1.9762845849802373% translated  98.02371541501977% untranslated | 1488 [1488](/nova/trunk/%2Bpots/nova/fil/%2Btranslate?show=untranslated) | 0 0 | 2012-07-20 05:07:53 UTC 2012-07-20 |
| [French](/nova/trunk/%2Bpots/nova/fr/%2Btranslate) | 641 057.77  42.226613965744406% translated  57.7733860342556% untranslated | 877 [877](/nova/trunk/%2Bpots/nova/fr/%2Btranslate?show=untranslated) | 139 [139](/nova/trunk/%2Bpots/nova/fr/%2Btranslate?show=new_suggestions) | 2013-03-04 16:32:33 UTC 2013-03-04 |
| [Galician](/nova/trunk/%2Bpots/nova/gl/%2Btranslate) | 97 093.61  6.389986824769434% translated  93.61001317523056% untranslated | 1421 [1421](/nova/trunk/%2Bpots/nova/gl/%2Btranslate?show=untranslated) | 5 [5](/nova/trunk/%2Bpots/nova/gl/%2Btranslate?show=new_suggestions) | 2013-07-10 23:58:13 UTC 2013-07-10 |
| [German](/nova/trunk/%2Bpots/nova/de/%2Btranslate) | 1094 027.93  72.06851119894598% translated  27.931488801054016% untranslated | 424 [424](/nova/trunk/%2Bpots/nova/de/%2Btranslate?show=untranslated) | 31 [31](/nova/trunk/%2Bpots/nova/de/%2Btranslate?show=new_suggestions) | 2013-07-10 09:57:58 UTC 2013-07-10 |
| [Greek](/nova/trunk/%2Bpots/nova/el/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/el/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:24 UTC 2014-04-02 |
| [Hebrew](/nova/trunk/%2Bpots/nova/he/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/he/%2Btranslate?show=untranslated) | 0 0 | 2014-03-07 06:39:29 UTC 2014-03-07 |
| [Hindi](/nova/trunk/%2Bpots/nova/hi/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/hi/%2Btranslate?show=untranslated) | 0 0 | 2013-09-09 20:15:29 UTC 2013-09-09 |
| [Hungarian](/nova/trunk/%2Bpots/nova/hu/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/hu/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:34 UTC 2013-06-07 |
| [Indonesian](/nova/trunk/%2Bpots/nova/id/%2Btranslate) | 1166 023.19  76.81159420289855% translated  23.18840579710145% untranslated | 352 [352](/nova/trunk/%2Bpots/nova/id/%2Btranslate?show=untranslated) | 4 [4](/nova/trunk/%2Bpots/nova/id/%2Btranslate?show=new_suggestions) | 2013-06-12 06:23:30 UTC 2013-06-12 |
| [Italian](/nova/trunk/%2Bpots/nova/it/%2Btranslate) | 399 073.72  26.284584980237153% translated  73.71541501976284% untranslated | 1119 [1119](/nova/trunk/%2Bpots/nova/it/%2Btranslate?show=untranslated) | 3 [3](/nova/trunk/%2Bpots/nova/it/%2Btranslate?show=new_suggestions) | 2013-04-12 14:24:26 UTC 2013-04-12 |
| [Japanese](/nova/trunk/%2Bpots/nova/ja/%2Btranslate) | 526 065.35  34.65085638998682% translated  65.34914361001317% untranslated | 992 [992](/nova/trunk/%2Bpots/nova/ja/%2Btranslate?show=untranslated) | 4 [4](/nova/trunk/%2Bpots/nova/ja/%2Btranslate?show=new_suggestions) | 2012-06-17 06:26:26 UTC 2012-06-17 |
| [Kabyle](/nova/trunk/%2Bpots/nova/kab/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/kab/%2Btranslate?show=untranslated) | 0 0 | 2020-09-26 09:29:19 UTC 2020-09-26 |
| [Kannada](/nova/trunk/%2Bpots/nova/kn/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/kn/%2Btranslate?show=untranslated) | 0 0 | 2013-10-03 20:33:34 UTC 2013-10-03 |
| [Khmer](/nova/trunk/%2Bpots/nova/km/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/km/%2Btranslate?show=untranslated) | 12 [12](/nova/trunk/%2Bpots/nova/km/%2Btranslate?show=new_suggestions) | 2013-12-05 23:09:30 UTC 2013-12-05 |
| [Korean](/nova/trunk/%2Bpots/nova/ko/%2Btranslate) | 133 091.24  8.761528326745719% translated  91.23847167325428% untranslated | 1385 [1385](/nova/trunk/%2Bpots/nova/ko/%2Btranslate?show=untranslated) | 0 0 | 2012-08-18 04:14:44 UTC 2012-08-18 |
| [Latgalian](/nova/trunk/%2Bpots/nova/ltg/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ltg/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/ltg/%2Btranslate?show=new_suggestions) | 2013-12-03 08:45:58 UTC 2013-12-03 |
| [Latvian](/nova/trunk/%2Bpots/nova/lv/%2Btranslate) | 5 099.67  0.32938076416337286% translated  99.67061923583663% untranslated | 1513 [1513](/nova/trunk/%2Bpots/nova/lv/%2Btranslate?show=untranslated) | 0 0 | 2013-03-07 16:14:28 UTC 2013-03-07 |
| [Malay](/nova/trunk/%2Bpots/nova/ms/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ms/%2Btranslate?show=untranslated) | 406 [406](/nova/trunk/%2Bpots/nova/ms/%2Btranslate?show=new_suggestions) | 2012-06-13 09:15:03 UTC 2012-06-13 |
| [Mari (Meadow)](/nova/trunk/%2Bpots/nova/mhr/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/mhr/%2Btranslate?show=untranslated) | 3 [3](/nova/trunk/%2Bpots/nova/mhr/%2Btranslate?show=new_suggestions) | 2013-11-05 08:44:17 UTC 2013-11-05 |
| [Nepali](/nova/trunk/%2Bpots/nova/ne/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ne/%2Btranslate?show=untranslated) | 0 0 | 2013-10-03 20:33:29 UTC 2013-10-03 |
| [Norwegian Bokmal](/nova/trunk/%2Bpots/nova/nb/%2Btranslate) | 74 095.13  4.874835309617918% translated  95.12516469038208% untranslated | 1444 [1444](/nova/trunk/%2Bpots/nova/nb/%2Btranslate?show=untranslated) | 0 0 | 2012-03-13 11:36:56 UTC 2012-03-13 |
| [Occitan (post 1500)](/nova/trunk/%2Bpots/nova/oc/%2Btranslate) | 16 098.95  1.0540184453227932% translated  98.9459815546772% untranslated | 1502 [1502](/nova/trunk/%2Bpots/nova/oc/%2Btranslate?show=untranslated) | 394 [394](/nova/trunk/%2Bpots/nova/oc/%2Btranslate?show=new_suggestions) | 2011-11-17 07:23:06 UTC 2011-11-17 |
| [Persian](/nova/trunk/%2Bpots/nova/fa/%2Btranslate) | 14 099.08  0.922266139657444% translated  99.07773386034255% untranslated | 1504 [1504](/nova/trunk/%2Bpots/nova/fa/%2Btranslate?show=untranslated) | 0 0 | 2012-09-18 11:44:07 UTC 2012-09-18 |
| [Polish](/nova/trunk/%2Bpots/nova/pl/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/pl/%2Btranslate?show=untranslated) | 0 0 | 2012-09-04 20:24:42 UTC 2012-09-04 |
| [Portuguese](/nova/trunk/%2Bpots/nova/pt/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/pt/%2Btranslate?show=untranslated) | 8 [8](/nova/trunk/%2Bpots/nova/pt/%2Btranslate?show=new_suggestions) | 2013-06-07 09:16:30 UTC 2013-06-07 |
| [Romanian](/nova/trunk/%2Bpots/nova/ro/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/ro/%2Btranslate?show=untranslated) | 4 [4](/nova/trunk/%2Bpots/nova/ro/%2Btranslate?show=new_suggestions) | 2013-03-03 09:38:48 UTC 2013-03-03 |
| [Russian](/nova/trunk/%2Bpots/nova/ru/%2Btranslate) | 1307 013.90  86.10013175230566% translated  13.899868247694336% untranslated | 211 [211](/nova/trunk/%2Bpots/nova/ru/%2Btranslate?show=untranslated) | 15 [15](/nova/trunk/%2Bpots/nova/ru/%2Btranslate?show=new_suggestions) | 2013-05-21 06:50:11 UTC 2013-05-21 |
| [Serbian](/nova/trunk/%2Bpots/nova/sr/%2Btranslate) | 1 099.93  0.06587615283267458% translated  99.93412384716733% untranslated | 1517 [1517](/nova/trunk/%2Bpots/nova/sr/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:24 UTC 2014-04-02 |
| [Slovak](/nova/trunk/%2Bpots/nova/sk/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/sk/%2Btranslate?show=untranslated) | 6 [6](/nova/trunk/%2Bpots/nova/sk/%2Btranslate?show=new_suggestions) | 2013-09-09 20:15:25 UTC 2013-09-09 |
| [Spanish](/nova/trunk/%2Bpots/nova/es/%2Btranslate) | 1517 000.07  99.93412384716733% translated  0.06587615283267458% untranslated | 1 [1](/nova/trunk/%2Bpots/nova/es/%2Btranslate?show=untranslated) | 80 [80](/nova/trunk/%2Bpots/nova/es/%2Btranslate?show=new_suggestions) | 2013-07-09 23:15:49 UTC 2013-07-09 |
| [Swedish](/nova/trunk/%2Bpots/nova/sv/%2Btranslate) | 20 098.68  1.3175230566534915% translated  98.68247694334651% untranslated | 1498 [1498](/nova/trunk/%2Bpots/nova/sv/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/sv/%2Btranslate?show=new_suggestions) | 2013-01-15 20:08:01 UTC 2013-01-15 |
| [Tagalog](/nova/trunk/%2Bpots/nova/tl/%2Btranslate) | 6 099.60  0.3952569169960474% translated  99.60474308300395% untranslated | 1512 [1512](/nova/trunk/%2Bpots/nova/tl/%2Btranslate?show=untranslated) | 0 0 | 2011-08-23 11:21:43 UTC 2011-08-23 |
| [Tajik](/nova/trunk/%2Bpots/nova/tg/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/tg/%2Btranslate?show=untranslated) | 0 0 | 2020-07-23 06:12:18 UTC 2020-07-23 |
| [Tamil](/nova/trunk/%2Bpots/nova/ta/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ta/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:25 UTC 2014-04-02 |
| [Thai](/nova/trunk/%2Bpots/nova/th/%2Btranslate) | 5 099.67  0.32938076416337286% translated  99.67061923583663% untranslated | 1513 [1513](/nova/trunk/%2Bpots/nova/th/%2Btranslate?show=untranslated) | 0 0 | 2012-05-27 00:06:52 UTC 2012-05-27 |
| [Tibetan](/nova/trunk/%2Bpots/nova/bo/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/bo/%2Btranslate?show=untranslated) | 0 0 | 2019-12-12 01:59:05 UTC 2019-12-12 |
| [Turkish](/nova/trunk/%2Bpots/nova/tr/%2Btranslate) | 28 098.16  1.844532279314888% translated  98.15546772068511% untranslated | 1490 [1490](/nova/trunk/%2Bpots/nova/tr/%2Btranslate?show=untranslated) | 43 [43](/nova/trunk/%2Bpots/nova/tr/%2Btranslate?show=new_suggestions) | 2013-03-14 06:55:20 UTC 2013-03-14 |
| [Ukrainian](/nova/trunk/%2Bpots/nova/uk/%2Btranslate) | 19 098.75  1.251646903820817% translated  98.74835309617919% untranslated | 1499 [1499](/nova/trunk/%2Bpots/nova/uk/%2Btranslate?show=untranslated) | 391 [391](/nova/trunk/%2Bpots/nova/uk/%2Btranslate?show=new_suggestions) | 2011-08-23 11:21:35 UTC 2011-08-23 |
| [Urdu](/nova/trunk/%2Bpots/nova/ur/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ur/%2Btranslate?show=untranslated) | 0 0 | 2013-12-05 23:09:34 UTC 2013-12-05 |
| [Uyghur](/nova/trunk/%2Bpots/nova/ug/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ug/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/ug/%2Btranslate?show=new_suggestions) | 2012-03-18 09:35:05 UTC 2012-03-18 |

[ [Change your preferred languages...](/%2Beditmylanguages)
—
View all languages
]

![Key to this table: “Unchanged” means](/@@/green-bar)
Translated

![and “untranslated” means just that,](/@@/red-bar)
Untranslated

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_41b0dc9b_20250126_012936.html ===




=== Content from launchpad.net_10be72f1_20250126_012943.html ===

[Log in / Register](https://launchpad.net/~244914362-q/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~244914362-q)

## [suntao](https://launchpad.net/~244914362-q)

* Overview
* [Code](https://code.launchpad.net/~244914362-q)
* [Bugs](https://bugs.launchpad.net/~244914362-q)
* [Blueprints](https://blueprints.launchpad.net/~244914362-q)
* [Translations](https://translations.launchpad.net/~244914362-q)
* [Answers](https://answers.launchpad.net/~244914362-q)

* [Related packages](https://launchpad.net/~244914362-q/%2Brelated-packages)
* [Related projects](https://launchpad.net/~244914362-q/%2Brelated-projects)

## User information

Launchpad Id:
244914362-q

Email:
[Log in](%2Blogin) for email information.

Member since:
2015-09-02

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~244914362-q/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## Latest memberships

suntao is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_985afa93_20250126_012938.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1275937)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1275937)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1275937)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1275937

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1275937**](show_bug.cgi?id=1275937)
- nova searches for wrong device unexpectedly when multipath device has faulty lun

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
nova searches for wrong device unexpectedly when multipath device has faulty lun

| | [Keywords](describekeywords.cgi): | Triaged  ZStream | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Red Hat OpenStack | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Red Hat | | [Component:](describecomponents.cgi?product=Red Hat OpenStack "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | openstack-nova | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 6.0 (Juno) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | z3 | | [Target Release](page.cgi?id=fields.html#target_release): | 7.0 (Kilo) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Lee Yarwood | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Prasanth Anbalagan | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | Duplicates (2): | [1275935](show_bug.cgi?id=1275935 "CLOSED DUPLICATE - nova searches for wrong device unexpectedly when multipath device has faulty lun") [1275936](show_bug.cgi?id=1275936 "CLOSED DUPLICATE - nova searches for wrong device unexpectedly when multipath device has faulty lun")  ([view as bug list](buglist.cgi?bug_id=1275936,1275935)) | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1278209](show_bug.cgi?id=1278209 "CLOSED DUPLICATE - Multipath ISCSI connections left open after disconnecting volume with libvirt") [1280359](show_bug.cgi?id=1280359 "CLOSED ERRATA - nova searches for wrong device unexpectedly when multipath device has faulty lun") [1281762](show_bug.cgi?id=1281762 "CLOSED CURRENTRELEASE - nova searches for wrong device unexpectedly when multipath device has faulty lun") | | TreeView+ | [depends on](buglist.cgi?bug_id=1275937&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1275937&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-10-28 07:03 UTC by Chen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-02-22 23:02 UTC ([History](show_activity.cgi?id=1275937)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  berrange cchen dasmith eglynn kchamart lyarwood ndipanov panbalag pbrady rbiba sbauza sferdjao sgordon vromanso yeylon | | Fixed In Version: | openstack-nova-2015.1.2-6.el7ost | | | Doc Type: | Bug Fix | | | Doc Text: | Previously, Nova failed to parse the output from the "multipath -l ${device}" command when errors were present. Consequently, the attaching and detaching of volumes could fail. This update corrects the find\_multipath\_device method to ensure that any errors present in the output from the aforementioned command are ignored. As a result, both the attaching and detaching of volumes will now succeed even if errors occur. | | | Clone Of: |  | | | Clones: | [1280359](show_bug.cgi?id=1280359 "CLOSED ERRATA - nova searches for wrong device unexpectedly when multipath device has faulty lun") [1281762](show_bug.cgi?id=1281762 "CLOSED CURRENTRELEASE - nova searches for wrong device unexpectedly when multipath device has faulty lun")  ([view as bug list](buglist.cgi?bug_id=1281762,1280359)) | | | Environment: |  | | | Last Closed: | 2015-12-21 17:08:02 UTC | | | Target Upstream Version: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**nova-compute.log**](attachment.cgi?id=1087152 "View the content of the attachment") (424.25 KB, application/zip)  [2015-10-28 07:05 UTC](#attach_1087152 "Go to the comment associated with the attachment"), Chen | *no flags* | [Details](attachment.cgi?id=1087152&action=edit) | | [View All](attachment.cgi?bugid=1275937&action=viewall) | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Issue Tracker | [OSP-16691](https://issues.redhat.com/browse/OSP-16691) | 0 | None | None | None | 2022-07-09 08:00:43 UTC | | Red Hat Product Errata | [RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-nova security and bug fix advisory | 2015-12-21 21:51:35 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1275937#c0)  Chen    2015-10-28 07:03:56 UTC  ``` Description of problem:  nova searches for wrong device unexpectedly when multipath device has faulty lun  The error message is something following:  TRACE nova.compute.manager [instance: d9db6ec9-0758-4565-acd8-e06bd6a29c3a] libvirtError: Cannot access storage file '/dev/mapper/Oct' (as uid:107, gid:107): No such file or directory  As the above we can see that nova-compute is looking for a device called /dev/mapper/Oct.  Version-Release number of selected component (if applicable):  OSP 6.0 on RHEL 7  How reproducible:    Steps to Reproduce: ( according to the customer ) 1. Make one lun faulty in multipath device 2. Start a nova instance 3. Check the nova-compute.log  Actual results:  A wrong device ( /dev/mapper/Oct ) is used  Expected results:  The instance should boot normally.  Additional info:   ```  [Comment 2](show_bug.cgi?id=1275937#c2)  Chen    2015-10-28 07:05:23 UTC  ``` Created [attachment 1087152](attachment.cgi?id=1087152 "nova-compute.log") [[details]](attachment.cgi?id=1087152&action=edit "nova-compute.log") nova-compute.log   ```  [Comment 3](show_bug.cgi?id=1275937#c3)  Lee Yarwood    2015-10-29 14:18:00 UTC  ``` Thanks for the report Chen.Can you confirm what the output of `multipath -l ${device}` is with these faulty LUNs? I think we need to port the following change from cinder prior to the os-brick split :  Multipath commands with error messages in stdout fail to parse <https://review.openstack.org/#/c/128755/>  I did try to get this into nova sometime ago but with the move to os-brick this was rejected :  Multipath commands with error messages in stdout fail to parse <https://review.openstack.org/#/c/172660/>   ```  [Comment 4](show_bug.cgi?id=1275937#c4)  Lee Yarwood    2015-10-30 16:47:21 UTC  ``` *** [Bug 1275936](show_bug.cgi?id=1275936 "CLOSED DUPLICATE - nova searches for wrong device unexpectedly when multipath device has faulty lun") has been marked as a duplicate of this bug. ***   ```  [Comment 5](show_bug.cgi?id=1275937#c5)  Lee Yarwood    2015-10-30 16:47:24 UTC  ``` *** [Bug 1275935](show_bug.cgi?id=1275935 "CLOSED DUPLICATE - nova searches for wrong device unexpectedly when multipath device has faulty lun") has been marked as a duplicate of this bug. ***   ```  [Comment 14](show_bug.cgi?id=1275937#c14)  Prasanth Anbalagan    2015-12-09 20:13:14 UTC  ``` Verified as follows - attach/detach volume to instance works even when there is error seen in multipath -ll output.  ************ Version ************  [root@seal17 ~(keystone_admin)]# yum list installed | grep  nova openstack-nova-api.noarch            2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-cert.noarch           2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-common.noarch         2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-compute.noarch        2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-conductor.noarch      2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-console.noarch        2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-novncproxy.noarch     2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-scheduler.noarch      2015.1.2-7.el7ost       @rhelosp-7.0-puddle  ************* Logs *************  [root@seal17 etc]# multipath -ll Dec 09 22:03:26 | missing value for option 'break-multipath' on line 1 of /etc/multipath.conf 36001405efa90fa3e42047ba886c7656e dm-1 LIO-ORG ,IBLOCK           size=1.0G features='0' hwhandler='0' wp=rw `-+- policy='service-time 0' prio=1 status=active   `- 10:0:0:0 sdb 8:16 active ready  running [root@seal17 etc]# nova list [root@seal17 ~(keystone_admin)]# nova list +--------------------------------------+------+--------+------------+-------------+------------------+ | ID                                   | Name | Status | Task State | Power State | Networks         | +--------------------------------------+------+--------+------------+-------------+------------------+ | 6e56ec06-3287-4d02-90db-69905ecda71f | vm1  | ACTIVE | -          | Running     | private=10.0.0.4 | +--------------------------------------+------+--------+------------+-------------+------------------+ [root@seal17 ~(keystone_admin)]# cinder list +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ |                  ID                  |   Status  |   Display Name   | Size | Volume Type | Bootable |             Attached to              | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ | 001efa06-fbda-4c7f-bdfd-999b5b533923 | available | encrypted volume |  1   |     LUKS    |  false   |                                      | | 156fdd02-00ca-427e-a7be-4ca245f352d5 |   in-use  |       vol1       |  1   |      -      |  false   | 6e56ec06-3287-4d02-90db-69905ecda71f | | 2dde0a96-8d53-4a9f-8ffa-8ae04da9b1a0 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | 899809dd-5415-4f17-9fba-d0cc2846d838 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | e4a9778e-ccac-49c1-8bc2-095f4f99af0f | available |     nfsvol1      |  1   |      -      |  false   |                                      | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ [root@seal17 ~(keystone_admin)]# nova volume-attach vm1 e4a9778e-ccac-49c1-8bc2-095f4f99af0f +----------+--------------------------------------+ | Property | Value                                | +----------+--------------------------------------+ | device   | /dev/vdc                             | | id       | e4a9778e-ccac-49c1-8bc2-095f4f99af0f | | serverId | 6e56ec06-3287-4d02-90db-69905ecda71f | | volumeId | e4a9778e-ccac-49c1-8bc2-095f4f99af0f | +----------+--------------------------------------+ [root@seal17 ~(keystone_admin)]#  [root@seal17 ~(keystone_admin)]#  [root@seal17 ~(keystone_admin)]# cinder list +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ |                  ID                  |   Status  |   Display Name   | Size | Volume Type | Bootable |             Attached to              | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ | 001efa06-fbda-4c7f-bdfd-999b5b533923 | available | encrypted volume |  1   |     LUKS    |  false   |                                      | | 156fdd02-00ca-427e-a7be-4ca245f352d5 |   in-use  |       vol1       |  1   |      -      |  false   | 6e56ec06-3287-4d02-90db-69905ecda71f | | 2dde0a96-8d53-4a9f-8ffa-8ae04da9b1a0 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | 899809dd-5415-4f17-9fba-d0cc2846d838 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | e4a9778e-ccac-49c1-8bc2-095f4f99af0f |   in-use  |     nfsvol1      |  1   |      -      |  false   | 6e56ec06-3287-4d02-90db-69905ecda71f | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ [root@seal17 ~(keystone_admin)]#   ```  [Comment 16](show_bug.cgi?id=1275937#c16)  errata-xmlrpc    2015-12-21 17:08:02 UTC  ``` Since the problem described in this bug report should be resolved in a recent advisory, it has been closed with a resolution of ERRATA.  For information on the advisory, and where to find the updated files, follow the link below.  If the solution does not work for you, open a new bug report.  [https://access.redhat.com/errata/RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1275937&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_6d5dd4f9_20250126_012942.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1269119)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1269119)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1269119)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1269119

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1269119**](show_bug.cgi?id=1269119)
(CVE-2015-7713)
- [CVE-2015-7713](https://access.redhat.com/security/cve/CVE-2015-7713) openstack-nova: network security group changes are not applied to running instances

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-7713 openstack-nova: network security group changes are not applied ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-7713 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1269122](show_bug.cgi?id=1269122) [1269123](show_bug.cgi?id=1269123 "CLOSED EOL - CVE-2015-7713 openstack-nova: network security group changes are not applied to running instances [fedora-all]") [1272863](show_bug.cgi?id=1272863) [1272864](show_bug.cgi?id=1272864) [1272865](show_bug.cgi?id=1272865) [1272866](show_bug.cgi?id=1272866) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1269121](show_bug.cgi?id=1269121) | | TreeView+ | [depends on](buglist.cgi?bug_id=1269119&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1269119&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-10-06 11:47 UTC by Martin Prpič | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 04:52 UTC ([History](show_activity.cgi?id=1269119)) | | [CC List:](page.cgi?id=fields.html#cclist) | 56 users (show)  abaron akscram alexander.sakhnov aortega apevec apevec ayoung berrange bfilippov bleanhar ccoleman chrisw dallan dasmith davidx dmcphers eglynn gkotton gmollett itamar jdetiber jialiu jjoyce jkeck jokerman jonathansteffan jose.castro.leon jrusnack jschluet kbasil kchamart kseifried lhh lmeyer lpeer markmc mburns mlvov mmagr mmccomas ndipanov nova-maint p rbryant rk sbauza sclewis sferdjao sgordon slinaber slong tdecacqu vladanovic vromanso weli yeylon | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: | A vulnerability was discovered in the way OpenStack Compute (nova) networking handled security group updates; changes were not applied to already running VM instances. A remote attacker could use this flaw to access running VM instances. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-01-11 00:30:53 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-nova security and bug fix advisory | 2015-12-21 21:51:35 UTC | | Red Hat Product Errata | [RHSA-2015:2684](https://access.redhat.com/errata/RHSA-2015%3A2684) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-nova secuity and bug fix advisory | 2015-12-21 23:43:27 UTC | | Red Hat Product Errata | [RHSA-2016:0013](https://access.redhat.com/errata/RHSA-2016%3A0013) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-nova security and bug fix advisory | 2016-01-08 01:47:38 UTC | | Red Hat Product Errata | [RHSA-2016:0017](https://access.redhat.com/errata/RHSA-2016%3A0017) | 0 | normal | SHIPPED\_LIVE | Important: openstack-nova security advisory | 2016-01-11 04:20:21 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1269119#c0)  Martin Prpič    2015-10-06 11:47:48 UTC  ``` Title: Nova network security group changes are not applied to running instances  Reporter: Sreekumar S and Suntao Products: Nova Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1  Description:  Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group. All Nova network setups are affected.  References:  <https://launchpad.net/bugs/1491307> <https://launchpad.net/bugs/1484738> <http://seclists.org/oss-sec/2015/q4/41>   ```  [Comment 1](show_bug.cgi?id=1269119#c1)  Martin Prpič    2015-10-06 11:50:21 UTC  ```  Created openstack-nova tracking bugs for this issue:  Affects: openstack-rdo [[bug 1269122](show_bug.cgi?id=1269122)] Affects: fedora-all [[bug 1269123](show_bug.cgi?id=1269123 "CLOSED EOL - CVE-2015-7713 openstack-nova: network security group changes are not applied to running instances [fedora-all]")]   ```  [Comment 3](show_bug.cgi?id=1269119#c3)  Adam Mariš    2015-10-08 08:23:25 UTC  ``` Upstream patches:  <https://review.openstack.org/222026> (Juno) <https://review.openstack.org/222023> (Kilo) <https://review.openstack.org/222022> (Liberty)   ```  [Comment 7](show_bug.cgi?id=1269119#c7)  errata-xmlrpc    2015-12-21 17:06:28 UTC  ``` This issue has been addressed in the following products:    OpenStack 7 For RHEL 7  Via RHSA-2015:2673 [https://access.redhat.com/errata/RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673)   ```  [Comment 8](show_bug.cgi?id=1269119#c8)  errata-xmlrpc    2015-12-21 18:45:13 UTC  ``` This issue has been addressed in the following products:    OpenStack 5 for RHEL 7  Via RHSA-2015:2684 <https://rhn.redhat.com/errata/RHSA-2015-2684.html>   ```  [Comment 9](show_bug.cgi?id=1269119#c9)  errata-xmlrpc    2016-01-07 20:49:01 UTC  ``` This issue has been addressed in the following products:    OpenStack 6 for RHEL 7  Via RHSA-2016:0013 <https://rhn.redhat.com/errata/RHSA-2016-0013.html>   ```  [Comment 10](show_bug.cgi?id=1269119#c10)  errata-xmlrpc    2016-01-10 23:20:39 UTC  ``` This issue has been addressed in the following products:    OpenStack 5 for RHEL 6  Via RHSA-2016:0017 <https://rhn.redhat.com/errata/RHSA-2016-0017.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1269119&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from answers.launchpad.net_c6f997e5_20250126_012947.html ===

[Log in / Register](https://answers.launchpad.net/nova/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* Answers

# Questions for OpenStack Compute (nova)

**Launchpad does not know where
OpenStack Compute (nova)
tracks support requests.**

OpenStack Compute (nova) questions are
tracked in:
[nova in Ubuntu](/ubuntu/%2Bsource/nova),
[python-openstack-compute in Ubuntu](/ubuntu/%2Bsource/python-openstack-compute).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_9e50c715_20250126_012946.html ===

[Log in / Register](https://launchpad.net/~tristan-cacqueray/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~tristan-cacqueray)

## [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray)

* Overview
* [Code](https://code.launchpad.net/~tristan-cacqueray)
* [Bugs](https://bugs.launchpad.net/~tristan-cacqueray)
* [Blueprints](https://blueprints.launchpad.net/~tristan-cacqueray)
* [Translations](https://translations.launchpad.net/~tristan-cacqueray)
* [Answers](https://answers.launchpad.net/~tristan-cacqueray)

* [Related packages](https://launchpad.net/~tristan-cacqueray/%2Brelated-packages)
* [Related projects](https://launchpad.net/~tristan-cacqueray/%2Brelated-projects)

## User information

Launchpad Id:
tristan-cacqueray

Email:
[Log in](%2Blogin) for email information.

Member since:
2013-10-25

[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

EB103DE8B5E69E631C6FF17922B9A05C925CC5D8

SSH keys:

[localadmin@controller](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~tristan-cacqueray/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**tristanC**
 on
**irc.freenode.net**

## [All memberships](https://launchpad.net/~tristan-cacqueray/%2Bparticipation) Latest memberships

| [Swiftsync dev](/~swiftsync-devteam)  Joined on 2014-02-13 | |
| --- | --- |
| [OpenStack Security SIG](/~openstack-ossg)  Joined on 2013-12-12 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from rhn.redhat.com_da910cff_20250124_141343.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2015:2684 - Security Advisory

Issued:
2015-12-21
Updated:
2015-12-21
# RHSA-2015:2684 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Moderate: openstack-nova secuity and bug fix advisory

## Type/Severity

Security Advisory: Moderate

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2015%3A2684)

## Topic

Updated OpenStack Compute packages that resolve one security issue
and a bug are now available for Red Hat Enterprise Linux OpenStack
Platform 5.0 for RHEL 7.

Red Hat Product Security has rated this update as having Moderate
security impact. A Common Vulnerability Scoring System (CVSS) base
score, which gives a detailed severity rating, is available from the
CVE link in the References section.

## Description

OpenStack Compute (nova) launches and schedules large networks of
virtual machines, creating a redundant and scalable cloud computing
platform. Compute provides the software, control panels, and APIs
required to orchestrate a cloud, including running virtual machine
instances and controlling access through users and projects.

A vulnerability was discovered in the way OpenStack Compute (nova)
networking handled security group updates; changes were not applied to
already running VM instances. A remote attacker could use this flaw to
access running VM instances. (CVE-2015-7713)

Additional bug fixes include:

* In some cases, Compute did not start instances when RHEL was

installed with a locale other than en\_US. The update ensures that
logging an exception no longer causes Unicode issues. (BZ#1190837)

All openstack-nova users are advised to upgrade to these updated
packages, which correct these issues and add these enhancements.

## Solution

Before applying this update, ensure all previously released errata
relevant to your system have been applied.

Red Hat Enterprise Linux OpenStack Platform 5 runs on Red Hat
Enterprise Linux 7.2.

The Red Hat Enterprise Linux OpenStack Platform 5 Release Notes
contain the following:

* An explanation of the way in which the provided components

interact to form a working cloud computing environment.

* Technology Previews, Recommended Practices, and Known Issues.
* The channels required for Red Hat Enterprise Linux OpenStack

Platform 5, including which channels need to be enabled and
 disabled.

The Release Notes are available at:
<https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/5/html/Release_Notes/index.html>

This update is available through the Red Hat Network. Details on how to use
the Red Hat Network to apply this update are available at
<https://access.redhat.com/site/articles/11258>

## Affected Products

* Red Hat OpenStack 5.0 for RHEL 7 x86\_64

## Fixes

* [BZ - 1190837](https://bugzilla.redhat.com/show_bug.cgi?id=1190837)
  - Nova may not start instances when OS is installed with locale not en\_US
* [BZ - 1269119](https://bugzilla.redhat.com/show_bug.cgi?id=1269119)
  - CVE-2015-7713 openstack-nova: network security group changes are not applied to running instances

## CVEs

* [CVE-2015-7713](https://www.redhat.com/security/data/cve/CVE-2015-7713.html)

## References

* <http://www.redhat.com/security/updates/classification/#normal>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 5.0 for RHEL 7

| SRPM | |
| --- | --- |
| openstack-nova-2014.1.5-9.el7ost.src.rpm | SHA-256: 59b82ffd4d4015ea7f53c09d439a7184188dcbb560af968eabddae766cc6a625 |
| x86\_64 | |
| openstack-nova-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 16d4ad31ffd3fe3fe631dd4f721e36d5e11293807e329a898aaf52d9711b9bfd |
| openstack-nova-api-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 945d6494ea1c0fd9a9188343a32df7b7ed1dcb22a9382bfd5e55317ef4d05f00 |
| openstack-nova-cells-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 8130cbcd4b342c9d898d2e240b868d45f4fe06f40cd3726351c63668fd20e8ef |
| openstack-nova-cert-2014.1.5-9.el7ost.noarch.rpm | SHA-256: e61c360097510656f15eb664a21a6236bb05f0d90e06adddcee9b1f7ff86c90b |
| openstack-nova-common-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 978c21e7e7074618b6384917a030b5f4b300013b32f73614da8615722082367c |
| openstack-nova-compute-2014.1.5-9.el7ost.noarch.rpm | SHA-256: ed3e34834f2b5676d13e534cfdc4a5540de85075a0ad387fb58c18b31d0ff4a3 |
| openstack-nova-conductor-2014.1.5-9.el7ost.noarch.rpm | SHA-256: f153621e7cae90b4e8bf9284e5b0ad794725b6bc033ed0413897bc2c08c7130f |
| openstack-nova-console-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 4042c77528f22f942518a8820dbfff89a76972a4320d46948eec698deb28647c |
| openstack-nova-doc-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 0e48d273e509682da43b61aa0bb739c0096304f26368b3fe130ad81fdb016266 |
| openstack-nova-network-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 2ed54295863195039c2200ea2be99a8389dfbd3bd075bd9e62a77a21c7ce07fa |
| openstack-nova-novncproxy-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 946130262911fccfbdf6716bc56ff27dca471f29aa9eb4dff17ee7c7e8ed4242 |
| openstack-nova-objectstore-2014.1.5-9.el7ost.noarch.rpm | SHA-256: e2fe88c7d4ac0ad150f5e55ac85e090e36e8fa7f448bd0e339417bc3aa810fa7 |
| openstack-nova-scheduler-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 6e51b28a41fcb09deef671bf87c02c03c00d0c2bba299898bad8f8d0577acee7 |
| openstack-nova-serialproxy-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 99486fe63b38e2711b250fa1508176d77d2280ec3d3006803d2b082ded57ee0b |
| python-nova-2014.1.5-9.el7ost.noarch.rpm | SHA-256: 9afbe6d9d7f24701ed822b334b594d44b35e66b78d25e68de07f25c1c6ef215c |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_6c80cbb1_20250126_012943.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from access.redhat.com_9d055623_20250124_141343.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2015:2673 - Security Advisory

Issued:
2015-12-21
Updated:
2015-12-21
# RHSA-2015:2673 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Moderate: openstack-nova security and bug fix advisory

## Type/Severity

Security Advisory: Moderate

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2015%3A2673)

## Topic

Updated OpenStack Compute packages that resolve various issues are now
available for Red Hat Enterprise Linux OpenStack Platform 7.0 for
RHEL 7.

## Description

OpenStack Compute (nova) launches and schedules large networks of virtual
machines, creating a redundant and scalable cloud computing platform.
Compute provides the software, control panels, and APIs required to
orchestrate a cloud, including running virtual machine instances and
controlling access through users and projects.

A vulnerability was discovered in the way OpenStack Compute (nova)
networking handled security group updates; changes were not applied to
already running VM instances. A remote attacker could use this flaw to
access running VM instances. (CVE-2015-7713)

Additional updates include:

* The openstack-nova packages have been upgraded to upstream version

2015.1.2. See <https://launchpad.net/nova/kilo/2015.1.2> for a complete list
of bug fixes and enhancements. (BZ#1274875)

* When using huge pages, the back-end memory for a guest was configured as

private. This disallowed an external process connected to a vhostuser VIF
type to access the QEMU guest's memory, which is required by the QEMU
network driver functionality. The memory mappings are now marked as
shared, and the external process to provide QEMU network is able to access
the guest's memory. (BZ#1215790)

* The termination of a WSGI application or an RPC server immediately

stopped the service and interrupted requests that were in progress. This
update adds a graceful handler for the SIGTERM signal sent to the parent
WSGI process, so the termination is performed gracefully, which allows
ongoing processes to continue. (BZ#1250269)

* Previously, novaclient records requested time even when timing was set

to False. As a consequence, system memory kept increasing. With this
update, when timing is set to True, the time of each request is recorded
and the timings are reset to clear the memory, which no longer
increases. (BZ#1260868)

* An earlier update changed the return value when no host devices were

found when connecting to an iSCSI or iSER volume. Consequently, when no
host devices were found, an exception was thrown and the connect volume
attempt failed. This update adds an additional check to ensure
os.path.exists(None) is never called. As a result, an exception is no
longer thrown and the connect logic correctly retries finding present
host devices. (BZ#1268051)

* Compute's rootwrap filters restricted an `ln` command used by the volume

encryption providers to a specific iSCSI related target path. Consequently,
iSER, NFS, and FC volumes encountered failures because the `ln` command was
rejected by Compute's rootwrap filters. This update makes Nova's rootwrap
filters more generic when calling `ln` allowing the volume encryption
providers to succeed. (BZ#1273466)

* FCoE devices have different sysfs paths to standard FC devices.

Consequently, Nova failed when attempting to attach an FCoE based volume
to an instance as it assumed these paths were the same. This update ensures
that the required PCI information is parsed from both FC and FCoE sysfs
device paths. As a result, Nova now succeeds in attaching FCoE based
volumes to instances. (BZ#1274054)

* Nova failed to parse the output from the `multipath -l ${device}` command

when errors were present. Consequently, the attaching and detaching of
volumes could fail. This update corrects the find\_multipath\_device method
to ensure that any errors present in the output from the aforementioned
command are ignored. As a result, both the attaching and detaching of
volumes will now succeed even if errors occur. (BZ#1275937)

* Volumes were not correctly detached if an error was encountered during

the attach process, and could be left attached to an instance, resulting
in data loss. This update ensures that the volume is both detached
and the connection to the volume closed in the event of a failure during
the attach process. (BZ#1276011)

* The ability of the libvirt driver to set the admin password has been

added. To use this feature, run the following command:
 nova root-password [server]
(BZ#1261100)

## Solution

Before applying this update, ensure all previously released errata relevant
to your system have been applied.

Red Hat Enterprise Linux OpenStack Platform 7 runs on Red Hat Enterprise
Linux 7.2.

The Red Hat Enterprise Linux OpenStack Platform 7 Release Notes contain the
following:

* An explanation of the way in which the provided components interact to

form a working cloud computing environment.

* Technology Previews, Recommended Practices, and Known Issues.
* The channels required for Red Hat Enterprise Linux OpenStack Platform 7,

including which channels need to be enabled and disabled.

The Release Notes are available at:
<https://access.redhat.com/documentation/en/red-hat-enterprise-linux-openstack-platform/version-7/release-notes/>

This update is available through 'yum update' on systems registered through
Red Hat Subscription Manager. For more information about Red Hat
Subscription Manager, see:

<https://access.redhat.com/documentation/en-US/Red_Hat_Subscription_Management/1/html/RHSM/index.html>

## Affected Products

* Red Hat Enterprise Linux Server 7 x86\_64
* Red Hat Enterprise Linux Workstation 7 x86\_64
* Red Hat Enterprise Linux Desktop 7 x86\_64
* Red Hat OpenStack 7 x86\_64

## Fixes

* [BZ - 1249751](https://bugzilla.redhat.com/show_bug.cgi?id=1249751)
  - centralized logging - fluentd is blocked from accessing Nova compute logs
* [BZ - 1261100](https://bugzilla.redhat.com/show_bug.cgi?id=1261100)
  - nova: Make set\_admin\_password work with the libvirt driver (via QEMU guest agent)
* [BZ - 1268051](https://bugzilla.redhat.com/show_bug.cgi?id=1268051)
  - volume attach failed with iser
* [BZ - 1269119](https://bugzilla.redhat.com/show_bug.cgi?id=1269119)
  - CVE-2015-7713 openstack-nova: network security group changes are not applied to running instances
* [BZ - 1273466](https://bugzilla.redhat.com/show_bug.cgi?id=1273466)
  - Nova volume encryptors attach volume fails for NFS and FC (rootwrap)
* [BZ - 1274054](https://bugzilla.redhat.com/show_bug.cgi?id=1274054)
  - When using a FCoE adapter instead of a FC adapter, volumes will fail to attach to the VM
* [BZ - 1274875](https://bugzilla.redhat.com/show_bug.cgi?id=1274875)
  - Rebase openstack-nova to 2015.1.2
* [BZ - 1275937](https://bugzilla.redhat.com/show_bug.cgi?id=1275937)
  - nova searches for wrong device unexpectedly when multipath device has faulty lun

## CVEs

* [CVE-2015-7713](https://www.redhat.com/security/data/cve/CVE-2015-7713.html)

## References

* <http://www.redhat.com/security/updates/classification/#normal>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 7

| SRPM | |
| --- | --- |
| python-novaclient-2.23.0-2.el7ost.src.rpm | SHA-256: 0325167f949b7bc61110a7bb2c4fa07de8c1a58df147dbd150648b2dfbe9a17e |
| x86\_64 | |
| python-novaclient-2.23.0-2.el7ost.noarch.rpm | SHA-256: 1c2e4cadb67a09da0c7f44bfac262e6077ca95edd7c08d6807f40444a1572215 |
| python-novaclient-doc-2.23.0-2.el7ost.noarch.rpm | SHA-256: ab1821f408c08d34e2729f1df5c62ee8d30929cdb9127552b5965c846660b130 |

## Red Hat Enterprise Linux Workstation 7

| SRPM | |
| --- | --- |
| python-novaclient-2.23.0-2.el7ost.src.rpm | SHA-256: 0325167f949b7bc61110a7bb2c4fa07de8c1a58df147dbd150648b2dfbe9a17e |
| x86\_64 | |
| python-novaclient-2.23.0-2.el7ost.noarch.rpm | SHA-256: 1c2e4cadb67a09da0c7f44bfac262e6077ca95edd7c08d6807f40444a1572215 |
| python-novaclient-doc-2.23.0-2.el7ost.noarch.rpm | SHA-256: ab1821f408c08d34e2729f1df5c62ee8d30929cdb9127552b5965c846660b130 |

## Red Hat Enterprise Linux Desktop 7

| SRPM | |
| --- | --- |
| python-novaclient-2.23.0-2.el7ost.src.rpm | SHA-256: 0325167f949b7bc61110a7bb2c4fa07de8c1a58df147dbd150648b2dfbe9a17e |
| x86\_64 | |
| python-novaclient-2.23.0-2.el7ost.noarch.rpm | SHA-256: 1c2e4cadb67a09da0c7f44bfac262e6077ca95edd7c08d6807f40444a1572215 |
| python-novaclient-doc-2.23.0-2.el7ost.noarch.rpm | SHA-256: ab1821f408c08d34e2729f1df5c62ee8d30929cdb9127552b5965c846660b130 |

## Red Hat OpenStack 7

| SRPM | |
| --- | --- |
| openstack-nova-2015.1.2-7.el7ost.src.rpm | SHA-256: 340c74086714ebf22ea93fd6beac884b9d07987c0ab9f7be2c4cd4a33fadaed9 |
| python-novaclient-2.23.0-2.el7ost.src.rpm | SHA-256: 0325167f949b7bc61110a7bb2c4fa07de8c1a58df147dbd150648b2dfbe9a17e |
| x86\_64 | |
| openstack-nova-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 0be5e8128acef33f7c121a580393e8ef41665f68957b366e882f98302cb89be8 |
| openstack-nova-api-2015.1.2-7.el7ost.noarch.rpm | SHA-256: e644043355ed084cd6f527272f1e5b3e72ad3670be3fe1d6ed8862156a38e5b8 |
| openstack-nova-cells-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 09441ecad39113fd30e2e5721a0752cf0ea693957f21aadb21a05cb5e8ee6b1f |
| openstack-nova-cert-2015.1.2-7.el7ost.noarch.rpm | SHA-256: cc4a5b4993b6d8ce16da23921feb2cc76fff76ada982948c2e8f8da67ebddf48 |
| openstack-nova-common-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 997b9cba5be97f626f9d6a6230b5deee083a6d60c688586b6f6bcf73c3ca86d1 |
| openstack-nova-compute-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 9eb5feeaecf6066991e9f7c7d5c7ab66e51ff7d9796a83854e36a043a0541c9f |
| openstack-nova-conductor-2015.1.2-7.el7ost.noarch.rpm | SHA-256: ad3f1b1ceb719c7e348a913fac77694605a73303d4e865b8272c2f4377d05d71 |
| openstack-nova-console-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 075b8ac1a0d312f3cc2d34ed772d797d4adf65f143199772ada4a903f6dc0720 |
| openstack-nova-doc-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 316bfe2bd09505f63fb8bc5e9e06fc299592e2a17cdea9a6921265fe47af2128 |
| openstack-nova-network-2015.1.2-7.el7ost.noarch.rpm | SHA-256: ef6950b87750cd41b264a3fae63c07db382295d0ef87efc2e577b027f20e995c |
| openstack-nova-novncproxy-2015.1.2-7.el7ost.noarch.rpm | SHA-256: c70a928becc4dfa91b180901b6f6f9bdf28fd8d21667d4623778fcfcf0d60f3d |
| openstack-nova-objectstore-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 2ca006e84c90097753239854362564791544c37d8841b5d04f4d792366fab125 |
| openstack-nova-scheduler-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 5a5a2781526b20a73c876501e459c107806e8ea7f13f9732c9e574018ec9a012 |
| openstack-nova-serialproxy-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 7e5fec524187f919c85dbf5c317a594c060b91dc0f17d44bdc87e0e9dd19ec73 |
| openstack-nova-spicehtml5proxy-2015.1.2-7.el7ost.noarch.rpm | SHA-256: a7b20f7a6bad3b5df5b5b4dd9853683a3b07bcc0570366e22271d40099ebf65c |
| python-nova-2015.1.2-7.el7ost.noarch.rpm | SHA-256: 2cbbb1cfc9d29c4e92295d519de26ca27d258f2e817d50a5658f9deb82252e5a |
| python-novaclient-2.23.0-2.el7ost.noarch.rpm | SHA-256: 1c2e4cadb67a09da0c7f44bfac262e6077ca95edd7c08d6807f40444a1572215 |
| python-novaclient-doc-2.23.0-2.el7ost.noarch.rpm | SHA-256: ab1821f408c08d34e2729f1df5c62ee8d30929cdb9127552b5965c846660b130 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from review.openstack.org_47850fb3_20250126_012936.html ===




=== Content from bugzilla.redhat.com_f4985654_20250126_012943.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1273466)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1273466)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1273466)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1273466

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1273466**](show_bug.cgi?id=1273466)
- Nova volume encryptors attach volume fails for NFS and FC (rootwrap)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Nova volume encryptors attach volume fails for NFS and FC (rootwrap)

| | [Keywords](describekeywords.cgi): | ZStream | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Red Hat OpenStack | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Red Hat | | [Component:](describecomponents.cgi?product=Red Hat OpenStack "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | openstack-nova | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 7.0 (Kilo) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86\_64 | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | z3 | | [Target Release](page.cgi?id=fields.html#target_release): | 7.0 (Kilo) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Lee Yarwood | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Prasanth Anbalagan | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | Duplicates (1): | [1272884](show_bug.cgi?id=1272884 "CLOSED DUPLICATE - EncryptedCinderVolumes Tempest fails with iSER")  ([view as bug list](buglist.cgi?bug_id=1272884)) | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1273466&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1273466&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-10-20 13:35 UTC by Lee Yarwood | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-02-22 23:02 UTC ([History](show_activity.cgi?id=1273466)) | | [CC List:](page.cgi?id=fields.html#cclist) | 14 users (show)  berrange dasmith eglynn kchamart lennyb moshele ndipanov pbrady rbiba sbauza sferdjao sgordon vromanso yeylon | | Fixed In Version: | openstack-nova-2015.1.2-2.el7ost | | | Doc Type: | Bug Fix | | | Doc Text: | Previously, nova's rootwrap filters restricted an `ln` command used by the volume encryption providers to a specific iSCSI related target path. As a consequence, iSER, NFS and FC volumes encountered failures as the `ln` command was rejected by nova's rootwrap filters. This update makes Nova's rootwrap filters more generic when calling `ln` allowing the volume encryption providers to succeed. As a result, both the cryptsetup and luks encryption providers now work with iSER, NFS, and FC based volumes. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-12-21 17:07:33 UTC | | | Target Upstream Version: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Launchpad | [1470142](https://bugs.launchpad.net/bugs/1470142) | 0 | None | None | None | Never | | Red Hat Issue Tracker | [OSP-16685](https://issues.redhat.com/browse/OSP-16685) | 0 | None | None | None | 2022-07-09 07:58:39 UTC | | Red Hat Product Errata | [RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-nova security and bug fix advisory | 2015-12-21 21:51:35 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1273466#c0)  Lee Yarwood    2015-10-20 13:35:41 UTC  ``` Description of problem:  Nova volume encryptors attach volume fails for NFS and FC (rootwrap) [https://bugs.launchpad.net/nova/+bug/1470142](https://bugs.launchpad.net/nova/%2Bbug/1470142)  As hit in the following RHBZ :  volume attach failed with iser  [https://bugzilla.redhat.com/show_bug.cgi?id=1268051](show_bug.cgi?id=1268051 "CLOSED ERRATA - volume attach failed with iser")  ~~~ 21982 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher ProcessExecutionError: Unexpected error while running command. 21983 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Command: sudo nova-rootwrap /etc/nova/rootwrap.conf ln --symbolic --force /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0  /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 21984 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Exit code: 99 21985 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Stdout: u'' 21986 2015-10-08 10:58:39.597 3415 TRACE oslo_messaging.rpc.dispatcher Stderr: u'/usr/bin/nova-rootwrap: Unauthorized command: ln --symbolic --force /dev/mapper/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 /dev/disk/by-path/pci-0000:02:00.0-ip-1.1.1.1:3260-iscsi-iqn.2010-10.org.openstack:volume-b21ab8b2-745c-4992-a29f-88993a9b591b-lun-0 (no filter matched)\n' ~~~   Version-Release number of selected component (if applicable):   How reproducible: Always.  Steps to Reproduce: 1. tempest.scenario.test_encrypted_cinder_volumes.TestEncryptedCinderVolumes   Actual results: Nova volume encryptors attach volume fails.  Expected results: Nova volume encryptors attach volume succeeds.  Additional info:   ```  [Comment 2](show_bug.cgi?id=1273466#c2)  Lee Yarwood    2015-11-02 09:26:11 UTC  ``` *** [Bug 1272884](show_bug.cgi?id=1272884 "CLOSED DUPLICATE - EncryptedCinderVolumes Tempest fails with iSER") has been marked as a duplicate of this bug. ***   ```  [Comment 4](show_bug.cgi?id=1273466#c4)  Prasanth Anbalagan    2015-12-09 16:06:11 UTC  ``` Verified as follows,  ************ Version ************  ^C[root@seal17 ~(keystone_admin)]# yum list installed | grep  nova openstack-nova-api.noarch            2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-cert.noarch           2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-common.noarch         2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-compute.noarch        2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-conductor.noarch      2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-console.noarch        2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-novncproxy.noarch     2015.1.2-7.el7ost       @rhelosp-7.0-puddle openstack-nova-scheduler.noarch      2015.1.2-7.el7ost       @rhelosp-7.0-puddle  ************* Logs *************  [root@seal17 ~(keystone_admin)]# cinder type-create LUKS +--------------------------------------+------+ |                  ID                  | Name | +--------------------------------------+------+ | eee5cf90-83e9-4c42-bd4a-5ec48c2f472f | LUKS | +--------------------------------------+------+ [root@seal17 ~(keystone_admin)]# cinder type-list +--------------------------------------+-------+ |                  ID                  |  Name | +--------------------------------------+-------+ | 57028ba3-64c9-488e-8cb5-de2f34d00df4 |  nfs  | | eee5cf90-83e9-4c42-bd4a-5ec48c2f472f |  LUKS | | fbbf0bb5-0698-4cdd-8876-dfde95cce478 | iscsi | +--------------------------------------+-------+ [root@seal17 ~(keystone_admin)]# cinder encryption-type-create --cipher aes-xts-plain64 --key_size 512 --control_location front-end LUKS nova.volume.encryptors.luks.LuksEncryptor +--------------------------------------+-------------------------------------------+-----------------+----------+------------------+ |            Volume Type ID            |                  Provider                 |      Cipher     | Key Size | Control Location | +--------------------------------------+-------------------------------------------+-----------------+----------+------------------+ | eee5cf90-83e9-4c42-bd4a-5ec48c2f472f | nova.volume.encryptors.luks.LuksEncryptor | aes-xts-plain64 |   512    |    front-end     | +--------------------------------------+-------------------------------------------+-----------------+----------+------------------+ [root@seal17 ~(keystone_admin)]# cinder create --display-name 'encrypted volume' --volume-type LUKS 1 +---------------------+--------------------------------------+ |       Property      |                Value                 | +---------------------+--------------------------------------+ |     attachments     |                  []                  | |  availability_zone  |                 nova                 | |       bootable      |                false                 | |      created_at     |      2015-12-09T16:01:40.455493      | | display_description |                 None                 | |     display_name    |           encrypted volume           | |      encrypted      |                 True                 | |          id         | 001efa06-fbda-4c7f-bdfd-999b5b533923 | |       metadata      |                  {}                  | |     multiattach     |                false                 | |         size        |                  1                   | |     snapshot_id     |                 None                 | |     source_volid    |                 None                 | |        status       |               creating               | |     volume_type     |                 LUKS                 | +---------------------+--------------------------------------+ [root@seal17 ~(keystone_admin)]# cinder list +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ |                  ID                  |   Status  |   Display Name   | Size | Volume Type | Bootable |             Attached to              | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ | 001efa06-fbda-4c7f-bdfd-999b5b533923 | available | encrypted volume |  1   |     LUKS    |  false   |                                      | | 156fdd02-00ca-427e-a7be-4ca245f352d5 |   in-use  |       vol1       |  1   |      -      |  false   | 6e56ec06-3287-4d02-90db-69905ecda71f | | 2dde0a96-8d53-4a9f-8ffa-8ae04da9b1a0 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | 899809dd-5415-4f17-9fba-d0cc2846d838 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | e4a9778e-ccac-49c1-8bc2-095f4f99af0f | available |     nfsvol1      |  1   |      -      |  false   |                                      | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ [root@seal17 ~(keystone_admin)]# nova list +--------------------------------------+------+--------+------------+-------------+------------------+ | ID                                   | Name | Status | Task State | Power State | Networks         | +--------------------------------------+------+--------+------------+-------------+------------------+ | 6e56ec06-3287-4d02-90db-69905ecda71f | vm1  | ACTIVE | -          | Running     | private=10.0.0.4 | +--------------------------------------+------+--------+------------+-------------+------------------+ [root@seal17 ~(keystone_admin)]# nova volume-attach vm1 001efa06-fbda-4c7f-bdfd-999b5b533923 +----------+--------------------------------------+ | Property | Value                                | +----------+--------------------------------------+ | device   | /dev/vdc                             | | id       | 001efa06-fbda-4c7f-bdfd-999b5b533923 | | serverId | 6e56ec06-3287-4d02-90db-69905ecda71f | | volumeId | 001efa06-fbda-4c7f-bdfd-999b5b533923 | +----------+--------------------------------------+ [root@seal17 ~(keystone_admin)]# nova list +--------------------------------------+------+--------+------------+-------------+------------------+ | ID                                   | Name | Status | Task State | Power State | Networks         | +--------------------------------------+------+--------+------------+-------------+------------------+ | 6e56ec06-3287-4d02-90db-69905ecda71f | vm1  | ACTIVE | -          | Running     | private=10.0.0.4 | +--------------------------------------+------+--------+------------+-------------+------------------+ [root@seal17 ~(keystone_admin)]# cinder list +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ |                  ID                  |   Status  |   Display Name   | Size | Volume Type | Bootable |             Attached to              | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ | 001efa06-fbda-4c7f-bdfd-999b5b533923 |   in-use  | encrypted volume |  1   |     LUKS    |  false   | 6e56ec06-3287-4d02-90db-69905ecda71f | | 156fdd02-00ca-427e-a7be-4ca245f352d5 |   in-use  |       vol1       |  1   |      -      |  false   | 6e56ec06-3287-4d02-90db-69905ecda71f | | 2dde0a96-8d53-4a9f-8ffa-8ae04da9b1a0 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | 899809dd-5415-4f17-9fba-d0cc2846d838 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | e4a9778e-ccac-49c1-8bc2-095f4f99af0f | available |     nfsvol1      |  1   |      -      |  false   |                                      | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ [root@seal17 ~(keystone_admin)]#  [root@seal17 ~(keystone_admin)]#  [root@seal17 ~(keystone_admin)]# nova volume-detach vm1 001efa06-fbda-4c7f-bdfd-999b5b533923 [root@seal17 ~(keystone_admin)]# cinder list +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ |                  ID                  |   Status  |   Display Name   | Size | Volume Type | Bootable |             Attached to              | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+ | 001efa06-fbda-4c7f-bdfd-999b5b533923 | available | encrypted volume |  1   |     LUKS    |  false   |                                      | | 156fdd02-00ca-427e-a7be-4ca245f352d5 |   in-use  |       vol1       |  1   |      -      |  false   | 6e56ec06-3287-4d02-90db-69905ecda71f | | 2dde0a96-8d53-4a9f-8ffa-8ae04da9b1a0 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | 899809dd-5415-4f17-9fba-d0cc2846d838 |   error   |     nfsvol1      |  1   |     nfs     |  false   |                                      | | e4a9778e-ccac-49c1-8bc2-095f4f99af0f | available |     nfsvol1      |  1   |      -      |  false   |                                      | +--------------------------------------+-----------+------------------+------+-------------+----------+--------------------------------------+   ```  [Comment 6](show_bug.cgi?id=1273466#c6)  errata-xmlrpc    2015-12-21 17:07:33 UTC  ``` Since the problem described in this bug report should be resolved in a recent advisory, it has been closed with a resolution of ERRATA.  For information on the advisory, and where to find the updated files, follow the link below.  If the solution does not work for you, open a new bug report.  [https://access.redhat.com/errata/RHSA-2015:2673](https://access.redhat.com/errata/RHSA-2015%3A2673)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1273466&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugs.launchpad.net_b0871eea_20250124_141345.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2015-021] secgroup rules doesn't work for instance immediately (CVE-2015-7713)

Bug #1491307 reported by
[suntao](https://launchpad.net/~244914362-q)
on 2015-09-02

[276](/%2Bhelp-bugs/bug-heat.html)

This bug affects 4 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [Sreekumar S](https://launchpad.net/~sreesiv) | [OpenStack Compute (nova) 12.0.0 "liberty"](https://launchpad.net/nova/%2Bmilestone/12.0.0) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray) |  |

### Bug Description

I have an OpenStack kilo setup on RHEL7.1 with a controller and a compute node (network-compute + network-network)，the config is following:

# /etc/nova.nova.conf on contrller node

[DEFAULT]

network\_api\_class = nova.network.api.API

security\_group\_api = nova

# /etc/nova/nova.conf on compute node

[DEFAULT]

network\_api\_class = nova.network.api.API

security\_group\_api = nova

firewall\_driver = nova.virt.libvirt.firewall.IptablesFirewallDriver

network\_manager = nova.network.manager.FlatDHCPManager

network\_size = 254

allow\_same\_net\_traffic = False

multi\_host = True

send\_arp\_for\_ha = True

share\_dhcp\_address = True

force\_dhcp\_release = True

flat\_network\_bridge = br100

flat\_interface = eth0

public\_interface = eth0

steps for test 1:

1) create and start VM instance-1 with secgroup default;

2) VM instance-1 ping br100: OK;

3) br100 ping VM instance-1: operation not permitted (because of no secgroup-rules for ICMP)

4) nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0

5) br100 ping VM instance-1: i got the same wrong message, not expected.

steps for test 2:

1) nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0;

2) create and start VM instance-2 with secgroup default;

3) br100 ping instance-2: OK

It seems that command "nova secgroup-add-rule ..." doesn't work immediately for the existed or running VM instances?

Tags:

[security](/nova/%2Bbugs?field.tag=security)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-02: |  |  | [#1](/nova/%2Bbug/1491307/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

So does new nova net security-group-rules are supposed to be applied on existing instance ?

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.
So does new nova net security-group-rules are supposed to be applied on existing instance ?

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-09-07: |  |  | [#2](/nova/%2Bbug/1491307/comments/2) |
| --- | --- | --- | --- |

I'm switching this bug to public security since it's been independently reported in public security [bug 1492961](/bugs/1492961) today.

I'm switching this bug to public security since it's been independently reported in public security bug 1492961 today.

| **information type**: | Private Security → Public Security |
| --- | --- |

[Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv)
on 2015-09-08

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Sreekumar S (sreesiv) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-08: |  |  | [#3](/nova/%2Bbug/1491307/comments/3) |
| --- | --- | --- | --- |

>> So does new nova net security-group-rules are supposed to be applied on existing instance ?

I believe it should, especially important in cases where new rules are added to make the group more restrictive. The admin would think that his rule is applied and safe, whereas actually he needs to manually re-associate that group with 'one of the instances' for it to be applied across all VMs. More details can be seen in the public security [bug 1492961](/bugs/1492961) raised be me.

I think it has to do something with the sec group rules not being refreshed in the code path... "refresh\_security\_group\_rules" func not being called I suppose!

I am new to OpenStack and would like to work on investigating and fixing this issue. I've assigned this to myself. Request reviewers to confirm and discuss the vulnerabilities and possible solutions.

>> So does new nova net security-group-rules are supposed to be applied on existing instance ?
I believe it should, especially important in cases where new rules are added to make the group more restrictive. The admin would think that his rule is applied and safe, whereas actually he needs to manually re-associate that group with 'one of the instances' for it to be applied across all VMs. More details can be seen in the public security bug 1492961 raised be me.
I think it has to do something with the sec group rules not being refreshed in the code path... "refresh\_security\_group\_rules" func not being called I suppose!
I am new to OpenStack and would like to work on investigating and fixing this issue. I've assigned this to myself. Request reviewers to confirm and discuss the vulnerabilities and possible solutions.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-08: |  |  | [#4](/nova/%2Bbug/1491307/comments/4) |
| --- | --- | --- | --- |

Can someone familiar with nova-net security group please confirm the issue here ?

Can someone familiar with nova-net security group please confirm the issue here ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-11: |  |  | [#5](/nova/%2Bbug/1491307/comments/5) |
| --- | --- | --- | --- |

I've found the root cause of this issue.

The call chain goes like this...

In "./nova/compute/api.py"

add\_rules() AND remove\_rules() calls

 trigger\_rules\_refresh() which in turn calls refresh\_instance\_security\_rules() [RPC]

This ends up in ./nova/compute/manager.py

[RPC] \_ComputeV4Proxy::refresh\_instance\_security\_rules() which calls ComputeManager::refresh\_instance\_security\_rules(). But the manager's function decorated with '@object\_compat' calls decorated\_function()

  which calls \_load\_instance(kwargs['instance']). This fails since there is no 'instance' key there and once again calls \_load\_instance from the except catch...

        except KeyError:

            args = (\_load\_instance(args[0]),) + args[1:]

From there it calls objects.Instance.\_from\_db\_object() with argument 'expected\_attrs=metas' which is initialized to

metas = ['metadata', 'system\_metadata']

The db instance dict doesn't have the keys in 'metas' because in trigger\_rules\_refresh() the sec groups are got from db by joining on the instances column, but it doesn't join on the metadata/system\_metadata fields.

This again causes 'KeyError' because when db instance dict is converted to the Instance object, it expects fields that aren't in the dict. So the manager's function do not call refresh\_instance\_security\_rules() on the LibvirtDriver and thereby IptablesFirewallDriver.

This same issue is mentioned in [bug 1484738](/bugs/1484738), although the end problems they cause differ. I've verified the fix proposed by Matt Riedemann and it resolves the issue.

More details: [https://bugs.launchpad.net/nova/+bug/1484738/comments/11](https://bugs.launchpad.net/nova/%2Bbug/1484738/comments/11)

Why this is not repro'ed in Liberty and why can't those changes be backported: [https://bugs.launchpad.net/nova/+bug/1484738/comments/13](https://bugs.launchpad.net/nova/%2Bbug/1484738/comments/13)

More details in commit msg: [https://bugs.launchpad.net/nova/+bug/1484738/comments/17](https://bugs.launchpad.net/nova/%2Bbug/1484738/comments/17)

So once the fix for [bug 1484738](/bugs/1484738) is merged to stable/kilo, it will resolve this issue as well.

I've found the root cause of this issue.
The call chain goes like this...
In "./nova/compute/api.py"
add\_rules() AND remove\_rules() calls
trigger\_rules\_refresh() which in turn calls refresh\_instance\_security\_rules() [RPC]
This ends up in ./nova/compute/manager.py
[RPC] \_ComputeV4Proxy::refresh\_instance\_security\_rules() which calls ComputeManager::refresh\_instance\_security\_rules(). But the manager's function decorated with '@object\_compat' calls decorated\_function()
which calls \_load\_instance(kwargs['instance']). This fails since there is no 'instance' key there and once again calls \_load\_instance from the except catch...
except KeyError:
args = (\_load\_instance(args[0]),) + args[1:]
From there it calls objects.Instance.\_from\_db\_object() with argument 'expected\_attrs=metas' which is initialized to
metas = ['metadata', 'system\_metadata']
The db instance dict doesn't have the keys in 'metas' because in trigger\_rules\_refresh() the sec groups are got from db by joining on the instances column, but it doesn't join on the metadata/system\_metadata fields.
This again causes 'KeyError' because when db instance dict is converted to the Instance object, it expects fields that aren't in the dict. So the manager's function do not call refresh\_instance\_security\_rules() on the LibvirtDriver and thereby IptablesFirewallDriver.
This same issue is mentioned in bug 1484738, although the end problems they cause differ. I've verified the fix proposed by Matt Riedemann and it resolves the issue.
More details: https://bugs.launchpad.net/nova/+bug/1484738/comments/11
Why this is not repro'ed in Liberty and why can't those changes be backported: https://bugs.launchpad.net/nova/+bug/1484738/comments/13
More details in commit msg: https://bugs.launchpad.net/nova/+bug/1484738/comments/17
So once the fix for bug 1484738 is merged to stable/kilo, it will resolve this issue as well.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-11: |  |  | [#6](/nova/%2Bbug/1491307/comments/6) |
| --- | --- | --- | --- |

Per comment 5, this sounds like a duplicate of [bug 1484738](/bugs/1484738). Before comment 5 I was going to ask if there were any errors in the logs, but comment 5 seems to confirm that. So I wouldn't consider this a security issue per se, it's just a code bug that was preventing things from working properly and is now fixed in master (liberty) and backport to stable/kilo and stable/juno. As of this morning it's merged in stable/juno and the fix in stable/kilo is going through the gate.

Per comment 5, this sounds like a duplicate of bug 1484738. Before comment 5 I was going to ask if there were any errors in the logs, but comment 5 seems to confirm that. So I wouldn't consider this a security issue per se, it's just a code bug that was preventing things from working properly and is now fixed in master (liberty) and backport to stable/kilo and stable/juno. As of this morning it's merged in stable/juno and the fix in stable/kilo is going through the gate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-09-11: |  |  | [#7](/nova/%2Bbug/1491307/comments/7) |
| --- | --- | --- | --- |

It sounds like the extent of the risk here is that a user may extend a security group with a change to block some malicious traffic or close off a vulnerable service, then assume they're protected from it without double-checking.

It sounds like the extent of the risk here is that a user may extend a security group with a change to block some malicious traffic or close off a vulnerable service, then assume they're protected from it without double-checking.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-11: |  |  | [#8](/nova/%2Bbug/1491307/comments/8) |
| --- | --- | --- | --- |

Looking at the 2 security group APIs in nova, in the case of nova-network when you add a new secgroup rule it gets into the db but doesn't get down to the virt driver which actually does the iptables stuff (in the case of libvirt) if you hit the KeyError when it calls refresh\_instance\_security\_rules. That failure doesn't get back to the user because the nova-network secgroup API does a cast to refresh the rules. So, yeah, the operation from the CLI would not return an error, but the rules aren't applied for the guest if you hit the KeyError, so you might have a false sense of security.

Looking at the 2 security group APIs in nova, in the case of nova-network when you add a new secgroup rule it gets into the db but doesn't get down to the virt driver which actually does the iptables stuff (in the case of libvirt) if you hit the KeyError when it calls refresh\_instance\_security\_rules. That failure doesn't get back to the user because the nova-network secgroup API does a cast to refresh the rules. So, yeah, the operation from the CLI would not return an error, but the rules aren't applied for the guest if you hit the KeyError, so you might have a false sense of security.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-11: |  |  | [#9](/nova/%2Bbug/1491307/comments/9) |
| --- | --- | --- | --- |

I wouldn't consider Neutron affected by this since it doesn't do the cast to refresh\_instance\_security\_rules.

I wouldn't consider Neutron affected by this since it doesn't do the cast to refresh\_instance\_security\_rules.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-14: |  |  | [#10](/nova/%2Bbug/1491307/comments/10) |
| --- | --- | --- | --- |

I am new to OpenStack and Python in general, so didn't understand the 'cast' part.

But as I mentioned in the bug I raised ([bug 1492961](/bugs/1492961), which was marked duplicate to this one) I've verified the same with neutron network and is working fine there. So it's nova-network only and is resolved with mriedem's changes to [bug 1484738](/bugs/1484738).

I am new to OpenStack and Python in general, so didn't understand the 'cast' part.
But as I mentioned in the bug I raised (bug 1492961, which was marked duplicate to this one) I've verified the same with neutron network and is working fine there. So it's nova-network only and is resolved with mriedem's changes to bug 1484738.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-14: |  |  | [#11](/nova/%2Bbug/1491307/comments/11) |
| --- | --- | --- | --- |

Since it's quite a security defect, and already fixed in supported stable release, I suggest we issue an OSSA with this impact description:

Title: Nova network security group changes are not applied to running instances

Products: Nova

Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1

Description:

Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.

Now about attributions, It seems like this was independently reported by suntao, Sreekumar S. Are those your name and is there affiliations to mention along or are you independent contributors ?

Since it's quite a security defect, and already fixed in supported stable release, I suggest we issue an OSSA with this impact description:
Title: Nova network security group changes are not applied to running instances
Products: Nova
Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1
Description:
Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.
Now about attributions, It seems like this was independently reported by suntao, Sreekumar S. Are those your name and is there affiliations to mention along or are you independent contributors ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sreekumar S (sreesiv)](https://launchpad.net/~sreesiv) wrote on 2015-09-15: |  |  | [#12](/nova/%2Bbug/1491307/comments/12) |
| --- | --- | --- | --- |

Yes, 'Sreekumar S' is my name, and I am an independent contributor.

Yes, 'Sreekumar S' is my name, and I am an independent contributor.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-09-21

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2015-09-23: |  |  | [#13](/nova/%2Bbug/1491307/comments/13) |
| --- | --- | --- | --- |

Tristan, this was fixed under [bug 1484738](/bugs/1484738) but the OSSA is on this bug - how do we resolve that? Should the OSSA move to 1484738?

Tristan, this was fixed under bug 1484738 but the OSSA is on this bug - how do we resolve that? Should the OSSA move to 1484738?

| Changed in nova: | |
| --- | --- |
| **status**: | New → Fix Committed |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-23: |  |  | [#14](/nova/%2Bbug/1491307/comments/14) |
| --- | --- | --- | --- |

Matt, that is fine to me, this bug describe the security impact of [bug 1484738](/bugs/1484738), and I propose to use it for the OSSA tasks. The advisory can reference the former [bug 1484738](/bugs/1484738).

@suntao, can you confirm your attribution is correct:

Title: Nova network security group changes are not applied to running instances

Reporter: Sreekumar S and Suntao

Products: Nova

Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1

Description:

Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.

Matt, that is fine to me, this bug describe the security impact of bug 1484738, and I propose to use it for the OSSA tasks. The advisory can reference the former bug 1484738.
@suntao, can you confirm your attribution is correct:
Title: Nova network security group changes are not applied to running instances
Reporter: Sreekumar S and Suntao
Products: Nova
Affects: versions through 2014.2.3, and 2015.1 versions through 2015.1.1
Description:
Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fails to be applied to already running instances, potentially resulting in instances not being protected by security group. All Nova network setups are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-09-23: |  |  | [#15](/nova/%2Bbug/1491307/comments/15) |
| --- | --- | --- | --- |

Oups, forgot to update the affect line:

Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1

Oups, forgot to update the affect line:
Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-09-24

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → liberty-rc1 |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Grant Murphy (gmurphy)](https://launchpad.net/~gmurphy) wrote on 2015-10-05: |  |  | [#16](/nova/%2Bbug/1491307/comments/16) |
| --- | --- | --- | --- |

+1 with affects line update

+1 with affects line update

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-10-05: |  |  | [#17](/nova/%2Bbug/1491307/comments/17) |
| --- | --- | --- | --- |

Also a slight phrasing improvement to suggest over the second sentence of Tristan's impact description from comment #14:

"Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group."

Otherwise looks good to me.

Also a slight phrasing improvement to suggest over the second sentence of Tristan's impact description from comment #14:
"Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group."
Otherwise looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-10-05: |  |  | [#18](/nova/%2Bbug/1491307/comments/18) |
| --- | --- | --- | --- |

Thanks, CVE requested with:

Title: Nova network security group changes are not applied to running instances

Reporter: Sreekumar S and Suntao

Products: Nova

Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1

Description:

Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group. All Nova network setups are affected.

Thanks, CVE requested with:
Title: Nova network security group changes are not applied to running instances
Reporter: Sreekumar S and Suntao
Products: Nova
Affects: <=2014.2.3, >=2015.1.0, <=2015.1.1
Description:
Sreekumar S and Suntao independently reported a vulnerability in Nova network. Security group changes silently fail to be applied to already running instances, potentially resulting in instances not being protected by the security group. All Nova network setups are affected.

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |
| **assignee**: | nobody → Tristan Cacqueray (tristan-cacqueray) |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-10-06

| **summary**: | - secgroup rules doesn't work for instance immediately+ secgroup rules doesn't work for instance immediately (CVE-2015-7713) |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-10-07

| **summary**: | - secgroup rules doesn't work for instance immediately (CVE-2015-7713)+ [OSSA 2015-021] secgroup rules doesn't work for instance immediately+ (CVE-2015-7713) |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-10-07

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-10-15

| Changed in nova: | |
| --- | --- |
| **milestone**: | liberty-rc1 → 12.0.0 |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1492264](https://bugs.launchpad.net/nova/%2Bbug/1492264 "Updating the security group rules does not reflected in the applicable running instances")
* [Bug #1492961](https://bugs.launchpad.net/nova/%2Bbug/1492961 "Security Group Rules not effective immediately")

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1491307/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1491307/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_febbc70b_20250126_012931.html ===

[Log in / Register](https://launchpad.net/~sreesiv/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~sreesiv)

## [Sreekumar S](https://launchpad.net/~sreesiv)

* Overview
* [Code](https://code.launchpad.net/~sreesiv)
* [Bugs](https://bugs.launchpad.net/~sreesiv)
* [Blueprints](https://blueprints.launchpad.net/~sreesiv)
* [Translations](https://translations.launchpad.net/~sreesiv)
* [Answers](https://answers.launchpad.net/~sreesiv)

* [Related packages](https://launchpad.net/~sreesiv/%2Brelated-packages)
* [Related projects](https://launchpad.net/~sreesiv/%2Brelated-projects)

## User information

Launchpad Id:
sreesiv

Email:
[Log in](%2Blogin) for email information.

Member since:
2015-06-17

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

87B228873C077E8BE3E0AC681B20FADBA12FFD4C

SSH keys:

[rsa-key-20150908](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~sreesiv/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**sreesiv**
 on
**irc.freenode.net**

## Latest memberships

Sreekumar S is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


