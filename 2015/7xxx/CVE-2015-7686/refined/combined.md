=== Content from www.openwall.com_3dab0ad9_20250125_004908.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2015/09/26/2) [[next>]](../../../2015/09/29/1) [[thread-next>]](../../../2015/09/30/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201509270953.59256@pali>
Date: Sun, 27 Sep 2015 09:53:59 +0200
From: Pali Rohár <pali.rohar@...il.com>
To: oss-security@...ts.openwall.com
Subject: DoS attack through Email-Address perl module v1.907 (CVE id request)

Hello!

I discovered possible DoS attack in any software which uses
Email::Address perl module for parsing string input to list of email
addresses.

By default Email::Address module, version v1.907 (and all before) try to
understand nestable comments in input string with deep level 2.

Parsing nestable comments is for specially prepared inputs too slow and
can cause high CPU load, freezing application and Denial of Service.

Because input string for Email::Address module comes from external
source (e.g. from email sent by attacker) it is security problem all
software application which parse email messages by Email::Address perl
module. For example: RT: Request Tracker, CiderWebmail, ...

In new version v1.908 of Email::Address module, released at Sep 19 was
set default value of nestable comments to deep level 1. This is not
proper fix, just workaround for pathological inputs with nestable
comments. Probably nobody has normal usage for inserting nested comments
into email address in To:/Cc: headers...

<https://metacpan.org/release/RJBS/Email-Address-1.908>

<https://github.com/rjbs/Email-Address/commit/3056b7d>

Can you assign CVE id for this problem?

In attachment I'm sending example perl script which uses Email::Address
module for parsing From header and example input.

On my machine that script runs 5 seconds and it parse just four
addresses. Imagine that attacker send email with Cc: header with 10
times more addresses and Email::Address module effectively DoS server
where is that parser running...

--
Pali Rohár
pali.rohar@...il.com

View attachment "[address-line](1/1)" of type "text/plain" (324 bytes)

Download attachment "[address-line-test.pl](1/2)" of type "application/x-perl" (139 bytes)

Download attachment "[signature.asc](1/3) " of type "application/pgp-signature" (199 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_929615ab_20250125_004908.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](12) [[next>]](../../../2015/10/03/1) [[<thread-prev]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151002214340.090C66C000A@smtpvmsrv1.mitre.org>
Date: Fri,  2 Oct 2015 17:43:40 -0400 (EDT)
From: cve-assign@...re.org
To: pali.rohar@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: DoS attack through Email-Address perl module v1.907 (CVE id request)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> Standard usage of Email::Address module is to parse From/To/Cc headers
> from emails. And standard is also to use that module without setting
> $COMMENT_NEST_LEVEL variable... So because I was thinking about this
> standard usage in other applications I think that one CVE ID could be
> enough.

Thanks for your additional notes. We have decided to choose the option
of a single CVE, although this option is unattractive for some
reasons. Use CVE-2015-7686 for the CWE-407 ("Algorithmic Complexity")
issue in versions 1.908 and earlier. In other words, we consider 1.908
to be an affected version because there are realistic cases in which
COMMENT_NEST_LEVEL must be 2 for usability reasons. There is no CVE ID
corresponding to the behavior change between 1.907 and 1.908.

Looking at the first example from our previous reply:

  jsmit@...ine.microsoft.com (Jan Smith (MSFT))

has a name field of "Jan Smith" in level 2 but a name field of "jsmit"
in level 1. However,

  jsmit@...ine.microsoft.com (Jan Smith)

has a name field of "Jan Smith" in both level 2 and level 1. The
documentation for the name instance method says:

  This method tries very hard to determine the name belonging to the
  address. First the "phrase" is checked. If that doesn't work out
  the "comment" is looked into.

The comment field of "(Jan Smith (MSFT))" is a real-life example and
doesn't seem inherently complicated, so we feel that the documented
"tries very hard" behavior is no longer provided if level 1 is used.
As an example, Email::Address->parse might be used only on the "From"
line to support an application that really, really wants to print:

   Dear Jan Smith,
      Thank you for opening a ticket.

instead of

   Dear jsmit,
      Thank you for opening a ticket.

It is, of course, not the CVE project's role to offer advice on
whether to update. In practice, though, if there were a CVE stating
"before 1.908" as the affected versions, then (because 1.908 exists)
many people would update to resolve the CVE. It would fix a
denial-of-service problem for anyone who is actually attacked, but
potentially add a usability problem for a much larger population.

Finally, if anyone is planning to actually fix the CWE-407 issue, note
that the problem might occur only with a list of addresses, as shown
in the address-line attachment in the original CVE request. None of
the four addresses by itself requires much CPU time.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWDvnQAAoJEL54rhJi8gl5HWkP/jTvpIsmvuIp/asS5pTJOXZD
kT5jvSVR76xGWyww4gD85oGzaYgg0mW4JMNmqgRWeK8KeSvhaBo3Q5eKzxL+XjLC
Ykjn9Ho9u+cbG6MBkGFeMW0SOYuN0nqIun7gxAPeYwE44fS2wSRFLDYQydgJahS7
Zqk4FCxSt+aPl4dDsxEaMn2LVr3JbzaRSqbihuzsoKLzjJObC0vAaQDSQgYED6F7
essACn02BiQbfwA7aBP1a8gOpV0J30IdmOsomBsBfqxVwma5GqFSfAnlzMYPM9Ys
/8qV+CZZrkXz42y58YwqolpS8THUtaIsvV2SttmZSGNXuNS0hWqP2tvquV5apvBv
4Wpu4Jx6ouw/3YYncQ5cm+pBjOmK7qYMUVeDlxREZnSxIPQOQ6Jq9womX6OGdEwL
KZV5w3B1U1+82Si6U8Dh0SiJhcumElsg5dvMVAaILDkzA13uEzipci59+oU1G0w2
pdaArJUZ8MvXFPRXGRB2D7GsG3NA0fBT1kttS9jIcsMkaZlHAJDeT9GnhDzWZcIi
SBdR2xi38nOEGHh1uGl7LSNmwrtY+mdkW3o1bEIr9/Ar7ji6c385RnzcTsgza2B3
NP4D5OjARqf4Txh7vpUu1OSohDlJpYjeDTvhu+1wMJaO5aaQf8JKS4owC+JQOJL8
TpZM2oVjUrN/Zbgnmgni
=EqLL
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from forum.bestpractical.com_650c2e69_20250125_004909.html ===


![Request Tracker Community Forum](data:image/svg;base64...)
Loading

[Request Tracker Community Forum](/)

# [Security vulnerabilities in RT (2017-06-15)](/t/security-vulnerabilities-in-rt-2017-06-15/32016)

[RT Users](/c/rt-users/7)

[shawn](https://forum.bestpractical.com/u/shawn)

June 15, 2017, 6:59pm

1

We have discovered security vulnerabilities which affect RT 4.0.x, RT 4.2.x, RT 4.4.x, and the RT::Authen::ExternalAuth extension. We are in the process of public testing of RT versions 4.0.25, 4.2.14, and 4.4.2 which resolve these vulnerabilities. In the meantime we are providing patches which apply atop all released versions of 4.0, 4.2, and 4.4. Additionally we are releasing RT::Authen::ExternalAuth 0.27 and providing a patch for versions 0.09 (released in 2011) and later.

The vulnerabilities addressed by 4.0.25, 4.2.14, 4.4.2, ExternalAuth 0.27 and the below patches include the following:

* RT 4.0.0 and above are vulnerable to an information leak of cross-site request forgery (CSRF) verification tokens if a user visits a specific URL crafted by an attacker. This vulnerability is assigned CVE-2017-5943. It was discovered by a third-party security researcher.
* RT 4.0.0 and above are vulnerable to a cross-site scripting (XSS) attack if an attacker uploads a malicious file with a certain content type. Installations which use the AlwaysDownloadAttachments config setting are unaffected. This fix addresses all existant and future uploaded attachments. This vulnerability is assigned CVE-2016-6127. This was responsibly disclosed to us first by Scott Russo and the GE Application Security Assessment Team.
* One of RT’s dependencies, a Perl module named Email::Address, has a denial of service vulnerability which could induce a denial of service of RT itself. We recommend administrators install Email::Address version 1.908 or above, though we additionally provide a new workaround within RT. The Email::Address vulnerability was assigned CVE-2015-7686. This vulnerability’s application to RT was brought to our attention by Pali Rohár.
* RT 4.0.0 and above are vulnerable to timing side-channel attacks for user passwords. By carefully measuring millions or billions of login attempts, an attacker could crack a user’s password even over the internet. RT now uses a constant-time comparison algorithm for secrets to thwart such attacks. This vulnerability is assigned CVE-2017-5361. This was responsibly disclosed to us by Aaron Kondziela.
* RT’s ExternalAuth feature is vulnerable to a similar timing side-channel attack. Both RT 4.0/4.2 with the widely-deployed RT::Authen::ExternalAuth extension, as well as the core ExternalAuth feature in RT 4.4 are vulnerable. Installations which don’t use ExternalAuth, or which use ExternalAuth for LDAP/ActiveDirectory authentication, or which use ExternalAuth for cookie-based authentication, are unaffected. Only ExternalAuth in DBI (database) mode is vulnerable.
* RT 4.0.0 and above are potentially vulnerable to a remote code execution attack in the dashboard subscription interface. A privileged attackercan cause unexpected code to be executed through carefully-crafted saved search names. Though we have not been able to demonstrate an actual attack owing to other defenses in place, it could be possible. This fix addresses all existant and future saved searches. This vulnerability is assigned CVE-2017-5944. It was discovered by an internal security audit.
* RT 4.0.0 and above have misleading documentation which could reduce system security. The RestrictLoginReferrer config setting (which has security implications) was inconsistent with its implementation, which checked for a slightly different variable name. RT will now check for the incorrect name and produce an error message. This was responsibly disclosed to us by Alex Vandiver.
* Patches for all releases of 4.0.x and 4.2.x are available for download below. Versions of RT older than 4.0.0 are unsupported and do not receive security patches; please contact sales@bestpractical.com if you need assistance with an older RT version.

<https://download.bestpractical.com/pub/rt/release/security-2017-06-15.tar.gz>

<https://download.bestpractical.com/pub/rt/release/security-2017-06-15.tar.gz.asc>

```
e75c2cd5bb99814d6dad4d865dbee6b93818eb7540a29d21cb19d5e002f96805  security-2017-06-15.tar.gz
9208cd8d79106890a73bfb05b480bf67abb3a1448db96546515103a6c1c75e20  security-2017-06-15.tar.gz.asc

```

The README in the tarball contains instructions for applying the patches. If you need help resolving this issue locally, we will provide discounted pricing for single-incident support; please contact us at sales@bestpractical.com for more information.

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](http://www.bestpractical.com/website-terms)
* [Privacy Policy](http://www.bestpractical.com/privacy-policy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

[![logo](https://static.bestpractical.com/bpslogo_only.png)](https://bestpractical.com)
[Docs](https://bestpractical.com/resources/)
[Wiki](https://rt-wiki.bestpractical.com)
[Blog](https://bestpractical.com/blog/)
[Demo](https://demo.bestpractical.com/)
[Support](https://bestpractical.com/services/)
[Code](https://github.com/bestpractical/)


