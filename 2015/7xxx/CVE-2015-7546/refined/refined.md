```
{
  "CVE-2015-7546": {
    "related_content": true,
    "summary": "A keystone token which has been revoked can still be used by manipulating particular byte fields within the token.",
    "root_cause": "The vulnerability arises from the fact that PKI/PKIZ token revocation was based on comparing the entire token value, instead of relying on unique identifiers within the token like a hash of the signed data or an audit ID. This allowed for modifying certain bytes in the token without invalidating the cryptographic signature, thus bypassing revocation.",
    "weaknesses": [
      "Insecure token revocation mechanism that relied on the full token value instead of unique internal IDs.",
      "Lack of proper cryptographic validation of the token's structure, allowing manipulation of non-signed fields.",
      "Offline token validation in keystone-middleware was susceptible to token manipulation."
    ],
     "impact": "A revoked PKI/PKIZ token can be modified to bypass the revocation check, potentially allowing unauthorized access to cloud resources using that token until its natural expiration time. This was mostly relevant for CLI based access as WebUI's use a different more secure mechanism for revocation.",
    "attack_vectors": [
      "An attacker intercepts a valid PKI or PKIZ token.",
       "The attacker manipulates the token bytes to bypass the revocation check.",
       "The modified token can then be used to access cloud resources."
    ],
    "attacker_capabilities": "The attacker needs to be able to intercept a valid, then later revoked, PKI/PKIZ token. Then, they must be able to manipulate certain byte fields within the token itself.",
      "affected_components": [
        "keystone",
        "keystonemiddleware"
     ],
      "vulnerable_versions": [
        "Keystone: <= 2015.1.2, >= 8.0.0 <= 8.0.1",
        "Keystonemiddleware: >= 1.5.0 <= 1.5.3, >= 1.6.0 <= 2.3.2"
    ],
     "fixes": [
        "Keystone fix: https://review.openstack.org/266045 (Kilo), https://review.openstack.org/266022 (Liberty), https://review.openstack.org/258141 (Mitaka)",
        "Keystonemiddleware fix: https://review.openstack.org/266607 (Kilo), https://review.openstack.org/265988 (Liberty), https://review.openstack.org/258143 (Mitaka)"
     ],
     "additional_notes": "The fix involves including the token's audit ID in revocation events and validating tokens against their audit IDs during offline validation. This ensures that even if byte fields are modified, the token is still considered invalid if it has been revoked via the audit ID. Using UUID or Fernet tokens was recommended as a workaround."
   }
}
```