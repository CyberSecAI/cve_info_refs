=== Content from www.openwall.com_7dde4f60_20250124_155015.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[<thread-prev]](../../../2015/09/29/3) [[thread-next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151001225726.9EF7AB2E0A6@smtpvbsrv1.mitre.org>
Date: Thu,  1 Oct 2015 18:57:26 -0400 (EDT)
From: cve-assign@...re.org
To: austinenglish@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request for wget

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

>>                                                 ... We know that a
>> design goal of Tails is to prevent Internet servers from discovering
>> the IP address of a machine running Tails. Possibly it's a design
>> requirement of Tails that a developer needs to "torify" every piece of
>> Internet client software before it can be shipped with the Tails
>> distribution, and that a failure of a torify step is, by definition, a
>> Tails vulnerability.

> That's a reasonable position, please instead issue a CVE for Tails.

Use CVE-2015-7665 for the Tails vulnerability corresponding to the
<http://git.savannah.gnu.org/cgit/wget.git/commit/?id=075d7556964f5a871a73c22ac4b69f5361295099>
commit.

If there is any additional Tails vulnerability related to this,
another CVE ID may be needed. For example,

  <https://lists.gnu.org/archive/html/bug-wget/2015-08/msg00050.html>

says

  to be 100% sure, you should add --passive-ftp to your command line.
  If you don't do that, your /etc/wgetrc or ~/.wgetrc could include
  --no-passive-ftp (or passiveftp = off).

If Tails is supposed to try to ensure that, perhaps there's a
requirement to have something like:

  alias wget="wget --passive-ftp"

in a system-wide location (possibly /etc/bash.bashrc). The concept of
CVE IDs for "failure of a torify step" issues is new, and we aren't
sure of the best approach.

Responding to:

> From: Andreas Stieger <astieger@...e.com>
> Date: Tue, 29 Sep 2015 13:12:37 +0200

>> We really don't understand what set of expectations led to this
>> becoming a CVE request for a vulnerability in wget.

> Possibly assignments for CWE-200 including CVE-2000-0649, CVE-2002-0422
> relating to exposure if an internal IP address of a communication partner.

The difference here is that sending the client IP address within the
TCP application data is inherently a part of the FTP protocol. That's
why we've been reluctant to consider this a vulnerability in the
upstream wget distribution.

This is also a situation in which the need to torify may be different
with IPv6 than with IPv4. IPv4 NAT environments are sometimes set up
so that clients cannot successfully use FTP in active mode. Perhaps
because of this, it is currently common for FTP clients to use passive
mode by default. With IPv6, it is probably more likely that a client
can successfully use FTP in active mode. There might be, now or in the
near future, FTP clients that try active mode for IPv6 FTP servers.
Thus, when Tor is used, there may be information disclosure in EPRT
commands even when there hadn't been information disclosure in PORT
commands. (Of course, a PORT command may be sent even when active mode
is ultimately going to fail. The point is that, for communication
between a normal FTP client and a normal IPv4 FTP server, active mode
will often never be attempted.)

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWDboGAAoJEL54rhJi8gl5WzwP/3vIX0WkQy2KIhjGgI+4dhcZ
lPT9GynzMKGCG5U4Fnqez5lfMammTAmyU6kRCohUSWLfxPkDNDZM5kf5fbnBcgPr
ebq0awx7oj9y506x0YHMw9zYtd1C1uaY18BEdVsZcTs8E2+nBMayAW8+T+o9OVyo
bqImRG5lIj+c68VJuY6mmePDRpqXohOZ4I+Vv5pzBim4cNKcYA28upErh5mZwYYj
rFct5GV3Jc//yAJPhtZMhRIaf+bXcKYoyL3bze+bFLPnLUQSJV/8ezcB2WWE4+Uu
1G4iYD0ZOrmHmbZfJs32ZF2QHdoWMRQzNNN0JQk60iB/4nWuP5Ns28QH3Vu2CRw1
XqyAnaChCEX+Xead71z5Db5ugdIOgTo1hPZ5DaUlU1EJ3T+SYCiwJCCPIELXcGgN
unlml3il98COee1E7tOFudguGlHq0PwHGPixlQVMtZSAHIbuec+Vh4LAbsEE5rTC
Hrsp3xRtUgQNKHiuYgDNNH03fh5e7A75RR6CPaIuTPKjMRCxVPtTzqyhrQYAkc/f
4kEQioiLK/2obNO7EuiitWBaQQGZHZgbFxWnz8F08ZGagg0hQj2QtYeN0SBp+iqY
CEqfUoihoZharTag3XPLf3xA2C8w4GGkWUI6LcyUtrlzoVoSaj0nB6Mt6tWaq6cT
QD/3LlAZGdgiRu5bEuld
=9V0C
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from git.savannah.gnu.org_680c7fad_20250124_155015.html ===


| [cgit logo](/cgit/) | [index](/cgit/) : [wget.git](/cgit/wget.git/) | master parallel-wget |
| --- | --- | --- |
| GNU Wget |  |

| [summary](/cgit/wget.git/)[refs](/cgit/wget.git/refs/?id=075d7556964f5a871a73c22ac4b69f5361295099)[log](/cgit/wget.git/log/)[tree](/cgit/wget.git/tree/?id=075d7556964f5a871a73c22ac4b69f5361295099)[commit](/cgit/wget.git/commit/?id=075d7556964f5a871a73c22ac4b69f5361295099)[diff](/cgit/wget.git/diff/?id=075d7556964f5a871a73c22ac4b69f5361295099) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tim Rühsen <tim.ruehsen@gmx.de> | 2015-08-11 16:48:08 +0200 |
| --- | --- | --- |
| committer | Tim Rühsen <tim.ruehsen@gmx.de> | 2015-08-11 17:38:33 +0200 |
| commit | [075d7556964f5a871a73c22ac4b69f5361295099](/cgit/wget.git/commit/?id=075d7556964f5a871a73c22ac4b69f5361295099) ([patch](/cgit/wget.git/patch/?id=075d7556964f5a871a73c22ac4b69f5361295099)) | |
| tree | [51e2446018e5b4ba1b145193b4eb47b179e8eded](/cgit/wget.git/tree/?id=075d7556964f5a871a73c22ac4b69f5361295099) | |
| parent | [7578e47d4957b019d90bbe77bcab98113a8923bc](/cgit/wget.git/commit/?id=7578e47d4957b019d90bbe77bcab98113a8923bc) ([diff](/cgit/wget.git/diff/?id=075d7556964f5a871a73c22ac4b69f5361295099&id2=7578e47d4957b019d90bbe77bcab98113a8923bc)) | |
| download | [wget-075d7556964f5a871a73c22ac4b69f5361295099.tar.gz](/cgit/wget.git/snapshot/wget-075d7556964f5a871a73c22ac4b69f5361295099.tar.gz) | |

Fix IP address exposure in FTP code\* src/ftp.c (getftp): Do not use PORT when PASV fails.
\* tests/FTPServer.px: Add pasv\_not\_supported server flag.
\* tests/Makefile.am: Add Test-ftp-pasv-not-supported.px
\* tests/Test-ftp-pasv-not-supported.px: New test
Fix IP address exposure when automatically falling back from
passive mode to active mode (using the PORT command). A behavior that
may be used to expose a client's privacy even when using a proxy.
[Diffstat](/cgit/wget.git/diff/?id=075d7556964f5a871a73c22ac4b69f5361295099)

| -rw-r--r-- | [NEWS](/cgit/wget.git/diff/NEWS?id=075d7556964f5a871a73c22ac4b69f5361295099) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [src/ftp.c](/cgit/wget.git/diff/src/ftp.c?id=075d7556964f5a871a73c22ac4b69f5361295099) | 19 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [tests/FTPServer.pm](/cgit/wget.git/diff/tests/FTPServer.pm?id=075d7556964f5a871a73c22ac4b69f5361295099) | 8 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [tests/Makefile.am](/cgit/wget.git/diff/tests/Makefile.am?id=075d7556964f5a871a73c22ac4b69f5361295099) | 3 | |  |  |  | | --- | --- | --- | |
| -rwxr-xr-x | [tests/Test-ftp-pasv-not-supported.px](/cgit/wget.git/diff/tests/Test-ftp-pasv-not-supported.px?id=075d7556964f5a871a73c22ac4b69f5361295099) | 60 | |  |  |  | | --- | --- | --- | |

5 files changed, 84 insertions, 8 deletions

| diff --git a/NEWS b/NEWSindex 50d91960..d84744ac 100644--- a/[NEWS](/cgit/wget.git/tree/NEWS?id=7578e47d4957b019d90bbe77bcab98113a8923bc)+++ b/[NEWS](/cgit/wget.git/tree/NEWS?id=075d7556964f5a871a73c22ac4b69f5361295099)@@ -9,6 +9,8 @@ Please send GNU Wget bug reports to <bug-wget@gnu.org>.  \* Changes in Wget X.Y.Z +\*\* Remove FTP passive to active fallback due to privacy concerns+ \*\* Add support for --if-modified-since  \*\* Add support for metalink through --input-metalink and --metalink-over-httpdiff --git a/src/ftp.c b/src/ftp.cindex 68f1a33c..9dab99c9 100644--- a/[src/ftp.c](/cgit/wget.git/tree/src/ftp.c?id=7578e47d4957b019d90bbe77bcab98113a8923bc)+++ b/[src/ftp.c](/cgit/wget.git/tree/src/ftp.c?id=075d7556964f5a871a73c22ac4b69f5361295099)@@ -252,7 +252,6 @@ getftp (struct url \*u, wgint passed\_expected\_bytes, wgint \*qtyread, char \*respline, \*tms; const char \*user, \*passwd, \*tmrate; int cmd = con->cmd;- bool pasv\_mode\_open = false; wgint expected\_bytes = 0; bool got\_expected\_bytes = false; bool rest\_failed = false;@@ -883,13 +882,19 @@ Error in server response, closing control connection.\n")); ? CONERROR : CONIMPOSSIBLE); } - pasv\_mode\_open = true; /\* Flag to avoid accept port \*/ if (!opt.server\_response) logputs (LOG\_VERBOSE, \_("done. "));- } /\* err==FTP\_OK \*/- }+ }+ else+ return err; - if (!pasv\_mode\_open) /\* Try to use a port command if PASV failed \*/+ /\*+ \* We do not want to fall back from PASSIVE mode to ACTIVE mode !+ \* The reason is the PORT command exposes the client's real IP address+ \* to the server. Bad for someone who relies on privacy via a ftp proxy.+ \*/+ }+ else { err = ftp\_do\_port (csock, &local\_sock); /\* FTPRERR, WRITEFAILED, bindport (FTPSYSERR), HOSTERR,@@ -1148,8 +1153,8 @@ Error in server response, closing control connection.\n")); }  /\* If no transmission was required, then everything is OK. \*/- if (!pasv\_mode\_open) /\* we are not using pasive mode so we need- to accept \*/+ if (!opt.ftp\_pasv) /\* we are not using passive mode so we need+ to accept \*/ { /\* Wait for the server to connect to the address we're waiting at. \*/diff --git a/tests/FTPServer.pm b/tests/FTPServer.pmindex c0a6e47e..a5185d66 100644--- a/[tests/FTPServer.pm](/cgit/wget.git/tree/tests/FTPServer.pm?id=7578e47d4957b019d90bbe77bcab98113a8923bc)+++ b/[tests/FTPServer.pm](/cgit/wget.git/tree/tests/FTPServer.pm?id=075d7556964f5a871a73c22ac4b69f5361295099)@@ -740,6 +740,14 @@ sub run last; } + if (defined($self->{\_server\_behavior}{pasv\_not\_supported})+ && $cmd eq 'PASV')+ {+ print {$conn->{socket}}+ "500 PASV not supported.\r\n";+ next;+ }+ # Run the command. &{$command\_table->{$cmd}}($conn, $cmd, $rest); }diff --git a/tests/Makefile.am b/tests/Makefile.amindex 5d387aab..daf162fc 100644--- a/[tests/Makefile.am](/cgit/wget.git/tree/tests/Makefile.am?id=7578e47d4957b019d90bbe77bcab98113a8923bc)+++ b/[tests/Makefile.am](/cgit/wget.git/tree/tests/Makefile.am?id=075d7556964f5a871a73c22ac4b69f5361295099)@@ -127,7 +127,8 @@ PX\_TESTS = \ Test--start-pos.px \ Test--start-pos--continue.px \ Test--httpsonly-r.px \- Test-204.px+ Test-204.px \+ Test-ftp-pasv-not-supported.px  EXTRA\_DIST = FTPServer.pm FTPTest.pm HTTPServer.pm HTTPTest.pm \ WgetTests.pm WgetFeature.pm WgetFeature.cfg $(PX\_TESTS) \diff --git a/tests/Test-ftp-pasv-not-supported.px b/tests/Test-ftp-pasv-not-supported.pxnew file mode 100755index 00000000..97d0610d--- /dev/null+++ b/[tests/Test-ftp-pasv-not-supported.px](/cgit/wget.git/tree/tests/Test-ftp-pasv-not-supported.px?id=075d7556964f5a871a73c22ac4b69f5361295099)@@ -0,0 +1,60 @@+#!/usr/bin/env perl++use strict;+use warnings;++use FTPTest;++# This test checks whether Wget \*does not\* fall back from passive mode to+# active mode using a PORT command. Wget <= 1.16.3 made a fallback exposing+# the client's real IP address to the remote FTP server.+#+# This behavior circumvents expected privacy when using a proxy / proxy network (e.g. Tor).+#+# Wget >= 1.16.4 does it right. This test checks it.++###############################################################################++# From bug report 10.08.2015 from tomtidaly@sigaint.org+my $afile = <<EOF;+FTP PORT command code in v1.16.3?++In the past it could be possible for a site over http connection to+redirect wget to FPT using FTP PORT command so the site gets the real IP+of the computer even when wget proxy command is in use I believe:+https://lists.torproject.org/pipermail/tor-talk/2012-April/024040.html++Is that code still present in wget v1.16.3? It was present in v1.13.4.+EOF++$afile =~ s/\n/\r\n/g;+++# code, msg, headers, content+my %urls = (+ '/afile.txt' => {+ content => $afile,+ },+);++my $cmdline = $WgetTest::WGETPATH . " -S ftp://localhost:{{port}}/afile.txt";++my $expected\_error\_code = 8;++my %expected\_downloaded\_files = (+ 'afile.txt' => {+ content => $afile,+ },+);++###############################################################################++my $the\_test = FTPTest->new (+ server\_behavior => {pasv\_not\_supported => 1},+ input => \%urls,+ cmdline => $cmdline,+ errcode => $expected\_error\_code,+ output => \%expected\_downloaded\_files);+exit !$the\_test->run();++# vim: et ts=4 sw=4 |
| --- |

generated by [cgit v1.2.3-70-g09d2](https://git.zx2c4.com/cgit/about/) ([git 2.46.0](https://git-scm.com/)) at 2025-01-24 15:50:15 +0000



=== Content from lists.gnu.org_0229c529_20250124_155015.html ===


| | **bug-wget** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-wget)

---

[[Date Prev](msg00019.html)][[Date Next](msg00021.html)][[Thread Prev](msg00018.html)][[Thread Next](msg00025.html)][[Date Index](index.html#00020)][[Thread Index](threads.html#00020)]

## [Bug-wget] FTP PORT command code in v1.16.3?

---

| **From**: | tomtidaly |
| --- | --- |

| **Subject**: | [Bug-wget] FTP PORT command code in v1.16.3? |
| **Date**: | Mon, 10 Aug 2015 16:37:35 -0000 |

---

```
In the past it could be possible for a site over http connection to
redirect wget to FPT using FTP PORT command so the site gets the real IP
of the computer even when wget proxy command is in use I believe:
<https://lists.torproject.org/pipermail/tor-talk/2012-April/024040.html>

Is that code still present in wget v1.16.3? It was present in v1.13.4.

Thank for help

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg00025.html)] |
| --- | --- | --- |

* **[Bug-wget] FTP PORT command code in v1.16.3?**,
  *tomtidaly* **<=**
  + **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00025.html)**, *Tim Ruehsen*, 2015/08/11
    - **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00026.html)**, *Tim Ruehsen*, 2015/08/11
      * **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00027.html)**, *Giuseppe Scrivano*, 2015/08/11* **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00028.html)**, *Tim Ruehsen*, 2015/08/11* **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00030.html)**, *Giuseppe Scrivano*, 2015/08/11
    - **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00047.html)**, *tomtidaly*, 2015/08/12
      * **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00050.html)**, *Tim Ruehsen*, 2015/08/13

---

* Prev by Date:
  **[Re: [Bug-wget] [PATCH] Update HSTS info](msg00019.html)**
* Next by Date:
  **[[Bug-wget] Eternallybored Windows binary Wget safe?](msg00021.html)**
* Previous by thread:
  **[[Bug-wget] [bug #20398] Save a list of the links that were not followed](msg00018.html)**
* Next by thread:
  **[Re: [Bug-wget] FTP PORT command code in v1.16.3?](msg00025.html)**
* Index(es):
  + [**Date**](index.html#00020)
  + [**Thread**](threads.html#00020)


