=== Content from review.openstack.org_c6b8f550_20250126_025824.html ===




=== Content from bugs.launchpad.net_879d8a44_20250126_025827.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2016-001] Unprivileged api user can access host data using instance snapshot (CVE-2015-7548)

Bug #1524274 reported by
[Matthew Booth](https://launchpad.net/~mbooth-9)
on 2015-12-09

[266](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [Matthew Booth](https://launchpad.net/~mbooth-9) |  |
|  | [Kilo](https://bugs.launchpad.net/nova/kilo) | Fix Released | High | [Matthew Booth](https://launchpad.net/~mbooth-9) | [OpenStack Compute (nova) 2015.1.3](https://launchpad.net/nova/%2Bmilestone/2015.1.3) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Critical | [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray) |  |

### Bug Description

There is a qcow2 format vulnerability in LibvirtDriver.snapshot. The impact is that on an affected system, an unprivileged api user can retrieve any file on the host readable by the nova user. This includes guest data of other instances on the same host, and credentials used by nova to access other services externally.

LibvirtDriver.snapshot does:

source\_format = libvirt\_utils.get\_disk\_type(disk\_path)

    ...

    snapshot\_backend = self.image\_backend.snapshot(instance,

        disk\_path,

        image\_type=source\_format)

    ...

    snapshot\_backend.snapshot\_extract(out\_path, image\_format)

libvirt\_utils.get\_disk\_type falls back to image inspection for disks which are not lvm, rbd or ploop, which means raw and qcow2 images.

The vulnerability only exists when a user can write to a raw volume which is later erroneously detected as qcow2. This means that the vulnerability is only present on systems using the libvirt driver which have defined use\_cow\_images=False in nova.conf. This is not the default, so by default nova is not vulnerable.

libvirt.utils.extract\_snapshot() expects to be reading from an instance disk and writing to a temporary directory created by nova for storing snapshots before transferring them to glance. As nova directly creates this directory and its contents, the 'qemu-img convert' process does not need to run privileged. This means that the exposure is limited to files directly readable by the nova user.

Unfortunately, as is clear from the context this includes all instance data which, despite being owned by the qemu user, is world readable. Additionally, because the qemu-img process is executed by nova directly, it does not benefit from any confinement by libvirt. Specifically, SELinux is not likely to be a defence on a typical deployment.

I have tested this exploit on a Fedora 23 system running devstack as of 8th Dec 2015:

Ensure nova.conf contains use\_cow\_images = False in the DEFAULT section.

As an unprivileged api user, do:

$ nova boot --image cirros --flavor m1.tiny foo

Somewhere, run:

$ qemu-img create -f qcow2 -o backing\_file=/etc/passwd bad.qcow2

Ensure bad.qcow2 is available in the foo instance.

Log into foo, and execute as root:

# dd if=bad.qcow2 of=/dev/vda conv=fsync

As an unprivileged api user, do:

$ nova image-create foo passwd

$ glance image-download <newly created image id> --file passwd

The unprivileged api now has the contents of /etc/passwd from the host locally.

Mitigations:

Nova is not vulnerable by default. The user must have configured use\_cow\_images=False.

Nova configurations using ceph or lvm for instance storage are not vulnerable.

An attacker must know the uuid of another user's instance in order to be able to access its data.

See [original description](comments/0)

Tags:

[in-stable-liberty](/nova/%2Bbugs?field.tag=in-stable-liberty)
[in-stable-kilo](/nova/%2Bbugs?field.tag=in-stable-kilo)

## CVE References

* [2015-7548](/bugs/cve/2015-7548 "OpenStack Compute (Nova) before 2015....")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2015-12-09: |  |  | [#1](/nova/%2Bbug/1524274/comments/1) |
| --- | --- | --- | --- |

Added ndipanov to help with this one

Added ndipanov to help with this one

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Matthew Booth (mbooth-9) |
| **importance**: | Undecided → High |

[Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9)
on 2015-12-09

| **description**: | updated |
| --- | --- |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2015-12-09

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-12-09: |  |  | [#2](/nova/%2Bbug/1524274/comments/2) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

In the past, we've considered bugs requiring UUID guessing to be security hardening opportunities rather than reasonably exploitable vulnerabilities. If it's confirmed that you need to guess or otherwise obtain the UUID of another tenant's instance to take advantage of this, then the VMT likely won't issue a security advisory nor request a CVE assignment. Also, the reduced risk implies that we'd be better off working this bug through our normal public process rather than incurring the expense of a private embargo.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.
In the past, we've considered bugs requiring UUID guessing to be security hardening opportunities rather than reasonably exploitable vulnerabilities. If it's confirmed that you need to guess or otherwise obtain the UUID of another tenant's instance to take advantage of this, then the VMT likely won't issue a security advisory nor request a CVE assignment. Also, the reduced risk implies that we'd be better off working this bug through our normal public process rather than incurring the expense of a private embargo.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-12-09: |  |  | [#3](/nova/%2Bbug/1524274/comments/3) |
| --- | --- | --- | --- |

This seems like a similar issue of <https://security.openstack.org/ossa/OSSA-2014-009.html>

We did issue an advisory because nova user is able to read /etc/nova/nova.conf which usually contains sensitive information like services token.

Anyway, is this a regression or snapshot never used the disk info file to inspect file format ?

This seems like a similar issue of https://security.openstack.org/ossa/OSSA-2014-009.html
We did issue an advisory because nova user is able to read /etc/nova/nova.conf which usually contains sensitive information like services token.
Anyway, is this a regression or snapshot never used the disk info file to inspect file format ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nikola Đipanov (ndipanov)](https://launchpad.net/~ndipanov) wrote on 2015-12-09: |  |  | [#4](/nova/%2Bbug/1524274/comments/4) |
| --- | --- | --- | --- |

This is very similar to [https://bugs.launchpad.net/nova/+bug/1221190](https://bugs.launchpad.net/nova/%2Bbug/1221190)

The problematic line

<https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/libvirt/driver.py#L1357>

was introduced by this commit: <https://review.openstack.org/#/c/13684/> which was merged more than 3 years ago, but looking at the surrounding code at the time, the problem was there even before the patch, since we'd just grab the image format from glance which is completely user controlled as well.

So this does not seem like a regression.

This is very similar to https://bugs.launchpad.net/nova/+bug/1221190
The problematic line
https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/libvirt/driver.py#L1357
was introduced by this commit: https://review.openstack.org/#/c/13684/ which was merged more than 3 years ago, but looking at the surrounding code at the time, the problem was there even before the patch, since we'd just grab the image format from glance which is completely user controlled as well.
So this does not seem like a regression.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-09: |  |  | [#5](/nova/%2Bbug/1524274/comments/5) |
| --- | --- | --- | --- |

The bug is worse that I originally realised, as it also affects installations running on ceph, lvm and ploop. The only setup which is not affected is qcow2 on filesystem.

The issue with ceph, lvm and ploop is that their snapshot\_extract does convert\_image, which calls qemu-img convert. It specifies an output format but not an input format, which means that the input format is implictly auto-detected. It is worse still on lvm, because in that case qemu-img convert runs as root, so it can read any file or device on the host without restriction.

I have successfully exploited this on rbd.

The bug is worse that I originally realised, as it also affects installations running on ceph, lvm and ploop. The only setup which is not affected is qcow2 on filesystem.
The issue with ceph, lvm and ploop is that their snapshot\_extract does convert\_image, which calls qemu-img convert. It specifies an output format but not an input format, which means that the input format is implictly auto-detected. It is worse still on lvm, because in that case qemu-img convert runs as root, so it can read any file or device on the host without restriction.
I have successfully exploited this on rbd.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-09: |  |  | [#6](/nova/%2Bbug/1524274/comments/6) |
| --- | --- | --- | --- |

* [0001-All-the-things.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4532036/%2Bfiles/0001-All-the-things.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4532036)
  (13.3 KiB,
  text/plain)

Here's a patch which addresses the originally reported issue with raw on filesystem. However, it does not fix the problem. With this patch, the disk is correctly handled as raw, but then it calls Raw.snapshot\_extract, which is also vulnerable as described above, as it doesn't explicitly specify input format.

So, I believe this patch is required, but another patch is also required. I will work on this second patch tomorrow.

Here's a patch which addresses the originally reported issue with raw on filesystem. However, it does not fix the problem. With this patch, the disk is correctly handled as raw, but then it calls Raw.snapshot\_extract, which is also vulnerable as described above, as it doesn't explicitly specify input format.
So, I believe this patch is required, but another patch is also required. I will work on this second patch tomorrow.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nikola Đipanov (ndipanov)](https://launchpad.net/~ndipanov) wrote on 2015-12-09: |  |  | [#7](/nova/%2Bbug/1524274/comments/7) |
| --- | --- | --- | --- |

Just for clarity the problematic line for RBD is

<https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/libvirt/imagebackend.py#L818>

if you look at convert\_image method it calls:

<https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/images.py#L71>

the call to qemu-image convert never gets passed an input file format (-f) which means it tries to guess it from the image.

Other formats Matt mentions call the same method and are exploitable for the same reason.

Just for clarity the problematic line for RBD is
https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/libvirt/imagebackend.py#L818
if you look at convert\_image method it calls:
https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/images.py#L71
the call to qemu-image convert never gets passed an input file format (-f) which means it tries to guess it from the image.
Other formats Matt mentions call the same method and are exploitable for the same reason.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-12-09

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |
| **importance**: | Undecided → Critical |
| **assignee**: | nobody → Tristan Cacqueray (tristan-cacqueray) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-12-09: |  |  | [#8](/nova/%2Bbug/1524274/comments/8) |
| --- | --- | --- | --- |

Thanks for the clarification, I've confirmed the OSSA task. Matthew, about ceph, lvm, ... does it also triggers even with use\_cow\_images = True ?

Here is a first draft for the impact description:

Title: Nova host data leak through snapshot

Reporter: Matthew Booth (Red Hat)

Products: Nova

Versions: <=2015.1.2, ==12.0.0

Description:

Matthew Booth from Red Hat reported a vulnerability in Nova instance snapshot. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host. Note that the host file needs to be readable by the libvirt/kvm context to be exposed, lvm image backend run as root user, other backends run as nova user. Only setups using libvirt to spawn instance, and having "use\_cow\_images = False" in Nova configuration are affected.

Thanks for the clarification, I've confirmed the OSSA task. Matthew, about ceph, lvm, ... does it also triggers even with use\_cow\_images = True ?
Here is a first draft for the impact description:
Title: Nova host data leak through snapshot
Reporter: Matthew Booth (Red Hat)
Products: Nova
Versions: <=2015.1.2, ==12.0.0
Description:
Matthew Booth from Red Hat reported a vulnerability in Nova instance snapshot. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host. Note that the host file needs to be readable by the libvirt/kvm context to be exposed, lvm image backend run as root user, other backends run as nova user. Only setups using libvirt to spawn instance, and having "use\_cow\_images = False" in Nova configuration are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-10: |  |  | [#9](/nova/%2Bbug/1524274/comments/9) |
| --- | --- | --- | --- |

use\_cow\_images = True is only used by filesystem storage. Systems which set use\_cow\_images = True and use filesystem storage are not vulnerable. Everything else is vulnerable. For clarity:

nfs or local files, use\_cow\_images = True: not vulnerable

nfs or local files, use\_cow\_images = False: vulnerable

ceph, lvm, ploop: vulnerable

Essentially, anything which stores raw data is vulnerable.

use\_cow\_images = True is only used by filesystem storage. Systems which set use\_cow\_images = True and use filesystem storage are not vulnerable. Everything else is vulnerable. For clarity:
nfs or local files, use\_cow\_images = True: not vulnerable
nfs or local files, use\_cow\_images = False: vulnerable
ceph, lvm, ploop: vulnerable
Essentially, anything which stores raw data is vulnerable.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-10: |  |  | [#10](/nova/%2Bbug/1524274/comments/10) |
| --- | --- | --- | --- |

The impact description isn't quite right, yet. The process which reads host data is executed directly by nova. It runs as the nova user, except for the lvm backend, which runs as root. libvirt/kvm is not involved, which means libvirt confinement isn't a protection here. As discussed above, use\_cow\_images = False is only relevant to filesystem storage (local/nfs).

How about:

Matthew Booth from Red Hat reported a vulnerability in Nova instance snapshot. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host. Note that the host file needs to be readable by the nova user to be exposed except when using lvm for instance storage, when all files readable by root are exposed. Only setups using libvirt to spawn instances are vulnerable. Of these, setups which use filesystem storage, and do not set "use\_cow\_images = False" in Nova configuration are not affected. Setups which use ceph, lvm, or ploop for instance storage, and setups which use filesystem storage with "use\_cow\_images = False" are all affected.

The impact description isn't quite right, yet. The process which reads host data is executed directly by nova. It runs as the nova user, except for the lvm backend, which runs as root. libvirt/kvm is not involved, which means libvirt confinement isn't a protection here. As discussed above, use\_cow\_images = False is only relevant to filesystem storage (local/nfs).
How about:
Matthew Booth from Red Hat reported a vulnerability in Nova instance snapshot. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host. Note that the host file needs to be readable by the nova user to be exposed except when using lvm for instance storage, when all files readable by root are exposed. Only setups using libvirt to spawn instances are vulnerable. Of these, setups which use filesystem storage, and do not set "use\_cow\_images = False" in Nova configuration are not affected. Setups which use ceph, lvm, or ploop for instance storage, and setups which use filesystem storage with "use\_cow\_images = False" are all affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Daniel Berrange (berrange)](https://launchpad.net/~berrange) wrote on 2015-12-10: |  |  | [#11](/nova/%2Bbug/1524274/comments/11) |
| --- | --- | --- | --- |

I've looked at the patch from comment #6 and I agree with the way Matt has fixed the find\_disk/get\_disk\_type methods to be safe.

I've looked at the patch from comment #6 and I agree with the way Matt has fixed the find\_disk/get\_disk\_type methods to be safe.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nikola Đipanov (ndipanov)](https://launchpad.net/~ndipanov) wrote on 2015-12-10: |  |  | [#12](/nova/%2Bbug/1524274/comments/12) |
| --- | --- | --- | --- |

Some comments on the patch from comment #6

@@ -1356,10 +1357,23 @@ class LibvirtDriver(driver.ComputeDriver):

snapshot = self.\_image\_api.get(context, image\_id)

- disk\_path = libvirt\_utils.find\_disk(virt\_dom)

- source\_format = libvirt\_utils.get\_disk\_type(disk\_path)

+ # source\_format is an on-disk format

+ # source\_type is a backend type

+ disk\_path, source\_format = libvirt\_utils.find\_disk(virt\_dom)

+ source\_type = libvirt\_utils.get\_disk\_type\_from\_path(disk\_path)

So the problem with using source\_type derived from the file we find in disk\_path is actually that we use it to instantiate the image backend class further down

<https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/libvirt/driver.py#L1421-L1422>

But we really do not need this information at all here, we should really just be calling

snapshot\_backend = self.image\_backend.snapshot(instance, disk\_path)

as the format will be taken care of by the resolve\_driver\_format() method of the backend which then looks at the stored format in the disk\_info\_path file.

I agree that this patch probably fixes the issue, but does it in a way that is slightly different from the mechanism for doing this that we already have in place - the resolve\_driver\_format method (and seems to require more code). We should go for the simplest/most confined solution if possible.

Some comments on the patch from comment #6
@@ -1356,10 +1357,23 @@ class LibvirtDriver(driver.ComputeDriver):
snapshot = self.\_image\_api.get(context, image\_id)
- disk\_path = libvirt\_utils.find\_disk(virt\_dom)
- source\_format = libvirt\_utils.get\_disk\_type(disk\_path)
+ # source\_format is an on-disk format
+ # source\_type is a backend type
+ disk\_path, source\_format = libvirt\_utils.find\_disk(virt\_dom)
+ source\_type = libvirt\_utils.get\_disk\_type\_from\_path(disk\_path)
So the problem with using source\_type derived from the file we find in disk\_path is actually that we use it to instantiate the image backend class further down
https://github.com/openstack/nova/blob/b5890b3c36613919338f83c4f59225f424c99cb1/nova/virt/libvirt/driver.py#L1421-L1422
But we really do not need this information at all here, we should really just be calling
snapshot\_backend = self.image\_backend.snapshot(instance, disk\_path)
as the format will be taken care of by the resolve\_driver\_format() method of the backend which then looks at the stored format in the disk\_info\_path file.
I agree that this patch probably fixes the issue, but does it in a way that is slightly different from the mechanism for doing this that we already have in place - the resolve\_driver\_format method (and seems to require more code). We should go for the simplest/most confined solution if possible.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nikola Đipanov (ndipanov)](https://launchpad.net/~ndipanov) wrote on 2015-12-10: |  |  | [#13](/nova/%2Bbug/1524274/comments/13) |
| --- | --- | --- | --- |

As a side note: I wonder if we should have a separate bug and CVE for the convert\_image issue. It seems that under the circumstances and considering the severity - it requires a proper analysis, which it may not get if we keep it all under an umbrella of a single bug.

As a side note: I wonder if we should have a separate bug and CVE for the convert\_image issue. It seems that under the circumstances and considering the severity - it requires a proper analysis, which it may not get if we keep it all under an umbrella of a single bug.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Daniel Berrange (berrange)](https://launchpad.net/~berrange) wrote on 2015-12-10: |  |  | [#14](/nova/%2Bbug/1524274/comments/14) |
| --- | --- | --- | --- |

IMHO it is only appropriate to use the resolve\_drive\_format() method in cases where we don't have access to the information from libvirt guest config. ie it if the guest does not already exist. If there is a libvirt guest XML present, we should consider that the canonical source of information about the disk format, because that reflects what format QEMU is actually running with. The Nova look-aside cache is just a backup data source IMHO, not the canonical source, so should be used as a last resort

IMHO it is only appropriate to use the resolve\_drive\_format() method in cases where we don't have access to the information from libvirt guest config. ie it if the guest does not already exist. If there is a libvirt guest XML present, we should consider that the canonical source of information about the disk format, because that reflects what format QEMU is actually running with. The Nova look-aside cache is just a backup data source IMHO, not the canonical source, so should be used as a last resort

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-10: |  |  | [#15](/nova/%2Bbug/1524274/comments/15) |
| --- | --- | --- | --- |

Nikola,

I figured that while the 2 issues are technically separate, though, the exploit and impact is essentially identical. i.e. from a user and patching pov, they're the same thing. In particular, I'd worry about producing 2 very similar CVEs with the same impact and exploit, but with different sets of affected users. The potential outcome of that is that somebody might mix them up and not patch, whereas in practice almost everybody has to patch.

However, I'm not sufficiently familiar with the process to know whether 2 bugs or 1 handles this better. I'm happy to create a second bug for the convert\_image issue if that's more useful. I'll continue treating them as 1 issue until somebody better informed tells me otherwise.

Nikola,
I figured that while the 2 issues are technically separate, though, the exploit and impact is essentially identical. i.e. from a user and patching pov, they're the same thing. In particular, I'd worry about producing 2 very similar CVEs with the same impact and exploit, but with different sets of affected users. The potential outcome of that is that somebody might mix them up and not patch, whereas in practice almost everybody has to patch.
However, I'm not sufficiently familiar with the process to know whether 2 bugs or 1 handles this better. I'm happy to create a second bug for the convert\_image issue if that's more useful. I'll continue treating them as 1 issue until somebody better informed tells me otherwise.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-10: |  |  | [#16](/nova/%2Bbug/1524274/comments/16) |
| --- | --- | --- | --- |

- return disk\_path

+ if driver is not None:

+ format = driver.get('type')

+ # This is a legacy quirk of libvirt/xen. Everything else should

+ # report the on-disk format in type.

+ if format == 'aio':

+ format = 'raw'

+ else:

+ format = None

+ return (disk\_path, format)

QEMU is running guest so I'm not sure we can be on case where format is None or if we are we should to stop process.

What about:

- return disk\_path

+ if driver is None:

+ raise RuntimeError("Can't retrieve disk driver from guest's domain XML")

+ format = driver.get('type')

+ if format == 'aio':

+ # This is a legacy quirk of libvirt/xen. Everything else should

+ # report the on-disk format in type.

+ format = 'raw'

+ return (disk\_path, format)

- return disk\_path
+ if driver is not None:
+ format = driver.get('type')
+ # This is a legacy quirk of libvirt/xen. Everything else should
+ # report the on-disk format in type.
+ if format == 'aio':
+ format = 'raw'
+ else:
+ format = None
+ return (disk\_path, format)
QEMU is running guest so I'm not sure we can be on case where format is None or if we are we should to stop process.
What about:
- return disk\_path
+ if driver is None:
+ raise RuntimeError("Can't retrieve disk driver from guest's domain XML")
+ format = driver.get('type')
+ if format == 'aio':
+ # This is a legacy quirk of libvirt/xen. Everything else should
+ # report the on-disk format in type.
+ format = 'raw'
+ return (disk\_path, format)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-10: |  |  | [#17](/nova/%2Bbug/1524274/comments/17) |
| --- | --- | --- | --- |

Sahid,

I wrote it the way I did because I don't know what's going on with lxc guests, and I wanted to minimise the chances of breaking them (I'm not going to test them). We're passing a mounted filesystem to libvirt for lxc guests, so libvirt doesn't know what the file format is of the underlying storage. That's not ideal, but it's a separate issue.

Sahid,
I wrote it the way I did because I don't know what's going on with lxc guests, and I wanted to minimise the chances of breaking them (I'm not going to test them). We're passing a mounted filesystem to libvirt for lxc guests, so libvirt doesn't know what the file format is of the underlying storage. That's not ideal, but it's a separate issue.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nikola Đipanov (ndipanov)](https://launchpad.net/~ndipanov) wrote on 2015-12-10: |  |  | [#18](/nova/%2Bbug/1524274/comments/18) |
| --- | --- | --- | --- |

So I think we have one more path that allows for a problem but affects only raw backend (as qcow is not affected and \_live\_snapshot is enabled only for file backed instances):

<https://github.com/openstack/nova/blob/240df4285964d341239376d8ea355c1b3763007a/nova/virt/libvirt/driver.py#L1567-L1571>

this creates an overlay on top of whatever is read from the image by calling libvirt\_utils.get\_disk\_backing\_file, and then image\_create (in case of raw it could have been tampered with). The code then proceeds to call blockRebase and finally qemu-image convert to whatever was detected.

It would be good to try to reproduce this path as well as we'll want to fix the issue with the

So I think we have one more path that allows for a problem but affects only raw backend (as qcow is not affected and \_live\_snapshot is enabled only for file backed instances):
https://github.com/openstack/nova/blob/240df4285964d341239376d8ea355c1b3763007a/nova/virt/libvirt/driver.py#L1567-L1571
this creates an overlay on top of whatever is read from the image by calling libvirt\_utils.get\_disk\_backing\_file, and then image\_create (in case of raw it could have been tampered with). The code then proceeds to call blockRebase and finally qemu-image convert to whatever was detected.
It would be good to try to reproduce this path as well as we'll want to fix the issue with the

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-10: |  |  | [#19](/nova/%2Bbug/1524274/comments/19) |
| --- | --- | --- | --- |

So the live snapshot thing is definitely a bug. However, it \*doesn't\* result in leaking data from the host. I'm not 100% sure why, but the resulting file is still a qcow2 with a backing file. As we don't have this backing file, there's no data leak.

As I don't understand why it's not broken, I'd still be inclined to fix it, tbh. It's definitely not safe.

So the live snapshot thing is definitely a bug. However, it \*doesn't\* result in leaking data from the host. I'm not 100% sure why, but the resulting file is still a qcow2 with a backing file. As we don't have this backing file, there's no data leak.
As I don't understand why it's not broken, I'd still be inclined to fix it, tbh. It's definitely not safe.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-10: |  |  | [#20](/nova/%2Bbug/1524274/comments/20) |
| --- | --- | --- | --- |

* [Fix for convert\_image bug](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4532695/%2Bfiles/0001-More-things.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4532695)
  (6.0 KiB,
  text/plain)

Apologies for the lack of commit messages. I have to run again and I don't have time to do them justice right now. The second patch addresses the convert\_image bug. I have tested it against both filesystem/raw and ceph. The exploit no longer works on either setup with both patches in place.

Apologies for the lack of commit messages. I have to run again and I don't have time to do them justice right now. The second patch addresses the convert\_image bug. I have tested it against both filesystem/raw and ceph. The exploit no longer works on either setup with both patches in place.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-12-10: |  |  | [#21](/nova/%2Bbug/1524274/comments/21) |
| --- | --- | --- | --- |

The migration case is also worrisome, the exploit may be prevented by another bug or something... We should fix it in another patch (and maybe another bug-report) only if we are confident this is not exploitable. Otherwise I would suggest we fix all qemu-img convert trickery in a single advisory.

Here is another draft that only covers the snapshot case with the description proposed by Matthew:

Title: Nova host data leak through snapshot

Reporter: Matthew Booth (Red Hat)

Products: Nova

Versions: <=2015.1.2, ==12.0.0

Description:

Matthew Booth from Red Hat reported a vulnerability in Nova instance snapshot. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host. Note that the host file needs to be readable by the nova user to be exposed except when using lvm for instance storage, when all files readable by root are exposed. Only setups using libvirt to spawn instances are vulnerable. Of these, setups which use filesystem storage, and do not set "use\_cow\_images = False" in Nova configuration are not affected. Setups which use ceph, lvm, or ploop for instance storage, and setups which use filesystem storage with "use\_cow\_images = False" are all affected.

The migration case is also worrisome, the exploit may be prevented by another bug or something... We should fix it in another patch (and maybe another bug-report) only if we are confident this is not exploitable. Otherwise I would suggest we fix all qemu-img convert trickery in a single advisory.
Here is another draft that only covers the snapshot case with the description proposed by Matthew:
Title: Nova host data leak through snapshot
Reporter: Matthew Booth (Red Hat)
Products: Nova
Versions: <=2015.1.2, ==12.0.0
Description:
Matthew Booth from Red Hat reported a vulnerability in Nova instance snapshot. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host. Note that the host file needs to be readable by the nova user to be exposed except when using lvm for instance storage, when all files readable by root are exposed. Only setups using libvirt to spawn instances are vulnerable. Of these, setups which use filesystem storage, and do not set "use\_cow\_images = False" in Nova configuration are not affected. Setups which use ceph, lvm, or ploop for instance storage, and setups which use filesystem storage with "use\_cow\_images = False" are all affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-11: |  |  | [#22](/nova/%2Bbug/1524274/comments/22) |
| --- | --- | --- | --- |

* [0001-Fix-format-detection-in-libvirt-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533238/%2Bfiles/0001-Fix-format-detection-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533238)
  (15.0 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-11: |  |  | [#23](/nova/%2Bbug/1524274/comments/23) |
| --- | --- | --- | --- |

* [0002-Fix-format-conversion-in-libvirt-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533239/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533239)
  (6.8 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-11: |  |  | [#24](/nova/%2Bbug/1524274/comments/24) |
| --- | --- | --- | --- |

* [0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533240/%2Bfiles/0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533240)
  (7.5 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-12-11: |  |  | [#25](/nova/%2Bbug/1524274/comments/25) |
| --- | --- | --- | --- |

I meant live-snapshot, not migration. my bad!

I meant live-snapshot, not migration. my bad!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-11: |  |  | [#26](/nova/%2Bbug/1524274/comments/26) |
| --- | --- | --- | --- |

I've uploaded 3 patches to address the 3 issues discussed in this bug, including the live-snapshot issue mentioned by nikola which we aren't 100% sure is usefully exploitable. They all now have proper commit messages. I have tested them against filesystem/raw and rbd locally, but I would be very grateful for review.

I've uploaded 3 patches to address the 3 issues discussed in this bug, including the live-snapshot issue mentioned by nikola which we aren't 100% sure is usefully exploitable. They all now have proper commit messages. I have tested them against filesystem/raw and rbd locally, but I would be very grateful for review.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-12-11

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-12-11: |  |  | [#27](/nova/%2Bbug/1524274/comments/27) |
| --- | --- | --- | --- |

Thanks Matthew, nova-coresec, please review proposed patch.

I'd like to request a CVE now with the proposed impact description in #21 since it's good enough for both issues (snapshot and live-snapshot).

If patches are approved by Monday morning (before 1500UTC), this could be disclosed the following Thursday:

2015-12-17, 1500 UTC

If patches are approved by Thursday, this would need to wait another week and could be disclosed the following Tuesday:

2015-12-22, 1500 UTC

This second date is not really ideal since it's dangerously close to Christmas holidays...

Thanks Matthew, nova-coresec, please review proposed patch.
I'd like to request a CVE now with the proposed impact description in #21 since it's good enough for both issues (snapshot and live-snapshot).
If patches are approved by Monday morning (before 1500UTC), this could be disclosed the following Thursday:
2015-12-17, 1500 UTC
If patches are approved by Thursday, this would need to wait another week and could be disclosed the following Tuesday:
2015-12-22, 1500 UTC
This second date is not really ideal since it's dangerously close to Christmas holidays...

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Daniel Berrange (berrange)](https://launchpad.net/~berrange) wrote on 2015-12-11: |  |  | [#28](/nova/%2Bbug/1524274/comments/28) |
| --- | --- | --- | --- |

The 3 new patches get my +2.

The 3 new patches get my +2.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nikola Đipanov (ndipanov)](https://launchpad.net/~ndipanov) wrote on 2015-12-11: |  |  | [#29](/nova/%2Bbug/1524274/comments/29) |
| --- | --- | --- | --- |

The only improvement I'd make in patche #2 would be to make sure that we never call an unsafe convert\_image outside of that one case where we have to do it, by making that a separate method we name \_unsafe

Otherwise lgtm - I think sahid was working on some backports. How do the tests look?

The only improvement I'd make in patche #2 would be to make sure that we never call an unsafe convert\_image outside of that one case where we have to do it, by making that a separate method we name \_unsafe
Otherwise lgtm - I think sahid was working on some backports. How do the tests look?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-12-11: |  |  | [#30](/nova/%2Bbug/1524274/comments/30) |
| --- | --- | --- | --- |

Tristan's impact description in comment #21 looks good to me.

The rules to determine whether your deployment is impacted are somewhat convoluted and it took me a few times reading through to grok. Nevertheless I can't think of any easier way to state that, and hopefully downstream consumers will just apply the patch regardless.

Tristan's impact description in comment #21 looks good to me.
The rules to determine whether your deployment is impacted are somewhat convoluted and it took me a few times reading through to grok. Nevertheless I can't think of any easier way to state that, and hopefully downstream consumers will just apply the patch regardless.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-11: |  |  | [#31](/nova/%2Bbug/1524274/comments/31) |
| --- | --- | --- | --- |

I would make 1 change to the impact statement: I no longer believe ploop is affected, although I still haven't tested it and I'm not going to. So affected setups are:

\* filesystem + use\_cow\_images = False

\* LVM

\* RBD

I would remove mention of ploop from the impact statement.

I would make 1 change to the impact statement: I no longer believe ploop is affected, although I still haven't tested it and I'm not going to. So affected setups are:
\* filesystem + use\_cow\_images = False
\* LVM
\* RBD
I would remove mention of ploop from the impact statement.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-11: |  |  | [#32](/nova/%2Bbug/1524274/comments/32) |
| --- | --- | --- | --- |

> I think sahid was working on some backports. How do the tests look?

All patches are passing tests.

If patches are acked by monday morning I could to propose them backported for liberty, kilo, juno, icehouse by end of day.

> I think sahid was working on some backports. How do the tests look?
All patches are passing tests.
If patches are acked by monday morning I could to propose them backported for liberty, kilo, juno, icehouse by end of day.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nikola Đipanov (ndipanov)](https://launchpad.net/~ndipanov) wrote on 2015-12-11: |  |  | [#33](/nova/%2Bbug/1524274/comments/33) |
| --- | --- | --- | --- |

Actually come to think of it we could use the same trick for patch #3 qemu-img info call - but seeing that there are more call sites, and it's not as critical, we can do that in a separate patch(es)

Actually come to think of it we could use the same trick for patch #3 qemu-img info call - but seeing that there are more call sites, and it's not as critical, we can do that in a separate patch(es)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-11: |  |  | [#34](/nova/%2Bbug/1524274/comments/34) |
| --- | --- | --- | --- |

* [0002-Fix-format-conversion-in-libvirt-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533286/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533286)
  (7.4 KiB,
  text/plain)

This is an updated patch #2, as per nikola's comments.

This is an updated patch #2, as per nikola's comments.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-12-11

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-12-11

| **summary**: | Unprivileged api user can access host data using instance snapshot+ (2015-7548) |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-12-11

| **summary**: | Unprivileged api user can access host data using instance snapshot- (2015-7548)+ (CVE-2015-7548) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-14:  [**Re: Unprivileged api user can access host data using instance snapshot (CVE-2015-7548)**](/nova/%2Bbug/1524274/comments/35) |  |  | [#35](/nova/%2Bbug/1524274/comments/35) |
| --- | --- | --- | --- |

* [stable/liberty (1)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534475/%2Bfiles/0001-Fix-format-detection-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534475)
  (10.5 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-14: |  |  | [#36](/nova/%2Bbug/1524274/comments/36) |
| --- | --- | --- | --- |

* [stable/liberty (2)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534476/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534476)
  (7.4 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-14: |  |  | [#37](/nova/%2Bbug/1524274/comments/37) |
| --- | --- | --- | --- |

* [stable/liberty (3)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534477/%2Bfiles/0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534477)
  (7.6 KiB,
  text/plain)

stable/liberty (1, 2, 3) are backports, please take time to review them. Thanks.

stable/liberty (1, 2, 3) are backports, please take time to review them. Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-14: |  |  | [#38](/nova/%2Bbug/1524274/comments/38) |
| --- | --- | --- | --- |

* [stable/kilo (1)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534478/%2Bfiles/0001-Fix-format-detection-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534478)
  (10.3 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-14: |  |  | [#39](/nova/%2Bbug/1524274/comments/39) |
| --- | --- | --- | --- |

* [stable/kilo (2)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534479/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534479)
  (7.4 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sahid Orentino (sahid-ferdjaoui)](https://launchpad.net/~sahid-ferdjaoui) wrote on 2015-12-14: |  |  | [#40](/nova/%2Bbug/1524274/comments/40) |
| --- | --- | --- | --- |

* [stable/kilo (3)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534480/%2Bfiles/0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534480)
  (7.7 KiB,
  text/plain)

stable/kilo (1, 2, 3) are backports please take time to review them. Thanks

stable/kilo (1, 2, 3) are backports please take time to review them. Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-14: |  |  | [#41](/nova/%2Bbug/1524274/comments/41) |
| --- | --- | --- | --- |

Backports look good to me. I've inspected them, and run pep8 and unit tests against all of them individually (kilo and liberty). I haven't tested them in a complete working system, though, or run tempest against them.

The only comment I would make is that ideally the cherry-pick line would either refer to an actual upstream commit, or be omitted. Right now it refers to something in your local tree. It might be simpler just to omit it, or to frig the commit messages after it actually lands on upstream master. However, this is a minor point, and shouldn't hold anything up.

Backports look good to me. I've inspected them, and run pep8 and unit tests against all of them individually (kilo and liberty). I haven't tested them in a complete working system, though, or run tempest against them.
The only comment I would make is that ideally the cherry-pick line would either refer to an actual upstream commit, or be omitted. Right now it refers to something in your local tree. It might be simpler just to omit it, or to frig the commit messages after it actually lands on upstream master. However, this is a minor point, and shouldn't hold anything up.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Booth (mbooth-9)](https://launchpad.net/~mbooth-9) wrote on 2015-12-14: |  |  | [#42](/nova/%2Bbug/1524274/comments/42) |
| --- | --- | --- | --- |

Taking into account the upcoming holiday period, we would like to propose an embargoed disclosure date of Monday 4th January, with a public disclosure date of Thursday 7th January. Does that suit?

Taking into account the upcoming holiday period, we would like to propose an embargoed disclosure date of Monday 4th January, with a public disclosure date of Thursday 7th January. Does that suit?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-12-14: |  |  | [#43](/nova/%2Bbug/1524274/comments/43) |
| --- | --- | --- | --- |

I'm okay with the bug reporter requesting a delay in disclosure. Under the current calendar circumstances, this seems like a reasonable timeline.

I'm okay with the bug reporter requesting a delay in disclosure. Under the current calendar circumstances, this seems like a reasonable timeline.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-01-04

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-01-07

| **information type**: | Private Security → Public Security |
| --- | --- |
| **summary**: | - Unprivileged api user can access host data using instance snapshot- (CVE-2015-7548)+ [OSSA 2016-001] Unprivileged api user can access host data using+ instance snapshot (CVE-2015-7548) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07:  [**Fix proposed to nova (master)**](/nova/%2Bbug/1524274/comments/44) |  |  | [#44](/nova/%2Bbug/1524274/comments/44) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/264812>

Fix proposed to branch: master
Review: https://review.openstack.org/264812

| Changed in nova: | |
| --- | --- |
| **status**: | New → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07: |  |  | [#45](/nova/%2Bbug/1524274/comments/45) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/264813>

Fix proposed to branch: master
Review: https://review.openstack.org/264813

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07: |  |  | [#46](/nova/%2Bbug/1524274/comments/46) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/264814>

Fix proposed to branch: master
Review: https://review.openstack.org/264814

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07:  [**Fix proposed to nova (stable/liberty)**](/nova/%2Bbug/1524274/comments/47) |  |  | [#47](/nova/%2Bbug/1524274/comments/47) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/264815>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/264815

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07: |  |  | [#48](/nova/%2Bbug/1524274/comments/48) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/264816>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/264816

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07: |  |  | [#49](/nova/%2Bbug/1524274/comments/49) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/264817>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/264817

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07:  [**Fix proposed to nova (stable/kilo)**](/nova/%2Bbug/1524274/comments/50) |  |  | [#50](/nova/%2Bbug/1524274/comments/50) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/264819>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/264819

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07: |  |  | [#51](/nova/%2Bbug/1524274/comments/51) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/264820>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/264820

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-07: |  |  | [#52](/nova/%2Bbug/1524274/comments/52) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/264821>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/264821

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-01-07

| Changed in ossa: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-08:  [**Fix merged to nova (master)**](/nova/%2Bbug/1524274/comments/53) |  |  | [#53](/nova/%2Bbug/1524274/comments/53) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264812>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=2bb6635a21e4f7abe386c01ec7d3af5480498f14>

Submitter: Jenkins

Branch: master

commit 2bb6635a21e4f7abe386c01ec7d3af5480498f14

Author: Matthew Booth <email address hidden>

Date: Wed Dec 9 15:36:32 2015 +0000

Fix format detection in libvirt snapshot

The libvirt driver was using automatic format detection during

    snapshot for disks stored on the local filesystem. This opened an

    exploit if nova was configured to use local file storage, and

    additionally to store those files in raw format by specifying

    use\_cow\_images = False in nova.conf. An authenticated user could write

    a qcow2 header to their guest image with a backing file on the host.

    libvirt.utils.get\_disk\_type() would then misdetect the type of this

    image as qcow2 and pass this to the Qcow2 image backend, whose

    snapshot\_extract method interprets the image as qcow2 and writes the

    backing file to glance. The authenticated user can then download the

    host file from glance.

This patch makes 2 principal changes. libvirt.utils.get\_disk\_type,

    which ought to be removed entirely as soon as possible, is updated to

    no longer do format detection if the format can't be determined from

    the path. Its name is changed to get\_disk\_type\_from\_path to reflect

    its actual function.

libvirt.utils.find\_disk is updated to return both the path and format

    of the root disk, rather than just the path. This is the most reliable

    source of this information, as it reflects the actual format in use.

    The previous format detection function of get\_disk\_type is replaced by

    the format taken from libvirt.

We replace a call to get\_disk\_type in \_rebase\_with\_qemu\_img with an

    explicit call to qemu\_img\_info, as the other behaviour of

    get\_disk\_type was not relevant in this context. qemu\_img\_info is safe

    from the backing file exploit when called on a file known to be a

    qcow2 image. As the file in this context is a volume snapshot, this is

    a safe use.

Partial-Bug: #1524274

Change-Id: I94c1c0d26215c061f71c3f95e1a6bf3a58fa19ea

Reviewed: https://review.openstack.org/264812
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=2bb6635a21e4f7abe386c01ec7d3af5480498f14
Submitter: Jenkins
Branch: master
commit 2bb6635a21e4f7abe386c01ec7d3af5480498f14
Author: Matthew Booth <mbooth@redhat.com>
Date: Wed Dec 9 15:36:32 2015 +0000
Fix format detection in libvirt snapshot
The libvirt driver was using automatic format detection during
snapshot for disks stored on the local filesystem. This opened an
exploit if nova was configured to use local file storage, and
additionally to store those files in raw format by specifying
use\_cow\_images = False in nova.conf. An authenticated user could write
a qcow2 header to their guest image with a backing file on the host.
libvirt.utils.get\_disk\_type() would then misdetect the type of this
image as qcow2 and pass this to the Qcow2 image backend, whose
snapshot\_extract method interprets the image as qcow2 and writes the
backing file to glance. The authenticated user can then download the
host file from glance.
This patch makes 2 principal changes. libvirt.utils.get\_disk\_type,
which ought to be removed entirely as soon as possible, is updated to
no longer do format detection if the format can't be determined from
the path. Its name is changed to get\_disk\_type\_from\_path to reflect
its actual function.
libvirt.utils.find\_disk is updated to return both the path and format
of the root disk, rather than just the path. This is the most reliable
source of this information, as it reflects the actual format in use.
The previous format detection function of get\_disk\_type is replaced by
the format taken from libvirt.
We replace a call to get\_disk\_type in \_rebase\_with\_qemu\_img with an
explicit call to qemu\_img\_info, as the other behaviour of
get\_disk\_type was not relevant in this context. qemu\_img\_info is safe
from the backing file exploit when called on a file known to be a
qcow2 image. As the file in this context is a volume snapshot, this is
a safe use.
Partial-Bug: #1524274
Change-Id: I94c1c0d26215c061f71c3f95e1a6bf3a58fa19ea

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-08: |  |  | [#54](/nova/%2Bbug/1524274/comments/54) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264813>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=820430b62aa5e87a8f7750f1b9873f56c4822452>

Submitter: Jenkins

Branch: master

commit 820430b62aa5e87a8f7750f1b9873f56c4822452

Author: Matthew Booth <email address hidden>

Date: Thu Dec 10 16:34:19 2015 +0000

Fix format conversion in libvirt snapshot

The libvirt driver was calling images.convert\_image during snapshot to

    convert snapshots to the intended output format. However, this

    function does not take the input format as an argument, meaning it

    implicitly does format detection. This opened an exploit for setups

    using raw storage on the backend, including raw on filesystem, LVM,

    and RBD (Ceph). An authenticated user could write a qcow2 header to

    their instance's disk which specified an arbitrary backing file on the

    host. When convert\_image ran during snapshot, this would then write

    the contents of the backing file to glance, which is then available to

    the user. If the setup uses an LVM backend this conversion runs as

    root, meaning the user can exfiltrate any file on the host, including

    raw disks.

This change adds an input format to convert\_image.

Partial-Bug: #1524274

Change-Id: If73e73718ecd5db262ed9904091024238f98dbc0

Reviewed: https://review.openstack.org/264813
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=820430b62aa5e87a8f7750f1b9873f56c4822452
Submitter: Jenkins
Branch: master
commit 820430b62aa5e87a8f7750f1b9873f56c4822452
Author: Matthew Booth <mbooth@redhat.com>
Date: Thu Dec 10 16:34:19 2015 +0000
Fix format conversion in libvirt snapshot
The libvirt driver was calling images.convert\_image during snapshot to
convert snapshots to the intended output format. However, this
function does not take the input format as an argument, meaning it
implicitly does format detection. This opened an exploit for setups
using raw storage on the backend, including raw on filesystem, LVM,
and RBD (Ceph). An authenticated user could write a qcow2 header to
their instance's disk which specified an arbitrary backing file on the
host. When convert\_image ran during snapshot, this would then write
the contents of the backing file to glance, which is then available to
the user. If the setup uses an LVM backend this conversion runs as
root, meaning the user can exfiltrate any file on the host, including
raw disks.
This change adds an input format to convert\_image.
Partial-Bug: #1524274
Change-Id: If73e73718ecd5db262ed9904091024238f98dbc0

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-13:  [**Related fix proposed to nova (stable/liberty)**](/nova/%2Bbug/1524274/comments/55) |  |  | [#55](/nova/%2Bbug/1524274/comments/55) |
| --- | --- | --- | --- |

Related fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/267178>

Related fix proposed to branch: stable/liberty
Review: https://review.openstack.org/267178

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-14:  [**Fix merged to nova (stable/liberty)**](/nova/%2Bbug/1524274/comments/56) |  |  | [#56](/nova/%2Bbug/1524274/comments/56) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264815>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=cd4eeead3d70719f04d940af7da608eec81ab4e8>

Submitter: Jenkins

Branch: stable/liberty

commit cd4eeead3d70719f04d940af7da608eec81ab4e8

Author: Matthew Booth <email address hidden>

Date: Wed Dec 9 15:36:32 2015 +0000

Fix format detection in libvirt snapshot

The libvirt driver was using automatic format detection during

    snapshot for disks stored on the local filesystem. This opened an

    exploit if nova was configured to use local file storage, and

    additionally to store those files in raw format by specifying

    use\_cow\_images = False in nova.conf. An authenticated user could write

    a qcow2 header to their guest image with a backing file on the host.

    libvirt.utils.get\_disk\_type() would then misdetect the type of this

    image as qcow2 and pass this to the Qcow2 image backend, whose

    snapshot\_extract method interprets the image as qcow2 and writes the

    backing file to glance. The authenticated user can then download the

    host file from glance.

This patch makes 2 principal changes. libvirt.utils.get\_disk\_type,

    which ought to be removed entirely as soon as possible, is updated to

    no longer do format detection if the format can't be determined from

    the path. Its name is changed to get\_disk\_type\_from\_path to reflect

    its actual function.

libvirt.utils.find\_disk is updated to return both the path and format

    of the root disk, rather than just the path. This is the most reliable

    source of this information, as it reflects the actual format in use.

    The previous format detection function of get\_disk\_type is replaced by

    the format taken from libvirt.

We replace a call to get\_disk\_type in \_rebase\_with\_qemu\_img with an

    explicit call to qemu\_img\_info, as the other behaviour of

    get\_disk\_type was not relevant in this context. qemu\_img\_info is safe

    from the backing file exploit when called on a file known to be a

    qcow2 image. As the file in this context is a volume snapshot, this is

    a safe use.

Partial-Bug: #1524274

(cherry picked from commit 2bb6635a21e4f7abe386c01ec7d3af5480498f14)

Conflicts:

        nova/tests/unit/virt/libvirt/test\_utils.py

        nova/virt/libvirt/utils.py

Minor conflicts as ploop was added in Mitaka.

Change-Id: I94c1c0d26215c061f71c3f95e1a6bf3a58fa19ea

Reviewed: https://review.openstack.org/264815
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=cd4eeead3d70719f04d940af7da608eec81ab4e8
Submitter: Jenkins
Branch: stable/liberty
commit cd4eeead3d70719f04d940af7da608eec81ab4e8
Author: Matthew Booth <mbooth@redhat.com>
Date: Wed Dec 9 15:36:32 2015 +0000
Fix format detection in libvirt snapshot
The libvirt driver was using automatic format detection during
snapshot for disks stored on the local filesystem. This opened an
exploit if nova was configured to use local file storage, and
additionally to store those files in raw format by specifying
use\_cow\_images = False in nova.conf. An authenticated user could write
a qcow2 header to their guest image with a backing file on the host.
libvirt.utils.get\_disk\_type() would then misdetect the type of this
image as qcow2 and pass this to the Qcow2 image backend, whose
snapshot\_extract method interprets the image as qcow2 and writes the
backing file to glance. The authenticated user can then download the
host file from glance.
This patch makes 2 principal changes. libvirt.utils.get\_disk\_type,
which ought to be removed entirely as soon as possible, is updated to
no longer do format detection if the format can't be determined from
the path. Its name is changed to get\_disk\_type\_from\_path to reflect
its actual function.
libvirt.utils.find\_disk is updated to return both the path and format
of the root disk, rather than just the path. This is the most reliable
source of this information, as it reflects the actual format in use.
The previous format detection function of get\_disk\_type is replaced by
the format taken from libvirt.
We replace a call to get\_disk\_type in \_rebase\_with\_qemu\_img with an
explicit call to qemu\_img\_info, as the other behaviour of
get\_disk\_type was not relevant in this context. qemu\_img\_info is safe
from the backing file exploit when called on a file known to be a
qcow2 image. As the file in this context is a volume snapshot, this is
a safe use.
Partial-Bug: #1524274
(cherry picked from commit 2bb6635a21e4f7abe386c01ec7d3af5480498f14)
Conflicts:
nova/tests/unit/virt/libvirt/test\_utils.py
nova/virt/libvirt/utils.py
Minor conflicts as ploop was added in Mitaka.
Change-Id: I94c1c0d26215c061f71c3f95e1a6bf3a58fa19ea

| **tags**: | added: in-stable-liberty |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-14: |  |  | [#57](/nova/%2Bbug/1524274/comments/57) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264816>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=a9c8dee7ec81d6331c3699a2dda3a57b48ecfe5c>

Submitter: Jenkins

Branch: stable/liberty

commit a9c8dee7ec81d6331c3699a2dda3a57b48ecfe5c

Author: Matthew Booth <email address hidden>

Date: Thu Dec 10 16:34:19 2015 +0000

Fix format conversion in libvirt snapshot

The libvirt driver was calling images.convert\_image during snapshot to

    convert snapshots to the intended output format. However, this

    function does not take the input format as an argument, meaning it

    implicitly does format detection. This opened an exploit for setups

    using raw storage on the backend, including raw on filesystem, LVM,

    and RBD (Ceph). An authenticated user could write a qcow2 header to

    their instance's disk which specified an arbitrary backing file on the

    host. When convert\_image ran during snapshot, this would then write

    the contents of the backing file to glance, which is then available to

    the user. If the setup uses an LVM backend this conversion runs as

    root, meaning the user can exfiltrate any file on the host, including

    raw disks.

This change adds an input format to convert\_image.

Partial-Bug: #1524274

(cherry picked from commit 820430b62aa5e87a8f7750f1b9873f56c4822452)

Change-Id: If73e73718ecd5db262ed9904091024238f98dbc0

Reviewed: https://review.openstack.org/264816
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=a9c8dee7ec81d6331c3699a2dda3a57b48ecfe5c
Submitter: Jenkins
Branch: stable/liberty
commit a9c8dee7ec81d6331c3699a2dda3a57b48ecfe5c
Author: Matthew Booth <mbooth@redhat.com>
Date: Thu Dec 10 16:34:19 2015 +0000
Fix format conversion in libvirt snapshot
The libvirt driver was calling images.convert\_image during snapshot to
convert snapshots to the intended output format. However, this
function does not take the input format as an argument, meaning it
implicitly does format detection. This opened an exploit for setups
using raw storage on the backend, including raw on filesystem, LVM,
and RBD (Ceph). An authenticated user could write a qcow2 header to
their instance's disk which specified an arbitrary backing file on the
host. When convert\_image ran during snapshot, this would then write
the contents of the backing file to glance, which is then available to
the user. If the setup uses an LVM backend this conversion runs as
root, meaning the user can exfiltrate any file on the host, including
raw disks.
This change adds an input format to convert\_image.
Partial-Bug: #1524274
(cherry picked from commit 820430b62aa5e87a8f7750f1b9873f56c4822452)
Change-Id: If73e73718ecd5db262ed9904091024238f98dbc0

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-14:  [**Fix merged to nova (master)**](/nova/%2Bbug/1524274/comments/58) |  |  | [#58](/nova/%2Bbug/1524274/comments/58) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264814>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=915fdbbfb82272b87cd80210943372b09351cf88>

Submitter: Jenkins

Branch: master

commit 915fdbbfb82272b87cd80210943372b09351cf88

Author: Matthew Booth <email address hidden>

Date: Fri Dec 11 13:40:54 2015 +0000

Fix backing file detection in libvirt live snapshot

When doing a live snapshot, the libvirt driver creates an intermediate

    qcow2 file with the same backing file as the original disk. However,

    it calls qemu-img info without specifying the input format explicitly.

    An authenticated user can write data to a raw disk which will cause

    this code to misinterpret the disk as a qcow2 file with a

    user-specified backing file on the host, and return an arbitrary host

    file as the backing file.

This bug does not appear to result in a data leak in this case, but

    this is hard to verify. It certainly results in corrupt output.

Closes-Bug: #1524274

Change-Id: I11485f077d28f4e97529a691e55e3e3c0bea8872

Reviewed: https://review.openstack.org/264814
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=915fdbbfb82272b87cd80210943372b09351cf88
Submitter: Jenkins
Branch: master
commit 915fdbbfb82272b87cd80210943372b09351cf88
Author: Matthew Booth <mbooth@redhat.com>
Date: Fri Dec 11 13:40:54 2015 +0000
Fix backing file detection in libvirt live snapshot
When doing a live snapshot, the libvirt driver creates an intermediate
qcow2 file with the same backing file as the original disk. However,
it calls qemu-img info without specifying the input format explicitly.
An authenticated user can write data to a raw disk which will cause
this code to misinterpret the disk as a qcow2 file with a
user-specified backing file on the host, and return an arbitrary host
file as the backing file.
This bug does not appear to result in a data leak in this case, but
this is hard to verify. It certainly results in corrupt output.
Closes-Bug: #1524274
Change-Id: I11485f077d28f4e97529a691e55e3e3c0bea8872

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-15:  [**Fix merged to nova (stable/liberty)**](/nova/%2Bbug/1524274/comments/59) |  |  | [#59](/nova/%2Bbug/1524274/comments/59) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264817>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=c9c0b1b4b5acc1ea3c2bbb694aa79d7e4a7087e3>

Submitter: Jenkins

Branch: stable/liberty

commit c9c0b1b4b5acc1ea3c2bbb694aa79d7e4a7087e3

Author: Matthew Booth <email address hidden>

Date: Fri Dec 11 13:40:54 2015 +0000

Fix backing file detection in libvirt live snapshot

When doing a live snapshot, the libvirt driver creates an intermediate

    qcow2 file with the same backing file as the original disk. However,

    it calls qemu-img info without specifying the input format explicitly.

    An authenticated user can write data to a raw disk which will cause

    this code to misinterpret the disk as a qcow2 file with a

    user-specified backing file on the host, and return an arbitrary host

    file as the backing file.

This bug does not appear to result in a data leak in this case, but

    this is hard to verify. It certainly results in corrupt output.

Closes-Bug: #1524274

(cherry picked from commit 915fdbbfb82272b87cd80210943372b09351cf88)

Conflicts:

        nova/virt/images.py

Liberty does not catch processutils.ProcessExecutionError in

    qemu\_img\_info.

Change-Id: I11485f077d28f4e97529a691e55e3e3c0bea8872

Reviewed: https://review.openstack.org/264817
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=c9c0b1b4b5acc1ea3c2bbb694aa79d7e4a7087e3
Submitter: Jenkins
Branch: stable/liberty
commit c9c0b1b4b5acc1ea3c2bbb694aa79d7e4a7087e3
Author: Matthew Booth <mbooth@redhat.com>
Date: Fri Dec 11 13:40:54 2015 +0000
Fix backing file detection in libvirt live snapshot
When doing a live snapshot, the libvirt driver creates an intermediate
qcow2 file with the same backing file as the original disk. However,
it calls qemu-img info without specifying the input format explicitly.
An authenticated user can write data to a raw disk which will cause
this code to misinterpret the disk as a qcow2 file with a
user-specified backing file on the host, and return an arbitrary host
file as the backing file.
This bug does not appear to result in a data leak in this case, but
this is hard to verify. It certainly results in corrupt output.
Closes-Bug: #1524274
(cherry picked from commit 915fdbbfb82272b87cd80210943372b09351cf88)
Conflicts:
nova/virt/images.py
Liberty does not catch processutils.ProcessExecutionError in
qemu\_img\_info.
Change-Id: I11485f077d28f4e97529a691e55e3e3c0bea8872

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-15:  [**Related fix merged to nova (stable/liberty)**](/nova/%2Bbug/1524274/comments/60) |  |  | [#60](/nova/%2Bbug/1524274/comments/60) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/267178>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=b2acc9fa864b6fe10bc0c5f3786b976b472b1b27>

Submitter: Jenkins

Branch: stable/liberty

commit b2acc9fa864b6fe10bc0c5f3786b976b472b1b27

Author: Matt Riedemann <email address hidden>

Date: Wed Jan 13 09:41:57 2016 -0800

Add security fixes to the release notes for 12.0.1

There are two security fixes in the upcoming stable/liberty

    point release (12.0.1) so we should document those in the

    release notes.

This shouldn't be merged until I11485f077d28f4e97529a691e55e3e3c0bea8872

    is merged. We don't use Depends-On here since we don't want to hold this

    up on the stable/kilo backport of that change.

Change-Id: Ib2235d6aee540d9010dc86c73aff71179d46e921

    Related-Bug: #1516765

    Related-Bug: #1524274

Reviewed: https://review.openstack.org/267178
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=b2acc9fa864b6fe10bc0c5f3786b976b472b1b27
Submitter: Jenkins
Branch: stable/liberty
commit b2acc9fa864b6fe10bc0c5f3786b976b472b1b27
Author: Matt Riedemann <mriedem@us.ibm.com>
Date: Wed Jan 13 09:41:57 2016 -0800
Add security fixes to the release notes for 12.0.1
There are two security fixes in the upcoming stable/liberty
point release (12.0.1) so we should document those in the
release notes.
This shouldn't be merged until I11485f077d28f4e97529a691e55e3e3c0bea8872
is merged. We don't use Depends-On here since we don't want to hold this
up on the stable/kilo backport of that change.
Change-Id: Ib2235d6aee540d9010dc86c73aff71179d46e921
Related-Bug: #1516765
Related-Bug: #1524274

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-16:  [**Fix merged to nova (stable/kilo)**](/nova/%2Bbug/1524274/comments/61) |  |  | [#61](/nova/%2Bbug/1524274/comments/61) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264819>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=7534182e7f1ae466f96fdb13d3715a458f300604>

Submitter: Jenkins

Branch: stable/kilo

commit 7534182e7f1ae466f96fdb13d3715a458f300604

Author: Matthew Booth <email address hidden>

Date: Wed Dec 9 15:36:32 2015 +0000

Fix format detection in libvirt snapshot

The libvirt driver was using automatic format detection during

    snapshot for disks stored on the local filesystem. This opened an

    exploit if nova was configured to use local file storage, and

    additionally to store those files in raw format by specifying

    use\_cow\_images = False in nova.conf. An authenticated user could write

    a qcow2 header to their guest image with a backing file on the host.

    libvirt.utils.get\_disk\_type() would then misdetect the type of this

    image as qcow2 and pass this to the Qcow2 image backend, whose

    snapshot\_extract method interprets the image as qcow2 and writes the

    backing file to glance. The authenticated user can then download the

    host file from glance.

This patch makes 2 principal changes. libvirt.utils.get\_disk\_type,

    which ought to be removed entirely as soon as possible, is updated to

    no longer do format detection if the format can't be determined from

    the path. Its name is changed to get\_disk\_type\_from\_path to reflect

    its actual function.

libvirt.utils.find\_disk is updated to return both the path and format

    of the root disk, rather than just the path. This is the most reliable

    source of this information, as it reflects the actual format in use.

    The previous format detection function of get\_disk\_type is replaced by

    the format taken from libvirt.

We replace a call to get\_disk\_type in \_rebase\_with\_qemu\_img with an

    explicit call to qemu\_img\_info, as the other behaviour of

    get\_disk\_type was not relevant in this context. qemu\_img\_info is safe

    from the backing file exploit when called on a file known to be a

    qcow2 image. As the file in this context is a volume snapshot, this is

    a safe use.

Partial-Bug: #1524274

Conflicts:

        nova/tests/unit/virt/libvirt/test\_driver.py

        nova/tests/unit/virt/libvirt/test\_utils.py

        nova/virt/libvirt/driver.py

        nova/virt/libvirt/utils.py

Change-Id: I94c1c0d26215c061f71c3f95e1a6bf3a58fa19ea

Reviewed: https://review.openstack.org/264819
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=7534182e7f1ae466f96fdb13d3715a458f300604
Submitter: Jenkins
Branch: stable/kilo
commit 7534182e7f1ae466f96fdb13d3715a458f300604
Author: Matthew Booth <mbooth@redhat.com>
Date: Wed Dec 9 15:36:32 2015 +0000
Fix format detection in libvirt snapshot
The libvirt driver was using automatic format detection during
snapshot for disks stored on the local filesystem. This opened an
exploit if nova was configured to use local file storage, and
additionally to store those files in raw format by specifying
use\_cow\_images = False in nova.conf. An authenticated user could write
a qcow2 header to their guest image with a backing file on the host.
libvirt.utils.get\_disk\_type() would then misdetect the type of this
image as qcow2 and pass this to the Qcow2 image backend, whose
snapshot\_extract method interprets the image as qcow2 and writes the
backing file to glance. The authenticated user can then download the
host file from glance.
This patch makes 2 principal changes. libvirt.utils.get\_disk\_type,
which ought to be removed entirely as soon as possible, is updated to
no longer do format detection if the format can't be determined from
the path. Its name is changed to get\_disk\_type\_from\_path to reflect
its actual function.
libvirt.utils.find\_disk is updated to return both the path and format
of the root disk, rather than just the path. This is the most reliable
source of this information, as it reflects the actual format in use.
The previous format detection function of get\_disk\_type is replaced by
the format taken from libvirt.
We replace a call to get\_disk\_type in \_rebase\_with\_qemu\_img with an
explicit call to qemu\_img\_info, as the other behaviour of
get\_disk\_type was not relevant in this context. qemu\_img\_info is safe
from the backing file exploit when called on a file known to be a
qcow2 image. As the file in this context is a volume snapshot, this is
a safe use.
Partial-Bug: #1524274
Conflicts:
nova/tests/unit/virt/libvirt/test\_driver.py
nova/tests/unit/virt/libvirt/test\_utils.py
nova/virt/libvirt/driver.py
nova/virt/libvirt/utils.py
Change-Id: I94c1c0d26215c061f71c3f95e1a6bf3a58fa19ea

| **tags**: | added: in-stable-kilo |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-16: |  |  | [#62](/nova/%2Bbug/1524274/comments/62) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264820>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=3bc1295e2d5fb1376e3a5c708efe9fbf9435e6a4>

Submitter: Jenkins

Branch: stable/kilo

commit 3bc1295e2d5fb1376e3a5c708efe9fbf9435e6a4

Author: Matthew Booth <email address hidden>

Date: Thu Dec 10 16:34:19 2015 +0000

Fix format conversion in libvirt snapshot

The libvirt driver was calling images.convert\_image during snapshot to

    convert snapshots to the intended output format. However, this

    function does not take the input format as an argument, meaning it

    implicitly does format detection. This opened an exploit for setups

    using raw storage on the backend, including raw on filesystem, LVM,

    and RBD (Ceph). An authenticated user could write a qcow2 header to

    their instance's disk which specified an arbitrary backing file on the

    host. When convert\_image ran during snapshot, this would then write

    the contents of the backing file to glance, which is then available to

    the user. If the setup uses an LVM backend this conversion runs as

    root, meaning the user can exfiltrate any file on the host, including

    raw disks.

This change adds an input format to convert\_image.

Partial-Bug: #1524274

Change-Id: If73e73718ecd5db262ed9904091024238f98dbc0

Reviewed: https://review.openstack.org/264820
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=3bc1295e2d5fb1376e3a5c708efe9fbf9435e6a4
Submitter: Jenkins
Branch: stable/kilo
commit 3bc1295e2d5fb1376e3a5c708efe9fbf9435e6a4
Author: Matthew Booth <mbooth@redhat.com>
Date: Thu Dec 10 16:34:19 2015 +0000
Fix format conversion in libvirt snapshot
The libvirt driver was calling images.convert\_image during snapshot to
convert snapshots to the intended output format. However, this
function does not take the input format as an argument, meaning it
implicitly does format detection. This opened an exploit for setups
using raw storage on the backend, including raw on filesystem, LVM,
and RBD (Ceph). An authenticated user could write a qcow2 header to
their instance's disk which specified an arbitrary backing file on the
host. When convert\_image ran during snapshot, this would then write
the contents of the backing file to glance, which is then available to
the user. If the setup uses an LVM backend this conversion runs as
root, meaning the user can exfiltrate any file on the host, including
raw disks.
This change adds an input format to convert\_image.
Partial-Bug: #1524274
Change-Id: If73e73718ecd5db262ed9904091024238f98dbc0

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-01-16: |  |  | [#63](/nova/%2Bbug/1524274/comments/63) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/264821>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=b974c6d1d5753f333d1d71f8190ddf3b4f8fbbf1>

Submitter: Jenkins

Branch: stable/kilo

commit b974c6d1d5753f333d1d71f8190ddf3b4f8fbbf1

Author: Matthew Booth <email address hidden>

Date: Fri Dec 11 13:40:54 2015 +0000

Fix backing file detection in libvirt live snapshot

When doing a live snapshot, the libvirt driver creates an intermediate

    qcow2 file with the same backing file as the original disk. However,

    it calls qemu-img info without specifying the input format explicitly.

    An authenticated user can write data to a raw disk which will cause

    this code to misinterpret the disk as a qcow2 file with a

    user-specified backing file on the host, and return an arbitrary host

    file as the backing file.

This bug does not appear to result in a data leak in this case, but

    this is hard to verify. It certainly results in corrupt output.

Closes-Bug: #1524274

Change-Id: I11485f077d28f4e97529a691e55e3e3c0bea8872

Reviewed: https://review.openstack.org/264821
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=b974c6d1d5753f333d1d71f8190ddf3b4f8fbbf1
Submitter: Jenkins
Branch: stable/kilo
commit b974c6d1d5753f333d1d71f8190ddf3b4f8fbbf1
Author: Matthew Booth <mbooth@redhat.com>
Date: Fri Dec 11 13:40:54 2015 +0000
Fix backing file detection in libvirt live snapshot
When doing a live snapshot, the libvirt driver creates an intermediate
qcow2 file with the same backing file as the original disk. However,
it calls qemu-img info without specifying the input format explicitly.
An authenticated user can write data to a raw disk which will cause
this code to misinterpret the disk as a qcow2 file with a
user-specified backing file on the host, and return an arbitrary host
file as the backing file.
This bug does not appear to result in a data leak in this case, but
this is hard to verify. It certainly results in corrupt output.
Closes-Bug: #1524274
Change-Id: I11485f077d28f4e97529a691e55e3e3c0bea8872

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-01-19:  [**Fix included in openstack/nova 12.0.1**](/nova/%2Bbug/1524274/comments/64) |  |  | [#64](/nova/%2Bbug/1524274/comments/64) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/nova 12.0.1 release.

This issue was fixed in the openstack/nova 12.0.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2016-01-21:  [**Fix included in openstack/nova 13.0.0.0b2**](/nova/%2Bbug/1524274/comments/65) |  |  | [#65](/nova/%2Bbug/1524274/comments/65) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/nova 13.0.0.0b2 development milestone.

This issue was fixed in the openstack/nova 13.0.0.0b2 development milestone.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-10:  [**Related fix proposed to nova (master)**](/nova/%2Bbug/1524274/comments/66) |  |  | [#66](/nova/%2Bbug/1524274/comments/66) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/291208>

Related fix proposed to branch: master
Review: https://review.openstack.org/291208

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-10:  [**Related fix merged to nova (master)**](/nova/%2Bbug/1524274/comments/67) |  |  | [#67](/nova/%2Bbug/1524274/comments/67) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/291208>

Committed: <https://git.openstack.org/cgit/openstack/nova/commit/?id=9c0bbda07fdcf134308371644d09becbb18c62b1>

Submitter: Jenkins

Branch: master

commit 9c0bbda07fdcf134308371644d09becbb18c62b1

Author: Matt Riedemann <email address hidden>

Date: Thu Mar 10 09:35:00 2016 -0500

Add release notes for security fixes in 13.0.0 mitaka GA

There are three security issues fixed in mitaka.

The first two were documented for liberty 12.0.1 but we

    apparently forgot to doc them for mitaka.

Related-Bug: #1524274

    Related-Bug: #1516765

    Related-Bug: #1548450

Change-Id: I3eba75f1fc86c4c9abd258042dfafc6df1f2405c

Reviewed: https://review.openstack.org/291208
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=9c0bbda07fdcf134308371644d09becbb18c62b1
Submitter: Jenkins
Branch: master
commit 9c0bbda07fdcf134308371644d09becbb18c62b1
Author: Matt Riedemann <mriedem@us.ibm.com>
Date: Thu Mar 10 09:35:00 2016 -0500
Add release notes for security fixes in 13.0.0 mitaka GA
There are three security issues fixed in mitaka.
The first two were documented for liberty 12.0.1 but we
apparently forgot to doc them for mitaka.
Related-Bug: #1524274
Related-Bug: #1516765
Related-Bug: #1548450
Change-Id: I3eba75f1fc86c4c9abd258042dfafc6df1f2405c

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hao Jun Wang (shhjwang)](https://launchpad.net/~shhjwang) wrote on 2016-06-28: |  |  | [#68](/nova/%2Bbug/1524274/comments/68) |
| --- | --- | --- | --- |

I am sorry that I am not clear reproducing process. Anyone can help me? Thanks.

I have set use\_cow\_images = False in nova.conf and restarted services.

Then I executed the steps in the description and file "passwd" generated.

As the description says, the contents of /etc/passwd should be in the passwd file. Since the passwd file is a binary file, I tried to use "grep" to search the contents of /etc/passwd in passwd file. But I found nothing. And I also tried "grep" command on bad.qcow2. Also nothing was found. In the instance, I executed "sudo strings /dev/vda | head -1" and it shows "/etc/passwd". So the "dd" operation should have worked. But I don't know how can I show the contents of "/etc/passwd" in downloaded passwd file.

Anyone has some advice? Thanks very much.

I am sorry that I am not clear reproducing process. Anyone can help me? Thanks.
I have set use\_cow\_images = False in nova.conf and restarted services.
Then I executed the steps in the description and file "passwd" generated.
As the description says, the contents of /etc/passwd should be in the passwd file. Since the passwd file is a binary file, I tried to use "grep" to search the contents of /etc/passwd in passwd file. But I found nothing. And I also tried "grep" command on bad.qcow2. Also nothing was found. In the instance, I executed "sudo strings /dev/vda | head -1" and it shows "/etc/passwd". So the "dd" operation should have worked. But I don't know how can I show the contents of "/etc/passwd" in downloaded passwd file.
Anyone has some advice? Thanks very much.

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2020-02-27

| **description**: | updated |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1524274/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-All-the-things.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4532036/%2Bfiles/0001-All-the-things.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4532036 "Change patch details")
* [Fix for convert\_image bug](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4532695/%2Bfiles/0001-More-things.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4532695 "Change patch details")
* [0001-Fix-format-detection-in-libvirt-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533238/%2Bfiles/0001-Fix-format-detection-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533238 "Change patch details")
* [0002-Fix-format-conversion-in-libvirt-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533239/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533239 "Change patch details")
* [0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533240/%2Bfiles/0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533240 "Change patch details")
* [0002-Fix-format-conversion-in-libvirt-snapshot.patch](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4533286/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4533286 "Change patch details")
* [stable/liberty (1)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534475/%2Bfiles/0001-Fix-format-detection-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534475 "Change patch details")
* [stable/liberty (2)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534476/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534476 "Change patch details")
* [stable/liberty (3)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534477/%2Bfiles/0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534477 "Change patch details")
* [stable/kilo (1)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534478/%2Bfiles/0001-Fix-format-detection-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534478 "Change patch details")
* [stable/kilo (2)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534479/%2Bfiles/0002-Fix-format-conversion-in-libvirt-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534479 "Change patch details")
* [stable/kilo (3)](https://bugs.launchpad.net/nova/%2Bbug/1524274/%2Battachment/4534480/%2Bfiles/0003-Fix-backing-file-detection-in-libvirt-live-snapshot.patch)
  [Edit](/nova/%2Bbug/1524274/%2Battachment/4534480 "Change patch details")

* [Add patch](/nova/%2Bbug/1524274/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from security.openstack.org_eac0d64c_20250124_191024.html ===


Toggle navigation

 Search

* [Software](https://www.openstack.org/software/)
  + [Overview](https://www.openstack.org/software/)
  + [OpenStack Components](https://www.openstack.org/software/project-navigator/openstack-components)
  + [SDKs](https://www.openstack.org/software/project-navigator/sdks)
  + [Deployment Tools](https://www.openstack.org/software/project-navigator/deployment-tools)
  + [OpenStack Map](https://www.openstack.org/assets/software/projectmap/openstack-map.pdf)
  + [Sample Configs](https://www.openstack.org/software/sample-configs/)
* [Use Cases](https://www.openstack.org/use-cases/)
  + [Users in Production](https://www.openstack.org/use-cases/)
  + [Ironic Bare Metal](https://www.openstack.org/use-cases/bare-metal/)
  + [Edge Computing](https://www.openstack.org/use-cases/edge-computing/)
  + [Telecom & NFV](https://www.openstack.org/use-cases/telecoms-and-nfv/)
  + [Science and HPC](https://www.openstack.org/use-cases/science/)
  + [Containers](https://www.openstack.org/use-cases/containers/)
  + [Enterprise](https://www.openstack.org/use-cases/enterprise/)
  + [User Survey](https://www.openstack.org/surveys/landing)
* [Events](https://openinfra.dev/summit)
  + [OpenInfra Summit](https://openinfra.dev/summit)
  + [Project Teams Gathering](https://www.openstack.org/ptg/)
  + [OpenDev](https://www.openstack.org/events/opendev-2020/)
  + [Community Events](https://www.openstack.org/events/community-events/)
  + [OpenStack & OpenInfra Days](https://www.openstack.org/events/openstackdays)
  + [Summit Videos](https://www.openstack.org/videos/)
* [Community](https://www.openstack.org/community/)
  + [Welcome! Start Here](https://www.openstack.org/community/)
  + [OpenStack Technical Committee](https://www.openstack.org/community/tech-committee)
  + [Speakers Bureau](https://www.openstack.org/community/speakers/)
  + [OpenStack Wiki](http://wiki.openstack.org)
  + [Get Certified (COA)](https://www.openstack.org/coa/)
  + [Jobs](https://www.openstack.org/community/jobs/)
  + [Marketing Resources](https://www.openstack.org/marketing/)
  + [Community News](https://www.openstack.org/news/)
  + [Superuser Magazine](http://superuser.openstack.org)
  + [OpenInfra Foundation Supporting Organizations](https://www.openstack.org/community/supporting-organizations/)
  + [OpenInfra Foundation](https://openinfra.dev)
* [Marketplace](https://www.openstack.org/marketplace/)
  + [Training](https://www.openstack.org/marketplace/training/)
  + [Distros & Appliances](https://www.openstack.org/marketplace/distros/)
  + [Public Clouds](https://www.openstack.org/marketplace/public-clouds/)
  + [Hosted Private Clouds](https://www.openstack.org/marketplace/hosted-private-clouds/)
  + [Remotely Managed Private Clouds](https://www.openstack.org/marketplace/remotely-managed-private-clouds/)
  + [Consulting & Integrators](https://www.openstack.org/marketplace/consulting/)
  + [Drivers](https://www.openstack.org/marketplace/drivers/)
* [Blog](https://www.openstack.org/blog/)
* [Docs](http://docs.openstack.org/)
* [Join](https://openinfra.dev/join/)
  + [Sign up for Foundation Membership](https://openinfra.dev/join/)
  + [Sponsor the Foundation](https://openinfra.dev/join/)
  + [More about the Foundation](https://openinfra.dev)
* [Log In](https://www.openstack.org/Security/login/?BackURL=/home/)

# OSSA-2016-001: Nova host data leak through snapshot

# OSSA-2016-001: Nova host data leak through snapshot[Â¶](#ossa-2016-001-nova-host-data-leak-through-snapshot "Link to this heading")

Date:

January 07, 2016

CVE:

CVE-2015-7548

## Affects[Â¶](#affects "Link to this heading")

* Nova: <=2015.1.2, ==12.0.0

## Description[Â¶](#description "Link to this heading")

Matthew Booth from Red Hat reported a vulnerability in Nova instance snapshot. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host. Note that the host file needs to be readable by the nova user to be exposed except when using lvm for instance storage, when all files readable by root are exposed. Only setups using libvirt to spawn instances are vulnerable. Of these, setups which use filesystem storage, and do not set âuse\_cow\_images = Falseâ in Nova configuration are not affected. Setups which use ceph or lvm for instance storage, and setups which use filesystem storage with âuse\_cow\_images = Falseâ are all affected.

## Patches[Â¶](#patches "Link to this heading")

* <https://review.openstack.org/264819> (Kilo)
* <https://review.openstack.org/264820> (Kilo)
* <https://review.openstack.org/264821> (Kilo)
* <https://review.openstack.org/264815> (Liberty)
* <https://review.openstack.org/264816> (Liberty)
* <https://review.openstack.org/264817> (Liberty)
* <https://review.openstack.org/264812> (Mitaka)
* <https://review.openstack.org/264813> (Mitaka)
* <https://review.openstack.org/264814> (Mitaka)

## Credits[Â¶](#credits "Link to this heading")

* Matthew Booth from Red Hat (CVE-2015-7548)

## References[Â¶](#references "Link to this heading")

* <https://bugs.launchpad.net/bugs/1524274>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7548>

## Notes[Â¶](#notes "Link to this heading")

* This fix will be included in future 2015.1.3 (kilo) and 12.0.1
  (liberty) releases.

this page last updated: 2025-01-07 18:17:35

[![Creative Commons Attribution 3.0 License](../_static/images/docs/license.png)](https://creativecommons.org/licenses/by/3.0/)

Except where otherwise noted, this document is licensed under
[Creative Commons
Attribution 3.0 License](https://creativecommons.org/licenses/by/3.0/). See all [OpenStack Legal Documents](https://www.openstack.org/legal).

found an error? report a bug

OpenStack Documentation

* Guides
* [Install Guides](https://docs.openstack.org/index.html#install-guides)
* [User Guides](https://docs.openstack.org/index.html#user-guides)
* [Configuration Guides](https://docs.openstack.org/index.html#configuration-guides)
* [Operations and Administration Guides](https://docs.openstack.org/index.html#ops-and-admin-guides)
* [API Guides](https://docs.openstack.org/index.html#api-guides)
* [Contributor Guides](https://docs.openstack.org/index.html#contributor-guides)
* Languages
* [Deutsch (German)](https://docs.openstack.org/de/)
* [FranÃ§ais (French)](https://docs.openstack.org/fr/)
* [Bahasa Indonesia (Indonesian)](https://docs.openstack.org/id/)
* [Italiano (Italian)](https://docs.openstack.org/it/)
* [æ¥æ¬èª (Japanese)](https://docs.openstack.org/ja/)
* [íêµ­ì´ (Korean)](https://docs.openstack.org/ko_KR/)
* [PortuguÃªs (Portuguese)](https://docs.openstack.org/pt_BR/)
* [TÃ¼rkÃ§e (TÃ¼rkiye)](https://docs.openstack.org/tr_TR/)
* [ç®ä½ä¸­æ (Simplified Chinese)](https://docs.openstack.org/zh_CN/)

#### Contents

* OSSA-2016-001: Nova host data leak through snapshot
  + [Affects](#affects)
  + [Description](#description)
  + [Patches](#patches)
  + [Credits](#credits)
  + [References](#references)
  + [Notes](#notes)

### OpenStack

* [Projects](https://www.openstack.org/software/project-navigator/)
* [OpenStack Security](https://security.openstack.org/)
* [Blog](https://openstack.org/blog/)
* [News](https://openstack.org/news/)

### Community

* [User Groups](https://www.meetup.com/pro/openinfradev/)
* [Events](https://openstack.org/community/events/)
* [Jobs](https://openstack.org/community/jobs/)
* [Companies](https://openinfra.dev/members/)
* [Contribute](https://docs.openstack.org/contributors)

### Documentation

* [OpenStack Manuals](https://docs.openstack.org)
* [Getting Started](https://openstack.org/software/start/)
* [API Documentation](https://developer.openstack.org)
* [Wiki](https://wiki.openstack.org)

### Branding & Legal

* [Legal Docs](https://openinfra.dev/legal)
* [Logos & Guidelines](https://openstack.org/brand/)
* [Trademark Policy](https://openinfra.dev/legal/trademark-policy)
* [Privacy Policy](https://openinfra.dev/privacy-policy)
* [OpenInfra CLA](https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement)

### Stay In Touch

The OpenStack project is provided under the
[Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0). Docs.openstack.org is powered by
[Rackspace Cloud Computing](https://rackspace.com).



=== Content from review.openstack.org_1f214367_20250126_025829.html ===




=== Content from bugzilla.redhat.com_28a9face_20250126_025830.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1290511)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1290511)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1290511)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1290511

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1290511**](show_bug.cgi?id=1290511)
(CVE-2015-7548)
- [CVE-2015-7548](https://access.redhat.com/security/cve/CVE-2015-7548) openstack-nova: Unprivileged API user can access host data using instance snapshot

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-7548 openstack-nova: Unprivileged API user can access host data usin...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-7548 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1295729](show_bug.cgi?id=1295729) [1295730](show_bug.cgi?id=1295730) [1295731](show_bug.cgi?id=1295731) [1295732](show_bug.cgi?id=1295732) [1295733](show_bug.cgi?id=1295733) [1296643](show_bug.cgi?id=1296643) [1296644](show_bug.cgi?id=1296644 "CLOSED EOL - CVE-2015-7548 openstack-nova: Unprivileged API user can access host data using instance snapshot [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1290521](show_bug.cgi?id=1290521) | | TreeView+ | [depends on](buglist.cgi?bug_id=1290511&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1290511&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-12-10 17:24 UTC by Adam Mariš | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 21:11 UTC ([History](show_activity.cgi?id=1290511)) | | [CC List:](page.cgi?id=fields.html#cclist) | 33 users (show)  abaron aortega apevec ayoung berrange chrisw dallan dasmith eglynn gkotton gmollett jjoyce jschluet kbasil kchamart lhh lpeer markmc mbooth mburns ndipanov nova-maint rbryant sbauza sclewis security-response-team sferdjao sgordon slinaber slong tdecacqu vromanso yeylon | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: | A flaw was discovered in the OpenStack Compute (nova) snapshot feature when using the libvirt driver. A compute user could overwrite an attached instance disk with a malicious header specifying a backing file, and then request a snapshot, causing a file from the compute host to be leaked. This flaw only affects LVM or Ceph setups, or setups using filesystem storage with "use\_cow\_images = False". | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-02-22 01:51:08 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:0017](https://access.redhat.com/errata/RHSA-2016%3A0017) | 0 | normal | SHIPPED\_LIVE | Important: openstack-nova security advisory | 2016-01-11 04:20:21 UTC | | Red Hat Product Errata | [RHSA-2016:0018](https://access.redhat.com/errata/RHSA-2016%3A0018) | 0 | normal | SHIPPED\_LIVE | Important: openstack-nova security update | 2016-01-11 15:17:02 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1290511#c0)  Adam Mariš    2015-12-10 17:24:14 UTC  ``` A vulnerability in Nova instance snapshot was discovered. By overwriting the disk inside an instance with a malicious image and requesting a snapshot, an authenticated user would be able to read an arbitrary file from the compute host.  Host file needs to be readable by the nova user to be exposed except when using lvm for instance storage, when all files readable by root are exposed. Only setups using libvirt to spawn instances are vulnerable. Of these, setups which use filesystem storage, and do not set "use_cow_images = False" in Nova configuration are not affected. Setups which use ceph, lvm, or ploop for instance storage, and setups which use filesystem storage with "use_cow_images = False" are all affected.  Upstream bug:  [https://bugs.launchpad.net/nova/+bug/1524274](https://bugs.launchpad.net/nova/%2Bbug/1524274)   ```  [Comment 5](show_bug.cgi?id=1290511#c5)  Adam Mariš    2015-12-11 12:35:07 UTC  ``` Acknowledgements:  This issue was discovered by Matthew Booth of Red Hat.   ```  [Comment 11](show_bug.cgi?id=1290511#c11)  Kurt Seifried    2016-01-07 18:02:42 UTC  ```  Created openstack-nova tracking bugs for this issue:  Affects: fedora-all [[bug 1296644](show_bug.cgi?id=1296644 "CLOSED EOL - CVE-2015-7548 openstack-nova: Unprivileged API user can access host data using instance snapshot [fedora-all]")]   ```  [Comment 12](show_bug.cgi?id=1290511#c12)  Kurt Seifried    2016-01-07 18:04:48 UTC  ``` This is now public:  <http://seclists.org/oss-sec/2016/q1/40>   ```  [Comment 13](show_bug.cgi?id=1290511#c13)  errata-xmlrpc    2016-01-10 23:21:23 UTC  ``` This issue has been addressed in the following products:    OpenStack 5 for RHEL 6  Via RHSA-2016:0017 <https://rhn.redhat.com/errata/RHSA-2016-0017.html>   ```  [Comment 14](show_bug.cgi?id=1290511#c14)  errata-xmlrpc    2016-01-11 10:17:25 UTC  ``` This issue has been addressed in the following products:    OpenStack 7 For RHEL 7   OpenStack 5 for RHEL 7   OpenStack 6 for RHEL 7  Via RHSA-2016:0018 <https://rhn.redhat.com/errata/RHSA-2016-0018.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1290511&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from rhn.redhat.com_209ee871_20250124_191023.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2016:0018 - Security Advisory

Issued:
2016-01-11
Updated:
2016-01-11
# RHSA-2016:0018 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: openstack-nova security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2016%3A0018)

## Topic

Updated openstack-nova packages that fix one security issue are now
available for Red Hat Enterprise Linux OpenStack Platform 5.0, 6.0,
and 7.0 for Red Hat Enterprise Linux 7.

Red Hat Product Security has rated this update as having Important security
impact. A Common Vulnerability Scoring System (CVSS) base score, which
gives a detailed severity rating, is available from the CVE link in the
References section.

## Description

OpenStack Compute (nova) launches and schedules large networks of virtual
machines, creating a redundant and scalable cloud computing platform.
Compute provides the software, control panels, and APIs required to
orchestrate a cloud, including running virtual machine instances and
controlling access through users and projects.

A flaw was discovered in the OpenStack Compute (nova) snapshot feature when
using the libvirt driver. A compute user could overwrite an attached
instance disk with a malicious header specifying a backing file, and then
request a snapshot, causing a file from the compute host to be leaked. This
flaw only affects LVM or Ceph setups, or setups using filesystem storage
with "use\_cow\_images = False". (CVE-2015-7548)

This issue was discovered by Matthew Booth of Red Hat OpenStack
Engineering.

All openstack-nova users are advised to upgrade to these updated packages,
which correct this issue.

## Solution

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

For details on how to apply this update, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 7 x86\_64
* Red Hat OpenStack 6.0 x86\_64
* Red Hat OpenStack 5.0 for RHEL 7 x86\_64

## Fixes

* [BZ - 1290511](https://bugzilla.redhat.com/show_bug.cgi?id=1290511)
  - CVE-2015-7548 openstack-nova: Unprivileged API user can access host data using instance snapshot

## CVEs

* [CVE-2015-7548](https://www.redhat.com/security/data/cve/CVE-2015-7548.html)

## References

* <http://www.redhat.com/security/updates/classification/#normal>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 7

| SRPM | |
| --- | --- |
| openstack-nova-2015.1.2-13.el7ost.src.rpm | SHA-256: ff0d4aec134968d47dec8707e0a5219f13ba6bec4e46e171eb0b267632280815 |
| x86\_64 | |
| openstack-nova-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 2394aadac36728e4cdadd0982856275f6e51cc5ceccf058070475c2046bfea7a |
| openstack-nova-api-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 2e99a193d12f98370124f94d98c438a3a771f421b2583809b9db6eefbd85f336 |
| openstack-nova-cells-2015.1.2-13.el7ost.noarch.rpm | SHA-256: a4a4bc407a762ffb197bf4c6a3a95e2fe82643981c94813a35de26912dd61ddd |
| openstack-nova-cert-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 4983b47a6357323913de6f188b5bb051b054e8ad857fed17400996390a2799bd |
| openstack-nova-common-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 397ad5502845fcb944647150c64bf08785f4e07fd1c8cda20d5771989c017c2c |
| openstack-nova-compute-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 2888ef33e794de2c6b7848be6b53f3499366ead6cbdca66812670ce7b0272f4f |
| openstack-nova-conductor-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 92c586a3323b0f995be0e68868b3850ff7018d2895c645b0dc4cc97fce4928ad |
| openstack-nova-console-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 929cfbdddb666f3af40e63cd87c13a3fe085dc87e0bf20e4c7d8e6e5709b4c17 |
| openstack-nova-doc-2015.1.2-13.el7ost.noarch.rpm | SHA-256: f11c56b3964aef48434f2f53c9462e2a881060a68781d6f2f30cdf8751cdf0a1 |
| openstack-nova-network-2015.1.2-13.el7ost.noarch.rpm | SHA-256: f7541b76eb86b12bdd46e5064d7e3626209a3f63d38d6d0489935c2cd9a625ec |
| openstack-nova-novncproxy-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 6c7be513c9fd61374099a35729ba57dc2c4f847d9ddd95793e034f53dd29ba71 |
| openstack-nova-objectstore-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 8f29c3634c3733bf48348b3eaa10edbd755006436f45f9ad721460fe447df04d |
| openstack-nova-scheduler-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 4dc178092b21991c024e33496ce4f44eb6df63f6376af7712fc462a0043dbab9 |
| openstack-nova-serialproxy-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 79d3e75b30703f280eb740b5820459d45f7f53f63f485f8fb69164b6f224a7ff |
| openstack-nova-spicehtml5proxy-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 8ccebe5c259333b9783bc577fd5118e41476401959be0166e2b0e7c1defea64e |
| python-nova-2015.1.2-13.el7ost.noarch.rpm | SHA-256: 8120c8f8896f282aa0c802ce5e1286c4174ab55a0d6373f843e1b5760d548edb |

## Red Hat OpenStack 6.0

| SRPM | |
| --- | --- |
| openstack-nova-2014.2.3-48.el7ost.src.rpm | SHA-256: 56631b14c8841de0a20f5bc6ac144b9d8e098ccbc8b5e24c22b7c5c9ca86b578 |
| x86\_64 | |
| openstack-nova-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 180bba6cd3a404e5a5b8ed036ac88e20b4d9213fa890c660e403c5399e3e89af |
| openstack-nova-api-2014.2.3-48.el7ost.noarch.rpm | SHA-256: d79ffe3a11f4d643eddfc10cca521e9f6c2243027ece5cb9ea4cf875329240f9 |
| openstack-nova-cells-2014.2.3-48.el7ost.noarch.rpm | SHA-256: c89a39bc56e1653c3b5ebfd1a61a95aeb7c33b198551e550498429cc917f85a1 |
| openstack-nova-cert-2014.2.3-48.el7ost.noarch.rpm | SHA-256: b27bd658869cdd246d095dc41be014f4e17631412b2542bf2f42e4a862948322 |
| openstack-nova-common-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 032ee7cea6f5bd0e3b05e54dd02f14b95fa2f400890746b49f4f2d85e7b54f4d |
| openstack-nova-compute-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 6d009332f26d03e04cf559d92bc9ec361817414061be43aee5a3d6fd353aef7e |
| openstack-nova-conductor-2014.2.3-48.el7ost.noarch.rpm | SHA-256: f86bc8170f5db62d788f170e6a928676bb44e45d3639951ae97a99eab1c71961 |
| openstack-nova-console-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 827ebdd8555b773d0828ca97c21d615a22de0148348703c275fa7d1b28d73a0c |
| openstack-nova-doc-2014.2.3-48.el7ost.noarch.rpm | SHA-256: a3d379a23ec527fe69f931daa7a53300058fa6ba5913a97a71d8f413e217165b |
| openstack-nova-network-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 7f733d83bcb4833f7782b69d10fb33022480c9ea1af9af6c21e61155c483e843 |
| openstack-nova-novncproxy-2014.2.3-48.el7ost.noarch.rpm | SHA-256: e6df84a1b6d517187245ceeb3924e82991312ff1a84e8054e51dbb1b56feec11 |
| openstack-nova-objectstore-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 600a562c8b880a273405260df1d1946b3d84bd11dbc470f36e20de79c48b9d65 |
| openstack-nova-scheduler-2014.2.3-48.el7ost.noarch.rpm | SHA-256: c32e53619b47c3511d3fc8753f38257f212afe53d61ba8f835ac1fc96158fa91 |
| openstack-nova-serialproxy-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 320cf54090236280bdc36d970b14e868bff21937980fea0f1dc23d7a2a38d13f |
| python-nova-2014.2.3-48.el7ost.noarch.rpm | SHA-256: 3e68ec94b42e66415a0eaf1ce39169cb9e38f46f8d455c0b354e3c896bb1933d |

## Red Hat OpenStack 5.0 for RHEL 7

| SRPM | |
| --- | --- |
| openstack-nova-2014.1.5-15.el7ost.src.rpm | SHA-256: f46268f65046824c59be91819ac0e3e6a6965dbdf2925f9ab27ee5e0531a581d |
| x86\_64 | |
| openstack-nova-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 01b777163e1898097c8bff90f37d045fd8234b90c65a828776c69747085e8c9d |
| openstack-nova-api-2014.1.5-15.el7ost.noarch.rpm | SHA-256: ba9515f822ad99dc0733fbac0879d40dd45851de664184b806af1daf41fbcc03 |
| openstack-nova-cells-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 58245df10c7dd0edaf47b2996667e9f2d6738fdd3780839165a33125457ef347 |
| openstack-nova-cert-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 1a96a812c749faa4879257c45890444aac5cad565cfdede83da7046247366ea9 |
| openstack-nova-common-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 0ba123d44921b415438ec0821fe7482b9213a649bd986a2652e287a9845e101d |
| openstack-nova-compute-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 097cb78e4072a7f59fa8db2baf02ee211354f483c0a94e09006ea795307eecf5 |
| openstack-nova-conductor-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 2a77621dab45648a23fe01ff7776e10fb821148da433b0a29d611fd42213471d |
| openstack-nova-console-2014.1.5-15.el7ost.noarch.rpm | SHA-256: a786ab3117dd59f53f464b6ee414199c3fa2d84633a5653ee8648155db3fc2e3 |
| openstack-nova-doc-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 69c74361ff09ef1aa12ad19f75edb18ece295ac57d8328961357ee6ceb94d494 |
| openstack-nova-network-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 32e0781ddffad7312ef655e4551f4c82ffb10380c8ab325aa1f614beb745c19e |
| openstack-nova-novncproxy-2014.1.5-15.el7ost.noarch.rpm | SHA-256: a4284e53e00e1fdb44cf65cfc9d37a24063fee4328e27e3293d145e918f19bca |
| openstack-nova-objectstore-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 6f12d467f1d6177a0b0506e52bd7e009c953efafa803768373c7aa2795fc6cce |
| openstack-nova-scheduler-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 50ad53912b4721dbb8ba74d7613fc27834c9d1a699e3e9d590a8dc9ce34e2bd9 |
| openstack-nova-serialproxy-2014.1.5-15.el7ost.noarch.rpm | SHA-256: d8ee6706fac8d62faa424f77015c6c6cc4bcf8123061cd1894ae5a4a4bfb9500 |
| python-nova-2014.1.5-15.el7ost.noarch.rpm | SHA-256: 5803fedb6eb0d352c0dfd75fc3b32076a16411c8bf8723747b1161cdb9cd7012 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_e4f0cf95_20250126_025831.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


