```
{
  "CVE-2015-7183": {
    "description": "Integer overflow in the PL_ARENA_ALLOCATE implementation in Netscape Portable Runtime (NSPR) in Mozilla Network Security Services (NSS) before 3.19.2.1 and 3.20.x before 3.20.1, as used in Firefox before 42.0 and Firefox ESR 38.x before 38.4 and other products, allows remote attackers to execute arbitrary code or cause a denial of service (memory corruption and application crash) via unspecified vectors.",
    "vulnerability_details": {
      "root_cause": "The `PL_ARENA_ALLOCATE` macro in NSPR does not perform a proper size check before allocating memory, leading to an integer overflow when calculating the available space within the arena. This incorrect calculation results in a situation where the macro indicates there is enough space available within the arena for the requested allocation, even when there is not. As a result, the macro will write into memory it should not, leading to memory corruption.",
      "weaknesses": [
        "Integer Overflow",
        "Memory Corruption",
        "Heap-based Buffer Overflow"
      ],
      "impact": "A successful exploit of this vulnerability could allow a remote attacker to cause a denial of service (application crash) or execute arbitrary code by corrupting memory.",
      "attack_vectors": [
        "Unspecified vectors, likely through specially crafted web content"
      ],
       "required_capabilities": "The attacker would need to entice a user to open malicious web content that would trigger the vulnerability.",
      "required_position": "Remote attacker"
    },
    "affected_products": [
      "Mozilla Firefox before 42.0",
      "Firefox ESR 38.x before 38.4",
      "Mozilla Network Security Services (NSS) before 3.19.2.1",
	    "Mozilla Network Security Services (NSS) 3.20.x before 3.20.1",
      "Netscape Portable Runtime (NSPR)"
	],
    "additional_information": "The vulnerability is caused by the fact that PL_ARENA_ALLOCATE macro doesn't check for overflow before determining whether or not enough memory exists, and as a result, overflows. The crash is ASAN yelling at the overflow.Specifically, <http://mxr.mozilla.org/nspr/source/lib/ds/plarena.h#142> and <http://mxr.mozilla.org/nspr/source/lib/ds/plarena.h#143> Example values of _p and _nb in my case _p = 4109373344 _nb = 808464432 _q = _p + _nb = 622870480 _q < _p, therefore NSPR assumes the memory can be used directly from _p (that it already allocated enough), and Bad Things Happen. What's supposed to happen is that it would call PL_ArenaAllocate and let that yell at the user for the (large) allocation. Instead, it sets _a->avail = _q, which includes a wide swath of memory not allocated, and then returns _p to the caller, as if the large allocation succeeded. In ASAN mode, this crashes when PL_MAKE_MEM_UNDEFINED is called, because _q < _p. In non-ASAN mode, no crashes, just wild writes.",
  }
}
```