The provided content relates to CVE-2015-5339.

**Root cause of vulnerability:**
The web service `core_enrol_get_enrolled_users` does not respect the course group mode settings when retrieving a list of course participants.

**Weaknesses/vulnerabilities present:**
The vulnerability lies in the fact that the `core_enrol_get_enrolled_users` web service returns all participants of a course, regardless of the group mode settings (separate groups). This means that users can potentially see other users enrolled in a course that they should not be able to see, based on the course's group settings.

**Impact of exploitation:**
An attacker could use this vulnerability to obtain a list of all participants in a course, even if they are not supposed to see some of those users due to group mode settings. This could lead to a privacy breach, as users might learn about the presence of other users in the course who are in separate groups and not intended to be visible to each other.

**Attack vectors:**
The attack vector is through the web service `core_enrol_get_enrolled_users`. An attacker could make a web service request to this API to retrieve the complete list of enrolled users.

**Required attacker capabilities/position:**
The attacker needs to have the ability to access the web service API and call `core_enrol_get_enrolled_users` and have sufficient privileges to call that API.  They do not need to be a part of the course to retrieve the user list, as long as they can access the API.