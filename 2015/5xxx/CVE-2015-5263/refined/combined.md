=== Content from cve.killedkenny.io_1501ffe1_20250125_122102.html ===

# \*\* RESERVED \*\*

* [home](https://cve.killedkenny.io/)
* [about](https://cve.killedkenny.io/p/about/)

### [CVE-2015-5263](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5263)

[oss-security - Pulp 2.6.4 released for CVE-2015-5263](https://cve.killedkenny.io/oss-security/2015-09-24-4/)



=== Content from github.com_b2fd93a3_20250125_122106.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpulp%2Fpulp%2Fcommit%2Fb542d7465f7e6e02e1ea1aec059ac607a65cefe7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpulp%2Fpulp%2Fcommit%2Fb542d7465f7e6e02e1ea1aec059ac607a65cefe7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pulp%2Fpulp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Dec 7, 2022. It is now read-only.

[pulp](/pulp)
/
**[pulp](/pulp/pulp)**
Public archive

* [Notifications](/login?return_to=%2Fpulp%2Fpulp) You must be signed in to change notification settings
* [Fork
  168](/login?return_to=%2Fpulp%2Fpulp)
* [Star
   508](/login?return_to=%2Fpulp%2Fpulp)

* [Code](/pulp/pulp)
* [Pull requests
  0](/pulp/pulp/pulls)
* [Security](/pulp/pulp/security)
* [Insights](/pulp/pulp/pulse)

Additional navigation options

* [Code](/pulp/pulp)
* [Pull requests](/pulp/pulp/pulls)
* [Security](/pulp/pulp/security)
* [Insights](/pulp/pulp/pulse)

## Commit

[Permalink](/pulp/pulp/commit/b542d7465f7e6e02e1ea1aec059ac607a65cefe7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

convert consumer register to bindings

[Browse files](/pulp/pulp/tree/b542d7465f7e6e02e1ea1aec059ac607a65cefe7)
Browse the repository at this point in the history

* Loading branch information

[![@asmacdo](https://avatars.githubusercontent.com/u/1028657?s=40&v=4)](/asmacdo)

[asmacdo](/pulp/pulp/commits?author=asmacdo "View all commits by asmacdo")
committed
Sep 16, 2015

1 parent
[aa432bf](/pulp/pulp/commit/aa432bf58497b5e3682333b1d5f5ae4f45788a61)

commit b542d74

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**209 additions**
and
**58 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* bindings

  + pulp/bindings

    - bindings/pulp/bindings/bindings.py
      [bindings.py](#diff-15f97c4d7cfbff5b0f22ab2008559ca30963fe7fd1f3053036d8942f592e9a6e)
    - bindings/pulp/bindings/consumer.py
      [consumer.py](#diff-1f01cfeb474c722f9acdf2c3cd5c0e300f336abc135b0aa238c49d04bb33c8d0)
    - bindings/pulp/bindings/server.py
      [server.py](#diff-dc4831eff52bc6b0e22bb68547186da46c9ccc54b3bddb0c79abb12fa4d3eea4)
    - bindings/pulp/bindings/static.py
      [static.py](#diff-661099ba94d3756d0a870bd0ad87018370abf71fabfe8e8d2dbab437ffb55222)
  + test/unit

    - bindings/test/unit/test\_static.py
      [test\_static.py](#diff-31fe83f538f0e66bb8ba284c22e3799aa6e634529647e60420585f95a652f523)
* client\_consumer

  + pulp/client/consumer

    - client\_consumer/pulp/client/consumer/cli.py
      [cli.py](#diff-d2d76d1d049fee5a147205834e4257dfb95fc58b815322590611d884355cca8b)
  + test/unit

    - client\_consumer/test/unit/test\_cli.py
      [test\_cli.py](#diff-d395665fad3a0b86e4ee9f59a8d7630f73808516abc94cec56ea33f0e8ff1eaf)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[bindings/pulp/bindings/bindings.py](#diff-15f97c4d7cfbff5b0f22ab2008559ca30963fe7fd1f3053036d8942f592e9a6e "bindings/pulp/bindings/bindings.py")

Show comments

[View file](/pulp/pulp/blob/b542d7465f7e6e02e1ea1aec059ac607a65cefe7/bindings/pulp/bindings/bindings.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,6 +19,7 @@ |
|  |  | from pulp.bindings.consumer\_groups import \* |
|  |  | from pulp.bindings.consumer import \* |
|  |  | from pulp.bindings.server\_info import ServerInfoAPI |
|  |  | from pulp.bindings.static import StaticRequest |
|  |  | from pulp.bindings.tasks import TasksAPI, TaskSearchAPI |
|  |  | from pulp.bindings.upload import UploadAPI |
|  |  | from pulp.bindings.auth import \* |
| Expand Down  Expand Up | | @@ -67,6 +68,7 @@ def \_\_init\_\_(self, pulp\_connection): |
|  |  | self.repo\_unit = RepositoryUnitAPI(pulp\_connection) |
|  |  | self.role = RoleAPI(pulp\_connection) |
|  |  | self.server\_info = ServerInfoAPI(pulp\_connection) |
|  |  | self.static = StaticRequest(pulp\_connection) |
|  |  | self.tasks = TasksAPI(pulp\_connection) |
|  |  | self.tasks\_search = TaskSearchAPI(pulp\_connection) |
|  |  | self.uploads = UploadAPI(pulp\_connection) |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[bindings/pulp/bindings/consumer.py](#diff-1f01cfeb474c722f9acdf2c3cd5c0e300f336abc135b0aa238c49d04bb33c8d0 "bindings/pulp/bindings/consumer.py")

Show comments

[View file](/pulp/pulp/blob/b542d7465f7e6e02e1ea1aec059ac607a65cefe7/bindings/pulp/bindings/consumer.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -111,7 +111,7 @@ def list\_schedules(self, action, consumer\_id): |
|  |  | def get\_schedule(self, action, consumer\_id, schedule\_id): |
|  |  | url = self.base\_path % consumer\_id + action + '/%s/' % schedule\_id |
|  |  | return self.server.GET(url) |
|  |  |  |
|  |  |  |
|  |  | def add\_schedule(self, action, consumer\_id, schedule, units, failure\_threshold=UNSPECIFIED, |
|  |  | enabled=UNSPECIFIED, options=UNSPECIFIED): |
|  |  | url = self.base\_path % consumer\_id + action + '/' |
| Expand All | | @@ -125,7 +125,7 @@ def add\_schedule(self, action, consumer\_id, schedule, units, failure\_threshold=U |
|  |  | # Strip out anything that wasn't specified by the caller |
|  |  | body = dict([(k, v) for k, v in body.items() if v is not UNSPECIFIED]) |
|  |  | return self.server.POST(url, body) |
|  |  |  |
|  |  |  |
|  |  | def delete\_schedule(self, action, consumer\_id, schedule\_id): |
|  |  | url = self.base\_path % consumer\_id + action + '/%s/' % schedule\_id |
|  |  | return self.server.DELETE(url) |
| Expand Down  Expand Up | | @@ -156,7 +156,7 @@ def find\_by\_id(self, consumer\_id, repo\_id=None): |
|  |  | if repo\_id: |
|  |  | path += '%s/' % repo\_id |
|  |  | return self.server.GET(path) |
|  |  |  |
|  |  |  |
|  |  | def bind(self, consumer\_id, repo\_id, distributor\_id, notify\_agent=True, binding\_config=None): |
|  |  | path = self.BASE\_PATH % consumer\_id |
|  |  | data = { |
| Expand All | | @@ -166,7 +166,7 @@ def bind(self, consumer\_id, repo\_id, distributor\_id, notify\_agent=True, binding\_ |
|  |  | 'binding\_config': binding\_config or {} |
|  |  | } |
|  |  | return self.server.POST(path, data) |
|  |  |  |
|  |  |  |
|  |  | def unbind(self, consumer\_id, repo\_id, distributor\_id, force=False): |
|  |  | path = self.BASE\_PATH % consumer\_id + "%s/" % repo\_id + "%s/" % distributor\_id |
|  |  | body = dict(force=force) |
| Expand Down | |  |

35 changes: 21 additions & 14 deletions

35
[bindings/pulp/bindings/server.py](#diff-dc4831eff52bc6b0e22bb68547186da46c9ccc54b3bddb0c79abb12fa4d3eea4 "bindings/pulp/bindings/server.py")

Show comments

[View file](/pulp/pulp/blob/b542d7465f7e6e02e1ea1aec059ac607a65cefe7/bindings/pulp/bindings/server.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -84,27 +84,29 @@ def \_\_init\_\_(self, |
|  |  | self.verify\_ssl = verify\_ssl |
|  |  | self.ca\_path = ca\_path |
|  |  |  |
|  |  | def DELETE(self, path, body=None, log\_request\_body=True): |
|  |  | return self.\_request('DELETE', path, body=body, log\_request\_body=log\_request\_body) |
|  |  | def DELETE(self, path, body=None, log\_request\_body=True, ignore\_prefix=False): |
|  |  | return self.\_request('DELETE', path, body=body, log\_request\_body=log\_request\_body, |
|  |  | ignore\_prefix=ignore\_prefix) |
|  |  |  |
|  |  | def GET(self, path, queries=()): |
|  |  | return self.\_request('GET', path, queries) |
|  |  | def GET(self, path, queries=(), ignore\_prefix=False): |
|  |  | return self.\_request('GET', path, queries, ignore\_prefix=ignore\_prefix) |
|  |  |  |
|  |  | def HEAD(self, path): |
|  |  | return self.\_request('HEAD', path) |
|  |  | def HEAD(self, path, ignore\_prefix=False): |
|  |  | return self.\_request('HEAD', path, ignore\_prefix=ignore\_prefix) |
|  |  |  |
|  |  | def POST(self, path, body=None, ensure\_encoding=True, log\_request\_body=True): |
|  |  | def POST(self, path, body=None, ensure\_encoding=True, log\_request\_body=True, |
|  |  | ignore\_prefix=False): |
|  |  | return self.\_request('POST', path, body=body, ensure\_encoding=ensure\_encoding, |
|  |  | log\_request\_body=log\_request\_body) |
|  |  | log\_request\_body=log\_request\_body, ignore\_prefix=ignore\_prefix) |
|  |  |  |
|  |  | def PUT(self, path, body, ensure\_encoding=True, log\_request\_body=True): |
|  |  | def PUT(self, path, body, ensure\_encoding=True, log\_request\_body=True, ignore\_prefix=False): |
|  |  | return self.\_request('PUT', path, body=body, ensure\_encoding=ensure\_encoding, |
|  |  | log\_request\_body=log\_request\_body) |
|  |  | log\_request\_body=log\_request\_body, ignore\_prefix=ignore\_prefix) |
|  |  |  |
|  |  | # protected request utilities --------------------------------------------- |
|  |  |  |
|  |  | def \_request(self, method, path, queries=(), body=None, ensure\_encoding=True, |
|  |  | log\_request\_body=True): |
|  |  | log\_request\_body=True, ignore\_prefix=False): |
|  |  | """ |
|  |  | make a HTTP request to the pulp server and return the response |
|  |  |  |
| Expand All | | @@ -130,14 +132,17 @@ def \_request(self, method, path, queries=(), body=None, ensure\_encoding=True, |
|  |  | :param log\_request\_body: Toggle logging of the request body, defaults to true |
|  |  | :type log\_request\_body: bool |
|  |  |  |
|  |  | :param ignore\_prefix: when building the url, disregard the self.path\_prefix |
|  |  | :type ignore\_prefix: bool |
|  |  |  |
|  |  | :return: Response object |
|  |  | :rtype: pulp.bindings.responses.Response |
|  |  |  |
|  |  | :raises: ConnectionException or one of the RequestExceptions |
|  |  | (depending on response codes) in case of unsuccessful |
|  |  | request |
|  |  | """ |
|  |  | url = self.\_build\_url(path, queries) |
|  |  | url = self.\_build\_url(path, queries, ignore\_prefix) |
|  |  | if ensure\_encoding: |
|  |  | body = self.\_process\_body(body) |
|  |  | if not isinstance(body, (NoneType, basestring)): |
| Expand Down  Expand Up | | @@ -201,7 +206,7 @@ def \_handle\_exceptions(self, response\_code, response\_body): |
|  |  | else: |
|  |  | raise code\_class\_mappings[response\_code](response\_body) |
|  |  |  |
|  |  | def \_build\_url(self, path, queries=()): |
|  |  | def \_build\_url(self, path, queries, ignore\_prefix): |
|  |  | """ |
|  |  | Takes a relative path and query parameters, combines them with the |
|  |  | base path, and returns the result. Handles utf-8 encoding as necessary. |
| Expand All | | @@ -217,13 +222,15 @@ def \_build\_url(self, path, queries=()): |
|  |  | in either case representing key-value pairs to be used |
|  |  | as query parameters on the URL. |
|  |  | :type queries: mapping object or sequence of 2-element tuples |
|  |  | :param ignore\_prefix: when building the url, disregard the self.path\_prefix |
|  |  | :type ignore\_prefix: bool |
|  |  |  |
|  |  | :return: path that is a composite of self.path\_prefix, path, and |
|  |  | queries. May be relative or absolute depending on the nature |
|  |  | of self.path\_prefix |
|  |  | """ |
|  |  | # build the request url from the path and queries dict or tuple |
|  |  | if not path.startswith(self.path\_prefix): |
|  |  | if not path.startswith(self.path\_prefix) and not ignore\_prefix: |
|  |  | if path.startswith('/'): |
|  |  | path = path[1:] |
|  |  | path = '/'.join((self.path\_prefix, path)) |
| Expand Down | |  |

16 changes: 16 additions & 0 deletions

16
[bindings/pulp/bindings/static.py](#diff-661099ba94d3756d0a870bd0ad87018370abf71fabfe8e8d2dbab437ffb55222 "bindings/pulp/bindings/static.py")

Show comments

[View file](/pulp/pulp/blob/b542d7465f7e6e02e1ea1aec059ac607a65cefe7/bindings/pulp/bindings/static.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,16 @@ |
|  |  | from pulp.bindings.base import PulpAPI |
|  |  |  |
|  |  |  |
|  |  | class StaticRequest(PulpAPI): |
|  |  | """ |
|  |  | Connection class to access static calls |
|  |  | """ |
|  |  |  |
|  |  | def get\_server\_key(self): |
|  |  | """ |
|  |  | Retrieve the server's public key. |
|  |  |  |
|  |  | :return: rsa public key |
|  |  | :rtype: str |
|  |  | """ |
|  |  | return self.server.GET('/pulp/static/rsa\_pub.key', ignore\_prefix=True) |

22 changes: 22 additions & 0 deletions

22
[bindings/test/unit/test\_static.py](#diff-31fe83f538f0e66bb8ba284c22e3799aa6e634529647e60420585f95a652f523 "bindings/test/unit/test_static.py")

Show comments

[View file](/pulp/pulp/blob/b542d7465f7e6e02e1ea1aec059ac607a65cefe7/bindings/test/unit/test_static.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,22 @@ |
|  |  | import unittest |
|  |  |  |
|  |  | import mock |
|  |  |  |
|  |  | from pulp.bindings.server import PulpConnection |
|  |  | from pulp.bindings.static import StaticRequest |
|  |  |  |
|  |  |  |
|  |  | class TestStaticRequest(unittest.TestCase): |
|  |  | """ |
|  |  | Tests for static file requests. |
|  |  | """ |
|  |  |  |
|  |  | def test\_get\_server\_key(self): |
|  |  | """ |
|  |  | Test that the correct path is given to the binding. |
|  |  | """ |
|  |  | static\_request = StaticRequest(mock.MagicMock(spec=PulpConnection)) |
|  |  | response = static\_request.get\_server\_key() |
|  |  | static\_request.server.GET.assert\_called\_once\_with('/pulp/static/rsa\_pub.key', |
|  |  | ignore\_prefix=True) |
|  |  | self.assertTrue(response is static\_request.server.GET.return\_value) |

68 changes: 28 additions & 40 deletions

68
[client\_consumer/pulp/client/consumer/cli.py](#diff-d2d76d1d049fee5a147205834e4257dfb95fc58b815322590611d884355cca8b "client_consumer/pulp/client/consumer/cli.py")

Show comments

[View file](/pulp/pulp/blob/b542d7465f7e6e02e1ea1aec059ac607a65cefe7/client_consumer/pulp/client/consumer/cli.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -91,43 +91,42 @@ def initialize(context): |
|  |  | context.cli.add\_command(StatusCommand(context, 'status', \_(d))) |
|  |  |  |
|  |  |  |
|  |  | def download(url, location): |
|  |  | def write\_to\_location(location, content): |
|  |  | """ |
|  |  | Download files to the specified location. |
|  |  | :param url: The file URL. |
|  |  | :type url: str |
|  |  | :param location: The absolute path to where the downloaded |
|  |  | file is to be stored. |
|  |  | :type location: str |
|  |  | Write content to a path. Ensures that the entire path exists, creating directories if necessary. |
|  |  |  |
|  |  | :param location: path that should exist |
|  |  | :type location: str |
|  |  | :param content: bits to be written to file |
|  |  | :type  content: str |
|  |  | """ |
|  |  | request = urllib2.urlopen(url) |
|  |  | try: |
|  |  | content = request.read() |
|  |  | os.makedirs(os.path.dirname(location)) |
|  |  | except OSError, e: |
|  |  | if e.errno != errno.EEXIST: |
|  |  | raise |
|  |  | try: |
|  |  | fp = open(location, 'w+') |
|  |  | try: |
|  |  | fp.write(content) |
|  |  | finally: |
|  |  | fp.close() |
|  |  | fp.write(content) |
|  |  | finally: |
|  |  | request.close() |
|  |  | fp.close() |
|  |  |  |
|  |  |  |
|  |  | def update\_server\_key(conf): |
|  |  | def update\_server\_key(command\_inst): |
|  |  | """ |
|  |  | Download the server's RSA key and store in the location |
|  |  | specified in the configuration. |
|  |  | :param conf: The consumer configuration object. |
|  |  | :type conf: dict |
|  |  | Ensure that the server's public key stored on the consumer is up to date. |
|  |  |  |
|  |  | :param command\_inst: instance of a CLI command |
|  |  | :type  command\_inst: pulp.client.extensions.extensions.PulpCliCommand |
|  |  | """ |
|  |  | host = conf['server']['host'] |
|  |  | location = conf['server']['rsa\_pub'] |
|  |  | url = 'https://%s/pulp/static/rsa\_pub.key' % host |
|  |  | try: |
|  |  | os.makedirs(os.path.dirname(location)) |
|  |  | except OSError, e: |
|  |  | if e.errno != errno.EEXIST: |
|  |  | raise |
|  |  | download(url, location) |
|  |  | key\_reply = command\_inst.context.server.static.get\_server\_key() |
|  |  | except Exception, e: |
|  |  | msg = \_('Download server RSA key failed [%(e)s]' % {'e': e}) |
|  |  | command\_inst.prompt.render\_failure\_message(msg) |
|  |  | else: |
|  |  | key\_location = command\_inst.context.config['server']['rsa\_pub'] |
|  |  | write\_to\_location(key\_location, key\_reply.response\_body) |
|  |  |  |
|  |  |  |
|  |  | # -- common exceptions -------------------------------------------------------- |
| Expand Down  Expand Up | | @@ -201,14 +200,7 @@ def register(self, \*\*kwargs): |
|  |  | finally: |
|  |  | fp.close() |
|  |  |  |
|  |  | # download server public key |
|  |  |  |
|  |  | try: |
|  |  | update\_server\_key(self.context.config) |
|  |  | except Exception, e: |
|  |  | msg = \_('Download server RSA key failed [%(e)s]' % {'e': e}) |
|  |  | self.prompt.render\_failure\_message(msg) |
|  |  |  |
|  |  | update\_server\_key(self) |
|  |  | self.prompt.render\_success\_message('Consumer [%s] successfully registered' % consumer\_id) |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -250,11 +242,7 @@ def update(self, \*\*kwargs): |
|  |  | self.prompt.render\_success\_message('Consumer [%s] successfully updated' % consumer\_id) |
|  |  | if not kwargs.get(OPTION\_EXCHANGE\_KEYS.keyword): |
|  |  | return |
|  |  | try: |
|  |  | update\_server\_key(self.context.config) |
|  |  | except Exception, e: |
|  |  | msg = \_('Download server RSA key failed [%(e)s]' % {'e': e}) |
|  |  | self.prompt.render\_failure\_message(msg) |
|  |  | update\_server\_key(self) |
|  |  | except NotFoundException: |
|  |  | self.prompt.write('Consumer [%s] does not exist on the server' % consumer\_id, tag='not-found') |
|  |  |  |
| Expand Down | |  |

116 changes: 116 additions & 0 deletions

116
[client\_consumer/test/unit/test\_cli.py](#diff-d395665fad3a0b86e4ee9f59a8d7630f73808516abc94cec56ea33f0e8ff1eaf "client_consumer/test/unit/test_cli.py")

Show comments

[View file](/pulp/pulp/blob/b542d7465f7e6e02e1ea1aec059ac607a65cefe7/client_consumer/test/unit/test_cli.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,116 @@ |
|  |  | import unittest |
|  |  |  |
|  |  | import mock |
|  |  |  |
|  |  | from pulp.client.consumer import cli |
|  |  |  |
|  |  |  |
|  |  | class TestWriteToLocation(unittest.TestCase): |
|  |  | """ |
|  |  | Tests for writing content to a file. |
|  |  | """ |
|  |  |  |
|  |  | @mock.patch('pulp.client.consumer.cli.os') |
|  |  | @mock.patch('\_\_builtin\_\_.open', new\_callable=mock.MagicMock()) |
|  |  | def test\_dir\_struct\_exists(self, mopen, mock\_os): |
|  |  | """ |
|  |  | Test that when the directory structure already exists, the write still happens. |
|  |  | """ |
|  |  |  |
|  |  | class MockException(OSError): |
|  |  | pass |
|  |  |  |
|  |  | mock\_e = MockException() |
|  |  | mock\_e.errno = 17 |
|  |  | mock\_os.makedirs.side\_effect = mock\_e |
|  |  | mock\_fp = open.return\_value |
|  |  |  |
|  |  | cli.write\_to\_location('test/loc', 'content') |
|  |  | mock\_os.path.dirname.assert\_called\_once\_with('test/loc') |
|  |  | mock\_os.makedirs.assert\_called\_once\_with(mock\_os.path.dirname.return\_value) |
|  |  | open.assert\_called\_once\_with('test/loc', 'w+') |
|  |  | mock\_fp.write.assert\_called\_once\_with('content') |
|  |  | mock\_fp.close.assert\_called\_once\_with() |
|  |  |  |
|  |  | @mock.patch('pulp.client.consumer.cli.os') |
|  |  | @mock.patch('\_\_builtin\_\_.open', new\_callable=mock.MagicMock()) |
|  |  | def test\_misc\_os\_err(self, mopen, mock\_os): |
|  |  | """ |
|  |  | Test that misc errors are reraised and the write does not happen. |
|  |  | """ |
|  |  |  |
|  |  | class MockException(OSError): |
|  |  | pass |
|  |  |  |
|  |  | mock\_e = MockException() |
|  |  | mock\_e.errno = 16 |
|  |  | mock\_os.makedirs.side\_effect = mock\_e |
|  |  | mock\_fp = open.return\_value |
|  |  |  |
|  |  | self.assertRaises(MockException, cli.write\_to\_location, 'test/loc', 'content') |
|  |  | self.assertEqual(mock\_fp.write.call\_count, 0) |
|  |  |  |
|  |  | @mock.patch('pulp.client.consumer.cli.os') |
|  |  | @mock.patch('\_\_builtin\_\_.open', new\_callable=mock.MagicMock()) |
|  |  | def test\_write\_err(self, \*\_): |
|  |  | """ |
|  |  | If there is a problem with the write, the file is still closed. |
|  |  | """ |
|  |  |  |
|  |  | class MockException(Exception): |
|  |  | pass |
|  |  |  |
|  |  | mock\_fp = open.return\_value |
|  |  | mock\_fp.write.side\_effect = MockException |
|  |  | self.assertRaises(MockException, cli.write\_to\_location, 'test/loc', 'content') |
|  |  | mock\_fp.write.assert\_called\_once\_with('content') |
|  |  | mock\_fp.close.assert\_called\_once\_with() |
|  |  |  |
|  |  | @mock.patch('pulp.client.consumer.cli.os') |
|  |  | @mock.patch('\_\_builtin\_\_.open', new\_callable=mock.MagicMock()) |
|  |  | def test\_as\_expected(self, mopen, mock\_os): |
|  |  | """ |
|  |  | When everything works as expected, ensure that the file is closed. |
|  |  | """ |
|  |  | mock\_fp = open.return\_value |
|  |  | cli.write\_to\_location('test/loc', 'content') |
|  |  | mock\_os.path.dirname.assert\_called\_once\_with('test/loc') |
|  |  | mock\_os.makedirs.assert\_called\_once\_with(mock\_os.path.dirname.return\_value) |
|  |  | open.assert\_called\_once\_with('test/loc', 'w+') |
|  |  | mock\_fp.write.assert\_called\_once\_with('content') |
|  |  | mock\_fp.close.assert\_called\_once\_with() |
|  |  |  |
|  |  |  |
|  |  | class TestUpdateServerKey(unittest.TestCase): |
|  |  | """ |
|  |  | Tests for updating the server key. |
|  |  | """ |
|  |  |  |
|  |  | @mock.patch('pulp.client.consumer.cli.write\_to\_location') |
|  |  | def test\_as\_expected(self, mock\_write): |
|  |  | """ |
|  |  | Everything is as expected, content is written to the location in the config file. |
|  |  | """ |
|  |  | mock\_cmd = mock.MagicMock() |
|  |  | key\_response = mock\_cmd.context.server.static.get\_server\_key.return\_value |
|  |  | key\_loc = mock\_cmd.context.config['getter']['getter'] |
|  |  | cli.update\_server\_key(mock\_cmd) |
|  |  | mock\_write.assert\_called\_once\_with(key\_loc, key\_response.response\_body) |
|  |  |  |
|  |  | @mock.patch('pulp.client.consumer.cli.write\_to\_location') |
|  |  | def test\_binding\_exception(self, mock\_write): |
|  |  | """ |
|  |  | If there is a problem getting the key, do not attempt to write the file. |
|  |  | """ |
|  |  |  |
|  |  | class MockException(Exception): |
|  |  |  |
|  |  | def \_\_str\_\_(self): |
|  |  | return "Mock Exception str" |
|  |  |  |
|  |  | mock\_cmd = mock.MagicMock() |
|  |  | mock\_cmd.context.server.static.get\_server\_key.side\_effect = MockException() |
|  |  | cli.update\_server\_key(mock\_cmd) |
|  |  | msg = 'Download server RSA key failed [Mock Exception str]' |
|  |  | mock\_cmd.prompt.render\_failure\_message.assert\_called\_once\_with(msg) |
|  |  | self.assertEqual(mock\_write.call\_count, 0) |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b542d74`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpulp%2Fpulp%2Fcommit%2Fb542d7465f7e6e02e1ea1aec059ac607a65cefe7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5b6cb2bf_20250125_122104.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpulp%2Fpulp%2Fblob%2Faa432bf58497b5e3682333b1d5f5ae4f45788a61%2Fclient_consumer%2Fpulp%2Fclient%2Fconsumer%2Fcli.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpulp%2Fpulp%2Fblob%2Faa432bf58497b5e3682333b1d5f5ae4f45788a61%2Fclient_consumer%2Fpulp%2Fclient%2Fconsumer%2Fcli.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=pulp%2Fpulp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Dec 7, 2022. It is now read-only.

[pulp](/pulp)
/
**[pulp](/pulp/pulp)**
Public archive

* [Notifications](/login?return_to=%2Fpulp%2Fpulp) You must be signed in to change notification settings
* [Fork
  168](/login?return_to=%2Fpulp%2Fpulp)
* [Star
   508](/login?return_to=%2Fpulp%2Fpulp)

* [Code](/pulp/pulp)
* [Pull requests
  0](/pulp/pulp/pulls)
* [Security](/pulp/pulp/security)
* [Insights](/pulp/pulp/pulse)

Additional navigation options

* [Code](/pulp/pulp)
* [Pull requests](/pulp/pulp/pulls)
* [Security](/pulp/pulp/security)
* [Insights](/pulp/pulp/pulse)

## Files

 aa432bf
## Breadcrumbs

1. [pulp](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61)
2. /[client\_consumer](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer)
3. /[pulp](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp)
4. /[client](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp/client)
5. /[consumer](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp/client/consumer)
/
# cli.py

Copy path Blame  Blame
## Latest commit

## History

[History](/pulp/pulp/commits/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp/client/consumer/cli.py)394 lines (320 loc) · 15.3 KB aa432bf
## Breadcrumbs

1. [pulp](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61)
2. /[client\_consumer](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer)
3. /[pulp](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp)
4. /[client](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp/client)
5. /[consumer](/pulp/pulp/tree/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp/client/consumer)
/
# cli.py

Top
## File metadata and controls

* Code
* Blame

394 lines (320 loc) · 15.3 KB[Raw](https://github.com/pulp/pulp/raw/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp/client/consumer/cli.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394# -\*- coding: utf-8 -\*-## Copyright © 2012 Red Hat, Inc.## This software is licensed to you under the GNU General Public# License as published by the Free Software Foundation; either version# 2 of the License (GPLv2) or (at your option) any later version.# There is NO WARRANTY for this software, express or implied,# including the implied warranties of MERCHANTABILITY,# NON-INFRINGEMENT, or FITNESS FOR A PARTICULAR PURPOSE. You should# have received a copy of GPLv2 along with this software; if not, see# http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.
import osimport urllib2import errno
from gettext import gettext as \_
from M2Crypto import RSAfrom M2Crypto.util import no\_passphrase\_callbackfrom M2Crypto.X509 import X509Error
from pulp.bindings.exceptions import NotFoundExceptionfrom pulp.client.arg\_utils import args\_to\_notes\_dictfrom pulp.client.consumer\_utils import load\_consumer\_idfrom pulp.client.extensions.decorator import priorityfrom pulp.client.extensions.extensions import PulpCliCommand, PulpCliOption, PulpCliFlagfrom pulp.client.extensions import exceptionsfrom pulp.client import validators
OPTION\_EXCHANGE\_KEYS = PulpCliFlag('--keys', \_('exchange public keys with the server'))
# -- framework hook -----------------------------------------------------------
@priority()def initialize(context):
 # Common Options d = 'uniquely identifies the consumer; only alphanumeric, ., -, and \_ allowed' id\_option = PulpCliOption('--consumer-id', \_(d), required=True, validate\_func=validators.id\_validator\_allow\_dots)
 d = 'user-readable display name for the consumer' name\_option = PulpCliOption('--display-name', \_(d), required=False)
 d = 'user-readable description for the consumer' description\_option = PulpCliOption('--description', \_(d), required=False)
 d = 'adds/updates/deletes key-value pairs to pragmatically identify the repository; ' d += 'pairs must be separated by an equal sign (e.g. key=value); multiple notes can ' d += 'be %(i)s by specifying this option multiple times; notes are deleted by ' d += 'specifying "" as the value' d = \_(d)
 update\_note\_d = d % {'i' : \_('changed')} add\_note\_d = d % {'i' : \_('added')}
 update\_note\_option = PulpCliOption('--note', update\_note\_d, required=False, allow\_multiple=True) add\_note\_option = PulpCliOption('--note', add\_note\_d, required=False, allow\_multiple=True)
 # Register Command d = 'registers this consumer to the Pulp server' register\_command = RegisterCommand(context, 'register', \_(d)) register\_command.add\_option(id\_option) register\_command.add\_option(name\_option) register\_command.add\_option(description\_option) register\_command.add\_option(add\_note\_option) context.cli.add\_command(register\_command)
 # Update Command d = 'changes metadata of this consumer' update\_command = UpdateCommand(context, 'update', \_(d)) update\_command.add\_option(name\_option) update\_command.add\_option(description\_option) update\_command.add\_option(update\_note\_option) update\_command.add\_option(OPTION\_EXCHANGE\_KEYS) context.cli.add\_command(update\_command)
 # Unregister Command d = 'unregisters this consumer from the Pulp server' unregister\_command = UnregisterCommand(context, 'unregister', \_(d)) context.cli.add\_command(unregister\_command)
 # History Retrieval Command d = 'lists history of this consumer' context.cli.add\_command(HistoryCommand(context, 'history', \_(d)))
 d = 'displays the registration status of this consumer' context.cli.add\_command(StatusCommand(context, 'status', \_(d)))
def download(url, location): """ Download files to the specified location. :param url: The file URL. :type url: str :param location: The absolute path to where the downloaded file is to be stored. :type location: str """ request = urllib2.urlopen(url) try: content = request.read() fp = open(location, 'w+') try: fp.write(content) finally: fp.close() finally: request.close()
def update\_server\_key(conf): """ Download the server's RSA key and store in the location specified in the configuration. :param conf: The consumer configuration object. :type conf: dict """ host = conf['server']['host'] location = conf['server']['rsa\_pub'] url = 'https://%s/pulp/static/rsa\_pub.key' % host try: os.makedirs(os.path.dirname(location)) except OSError, e: if e.errno != errno.EEXIST: raise download(url, location)
# -- common exceptions --------------------------------------------------------
class RegisterCommand(PulpCliCommand):
 def \_\_init\_\_(self, context, name, description): PulpCliCommand.\_\_init\_\_(self, name, description, self.register) self.context = context self.prompt = context.prompt
 def register(self, \*\*kwargs): consumer\_id = kwargs['consumer-id']
 # Check if this consumer is already registered
 existing\_consumer = load\_consumer\_id(self.context) if existing\_consumer: m = \_('This system has already been registered as a consumer. Please ' 'use the unregister command to remove the consumer before attempting ' 'to re-register.') self.prompt.render\_failure\_message(m) return
 # Get other consumer parameters
 name = kwargs.get('display-name', consumer\_id) description = kwargs.get('description') notes = kwargs.get('note') if notes: notes = args\_to\_notes\_dict(notes, include\_none=False)
 # Check write permissions to cert directory id\_cert\_dir = self.context.config['filesystem']['id\_cert\_dir'] if not os.access(id\_cert\_dir, os.W\_OK): msg = \_("Write permission is required for %(d)s to perform this operation.") self.prompt.render\_failure\_message(msg % {'d': id\_cert\_dir}) return exceptions.CODE\_PERMISSIONS\_EXCEPTION
 # RSA key path = self.context.config['authentication']['rsa\_key'] key = RSA.gen\_key(2048, 65535, no\_passphrase\_callback) key.save\_key(path, None) path = self.context.config['authentication']['rsa\_pub'] key.save\_pub\_key(path) fp = open(path) try: rsa\_pub = fp.read() finally: fp.close()
 # Call the server
 reply = self.context.server.consumer.register( consumer\_id, name=name, description=description, notes=notes, rsa\_pub=rsa\_pub)
 certificate = reply.response\_body['certificate']
 # Write consumer certificate
 id\_cert\_name = self.context.config['filesystem']['id\_cert\_filename'] cert\_filename = os.path.join(id\_cert\_dir, id\_cert\_name) fp = open(cert\_filename, 'w') try: fp.write(certificate) finally: fp.close()
 # download server public key
 try: update\_server\_key(self.context.config) except Exception, e: msg = \_('Download server RSA key failed [%(e)s]' % {'e': e}) self.prompt.render\_failure\_message(msg)
 self.prompt.render\_success\_message('Consumer [%s] successfully registered' % consumer\_id)
class UpdateCommand(PulpCliCommand):
 def \_\_init\_\_(self, context, name, description): PulpCliCommand.\_\_init\_\_(self, name, description, self.update) self.context = context self.prompt = context.prompt
 def update(self, \*\*kwargs): consumer\_id = load\_consumer\_id(self.context) if not consumer\_id: self.prompt.render\_failure\_message("This consumer is not registered to the Pulp server.") return
 delta = dict([(k, v) for k, v in kwargs.items() if v is not None]) if 'note' in delta.keys(): if delta['note']: delta['notes'] = args\_to\_notes\_dict(kwargs['note'], include\_none=False) delta.pop('note') # convert display-name to display\_name key = 'display-name' if key in delta: v = delta.pop(key) key = key.replace('-', '\_') delta[key] = v
 if kwargs.get(OPTION\_EXCHANGE\_KEYS.keyword): path = self.context.config['authentication']['rsa\_pub'] fp = open(path) try: delta['rsa\_pub'] = fp.read() finally: fp.close()
 try: self.context.server.consumer.update(consumer\_id, delta) self.prompt.render\_success\_message('Consumer [%s] successfully updated' % consumer\_id) if not kwargs.get(OPTION\_EXCHANGE\_KEYS.keyword): return try: update\_server\_key(self.context.config) except Exception, e: msg = \_('Download server RSA key failed [%(e)s]' % {'e': e}) self.prompt.render\_failure\_message(msg) except NotFoundException: self.prompt.write('Consumer [%s] does not exist on the server' % consumer\_id, tag='not-found')
class UnregisterCommand(PulpCliCommand):
 def \_\_init\_\_(self, context, name, description): PulpCliCommand.\_\_init\_\_(self, name, description, self.unregister) self.context = context self.prompt = context.prompt
 d = 'if specified, the local consumer identification certificate will be '\ 'removed even if the server cannot be contacted' self.create\_flag('--force', \_(d))
 def unregister(self, \*\*kwargs):
 force = kwargs['force']
 # Check write permissions to cert directory id\_cert\_dir = self.context.config['filesystem']['id\_cert\_dir'] if not os.access(id\_cert\_dir, os.W\_OK): msg = \_("Write permission is required for %(d)s to perform this operation.") self.prompt.render\_failure\_message(msg % {'d': id\_cert\_dir}) return exceptions.CODE\_PERMISSIONS\_EXCEPTION
 # Get the consumer ID try: consumer\_id = load\_consumer\_id(self.context) if not consumer\_id: msg = \_('This consumer is not registered to the Pulp server.') self.context.prompt.render\_failure\_message(msg) return exceptions.CODE\_NOT\_FOUND except X509Error: self.context.logger.exception('Consumer certificate not valid.') if force: self.\_delete\_cert() msg = \_('Consumer certificate deleted.') self.context.prompt.render\_success\_message(msg) self.\_forced\_warning() return os.EX\_OK else: msg = \_('Consumer certificate not valid. Please retry using the --force option.') self.context.prompt.render\_failure\_message(msg) return os.EX\_DATAERR
 # Unregister on the server forced = True try: self.context.server.consumer.unregister(consumer\_id) forced = False except NotFoundException: if not force: msg = \_('This consumer does not exist on the server. Please retry using the --force option.') self.prompt.render\_failure\_message(msg) return exceptions.CODE\_NOT\_FOUND except X509Error: self.context.logger.exception('SSL connection failed.') if not force: msg = \_('SSL connection failed. This error may be ignored by using the --force option.') self.prompt.render\_failure\_message(msg) return os.EX\_OSERR except Exception: self.context.logger.exception('Unregistration failed') if not force: msg = \_('Unregistration failed on the server. This error may be ignored by using the --force option.') self.prompt.render\_failure\_message(msg) return exceptions.CODE\_UNEXPECTED
 # Unregister locally self.\_delete\_cert() msg = 'Consumer [%(c)s] successfully unregistered' % dict(c=consumer\_id) self.context.prompt.render\_success\_message(msg) if forced: self.\_forced\_warning()
 def \_forced\_warning(self): msg = \_('Warning: The unregistration was not coordinated with the server.') self.context.prompt.render\_warning\_message(msg)
 def \_delete\_cert(self): id\_cert\_dir = self.context.config['filesystem']['id\_cert\_dir'] id\_cert\_name = self.context.config['filesystem']['id\_cert\_filename'] cert\_filename = os.path.join(id\_cert\_dir, id\_cert\_name) if os.path.exists(cert\_filename): os.remove(cert\_filename)
class HistoryCommand(PulpCliCommand):
 def \_\_init\_\_(self, context, name, description): PulpCliCommand.\_\_init\_\_(self, name, description, self.history) self.context = context self.prompt = context.prompt
 d = 'limits displayed history entries to the given type;' d += 'supported types: ("consumer\_registered", "consumer\_unregistered", "repo\_bound", "repo\_unbound",' d += '"content\_unit\_installed", "content\_unit\_uninstalled", "unit\_profile\_changed", "added\_to\_group",' d += '"removed\_from\_group")' self.add\_option(PulpCliOption('--event-type', \_(d), required=False)) self.add\_option(PulpCliOption('--limit', 'limits displayed history entries to the given amount (must be greater than zero)', required=False)) self.add\_option(PulpCliOption('--sort', 'indicates the sort direction ("ascending" or "descending") based on the entry\'s timestamp', required=False)) self.add\_option(PulpCliOption('--start-date', 'only return entries that occur on or after the given date in iso8601 format (yyyy-mm-ddThh:mm:ssZ)', required=False)) self.add\_option(PulpCliOption('--end-date', 'only return entries that occur on or before the given date in iso8601 format (yyyy-mm-ddThh:mm:ssZ)', required=False))
 def history(self, \*\*kwargs): consumer\_id = load\_consumer\_id(self.context) if not consumer\_id: self.prompt.render\_failure\_message("This consumer is not registered to the Pulp server.") return self.prompt.render\_title(\_('Consumer History [%(i)s]') % {'i' : consumer\_id})
 history\_list = self.context.server.consumer\_history.history(consumer\_id, kwargs['event-type'], kwargs['limit'], kwargs['sort'], kwargs['start-date'], kwargs['end-date']).response\_body filters = ['consumer\_id', 'type', 'details', 'originator', 'timestamp'] order = filters for history in history\_list: self.prompt.render\_document(history, filters=filters, order=order)
class StatusCommand(PulpCliCommand):
 def \_\_init\_\_(self, context, name, description): PulpCliCommand.\_\_init\_\_(self, name, description, self.status) self.context = context self.prompt = context.prompt
 def status(self): consumer\_id = load\_consumer\_id(self.context)
 if consumer\_id: server = self.context.config['server']['host'] m = 'This consumer is registered to the server [%(s)s] with the ID [%(i)s].' self.prompt.render\_success\_message(\_(m) % {'s': server, 'i' : consumer\_id}) else: m = 'This consumer is not currently registered.' self.prompt.render\_paragraph(\_(m))

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_09bfb6d6_20250125_122102.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](../../../2015/09/25/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20150924210049.GG17080@mail.corp.redhat.com>
Date: Thu, 24 Sep 2015 17:00:49 -0400
From: Randy Barlow <rbarlow@...hat.com>
To: OSS Security <oss-security@...ts.openwall.com>
Subject: Pulp 2.6.4 released for CVE-2015-5263

Summary
=======
The Pulp[0] team has published Pulp 2.6.4 which contains a fix for
an important security vulnerability (CVE-2015-5263). Users who use the
pulp-consumer CLI to register consumers to the Pulp server should
upgrade to pulp-consumer-client>=2.6.4. All versions of
pulp-consumer-client from 2.4.0 to 2.6.3 inclusive are vulnerable and
should be upgraded.

Details
=======

A security flaw (CVE-2015-5263) was discovered in Pulp's consumer
management system. When the pulp-consumer CLI is used to register to the
Pulp server, it downloads a public key from the Pulp server and stores
it locally. Later when the Pulp server sends messages to the client via
a message broker to instruct it to perform commands, it will use the
corresponding private key to sign the messages. The client checks the
signatures before executing the instructions to ensure that the messages
came from the Pulp server and not from an attacker.

Versions of pulp-consumer-client between 2.4.0 and 2.6.3 do not check
the server's TLS certificate signatures when retrieving the server's
public key upon registration:

<https://github.com/pulp/pulp/blob/aa432bf58497b5e3682333b1d5f5ae4f45788a61/client_consumer/pulp/client/consumer/cli.py#L103>

This allows a man in the middle to inject their own message signing
key and to then perform administrative actions on the machine, if they
are able to send messages through the message broker.

Austin Macdonald fixed this issue in this commit by using our
pulp.bindings library as the rest of our CLI does:

<https://github.com/pulp/pulp/commit/b542d7465f7e6e02e1ea1aec059ac607a65cefe7#diff-17110211f89c042a9267e2167dedd754>

Users who do not use pulp-consumer are not affected by this issue.

Thanks to Austin Macdonald for writing the fix, to Dennis Kliban for making
our beta and release builds, and to Preethi Thomas for testing our
releases!

[0] <http://www.pulpproject.org/>

Download attachment "[signature.asc](4/1)" of type "application/pgp-signature" (820 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


