Based on the provided information, here's an analysis of CVE-2015-5331:

**Root cause of vulnerability:**
- Insufficient settings check when messaging another user. The system did not properly enforce the user's preference to block messages from non-contacts.

**Weaknesses/vulnerabilities present:**
- Failure to properly check user message blocking settings, which leads to a bypass of privacy preferences.

**Impact of exploitation:**
- Users could receive unwanted messages (spam) from other users who are not in their contact list, even when the setting to block such messages is enabled. This can lead to a degraded user experience.

**Attack vectors:**
- Any user on the Moodle platform can send messages to other users.

**Required attacker capabilities/position:**
- An attacker would need to be a registered user on the Moodle instance, but not on the contact list of the targeted user.

**Additional details:**
- The vulnerability affects Moodle versions 2.9 to 2.9.2 and is fixed in version 2.9.3
- The issue is identified by the Moodle issue tracker as MDL-50426