=== Content from www.mozilla.org_3f402552_20250125_232837.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2015-77

## Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer

Announced
August 6, 2015
Reporter
Julian Hector
Impact
Low
Products
Firefox OS
Fixed in

* Firefox OS 2.2

### Description

Mozilla intern **Julian Hector** discovered a regression in the graphics buffer management
of Firefox OS's graphics layer that would lead to graphics memory corruption by providing negative size
parameters. JavaScript can not access the graphics layer in a way required to trigger this vulnerability,
but it could be potentially used in a staged attack.

### References

* [Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer](https://bugzilla.mozilla.org/show_bug.cgi?id=1145389)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_6901aa5a_20250125_232840.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1145389)
* [XML](/show_bug.cgi?ctype=xml&id=1145389)

Closed
[Bug 1145389](/show_bug.cgi?id=1145389)

Opened 10 years ago
Closed 10 years ago

# Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer

## Categories

### (Core :: Graphics: Layers, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20Layers#Graphics%3A%20Layers)

Graphics: Layers
▾

Core :: Graphics: Layers
The graphics subsystem that implements hardware-accelerated (and software) composition of layers of content.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Layers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Layers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20Layers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Gonk (Firefox OS)

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla39

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox36 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=unaffected) |
| firefox37 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox37&o1=equals&v1=unaffected) |
| firefox38 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox38&o1=equals&v1=unaffected) |
| firefox39 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox39&o1=equals&v1=unaffected) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=fixed) |
| b2g-v2.0 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=fixed) |
| b2g-v2.0M | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=fixed) |
| b2g-v2.1 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed) |
| b2g-v2.1S | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=fixed) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |
| b2g-master | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox36 |  | unaffected |
| firefox37 |  | unaffected |
| firefox38 |  | unaffected |
| firefox39 |  | unaffected |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | fixed |
| b2g-v2.0 |  | fixed |
| b2g-v2.0M |  | fixed |
| b2g-v2.1 |  | fixed |
| b2g-v2.1S |  | fixed |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| b2g-master |  | fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: tedd, Assigned: sotaro)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/a0c6bcb88fdc08a4e55f4fcf65cf0428?d=mm&size=40)  [sotaro](/user_profile?user_id=434202)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/845e122fd6b1882889f392e35b40f4c4?d=mm&size=40)  [tedd](/user_profile?user_id=506410)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/17436ade8da1b23d42b3df05b9c4fc77?d=mm&size=40)  [bhood](/user_profile?user_id=697075)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[765734](/show_bug.cgi?id=765734 "RESOLVED FIXED - add gralloc-based layer buffers for gonk"), [1041862](/show_bug.cgi?id=1041862 "RESOLVED FIXED - Re-Audit IPDL protocols")

Dependency [tree](/showdependencytree.cgi?id=1145389&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1145389)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [b2g-adv-main2.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[b2g-adv-main2.2+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c26 "10 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [logfile from the hooks (values are little endian)](/attachment.cgi?id=8580310)  [10 years ago](#c0)  [Julian Hector [:tedd] [:jhector]](/user_profile?user_id=506410)   551 bytes, text/plain |  | [Details](/attachment.cgi?id=8580310&action=edit) |
| --- | --- | --- |
| [patch - Add gralloc allocation requet size check](/attachment.cgi?id=8582566)  [10 years ago](#c3)  [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)   1.22 KB, patch |  | [Details](/attachment.cgi?id=8582566&action=edit) | [Diff](/attachment.cgi?id=8582566&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8582566) |
| [patch - Add gralloc allocation requet size check](/attachment.cgi?id=8583063)  [10 years ago](#c6)  [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)   1.38 KB, patch | nical : [review+](#a489032_438998 "10 years ago")  abillings : [sec-approval+](#a499837_280903 "10 years ago") | [Details](/attachment.cgi?id=8583063&action=edit) | [Diff](/attachment.cgi?id=8583063&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8583063) |
| [patch forb2g v1.4 - Add gralloc allocation requet size check](/attachment.cgi?id=8584650)  [10 years ago](#c17)  [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)   1.27 KB, patch | sotaro : [review+](#a670812_434202 "10 years ago") | [Details](/attachment.cgi?id=8584650&action=edit) | [Diff](/attachment.cgi?id=8584650&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8584650) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Julian Hector [:tedd] [:jhector]](/user_profile?user_id=506410)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1145389#c0)• 10 years ago |
|  | |

Attached file
[logfile from the hooks (values are little endian)](attachment.cgi?id=8580310)
— [Details](attachment.cgi?id=8580310&action=edit)

The upper bound check of the 'width' and 'height' field[1] can be bypassed using negative values that are supplied by a malicious child through the IPC message 'Msg\_AllocateGrallocBuffer' in the field 'size'. The assembler code for the mentioned checks looks like this (flame device):
> cmp.w r3, #4096
> bgt.n <destination>
According to the ARM Reference Manual 'bgt' is a signed compare. I verified it using gdb. To modify the IPC message I used my hooking engine to hook the Pickle::Read\* functions inside the b2g process at runtime and swapped the values (similar to the faulty fuzzer). I supplied the log file from the hooks as an attachment.
'width' and 'height' (as well as the other two parameters) are used to allocate GPU memory, by creating a 'GraphicBuffer'[2] instance, the actual allocation happens inside a device specific library called 'gralloc.<device>.so' (for the flame it is called: 'gralloc.msm8610.so'[3])
I am not sure what impact this could have. I tested a couple of values for 'width' and 'height', when I set them both to 0xffffff00 then I get a NULL pointer deref:
> ldr.w r3, [r10]
with r10 being 0 [4]. But I don't know how this relates to the negative size of the graphic buffer. If I set the first value (I am missing the definition of the 'IntSize' struct so I can't tell whether it is the 'height' or 'width') to 0x80001100 and the second to 0x1000, so that the product of the two gives me a higher value than the allowed 4096 and 4096, the process freezes, gdb doesn't show anything, nothing responds and after a while the process is killed.
So that's what I got regarding the impact, but I assume we shouldn't allow negative values for width and the height.
[1] <http://mxr.mozilla.org/mozilla-central/source/gfx/layers/ipc/SharedBufferManagerParent.cpp?rev=da8b000c08c6#223>
[2] ./B2G/frameworks/native/libs/ui/GraphicBuffer.cpp
[3] ./B2G/hardware/qcom/display/libgralloc/gpu.cpp - gralloc\_alloc(...)
[4] <http://mxr.mozilla.org/mozilla-central/source/gfx/layers/client/TiledContentClient.cpp?rev=78dcb3a426f2#1222>

|  | [Jed Davis [:jld] ⟨⏰|UTC-8⟩ ⟦he/him⟧](/user_profile?user_id=462836) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1145389#c1)• 10 years ago |
|  | |

I think this belongs to Core::Graphics:Layers; Core::IPC is for the general IPC infrastructure.Component: IPC → Graphics: Layers

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1145389#c2)• 10 years ago |
|  | |

I might be overly cautious but rating this sec-high for now because this kind of thing can lead to memory corruption.Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1145389#c3)• 10 years ago |
|  | |

Attached patch

[patch - Add gralloc allocation requet size check](attachment.cgi?id=8582566&action=diff) (obsolete)
— [Details](attachment.cgi?id=8582566&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8582566)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a417047_434202)• 10 years ago |

[Attachment #8582566](/attachment.cgi?id=8582566&action=edit "patch - Add gralloc allocation requet size check") -
Flags: review?(nical.bugzilla)

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1145389#c4)• 10 years ago |
|  | |

Comment on [attachment 8582566](/attachment.cgi?id=8582566 "patch - Add gralloc allocation requet size check") [[details]](/attachment.cgi?id=8582566&action=edit "patch - Add gralloc allocation requet size check") [[diff]](/attachment.cgi?id=8582566&action=diff "patch - Add gralloc allocation requet size check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8582566)
patch - Add gralloc allocation requet size check
Review of [attachment 8582566](/attachment.cgi?id=8582566 "patch - Add gralloc allocation requet size check") [[details]](/attachment.cgi?id=8582566&action=edit "patch - Add gralloc allocation requet size check") [[diff]](/attachment.cgi?id=8582566&action=diff "patch - Add gralloc allocation requet size check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8582566):
-----------------------------------------------------------------
::: gfx/layers/ipc/SharedBufferManagerParent.cpp
@@ +210,5 @@
> \*aHandle = null\_t();
>
> if (aFormat == 0 || aUsage == 0) {
> printf\_stderr("SharedBufferManagerParent::RecvAllocateGrallocBuffer -- format and usage must be non-zero");
> return true;
Should we be returning false here also?

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1145389#c5)• 10 years ago |
|  | |

(In reply to Ben Turner <unresponsive until 3/30> (use the needinfo flag!) from [comment #4](/show_bug.cgi?id=1145389#c4 "RESOLVED FIXED - Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer"))
> Comment on [attachment 8582566](/attachment.cgi?id=8582566 "patch - Add gralloc allocation requet size check") [[details]](/attachment.cgi?id=8582566&action=edit "patch - Add gralloc allocation requet size check") [[diff]](/attachment.cgi?id=8582566&action=diff "patch - Add gralloc allocation requet size check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8582566)
> patch - Add gralloc allocation requet size check
>
> Review of [attachment 8582566](/attachment.cgi?id=8582566 "patch - Add gralloc allocation requet size check") [[details]](/attachment.cgi?id=8582566&action=edit "patch - Add gralloc allocation requet size check") [[diff]](/attachment.cgi?id=8582566&action=diff "patch - Add gralloc allocation requet size check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8582566):
> -----------------------------------------------------------------
>
> ::: gfx/layers/ipc/SharedBufferManagerParent.cpp
> @@ +210,5 @@
> > \*aHandle = null\_t();
> >
> > if (aFormat == 0 || aUsage == 0) {
> > printf\_stderr("SharedBufferManagerParent::RecvAllocateGrallocBuffer -- format and usage must be non-zero");
> > return true;
>
> Should we be returning false here also?
Yes. "return false" is better.

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1145389#c6)• 10 years ago |
|  | |

Attached patch

[patch - Add gralloc allocation requet size check](attachment.cgi?id=8583063&action=diff)
— [Details](attachment.cgi?id=8583063&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8583063)

[Attachment #8582566](/attachment.cgi?id=8582566&action=edit "patch - Add gralloc allocation requet size check") -
Attachment is obsolete: true
[Attachment #8582566](/attachment.cgi?id=8582566&action=edit "patch - Add gralloc allocation requet size check") -
Flags: review?(nical.bugzilla)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a486687_434202)• 10 years ago |

[Attachment #8583063](/attachment.cgi?id=8583063&action=edit "patch - Add gralloc allocation requet size check") -
Flags: review?(nical.bugzilla)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a487360_434202)• 10 years ago |

Assignee: nobody → sotaro.ikeda.g

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a489032_438998)• 10 years ago |

[Attachment #8583063](/attachment.cgi?id=8583063&action=edit "patch - Add gralloc allocation requet size check") -
Flags: review?(nical.bugzilla) → review+

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1145389#c7)• 10 years ago |
|  | |

Comment on [attachment 8583063](/attachment.cgi?id=8583063 "patch - Add gralloc allocation requet size check") [[details]](/attachment.cgi?id=8583063&action=edit "patch - Add gralloc allocation requet size check") [[diff]](/attachment.cgi?id=8583063&action=diff "patch - Add gralloc allocation requet size check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8583063)
patch - Add gralloc allocation requet size check
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
> Not easy
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
> No. It is not clear from the comment.
Which older supported branches are affected by this flaw?
> all b2g that uses gralloc buffer since [Bug 765734](/show_bug.cgi?id=765734 "RESOLVED FIXED - add gralloc-based layer buffers for gonk") fix.
If not all supported branches, which bug introduced the flaw?
> all b2g since gralloc support by [Bug 76573](/show_bug.cgi?id=76573 "VERIFIED WORKSFORME - BG Netbank Denmark [LAYER]JavaScript that doesn't work") fix.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
> The patch could be created relatively easily.
How likely is this patch to cause regressions; how much testing does it need?
> low risk of regressions. tryserver test is enough.
[Attachment #8583063](/attachment.cgi?id=8583063&action=edit "patch - Add gralloc allocation requet size check") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1145389#c8)• 10 years ago |
|  | |

This can't affect Firefox builds, only B2G?Flags: needinfo?(sotaro.ikeda.g)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1145389#c9)• 10 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #8](/show_bug.cgi?id=1145389#c8 "RESOLVED FIXED - Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer"))
> This can't affect Firefox builds, only B2G?
It affects only b2g gonk.Flags: needinfo?(sotaro.ikeda.g)

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1145389#c10)• 10 years ago |
|  | |

Comment on [attachment 8583063](/attachment.cgi?id=8583063 "patch - Add gralloc allocation requet size check") [[details]](/attachment.cgi?id=8583063&action=edit "patch - Add gralloc allocation requet size check") [[diff]](/attachment.cgi?id=8583063&action=diff "patch - Add gralloc allocation requet size check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8583063)
patch - Add gralloc allocation requet size check
Review of [attachment 8583063](/attachment.cgi?id=8583063 "patch - Add gralloc allocation requet size check") [[details]](/attachment.cgi?id=8583063&action=edit "patch - Add gralloc allocation requet size check") [[diff]](/attachment.cgi?id=8583063&action=diff "patch - Add gralloc allocation requet size check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8583063):
-----------------------------------------------------------------
::: gfx/layers/ipc/SharedBufferManagerParent.cpp
@@ +216,5 @@
> + return false;
> + }
> +
> + if (aSize.width <= 0 || aSize.height <= 0) {
> + printf\_stderr("SharedBufferManagerParent::RecvAllocateGrallocBuffer -- requested gralloc buffer size is invalid");
Probably worth using gfxWarning() rather than printf\_stderr, and replacing the other occurrence of the printf\_stderr above as well.

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1145389#c11)• 10 years ago |
|  | |

(In reply to Milan Sreckovic [:milan] from [comment #10](/show_bug.cgi?id=1145389#c10 "RESOLVED FIXED - Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer"))
>
> Probably worth using gfxWarning() rather than printf\_stderr, and replacing
> the other occurrence of the printf\_stderr above as well.
It seems better to do it in another bug.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a499837_280903)• 10 years ago |

[Attachment #8583063](/attachment.cgi?id=8583063&action=edit "patch - Add gralloc allocation requet size check") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a501673_1689)• 10 years ago |

Blocks: [765734](/show_bug.cgi?id=765734 "RESOLVED FIXED - add gralloc-based layer buffers for gonk")
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=affected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected)
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=unaffected)
[status-firefox37](/buglist.cgi?f1=cf_status_firefox37&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox37&o1=equals&v1=unaffected)
[status-firefox38](/buglist.cgi?f1=cf_status_firefox38&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox38&o1=equals&v1=unaffected)
[status-firefox39](/buglist.cgi?f1=cf_status_firefox39&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox39&o1=equals&v1=unaffected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1145389#c12)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/628e263e2205>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1145389#c13)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/628e263e2205>Status: NEW → RESOLVEDClosed: 10 years ago
[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla39

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1145389#c14)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/021e9a34c39a>
<https://hg.mozilla.org/releases/mozilla-b2g34_v2_1/rev/aa80084c1ffc>
<https://hg.mozilla.org/releases/mozilla-b2g32_v2_0/rev/adb9d7679526>
<http://mxr.mozilla.org/mozilla-b2g30_v1_4/source/gfx/layers/ipc/ShadowLayerUtilsGralloc.cpp#291> looks like the relevant place to make the change on b2g30, but I'm not entirely sure what that should end up looking like. Can you please attach a branch patch? :)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=fixed)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed)
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)Flags: needinfo?(sotaro.ikeda.g)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1145389#c15)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-b2g34_v2_1s/rev/aa80084c1ffc>
<https://hg.mozilla.org/releases/mozilla-b2g32_v2_0m/rev/adb9d7679526>
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=fixed)
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=fixed)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1145389#c16)• 10 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM UTC-4] from [comment #14](/show_bug.cgi?id=1145389#c14 "RESOLVED FIXED - Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer"))
> <https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/021e9a34c39a>
> <https://hg.mozilla.org/releases/mozilla-b2g34_v2_1/rev/aa80084c1ffc>
> <https://hg.mozilla.org/releases/mozilla-b2g32_v2_0/rev/adb9d7679526>
>
> <http://mxr.mozilla.org/mozilla-b2g30_v1_4/source/gfx/layers/ipc/>
> ShadowLayerUtilsGralloc.cpp#291 looks like the relevant place to make the
> change on b2g30, but I'm not entirely sure what that should end up looking
> like. Can you please attach a branch patch? :)
I am going to crate a patch for v1.4.

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1145389#c17)• 10 years ago |
|  | |

Attached patch

[patch forb2g v1.4 - Add gralloc allocation requet size check](attachment.cgi?id=8584650&action=diff)
— [Details](attachment.cgi?id=8584650&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1145389&attachment=8584650)

Patch for b2g v1.4. Less risky patch. Carry "r=nical".Flags: needinfo?(sotaro.ikeda.g)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a670812_434202)• 10 years ago |

[Attachment #8584650](/attachment.cgi?id=8584650&action=edit "patch forb2g v1.4 - Add gralloc allocation requet size check") -
Flags: review+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1145389#c18)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/f31e7ac5347f>
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=fixed)

|  | [Julian Hector [:tedd] [:jhector]](/user_profile?user_id=506410)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1145389#c19)• 10 years ago |
|  | |

Maybe I am missing something, but it seems like the b2g-v1.4 doesn't have the greater than 4096 check, with this patch now, it only has the less than 0 check. Which means that 'height' and 'width' could have the maximum value of 0x7fffffff. I don't know if such a size would cause trouble, but I guess the 4096 check is there for a reason.

|  | [Julian Hector [:tedd] [:jhector]](/user_profile?user_id=506410)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1145389#c20)• 10 years ago |
|  | |

Never mind, sorry, it was a little further up.

|  | [Julian Hector [:tedd] [:jhector]](/user_profile?user_id=506410)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1145389#c21)• 10 years ago |
|  | |

I've been meaning to ask, does this bug qualify for a bounty?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1145389#c22)• 10 years ago |
|  | |

(In reply to Julian Hector [:tedd] from [comment #21](/show_bug.cgi?id=1145389#c21 "RESOLVED FIXED - Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer"))
> I've been meaning to ask, does this bug qualify for a bounty?
Please email security@mozilla.org and ask to have this bug nominated per our bounty policy process. See <https://www.mozilla.org/en-US/security/bug-bounty/> for details.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a4147444_280903)• 10 years ago |

Flags: sec-bounty?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1145389#c23)• 10 years ago |
|  | |

This is currently rated as high, but more as a precaution.
It looks exploitable for me, but can either of you take a look and tell us what you think?
See also <https://wiki.mozilla.org/Security_Severity_Ratings>Flags: needinfo?(sotaro.ikeda.g)Flags: needinfo?(nical.bugzilla)

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1145389#c24)• 10 years ago |
|  | |

(In reply to Frederik Braun [:freddyb] from [comment #23](/show_bug.cgi?id=1145389#c23 "RESOLVED FIXED - Upper bound check bypass due to signed compare in SharedBufferManagerParent::RecvAllocateGrallocBuffer"))
> This is currently rated as high, but more as a precaution.
> It looks exploitable for me, but can either of you take a look and tell us
> what you think?
> See also <https://wiki.mozilla.org/Security_Severity_Ratings>
As far as I can tell, the worst that can happen here is a child process asking for very big textures, which could cause the main process to run out of memory and in the worst case reboot the phone (or trigger a path where the allocation fails and we deref a null pointer on the child process which reboots the phone as well.
I don't think that this can be used to inject code or steal confidential data, but it could be used to cause the phone to reboot (provided the child process is already compromised and can manipulate the values it sends in this specific message).
According to the wiki page, I seems like this does not qualify as sec-critical or sec-high (I see the tag csectype-oom which looks appropriate).Flags: needinfo?(nical.bugzilla)

|  | [Sotaro Ikeda [:sotaro]](/user_profile?user_id=434202)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1145389#c25)• 10 years ago |
|  | |

I agree to nical.Flags: needinfo?(sotaro.ikeda.g)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1145389#c26)• 10 years ago |
|  | |

tedd: this now looks like a denial of service bug and not eligible for a bug bounty. If you disagree with that assessment please provide more information about how this could be exploited and ping us on #security or via email to reconsider.Flags: sec-bounty? → sec-bounty-Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Julian Hector [:tedd] [:jhector]](/user_profile?user_id=506410)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1145389#c27)• 10 years ago |
|  | |

Thank you dveditz, I don't disagree, I don't know enough about the code and would have to read into it.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a9636756_465475)• 10 years ago |

Whiteboard: [b2g-adv-main2.2+]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a14373307_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a40676986_1689)• 9 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1145389#a290280881_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1145389&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Julian Hector [:tedd] [:jhector]](/user_profile?user_id=506410)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


