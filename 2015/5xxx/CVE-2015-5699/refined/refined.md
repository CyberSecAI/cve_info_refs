- **Root cause of vulnerability**: The `clcmd_server` in Cumulus Linux fails to properly sanitize user-supplied labels in commands, leading to command injection.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability. The `clcmd_server` stops checking commands against the Rosetta (allowed commands) when it reaches a user-supplied label, passing the label and any appended commands directly to the shell.
- **Impact of exploitation**: Local privilege escalation to root, allowing an attacker to take full control of the system.
- **Attack vectors**: A local user can execute a crafted command using `cl-rctl` or similar tools that calls `clcmd_server` by appending a malicious command to a legitimate command with a user-supplied label. The appended command will be executed by the server as root.
- **Required attacker capabilities/position**: A user with local access to the system, and with the ability to execute commands using tools such as `cl-rctl`. It is not required that the user have sudo access, as in the provided example the user 'lab' was sudo-limited to cl-rctl, and still successfully exploited the vulnerability.