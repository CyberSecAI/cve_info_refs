Based on the provided content, here's the breakdown of the vulnerability:

**Root cause of vulnerability:** The standard survey module in Moodle was vulnerable to a Cross-Site Scripting (XSS) attack.

**Weaknesses/vulnerabilities present:**
*   **XSS vulnerability:** Students could inject malicious scripts into the survey module through their survey responses.

**Impact of exploitation:**
*   **Arbitrary JavaScript execution:** Successful exploitation would allow attackers to execute arbitrary JavaScript code within the context of other users' browsers who view the survey results or the survey module. This could lead to various malicious activities, such as:
    *   Stealing session cookies.
    *   Redirecting users to malicious websites.
    *   Defacing the website.
    *   Performing actions on behalf of the victim.

**Attack vectors:**
*   **Survey responses:** Students could inject malicious JavaScript code into their survey answers.

**Required attacker capabilities/position:**
*   **Authenticated user:** An attacker needs to be a student user with the ability to complete surveys.

**Affected Versions:**
*   Moodle versions 2.9 to 2.9.2, 2.8 to 2.8.8, 2.7 to 2.7.10, and earlier unsupported versions are affected.

**Patched Versions:**
*   Moodle versions 2.9.3, 2.8.9, and 2.7.11 contain the fix for this vulnerability.

**Additional Details:**
* The vulnerability was reported by Hugh Davenport.
* The issue was tracked as MDL-49940 in the Moodle issue tracker.
* The fix involved escaping user comments to prevent execution of injected scripts.