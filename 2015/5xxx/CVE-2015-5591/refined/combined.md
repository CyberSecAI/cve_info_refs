=== Content from www.zenphoto.org_29570773_20250125_010214.html ===


* [Bugtracker (GitHub)](https://github.com/zenphoto/zenphoto/issues?state=open "Bugtracker (GitHub)")
* [Get involved](/pages/get-involved/ "Get involved")
* [Stay tuned!](#footer "Get involved!")
* [Paid support](/pages/paid-support/ "Paid support")
* [Sponsors](/sponsors/ "Sponsors")

![fields](/zp-core/images/searchfields_icon.png "search options")

* \* Check/uncheck all \*
* Content
* Tags
* Title

[![ZenphotoCMS](/themes/zenphoto-theme/images/logo-new.png)ZenphotoCMS](/)

The *simpler* media website CMS

* [Home](/)
* [News](/news)
* [Demo](http://demo.zenphoto.org)
* [Screenshots](/screenshots/)
* [User Guide](/news/category/user-guide)
* [Forum](http://forum.zenphoto.org "Zenphoto forum")
* [Themes](/theme/)
* [Extensions](/news/category/extensions)
* [Showcase](/showcase/)

---

## Categories

* [All news](/news/ "All news")
* [News (325)](/news/category/news/ "News")
  + [Security (25)](/news/category/security/ "Security")
  + [Announcements (165)](/news/category/announcements/ "Announcements")
  + [Changelog (113)](/news/category/changelog/ "Changelog")
  + [Release (138)](/news/category/release/ "Release")
* [User guide (56)](/news/category/user-guide/ "User guide")
* [Extensions (282)](/news/category/extensions/ "Extensions")

---

Advertisements

[![ALL-INKL.COM - Webhosting Server Hosting Domain Provider](https://all-inkl.com/banner/all-inkl_banner_185x35_white.gif)](https://all-inkl.com/PA48F18DCC89C8D)

[![Advertise](/albums/storage/sponsor-placeholders/sponsorpalladium-placeholder-ad.gif)](/pages/advertise/ "Advertise")

---

![](/themes/zenphoto-theme/images/icon-forum.png)
### Like using Zenphoto? Donate!

Your support helps pay for this server, and helps development of zenphoto. Thank you!

Visit the [donations page](/pages/donations/ "donations page")

News
# Zenphoto 1.4.9 July 09, 2015

Categories:

* [Announcements](/news/category/announcements/ "Announcements"),
* [Changelog](/news/category/changelog/ "Changelog"),
* [News](/news/category/news/ "News"),
* [Release](/news/category/release/ "Release"),
* [Security](/news/category/security/ "Security")

## Content

1. [General](#--general)
2. [Small change for theme breadcrumbs](#--small-change-for-nbsp-theme-breadcrumbs)
3. [Plugins](#--plugins)
4. [Themes](#--themes)
5. [Translation updates:](#--translation-updates-)

## Contributors:

* [Tim Coen *(tim-coen)*](/pages/tim-coen/)
* [Michel Gagnon *(michel-gagnon)*](/pages/michel-gagnon/)
* [Tristan Harward *(trisweb)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/trisweb/)
* [Mark Headrick *(markrh)*](/pages/markrh/)
* [Jes *(jesdnissen)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/jesdnissen/)
* [Abhishek Malani *(amalani)*](/pages/amalani/)
* [momo-i![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/momo-i/)
* [Malte Müller *(acrylian)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/acrylian/)
* [Fred Sondaar *(fretzl)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/fretzl/)

This is a security and bugfix release.

## General

* Fixes several SQL Injection, XSS and path traversal security issues *[trisweb – Thanks to Tim Coen for the report and help]*
* Fixes issue with single image edit page if accessing via front end admin toolbox and "back" button to bulk edit page *[trisweb, acrylian – Thanks to MarkRH]*
* Fixes the zenphoto package file which caused an unnecessary file warning on running setup *[acrylian - Thanks to vincent3569]*
* Fixes function `getNotViewableImages()` that failed to exclude said images, e.g. used if "check tag access" for tag lists if tag\_suggest is enabled*[amalani]*
* Fixes wrong image/album search result order by title *[acrylian]*

## Small change for theme breadcrumbs

Normally on basic themes the gallery index is the same as the site index ( = home page). But on themes that set a custom gallery index page (e.g. Zenpage, Garland, Efferscene+) those are really different pages so the breadcrumb was actually wrong.

Therefore a new template function `printGalleryIndexURL()` has been introduced that automatically prints a home link if needed (e.g. printing *Home > Gallery index*) or the real index link where needed. This internally uses an also new function set of `get/printSiteHomeURL()` that always returns/prints the home page url.

This is additional functionality and your custom or customized theme doesn't require any update if you are fine with the old (wrong) behaviour.

## Plugins

* **sitemap-extended:** Fixes missing trailing slash in rewritten album URL's *[acrylian – Thanks to gingo for the note]*
* **html\_meta\_tags:**Maxspace options for open graph mages to be able to better cover general now bigger (and changing) sizes of various social media services and don't use thumb mode so watermarks set are used *[acrylian]*

## Themes

* **default:** Fixes missing clearing of footer causing the layout being misaligned *[fretzl]*

## Translation updates:

* Danish *[jesdnissen]*
* Dutch *[fretzl]*
* French *[Michel Gagnon]*
* German *[acrylian]*
* Japanese *[momo-i]*

*For questions and comments please use the [forum](http://www.zenphoto.org/support "Zenphoto forums") or discuss on the [social networks](#stay-tuned).*

## Related items

* ### [Zenphoto 1.6.5](/news/zenphoto-1.6.5/ "Zenphoto 1.6.5") (News)
* ### [Secure submitting of forms](/news/secure-submitting-of-forms/ "Secure submitting of forms") (User guide)
* ### [tinymce](/news/tinymce/ "tinymce") (Extensions)
* ### [Zenphoto 1.6.4](/news/zenphoto-1.6.4/ "Zenphoto 1.6.4") (News)
* ### [Zenphoto 1.6.3](/news/zenphoto-1.6.3/ "Zenphoto 1.6.3") (News)

### RSS feeds!

* [All news](/index.php?mergedrss "RSS all news") (incl. all below except forum)
* [All general news](/index.php?rss=news "RSS all general news") (except themes, showcase, screenshots)
* [New releases and announcements](/index.php?rss=news&category=news "RSS New releases and announcements")
* [User guide](/index.php?rss=news&category=user-guide "RSS User guide")
* [Extensions](/index.php?rss=news&category=extensions "RSS Extensions")
* [Screenshots and screencasts](/index.php?rss=gallery&folder=screenshots "RSS Screenshots	and screencasts")
* [Themes](/index.php?rss=gallery&folder=theme&albumsmode&sortorder=latest "RSS Themes")
* [Showcase](/index.php?rss=gallery&albumname=showcase "RSS Showcase")
* [Forum](http://forum.zenphoto.org/discussions/feed.rss)

### Social networks

* [Twitter](http://twitter.com/zenphotocms "Zenphoto on Twitter")
* [GitHub](https://github.com/zenphoto/zenphoto "Zenphoto on GitHub")
* [Facebook](https://www.facebook.com/zenphotocms "Zenphoto on Facebook")
* [Youtube](http://www.youtube.com/zenphotocms "Zenphoto on Youtube")

### Join the Google Group!

* [zenphoto-announce](https://groups.google.com/group/zenphoto-announce)
  Release announcements and security alerts only (no support)

  **Subscribe right here:**

  Email:

Website powered by Zenphoto

Forum powered by [Vanilla](https://open.vanillaforums.com)

### Information

* [About us](/pages/about-us/ "About us")
* [Contact](/pages/contact/ "Contact")
* [Get involved](/pages/get-involved/ "Get involved")
* [Paid support](/pages/paid-support/ "Paid support")
* [Advertise](/pages/advertise/ "Advertise")
* [Bugtracker (GitHub)](https://github.com/zenphoto/zenphoto/issues?state=open "Bugtracker (GitHub)")

### Legal stuff

* [Legal](/pages/legal/ "Legal")
* [Forum Terms Of Service](/pages/forum-terms-of-service/ "Forum Terms Of Service ")
* [Data Privacy Policy](/pages/data-privacy-policy/ "Data Privacy Policy")

![](https://stats.zenphoto.org/matomo.php?idsite=1&rec=1)



=== Content from packetstormsecurity.com_a5d502e6_20250125_010209.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.openwall.com_1aab11cd_20250125_010215.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2015/07/16/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150718154115.805846C00BB@smtpvmsrv1.mitre.org>
Date: Sat, 18 Jul 2015 11:41:15 -0400 (EDT)
From: cve-assign@...re.org
To: henri@...v.fi
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: Zenphoto before 1.4.9 multiple vulnerabilities

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Can I get CVEs for vulnerabilities fixed in Zenphoto 1.4.9 ...
> <http://www.zenphoto.org/news/zenphoto-1.4.9> says "Fixes several SQL Injection,
> XSS and path traversal

> <http://software-talk.org/blog/2015/07/second-order-sql-injection-reflected-xss-path-traversal-function-execution-vulnerability-zenphoto/>

For purposes of CVE assignments, one important part of this blog post
is:

  In practice, it doesn't matter, because an attacker can just edit a
  legitimate PHP theme file and inject <?php passthru($_GET['c']) ?>

In other words, it appears that the design of Zenphoto intentionally
gives the admin an ability to execute arbitrary code on the server.
This ability apparently also extends to users with the THEMES_RIGHTS
right. The researcher suggests:

  It is still a good idea to fix this, as users might disable the
  file edit functionality themselves to increase security.

We couldn't immediately find documentation suggesting that there is a
supported way to use the product without letting an admin execute
arbitrary code (e.g., by deleting/changing admin-themes-editor.php or
possibly other files). In general, the scope of CVE doesn't include
questionable behaviors that have security relevance only if a user
modifies a product.

Now, to consider the individual issues:

> There are multiple second order error based SQL injections into the
> ORDER BY keyword in the admin area.

This seems to allow exploitation by users who have only the
OPTIONS_RIGHTS right. Use CVE-2015-5591.

> XSS 1
> sanitize_string, which does not adequately protect against any attacks

The product is apparently trying to prevent all XSS but has three
independent types of mistakes described by the researcher.

>       $content = preg_replace('~<script.*?/script>~is', '', $content);
>       $content = preg_replace('~<style.*?/style>~is', '', $content);

>       $content = strip_tags($content);

Identifying only a short list of relevant elements (e.g., SCRIPT and
STYLE) and relying on strip_tags are both incomplete protection
mechanisms. Use CVE-2015-5592.

This specific use of preg_replace also has an implementation error,
noted by the researcher in the first "can be easily bypassed" example
involving multiple SCRIPT elements. Use CVE-2015-5593.

>       $content = html_entity_decode($content, ENT_QUOTES, 'UTF-8');

Finally, the placement of html_entity_decode after input sanitization
is inconsistent with the function's purpose. Use CVE-2015-5594.

> Directory Traversal

This has no CVE ID because it doesn't cross privilege boundaries.

> XSS 2
> admin.php?action=external&error=" onmouseover="alert('xsstest')" foo="bar

We don't think this is an independent type of issue. admin.php has a
call to sanitize($_GET['error']), and this seems to use
sanitize_string. The three CVE IDs related to sanitize_string also
apply to this admin.php behavior.

> Execute Function
> admin.php?action=phpinfo

> An admin user can execute any function they want via this URL (there
> is also no CSRF protection for it)

> I'm reporting this because as defense in depth, it's a good idea to
> not allow execution of arbitrary functions. I have not found a way to
> actually exploit it

We feel that action=ingres_connect seems to be a relevant example.
<http://php.net/manual/function.ingres-connect.php> says "If some
parameters are missing, ingres_connect() uses the values in php.ini
for ingres.default_database, ingres.default_user and
ingres.default_password." This is, more or less, a CSRF with resultant
SSRF: the attacker can cause a denial of service by triggering many
connections to a (victim-specified) remote Ingres database.

Use CVE-2015-5595 for this CSRF issue. An intentional call to
admin.php?action= doesn't cross privilege boundaries because it
requires that the attacker is an admin.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVqm1+AAoJEKllVAevmvms2ccH/3lD5AOAzdh9YtJBP+rBv4OO
RMb0QpjWKcEWjXXMZzLeYQLiHX0HG63+NIpTajrTgCMRoWyjZB+ay+XkH6mbFvB3
wiMm9IP6IVx7nfc8jzJLJtHfMrGgczr06i0sUPWoncVE1nIv6ErS/qrCbW7CL2BU
/0lkuWeX4G18aANWrULuxKxrzLhx+fy4jvSHNQPab6Hje6amxEtQZkxp3df2oHIT
/CFICBItz4mo3JvuhMJqzFGoqp+C+itPwO+S+9Uromw7XIA/aztdUesDANY2OjvH
eso6opnRHWql4WfKvR9TyuLio54kK96BaD61H6nCahcoe6J2BYP19wP4nlzf8RE=
=/q0j
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


