The provided content relates to CVE-2015-5340.

**Root cause of vulnerability:**
The vulnerability stems from the fact that the capability `moodle/badges:viewbadges` was not being properly respected.

**Weaknesses/vulnerabilities present:**
The primary vulnerability is an insufficient access control, allowing logged-in users, who do not have the specific permission 'View available badges without earning them', to still access the full list of badges. This means the system failed to enforce the intended access restrictions related to badge viewing.

**Impact of exploitation:**
The impact of this vulnerability is considered "Minor." Exploitation would allow unauthorized users to view the full list of available badges, which they shouldn't have access to without earning them.

**Attack vectors:**
The attack vector is through the application's web interface. A logged-in user could access the list of badges even without the appropriate permission.

**Required attacker capabilities/position:**
The attacker needs to be a logged-in user on the Moodle platform. No other special capabilities or privileges are necessary.

**Versions affected:**
Moodle versions 2.9 to 2.9.2, 2.8 to 2.8.8, 2.7 to 2.7.10 and earlier unsupported versions are affected by this vulnerability.

**Versions fixed:**
The vulnerability is fixed in Moodle versions 2.9.3, 2.8.9 and 2.7.11.