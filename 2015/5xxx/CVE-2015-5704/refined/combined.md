=== Content from bugs.debian.org_7483f06d_20250126_034956.html ===

# Debian Bug report logs - #794260 devscripts: licensecheck: CVE-2015-5704: shell injection vulnerability

[![version graph](version.cgi?width=2;height=2;fixed=devscripts%2F2.15.7;found=devscripts%2F2.15.6;found=devscripts%2F2.15.5;absolute=0;collapse=1;package=devscripts)](version.cgi?absolute=0;found=devscripts%2F2.15.6;found=devscripts%2F2.15.5;collapse=1;info=1;package=devscripts;fixed=devscripts%2F2.15.7)

Package:
[devscripts](pkgreport.cgi?package=devscripts);
Maintainer for [devscripts](pkgreport.cgi?package=devscripts) is [Devscripts Maintainers <devscripts@packages.debian.org>](pkgreport.cgi?maint=devscripts%40packages.debian.org); Source for [devscripts](pkgreport.cgi?package=devscripts) is [src:devscripts](pkgreport.cgi?src=devscripts) ([PTS](https://tracker.debian.org/pkg/devscripts), [buildd](https://buildd.debian.org/devscripts), [popcon](https://qa.debian.org/popcon.php?package=devscripts)).

Reported by: [Jonas Smedegaard <dr@jones.dk>](pkgreport.cgi?submitter=dr%40jones.dk)

Date: Fri, 31 Jul 2015 18:45:14 UTC

Severity: *grave*

Tags: patch, security

Found in versions devscripts/2.15.6, devscripts/2.15.5

Fixed in version devscripts/2.15.7

**Done:** James McCoy <jamessan@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=794260;mbox=yes), [status mbox](bugreport.cgi?bug=794260;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=794260;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`:

`Bug#794260`; Package `devscripts`.
(Fri, 31 Jul 2015 18:45:17 GMT) ([full text](bugreport.cgi?bug=794260;msg=2), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Jonas Smedegaard <dr@jones.dk>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`.
(Fri, 31 Jul 2015 18:45:18 GMT) ([full text](bugreport.cgi?bug=794260;msg=4), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=5), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=dr%40jones.dk)
From: Jonas Smedegaard <dr@jones.dk>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: devscripts: licensecheck chokes on files containing space
Date: Fri, 31 Jul 2015 20:44:12 +0200
```
Package: devscripts
Version: 2.15.6
Severity: grave
Tags: security patch
Justification: user security hole

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On line 324 of licensecheck is executed this shell code:

  file --brief --mime --dereference $file

That will fail if the input file contains space, and may do horrible
things with input files containing semicolon.

Fix is simple: Add quotes around the variable, so line 324 looks like
this:

    my $mime = `file --brief --mime --dereference "$file"`;

 - Jonas

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJVu8H2AAoJECx8MUbBoAEhFwAP+wYs9y6MjavimltBk7DbMmV9
TrYB/TcAQyv9zHw4OS/qJqHUf8W7fU+WsugCnWEfKpX1zBKVT4cXYTiB9bz43ayB
eZoykVxP5xe7OTVM1m96lDjy4hUC0sK/jQ8+iPP29apWFLGAJKVGYBKn/5qDNd4v
FZpCoUuy4aFIKCCzQ/1cIhPG8K6xekiQRYqczH2tFoyAD9kN5w3ybxtuMob0SgMY
tEpqfRrxVwLJNMjae1aUa/4gwfEo1TUT94bgsAihtBKR+QE645MgBvu1duNoAR2+
9o3c1/FB+ryNFraPNkrU8P0Y81Bv5Bf2XXd/1QxZe2IatBgZZMw36nISyqnsJBeP
6esh9sI8jgnMYz5CNN+jV681vqBfU4l/ZBEpmiYs04uR0Gn/arDt5TrSQAYvPLIY
D/aR4oUqO5Pwf2zXKNHgzSU7Ubh7I4a0k3TQwq6/mTzTBcpwvZXoTwEisA7JVhsP
SOKWc+j4E8ueDFgdL6/65HaNAwi7VYcG72EHlQ5CRGsWN61ejkJcjq/LiNajIELo
IvU40b/X3D/sjf6TbgWdHUl5S5ogzJiRpLfzBfkKAoY76DqcJ21M5Z+MVk98T9yF
OjqMzCFWduQ6NsZwNQq7YLeotx8Y1qaebxEDg1QWuGf9Fh5dQQH7PAnXi26u51ZM
a5cD5Cr9fCoXidVYrJhK
=RNm9
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`:

`Bug#794260`; Package `devscripts`.
(Fri, 31 Jul 2015 19:36:08 GMT) ([full text](bugreport.cgi?bug=794260;msg=7), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=7), [link](#6)).

---

[Message #8](#8) received at 794260@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=8), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=8), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: Jonas Smedegaard <dr@jones.dk>, 794260@bugs.debian.org
Subject: Re: Bug#794260: devscripts: licensecheck chokes on files containing
space
Date: Fri, 31 Jul 2015 21:32:33 +0200
```
* Jonas Smedegaard <dr@jones.dk>, 2015-07-31, 20:44:
>On line 324 of licensecheck is executed this shell code:
>
>  file --brief --mime --dereference $file
>
>That will fail if the input file contains space, and may do horrible
>things with input files containing semicolon.
>
>Fix is simple: Add quotes around the variable, so line 324 looks like
>this:
>
>    my $mime = `file --brief --mime --dereference "$file"`;

Note that $file is expanded by Perl, not by shell, so this change is not
sufficient:
| $ touch '"; cowsay moo; #.c'
| $ licensecheck *.c
| /usr/bin/licensecheck warning: cannot parse file '"; cowsay moo; #.c' with mime type 'cannot open `' (No such file or directory)
|  _____
| < moo >
|  -----
|         \   ^__^
|          \  (oo)\_______
|             (__)\       )\/\
|                 ||----w |
|                 ||     ||'

(If the variable were expanded by shell, command injection wouldn't be
even possible. You could still exploit argument injection, but that's
less exciting.)

--
Jakub Wilk

```

---

**Marked as found in versions devscripts/2.15.5.**
Request was from `James McCoy <jamessan@debian.org>`
to `control@bugs.debian.org`.
(Fri, 31 Jul 2015 23:51:04 GMT) ([full text](bugreport.cgi?bug=794260;msg=10), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=10), [link](#9)).

---

**Added tag(s) pending.**
Request was from `James McCoy <jamessan@debian.org>`
to `control@bugs.debian.org`.
(Sat, 01 Aug 2015 00:48:06 GMT) ([full text](bugreport.cgi?bug=794260;msg=12), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=12), [link](#11)).

---

**Message sent on**
to `Jonas Smedegaard <dr@jones.dk>`:

Bug#794260.
(Sat, 01 Aug 2015 00:48:15 GMT) ([full text](bugreport.cgi?bug=794260;msg=14), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 794260-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=15), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James McCoy <jamessan@debian.org>
To: 794260-submitter@bugs.debian.org
Subject: Bug#794260 marked as pending
Date: Sat, 01 Aug 2015 00:46:26 +0000
```
tag 794260 pending
thanks

Hello,

Bug #794260 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=collab-maint/devscripts.git;a=commitdiff;h=c0687bc>

---
commit c0687bcde23108dd42e146573c368b6905e6b8e8
Author: James McCoy <jamessan@debian.org>
Date:   Fri Jul 31 19:56:36 2015 -0400

    licensecheck: Use Dpkg::IPC to run file command

    The command being run through `` allowed the shell to interpret the
    given file argument, which allows arbitrary command execution.  Using
    Dpkg::IPC avoids the shell, directly executing file.

    Closes: #[794260](bugreport.cgi?bug=794260)
    Signed-off-by: James McCoy <jamessan@debian.org>

diff --git a/debian/changelog b/debian/changelog
index a9cd9cb..6536846 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,10 @@
+devscripts (2.15.7) UNRELEASED; urgency=medium
+
+  * licensecheck:
+    + Use Dpkg::IPC to run file to avoid shell injection.  (Closes: #[794260](bugreport.cgi?bug=794260))
+
+ -- James McCoy <jamessan@debian.org>  Fri, 31 Jul 2015 19:53:04 -0400
+
 devscripts (2.15.6) unstable; urgency=medium

   [ Paul Wise ]

```

---

**Reply sent**
to `James McCoy <jamessan@debian.org>`:

You have taken responsibility.
(Sat, 01 Aug 2015 03:39:05 GMT) ([full text](bugreport.cgi?bug=794260;msg=17), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=17), [link](#16)).

---

**Notification sent**
to `Jonas Smedegaard <dr@jones.dk>`:

Bug acknowledged by developer.
(Sat, 01 Aug 2015 03:39:05 GMT) ([full text](bugreport.cgi?bug=794260;msg=19), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 794260-close@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=20), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James McCoy <jamessan@debian.org>
To: 794260-close@bugs.debian.org
Subject: Bug#794260: fixed in devscripts 2.15.7
Date: Sat, 01 Aug 2015 03:34:57 +0000
```
Source: devscripts
Source-Version: 2.15.7

We believe that the bug you reported is fixed in the latest version of
devscripts, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 794260@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James McCoy <jamessan@debian.org> (supplier of updated devscripts package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Fri, 31 Jul 2015 22:50:33 -0400
Source: devscripts
Binary: devscripts
Architecture: source
Version: 2.15.7
Distribution: unstable
Urgency: medium
Maintainer: Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>
Changed-By: James McCoy <jamessan@debian.org>
Closes: [794260](bugreport.cgi?bug=794260) [794263](bugreport.cgi?bug=794263) [794282](bugreport.cgi?bug=794282)
Description:
 devscripts - scripts to make the life of a Debian Package maintainer easier
Changes:
 devscripts (2.15.7) unstable; urgency=medium
 .
   * licensecheck:
     + Use Dpkg::IPC to run file to avoid shell injection.  (Closes: #[794260](bugreport.cgi?bug=794260))
     + Change whitelist of mime types to greylist of encodings.  Restores
       ability to check files with mime types like text/x-c++ and
       application/postscript.  Thanks to Jonas Smedegaard for the patch.
       (Closes: #[794282](bugreport.cgi?bug=794282))
     + Fix an endless loop in parsing certain files.  Thanks to Jonas
       Smedegaard for the patch.  (Closes: #[794263](bugreport.cgi?bug=794263))
Checksums-Sha1:
 e1368f617e07f74cb0bcd41e6202ede27d42d784 2257 devscripts_2.15.7.dsc
 4f01f5b1a9f118aebf66461adf46e0e830731f47 620100 devscripts_2.15.7.tar.xz
Checksums-Sha256:
 daee3c021a6f44fe05e7568196c5eb55d34fbb6238f341a7fcf8443caa126ec5 2257 devscripts_2.15.7.dsc
 7eadef203bc50612af70fb0047b5225a7f2b5fdaacd45c2df09126fcc1aed027 620100 devscripts_2.15.7.tar.xz
Files:
 e5b6f0e0c29dca1b3f37f3713ec7e75a 2257 devel optional devscripts_2.15.7.dsc
 1655e2c91e42cd48393c65726bc3faa9 620100 devel optional devscripts_2.15.7.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQJ8BAEBCgBmBQJVvDcKXxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ5MUJGQkY0RDY5NTZCRDVERjdCNzJEMjNE
RkU2OTFBRTMzMUJBM0RCAAoJEN/mka4zG6PbXJwQAJiTiBnnINA0iMvImKmRRxMl
8hBGGBI7+dhsoDeDAcS4z1Dg4NzkarF+kg51JbUrgOkRBNevJXheqhM+tM40xjPG
DDfXSOKTcm0MLKJlr79BevQ1wCE/xoWygTWLvChAEL6exDnjauv2vGJhFvvwwkkS
ILyJYNl50bqM56SZc3PXRdV7GDd8Az6qGFHihsSN4i0+7JIV4z4WjKd1IRg79uxs
lNvFCt+FPFhsRdYlzzLlrxDMDeC2sFHkt9cdg+3JdNojC97In2VZ02fTXCI7hA20
fvMKk+3esPhVkdv8pBGAAaKJsCaCV4kd97w9/L12sjC7pMsakiX2QVD83m5UCUKb
ETuqttftEX857+2ZMLk9o26t3HFbv7jTv1Rcs99+XVe3pzJdGYa7XwmQlP1ROZwv
xvsNGbdwoGOf8biGKdcR6jyAl5WixtgKJpD6eluOD/jcazMiI/F38sDrCaM/opYd
uMewMR3MCpuKh+fvcIPxbuj6mAULjyBOmAZyypWk4whqpslZxf+f3/LejDL7tSMo
+cUtYSrYRWmychmCrzC+czr8GtZ4epDgiuprXvSvSS95UsGzYVqLPvtB3rq/+s7i
Wy2jgMYUuz1PcnBiCom8ek8BNIl6LcX7BzDwUZwtWPoXKQp7F5QZwhqYwplYnbFG
k7dyXY+do50+JpJ2rAZB
=4pg9
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'devscripts: licensecheck: CVE-2015-5704: shell injection vulnerability' from 'devscripts: licensecheck chokes on files containing space'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Sun, 02 Aug 2015 07:33:13 GMT) ([full text](bugreport.cgi?bug=794260;msg=22), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=22), [link](#21)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 02 Sep 2015 07:32:59 GMT) ([full text](bugreport.cgi?bug=794260;msg=24), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=24), [link](#23)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=794260).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 03:49:55 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from bugs.debian.org_f5eeeaf6_20250124_220458.html ===

# Debian Bug report logs - #794260 devscripts: licensecheck: CVE-2015-5704: shell injection vulnerability

[![version graph](version.cgi?found=devscripts%2F2.15.6;found=devscripts%2F2.15.5;fixed=devscripts%2F2.15.7;width=2;collapse=1;package=devscripts;absolute=0;height=2)](version.cgi?collapse=1;absolute=0;package=devscripts;fixed=devscripts%2F2.15.7;found=devscripts%2F2.15.6;found=devscripts%2F2.15.5;info=1)

Package:
[devscripts](pkgreport.cgi?package=devscripts);
Maintainer for [devscripts](pkgreport.cgi?package=devscripts) is [Devscripts Maintainers <devscripts@packages.debian.org>](pkgreport.cgi?maint=devscripts%40packages.debian.org); Source for [devscripts](pkgreport.cgi?package=devscripts) is [src:devscripts](pkgreport.cgi?src=devscripts) ([PTS](https://tracker.debian.org/pkg/devscripts), [buildd](https://buildd.debian.org/devscripts), [popcon](https://qa.debian.org/popcon.php?package=devscripts)).

Reported by: [Jonas Smedegaard <dr@jones.dk>](pkgreport.cgi?submitter=dr%40jones.dk)

Date: Fri, 31 Jul 2015 18:45:14 UTC

Severity: *grave*

Tags: patch, security

Found in versions devscripts/2.15.6, devscripts/2.15.5

Fixed in version devscripts/2.15.7

**Done:** James McCoy <jamessan@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=794260;mbox=yes), [status mbox](bugreport.cgi?bug=794260;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=794260;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`:

`Bug#794260`; Package `devscripts`.
(Fri, 31 Jul 2015 18:45:17 GMT) ([full text](bugreport.cgi?bug=794260;msg=2), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Jonas Smedegaard <dr@jones.dk>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`.
(Fri, 31 Jul 2015 18:45:18 GMT) ([full text](bugreport.cgi?bug=794260;msg=4), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=5), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=dr%40jones.dk)
From: Jonas Smedegaard <dr@jones.dk>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: devscripts: licensecheck chokes on files containing space
Date: Fri, 31 Jul 2015 20:44:12 +0200
```
Package: devscripts
Version: 2.15.6
Severity: grave
Tags: security patch
Justification: user security hole

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On line 324 of licensecheck is executed this shell code:

  file --brief --mime --dereference $file

That will fail if the input file contains space, and may do horrible
things with input files containing semicolon.

Fix is simple: Add quotes around the variable, so line 324 looks like
this:

    my $mime = `file --brief --mime --dereference "$file"`;

 - Jonas

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJVu8H2AAoJECx8MUbBoAEhFwAP+wYs9y6MjavimltBk7DbMmV9
TrYB/TcAQyv9zHw4OS/qJqHUf8W7fU+WsugCnWEfKpX1zBKVT4cXYTiB9bz43ayB
eZoykVxP5xe7OTVM1m96lDjy4hUC0sK/jQ8+iPP29apWFLGAJKVGYBKn/5qDNd4v
FZpCoUuy4aFIKCCzQ/1cIhPG8K6xekiQRYqczH2tFoyAD9kN5w3ybxtuMob0SgMY
tEpqfRrxVwLJNMjae1aUa/4gwfEo1TUT94bgsAihtBKR+QE645MgBvu1duNoAR2+
9o3c1/FB+ryNFraPNkrU8P0Y81Bv5Bf2XXd/1QxZe2IatBgZZMw36nISyqnsJBeP
6esh9sI8jgnMYz5CNN+jV681vqBfU4l/ZBEpmiYs04uR0Gn/arDt5TrSQAYvPLIY
D/aR4oUqO5Pwf2zXKNHgzSU7Ubh7I4a0k3TQwq6/mTzTBcpwvZXoTwEisA7JVhsP
SOKWc+j4E8ueDFgdL6/65HaNAwi7VYcG72EHlQ5CRGsWN61ejkJcjq/LiNajIELo
IvU40b/X3D/sjf6TbgWdHUl5S5ogzJiRpLfzBfkKAoY76DqcJ21M5Z+MVk98T9yF
OjqMzCFWduQ6NsZwNQq7YLeotx8Y1qaebxEDg1QWuGf9Fh5dQQH7PAnXi26u51ZM
a5cD5Cr9fCoXidVYrJhK
=RNm9
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`:

`Bug#794260`; Package `devscripts`.
(Fri, 31 Jul 2015 19:36:08 GMT) ([full text](bugreport.cgi?bug=794260;msg=7), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=7), [link](#6)).

---

[Message #8](#8) received at 794260@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=8), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=8), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: Jonas Smedegaard <dr@jones.dk>, 794260@bugs.debian.org
Subject: Re: Bug#794260: devscripts: licensecheck chokes on files containing
space
Date: Fri, 31 Jul 2015 21:32:33 +0200
```
* Jonas Smedegaard <dr@jones.dk>, 2015-07-31, 20:44:
>On line 324 of licensecheck is executed this shell code:
>
>  file --brief --mime --dereference $file
>
>That will fail if the input file contains space, and may do horrible
>things with input files containing semicolon.
>
>Fix is simple: Add quotes around the variable, so line 324 looks like
>this:
>
>    my $mime = `file --brief --mime --dereference "$file"`;

Note that $file is expanded by Perl, not by shell, so this change is not
sufficient:
| $ touch '"; cowsay moo; #.c'
| $ licensecheck *.c
| /usr/bin/licensecheck warning: cannot parse file '"; cowsay moo; #.c' with mime type 'cannot open `' (No such file or directory)
|  _____
| < moo >
|  -----
|         \   ^__^
|          \  (oo)\_______
|             (__)\       )\/\
|                 ||----w |
|                 ||     ||'

(If the variable were expanded by shell, command injection wouldn't be
even possible. You could still exploit argument injection, but that's
less exciting.)

--
Jakub Wilk

```

---

**Marked as found in versions devscripts/2.15.5.**
Request was from `James McCoy <jamessan@debian.org>`
to `control@bugs.debian.org`.
(Fri, 31 Jul 2015 23:51:04 GMT) ([full text](bugreport.cgi?bug=794260;msg=10), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=10), [link](#9)).

---

**Added tag(s) pending.**
Request was from `James McCoy <jamessan@debian.org>`
to `control@bugs.debian.org`.
(Sat, 01 Aug 2015 00:48:06 GMT) ([full text](bugreport.cgi?bug=794260;msg=12), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=12), [link](#11)).

---

**Message sent on**
to `Jonas Smedegaard <dr@jones.dk>`:

Bug#794260.
(Sat, 01 Aug 2015 00:48:15 GMT) ([full text](bugreport.cgi?bug=794260;msg=14), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 794260-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=15), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James McCoy <jamessan@debian.org>
To: 794260-submitter@bugs.debian.org
Subject: Bug#794260 marked as pending
Date: Sat, 01 Aug 2015 00:46:26 +0000
```
tag 794260 pending
thanks

Hello,

Bug #794260 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=collab-maint/devscripts.git;a=commitdiff;h=c0687bc>

---
commit c0687bcde23108dd42e146573c368b6905e6b8e8
Author: James McCoy <jamessan@debian.org>
Date:   Fri Jul 31 19:56:36 2015 -0400

    licensecheck: Use Dpkg::IPC to run file command

    The command being run through `` allowed the shell to interpret the
    given file argument, which allows arbitrary command execution.  Using
    Dpkg::IPC avoids the shell, directly executing file.

    Closes: #[794260](bugreport.cgi?bug=794260)
    Signed-off-by: James McCoy <jamessan@debian.org>

diff --git a/debian/changelog b/debian/changelog
index a9cd9cb..6536846 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,10 @@
+devscripts (2.15.7) UNRELEASED; urgency=medium
+
+  * licensecheck:
+    + Use Dpkg::IPC to run file to avoid shell injection.  (Closes: #[794260](bugreport.cgi?bug=794260))
+
+ -- James McCoy <jamessan@debian.org>  Fri, 31 Jul 2015 19:53:04 -0400
+
 devscripts (2.15.6) unstable; urgency=medium

   [ Paul Wise ]

```

---

**Reply sent**
to `James McCoy <jamessan@debian.org>`:

You have taken responsibility.
(Sat, 01 Aug 2015 03:39:05 GMT) ([full text](bugreport.cgi?bug=794260;msg=17), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=17), [link](#16)).

---

**Notification sent**
to `Jonas Smedegaard <dr@jones.dk>`:

Bug acknowledged by developer.
(Sat, 01 Aug 2015 03:39:05 GMT) ([full text](bugreport.cgi?bug=794260;msg=19), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 794260-close@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=20), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James McCoy <jamessan@debian.org>
To: 794260-close@bugs.debian.org
Subject: Bug#794260: fixed in devscripts 2.15.7
Date: Sat, 01 Aug 2015 03:34:57 +0000
```
Source: devscripts
Source-Version: 2.15.7

We believe that the bug you reported is fixed in the latest version of
devscripts, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 794260@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James McCoy <jamessan@debian.org> (supplier of updated devscripts package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Fri, 31 Jul 2015 22:50:33 -0400
Source: devscripts
Binary: devscripts
Architecture: source
Version: 2.15.7
Distribution: unstable
Urgency: medium
Maintainer: Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>
Changed-By: James McCoy <jamessan@debian.org>
Closes: [794260](bugreport.cgi?bug=794260) [794263](bugreport.cgi?bug=794263) [794282](bugreport.cgi?bug=794282)
Description:
 devscripts - scripts to make the life of a Debian Package maintainer easier
Changes:
 devscripts (2.15.7) unstable; urgency=medium
 .
   * licensecheck:
     + Use Dpkg::IPC to run file to avoid shell injection.  (Closes: #[794260](bugreport.cgi?bug=794260))
     + Change whitelist of mime types to greylist of encodings.  Restores
       ability to check files with mime types like text/x-c++ and
       application/postscript.  Thanks to Jonas Smedegaard for the patch.
       (Closes: #[794282](bugreport.cgi?bug=794282))
     + Fix an endless loop in parsing certain files.  Thanks to Jonas
       Smedegaard for the patch.  (Closes: #[794263](bugreport.cgi?bug=794263))
Checksums-Sha1:
 e1368f617e07f74cb0bcd41e6202ede27d42d784 2257 devscripts_2.15.7.dsc
 4f01f5b1a9f118aebf66461adf46e0e830731f47 620100 devscripts_2.15.7.tar.xz
Checksums-Sha256:
 daee3c021a6f44fe05e7568196c5eb55d34fbb6238f341a7fcf8443caa126ec5 2257 devscripts_2.15.7.dsc
 7eadef203bc50612af70fb0047b5225a7f2b5fdaacd45c2df09126fcc1aed027 620100 devscripts_2.15.7.tar.xz
Files:
 e5b6f0e0c29dca1b3f37f3713ec7e75a 2257 devel optional devscripts_2.15.7.dsc
 1655e2c91e42cd48393c65726bc3faa9 620100 devel optional devscripts_2.15.7.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQJ8BAEBCgBmBQJVvDcKXxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ5MUJGQkY0RDY5NTZCRDVERjdCNzJEMjNE
RkU2OTFBRTMzMUJBM0RCAAoJEN/mka4zG6PbXJwQAJiTiBnnINA0iMvImKmRRxMl
8hBGGBI7+dhsoDeDAcS4z1Dg4NzkarF+kg51JbUrgOkRBNevJXheqhM+tM40xjPG
DDfXSOKTcm0MLKJlr79BevQ1wCE/xoWygTWLvChAEL6exDnjauv2vGJhFvvwwkkS
ILyJYNl50bqM56SZc3PXRdV7GDd8Az6qGFHihsSN4i0+7JIV4z4WjKd1IRg79uxs
lNvFCt+FPFhsRdYlzzLlrxDMDeC2sFHkt9cdg+3JdNojC97In2VZ02fTXCI7hA20
fvMKk+3esPhVkdv8pBGAAaKJsCaCV4kd97w9/L12sjC7pMsakiX2QVD83m5UCUKb
ETuqttftEX857+2ZMLk9o26t3HFbv7jTv1Rcs99+XVe3pzJdGYa7XwmQlP1ROZwv
xvsNGbdwoGOf8biGKdcR6jyAl5WixtgKJpD6eluOD/jcazMiI/F38sDrCaM/opYd
uMewMR3MCpuKh+fvcIPxbuj6mAULjyBOmAZyypWk4whqpslZxf+f3/LejDL7tSMo
+cUtYSrYRWmychmCrzC+czr8GtZ4epDgiuprXvSvSS95UsGzYVqLPvtB3rq/+s7i
Wy2jgMYUuz1PcnBiCom8ek8BNIl6LcX7BzDwUZwtWPoXKQp7F5QZwhqYwplYnbFG
k7dyXY+do50+JpJ2rAZB
=4pg9
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'devscripts: licensecheck: CVE-2015-5704: shell injection vulnerability' from 'devscripts: licensecheck chokes on files containing space'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Sun, 02 Aug 2015 07:33:13 GMT) ([full text](bugreport.cgi?bug=794260;msg=22), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=22), [link](#21)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 02 Sep 2015 07:32:59 GMT) ([full text](bugreport.cgi?bug=794260;msg=24), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=24), [link](#23)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=794260).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:04:58 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from anonscm.debian.org_3e23ac6b_20250126_034954.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

Verified
**Commit
c0687bcd**

authored
Jul 31, 2015
by
**[![James McCoy's avatar](https://seccdn.libravatar.org/avatar/379b1b5588b13e6205fda2b6756a40838622be75efd34598426c3edc5f2edd84?s=96&d=identicon&gravatarproxy=n "James McCoy")](/jamessan)
[James McCoy](/jamessan)**

[Browse files](/debian/devscripts/-/tree/c0687bcde23108dd42e146573c368b6905e6b8e8)

### licensecheck: Use Dpkg::IPC to run file command

```

The command being run through `` allowed the shell to interpret the
given file argument, which allows arbitrary command execution.  Using
Dpkg::IPC avoids the shell, directly executing file.

Closes: #794260
Signed-off-by: ![default avatar](https://seccdn.libravatar.org/avatar/379b1b5588b13e6205fda2b6756a40838622be75efd34598426c3edc5f2edd84?s=32&d=identicon&gravatarproxy=n)James McCoy <jamessan@debian.org>
```

parent
[f43da2ce](/debian/devscripts/-/commit/f43da2ce9271262864d97b7cdcfb191604f0a862)

Loading

Loading

Loading

* [Changes
  2](/debian/devscripts/-/commit/c0687bcde23108dd42e146573c368b6905e6b8e8)

[Hide whitespace changes](/debian/devscripts/-/commit/c0687bcde23108dd42e146573c368b6905e6b8e8?action=show&controller=projects%2Fcommit&id=c0687bcde23108dd42e146573c368b6905e6b8e8&namespace_id=debian&project_id=devscripts&w=1)
[Inline](/debian/devscripts/-/commit/c0687bcde23108dd42e146573c368b6905e6b8e8?view=inline)
[Side-by-side](/debian/devscripts/-/commit/c0687bcde23108dd42e146573c368b6905e6b8e8?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from access.redhat.com_c7c04a33_20250126_034956.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugs.debian.org_bcca961a_20250126_034955.html ===

# Debian Bug report logs - #794260 devscripts: licensecheck: CVE-2015-5704: shell injection vulnerability

[![version graph](version.cgi?width=2;height=2;fixed=devscripts%2F2.15.7;found=devscripts%2F2.15.6;found=devscripts%2F2.15.5;absolute=0;collapse=1;package=devscripts)](version.cgi?absolute=0;found=devscripts%2F2.15.6;found=devscripts%2F2.15.5;collapse=1;info=1;package=devscripts;fixed=devscripts%2F2.15.7)

Package:
[devscripts](pkgreport.cgi?package=devscripts);
Maintainer for [devscripts](pkgreport.cgi?package=devscripts) is [Devscripts Maintainers <devscripts@packages.debian.org>](pkgreport.cgi?maint=devscripts%40packages.debian.org); Source for [devscripts](pkgreport.cgi?package=devscripts) is [src:devscripts](pkgreport.cgi?src=devscripts) ([PTS](https://tracker.debian.org/pkg/devscripts), [buildd](https://buildd.debian.org/devscripts), [popcon](https://qa.debian.org/popcon.php?package=devscripts)).

Reported by: [Jonas Smedegaard <dr@jones.dk>](pkgreport.cgi?submitter=dr%40jones.dk)

Date: Fri, 31 Jul 2015 18:45:14 UTC

Severity: *grave*

Tags: patch, security

Found in versions devscripts/2.15.6, devscripts/2.15.5

Fixed in version devscripts/2.15.7

**Done:** James McCoy <jamessan@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=794260;mbox=yes), [status mbox](bugreport.cgi?bug=794260;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=794260;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`:

`Bug#794260`; Package `devscripts`.
(Fri, 31 Jul 2015 18:45:17 GMT) ([full text](bugreport.cgi?bug=794260;msg=2), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Jonas Smedegaard <dr@jones.dk>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`.
(Fri, 31 Jul 2015 18:45:18 GMT) ([full text](bugreport.cgi?bug=794260;msg=4), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=5), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=dr%40jones.dk)
From: Jonas Smedegaard <dr@jones.dk>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: devscripts: licensecheck chokes on files containing space
Date: Fri, 31 Jul 2015 20:44:12 +0200
```
Package: devscripts
Version: 2.15.6
Severity: grave
Tags: security patch
Justification: user security hole

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On line 324 of licensecheck is executed this shell code:

  file --brief --mime --dereference $file

That will fail if the input file contains space, and may do horrible
things with input files containing semicolon.

Fix is simple: Add quotes around the variable, so line 324 looks like
this:

    my $mime = `file --brief --mime --dereference "$file"`;

 - Jonas

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJVu8H2AAoJECx8MUbBoAEhFwAP+wYs9y6MjavimltBk7DbMmV9
TrYB/TcAQyv9zHw4OS/qJqHUf8W7fU+WsugCnWEfKpX1zBKVT4cXYTiB9bz43ayB
eZoykVxP5xe7OTVM1m96lDjy4hUC0sK/jQ8+iPP29apWFLGAJKVGYBKn/5qDNd4v
FZpCoUuy4aFIKCCzQ/1cIhPG8K6xekiQRYqczH2tFoyAD9kN5w3ybxtuMob0SgMY
tEpqfRrxVwLJNMjae1aUa/4gwfEo1TUT94bgsAihtBKR+QE645MgBvu1duNoAR2+
9o3c1/FB+ryNFraPNkrU8P0Y81Bv5Bf2XXd/1QxZe2IatBgZZMw36nISyqnsJBeP
6esh9sI8jgnMYz5CNN+jV681vqBfU4l/ZBEpmiYs04uR0Gn/arDt5TrSQAYvPLIY
D/aR4oUqO5Pwf2zXKNHgzSU7Ubh7I4a0k3TQwq6/mTzTBcpwvZXoTwEisA7JVhsP
SOKWc+j4E8ueDFgdL6/65HaNAwi7VYcG72EHlQ5CRGsWN61ejkJcjq/LiNajIELo
IvU40b/X3D/sjf6TbgWdHUl5S5ogzJiRpLfzBfkKAoY76DqcJ21M5Z+MVk98T9yF
OjqMzCFWduQ6NsZwNQq7YLeotx8Y1qaebxEDg1QWuGf9Fh5dQQH7PAnXi26u51ZM
a5cD5Cr9fCoXidVYrJhK
=RNm9
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>`:

`Bug#794260`; Package `devscripts`.
(Fri, 31 Jul 2015 19:36:08 GMT) ([full text](bugreport.cgi?bug=794260;msg=7), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=7), [link](#6)).

---

[Message #8](#8) received at 794260@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=8), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=8), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: Jonas Smedegaard <dr@jones.dk>, 794260@bugs.debian.org
Subject: Re: Bug#794260: devscripts: licensecheck chokes on files containing
space
Date: Fri, 31 Jul 2015 21:32:33 +0200
```
* Jonas Smedegaard <dr@jones.dk>, 2015-07-31, 20:44:
>On line 324 of licensecheck is executed this shell code:
>
>  file --brief --mime --dereference $file
>
>That will fail if the input file contains space, and may do horrible
>things with input files containing semicolon.
>
>Fix is simple: Add quotes around the variable, so line 324 looks like
>this:
>
>    my $mime = `file --brief --mime --dereference "$file"`;

Note that $file is expanded by Perl, not by shell, so this change is not
sufficient:
| $ touch '"; cowsay moo; #.c'
| $ licensecheck *.c
| /usr/bin/licensecheck warning: cannot parse file '"; cowsay moo; #.c' with mime type 'cannot open `' (No such file or directory)
|  _____
| < moo >
|  -----
|         \   ^__^
|          \  (oo)\_______
|             (__)\       )\/\
|                 ||----w |
|                 ||     ||'

(If the variable were expanded by shell, command injection wouldn't be
even possible. You could still exploit argument injection, but that's
less exciting.)

--
Jakub Wilk

```

---

**Marked as found in versions devscripts/2.15.5.**
Request was from `James McCoy <jamessan@debian.org>`
to `control@bugs.debian.org`.
(Fri, 31 Jul 2015 23:51:04 GMT) ([full text](bugreport.cgi?bug=794260;msg=10), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=10), [link](#9)).

---

**Added tag(s) pending.**
Request was from `James McCoy <jamessan@debian.org>`
to `control@bugs.debian.org`.
(Sat, 01 Aug 2015 00:48:06 GMT) ([full text](bugreport.cgi?bug=794260;msg=12), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=12), [link](#11)).

---

**Message sent on**
to `Jonas Smedegaard <dr@jones.dk>`:

Bug#794260.
(Sat, 01 Aug 2015 00:48:15 GMT) ([full text](bugreport.cgi?bug=794260;msg=14), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 794260-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=15), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James McCoy <jamessan@debian.org>
To: 794260-submitter@bugs.debian.org
Subject: Bug#794260 marked as pending
Date: Sat, 01 Aug 2015 00:46:26 +0000
```
tag 794260 pending
thanks

Hello,

Bug #794260 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=collab-maint/devscripts.git;a=commitdiff;h=c0687bc>

---
commit c0687bcde23108dd42e146573c368b6905e6b8e8
Author: James McCoy <jamessan@debian.org>
Date:   Fri Jul 31 19:56:36 2015 -0400

    licensecheck: Use Dpkg::IPC to run file command

    The command being run through `` allowed the shell to interpret the
    given file argument, which allows arbitrary command execution.  Using
    Dpkg::IPC avoids the shell, directly executing file.

    Closes: #[794260](bugreport.cgi?bug=794260)
    Signed-off-by: James McCoy <jamessan@debian.org>

diff --git a/debian/changelog b/debian/changelog
index a9cd9cb..6536846 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,10 @@
+devscripts (2.15.7) UNRELEASED; urgency=medium
+
+  * licensecheck:
+    + Use Dpkg::IPC to run file to avoid shell injection.  (Closes: #[794260](bugreport.cgi?bug=794260))
+
+ -- James McCoy <jamessan@debian.org>  Fri, 31 Jul 2015 19:53:04 -0400
+
 devscripts (2.15.6) unstable; urgency=medium

   [ Paul Wise ]

```

---

**Reply sent**
to `James McCoy <jamessan@debian.org>`:

You have taken responsibility.
(Sat, 01 Aug 2015 03:39:05 GMT) ([full text](bugreport.cgi?bug=794260;msg=17), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=17), [link](#16)).

---

**Notification sent**
to `Jonas Smedegaard <dr@jones.dk>`:

Bug acknowledged by developer.
(Sat, 01 Aug 2015 03:39:05 GMT) ([full text](bugreport.cgi?bug=794260;msg=19), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 794260-close@bugs.debian.org ([full text](bugreport.cgi?bug=794260;msg=20), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James McCoy <jamessan@debian.org>
To: 794260-close@bugs.debian.org
Subject: Bug#794260: fixed in devscripts 2.15.7
Date: Sat, 01 Aug 2015 03:34:57 +0000
```
Source: devscripts
Source-Version: 2.15.7

We believe that the bug you reported is fixed in the latest version of
devscripts, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 794260@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James McCoy <jamessan@debian.org> (supplier of updated devscripts package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Fri, 31 Jul 2015 22:50:33 -0400
Source: devscripts
Binary: devscripts
Architecture: source
Version: 2.15.7
Distribution: unstable
Urgency: medium
Maintainer: Devscripts Devel Team <devscripts-devel@lists.alioth.debian.org>
Changed-By: James McCoy <jamessan@debian.org>
Closes: [794260](bugreport.cgi?bug=794260) [794263](bugreport.cgi?bug=794263) [794282](bugreport.cgi?bug=794282)
Description:
 devscripts - scripts to make the life of a Debian Package maintainer easier
Changes:
 devscripts (2.15.7) unstable; urgency=medium
 .
   * licensecheck:
     + Use Dpkg::IPC to run file to avoid shell injection.  (Closes: #[794260](bugreport.cgi?bug=794260))
     + Change whitelist of mime types to greylist of encodings.  Restores
       ability to check files with mime types like text/x-c++ and
       application/postscript.  Thanks to Jonas Smedegaard for the patch.
       (Closes: #[794282](bugreport.cgi?bug=794282))
     + Fix an endless loop in parsing certain files.  Thanks to Jonas
       Smedegaard for the patch.  (Closes: #[794263](bugreport.cgi?bug=794263))
Checksums-Sha1:
 e1368f617e07f74cb0bcd41e6202ede27d42d784 2257 devscripts_2.15.7.dsc
 4f01f5b1a9f118aebf66461adf46e0e830731f47 620100 devscripts_2.15.7.tar.xz
Checksums-Sha256:
 daee3c021a6f44fe05e7568196c5eb55d34fbb6238f341a7fcf8443caa126ec5 2257 devscripts_2.15.7.dsc
 7eadef203bc50612af70fb0047b5225a7f2b5fdaacd45c2df09126fcc1aed027 620100 devscripts_2.15.7.tar.xz
Files:
 e5b6f0e0c29dca1b3f37f3713ec7e75a 2257 devel optional devscripts_2.15.7.dsc
 1655e2c91e42cd48393c65726bc3faa9 620100 devel optional devscripts_2.15.7.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQJ8BAEBCgBmBQJVvDcKXxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ5MUJGQkY0RDY5NTZCRDVERjdCNzJEMjNE
RkU2OTFBRTMzMUJBM0RCAAoJEN/mka4zG6PbXJwQAJiTiBnnINA0iMvImKmRRxMl
8hBGGBI7+dhsoDeDAcS4z1Dg4NzkarF+kg51JbUrgOkRBNevJXheqhM+tM40xjPG
DDfXSOKTcm0MLKJlr79BevQ1wCE/xoWygTWLvChAEL6exDnjauv2vGJhFvvwwkkS
ILyJYNl50bqM56SZc3PXRdV7GDd8Az6qGFHihsSN4i0+7JIV4z4WjKd1IRg79uxs
lNvFCt+FPFhsRdYlzzLlrxDMDeC2sFHkt9cdg+3JdNojC97In2VZ02fTXCI7hA20
fvMKk+3esPhVkdv8pBGAAaKJsCaCV4kd97w9/L12sjC7pMsakiX2QVD83m5UCUKb
ETuqttftEX857+2ZMLk9o26t3HFbv7jTv1Rcs99+XVe3pzJdGYa7XwmQlP1ROZwv
xvsNGbdwoGOf8biGKdcR6jyAl5WixtgKJpD6eluOD/jcazMiI/F38sDrCaM/opYd
uMewMR3MCpuKh+fvcIPxbuj6mAULjyBOmAZyypWk4whqpslZxf+f3/LejDL7tSMo
+cUtYSrYRWmychmCrzC+czr8GtZ4epDgiuprXvSvSS95UsGzYVqLPvtB3rq/+s7i
Wy2jgMYUuz1PcnBiCom8ek8BNIl6LcX7BzDwUZwtWPoXKQp7F5QZwhqYwplYnbFG
k7dyXY+do50+JpJ2rAZB
=4pg9
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'devscripts: licensecheck: CVE-2015-5704: shell injection vulnerability' from 'devscripts: licensecheck chokes on files containing space'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Sun, 02 Aug 2015 07:33:13 GMT) ([full text](bugreport.cgi?bug=794260;msg=22), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=22), [link](#21)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 02 Sep 2015 07:32:59 GMT) ([full text](bugreport.cgi?bug=794260;msg=24), [mbox](bugreport.cgi?bug=794260;mbox=yes;msg=24), [link](#23)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=794260).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 03:49:55 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_b79b75b3_20250124_220453.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150801172434.746C54D8BEC@smtpvbsrv1.mitre.org>
Date: Sat,  1 Aug 2015 13:24:34 -0400 (EDT)
From: cve-assign@...re.org
To: carnil@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: devscripts: licensecheck: arbitrary shell command injection

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> licensecheck is prone to arbitrary shell command injection via
> shell metacharacters in filenames
>
> <https://bugs.debian.org/794260>
> <https://anonscm.debian.org/cgit/collab-maint/devscripts.git/commit/?id=c0687bcde23108dd42e146573c368b6905e6b8e8>

Use CVE-2015-5704 for the issue involving shell metacharacters that
was fixed in c0687bcde23108dd42e146573c368b6905e6b8e8.

> <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=794260#8>
>
> (If the variable were expanded by shell, command injection wouldn't be
> even possible. You could still exploit argument injection, but that's
> less exciting.)

Yes, but argument injection is within the scope of CVE and seems to be
relevant even in the patched code, i.e.,

  % touch -- -C
  % ln -s /etc/passwd magic.mgc
  % ls -l /etc/passwd
  -rw-r--r-- 1 root root 1388 Jul 16 14:47 /etc/passwd
  % licensecheck -- *C
  /usr/bin/licensecheck warning: cannot parse file '-C' with mime type ''
  % ls -l /etc/passwd
  -rw-r--r-- 1 0 root 248 Aug  1 13:07 /etc/passwd

In other words, we don't believe it's intentional behavior for
licensecheck to operate on arbitrary files that have '-' at the
beginning of their names, and use these names to construct unsafe
command lines for the file program. The new spawn section perhaps
should begin with

  spawn(exec => ['file', '--brief', '--mime', '--dereference', '--', $file],

instead. Use CVE-2015-5705 for this argument injection vulnerability.

For now, we'll leave the open question of whether the file program
should be following symlinks when creating a magic.mgc file in
response to the -C option. Possibly file was supposed to be resilient
in the face of unsafe directories, e.g., a legitimate user shouldn't
need to be concerned about file overwrites when running "file *" in a
directory where a local attacker has created a -C file and a symlink
named magic.mgc. However, maybe the legitimate user is supposed to
know to type "file -- *" whenever the directory might contain leading
'-' characters in filenames. And maybe the legitimate user who
directly enters -C on the command line actually wants magic.mgc to be
created in the location specified by the symlink. It doesn't seem
possible to decide whether there's a file vulnerability here without
clarification from the author of file.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJVvP/TAAoJEKllVAevmvmsV0sIAL7zUQZr+qMT+n8fN6mdtroc
wqgwVisSbNv1KfuzjPtQ0NZDLaO83gOs7Mx5HM/dZu/LAErFkfmzZpz+Cw3DYaqt
cPCcwE+hPjylzsHNZYJvQaOzNqrM75tvmAvGRfaBTEiRkiW0fvkYsHr3wVi1VCqu
lE304MuyzKuXNbBHPpM1G+RKWpkgHNmzQ57xGZ9GV+krO3MpkZ+na3wHAlnflBYv
Q5klYBEOke8kvfnAQ2a7SL82sKhRmvNP5h+LS+IMb+Mg0zzTbt6HAqu4lNgWdKlP
gkK3t5EOEwB9fikb6YYaHAxPF46cGgSGZDGakTzO50HfZK8xPv7/9u0qk8e4BhU=
=CXEC
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_9c18e6fa_20250124_220500.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1249635)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1249635)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1249635)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1249635

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1249635**](show_bug.cgi?id=1249635)
(CVE-2015-5704)
- [CVE-2015-5704](https://access.redhat.com/security/cve/CVE-2015-5704) devscripts: arbitrary shell command injection

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-5704 devscripts: arbitrary shell command injection

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-5704 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1249636](show_bug.cgi?id=1249636 "CLOSED ERRATA - CVE-2015-5704 devscripts: arbitrary shell command injection [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1249635&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1249635&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-08-03 13:01 UTC by Adam Mariš | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:35 UTC ([History](show_activity.cgi?id=1249635)) | | [CC List:](page.cgi?id=fields.html#cclist) | 1 user (show)  manisandro | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-08-15 10:34:47 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1249635#c0)  Adam Mariš    2015-08-03 13:01:10 UTC  ``` In scripts/licensecheck.pl, there is executed code, that is vulnerable to shell command injection via shell metacharacters in filename.  my $mime = `file --brief --mime --dereference $file`;  Upstream patch: <https://anonscm.debian.org/cgit/collab-maint/devscripts.git/commit/?id=c0687bcde23108dd42e146573c368b6905e6b8e8>  CVE assignment: <http://www.openwall.com/lists/oss-security/2015/08/01/7>   ```  [Comment 1](show_bug.cgi?id=1249635#c1)  Adam Mariš    2015-08-03 13:02:24 UTC  ```  Created devscripts tracking bugs for this issue:  Affects: fedora-all [[bug 1249636](show_bug.cgi?id=1249636 "CLOSED ERRATA - CVE-2015-5704 devscripts: arbitrary shell command injection [fedora-all]")]   ```  [Comment 2](show_bug.cgi?id=1249635#c2)  Fedora Update System    2015-08-12 07:04:15 UTC  ``` devscripts-2.15.8-1.fc22 has been pushed to the Fedora 22 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 3](show_bug.cgi?id=1249635#c3)  Fedora Update System    2015-08-12 07:04:58 UTC  ``` devscripts-2.15.8-1.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1249635&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


