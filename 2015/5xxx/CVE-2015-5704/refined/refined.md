```
{
  "vulnerability_details": {
    "root_cause": "The `licensecheck` script in `devscripts` was vulnerable to shell command injection because it used backticks to execute the `file` command with an unsanitized filename argument.",
    "weaknesses": [
      "Shell command injection"
    ],
    "impact": "Arbitrary command execution with the privileges of the user running `licensecheck`.",
    "attack_vectors": "An attacker can create a file with malicious shell metacharacters in its name, then invoke the `licensecheck` tool on that file.",
    "attacker_capabilities": "The attacker needs to be able to create files on the system and have the user execute the licensecheck tool on it. No special position needed."
  },
  "additional_details": {
    "details": "The vulnerability was located in line 324 of the `licensecheck` script, where the command `file --brief --mime --dereference $file` was executed using backticks. This allowed the shell to interpret the filename argument, leading to command injection. Quoting the filename was not sufficient, as the variable expansion was done by Perl, not the shell. The fix involved using `Dpkg::IPC` to directly execute the file command, avoiding the shell entirely. The vulnerability was initially reported as an issue where `licensecheck` chokes on files containing spaces. The fix also addressed issues with parsing certain files and mime types.",
    "affected_versions": "devscripts versions 2.15.5 and 2.15.6",
    "fixed_versions": "devscripts version 2.15.7",
    "cve_id": "CVE-2015-5704",
  }
}
```