- **Root cause of vulnerability**: The `routed(8)` daemon accepts RIP queries from any source, but when responding, it assumes the destination is on a directly connected network. This leads to a failed assertion when the source of the query is not directly connected.
- **Weaknesses/vulnerabilities present**: Improper input validation and an incorrect assumption about the destination network when responding to RIP queries.
- **Impact of exploitation**: The `routed(8)` daemon terminates due to the assertion failure. This stops the affected system from updating its routing table, causing its routes to expire from other routers, and the networks behind the affected system to become unreachable. This is a denial-of-service (DoS).
- **Attack vectors**: Sending a RIP query to a vulnerable system from a source that is not on a directly connected network.
- **Required attacker capabilities/position**: The attacker needs to be able to send UDP packets with destination port 520 to the vulnerable system and must not be on a directly connected network to trigger the vulnerability.