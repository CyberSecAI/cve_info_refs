=== Content from bugzilla.mozilla.org_489dbca3_20250124_185146.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1111725)
* [XML](/show_bug.cgi?ctype=xml&id=1111725)

Closed
[Bug 1111725](/show_bug.cgi?id=1111725)

Opened 10 years ago
Closed 10 years ago

# UMS (USB) mounting after reboot even without unlocking

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

UMS (USB) mounting after reboot even without unlocking

## Categories

### (Firefox OS Graveyard :: Gaia::System, defect)

[Product:](/describecomponents.cgi?product=Firefox%20OS%20Graveyard)

Firefox OS Graveyard
▾

Firefox OS Graveyard
FirefoxOS, or Boot2Gecko (B2G) is Mozilla's operating system built on web standards. ([more info](https://wiki.mozilla.org/B2G))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20OS%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20OS%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem#Gaia%3A%3ASystem)

Gaia::System
▾

Firefox OS Graveyard :: Gaia::System
Bugs related to Gaia's System app except the lockscreen and window management.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Gonk (Firefox OS)

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (blocking-b2g:2.1+, b2g-v1.4 unaffected, b2g-v2.0 unaffected, b2g-v2.0M unaffected, b2g-v2.1 fixed, b2g-v2.1S fixed, b2g-v2.2 fixed, b2g-master fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

2.2 S4 (23jan)

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| blocking-b2g | [2.1+](/buglist.cgi?f1=cf_blocking_b2g&o1=equals&v1=2.1%2B) |
| --- | --- |

| blocking-b2g | 2.1+ |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) |
| b2g-v2.0M | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) |
| b2g-v2.1 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed) |
| b2g-v2.1S | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=fixed) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |
| b2g-master | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | unaffected |
| b2g-v2.0M |  | unaffected |
| b2g-v2.1 |  | fixed |
| b2g-v2.1S |  | fixed |
| b2g-v2.2 |  | fixed |
| b2g-master |  | fixed |

## People

### (Reporter: clement.lefevre, Assigned: dhylands)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/61091f94cc81be8e6caa0fb4c6b15ddc?d=mm&size=40)  [dhylands](/user_profile?user_id=437955)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8f50ec5169ba9423fff8e4cdf091ecdc?d=mm&size=40)  [clement.lefevre](/user_profile?user_id=445496)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: privacy, reporter-external, sec-high, Whiteboard: [b2g-adv-main2.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[b2g-adv-main2.2+]

QA Whiteboard:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a16939947_1689 "10 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [log.txt](/attachment.cgi?id=8538009)  [10 years ago](#c8)  [Dave Hylands [:dhylands]](/user_profile?user_id=437955)   111.63 KB, text/plain |  | [Details](/attachment.cgi?id=8538009&action=edit) |
| --- | --- | --- |
| [Rewrite usb\_storage.js to have the same logic that it had before (in regards to locking/unlocking)](/attachment.cgi?id=8550059)  [10 years ago](#c12)  [Dave Hylands [:dhylands]](/user_profile?user_id=437955)   46 bytes, text/x-github-pull-request | alive : [review+](#c19 "10 years ago") | [Details](/attachment.cgi?id=8550059&action=edit) | [Review](/attachment.cgi?id=8550059) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Clément Lefèvre](/user_profile?user_id=445496)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1111725#c0)• 10 years ago |
| str | |

For security purpose, you are supposed to need unlocking your phone to have access to storage content when USB share is enabled.
STR : Enable USB share and reboot the phone. Plug it to the computer before or after reboot, it does not matter. After reboot is complete do NOT unlock the phone.
What will happen : You will see that shared Volumes will mount on your computer.
What should have happened : You are not supposed to get access to the USB shared volumes if the phone have not been unlocked (which is like an authentication to get this access)
Considering anyone can reboot the phone, it gives access to phones content for everyone.
Additional informations: Just after reboot, if the screen switch off (manually or by idle time), the USB mount is stopped, but after some switch between on and off state, it finally stay mounted even if the screen stay at off state.
However, when the screen is shut down, it will switch on itself again until USB mount keep its state even with switched off screen.
Main tested phone and build:
Build ID 20141214040212
Build Type user
Gaia Revision e2a3e606675c346b6e6f35351a458040be599b09
Gaia Date 2014-12-12 21:39:46
Gecko Revision <https://hg.mozilla.org/mozilla-central/rev/f14dcd1c8c0b>
Gecko Version 37.0a1
Device ID flame
Device Name msm8610
Firmware(Release) 4.4.2
Firmware(Incremental) 39
Firmware Date Thu Oct 16 18:19:14 CST 2014
Bootloader L1TC00011880
Reproduced on a 2.0 build, not reproduced on 1.3.

|  | [Julien Wajsberg [:julienw]](/user_profile?user_id=364883) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1111725#c1)• 10 years ago |
|  | |

To make it clearer: reproduced in 2.2 as well (that's the build information above).

|  | [Clément Lefèvre](/user_profile?user_id=445496)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1111725#c2)• 10 years ago |
|  | |

After looking a bit more at this bug, I could find other linked problems depending on adb state (enabled or not):
If ADB is unabled:
USB mount will happen after reboot, the screen will not switch on and off alone and no unmount will happen.
If ADB is enabled : The switches I described previously will happen. While the screen is off and the USB volume unmounted, you can have access to adb even without unlocking the phone too. If the screen switch on, USB mount and adb disconnect.
But then if you switch on and off several time you will then be able to have USB volume mounted AND adb access witch switched off screen without any problem or interruption.

|  | [Stephanie Ouillon [:arroway] (needinfo me)](/user_profile?user_id=485442) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1111725#c3)• 10 years ago |
|  | |

(In reply to Clément Lefèvre from [comment #2](/show_bug.cgi?id=1111725#c2 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> After looking a bit more at this bug, I could find other linked problems
> depending on adb state (enabled or not):
>
> If ADB is unabled:
> USB mount will happen after reboot, the screen will not switch on and off
> alone and no unmount will happen.
what do you mean by "the screen will not witch on and off alone"? It only happens when you switch on the screen manually and goes off manually or when it goes idle, right?
>
> If ADB is enabled : The switches I described previously will happen. While
> the screen is off and the USB volume unmounted, you can have access to adb
> even without unlocking the phone too. If the screen switch on, USB mount and
> adb disconnect.
>
> But then if you switch on and off several time you will then be able to have
> USB volume mounted AND adb access witch switched off screen without any
> problem or interruption.
Te be more precise, given that Paul had noticed the same thing on a developer build some time ago but this was a normal behavior: do you have adb access even if you unplug the phone before or during rebooting?
(and I precise it again just in case to be clearer: Clement is testing on a \*user\* build).

|  | [Clément Lefèvre](/user_profile?user_id=445496)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1111725#c4)• 10 years ago |
| str | |

(In reply to Stephanie Ouillon [:arroway] from [comment #3](/show_bug.cgi?id=1111725#c3 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> (In reply to Clément Lefèvre from [comment #2](/show_bug.cgi?id=1111725#c2 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> > After looking a bit more at this bug, I could find other linked problems
> > depending on adb state (enabled or not):
> >
> > If ADB is unabled:
> > USB mount will happen after reboot, the screen will not switch on and off
> > alone and no unmount will happen.
>
> what do you mean by "the screen will not witch on and off alone"? It only
> happens when you switch on the screen manually and goes off manually or when
> it goes idle, right?
>
I mean, if adb settings is enabled, after reboot, the phone can switch on the screen itself after this one turned off either because of idle time or because user manually do it.
When the screen switch off, USB mount is unmounted. When it switch on, it remount.
It appears it will do this until USB mount keep mounted state definitely (ie. even with switched off screen – see second part of this comment for step by step STR).
If adb is clearly disabled, these switches will not happen and USB mount will be definitively mounted: screen state will make no difference.
> >
> > If ADB is enabled : The switches I described previously will happen. While
> > the screen is off and the USB volume unmounted, you can have access to adb
> > even without unlocking the phone too. If the screen switch on, USB mount and
> > adb disconnect.
> >
> > But then if you switch on and off several time you will then be able to have
> > USB volume mounted AND adb access witch switched off screen without any
> > problem or interruption.
>
> Te be more precise, given that Paul had noticed the same thing on a
> developer build some time ago but this was a normal behavior: do you have
> adb access even if you unplug the phone before or during rebooting?
> (and I precise it again just in case to be clearer: Clement is testing on a
> \*user\* build).
Yes, it's happening whatever you did to plug the phone : before reboot, after reboot, during reboot.
While phone have not been unlocked, issue happen.
To define very clear STR:
- Reboot the phone and plug it whenever you want, do not unlock it.
- USB is mounting and you have no adb access.
- Switch off the screen.
- USB volume is unmounting, and you can now connect adb to the phone. Phone have not been unlocked.
- Adb will be disconnect if you switch on the screen again or after around five minutes: the screen will switch on itself and have the same effect.
This can alternate several times (USB mount/adb, depending on screen state), but finally after some switches, both USB share and adb will be active in the same time.

|  | [Stephanie Ouillon [:arroway] (needinfo me)](/user_profile?user_id=485442) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1111725#c5)• 10 years ago |
|  | |

I did the following tests and I reproduce the issues described by Clement on a user build, central branch, flashing the flame-kk images from pvt:
\* If ADB is disabled and USB sharing is on (while the phone is unplugged), when we restart the phone and plug it, we can get access to internal storage before unlocking the phone
\* If ADB (only, not the devtools) is enabled and USB sharing is on (while the phone is unplugged), when we restart the phone and plug it, we can observe two behaviors:
1) at first the local storage is not mounted when the screen is off. It is mounting if the screen is turned on, unmounting when the screen goes off. We can get an ADB shell \*only\* when the local storage is mounted.
2) after turning off and on the screen a few times, as described by Clement, the local storage stays mounted whatever the state of the screen is. Then, we can always get an ADB shell too.
During my tests, I unplugged the phone, turned off and on again USB Sharing and ADB, then restart the phone and plugged it again to be sure there wasn't a remaining connection as Paul was suggesting offline.
So it looks like that the issue comes from the way the connection for USB sharing is handled.
@Paul: can you confirm this is NOT a wanted behavior on a user build?Flags: needinfo?(ptheriault)

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1111725#c6)• 10 years ago |
|  | |

I'm unclear about usb storage, don't know if we ever prevented that based on the lockscreen status. We may have but I don't know.
As for adb, the security requirement is we should not be able to initiate a new adb connection to a locked phone. IE if you steal someones phone, even if they have edb debugging enabled, you musn't be able to get to it.
To enforce this, I believe we currently disable adb via adb access via an android property when the phone is locked, and we are not currently debugging.
Dave, any idea why we might be seeing this interaction?
Stephanie, I won't have time to dig into this further today, but if it was me, I would start by looking at all the code which references the persist.sys.usb.config android pref.Flags: needinfo?(ptheriault) → needinfo?(dhylands)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a85972_1689)• 10 years ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Gregor Wagner [:gwagner]](/user_profile?user_id=314734) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a95037_314734)• 10 years ago |

Component: Gaia::System → GonkIntegration

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1111725#c7)• 10 years ago |
|  | |

This looks like some bad logic in gaia/apps/system/js/usb\_storage.js
The file looks totally different from when I originally wrote it, so somebody has re-written it and it doesn't quite work properly.
If nobody else gets to this, I'll take a look once my review queue is down.
I'm changing the component to Gaia::System, since that's where the issue is.Component: GonkIntegration → Gaia::SystemFlags: needinfo?(dhylands)

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1111725#c8)• 10 years ago |
|  | |

Attached file
[log.txt](attachment.cgi?id=8538009)
— [Details](attachment.cgi?id=8538009&action=edit)

logcat during bootup while USB Mass Storage was enabled.
I added some prints (search for usb\_storage), which shows \_setMode being called to enable sharing while the screen is locked.
The blank lines at 11:55:37.366 is where I hit the power button and then unlocked the screen.
The call which is enabling sharing happens at: 11:53:29.296
It also looks like usb\_storage is treating MTP differently from UMS. They should both be treated the same (as far as enabling is concerned).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a690219_1689)• 10 years ago |

Keywords: [privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Julien Wajsberg [:julienw]](/user_profile?user_id=364883) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a742783_364883)• 10 years ago |

blocking-b2g: --- → 2.2?

|  | [Julien Wajsberg [:julienw]](/user_profile?user_id=364883) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1111725#c9)• 10 years ago |
|  | |

[Blocking Requested - why for this release]:blocking-b2g: 2.2? → 2.1?

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1111725#c10)• 10 years ago |
|  | |

Blocking as this is a sec-high, dhylands would be the best person to help with a patch here ? Or can you recommend anyone else who can grab this?blocking-b2g: 2.1? → 2.1+Flags: needinfo?(dhylands)

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1111725#c11)• 10 years ago |
|  | |

I can take a look at it, and see if my JS is good enough...Assignee: nobody → dhylandsFlags: needinfo?(dhylands)

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1111725#c12)• 10 years ago |
|  | |

Attached file
[Rewrite usb\_storage.js to have the same logic that it had before (in regards to locking/unlocking)](attachment.cgi?id=8550059)
— [Details](attachment.cgi?id=8550059&action=edit)

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1111725#c13)• 10 years ago |
|  | |

Comment on [attachment 8550059](/attachment.cgi?id=8550059 "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[details]](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1111725&attachment=8550059)
Rewrite usb\_storage.js to have the same logic that it had before (in regards to locking/unlocking)
I'm going to put alive and kgrandon down for review, but I think I only need one or the other.
[Attachment #8550059](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") -
Flags: review?(kgrandon)
[Attachment #8550059](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") -
Flags: review?(alive)

|  | [(inactive after 6/18) Alive Kuo [:alive]](/user_profile?user_id=445020) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1111725#c14)• 10 years ago |
|  | |

(In reply to Paul Theriault [:pauljt] from [comment #6](/show_bug.cgi?id=1111725#c6 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> I'm unclear about usb storage, don't know if we ever prevented that based on
> the lockscreen status. We may have but I don't know.
>
> As for adb, the security requirement is we should not be able to initiate a
> new adb connection to a locked phone. IE if you steal someones phone, even
> if they have edb debugging enabled, you musn't be able to get to it.
>
> To enforce this, I believe we currently disable adb via adb access via an
> android property when the phone is locked, and we are not currently
> debugging.
>
> Dave, any idea why we might be seeing this interaction?
>
> Stephanie, I won't have time to dig into this further today, but if it was
> me, I would start by looking at all the code which references the
> persist.sys.usb.config android pref.
Do we need to care passcode-enabled phone here only or even the passcode is off?Flags: needinfo?(ptheriault)

|  | [(inactive after 6/18) Alive Kuo [:alive]](/user_profile?user_id=445020) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1111725#c15)• 10 years ago |
|  | |

Comment on [attachment 8550059](/attachment.cgi?id=8550059 "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[details]](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1111725&attachment=8550059)
Rewrite usb\_storage.js to have the same logic that it had before (in regards to locking/unlocking)
Dave, thanks for contributing.
My main concern here is that we should not observe lockscreen.enabled or lockscreen.locked because it is already observed by lockscreenWindowManager.
Could you tell me why the original System.locked and listen to lockscreen-appopened/lockscreen-appclosed does not work?
Maybe what we need is just put your update() function inside start(). Could you give it a try?
Also we may need to change usb\_storage\_test.js to avoid test failure.
Lemme know if you have trouble doing that.
[Attachment #8550059](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") -
Flags: review?(alive)

|  | [Kevin Grandon :kgrandon](/user_profile?user_id=456525) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1111725#c16)• 10 years ago |
|  | |

Comment on [attachment 8550059](/attachment.cgi?id=8550059 "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[details]](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1111725&attachment=8550059)
Rewrite usb\_storage.js to have the same logic that it had before (in regards to locking/unlocking)
I'll let Alive take this one since he's already made some good comments here.
[Attachment #8550059](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") -
Flags: review?(kgrandon)

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1111725#c17)• 10 years ago |
|  | |

(In reply to Alive Kuo [:alive][NEEDINFO!] from [comment #14](/show_bug.cgi?id=1111725#c14 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> (In reply to Paul Theriault [:pauljt] from [comment #6](/show_bug.cgi?id=1111725#c6 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> > I'm unclear about usb storage, don't know if we ever prevented that based on
> > the lockscreen status. We may have but I don't know.
Yes - this used to work.
> > As for adb, the security requirement is we should not be able to initiate a
> > new adb connection to a locked phone. IE if you steal someones phone, even
> > if they have edb debugging enabled, you musn't be able to get to it.
> >
> > To enforce this, I believe we currently disable adb via adb access via an
> > android property when the phone is locked, and we are not currently
> > debugging.
The adb logic is found in b2g/chrome/content/devtools/adb.js
I think that it needs to be updated to use similar logic to what gets used here.
There is also some interaction between adb and UMS/MTP and RNDIS. These are all controlled through sys.usb.config. It turns out that making any chaneg to sys.usb.config will have the side effect of stopping and restarting abd, so in the event that UMS/MTP/RNDIS are being used we defer disabling adb until the usb services are also turned off (this would typically happen when the usb cable is unplugged, or when the user disables the service in question).
> > Dave, any idea why we might be seeing this interaction?
> >
> > Stephanie, I won't have time to dig into this further today, but if it was
> > me, I would start by looking at all the code which references the
> > persist.sys.usb.config android pref.
>
> Do we need to care passcode-enabled phone here only or even the passcode is
> off?
The adb logic looks at lockscreen.enabled.
I'm going to rework usb\_storage.js so that all updated go through \_updateMode, but go back to using Sevice.locked and the appopened/appclosed logic.

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1111725#c18)• 10 years ago |
|  | |

Comment on [attachment 8550059](/attachment.cgi?id=8550059 "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[details]](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1111725&attachment=8550059)
Rewrite usb\_storage.js to have the same logic that it had before (in regards to locking/unlocking)
I reworked the code so that it continues to use Service.locked and the lockscreen-appopened/closed.
I also updated the unit test to work with the new code.
The biggest problem I discovered is that the old logic wasn't taking the current state into consideration.
[Attachment #8550059](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") -
Flags: review?(alive)

|  | [(inactive after 6/18) Alive Kuo [:alive]](/user_profile?user_id=445020) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1111725#c19)• 10 years ago |
|  | |

Comment on [attachment 8550059](/attachment.cgi?id=8550059 "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[details]](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1111725&attachment=8550059)
Rewrite usb\_storage.js to have the same logic that it had before (in regards to locking/unlocking)
Thanks for your hard work!
[Attachment #8550059](/attachment.cgi?id=8550059&action=edit "Rewrite usb_storage.js to have the same logic that it had before (in regards to locking/unlocking)") -
Flags: review?(alive) → review+

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1111725#c20)• 10 years ago |
|  | |

<https://github.com/mozilla-b2g/gaia/commit/19e985b3ff0874931233152a1ec31ad1407de707>Status: NEW → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1111725#c21)• 10 years ago |
|  | |

[Comment 0](/show_bug.cgi?id=1111725#c0 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking") makes it sound like 2.0 is affected as well? What about 1.4?
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=%3F)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=%3F)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed)Flags: needinfo?(dhylands)Target Milestone: --- → 2.2 S4 (23jan)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1111725#c22)• 10 years ago |
|  | |

And reverted for the same Linter failures that were visible on your Gaia Try run.
Master: <https://github.com/mozilla-b2g/gaia/commit/ee6b41098f0ad8c70f9db289627f9d215df3eff0>
<https://treeherder.mozilla.org/logviewer.html#?job_id=1210256&repo=b2g-inbound>Status: RESOLVED → REOPENED
[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected)Resolution: FIXED → ---Target Milestone: 2.2 S4 (23jan) → ---

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1111725#c23)• 10 years ago |
|  | |

And Gaia UI test failures.
<https://treeherder.mozilla.org/logviewer.html#?job_id=1210266&repo=b2g-inbound>
Please verify that your Gaia Try run is passing before pushing next time to avoid inconveniencing other developers.

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1111725#c24)• 10 years ago |
|  | |

Hmm. Gaia try showed green on Gaia unit tests here: <https://treeherder.mozilla.org/ui/#/jobs?repo=gaia-try&revision=2d43046720cb>
I'll figure out what's wrong...Flags: needinfo?(dhylands)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1111725#c25)• 10 years ago |
|  | |

Gaia \*UI\* tests - they show up under the Gip group. Gu is the Gaia unit tests.
Also, what branches are affected by this bug?

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1111725#c26)• 10 years ago |
|  | |

I think that the error was in a routine that the unit tests intercept, which is why the unit tests passed.
The real error was lost in the sea of reds (my try run happened to run when the the gaia tree was closed) and I missed it. Sorry.

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1111725#c27)• 10 years ago |
|  | |

Completely green gaia try run:
<https://treeherder.mozilla.org/ui/#/jobs?repo=gaia-try&revision=d3384a681c1e>
Now I just have to wait for gaia to reopenStatus: REOPENED → RESOLVEDClosed: 10 years ago → 10 years agoResolution: --- → FIXED

|  | [Dave Hylands [:dhylands]](/user_profile?user_id=437955)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1111725#c28)• 10 years ago |
|  | |

<https://github.com/mozilla-b2g/gaia/commit/8012698afd2a38aaf9d085f7992603e172f35646>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1111725#c29)• 10 years ago |
|  | |

v2.2: <https://github.com/mozilla-b2g/gaia/commit/0518f4581a0925c0b703d730ef289ab15cbd1216>
v2.1: <https://github.com/mozilla-b2g/gaia/commit/54d92cc0755e5102223276ab23063b5eee74b514>
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=%3F) → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=%3F) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed)
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed)Target Milestone: --- → 2.2 S4 (23jan)

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1111725#c30)• 10 years ago |
|  | |

(In reply to Alive Kuo@Paris~2/17 [:alive][NEEDINFO!] from [comment #14](/show_bug.cgi?id=1111725#c14 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> (In reply to Paul Theriault [:pauljt] from [comment #6](/show_bug.cgi?id=1111725#c6 "RESOLVED FIXED - UMS (USB) mounting after reboot even without unlocking"))
> > I'm unclear about usb storage, don't know if we ever prevented that based on
> > the lockscreen status. We may have but I don't know.
> >
> > As for adb, the security requirement is we should not be able to initiate a
> > new adb connection to a locked phone. IE if you steal someones phone, even
> > if they have edb debugging enabled, you musn't be able to get to it.
> >
> > To enforce this, I believe we currently disable adb via adb access via an
> > android property when the phone is locked, and we are not currently
> > debugging.
> >
> > Dave, any idea why we might be seeing this interaction?
> >
> > Stephanie, I won't have time to dig into this further today, but if it was
> > me, I would start by looking at all the code which references the
> > persist.sys.usb.config android pref.
>
> Do we need to care passcode-enabled phone here only or even the passcode is
> off?
Late reply, but only a passcode enabled phone. if the passcode is disabled, a local attacker can do whatever they want with the device, including enabling USB mounting.Flags: needinfo?(ptheriault)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a7375953_75935)• 10 years ago |

[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=fixed)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a15795705_465475)• 10 years ago |

Whiteboard: [b2g-adv-main2.2+]

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a15796576_465475)• 10 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a16939947_1689)• 10 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a22507173_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a46411998_1689)• 9 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1111725#a298413552_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1111725&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dave Hylands [:dhylands]](/user_profile?user_id=437955)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_a6e6a333_20250124_185144.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2015-74

## UMS (USB) mounting after reboot even without unlocking

Announced
August 6, 2015
Reporter
Clement Lefevre
Impact
High
Products
Firefox OS
Fixed in

* Firefox OS 2.2

### Description

**Clement Lefevre** reported a bug in USB Mass Storage handling of Firefox OS that
would allow unauthorized access to device data through the USB interface. The logic error would
under certain circumstances expose USB media volumes to USB hosts while the device is locked
with a pass code, for example after a reboot or after certain screen saver state changes.

### References

* [UMS (USB) mounting after reboot even without unlocking](https://bugzilla.mozilla.org/show_bug.cgi?id=1111725)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


