```json
{
  "CVE-2015-5161": {
    "description": "Zend Framework, when running under PHP-FPM in a threaded environment, did not properly handle XML data in multibyte encoding. This could be used by remote attackers to perform an XML External Entity attack via crafted XML data.",
    "vulnerability_details": [
      {
        "root_cause": "The vulnerability lies in the inadequate handling of XML data in multibyte encoding when Zend Framework is used with PHP-FPM in a threaded environment. The fix for thread safety issues in libxml2 had not been applied to all versions of PHP. To mitigate this, Zend Framework implemented a heuristic check for XXE vulnerabilities. However this heuristic was insufficient.",
        "weaknesses": [
          "The heuristic check implemented in Zend Framework to detect XXE attacks when running under PHP-FPM is insufficient. It only searches for the string '<!ENTITY' and can be bypassed by using a different encoding, such as UTF-16, where the same characters are encoded using 2-bytes.",
          "The application does not properly disable external entity loading when running in a threaded PHP-FPM environment. While `libxml_disable_entity_loader` is used outside of FPM, it's not used within FPM. The heuristic scan is used instead and is bypassed."
        ],
        "impact": "Successful exploitation allows remote attackers to perform an XML External Entity (XXE) attack. This can lead to:\n\n*   Disclosure of local files by reading their contents.\n*   Access to internal network resources.\n*   Denial of service by exhausting resources or injecting an endless stream from /dev/random.\n*   In some cases, with the `expect` module installed, remote command execution.",
        "attack_vectors": [
          "The attack vector is through crafted XML data with multibyte encoding sent to a Zend Framework application that uses vulnerable XML processing components, such as `Zend_XmlRpc_Server`, `Zend_Feed`, or `Zend_Config_Xml`, served via PHP-FPM.",
           "The vulnerability can be exploited through XML-RPC endpoints or any other component that processes XML data within the Zend Framework."
        ],
        "required_capabilities": [
          "The attacker needs to send an HTTP request containing crafted XML data.",
          "The attacker needs to know that the application uses Zend Framework and is served through PHP-FPM.",
           "The attacker needs to be able to send a crafted XML document that includes an external entity declaration."
        ]
      }
    ],
    "affected_products": [
      "Zend Framework versions <= 2.4.2 and <= 1.12.13",
      "All Zend Framework components consuming XML are potentially vulnerable",
       "Zend/Amf/Parse/Amf0/Deserializer.php",
        "Zend/Amf/Parse/Amf3/Deserializer.php",
        "Zend/Config/Xml.php",
        "Zend/Dom/Query.php",
        "Zend/Feed/Abstract.php",
        "Zend/Feed/Entry/Abstract.php",
        "Zend/Feed/Entry/Atom.php",
        "Zend/Feed.php",
        "Zend/Feed/Reader.php",
        "Zend/Feed/Writer/Renderer/Entry/Atom.php",
        "Zend/Gdata/App/Base.php",
        "Zend/Gdata/App.php",
        "Zend/Gdata/Gapps/ServiceException.php",
        "Zend/Gdata/YouTube.php",
        "Zend/Json.php",
        "Zend/Mobile/Push/Message/Mpns/Raw.php",
        "Zend/Rest/Client/Result.php",
        "Zend/Search/Lucene/Document/Docx.php",
        "Zend/Search/Lucene/Document/OpenXml.php",
        "Zend/Search/Lucene/Document/Pptx.php",
        "Zend/Search/Lucene/Document/Xlsx.php",
        "Zend/Serializer/Adapter/Wddx.php",
        "Zend/Service/Amazon/Ec2/Response.php",
        "Zend/Service/Amazon.php",
        "Zend/Service/Amazon/SimpleDb/Response.php",
        "Zend/Service/Audioscrobbler.php",
        "Zend/Service/Delicious.php",
        "Zend/Service/Ebay/Finding.php",
        "Zend/Service/Flickr.php",
        "Zend/Service/SlideShare.php",
        "Zend/Service/SqlAzure/Management/Client.php",
        "Zend/Service/Technorati.php",
        "Zend/Service/WindowsAzure/Diagnostics/ConfigurationInstance.php",
        "Zend/Service/WindowsAzure/Management/Client.php",
        "Zend/Service/WindowsAzure/Storage.php",
        "Zend/Service/Yahoo.php",
        "Zend/Soap/Server.php",
        "Zend/Soap/Wsdl.php",
        "Zend/XmlRpc/Request.php",
         "Zend/XmlRpc/Response.php"
    ],
     "fixed_versions": [
      "Zend Framework 1, version 1.12.14",
      "Zend Framework 2, versions 2.4.6 and 2.5.2"
    ]
  }
}
```