=== Content from wicket.apache.org_64810a60_20250124_222619.html ===

[![Apache Wicket](/img/logo-apachewicket.svg)](/)

[Quick Start](/start/quickstart.html)

[Download](/start/download.html)

[Documentation](/learn)

[Support](/help)

[Contribute](/contribute)

[Community](/community)

[Apache](/apache)

# CVE-2015-5347 Apache Wicket XSS vulnerability

## Table of Contents

* [1 The application developers are recommended to upgrade to:](#the-application-developers-are-recommended-to-upgrade-to)

01 Mar 2016

Severity: Important

Vendor:
The Apache Software Foundation

Versions Affected:
Apache Wicket 1.5.x, 6.x and 7.x

Description:

It is possible for JavaScript statements to break out of a ModalWindowâs
title - only quotes are escaped in the JavaScript settings object, allowing JavaScript
to be injected into the markup.

This might pose a security threat if the written JavaScript contains user provided data.

The title is now escaped by default, this can be disabled explicitly via
modalWindow.setEscapeModelStrings(false).

## The application developers are recommended to upgrade to:

* [Apache Wicket 1.5.15](/news/2016/02/19/wicket-1.5.15-released.html)
* [Apache Wicket 6.22.0](/news/2016/02/19/wicket-6.22.0-released.html)
* [Apache Wicket 7.2.0](/news/2016/01/20/wicket-7.2.0-released.html)

Credit:
This issue was reported by Tobias Gierke!

Apache Wicket Team

![](/img/asf_logo_url.svg)
Copyright Â© 2025 â The Apache Software Foundation. Apache Wicket, Wicket, Apache, the Apache feather logo, and the Apache Wicket project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.



=== Content from issues.apache.org_f3934c1a_20250124_222620.html ===


[Log in](/jira/login.jsp?os_destination=%2Fbrowse%2FWICKET-6037)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![ASF JIRA](/jira/s/xd97tr/820010/13pdxe5/_/jira-logo-scaled.png)](https://issues.apache.org/jira/secure/MyJiraHome.jspa)

* [Dashboards](/jira/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/jira/browse/WICKET "View recent projects and browse a list of projects")
* [Issues](/jira/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/jira/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/jira/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/jira/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FWICKET-6037)

Public signup for this instance is **disabled**. Go to our [Self serve sign up page](https://selfserve.apache.org/jira-account.html) to request an account. Report potential security issues [privately](https://apache.org/security/#reporting-a-vulnerability)

![Uploaded image for project: 'Wicket'](https://issues.apache.org/jira/secure/projectavatar?pid=12310561&avatarId=17538)

1. [Wicket](/jira/browse/WICKET)
2. [WICKET-6037](/jira/browse/WICKET-6037)

# ModalWindow vulnerable to Javascript injection through title model

[Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FWICKET-6037 "Log In")Export

XMLWordPrintableJSON
#### Details

* **Type:**
  ![](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Status:**
  Resolved
* **Priority:**
  ![](/jira/images/icons/priorities/major.svg "Major - Major loss of function.") Major
* **Resolution:**
  Fixed
* **Affects Version/s:**
  1.5.11, 7.1.0
* **Fix Version/s:**
  [7.2.0](/jira/issues/?jql=project+%3D+WICKET+AND+fixVersion+%3D+7.2.0 "7.2.0 Minor release for 7.x"), [8.0.0-M1](/jira/issues/?jql=project+%3D+WICKET+AND+fixVersion+%3D+8.0.0-M1 "8.0.0-M1 Major release (API break, new additions) Milestone 1"), [6.22.0](/jira/issues/?jql=project+%3D+WICKET+AND+fixVersion+%3D+6.22.0 "6.22.0 Minor release for 6.x"), [1.5.15](/jira/issues/?jql=project+%3D+WICKET+AND+fixVersion+%3D+1.5.15 "1.5.15 Security release for 1.5.x")
* **Component/s:**
  [wicket-extensions](/jira/issues/?jql=project+%3D+WICKET+AND+component+%3D+wicket-extensions "wicket-extensions ")
* **Labels:**
  None
#### Description

I came across this while fixing XSS vulnerabilities found during a penetration test of our application (which sadly still uses Wicket 1.5.x).

Just to be sure, I also checked the source from Wicket 7.1.0 and the issue is present as well.

The following lines in org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow#getWindowOpenJavaScript() are the culprit

------------------

Object title = getTitle() != null ? getTitle().getObject() : null;

if (title != null)

{
appendAssignment(buffer, "settings.title", escapeQuotes(title.toString()));
}

-----------------

Using escapeQuotes() is not enough since Javascript written without quotes is still executed by at least the latest Firefox version (didn't bother checking other browsers).

For example having the title model return a string that contains

<i onclick=alert(1)>stuff</i>

will make the browser show a JS popup when clicking on the dialog title.

#### Attachments

#### Activity

#### People

Assignee:

![svenmeier](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Sven Meier

Reporter:

![tgierke](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Tobias Gierke

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

#### Dates

Created:

18/Nov/15 11:22

Updated:

19/Nov/15 09:14

Resolved:

19/Nov/15 09:14

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/jira/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/jira/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Apache Software Foundation. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


