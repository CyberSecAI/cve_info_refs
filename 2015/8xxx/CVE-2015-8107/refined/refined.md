The provided content relates to CVE-2015-8107.

**Root cause of vulnerability:**
The vulnerability is a format string bug in the `a2ps` (GNU) utility. The `output_file` function processes the `%Expand` command in a prologue file. The `expansion` variable in this function may hold a malicious input string which is then used as a format argument of `vsprintf`.

**Weaknesses/vulnerabilities present:**
- Format string vulnerability. The `expansion` variable which contains user-controlled input is used as a format string in `vsprintf` without proper sanitization.
- The `output` function passes the potentially malicious format string to `ds_unsafe_cat_vsprintf`, which then passes it to `vsprintf`.

**Impact of exploitation:**
- Arbitrary code execution. An attacker can execute arbitrary code by crafting a malicious prologue file that contains a format string vulnerability.
- Denial of service, as demonstrated by the crash ("aborted (core dumped)").

**Attack vectors:**
- Malicious prologue file. The attacker needs to craft a prologue file (.pro) containing a malicious `%Expand` command.
- The vulnerability is triggered when a user runs `a2ps` with the crafted prologue file.

**Required attacker capabilities/position:**
- The attacker needs to be able to create a malicious prologue file and convince a user to use it with `a2ps`.
- No special user privileges are needed for the attack.

**Additional details:**
- The vulnerable code is in `output.c` and `dstring.c`.
- The specific line of code where the `vsprintf` is called is `dstring.c:326`.
- The fix is to pass the format string as a parameter to `output` and use `%s` as the format specifier: `output (dest, "%s", expansion);` instead of  `output (dest, expansion);`
- A static analyzer, Sparrow, was used to discover this vulnerability.
- An example of a malicious `exploit.pro` file is provided to trigger the vulnerability.