=== Content from www.openwall.com_82904a99_20250124_195657.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](24) [[next>]](26) [[<thread-prev]](../../../2015/11/17/9) [[thread-next>]](26) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151118171541.3A12B6C0188@smtpvmsrv1.mitre.org>
Date: Wed, 18 Nov 2015 12:15:41 -0500 (EST)
From: cve-assign@...re.org
To: peter@...e-magic.net
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request for path traversal / info leak bug in Spiffy web server

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <http://lists.gnu.org/archive/html/chicken-announce/2015-11/msg00000.html>

> if you are using awful,
> chickadee, pastiche, qwiki, websockets or any other egg that uses Spiffy
> as HTTP server, your server is vulnerable as well.

> Spiffy 5.4 eliminates the
> vulnerability without requiring the fix for the CHICKEN core.

Use CVE-2015-8235 for the Spiffy vulnerability.

> The unfortunate cause of this is that some CHICKEN core
> procedures are misbehaving: when passed a file that starts with a
> backslash, some path manipulation procedures incorrectly
> *replace* the backslash with a slash. This has the effect of
> injecting a path separator into a path component that was
> supposed to be "atomic". This results in the path component
> being reinterpretated as two components.
>
> The issue with the CHICKEN core procedures has been addressed by
> edd4926bb4f4c97760a0e03b0d0e8210398fe967 in the git repository, but it
> is not in any stable release yet.
>
> <http://code.call-cc.org/cgi-bin/gitweb.cgi?p=chicken-core.git;a=commit;h=edd4926bb4f4c97760a0e03b0d0e8210398fe967>

If this is a CHICKEN core vulnerability, it needs a separate CVE ID.
The description above -- especially the 'supposed to be "atomic"'
comment -- suggests that the code is unambiguously wrong, but the
commit message presents the issue differently. Also, it appears that
introducing '/' characters into strings is a general problem for any
program that prohibits only '/' characters in user-supplied filenames
(e.g., because the program, for whatever reason, can only be used on
UNIX platforms). Is there a rationale for not considering this a
CHICKEN vulnerability?

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWTLHmAAoJEL54rhJi8gl5sVQP/RNAF0urGXCKfGnigPmyHtDK
7hDILbfND4iaMAS+o3avt+Nhfml1MuLMKwRWp31uHaAGnglbIQWp6eMC2JOlSSci
Q3g7QsV4s/x7FMvBXrvv0jLDkxJpL8mtCZ8pah9qXPr5CLr6KZzA499NvoUVlyqb
5c5kL8ERmrm0mmHgRAyt8hcb4Zv6wuzOCGBwmzhVLDe+rx7Nr68WBL1oJdcBzfJE
tYuV4RwF/iqyxfRKa5xxEkirawdiGRMo3D0MRVIyuaJoj70Cmy2pWJjChi0mgGfV
hNLREKlg60e7NXWYdtzAJE9w4KkM/emHdFLth9JNGr9AryLu32VTdqJQ9E9JKiK5
+veMNE4U2TzsKNqUTx1Li2UnogLhSNlO/ZetujG76QC97qBYfrFpiMIntf/kyox1
5IrhOAjZohUoH07Rm0bF6HXiVvteOvJg9NJAymFc7GdAZJvYuNfIsV3rFJNl2gHI
ybAVNlNApmuiOXh+umvCzAqUi3flaNev6Xuti98rbqi3aaxutCSwdS7xnWmvSaSy
HDNFVELLcyqSrTAI1P8StFHlV4FR4zJzq30T5N/aGfl+obMmLDpVpNbNVChSzdfU
x2te+gBcM7lZjKM8QOjqogcVSvUUPHQ9cvAtfmjCgH1IGigBmaejtBW1gzELykIp
nqmUX0Ef4QyYg8ylidBx
=u0rD
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.gnu.org_bd83e938_20250124_195658.html ===


| | **chicken-announce** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=chicken-announce)

---

[Date Prev][[Date Next](msg00001.html)][Thread Prev][[Thread Next](msg00001.html)][[Date Index](index.html#00000)][[Thread Index](threads.html#00000)]

## [Chicken-announce] [CRITICAL] Spiffy path traversal vulnerability

---

| **From**: | Mario Domenech Goulart |
| --- | --- |

| **Subject**: | [Chicken-announce] [CRITICAL] Spiffy path traversal vulnerability |
| **Date**: | Wed, 11 Nov 2015 22:34:52 +0000 |
| **User-agent**: | Gnus/5.13 (Gnus v5.13) Emacs/24.4 (gnu/linux) |

---

```
Hello,

Benedikt Rosenau discovered a critical security vulnerability
that affects Spiffy, the web server.

It's strongly advised that all Spiffy instances be updated as soon as
possible to version 5.4.  Please not that if you are using awful,
chickadee, pastiche, qwiki, websockets or any other egg that uses Spiffy
as HTTP server, your server is vulnerable as well.

Qwiki and henrietta may also be vulnerable, but to the best of
our knowledge there's no way to exploit the vulnerability so far.
Anyway, they have also been patched to restrict the possible
inputs.  If you are running qwiki and/or henrietta, updating to
versions 1.8 and 1.1 respectively is recommended.

The fix for the vulnerable eggs has just been released.  They are
available at the call-cc.org server.  You can update them with:

  $ chicken-install -l call-cc spiffy
  $ chicken-install -l call-cc qwiki
  $ chicken-install -l call-cc henrietta

Please note that in case of spiffy and qwiki, you may want to
stop the web server before updating it.

The new releases will be soon propagated to the canonical egg
server (~1h).

Description of the issue:

Spiffy assumes that a path component in the file system can never
contain slashes or NULs, which is true in a POSIX setting.  The
strings "." and ".." are also recognised as "special", so any
request to an URI with such path components is immediately
short-circuited to return 404 to ensure only paths BELOW the
document root can be accessed.

Additionally, on Windows, *back*slashes can't occur in path
components, but Spiffy neglected to filter these out.  This means
a path traversal attack has always been possible on that
platform.  Unexpectedly, Spiffy on UNIX is also affected by this.

The unfortunate cause of this is that some CHICKEN core
procedures are misbehaving: when passed a file that starts with a
backslash, some path manipulation procedures incorrectly
*replace* the backslash with a slash.  This has the effect of
injecting a path separator into a path component that was
supposed to be "atomic".  This results in the path component
being reinterpretated as two components.  An attacker can
therefore use backslashes in a URI to bypass Spiffy's pathname
component filtering, even on UNIX.

The issue with the CHICKEN core procedures has been addressed by
edd4926bb4f4c97760a0e03b0d0e8210398fe967 in the git repository, but it
is not in any stable release yet.  Note that Spiffy 5.4 eliminates the
vulnerability without requiring the fix for the CHICKEN core.

We apologize for the inconvenience.

We'd like to thank Benedikt Rosenau for discovering and reporting
the vulnerability.

The CHICKEN Team

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg00001.html)] |
| --- | --- | --- |

* **[Chicken-announce] [CRITICAL] Spiffy path traversal vulnerability**,
  *Mario Domenech Goulart* **<=**
  + **[Re: [Chicken-announce] [CRITICAL] Spiffy path traversal vulnerability](msg00001.html)**, *Peter Bex*, 2015/11/20

---

* Next by Date:
  **[Re: [Chicken-announce] [CRITICAL] Spiffy path traversal vulnerability](msg00001.html)**
* Next by thread:
  **[Re: [Chicken-announce] [CRITICAL] Spiffy path traversal vulnerability](msg00001.html)**
* Index(es):
  + [**Date**](index.html#00000)
  + [**Thread**](threads.html#00000)


