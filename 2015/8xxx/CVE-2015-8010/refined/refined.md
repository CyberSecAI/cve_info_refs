```
{
  "cve": "CVE-2015-8010",
  "description": "Cross-site scripting (XSS) vulnerability in the Classic-UI with the CSV export link and pagination feature in Icinga before 1.14 allows remote attackers to inject arbitrary web script or HTML via the query string to cgi-bin/status.cgi.",
  "affected_versions": [
    "Icinga before 1.14"
  ],
  "root_cause": "The Classic-UI parsed QUERY_STRING from the environment without proper sanitization.",
  "vulnerabilities": [
    "Cross-site Scripting (XSS)"
  ],
  "impact": "An attacker can inject arbitrary web script or HTML, potentially leading to session hijacking, defacement, or other malicious activities.",
  "attack_vectors": [
    "Network"
  ],
  "attacker_capabilities": "The attacker needs to be able to send a crafted URL to the Icinga instance. No authentication is required to exploit the vulnerability.",
  "additional_details": "The vulnerability is present in the Classic-UI's CSV export link and pagination feature. The functions parsing the QUERY_STRING from the environment did not sanitize the input, allowing for the injection of malicious code. The vulnerable CGI script is /cgi-bin/status.cgi, and the vulnerability is triggered when the attacker supplies a malicious query string (e.g., /cgi-bin/status.cgi?host=all&[XSS]). The fix involves sanitizing the query string and handling the CGI parameters properly.",
  "fix_details": [
    "The vulnerability is addressed by properly sanitizing the QUERY_STRING and parsing CGI parameters.",
      "The getcgivars() function was reworked so the content survives the whole lifetime of the cgi execution and gets free'd at the end.",
    "The url param parsing in every cgi was updated to prevent XSS."
  ]
}
```