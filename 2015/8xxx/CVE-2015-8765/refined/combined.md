=== Content from www.kb.cert.org_18b86862_20250125_233318.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#576313

## Apache Commons Collections Java library insecurely deserializes data

#### Vulnerability Note VU#576313

Original Release Date: 2015-11-13 | Last Revised: 2018-08-27

---

### Overview

The Apache Commons Collections (ACC) library is vulnerable to insecure deserialization of data, which may result in arbitrary code execution. Java applications that either directly use ACC, or contain ACC in their classpath, may be vulnerable to arbitrary code execution.

### Description

| [**CWE-502**](http://cwe.mitre.org/data/definitions/502.html)**: Deserialization of Untrusted Data -** CVE-2015-6420  In January 2015, at AppSec California 2015, researchers [Gabriel Lawrence and Chris Frohoff](http://frohoff.github.io/appseccali-marshalling-pickles/) described how many Java applications and libraries using Java Object Serialization may be vulnerable to insecure deserialization of data, which may result in arbitrary code execution. Any Java library or application that utilizes this functionality incorrectly may be impacted by this vulnerability.In November 2015, [Stephen Breen of Foxglove Security](http://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/) identified the [Apache Commons Collections](https://commons.apache.org/proper/commons-collections/) (ACC) Java library as being vulnerable to insecure deserialization of data; specifically, the ACC InvokerTransformer class may allow arbitrary code execution when used to deserialize data from untrusted sources. According to the researcher, this issue affects several large projects that utilize ACC including WebSphere, JBoss, [Jenkins](https://wiki.jenkins-ci.org/display/SECURITY/Jenkins%2BSecurity%2BAdvisory%2B2015-11-11), [WebLogic](http://www.oracle.com/technetwork/topics/security/alert-cve-2015-4852-2763333.html?elq_mid=31793&sh=&cmid=WWSU12091612MPP001C179), and OpenNMS. Unify also reports that [OpenScape](https://networks.unify.com/security/advisories/OBSO-1511-01.pdf) software is affected. In addition, [Cisco](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20) has released an advisory for their products.Both [versions 3.2.1 and 4.0](https://blogs.apache.org/foundation/entry/apache_commons_statement_to_widespread) of the Apache Commons Collections library have been identified as being vulnerable to this deserialization issue.The Apache Software Foundation has released a [statement](https://blogs.apache.org/foundation/entry/apache_commons_statement_to_widespread) regarding this issue, which contains advice for mitigating the issue, as well as further references and links. A [bug](https://issues.apache.org/jira/browse/COLLECTIONS-580) tracker entry has been filed to track progress toward a full solution.Other libraries, such as Groovy and Spring, are currently being investigated for similar flaws. Lawrence and Frohoff's presentation describes how applications and libraries written in other languages, such as Python and Ruby, may also be vulnerable to the same type of issue. It is generally up to software designers to follow best practices for security when handling serialized data, no matter the programming language or library used. |
| --- |

### Impact

| A Java application or library with the Apache Commons Collections library in its classpath may be coerced into executing arbitrary Java functions or bytecode.While many applications do not actively use serialization or deserailization, they often rely on libraries that do. If a class uses deserialization on some input stream (either a file or socket), and an attacker can send malicious data down that stream, the attacker can cause the program to construct objects of any class on its classpath (whether it uses those classes or not). And some classes, such as those in the ACC automatically execute code based on attacker-supplied deserialization input.An application that neither uses deserialization, nor employs any libraries that use deserialization, would not be vulnerable to this problem. Such an application should also lack a plugin architecture, or any mechanism for loading code that might use deserialization. |
| --- |

### Solution

| The CERT/CC is currently unaware of a full solution to this problem, but you may consider the following:**Apply an update**Apache Commons Collections [version 3.2.2](https://commons.apache.org/proper/commons-collections/download_collections.cgi) and [version 4.1](http://commons.apache.org/proper/commons-collections/download_collections.cgi) has been released. These new releases mitigate the vulnerability by disabling the insecure functionality.**Developers need to re-architect their applications, and should be suspicious of deserialized data from untrusted sources**Developers will need to make further architectural changes to secure their applications before they can re-enable functionality in ACC version 3.2.2 and later. From Apache's statement:*However, to be clear: this is not the only known and especially not unknown useable gadget. So replacing your installations with a hardened version of Apache Commons Collections will not make your application resist this vulnerability.* Developers should in general be very suspicious of deserialized data from an untrusted source. For best practices, see the [CERT Oracle Coding Standard for Java](https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=27492407) guidelines for Serialization, especially rules [SER12-J](https://www.securecoding.cert.org/confluence/display/java/SER12-J.%2BPrevent%2Bdeserialization%2Bof%2Buntrusted%2Bclasses) and [SER13-J](https://www.securecoding.cert.org/confluence/display/java/SER13-J.%2BTreat%2Bdata%2Bto%2Bbe%2Bdeserialized%2Bas%2Bpotentially%2Bmalicious%2Bby%2Bdefault).**Use firewall rules or filesystem restrictions**System administrators may be able to mitigate this issue for some applications by restricting access to the network and/or filesystem. If an affected application, such as Jenkins, utilizes an open port accepting serialized objects, restricting access to the application may help mitigate the issue. |
| --- |

### Vendor Information

576313
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23576313/) to view vendors.**
### [Apache Software Foundation](#GWAN-A45SB6) Affected

Updated:  November 10, 2015

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Cisco](#GWAN-A58L93) Affected

Updated:  July 18, 2017

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Cisco has released a [security advisory](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151209-java-deserialization) and list of affected products at the URL below. Cisco has assigned CVE-2015-6420 to this issue.

### Vendor References

* <http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151209-java-deserialization>

### Addendum

As of 2017-07-18, CERT/CC is aware of a report that Cisco Unity Express (CUE) 8.6.1 is still vulnerable to this issue and is incorrectly identified as "not vulnerable" in the above Cisco advisory. We have reached out to Cisco for clarification.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [IBM Corporation](#GWAN-A4RPC5) Affected

Updated:  November 30, 2015

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

IBM has released a security advisory for WebSphere at the following URL:

### Vendor References

* <http://www-01.ibm.com/support/docview.wss?uid=swg21970575>

### [Jenkins](#GWAN-A4RPGC) Affected

Updated:  November 30, 2015

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Jenkins has released a security advisory at the URL below. CVE-2015-8103 was assigned this issue in Jenkins.

### Vendor References

* [https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2015-11-11](https://wiki.jenkins-ci.org/display/SECURITY/Jenkins%2BSecurity%2BAdvisory%2B2015-11-11)

### [Oracle Corporation](#GWAN-A4RPAY) Affected

Updated:  November 30, 2015

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Oracle has released a security advisory at the URL below:

### Vendor References

* <http://www.oracle.com/technetwork/topics/security/alert-cve-2015-4852-2763333.html?elq_mid=31793&sh=&cmid=WWSU12091612MPP001C179>
* <https://blogs.oracle.com/security/entry/security_alert_cve_2015_4852>

### [Unify Inc](#GWAN-A4RP93) Affected

Updated:  November 30, 2015

**Statement Date:   November 24, 2015**

### Status

Affected

### Vendor Statement

"Unify is affected in two product lines as listed below. For details refer to the information given in the Security Advisory OBSO-1511-01.

We recommend all customers to apply the mitigations described in the advisory and install the corresponding product fix releases as soon as available.
To get notified about Advisory updates, subscribe as listed in <https://www.unify.com/security/advisories>."

### Vendor Information

Unify has issued Security Advisory OBSO-1511-01 at the URL listed below.

Mitre had assigned two CVE IDs for Unify products impacted by VU#576313:

CVE-2015-8237, affected products:
Unify OpenScape Fault Management V7 ("cpe:/a:unify:openscape\_fault\_management:7.%02")
Unify OpenScape Fault Management V8 ("cpe:/a:unify:openscape\_fault\_management:8.%02")

CVE-2015-8238, affected products:
Unify OpenScape UC Application V7 ("cpe:/a:unify:openscape\_uc\_application:7.%02")
Unify OpenScape Common Management Platform V7 ("cpe:/a:unify:openscape\_common\_management\_platform:7.%02")

### Vendor References

* <https://networks.unify.com/security/advisories/OBSO-1511-01.pdf>

### [Red Hat, Inc.](#GWAN-A4RPJ8) Unknown

Updated:  November 30, 2015

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

JBOSS has been reported as being affected.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 7.5 | AV:N/AC:L/Au:N/C:P/I:P/A:P |
| Temporal | 6.4 | E:POC/RL:W/RC:C |
| Environmental | 6.4 | CDP:ND/TD:H/CR:ND/IR:ND/AR:ND |

### References

* <https://blogs.apache.org/foundation/entry/apache_commons_statement_to_widespread>
* <https://issues.apache.org/jira/browse/COLLECTIONS-580>
* <http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151209-java-deserialization>
* <https://networks.unify.com/security/advisories/OBSO-1511-01.pdf>
* [http://www.oracle.com/technetwork/topics/security/alert-cve-2015-4852-2763333.html?elq\_mid=31793&sh=&cmid=WWSU12091612MPP001C179](http://www.oracle.com/technetwork/topics/security/alert-cve-2015-4852-2763333.html?elq_mid=31793&sh=&cmid=WWSU12091612MPP001C179 )
* [https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2015-11-11](https://wiki.jenkins-ci.org/display/SECURITY/Jenkins%2BSecurity%2BAdvisory%2B2015-11-11)
* <http://www.openwall.com/lists/oss-security/2015/11/11/3>
* <http://www.infoq.com/news/2015/11/commons-exploit>
* <https://tersesystems.com/2015/11/08/closing-the-open-door-of-java-object-serialization/>
* <http://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/>
* [http://mail-archives.apache.org/mod\_mbox/commons-dev/201511.mbox/%3c20151106222553.00002c57.ecki@zusammenkunft.net%3e](http://mail-archives.apache.org/mod_mbox/commons-dev/201511.mbox/%3C20151106222553.00002c57.ecki%40zusammenkunft.net%3E)
* <http://frohoff.github.io/appseccali-marshalling-pickles/>
* <http://www.slideshare.net/frohoff1/appseccali-2015-marshalling-pickles>
* <https://www.youtube.com/watch?v=VviY3O-euVQ>
* <https://commons.apache.org/proper/commons-collections/>
* <http://cwe.mitre.org/data/definitions/502.html>
* <https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=27492407>
* <http://www.oracle.com/technetwork/java/seccodeguide-139067.html#8>
### Acknowledgements

This type of vulnerability was reported publicly by Gabriel Lawrence and Chris Frohoff, and later investigated by Stephen Breen.

This document was written by Garret Wassermann with assistance from David Svoboda and the CERT Secure Coding team.

### Other Information

| **CVE IDs:** | [CVE-2015-6420](http://web.nvd.nist.gov/vuln/detail/CVE-2015-6420) |
| --- | --- |
| **Date Public:** | 2015-01-28 |
| **Date First Published:** | 2015-11-13 |
| **Date Last Updated:** | 2018-08-27 17:57 UTC |
| **Document Revision:** | 89 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from kc.mcafee.com_8cca5136_20250125_233318.html ===
Loading×Sorry to interruptCSS ErrorRefresh
