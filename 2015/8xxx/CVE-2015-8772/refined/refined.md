- **Root cause of vulnerability:** The McAfee File Lock Driver (McPvDrv.sys) does not properly validate the `VERIFY_INFORMATION.Length` field within an `IOCTL_DISK_VERIFY` request.
- **Weaknesses/vulnerabilities present:** The driver trusts the user-controlled `VERIFY_INFORMATION.Length` value when allocating kernel memory. This allows an attacker to specify a larger length than intended, leading to an out-of-bounds read.
- **Impact of exploitation:** A local attacker can exploit this vulnerability to read arbitrary kernel memory, potentially disclosing sensitive information, or crash the affected system.
- **Attack vectors:** The attacker sends a specially crafted `IOCTL_DISK_VERIFY` request to the driver. The input buffer of this request must contain a `VERIFY_INFORMATION` structure with a malicious length value.
- **Required attacker capabilities/position:** The attacker requires local access to the system to send the crafted IOCTL request to the vulnerable driver.