=== Content from bugzilla.mozilla.org_2bace662_20250125_075813.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1173284)
* [XML](/show_bug.cgi?ctype=xml&id=1173284)

Closed
[Bug 1173284](/show_bug.cgi?id=1173284)
(CVE-2015-8511)

Opened 10 years ago
Closed 9 years ago

# Firefox OS Lockscreen passcode bypass due to race condition

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox OS Lockscreen passcode bypass due to race condition

## Categories

### (Firefox OS Graveyard :: Gaia::System::Lockscreen, defect)

[Product:](/describecomponents.cgi?product=Firefox%20OS%20Graveyard)

Firefox OS Graveyard
▾

Firefox OS Graveyard
FirefoxOS, or Boot2Gecko (B2G) is Mozilla's operating system built on web standards. ([more info](https://wiki.mozilla.org/B2G))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20OS%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20OS%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen#Gaia%3A%3ASystem%3A%3ALockscreen)

Gaia::System::Lockscreen
▾

Firefox OS Graveyard :: Gaia::System::Lockscreen
Any issues related to Gaia's lockscreen.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

ARM

Gonk (Firefox OS)

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

## Tracking

### (blocking-b2g:2.5+, b2g-v2.0 wontfix, b2g-v2.0M wontfix, b2g-v2.1 wontfix, b2g-v2.1S wontfix, b2g-v2.2 wontfix, b2g-v2.2r wontfix, b2g-master fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

FxOS-S4 (07Aug)

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| blocking-b2g | [2.5+](/buglist.cgi?f1=cf_blocking_b2g&o1=equals&v1=2.5%2B) |
| --- | --- |

| blocking-b2g | 2.5+ |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| b2g-v2.0 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=wontfix) |
| b2g-v2.0M | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=wontfix) |
| b2g-v2.1 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=wontfix) |
| b2g-v2.1S | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=wontfix) |
| b2g-v2.2 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=wontfix) |
| b2g-v2.2r | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=wontfix) |
| b2g-master | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| b2g-v2.0 |  | wontfix |
| b2g-v2.0M |  | wontfix |
| b2g-v2.1 |  | wontfix |
| b2g-v2.1S |  | wontfix |
| b2g-v2.2 |  | wontfix |
| b2g-v2.2r |  | wontfix |
| b2g-master |  | fixed |

## People

### (Reporter: lixia, Assigned: gweng)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/aaec1e3c70b450dd7fce392e46d36158?d=mm&size=40)  [gweng](/user_profile?user_id=476523)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/b98bc212cb3a7aaecd8cb71d27df6487?d=mm&size=40)  [pcheng](/user_profile?user_id=501985)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b125706ec5eab7079333f4cec2f443a2?d=mm&size=40)  [lixia](/user_profile?user_id=519767)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

38 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1175955](/show_bug.cgi?id=1175955 "VERIFIED FIXED - passive pairing not work when fresh flash")

Dependency [tree](/showdependencytree.cgi?id=1173284&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1173284)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1177373](/show_bug.cgi?id=1177373 "RESOLVED DUPLICATE - lock passcode not requested when powering up"), [1184875](/show_bug.cgi?id=1184875 "RESOLVED DUPLICATE - Phone can be unlocked without password when restarting"), [1185096](/show_bug.cgi?id=1185096 "RESOLVED DUPLICATE - Lockscreen passcode bypass"), [1187368](/show_bug.cgi?id=1187368 "RESOLVED DUPLICATE - Lockscreen pass code bypass after reboot"), [1187765](/show_bug.cgi?id=1187765 "RESOLVED DUPLICATE - Bypass lockscreen without entering passcode"), [1265319](/show_bug.cgi?id=1265319 "RESOLVED DUPLICATE - Possible to circumvent lockscreen by swiping it away before it is visible")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions")

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [v3.0-nexus-5-l][b2g-adv-main2.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2015-8511

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[v3.0-nexus-5-l][b2g-adv-main2.5+]

QA Whiteboard:

[QAnalyst-Triage+]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [cr](/user_profile?user_id=465475) | [sec-review](#a7862760_465475 "9 years ago") | + |
| --- | --- | --- |
| [cr](/user_profile?user_id=465475) | sec-review | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4697466_1689 "10 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [logcat\_2047.txt](/attachment.cgi?id=8617794)  [10 years ago](#c1)  [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)   824.01 KB, text/plain |  | [Details](/attachment.cgi?id=8617794&action=edit) |
| --- | --- | --- |
| [passcode.mp4](/attachment.cgi?id=8617795)  [10 years ago](#c2)  [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)   5.24 MB, video/mp4 |  | [Details](/attachment.cgi?id=8617795&action=edit) |
| [WIP patch](/attachment.cgi?id=8628283)  [10 years ago](#c20)  [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)   46 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=8628283&action=edit) | [Review](/attachment.cgi?id=8628283) |
| [[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master](/attachment.cgi?id=8636455)  [10 years ago](#c31)  [GitHub Autolander Bot](/user_profile?user_id=517379)   46 bytes, text/x-github-pull-request | timdream : [review+](#c64 "9 years ago")  timdream : [feedback+](#c37 "10 years ago") | [Details](/attachment.cgi?id=8636455&action=edit) | [Review](/attachment.cgi?id=8636455) |
| [The new PR](/attachment.cgi?id=8640386)  [9 years ago](#c84)  [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)   46 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=8640386&action=edit) | [Review](/attachment.cgi?id=8640386) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1173284#c0)• 10 years ago |
|  | |

[1.Description]:
[Flame v3.0][Nexus 5 v3.0][Lock Screen]Enable the passcode, restart device, slide to left for unlocking screen, but sometimes it will not prompt user to input the passcode and directly enter homescreen.
Found time: 20:47
Attach: passcode.mp4 and logcat\_2047.txt
[2.Testing Steps]:
1. Enable passcode lock in Settings/Screen Lock.
2. Restart device.
3. Try to unlock screen.
[3.Expected Result]:
3. It should prompt user to input passcode for unlocking sceen.
[4.Actual Result]:
3. It will not prompt user to input passcode.
[5.Reproduction build]:
Device: Flame v2.2 build(unaffected)
Build ID 20150609162508
Gaia Revision 06edb0f8db7c2f45cde54401a8593663059861a4
Gaia Date 2015-06-08 14:29:09
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/a3d7b08fb0ec>
Gecko Version 37.0
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150609.211329
Firmware Date Tue Jun 9 21:13:39 EDT 2015
Bootloader L1TC000118D0
Device: Nexus 5 v2.2 build(unaffected)
Build ID 20150609081832
Gaia Revision 06edb0f8db7c2f45cde54401a8593663059861a4
Gaia Date 2015-06-08 14:29:09
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/239c59921129>
Gecko Version 37.0
Device Name hammerhead
Firmware(Release) 5.1
Firmware(Incremental) eng.cltbld.20150609.121628
Firmware Date Tue Jun 9 12:16:44 EDT 2015
Bootloader HHZ12f
Device: Flame v3.0 build(affected)
Build ID 20150609160220
Gaia Revision 31ef8deec7a04a988eb92309178b87cc0bde8220
Gaia Date 2015-06-08 14:48:40
Gecko Revision <https://hg.mozilla.org/mozilla-central/rev/8be8deb10e4f>
Gecko Version 41.0a1
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150609.193617
Firmware Date Tue Jun 9 19:36:29 EDT 2015
Bootloader L1TC000118D0
Device: Nexus 5 v3.0 build(affected)
Build ID 20150609081840
Gaia Revision ea27c4ed5b6083c9e21d233d4804372ac4d5d353
Gaia Date 2015-06-08 03:06:41
Gecko Revision <https://hg.mozilla.org/mozilla-central/rev/e10e2e8d8bf2>
Gecko Version 41.0a1
Device Name hammerhead
Firmware(Release) 5.1
Firmware(Incremental) eng.cltbld.20150609.121002
Firmware Date Tue Jun 9 12:10:19 EDT 2015
Bootloader HHZ11k
[6.Reproduction Frequency]:
occasionally Recurrence,6/20
[7.TCID]:
Free Test

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a171_519767)• 10 years ago |

[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected)
[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected)

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1173284#c1)• 10 years ago |
|  | |

Attached file
[logcat\_2047.txt](attachment.cgi?id=8617794)
— [Details](attachment.cgi?id=8617794&action=edit)

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1173284#c2)• 10 years ago |
|  | |

Attached video
[passcode.mp4](attachment.cgi?id=8617795)
— [Details](attachment.cgi?id=8617795&action=edit)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1173284#c4)• 10 years ago |
|  | |

[Blocking Requested - why for this release]:
The user should always be prompted for a passcode and this is a regression so nominating this 3.0?blocking-b2g: --- → 3.0?Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---),
[regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [Pi Wei Cheng [:piwei] (inactive)](/user_profile?user_id=501985) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a1437857_501985)• 10 years ago |

QA Contact: pcheng

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1173284#c5)• 10 years ago |
|  | |

Nom is good.
I noticed one case is when the phone is flashed and the device is turned off completely and then turned back on.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1173284#c6)• 10 years ago |
|  | |

I am able to reproduce this by swiping unlock less than one second after the lock screen is first displayed at power on. Waiting more than one second or so prevents the issue from occurring, and it correctly asks for a PIN.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1173284#c7)• 10 years ago |
|  | |

A reflash is not required to trigger the issue.

|  | [Michael Henretty [:mikehenrty][:mhenretty]](/user_profile?user_id=468904) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1173284#c8)• 10 years ago |
|  | |

This is a big concern for our foxfooders. Let's fix ASAP. Greg, any ideas what may be going on?blocking-b2g: 2.5? → 2.5+Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1173284#c9)• 10 years ago |
|  | |

I would check regression window from the time [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") got landed, since recently I don't remember I changed any LockScreen control flow except for this one.
The PR is here:
<https://github.com/mozilla-b2g/gaia/pull/30383>
If it only exists after this bug than we need to fix it in the bootstraping code. If not, it's a pure LockScreen issue. It would be helpful if we could first identify this.Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1173284#c10)• 10 years ago |
|  | |

Yes...I've bisected the bug. While it's without the patch from [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), namely the patch:
c1ef854924f18357832ddcf98dc6c42391d5599e
I cannot reproduce it anymore. However, this is an unfortunately news. Since Alive's gone, and the patch is too huge, it's hard to fix this.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1173284#c11)• 10 years ago |
|  | |

And maybe this should be in the pocket of smoke test, since it bypasses the security check. I don't know why it could escape from our people's check, I think it's another reason why never land big patch without split it.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1173284#c12)• 10 years ago |
|  | |

Hi Michael: as I said, even though this is a serious bug, I may not solve it soon since the patch quite complicated (although I'll try it). Meanwhile I don't know what happened (maybe the exciting working week) to let the first landing (6/4) and report (6/10) are so far from the current revision (6/28). So if we can build some automation or manual test case for the bug, it would be great. But since I can only reproduce it after rebooting on device, I don't know if an automation test running not on an device could work as well.Flags: needinfo?(mhenretty)

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1173284#c13)• 10 years ago |
|  | |

Should we be marking the lockscreen as 'ready' before we've wired up the passcode-lock preference to the lockscreen?
--- a/apps/system/lockscreen/js/lockscreen.js
+++ b/apps/system/lockscreen/js/lockscreen.js
@@ -329,6 +329,11 @@
\*/
LockScreen.prototype.init =
function ls\_init() {
+ window.SettingsListener.observe(
+ 'lockscreen.passcode-lock.enabled', false, (function(value) {
+ this.setPassCodeEnabled(value);
+ }).bind(this));
+
this.ready = true;
/\*\*
\* "new style" slider: as described in <https://bugzil.la/950884>
@@ -407,11 +412,6 @@
this.overlay.classList.remove('uninit');
}).bind(this));
- window.SettingsListener.observe(
- 'lockscreen.passcode-lock.enabled', false, (function(value) {
- this.setPassCodeEnabled(value);
- }).bind(this));
-

|  | [Pi Wei Cheng [:piwei] (inactive)](/user_profile?user_id=501985) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1173284#c14)• 10 years ago |
|  | |

b2g-inbound regression window:
Last Working
Device: Flame
BuildID: 20150604012244
Gaia: e0fbadeb78a96137f071d9be7a47ef9fe882d17f
Gecko: 64ce149fabf1
Version: 41.0a1 (3.0 Master)
Firmware Version: v18D-1
User Agent: Mozilla/5.0 (Mobile; rv:41.0) Gecko/41.0 Firefox/41.0
First Broken
Device: Flame
BuildID: 20150604020845
Gaia: c1ef854924f18357832ddcf98dc6c42391d5599e
Gecko: 4f7e7631e277
Version: 41.0a1 (3.0 Master)
Firmware Version: v18D-1
User Agent: Mozilla/5.0 (Mobile; rv:41.0) Gecko/41.0 Firefox/41.0
Last Working Gaia & First Broken Gecko - no repro
Gaia: e0fbadeb78a96137f071d9be7a47ef9fe882d17f
Gecko: 4f7e7631e277
Last Working Gecko & First Broken Gaia - repro
Gaia: c1ef854924f18357832ddcf98dc6c42391d5599e
Gecko: 64ce149fabf1
Gaia pushlog:
<https://github.com/mozilla-b2g/gaia/compare/e0fbadeb78a96137f071d9be7a47ef9fe882d17f...c1ef854924f18357832ddcf98dc6c42391d5599e>
Confirmed that this is caused by [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.").Blocks: [system-bootstrap](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.")QA Whiteboard: [QAnalyst-Triage?]Flags: needinfo?(ktucker)Keywords: [regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1173284#c15)• 10 years ago |
|  | |

Tim, can you take a look at this please since the author of the landing for [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") is no longer active? Looks like that landing caused this issue to occur.QA Whiteboard: [QAnalyst-Triage?] → [QAnalyst-Triage+]Flags: needinfo?(ktucker) → needinfo?(timdream)

|  | [Michael Henretty [:mikehenrty][:mhenretty]](/user_profile?user_id=468904) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1173284#c16)• 10 years ago |
|  | |

(In reply to Greg Weng [:snowmantw][:gweng][:λ] from [comment #12](/show_bug.cgi?id=1173284#c12 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> Hi Michael: as I said, even though this is a serious bug, I may not solve it
> soon since the patch quite complicated (although I'll try it). Meanwhile I
> don't know what happened (maybe the exciting working week) to let the first
> landing (6/4) and report (6/10) are so far from the current revision (6/28).
> So if we can build some automation or manual test case for the bug, it would
> be great. But since I can only reproduce it after rebooting on device, I
> don't know if an automation test running not on an device could work as well.
Hi Greg, thanks for the explanation. If we were to add the `lockscreen.passcode-lock.enabled` and `lockscreen.passcode-lock.code` settings to a Marionette-JS startup (like here [1]), could we reproduce this bug from the context of an integration test?
1.) <https://github.com/mozilla-b2g/gaia/blob/da447493053e704533c2b3fbb6be8dc93f71dacc/apps/system/test/marionette/software_home_fullscreen_test.js#L13>Flags: needinfo?(mhenretty) → needinfo?(gweng)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1173284#c17)• 10 years ago |
|  | |

Greg is the best person left to fix this, however given the complexity we would need some time to find the root cause.
This reads like a timing issue to me. Fixing it shouldn't be hard once we found the cause.Flags: needinfo?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1173284#c18)• 10 years ago |
|  | |

Tim: Just update the situation: it looks caused by a "delay mozSetting change", revealed by the new bootstrapping and not covered by tests. I've found that
1. LockScreenStateManager would `start` itself to observe "lockscreen.passcode-lock.enabled". If the value is true, unlocking leads to passcode panel. Else, it unlocks straightly.
2. With new bootstrapping chain, the UI would show up since LockScreenWindowManager has been bootstrapped. LockScreenStateManager starts itself after that. This would observe the setting change immediately. And from the log, it does. Since I use SettingsListener, the "change" in fact includes the initial value even without any change after.
3. \*However\*, the value change bubbled up in an asynchronous way, and it's a really long waiting (about 1 second after the manager observers it). So before the value returns, the whole UI is able to be manipulated, while the passcode-enabled is assumed as false. This is why the bug appears.
The tricky part is such long waiting only happens when you do a cold restart. If it only restart b2g process, the reading would be quick enough to hide the symptom. So that's one reason that I guess it can't be discovered in automatic tests, although I would still try.
For the bug, solution is to hook LockScreenStateManager and the observing on the bootstraping chain: only when the state manager got the passcode value from the launcher, the OS logo hides itself and make LockScreen window visible. This should fix the bug but I need some time to figure out how to do that.
And I still have no idea about how it was covered in the past. Maybe in the previous version OS logo hides itself lately, so user has no chance to do trigger that. Anyway, I don't believe in the previous complex of bootstrapping, we have any good chance to discover it like this. So although the author had gone and we need to take regressions from the lost king, to fix this is still fair enough.Flags: needinfo?(timdream)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1173284#c19)• 10 years ago |
|  | |

Understood, thank you for the analysis.Flags: needinfo?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1173284#c20)• 10 years ago |
|  | |

Attached file
[WIP patch](attachment.cgi?id=8628283)
— [Details](attachment.cgi?id=8628283&action=edit)

Tim: this is a hotfix. It:
1. Changes booting sequence of LockScreenStateManager as a Promise, for those async steps
2. Bubbles up:
a) [Launcher] waiting [LockScreenLauncher]
b) [LockScreenLauncher] waiting [LockScreenWindowManager#openApp]
c) [LockScreenWindowManager#openApp] waiting [LockScreenStateManager#start]
So [Launcher] would only remove the animation/logo after the chain got entirely ready. Almost all these waiting are in Promises. The only one exception is:
3. |LockScreenWindowManager#openApp| would call |createWindow| if the WM is first time launched. So, |createWindow| would eventually fire an event called |lockscreen-frame-bootstrap| to notify stuff inside the \*lockscreen frame\* to start themselves, which includes |LockScreenStateManager|. As a result, the |#openApp| method needs to know when does this inner bootstrapping progress done. And I add a |lockscreen-frame-bootstrap-done| event to do that. You can image if it's an app there \*must\* be some IAC things. It's in fact discussed with Alive once, but he didn't adopt that because he didn't think it's necessary. Anyway, after |#openApp| got the |-done| event, it would resolve the promise to let caller (the |LockScreenLauncher|) know it's done, too. So the launcher could now know it's launched, and to let the master launcher keep going.
(If my explanation is too confused, we may have it offline.)
4. The impact is the bootstrapping time, which has been sped up by the new bootstrapping, now slower than that because it now need to wait such mozSettings read. And sometimes it's quite long. Maybe we should invite performance team to find out if we can boost this, or if we can optimize it from Gaia to avoid too much platform work in short releases.
And as I said, this is just a hotfix. It's in fact need a clear rewriting to make all of these subcomponent bootstrapping processes become Promise-orient. But for LockScreen business I don't think we have such resource so far, so let's pray in the future the entropy of this component would not grow fast.
[Attachment #8628283](/attachment.cgi?id=8628283&action=edit "WIP patch") -
Flags: feedback?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1173284#c21)• 10 years ago |
|  | |

Comment on [attachment 8628283](/attachment.cgi?id=8628283 "WIP patch") [[details]](/attachment.cgi?id=8628283&action=edit "WIP patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8628283)
WIP patch
Discussed with Tim. Conclusion:
1. Find how long the settings reading is
2. LockScreen can show it self before the reading done, so we could reduce the waiting time of app interaction
3. However, when it's going to unlock, if the reading is unfinished, block the unlocking until it's done. So we can still switch to the correct unlocking panel
4. If the reading time is still too long and user would feel it "lags" when unlocking, ask UX' opinion before we can address the issue (as a follow-up bug)
The point is we all agree that to add more coupling between System and LockScreen is bad. So if it's a pure LockScreen solution, it would be better.
[Attachment #8628283](/attachment.cgi?id=8628283&action=edit "WIP patch") -
Flags: feedback?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1173284#c22)• 10 years ago |
|  | |

Unfortunately it looks that we hit a mozSettings issues. The log:
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>>> launching lockscreen 1435570622127
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>> start state manager: 1435570623006
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>>> animate poweron logo 1435570623095
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>>> remove poweron logo 1435570626797
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>> got passcode status: 1435570630566
shows that from user could see LockScreen ("remove poweron logo") to ("got passcode status) is almost 3.8 seconds. And it's not caused by launching or setting up something, because the state manager was already started at "start state manager". And it's also long from there to the final reading. So, the whole time may spend on waiting to read the value.
I'm not sure if it's because of new bootstrapping reads too many values from settings before this step. I would still solve this issue by blocking user to unlock the phone if it's waiting to read the value, since to leave a security hole is much serious. After that, I would start to address the performance issue.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a2241288_476523)• 10 years ago |

Blocks: [1175955](/show_bug.cgi?id=1175955 "VERIFIED FIXED - passive pairing not work when fresh flash")

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1173284#c23)• 10 years ago |
|  | |

Update: I've patched it to fix the bug. However, the performance issue is very serious, since the animation of unlocking is by-passed, too. So I'm now profiling and try to pin it down.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1173284#c24)• 10 years ago |
|  | |

There is a bug about mozSetting reading is too slow (confidential): [Bug 1100188](/show_bug.cgi?id=1100188 "RESOLVED WONTFIX"). But for the missing animation I still need to dig in to find out the root cause.

|  | [Cervantes Yu [:cyu] [:cervantes]](/user_profile?user_id=434958) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1173284#c25)• 10 years ago |
|  | |

SPS Profile: <https://people.mozilla.org/~bgirard/cleopatra/#report=bf0feb427edd35bfed3dd9471dec0de538800b19&javascriptOnly=true&filter=%5B%7B%22type%22%3A%22RangeSampleFilter%22,%22start%22%3A62288,%22end%22%3A62447%7D%5D&selection=0,3,4,5,6,7,8,9,10,11,12,13,9,14,15,16,17,18,20,21,22,23,24,25,26,72>

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1173284#c26)• 10 years ago |
|  | |

Has the security hole been closed in the latest foxfood OTA update?Flags: needinfo?(nhirata.bugzilla)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1173284#c27)• 10 years ago |
|  | |

Richard, the bug that is addressing the issue that you're speaking of is this bug. No patches have officially landed, so no. The OTA does not have the fix for the lockscreen issue you are speaking of.Flags: needinfo?(nhirata.bugzilla) → needinfo?(rsoderberg)

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1173284#c28)• 10 years ago |
|  | |

Yeah. [Comment 22](/show_bug.cgi?id=1173284#c22 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") indicated that a fix for the security issue had been confirmed, and so I'd hoped we chose to close the security hole (that prevents me from putting \*any\* credentials on my device for foxfood testing) while the performance investigation continues. Ah well.Flags: needinfo?(rsoderberg)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1173284#c29)• 10 years ago |
|  | |

Update: still digging in performance issue. [Bug 1100188](/show_bug.cgi?id=1100188 "RESOLVED WONTFIX") looks also related to the performance issue.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3090904_476523)• 10 years ago |

Assignee: nobody → gwengFlags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1173284#c30)• 10 years ago |
|  | |

Update: Discussed with Tim. Now I'm trying the new solution, but it's quite complicated so we need some more time to fix this.

|  | [GitHub Autolander Bot](/user_profile?user_id=517379) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1173284#c31)• 10 years ago |
|  | |

Attached file
[[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master](attachment.cgi?id=8636455)
— [Details](attachment.cgi?id=8636455&action=edit)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1173284#c32)• 10 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
Tim: this is the patch based on what we have discussed. I set feedback to see if you have any opinion about the code, before I start to write the tests. Thanks.
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: feedback?(timdream)

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1173284#c33)• 10 years ago |
|  | |

Is it possible to see that patch as two commits - one creating the 'this.bootstrapping = ...' block, and then a second that fixes the lockscreen issue itself?

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1173284#c34)• 10 years ago |
|  | |

It's quite complicated: the lockscreen part is because Alive had changed when and how to load the components inside LockScreen. In previous version, they were assumed as synchronous, or ready, at the moment LockScreen was used by LockScreenStateManager. He changed that but not changed how these two component cooperate. So I need to change the LockScreen to make the whole loading process in a promise that the state manager could get it and know when does the lockscreen get fully loaded. In fact, this is a minor change compare to the changes I've done for the state manager. So, yes, you can say it's two commits, but they're so related so I think it's okay to put them in one commit.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1173284#c35)• 10 years ago |
|  | |

This bug occurs on 2.2 on flame. I just checked with today's build:
Build ID 20150721162504
Gaia Revision e1e6317f17a840b19af9dbb25f5a771d8d9fa161
Gaia Date 2015-07-15 21:05:11
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/a73051740290>
Gecko Version 37.0
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150721.203103
Firmware Date Tue Jul 21 20:31:14 EDT 2015
Bootloader L1TC000118D0
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1173284#c36)• 10 years ago |
|  | |

Also occurs in :
Build ID 20150721161206
Gaia Revision cc24cce17ab2ebf79f6505103da714fc65bc5ec1
Gaia Date 2015-07-15 18:48:55
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g34_v2_1/rev/3856aebece7b>
Gecko Version 34.0
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150721.193944
Firmware Date Tue Jul 21 19:39:55 EDT 2015
Bootloader L1TC000118D0
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3607906_391803)• 10 years ago |

[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1173284#c37)• 10 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
We really, really need to simplify the code here........
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: feedback?(timdream) → feedback+

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1173284#c38)• 10 years ago |
|  | |

Marking this as security-sensitive b2g bug, rating sec-criticalGroup: b2g-core-securityKeywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3833777_465475)• 10 years ago |

Summary: [Lock Screen]Sometimes it will not prompt user to input passcode for unlocking screen after restarting device. → [Lock Screen] pass code bypass after restarting device due to settings observer race condition

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1173284#c39)• 10 years ago |
|  | |

I'm confident this is a race condition with the settings observers. I discussed parts of this and a dirty hotfix in [bug 1187368](/show_bug.cgi?id=1187368 "RESOLVED DUPLICATE - Lockscreen pass code bypass after reboot") (which I'll mark duplicate of this now). Switching to promises looks like the clean solution.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3834306_465475)• 10 years ago |

Summary: [Lock Screen] pass code bypass after restarting device due to settings observer race condition → [Lock Screen] pass code bypass after reboot due to settings observer race condition

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1173284#c41)• 10 years ago |
|  | |

I have been exploring a very simple promise-based fix. Since it's delaying most of LockScreen's init code to after the SettingsListener getter promises resolve, it unfortunately has some visual regressions, showing a mostly black lock screen on startup, and showing Homescreen placing icons if lockscreen is disabled:
Fix pass code reboot bypass with promise
Moving the grunt of LockScreen .init() to .initStaged() which is called
from a promise that wraps settings getters for the problematic settings
values, avoiding the race condition that allows pass code bypass.
It has the side effect of showing no lock screen when it is disabled
in settings, and it creates two UX artefacts by exposing apps
while rendering their UI:
- (mostly) black lock screen state on startup
- Homescreen rendering icons when lock screen disabled
diff --git a/apps/system/lockscreen/js/lockscreen.js b/apps/system/lockscreen/js/lockscreen.js
index c3be4b4..b0ac6fe 100755
--- a/apps/system/lockscreen/js/lockscreen.js
+++ b/apps/system/lockscreen/js/lockscreen.js
@@ -62,7 +62,7 @@
\* in Settings API.
\* Will be ignored if 'enabled' is set to false.
\*/
- passCodeEnabled: false,
+ passCodeEnabled: true,
/\*
\* Boolean returns whether the screen is enabled, as mutated by screenchange
@@ -330,6 +330,27 @@
LockScreen.prototype.init =
function ls\_init() {
this.ready = true;
+
+ /\*\*
+ \* Ensure that settings state is up to date before deciding on pass code
+ \* locking or not. This avoids a race conditions with Settings observers.
+ \*/
+ var pEnabled = window.SettingsListener
+ .getSettingsLock().get('lockscreen.enabled');
+ pEnabled.then((v) => {
+ this.setEnabled(v['lockscreen.enabled']);});
+
+ var pPassEnabled = window.SettingsListener
+ .getSettingsLock().get('lockscreen.passcode-lock.enabled');
+ pPassEnabled.then((v) => {
+ this.setPassCodeEnabled(v['lockscreen.passcode-lock.enabled']);});
+
+ var pSettings = Promise.all([pEnabled, pPassEnabled]);
+ pSettings.then(() => {this.initStaged()});
+ };
+
+ LockScreen.prototype.initStaged =
+ function ls\_initStaged() {
/\*\*
\* "new style" slider: as described in <https://bugzil.la/950884>
\* setting this parameter to true causes the LockScreenSlide to render

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1173284#c42)• 10 years ago |
|  | |

FxOS always opens the lock screen on reboot even if the user disables it in the settings. This turned out to be an artefact of the very same race condition that causes the pass code bypass. Has this been a conscious design decision?

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1173284#c43)• 10 years ago |
|  | |

(In reply to Christiane Ruetten [:cr] from [comment #42](/show_bug.cgi?id=1173284#c42 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> FxOS always opens the lock screen on reboot even if the user disables it in
> the settings. This turned out to be an artefact of the very same race
> condition that causes the pass code bypass. Has this been a conscious design
> decision?
It seems like this is a UX design question, so I'm tentatively setting needinfo? Tiffany (UX) to invite comment.Flags: needinfo?(tshakespeare)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1173284#c44)• 10 years ago |
|  | |

Just a remind: I've attached my patch (see the comment) to fix this according to the current design of state manager (which manages most of UI changes right now and should take over the legacy LockScreen in the future, although we have discovered some concerns so we were trying to migrate to another new state machine, which eliminates lots of issues of this intermediate one). The patch is still in progress because I'm writing unit tests for that, and I could only unfortunately use a slow round-robing strategy to allocate my time on that, because I'm also dealing with some other critical issues in different components.
So, what I'm saying is, if you're proposing a new patch, please note the thing should be considered with the fact that the legacy LockScreen, as I mentioned many times, now is in a progress to decentralize itself to multiple components. You'll never want to see another 2000+ lines 'lockscreen.js' appears again (that's what happened in v1.2: at that time it's a ridiculous monolithic component only smaller than the 'window\_manager.js' which is also a ridiculous and messy one). And for the solution, as you can see in the second WIP patch (with f+), I did what you posted here as a state condition of LockScreenStateManager, not as a global "init lock" that would postpone every initialization things until it's fully read (result in what you mentioned: the "black lockscreen state on startup"). That's because although the solution is exactly what I also considered to adopt to solve the case, it really hurts our platform because:
- User don't know what's happening: all they can see is a black screen without any prompt
- While only the unlocking action depends on the value, LockScreen components should be able to do other rendering and preparation things \*\*in parallel\*\*. To block all of these by a value may or may not be used later indeed violates what the performance team is doing: reducing the time user can start use the app as much as possible.
So what I've discussed with Tim is, according to [Comment 30](/show_bug.cgi?id=1173284#c30 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") and [Comment 32](/show_bug.cgi?id=1173284#c32 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), we should show the screen as soon as possible. And only block user only when the value isn't ready but the finger already dragged the slider to the end, which means the intention of unlocking now is presented. So the diagram would be:
[Booting]----|show LockScreen | ---- done | |
|other preparations| ------ done | user could unlock here | -----------------|
|slider rendering | ---- done | | |
|read the value | ---------- (an unfortunate long waiting at [Comment 22](/show_bug.cgi?id=1173284#c22 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")) -- \* --> unlock
As you can see, to respect the performance and UX principlse we can't make the diagram as:
[Booting]----|read the value| ---- (reading....) ---- |show LockScreen...| ----- |user could unlock here|
Nevertheless, I think for 2.2 and 2.1, since I believe it's not really a regression but an old bug hidden in the previous tests and bootstrapping which is slower than now (so it covered the symptom well), if the mozSettings reading isn't too long, we may patch them as that.Flags: needinfo?(cr)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1173284#c45)• 10 years ago |
|  | |

I'm aware, and I'm all supportive of your rewrite, and I'm not proposing to replace your patch. But as you say: it's a huge and complex project, and I am merely posting minimally-intrusive fixes so that we don't stand empty-handed until your rewrite lands.Flags: needinfo?(cr)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1173284#c46)• 10 years ago |
|  | |

Okay. Thanks for your understanding and affords. I plan to complete this and land the patch in the next week, although it depends on the CI results. Sorry for the delay.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1173284#c47)• 10 years ago |
|  | |

Sorry, \*efforts\*, a sleepy time :(

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1173284#c48)• 10 years ago |
|  | |

It's not remotely exploitable and requires a device falling into the wrong hands ("angry spouse attack"), so I'd down-rate this to sec-moderate, but I'm settling for sec-high because a bug like this can easily result in a serious PR disaster.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1173284#c52)• 10 years ago |
|  | |

Update: fixed all unit tests of state manager, will continue to fix other failed tests for the patch.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4058338_465475)• 10 years ago |

Group: core-securityFlags: sec-bounty?

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1173284#c53)• 10 years ago |
|  | |

Okay. All tests are green:
<https://treeherder.mozilla.org/#/jobs?repo=gaia&revision=1094fb7bc7ecfdc157c0ea0cf0c56a619b847f87>
I now will try to add new tests for the new parts. If everything is fine, I will be able to land it within these two days.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1173284#c54)• 10 years ago |
|  | |

Is [bug 1187765](/show_bug.cgi?id=1187765 "RESOLVED DUPLICATE - Bypass lockscreen without entering passcode") a dupe of this one?

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1173284#c55)• 10 years ago |
|  | |

Oh, yes, I missed it in the bugmail, sorry.

|  | [:gerard-majax](/user_profile?user_id=41385) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1173284#c56)• 9 years ago |
|  | |

Jumping into this, I see you are playing with mozSettings observers, and specifically moving code around. Please make sure you do not endup with a codepath that gets triggered multiple times within the systemapp without a matching removeObserver(): otherwise, this will just leak observers and slow down the system.

|  | [:gerard-majax](/user_profile?user_id=41385) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1173284#c57)• 9 years ago |
|  | |

(In reply to Greg Weng [:snowmantw][:gweng][:λ] from [comment #24](/show_bug.cgi?id=1173284#c24 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> There is a bug about mozSetting reading is too slow (confidential): Bug
> 1100188. But for the missing animation I still need to dig in to find out
> the root cause.
Investigation on this topic showed that the big delay was because the main thread was busy, and thus messages delivery was taking quite some time. Given the context, I get that you are observing the latency during a boot time phase. And this is exactly the moment where this happens. So the 3.8 secs delay you are observing can just be because of this: slow async messages passing because of busy main process.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1173284#c58)• 9 years ago |
|  | |

We have had some profiling, but it only shows the main thread is waiting somethings, not really busy. And we can't see what makes it waiting. Maybe the root cause is just like you said. But we also discovered some extra waiting in settings delay the whole booting time, and some of the requests seems from Gecko. For example, BT enabled value reading delay all the following settings at very beginning, and we've found they are all reading requests, so in theory they could be parallel executed. Anyway, for this bug we can try to find a specific solution first. I just mentioned that Cervantes and me prepare to do some study to see if mozsettings could be more optimised by making it more parallel. And since you once landed a patch about FORCE READONLY flag of setting requests, we want to know if you have some similar plans or concerns, so that we don't need to fix the duplicated bugs.
(This is a BTW. But since you mentioned the relative point, I post it here)

|  | [[:fabrice] Fabrice Desré](/user_profile?user_id=390071) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1173284#c59)• 9 years ago |
|  | |

We should focus on correctness instead of performance in this bug. It's pretty unacceptable to have a broken lock screen.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1173284#c60)• 9 years ago |
|  | |

Yes. I will land the Gaia patch first. I have almost completed that (see my updates). We may fire another bug for performance.

|  | [Tiffanie Shakespeare [:tif]](/user_profile?user_id=478202) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1173284#c61)• 9 years ago |
|  | |

(In reply to Richard Soderberg [:atoll] from [comment #43](/show_bug.cgi?id=1173284#c43 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> (In reply to Christiane Ruetten [:cr] from [comment #42](/show_bug.cgi?id=1173284#c42 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> > FxOS always opens the lock screen on reboot even if the user disables it in
> > the settings. This turned out to be an artefact of the very same race
> > condition that causes the pass code bypass. Has this been a conscious design
> > decision?
>
> It seems like this is a UX design question, so I'm tentatively setting
> needinfo? Tiffany (UX) to invite comment.
If the user disables the lockscreen in settings, then how do they know how to unlock the device? The device should be respecting the user's settings and either prompt them or not depending on the their settings.
Adding Harly for further comment if needed. Thanks!Flags: needinfo?(tshakespeare) → needinfo?(hhsu)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1173284#c62)• 9 years ago |
|  | |

Tiffanie, perhaps this is already clear, but it sounds like this may need clarification: we're talking about two types of locking in this bug: screen locking, requiring the user just to swipe, and pass code locking, requiring pin entry.
The side-issue I brought up in [comment #42](/show_bug.cgi?id=1173284#c42 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") is that after reboot the device is always screen-locked even when the user disables screen lock. The rest of this bug is about an error in pass code locking, but both these have a common cause.
But from your comment I take that invariably booting to screen lock was in fact not a deliberate UX decision.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1173284#c63)• 9 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
Since it works on my device and passed all tests on CI (excepted one I fixed now) and local console, set review.
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: review?(timdream)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1173284#c64)• 9 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
I have one major concern around this patch and I want to know if this is something purposely done to make turnaround faster or accidental sloppiness.
|this.lockScreenStates.passcodeEnabled| could be either an anno object from |deferredRequest| or an actual boolean. You should try to pick one and stuck with it -- having to leverage dynamic-typing in JS almost always imply questionable design.
One alternative to be schedule the state-getting promises on to the mainPromise so that we could ensure the states are always an up-to-date boolean when the first |doTransfer| is being run. In that way you don't need to do complex things like above nor |resolveInnerStates| etc.
r=me if I am just wrong, if you don't agree with what I said, or you want to fix this in future bugs.
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: review?(timdream) → review+

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1173284#c65)• 9 years ago |
|  | |

Before I reply Tim, I suddenly found it's a regression the root cause is only on 2.2+ (master; see [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")). But obviously this bug exists in 2.0, 2.1 and 2.2. I think we better to clarify the regression status: if it's really a regression as [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), the 2.0, 2.1 and 2.2 symptom before [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") \*couldn't\* be the same bug. They must be with different root causes and deserves different solutions in different bugs. So I suggest that we should fire and investigate another bug for 2.2 and older branches before the [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), or the regression status won't be correct.Flags: needinfo?(ktucker)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1173284#c66)• 9 years ago |
|  | |

I think that Lockscreen can and must ensure that its (so far unsafe) defaults have been overridden by the settings listener callbacks before deciding on whether or not to screen lock or pass code lock the device. Let's just make sure now once and for all that this won't regress again. The rest of this problem complex lives in other components.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1173284#c67)• 9 years ago |
|  | |

Reproducible on Woodduck as per [bug 1185096](/show_bug.cgi?id=1185096 "RESOLVED DUPLICATE - Lockscreen passcode bypass")#c10
Btw, when reproducing this bug it helps to build more CPU load on boot-up by booking the device into an encrypted wireless network, giving you more time to swipe.
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1173284#c68)• 9 years ago |
|  | |

[Comment 66](/show_bug.cgi?id=1173284#c66 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") doesn't affect the fact it's a regression from [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), unless the analyzes are wrong. So I were not suggesting we should give up to patch them, but the bug status must be clarified. So, if they're uncovered by different root causes, we should fire different bugs for them, not try to manage different root causes in one bug with different patches. Otherwise, we should do the regression-window searching again, and to make sure whether it's a regression (since the flag and the conclusion is still held). If not, we need to clear it. It's just a simple flag problem.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1173284#c69)• 9 years ago |
|  | |

By all means, let's restrict this bug to LockScreen. I was just saying that because of its central role to security we should make sure that it in itself has all the safeguards for securely operating in a regressive environment.
So are we in agreement that within LockScreen the problem was a race condition with the settings observers not quickly enough overwriting the unsafe defaults? Or did I miss something?

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1173284#c70)• 9 years ago |
|  | |

1. If it's not a regression of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), because you and others raised that it appears in older branches, cancel the regression tag and the blocks of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."): it's now not correct anymore. And we need to take a look to see if setting it as regression still makes senses, since we now don't have the regression window anymore.
2. If it's still a regression of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), we're discussion two kinds of bug that may have almost the same root cause of racing. But [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") make the symptom worse. So, we may need two bugs to track the bug status correctly.
Please, take a look at [Comment 10](/show_bug.cgi?id=1173284#c10 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") to [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"). And I must emphasis it again: I don't say the racing isn't the root case. But apparently the regression status might be wrong: whether it's a regression of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") by previous QA and my result, OR not. There is no third possibility. And I just raise a requirement to clear the bug status according to what we have now.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1173284#c72)• 9 years ago |
|  | |

Let me preface this by restating what the principal problem is:
SettingsListener.observe() not only registers the callback with mozSettings.addObserver(), it also triggers the callback by registering it in a mozSettings.createLock().get() 'success' event listener. This is meant for initializing the value on the listener side, but it can take up to several seconds during system bootstrap. This is the race condition we're talking about.
Regarding the regression:
I have looked at commit 02a14c282c5fb391675246e627a10d1508418c40 from March right before Alive landed his first patches in [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."). The basic anatomy starting from lockscreen\_bootstrap.js is the same:
1. this.lockscreen = new LockScreen();
- sets local defaults
- .enabled: true
- .passCodeEnabled: false
- calls .lockIfEnabled(true) even before registering observers
- registers settings observers for .enabled and .passCodeEnabled
- this starts the race
2. window.lockScreen = this.lockscreen;
3. window.lockScreenStateManager = new window.LockScreenStateManager();
4. window.lockScreenStateManager.start(window.lockScreen);
- maintains it's own state about passcodeEnabled
- registers own settings observer for that, no sync with lockScreen
- only lockscreen interaction ever is checkPassCodeTimeout
5. this.lockscreen.init();
- activates screen lock if .enabled
And later:
- user swipes right on LockScreen, triggering event that leads to LockScreen.unlock()
- LockScreen.unlock checks .passCodeEnabled, unlocks without pass code if (still) false
There was and is no logic that prevents that LockScreen.unlock is reached before the initial settings observer callbacks are fired, overriding the unsafe defaults. If the callbacks fire before swiping to the right and LockScreen.unlock(), pass code entry appears. If they don't, the phone unlocks without passcode. Everything points to the race condition existing prior to that, but it never was a problem as long as the callbacks were fired faster than the user could execute a swipe.
I'm sure there were other patches along the way that increased system load and shifted the first round of firing mozSettings observer callbacks to a later and later time to a point where it became relevant. Hence it doesn't make sense to single any one out pushing the race condition beyond some acceptable limit.
TL;DR: [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") did not introduce the observer callback race condition, which I consider to be the root cause. If anything, I speculate it has only emphasized it by making lockscreen bootstrapping faster.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4184921_465475)• 9 years ago |

No longer blocks: [system-bootstrap](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.")Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1173284#c73)• 9 years ago |
|  | |

I must correct my analysis write-up: The last two items of 1. actually belong to 5., and 1. just sets defaults. Sorry for the spam.

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4197314_481704)• 9 years ago |

Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1173284#c74)• 9 years ago |
|  | |

In reply to [Comment 65](/show_bug.cgi?id=1173284#c65 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), I double checked the regression window in [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") and it is absolutely correct for this bug.
This bug as written in [Comment 0](/show_bug.cgi?id=1173284#c0 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") only reproduces on the latest Flame 2.5 build. I cannot reproduce this issue on the latest Flame 2.2, 2.1 or 2.0 builds so that must be a different issue with a different set of steps and a different regression window.
Device: Flame 2.5
BuildID: 20150728115244 (issue reproduces 100% as written)
Gaia: 862f0895f3f5a97200601542d99a152a46385a0b
Gecko: 833403badc41
Version: 42.0a1 (2.5)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:42.0) Gecko/42.0 Firefox/42.0
Device: Flame 2.2 (Does not reproduce)
BuildID: 20150728111942
Gaia: e1e6317f17a840b19af9dbb25f5a771d8d9fa161
Gecko: 813cb3d271f0
Version: 37.0 (2.2)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:37.0) Gecko/37.0 Firefox/37.0
Device: Flame 2.1 (Does not reproduce)
BuildID: 20150723133047
Gaia: 9dba58d18006e921546cec62c76074ce81e16518
Gecko: 41e10c6740be
Version: 34.0 (2.1)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:34.0) Gecko/34.0 Firefox/34.0
Device: Flame 2.0
BuildID: 20150722193116 (Does not reproduce)
Gaia: b16ba05481e577bc644ed8966f587a70fe2148e6
Gecko: 2e6f1d4deff9
Version: 32.0 (2.0)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:32.0) Gecko/32.0 Firefox/32.0
This issue as written in [Comment 0](/show_bug.cgi?id=1173284#c0 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") appears to have been caused by the landing for [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.").Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1173284#c75)• 9 years ago |
|  | |

To clarify the steps given in [Comment 6](/show_bug.cgi?id=1173284#c6 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") should be written up as a different bug. However, I cannot reproduce that issue manually following those steps. I'm sliding to unlock as soon as the slider appears but it still prompts me for a passcode on 2.2, 2.1 and 2.0.
On master, I am not particularly rushing. I waited like 3 seconds before sliding to unlock after restart and the passcode is not prompted. I hope this helps to clarify what is going on here.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected)Flags: needinfo?(ktucker)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1173284#c76)• 9 years ago |
|  | |

I can reproduce the issue on those builds by swiping before the ui appears.
Keep swiping frantically and you can get passed the lockscreen.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1173284#c77)• 9 years ago |
|  | |

Kevin and I spoke offline. I think the difference might have been I have SIM security turned on my SIM. I'll reinvestigate the issue for 2.0, 2.1, 2.2
He reproduced not seeing the SIM pin dialog for 2.2
We probably should separate what I'm seeing into a separate bug from this original issue.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1173284#c78)• 9 years ago |
|  | |

While QA puts great efforts to clarify the situation, I shall land the patch to solve what we have now, for master (2.5). I would also take a look at other branches after that. But first, I need to switches temporarily to the recent intermittent errors of Gij, which bothers lots of people and make test unstable.
Naoki: please fire a different bug if you caught the different symptom, thanks.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=1173284#c79)• 9 years ago |
|  | |

[bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") is filed.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4212411_391803)• 9 years ago |

[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=1173284#c80)• 9 years ago |
|  | |

Okay the patch passed all tests:
<https://treeherder.mozilla.org/#/jobs?repo=gaia&revision=4586ecefd52a1ff1ea87f7db7f53f9ee9d6ef9b3>
and it works on my device. So I now land it.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4227800_476523)• 9 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=1173284#c81)• 9 years ago |
|  | |

master: <https://github.com/mozilla-b2g/gaia/commit/8bc364b351531cfaaa033229ec2dd81d8e5ebe7d>
I'm looking for any possible regressions. So NI me at this bug it they do happen. Thanks.Status: NEW → RESOLVEDClosed: 9 years agoResolution: --- → FIXED

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=1173284#c82)• 9 years ago |
|  | |

master: <https://github.com/mozilla-b2g/gaia/commit/8bc364b351531cfaaa033229ec2dd81d8e5ebe7d>
I'm looking for any possible regressions. So NI me at this bug it they do happen. Thanks.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=1173284#c83)• 9 years ago |
|  | |

Ahh sorry I suddenly saw one debugging line left in the patch. I now fix it.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=1173284#c84)• 9 years ago |
|  | |

Attached file
[The new PR](attachment.cgi?id=8640386)
— [Details](attachment.cgi?id=8640386&action=edit)

I created a new one and it's the same with the old (landed) one, but without the debugging line.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=1173284#c85)• 9 years ago |
|  | |

Landed again.
master: <https://github.com/mozilla-b2g/gaia/commit/b066d68030dac08cb545b37195bcab67593f365b>Status: REOPENED → RESOLVEDClosed: 9 years ago → 9 years agoResolution: --- → FIXED

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=1173284#c86)• 9 years ago |
|  | |

Naoki, KTucker, we have successfully reproduced this bug all the way back to 2.0 on Woodduck. Why are you resetting affected status?Flags: needinfo?(nhirata.bugzilla)Flags: needinfo?(ktucker)

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=1173284#c87)• 9 years ago |
|  | |

This is a pretty critical flaw, we should probably sec-review this to make sure this is fixed for sure - can you make sure this is done please cr? Thanks.Flags: sec-review?(cr)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4248338_75935)• 9 years ago |

[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)Target Milestone: --- → FxOS-S4 (07Aug)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=1173284#c88)• 9 years ago |
|  | |

Please note the symptom of [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") is very different from this bug: in this one, user can easily reproduce it by dragging the slider in an ordinary scene, while in [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"), as I've tried and the video shows, it needs some edging action to by-pass the lock. If user slide it when the slider shows up, it's hard to reproduce. So, although these bugs are both critical for security and they're with the same root cause, I can fix them with different solution that all suppose to plug the hole. The only different these two patches is in this bug, the patch cares about user experience and the new bootstrapping changes (which definitely makes it more complicated, but also necessary), while another one needn't to care about that since the reading time is much shorter.
As a conclusion, I now
1. Fixed this bug while caring user behavior & new bootstrapping
2. Fixing [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") with a much simple patch. It is because we can block the by-passing behavior in a simpler way, since the bootstrapping is the legacy one and the reading time user must to wait is not so long
So if the code is implemented correctly and will not trigger any new regression, and security team review it as Paul said, we may claim this/these bugs are fixed.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4261396_465475)• 9 years ago |

See Also: → [1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions")

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=1173284#c89)• 9 years ago |
|  | |

CR, per [comment 88](/show_bug.cgi?id=1173284#c88 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"); in [comment 35](/show_bug.cgi?id=1173284#c35 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), I used different steps when testing 2.x which is listed in [bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)").
We seperated them into two separate issues as there was a major regression which is an issue and a harder to reproduce security issue that was split off in [bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)").
Greg is going to try to address both. I think we're all on the same page that we don't want this bug to escape. Just separating this one from the other one is probably better as ktucker and Greg had noted.Flags: needinfo?(nhirata.bugzilla)Flags: needinfo?(ktucker)Flags: needinfo?(cr)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=1173284#c90)• 9 years ago |
|  | |

Naoki, I am able to reproduce this on my Woodduck with 2.0m with just the STR in [comment 0](/show_bug.cgi?id=1173284#c0 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") (and without any SIM pin involvement). The mechanism of the flaw is the same, and the code in 2.0 is essentially identical in that respect (I verified). This bug needs to be addressed all the way back to 2.0.
KTucker's approach of testing this bug against different B2G versions on the relatively powerful Flame is not suitable for this type of bug. Since it's a race condition, the race window's length varies greatly with device performance and system load during boot up.
We already know that latest B2G versions put so much stress on the system that it pushes the race length beyond acceptable limits even on powerful devices like the Flame. And even if the race window is too short to reliably exploit on a Flame with 2.0, it doesn't mean that it's neither exploitable on a slower device or when the device is connecting to an encrypted wireless network, or connected via Bluetooth, or anything else that increases system load during boot-up.
Consequently I am resetting affected status and re-opening this bug as incomplete, so we don't lose track of this. If different B2G versions require different fixes, please address this in separate blocking bugs, but please don't reset the tracking flags again unless you can prove my analysis wrong, or – at the very least – test the bug negatively against the slowest device running the most load-demanding config we need to support.
I would propose to remove the 2.5 blocker once the sec review of Greg's patch is finished, but I don't expect any issues there.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=%3F)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=%3F)Flags: needinfo?(cr)Resolution: FIXED → INCOMPLETE

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=1173284#c91)• 9 years ago |
|  | |

This should be fixed - cr misunderstood the status meanings here.Resolution: INCOMPLETE → FIXED

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=1173284#c92)• 9 years ago |
|  | |

So I feel Christiane is treating this as a "meta" or "tracking" bug for tracking according to the words ("...don't lose tracking ..." and "address this in separate blocking bugs") . I don't mind people to reset the tracking flags if that is true. But that intention should be stated clearly, so maybe we should change the title to add some [tracking] or [meta] to follow the usual convention of bug management.

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=1173284#c93)• 9 years ago |
|  | |

I think Christiane's main concern was just that this does in fact affect earlier versions, and that is now reflected in the status flags.

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=1173284#c94)• 9 years ago |
|  | |

Greg - it might be too late, but how possible is this fix to backport to 2.2? I wonder if there is any chance we can get a fix to partners before they ship?Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=1173284#c95)• 9 years ago |
|  | |

No. This fix is only for code after [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), as I said at [Comment 65](/show_bug.cgi?id=1173284#c65 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"). And please note that's why I asked if we should raise another bug with a different symptom which also deserves a different patch, although the root case may be the same. Because before [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), there is no need to handle the LazyLoading + abnormal reading delay, which significantly add the effort to deal with the bug. You can take a look at [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"): the solution is simple and thus it's with fewer risks to land it in 2.2, 2.1 and maybe 2.0.
And I need to mention that I can't reproduce this bug on 2.2 without the rapid sliding at very beginning of bootstrapping, just like QA did at [bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"). So I feel it will be great if Christiane can upload a video about how to reproduce it as STR0 (Flame and Wooduck). Basically, if your reproduction needs to start slide it \*before\* you see the unlocker, or the settings reading doesn't cost the abnormally long time to complete, it could be solved by applying the patch for [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"). Otherwise, we \*might\* need a more complicated patch like this one. Unless UX decided it's tolerable to fix the issue with the freezing delay.Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=1173284#c96)• 9 years ago |
|  | |

So Paul, that's what I really don't know why secure team looks like to fix them in the same bug. To fork a bug with different symptoms and with different patches won't hurt the fact that they're both valid bug and \*all\* fixed the same flaw, while we can avoid to uplift the large patch to the stabilizing branches. Moreover, to mix bugs with different symptoms on different branches always mess bug status. To separate them is usually a better way to manage them.
And, I'm just so tired to explain that again and again (\*see\* how much comments I can refer to), while what I'm talking about seemed totally ignored. It's also really annoyed to change the tracking flags without asking (NI) he who opposes it earlier. Please, if someone disagree others' opinions, at least the one should take a look at what the opponent said, and counter strike them based on the opinions or the new solid facts.

|  | [sjw](/user_profile?user_id=436910) |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=1173284#c97)• 9 years ago |
|  | |

Could someone CC me to the newly referred bugs here, please?

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=1173284#c98)• 9 years ago |
|  | |

Greg, I don't see how producing video proof is going to help. AFAICS, the rapid swiping that helps exploiting Woodduck isn't indicative of a different bug and it isn't even a different symptom. It merely has two effects:
1. It increases system load by hammering the event queue, thus widening the race window.
2. It helps hitting short race windows.
Rapid swiping is just an advanced exploit variant of STR0, and the underlying issue is the same: The unlock event is fired before the settings were read. Greg, if you are really convinced that rapid swiping is a different issue, please, point out the code flow to me that is responsible. I can't see how. Until then I maintain that it is as outlined [comment 72](/show_bug.cgi?id=1173284#c72 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") / 73.
However, there's a very simple way to shut me up about this as proposed in [bug 1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions") and before: We could change
lockscreen.js: passCodeEnabled: false; // insecure
to
lockscreen.js: passCodeEnabled: true; // secure
in all affected versions, and this problem ceases to be a security issue with a simple one-liner. Its frankly very minor UX regression of having to swipe twice – and that if and only if you're fast enough to hit the race window – could then be dealt with in separate, non-security-relevant bugs, and in the same way that Greg is planning to, anyway.
I'd rather have a working pass code lock than never ever having to swipe twice.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=1173284#c99)• 9 years ago |
|  | |

Moving tracking of uplifting efforts in affected branches to tracking [bug 1189314](/show_bug.cgi?id=1189314 "RESOLVED WONTFIX"). If you fix the bypass in other releases, please open a separate bug that blocks 1189314.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → ---
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → ---
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → ---
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=%3F) → ---
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → ---
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=%3F) → ---

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=1173284#c100)• 9 years ago |
|  | |

I don't know how many times I must repeat that the difference is matter for the different solution. \*Sigh\*
As I said (yes, I've said, again), why it matters is because according the symptom, we can prepare different solutions to eliminate the racing. One is to delay the unlocker to block user action before we successfully reading the value. This is a very simple solution that you also proposed at [Comment 41](/show_bug.cgi?id=1173284#c41 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), although your version blocks more than the unlocker (you blocks the whole initialization of the lockscreen). The advantage is it's very simple, so you it's not to risky to uplift to other branches.
However, the shortage is it could seriously hurt the user experience if the bootstrapping time is short and user can see the screen lock soon, and that's what we now have after [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."). So the second solution I used here, is to block the component only when the value is really needed, which means before user unlock it. This gives us a better solution respect performance and UX requirement, plus the changes of new bootstrapping. The shortage is the patch is complicated and mixed with lots of new changes don't exist in the old branches. So to uplift such patch is risky.
That's what I've and they still hold true even you still don't get it. Time to cite:
> I don't see how producing video proof is going to help.
If you know what I'm talking about, and if you've seen my solutions and their differences and what I concern, you'll know it's important to help.
> AFAICS, the rapid swiping that helps exploiting Woodduck isn't indicative of a different bug and it isn't even a different symptom.
No. Even though they're the same bug ([Comment 65](/show_bug.cgi?id=1173284#c65 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), [Comment 88](/show_bug.cgi?id=1173284#c88 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), [Comment 95](/show_bug.cgi?id=1173284#c95 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") and [Bug 1188716 Comment 4](/show_bug.cgi?id=1188716#c4 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)")), the different racing window before user can see the screen locker means whether we can adopt a more simple solution or not, which is important for uplifting since we need to reduce the risk AMAP.
> It merely has two effects:
> 1. It increases system load by hammering the event queue, thus widening the race window.
> 2. It helps hitting short race windows.
> Rapid swiping is just an advanced exploit variant of STR0, and the underlying issue is the same: The unlock event is fired before the settings were read. Greg, if you are really convinced that rapid swiping is a different issue, please, point out the code flow to me that is responsible. I can't see how. Until then I maintain that it is as outlined [comment 72](/show_bug.cgi?id=1173284#c72 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") / 73.
You're just repeating what I said, and you still don't get it: yes, they're the same bug, and they're the same issue, but they could be solved with different solutions which are better for different branches. And the solutions are both valid since they both block user to unlock the screen by-passing the passcode, but their concerns are not different.
So is "Rapid swiping is just an advanced exploit variant of STR0" ? Yes, and I never said it isn't. But if a bug need to be reproduced by rapid swiping + early swiping at bootstrapping, especially when it's in an old branch, it definitely deserves a different solution.
\*Repeat again\*: they're both valid solutions for the same bug, but they're good to the different cases.
> However, there's a very simple way to shut me up about this as proposed in [bug 1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions") and before: We could change
> lockscreen.js: passCodeEnabled: false; // insecure
> to
> lockscreen.js: passCodeEnabled: true; // secure
> in all affected versions, and this problem ceases to be a security issue with a simple one-liner.
NO. It \*covers\* the racing again, and the mindset like this is what really doesn't help. What surprise me is you proposed this as I haven't submit any valid solution, and as you never saw my patch has been landed and waiting for future validation. The fact is, that value should never be used if it's still not read from db. So we either block user action requires that value, or we block the whole initialization of the unlocker. And that's what the two patches implemented for.
> However, there's a very simple way to shut me up about this as proposed in [bug 1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions") and before: We could change
I rather you seriously read what I commented and proposed and landed. If you have found any defects in my patches and concerns for different branches, you can pick and put them here, so we can make it more secure and sophisticated. That's what a effective and ordinary bug should do. But to push me to explain it again and again, and to ignore them all, is not the way to solve the case.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 101](/show_bug.cgi?id=1173284#c101)• 9 years ago |
|  | |

(In reply to Christiane Ruetten [:cr] from [comment #99](/show_bug.cgi?id=1173284#c99 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> Moving tracking of uplifting efforts in affected branches to tracking bug
> 1189314. If you fix the bypass in other releases, please open a separate bug
> that blocks 1189314.
That's what [Bug 118871](/show_bug.cgi?id=118871 "RESOLVED WORKSFORME - Automatic reload reloads all images *everytime* they appear on the page.") is for. It's already open, and you're also in the CC list and has been NIed.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=1173284#c102)• 9 years ago |
|  | |

Sorry, [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)").

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=1173284#c103)• 9 years ago |
|  | |

Greg, I really tried, but we're moving backwards. Please stop blaming me for your refusal to adopt a security mindset even for the sake of this discussion. Just because I don't interpret things your way doesn't mean that I don't understand what your approach and motivation are. You made that plenty clear by now and repeating your stance until I fall in line isn't helping. While there's lots to be said about [comment 100](/show_bug.cgi?id=1173284#c100 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), I'm not going to debate this any more.

|  | [Pi Wei Cheng [:piwei] (inactive)](/user_profile?user_id=501985) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4361000_501985)• 9 years ago |

Depends on: [1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted")

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=1173284#c104)• 9 years ago |
|  | |

We will need this landing backed out. It seems to be causing a smoke test blocker. Please see [bug 1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted").Flags: needinfo?(nhirata.bugzilla)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=1173284#c105)• 9 years ago |
|  | |

CR and I spoke about this bug. We both thought the current situation of having to reboot the device is better than having the security issue that the patch tried to resolve.
I'm thinking we also have to reevaluate when we're doing backouts to figuring out which break is worse. The break that the patch is resolving or the regression that it causes.
I would prefer to either talk to Greg first before backing out, or more so let him decide in this case esp since he's the owner of the patch.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=1173284#c106)• 9 years ago |
|  | |

I submitted the patch at [Bug 1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted").

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 107](/show_bug.cgi?id=1173284#c107)• 9 years ago |
|  | |

Just FYI for other readers of this bug - I've taken the discussions above to email and face to face meetings to figure out the jumble of bugs, versions and issues and figure out a path forward here. I'll post back in this and related bugs once we get a solid plan.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4445363_391803)• 9 years ago |

Flags: needinfo?(nhirata.bugzilla)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4697344_1689)• 9 years ago |

[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4697466_1689)• 9 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 108](/show_bug.cgi?id=1173284#c108)• 9 years ago |
|  | |

[Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") covers fixing older releases, so wontfixing this bug for better tracking.
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=wontfix)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=wontfix)
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4972762_75935)• 9 years ago |

[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=wontfix)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=wontfix)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a6729910_1689)• 9 years ago |

Group: b2g-core-security

|  | [Harly Hsu[:harly]](/user_profile?user_id=486171) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a6826242_486171)• 9 years ago |

Flags: needinfo?(hhsu)

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a7251023_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a7862760_465475)• 9 years ago |

Flags: sec-review?(cr) → sec-review+

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a12704239_465475)• 9 years ago |

Whiteboard: [v3.0-nexus-5-l] → [v3.0-nexus-5-l][b2g-adv-main2.5+]

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a18002009_465475)• 9 years ago |

Summary: [Lock Screen] pass code bypass after reboot due to settings observer race condition → Firefox OS Lockscreen passcode bypass due to settings observer race condition

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a18003448_465475)• 9 years ago |

Alias: CVE-2015-8511Summary: Firefox OS Lockscreen passcode bypass due to settings observer race condition → Firefox OS Lockscreen passcode bypass due to race condition

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a33555827_1689)• 9 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a283158732_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1173284&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_2355d2c3_20250125_075811.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2015-152

## Lockscreen passcode bypass due to race condition

Announced
December 30, 2015
Reporter
Shally Li
Impact
High
Products
Firefox OS
Fixed in

* Firefox OS 2.5

### Description

**Shally Li** was first to report a race condition
in the lockscreen of Firefox OS that can be used to bypass the passcode
lock of a Firefox OS device. Under certain circumstances on a locked
device, the user will be dropped directly to the homescreen instead of
being presented with the passcode input dialog.

### References

* [Firefox OS Lockscreen passcode bypass due to race condition](https://bugzilla.mozilla.org/show_bug.cgi?id=1173284)
  ([CVE-2015-8511](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8511))

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_2bace662_20250126_072509.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1173284)
* [XML](/show_bug.cgi?ctype=xml&id=1173284)

Closed
[Bug 1173284](/show_bug.cgi?id=1173284)
(CVE-2015-8511)

Opened 10 years ago
Closed 9 years ago

# Firefox OS Lockscreen passcode bypass due to race condition

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox OS Lockscreen passcode bypass due to race condition

## Categories

### (Firefox OS Graveyard :: Gaia::System::Lockscreen, defect)

[Product:](/describecomponents.cgi?product=Firefox%20OS%20Graveyard)

Firefox OS Graveyard
▾

Firefox OS Graveyard
FirefoxOS, or Boot2Gecko (B2G) is Mozilla's operating system built on web standards. ([more info](https://wiki.mozilla.org/B2G))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20OS%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20OS%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen#Gaia%3A%3ASystem%3A%3ALockscreen)

Gaia::System::Lockscreen
▾

Firefox OS Graveyard :: Gaia::System::Lockscreen
Any issues related to Gaia's lockscreen.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20OS%20Graveyard&component=Gaia%3A%3ASystem%3A%3ALockscreen)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

ARM

Gonk (Firefox OS)

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

## Tracking

### (blocking-b2g:2.5+, b2g-v2.0 wontfix, b2g-v2.0M wontfix, b2g-v2.1 wontfix, b2g-v2.1S wontfix, b2g-v2.2 wontfix, b2g-v2.2r wontfix, b2g-master fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

FxOS-S4 (07Aug)

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| blocking-b2g | [2.5+](/buglist.cgi?f1=cf_blocking_b2g&o1=equals&v1=2.5%2B) |
| --- | --- |

| blocking-b2g | 2.5+ |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| b2g-v2.0 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=wontfix) |
| b2g-v2.0M | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=wontfix) |
| b2g-v2.1 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=wontfix) |
| b2g-v2.1S | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=wontfix) |
| b2g-v2.2 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=wontfix) |
| b2g-v2.2r | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=wontfix) |
| b2g-master | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| b2g-v2.0 |  | wontfix |
| b2g-v2.0M |  | wontfix |
| b2g-v2.1 |  | wontfix |
| b2g-v2.1S |  | wontfix |
| b2g-v2.2 |  | wontfix |
| b2g-v2.2r |  | wontfix |
| b2g-master |  | fixed |

## People

### (Reporter: lixia, Assigned: gweng)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/aaec1e3c70b450dd7fce392e46d36158?d=mm&size=40)  [gweng](/user_profile?user_id=476523)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/b98bc212cb3a7aaecd8cb71d27df6487?d=mm&size=40)  [pcheng](/user_profile?user_id=501985)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b125706ec5eab7079333f4cec2f443a2?d=mm&size=40)  [lixia](/user_profile?user_id=519767)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

38 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1175955](/show_bug.cgi?id=1175955 "VERIFIED FIXED - passive pairing not work when fresh flash")

Dependency [tree](/showdependencytree.cgi?id=1173284&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1173284)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1177373](/show_bug.cgi?id=1177373 "RESOLVED DUPLICATE - lock passcode not requested when powering up"), [1184875](/show_bug.cgi?id=1184875 "RESOLVED DUPLICATE - Phone can be unlocked without password when restarting"), [1185096](/show_bug.cgi?id=1185096 "RESOLVED DUPLICATE - Lockscreen passcode bypass"), [1187368](/show_bug.cgi?id=1187368 "RESOLVED DUPLICATE - Lockscreen pass code bypass after reboot"), [1187765](/show_bug.cgi?id=1187765 "RESOLVED DUPLICATE - Bypass lockscreen without entering passcode"), [1265319](/show_bug.cgi?id=1265319 "RESOLVED DUPLICATE - Possible to circumvent lockscreen by swiping it away before it is visible")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions")

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [v3.0-nexus-5-l][b2g-adv-main2.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2015-8511

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[v3.0-nexus-5-l][b2g-adv-main2.5+]

QA Whiteboard:

[QAnalyst-Triage+]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [cr](/user_profile?user_id=465475) | [sec-review](#a7862760_465475 "9 years ago") | + |
| --- | --- | --- |
| [cr](/user_profile?user_id=465475) | sec-review | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4697466_1689 "10 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [logcat\_2047.txt](/attachment.cgi?id=8617794)  [10 years ago](#c1)  [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)   824.01 KB, text/plain |  | [Details](/attachment.cgi?id=8617794&action=edit) |
| --- | --- | --- |
| [passcode.mp4](/attachment.cgi?id=8617795)  [10 years ago](#c2)  [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)   5.24 MB, video/mp4 |  | [Details](/attachment.cgi?id=8617795&action=edit) |
| [WIP patch](/attachment.cgi?id=8628283)  [10 years ago](#c20)  [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)   46 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=8628283&action=edit) | [Review](/attachment.cgi?id=8628283) |
| [[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master](/attachment.cgi?id=8636455)  [10 years ago](#c31)  [GitHub Autolander Bot](/user_profile?user_id=517379)   46 bytes, text/x-github-pull-request | timdream : [review+](#c64 "10 years ago")  timdream : [feedback+](#c37 "10 years ago") | [Details](/attachment.cgi?id=8636455&action=edit) | [Review](/attachment.cgi?id=8636455) |
| [The new PR](/attachment.cgi?id=8640386)  [9 years ago](#c84)  [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)   46 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=8640386&action=edit) | [Review](/attachment.cgi?id=8640386) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1173284#c0)• 10 years ago |
|  | |

[1.Description]:
[Flame v3.0][Nexus 5 v3.0][Lock Screen]Enable the passcode, restart device, slide to left for unlocking screen, but sometimes it will not prompt user to input the passcode and directly enter homescreen.
Found time: 20:47
Attach: passcode.mp4 and logcat\_2047.txt
[2.Testing Steps]:
1. Enable passcode lock in Settings/Screen Lock.
2. Restart device.
3. Try to unlock screen.
[3.Expected Result]:
3. It should prompt user to input passcode for unlocking sceen.
[4.Actual Result]:
3. It will not prompt user to input passcode.
[5.Reproduction build]:
Device: Flame v2.2 build(unaffected)
Build ID 20150609162508
Gaia Revision 06edb0f8db7c2f45cde54401a8593663059861a4
Gaia Date 2015-06-08 14:29:09
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/a3d7b08fb0ec>
Gecko Version 37.0
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150609.211329
Firmware Date Tue Jun 9 21:13:39 EDT 2015
Bootloader L1TC000118D0
Device: Nexus 5 v2.2 build(unaffected)
Build ID 20150609081832
Gaia Revision 06edb0f8db7c2f45cde54401a8593663059861a4
Gaia Date 2015-06-08 14:29:09
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/239c59921129>
Gecko Version 37.0
Device Name hammerhead
Firmware(Release) 5.1
Firmware(Incremental) eng.cltbld.20150609.121628
Firmware Date Tue Jun 9 12:16:44 EDT 2015
Bootloader HHZ12f
Device: Flame v3.0 build(affected)
Build ID 20150609160220
Gaia Revision 31ef8deec7a04a988eb92309178b87cc0bde8220
Gaia Date 2015-06-08 14:48:40
Gecko Revision <https://hg.mozilla.org/mozilla-central/rev/8be8deb10e4f>
Gecko Version 41.0a1
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150609.193617
Firmware Date Tue Jun 9 19:36:29 EDT 2015
Bootloader L1TC000118D0
Device: Nexus 5 v3.0 build(affected)
Build ID 20150609081840
Gaia Revision ea27c4ed5b6083c9e21d233d4804372ac4d5d353
Gaia Date 2015-06-08 03:06:41
Gecko Revision <https://hg.mozilla.org/mozilla-central/rev/e10e2e8d8bf2>
Gecko Version 41.0a1
Device Name hammerhead
Firmware(Release) 5.1
Firmware(Incremental) eng.cltbld.20150609.121002
Firmware Date Tue Jun 9 12:10:19 EDT 2015
Bootloader HHZ11k
[6.Reproduction Frequency]:
occasionally Recurrence,6/20
[7.TCID]:
Free Test

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a171_519767)• 10 years ago |

[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected)
[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected)

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1173284#c1)• 10 years ago |
|  | |

Attached file
[logcat\_2047.txt](attachment.cgi?id=8617794)
— [Details](attachment.cgi?id=8617794&action=edit)

|  | [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1173284#c2)• 10 years ago |
|  | |

Attached video
[passcode.mp4](attachment.cgi?id=8617795)
— [Details](attachment.cgi?id=8617795&action=edit)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1173284#c4)• 10 years ago |
|  | |

[Blocking Requested - why for this release]:
The user should always be prompted for a passcode and this is a regression so nominating this 3.0?blocking-b2g: --- → 3.0?Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---),
[regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [Pi Wei Cheng [:piwei] (inactive)](/user_profile?user_id=501985) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a1437857_501985)• 10 years ago |

QA Contact: pcheng

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1173284#c5)• 10 years ago |
|  | |

Nom is good.
I noticed one case is when the phone is flashed and the device is turned off completely and then turned back on.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1173284#c6)• 10 years ago |
|  | |

I am able to reproduce this by swiping unlock less than one second after the lock screen is first displayed at power on. Waiting more than one second or so prevents the issue from occurring, and it correctly asks for a PIN.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1173284#c7)• 10 years ago |
|  | |

A reflash is not required to trigger the issue.

|  | [Michael Henretty [:mikehenrty][:mhenretty]](/user_profile?user_id=468904) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1173284#c8)• 10 years ago |
|  | |

This is a big concern for our foxfooders. Let's fix ASAP. Greg, any ideas what may be going on?blocking-b2g: 2.5? → 2.5+Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1173284#c9)• 10 years ago |
|  | |

I would check regression window from the time [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") got landed, since recently I don't remember I changed any LockScreen control flow except for this one.
The PR is here:
<https://github.com/mozilla-b2g/gaia/pull/30383>
If it only exists after this bug than we need to fix it in the bootstraping code. If not, it's a pure LockScreen issue. It would be helpful if we could first identify this.Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1173284#c10)• 10 years ago |
|  | |

Yes...I've bisected the bug. While it's without the patch from [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), namely the patch:
c1ef854924f18357832ddcf98dc6c42391d5599e
I cannot reproduce it anymore. However, this is an unfortunately news. Since Alive's gone, and the patch is too huge, it's hard to fix this.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1173284#c11)• 10 years ago |
|  | |

And maybe this should be in the pocket of smoke test, since it bypasses the security check. I don't know why it could escape from our people's check, I think it's another reason why never land big patch without split it.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1173284#c12)• 10 years ago |
|  | |

Hi Michael: as I said, even though this is a serious bug, I may not solve it soon since the patch quite complicated (although I'll try it). Meanwhile I don't know what happened (maybe the exciting working week) to let the first landing (6/4) and report (6/10) are so far from the current revision (6/28). So if we can build some automation or manual test case for the bug, it would be great. But since I can only reproduce it after rebooting on device, I don't know if an automation test running not on an device could work as well.Flags: needinfo?(mhenretty)

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1173284#c13)• 10 years ago |
|  | |

Should we be marking the lockscreen as 'ready' before we've wired up the passcode-lock preference to the lockscreen?
--- a/apps/system/lockscreen/js/lockscreen.js
+++ b/apps/system/lockscreen/js/lockscreen.js
@@ -329,6 +329,11 @@
\*/
LockScreen.prototype.init =
function ls\_init() {
+ window.SettingsListener.observe(
+ 'lockscreen.passcode-lock.enabled', false, (function(value) {
+ this.setPassCodeEnabled(value);
+ }).bind(this));
+
this.ready = true;
/\*\*
\* "new style" slider: as described in <https://bugzil.la/950884>
@@ -407,11 +412,6 @@
this.overlay.classList.remove('uninit');
}).bind(this));
- window.SettingsListener.observe(
- 'lockscreen.passcode-lock.enabled', false, (function(value) {
- this.setPassCodeEnabled(value);
- }).bind(this));
-

|  | [Pi Wei Cheng [:piwei] (inactive)](/user_profile?user_id=501985) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1173284#c14)• 10 years ago |
|  | |

b2g-inbound regression window:
Last Working
Device: Flame
BuildID: 20150604012244
Gaia: e0fbadeb78a96137f071d9be7a47ef9fe882d17f
Gecko: 64ce149fabf1
Version: 41.0a1 (3.0 Master)
Firmware Version: v18D-1
User Agent: Mozilla/5.0 (Mobile; rv:41.0) Gecko/41.0 Firefox/41.0
First Broken
Device: Flame
BuildID: 20150604020845
Gaia: c1ef854924f18357832ddcf98dc6c42391d5599e
Gecko: 4f7e7631e277
Version: 41.0a1 (3.0 Master)
Firmware Version: v18D-1
User Agent: Mozilla/5.0 (Mobile; rv:41.0) Gecko/41.0 Firefox/41.0
Last Working Gaia & First Broken Gecko - no repro
Gaia: e0fbadeb78a96137f071d9be7a47ef9fe882d17f
Gecko: 4f7e7631e277
Last Working Gecko & First Broken Gaia - repro
Gaia: c1ef854924f18357832ddcf98dc6c42391d5599e
Gecko: 64ce149fabf1
Gaia pushlog:
<https://github.com/mozilla-b2g/gaia/compare/e0fbadeb78a96137f071d9be7a47ef9fe882d17f...c1ef854924f18357832ddcf98dc6c42391d5599e>
Confirmed that this is caused by [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.").Blocks: [system-bootstrap](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.")QA Whiteboard: [QAnalyst-Triage?]Flags: needinfo?(ktucker)Keywords: [regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1173284#c15)• 10 years ago |
|  | |

Tim, can you take a look at this please since the author of the landing for [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") is no longer active? Looks like that landing caused this issue to occur.QA Whiteboard: [QAnalyst-Triage?] → [QAnalyst-Triage+]Flags: needinfo?(ktucker) → needinfo?(timdream)

|  | [Michael Henretty [:mikehenrty][:mhenretty]](/user_profile?user_id=468904) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1173284#c16)• 10 years ago |
|  | |

(In reply to Greg Weng [:snowmantw][:gweng][:λ] from [comment #12](/show_bug.cgi?id=1173284#c12 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> Hi Michael: as I said, even though this is a serious bug, I may not solve it
> soon since the patch quite complicated (although I'll try it). Meanwhile I
> don't know what happened (maybe the exciting working week) to let the first
> landing (6/4) and report (6/10) are so far from the current revision (6/28).
> So if we can build some automation or manual test case for the bug, it would
> be great. But since I can only reproduce it after rebooting on device, I
> don't know if an automation test running not on an device could work as well.
Hi Greg, thanks for the explanation. If we were to add the `lockscreen.passcode-lock.enabled` and `lockscreen.passcode-lock.code` settings to a Marionette-JS startup (like here [1]), could we reproduce this bug from the context of an integration test?
1.) <https://github.com/mozilla-b2g/gaia/blob/da447493053e704533c2b3fbb6be8dc93f71dacc/apps/system/test/marionette/software_home_fullscreen_test.js#L13>Flags: needinfo?(mhenretty) → needinfo?(gweng)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1173284#c17)• 10 years ago |
|  | |

Greg is the best person left to fix this, however given the complexity we would need some time to find the root cause.
This reads like a timing issue to me. Fixing it shouldn't be hard once we found the cause.Flags: needinfo?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1173284#c18)• 10 years ago |
|  | |

Tim: Just update the situation: it looks caused by a "delay mozSetting change", revealed by the new bootstrapping and not covered by tests. I've found that
1. LockScreenStateManager would `start` itself to observe "lockscreen.passcode-lock.enabled". If the value is true, unlocking leads to passcode panel. Else, it unlocks straightly.
2. With new bootstrapping chain, the UI would show up since LockScreenWindowManager has been bootstrapped. LockScreenStateManager starts itself after that. This would observe the setting change immediately. And from the log, it does. Since I use SettingsListener, the "change" in fact includes the initial value even without any change after.
3. \*However\*, the value change bubbled up in an asynchronous way, and it's a really long waiting (about 1 second after the manager observers it). So before the value returns, the whole UI is able to be manipulated, while the passcode-enabled is assumed as false. This is why the bug appears.
The tricky part is such long waiting only happens when you do a cold restart. If it only restart b2g process, the reading would be quick enough to hide the symptom. So that's one reason that I guess it can't be discovered in automatic tests, although I would still try.
For the bug, solution is to hook LockScreenStateManager and the observing on the bootstraping chain: only when the state manager got the passcode value from the launcher, the OS logo hides itself and make LockScreen window visible. This should fix the bug but I need some time to figure out how to do that.
And I still have no idea about how it was covered in the past. Maybe in the previous version OS logo hides itself lately, so user has no chance to do trigger that. Anyway, I don't believe in the previous complex of bootstrapping, we have any good chance to discover it like this. So although the author had gone and we need to take regressions from the lost king, to fix this is still fair enough.Flags: needinfo?(timdream)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1173284#c19)• 10 years ago |
|  | |

Understood, thank you for the analysis.Flags: needinfo?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1173284#c20)• 10 years ago |
|  | |

Attached file
[WIP patch](attachment.cgi?id=8628283)
— [Details](attachment.cgi?id=8628283&action=edit)

Tim: this is a hotfix. It:
1. Changes booting sequence of LockScreenStateManager as a Promise, for those async steps
2. Bubbles up:
a) [Launcher] waiting [LockScreenLauncher]
b) [LockScreenLauncher] waiting [LockScreenWindowManager#openApp]
c) [LockScreenWindowManager#openApp] waiting [LockScreenStateManager#start]
So [Launcher] would only remove the animation/logo after the chain got entirely ready. Almost all these waiting are in Promises. The only one exception is:
3. |LockScreenWindowManager#openApp| would call |createWindow| if the WM is first time launched. So, |createWindow| would eventually fire an event called |lockscreen-frame-bootstrap| to notify stuff inside the \*lockscreen frame\* to start themselves, which includes |LockScreenStateManager|. As a result, the |#openApp| method needs to know when does this inner bootstrapping progress done. And I add a |lockscreen-frame-bootstrap-done| event to do that. You can image if it's an app there \*must\* be some IAC things. It's in fact discussed with Alive once, but he didn't adopt that because he didn't think it's necessary. Anyway, after |#openApp| got the |-done| event, it would resolve the promise to let caller (the |LockScreenLauncher|) know it's done, too. So the launcher could now know it's launched, and to let the master launcher keep going.
(If my explanation is too confused, we may have it offline.)
4. The impact is the bootstrapping time, which has been sped up by the new bootstrapping, now slower than that because it now need to wait such mozSettings read. And sometimes it's quite long. Maybe we should invite performance team to find out if we can boost this, or if we can optimize it from Gaia to avoid too much platform work in short releases.
And as I said, this is just a hotfix. It's in fact need a clear rewriting to make all of these subcomponent bootstrapping processes become Promise-orient. But for LockScreen business I don't think we have such resource so far, so let's pray in the future the entropy of this component would not grow fast.
[Attachment #8628283](/attachment.cgi?id=8628283&action=edit "WIP patch") -
Flags: feedback?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1173284#c21)• 10 years ago |
|  | |

Comment on [attachment 8628283](/attachment.cgi?id=8628283 "WIP patch") [[details]](/attachment.cgi?id=8628283&action=edit "WIP patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8628283)
WIP patch
Discussed with Tim. Conclusion:
1. Find how long the settings reading is
2. LockScreen can show it self before the reading done, so we could reduce the waiting time of app interaction
3. However, when it's going to unlock, if the reading is unfinished, block the unlocking until it's done. So we can still switch to the correct unlocking panel
4. If the reading time is still too long and user would feel it "lags" when unlocking, ask UX' opinion before we can address the issue (as a follow-up bug)
The point is we all agree that to add more coupling between System and LockScreen is bad. So if it's a pure LockScreen solution, it would be better.
[Attachment #8628283](/attachment.cgi?id=8628283&action=edit "WIP patch") -
Flags: feedback?(timdream)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1173284#c22)• 10 years ago |
|  | |

Unfortunately it looks that we hit a mozSettings issues. The log:
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>>> launching lockscreen 1435570622127
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>> start state manager: 1435570623006
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>>> animate poweron logo 1435570623095
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>>>>> remove poweron logo 1435570626797
> I/GeckoConsole( 212): Content JS LOG: >>>>>>>> got passcode status: 1435570630566
shows that from user could see LockScreen ("remove poweron logo") to ("got passcode status) is almost 3.8 seconds. And it's not caused by launching or setting up something, because the state manager was already started at "start state manager". And it's also long from there to the final reading. So, the whole time may spend on waiting to read the value.
I'm not sure if it's because of new bootstrapping reads too many values from settings before this step. I would still solve this issue by blocking user to unlock the phone if it's waiting to read the value, since to leave a security hole is much serious. After that, I would start to address the performance issue.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a2241288_476523)• 10 years ago |

Blocks: [1175955](/show_bug.cgi?id=1175955 "VERIFIED FIXED - passive pairing not work when fresh flash")

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1173284#c23)• 10 years ago |
|  | |

Update: I've patched it to fix the bug. However, the performance issue is very serious, since the animation of unlocking is by-passed, too. So I'm now profiling and try to pin it down.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1173284#c24)• 10 years ago |
|  | |

There is a bug about mozSetting reading is too slow (confidential): [Bug 1100188](/show_bug.cgi?id=1100188 "RESOLVED WONTFIX"). But for the missing animation I still need to dig in to find out the root cause.

|  | [Cervantes Yu [:cyu] [:cervantes]](/user_profile?user_id=434958) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1173284#c25)• 10 years ago |
|  | |

SPS Profile: <https://people.mozilla.org/~bgirard/cleopatra/#report=bf0feb427edd35bfed3dd9471dec0de538800b19&javascriptOnly=true&filter=%5B%7B%22type%22%3A%22RangeSampleFilter%22,%22start%22%3A62288,%22end%22%3A62447%7D%5D&selection=0,3,4,5,6,7,8,9,10,11,12,13,9,14,15,16,17,18,20,21,22,23,24,25,26,72>

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1173284#c26)• 10 years ago |
|  | |

Has the security hole been closed in the latest foxfood OTA update?Flags: needinfo?(nhirata.bugzilla)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1173284#c27)• 10 years ago |
|  | |

Richard, the bug that is addressing the issue that you're speaking of is this bug. No patches have officially landed, so no. The OTA does not have the fix for the lockscreen issue you are speaking of.Flags: needinfo?(nhirata.bugzilla) → needinfo?(rsoderberg)

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1173284#c28)• 10 years ago |
|  | |

Yeah. [Comment 22](/show_bug.cgi?id=1173284#c22 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") indicated that a fix for the security issue had been confirmed, and so I'd hoped we chose to close the security hole (that prevents me from putting \*any\* credentials on my device for foxfood testing) while the performance investigation continues. Ah well.Flags: needinfo?(rsoderberg)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1173284#c29)• 10 years ago |
|  | |

Update: still digging in performance issue. [Bug 1100188](/show_bug.cgi?id=1100188 "RESOLVED WONTFIX") looks also related to the performance issue.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3090904_476523)• 10 years ago |

Assignee: nobody → gwengFlags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1173284#c30)• 10 years ago |
|  | |

Update: Discussed with Tim. Now I'm trying the new solution, but it's quite complicated so we need some more time to fix this.

|  | [GitHub Autolander Bot](/user_profile?user_id=517379) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1173284#c31)• 10 years ago |
|  | |

Attached file
[[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master](attachment.cgi?id=8636455)
— [Details](attachment.cgi?id=8636455&action=edit)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1173284#c32)• 10 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
Tim: this is the patch based on what we have discussed. I set feedback to see if you have any opinion about the code, before I start to write the tests. Thanks.
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: feedback?(timdream)

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1173284#c33)• 10 years ago |
|  | |

Is it possible to see that patch as two commits - one creating the 'this.bootstrapping = ...' block, and then a second that fixes the lockscreen issue itself?

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1173284#c34)• 10 years ago |
|  | |

It's quite complicated: the lockscreen part is because Alive had changed when and how to load the components inside LockScreen. In previous version, they were assumed as synchronous, or ready, at the moment LockScreen was used by LockScreenStateManager. He changed that but not changed how these two component cooperate. So I need to change the LockScreen to make the whole loading process in a promise that the state manager could get it and know when does the lockscreen get fully loaded. In fact, this is a minor change compare to the changes I've done for the state manager. So, yes, you can say it's two commits, but they're so related so I think it's okay to put them in one commit.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1173284#c35)• 10 years ago |
|  | |

This bug occurs on 2.2 on flame. I just checked with today's build:
Build ID 20150721162504
Gaia Revision e1e6317f17a840b19af9dbb25f5a771d8d9fa161
Gaia Date 2015-07-15 21:05:11
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g37_v2_2/rev/a73051740290>
Gecko Version 37.0
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150721.203103
Firmware Date Tue Jul 21 20:31:14 EDT 2015
Bootloader L1TC000118D0
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1173284#c36)• 10 years ago |
|  | |

Also occurs in :
Build ID 20150721161206
Gaia Revision cc24cce17ab2ebf79f6505103da714fc65bc5ec1
Gaia Date 2015-07-15 18:48:55
Gecko Revision <https://hg.mozilla.org/releases/mozilla-b2g34_v2_1/rev/3856aebece7b>
Gecko Version 34.0
Device Name flame
Firmware(Release) 4.4.2
Firmware(Incremental) eng.cltbld.20150721.193944
Firmware Date Tue Jul 21 19:39:55 EDT 2015
Bootloader L1TC000118D0
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3607906_391803)• 10 years ago |

[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1173284#c37)• 10 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
We really, really need to simplify the code here........
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: feedback?(timdream) → feedback+

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1173284#c38)• 10 years ago |
|  | |

Marking this as security-sensitive b2g bug, rating sec-criticalGroup: b2g-core-securityKeywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3833777_465475)• 10 years ago |

Summary: [Lock Screen]Sometimes it will not prompt user to input passcode for unlocking screen after restarting device. → [Lock Screen] pass code bypass after restarting device due to settings observer race condition

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1173284#c39)• 10 years ago |
|  | |

I'm confident this is a race condition with the settings observers. I discussed parts of this and a dirty hotfix in [bug 1187368](/show_bug.cgi?id=1187368 "RESOLVED DUPLICATE - Lockscreen pass code bypass after reboot") (which I'll mark duplicate of this now). Switching to promises looks like the clean solution.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a3834306_465475)• 10 years ago |

Summary: [Lock Screen] pass code bypass after restarting device due to settings observer race condition → [Lock Screen] pass code bypass after reboot due to settings observer race condition

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1173284#c41)• 10 years ago |
|  | |

I have been exploring a very simple promise-based fix. Since it's delaying most of LockScreen's init code to after the SettingsListener getter promises resolve, it unfortunately has some visual regressions, showing a mostly black lock screen on startup, and showing Homescreen placing icons if lockscreen is disabled:
Fix pass code reboot bypass with promise
Moving the grunt of LockScreen .init() to .initStaged() which is called
from a promise that wraps settings getters for the problematic settings
values, avoiding the race condition that allows pass code bypass.
It has the side effect of showing no lock screen when it is disabled
in settings, and it creates two UX artefacts by exposing apps
while rendering their UI:
- (mostly) black lock screen state on startup
- Homescreen rendering icons when lock screen disabled
diff --git a/apps/system/lockscreen/js/lockscreen.js b/apps/system/lockscreen/js/lockscreen.js
index c3be4b4..b0ac6fe 100755
--- a/apps/system/lockscreen/js/lockscreen.js
+++ b/apps/system/lockscreen/js/lockscreen.js
@@ -62,7 +62,7 @@
\* in Settings API.
\* Will be ignored if 'enabled' is set to false.
\*/
- passCodeEnabled: false,
+ passCodeEnabled: true,
/\*
\* Boolean returns whether the screen is enabled, as mutated by screenchange
@@ -330,6 +330,27 @@
LockScreen.prototype.init =
function ls\_init() {
this.ready = true;
+
+ /\*\*
+ \* Ensure that settings state is up to date before deciding on pass code
+ \* locking or not. This avoids a race conditions with Settings observers.
+ \*/
+ var pEnabled = window.SettingsListener
+ .getSettingsLock().get('lockscreen.enabled');
+ pEnabled.then((v) => {
+ this.setEnabled(v['lockscreen.enabled']);});
+
+ var pPassEnabled = window.SettingsListener
+ .getSettingsLock().get('lockscreen.passcode-lock.enabled');
+ pPassEnabled.then((v) => {
+ this.setPassCodeEnabled(v['lockscreen.passcode-lock.enabled']);});
+
+ var pSettings = Promise.all([pEnabled, pPassEnabled]);
+ pSettings.then(() => {this.initStaged()});
+ };
+
+ LockScreen.prototype.initStaged =
+ function ls\_initStaged() {
/\*\*
\* "new style" slider: as described in <https://bugzil.la/950884>
\* setting this parameter to true causes the LockScreenSlide to render

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1173284#c42)• 10 years ago |
|  | |

FxOS always opens the lock screen on reboot even if the user disables it in the settings. This turned out to be an artefact of the very same race condition that causes the pass code bypass. Has this been a conscious design decision?

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1173284#c43)• 10 years ago |
|  | |

(In reply to Christiane Ruetten [:cr] from [comment #42](/show_bug.cgi?id=1173284#c42 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> FxOS always opens the lock screen on reboot even if the user disables it in
> the settings. This turned out to be an artefact of the very same race
> condition that causes the pass code bypass. Has this been a conscious design
> decision?
It seems like this is a UX design question, so I'm tentatively setting needinfo? Tiffany (UX) to invite comment.Flags: needinfo?(tshakespeare)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1173284#c44)• 10 years ago |
|  | |

Just a remind: I've attached my patch (see the comment) to fix this according to the current design of state manager (which manages most of UI changes right now and should take over the legacy LockScreen in the future, although we have discovered some concerns so we were trying to migrate to another new state machine, which eliminates lots of issues of this intermediate one). The patch is still in progress because I'm writing unit tests for that, and I could only unfortunately use a slow round-robing strategy to allocate my time on that, because I'm also dealing with some other critical issues in different components.
So, what I'm saying is, if you're proposing a new patch, please note the thing should be considered with the fact that the legacy LockScreen, as I mentioned many times, now is in a progress to decentralize itself to multiple components. You'll never want to see another 2000+ lines 'lockscreen.js' appears again (that's what happened in v1.2: at that time it's a ridiculous monolithic component only smaller than the 'window\_manager.js' which is also a ridiculous and messy one). And for the solution, as you can see in the second WIP patch (with f+), I did what you posted here as a state condition of LockScreenStateManager, not as a global "init lock" that would postpone every initialization things until it's fully read (result in what you mentioned: the "black lockscreen state on startup"). That's because although the solution is exactly what I also considered to adopt to solve the case, it really hurts our platform because:
- User don't know what's happening: all they can see is a black screen without any prompt
- While only the unlocking action depends on the value, LockScreen components should be able to do other rendering and preparation things \*\*in parallel\*\*. To block all of these by a value may or may not be used later indeed violates what the performance team is doing: reducing the time user can start use the app as much as possible.
So what I've discussed with Tim is, according to [Comment 30](/show_bug.cgi?id=1173284#c30 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") and [Comment 32](/show_bug.cgi?id=1173284#c32 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), we should show the screen as soon as possible. And only block user only when the value isn't ready but the finger already dragged the slider to the end, which means the intention of unlocking now is presented. So the diagram would be:
[Booting]----|show LockScreen | ---- done | |
|other preparations| ------ done | user could unlock here | -----------------|
|slider rendering | ---- done | | |
|read the value | ---------- (an unfortunate long waiting at [Comment 22](/show_bug.cgi?id=1173284#c22 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")) -- \* --> unlock
As you can see, to respect the performance and UX principlse we can't make the diagram as:
[Booting]----|read the value| ---- (reading....) ---- |show LockScreen...| ----- |user could unlock here|
Nevertheless, I think for 2.2 and 2.1, since I believe it's not really a regression but an old bug hidden in the previous tests and bootstrapping which is slower than now (so it covered the symptom well), if the mozSettings reading isn't too long, we may patch them as that.Flags: needinfo?(cr)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1173284#c45)• 10 years ago |
|  | |

I'm aware, and I'm all supportive of your rewrite, and I'm not proposing to replace your patch. But as you say: it's a huge and complex project, and I am merely posting minimally-intrusive fixes so that we don't stand empty-handed until your rewrite lands.Flags: needinfo?(cr)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1173284#c46)• 10 years ago |
|  | |

Okay. Thanks for your understanding and affords. I plan to complete this and land the patch in the next week, although it depends on the CI results. Sorry for the delay.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1173284#c47)• 10 years ago |
|  | |

Sorry, \*efforts\*, a sleepy time :(

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1173284#c48)• 10 years ago |
|  | |

It's not remotely exploitable and requires a device falling into the wrong hands ("angry spouse attack"), so I'd down-rate this to sec-moderate, but I'm settling for sec-high because a bug like this can easily result in a serious PR disaster.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1173284#c52)• 10 years ago |
|  | |

Update: fixed all unit tests of state manager, will continue to fix other failed tests for the patch.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4058338_465475)• 10 years ago |

Group: core-securityFlags: sec-bounty?

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1173284#c53)• 10 years ago |
|  | |

Okay. All tests are green:
<https://treeherder.mozilla.org/#/jobs?repo=gaia&revision=1094fb7bc7ecfdc157c0ea0cf0c56a619b847f87>
I now will try to add new tests for the new parts. If everything is fine, I will be able to land it within these two days.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1173284#c54)• 10 years ago |
|  | |

Is [bug 1187765](/show_bug.cgi?id=1187765 "RESOLVED DUPLICATE - Bypass lockscreen without entering passcode") a dupe of this one?

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1173284#c55)• 10 years ago |
|  | |

Oh, yes, I missed it in the bugmail, sorry.

|  | [:gerard-majax](/user_profile?user_id=41385) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1173284#c56)• 10 years ago |
|  | |

Jumping into this, I see you are playing with mozSettings observers, and specifically moving code around. Please make sure you do not endup with a codepath that gets triggered multiple times within the systemapp without a matching removeObserver(): otherwise, this will just leak observers and slow down the system.

|  | [:gerard-majax](/user_profile?user_id=41385) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1173284#c57)• 10 years ago |
|  | |

(In reply to Greg Weng [:snowmantw][:gweng][:λ] from [comment #24](/show_bug.cgi?id=1173284#c24 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> There is a bug about mozSetting reading is too slow (confidential): Bug
> 1100188. But for the missing animation I still need to dig in to find out
> the root cause.
Investigation on this topic showed that the big delay was because the main thread was busy, and thus messages delivery was taking quite some time. Given the context, I get that you are observing the latency during a boot time phase. And this is exactly the moment where this happens. So the 3.8 secs delay you are observing can just be because of this: slow async messages passing because of busy main process.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1173284#c58)• 10 years ago |
|  | |

We have had some profiling, but it only shows the main thread is waiting somethings, not really busy. And we can't see what makes it waiting. Maybe the root cause is just like you said. But we also discovered some extra waiting in settings delay the whole booting time, and some of the requests seems from Gecko. For example, BT enabled value reading delay all the following settings at very beginning, and we've found they are all reading requests, so in theory they could be parallel executed. Anyway, for this bug we can try to find a specific solution first. I just mentioned that Cervantes and me prepare to do some study to see if mozsettings could be more optimised by making it more parallel. And since you once landed a patch about FORCE READONLY flag of setting requests, we want to know if you have some similar plans or concerns, so that we don't need to fix the duplicated bugs.
(This is a BTW. But since you mentioned the relative point, I post it here)

|  | [[:fabrice] Fabrice Desré](/user_profile?user_id=390071) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1173284#c59)• 10 years ago |
|  | |

We should focus on correctness instead of performance in this bug. It's pretty unacceptable to have a broken lock screen.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1173284#c60)• 10 years ago |
|  | |

Yes. I will land the Gaia patch first. I have almost completed that (see my updates). We may fire another bug for performance.

|  | [Tiffanie Shakespeare [:tif]](/user_profile?user_id=478202) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1173284#c61)• 10 years ago |
|  | |

(In reply to Richard Soderberg [:atoll] from [comment #43](/show_bug.cgi?id=1173284#c43 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> (In reply to Christiane Ruetten [:cr] from [comment #42](/show_bug.cgi?id=1173284#c42 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> > FxOS always opens the lock screen on reboot even if the user disables it in
> > the settings. This turned out to be an artefact of the very same race
> > condition that causes the pass code bypass. Has this been a conscious design
> > decision?
>
> It seems like this is a UX design question, so I'm tentatively setting
> needinfo? Tiffany (UX) to invite comment.
If the user disables the lockscreen in settings, then how do they know how to unlock the device? The device should be respecting the user's settings and either prompt them or not depending on the their settings.
Adding Harly for further comment if needed. Thanks!Flags: needinfo?(tshakespeare) → needinfo?(hhsu)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1173284#c62)• 10 years ago |
|  | |

Tiffanie, perhaps this is already clear, but it sounds like this may need clarification: we're talking about two types of locking in this bug: screen locking, requiring the user just to swipe, and pass code locking, requiring pin entry.
The side-issue I brought up in [comment #42](/show_bug.cgi?id=1173284#c42 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") is that after reboot the device is always screen-locked even when the user disables screen lock. The rest of this bug is about an error in pass code locking, but both these have a common cause.
But from your comment I take that invariably booting to screen lock was in fact not a deliberate UX decision.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1173284#c63)• 10 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
Since it works on my device and passed all tests on CI (excepted one I fixed now) and local console, set review.
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: review?(timdream)

|  | [Tim Guan-tin Chien [:timdream] (please needinfo)](/user_profile?user_id=185001) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1173284#c64)• 10 years ago |
|  | |

Comment on [attachment 8636455](/attachment.cgi?id=8636455 "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[details]](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1173284&attachment=8636455)
[gaia] snowmantw:[bug1173284](/show_bug.cgi?id=1173284 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")-rev3 > mozilla-b2g:master
I have one major concern around this patch and I want to know if this is something purposely done to make turnaround faster or accidental sloppiness.
|this.lockScreenStates.passcodeEnabled| could be either an anno object from |deferredRequest| or an actual boolean. You should try to pick one and stuck with it -- having to leverage dynamic-typing in JS almost always imply questionable design.
One alternative to be schedule the state-getting promises on to the mainPromise so that we could ensure the states are always an up-to-date boolean when the first |doTransfer| is being run. In that way you don't need to do complex things like above nor |resolveInnerStates| etc.
r=me if I am just wrong, if you don't agree with what I said, or you want to fix this in future bugs.
[Attachment #8636455](/attachment.cgi?id=8636455&action=edit "[gaia] snowmantw:bug1173284-rev3 > mozilla-b2g:master") -
Flags: review?(timdream) → review+

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1173284#c65)• 10 years ago |
|  | |

Before I reply Tim, I suddenly found it's a regression the root cause is only on 2.2+ (master; see [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition")). But obviously this bug exists in 2.0, 2.1 and 2.2. I think we better to clarify the regression status: if it's really a regression as [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), the 2.0, 2.1 and 2.2 symptom before [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") \*couldn't\* be the same bug. They must be with different root causes and deserves different solutions in different bugs. So I suggest that we should fire and investigate another bug for 2.2 and older branches before the [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), or the regression status won't be correct.Flags: needinfo?(ktucker)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1173284#c66)• 10 years ago |
|  | |

I think that Lockscreen can and must ensure that its (so far unsafe) defaults have been overridden by the settings listener callbacks before deciding on whether or not to screen lock or pass code lock the device. Let's just make sure now once and for all that this won't regress again. The rest of this problem complex lives in other components.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1173284#c67)• 10 years ago |
|  | |

Reproducible on Woodduck as per [bug 1185096](/show_bug.cgi?id=1185096 "RESOLVED DUPLICATE - Lockscreen passcode bypass")#c10
Btw, when reproducing this bug it helps to build more CPU load on boot-up by booking the device into an encrypted wireless network, giving you more time to swipe.
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1173284#c68)• 10 years ago |
|  | |

[Comment 66](/show_bug.cgi?id=1173284#c66 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") doesn't affect the fact it's a regression from [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), unless the analyzes are wrong. So I were not suggesting we should give up to patch them, but the bug status must be clarified. So, if they're uncovered by different root causes, we should fire different bugs for them, not try to manage different root causes in one bug with different patches. Otherwise, we should do the regression-window searching again, and to make sure whether it's a regression (since the flag and the conclusion is still held). If not, we need to clear it. It's just a simple flag problem.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1173284#c69)• 9 years ago |
|  | |

By all means, let's restrict this bug to LockScreen. I was just saying that because of its central role to security we should make sure that it in itself has all the safeguards for securely operating in a regressive environment.
So are we in agreement that within LockScreen the problem was a race condition with the settings observers not quickly enough overwriting the unsafe defaults? Or did I miss something?

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1173284#c70)• 9 years ago |
|  | |

1. If it's not a regression of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), because you and others raised that it appears in older branches, cancel the regression tag and the blocks of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."): it's now not correct anymore. And we need to take a look to see if setting it as regression still makes senses, since we now don't have the regression window anymore.
2. If it's still a regression of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), we're discussion two kinds of bug that may have almost the same root cause of racing. But [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") make the symptom worse. So, we may need two bugs to track the bug status correctly.
Please, take a look at [Comment 10](/show_bug.cgi?id=1173284#c10 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") to [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"). And I must emphasis it again: I don't say the racing isn't the root case. But apparently the regression status might be wrong: whether it's a regression of [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") by previous QA and my result, OR not. There is no third possibility. And I just raise a requirement to clear the bug status according to what we have now.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1173284#c72)• 9 years ago |
|  | |

Let me preface this by restating what the principal problem is:
SettingsListener.observe() not only registers the callback with mozSettings.addObserver(), it also triggers the callback by registering it in a mozSettings.createLock().get() 'success' event listener. This is meant for initializing the value on the listener side, but it can take up to several seconds during system bootstrap. This is the race condition we're talking about.
Regarding the regression:
I have looked at commit 02a14c282c5fb391675246e627a10d1508418c40 from March right before Alive landed his first patches in [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."). The basic anatomy starting from lockscreen\_bootstrap.js is the same:
1. this.lockscreen = new LockScreen();
- sets local defaults
- .enabled: true
- .passCodeEnabled: false
- calls .lockIfEnabled(true) even before registering observers
- registers settings observers for .enabled and .passCodeEnabled
- this starts the race
2. window.lockScreen = this.lockscreen;
3. window.lockScreenStateManager = new window.LockScreenStateManager();
4. window.lockScreenStateManager.start(window.lockScreen);
- maintains it's own state about passcodeEnabled
- registers own settings observer for that, no sync with lockScreen
- only lockscreen interaction ever is checkPassCodeTimeout
5. this.lockscreen.init();
- activates screen lock if .enabled
And later:
- user swipes right on LockScreen, triggering event that leads to LockScreen.unlock()
- LockScreen.unlock checks .passCodeEnabled, unlocks without pass code if (still) false
There was and is no logic that prevents that LockScreen.unlock is reached before the initial settings observer callbacks are fired, overriding the unsafe defaults. If the callbacks fire before swiping to the right and LockScreen.unlock(), pass code entry appears. If they don't, the phone unlocks without passcode. Everything points to the race condition existing prior to that, but it never was a problem as long as the callbacks were fired faster than the user could execute a swipe.
I'm sure there were other patches along the way that increased system load and shifted the first round of firing mozSettings observer callbacks to a later and later time to a point where it became relevant. Hence it doesn't make sense to single any one out pushing the race condition beyond some acceptable limit.
TL;DR: [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.") did not introduce the observer callback race condition, which I consider to be the root cause. If anything, I speculate it has only emphasized it by making lockscreen bootstrapping faster.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4184921_465475)• 9 years ago |

No longer blocks: [system-bootstrap](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.")Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1173284#c73)• 9 years ago |
|  | |

I must correct my analysis write-up: The last two items of 1. actually belong to 5., and 1. just sets defaults. Sorry for the spam.

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4197314_481704)• 9 years ago |

Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1173284#c74)• 9 years ago |
|  | |

In reply to [Comment 65](/show_bug.cgi?id=1173284#c65 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), I double checked the regression window in [Comment 14](/show_bug.cgi?id=1173284#c14 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") and it is absolutely correct for this bug.
This bug as written in [Comment 0](/show_bug.cgi?id=1173284#c0 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") only reproduces on the latest Flame 2.5 build. I cannot reproduce this issue on the latest Flame 2.2, 2.1 or 2.0 builds so that must be a different issue with a different set of steps and a different regression window.
Device: Flame 2.5
BuildID: 20150728115244 (issue reproduces 100% as written)
Gaia: 862f0895f3f5a97200601542d99a152a46385a0b
Gecko: 833403badc41
Version: 42.0a1 (2.5)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:42.0) Gecko/42.0 Firefox/42.0
Device: Flame 2.2 (Does not reproduce)
BuildID: 20150728111942
Gaia: e1e6317f17a840b19af9dbb25f5a771d8d9fa161
Gecko: 813cb3d271f0
Version: 37.0 (2.2)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:37.0) Gecko/37.0 Firefox/37.0
Device: Flame 2.1 (Does not reproduce)
BuildID: 20150723133047
Gaia: 9dba58d18006e921546cec62c76074ce81e16518
Gecko: 41e10c6740be
Version: 34.0 (2.1)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:34.0) Gecko/34.0 Firefox/34.0
Device: Flame 2.0
BuildID: 20150722193116 (Does not reproduce)
Gaia: b16ba05481e577bc644ed8966f587a70fe2148e6
Gecko: 2e6f1d4deff9
Version: 32.0 (2.0)
Firmware Version: v18D
User Agent: Mozilla/5.0 (Mobile; rv:32.0) Gecko/32.0 Firefox/32.0
This issue as written in [Comment 0](/show_bug.cgi?id=1173284#c0 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") appears to have been caused by the landing for [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure.").Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1173284#c75)• 9 years ago |
|  | |

To clarify the steps given in [Comment 6](/show_bug.cgi?id=1173284#c6 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") should be written up as a different bug. However, I cannot reproduce that issue manually following those steps. I'm sliding to unlock as soon as the slider appears but it still prompts me for a passcode on 2.2, 2.1 and 2.0.
On master, I am not particularly rushing. I waited like 3 seconds before sliding to unlock after restart and the passcode is not prompted. I hope this helps to clarify what is going on here.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected)Flags: needinfo?(ktucker)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1173284#c76)• 9 years ago |
|  | |

I can reproduce the issue on those builds by swiping before the ui appears.
Keep swiping frantically and you can get passed the lockscreen.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1173284#c77)• 9 years ago |
|  | |

Kevin and I spoke offline. I think the difference might have been I have SIM security turned on my SIM. I'll reinvestigate the issue for 2.0, 2.1, 2.2
He reproduced not seeing the SIM pin dialog for 2.2
We probably should separate what I'm seeing into a separate bug from this original issue.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1173284#c78)• 9 years ago |
|  | |

While QA puts great efforts to clarify the situation, I shall land the patch to solve what we have now, for master (2.5). I would also take a look at other branches after that. But first, I need to switches temporarily to the recent intermittent errors of Gij, which bothers lots of people and make test unstable.
Naoki: please fire a different bug if you caught the different symptom, thanks.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=1173284#c79)• 9 years ago |
|  | |

[bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") is filed.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4212411_391803)• 9 years ago |

[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=1173284#c80)• 9 years ago |
|  | |

Okay the patch passed all tests:
<https://treeherder.mozilla.org/#/jobs?repo=gaia&revision=4586ecefd52a1ff1ea87f7db7f53f9ee9d6ef9b3>
and it works on my device. So I now land it.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4227800_476523)• 9 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=1173284#c81)• 9 years ago |
|  | |

master: <https://github.com/mozilla-b2g/gaia/commit/8bc364b351531cfaaa033229ec2dd81d8e5ebe7d>
I'm looking for any possible regressions. So NI me at this bug it they do happen. Thanks.Status: NEW → RESOLVEDClosed: 9 years agoResolution: --- → FIXED

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=1173284#c82)• 9 years ago |
|  | |

master: <https://github.com/mozilla-b2g/gaia/commit/8bc364b351531cfaaa033229ec2dd81d8e5ebe7d>
I'm looking for any possible regressions. So NI me at this bug it they do happen. Thanks.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=1173284#c83)• 9 years ago |
|  | |

Ahh sorry I suddenly saw one debugging line left in the patch. I now fix it.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=1173284#c84)• 9 years ago |
|  | |

Attached file
[The new PR](attachment.cgi?id=8640386)
— [Details](attachment.cgi?id=8640386&action=edit)

I created a new one and it's the same with the old (landed) one, but without the debugging line.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=1173284#c85)• 9 years ago |
|  | |

Landed again.
master: <https://github.com/mozilla-b2g/gaia/commit/b066d68030dac08cb545b37195bcab67593f365b>Status: REOPENED → RESOLVEDClosed: 9 years ago → 9 years agoResolution: --- → FIXED

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=1173284#c86)• 9 years ago |
|  | |

Naoki, KTucker, we have successfully reproduced this bug all the way back to 2.0 on Woodduck. Why are you resetting affected status?Flags: needinfo?(nhirata.bugzilla)Flags: needinfo?(ktucker)

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=1173284#c87)• 9 years ago |
|  | |

This is a pretty critical flaw, we should probably sec-review this to make sure this is fixed for sure - can you make sure this is done please cr? Thanks.Flags: sec-review?(cr)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4248338_75935)• 9 years ago |

[status-b2g-master](/buglist.cgi?f1=cf_status_b2g_master&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_master&o1=equals&v1=fixed)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)Target Milestone: --- → FxOS-S4 (07Aug)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=1173284#c88)• 9 years ago |
|  | |

Please note the symptom of [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") is very different from this bug: in this one, user can easily reproduce it by dragging the slider in an ordinary scene, while in [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"), as I've tried and the video shows, it needs some edging action to by-pass the lock. If user slide it when the slider shows up, it's hard to reproduce. So, although these bugs are both critical for security and they're with the same root cause, I can fix them with different solution that all suppose to plug the hole. The only different these two patches is in this bug, the patch cares about user experience and the new bootstrapping changes (which definitely makes it more complicated, but also necessary), while another one needn't to care about that since the reading time is much shorter.
As a conclusion, I now
1. Fixed this bug while caring user behavior & new bootstrapping
2. Fixing [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") with a much simple patch. It is because we can block the by-passing behavior in a simpler way, since the bootstrapping is the legacy one and the reading time user must to wait is not so long
So if the code is implemented correctly and will not trigger any new regression, and security team review it as Paul said, we may claim this/these bugs are fixed.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4261396_465475)• 9 years ago |

See Also: → [1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions")

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=1173284#c89)• 9 years ago |
|  | |

CR, per [comment 88](/show_bug.cgi?id=1173284#c88 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"); in [comment 35](/show_bug.cgi?id=1173284#c35 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), I used different steps when testing 2.x which is listed in [bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)").
We seperated them into two separate issues as there was a major regression which is an issue and a harder to reproduce security issue that was split off in [bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)").
Greg is going to try to address both. I think we're all on the same page that we don't want this bug to escape. Just separating this one from the other one is probably better as ktucker and Greg had noted.Flags: needinfo?(nhirata.bugzilla)Flags: needinfo?(ktucker)Flags: needinfo?(cr)

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=1173284#c90)• 9 years ago |
|  | |

Naoki, I am able to reproduce this on my Woodduck with 2.0m with just the STR in [comment 0](/show_bug.cgi?id=1173284#c0 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") (and without any SIM pin involvement). The mechanism of the flaw is the same, and the code in 2.0 is essentially identical in that respect (I verified). This bug needs to be addressed all the way back to 2.0.
KTucker's approach of testing this bug against different B2G versions on the relatively powerful Flame is not suitable for this type of bug. Since it's a race condition, the race window's length varies greatly with device performance and system load during boot up.
We already know that latest B2G versions put so much stress on the system that it pushes the race length beyond acceptable limits even on powerful devices like the Flame. And even if the race window is too short to reliably exploit on a Flame with 2.0, it doesn't mean that it's neither exploitable on a slower device or when the device is connecting to an encrypted wireless network, or connected via Bluetooth, or anything else that increases system load during boot-up.
Consequently I am resetting affected status and re-opening this bug as incomplete, so we don't lose track of this. If different B2G versions require different fixes, please address this in separate blocking bugs, but please don't reset the tracking flags again unless you can prove my analysis wrong, or – at the very least – test the bug negatively against the slowest device running the most load-demanding config we need to support.
I would propose to remove the 2.5 blocker once the sec review of Greg's patch is finished, but I don't expect any issues there.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=%3F)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=%3F)Flags: needinfo?(cr)Resolution: FIXED → INCOMPLETE

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=1173284#c91)• 9 years ago |
|  | |

This should be fixed - cr misunderstood the status meanings here.Resolution: INCOMPLETE → FIXED

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=1173284#c92)• 9 years ago |
|  | |

So I feel Christiane is treating this as a "meta" or "tracking" bug for tracking according to the words ("...don't lose tracking ..." and "address this in separate blocking bugs") . I don't mind people to reset the tracking flags if that is true. But that intention should be stated clearly, so maybe we should change the title to add some [tracking] or [meta] to follow the usual convention of bug management.

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=1173284#c93)• 9 years ago |
|  | |

I think Christiane's main concern was just that this does in fact affect earlier versions, and that is now reflected in the status flags.

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=1173284#c94)• 9 years ago |
|  | |

Greg - it might be too late, but how possible is this fix to backport to 2.2? I wonder if there is any chance we can get a fix to partners before they ship?Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=1173284#c95)• 9 years ago |
|  | |

No. This fix is only for code after [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), as I said at [Comment 65](/show_bug.cgi?id=1173284#c65 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"). And please note that's why I asked if we should raise another bug with a different symptom which also deserves a different patch, although the root case may be the same. Because before [bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."), there is no need to handle the LazyLoading + abnormal reading delay, which significantly add the effort to deal with the bug. You can take a look at [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"): the solution is simple and thus it's with fewer risks to land it in 2.2, 2.1 and maybe 2.0.
And I need to mention that I can't reproduce this bug on 2.2 without the rapid sliding at very beginning of bootstrapping, just like QA did at [bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"). So I feel it will be great if Christiane can upload a video about how to reproduce it as STR0 (Flame and Wooduck). Basically, if your reproduction needs to start slide it \*before\* you see the unlocker, or the settings reading doesn't cost the abnormally long time to complete, it could be solved by applying the patch for [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)"). Otherwise, we \*might\* need a more complicated patch like this one. Unless UX decided it's tolerable to fix the issue with the freezing delay.Flags: needinfo?(gweng)

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=1173284#c96)• 9 years ago |
|  | |

So Paul, that's what I really don't know why secure team looks like to fix them in the same bug. To fork a bug with different symptoms and with different patches won't hurt the fact that they're both valid bug and \*all\* fixed the same flaw, while we can avoid to uplift the large patch to the stabilizing branches. Moreover, to mix bugs with different symptoms on different branches always mess bug status. To separate them is usually a better way to manage them.
And, I'm just so tired to explain that again and again (\*see\* how much comments I can refer to), while what I'm talking about seemed totally ignored. It's also really annoyed to change the tracking flags without asking (NI) he who opposes it earlier. Please, if someone disagree others' opinions, at least the one should take a look at what the opponent said, and counter strike them based on the opinions or the new solid facts.

|  | [sjw](/user_profile?user_id=436910) |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=1173284#c97)• 9 years ago |
|  | |

Could someone CC me to the newly referred bugs here, please?

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=1173284#c98)• 9 years ago |
|  | |

Greg, I don't see how producing video proof is going to help. AFAICS, the rapid swiping that helps exploiting Woodduck isn't indicative of a different bug and it isn't even a different symptom. It merely has two effects:
1. It increases system load by hammering the event queue, thus widening the race window.
2. It helps hitting short race windows.
Rapid swiping is just an advanced exploit variant of STR0, and the underlying issue is the same: The unlock event is fired before the settings were read. Greg, if you are really convinced that rapid swiping is a different issue, please, point out the code flow to me that is responsible. I can't see how. Until then I maintain that it is as outlined [comment 72](/show_bug.cgi?id=1173284#c72 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") / 73.
However, there's a very simple way to shut me up about this as proposed in [bug 1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions") and before: We could change
lockscreen.js: passCodeEnabled: false; // insecure
to
lockscreen.js: passCodeEnabled: true; // secure
in all affected versions, and this problem ceases to be a security issue with a simple one-liner. Its frankly very minor UX regression of having to swipe twice – and that if and only if you're fast enough to hit the race window – could then be dealt with in separate, non-security-relevant bugs, and in the same way that Greg is planning to, anyway.
I'd rather have a working pass code lock than never ever having to swipe twice.

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=1173284#c99)• 9 years ago |
|  | |

Moving tracking of uplifting efforts in affected branches to tracking [bug 1189314](/show_bug.cgi?id=1189314 "RESOLVED WONTFIX"). If you fix the bypass in other releases, please open a separate bug that blocks 1189314.
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → ---
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → ---
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → ---
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=%3F) → ---
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → ---
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=%3F) → ---

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=1173284#c100)• 9 years ago |
|  | |

I don't know how many times I must repeat that the difference is matter for the different solution. \*Sigh\*
As I said (yes, I've said, again), why it matters is because according the symptom, we can prepare different solutions to eliminate the racing. One is to delay the unlocker to block user action before we successfully reading the value. This is a very simple solution that you also proposed at [Comment 41](/show_bug.cgi?id=1173284#c41 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), although your version blocks more than the unlocker (you blocks the whole initialization of the lockscreen). The advantage is it's very simple, so you it's not to risky to uplift to other branches.
However, the shortage is it could seriously hurt the user experience if the bootstrapping time is short and user can see the screen lock soon, and that's what we now have after [Bug 1094759](/show_bug.cgi?id=1094759 "RESOLVED FIXED - [System2] Implement new bootup procedure."). So the second solution I used here, is to block the component only when the value is really needed, which means before user unlock it. This gives us a better solution respect performance and UX requirement, plus the changes of new bootstrapping. The shortage is the patch is complicated and mixed with lots of new changes don't exist in the old branches. So to uplift such patch is risky.
That's what I've and they still hold true even you still don't get it. Time to cite:
> I don't see how producing video proof is going to help.
If you know what I'm talking about, and if you've seen my solutions and their differences and what I concern, you'll know it's important to help.
> AFAICS, the rapid swiping that helps exploiting Woodduck isn't indicative of a different bug and it isn't even a different symptom.
No. Even though they're the same bug ([Comment 65](/show_bug.cgi?id=1173284#c65 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), [Comment 88](/show_bug.cgi?id=1173284#c88 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), [Comment 95](/show_bug.cgi?id=1173284#c95 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") and [Bug 1188716 Comment 4](/show_bug.cgi?id=1188716#c4 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)")), the different racing window before user can see the screen locker means whether we can adopt a more simple solution or not, which is important for uplifting since we need to reduce the risk AMAP.
> It merely has two effects:
> 1. It increases system load by hammering the event queue, thus widening the race window.
> 2. It helps hitting short race windows.
> Rapid swiping is just an advanced exploit variant of STR0, and the underlying issue is the same: The unlock event is fired before the settings were read. Greg, if you are really convinced that rapid swiping is a different issue, please, point out the code flow to me that is responsible. I can't see how. Until then I maintain that it is as outlined [comment 72](/show_bug.cgi?id=1173284#c72 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition") / 73.
You're just repeating what I said, and you still don't get it: yes, they're the same bug, and they're the same issue, but they could be solved with different solutions which are better for different branches. And the solutions are both valid since they both block user to unlock the screen by-passing the passcode, but their concerns are not different.
So is "Rapid swiping is just an advanced exploit variant of STR0" ? Yes, and I never said it isn't. But if a bug need to be reproduced by rapid swiping + early swiping at bootstrapping, especially when it's in an old branch, it definitely deserves a different solution.
\*Repeat again\*: they're both valid solutions for the same bug, but they're good to the different cases.
> However, there's a very simple way to shut me up about this as proposed in [bug 1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions") and before: We could change
> lockscreen.js: passCodeEnabled: false; // insecure
> to
> lockscreen.js: passCodeEnabled: true; // secure
> in all affected versions, and this problem ceases to be a security issue with a simple one-liner.
NO. It \*covers\* the racing again, and the mindset like this is what really doesn't help. What surprise me is you proposed this as I haven't submit any valid solution, and as you never saw my patch has been landed and waiting for future validation. The fact is, that value should never be used if it's still not read from db. So we either block user action requires that value, or we block the whole initialization of the unlocker. And that's what the two patches implemented for.
> However, there's a very simple way to shut me up about this as proposed in [bug 1188934](/show_bug.cgi?id=1188934 "RESOLVED WONTFIX - Lockscreen: harden .unlock() against settings observer callback race conditions") and before: We could change
I rather you seriously read what I commented and proposed and landed. If you have found any defects in my patches and concerns for different branches, you can pick and put them here, so we can make it more secure and sophisticated. That's what a effective and ordinary bug should do. But to push me to explain it again and again, and to ignore them all, is not the way to solve the case.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 101](/show_bug.cgi?id=1173284#c101)• 9 years ago |
|  | |

(In reply to Christiane Ruetten [:cr] from [comment #99](/show_bug.cgi?id=1173284#c99 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"))
> Moving tracking of uplifting efforts in affected branches to tracking bug
> 1189314. If you fix the bypass in other releases, please open a separate bug
> that blocks 1189314.
That's what [Bug 118871](/show_bug.cgi?id=118871 "RESOLVED WORKSFORME - Automatic reload reloads all images *everytime* they appear on the page.") is for. It's already open, and you're also in the CC list and has been NIed.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=1173284#c102)• 9 years ago |
|  | |

Sorry, [Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)").

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=1173284#c103)• 9 years ago |
|  | |

Greg, I really tried, but we're moving backwards. Please stop blaming me for your refusal to adopt a security mindset even for the sake of this discussion. Just because I don't interpret things your way doesn't mean that I don't understand what your approach and motivation are. You made that plenty clear by now and repeating your stance until I fall in line isn't helping. While there's lots to be said about [comment 100](/show_bug.cgi?id=1173284#c100 "RESOLVED FIXED - Firefox OS Lockscreen passcode bypass due to race condition"), I'm not going to debate this any more.

|  | [Pi Wei Cheng [:piwei] (inactive)](/user_profile?user_id=501985) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4361000_501985)• 9 years ago |

Depends on: [1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted")

|  | [KTucker [:KTucker][Inactive 3/4/2016]](/user_profile?user_id=481704) |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=1173284#c104)• 9 years ago |
|  | |

We will need this landing backed out. It seems to be causing a smoke test blocker. Please see [bug 1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted").Flags: needinfo?(nhirata.bugzilla)

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=1173284#c105)• 9 years ago |
|  | |

CR and I spoke about this bug. We both thought the current situation of having to reboot the device is better than having the security issue that the patch tried to resolve.
I'm thinking we also have to reevaluate when we're doing backouts to figuring out which break is worse. The break that the patch is resolving or the regression that it causes.
I would prefer to either talk to Greg first before backing out, or more so let him decide in this case esp since he's the owner of the patch.

|  | [Greg Weng [:snowmantw][:gweng][:λ]](/user_profile?user_id=476523)  Assignee |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=1173284#c106)• 9 years ago |
|  | |

I submitted the patch at [Bug 1189455](/show_bug.cgi?id=1189455 "VERIFIED FIXED - [Lockscreen] enabling/disabling passcode will not take effect until device is restarted").

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 107](/show_bug.cgi?id=1173284#c107)• 9 years ago |
|  | |

Just FYI for other readers of this bug - I've taken the discussions above to email and face to face meetings to figure out the jumble of bugs, versions and issues and figure out a path forward here. I'll post back in this and related bugs once we get a solid plan.

|  | [Naoki Hirata :nhirata (please use needinfo instead of cc)](/user_profile?user_id=391803) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4445363_391803)• 9 years ago |

Flags: needinfo?(nhirata.bugzilla)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4697344_1689)• 9 years ago |

[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4697466_1689)• 9 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 108](/show_bug.cgi?id=1173284#c108)• 9 years ago |
|  | |

[Bug 1188716](/show_bug.cgi?id=1188716 "RESOLVED FIXED - Lockscreen can be bypassed with swiping while the device is booting (having the SIM pin lock facilitates it)") covers fixing older releases, so wontfixing this bug for better tracking.
[status-b2g-v2.1S](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1_s&o1=equals&v1=wontfix)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=wontfix)
[status-b2g-v2.2r](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_2r&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a4972762_75935)• 9 years ago |

[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=wontfix)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=wontfix)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a6729910_1689)• 9 years ago |

Group: b2g-core-security

|  | [Harly Hsu[:harly]](/user_profile?user_id=486171) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a6826242_486171)• 9 years ago |

Flags: needinfo?(hhsu)

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a7251023_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a7862760_465475)• 9 years ago |

Flags: sec-review?(cr) → sec-review+

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a12704239_465475)• 9 years ago |

Whiteboard: [v3.0-nexus-5-l] → [v3.0-nexus-5-l][b2g-adv-main2.5+]

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a18002009_465475)• 9 years ago |

Summary: [Lock Screen] pass code bypass after reboot due to settings observer race condition → Firefox OS Lockscreen passcode bypass due to settings observer race condition

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a18003448_465475)• 9 years ago |

Alias: CVE-2015-8511Summary: Firefox OS Lockscreen passcode bypass due to settings observer race condition → Firefox OS Lockscreen passcode bypass due to race condition

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a33555827_1689)• 9 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1173284#a283158732_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1173284&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shally Li（leave from Mozilla）](/user_profile?user_id=519767)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_3659d679_20250126_072504.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from blog.mozilla.org_214f5ef1_20250126_072507.html ===

[Skip to content](#content)

[Mozilla](https://blog.mozilla.org/en/)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

* [Internet Culture](https://blog.mozilla.org/en/category/internet-culture/)
  + [Deep Dives](https://blog.mozilla.org/en/category/internet-culture/deep-dives/)
  + [Mozilla Explains](https://blog.mozilla.org/en/category/internet-culture/mozilla-explains/)
  + [Interviews](https://blog.mozilla.org/en/category/internet-culture/interviews/)
  + [Videos](https://blog.mozilla.org/en/category/videos/)
* [Privacy & Security](https://blog.mozilla.org/en/category/privacy-security/)
* [Products](https://blog.mozilla.org/en/category/products/)
  + [Firefox](https://blog.mozilla.org/en/category/products/firefox/)
  + [Pocket](https://blog.mozilla.org/en/category/products/pocket/)
  + [Mozilla VPN](https://blog.mozilla.org/en/category/products/mozilla-vpn/)
* [Mozilla](https://blog.mozilla.org/en/category/mozilla/)
  + [News](https://blog.mozilla.org/en/category/mozilla/news/)
  + [Internet Policy](https://blog.mozilla.org/en/category/mozilla/internet-policy/)
  + [Leadership](https://blog.mozilla.org/en/category/mozilla/leadership/)
    - [Mitchell Baker, CEO](https://blog.mozilla.org/en/author/mitchellmozillacom/)
    - [Mark Surman, ED Foundation](https://blog.mozilla.org/en/author/markmozillafoundation-org/)
    - [Eric Rescorla, Firefox CTO](https://blog.mozilla.org/en/author/ekrmozilla-com/)

[Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

#### Search

Search for:

![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2019/01/mozilla-logo-bw-rgb.png)
## News

Official announcements and press releases

[![Room filled with people listening to a speaker on stage. Demo Day visual image in the background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/Demo_Day_Blog_Header_-1-800x800.jpg)
Mozilla
## Mozilla Builders: Celebrating community-driven innovation in AI

Read More](https://blog.mozilla.org/en/mozilla/mozilla-builders-demo-day/)

[![The Mozilla logo in green on a black background](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/logo-lockup-video-poster-800x800.png)
Mozilla
## Mozilla welcomes new executive team members

Read More](https://blog.mozilla.org/en/mozilla/new-executives/)

[![Decorative image of wrapped gifts in front of an iphone](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/11/moz_header_holiday_firefox-phone-gifts_blue-03.png-800x800.png)
Products
## Shopping for everyone? We’ve got you covered with the Fakespot Holiday Gift Guide 2024

Read More](https://blog.mozilla.org/en/products/shopping-for-everyone-weve-got-you-covered-with-the-fakespot-holiday-gift-guide-2024/)

[![Text: Mozilla Builders](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/Blog-16_9-1920x1080-1-800x800.png)
Mozilla
## 14 AI projects to watch: Mozilla’s first Builders Accelerator cohort kicks off

Read More](https://blog.mozilla.org/en/mozilla/14-ai-projects-to-watch-mozillas-first-builders-accelerator-cohort-kicks-off/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot’s guide to trending back-to-school products

Read More](https://blog.mozilla.org/en/mozilla/news/fakespots-guide-to-trending-back-to-school-products/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## BAFTA Award-Winner Siobhán McSweeney to host Mozilla’s 2nd Annual Rise25 Awards in Dublin, Ireland on Aug. 13

Read More](https://blog.mozilla.org/en/mozilla/bafta-award-winner-siobhan-mcsweeney-to-host-mozillas-2nd-annual-rise25-awards-in-dublin-ireland-on-august-13/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/05/fx_website_meta-image_tips-tricks_alt-04-1-800x800.webp)
Mozilla
## Here’s what we’re working on in Firefox

Read More](https://blog.mozilla.org/en/mozilla/heres-what-were-working-on-in-firefox/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot reveals the product categories with the most and least reliable product reviews

Read More](https://blog.mozilla.org/en/mozilla/news/fakespot-reveals-the-product-categories-with-the-most-and-least-reliable-product-reviews-for-summer-and-back-to-school-shopping/)

[![A dark blue speech bubble with horizontal purple and red bars on a pink background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2020/03/fx_blog_header_announcements_001_1920x1080-800x800.jpg)
Firefox
## Engaging with our Firefox community: Highlights from our recent AMA

Read More](https://blog.mozilla.org/en/products/firefox/engaging-with-our-firefox-community-highlights-from-our-recent-ama/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## Mozilla announces finalists for the 2nd annual Rise25 Awards

Read More](https://blog.mozilla.org/en/mozilla/mozilla-announces-finalists-for-the-2nd-annual-rise25-awards/)

[![Mozilla and Anonym logos](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/blog_1200x800_v2-800x800.png)
Mozilla
## Introducing Anonym: Raising the bar for privacy-preserving digital advertising

Read More](https://blog.mozilla.org/en/mozilla/mozilla-anonym-raising-the-bar-for-privacy-preserving-digital-advertising/)

[![logo - zero with a diagonal line through it, and the letters D, I, N](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/odintbanner-500x500.png)
Mozilla
## Keeping GenAI technologies secure is a shared responsibility

Read More](https://blog.mozilla.org/en/mozilla/keeping-genai-technologies-secure-is-a-shared-responsibility/)

1
[2](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla)
[3](https://blog.mozilla.org/en/category/mozilla/news/page/3?utm_source=www.mozilla)
…
[24](https://blog.mozilla.org/en/category/mozilla/news/page/24?utm_source=www.mozilla)
[next](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla)

![newsletter](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/newsletter.png)

### Keep up with all things Firefox

Get how-tos, advice and news to make your Firefox experience work best for you.

Your e-mail address

Country
- select -
Afghanistan
Akrotiri
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Ashmore and Cartier Islands
Australia
Austria
Azerbaijan
Bahamas, The
Bahrain
Baker Island
Bangladesh
Barbados
Bassas da India
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia
Bonaire, Sint Eustatius, and Saba
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei
Bulgaria
Burkina Faso
Burma
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Clipperton Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo (Brazzaville)
Congo (Kinshasa)
Cook Islands
Coral Sea Islands
Costa Rica
Croatia
Cuba
Curaçao
Cyprus
Czech Republic
Côte d’Ivoire
Denmark
Dhekelia
Diego Garcia
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Ethiopia
Europa Island
Falkland Islands (Islas Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern and Antarctic Lands
Gabon
Gambia, The
Gaza Strip
Georgia
Germany
Ghana
Gibraltar
Glorioso Islands
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and McDonald Islands
Honduras
Hong Kong
Howland Island
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Jan Mayen
Japan
Jarvis Island
Jersey
Johnston Atoll
Jordan
Juan de Nova Island
Kazakhstan
Kenya
Kingman Reef
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Laos
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macau
Macedonia
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia, Federated States of
Midway Islands
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Namibia
Nauru
Navassa Island
Nepal
Netherlands
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palmyra Atoll
Panama
Papua New Guinea
Paracel Islands
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russia
Rwanda
Saint Barthelemy
Saint Helena, Ascension, and Tristan da Cunha
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and South Sandwich Islands
South Sudan
Spain
Spratly Islands
Sri Lanka
Sudan
Suriname
Svalbard
Swaziland
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tromelin Island
Tunisia
Turkey
Turkmenistan
Turks and Caicos Islands
Tuvalu
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S.
Wake Island
Wallis and Futuna
West Bank
Western Sahara
Yemen
Zambia
Zimbabwe

Language
English
Bahasa Indonesia
Deutsch
Español
Français
Polski
Português
Русский
正體中文

Format

 HTML

 Text

I’m okay with Mozilla handling my info as explained in this [Privacy Policy](https://www.mozilla.org/privacy/).

Sign up now
We will only send you
Mozilla-related information.

## Thanks!

If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an e-mail from us.

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Mozilla

* [About](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Contact Us](https://www.mozilla.org/contact/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Donate](https://donate.mozilla.org/?presets=50,30,20,10&amount=30¤cy=usd&utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Firefox

* [Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Desktop](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Mobile](https://www.mozilla.org/firefox/mobile/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Features](https://www.mozilla.org/firefox/features/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Beta, Nightly, Developer Edition](https://www.mozilla.org/firefox/channel/desktop/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Resources

* [Privacy Hub](https://www.mozilla.org/privacy/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Browser Comparison](https://www.mozilla.org/firefox/browsers/compare/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Brand Standards](https://mozilla.design/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Social

Follow @Firefox

* [Twitter (@mozilla)](https://twitter.com/firefox)
* [Instagram (@mozilla)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)

Follow @Mozilla

* [Twitter (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)

* [Website Privacy Notice](https://www.mozilla.org/privacy/websites/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Legal](https://www.mozilla.org/about/legal/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)



=== Content from blog.mozilla.org_a1905f2a_20250126_072506.html ===

[Skip to content](#content)

[Mozilla](https://blog.mozilla.org/en/)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

* [Internet Culture](https://blog.mozilla.org/en/category/internet-culture/)
  + [Deep Dives](https://blog.mozilla.org/en/category/internet-culture/deep-dives/)
  + [Mozilla Explains](https://blog.mozilla.org/en/category/internet-culture/mozilla-explains/)
  + [Interviews](https://blog.mozilla.org/en/category/internet-culture/interviews/)
  + [Videos](https://blog.mozilla.org/en/category/videos/)
* [Privacy & Security](https://blog.mozilla.org/en/category/privacy-security/)
* [Products](https://blog.mozilla.org/en/category/products/)
  + [Firefox](https://blog.mozilla.org/en/category/products/firefox/)
  + [Pocket](https://blog.mozilla.org/en/category/products/pocket/)
  + [Mozilla VPN](https://blog.mozilla.org/en/category/products/mozilla-vpn/)
* [Mozilla](https://blog.mozilla.org/en/category/mozilla/)
  + [News](https://blog.mozilla.org/en/category/mozilla/news/)
  + [Internet Policy](https://blog.mozilla.org/en/category/mozilla/internet-policy/)
  + [Leadership](https://blog.mozilla.org/en/category/mozilla/leadership/)
    - [Mitchell Baker, CEO](https://blog.mozilla.org/en/author/mitchellmozillacom/)
    - [Mark Surman, ED Foundation](https://blog.mozilla.org/en/author/markmozillafoundation-org/)
    - [Eric Rescorla, Firefox CTO](https://blog.mozilla.org/en/author/ekrmozilla-com/)

[Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

#### Search

Search for:

![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2019/01/mozilla-logo-bw-rgb.png)
## News

Official announcements and press releases

[![Room filled with people listening to a speaker on stage. Demo Day visual image in the background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/Demo_Day_Blog_Header_-1-800x800.jpg)
Mozilla
## Mozilla Builders: Celebrating community-driven innovation in AI

Read More](https://blog.mozilla.org/en/mozilla/mozilla-builders-demo-day/)

[![The Mozilla logo in green on a black background](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/logo-lockup-video-poster-800x800.png)
Mozilla
## Mozilla welcomes new executive team members

Read More](https://blog.mozilla.org/en/mozilla/new-executives/)

[![Decorative image of wrapped gifts in front of an iphone](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/11/moz_header_holiday_firefox-phone-gifts_blue-03.png-800x800.png)
Products
## Shopping for everyone? We’ve got you covered with the Fakespot Holiday Gift Guide 2024

Read More](https://blog.mozilla.org/en/products/shopping-for-everyone-weve-got-you-covered-with-the-fakespot-holiday-gift-guide-2024/)

[![Text: Mozilla Builders](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/Blog-16_9-1920x1080-1-800x800.png)
Mozilla
## 14 AI projects to watch: Mozilla’s first Builders Accelerator cohort kicks off

Read More](https://blog.mozilla.org/en/mozilla/14-ai-projects-to-watch-mozillas-first-builders-accelerator-cohort-kicks-off/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot’s guide to trending back-to-school products

Read More](https://blog.mozilla.org/en/mozilla/news/fakespots-guide-to-trending-back-to-school-products/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## BAFTA Award-Winner Siobhán McSweeney to host Mozilla’s 2nd Annual Rise25 Awards in Dublin, Ireland on Aug. 13

Read More](https://blog.mozilla.org/en/mozilla/bafta-award-winner-siobhan-mcsweeney-to-host-mozillas-2nd-annual-rise25-awards-in-dublin-ireland-on-august-13/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/05/fx_website_meta-image_tips-tricks_alt-04-1-800x800.webp)
Mozilla
## Here’s what we’re working on in Firefox

Read More](https://blog.mozilla.org/en/mozilla/heres-what-were-working-on-in-firefox/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot reveals the product categories with the most and least reliable product reviews

Read More](https://blog.mozilla.org/en/mozilla/news/fakespot-reveals-the-product-categories-with-the-most-and-least-reliable-product-reviews-for-summer-and-back-to-school-shopping/)

[![A dark blue speech bubble with horizontal purple and red bars on a pink background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2020/03/fx_blog_header_announcements_001_1920x1080-800x800.jpg)
Firefox
## Engaging with our Firefox community: Highlights from our recent AMA

Read More](https://blog.mozilla.org/en/products/firefox/engaging-with-our-firefox-community-highlights-from-our-recent-ama/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## Mozilla announces finalists for the 2nd annual Rise25 Awards

Read More](https://blog.mozilla.org/en/mozilla/mozilla-announces-finalists-for-the-2nd-annual-rise25-awards/)

[![Mozilla and Anonym logos](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/blog_1200x800_v2-800x800.png)
Mozilla
## Introducing Anonym: Raising the bar for privacy-preserving digital advertising

Read More](https://blog.mozilla.org/en/mozilla/mozilla-anonym-raising-the-bar-for-privacy-preserving-digital-advertising/)

[![logo - zero with a diagonal line through it, and the letters D, I, N](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/odintbanner-500x500.png)
Mozilla
## Keeping GenAI technologies secure is a shared responsibility

Read More](https://blog.mozilla.org/en/mozilla/keeping-genai-technologies-secure-is-a-shared-responsibility/)

1
[2](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)
[3](https://blog.mozilla.org/en/category/mozilla/news/page/3?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)
…
[24](https://blog.mozilla.org/en/category/mozilla/news/page/24?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)
[next](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)

![newsletter](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/newsletter.png)

### Keep up with all things Firefox

Get how-tos, advice and news to make your Firefox experience work best for you.

Your e-mail address

Country
- select -
Afghanistan
Akrotiri
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Ashmore and Cartier Islands
Australia
Austria
Azerbaijan
Bahamas, The
Bahrain
Baker Island
Bangladesh
Barbados
Bassas da India
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia
Bonaire, Sint Eustatius, and Saba
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei
Bulgaria
Burkina Faso
Burma
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Clipperton Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo (Brazzaville)
Congo (Kinshasa)
Cook Islands
Coral Sea Islands
Costa Rica
Croatia
Cuba
Curaçao
Cyprus
Czech Republic
Côte d’Ivoire
Denmark
Dhekelia
Diego Garcia
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Ethiopia
Europa Island
Falkland Islands (Islas Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern and Antarctic Lands
Gabon
Gambia, The
Gaza Strip
Georgia
Germany
Ghana
Gibraltar
Glorioso Islands
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and McDonald Islands
Honduras
Hong Kong
Howland Island
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Jan Mayen
Japan
Jarvis Island
Jersey
Johnston Atoll
Jordan
Juan de Nova Island
Kazakhstan
Kenya
Kingman Reef
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Laos
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macau
Macedonia
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia, Federated States of
Midway Islands
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Namibia
Nauru
Navassa Island
Nepal
Netherlands
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palmyra Atoll
Panama
Papua New Guinea
Paracel Islands
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russia
Rwanda
Saint Barthelemy
Saint Helena, Ascension, and Tristan da Cunha
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and South Sandwich Islands
South Sudan
Spain
Spratly Islands
Sri Lanka
Sudan
Suriname
Svalbard
Swaziland
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tromelin Island
Tunisia
Turkey
Turkmenistan
Turks and Caicos Islands
Tuvalu
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S.
Wake Island
Wallis and Futuna
West Bank
Western Sahara
Yemen
Zambia
Zimbabwe

Language
English
Bahasa Indonesia
Deutsch
Español
Français
Polski
Português
Русский
正體中文

Format

 HTML

 Text

I’m okay with Mozilla handling my info as explained in this [Privacy Policy](https://www.mozilla.org/privacy/).

Sign up now
We will only send you
Mozilla-related information.

## Thanks!

If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an e-mail from us.

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Mozilla

* [About](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Contact Us](https://www.mozilla.org/contact/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Donate](https://donate.mozilla.org/?presets=50,30,20,10&amount=30¤cy=usd&utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Firefox

* [Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Desktop](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Mobile](https://www.mozilla.org/firefox/mobile/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Features](https://www.mozilla.org/firefox/features/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Beta, Nightly, Developer Edition](https://www.mozilla.org/firefox/channel/desktop/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Resources

* [Privacy Hub](https://www.mozilla.org/privacy/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Browser Comparison](https://www.mozilla.org/firefox/browsers/compare/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Brand Standards](https://mozilla.design/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Social

Follow @Firefox

* [Twitter (@mozilla)](https://twitter.com/firefox)
* [Instagram (@mozilla)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)

Follow @Mozilla

* [Twitter (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)

* [Website Privacy Notice](https://www.mozilla.org/privacy/websites/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Legal](https://www.mozilla.org/about/legal/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_072504.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


