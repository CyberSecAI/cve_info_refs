=== Content from www.openwall.com_7f30fb93_20250124_182748.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](11) [[next>]](13) [[<thread-prev]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5f7c61458c5f4f3d9c95c80a8da2521e@imshyb02.MITRE.ORG>
Date: Mon, 14 Nov 2016 14:46:55 -0500
From: <cve-assign@...re.org>
To: <sebastian@...ping.org>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>,
	<aceballos@...il.com>
Subject: Re: CVE needed? / gnuchess 6.2.4 fixed user input buffer overflow

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <http://lists.gnu.org/archive/html/bug-gnu-chess/2015-10/msg00002.html>
> <http://svn.savannah.gnu.org/viewvc?view=rev&root=chess&revision=134>

> frontend/move.cc

>> ValidateMove function that is expecting 128

Use CVE-2015-8972.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYKhRRAAoJEHb/MwWLVhi2DwcP/1juLQPRJva94HfwKmS+gZhL
yhKtVh9QtPrmwwBENu+m7q/DICQbzLMkm55OIxCqI/0IpH6UrSwV3ga1r1n8q6na
+6Z3hWSsl6AlIZ7ACWSsQikoc9xSRibIG4DIFR9yX6KpRcFX6SxvzZ2gxM5riU4m
sxreTblY5nqczyW7PT2gIOB93SBzsMnZDXf6eVJkNixuNb2zo0AAA32ccXjPCJJl
u2dU9q6z6PfuyMWymhXjY31NXzZlm8upMdyrvx/xqdy8Crpw/RYY67AEa1k2l15X
7C7v466fKnMmR3XYUVRLqnFjFdT2XAc11ITyl9HbXKPpsEbfTnUxiUgmpzIFU9y8
jrRNdRtsY469RPTxDjZTnfnu8blcTK9CfhzeSWva0SEc0phVtjjyPR6xrNuhUmKh
6714CVSSKtzbti2m2i/Aio6xfHef7RH7S8TcoEx5xnNHCJ77PPXEWPr2wkeSDeUc
NEZpw6IV3rhtyOrGNhEWxtU+NOYgK1qGCkpPWfZX3loNVihNETODLD1VsH6YYS0l
E5/wCzZ9Bu3k9qWgd9VTJQKZ/Jkfg/q4MCFcTqeqDNmEOrg+I8uJegsikwGnLij3
i79vBgnNt2nVmKIbNsX59zRlfgRS81Ok+zoLrjHEitGsfGYBh26vn7x2l/oFGEgU
l93Rb5Wp7wStDB4bzHHo
=Gg4P
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_c4fc10a5_20250124_182748.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](1) [[thread-next>]](12) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5147e375-7b26-a93d-b052-85cd8222c9fa@pipping.org>
Date: Mon, 14 Nov 2016 19:58:01 +0100
From: Sebastian Pipping <sebastian@...ping.org>
To: oss-security@...ts.openwall.com
Cc: Antonio Ceballos <aceballos@...il.com>
Subject: Re: Re: CVE needed? / gnuchess 6.2.4 fixed user input
 buffer overflow

Thanks for pointing to -u / UCI mode.

I guess it does make sense to request/assign a CVE then.

The initial report seems to be by Antti Karjalainen at
<http://lists.gnu.org/archive/html/bug-gnu-chess/2015-10/msg00002.html> .

Best, Sebastian

On 14.11.2016 10:42, cve-assign@...re.org wrote:
> The reference for this bug is:
>
>   <http://svn.savannah.gnu.org/viewvc?view=rev&root=chess&revision=134>
>
>> may need some other application in front (e.g. a website
>> using gnuchess for a backend or some mobile/desktop application
>> forwarding evil input to gnuchess with improper validation) to attack.
>
> Is it vulnerable without such an application if launched as
> "gnuchess -u" (UCI mode)? For example, is it taking untrusted input of
> 4096 characters and sending it to the ValidateMove function that is
> expecting 128?
>
>
>   #define BUF_SIZE 4096
>
>   #define MAXSTR 128
>
>
>   if ( flags & UCI )
>   ...
>   NextEngineCmd();
>   ...
>   ReadFromEngine();
>
>
>   static char engineinputbuf[BUF_SIZE]="";
>
>
>   nread = read( pipefd_a2f[0], engineinputaux, BUF_SIZE );
>   strcat( engineinputbuf, engineinputaux );
>
>
>   char enginemovestr[BUF_SIZE]="";
>   enginemove = ValidateMove( enginemovestr );
>
>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_e5b4223e_20250124_182748.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2016/11/14/1) [[thread-next>]](../../../2016/11/14/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <22143afd-005a-6fff-2c75-f5e74c2b92fe@pipping.org>
Date: Sun, 13 Nov 2016 16:28:19 +0100
From: Sebastian Pipping <sebastian@...ping.org>
To: oss-security@...ts.openwall.com
Cc: Antonio Ceballos <aceballos@...il.com>
Subject: CVE needed? / gnuchess 6.2.4 fixed user input buffer overflow

Hi there!

gnuchess 6.2.4 fixed a stack buffer overflow related to user move input,
i.e. 160 characters input can crash unpatched gnuchess 6.2.3.

I am unsure if this can be used to execute arbitrary code and if it
needs a CVE or not: gnuchess itself does not seem to accept input from a
file so it may need some other application in front (e.g. a website
using gnuchess for a backend or some mobile/desktop application
forwarding evil input to gnuchess with improper validation) to attack.

The patch in 6.2.4 is this, content from s goes into mvstr later:

# diff -u4 gnuchess-6.2.3/src/frontend/move.cc
gnuchess-6.2.4/src/frontend/move.cc
--- gnuchess-6.2.3/src/frontend/move.cc        2015-01-01
23:57:25.000000000 +0100
+++ gnuchess-6.2.4/src/frontend/move.cc        2016-09-20
01:12:35.000000000 +0200
@@ -541,8 +541,13 @@
    char mvstr[MAXSTR], *p;
    BitBoard b, b2;
    leaf *n1, *n2;

+   /* User input could be longer than MAXSTR */
+   if ( strlen(s) >= MAXSTR ) {
+      s[MAXSTR-1] = '\0';
+   }
+
    TreePtr[2] = TreePtr[1];
    GenMoves (1);
    FilterIllegalMoves (1);
    side = board.side;

Thanks and best

Sebastian

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from svn.savannah.gnu.org_fee9ebef_20250124_182747.html ===


| **[/](/viewvc)[[chess]](/viewvc/chess/)** |  |
| --- | --- |

[![ViewVC logotype](/viewvc/*docroot*/images/viewvc-logo.png)](http://www.viewvc.org/ "ViewVC Home")
# Revision 134

---

| Jump to revision: | [Previous](/viewvc/chess?view=revision&revision=133 "Previous Revision") [Next](/viewvc/chess?view=revision&revision=135 "Next Revision") |
| --- | --- |
| Author: | aceballos |
| Date: | Tue Sep 20 21:35:52 2016 UTC *(8 years, 4 months ago)* |
| Changed paths: | **2** |
| Log Message: | ``` Truncate user input if longer than 128 characters; otherwise, the program will crash. ``` |

---

**Changed paths:**

| Path | Details |
| --- | --- |
| [Directorytrunk/ChangeLog](/viewvc/chess/trunk/ChangeLog?view=markup&pathrev=134 "View File Contents") | [modified](/viewvc/chess/trunk/ChangeLog?view=log&pathrev=134 "View Log") , [text changed](/viewvc/chess/trunk/ChangeLog?r1=134&r2=133&pathrev=134 "View Diff") |
| [Directorytrunk/src/frontend/move.cc](/viewvc/chess/trunk/src/frontend/move.cc?view=markup&pathrev=134 "View File Contents") | [modified](/viewvc/chess/trunk/src/frontend/move.cc?view=log&pathrev=134 "View Log") , [text changed](/viewvc/chess/trunk/src/frontend/move.cc?r1=134&r2=133&pathrev=134 "View Diff") |

---

| savannah-hackers-public@gnu.org | **[ViewVC Help](/viewvc/%2Adocroot%2A/help_rootview.html)** |
| --- | --- |
| Powered by [ViewVC 1.1.5](http://viewvc.tigris.org/) |  |



=== Content from lists.gnu.org_5b7cefef_20250124_182746.html ===


| | **bug-gnu-chess** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-gnu-chess)

---

[[Date Prev](msg00001.html)][Date Next][[Thread Prev](msg00000.html)][Thread Next][[Date Index](index.html#00002)][[Thread Index](threads.html#00002)]

## Buffer overflow issue in gnuchess

---

| **From**: | Antti Karjalainen |
| --- | --- |

| **Subject**: | Buffer overflow issue in gnuchess |
| **Date**: | Thu, 29 Oct 2015 21:56:55 +0200 |

---

Hello,
There seems to be a buffer overflow vulnerability in gnuchess version 6.1.1.I think it's possible there is some remote attack vector via network play, but I haven't studied it further.
The issue can be reproduced like this:
$ gnuchess
GNU Chess 6.1.1Copyright (C) 2013 Free Software Foundation, Inc.License GPLv3+: GNU GPL version 3 or later <<http://gnu.org/licenses/gpl.html>>This is free software: you are free to change and redistribute it.There is NO WARRANTY, to the extent permitted by law.White (1) : 1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111TimeLimit[0] = 0TimeLimit[1] = 0Invalid move: 1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111White (1) : 11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111TimeLimit[0] = 0TimeLimit[1] = 0\*\*\* stack smashing detected \*\*\*: gnuchess terminated[1] 30500 abort (core dumped) gnuchess

    BR, Antti Karjalainen

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **Buffer overflow issue in gnuchess**,
  *Antti Karjalainen* **<=**

---

* Prev by Date:
  **[Re: -a doesn't work in gnuchess-6.2.2](msg00001.html)**
* Previous by thread:
  **[-a doesn't work in gnuchess-6.2.2](msg00000.html)**
* Index(es):
  + [**Date**](index.html#00002)
  + [**Thread**](threads.html#00002)


