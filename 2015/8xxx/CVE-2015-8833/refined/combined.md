=== Content from www.openwall.com_8d19de81_20250125_034706.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](12) [[next>]](../../../2016/03/10/1) [[<thread-prev]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160309231638.532136C0402@smtpvmsrv1.mitre.org>
Date: Wed,  9 Mar 2016 18:16:38 -0500 (EST)
From: cve-assign@...re.org
To: hanno@...eck.de
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Heap use after free in Pidgin-OTR plugin

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <https://blog.fuzzing-project.org/39-Heap-use-after-free-in-Pidgin-OTR-plugin.html>
>
> The pidgin-otr plugin version 4.0.2 fixes a heap use after free error.
> The bug is triggered when a user tries to authenticate a buddy and
> happens in the function create_smp_dialog.
>
> This bug was already independently discovered and reported in the otr
> bug tracker.
> <https://bugs.otr.im/issues/88>
>
> Upstream bug report (contains Address Sanitizer stack trace):
> <https://bugs.otr.im/issues/128>
> Commit / fix:
> <https://bugs.otr.im/projects/pidgin-otr/repository/revisions/aaf551b9dd5cbba8c4abaa3d4dc7ead860efef94>

>> gtk-dialog.c

Use CVE-2015-8833.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJW4K5zAAoJEL54rhJi8gl5qJIP/0TSzlXZQnc69Kt5bNsE2ovq
VwQkjUo4BiwB5ewuoSyNjDtEIrqOFSVesEFRFK33QfLCVELk7NtRf4QCMHgW6TuZ
HiK3grAbg8PtbcvMsKQTlo55BrZ5YBovXAsYmMeBmuZ7pp8wNYjAMvtjnnlwBesF
20nxsVSjVmQUAwUSgtrdQXMqXlNltcsq8HhXOSkTBFxTk/R6J/KfoW33EfcxFv0s
5zy/SU/sU6rI/0Gy4t4pPs/c2j7ApA9SmYfBel6xpdnCb2u3GSczz7O6+jEcRNzB
IqxvAOMkeIGHc0QHOd9naYkW2gyIP3Y0s4fTydzHrfU/aQ1ICWH0FHAcmcJIRKvF
diV7f1td8yzDlbk+TAsrp5RyxhzkagIJLeJhASYguPz5yELqS6cYqb4ie5LageNd
UBji9ulEPgHaAmQPMOZH6oJZE9YO9HKWJ3HOmEQ11DrbHlXkYA6ez0oLu53gRxB9
wuyo01YH7hF+FhMxRUL7RYNwyj06dBhohlWj8rRPIAhlrp7Pc/WAsAR1c3FJgCwk
2FmfpJ6BrCMumP+6EAGpbXegbBTMCOrvgpLc7UBYNnb+PvGyfwChLBSTIwrKzhga
FyH4O8lnB925tHofpCK0OEWWHOi0N6JKlChLKwEt1eMhUk7SnRsqNjyAdV1Kqk1u
bHI5urvjRUc0ka/E3oiK
=o1S3
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from blog.fuzzing-project.org_608e4ce0_20250126_054653.html ===

[Skip to content](#content)
[# The Fuzzing Project

Blog and Advisories](https://blog.fuzzing-project.org/)

Quicksearch

## Navigation

* [Back to main page](https://fuzzing-project.org/)
* [Software list](https://fuzzing-project.org/software.html)

## [When your Memory Allocator hides Security Bugs](/65-When-your-Memory-Allocator-hides-Security-Bugs.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Wednesday, January 30. 2019

![Memory](/uploads/ram.jpg)Recently I shared some information about potential [memory safety bugs in the Apache web server together with Craig Young](https://github.com/hannob/apache-uaf). One issue that came up in that context is the so-called pool allocator Apache is using.

What is this [pool allocator](https://apr.apache.org/docs/apr/1.6/group__apr__pools.html)? Apache’s APR library has a feature where you can allocate a pool, which is a larger area of memory, and then do memory allocations within that pool. It’s essentially a separate memory allocation functionality by the library. Similar concepts exist in other software.

Why would anyone do that? It might bring performance benefits to have memory allocation that’s optimized for a specific application. It also can make programming more convenient when you can allocate many small buffers in a pool and then not bothering about freeing each one of then and instead just free the whole pool with all allocations within.

There’s a disadvantage with the pool allocator, and that is that it may hide bugs. Let’s look at a simple code example:

#include <apr\_pools.h>

#include <stdio.h>

#include <string.h>

int main() {

apr\_pool\_t \*p;

char \*b1, \*b2;

apr\_initialize();

apr\_pool\_create(&p, NULL);

b1 = apr\_palloc(p, 6);

b2 = apr\_palloc(p, 6);

strcpy(b1, "This is too long");

strcpy(b2, "Short");

printf("%s %s\n", b1, b2);

}

We can compile this with:

`gcc $(pkg-config --cflags --libs apr-1) input.c`

What we’re doing here is that we create a pool p and we create two buffers (b1, b2) within that pool, each six byte. Now we fill those buffers with strings. However for b1 we fill it with a string that is larger than its size. This is thus a classic buffer overflow. The `printf` at the end which outputs both strings will show garbled output, because the two buffers interfere.

Now the question is how do we find such bugs? Of course we can carefully analyze the code, and in the simple example above this is easy to do. But in complex software such bugs are hard to find manually, therefore there are tools to detect unsafe memory access (e.g. buffer overflows, use after free) during execution. The state of the art tool is Address Sanitizer (ASAN). If you write C code and don’t use it for testing yet, you should start doing so now.

Address Sanitizer is part of both the gcc and clang compiler and it can be enabled by passing `-fsanitize=address` on the command line. We’ll also add -g, which adds debugging information and will give us better error messages. So let’s try:

`gcc -g -fsanitize=address $(pkg-config --cflags --libs apr-1) input.c`

If you try this you will find out that nothing has changed. We still see the garbled string and Address Sanitizer has not detected the buffer overflow.

Let’s try rewriting the above code in plain C without the pool allocator:

#include <stdio.h>

#include <string.h>

#include <stdlib.h>

int main() {

char \*b1, \*b2;

b1 = malloc(6);

b2 = malloc(6);

strcpy(b1, "This is too long");

strcpy(b2, "Short");

printf("%s %s\n", b1, b2);

}

If we compile and run this with ASAN it will give us a nice error message that tells us what’s going on:

==9319==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000016 at pc 0x7f81fdd08c9d bp 0x7ffe82881930 sp 0x7ffe828810d8

WRITE of size 17 at 0x602000000016 thread T0

#0 0x7f81fdd08c9c in \_\_interceptor\_memcpy /var/tmp/portage/sys-devel/gcc-8.2.0-r6/work/gcc-8.2.0/libsanitizer/sanitizer\_common/sanitizer\_common\_interceptors.inc:737

#1 0x5636994851e0 in main /tmp/input.c:10

#2 0x7f81fdb204ea in \_\_libc\_start\_main (/lib64/libc.so.6+0x244ea)

#3 0x5636994850e9 in \_start (/tmp/a.out+0x10e9)

0x602000000016 is located 0 bytes to the right of 6-byte region [0x602000000010,0x602000000016)

allocated by thread T0 here:

#0 0x7f81fddb6b10 in \_\_interceptor\_malloc /var/tmp/portage/sys-devel/gcc-8.2.0-r6/work/gcc-8.2.0/libsanitizer/asan/asan\_malloc\_linux.cc:86

#1 0x5636994851b6 in main /tmp/input.c:7

#2 0x7f81fdb204ea in \_\_libc\_start\_main (/lib64/libc.so.6+0x244ea)

So why didn’t the error show up when we used the pool allocator? The reason is that ASAN is built on top of the normal C memory allocation functions like `malloc`/`free`. It does not know anything about APR’s pools. From ASAN’s point of view the pool is just one large block of memory, and what’s happening inside is not relevant.

Thus we have a buffer overflow, but the state of the art tool to detect buffer overflows is unable to detect it. This is obviously not good, it means the pool allocator takes one of the most effective ways to discover an important class of security bugs away from us.

If you’re looking for solutions for that problem you may [find old documentation about "Debugging Memory Allocation in APR"](http://download.vikis.lt/manual/developer/debugging.html). However it relies on flags that have been removed from the APR library, so it’s not helpful. However there’s a not very well documented option of the APR library that allows us to gain memory safety checks back. Passing `--enable-pool-debug=yes` to the configure script will effectively disable the pool allocator and create a separate memory allocation for each call to the pool allocator.

If we compile our first example again, this time with the pool debugger and ASAN, we’ll see the error:

==20228==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000016 at pc 0x7fe2e625dc9d bp 0x7ffe8419a180 sp 0x7ffe84199928

WRITE of size 17 at 0x602000000016 thread T0

#0 0x7fe2e625dc9c in \_\_interceptor\_memcpy /var/tmp/portage/sys-devel/gcc-8.2.0-r6/work/gcc-8.2.0/libsanitizer/sanitizer\_common/sanitizer\_common\_interceptors.inc:737

#1 0x55fe439d132c in main /tmp/input.c:15

#2 0x7fe2e5fc34ea in \_\_libc\_start\_main (/lib64/libc.so.6+0x244ea)

#3 0x55fe439d1129 in \_start (/tmp/a.out+0x1129)

0x602000000016 is located 0 bytes to the right of 6-byte region [0x602000000010,0x602000000016)

allocated by thread T0 here:

#0 0x7fe2e630bb10 in \_\_interceptor\_malloc /var/tmp/portage/sys-devel/gcc-8.2.0-r6/work/gcc-8.2.0/libsanitizer/asan/asan\_malloc\_linux.cc:86

#1 0x7fe2e6203157 (/usr/lib64/libapr-1.so.0+0x1f157)

#2 0x7fe2e5fc34ea in \_\_libc\_start\_main (/lib64/libc.so.6+0x244ea)

Apache is not alone in having a custom memory allocation that can hide bugs. Mozilla’s NSPR and NSS libraries have something called an Arena Pool, Glib has memory slices and PHP has the Zend allocator. All of them have the potential of hiding memory safety bugs from ASAN, yet luckily all have an option to be turned off for testing. I maintain [a collection of information about such custom allocators and how to disable them](https://fuzzing-project.org/tutorial-malloc.html).

But back to Apache. When we started reporting use after free bugs we saw with the debugging option for the pool allocator we learned from the Apache developers that there are incompatibilities with the http2 module and the pool debugger. This has led to replies after our disclosure that these [are non-issues](https://icing.github.io/mod_h2/pool-debugging.html), because nobody should run the pool debugger in production.

It should be noted that we were also able to reproduce some bugs without the pool debugger in the latest Apache version (we have shared this information with Apache and will share it publicly later), and that indeed it seems some people did run the pool debugger in production (OpenBSD).

But I have another problem with this. If we consider that parts of the current Apache code are incompatible with the APR pool debugger then we end up with an unfortunate situation: If a tool like ASAN reports memory safety bugs with the pool debugger we don’t know if they are real issues or just incompatibilities. If we turn off the pool debugger we won’t see most of the memory safety bugs.

That’s a situation where testing Apache for memory safety bugs becomes practically very difficult. In my opinion that by itself is a worrying and severe security issue.

*Image source: [Dreamstime, CC0](https://www.dreamstime.com/ddr2-sdram-stands-double-data-rate-synchronous-dynamic-random-access-memory-interface-modules-used-desktop-pcs-public-domain-image-free-87854911)*

[0 Comments](/65-When-your-Memory-Allocator-hides-Security-Bugs.html#comments "0 Comments, 0 Trackbacks")

## [Stack buffer overflow in WolfSSL before 3.13.0](/63-Stack-buffer-overflow-in-WolfSSL-before-3.13.0.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Saturday, March 24. 2018

During some tests of TLS libraries I found a stack buffer overflow vulnerability in the WolfSSL library.

Finding this one was surprisingly simple: I had a wolfssl server that was compiled with address sanitizer and ran the SSL Labs test against it.

The bug happens in the parsing of the signature hash algorithm list that is sent in a ClientHello and is basically a textbook stack buffer overflow. WolfSSL simply tries to store that in an array with 32 elements. If one sends more than 32 hash algorithms it overflows.

With the SSL Labs scan the bug only causes WolfSSL to terminate if it's compiled with address sanitizer, but if one sends a very large list of hash algorithms it also crashes in a normal compile. In situations where WolfSSL is used without ASLR this bug is probably trivially exploitable.

I have created a simple [bash proof of concept](https://github.com/hannob/wolfoverflow) (using netcat and xxd) that crashes a WolfSSL server.

The bug was fixed in [this commit](https://github.com/wolfSSL/wolfssl/pull/1231/commits/9f7e40ad5c8097ff38d7caff4a9989db260981cc) and in version 3.13.0 of WolfSSL.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/63-Stack-buffer-overflow-in-WolfSSL-before-3.13.0.html#comments "0 Comments, 0 Trackbacks")

## [FLIMP! The GIMP has some security problems](/62-FLIMP%21-The-GIMP-has-some-security-problems.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Tuesday, December 19. 2017

I recently got an E-Mail from Tobias Stöckmann, who reminded me of some bugs I had almost forgotten. When I started the Fuzzing Project I reported two bugs in import parsers of the GIMP. Tobias managed to write an exploit for one of them.

See [FLIMP!](https://flimp.fuzzing-project.org/) for more info.

[0 Comments](/62-FLIMP%21-The-GIMP-has-some-security-problems.html#comments "0 Comments, 0 Trackbacks")

## [How Optionsbleed wasn't found in 2014](/61-How-Optionsbleed-wasnt-found-in-2014.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Wednesday, September 20. 2017

Shortly after I [published details about the Optionsbleed bug](https://blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html) I learned about something quite surprising: Others had already discovered this bug before, but have neither pinned it down to Apache nor recognized that it is a security vulnerability.

A paper published in 2014 on Arxiv titled ["Support for Various HTTP Methods on the Web"](https://arxiv.org/pdf/1405.2330.pdf) mentions servers sending malformed Allow headers. It has examples listed that very clearly look like the output you get from a server vulnerable to Optionsbleed.

This alone would be noteworthy enough, but there's something that makes this even more surprising. This paper was published in May 2014, about a month after the Heartbleed bug was found. Heartbleed gained a lot of attention, not just in the tech scene, it was widely covered in the mainstream media. It can be assumed that almost everyone working in IT had heard of it.

So we have a situation where a major bug hit the news - and several people must have had evidence of a very similar bug in front of their eyes shortly afterwards. Yet nobody has recognized it as such. One of the authors [mentioned in a comment](https://blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html#c989) that they hadn't looked at it from a security perspective, but still you'd think that someone should have noticed.

While it's always problematic to interpret too much into single anecdotes, it still makes me wonder things. Are we just terribly bad at explaining security issues? My personal impression is that Heartbleed is actually an issue that is relatively simple to grasp (of course best explained by [XKCD](https://xkcd.com/1354/)). Going from there to the idea that seeing random garbage in HTTP headers indicates a very similar bug doesn't seem so far fetched to me. But the facts seem to disprove that.

[0 Comments](/61-How-Optionsbleed-wasnt-found-in-2014.html#comments "0 Comments, 0 Trackbacks")

## [Optionsbleed - HTTP OPTIONS method can leak Apache's server memory](/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Monday, September 18. 2017

[![optionsbleed](/uploads/optionsbleed.serendipityThumb.png)](/uploads/optionsbleed.png)If you're using the HTTP protocol in everday Internet use you are usually only using two of its methods: GET and POST. However HTTP has a number of other methods, so I wondered what you can do with them and if there are any vulnerabilities.![](https://ssl-vg03.met.vgwort.de/na/cebfb3b02359461ab9ecf10beb28e327)
Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [16 Comments](/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html#comments "16 Comments, 2 Trackbacks")

## [Six year old PDF loop bug affects most major implementations](/59-Six-year-old-PDF-loop-bug-affects-most-major-implementations.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Sunday, September 3. 2017

![Endless Loop](/uploads/moebius-endless-loop.jpg)I recently did some testing of the qpdf library with afl and libfuzzer. I discovered an input sample that would generate a high CPU load spike and eventually after several minutes cause an out of memory error. It looked like the parser was caught in some kind of endless loop.

This reminded me of something. In [2011 at the Chaos Communication Camp Andreas Bogk gave a talk about creating a formally verified PDF parser with Ocaml and Coq](https://media.ccc.de/v/cccamp11-4426-certified_programming_with_dependent_types-en). In that talk he mentioned that one could create a PDF file with cross-referencing xref tables. A naive parser would get caught in an endless loop. He showed that the evince thumbnailer process was affected by this.

This was eventually fixed in evince's underlying rendering library poppler. But it seems this issue hasn't reached many other PDF parser libraries. The qpdf issue I had seen was exactly the [same bug](https://github.com/qpdf/qpdf/issues/149). The sample file can [be found here](https://github.com/andreas23/pdfparser/blob/master/tests/loop_edited.pdf). If you follow that link you'll immediately notice that Github's Javascript PDF viewer is also affected.

How about Mozilla Firefox? [Affected](https://bugzilla.mozilla.org/show_bug.cgi?id=1393476). (They use pdf.js, which is the same code Github uses.) What about Chrome / Chromium, which uses a library called PDFium? [Affected](https://bugs.chromium.org/p/pdfium/issues/detail?id=875). (Notably they already had a test PDF for this, but the function that causes the loop wasn't tested.) Microsoft Edge? [Affected](https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/13534806/). Ghostscript, which is the other major PDF parser used by many free and open source tools? [Also affected](https://bugs.ghostscript.com/show_bug.cgi?id=698409). For completeness, Adobe Reader and Apple's OS X internal PDF viewer were unaffected.

To make this clear: This isn't a major security issue, the impact is a denial of service. But it is certainly something undesirable that should be fixed.

It is remarkable that a bug that was discovered six years ago affected the majority of widely used PDF implementations. But it falls into a pattern of IT security: Very often discovering security issues means rediscovering old issues. In general this is a difficult problem to solve, as it touches complex questions about knowledge transfer.

However in this specific case - an input file that causes a bug in one implementation also causes the same bug in other implementations - there are things that can be done.

I report fuzzing-related bugs on a very regular basis and I always share a sample file that triggers the bug. In the best cases the maintainers of the affected software take the bug triggering sample and use it in their test suite. I think this should be a standard practice.

However that only prevents regressions in the same software. But maintainers of parsers for common file formats could also take a look at their competitors and check their test suites. While the PDF standard probably isn't well defined enough to allow a visual comparison of rendering output, it's surely obvious that no input file should cause a crash, an invalid memory access or an endless loop.

Looking at the common PDF libraries the situation with test cases was quite mixed. Mozilla's pdf.js had the most [extensive collection of files](https://github.com/mozilla/pdf.js/tree/master/test/pdfs), many of them examples from previous bugs. However one should know that about a third of them are not part of their code repository. They're referenced as links (all of them pointing to their own bug tracker or to the Internet archive, so I guess they're reasonably stable).

PDFium, used by Google Chrome, has a far less extensive test suite with only 96 PDF files. I have reported a bunch of PDFium bugs myself in the past (Examples: [[1]](https://bugs.chromium.org/p/chromium/issues/detail?id=450871), [[2]](https://bugs.chromium.org/p/chromium/issues/detail?id=457493), [[3]](https://bugs.chromium.org/p/chromium/issues/detail?id=450971)) and the test cases I provided never got added to the test suite.

QPDF is doing very well: They ship 278 test PDFs and for all the bugs I reported lately they added the provided sample files.

Ghostscript has only three PDF example files in its code (other PDFs in the code seem to be documentation, not test cases). Poppler's code has no PDFs bundled at all. They have a separate [test repository](https://cgit.freedesktop.org/poppler/test/) for that with 35 files, but it hasn't been updated since 2009. There's definitely lots of room for improvement in that area.

[Image Source](https://commons.wikimedia.org/wiki/File%3ACircle_Wind_Sculpture.jpg)

[9 Comments](/59-Six-year-old-PDF-loop-bug-affects-most-major-implementations.html#comments "9 Comments, 0 Trackbacks")

## [exiv2: multiple memory safety issues](/58-exiv2-multiple-memory-safety-issues.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Monday, July 3. 2017

*This post first appeared on [oss-security](http://www.openwall.com/lists/oss-security/2017/06/30/1).*

I'm reporting three issues here in exiv2, a parser libary for image metadata. These are only examples, exiv2 is full of memory safety bugs that can trivially be found by running afl with asan for a few hours.

I have not reported those issues upstream. When I previously tried to report bugs in exiv2 found via fuzzing the upstream author made it clear to me that he has little interest in fixing those issues and doesn't consider his software suitable to parse defect files (which basically means it's unsuitable for untrusted input). The [discussion can be read here](http://dev.exiv2.org/issues/1248). (the page is sometimes not available, searching for it in the google cache usually works though)

exiv2 is to my knowledge used by the major Linux Desktops GNOME and KDE. I'll also inform their security teams. I leave it up to Linux distros how to handle this, but it certainly is problematic that a crucial parser used by major desktop applications is not interested in fixing potential security issues.

**Heap overflow (write) in tiff parser**

A [malformed tiff file](https://crashes.fuzzing-project.org/exiv2-heap-oob-write.tiff) can cause a one byte heap overflow in exiv2.

Stack trace:

`==22873==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000df1 at pc 0x000000842091 bp 0x7fff51b3ee70 sp 0x7fff51b3ee68

WRITE of size 1 at 0x602000000df1 thread T0

#0 0x842090 in Exiv2::ul2Data(unsigned char*, unsigned int, Exiv2::ByteOrder) /f/exiv2-trunk/src/types.cpp:362:20

#1 0x68beac in long Exiv2::toData<unsigned int>(unsigned char*, unsigned int, Exiv2::ByteOrder) /f/exiv2-trunk/src/../include/exiv2/value.hpp:1459:16

#2 0x68beac in Exiv2::ValueType<unsigned int>::copy(unsigned char*, Exiv2::ByteOrder) const /f/exiv2-trunk/src/../include/exiv2/value.hpp:1612

#3 0x6742b2 in Exiv2::Exifdatum::copy(unsigned char*, Exiv2::ByteOrder) const /f/exiv2-trunk/src/exif.cpp:362:48

#4 0x7f794d in Exiv2::TiffImage::readMetadata() /f/exiv2-trunk/src/tiffimage.cpp:204:18

#5 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#6 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#7 0x55fb3f in main /f/exiv2-trunk/src/exiv2.cpp:170:25

#8 0x7f91c1e571d0 in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289

#9 0x468979 in _start (/r/exiv2/exiv2+0x468979)

0x602000000df1 is located 0 bytes to the right of 1-byte region [0x602000000df0,0x602000000df1)

allocated by thread T0 here:

#0 0x55af00 in operator new[](unsigned long) (/r/exiv2/exiv2+0x55af00)

#1 0x83fadf in Exiv2::DataBuf::alloc(long) /f/exiv2-trunk/src/types.cpp:158:22`

**Heap out of bounds read in jp2 / JPEG2000 parser**

A [malformed jpeg2000 file](https://crashes.fuzzing-project.org/exiv2-heap-oob-read.jp2) causes a (large) out of bounds read.

Stack trace:

`==32038==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f5e099e6838 at pc 0x00000050f22c bp 0x7ffdf7f3dcd0 sp 0x7ffdf7f3d480

READ of size 808464432 at 0x7f5e099e6838 thread T0

#0 0x50f22b in __asan_memcpy (/r/exiv2/exiv2+0x50f22b)

#1 0x6e82bc in Exiv2::Jp2Image::readMetadata() /f/exiv2-trunk/src/jp2image.cpp:277:29

#2 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#3 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#4 0x55fb3f in main /f/exiv2-trunk/src/exiv2.cpp:170:25

#5 0x7f5e130a71d0 in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289

#6 0x468979 in _start (/r/exiv2/exiv2+0x468979)

0x7f5e099e6838 is located 0 bytes to the right of 808452152-byte region [0x7f5dd96e6800,0x7f5e099e6838)

allocated by thread T0 here:

#0 0x55af00 in operator new[](unsigned long) (/r/exiv2/exiv2+0x55af00)

#1 0x6e8176 in Exiv2::DataBuf::DataBuf(long) /f/exiv2-trunk/src/../include/exiv2/types.hpp:204:46

#2 0x6e8176 in Exiv2::Jp2Image::readMetadata() /f/exiv2-trunk/src/jp2image.cpp:273

#3 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#4 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#5 0x7f5e130a71d0 in

__libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289`

**Stack out of bounds read in webp parser**

A [malformed webp file](https://crashes.fuzzing-project.org/exiv2-stack-oob-read.webp) causes a six bytes stack out of bounds read.

Stack trace:

`==598==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffcc12aa054 at pc 0x0000004fe311 bp 0x7ffcc12a9f90 sp 0x7ffcc12a9740

READ of size 6 at 0x7ffcc12aa054 thread T0

#0 0x4fe310 in __interceptor_memcmp.part.76 (/r/exiv2/exiv2+0x4fe310)

#1 0x8889d0 in Exiv2::WebPImage::getHeaderOffset(unsigned char*, long, unsigned char*, long) /f/exiv2-trunk/src/webpimage.cpp:798:17

#2 0x8889d0 in Exiv2::WebPImage::decodeChunks(unsigned long) /f/exiv2-trunk/src/webpimage.cpp:601

#3 0x884ff2 in Exiv2::WebPImage::readMetadata() /f/exiv2-trunk/src/webpimage.cpp:496:20

#4 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#5 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#6 0x55fb3f in main /f/exiv2-trunk/src/exiv2.cpp:170:25

#7 0x7f7f9cc9f1d0 in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289

#8 0x468979 in _start (/r/exiv2/exiv2+0x468979)

Address 0x7ffcc12aa054 is located in stack of thread T0 at offset 180 in frame

#0 0x885a0f in Exiv2::WebPImage::decodeChunks(unsigned long) /f/exiv2-trunk/src/webpimage.cpp:501

This frame has 13 object(s):

[32, 36) 'size_buff' (line 503)

[48, 64) 'payload' (line 516)

[80, 84) 'size_buf' (line 520)

[96, 100) 'size_buf48' (line 536)

[112, 114) 'size_buf_w' (line 551)

[128, 131) 'size_buf_h' (line 552)

[144, 148) 'size_buf112' (line 568)

[160, 162) 'size_buff152' (line 587)

[176, 180) 'exifLongHeader295' (line 588) <== Memory access at offset 180 overflows this variable

[192, 196) 'exifTiffBEHeader297' (line 591)

[208, 272) 'xmpData' (line 650)

[304, 688) 'temp.lvalue'

[752, 1136) 'temp.lvalue232'

HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext

(longjmp and C++ exceptions are supported)`

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/58-exiv2-multiple-memory-safety-issues.html#comments "0 Comments, 0 Trackbacks")

## [Diving into Control Flow Integrity](/57-Diving-into-Control-Flow-Integrity.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, March 31. 2017

To improve security, modern systems contain many mitigation strategies that try to make it harder to exploit security vulnerabilities. Commonly used strategies include stack canaries, address space layout randomization (ASLR) and nonexecutable memory pages. Unfortunately the Linux distributions have been slow in adopting ASLR, but this is finally changing.

A new set of mitigation technologies has been discussed for a while under the umbrella term "Control Flow Integrity" (CFI). I won't get into technical details, but the very general idea is to add additional checks to the code that prohibit jumps to code parts that are not supposed to happen in the normal operation of a software.

LLVM's Clang compiler supports a form of CFI since version 3.7. Other forms of CFI are available under windows in Visual Studio ([CFGuard](https://msdn.microsoft.com/en-us/library/windows/desktop/mt637065%28v%3Dvs.85%29.aspx)) and with Grsecurity ([RAP](https://grsecurity.net/rap_announce.php)).

Recently I experimented a bit with the Clang version of CFI. It's been one of those situations where you dig into a topic and find out that it's really hard to Google for advice. The information out there is relatively limited: There's the [official LLVM documentation](https://clang.llvm.org/docs/ControlFlowIntegrity.html), a [talk by Kostya Serebryany that briefly mentions CFI in the second half](https://www.youtube.com/watch?v=qTkYDA0En6U) and [two](https://blog.trailofbits.com/2016/10/17/lets-talk-about-cfi-clang-edition/) [blog](https://blog.trailofbits.com/2017/02/20/the-challenges-of-deploying-security-mitigations/) posts by the company Trail of Bits. Also [Chrome is using a subset of the CFI functionality and there's a list of bugs found with it](https://www.chromium.org/developers/testing/control-flow-integrity).

Given the relatively scarce information when starting to use it you will experience situations where things fail and you won't find any help via Google.

So why would you want to use CFI? One possibility would be to create a super-hardened Linux system where, beyond using the "old" exploit mitigations like ASLR, one would also enable CFI. The computational costs of doing so are relatively small (Kostya Serebryany mentions in the talk above that they were unable to measure the CPU cost in Chrome). The executables grow in size and likely use more memory, but not in extraordinary amounts (below 10 percent). So from a performance side this is doable.

I started by compiling some small applications with CFI to see what happens. In some cases they "just work". In most cases I ended up having strange linker errors that were nontrivial to debug. Interesting for Linux distributions: There seems to be no dependency chain that needs to be considered (which is different from many of Clang's Sanitizer features). It's possible to have an executable built with CFI that depends on libraries not using CFI and it's also possible to have libraries using CFI that are used by executables not using CFI. This is good: If we'd strive for our super-hardened Linux we can easily exclude packages that create too many problems or start by including packages where we think they'd profit most from such extra protection.

CFI itself is enabled with the flag *-fsanitize=cfi*. It needs two other compiler and linker flags to work: *-fvisibility=hidden* for the compiler, which hides unnecessary symbols, and *-flto* for the linker to enable Link Time Optimization. The latter one needs the Gold linker, depending on your system you may need to install the LLVM gold plugin. If Gold isn't your default linker you can pass *-fuse-ld=gold*. Furthermore if you want to debug things you want to add *-fno-sanitize-trap=all* and enable extended debugging with *-g*, this will give you useful error messages in case CFI stops your application. (However you probably don't want to do that in production systems, as the error reporting can introduce additional bugs.)

In theory some of these flags only need to be passed to the compiler and others to the linker, but compilation systems aren't always strict in separating those, so we just add all of them to both.

So we can start compiling the current version of curl (7.53.1):
```
./configure CC=clang CXX=clang++ LD=clang CFLAGS="-fsanitize=cfi -fvisibility=hidden -fuse-ld=gold -flto" CXXFLAGS="-fsanitize=cfi -fvisibility=hidden -fuse-ld=gold -flto" LDFLAGS="-fsanitize=cfi -fvisibility=hidden -fuse-ld=gold -flto"

make
```

However we'll end up getting an error when it tries to link to the shared library. I guess it's a libtool problem, but I haven't digged into it. For now we can just disable the shared library by adding *--disable-shared*:
```
./configure CC=clang CXX=clang++ LD=clang CFLAGS="-fsanitize=cfi -fvisibility=hidden -fuse-ld=gold -flto" CXXFLAGS="-fsanitize=cfi -fvisibility=hidden -fuse-ld=gold -flto" LDFLAGS="-fsanitize=cfi -fvisibility=hidden -fuse-ld=gold -flto" --disable-shared
make
```

[0 Comments](/57-Diving-into-Control-Flow-Integrity.html#comments "0 Comments, 1 Trackback")

## [htpasswDoS: Local Denial of Service via Apache httpd password hashes](/56-htpasswDoS-Local-Denial-of-Service-via-Apache-httpd-password-hashes.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Tuesday, January 10. 2017

![Apache logo](/uploads/apache-httpd-logo.png)The way the Apache httpd web server handles password hashes can be abused by a malicious user on a server to cause resource exhaustion and denial of service of the web server. I reported this a while ago to the Apache security team - which led to a lengthy discussion where I was a bit appalled about some of the statements I got from the Apache developers. They can be summed up in a way that major use cases of Apache - especially in web hosting environments - are not recommended by their developers.![](https://ssl-vg03.met.vgwort.de/na/18d199e9596c4bdb82d4b86de95bc498)
Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/56-htpasswDoS-Local-Denial-of-Service-via-Apache-httpd-password-hashes.html#comments "0 Comments, 0 Trackbacks")

## [Fuzzing Irssi with Perl Scripts](/55-Fuzzing-Irssi-with-Perl-Scripts.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, January 6. 2017

When using fuzzing tools like afl a common challenge is how you can pass input to the interesting parts of the application you want to fuzz. In easy situations we have a tool that will accept our input as a file or via stdin. However sometimes this is not easily possible.

Let's have a look at Irssi, an irc chat client. The only input you can pass on the command line is a config file. Fuzzing Irssi 0.8.10 easily led to [a segfault caused by a null pointer access](https://github.com/irssi/irssi/issues/550). However while bugs in config file parsers probably still should be fixed, usually they are not very interesting. (There [can be exceptions](https://blog.fuzzing-project.org/8-Why-it-can-make-sense-to-fuzz-config-files-two-out-of-bounds-vulnerabilities-in-curl-TFPA-0042015.html).)

So what else might be interesting? Irssi does some parsing on all output, e.g. due to [color codes](https://irssi.org/documentation/settings/#a_d). However we can't just print text that is passed via the command line as an input file. We have to abuse Irssi's perl scripting capability for that.

We can place a [simple perl script](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-print.pl) that will read a file (`fuzzp.txt`) and print it into Irssi's autorun directory (default location is ~/.Irssi/scripts/autorun/). We can then place some [examples of Irssi color codes](https://gitlab.com/hanno/irssi-fuzzing/blob/master/irssi-example-colorcodes.txt) into the directory "in/". I have installed an afl/asan-instrumented Irssi into my system to `/usr/local/`, because for running perl scripts it needs more than just the executable. So we can run afl like this:

`afl-fuzz -i in -o out -m none -f fuzzp.txt Irssi`

afl will put the fuzzed output into `fuzzp.txt` and our autoload script will read it from there. Doing this lets us learn that the sequence "%[" causes Irssi to read an invalid memory byte. For reasons unclear to me this only happens if a script outputs this sequence, not if a user types it in. (This issue got [CVE-2017-5196](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5196) assigned.)

We can go further and do a [similar script that executes input as a command](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl). Commands are things like "/QUIT" that control the application and the channel behavior. I named the input file `fuzzc.txt`, so we can place some [simple Irssi commands](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl) into `in/` and run:

`afl-fuzz -i in -o out -m none -f fuzzc.txt Irssi`

Thus we will now fuzz Irssi's command processing.

As we have seen, scripting functionality can be used to fuzz an application. So if you want to fuzz something and don't know how to pass input: See if there's a scripting functionality.

*Irssi has issued a [security advisory for several security vulnerabilities](https://irssi.org/security/irssi_sa_2017_01.txt), including the out of bounds read mentioned above. All vulnerabilities and the config file parser segfault are fixed in 0.8.21 and 1.0.0.*

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/55-Fuzzing-Irssi-with-Perl-Scripts.html#comments "0 Comments, 0 Trackbacks")

## [Update on MatrixSSL miscalculation (CVE-2016-8671, incomplete fix for CVE-2016-6887)](/54-Update-on-MatrixSSL-miscalculation-CVE-2016-8671%2C-incomplete-fix-for-CVE-2016-6887.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Saturday, October 15. 2016

I recently reported how I found [various bugs in the bignum implementation of MatrixSSL](https://blog.fuzzing-project.org/51-Fun-with-Bignums-Crashing-MatrixSSL-and-more.html), some of them leading to remotely exploitable vulnerabilities.

One of the bugs was that the modular exponentiation function - pstm\_exptmod() - produced wrong results for some inputs . This wasn't really fixed, but only worked around by restricting the allowed size of the modulus. Not surprisingly it is still possible to find inputs that cause miscalculations ([code](https://github.com/hannob/bignum-fuzz/blob/master/matrixssl-exptmod-bug-variant2.c)). I reported this to MatrixSSL on August 1st.

Recently MatrixSSL released another update (3.8.6) [fixing several vulnerabilities reported by Craig Young from Tripwire](http://www.tripwire.com/state-of-security/security-data-protection/cyber-security/flawed-matrixssl-code-highlights-need-for-better-iot-update-practices/). However the pstm\_exptmod() bug is still there. (The incomplete fix got assigned [CVE-2016-8671](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8671).)

It is unclear how exploitable such bugs are, but given that it's used in the context of cryptographic functions handling secret key material this is clearly a reason for concern.

MatrixSSL has long advertised itself as a safer alternative to OpenSSL, because it didn't suffer from the same kind of high severity bugs. I think it has been sufficiently shown that this was due to the fact that nobody was looking. But what's more worrying is that bugs they knew about for several months now don't get fixed properly.

[0 Comments](/54-Update-on-MatrixSSL-miscalculation-CVE-2016-8671%2C-incomplete-fix-for-CVE-2016-6887.html#comments "0 Comments, 0 Trackbacks")

## [Out of bounds heap bugs in glib, heap buffer overflow in gnome-session](/53-Out-of-bounds-heap-bugs-in-glib%2C-heap-buffer-overflow-in-gnome-session.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, September 16. 2016

By testing GNOME-related packages with Address Sanitizer I recently discovered several trivial to find bugs.

Two out of bounds bugs in the glib library were uncovered by running the test suite with Address Sanitizer enabled. One heap buffer overflow in the parameter parsing of gnome-session was uncovered by trying to start GNOME. Given that these bugs weren't discovered earlier means that most likely nobody ever used Address Sanitizer to test GNOME components.

I strongly recommend to GNOME and to other software communities to use Address Sanitizer testing in order to improve the quality of their software.

Out of bounds read in g\_unichar\_iswide\_bsearch() / glib

[Upstream bug report](https://bugzilla.gnome.org/show_bug.cgi?id=762493) (again reported [here](https://bugzilla.gnome.org/show_bug.cgi?id=766211))

[Commit / fix](https://git.gnome.org/browse/glib/commit/?id=bcbd8d7)

Fixed in 2.48.2.

Out of bounds read in token\_stream\_prepare() / glib

[Upstream bug report](https://bugzilla.gnome.org/show_bug.cgi?id=762417)

[Commit / fix](https://git.gnome.org/browse/glib/commit/glib/gvariant-parser.c?id=aead1c046dd39748cca449b55ec300ba5f025365)

Fixed in 2.48.0.

Heap buffer overflow in gnome-session

[Upstream bug report](https://bugzilla.gnome.org/show_bug.cgi?id=768441)

[Commit / fix](https://git.gnome.org/browse/gnome-session/commit/?h=gnome-3-20&id=634ab70d9f03b1650be4b8259091ca3036f0fbf9)

Fixed in 3.20.2.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/53-Out-of-bounds-heap-bugs-in-glib%2C-heap-buffer-overflow-in-gnome-session.html#comments "0 Comments, 0 Trackbacks")

## [Multiple vulnerabilities in RPM – and a rant](/52-Multiple-vulnerabilities-in-RPM-and-a-rant.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, August 26. 2016

Last year in November I decided that it might be a good idea to fuzz the parsers of package management tools in Linux distributions. I quickly found a couple of issues in DPKG and RPM. For DPKG the process went very smooth. I reported them to Debian's security team, eight days later fixes and security advisories were published by both Debian and Ubuntu, the main distributions using DPKG. For RPM the process was a bit more difficult.

If you want to report a bug to RPM you first may wonder where to report it. The RPM webpage [1] is a trac installation which has its own bug tracker. However if you try to register an account there you'll get forwarded to an HTTPS site with an expired certificate that doesn't match the domain name. In case you are brave and tell your browser to ignore all warnings you'll be greeted by a broken-looking trac without any CSS. Should you proceed and create an account you will learn that this doesn't help you, because in order to be allowed to report a bug you first have to ask on the mailing list or in the IRC channel for permission [2]. That's probably the point where many well-meaning bug reporters give up.

Okay, but RPM originally stood for “Red Hat package manager” (I've been told that today it stands for RPM Package Manager), so maybe Red Hat feels responsible. So I reported three bugs with sample files triggering them to the Red Hat security team on November 20th. The answer was – to put it mildly – a bit dissatisfying. I'll just fully quote it: “Thanks for the report. We also received about 30+ crash reports in RPM from

a different reporter recently so processing all of them (yours and the

others) will take quite a bit of time. We simply don't have the resources

to spend hours upon hours analyzing all crash reports.”

Okay, so I wasn't the only one fuzzing RPM and the maybe bugs will be fixed some day. I waited. In the meantime I got contacted by another person who also had tried to report fuzzing bugs in RPM and who has made similar experiences (maybe the same person who reported the 30+ crashers, I don't know).

In February I decided to ask what the state of things is. I also gave them a 30 day period until I'd publish the bugs (I know that it's now long past that, I shouldn't have let this issue wait so long). I ended up having a call with a Red Hat security team member and exchanged a couple of mails. I learned that RPM has a Github repository [3], which contains fixes for some (but not all) of the issues I reported, however that's nowhere referenced on its webpage. I then fuzzed the current RPM git code again and found two more issues I also reported to the Red Hat security team.

Status today is that the latest release of RPM on its webpage – 4.12.0.1 - is from July 2015, so all of the bugs still affect this release. However it seems there is an unofficial 4.13 release that's nowhere to be found on the RPM webpage, but Red Hat is using it together with some fixes [4]. And the Github repository says the latest release is 4.12.0, so according to three different sources three different versions are the current one (4.12.0, 4.12.0.1, 4.13).

One of the bugs – a stack overflow (write) - is still present in the latest code on Github.

**Commend and Conclusion**

This blog post probably reads like a big rant about how unprofessional Red Hat is in handling potential security issues. But this is contrary to my usual experience. I often see Red Hat developers being very active in the free software security community and often contributing in a positive way. Quite simply I expect better from Red Hat. This is not some dubious Enterprise vendor where I wouldn't be the least bit surprised of such a reaction.

The development process of RPM seems to be totally chaotic, it's neither clear where one reports bugs nor where one gets the latest code and security bugs don't get fixed within a reasonable time.

There's been some recent events that make me feel especially worried about this: An unknown person has created an entry in the Libarchive issue tracker [5] that points to an anonymous document [6] with a very detailed description of various security weaknesses in the FreeBSD update process (most of them are still unfixed). The most worrying thing about this is however that the anonymous post mentions the existence similar documents affecting multiple Linux distributions. These documents haven't shown up publicly yet and given the unclear nature of this incident it's hard to know whether they ever will become public or exist at all. But this should still be reason enough to have a closer look at potential security vulnerabilities in all pieces of Linux package management systems.

I haven't analyzed the RPM installation process in detail, so I can't say how likely it is that the RPM tool ever sees a malformed input file. It seems downloads happen over HTTP, but the first thing that happens is a signature check. As the signature is part of the RPM file it already needs to be parsed for this. The exact impact of these bugs would require further analysis. But independent of how likely this is I think the parser in such a crucial piece of software should be robust. It should be safe to use the rpm tool to show info about a file on the command line.

[1] <http://rpm.org/>

[2] <http://rpm.org/wiki/ReportingBugs>

[3] <https://github.com/rpm-software-management/rpm>

[4] <http://pkgs.fedoraproject.org/cgit/rpms/rpm.git/diff/rpm-4.13.0-rpmtd-out-of-bounds.patch?h=f22&id=165614f3dd42caa188f78b55e7723dad2900b2f4>

[5] <https://github.com/libarchive/libarchive/issues/743>

[6] <https://gist.github.com/anonymous/e48209b03f1dd9625a992717e7b89c4f>

All bugs were found with the help of american fuzzy lop. Here are the bugs:

Stack Overflow in glob() / rpmglob.c.

Sample file (test with rpm -i [input]):

<https://crashes.fuzzing-project.org/rpm-stackoverflow-glob.rpm>

Unfixed in the current Git code.

Heap out of bounds read in headerVerifyInfo() / header.c.

Sample file (test with “rpm -i [input]”):

<https://crashes.fuzzing-project.org/rpm-heap-oob-read-headerVerifyInfo.rpm>

Git commit:

<https://github.com/rpm-software-management/rpm/commit/8e847d52c811e9a57239e18672d40f781e0ec48e>

Null pointer access / segfault in stringFormat() / formats.c

Sample file (test with “rpm -i [input]”):

<https://crashes.fuzzing-project.org/rpm-nullptr-rpmtdFormat.rpm>

Git commit:

<https://github.com/rpm-software-management/rpm/commit/cddf43a56f19711866371f02f378dc4095b0fadd>

Out of bounds read in rpmtdGetNumber() / rpmtd.c

Sample file (test with “rpm -qi -p -- [input]”)

<https://crashes.fuzzing-project.org/rpm-heap-oob-read-rpmtdGetNumber.rpm>

Git commit:

<https://github.com/rpm-software-management/rpm/commit/b722cf86200505b3e3fcbb2095c4ff61f1f5a2ab>

Finally one annoying thing to admit: In my original report I included another segfault in headerVerifyInfo() with unclear reasons. However I am now unable to reproduce this one. It may be due to compiler options, different command line parameters or dependencies on my system that have changed. For completeness I'm still providing the sample file:

<https://crashes.fuzzing-project.org/rpm-segfault-headerVerifyInfo.rpm>

(Ideally the RPM developers should include all those sample files in a test suite they regularly run against an address sanitizer build of RPM.)

Please also note that I expect this list to be incomplete and there are likely more issues that could be uncovered with further fuzzing. I'll test that once all the existing issues are fixed.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [11 Comments](/52-Multiple-vulnerabilities-in-RPM-and-a-rant.html#comments "11 Comments, 0 Trackbacks")

## [Fun with Bignums: Crashing MatrixSSL and more](/51-Fun-with-Bignums-Crashing-MatrixSSL-and-more.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Sunday, July 31. 2016

If you've been following my fuzzing work you will be aware that I've fuzzed various bignum libraries and found several bugs by comparing implementations against each other.

I recently had a look at the MatrixSSL's modular exponentiation function, for reasons I'll explain later. I wrote [a wrapper, similar to previous experiments, comparing its result to OpenSSL](https://github.com/hannob/bignum-fuzz/blob/master/openssl-vs-matrixssl-modexp.c).

I immediately noted that the pstm\_exptmod() function of MatrixSSL has certain limitations that weren't documented. If one tries to calculate a modular exponentiation with the base equal to the modulus (a^b mod a, [code](https://github.com/hannob/bignum-fuzz/blob/master/matrixssl-base-equals-modulus.c)) it would return an error. If one tries to calculate a modular exponentiation with the base zero (0^b mod a, [code](https://github.com/hannob/bignum-fuzz/blob/master/matrixssl-base-zero.c), [CVE-2016-6885](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6885)) it would crash with an invalid free operation, potentially leading to memory corruption.

In normal cryptographic operations these values should never appear. But these values are in many situations attacker controlled. One situation is during an RSA key exchange. What happens here is that a client encrypts a random secret with the server's key. However a malicious client could simply send a zero or the key's modulus here. I created a [patch against openssl that allows to test this](https://github.com/hannob/bignum-fuzz/blob/master/openssl-break-rsa-values.diff). Both values crash the MatrixSSL server. However the crash seems not to happen in pstm\_exptmod(), it hits another bug earlier ([CVE-2016-6886](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6886)). In both cases the crash happens due to an invalid memory read in the function pstm\_reverse(), which is not prepared for zero-sized inputs and will underflow the len variable.

The crashes [have been fixed in 3.8.4](http://www.matrixssl.org/blog/releases/matrixssl_3_8_4), but the pstm\_exptmod() function still doesn't accept these inputs. However it no longer crashes with a zero base. It may be possible that these issues can be triggered through other code paths. I haven't tested Diffie Hellman key exchanges, which also allows putting attacker-controlled values into a modular exponentiation.

This is an interesting class of bugs. Bignum functions often aren't designed to handle all inputs and only consider values that make sense in the context of the cryptographic operations. However if they are attacker-controlled this may lead to problems. I just discovered a [somewhat similar issue in Nettle](https://lists.lysator.liu.se/pipermail/nettle-bugs/2016/003104.html). They switched their RSA implementation from GMP's mpz\_powm() function to mpz\_powm\_sec(), which is supposed to be sidechannel resistant. However mpz\_powm\_sec() is no drop-in replacement. Unlike mpz\_pown() it doesn't accept even moduli and crashes with a floating point error. Therefore when trying to use a specifically crafted RSA key with an even modulus this will crash. Fortunately this was discovered before the change made it into a release.

But back to MatrixSSL: Independent of these corner case values that lead to failures I was able to identify an input value that caused a wrong calculation result ([code](https://github.com/hannob/bignum-fuzz/blob/master/matrixssl-exptmod-bug.c),[CVE-2016-6887](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6887).

There's a particularly severe risk with calculation errors in the modulo exponentiation when it comes to the RSA algorithm. A common way to speed up the calculation of RSA signatures is an algorithm based on the chinese remainder theorem (CRT) that splits it up into two smaller calculations. However if one of these calculations goes wrong an attacker can learn the private key. Last year [Florian Weimer observed that various devices had this error](https://access.redhat.com/blogs/766093/posts/1976703) and he could extract their keys. He recently mentioned on the [oss-security mailing list that he also observed this in devices using MatrixSSL](http://www.openwall.com/lists/oss-security/2016/06/27/1).

The way the MatrixSSL team "fixed" the miscalculation issue is not really satisfying: They now restrict the input to the pstm\_exptmod() function to a set of bit sizes (512, 1024, 1536, 2048, 3072, 4096). My test input had a different bit size, therefore I cannot reproduce the miscalculation any more, but the underlying bug is most likely still there. I've tried to find inputs matching these restrictions and still causing wrong results, but without success yet. Independent of that the restriction means that connections to sites with unusual key sizes or Diffie Hellman moduli will no longer work. While they are not common, there is no rule that RSA keys or Diffie Hellman moduli need to have certain sizes.

Despite the fact that the bug may be still there the CRT attack will probably no longer work. A protection mechanism against that was implemented in version 3.8.3.

I got told by the MatrixSSL developers that their bignum code is based on libtommath. Therefore I also checked if the same bugs appeared there. That wasn't the case. The test input causing wrong results in MatrixSSL were correctly calculated by libtommath and it was also capable of correctly using a zero base or a base equal to the modulus.

[0 Comments](/51-Fun-with-Bignums-Crashing-MatrixSSL-and-more.html#comments "0 Comments, 1 Trackback")

## [Use after free in my\_login() function of DBD::mysql (Perl module)](/50-Use-after-free-in-my_login-function-of-DBDmysql-Perl-module.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Monday, July 25. 2016

DBD::mysql versions 4.033 and earlier have a use after free bug in the my\_login() function. DBD::mysql is a Perl module providing bindings to the mysql database. The issue was fixed in version 4.034.

This issue was discovered with Address Sanitizer.

[Pull request / patch](https://github.com/perl5-dbi/DBD-mysql/pull/45)

[CVE-2015-8949](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8949)

[0 Comments](/50-Use-after-free-in-my_login-function-of-DBDmysql-Perl-module.html#comments "0 Comments, 0 Trackbacks")

## Pagination

* Page 1 of 5, totaling 64 entries
* [next page →](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck/P2.html)

## Sidebar

### The Fuzzing Project

You may want to go [back to the Fuzzing Project's main page](https://fuzzing-project.org/) or [software list](https://fuzzing-project.org/software/).

### Archives

* [January 2025](/archives/2025/01.html "January 2025")
* [December 2024](/archives/2024/12.html "December 2024")
* [November 2024](/archives/2024/11.html "November 2024")
* [Recent...](/index.php?frontpage)
* [Older...](https://blog.fuzzing-project.org/archive)

### Categories

* [![XML](/templates/2k11/img/xml.gif)](/feeds/categories/1-advisories.rss) [advisories](/categories/1-advisories)

### Syndicate This Blog

* [![XML](/templates/2k11/img/subtome.png)](https://blog.fuzzing-project.org/feeds/index.rss2)
* [![XML](/templates/2k11/img/xml.gif)](https://blog.fuzzing-project.org/feeds/comments.rss2)
  [Comments](https://blog.fuzzing-project.org/feeds/comments.rss2)

Powered by [Serendipity](http://s9y.org) & the *2k11* theme.



=== Content from www.openwall.com_c1941a30_20250125_034706.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[thread-next>]](13) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20160309202145.0273729d@pc1>
Date: Wed, 9 Mar 2016 20:21:45 +0100
From: Hanno Böck <hanno@...eck.de>
To: oss-security@...ts.openwall.com, cve-assign@...re.org
Subject: Heap use after free in Pidgin-OTR plugin

<https://blog.fuzzing-project.org/39-Heap-use-after-free-in-Pidgin-OTR-plugin.html>

The pidgin-otr plugin version 4.0.2 fixes a heap use after free error.
The bug is triggered when a user tries to authenticate a buddy and
happens in the function create_smp_dialog.

The bug was discovered with Address Sanitizer. This is yet another
example why all C/C++ code should be tested with Address Sanitizer
enabled.

This bug was already independently discovered and reported in the otr
bug tracker.
<https://bugs.otr.im/issues/88>

Independend of this bug another more severe bug in Libotr itself was
also disclosed today, please make sure you update both libotr (4.1.1)
and the pidgin-otr plugin (4.0.2).
<https://www.x41-dsec.de/lab/advisories/x41-2016-001-libotr/>

Upstream bug report (contains Address Sanitizer stack trace):
<https://bugs.otr.im/issues/128>
Commit / fix:
<https://bugs.otr.im/projects/pidgin-otr/repository/revisions/aaf551b9dd5cbba8c4abaa3d4dc7ead860efef94>

--
Hanno Böck
<https://hboeck.de/>

mail/jabber: hanno@...eck.de
GPG: BBB51E42

Content of type "application/pgp-signature" skipped

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.opensuse.org_bf34742d_20250125_034704.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR/#J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR)

# openSUSE-SU-2016:0878-1: moderate: Security update for pidgin-otr

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

24 Mar
2016

24 Mar
'16

14:10

openSUSE Security Update: Security update for pidgin-otr
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2016:0878-1
Rating: moderate
References: #970498
Cross-References: CVE-2015-8833
Affected Products:
openSUSE Leap 42.1
openSUSE 13.2
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This update to pidgin-otr 4.0.2 fixes the following issue:
- CVE-2015-8833: use-after-free issue during SMP (boo#970498)
It also contains new and updated translations.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE Leap 42.1:
zypper in -t patch openSUSE-2016-397=1
- openSUSE 13.2:
zypper in -t patch openSUSE-2016-397=1
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE Leap 42.1 (i586 x86\_64):
pidgin-otr-4.0.2-7.1
pidgin-otr-debuginfo-4.0.2-7.1
pidgin-otr-debugsource-4.0.2-7.1
- openSUSE 13.2 (i586 x86\_64):
pidgin-otr-4.0.2-7.8.1
pidgin-otr-debuginfo-4.0.2-7.8.1
pidgin-otr-debugsource-4.0.2-7.8.1
References:
<https://www.suse.com/security/cve/CVE-2015-8833.html>
<https://bugzilla.suse.com/970498>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR/#J3ISRTN4P4MA4LQLU23VCNNHLDLDJDKR)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.suse.com_b305f4fd_20250126_054654.html ===


| Bugzilla – Bug 970498 | VUL-0: CVE-2015-8833: pidgin-otr: heap use after free vulnerability | Last modified: 2017-04-03 16:04:49 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D970498)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 970498**](show_bug.cgi?id=970498)
(CVE-2015-8833)
- VUL-0: CVE-2015-8833: pidgin-otr: heap use after free vulnerability

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2015-8833: pidgin-otr: heap use after free vulnerability

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-8833 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/163005/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv2:RedHat:CVE-2015-8833:5.0:(AV:N... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-03-10 14:45 UTC by Victor Pereira | | --- | --- | | Modified: | 2017-04-03 16:04 UTC ([History](show_activity.cgi?id=970498)) | | CC List: | 7 users (show)  astieger badshah400 fcrozat fezhang smash\_bz sreeves zaitor | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=970498) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=970498&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=970498&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=970498#c0)  Victor Pereira   2016-03-10 14:45:57 UTC  ``` rh#1316427  The pidgin-otr plugin version 4.0.2 fixes a heap use after free error. The bug is triggered when a user tries to authenticate a buddy and happens in the function create_smp_dialog.  External references:  <https://blog.fuzzing-project.org/39-Heap-use-after-free-in-Pidgin-OTR-plugin.html> <http://seclists.org/oss-sec/2016/q1/572>  Upstream bug report:  <https://bugs.otr.im/issues/88>  Upstream fix:  <https://bugs.otr.im/projects/pidgin-otr/repository/revisions/aaf551b9dd5cbba8c4abaa3d4dc7ead860efef94>  References: <https://bugzilla.redhat.com/show_bug.cgi?id=1316427> <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-8833> <http://seclists.org/oss-sec/2016/q1/577> ``` [Comment 1](show_bug.cgi?id=970498#c1)  Swamp Workflow Management   2016-03-10 23:00:42 UTC  ``` bugbot adjusting priority ``` [Comment 2](show_bug.cgi?id=970498#c2)  Bjørn Lie   2016-03-14 10:00:50 UTC  ``` [https://build.opensuse.org/patchinfo/show/openSUSE:Maintenance:4811/patchinfo](https://build.opensuse.org/patchinfo/show/openSUSE%3AMaintenance%3A4811/patchinfo)  For Leap and 13.2 ``` [Comment 4](show_bug.cgi?id=970498#c4)  Scott Reeves   2016-03-21 21:21:29 UTC  ``` <https://build.suse.de/request/show/104549> for SLE12.  SLE11 is not vulnerable as it does not perform the check for a different context in create_smp_dialog ``` [Comment 5](show_bug.cgi?id=970498#c5)  Swamp Workflow Management   2016-03-24 14:11:05 UTC  ``` openSUSE-SU-2016:0878-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 970498 CVE References: CVE-2015-8833 Sources used: openSUSE Leap 42.1 (src):    pidgin-otr-4.0.2-7.1 openSUSE 13.2 (src):    pidgin-otr-4.0.2-7.8.1 ``` [Comment 6](show_bug.cgi?id=970498#c6)  Marcus Meissner   2016-03-30 14:31:59 UTC  ``` released ``` [Comment 7](show_bug.cgi?id=970498#c7)  Swamp Workflow Management   2016-04-01 11:03:21 UTC  ``` SUSE-SU-2016:0912-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 970498 CVE References: CVE-2015-8833 Sources used: SUSE Linux Enterprise Workstation Extension 12-SP1 (src):    pidgin-otr-4.0.0-8.1 SUSE Linux Enterprise Workstation Extension 12 (src):    pidgin-otr-4.0.0-8.1 SUSE Linux Enterprise Desktop 12-SP1 (src):    pidgin-otr-4.0.0-8.1 SUSE Linux Enterprise Desktop 12 (src):    pidgin-otr-4.0.0-8.1  Product List: SUSE Linux Enterprise Workstation Extension 12-SP1 SUSE Linux Enterprise Workstation Extension 12 SUSE Linux Enterprise Desktop 12-SP1 SUSE Linux Enterprise Desktop 12 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=970498)
* - [XML](show_bug.cgi?ctype=xml&id=970498)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=970498)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D970498)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from security.gentoo.org_0f83b752_20250125_034708.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libotr, Pidgin OTR: Remote execution of arbitrary code — GLSA **201701-10**

Multiple vulnerabilities have been found in libotr and Pidgin OTR,
allowing remote attackers to execute arbitrary code.

### Affected packages

| Package | **net-libs/libotr** on all architectures |
| --- | --- |
| Affected versions | < **4.1.1** |
| Unaffected versions | >= **4.1.1** |

| Package | **x11-plugins/pidgin-otr** on all architectures |
| --- | --- |
| Affected versions | < **4.0.2** |
| Unaffected versions | >= **4.0.2** |

### Background

Pidgin Off-the-Record (OTR) messaging allows you to have private
conversations over instant messaging. libotr is a portable off-the-record
messaging library.

### Description

Multiple vulnerabilities exist in both libotr and Pidgin OTR. Please
review the CVE identifiers for more information.

### Impact

A remote attacker could send a specially crafted message, possibly
resulting in the execution of arbitrary code with the privileges of the
process, or cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libotr users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-libs/libotr-4.1.1"

```

All Pidgin OTR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=x11-plugins/pidgin-otr-4.0.2"

```
### References

* [CVE-2015-8833](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8833)
* [CVE-2016-2851](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2851)

**Release date**

January 02, 2017

**Latest revision**

January 02, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [576914](https://bugs.gentoo.org/show_bug.cgi?id=576914)
* [576916](https://bugs.gentoo.org/show_bug.cgi?id=576916)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from fuzzing-project.org_71481b52_20250126_054652.html ===

The Fuzzing Project - Background

[The Fuzzing Project](/)

* [tutorials](tutorials.html)* [background](background.html)* [resources](resources.html)* [faq](faq.html)* [links](links.html)* [about](about.html)

* [blog / advisories](https://blog.fuzzing-project.org/)

### The Fuzzing Project

![american fuzzy lop](afl500.png)

Fuzzing is a powerful strategy to find bugs in software. The idea
is quite simple: Generate a large number of randomly malformed inputs
for a software to parse and see what happens. If the program crashes then
something is likely wrong.
While fuzzing is a well-known strategy, it is surprisingly easy
to find bugs, often with security implications, in widely used software.

Memory access errors are the errors most likely to be exposed when fuzzing software that is written in C/C++.
While they differ in the details (stack overflow,
heap overflow, use after free, ...), the core problem is often the same:
A software reads or writes to wrong memory locations.

A modern Linux or BSD system ships a large number of basic tools that
do some kind of file displaying and parsing.
In their current state most of these tools are not suitable for
untrusted inputs.

On the other hand we have powerful tools these days that allow us
to find and analyze these bugs, notably the fuzzing tool
american fuzzy lop
and the Address Sanitizer feature of gcc and clang.

The Fuzzing Project is trying to improve the state of things. I
maintain
some helpful pointers how you can join the effort to improve
the state of security in free software.

[![CC0](cc-zero.png)](https://creativecommons.org/publicdomain/zero/1.0/)

The Fuzzing Project is run by [Hanno Böck](https://hboeck.de/)



=== Content from www.debian.org_968ce1cd_20250125_034705.html ===


---

[[Date Prev](msg00100.html)][[Date Next](msg00102.html)]
[[Thread Prev](msg00100.html)][[Thread Next](msg00102.html)]
[[Date Index](maillist.html#00101)]
[[Thread Index](threads.html#00101)]

# [SECURITY] [DSA 3528-1] pidgin-otr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3528-1] pidgin-otr security update
* *From*: Sebastien Delafond <seb@debian.org>
* *Date*: Wed, 23 Mar 2016 18:43:12 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1ainkO-000202-UE%40seger.debian.org) [E1ainkO-000202-UE@seger.debian.org](msg00101.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3528-1                   security@debian.org
<https://www.debian.org/security/>                       Sebastien Delafond
March 23, 2016                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : pidgin-otr
CVE ID         : CVE-2015-8833

Stefan Sperling discovered that pidgin-otr, a Pidgin plugin
implementing Off-The-Record messaging, contained a use-after-free
bug. This could be used by a malicious remote user to intentionally
crash the application, thus causing a denial-of-service.

For the stable distribution (jessie), this problem has been fixed in
version 4.0.1-1+deb8u1.

For the testing (stretch) and unstable (sid) distributions, this
problem has been fixed in version 4.0.2-1.

We recommend that you upgrade your pidgin-otr packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQEcBAEBCgAGBQJW8uGEAAoJEBC+iYPz1Z1kBF0H/1gE8G6ptO3rkGNP6ezKf2G/
+jBnkzKNGoUzj9lx4q4Vgo65REQfgSkupV7rL8BJTHR64/sz148ih2Itwg5spnVN
JgxmBlFR6J0e6x7yAwWxFJD3Y5sgwj5amvRQzzeDgcX4tSjozKeebYLRv4bdXlYK
ObdbMqd7pBrrMrSPVujj0I1OvecPM8FIc8g6c/E9kBuLAIInfsAfKQ164kuVu73P
k4DKM5RdTS1JyPHNQHzHzRRGGQE4a81ewWTxZlXKVlEe2O8pdMp0+qNX7woP3kfX
hagzorYUcqe1u31Bvi61wnLxY5Cx683tn1sitgPo1Pm1SXqnQed4ci3Yr5+p3PE=
=jPMs
-----END PGP SIGNATURE-----

```

---



=== Content from blog.fuzzing-project.org_a09b5e7f_20250125_034706.html ===

[Skip to content](#content)
[# The Fuzzing Project

Blog and Advisories](https://blog.fuzzing-project.org/)

Quicksearch

## Navigation

* [Back to main page](https://fuzzing-project.org/)
* [Software list](https://fuzzing-project.org/software.html)

## [Heap use after free in Pidgin-OTR plugin (CVE-2015-8833)](/39-Heap-use-after-free-in-Pidgin-OTR-plugin-CVE-2015-8833.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Wednesday, March 9. 2016

The pidgin-otr plugin version 4.0.2 fixes a heap use after free error. The bug is triggered when a user tries to authenticate a buddy and happens in the function create\_smp\_dialog.

The bug was discovered with Address Sanitizer. This is yet another example why all C/C++ code should be tested with Address Sanitizer enabled.

This bug was already independently discovered and reported by Stefan Sperling [in the otr bug tracker](https://bugs.otr.im/issues/88).

Independend of this bug another [more severe bug in Libotr itself was also disclosed today](https://www.x41-dsec.de/lab/advisories/x41-2016-001-libotr/), please make sure you update both libotr (4.1.1) and the pidgin-otr plugin (4.0.2).

[Upstream bug report (contains Address Sanitizer stack trace)](https://bugs.otr.im/issues/128)

[Commit / fix](https://bugs.otr.im/projects/pidgin-otr/repository/revisions/aaf551b9dd5cbba8c4abaa3d4dc7ead860efef94)

[CVE-2015-8833](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8833)

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/39-Heap-use-after-free-in-Pidgin-OTR-plugin-CVE-2015-8833.html#comments "0 Comments, 0 Trackbacks")

### Trackbacks

[Trackback specific URI for this entry](https://blog.fuzzing-project.org/comment.php?type=trackback&entry_id=39 "This link is not meant to be clicked. It contains the trackback URI for this entry. You can use this URI to send ping- & trackbacks from your own blog to this entry. To copy the link, right click and select \"Copy Shortcut\" in Internet Explorer or \"Copy Link Location\" in Mozilla.")

No Trackbacks

### Comments

Display comments as
[Linear](/index.php?url=39-Heap-use-after-free-in-Pidgin-OTR-plugin-CVE-2015-8833.html&serendipity%5Bcview%5D=linear#comments) | Threaded

No comments

### Add Comment

Name

Email

Homepage

Comment

In reply to
[ Top level ]

Phone\*

What is eight plus zero?

Enclosing asterisks marks text as bold (\*word\*), underscore are made via \_word\_.Standard emoticons like :-) and ;-) are converted to images.E-Mail addresses will not be displayed and will only be used for E-Mail notifications.

To prevent automated Bots from commentspamming, please enter the string you see in the image below in the appropriate input box. Your comment will only be submitted if the strings match. Please ensure that your browser supports and accepts cookies, or your comment cannot be verified correctly.
![CAPTCHA](https://blog.fuzzing-project.org/plugin/captcha_9a732cd4a46a47a5b8695a09e2908159 "Enter the string you see here in the input box!")
Enter the string from the spam-prevention image above:

Form options
Remember Information?

Subscribe to this entry

## Sidebar

### The Fuzzing Project

You may want to go [back to the Fuzzing Project's main page](https://fuzzing-project.org/) or [software list](https://fuzzing-project.org/software/).

### Archives

* [January 2025](/archives/2025/01.html "January 2025")
* [December 2024](/archives/2024/12.html "December 2024")
* [November 2024](/archives/2024/11.html "November 2024")
* [Recent...](/index.php?frontpage)
* [Older...](https://blog.fuzzing-project.org/archive)

### Categories

* [![XML](/templates/2k11/img/xml.gif)](/feeds/categories/1-advisories.rss) [advisories](/categories/1-advisories)

### Syndicate This Blog

* [![XML](/templates/2k11/img/subtome.png)](https://blog.fuzzing-project.org/feeds/index.rss2)
* [![XML](/templates/2k11/img/xml.gif)](https://blog.fuzzing-project.org/feeds/comments.rss2)
  [Comments](https://blog.fuzzing-project.org/feeds/comments.rss2)

Powered by [Serendipity](http://s9y.org) & the *2k11* theme.



=== Content from www.debian.org_2c992b25_20250126_054652.html ===

[![Debian](../Pics/openlogo-50.png)](../ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

[Security Information](./)
/
Debian security FAQ

# Debian security FAQ

1. [I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?](#buthow)- [The signature on your advisories does not verify correctly!](#signature)- [How is security handled in Debian?](#handling)- [Why are you fiddling with an old version of that package?](#oldversion)- [The version number for a package indicates that I am still running a vulnerable version!](#version)- [I received an advisory, but the build for one processor architecture seems to be missing.](#archismissing)- [How is security handled for unstable?](#unstable)- [How is security handled for testing?](#testing)- [How is security handled for contrib, non-free and non-free-firmware?](#contrib)- [The advisory says unstable is fixed in version 1.2.3-1, but unstable has 1.2.5-1, what's up?](#sidversionisold)- [Why are there no official mirrors for security.debian.org?](#mirror)- [I've seen DSA 100 and DSA 102, now where is DSA 101?](#missing)- [How can I reach the security team?](#contact)- [I guess I found a security problem, what should I do?](#discover)- [What am I supposed to do with a security problem in one of my packages?](#care)- [I tried to download a package listed in one of the security advisories, but I got a `file not found' error.](#enofile)- [I've got a bugfix, can I upload to security.debian.org directly?](#upload)- [I've got a bugfix, can I upload to proposed-updates instead?](#ppu)- [I'm pretty sure my packages are fine, how can I upload them?](#SecurityUploadQueue)- [How can I help with security?](#help)- [What is the scope of proposed-updates?](#proposed-updates)- [How is the security team composed?](#composing)- [How long will security updates be provided?](#lifespan)- [How can I check the integrity of packages?](#check)- [What to do if a random package breaks after a security update?](#break)- [What is a CVE identifier?](#cvewhat)- [Does Debian issue a DSA for every CVE id?](#cvedsa)- [Can Debian assign CVE identifiers?](#cveget)- [Does Debian have a vulnerability disclosure policy?](#disclosure-policy)- [Our vulnerability management tool has shown that the following issues are open (list of CVEs with random CVSS scores). When are those going to be fixed?](#cve-severity-assessment)- [What does local (remote) mean?](#localremote)

*Q: I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?*

A: As the DSA mail says, you should upgrade the packages affected by the
announced vulnerability. You can do this by just upgrading (after
updating the list of available packages with apt-get update)
every package in your system with apt-get upgrade or by
upgrading just a particular package, with apt-get install
*package*.

The announcement mail mentions the source package in which the vulnerability
was present. Therefore, you should update all the binary packages from
that source package. To check the binary packages to update, visit
https://packages.debian.org/src:*source-package-name* and
click on *[show ... binary packages]* for the distribution you
are updating.

It may also be necessary to restart a service or a running process. The
command [checkrestart](https://manpages.debian.org/checkrestart)
included in the package
[debian-goodies](https://packages.debian.org/debian-goodies)
might help to find which ones.

*Q: The signature on your advisories does not verify correctly!*

A: This is most likely a problem on your end. The
[debian-security-announce](https://lists.debian.org/debian-security-announce/)
list has a filter that only allows messages with a correct signature
from one of the security team members to be posted.

Most likely some piece of mail software on your end slightly changes
the message that breaks the signature. Make sure your software does
not do any MIME encoding or decoding, or tab/space conversions.

Known culprits are fetchmail (with the mimedecode option enabled),
formail (from procmail 3.14 only) and evolution.

*Q: How is security handled in Debian?*

A: Once the security team receives a notification of an incident,
one or more members review it and consider its impact on the stable
release of Debian (i.e. if it's vulnerable or not).
If our system is vulnerable, we work on a fix for the
problem. The package maintainer is contacted as well, if they didn't
contact the security team already. Finally, the fix is tested and
new packages are prepared, which are then compiled on all stable
architectures and uploaded afterwards. After all of that is done,
an advisory is published.

*Q: Why are you fiddling with an old version of that package?*

The most important guideline when making a new package that fixes a
security problem is to make as few changes as possible. Our users and
developers are relying on the exact behaviour of a release once it is made,
so any change we make can possibly break someone's system. This is
especially true in case of libraries: make sure you never change the
Application Program Interface (API) or Application Binary Interface (ABI),
no matter how small the change is.

This means that moving to a new upstream version is not a good solution,
instead the relevant changes should be backported. Generally upstream
maintainers are willing to help if needed, if not the Debian security team
might be able to help.

In some cases it is not possible to backport a security fix, for example
when large amounts of source code need to be modified or rewritten. If that
happens it might be necessary to move to a new upstream version, but this
has to be coordinated with the security team beforehand.

*Q: The version number for a package indicates that I am still running
a vulnerable version!*

A: Instead of upgrading to a new release we backport security fixes to
the version that was shipped in the stable release. The reason we do
this is to make sure that a release changes as little as possible
so things will not change or break unexpectedly as a result of a
security fix. You can check if you are running a secure version of
a package by looking at the package changelog, or comparing its
exact version number with the version indicated in the Debian
Security Advisory.

*Q: I received an advisory, but the build for one
processor architecture seems to be missing.*

A: Generally the Security Team releases an advisory with builds of the updated
packages for all architectures that Debian supports. However, some architectures
are slower than others and it may happen that builds for most architectures
are ready while some are still missing. These smaller archs represent a small
fraction of our user base. Depending on the urgency of the issue
we may decide to release the advisory forthwith. The missing builds will be
installed as soon as they come available, but no further notice of this will
be given. Of course we will never release an advisory where the i386 or amd64
builds are not present.

*Q: How is security handled for unstable?*

A: Security for unstable is primarily handled by package maintainers, not
by the Debian Security Team. Although the security team may upload
high-urgency security-only fixes when maintainers are noticed to be
inactive, support for stable will always have priority.
If you want to have a secure (and stable) server you are strongly encouraged
to stay with stable.

*Q: How is security handled for testing?*

A: Security for testing benefits from the security efforts of the entire
project for unstable. However, there is a minimum two-day migration delay,
and sometimes security fixes can be held up by transitions. The Security
Team helps to move along those transitions holding back important
security uploads, but this is not always possible and delays may occur.
Especially in the months after a new stable release, when many new versions
are uploaded to unstable, security fixes for testing may lag behind.
If you want to have a secure (and stable) server you are strongly
encouraged to stay with stable.

*Q: How is security handled for contrib,
non-free and non-free-firmware?*

A: The short answer is: it's not. Contrib, non-free and non-free-firmware aren't official
parts of the Debian Distribution and are not released, and thus not
supported by the security team. Some non-free packages are distributed
without source or without a license allowing the distribution of modified
versions. In those cases no security fixes can be made at all. If it
is possible to fix the problem, and the package maintainer or someone else
provides correct updated packages, then the security team will generally
process them and release an advisory.

*Q: The advisory says unstable is fixed in
version 1.2.3-1, but unstable has 1.2.5-1, what's up?*

A: We try to list the first version in unstable that fixed the problem.
Sometimes the maintainer has uploaded even newer versions in the meantime.
Compare the version in unstable with the version we indicate. If it's the
same or higher, you should be safe from this vulnerability. If you want to
be sure, you can check the package changelog with apt-get changelog
package-name and search for the entry announcing the fix.

*Q: Why are there no official mirrors for security.debian.org?*

A: Actually, there are. There are several official mirrors, implemented
through DNS aliases. The purpose of security.debian.org is to make security
updates available as quickly and easily as possible.

Encouraging the use of unofficial mirrors would add extra complexity
that is usually not needed and that can cause frustration if these
mirrors are not kept up to date.

*Q: I've seen DSA 100 and DSA 102, now where is DSA 101?*

A: Several vendors (mostly of GNU/Linux, but also of BSD
derivatives) coordinate security advisories for some incidents and
agree to a particular timeline so that all vendors are able to
release an advisory at the same time. This was decided in order to
not discriminate some vendors that need more time (e.g. when the
vendor has to pass packages through lengthy QA tests or has to
support several architectures or binary distributions). Our own
security team also prepares advisories in advance. Every now and
then, other security issues have to be dealt with before the parked
advisory could be released, and hence temporarily leaving out one or
more advisories by number.

*Q: How can I reach the security team?*

A: Security information can be sent to security@debian.org or
team@security.debian.org, both of which are read by the members of
the security team.

If desired, email can be encrypted with the Debian Security
Contact key (key ID [0x0D59D2B15144766A14D241C66BAF400B05C3E651](https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x0d59d2b15144766a14d241c66baf400b05c3e651)). For the OpenPGP keys of individual team members, please
refer to the [keyring.debian.org](https://keyring.debian.org/)
keyserver.

*Q: I guess I found a security problem, what should I do?*

A: If you learn about a security problem, either in one of your own
packages or in someone else's please always contact the security team. If
the Debian security team confirms the vulnerability and other vendors are
likely to be vulnerable as well, they usually contact other vendors as
well. If the vulnerability is not yet public they will try to coordinate
security advisories with the other vendors, so all major distributions are
in sync.

If the vulnerability is already publicly known, be sure to file a bug
report in the Debian BTS, and tag it security.

If you are a Debian maintainer, [see below](#care).

*Q: What am I supposed to do with a security problem in one of
my packages?*

A: If you learn of a security problem, either in your package or
someone else's please always contact the security team via email at
team@security.debian.org. They keep track
of outstanding security problems, can help maintainers with
security problems or fix problems on their own, are responsible for
sending out security advisories and maintaining
security.debian.org.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

It's particularly important that you don't upload to any other
distribution other than unstable without prior agreement by the
security team, because bypassing them will cause confusion and more
work.

*Q: I tried to download a package listed in one of the security
advisories, but I got a `file not found' error.*

A: Whenever a newer bugfix supersedes an older package on
security.debian.org, chances are high that the old package will be
removed by the time the new one gets installed. Hence, you'll get
this `file not found' error. We don't want to distribute packages
with known security bugs longer than absolutely necessary.

Please use the packages from the latest security advisories, which are
distributed through the [debian-security-announce](https://lists.debian.org/debian-security-announce/) mailing list. It's best to simply run
`apt-get update` before upgrading the package.

*Q: I've got a bugfix, can I upload to security.debian.org directly?*

A: No, you can't. The archive at security.debian.org is maintained
by the security team, who have to approve all packages. You should
instead send patches or proper source packages to the security team
via team@security.debian.org. They will be
reviewed by the security team and eventually uploaded, either with
or without modifications.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I've got a bugfix, can I upload to proposed-updates instead?*

A: Technically speaking, you can. However, you should not do this,
since this interferes badly with the work of the security team.
Packages from security.debian.org will be copied into the
proposed-updates directory automatically. If a package with the
same or a higher version number is already installed into the
archive, the security update will be rejected by the archive
system. That way, the stable distribution will end up without a
security update for this package instead, unless the wrong
packages in the proposed-updates directory were rejected. Please contact the
security team instead and include all details of the vulnerability
and attach the source files (i.e. diff.gz and dsc files) to your mail.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I'm pretty sure my packages are fine,
how can I upload them?*

A: If you are very sure that your packages don't break anything, that the
version is sane (i.e. greater than the version in stable and less than the
version in testing/unstable), that you didn't change the behaviour of the
package, despite the corresponding security problem, that you compiled it
for the correct distribution (that is `oldstable-security` or
`stable-security`), that the package contains the original
source if the package is new on security.debian.org, that you can confirm
the patch against the most recent version is clean and only touches the
corresponding security problem (check with `interdiff -z` and
both `.diff.gz` files), that you have proofread the patch at
least thrice, and that `debdiff` doesn't display any changes,
you may upload the files into the incoming directory
`ftp://ftp.security.upload.debian.org/pub/SecurityUploadQueue` on the
security.debian.org directly. Please send a notification with all details
and links to team@security.debian.org as well.

*Q: How can I help with security?*

A: Please review each problem before reporting it to
security@debian.org. If you are able to provide patches, that
would speed up the process. Do not simply forward bugtraq mails,
because we already receive them — but do provide us with
additional information about things reported on bugtraq.

A good way to get started with security work is helping
out on the Debian Security Tracker ([instructions](https://security-tracker.debian.org/tracker/data/report)).

*Q: What is the scope of proposed-updates?*

A: This directory contains packages which are proposed to enter the
next revision of Debian stable. Whenever packages are uploaded by
a maintainer for the stable distribution, they end up in the
proposed-updates directory. Since stable is meant to be stable, no
automatic updates are made. The security team will upload fixed
packages mentioned in their advisories to stable, however they will
be placed in proposed-updates first. Every couple of months the
Stable Release Manager checks the list of packages in
proposed-updates and discusses whether a package is suited for
stable or not. This is compiled into another revision of stable
(e.g. 2.2r3 or 2.2r4). Packages that don't fit will probably be
rejected and dropped from proposed-updates as well.

Note that the packages uploaded by maintainers (not by the security team)
in the proposed-updates/ directory are not supported by the security
team.

*Q: How is the security team composed?*

A: The Debian security team consists of
[several officers and secretaries](../intro/organization#security).
The security team itself appoints people to join the team.

*Q: How long will security updates be provided?*

A: The security team will support a stable distribution for
three years after its release. It is not possible to support three
distributions; supporting two simultaneously is already difficult
enough.

*Q: How can I check the integrity of packages?*

A: This process involve checking the Release file signature against
the [public key](https://ftp-master.debian.org/keys.html) used for the archive. The Release file contains the
checksums of Packages and Sources files, which contain
checksums of binary and source packages. Detailed instruction on how
to check packages integrity can be found in the [Debian Securing Manual](../doc/manuals/securing-debian-howto/ch7#s-deb-pack-sign).

*Q: What to do if a random package breaks after a security update?*

A: First of all, you should figure out why the package breaks and
how it is connected to the security update, then contact the
security team if it is serious or the stable release manager if it
is less serious. We're talking about random packages that break
after a security update of a different package. If you can't
figure out what's going wrong but have a correction, talk to the
security team as well. You may be redirected to the stable release
manager though.

*Q: What is a CVE identifier?*

A: The Common Vulnerabilities and Exposures project assignes
unique names, called CVE identifiers, to specific security
vulnerabilities, to make it easier to uniquely refer to a specific
issue. More information can be found at [Wikipedia](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures).

*Q: Does Debian issue a DSA for every CVE id?*

A: The Debian security team keeps track of every issued CVE identifier,
connect it to the relevant Debian package and assess its impact in a
Debian context - the fact that something is assigned a CVE id does not
necessarily imply that the issue is a serious threat to a Debian system.
This information is tracked in the
[Debian Security Tracker](https://security-tracker.debian.org)
and for the issues that are considered serious a Debian Security Advisory
will be issued.

Low-impact issues not qualifying for a DSA can be fixed in the next
release of Debian, in a point release of the current stable or oldstable
distributions, or are included in a DSA when that is being issued for a
more serious vulnerability.

*Q: Can Debian assign CVE identifiers?*

A: Debian is a CVE Numbering Authority and can assign ids, but per
CVE policy only to yet-undisclosed issues. If you have an undisclosed
security vulnerability for software in Debian and would like to get an
identifier for it, contact the Debian Security Team. For cases where the
vulnerability is already public, we advise to follow the procedure
detailed in the [CVE OpenSource Request HOWTO](https://github.com/RedHatProductSecurity/CVE-HOWTO).

*Q: Does Debian have a vulnerability disclosure policy?*

A: Debian has published a [vulnerability
disclosure policy](disclosure-policy) as part of its participation in the CVE
program.

*Q: Our vulnerability management tool
has shown that the following issues are open (list of CVEs with random CVSS
scores). When are those going to be fixed?*

A: Debian does not provide CVSS scores and doesn't use CVSS scores from
external sources when triaging security issues.

You can check the state of every single CVE ID in the Debian Security Tracker by accessing
it by [ID](https://security-tracker.debian.org/tracker/CVE-ID).

The "Notes" section will contain additional information, e.g. that a security issue doesn't
warrant a Debian security update, but might get fixed in a subsequent point release.

A list of packages for which a Security update is planned can be found at the
[dsa-needed list](https://salsa.debian.org/security-tracker-team/security-tracker/raw/master/data/dsa-needed.txt).

If you find an error in triage data, you're very welcome to report it. The Debian Security Team will
however not generally react to requests asking for more specific information, you should instead contact
the vendor of your vulnerability management tool, after all they are the ones who alerted you about a
security issue and not Debian.

# Deprecated Debian security FAQ

*Q: What does local (remote) mean?*

**The field *Problem type* in DSA mails is not used since April 2014.**

A: Some advisories cover vulnerabilities that cannot be identified
with the classic scheme of local and remote exploitability. Some
vulnerabilities cannot be exploited from remote, i.e. don't
correspond to a daemon listening to a network port. If they can be
exploited by special files that could be provided via the network
while the vulnerable service is not permanently connected with the
network, we write local (remote) in such cases.

Such vulnerabilities are somewhat between local and remote
vulnerabilities and often cover archives that could be provided
through the network, e.g. as mail attachment or from a download
page.

---

Back to the [Debian Project homepage](../).

---

This page is also available in the following languages:
Select your language
dansk
Deutsch
español
français
Italiano
Nederlands
polski
Português
suomi
svenska
Русский (Russkij)
中文(简)
中文(HK)
中文(繁)
日本語 (Nihongo)

How to set [the default document language](../intro/cn)

---

**[Home](/)**

* [About](../intro/about)
  + [Social Contract](../social_contract)
  + [Code of Conduct](../code_of_conduct)
  + [Free Software](../intro/free)
  + [Legal Info](../legal)
* [Help Debian](../intro/help)

* [Getting Debian](../distrib/)
  + [Network install](../distrib/netinst)
  + [CD/USB ISO images](../CD/)
  + [Pure Blends](../blends/)
  + [Debian Packages](../distrib/packages)
  + [Developers' Corner](../devel/)

* [News](../News/)
  + [Project News](../News/weekly/)
  + [Events](../events/)
* [Documentation](../doc/)
  + [Release Info](../releases/)
  + [Debian Wiki](https://wiki.debian.org/)

* [Support](../support)
  + [Debian International](../international/)
  + [Security Information](../security/)
  + [Bug reports](../Bugs/)
  + [Mailing Lists](../MailingLists/)

* [Site map](../sitemap)
* [Search](https://search.debian.org/)
* [The Debian Blog](https://bits.debian.org)
* [Debian Micronews](https://micronews.debian.org)
* [Debian Planet](https://planet.debian.org)

See our [contact page](../contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Fri, Oct 6 21:55:11 UTC 2023

Last Built: Sat, Jan 11 19:35:55 UTC 2025

Copyright © 1997-2023 [SPI](https://www.spi-inc.org/) and others; See [license terms](../license)

Debian is a registered [trademark](../trademark) of Software in the Public Interest, Inc.



=== Content from fuzzing-project.org_cea1a41d_20250126_054652.html ===

The Fuzzing Project - apps

[The Fuzzing Project](/)

* [tutorials](tutorials.html)* [background](background.html)* [resources](resources.html)* [faq](faq.html)* [links](links.html)* [about](about.html)

* [blog / advisories](https://blog.fuzzing-project.org/)

I'm no longer maintaining this list, as it was extremely outdated.

[![CC0](cc-zero.png)](https://creativecommons.org/publicdomain/zero/1.0/)

The Fuzzing Project is run by [Hanno Böck](https://hboeck.de/)



=== Content from lists.opensuse.org_1fb4215e_20250125_034703.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM/#O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM)

# [security-announce] SUSE-SU-2016:0912-1: important: Security update for pidgin-otr

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

30 Mar
2016

30 Mar
'16

18:07

SUSE Security Update: Security update for pidgin-otr
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2016:0912-1
Rating: important
References: #970498
Cross-References: CVE-2015-8833
Affected Products:
SUSE Linux Enterprise Workstation Extension 12-SP1
SUSE Linux Enterprise Workstation Extension 12
SUSE Linux Enterprise Desktop 12-SP1
SUSE Linux Enterprise Desktop 12
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This update for pidgin-otr fixes the following issues:
- CVE-2015-8833: A heap based use-after-free issue was fixed in pidgin-otr
that could lead to crashes or potential code execution.
Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Workstation Extension 12-SP1:
zypper in -t patch SUSE-SLE-WE-12-SP1-2016-523=1
- SUSE Linux Enterprise Workstation Extension 12:
zypper in -t patch SUSE-SLE-WE-12-2016-523=1
- SUSE Linux Enterprise Desktop 12-SP1:
zypper in -t patch SUSE-SLE-DESKTOP-12-SP1-2016-523=1
- SUSE Linux Enterprise Desktop 12:
zypper in -t patch SUSE-SLE-DESKTOP-12-2016-523=1
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Workstation Extension 12-SP1 (x86\_64):
pidgin-otr-4.0.0-8.1
pidgin-otr-debuginfo-4.0.0-8.1
pidgin-otr-debugsource-4.0.0-8.1
- SUSE Linux Enterprise Workstation Extension 12 (x86\_64):
pidgin-otr-4.0.0-8.1
pidgin-otr-debuginfo-4.0.0-8.1
pidgin-otr-debugsource-4.0.0-8.1
- SUSE Linux Enterprise Desktop 12-SP1 (x86\_64):
pidgin-otr-4.0.0-8.1
pidgin-otr-debuginfo-4.0.0-8.1
pidgin-otr-debugsource-4.0.0-8.1
- SUSE Linux Enterprise Desktop 12 (x86\_64):
pidgin-otr-4.0.0-8.1
pidgin-otr-debuginfo-4.0.0-8.1
pidgin-otr-debugsource-4.0.0-8.1
References:
<https://www.suse.com/security/cve/CVE-2015-8833.html>
<https://bugzilla.suse.com/970498>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM/#O6HCLTBUUI2SBGF3MJNSTTXXW4NUTJVM)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from lists.cypherpunks.ca_bcc76c7f_20250125_034707.html ===

# [OTR-users] New releases of libotr (4.1.1) and pidgin-otr (4.0.2) available

**Ian Goldberg**
ian at cypherpunks.ca

*Wed Mar 9 13:01:41 EST 2016*

* Previous message: [[OTR-users] Security Advisory: upgrade to libotr 4.1.1](002581.html)
* **Messages sorted by:**
  [[ date ]](date.html#2582)
  [[ thread ]](thread.html#2582)
  [[ subject ]](subject.html#2582)
  [[ author ]](author.html#2582)

---

```
Security update: libotr version 4.1.1

Versions 4.1.0 and earlier of libotr in 64-bit builds contain an integer
overflow security flaw. This flaw could potentially be exploited by a
remote attacker to cause a heap buffer overflow and subsequently for
arbitrary code to be executed on the user's machine.

CVE-2016-2851 has been assigned to this issue.

Please upgrade to libotr version 4.1.1 immediately.

Users of libotr packages in Linux and *BSD distributions should see
updated packages shortly.

This security release includes the following updates:

 - Fix an integer overflow bug that can cause a heap buffer overflow
   (and from there remote code execution) on 64-bit platforms
 - Fix possible free() of an uninitialized pointer
 - Be stricter about parsing v3 fragments
 - Add a testsuite ("make check" to run it), but only on Linux for now,
   since it uses Linux-specific features such as epoll
 - Fix a memory leak when reading a malformed instance tag file
 - Protocol documentation clarifications

pidgin-otr version 4.0.2 released

This point release includes the following updates:

 - Fix use-after-free issue during SMP
 - Updated Spanish, German, Norwegian BokmÃ¥l translations
 - New Danish translation
 - The Windows binary has been linked with updated versions of libotr,
   libgcrypt, libgpg-error, and other supporting libraries

Thanks,

   - Ian

```

---

* Previous message: [[OTR-users] Security Advisory: upgrade to libotr 4.1.1](002581.html)
* **Messages sorted by:**
  [[ date ]](date.html#2582)
  [[ thread ]](thread.html#2582)
  [[ subject ]](subject.html#2582)
  [[ author ]](author.html#2582)

---

[More information about the OTR-users
mailing list](http://lists.cypherpunks.ca/mailman/listinfo/otr-users)



=== Content from www.suse.com_f2cc3c90_20250126_054654.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2015-8833.html)
[English](https://www.suse.com/security/cve/CVE-2015-8833.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2015-8833.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2015-8833.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2015-8833.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2015-8833.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2015-8833.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2015-8833.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2015-8833

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2015-8830.html) [[Index]](index.html) [[Next]](CVE-2015-8835.html)

### Upstream information

[CVE-2015-8833 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8833)

#### Description

Use-after-free vulnerability in the create\_smp\_dialog function in gtk-dialog.c in the Off-the-Record Messaging (OTR) pidgin-otr plugin before 4.0.2 for Pidgin allows remote attackers to execute arbitrary code via vectors related to the "Authenticate buddy" menu item.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [important](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database | SUSE |
| Base Score | 10 | 7.5 |
| Vector | AV:N/AC:L/Au:N/C:C/I:C/A:C | AV:N/AC:L/Au:N/C:P/I:P/A:P |
| Access Vector | Network | Network |
| Access Complexity | Low | Low |
| Authentication | None | None |
| Confidentiality Impact | Complete | Partial |
| Integrity Impact | Complete | Partial |
| Availability Impact | Complete | Partial |

SUSE Bugzilla entry: [970498](https://bugzilla.suse.com/show_bug.cgi?id=970498) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [SUSE-SU-2016:0912-1](https://lists.suse.com/pipermail/sle-security-updates/2016-March/001974.html), published Wed Mar 30 12:07:21 MDT 2016
openSUSE-SU-2016:0878-1
### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| SUSE Linux Enterprise Desktop 12 SP1 | * `pidgin-otr >= 4.0.0-8.1` | Patchnames: SUSE-SLE-DESKTOP-12-SP1-2016-523SUSE-SLE-WE-12-SP1-2016-523 |
| SUSE Linux Enterprise Desktop 12 SP2 | * `pidgin-otr >= 4.0.0-11.6` | Patchnames: SUSE Linux Enterprise Desktop 12 SP2 GA pidgin-otr-4.0.0-11.6SUSE Linux Enterprise Workstation Extension 12 SP2 GA pidgin-otr-4.0.0-11.6 |
| SUSE Linux Enterprise Desktop 12 SP3 | * `pidgin-plugin-otr >= 4.0.2-1.29` | Patchnames: SUSE Linux Enterprise Desktop 12 SP3 GA pidgin-plugin-otr-4.0.2-1.29SUSE Linux Enterprise Workstation Extension 12 SP3 GA pidgin-plugin-otr-4.0.2-1.29 |
| SUSE Linux Enterprise Desktop 12 SP4 | * `pidgin-plugin-otr >= 4.0.2-1.29` | Patchnames: SUSE Linux Enterprise Desktop 12 SP4 GA pidgin-plugin-otr-4.0.2-1.29SUSE Linux Enterprise Workstation Extension 12 SP4 GA pidgin-plugin-otr-4.0.2-1.29 |
| SUSE Linux Enterprise Desktop 12 | * `pidgin-otr >= 4.0.0-8.1` | Patchnames: SUSE-SLE-DESKTOP-12-2016-523SUSE-SLE-WE-12-2016-523 |
| SUSE Linux Enterprise Desktop 15 SP1 SUSE Linux Enterprise Server 15 SP1 SUSE Linux Enterprise Server for SAP Applications 15 SP1 SUSE Linux Enterprise Workstation Extension 15 SP1 | * `pidgin-plugin-otr >= 4.0.2-1.61` * `pidgin-plugin-otr-lang >= 4.0.2-1.61` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 SP1 GA pidgin-plugin-otr-4.0.2-1.61 |
| SUSE Linux Enterprise Desktop 15 SP2 SUSE Linux Enterprise Server 15 SP2 SUSE Linux Enterprise Server for SAP Applications 15 SP2 SUSE Linux Enterprise Workstation Extension 15 SP2 | * `pidgin-plugin-otr >= 4.0.2-1.61` * `pidgin-plugin-otr-lang >= 4.0.2-1.61` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 SP2 GA pidgin-plugin-otr-4.0.2-1.61 |
| SUSE Linux Enterprise Desktop 15 SP3 SUSE Linux Enterprise Server 15 SP3 SUSE Linux Enterprise Server for SAP Applications 15 SP3 SUSE Linux Enterprise Workstation Extension 15 SP3 | * `pidgin-plugin-otr >= 4.0.2-1.61` * `pidgin-plugin-otr-lang >= 4.0.2-1.61` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 SP3 GA pidgin-plugin-otr-4.0.2-1.61 |
| SUSE Linux Enterprise Desktop 15 SP4 SUSE Linux Enterprise Server 15 SP4 SUSE Linux Enterprise Server for SAP Applications 15 SP4 SUSE Linux Enterprise Workstation Extension 15 SP4 | * `pidgin-plugin-otr >= 4.0.2-1.61` * `pidgin-plugin-otr-lang >= 4.0.2-1.61` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 SP4 GA pidgin-plugin-otr-4.0.2-1.61 |
| SUSE Linux Enterprise Desktop 15 SUSE Linux Enterprise Server 15 SUSE Linux Enterprise Server for SAP Applications 15 SUSE Linux Enterprise Workstation Extension 15 | * `pidgin-plugin-otr >= 4.0.2-1.61` * `pidgin-plugin-otr-lang >= 4.0.2-1.61` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 GA pidgin-plugin-otr-4.0.2-1.61 |
| SUSE Linux Enterprise Server 12 SP1 SUSE Linux Enterprise Server for SAP Applications 12 SP1 SUSE Linux Enterprise Workstation Extension 12 SP1 | * `pidgin-otr >= 4.0.0-8.1` | Patchnames: SUSE-SLE-WE-12-SP1-2016-523 |
| SUSE Linux Enterprise Server 12 SP2 SUSE Linux Enterprise Server for SAP Applications 12 SP2 SUSE Linux Enterprise Workstation Extension 12 SP2 | * `pidgin-otr >= 4.0.0-11.6` | Patchnames: SUSE Linux Enterprise Workstation Extension 12 SP2 GA pidgin-otr-4.0.0-11.6 |
| SUSE Linux Enterprise Server 12 SP3 SUSE Linux Enterprise Server for SAP Applications 12 SP3 SUSE Linux Enterprise Workstation Extension 12 SP3 | * `pidgin-plugin-otr >= 4.0.2-1.29` | Patchnames: SUSE Linux Enterprise Workstation Extension 12 SP3 GA pidgin-plugin-otr-4.0.2-1.29 |
| SUSE Linux Enterprise Server 12 SP4 SUSE Linux Enterprise Server for SAP Applications 12 SP4 SUSE Linux Enterprise Workstation Extension 12 SP4 | * `pidgin-plugin-otr >= 4.0.2-1.29` | Patchnames: SUSE Linux Enterprise Workstation Extension 12 SP4 GA pidgin-plugin-otr-4.0.2-1.29 |
| SUSE Linux Enterprise Server 12 SP5 SUSE Linux Enterprise Server for SAP Applications 12 SP5 SUSE Linux Enterprise Workstation Extension 12 SP5 | * `pidgin-plugin-otr >= 4.0.2-1.29` | Patchnames: SUSE Linux Enterprise Workstation Extension 12 SP5 GA pidgin-plugin-otr-4.0.2-1.29 |
| SUSE Linux Enterprise Server 12 SUSE Linux Enterprise Server for SAP Applications 12 SUSE Linux Enterprise Workstation Extension 12 | * `pidgin-otr >= 4.0.0-8.1` | Patchnames: SUSE-SLE-WE-12-2016-523 |
| openSUSE Tumbleweed | * `pidgin-otr >= 4.0.2-1.5` * `pidgin-plugin-otr >= 4.0.2-3.18` * `pidgin-plugin-otr-lang >= 4.0.2-3.18` | Patchnames: openSUSE-Tumbleweed-2024-10258openSUSE-Tumbleweed-2024-11173 |

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products under Long Term Service Pack support and receiving important and critical security fixes. | | |
| SUSE Linux Enterprise Server 12 SP5 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Server for SAP Applications 12 SP5 | pidgin-otr | Already fixed |
| Products past their end of life and not receiving proactive updates anymore. | | |
| SUSE Linux Enterprise Desktop 11 SP2 | pidgin-otr | Not affected |
| SUSE Linux Enterprise Desktop 11 SP3 | pidgin-otr | Not affected |
| SUSE Linux Enterprise Desktop 11 SP4 | pidgin-otr | Not affected |
| SUSE Linux Enterprise Desktop 12 | pidgin-otr | Released |
| SUSE Linux Enterprise Desktop 12 SP1 | pidgin-otr | Released |
| SUSE Linux Enterprise Desktop 12 SP3 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Desktop 12 SP4 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Server 12 | pidgin-otr | Released |
| SUSE Linux Enterprise Server 12 SP1 | pidgin-otr | Released |
| SUSE Linux Enterprise Server 12 SP3 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Server 12 SP4 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Server for SAP Applications 12 | pidgin-otr | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 SP1 | pidgin-otr | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 SP3 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Server for SAP Applications 12 SP4 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Workstation Extension 12 | pidgin-otr | Released |
| SUSE Linux Enterprise Workstation Extension 12 SP1 | pidgin-otr | Released |
| SUSE Linux Enterprise Workstation Extension 12 SP3 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Workstation Extension 12 SP4 | pidgin-otr | Already fixed |
| SUSE Linux Enterprise Workstation Extension 12 SP5 | pidgin-otr | Already fixed |

---

### SUSE Timeline for this CVE

CVE page created: Thu Mar 10 00:45:51 2016

CVE page last modified: Fri Nov 1 12:08:05 2024

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from blog.fuzzing-project.org_cde374c2_20250126_054653.html ===
xml version="1.0" encoding="iso-8859-1"?
1
Danger Will Robinson, trackback failed.


=== Content from blog.fuzzing-project.org_aa07fcf2_20250126_054653.html ===

[Skip to content](#content)
[# The Fuzzing Project

Blog and Advisories](https://blog.fuzzing-project.org/)

Quicksearch

## Navigation

* [Back to main page](https://fuzzing-project.org/)
* [Software list](https://fuzzing-project.org/software.html)

## [Stack buffer overflow in WolfSSL before 3.13.0](/63-Stack-buffer-overflow-in-WolfSSL-before-3.13.0.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Saturday, March 24. 2018

During some tests of TLS libraries I found a stack buffer overflow vulnerability in the WolfSSL library.

Finding this one was surprisingly simple: I had a wolfssl server that was compiled with address sanitizer and ran the SSL Labs test against it.

The bug happens in the parsing of the signature hash algorithm list that is sent in a ClientHello and is basically a textbook stack buffer overflow. WolfSSL simply tries to store that in an array with 32 elements. If one sends more than 32 hash algorithms it overflows.

With the SSL Labs scan the bug only causes WolfSSL to terminate if it's compiled with address sanitizer, but if one sends a very large list of hash algorithms it also crashes in a normal compile. In situations where WolfSSL is used without ASLR this bug is probably trivially exploitable.

I have created a simple [bash proof of concept](https://github.com/hannob/wolfoverflow) (using netcat and xxd) that crashes a WolfSSL server.

The bug was fixed in [this commit](https://github.com/wolfSSL/wolfssl/pull/1231/commits/9f7e40ad5c8097ff38d7caff4a9989db260981cc) and in version 3.13.0 of WolfSSL.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/63-Stack-buffer-overflow-in-WolfSSL-before-3.13.0.html#comments "0 Comments, 0 Trackbacks")

## [Optionsbleed - HTTP OPTIONS method can leak Apache's server memory](/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Monday, September 18. 2017

[![optionsbleed](/uploads/optionsbleed.serendipityThumb.png)](/uploads/optionsbleed.png)If you're using the HTTP protocol in everday Internet use you are usually only using two of its methods: GET and POST. However HTTP has a number of other methods, so I wondered what you can do with them and if there are any vulnerabilities.![](https://ssl-vg03.met.vgwort.de/na/cebfb3b02359461ab9ecf10beb28e327)
Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [16 Comments](/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html#comments "16 Comments, 2 Trackbacks")

## [exiv2: multiple memory safety issues](/58-exiv2-multiple-memory-safety-issues.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Monday, July 3. 2017

*This post first appeared on [oss-security](http://www.openwall.com/lists/oss-security/2017/06/30/1).*

I'm reporting three issues here in exiv2, a parser libary for image metadata. These are only examples, exiv2 is full of memory safety bugs that can trivially be found by running afl with asan for a few hours.

I have not reported those issues upstream. When I previously tried to report bugs in exiv2 found via fuzzing the upstream author made it clear to me that he has little interest in fixing those issues and doesn't consider his software suitable to parse defect files (which basically means it's unsuitable for untrusted input). The [discussion can be read here](http://dev.exiv2.org/issues/1248). (the page is sometimes not available, searching for it in the google cache usually works though)

exiv2 is to my knowledge used by the major Linux Desktops GNOME and KDE. I'll also inform their security teams. I leave it up to Linux distros how to handle this, but it certainly is problematic that a crucial parser used by major desktop applications is not interested in fixing potential security issues.

**Heap overflow (write) in tiff parser**

A [malformed tiff file](https://crashes.fuzzing-project.org/exiv2-heap-oob-write.tiff) can cause a one byte heap overflow in exiv2.

Stack trace:

`==22873==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000df1 at pc 0x000000842091 bp 0x7fff51b3ee70 sp 0x7fff51b3ee68

WRITE of size 1 at 0x602000000df1 thread T0

#0 0x842090 in Exiv2::ul2Data(unsigned char*, unsigned int, Exiv2::ByteOrder) /f/exiv2-trunk/src/types.cpp:362:20

#1 0x68beac in long Exiv2::toData<unsigned int>(unsigned char*, unsigned int, Exiv2::ByteOrder) /f/exiv2-trunk/src/../include/exiv2/value.hpp:1459:16

#2 0x68beac in Exiv2::ValueType<unsigned int>::copy(unsigned char*, Exiv2::ByteOrder) const /f/exiv2-trunk/src/../include/exiv2/value.hpp:1612

#3 0x6742b2 in Exiv2::Exifdatum::copy(unsigned char*, Exiv2::ByteOrder) const /f/exiv2-trunk/src/exif.cpp:362:48

#4 0x7f794d in Exiv2::TiffImage::readMetadata() /f/exiv2-trunk/src/tiffimage.cpp:204:18

#5 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#6 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#7 0x55fb3f in main /f/exiv2-trunk/src/exiv2.cpp:170:25

#8 0x7f91c1e571d0 in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289

#9 0x468979 in _start (/r/exiv2/exiv2+0x468979)

0x602000000df1 is located 0 bytes to the right of 1-byte region [0x602000000df0,0x602000000df1)

allocated by thread T0 here:

#0 0x55af00 in operator new[](unsigned long) (/r/exiv2/exiv2+0x55af00)

#1 0x83fadf in Exiv2::DataBuf::alloc(long) /f/exiv2-trunk/src/types.cpp:158:22`

**Heap out of bounds read in jp2 / JPEG2000 parser**

A [malformed jpeg2000 file](https://crashes.fuzzing-project.org/exiv2-heap-oob-read.jp2) causes a (large) out of bounds read.

Stack trace:

`==32038==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f5e099e6838 at pc 0x00000050f22c bp 0x7ffdf7f3dcd0 sp 0x7ffdf7f3d480

READ of size 808464432 at 0x7f5e099e6838 thread T0

#0 0x50f22b in __asan_memcpy (/r/exiv2/exiv2+0x50f22b)

#1 0x6e82bc in Exiv2::Jp2Image::readMetadata() /f/exiv2-trunk/src/jp2image.cpp:277:29

#2 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#3 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#4 0x55fb3f in main /f/exiv2-trunk/src/exiv2.cpp:170:25

#5 0x7f5e130a71d0 in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289

#6 0x468979 in _start (/r/exiv2/exiv2+0x468979)

0x7f5e099e6838 is located 0 bytes to the right of 808452152-byte region [0x7f5dd96e6800,0x7f5e099e6838)

allocated by thread T0 here:

#0 0x55af00 in operator new[](unsigned long) (/r/exiv2/exiv2+0x55af00)

#1 0x6e8176 in Exiv2::DataBuf::DataBuf(long) /f/exiv2-trunk/src/../include/exiv2/types.hpp:204:46

#2 0x6e8176 in Exiv2::Jp2Image::readMetadata() /f/exiv2-trunk/src/jp2image.cpp:273

#3 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#4 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#5 0x7f5e130a71d0 in

__libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289`

**Stack out of bounds read in webp parser**

A [malformed webp file](https://crashes.fuzzing-project.org/exiv2-stack-oob-read.webp) causes a six bytes stack out of bounds read.

Stack trace:

`==598==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffcc12aa054 at pc 0x0000004fe311 bp 0x7ffcc12a9f90 sp 0x7ffcc12a9740

READ of size 6 at 0x7ffcc12aa054 thread T0

#0 0x4fe310 in __interceptor_memcmp.part.76 (/r/exiv2/exiv2+0x4fe310)

#1 0x8889d0 in Exiv2::WebPImage::getHeaderOffset(unsigned char*, long, unsigned char*, long) /f/exiv2-trunk/src/webpimage.cpp:798:17

#2 0x8889d0 in Exiv2::WebPImage::decodeChunks(unsigned long) /f/exiv2-trunk/src/webpimage.cpp:601

#3 0x884ff2 in Exiv2::WebPImage::readMetadata() /f/exiv2-trunk/src/webpimage.cpp:496:20

#4 0x59786a in Action::Print::printSummary() /f/exiv2-trunk/src/actions.cpp:289:16

#5 0x596ef8 in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /f/exiv2-trunk/src/actions.cpp:244:44

#6 0x55fb3f in main /f/exiv2-trunk/src/exiv2.cpp:170:25

#7 0x7f7f9cc9f1d0 in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.24-r2/work/glibc-2.24/csu/../csu/libc-start.c:289

#8 0x468979 in _start (/r/exiv2/exiv2+0x468979)

Address 0x7ffcc12aa054 is located in stack of thread T0 at offset 180 in frame

#0 0x885a0f in Exiv2::WebPImage::decodeChunks(unsigned long) /f/exiv2-trunk/src/webpimage.cpp:501

This frame has 13 object(s):

[32, 36) 'size_buff' (line 503)

[48, 64) 'payload' (line 516)

[80, 84) 'size_buf' (line 520)

[96, 100) 'size_buf48' (line 536)

[112, 114) 'size_buf_w' (line 551)

[128, 131) 'size_buf_h' (line 552)

[144, 148) 'size_buf112' (line 568)

[160, 162) 'size_buff152' (line 587)

[176, 180) 'exifLongHeader295' (line 588) <== Memory access at offset 180 overflows this variable

[192, 196) 'exifTiffBEHeader297' (line 591)

[208, 272) 'xmpData' (line 650)

[304, 688) 'temp.lvalue'

[752, 1136) 'temp.lvalue232'

HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext

(longjmp and C++ exceptions are supported)`

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/58-exiv2-multiple-memory-safety-issues.html#comments "0 Comments, 0 Trackbacks")

## [htpasswDoS: Local Denial of Service via Apache httpd password hashes](/56-htpasswDoS-Local-Denial-of-Service-via-Apache-httpd-password-hashes.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Tuesday, January 10. 2017

![Apache logo](/uploads/apache-httpd-logo.png)The way the Apache httpd web server handles password hashes can be abused by a malicious user on a server to cause resource exhaustion and denial of service of the web server. I reported this a while ago to the Apache security team - which led to a lengthy discussion where I was a bit appalled about some of the statements I got from the Apache developers. They can be summed up in a way that major use cases of Apache - especially in web hosting environments - are not recommended by their developers.![](https://ssl-vg03.met.vgwort.de/na/18d199e9596c4bdb82d4b86de95bc498)
Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/56-htpasswDoS-Local-Denial-of-Service-via-Apache-httpd-password-hashes.html#comments "0 Comments, 0 Trackbacks")

## [Fuzzing Irssi with Perl Scripts](/55-Fuzzing-Irssi-with-Perl-Scripts.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, January 6. 2017

When using fuzzing tools like afl a common challenge is how you can pass input to the interesting parts of the application you want to fuzz. In easy situations we have a tool that will accept our input as a file or via stdin. However sometimes this is not easily possible.

Let's have a look at Irssi, an irc chat client. The only input you can pass on the command line is a config file. Fuzzing Irssi 0.8.10 easily led to [a segfault caused by a null pointer access](https://github.com/irssi/irssi/issues/550). However while bugs in config file parsers probably still should be fixed, usually they are not very interesting. (There [can be exceptions](https://blog.fuzzing-project.org/8-Why-it-can-make-sense-to-fuzz-config-files-two-out-of-bounds-vulnerabilities-in-curl-TFPA-0042015.html).)

So what else might be interesting? Irssi does some parsing on all output, e.g. due to [color codes](https://irssi.org/documentation/settings/#a_d). However we can't just print text that is passed via the command line as an input file. We have to abuse Irssi's perl scripting capability for that.

We can place a [simple perl script](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-print.pl) that will read a file (`fuzzp.txt`) and print it into Irssi's autorun directory (default location is ~/.Irssi/scripts/autorun/). We can then place some [examples of Irssi color codes](https://gitlab.com/hanno/irssi-fuzzing/blob/master/irssi-example-colorcodes.txt) into the directory "in/". I have installed an afl/asan-instrumented Irssi into my system to `/usr/local/`, because for running perl scripts it needs more than just the executable. So we can run afl like this:

`afl-fuzz -i in -o out -m none -f fuzzp.txt Irssi`

afl will put the fuzzed output into `fuzzp.txt` and our autoload script will read it from there. Doing this lets us learn that the sequence "%[" causes Irssi to read an invalid memory byte. For reasons unclear to me this only happens if a script outputs this sequence, not if a user types it in. (This issue got [CVE-2017-5196](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5196) assigned.)

We can go further and do a [similar script that executes input as a command](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl). Commands are things like "/QUIT" that control the application and the channel behavior. I named the input file `fuzzc.txt`, so we can place some [simple Irssi commands](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl) into `in/` and run:

`afl-fuzz -i in -o out -m none -f fuzzc.txt Irssi`

Thus we will now fuzz Irssi's command processing.

As we have seen, scripting functionality can be used to fuzz an application. So if you want to fuzz something and don't know how to pass input: See if there's a scripting functionality.

*Irssi has issued a [security advisory for several security vulnerabilities](https://irssi.org/security/irssi_sa_2017_01.txt), including the out of bounds read mentioned above. All vulnerabilities and the config file parser segfault are fixed in 0.8.21 and 1.0.0.*

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/55-Fuzzing-Irssi-with-Perl-Scripts.html#comments "0 Comments, 0 Trackbacks")

## [Out of bounds heap bugs in glib, heap buffer overflow in gnome-session](/53-Out-of-bounds-heap-bugs-in-glib%2C-heap-buffer-overflow-in-gnome-session.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, September 16. 2016

By testing GNOME-related packages with Address Sanitizer I recently discovered several trivial to find bugs.

Two out of bounds bugs in the glib library were uncovered by running the test suite with Address Sanitizer enabled. One heap buffer overflow in the parameter parsing of gnome-session was uncovered by trying to start GNOME. Given that these bugs weren't discovered earlier means that most likely nobody ever used Address Sanitizer to test GNOME components.

I strongly recommend to GNOME and to other software communities to use Address Sanitizer testing in order to improve the quality of their software.

Out of bounds read in g\_unichar\_iswide\_bsearch() / glib

[Upstream bug report](https://bugzilla.gnome.org/show_bug.cgi?id=762493) (again reported [here](https://bugzilla.gnome.org/show_bug.cgi?id=766211))

[Commit / fix](https://git.gnome.org/browse/glib/commit/?id=bcbd8d7)

Fixed in 2.48.2.

Out of bounds read in token\_stream\_prepare() / glib

[Upstream bug report](https://bugzilla.gnome.org/show_bug.cgi?id=762417)

[Commit / fix](https://git.gnome.org/browse/glib/commit/glib/gvariant-parser.c?id=aead1c046dd39748cca449b55ec300ba5f025365)

Fixed in 2.48.0.

Heap buffer overflow in gnome-session

[Upstream bug report](https://bugzilla.gnome.org/show_bug.cgi?id=768441)

[Commit / fix](https://git.gnome.org/browse/gnome-session/commit/?h=gnome-3-20&id=634ab70d9f03b1650be4b8259091ca3036f0fbf9)

Fixed in 3.20.2.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/53-Out-of-bounds-heap-bugs-in-glib%2C-heap-buffer-overflow-in-gnome-session.html#comments "0 Comments, 0 Trackbacks")

## [Multiple vulnerabilities in RPM – and a rant](/52-Multiple-vulnerabilities-in-RPM-and-a-rant.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, August 26. 2016

Last year in November I decided that it might be a good idea to fuzz the parsers of package management tools in Linux distributions. I quickly found a couple of issues in DPKG and RPM. For DPKG the process went very smooth. I reported them to Debian's security team, eight days later fixes and security advisories were published by both Debian and Ubuntu, the main distributions using DPKG. For RPM the process was a bit more difficult.

If you want to report a bug to RPM you first may wonder where to report it. The RPM webpage [1] is a trac installation which has its own bug tracker. However if you try to register an account there you'll get forwarded to an HTTPS site with an expired certificate that doesn't match the domain name. In case you are brave and tell your browser to ignore all warnings you'll be greeted by a broken-looking trac without any CSS. Should you proceed and create an account you will learn that this doesn't help you, because in order to be allowed to report a bug you first have to ask on the mailing list or in the IRC channel for permission [2]. That's probably the point where many well-meaning bug reporters give up.

Okay, but RPM originally stood for “Red Hat package manager” (I've been told that today it stands for RPM Package Manager), so maybe Red Hat feels responsible. So I reported three bugs with sample files triggering them to the Red Hat security team on November 20th. The answer was – to put it mildly – a bit dissatisfying. I'll just fully quote it: “Thanks for the report. We also received about 30+ crash reports in RPM from

a different reporter recently so processing all of them (yours and the

others) will take quite a bit of time. We simply don't have the resources

to spend hours upon hours analyzing all crash reports.”

Okay, so I wasn't the only one fuzzing RPM and the maybe bugs will be fixed some day. I waited. In the meantime I got contacted by another person who also had tried to report fuzzing bugs in RPM and who has made similar experiences (maybe the same person who reported the 30+ crashers, I don't know).

In February I decided to ask what the state of things is. I also gave them a 30 day period until I'd publish the bugs (I know that it's now long past that, I shouldn't have let this issue wait so long). I ended up having a call with a Red Hat security team member and exchanged a couple of mails. I learned that RPM has a Github repository [3], which contains fixes for some (but not all) of the issues I reported, however that's nowhere referenced on its webpage. I then fuzzed the current RPM git code again and found two more issues I also reported to the Red Hat security team.

Status today is that the latest release of RPM on its webpage – 4.12.0.1 - is from July 2015, so all of the bugs still affect this release. However it seems there is an unofficial 4.13 release that's nowhere to be found on the RPM webpage, but Red Hat is using it together with some fixes [4]. And the Github repository says the latest release is 4.12.0, so according to three different sources three different versions are the current one (4.12.0, 4.12.0.1, 4.13).

One of the bugs – a stack overflow (write) - is still present in the latest code on Github.

**Commend and Conclusion**

This blog post probably reads like a big rant about how unprofessional Red Hat is in handling potential security issues. But this is contrary to my usual experience. I often see Red Hat developers being very active in the free software security community and often contributing in a positive way. Quite simply I expect better from Red Hat. This is not some dubious Enterprise vendor where I wouldn't be the least bit surprised of such a reaction.

The development process of RPM seems to be totally chaotic, it's neither clear where one reports bugs nor where one gets the latest code and security bugs don't get fixed within a reasonable time.

There's been some recent events that make me feel especially worried about this: An unknown person has created an entry in the Libarchive issue tracker [5] that points to an anonymous document [6] with a very detailed description of various security weaknesses in the FreeBSD update process (most of them are still unfixed). The most worrying thing about this is however that the anonymous post mentions the existence similar documents affecting multiple Linux distributions. These documents haven't shown up publicly yet and given the unclear nature of this incident it's hard to know whether they ever will become public or exist at all. But this should still be reason enough to have a closer look at potential security vulnerabilities in all pieces of Linux package management systems.

I haven't analyzed the RPM installation process in detail, so I can't say how likely it is that the RPM tool ever sees a malformed input file. It seems downloads happen over HTTP, but the first thing that happens is a signature check. As the signature is part of the RPM file it already needs to be parsed for this. The exact impact of these bugs would require further analysis. But independent of how likely this is I think the parser in such a crucial piece of software should be robust. It should be safe to use the rpm tool to show info about a file on the command line.

[1] <http://rpm.org/>

[2] <http://rpm.org/wiki/ReportingBugs>

[3] <https://github.com/rpm-software-management/rpm>

[4] <http://pkgs.fedoraproject.org/cgit/rpms/rpm.git/diff/rpm-4.13.0-rpmtd-out-of-bounds.patch?h=f22&id=165614f3dd42caa188f78b55e7723dad2900b2f4>

[5] <https://github.com/libarchive/libarchive/issues/743>

[6] <https://gist.github.com/anonymous/e48209b03f1dd9625a992717e7b89c4f>

All bugs were found with the help of american fuzzy lop. Here are the bugs:

Stack Overflow in glob() / rpmglob.c.

Sample file (test with rpm -i [input]):

<https://crashes.fuzzing-project.org/rpm-stackoverflow-glob.rpm>

Unfixed in the current Git code.

Heap out of bounds read in headerVerifyInfo() / header.c.

Sample file (test with “rpm -i [input]”):

<https://crashes.fuzzing-project.org/rpm-heap-oob-read-headerVerifyInfo.rpm>

Git commit:

<https://github.com/rpm-software-management/rpm/commit/8e847d52c811e9a57239e18672d40f781e0ec48e>

Null pointer access / segfault in stringFormat() / formats.c

Sample file (test with “rpm -i [input]”):

<https://crashes.fuzzing-project.org/rpm-nullptr-rpmtdFormat.rpm>

Git commit:

<https://github.com/rpm-software-management/rpm/commit/cddf43a56f19711866371f02f378dc4095b0fadd>

Out of bounds read in rpmtdGetNumber() / rpmtd.c

Sample file (test with “rpm -qi -p -- [input]”)

<https://crashes.fuzzing-project.org/rpm-heap-oob-read-rpmtdGetNumber.rpm>

Git commit:

<https://github.com/rpm-software-management/rpm/commit/b722cf86200505b3e3fcbb2095c4ff61f1f5a2ab>

Finally one annoying thing to admit: In my original report I included another segfault in headerVerifyInfo() with unclear reasons. However I am now unable to reproduce this one. It may be due to compiler options, different command line parameters or dependencies on my system that have changed. For completeness I'm still providing the sample file:

<https://crashes.fuzzing-project.org/rpm-segfault-headerVerifyInfo.rpm>

(Ideally the RPM developers should include all those sample files in a test suite they regularly run against an address sanitizer build of RPM.)

Please also note that I expect this list to be incomplete and there are likely more issues that could be uncovered with further fuzzing. I'll test that once all the existing issues are fixed.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [11 Comments](/52-Multiple-vulnerabilities-in-RPM-and-a-rant.html#comments "11 Comments, 0 Trackbacks")

## [Multiple issues in p7zip](/49-Multiple-issues-in-p7zip.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, July 15. 2016

I reported several bugs discovered with afl in p7zip, the portable command line version of the 7-Zip archiving tool, one null pointer access causing a segfault and one out of bounds heap read.

At the time I reported the first issues these were already fixed in the main 7-Zip code, but the portable version hadn't been updated yet. Now there is version 16.02, unfortunately there are still issues left.

[Null pointer access / segfault](https://sourceforge.net/p/p7zip/bugs/182/)

An access to a null pointer in NArchive::N7z::CStreamSwitch::Set can cause p7zip to crash.

[Out of bounds read (bug is not publicly visible yet)](https://sourceforge.net/p/p7zip/bugs/183/)

An out of bounds heap read access can happen in the function NArchive::N7z::CDecoder::Decode.

[Null pointer acctess / segfault (unfixed in 16.02)](https://sourceforge.net/p/p7zip/bugs/184/)

A memory allocation isn't checked for a failing allocation. If the file's header indicates a large data size the allocation will fail and subsequently p7zip will try to write to a null pointer. This will likely only lead to a crash and not to further security issues, however this problem seems prevalent in the 7-zip codebase - there are several memory allocations without a check for failures.

p7zip is often used in security appliances to scan inputs, because it supports a large number of archiving file formats. Vulnerabilities in it have [played a role in previous attacks on Fireeye appliances](http://de.slideshare.net/44Con/44con-london-2015-playing-with-fire-attacking-the-fireeye-mps). Therefore it's worrying that it's so easy to find crashers in it via fuzzing.

There were [also other issues in 7-Zip discovered lately](http://blog.talosintel.com/2016/05/multiple-7-zip-vulnerabilities.html).

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [1 Comment](/49-Multiple-issues-in-p7zip.html#comments "1 Comment, 0 Trackbacks")

## [Out of bounds read and signed integer overflow in libarchive](/48-Out-of-bounds-read-and-signed-integer-overflow-in-libarchive.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Thursday, June 23. 2016

I recently wrote about a [large number of bugs and potential security issues in libarchive](https://blog.fuzzing-project.org/47-Many-invalid-memory-access-issues-in-libarchive.html). The release 3.2.0 missed one fix for an out of bounds read in the rar parser. Also I discovered one additional signed integer overflow issue with ubsan. Both issues are now fixed in [libarchive 3.2.1](https://groups.google.com/forum/#!topic/libarchive-discuss/sui01WaM3ic).

All issues were discovered with the help of american fuzzy lop.

[Out of bounds heap read in RAR parser](https://github.com/libarchive/libarchive/issues/521)

[Sample rar file](http://libarchive.github.io/google-code/issue-413/comment-0/bsdtar-invalid-read.rar)

[CVE-2015-8934](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8934)

[Signed integer overflow in ISO parser](https://github.com/libarchive/libarchive/issues/717#event-697151157)

[Sample ISO file](https://github.com/libarchive/libarchive/files/321672/libarchive-signed-int-overflow.zip)

[CVE-2016-5844](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5844)

Also a couple of [other security issues in libarchive were found by Cisco](http://blog.talosintel.com/2016/06/the-poisoned-archives.html).

With the release of version 3.2.1 I consider libarchive to be reasonably robust against fuzzing. I've tested all supported file formats and fuzzed each one with afl/asan for at least one day. Of course that doesn't mean that no security issues are left - but the easy to find ones should be wiped out.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/48-Out-of-bounds-read-and-signed-integer-overflow-in-libarchive.html#comments "0 Comments, 0 Trackbacks")

## [ImageMagick heap overflow and out of bounds read](/45-ImageMagick-heap-overflow-and-out-of-bounds-read.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Wednesday, May 11. 2016

Recently the [ImageTragick](https://imagetragick.com/) vulnerability shed some light on the security status of ImageMagick.

This made me wonder how resilient to fuzzing ImageMagick is these days. It's pretty much a posterchild example for a good fuzzing target: Lots of supported complex binary file formats.

I already did some fuzzing on ImageMagick, but as far as I remember that was before I used american fuzzy lop and was done with zzuf. I was also aware that [others did some more thorough fuzzing](http://www.openwall.com/lists/oss-security/2014/12/24/1) on ImageMagick.

What I did now was relatively simple: I took a trivial, few pixels PNG and used ImageMagick's "convert" tool to convert it into all file formats that have both read and write support in ImageMagick. I used that to run a fuzzing job with afl and asan. By design ImageMagick will sometimes do huge memory allocations, these can be prevented by setting limits for the width, height and memory usage in the policy.xml file.

I discovered one heap buffer overflow in the PICT parser and one heap out of bounds read in the PSD parser. Given how big the attack surface is this is not terrible, but it shows that despite previous efforts there's still potential to fuzz ImageMagick.

[Sample file for heap buffer overflow in WritePixelCachePixels() (PICT format)](https://crashes.fuzzing-project.org/imagemagick-heapoverflow-WritePixelCachePixels.pict)

[Git commit / fix](https://github.com/ImageMagick/ImageMagick/commit/cfbe890d0cfcd5d3b0f63744a6901e40e992e07c)

[Sample file for heap out of bounds read in PushShortPixel() (PSD format)](https://crashes.fuzzing-project.org/imagemagick-oob-heap-read-PushShortPixel.psd)

[Git commit / fix](https://github.com/ImageMagick/ImageMagick/commit/15dd190dfd7e7a3341bdc378f4f0daba9873322c)

Both issues have been fixed in the versions 6.9.4-0 and 7.0.1-2. In the meantime new versions (6.9.4-1, 7.0.1-3) came out that, as far as I understand [the ChangeLog](https://www.imagemagick.org/script/changelog.php), remove another potential vector for the ImageTragick vulnerabilities, so you should preferrably update to those.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/45-ImageMagick-heap-overflow-and-out-of-bounds-read.html#comments "0 Comments, 0 Trackbacks")

## [dosfstools / fsck.vfat: Several invalid memory accesses](/44-dosfstools-fsck.vfat-Several-invalid-memory-accesses.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Sunday, May 8. 2016

I lately fuzzed various filesystem check tools. This uncovered a number of issues in dosfstools / fsck.fat that have now been fixed in the new version 4.0. All issues were found with american fuzzy lop and address sanitizer.

[Global out of bounds read file\_stat() / check\_dir()](https://github.com/dosfstools/dosfstools/issues/11)

[Git commit / fix](https://github.com/dosfstools/dosfstools/commit/2aad1c83c7d010de36afbe79c9fde22c50aa2f74)

[Unclear invalid memory access in get\_fat()](https://github.com/dosfstools/dosfstools/issues/12)

[Git commit / fix](https://github.com/dosfstools/dosfstools/commit/07908124838afcc99c577d1d3e84cef2dbd39cb7)

[CVE-2015-8872](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8872)

[Heap overflow in read\_fat()](https://github.com/dosfstools/dosfstools/issues/25)

[Heap out of bounds read in get\_fat()](https://github.com/dosfstools/dosfstools/issues/26)

[Git commit / fix for both issues](https://github.com/dosfstools/dosfstools/commit/e8eff147e9da1185f9afd5b25948153a3b97cf52)

[CVE-2016-4804](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4804)

These bugs can pose a security risk if a system automatically checks attached storage media with fsck or in situations where filesystems on untrusted devices get checked. The new version [dosfstools 4.0](https://github.com/dosfstools/dosfstools/releases/tag/v4.0) fixes all four bugs.

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/44-dosfstools-fsck.vfat-Several-invalid-memory-accesses.html#comments "0 Comments, 0 Trackbacks")

## [PHP EXIF parser out of bounds reads (CVE-2016-4542, CVE-2016-4543, CVE-2016-4544) and a note on custom memory allocators](/43-PHP-EXIF-parser-out-of-bounds-reads-CVE-2016-4542%2C-CVE-2016-4543%2C-CVE-2016-4544-and-a-note-on-custom-memory-allocators.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, May 6. 2016

PHP recently released the security updates [7.0.6](https://secure.php.net/archive/2016.php#id2016-04-29-1), 5.6.21 and 5.5.35 that fix - among a couple of other security issues - a couple of out of bounds issues in the EXIF parser I reported.

[Sample file (CVE-2016-4542)](https://crashes.fuzzing-project.org/php-exif_process_IFD_TAG-2949.jpg)

[Sample file (CVE-2016-4543)](https://crashes.fuzzing-project.org/php-exif_process_IFD_in_JPEG-3118.jpg)

[Sample file (also CVE-2016-4543)](https://crashes.fuzzing-project.org/php-exif_process_IFD_in_JPEG-3141.jpg)

[Sample file (CVE-2016-4544)](https://crashes.fuzzing-project.org/php-exif_process_TIFF_in_JPEG-3191.jpg)

[Bug report](https://bugs.php.net/bug.php?id=72094)

[Git commit](https://git.php.net/?p=php-src.git;a=blobdiff;f=ext/exif/exif.c;h=f366acc552b833af05c402be1c85c28cfd1581e6;hp=ff29fdd0fa0b922fd32e2f5704857dcc8543f628;hb=082aecfc3a753ad03be82cf14f03ac065723ec92;hpb=d650063a0457aec56364e4005a636dc6c401f9cd)

These bugs are not exceptionally interesting, but there is something to know when fuzzing PHP and the same applies also to a number of other applications: It uses a custom memory allocator that can sometimes mask issues from memory safety tools like Address Sanitizer. It is therefore good to know about them and disable them during fuzz testing.

With PHP this can be circumvented by setting the environment variable **USE\_ZEND\_ALLOC=0** while fuzzing. This disables the Zend allocator from PHP and uses normal libc memory allocation calls.

I started [documenting such issues and workarounds](https://fuzzing-project.org/tutorial-tips.html).

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/43-PHP-EXIF-parser-out-of-bounds-reads-CVE-2016-4542%2C-CVE-2016-4543%2C-CVE-2016-4544-and-a-note-on-custom-memory-allocators.html#comments "0 Comments, 0 Trackbacks")

## [Bugs found with Address Sanitizer in syslog-ng, monit, cmake](/41-Bugs-found-with-Address-Sanitizer-in-syslog-ng%2C-monit%2C-cmake.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Tuesday, April 5. 2016

Lately a couple of updates have fixed issues that I discovered while testing software with Address Sanitizer (ASAN). I'll publish these combined. Once again these show that a lot of software hasn't been tested with ASAN and what kind of bugs it can uncover.

In syslog-ng a function returns an error -1 that gets stored in an unsigned variable. This cannot be stored and a subsequent check for the error value fails, this later leads to a heap out of bounds memory read. This was fixed in syslog-ng 3.7.3.

[Upstream bug report](https://github.com/balabit/syslog-ng/issues/780)

[Pull request / patch](https://github.com/balabit/syslog-ng/pull/783)

[syslog-ng 3.7.3 release notes](https://github.com/balabit/syslog-ng/releases/tag/syslog-ng-3.7.3)

In the monit system monitoring tool a heap overflow was discovered. A call to sscanf would write a string of length 256 into a 256 byte long buffer. However this fails to consider the trailing zero byte of that string, therefore causing a one byte heap overflow. This was fixed in monit 5.16.

[Commit / fix](https://bitbucket.org/tildeslash/monit/commits/58c562b9de25981060486b38a205dfcfa2235ef4)

In the compilation tool cmake a use after free error was found. This happened becaused a variable was used in a comparison and was free'd during that comparison operation. This was fixed in cmake 3.5.0.

[Upstream bug report](https://public.kitware.com/Bug/view.php?id=15944)

[Commit / fix](https://cmake.org/gitweb?p=cmake.git;a=commitdiff;h=6ffc4323)

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/41-Bugs-found-with-Address-Sanitizer-in-syslog-ng%2C-monit%2C-cmake.html#comments "0 Comments, 0 Trackbacks")

## [Heap use after free in Pidgin-OTR plugin (CVE-2015-8833)](/39-Heap-use-after-free-in-Pidgin-OTR-plugin-CVE-2015-8833.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Wednesday, March 9. 2016

The pidgin-otr plugin version 4.0.2 fixes a heap use after free error. The bug is triggered when a user tries to authenticate a buddy and happens in the function create\_smp\_dialog.

The bug was discovered with Address Sanitizer. This is yet another example why all C/C++ code should be tested with Address Sanitizer enabled.

This bug was already independently discovered and reported by Stefan Sperling [in the otr bug tracker](https://bugs.otr.im/issues/88).

Independend of this bug another [more severe bug in Libotr itself was also disclosed today](https://www.x41-dsec.de/lab/advisories/x41-2016-001-libotr/), please make sure you update both libotr (4.1.1) and the pidgin-otr plugin (4.0.2).

[Upstream bug report (contains Address Sanitizer stack trace)](https://bugs.otr.im/issues/128)

[Commit / fix](https://bugs.otr.im/projects/pidgin-otr/repository/revisions/aaf551b9dd5cbba8c4abaa3d4dc7ead860efef94)

[CVE-2015-8833](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8833)

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/39-Heap-use-after-free-in-Pidgin-OTR-plugin-CVE-2015-8833.html#comments "0 Comments, 0 Trackbacks")

## [Miscomputations of elliptic curve scalar multiplications in Nettle](/38-Miscomputations-of-elliptic-curve-scalar-multiplications-in-Nettle.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Tuesday, February 2. 2016

The Nettle library is a library for basic cryptographic functions. Its most prominent user is GnuTLS.

Through fuzzing of elliptic curve scalar multiplications (multiplying a point on an elliptic curve with a scalar number) I discovered two carry propagation bugs that would lead the cauculations to produce wrong results. They affect the NIST P-256 and P-384 curves. The P-256 bug is in the C code and affects multiple architectures. The P-384 bug is in the assembly code and only affects 64 bit x86. Both bugs were found with the help of american fuzzy lop.

While analyzing these bugs Nettle developer Niels Möller discovered another carry propagation bug in P-256 that was fixed in the same commit ([CVE-2015-8805](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-8805)). Nettle 3.2 fixes all three bugs.

The impact is currently unclear, but miscalculations in cryptographic functions should generally be considered security issues. I'd like to encourage cryptographers to try to analyze whether these bugs can lead to cryptographic breaks.

I have published a [code example on how to fuzz elliptic curve multiplications](https://github.com/hannob/bignum-fuzz/blob/master/point-fuzz.c). It can compare the output of OpenSSL with either Nettle or NSS. It currently works only with prime field curves, but it can probably be adapted to other curves.

P-256 bug:

[Mailing list post with code sample](https://lists.lysator.liu.se/pipermail/nettle-bugs/2015/003028.html)

[Commit / fix for P-256 bug](https://git.lysator.liu.se/nettle/nettle/commit/c71d2c9d20eeebb985e3872e4550137209e3ce4d)

[CVE-2015-8803](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-8803)

P-384 bug:

[Mailing list post with code sample](https://lists.lysator.liu.se/pipermail/nettle-bugs/2015/003024.html)

[Commit / fix for P-384 bug](https://git.lysator.liu.se/nettle/nettle/commit/fa269b6ad06dd13c901dbd84a12e52b918a09cd7)

[CVE-2015-8804](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-8804)

[Nettle 3.2 release notes](https://lists.gnu.org/archive/html/info-gnu/2016-01/msg00006.html)

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/38-Miscomputations-of-elliptic-curve-scalar-multiplications-in-Nettle.html#comments "0 Comments, 0 Trackbacks")

## Pagination

* Page 1 of 3, totaling 34 entries
* [next page →](https://blog.fuzzing-project.org/categories/1-advisories/P2.html)

## Sidebar

### The Fuzzing Project

You may want to go [back to the Fuzzing Project's main page](https://fuzzing-project.org/) or [software list](https://fuzzing-project.org/software/).

### Archives

* [January 2025](/archives/2025/01/C1.html "January 2025")
* [December 2024](/archives/2024/12/C1.html "December 2024")
* [November 2024](/archives/2024/11/C1.html "November 2024")
* [Recent...](/index.php?frontpage)
* [Older...](https://blog.fuzzing-project.org/archive/C1)

### Categories

* [![XML](/templates/2k11/img/xml.gif)](/feeds/categories/1-advisories.rss) [advisories](/categories/1-advisories)

### Syndicate This Blog

* [![XML](/templates/2k11/img/subtome.png)](https://blog.fuzzing-project.org/feeds/index.rss2)
* [![XML](/templates/2k11/img/xml.gif)](https://blog.fuzzing-project.org/feeds/comments.rss2)
  [Comments](https://blog.fuzzing-project.org/feeds/comments.rss2)

Powered by [Serendipity](http://s9y.org) & the *2k11* theme.


