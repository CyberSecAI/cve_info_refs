=== Content from twitter.com_2088dc6a_20250126_114122.html ===



=== Content from github.com_8d3beeff_20250125_202120.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fud2%2Fadvisories%2Ftree%2Fmaster%2Fandroid%2Fsamsung%2Fnocve-2015-0001)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fud2%2Fadvisories%2Ftree%2Fmaster%2Fandroid%2Fsamsung%2Fnocve-2015-0001)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=ud2%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ud2](/ud2)
/
**[advisories](/ud2/advisories)**
Public

* [Notifications](/login?return_to=%2Fud2%2Fadvisories) You must be signed in to change notification settings
* [Fork
  66](/login?return_to=%2Fud2%2Fadvisories)
* [Star
   169](/login?return_to=%2Fud2%2Fadvisories)

* [Code](/ud2/advisories)
* [Issues
  4](/ud2/advisories/issues)
* [Pull requests
  0](/ud2/advisories/pulls)
* [Actions](/ud2/advisories/actions)
* [Projects
  0](/ud2/advisories/projects)
* [Wiki](/ud2/advisories/wiki)
* [Security](/ud2/advisories/security)
* [Insights](/ud2/advisories/pulse)

Additional navigation options

* [Code](/ud2/advisories)
* [Issues](/ud2/advisories/issues)
* [Pull requests](/ud2/advisories/pulls)
* [Actions](/ud2/advisories/actions)
* [Projects](/ud2/advisories/projects)
* [Wiki](/ud2/advisories/wiki)
* [Security](/ud2/advisories/security)
* [Insights](/ud2/advisories/pulse)

## Files

 master
## Breadcrumbs

1. [advisories](/ud2/advisories/tree/master)
2. /[android](/ud2/advisories/tree/master/android)
3. /[samsung](/ud2/advisories/tree/master/android/samsung)
/
# nocve-2015-0001

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/ud2/advisories/commits/master/android/samsung/nocve-2015-0001) master
## Breadcrumbs

1. [advisories](/ud2/advisories/tree/master)
2. /[android](/ud2/advisories/tree/master/android)
3. /[samsung](/ud2/advisories/tree/master/android/samsung)
/
# nocve-2015-0001

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/ud2/advisories/tree/master/android/samsung) | | |
| [README.md](/ud2/advisories/blob/master/android/samsung/nocve-2015-0001/README.md "README.md") | | [README.md](/ud2/advisories/blob/master/android/samsung/nocve-2015-0001/README.md "README.md") |  |  |
| [pwn](/ud2/advisories/blob/master/android/samsung/nocve-2015-0001/pwn "pwn") | | [pwn](/ud2/advisories/blob/master/android/samsung/nocve-2015-0001/pwn "pwn") |  |  |
| [zipfury.py](/ud2/advisories/blob/master/android/samsung/nocve-2015-0001/zipfury.py "zipfury.py") | | [zipfury.py](/ud2/advisories/blob/master/android/samsung/nocve-2015-0001/zipfury.py "zipfury.py") |  |  |
| View all files | | |

## [README.md](#readme)

# ZipFury: Yet another Zip arbitrary file write with system privileges

* *Authors*: Roberto Paleari ([@rpaleari](https://twitter.com/rpaleari)) and Aristide Fattori ([@joystick](https://twitter.com/joystick))
* *ID*: CVE-2015-8780
* *Notification date*: 12/06/2015
* *Release date*: 02/11/2015

Some months ago, while testing an Android app, we identified an arbitrary file
write vulnerability in a Zip file decompression routine. The standard
Java/Android Zip library (i.e., `ZipFile`) does *not* perform any check on the
paths of files contained in a Zip archive, as this task is devoted to the
application itself.

This tickled our senses and a quick grep to find system apps using this library
yielded some interesting results. In particular, we identified two interesting system level
components that made use of the `ZipFile` library and did not check for
dangerous paths: `wssyncmlnps` and the Swift keyboard. We soon ruled out the
latter, since the vulnerability was only reachable during an update routine and
required a MitM attack. Some months
[later](https://www.nowsecure.com/blog/2015/06/16/remote-code-execution-as-system-user-on-samsung-phones/),
this proved to be a very bad idea :-). `wssyncmlnps`, on the other hand, was
just slightly more interesting: it was exploitable to write arbitrary files as
system as well, but the bug was reachable only through Samsung Kies. For these
reasons (and also for the lack of spare time) we sat on the bug for some months.

When we finally had time to investigate better and produce a small PoC Zip to
demonstrate the vulnerability, we notified it to Samsung (12/07/2015). A couple
of days later, NowSecure published its blog post on the SwiftKey bug. They made
no mention to `wssyncmlnps`, fortunately :-)

## Technical details

The vulnerability affects `wssyncmlnps` (`wssyncmlnps.odex`), a proprietary Samsung
application executed with administrative (i.e., "system") privileges. Among the other
things, this application handles the backup & restore of user data via Kies.

Practically speaking, when a user performs a restore operation through Kies,
the aforementioned application eventually processes a `.bk` file, which is
basically a Zip archive that is uncompressed using the standard Java/Android
library class `ZipFile`.

Due to insufficient checks on the name of the files contained in the Zip
archive, an attacker can perform a directory traversal to extract
uncompressed files to arbitrary locations. This permits a local user with
access to Kies to write to any filesystem location, with "system" privileges
(provided that the destination directory is not mounted in read-only mode).

To the best of our knowledge, this issue can only be triggered through Kies, or
at least exploitation requires a physical USB connection. In other terms, there
are apparently no ways that other apps on the phone could leverage to exploit
this vulnerability.

### Steps to recreate

As a proof-of-concept, we created a malicious e-mail backup archive that
exploits the vulnerability. Other backup archive types can also be used to
trigger the vulnerability.

In detail, we first created a `.bk` file containing a file named
`../../../../../../data/testme.pwn`. Consider that this is not possible using
traditional file compression applications: the Zip file must be manually
modified to rename one of the contained files inserting the directory traversal
specifiers (`../`). See the attached [script](/ud2/advisories/blob/master/android/samsung/nocve-2015-0001/zipfury.py) to create the Zip.

Secondly, we created a backup folder that satisfied the requirements of
Kies. More precisely, the backup folder must contain:

* a `backupHistoryInfo.xml` file containing information on the backup. The
  contents of this file must be adapted to reflect the parameters of the target
  device.
* An `EMAIL/BR/` sub-directory containing the maliciously crafted `.bk` file
  (i.e., the Zip archive).

Finally, from the Kies "Back up/Restore" tab we clicked on the "Restore"
option. We then selected the directory containing the crafted backup files
through the "Select folder" button and hit "Restore". The specially-crafted
backup archive is thus processed and a file named `/data/testme.pwn` is
eventually created, owned by the "system" user; this file has
attacker-controlled contents.

### Discussion

As mentioned earlier, a very similar bug has been almost concurrently identified by
NowSecure in the update mechanism of the Swift keyboard. NowSecure
[demonstrated](https://www.nowsecure.com/blog/2015/06/16/remote-code-execution-as-system-user-on-samsung-phones/)
that an arbitrary file write with system privileges can be successfully
exploited to eventually obtain code execution. Our bug cannot be exploited for
remote code execution, but it could be exploited to gain system privileges on a
physically (i.e., USB) accessible device.

## Timeline

* 12 Jun: Notified Samsung, proposed a 90-days disclosure.
* 15 Jun: Samsung replied.
* 15 Jun: Sent details to Samsung.
* 16 Jun: NowSecure releases details of its attack to SwiftKey.
* 17 Jun: Samsung acknowledges the bug and asks for some time to evaluate the
  time of disclosure.
* 22 Jul: Samsung has a patch ready, but still no update on the disclosure date.
* 28 Jul: Samsung finishes the patch testing, proposes a "End of October" disclosure.
* 29 Jul: We agree to postpone the deadline to October 31.
* 26 Oct: Remind Samsung of disclosure date.
* 2 Nov: Disclosure.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from twitter.com_c38cf83c_20250126_114123.html ===


