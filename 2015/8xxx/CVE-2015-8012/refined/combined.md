=== Content from github.com_b69c2312_20250125_130326.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flldpd%2Flldpd%2Fcommit%2F793526f8884455f43daecd0a2c46772388417a00)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flldpd%2Flldpd%2Fcommit%2F793526f8884455f43daecd0a2c46772388417a00)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lldpd%2Flldpd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lldpd](/lldpd)
/
**[lldpd](/lldpd/lldpd)**
Public

* [Notifications](/login?return_to=%2Flldpd%2Flldpd) You must be signed in to change notification settings
* [Fork
  184](/login?return_to=%2Flldpd%2Flldpd)
* [Star
   627](/login?return_to=%2Flldpd%2Flldpd)

* [Code](/lldpd/lldpd)
* [Issues
  38](/lldpd/lldpd/issues)
* [Pull requests
  11](/lldpd/lldpd/pulls)
* [Discussions](/lldpd/lldpd/discussions)
* [Actions](/lldpd/lldpd/actions)
* [Projects
  0](/lldpd/lldpd/projects)
* [Wiki](/lldpd/lldpd/wiki)
* [Security](/lldpd/lldpd/security)
* [Insights](/lldpd/lldpd/pulse)

Additional navigation options

* [Code](/lldpd/lldpd)
* [Issues](/lldpd/lldpd/issues)
* [Pull requests](/lldpd/lldpd/pulls)
* [Discussions](/lldpd/lldpd/discussions)
* [Actions](/lldpd/lldpd/actions)
* [Projects](/lldpd/lldpd/projects)
* [Wiki](/lldpd/lldpd/wiki)
* [Security](/lldpd/lldpd/security)
* [Insights](/lldpd/lldpd/pulse)

## Commit

[Permalink](/lldpd/lldpd/commit/793526f8884455f43daecd0a2c46772388417a00)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

protocols: don't use assert on paths that can be reached

[Browse files](/lldpd/lldpd/tree/793526f8884455f43daecd0a2c46772388417a00)
Browse the repository at this point in the history

```
Malformed packets should not make lldpd crash. Ensure we can handle them
by not using assert() in this part.
```

* Loading branch information

[![@vincentbernat](https://avatars.githubusercontent.com/u/631446?s=40&v=4)](/vincentbernat)

[vincentbernat](/lldpd/lldpd/commits?author=vincentbernat "View all commits by vincentbernat")
committed
Oct 4, 2015

1 parent
[479c1a6](/lldpd/lldpd/commit/479c1a61ffc652aa713f371d969f4645052fac4f)

commit 793526f

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**20 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/daemon

  + src/daemon/lldpd.c
    [lldpd.c](#diff-648600df7c7707b4e05700b85b40b337a2b2c3b7695ff1e4e73d86ffb6e6278f)
  + protocols

    - src/daemon/protocols/cdp.c
      [cdp.c](#diff-1d7925fb31f559c3e69bd44b8892dcd0048786693d5f2f9e0df90b93ab40b48a)
    - src/daemon/protocols/edp.c
      [edp.c](#diff-0e4256bd5ee6ef44b80bb83ee7693a894ff119289340337db26242942ae99efa)
    - src/daemon/protocols/lldp.c
      [lldp.c](#diff-47a8d31782d9395da05afcb0fa27de674fe5a1c83c77142c438fa935999c37da)
    - src/daemon/protocols/sonmp.c
      [sonmp.c](#diff-ae2362833fb0b5942cd7c80fe9877ce4e14098d45a231b7256037d63ea4f59e5)

## There are no files selected for viewing

1 change: 0 additions & 1 deletion

1
[src/daemon/lldpd.c](#diff-648600df7c7707b4e05700b85b40b337a2b2c3b7695ff1e4e73d86ffb6e6278f "src/daemon/lldpd.c")

Show comments

[View file](/lldpd/lldpd/blob/793526f8884455f43daecd0a2c46772388417a00/src/daemon/lldpd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -198,7 +198,6 @@ lldpd\_alloc\_mgmt(int family, void \*addrptr, size\_t addrsize, u\_int32\_t iface) |
|  |  | return NULL; |
|  |  | } |
|  |  | mgmt->m\_family = family; |
|  |  | assert(addrsize <= LLDPD\_MGMT\_MAXADDRSIZE); |
|  |  | memcpy(&mgmt->m\_addr, addrptr, addrsize); |
|  |  | mgmt->m\_addrsize = addrsize; |
|  |  | mgmt->m\_iface = iface; |
| Expand Down | |  |

10 changes: 7 additions & 3 deletions

10
[src/daemon/protocols/cdp.c](#diff-1d7925fb31f559c3e69bd44b8892dcd0048786693d5f2f9e0df90b93ab40b48a "src/daemon/protocols/cdp.c")

Show comments

[View file](/lldpd/lldpd/blob/793526f8884455f43daecd0a2c46772388417a00/src/daemon/protocols/cdp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,6 @@ |
|  |  | #include <unistd.h> |
|  |  | #include <errno.h> |
|  |  | #include <arpa/inet.h> |
|  |  | #include <assert.h> |
|  |  |  |
|  |  | static int |
|  |  | cdp\_send(struct lldpd \*global, |
| Expand Down  Expand Up | | @@ -438,8 +437,13 @@ cdp\_decode(struct lldpd \*cfg, char \*frame, int s, |
|  |  | mgmt = lldpd\_alloc\_mgmt(LLDPD\_AF\_IPV4, &addr, |
|  |  | sizeof(struct in\_addr), 0); |
|  |  | if (mgmt == NULL) { |
|  |  | assert(errno == ENOMEM); |
|  |  | log\_warn("cdp", "unable to allocate memory for management address"); |
|  |  | if (errno == ENOMEM) |
|  |  | log\_warn("cdp", |
|  |  | "unable to allocate memory for management address"); |
|  |  | else |
|  |  | log\_warn("cdp", |
|  |  | "too large management address received on %s", |
|  |  | hardware->h\_ifname); |
|  |  | goto malformed; |
|  |  | } |
|  |  | TAILQ\_INSERT\_TAIL(&chassis->c\_mgmt, mgmt, m\_entries); |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[src/daemon/protocols/edp.c](#diff-0e4256bd5ee6ef44b80bb83ee7693a894ff119289340337db26242942ae99efa "src/daemon/protocols/edp.c")

Show comments

[View file](/lldpd/lldpd/blob/793526f8884455f43daecd0a2c46772388417a00/src/daemon/protocols/edp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,6 @@ |
|  |  | #include <errno.h> |
|  |  | #include <arpa/inet.h> |
|  |  | #include <fnmatch.h> |
|  |  | #include <assert.h> |
|  |  |  |
|  |  | static int seq = 0; |
|  |  |  |
| Expand Down | |  |

14 changes: 8 additions & 6 deletions

14
[src/daemon/protocols/lldp.c](#diff-47a8d31782d9395da05afcb0fa27de674fe5a1c83c77142c438fa935999c37da "src/daemon/protocols/lldp.c")

Show comments

[View file](/lldpd/lldpd/blob/793526f8884455f43daecd0a2c46772388417a00/src/daemon/protocols/lldp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,7 +20,6 @@ |
|  |  |  |
|  |  | #include <unistd.h> |
|  |  | #include <errno.h> |
|  |  | #include <assert.h> |
|  |  | #include <time.h> |
|  |  | #include <sys/types.h> |
|  |  | #include <sys/socket.h> |
| Expand Down  Expand Up | | @@ -161,7 +160,7 @@ static int \_lldp\_send(struct lldpd \*global, |
|  |  | /\* Management addresses \*/ |
|  |  | TAILQ\_FOREACH(mgmt, &chassis->c\_mgmt, m\_entries) { |
|  |  | proto = lldpd\_af\_to\_lldp\_proto(mgmt->m\_family); |
|  |  | assert(proto != LLDP\_MGMT\_ADDR\_NONE); |
|  |  | if (proto == LLDP\_MGMT\_ADDR\_NONE) continue; |
|  |  | if (!( |
|  |  | POKE\_START\_LLDP\_TLV(LLDP\_TLV\_MGMT\_ADDR) && |
|  |  | /\* Size of the address, including its type \*/ |
| Expand Down  Expand Up | | @@ -749,10 +748,13 @@ lldp\_decode(struct lldpd \*cfg, char \*frame, int s, |
|  |  | iface = 0; |
|  |  | mgmt = lldpd\_alloc\_mgmt(af, addr\_ptr, addr\_length, iface); |
|  |  | if (mgmt == NULL) { |
|  |  | assert(errno == ENOMEM); |
|  |  | log\_warn("lldp", "unable to allocate memory " |
|  |  | "for management address"); |
|  |  | goto malformed; |
|  |  | if (errno == ENOMEM) |
|  |  | log\_warn("lldp", "unable to allocate memory " |
|  |  | "for management address"); |
|  |  | else |
|  |  | log\_warn("lldp", "too large management address " |
|  |  | "received on %s", hardware->h\_ifname); |
|  |  | goto malformed; |
|  |  | } |
|  |  | TAILQ\_INSERT\_TAIL(&chassis->c\_mgmt, mgmt, m\_entries); |
|  |  | break; |
| Expand Down | |  |

8 changes: 5 additions & 3 deletions

8
[src/daemon/protocols/sonmp.c](#diff-ae2362833fb0b5942cd7c80fe9877ce4e14098d45a231b7256037d63ea4f59e5 "src/daemon/protocols/sonmp.c")

Show comments

[View file](/lldpd/lldpd/blob/793526f8884455f43daecd0a2c46772388417a00/src/daemon/protocols/sonmp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,7 +24,6 @@ |
|  |  | #include <unistd.h> |
|  |  | #include <errno.h> |
|  |  | #include <arpa/inet.h> |
|  |  | #include <assert.h> |
|  |  |  |
|  |  | static struct sonmp\_chassis sonmp\_chassis\_types[] = { |
|  |  | {1, "unknown (via SONMP)"}, |
| Expand Down  Expand Up | | @@ -358,8 +357,11 @@ sonmp\_decode(struct lldpd \*cfg, char \*frame, int s, |
|  |  | } |
|  |  | mgmt = lldpd\_alloc\_mgmt(LLDPD\_AF\_IPV4, &address, sizeof(struct in\_addr), 0); |
|  |  | if (mgmt == NULL) { |
|  |  | assert(errno == ENOMEM); |
|  |  | log\_warn("sonmp", "unable to allocate memory for management address"); |
|  |  | if (errno == ENOMEM) |
|  |  | log\_warn("sonmp", "unable to allocate memory for management address"); |
|  |  | else |
|  |  | log\_warn("sonmp", "too large management address received on %s", |
|  |  | hardware->h\_ifname); |
|  |  | goto malformed; |
|  |  | } |
|  |  | TAILQ\_INSERT\_TAIL(&chassis->c\_mgmt, mgmt, m\_entries); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `793526f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flldpd%2Flldpd%2Fcommit%2F793526f8884455f43daecd0a2c46772388417a00) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_da6ebb17_20250125_130325.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2015/10/19/1) [[<thread-prev]](../../../2015/10/16/2) [[thread-next>]](../../../2015/10/30/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <87zizgc69u.fsf@mid.deneb.enyo.de>
Date: Sun, 18 Oct 2015 21:42:53 +0200
From: Florian Weimer <fw@...eb.enyo.de>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: lldpd crash in lldp_decode due large management address

* Florian Weimer:

> Upstream commit:
>
> <<https://github.com/vincentbernat/lldpd/commit/dd4f16e7e816f2165fba76e3d162cd8d2978dcb2>>
>
> If compiled with effective source fortification, the vulnerability is
> just a crash and not exploitable for anything else, as a result of the
> compiler-emitted length check for memcpy inside the PEEK_BYTES macro.

There is also another fix, an improper assert leading to a daemon
crash:

<https://github.com/vincentbernat/lldpd/commit/793526f8884455f43daecd0a2c46772388417a00>

This probably needs a separate CVE ID.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_e7247302_20250125_130325.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2015/10/18/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151030002822.EA52E6C0116@smtpvmsrv1.mitre.org>
Date: Thu, 29 Oct 2015 20:28:22 -0400 (EDT)
From: cve-assign@...re.org
To: fw@...eb.enyo.de
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: lldpd crash in lldp_decode due large management address

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <https://github.com/vincentbernat/lldpd/commit/dd4f16e7e816f2165fba76e3d162cd8d2978dcb2>
>
> lldp: fix a buffer overflow when handling management address TLV
>
> When a remote device was advertising a too large management address
> while still respecting TLV boundaries, lldpd would crash due to a buffer
> overflow. However, the buffer being a static one, this buffer overflow
> is not exploitable if hardening was not disabled. This bug exists since
> version 0.5.6.

>> <https://github.com/vincentbernat/lldpd/blob/master/configure.ac>

>> [AS_HELP_STRING([--enable-hardening],
>>   [Enable compiler and linker options to frustrate memory corruption exploits @<:@default=yes@:>@])],

Based on the
<https://github.com/vincentbernat/lldpd/commit/8738a36d30e2e94257c5b1ae9cd3e7c3d314808e>
commit, there are apparently some platforms, such as the OpenWrt Linux
distribution, on which hardening must be disabled. Thus, this is a
relevant exploitable problem in the general case.

Use CVE-2015-8011.

> <https://github.com/vincentbernat/lldpd/commit/793526f8884455f43daecd0a2c46772388417a00>
>
> protocols: don't use assert on paths that can be reached
>
> Malformed packets should not make lldpd crash. Ensure we can handle them
> by not using assert() in this part.

Use CVE-2015-8012.

(Apparently there are various types of malformed packets that can
cause different problems. However, the code changes themselves are all
for CWE-617.)

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWMriDAAoJEL54rhJi8gl5QwcQAMzf82elhg+4B1gE2Yg0APUa
6wTU/GsftPClKuy9zVGNGbajoZgDcrkyqADc45aH4Dpb9G+YK/X6s/B9dgf9KqBj
3X+5lreJbNKXJlOfZRU9t9J0HH+qRSYa3uVnU19gmLcSG8Z1rJU2JVHVYGha7ujF
Vh6UozSj/U+hgmfMs9ArXCrjWFEz15kiWr3XmAcVH6ARwtkKNbIadGiz5R5w/dqb
HF1V7gZHSMz+QHVj/LsMLeuX6Ba6eGFtSAXgrIWKuqZbstTRde2spTUwmB5Njayn
RUUkIWxQd4oRqNL4ckAj1hIq28GjEreoO3gn2p8CU8On6kc/geHEc2xXt3PBsaZU
k4R+qY/uq4gFiLjNUdrw9oiCEC5LqFgc2PM1EqzwXlPgvBTvAf6end1DIzf8DLVM
7WAChlIPTXJL1+mRz6N5xEGdlEEDiCKDpvgCtUNc1b88IHB6Rr51eJgjypxhDAsp
D8gWfyCwuPps2gSLmipz0LXfb/2DwuzAjcJoZ5rAiWRnmz53asI+2DZMUM2Q6/jF
kdsgw0lHv5TIO+5MMl/s82s/gmiLbYZ7muvxqzlgCynpTR3UJNs9NDLp6ifLYLAw
27HxxKBq+vGKbCmtK5pDwE2qth9fSR8k5n/ofBcmuPG2mbKMQMPrDvb87Usq5XOR
P0vNhiVvQ3oNBE9Ny7UM
=dhHo
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_29311502_20250125_130327.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flldpd%2Flldpd%2Fcommit%2F9221b5c249f9e4843f77c7f888d5705348d179c0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flldpd%2Flldpd%2Fcommit%2F9221b5c249f9e4843f77c7f888d5705348d179c0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lldpd%2Flldpd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lldpd](/lldpd)
/
**[lldpd](/lldpd/lldpd)**
Public

* [Notifications](/login?return_to=%2Flldpd%2Flldpd) You must be signed in to change notification settings
* [Fork
  184](/login?return_to=%2Flldpd%2Flldpd)
* [Star
   627](/login?return_to=%2Flldpd%2Flldpd)

* [Code](/lldpd/lldpd)
* [Issues
  38](/lldpd/lldpd/issues)
* [Pull requests
  11](/lldpd/lldpd/pulls)
* [Discussions](/lldpd/lldpd/discussions)
* [Actions](/lldpd/lldpd/actions)
* [Projects
  0](/lldpd/lldpd/projects)
* [Wiki](/lldpd/lldpd/wiki)
* [Security](/lldpd/lldpd/security)
* [Insights](/lldpd/lldpd/pulse)

Additional navigation options

* [Code](/lldpd/lldpd)
* [Issues](/lldpd/lldpd/issues)
* [Pull requests](/lldpd/lldpd/pulls)
* [Discussions](/lldpd/lldpd/discussions)
* [Actions](/lldpd/lldpd/actions)
* [Projects](/lldpd/lldpd/projects)
* [Wiki](/lldpd/lldpd/wiki)
* [Security](/lldpd/lldpd/security)
* [Insights](/lldpd/lldpd/pulse)

## Commit

[Permalink](/lldpd/lldpd/commit/9221b5c249f9e4843f77c7f888d5705348d179c0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

protocols: don't use assert on paths that can be reached

[Browse files](/lldpd/lldpd/tree/9221b5c249f9e4843f77c7f888d5705348d179c0)
Browse the repository at this point in the history

```
Malformed packets should not make lldpd crash. Ensure we can handle them
by not using assert() in this part.
```

* Loading branch information

[![@vincentbernat](https://avatars.githubusercontent.com/u/631446?s=40&v=4)](/vincentbernat)

[vincentbernat](/lldpd/lldpd/commits?author=vincentbernat "View all commits by vincentbernat")
committed
Oct 4, 2015

1 parent
[ff75b38](/lldpd/lldpd/commit/ff75b38e6f04959b654ec2e6b6e8ae8011a7ba08)

commit 9221b5c

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**19 additions**
and
**13 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/daemon

  + src/daemon/lldpd.c
    [lldpd.c](#diff-648600df7c7707b4e05700b85b40b337a2b2c3b7695ff1e4e73d86ffb6e6278f)
  + protocols

    - src/daemon/protocols/cdp.c
      [cdp.c](#diff-1d7925fb31f559c3e69bd44b8892dcd0048786693d5f2f9e0df90b93ab40b48a)
    - src/daemon/protocols/edp.c
      [edp.c](#diff-0e4256bd5ee6ef44b80bb83ee7693a894ff119289340337db26242942ae99efa)
    - src/daemon/protocols/lldp.c
      [lldp.c](#diff-47a8d31782d9395da05afcb0fa27de674fe5a1c83c77142c438fa935999c37da)
    - src/daemon/protocols/sonmp.c
      [sonmp.c](#diff-ae2362833fb0b5942cd7c80fe9877ce4e14098d45a231b7256037d63ea4f59e5)

## There are no files selected for viewing

1 change: 0 additions & 1 deletion

1
[src/daemon/lldpd.c](#diff-648600df7c7707b4e05700b85b40b337a2b2c3b7695ff1e4e73d86ffb6e6278f "src/daemon/lldpd.c")

Show comments

[View file](/lldpd/lldpd/blob/9221b5c249f9e4843f77c7f888d5705348d179c0/src/daemon/lldpd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -252,7 +252,6 @@ lldpd\_alloc\_mgmt(int family, void \*addrptr, size\_t addrsize, u\_int32\_t iface) |
|  |  | return NULL; |
|  |  | } |
|  |  | mgmt->m\_family = family; |
|  |  | assert(addrsize <= LLDPD\_MGMT\_MAXADDRSIZE); |
|  |  | memcpy(&mgmt->m\_addr, addrptr, addrsize); |
|  |  | mgmt->m\_addrsize = addrsize; |
|  |  | mgmt->m\_iface = iface; |
| Expand Down | |  |

10 changes: 7 additions & 3 deletions

10
[src/daemon/protocols/cdp.c](#diff-1d7925fb31f559c3e69bd44b8892dcd0048786693d5f2f9e0df90b93ab40b48a "src/daemon/protocols/cdp.c")

Show comments

[View file](/lldpd/lldpd/blob/9221b5c249f9e4843f77c7f888d5705348d179c0/src/daemon/protocols/cdp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,6 @@ |
|  |  | #include <unistd.h> |
|  |  | #include <errno.h> |
|  |  | #include <arpa/inet.h> |
|  |  | #include <assert.h> |
|  |  |  |
|  |  | static int |
|  |  | cdp\_send(struct lldpd \*global, |
| Expand Down  Expand Up | | @@ -438,8 +437,13 @@ cdp\_decode(struct lldpd \*cfg, char \*frame, int s, |
|  |  | mgmt = lldpd\_alloc\_mgmt(LLDPD\_AF\_IPV4, &addr, |
|  |  | sizeof(struct in\_addr), 0); |
|  |  | if (mgmt == NULL) { |
|  |  | assert(errno == ENOMEM); |
|  |  | log\_warn("cdp", "unable to allocate memory for management address"); |
|  |  | if (errno == ENOMEM) |
|  |  | log\_warn("cdp", |
|  |  | "unable to allocate memory for management address"); |
|  |  | else |
|  |  | log\_warn("cdp", |
|  |  | "too large management address received on %s", |
|  |  | hardware->h\_ifname); |
|  |  | goto malformed; |
|  |  | } |
|  |  | TAILQ\_INSERT\_TAIL(&chassis->c\_mgmt, mgmt, m\_entries); |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[src/daemon/protocols/edp.c](#diff-0e4256bd5ee6ef44b80bb83ee7693a894ff119289340337db26242942ae99efa "src/daemon/protocols/edp.c")

Show comments

[View file](/lldpd/lldpd/blob/9221b5c249f9e4843f77c7f888d5705348d179c0/src/daemon/protocols/edp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,6 @@ |
|  |  | #include <errno.h> |
|  |  | #include <arpa/inet.h> |
|  |  | #include <fnmatch.h> |
|  |  | #include <assert.h> |
|  |  |  |
|  |  | static int seq = 0; |
|  |  |  |
| Expand Down | |  |

12 changes: 7 additions & 5 deletions

12
[src/daemon/protocols/lldp.c](#diff-47a8d31782d9395da05afcb0fa27de674fe5a1c83c77142c438fa935999c37da "src/daemon/protocols/lldp.c")

Show comments

[View file](/lldpd/lldpd/blob/9221b5c249f9e4843f77c7f888d5705348d179c0/src/daemon/protocols/lldp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,7 +20,6 @@ |
|  |  |  |
|  |  | #include <unistd.h> |
|  |  | #include <errno.h> |
|  |  | #include <assert.h> |
|  |  | #include <time.h> |
|  |  | #include <sys/types.h> |
|  |  | #include <sys/socket.h> |
| Expand Down  Expand Up | | @@ -161,7 +160,7 @@ static int \_lldp\_send(struct lldpd \*global, |
|  |  | /\* Management addresses \*/ |
|  |  | TAILQ\_FOREACH(mgmt, &chassis->c\_mgmt, m\_entries) { |
|  |  | proto = lldpd\_af\_to\_lldp\_proto(mgmt->m\_family); |
|  |  | assert(proto != LLDP\_MGMT\_ADDR\_NONE); |
|  |  | if (proto == LLDP\_MGMT\_ADDR\_NONE) continue; |
|  |  | if (!( |
|  |  | POKE\_START\_LLDP\_TLV(LLDP\_TLV\_MGMT\_ADDR) && |
|  |  | /\* Size of the address, including its type \*/ |
| Expand Down  Expand Up | | @@ -749,9 +748,12 @@ lldp\_decode(struct lldpd \*cfg, char \*frame, int s, |
|  |  | iface = 0; |
|  |  | mgmt = lldpd\_alloc\_mgmt(af, addr\_ptr, addr\_length, iface); |
|  |  | if (mgmt == NULL) { |
|  |  | assert(errno == ENOMEM); |
|  |  | log\_warn("lldp", "unable to allocate memory " |
|  |  | "for management address"); |
|  |  | if (errno == ENOMEM) |
|  |  | log\_warn("lldp", "unable to allocate memory " |
|  |  | "for management address"); |
|  |  | else |
|  |  | log\_warn("lldp", "too large management address " |
|  |  | "received on %s", hardware->h\_ifname); |
|  |  | goto malformed; |
|  |  | } |
|  |  | TAILQ\_INSERT\_TAIL(&chassis->c\_mgmt, mgmt, m\_entries); |
| Expand Down | |  |

8 changes: 5 additions & 3 deletions

8
[src/daemon/protocols/sonmp.c](#diff-ae2362833fb0b5942cd7c80fe9877ce4e14098d45a231b7256037d63ea4f59e5 "src/daemon/protocols/sonmp.c")

Show comments

[View file](/lldpd/lldpd/blob/9221b5c249f9e4843f77c7f888d5705348d179c0/src/daemon/protocols/sonmp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,7 +24,6 @@ |
|  |  | #include <unistd.h> |
|  |  | #include <errno.h> |
|  |  | #include <arpa/inet.h> |
|  |  | #include <assert.h> |
|  |  |  |
|  |  | static struct sonmp\_chassis sonmp\_chassis\_types[] = { |
|  |  | {1, "unknown (via SONMP)"}, |
| Expand Down  Expand Up | | @@ -358,8 +357,11 @@ sonmp\_decode(struct lldpd \*cfg, char \*frame, int s, |
|  |  | } |
|  |  | mgmt = lldpd\_alloc\_mgmt(LLDPD\_AF\_IPV4, &address, sizeof(struct in\_addr), 0); |
|  |  | if (mgmt == NULL) { |
|  |  | assert(errno == ENOMEM); |
|  |  | log\_warn("sonmp", "unable to allocate memory for management address"); |
|  |  | if (errno == ENOMEM) |
|  |  | log\_warn("sonmp", "unable to allocate memory for management address"); |
|  |  | else |
|  |  | log\_warn("sonmp", "too large management address received on %s", |
|  |  | hardware->h\_ifname); |
|  |  | goto malformed; |
|  |  | } |
|  |  | TAILQ\_INSERT\_TAIL(&chassis->c\_mgmt, mgmt, m\_entries); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9221b5c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flldpd%2Flldpd%2Fcommit%2F9221b5c249f9e4843f77c7f888d5705348d179c0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


