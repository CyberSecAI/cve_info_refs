Based on the provided information, here's an analysis of CVE-2015-8504:

**Root cause of vulnerability:**

*   The vulnerability lies in the VNC display driver within QEMU. It is triggered by processing 'SetPixelFormat' messages sent from a VNC client to the server. Specifically, the issue is an arithmetic exception due to the VNC client setting 'red-max', 'green-max', and 'blue-max' values to zero. This leads to a floating-point exception during frame buffer updates in the `write_png_palette` function.

**Weaknesses/vulnerabilities present:**

*   Arithmetic exception (specifically a floating-point exception)
*   Improper input validation/handling. The VNC server does not properly validate the maximum color values sent by client before using them in calculations.

**Impact of exploitation:**

*   Denial-of-service (DoS) via application crash: The arithmetic exception causes QEMU to crash, leading to a denial of service for the virtual machine.

**Attack vectors:**

*   Remote attack: A privileged remote VNC client can send specially crafted 'SetPixelFormat' messages to the vulnerable QEMU VNC server.

**Required attacker capabilities/position:**

*   The attacker needs to have network access to the QEMU instance's VNC port.
*   The attacker needs to be able to send VNC protocol messages to the server, usually as a privileged VNC client.

**Additional details:**

*   The `SetPixelFormat` is a VNC message that allows the client to specify how color information is structured, including maximum RGB color values. The vulnerability occurs in ui/vnc.c in the `set_pixel_format` function.
*   The vulnerability can be triggered by setting the 'red-max', 'green-max', and 'blue-max' values in the `SetPixelFormat` message to zero, causing a divide-by-zero error during calculations.
*   The issue was discovered by Lian Yihan of Qihoo 360 Inc.
*   Red Hat rated the impact as moderate, and does not plan to address this in future updates for RHEL 5 & 6.
*   Patches were created by the QEMU project to address the vulnerability