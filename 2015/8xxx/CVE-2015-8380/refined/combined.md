=== Content from blog.fuzzing-project.org_7a3d9246_20250125_214032.html ===

[Skip to content](#content)
[# The Fuzzing Project

Blog and Advisories](https://blog.fuzzing-project.org/)

Quicksearch

## Navigation

* [Back to main page](https://fuzzing-project.org/)
* [Software list](https://fuzzing-project.org/software.html)

## [Heap Overflow in PCRE](/29-Heap-Overflow-in-PCRE.html)

Posted by [Hanno Böck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Tuesday, November 24. 2015

The Perl Compatible Regular Expressions (PCRE) library has just released a new version which fixes a number of security issues.

Fuzzing the pcretest tool uncovered an input leading to a heap overflow in the function pcre\_exec. This bug was found with the help of american fuzzy lop and address sanitizer.

[Upstream bug #1637](https://bugs.exim.org/show_bug.cgi?id=1637)

This is fixed in [PCRE 8.38](https://lists.exim.org/lurker/message/20151123.125009.80e5ac05.en.html). There are two variants of PCRE, the classic one and PCRE2. PCRE2 is not affected.

Appart from that a couple of other vulnerabilities found by other people have been fixed in this release:

[Stack overflow in compile\_regex (bug #1503)](https://bugs.exim.org/show_bug.cgi?id=1503)

[Heap overflow in compile\_regex (bug #1672)](https://bugs.exim.org/show_bug.cgi?id=1672)

[Stack overflow in compile\_regex (bug #1515)](https://bugs.exim.org/show_bug.cgi?id=1515)

[Heap overflow in compile\_regex (bug #1636, CVE-2015-3210)](https://bugs.exim.org/show_bug.cgi?id=1636)

[Stack overflow in match (bug #1638, CVE-2015-3217)](https://bugs.exim.org/show_bug.cgi?id=1638)

[Heap overflow in compile\_regex (bug #1667)](https://bugs.exim.org/show_bug.cgi?id=1667)

(this list may be incomplete)

If you use PCRE with potentially untrusted regular expressions you should update immediately. There is no immediate risk if you use regular expressions from a trusted source with an untrusted input.

[0 Comments](/29-Heap-Overflow-in-PCRE.html#comments "0 Comments, 0 Trackbacks")

### Trackbacks

[Trackback specific URI for this entry](https://blog.fuzzing-project.org/comment.php?type=trackback&entry_id=29 "This link is not meant to be clicked. It contains the trackback URI for this entry. You can use this URI to send ping- & trackbacks from your own blog to this entry. To copy the link, right click and select \"Copy Shortcut\" in Internet Explorer or \"Copy Link Location\" in Mozilla.")

No Trackbacks

### Comments

Display comments as
[Linear](/index.php?url=29-Heap-Overflow-in-PCRE.html&serendipity%5Bcview%5D=linear#comments) | Threaded

No comments

### Add Comment

Name

Email

Homepage

Comment

In reply to
[ Top level ]

Phone\*

What is six minus five?

Enclosing asterisks marks text as bold (\*word\*), underscore are made via \_word\_.Standard emoticons like :-) and ;-) are converted to images.E-Mail addresses will not be displayed and will only be used for E-Mail notifications.

To prevent automated Bots from commentspamming, please enter the string you see in the image below in the appropriate input box. Your comment will only be submitted if the strings match. Please ensure that your browser supports and accepts cookies, or your comment cannot be verified correctly.
![CAPTCHA](https://blog.fuzzing-project.org/plugin/captcha_699760b1e890163db8fcdb14df51cf3e "Enter the string you see here in the input box!")
Enter the string from the spam-prevention image above:

Form options
Remember Information?

Subscribe to this entry

## Sidebar

### The Fuzzing Project

You may want to go [back to the Fuzzing Project's main page](https://fuzzing-project.org/) or [software list](https://fuzzing-project.org/software/).

### Archives

* [January 2025](/archives/2025/01.html "January 2025")
* [December 2024](/archives/2024/12.html "December 2024")
* [November 2024](/archives/2024/11.html "November 2024")
* [Recent...](/index.php?frontpage)
* [Older...](https://blog.fuzzing-project.org/archive)

### Categories

* [![XML](/templates/2k11/img/xml.gif)](/feeds/categories/1-advisories.rss) [advisories](/categories/1-advisories)

### Syndicate This Blog

* [![XML](/templates/2k11/img/subtome.png)](https://blog.fuzzing-project.org/feeds/index.rss2)
* [![XML](/templates/2k11/img/xml.gif)](https://blog.fuzzing-project.org/feeds/comments.rss2)
  [Comments](https://blog.fuzzing-project.org/feeds/comments.rss2)

Powered by [Serendipity](http://s9y.org) & the *2k11* theme.



=== Content from www.openwall.com_717c893d_20250125_214032.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2015/11/28/3) [[next>]](2) [[<thread-prev]](../../../2015/11/25/4) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151129040103.E8DA86C018F@smtpvmsrv1.mitre.org>
Date: Sat, 28 Nov 2015 23:01:03 -0500 (EST)
From: cve-assign@...re.org
To: hanno@...eck.de
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Heap Overflow in PCRE

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

This is a somewhat complex situation for several reasons, including
previously assigned CVE IDs that may be related to duplicate
discoveries, and the nature of the findings themselves.

Most PCRE findings have a requirement that the attacker is able to
provide an arbitrary regular expression in a way that crosses a
privilege boundary.
<http://www.pcre.org/current/doc/html/pcre2pattern.html> implies that
this is relevant to the PCRE security model, i.e., the reference to
"applications that allow their users to supply patterns." We've
mentioned this before in
<http://www.openwall.com/lists/oss-security/2015/09/08/8> but we're
still unaware of any specific application that meets this requirement
(the closest we found was <http://stackoverflow.com/questions/2371445>).
Also, these PCRE problems are not the same as a "regex injection"
problem within an application (see IDS08-J on the
securecoding.cert.org web site); they are cases where the legitimate
user is supposed to know what a regular expression is, and is expected
to construct a useful one. Accordingly, CVE IDs might have little
practical value.

Because mitigating the CVEs is rarely necessary, it might be reasonable
to restrict CVE ID assignments to cases with certain types of impacts.

Another factor that is relevant here is that some PCRE CVEs have been
based on information that wasn't public at the time of CVE ID
assignments.

> <https://blog.fuzzing-project.org/29-Heap-Overflow-in-PCRE.html>

This report relates to the PCRE changelog:

   <http://vcs.pcre.org/pcre/code/trunk/ChangeLog?view=markup>

> Fuzzing the pcretest tool uncovered an input leading to a heap
> overflow in the function pcre_exec. This bug was found with
> the help of american fuzzy lop and address sanitizer.
> Upstream bug #1637

This seems to be changelog item 10 in 8.38.

> Apart from that a couple of other vulnerabilities found by
> other people have been fixed in this release:

> Heap overflow in compile_regex (bug #1667)
> Heap overflow in compile_regex (bug #1672)

Both of these seem to be changelog item 7 in 8.38.

> Stack overflow in compile_regex (bug #1515)

Another one from a similar time was bug #1503.

Although 8.38 has these fixed, it seems that they are earlier bugs
that were originally fixed in 8.36: 1503 is changelog item 19 in 8.36,
whereas 1515 is changelog item 20 in 8.36. MITRE happens to have
received multiple credible reports of discovering these issues. 1503
was assigned CVE-2015-2327 months ago, and 1515 was assigned
CVE-2015-2328 at the same time. These CVE IDs are used, at least, in:

  <http://www.fortiguard.com/advisory/FG-VD-15-010/>
  <http://www.fortiguard.com/advisory/FG-VD-15-014/>

Several other 8.38 changelog entries appear to meet an arbitrary
cutoff of impact specificity that might be reasonable for this type of
the-input-might-be-untrusted-but-usually-isn't scenario:

  3, 4, 5, 6, 8, 18, 21, 22, 23, 27, 28, 31, 36

28 is unlike the others. A possible threat model is that "pcregrep -q"
is called from a CGI script, and the attacker is able to provide a
binary file in an attempt to learn details about what the script is
looking for. (This isn't expected to be very common, but may be more
common than an attacker who is able to provide an arbitrary regular
expression.)

Finally, here are two other PCRE issues that have been discussed on
oss-security recently:

 - <https://bugs.exim.org/show_bug.cgi?id=1537> (this is changelog item
   1 in 8.37)

 - <https://bugs.php.net/bug.php?id=70345> [2015-08-25 11:10 UTC] says
   "the PCRE dev does not consider this a bug. So it probably hasn't
   been/won't be changed in PCRE."

We think what would be reasonable is for us to assign CVE IDs soon so
that there is coverage of all of the PCRE issues listed above, i.e.,

  8.38 changelog items:  3, 4, 5, 6, 7, 8, 10, 18, 21, 22, 23, 27, 28, 31, 36

  8.37 changelog item:  1

(It is possible that we may need to change the strategy for PCRE CVE
coverage in the future.) If there's something wrong -- especially if
1503 or 1515 wasn't fixed in 8.36 -- please let us know.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWWndbAAoJEL54rhJi8gl5Ki8QAMXLzwar3Bn+C8nCnU6WNgKg
QyeOOXjnDrXxUAFlw5SsMgKMecEPBLyXjav6Zr7d4b29VmvT3Y1lbiimXC1Funkd
dtT/UOlMmrWhcW8PvetbgS4YMc/YOIa+XDHoEka+fUafzEdXOQXilNH5xoMQJb0+
uoFNjrtoo/sXzG9tuuZ6NxGNsUrC3c/sdGboAImQWhFBG3pl98dHyJdIkURNVVaY
iYH+m+wDuija8tcq0U+sX7SKyh/gGOho07oYK7Cpe2grXQpbeEU+bhrTD4BL//SQ
f+hvXJMrdVUVdvd6/owMvDVOdGMN9WBq/+azRY3sN8de+nGxpNv3yy7NcDyScDQg
SUevQbp9WyPJWJOtvvB0Dsx9XL0EWgW0wMqBFx/35CtSxbgVwEJczd1T6sqDE3w7
6EUCmxirhjJFE+ppgr9Q17E4V5Jtsh3Wf7L+R8dVvRMMFmFvIjtqHmbAu9MkDukP
/trl//ApdrntKykhVxrkqROTmTS5OZX3nQ3G49VR+eAHwWXfHLIV09DXOi9YbEo6
efmaB1cLyN6C6vvLHewwytpFzLdjX9Mtd1mCaCETDCKd/m4ak425XHfQIVd9OOPv
gVsGSETPyI3wNyginhnqnUe9QY8ygI9Til9HSl58Q3zX3L+95ZGiTjICPagO1guL
MoiX6BkJiBSD+aCt3Olh
=HdYk
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bto.bluecoat.com_60a8519b_20250125_214034.html ===




=== Content from bugs.exim.org_28b127ea_20250125_214035.html ===


| Bugzilla – Access Denied |
| --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=1637&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=1637&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

## Related documentation

* [Creating an account](docs/html/myaccount.html)

| You are not authorized to access bug #1637. To see this bug, you must first [log in to an account](show_bug.cgi?id=1637&GoAheadAndLogIn=1) with the appropriate permissions. |
| --- |

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=1637&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=1637&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.gentoo.org_e3b1c378_20250125_214036.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libpcre: Multiple Vulnerabilities — GLSA **201607-02**

Multiple vulnerabilities have been found in libpcre, the worst of
which could lead to arbitrary code execution, or cause a Denial of Service
condition.

### Affected packages

| Package | **dev-libs/libpcre** on all architectures |
| --- | --- |
| Affected versions | < **8.38-r1** |
| Unaffected versions | >= **8.38-r1** |

### Background

libpcre is a library providing functions for Perl-compatible regular
expressions.

### Description

Multiple vulnerabilities have been discovered in libpcre. Please review
the CVE identifiers referenced below for details.

### Impact

An attacker can possibly execute arbitrary code or create a Denial of
Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libpcre users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-libs/libpcre-8.38-r1"

```
### References

* [CVE-2014-8964](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8964)
* [CVE-2014-8964](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8964)
* [CVE-2015-5073](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-5073)
* [CVE-2015-5073](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-5073)
* [CVE-2015-5073](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-5073)
* [CVE-2015-8380](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8380)
* [CVE-2015-8381](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8381)
* [CVE-2015-8383](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8383)
* [CVE-2015-8384](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8384)
* [CVE-2015-8385](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8385)
* [CVE-2015-8386](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8386)
* [CVE-2015-8387](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8387)
* [CVE-2015-8388](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8388)
* [CVE-2015-8389](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8389)
* [CVE-2015-8390](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8390)
* [CVE-2015-8391](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8391)
* [CVE-2015-8392](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8392)
* [CVE-2015-8393](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8393)
* [CVE-2015-8394](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8394)
* [CVE-2015-8395](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8395)
* [CVE-2016-1283](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1283)
* [CVE-2016-1283](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1283)

**Release date**

July 09, 2016

**Latest revision**

July 09, 2016: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [529952](https://bugs.gentoo.org/show_bug.cgi?id=529952)
* [551240](https://bugs.gentoo.org/show_bug.cgi?id=551240)
* [553300](https://bugs.gentoo.org/show_bug.cgi?id=553300)
* [570694](https://bugs.gentoo.org/show_bug.cgi?id=570694)
* [575546](https://bugs.gentoo.org/show_bug.cgi?id=575546)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


