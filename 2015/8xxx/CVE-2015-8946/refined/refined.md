```
Message-Id: <20160714180943.CEF62B2E017@smtpvbsrv1.mitre.org>
Date: Thu, 14 Jul 2016 14:09:43 -0400 (EDT)
From: cve-assign@...re.org
To: tyhicks@...onical.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Requests: Information exposure caused by ecryptfs-setup-swap failures

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> ecryptfs-setup-swap script that is provided by the upstream
> ecryptfs-utils project. The script can be used to convert an existing,
> unencrypted swap partition into a swap partition that is encrypted.
> System admins may use this tool and the Ubuntu installer uses it when
> the user opts into home directory encryption.
>
> On systems using systemd 211 or newer and GPT partitioning, the
> unencrypted swap partition was being automatically activated during boot
> and the encrypted swap was not used. This was due to ecryptfs-setup-swap
> not marking the swap partition as "no-auto", as defined by the
> Discoverable Partitions Spec

> ecryptfs-setup-swap improperly configures encrypted swap when using GPT
> partitioning
> Bug: <https://launchpad.net/bugs/1447282>
> Fix: <https://bazaar.launchpad.net/~ecryptfs/ecryptfs/trunk/revision/857>
> (Please ignore the inaccurate commit message for commit 857)

Use CVE-2015-8946.

> ecryptfs-setup-swap improperly configures encrypted swap when using GPT
> partitioning on a NVMe or MMC drive. This bug is due to an incomplete
> fix for bug 1447282.
> Bug: <https://launchpad.net/bugs/1597154>
> Fix: <https://bazaar.launchpad.net/~ecryptfs/ecryptfs/trunk/revision/882>

Use CVE-2016-6224.
```

Based on the provided content, this is a **CVE ID assignment confirmation**, not a detailed analysis of the vulnerability itself. The email assigns CVE-2015-8946 to the issue described below.

**Root cause of vulnerability:** The `ecryptfs-setup-swap` script, used to encrypt swap partitions, failed to mark the underlying unencrypted swap partition as "no-auto" when using GPT partitioning with systemd version 211 or newer. This caused the unencrypted swap to be activated during boot, instead of the encrypted swap.

**Weaknesses/vulnerabilities present:** The vulnerability lies in the improper configuration of encrypted swap due to the script not marking unencrypted swap partitions as "no-auto". This can lead to the usage of unencrypted swap, which is a security risk.

**Impact of exploitation:** An attacker could potentially gain access to sensitive information stored in swap due to the failure of the encrypted swap being activated.

**Attack vectors:** The attack vector is the system boot process. If a system with this vulnerability has the encrypted swap improperly set up, the system would activate the unencrypted swap, making the data accessible.

**Required attacker capabilities/position:** No specific attacker capabilities or position is mentioned in the provided content, just the system must have GPT partitioning, systemd version 211+, and an encrypted home directory and swap, in order for the vulnerability to be triggered. The attacker would need to have access to the system's swap partition to leverage the vulnerability.