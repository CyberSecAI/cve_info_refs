```
Message-Id: <20160617193519.1646CABC216@smtpvmsrv1.mitre.org>
Date: Fri, 17 Jun 2016 15:35:19 -0400 (EDT)
From: cve-assign@...re.org
To: hanno@...eck.de
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Many invalid memory access issues in libarchive

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <https://blog.fuzzing-project.org/47-Many-invalid-memory-access-issues-in-libarchive.html>

> libarchive version 3.2.0 (released on April 30th) fixed a large number
> of memory access bugs that I reported to them a while ago.
> <https://github.com/libarchive/libarchive/issues/548>
> Undefined behavior / signed integer overflow in TAR parser

Use CVE-2015-8933.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXZFBlAAoJEHb/MwWLVhi2IvcQAJLbWv3xlaskqSfuSLpe58Q8
fitvzzYGjb3vz/A6HFkIoPImxyokCMCljw0IQbeRLamFuwhaDnswDpLE2kdspX90
8z7lnmoZvK29d0bmlPlOSrkHHwBM7d0J5AtxL+VdNCZ+l+75e1oKUQNxd5Vkugll
3KQzmBr2ZO9bRhlrTfviY/D5T+dH0H/PnjO5kL2FaSPQylam2CRRWv2O6N8BWDCY
qOibiC4Tz269lawxcM1mxJIvFVuXaomKGaXp1+F91cuUfV1/t7aUAMlSjUc3ASL4
6rkWAy8WDlk24ZKG7mLv8t5V+fcDxLNNJLryWuRB8IqcBgFRuac3QPtvm2dw4j2Q
7ioHgjCISvfmh08a341SIG1vMdBfq+lCgp3IGom3mjSf38I/x0dcxCIXAd3ZMSVr
ApguzBuW6mTW8Xr/Eiqa8QyJ9HbvZS/Io5Qp/ki3O0LAKrHf2cLyzd/M1aNZFBK+
AmPlK39wuxDGDNZPIBV0v5eVvAq3ljE8XhdrGN8wxq5+UAeUDsaIOksWRFWXmji2
iEHhReLq3Z3zCEIoo9UADeOwrh36Ucq7P+EgmTd3YmX1H21tT2cIuRCdj095rzJV
dVTMARdB7vs60X5kXj1dVl5GLEaVa2wZ7AP34AutJI8WNbn86eL0Tcw/vRvv2Jxl
TCeZY1uY1URj4l8tvMpU
=TTkk
-----END PGP SIGNATURE-----
```
The content relates to CVE-2015-8933.

- **Root cause of vulnerability:** Signed integer overflow in the `archive_read_format_tar_skip` function within the TAR parser.
- **Weaknesses/vulnerabilities present:** Undefined behavior due to signed integer overflow.
- **Impact of exploitation:** Denial of service (crash).
- **Attack vectors:**  By processing a specially crafted TAR file.
- **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by `libarchive`.
```
Message-ID: <20160617145146.710ad5de@pc1>
Date: Fri, 17 Jun 2016 14:51:46 +0200
From: Hanno Böck <hanno@...eck.de>
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: Many invalid memory access issues in libarchive

<https://blog.fuzzing-project.org/47-Many-invalid-memory-access-issues-in-libarchive.html>

libarchive version 3.2.0 (released on April 30th) fixed a large number
of memory access bugs that I reported to them a while ago.
<https://github.com/libarchive/libarchive/issues/548>
Undefined behavior / signed integer overflow in TAR parser
<https://crashes.fuzzing-project.org/libarchive-undefined-signed-overflow.tar>
Sample file
```
This content provides context on the discovery of multiple vulnerabilities, including the one associated with CVE-2015-8933, in libarchive. The vulnerability was found using American Fuzzy Lop and Undefined Behavior Sanitizer. It provides a sample file to reproduce the issue.

- **Root cause of vulnerability:** Signed integer overflow in the TAR parser.
- **Weaknesses/vulnerabilities present:** Undefined behavior due to signed integer overflow.
-  **Impact of exploitation:** Program crash due to undefined behavior.
-  **Attack vectors:**  Processing a crafted TAR file.
- **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by libarchive.
```
# undefined behaviour / signed integer overflow in archive_read_format_tar_skip() #548
Using this malformed tar file with "bsdtar -tf [input]" will cause a signed integer overflow:

<https://crashes.fuzzing-project.org/libarchive-undefined-signed-overflow.tar>

Signed integer overflows are undefined in C. This can be seen by compiling libarchive with -fsanitize=undefined.

Here's the crash dump:

\307q\005\bo\002\244\201\350\003\350\003libarchive/archive_read_support_format_tar.c:612:10: runtime error: signed integer overflow: 9223372036854775807 + 1 cannot be represented in type 'long'

#0 0x96c665 in archive_read_format_tar_skip /f/libarchive/libarchive/libarchive/archive_read_support_format_tar.c:612:2

[#1](https://github.com/libarchive/libarchive/pull/1) 0x607044 in archive_read_data_skip /f/libarchive/libarchive/libarchive/archive_read.c:914:8
```
This GitHub issue report provides specific details of the vulnerability. It highlights the signed integer overflow in the `archive_read_format_tar_skip()` function of the libarchive library when parsing a crafted TAR file. A crash dump is provided, showing the exact location of the vulnerability.

-   **Root cause of vulnerability:** Signed integer overflow in the `archive_read_format_tar_skip()` function.
-   **Weaknesses/vulnerabilities present:** Signed integer overflow resulting in undefined behavior.
-   **Impact of exploitation:** Program crash (denial of service).
-   **Attack vectors:** Processing a crafted TAR file.
-   **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by `bsdtar` or similar tool.
```
# CVE-2015-8933
#### Description
Integer overflow in the archive_read_format_tar_skip function in archive_read_support_format_tar.c in libarchive before 3.2.0 allows remote attackers to cause a denial of service (crash) via a crafted tar file.
```
This SUSE entry provides the official CVE description of the vulnerability.

-   **Root cause of vulnerability:** Integer overflow in `archive_read_format_tar_skip` function.
-   **Weaknesses/vulnerabilities present:** Integer overflow leading to a crash.
-   **Impact of exploitation:** Denial of service (crash).
-  **Attack vectors:** Processing a specially crafted TAR file.
- **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by libarchive.
```
Multiple integer overflows in the (1) get_time_t_max and (2) get_time_t_min functions in archive_read_support_format_mtree.c in libarchive before 3.2.0 allow remote attackers to have unspecified impact via a crafted mtree file, which triggers undefined behavior.
```
This content is **UNRELATED** to CVE-2015-8933, as it describes vulnerabilities related to the mtree parser, not the tar parser.

```
libarchive version 3.2.0 (released on April 30th) fixed a large number of memory access bugs that I reported to them a while ago. All issues (except the test suite failure) were found with the help of american fuzzy lop and either address sanitizer or undefined behavior sanitizer.
Undefined behavior / signed integer overflow in TAR parser(https://github.com/libarchive/libarchive/issues/548)
Sample file(https://crashes.fuzzing-project.org/libarchive-undefined-signed-overflow.tar)
CVE-2015-8933(https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8933)
```
This blog entry summarizes the discovery of multiple libarchive vulnerabilities, including CVE-2015-8933, using fuzzing techniques and sanitizers. It confirms that the signed integer overflow vulnerability exists in the TAR parser, and provides a sample file.

-   **Root cause of vulnerability:** Signed integer overflow in the TAR parser.
-   **Weaknesses/vulnerabilities present:** Undefined behavior due to signed integer overflow.
-   **Impact of exploitation:** Program crash.
-   **Attack vectors:**  By processing a specially crafted TAR file.
-  **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by libarchive.
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Debian Security Advisory DSA-3657-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
August 30, 2016                       <https://www.debian.org/security/faq>
Package        : libarchive
CVE ID         : CVE-2015-8916 CVE-2015-8917 CVE-2015-8919 CVE-2015-8920
                 CVE-2015-8921 CVE-2015-8922 CVE-2015-8923 CVE-2015-8925
                 CVE-2015-8926 CVE-2015-8928 CVE-2015-8930 CVE-2015-8931
                 CVE-2015-8932 CVE-2015-8933 CVE-2015-8934 CVE-2016-4300
                 CVE-2016-4302 CVE-2016-4809 CVE-2016-5844

Hanno Boeck and Marcin Noga discovered multiple vulnerabilities in
libarchive; processing malformed archives may result in denial of
service or the execution of arbitrary code.

For the stable distribution (jessie), these problems have been fixed in
version 3.1.2-11+deb8u2.

For the testing distribution (stretch), these problems have been fixed
in version 3.2.1-1.

For the unstable distribution (sid), these problems have been fixed in
version 3.2.1-1.

We recommend that you upgrade your libarchive packages.
-----BEGIN PGP SIGNATURE-----
```
This Debian Security Advisory confirms that CVE-2015-8933 was among the vulnerabilities discovered and addressed by updates to libarchive packages. It indicates that processing malformed archive files can lead to a denial of service or arbitrary code execution.
```
# CVE-2015-8932
#### Description
The compress_bidder_init function in archive_read_support_filter_compress.c in libarchive before 3.2.0 allows remote attackers to cause a denial of service (crash) via a crafted tar file, which triggers an invalid left shift.
```
This SUSE entry is **UNRELATED** to CVE-2015-8933 as it describes CVE-2015-8932 which is related to an invalid shift left in a different function.
```
SUSE Security Update: Security update for libarchive
Announcement ID: SUSE-SU-2016:1909-1
References: #984990 #985609 #985665 #985669 #985673 #985675
#985679 #985682 #985685 #985688 #985689 #985697
#985698 #985700 #985703 #985704 #985706 #985826
#985832 #985835
Cross-References: CVE-2015-8918 CVE-2015-8919 CVE-2015-8920
CVE-2015-8921 CVE-2015-8922 CVE-2015-8923
CVE-2015-8924 CVE-2015-8925 CVE-2015-8926
CVE-2015-8928 CVE-2015-8929 CVE-2015-8930
CVE-2015-8931 CVE-2015-8932 CVE-2015-8933
CVE-2015-8934 CVE-2016-4300 CVE-2016-4301
CVE-2016-4302 CVE-2016-4809
Description:
libarchive was updated to fix 20 security issues.
These security issues were fixed:
...
- CVE-2015-8933: Undefined behavior / signed integer overflow in TAR parser (bsc#985688).
...
```
This openSUSE security update announces that CVE-2015-8933 has been addressed, specifically highlighting a signed integer overflow issue in the TAR parser. It mentions that it was fixed along with 19 other vulnerabilities.

-   **Root cause of vulnerability:** Signed integer overflow in the TAR parser.
-  **Weaknesses/vulnerabilities present:** Undefined behavior due to signed integer overflow.
-   **Impact of exploitation:** Program crash.
-   **Attack vectors:** By providing a malformed TAR file.
-  **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by libarchive.
```
# Invalid read in function copy_from_lzss_window() when unpacking malformed rar #521
Original [issue 413](https://code.google.com/p/libarchive/issues/detail?id=413) created by Google Code user `hanno@hboeck.de` on 2015-03-05T09:37:02.000Z:
```
This GitHub issue is **UNRELATED** as it discusses a vulnerability in the RAR parser related to a heap buffer overflow, not the integer overflow in the TAR parser described in CVE-2015-8933.
```
USN-3033-1: libarchive vulnerabilities
Hanno Böck discovered that libarchive contained multiple security issues
when processing certain malformed archive files. A remote attacker could
use this issue to cause libarchive to crash, resulting in a denial of
service, or possibly execute arbitrary code. ([CVE-2015-8916](/security/CVE-2015-8916), [CVE-2015-8917](/security/CVE-2015-8917)
[CVE-2015-8919](/security/CVE-2015-8919), [CVE-2015-8920](/security/CVE-2015-8920), [CVE-2015-8921](/security/CVE-2015-8921), [CVE-2015-8922](/security/CVE-2015-8922), [CVE-2015-8923](/security/CVE-2015-8923),
[CVE-2015-8924](/security/CVE-2015-8924), [CVE-2015-8925](/security/CVE-2015-8925), [CVE-2015-8926](/security/CVE-2015-8926), [CVE-2015-8928](/security/CVE-2015-8928), [CVE-2015-8930](/security/CVE-2015-8930),
[CVE-2015-8931](/security/CVE-2015-8931), [CVE-2015-8932](/security/CVE-2015-8932), [CVE-2015-8933](/security/CVE-2015-8933), [CVE-2015-8934](/security/CVE-2015-8934), [CVE-2016-5844](/security/CVE-2016-5844))

Marcin "Icewall" Noga discovered that libarchive contained multiple
security issues when processing certain malformed archive files. A remote
attacker could use this issue to cause libarchive to crash, resulting in a
denial of service, or possibly execute arbitrary code. ([CVE-2016-4300](/security/CVE-2016-4300),

[CVE-2016-4302](/security/CVE-2016-4302))

It was discovered that libarchive incorrectly handled memory allocation
with large cpio symlinks. A remote attacker could use this issue to
possibly cause libarchive to crash, resulting in a denial of service.
([CVE-2016-4809](/security/CVE-2016-4809))
```
This Ubuntu Security Notice confirms that CVE-2015-8933 was among a large number of vulnerabilities patched in the libarchive package. This notice indicates that processing malformed archives could lead to denial of service, and possibly arbitrary code execution.

-   **Root cause of vulnerability:** Signed integer overflow in the TAR parser, and other vulnerabilities in multiple archive formats.
-   **Weaknesses/vulnerabilities present:**  Signed integer overflow and other memory corruption issues
-   **Impact of exploitation:** Denial of service, possibly arbitrary code execution.
-   **Attack vectors:**  By processing specially crafted archive files.
-   **Required attacker capabilities/position:** Ability to provide a malformed archive to be processed by libarchive.
```
# CVE-2015-8933
#### Description
Integer overflow in the archive_read_format_tar_skip function in archive_read_support_format_tar.c in libarchive before 3.2.0 allows remote attackers to cause a denial of service (crash) via a crafted tar file.
```
This SUSE entry provides the official description of CVE-2015-8933.

-   **Root cause of vulnerability:** Integer overflow in the `archive_read_format_tar_skip` function
-   **Weaknesses/vulnerabilities present:** Integer overflow leading to a crash.
-   **Impact of exploitation:** Denial of service (crash)
-   **Attack vectors:**  By processing a crafted TAR file.
-   **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by libarchive.
```
Multiple vulnerabilities have been found in libarchive, the worst
of which allows for the remote execution of arbitrary code.
Affected versions < **3.2.2**
libarchive is a library for manipulating different streaming archive
formats, including certain tar variants, several cpio formats, and both
BSD and GNU ar variants.
A remote attacker could entice a user to open a specially crafted
archive file possibly resulting in the execution of arbitrary code with
the privileges of the process or a Denial of Service condition.
```
This Gentoo Security Advisory acknowledges that CVE-2015-8933 is among the multiple vulnerabilities identified in `libarchive`, noting that it could lead to arbitrary code execution and/or a denial of service. It recommends upgrading libarchive to version 3.2.2 or higher.

-   **Root cause of vulnerability:** Signed integer overflow in the TAR parser, and other vulnerabilities in multiple archive formats.
-   **Weaknesses/vulnerabilities present:** Integer overflows and other memory corruption issues.
-   **Impact of exploitation:**  Remote execution of arbitrary code or denial of service.
-   **Attack vectors:** By processing specially crafted archive files.
-  **Required attacker capabilities/position:** Ability to provide a malformed archive to be processed by libarchive.
```
### Upstream information
[CVE-2015-8933 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8933)
#### Description
Integer overflow in the archive_read_format_tar_skip function in archive_read_support_format_tar.c in libarchive before 3.2.0 allows remote attackers to cause a denial of service (crash) via a crafted tar file.
```
This SUSE entry provides the official CVE description from MITRE for CVE-2015-8933.

-   **Root cause of vulnerability:** Integer overflow in `archive_read_format_tar_skip` function.
-   **Weaknesses/vulnerabilities present:** Integer overflow leading to a crash.
-   **Impact of exploitation:** Denial of service (crash).
-  **Attack vectors:** Processing a specially crafted TAR file.
-  **Required attacker capabilities/position:** Ability to provide a malformed TAR archive to be processed by libarchive.
```
\307q\005\b o\002\244\201\350\003\350\003LIB ARCHIVE!!! TRAILER!!!AILER!!!
```
This content appears to be a fragment of a crafted input file for triggering a vulnerability in libarchive. However, it does not specify the CVE or provide additional information other than sample data.
```
```