=== Content from www.openwall.com_7d0d43b8_20250125_072214.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2015/12/22/11) [[next>]](2) [[<thread-prev]](../../../2015/12/22/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151223000211.455E442E1D2@smtpvbsrv1.mitre.org>
Date: Tue, 22 Dec 2015 19:02:11 -0500 (EST)
From: cve-assign@...re.org
To: ppandit@...hat.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, liuling-it@....cn
Subject: Re: CVE request Qemu: hmp: stack based OOB write in hmp_sendkey routine

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> Qemu emulator built with the Human Monitor Interface(HMP) support is
> vulnerable to an OOB write issue. It occurs while processing 'sendkey' command
> in hmp_sendkey routine, if the command argument is longer than the
> 'keyname_buf' buffer size.
>
> A user/process could use this flaw to crash the Qemu process instance
> resulting in DoS.
>
> <https://lists.gnu.org/archive/html/qemu-devel/2015-12/msg02930.html>
> <https://bugzilla.redhat.com/show_bug.cgi?id=1283926>

>> An OOB write issue was reported by Mr Ling Liu ... It occurs while
>> processing the 'sendkey' command, if the command argument was longer
>> than the 'keyname_buf[16]' buffer.

>> hmp: avoid redundant null termination of buffer

>> When processing 'sendkey' command, hmp_sendkey routine null
>> terminates the 'keyname_buf' array. This results in an OOB write
>> issue, if 'keyname_len' was to fall outside of 'keyname_buf' array.
>> Removed the redundant null termination, as pstrcpy routine already
>> null terminates the target buffer.

Use CVE-2015-8619.

This is not yet available at
<http://git.qemu.org/?p=qemu.git;a=history;f=hmp.c> but that
may be an expected place for a later update.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWeeQAAAoJEL54rhJi8gl5SqUP/jZ+NCSW5hsvkOvpcDPME24Q
JyWE7Gm5PesbYYNOMRIZjtNm3FZJWP0iKMxECyx71bksSXrnW1m2RcNus1wNxkif
UKuIRiGut2gTBIcMOKsVAKCfd7W705TJOMUEperMR8o2uKhcLQzkQ9VxrnOukIPR
jGNSCtBJT3cC2M8U1MFWnWiNErBPNrUKcRnf9ob2EtXEmM9t/nV9FMA/U8C6Ke10
i2WMJ7pbKaqxn+irai/d4MBqSKHn0caeTy5XYYPJuSMcUOw+yAocljUJkqqi456L
MxBUpY054DKqY15XpL7S1A/z/IXtvxs6eKRVIzJOvSskDDFVauJayNRi2A0w0wyM
aJ5HZPwBFPCOpCpz3nftG5UxdnxQtUDrO2BBu09T9d2Est1wCP+zxKAboUkG3SE2
+xixvZXTlqo8/f7qMVvZ58Hr1ieT5Gp5DD7AdK8wBmHlDTbGRXEAqgskgvbBZIjl
lkRpp9gXrpuiETyI08y5lxBd7Yu74f8WNxdNn5OR9Q3pWo6BPRBGRiqV5A0Z1lGB
dqV71TvYDxzphZF1bFyLV0x4L6F3XIShew1mOfD45M78Z531ZNJGo116HJiJulgB
yC+hfD8ctkaqAfHILIDuRug3oIYeD1jxqeSLixZS79ASGUtBrxnGO8eMU+ra0ZvQ
Tx6KxEwFW+HIMZvyyVdm
=BQ7m
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.gentoo.org_afef7eb1_20250125_072216.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# QEMU: Multiple vulnerabilities â€” GLSA **201604-01**

Multiple vulnerabilities have been found in QEMU, the worst of
which could lead to arbitrary code execution, or cause a Denial of Service
condition.

### Affected packages

| Package | **app-emulation/qemu** on all architectures |
| --- | --- |
| Affected versions | < **2.5.0-r2** |
| Unaffected versions | >= **2.5.0-r2** |

### Background

QEMU is a generic and open source machine emulator and virtualizer.

### Description

Multiple vulnerabilities have been discovered in QEMU. Please review the
CVE identifiers referenced below for details.

### Impact

Local users within a guest QEMU environment can execute arbitrary code
within the host or a cause a Denial of Service condition of the QEMU
guest process.

### Workaround

There is no known workaround at this time.

### Resolution

All QEMU users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/qemu-2.5.0-r2"

```
### References

* [CVE-2015-8613](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8613)
* [CVE-2015-8619](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8619)
* [CVE-2016-1714](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1714)
* [CVE-2016-1922](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1922)
* [CVE-2016-1981](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1981)
* [CVE-2016-2197](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2197)
* [CVE-2016-2198](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2198)
* [CVE-2016-2392](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2392)
* [CVE-2016-2538](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2538)
* [CVE-2016-2858](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2858)

**Release date**

April 02, 2016

**Latest revision**

April 02, 2016: 1

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [569118](https://bugs.gentoo.org/show_bug.cgi?id=569118)
* [569300](https://bugs.gentoo.org/show_bug.cgi?id=569300)
* [571560](https://bugs.gentoo.org/show_bug.cgi?id=571560)
* [572082](https://bugs.gentoo.org/show_bug.cgi?id=572082)
* [572412](https://bugs.gentoo.org/show_bug.cgi?id=572412)
* [572454](https://bugs.gentoo.org/show_bug.cgi?id=572454)
* [573280](https://bugs.gentoo.org/show_bug.cgi?id=573280)
* [573314](https://bugs.gentoo.org/show_bug.cgi?id=573314)
* [574902](https://bugs.gentoo.org/show_bug.cgi?id=574902)
* [575492](https://bugs.gentoo.org/show_bug.cgi?id=575492)
* [576420](https://bugs.gentoo.org/show_bug.cgi?id=576420)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_ea63eb5e_20250125_072213.html ===


---

[[Date Prev](msg00040.html)][[Date Next](msg00042.html)]
[[Thread Prev](msg00040.html)][[Thread Next](msg00042.html)]
[[Date Index](maillist.html#00041)]
[[Thread Index](threads.html#00041)]

# [SECURITY] [DSA 3471-1] qemu security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3471-1] qemu security update
* *From*: Sebastien Delafond <seb@debian.org>
* *Date*: Mon, 08 Feb 2016 19:45:55 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1aSrkx-000732-MQ%40seger.debian.org)Â [E1aSrkx-000732-MQ@seger.debian.org](msg00041.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3471-1                   security@debian.org
<https://www.debian.org/security/>                       Sebastien Delafond
February 08, 2016                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : qemu
CVE ID         : CVE-2015-7295 CVE-2015-7504 CVE-2015-7512 CVE-2015-7549
                 CVE-2015-8345 CVE-2015-8504 CVE-2015-8550 CVE-2015-8558 CVE-2015-8567 CVE-2015-8568 CVE-2015-8613 CVE-2015-8619 CVE-2015-8743 CVE-2015-8744 CVE-2015-8745 CVE-2016-1568 CVE-2016-1714 CVE-2016-1922 CVE-2016-1981
Debian Bug     : 799452 806373 806741 806742 808130 808131 808144 808145 809229 809232 810519 810527 811201 812307 809237 809237

Several vulnerabilities were discovered in qemu, a full virtualization
solution on x86 hardware.

CVE-2015-7295

    Jason Wang of Red Hat Inc. discovered that the Virtual Network
    Device support is vulnerable to denial-of-service, that could
    occur when receiving large packets.

CVE-2015-7504

    Qinghao Tang of Qihoo 360 Inc. and Ling Liu of Qihoo 360 Inc.
    discovered that the PC-Net II ethernet controller is vulnerable to
    a heap-based buffer overflow that could result in
    denial-of-service (via application crash) or arbitrary code
    execution.

CVE-2015-7512

    Ling Liu of Qihoo 360 Inc. and Jason Wang of Red Hat Inc.
    discovered that the PC-Net II ethernet controller is vulnerable to
    a buffer overflow that could result in denial-of-service (via
    application crash) or arbitrary code execution.

CVE-2015-7549

    Qinghao Tang of Qihoo 360 Inc. and Ling Liu of Qihoo 360
    Inc. discovered that the PCI MSI-X emulator is vulnerable to a
    null pointer dereference issue, that could lead to
    denial-of-service (via application crash).

CVE-2015-8345

    Qinghao Tang of Qihoo 360 Inc. discovered that the eepro100
    emulator contains a flaw that could lead to an infinite loop when
    processing Command Blocks, eventually resulting in
    denial-of-service (via application crash).

CVE-2015-8504

    Lian Yihan of Qihoo 360 Inc. discovered that the VNC display
    driver support is vulnerable to an arithmetic exception flaw that
    could lead to denial-of-service (via application crash).

CVE-2015-8550

    Felix Wilhelm of ERNW Research that the PV backend drivers are
    vulnerable to double fetch vulnerabilities, possibly resulting in
    arbitrary code execution.

CVE-2015-8558

    Qinghao Tang of Qihoo 360 Inc. discovered that the USB EHCI
    emulation support contains a flaw that could lead to an infinite
    loop during communication between the host controller and a device
    driver. This could lead to denial-of-service (via resource
    exhaustion).

CVE-2015-8567 CVE-2015-8568

    Qinghao Tang of Qihoo 360 Inc. discovered that the vmxnet3 device
    emulator could be used to intentionally leak host memory, thus
    resulting in denial-of-service.

CVE-2015-8613

    Qinghao Tang of Qihoo 360 Inc. discovered that the SCSI MegaRAID
    SAS HBA emulation support is vulnerable to a stack-based buffer
    overflow issue, that could lead to denial-of-service (via
    application crash).

CVE-2015-8619

    Ling Liu of Qihoo 360 Inc. discovered that the Human Monitor
    Interface support is vulnerable to an out-of-bound write access
    issue that could result in denial-of-service (via application
    crash).

CVE-2015-8743

    Ling Liu of Qihoo 360 Inc. discovered that the NE2000 emulator is
    vulnerable to an out-of-bound read/write access issue, potentially
    resulting in information leak or memory corruption.

CVE-2015-8744

   The vmxnet3 driver incorrectly processes small packets, which could
   result in denial-of-service (via application crash).

CVE-2015-8745

   The vmxnet3 driver incorrectly processes Interrupt Mask Registers,
   which could result in denial-of-service (via application crash).

CVE-2016-1568

    Qinghao Tang of Qihoo 360 Inc. discovered that the IDE AHCI
    emulation support is vulnerable to a use-after-free issue, that
    could lead to denial-of-service (via application crash) or
    arbitrary code execution.

CVE-2016-1714

    Donghai Zhu of Alibaba discovered that the Firmware Configuration
    emulation support is vulnerable to an out-of-bound read/write
    access issue, that could lead to denial-of-service (via
    application crash) or arbitrary code execution.

CVE-2016-1922

    Ling Liu of Qihoo 360 Inc. discovered that 32-bit Windows guests
    support is vulnerable to a null pointer dereference issue, that
    could lead to denial-of-service (via application crash).

CVE-2016-1981

    The e1000 driver is vulnerable to an infinite loop issue that
    could lead to denial-of-service (via application crash).

For the stable distribution (jessie), these problems have been fixed in
version 1:2.1+dfsg-12+deb8u5a.

We recommend that you upgrade your qemu packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQEcBAEBCgAGBQJWuOaQAAoJEBC+iYPz1Z1kkZIH/jyJ+TuoNYvErltzw17m6TmC
4S6G4yAm3MILtC05UsClvI5uscPlpy+VaS0LA+OjEVriCqmxQaXiY35mQFa5ptiS
/IC90wHehtBjcc3ID7tuk2HF4jIbYMvdLlXRp5e4CcfSaqQQkLqE/suozViVNSsj
YIhKRjY9jeVEuSALCkkDT8nHoT6zDWZeYeT5WegouPRO+RqxjFsLnBU+DxGqjnvc
Ty2Gw7XsBxh0Bhe9YL3eWl/QsHvTSYPkBmgHWuNG+LjSNStSzjUg3cFKQf/PLdVg
CgM5yPo3Y89YNqn3U7CEA5DsIltzqfexddUFZZtUg/bgtyhrp3djTAikCjM43sU=
=kgTM
-----END PGP SIGNATURE-----

```

---



=== Content from lists.gnu.org_28e2d403_20250125_072215.html ===


| | **qemu-devel** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=qemu-devel)

---

[[Date Prev](msg02929.html)][[Date Next](msg02931.html)][[Thread Prev](msg02925.html)][[Thread Next](msg03420.html)][[Date Index](index.html#02930)][[Thread Index](threads.html#02930)]

## [Qemu-devel] [PATCH] hmp: avoid redundant null termination of buffer

---

| **From**: | P J P |
| --- | --- |

| **Subject**: | [Qemu-devel] [PATCH] hmp: avoid redundant null termination of buffer |
| **Date**: | Thu, 17 Dec 2015 18:10:59 +0530 (IST) |

---

```

  Hello,

```
An OOB write issue was reported by Mr Ling Liu, CC'd here. It occurs while
processing the 'sendkey' command, if the command argument was longer than
```

the 'keyname_buf[16]' buffer.

===

```
> ```
>
> From b0363f4c0e91671064dd7ffece8a6923c8dcaf20 Mon Sep 17 00:00:00 2001
>
> ```

```

From: Prasad J Pandit <address@hidden>
Date: Thu, 17 Dec 2015 17:47:15 +0530
Subject: [PATCH] hmp: avoid redundant null termination of buffer

When processing 'sendkey' command, hmp_sendkey routine null
terminates the 'keyname_buf' array. This results in an OOB write
issue, if 'keyname_len' was to fall outside of 'keyname_buf' array.
Removed the redundant null termination, as pstrcpy routine already
null terminates the target buffer.

Reported-by: Ling Liu <address@hidden>
Signed-off-by: Prasad J Pandit <address@hidden>
---
 hmp.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/hmp.c b/hmp.c
index 2140605..e530c9c 100644
--- a/hmp.c
+++ b/hmp.c
@@ -1746,9 +1746,7 @@ void hmp_sendkey(Monitor *mon, const QDict *qdict)
         /* Be compatible with old interface, convert user inputted "<" */
         if (!strncmp(keyname_buf, "<", 1) && keyname_len == 1) {
             pstrcpy(keyname_buf, sizeof(keyname_buf), "less");
-            keyname_len = 4;
         }
-        keyname_buf[keyname_len] = 0;

         keylist = g_malloc0(sizeof(*keylist));
         keylist->value = g_malloc0(sizeof(*keylist->value));
--
2.4.3
===

Thank you.
--
Prasad J Pandit / Red Hat Product Security Team
47AF CE69 3A90 54AA 9045 1053 DD13 3D32 FE5B 041F

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg03420.html)] |
| --- | --- | --- |

* **[Qemu-devel] [PATCH] hmp: avoid redundant null termination of buffer**,
  *P J P*Â **<=**
  + **[Re: [Qemu-devel] [PATCH] hmp: avoid redundant null termination of buffer](msg03420.html)**, *Ã¥ÂˆÂ˜Ã¤Â»Â¤*, 2015/12/18
    - **[Re: [Qemu-devel] [PATCH] hmp: avoid redundant null termination of buffer](msg03297.html)**, *P J P*, 2015/12/17
  + **[Re: [Qemu-devel] [PATCH] hmp: avoid redundant null termination of buffer](msg04184.html)**, *Luiz Capitulino*, 2015/12/22

---

* Prev by Date:
  **[Re: [Qemu-devel] [PULL 00/40] QAPI patches for 2015-12-17](msg02929.html)**
* Next by Date:
  **[Re: [Qemu-devel] [PATCH 2/2] iotests: Don't mention bdrv\_swap in comments](msg02931.html)**
* Previous by thread:
  **[[Qemu-devel] [PATCH 0/6] AMD XGBE KVM platform passthrough](msg02925.html)**
* Next by thread:
  **[Re: [Qemu-devel] [PATCH] hmp: avoid redundant null termination of buffer](msg03420.html)**
* Index(es):
  + [**Date**](index.html#02930)
  + [**Thread**](threads.html#02930)


