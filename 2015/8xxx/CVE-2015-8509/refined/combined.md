=== Content from seclists.org_15d57c2c_20250125_144203.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](130)
[By Date](date.html#131)
[![Next](/images/right-icon-16x16.png)](132)

[![Previous](/images/left-icon-16x16.png)](130)
[By Thread](index.html#131)
[![Next](/images/right-icon-16x16.png)](132)

![](/shared/images/nst-icons.svg#search)

# Security advisory for Bugzilla 5.0.2, 4.4.11 and 4.2.16

---

*From*: LpSolit () gmail com

*Date*: Tue, 22 Dec 2015 21:50:04 GMT

---

```
Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* Unfiltered HTML injected into a dependency graph could be used to
  create a cross-site scripting attack.

* Some web browsers incorrectly parse CSV files as valid JavaScript
  code which could lead to data leak.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Cross-Site Scripting
Versions:    Bugzilla 2.6 to 4.2.15, 4.3.1 to 4.4.10, 4.5.1 to 5.0.1
Fixed In:    4.2.16, 4.4.11, 5.0.2
Description: During the generation of a dependency graph, the code for
             the HTML image map is generated locally if a local dot
             installation is used. With escaped HTML characters in a bug
             summary, it is possible to inject unfiltered HTML code in
             the map file which the CreateImagemap function generates.
             This could be used for a cross-site scripting attack.
References:  <https://bugzilla.mozilla.org/show_bug.cgi?id=1221518>
CVE Number:  CVE-2015-8508

Class:       Information Leak
Versions:    Bugzilla 2.17.1 to 4.2.15, 4.3.1 to 4.4.10, 4.5.1 to 5.0.1
Fixed In:    4.2.16, 4.4.11, 5.0.2
Description: If an external HTML page contains a <script> element with
             its src attribute pointing to a buglist in CSV format, some
             web browsers incorrectly try to parse the CSV file as valid
             JavaScript code. As the buglist is generated based on the
             privileges of the user logged into Bugzilla, the external
             page could collect confidential data contained in the CSV
             file.
References:  <https://bugzilla.mozilla.org/show_bug.cgi?id=1232785>
CVE Number:  CVE-2015-8509

Vulnerability Solutions
=======================

The fixes for these issues are included in the 4.2.16, 4.4.11 and 5.0.2
releases. Upgrading to a release with the relevant fixes will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerabilities, there are patches available for the issues at the
"References" URL for each vulnerability.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  <https://www.bugzilla.org/download/>

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix these
issues:

Issue 1 reported by: Holger Fuhrmannek
Issue 2 reported by: Mario Gomes

Fixed by: Frédéric Buclin, Dylan William Hardison,
          David Lawrence, Gervase Markham

General information about the Bugzilla bug-tracking system can be found
at:

  <https://www.bugzilla.org/>

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
<https://www.bugzilla.org/support/> has directions for accessing these
forums.

```

---

[![Previous](/images/left-icon-16x16.png)](130)
[By Date](date.html#131)
[![Next](/images/right-icon-16x16.png)](132)

[![Previous](/images/left-icon-16x16.png)](130)
[By Thread](index.html#131)
[![Next](/images/right-icon-16x16.png)](132)

### Current thread:

* **Security advisory for Bugzilla 5.0.2, 4.4.11 and 4.2.16** *LpSolit (Dec 23)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from bugzilla.mozilla.org_ba90accd_20250126_093541.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1232785)
* [XML](/show_bug.cgi?ctype=xml&id=1232785)

Closed
[Bug 1232785](/show_bug.cgi?id=1232785)
(CVE-2015-8509)

Opened 9 years ago
Closed 9 years ago

# [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers

## Categories

### (Bugzilla :: Attachments & Requests, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Attachments%20%26%20Requests#Attachments%20%26%20Requests)

Attachments & Requests
▾

Bugzilla :: Attachments & Requests
For problems with attachment creation/management and request creation/management. attachment.cgi, request.cgi
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Attachments%20%26%20Requests&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Attachments%20%26%20Requests&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Attachments%20%26%20Requests)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.17.1

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 4.2

## People

### (Reporter: netfuzzerr, Assigned: dylan)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ea4290f897444ad075f1c33fecc24f8f?d=mm&size=40)  [dylan](/user_profile?user_id=491519)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/cd44f38f61c8d163ca776119f9135402?d=mm&size=40)  [netfuzzerr](/user_profile?user_id=423436)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1229728](/show_bug.cgi?id=1229728 "RESOLVED FIXED - Security advisory for Bugzilla 5.0.2, 4.4.11 and 4.2.16"), [1234237](/show_bug.cgi?id=1234237 "RESOLVED FIXED - Backport upstream bug 1232785 to bmo/4.2 [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers")

Dependency [tree](/showdependencytree.cgi?id=1232785&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1232785)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: ES 6 `-strings + no MIME restrictions on script src + no support for x-content-options: nosniff)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2015-8509

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

ES 6 `-strings + no MIME restrictions on script src + no support for x-content-options: nosniff

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dkl](/user_profile?user_id=5898) | [approval5.0](#a261315_5898 "9 years ago") | + |
| --- | --- | --- |
| [dkl](/user_profile?user_id=5898) | approval5.0 | + |
| --- | --- | --- |
| [dkl](/user_profile?user_id=5898) | [approval4.4](#a261315_5898 "9 years ago") | + |
| --- | --- | --- |
| [dkl](/user_profile?user_id=5898) | approval4.4 | + |
| --- | --- | --- |
| [dkl](/user_profile?user_id=5898) | [approval4.2](#c94 "9 years ago") | + |
| --- | --- | --- |
| [dkl](/user_profile?user_id=5898) | approval4.2 | + |
| --- | --- | --- |
| [abillings](/user_profile?user_id=280903) | [sec-bounty](#a1112657_280903 "9 years ago") | + |
| --- | --- | --- |
| [abillings](/user_profile?user_id=280903) | sec-bounty | + |
| --- | --- | --- |
|  | approval | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 3 obsolete files)

| [poc.html](/attachment.cgi?id=8698593)  [9 years ago](#c1)  [Mario Gomes](/user_profile?user_id=423436)   728 bytes, text/html |  | [Details](/attachment.cgi?id=8698593&action=edit) |
| --- | --- | --- |
| [csv that is also javascript](/attachment.cgi?id=8698717)  [9 years ago](#c12)  [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)   838 bytes, text/plain |  | [Details](/attachment.cgi?id=8698717&action=edit) |
| [Patch v.1](/attachment.cgi?id=8699452)  [9 years ago](#c34)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   995 bytes, patch | LpSolit : [review-](#c35 "9 years ago") | [Details](/attachment.cgi?id=8699452&action=edit) | [Diff](/attachment.cgi?id=8699452&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699452) |
| [Patch v.1](/attachment.cgi?id=8699454)  [9 years ago](#c37)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   996 bytes, patch | dylan : [review-](#c43 "9 years ago") | [Details](/attachment.cgi?id=8699454&action=edit) | [Diff](/attachment.cgi?id=8699454&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699454) |
| [non-human buglist csv](/attachment.cgi?id=8699460)  [9 years ago](#c42)  [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)   850 bytes, text/plain |  | [Details](/attachment.cgi?id=8699460&action=edit) |
| [1232785\_2.patch](/attachment.cgi?id=8699589)  [9 years ago](#c70)  [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)   731 bytes, patch | dkl : [review+](#c74 "9 years ago") | [Details](/attachment.cgi?id=8699589&action=edit) | [Diff](/attachment.cgi?id=8699589&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699589) |
| [1232785\_3.patch](/attachment.cgi?id=8699686)  [9 years ago](#c75)  [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)   733 bytes, patch | dkl : [review+](#c80 "9 years ago") | [Details](/attachment.cgi?id=8699686&action=edit) | [Diff](/attachment.cgi?id=8699686&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699686) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1232785#c0)• 9 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.80 Safari/537.36
Steps to reproduce:
Hey,
I'll explain it in the next comment.
Cheers,

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1232785#c1)• 9 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=8698593)
— [Details](attachment.cgi?id=8698593&action=edit)

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1232785#c2)• 9 years ago |
|  | |

This PoC works only on Firefox.
Steps to reproduce(firefox only):
1. Go to <https://bugzilla-dev.allizom.org> and log in using my persona account
Log in: netfuzzer@yandex.com
Log in: 1111111111
2. Once you're logged to my bugzilla-dev testing account, visit <https://bugzilla.mozilla.org/attachment.cgi?id=8698593>
3. Wait until page finishes loading.
4. See my fake security bug informations(status, title, and date).
This vulnerability occurs due to the content of a CSV isn't properly sanitized, allowing me to break CSV files syntax, and make it "parseable" as javascript then I can steal victim's bugs informations.
In order to make it I have to be able to change the title of the first and the last bug listed on victim's "My bugs" page(let's supposed i'm CCed to them, then i can easily exploit this vulnerability).
Cheers,
Mario

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1232785#c3)• 9 years ago |
|  | |

Just to clarify, my personna login info are:
Log in: netfuzzer@yandex.com
Password: 1111111111

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1232785#c4)• 9 years ago |
|  | |

(In reply to Mario Gomes"'><img src=x onerror=prompt();> from [comment #2](/show_bug.cgi?id=1232785#c2 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> In order to make it I have to be able to change the title of the first and
> the last bug listed
Change how? I tested against landfill, and nothing is displayed.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1232785#c5)• 9 years ago |
|  | |

so firefox will interpret text/plain as js if it is the target of a src= tag? Does it even matter if the attachment is served by BMO or somewhere else?

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1232785#c6)• 9 years ago |
|  | |

This works from any page context, in firefox only as reported. Chrome reports this error:
"Refused to execute script from '<https://bugzilla-dev.allizom.org/buglist.cgi?bug_status=UNCONFIRMED&bug_sta…value0-0-0=UNCONFIRMED&value0-0-1=netfuzzer%40yandex.com&ctype=csv&human=1>' because its MIME type ('text/csv') is not executable, and strict MIME type checking is enabled."

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1232785#c7)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #4](/show_bug.cgi?id=1232785#c4 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Change how? I tested against landfill, and nothing is displayed.
In order to reproduce on your own, you have to add: \"; data = `
to the title of the first bug listed, also change the title of the last bug to: `;
Then copy the URL in the "CSV"(on "My bugs page") to the "SRC" attribute on the "poc.html".
(In reply to Dylan William Hardison [:dylan] from [comment #5](/show_bug.cgi?id=1232785#c5 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> so firefox will interpret text/plain as js if it is the target of a src=
> tag? Does it even matter if the attachment is served by BMO or somewhere
> else?
Yep - pretty much that. In fact, on my tests Firefox parses whatever comes up regardlessly the "content-type".
No, it doesn't matter. It'll work the same way. A good idea por a patching this would be required a security token to display buglist CSV.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1232785#c8)• 9 years ago |
|  | |

I confirmed with :ehsan that there is no client side fix for this at the moment, I will proceed with Frédéric Buclin proposed solution.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1232785#c9)• 9 years ago |
|  | |

We need [bug 471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox"), with that, we could send X-Content-Type-Options: nosniff and fix this on the client side.
At the lack of that, we should make what we send unparseable on the server side.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1232785#c10)• 9 years ago |
|  | |

(In reply to :Ehsan Akhgari from [comment #9](/show_bug.cgi?id=1232785#c9 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> We need [bug 471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox"), with that, we could send X-Content-Type-Options: nosniff
> and fix this on the client side.
Since when does Firefox do content type sniffing?? AFAIK, only IE behaves this way.

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1232785#c11)• 9 years ago |
|  | |

Great! Could this be eligible for a bounty? also, what would be appropriate sec-rate for this bug?
Possible attack would vector be:
======================
To exploit it attacker would have to control the FIRST and LAST shown on the page "My bugs"(which can be done by CC him to some old bug, and a recently created bug), after that, he would have to convince the victim to visit a specially crafted page exploiting this vulnerability and stealing all listed bugs information(report date, title and status, reporter).
======================

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1232785#c12)• 9 years ago |
|  | |

Attached file
[csv that is also javascript](attachment.cgi?id=8698717)
— [Details](attachment.cgi?id=8698717&action=edit)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1232785#c13)• 9 years ago |
|  | |

I can now reproduce the issue. The CSV format for buglists has been added in 2.17.1, see [bug 177430](/show_bug.cgi?id=177430 "RESOLVED FIXED - buglist.cgi needs a CSV output format").Assignee: general → attach-and-requestSeverity: normal → majorStatus: UNCONFIRMED → NEWComponent: Bugzilla-General → Attachments & RequestsEver confirmed: trueSummary: Bugzilla Buglist Information Disclosure Vulnerability. → [SECURITY] Attachments are able to read remote buglists containing restricted bugsTarget Milestone: --- → Bugzilla 4.4Version: unspecified → 2.17.1

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1232785#c14)• 9 years ago |
|  | |

Actually, from what I can read, this is exactly a duplicate of [bug 471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox") and/or [bug 1048535](/show_bug.cgi?id=1048535 "RESOLVED FIXED - Cross-origin info leak: [[get]] calls on global expose text (or CSV) sniffed as JS"). See these comments:
[bug 471020 comment 69](/show_bug.cgi?id=471020#c69 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox") - bz says the problem has nothing to do with the content type. If the remote file looks like a JS file, it's interpreted as a JS file.
[bug 471020 comment 41](/show_bug.cgi?id=471020#c41 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox") - Jann already describes the problem reported here.
[bug 1048535 comment 46](/show_bug.cgi?id=1048535#c46 "RESOLVED FIXED - Cross-origin info leak: [[get]] calls on global expose text (or CSV) sniffed as JS") - Jeff also confirms that the only way to fix this problem is to reject external files which do not have the correct content type.
CCing bz and jruderman for some helpful input: wait for [bug 471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox") to be fixed, i.e. Fx should only accept remote scripts with the correct content type?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1232785#c15)• 9 years ago |
|  | |

How can we fix this in Bugzilla? The CSV output is valid CSV; I don't think it's broken in any way, is it? The problem is Firefox loading it cross-site, which we can't fix.
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1232785#c16)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #15](/show_bug.cgi?id=1232785#c15 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> How can we fix this in Bugzilla? The CSV output is valid CSV; I don't think
> it's broken in any way, is it?
The CSV file is not broken. But Firefox recognizes some JS paths in it due to some strings present in the bug summaries and so it thinks it's a JS script and executes it.

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1232785#c17)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #15](/show_bug.cgi?id=1232785#c15 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> How can we fix this in Bugzilla?
As I suggested on [comment 7](/show_bug.cgi?id=1232785#c7 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"), you could require a CSRF Security-Token for displaying buglist.cgi. By doing so, there wouldnt be possible to see it directly.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1232785#c18)• 9 years ago |
|  | |

(In reply to Mario Gomes from [comment #17](/show_bug.cgi?id=1232785#c17 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> As I suggested on [comment 7](/show_bug.cgi?id=1232785#c7 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"), you could require a CSRF Security-Token for
> displaying buglist.cgi. By doing so, there wouldnt be possible to see it
> directly.
That's exactly why it's not a good idea. You cannot bookmark CSV buglists anymore, you cannot call them directly either from 3rd-party applications.

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1232785#c19)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #18](/show_bug.cgi?id=1232785#c18 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> That's exactly why it's not a good idea. You cannot bookmark CSV buglists
> anymore, you cannot call them directly either from 3rd-party applications.
OOh - I see now. Thought CSV were only supposed to be seen through "My bugs" pages.
Did some research and it turns out that CSV has a attribute to indicate the "separator char"
Example: <https://pt.wikipedia.org/wiki/Comma-separated_values>
============
sep=,
1997,Ford,E350,"ac, abs, moon",30100.00
1999,Chevy,"Venture ""Extended Edition""",,49000.00
1996,Jeep,Grand Cherokee,"MUST SELL!
air, moon roof, loaded",479699.00
============
This could be a good patch, add this "sep=," to the beginning of the file, by doing so it would still be parsed as a CSV, but wouldn't work as javascript anymore.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1232785#c20)• 9 years ago |
|  | |

(In reply to Mario Gomes from [comment #19](/show_bug.cgi?id=1232785#c19 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> This could be a good patch, add this "sep=," to the beginning of the file,
> by doing so it would still be parsed as a CSV, but wouldn't work as
> javascript anymore.
Why wouldn't it be seen as a JS script anymore?

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1232785#c21)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #20](/show_bug.cgi?id=1232785#c20 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> (In reply to Mario Gomes from [comment #19](/show_bug.cgi?id=1232785#c19 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Why wouldn't it be seen as a JS script anymore?
Because "sep=," will throw a grammar error forcing Firefox to get stucker on it and not parse the rest of the file.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1232785#c22)• 9 years ago |
|  | |

(In reply to Mario Gomes from [comment #19](/show_bug.cgi?id=1232785#c19 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> This could be a good patch, add this "sep=," to the beginning of the file,
> by doing so it would still be parsed as a CSV, but wouldn't work as
> javascript anymore.
Trouble is, that isn't in the RFC: <https://tools.ietf.org/html/rfc4180> . It's an Excel-ism. Many implementations will expect the headers on the first line. So adding this will break stuff. I don't see a way to mangle the format without also breaking something, as the header lines may well be being matched by software to know which column is which.
We can't use CORS either, AFAICS. :-|
Gerv

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1232785#c23)• 9 years ago |
|  | |

scripts from <script> tags are loaded in no-cors mode, so CORS is irrelevant...
Can we not include security sensitive bugs in CSV exports?

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1232785#c24)• 9 years ago |
|  | |

thebigbangwolf(In reply to Gervase Markham [:gerv] from [comment #22](/show_bug.cgi?id=1232785#c22 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Trouble is, that isn't in the RFC: <https://tools.ietf.org/html/rfc4180> .
> It's an Excel-ism. Many implementations will expect the headers on the first
> line. So adding this will break stuff. I don't see a way to mangle the
> format without also breaking something, as the header lines may well be
> being matched by software to know which column is which.
Good point. There's another way though: you could add one a "," to the add of the first line for the file.
=====================
"Bug ID","Product","Component","Assignee","Status","Resolution","Summary","Changed",,
=====================
Adding double comma to the end of the first line will prevent it from being parsed as JS(as it would cause a javascript grammar error). It'll stop any javascript parser and will still being a valid CSV.

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1232785#c25)• 9 years ago |
|  | |

Good point. There's another way though: you could add double comma(",,") to the end of the first line of the file.
=====================
"Bug ID","Product","Component","Assignee","Status","Resolution","Summary","Changed",,
=====================
Adding double comma to the end of the first line will prevent it from being parsed as JS(as it would cause a javascript grammar error). It'll stop any javascript parser and will still being a valid CSV.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1232785#c26)• 9 years ago |
|  | |

That is an idea we could consider. It could be that some implementations then find an empty unlabelled column, but this seems much less impactful than the other options considered. LpSolit: views?
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1232785#c27)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #26](/show_bug.cgi?id=1232785#c26 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> That is an idea we could consider. It could be that some implementations
> then find an empty unlabelled column, but this seems much less impactful
> than the other options considered. LpSolit: views?
RFC 4180 says 2 things about this:
- There maybe an optional header line appearing as the first line
of the file with the same format as normal record lines. This
header will contain names corresponding to the fields in the file
and \*should contain the same number of fields as the records in
the rest of the file\*
- Within the header and each record, there may be one or more
fields, separated by commas. Each line should contain the same
number of fields throughout the file. Spaces are considered part
of a field and should not be ignored. \*The last field in the
record must not be followed by a comma.\*
So ending the first line with a double comma would be in contradiction with both items.
re [comment 23](/show_bug.cgi?id=1232785#c23 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"): excluding non-public bugs from the CSV file would defeat the usefulness of the file. This is especially true if the Bugzilla installation requires login to access it. In that case, no bugs would be public and the CSV file would be empty. But this would be the safest approach, and wouldn't break the file format as specified by RFC 4180.
I wonder if we couldn't use a redirect to get the CSV file. Browsers are fine with redirects, and curl and wget too AFAIK. And maybe Firefox wouldn't follow the redirection into <script>, I don't know.

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1232785#c28)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #27](/show_bug.cgi?id=1232785#c27 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> I wonder if we couldn't use a redirect to get the CSV file. Browsers are
> fine with redirects, and curl and wget too AFAIK. And maybe Firefox wouldn't
> follow the redirection into <script>, I don't know.
Unfortunately, Firefox(and any other browser) will follow redirect to get the JS content.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1232785#c29)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #27](/show_bug.cgi?id=1232785#c27 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> So ending the first line with a double comma would be in contradiction with
> both items.
I agree. However, in absence of an idea to do it which does fit the file format, this seems like the least impactful option.
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1232785#c30)• 9 years ago |
|  | |

Another option is manipulating the output to disallow ES6 quoting seems to work as well.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1232785#c31)• 9 years ago |
|  | |

As in, switch the CSV library to only quote values which need quoting? Yes, that's an excellent idea. That should surely stop the parser in its tracks somewhere on line 1.
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1232785#c32)• 9 years ago |
|  | |

No, but that might work as well. I meant physically remove the ` from bug summaries.

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1232785#c33)• 9 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #32](/show_bug.cgi?id=1232785#c32 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> No, but that might work as well. I meant physically remove the ` from bug
> summaries.
Removing the: "`" won't fix this as the main problem here is the quotes("), remember it's parsed as javascript. I use \" to finish the string then I set the variable "data" stealing victim's info.
So, the better way for patching it would be remove quotes(") from the CSV.
Only removing ` won't work 'cause I can still set "data" as an array instead of a string.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a147193_491519)• 9 years ago |

Assignee: attach-and-request → dylanStatus: NEW → ASSIGNED

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1232785#c34)• 9 years ago |
|  | |

Attached patch

[Patch v.1](attachment.cgi?id=8699452&action=diff) (obsolete)
— [Details](attachment.cgi?id=8699452&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699452)

How's this? RFC is here: <https://tools.ietf.org/html/rfc4180> .
GervAssignee: dylan → gerv
[Attachment #8699452](/attachment.cgi?id=8699452&action=edit "Patch v.1") -
Flags: review?(dylan)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1232785#c35)• 9 years ago |
|  | |

Comment on [attachment 8699452](/attachment.cgi?id=8699452 "Patch v.1") [[details]](/attachment.cgi?id=8699452&action=edit "Patch v.1") [[diff]](/attachment.cgi?id=8699452&action=diff "Patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699452)
Patch v.1
>+ if ($var =~ /[\r\n,"]/) {
You must include semicolons too, because they are also used as field separator (there is a user pref to control which field separator you want).
[Attachment #8699452](/attachment.cgi?id=8699452&action=edit "Patch v.1") -
Flags: review?(dylan) → review-

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1232785#c36)• 9 years ago |
|  | |

can the list of fields be controlled by the requester? if that's the case, if you pick fields that are single words, you can still make it valid JS I think?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1232785#c37)• 9 years ago |
|  | |

Attached patch

[Patch v.1](attachment.cgi?id=8699454&action=diff) (obsolete)
— [Details](attachment.cgi?id=8699454&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699454)

With semicolon.
Gerv
[Attachment #8699452](/attachment.cgi?id=8699452&action=edit "Patch v.1") -
Attachment is obsolete: true
[Attachment #8699454](/attachment.cgi?id=8699454&action=edit "Patch v.1") -
Flags: review?(dylan)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1232785#c38)• 9 years ago |
|  | |

A string of random undeclared comma-separated identifiers is valid JS?
<sigh>
Yes, I believe the requester has control of the field list.
gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1232785#c39)• 9 years ago |
|  | |

The exploit author gets to set any variable they want before making the <script> request. But it appears "Bug ID" is always first.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1232785#c40)• 9 years ago |
|  | |

However, if "Bug ID" is ever valid js syntax this would be a time bomb...

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1232785#c41)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #38](/show_bug.cgi?id=1232785#c38 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Yes, I believe the requester has control of the field list.
Yes, he has. You can pass &columnlist=... in the URL bar.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1232785#c42)• 9 years ago |
|  | |

Attached file
[non-human buglist csv](attachment.cgi?id=8699460)
— [Details](attachment.cgi?id=8699460&action=edit)

Also human=0 (or no human=):
<https://bugzilla-dev.allizom.org/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&email1=netfuzzer%40yandex.com&emailassigned_to1=1&emailreporter1=1&emailtype1=exact&field0-0-0=bug_status&field0-0-1=reporter&list_id=357&query_format=advanced&type0-0-0=notequals&type0-0-1=equals&value0-0-0=UNCONFIRMED&value0-0-1=netfuzzer%40yandex.com&ctype=csv>

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1232785#c43)• 9 years ago |
|  | |

Comment on [attachment 8699454](/attachment.cgi?id=8699454 "Patch v.1") [[details]](/attachment.cgi?id=8699454&action=edit "Patch v.1") [[diff]](/attachment.cgi?id=8699454&action=diff "Patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699454)
Patch v.1
Review of [attachment 8699454](/attachment.cgi?id=8699454 "Patch v.1") [[details]](/attachment.cgi?id=8699454&action=edit "Patch v.1") [[diff]](/attachment.cgi?id=8699454&action=diff "Patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699454):
-----------------------------------------------------------------
with gerv's patch, the file in [comment 42](/show_bug.cgi?id=1232785#c42 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers") would still be valid js.
[Attachment #8699454](/attachment.cgi?id=8699454&action=edit "Patch v.1") -
Flags: review?(dylan) → review-

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1232785#c44)• 9 years ago |
|  | |

:-( OK, other than the trailing comma on line 1, I'm now out of ideas for breaking the JS-ness of the file.
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1232785#c45)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #44](/show_bug.cgi?id=1232785#c44 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> :-( OK, other than the trailing comma on line 1, I'm now out of ideas for
> breaking the JS-ness of the file.
>
> Gerv
What about a trailing comma on every line?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1232785#c46)• 9 years ago |
|  | |

I wonder whether that would lead to more of a compatibility issue than a trailing comma on the first line...
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1232785#c47)• 9 years ago |
|  | |

we have two options -- make it invalid js or remove the feature. I think double trailing commas is the least invasive way of making it invalid js.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1232785#c48)• 9 years ago |
|  | |

to be clear, can the user's sepchar be changed outside of the user's control? if it is set to ; ... we will still have valid js!

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1232785#c49)• 9 years ago |
|  | |

about 211 users on BMO use ;

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1232785#c50)• 9 years ago |
|  | |

We can always add a final column named ☃ that is empty for all other rows.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1232785#c51)• 9 years ago |
|  | |

Guys, trying to make this not parse as JS is pointless. Either we're going to end up missing something, or a future ES version is going to add something that will result in sadness.
We should either remove all non-public bugs from the CSV export, or remove CSV export altogether. There is no safe way to expose the information we currently expose in a CSV format.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1232785#c52)• 9 years ago |
|  | |

(In reply to :Ehsan Akhgari from [comment #51](/show_bug.cgi?id=1232785#c51 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Guys, trying to make this not parse as JS is pointless. Either we're going
> to end up missing something, or a future ES version is going to add
> something that will result in sadness.
Ehsan: "don't ever put any sensitive data on the web (even password-protected) in any format that could possibly be parsed as JS" is not a reasonable position for Mozilla's Firefox team to take. There's no way anyone can ever meet that security criteria apart from by avoiding text-based file formats entirely, which is an unreasonable restriction.
If X-Content-Type-Options: nosniff is really the only way to fix this, then we'd better get on and implement that. How do we get that bug prioritized?
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1232785#c53)• 9 years ago |
|  | |

at least js doesn't support XML literals (like Scala does) or else this would be really bad.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1232785#c54)• 9 years ago |
|  | |

Note: Safari is also vulnerable.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1232785#c55)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #52](/show_bug.cgi?id=1232785#c52 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> (In reply to :Ehsan Akhgari from [comment #51](/show_bug.cgi?id=1232785#c51 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> > Guys, trying to make this not parse as JS is pointless. Either we're going
> > to end up missing something, or a future ES version is going to add
> > something that will result in sadness.
>
> Ehsan: "don't ever put any sensitive data on the web (even
> password-protected) in any format that could possibly be parsed as JS" is
> not a reasonable position for Mozilla's Firefox team to take.
I am only suggesting this as a fix to this specific issue, not the general problem you're referring to. The discussion on the latter can happen on dev-platform.
> There's no way
> anyone can ever meet that security criteria apart from by avoiding
> text-based file formats entirely, which is an unreasonable restriction.
>
> If X-Content-Type-Options: nosniff is really the only way to fix this, then
> we'd better get on and implement that. How do we get that bug prioritized?
See the discussion on [bug 471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox")? The problem is not one of prioritizing a bug, it's about there being no complete specification on what this header is supposed to do, and it behaving differently in IE, Chrome and the partial specs written for it. So it's hard to know what needs to be implemented here.
I think we can make a reasonable case for adding support for nosniff for <script> loads, but we need to know what the exact behavior we want to support it.
But now we're getting really off topic here. I think we should focus on fixing this bug without nosniff.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1232785#c56)• 9 years ago |
|  | |

OK, I think we have only one solution left: by default, the CSV file should only include public bugs (make sure to take the requirelogin parameter into account!). If you want to see private bugs, you must pass a valid API key in the URL. The CSV file would then only contain bugs which are visible to the user identified by this API key, independently of your current login cookies, to prevent the attacker from using the victim's credential.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1232785#c57)• 9 years ago |
|  | |

I'm working on this Roughly speaking the same as [comment 56](/show_bug.cgi?id=1232785#c56 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"). Cookies will be ignored for buglist.cgi when producing a csv formatted report,Assignee: gerv → dylan

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1232785#c58)• 9 years ago |
|  | |

There's also another way that doesn't break anything and prevent the xss.
Have a look:
============================
Bug ID,"Product","Component","Assignee","Status","Resolution","Summary","Changed"
============================
Removing the quotes from the first field won't break anything and will cause a javascript error.
It'll still work in most CSV parsers.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1232785#c59)• 9 years ago |
|  | |

Mario: Dylan covered that in [comment 42](/show_bug.cgi?id=1232785#c42 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"). Adding "&human=0" to the URL gives database field names, which contain no spaces. So, I am told, removing the quotes from the field won't help.
And, because in JS semicolons are optional, I don't think we can add linebreaks to the first line to break the parser either. :-|
Gerv

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1232785#c60)• 9 years ago |
|  | |

@Gerv: how about checking the "Accept" header? Most browser send "Accept: \*/\*"(IE,Chrome,Firefox and Safari) to get JS content. You guys could check this header and block the attack.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1232785#c61)• 9 years ago |
|  | |

IE sends \*/\* for some top-level loads too, AIUI. Accept header parsing would probably be pretty fragile. And it's not a security header so there's no guarantee some browsers don't have ways to modify it for some requests.
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1232785#c62)• 9 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #57](/show_bug.cgi?id=1232785#c57 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> I'm working on this Roughly speaking the same as [comment 56](/show_bug.cgi?id=1232785#c56 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"). Cookies will be
> ignored for buglist.cgi when producing a csv formatted report,
I think this will break old BzAPI, for anyone still using it. Will you still allow explicit username/password login on the URL?
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1232785#c63)• 9 years ago |
|  | |

So in other news, doesn't this also mean that you can craft (using only public bugs) js that gets run under the security context of bugzilla.mozilla.org?

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1232785#c64)• 9 years ago |
|  | |

can said code poke at the local storage that splinter uses? If I put this <script src> on a site that people that review security bugs go to, ....? I want to be wrong about this.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1232785#c65)• 9 years ago |
|  | |

Is my fear outlined in [comment 63](/show_bug.cgi?id=1232785#c63 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers") and [comment 64](/show_bug.cgi?id=1232785#c64 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers") feasible?Flags: needinfo?(ehsan)

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1232785#c66)• 9 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #65](/show_bug.cgi?id=1232785#c65 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Is my fear outlined in [comment 63](/show_bug.cgi?id=1232785#c63 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers") and [comment 64](/show_bug.cgi?id=1232785#c64 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers") feasible?
No. Script runs in the context of the web page that embeds the <script> tag, not the context of where the script is loaded from.Flags: needinfo?(ehsan)

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1232785#c67)• 9 years ago |
|  | |

I am incredibly happy that I am wrong, and I wish I had remembered the context a script gets executed in is the page it is on.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1232785#c68)• 9 years ago |
|  | |

(In reply to Mario Gomes from [comment #11](/show_bug.cgi?id=1232785#c11 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Great! Could this be eligible for a bounty?
Please mail security@mozilla.org for bounty requests, as always, to make sure the bounty folks see it. (In this case I happened to see it, but that's no guarantee for next time.)
Severity is somewhere between moderate and high, I'll go on the high side to start. Easy for attacker to arrange bugs with the right titles to be first and last: even w/out editbugs powers you can create your own bugs and sort your target query on some irrelevant column that you put low/high markers in your boundary bugs. You don't get full details of bugs, summary is the most damaging. Sometimes that's pretty revealing, sometimes it's useless.
Even though Mario points out that in the particular case of CSV he could get it to be parsed as an array, the new ES 6 ` string delimiter is going to create more problems in more sites. No one's going to be filtering on that and prior to this feature any multi-line quoting attempts would be a syntax error. Part of the problem here is that CSV quote escaping is different from JS escaping, but that could be true in other formats as well.
At one point we tried to use Content Security Policy as a way to raise the bar on JS MIME type sniffing: [bug 662227](/show_bug.cgi?id=662227 "RESOLVED WONTFIX - Load script files only with a Content-Type of application/javascript or application/json when CSP is enabled"). That wouldn't have been a solution here because the attacker would presumably not use CSP, but the fact that it was removed from the initial spec shows the depth of the compatibility worries MIME type enforcement raises.
I thought we had a bug (even if WONTFIXed) about making strict mime type checking for JS the default regardless of any nosniff header but I can't currently find it. Would probably break the web since text/plain has historically been very popular for script files (we should add telemetry).
Maybe we could restrict new ES 6 features to files that have a reasonable content type? The doesn't solve this Bugzilla problem but longer term could help the web.Depends on: [471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox")Flags: sec-bounty?Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Whiteboard: ES 6 `-strings + no MIME restrictions on script src + no support for x-content-options: nosniff

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1232785#c69)• 9 years ago |
|  | |

I think we could get away with filtering out all punctuation characters (basically anything that is not /[\s\w]/ in a perl regex). For minimum breakage, we could do this only for logged in users. For BMO this would be a very small sample of users -- and it would probably not break anyone's workflow beyond repair.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1232785#c70)• 9 years ago |
|  | |

Attached patch

[1232785\_2.patch](attachment.cgi?id=8699589&action=diff) (obsolete)
— [Details](attachment.cgi?id=8699589&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699589)

replace \ with &bsol; for logged in users. This means it will only break for about 20 people on BMO and hopefully small numbers on other sites.
[Attachment #8699454](/attachment.cgi?id=8699454&action=edit "Patch v.1") -
Attachment is obsolete: true
[Attachment #8699589](/attachment.cgi?id=8699589&action=edit "1232785_2.patch") -
Flags: review?(dkl)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1232785#c71)• 9 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #70](/show_bug.cgi?id=1232785#c70 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> replace \ with &bsol; for logged in users.
I don't see why you do HTML-escaping with a plain text file. This doesn't make any sense to me. When you then read the CSV file, text would be displayed as &bsol;, not converted back to \. That's painful. C:\Foo\Bar\file.ext would be displayed as C:&bsol;Foo&bsol;file.ext. Yay!

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1232785#c72)• 9 years ago |
|  | |

it's painful but less painful than other options. I was going to use [BACKSLASH] but dveditz suggested the html entity for shortness.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1232785#c73)• 9 years ago |
|  | |

I could also use <http://www.fileformat.info/info/unicode/char/ff3c/index.htm>

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1232785#c74)• 9 years ago |
|  | |

Comment on [attachment 8699589](/attachment.cgi?id=8699589 "1232785_2.patch") [[details]](/attachment.cgi?id=8699589&action=edit "1232785_2.patch") [[diff]](/attachment.cgi?id=8699589&action=diff "1232785_2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699589)
1232785\_2.patch
Review of [attachment 8699589](/attachment.cgi?id=8699589 "1232785_2.patch") [[details]](/attachment.cgi?id=8699589&action=edit "1232785_2.patch") [[diff]](/attachment.cgi?id=8699589&action=diff "1232785_2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699589):
-----------------------------------------------------------------
r=dkl as this fixes this particular exploit case as demonstrated by the reporter. I also see LpSolit's point about seeming wrong to change values in a plain text format causing extra work for the client. Until Firefox (and others) are fixed to do the correct thing with regards to text/plain and not execute as javascript, can we guarantee that some other similar issue will arise from this type of exploit. Is there a list of other characters we should be escaping as well or will this be enough to catch most cases?
[Attachment #8699589](/attachment.cgi?id=8699589&action=edit "1232785_2.patch") -
Flags: review?(dkl) → review+

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1232785#c75)• 9 years ago |
|  | |

Attached patch

[1232785\_3.patch](attachment.cgi?id=8699686&action=diff)
— [Details](attachment.cgi?id=8699686&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699686)

use unicode Fullwidth Reverse Solidus instead of ASCII Reverse Solidus
[Attachment #8699589](/attachment.cgi?id=8699589&action=edit "1232785_2.patch") -
Attachment is obsolete: true
[Attachment #8699686](/attachment.cgi?id=8699686&action=edit "1232785_3.patch") -
Flags: review?(dkl)

|  | [Tanvi Vyas[:tanvi]](/user_profile?user_id=430652) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1232785#c76)• 9 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #6](/show_bug.cgi?id=1232785#c6 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> This works from any page context, in firefox only as reported. Chrome
> reports this error:
>
> "Refused to execute script from
> '<https://bugzilla-dev.allizom.org/buglist>.
> cgi?bug\_status=UNCONFIRMED&bug\_sta…value0-0-0=UNCONFIRMED&value0-0-
> 1=netfuzzer%40yandex.com&ctype=csv&human=1' because its MIME type
> ('text/csv') is not executable, and strict MIME type checking is enabled."
Since bugzilla isn't sending "X-Content-Type-Options: nosniff", how is this getting blocked on chrome? Maybe in addition to [bug 471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox"), we need something else?

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1232785#c77)• 9 years ago |
|  | |

Chrome just refuses to execute text/csv as js.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1232785#c78)• 9 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #77](/show_bug.cgi?id=1232785#c77 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Chrome just refuses to execute text/csv as js.
If we can't have "X-Content-Type-Options: nosniff" in Firefox, can we just have this? :-)
Gerv

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=1232785#c79)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #78](/show_bug.cgi?id=1232785#c78 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> (In reply to Dylan William Hardison [:dylan] from [comment #77](/show_bug.cgi?id=1232785#c77 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> > Chrome just refuses to execute text/csv as js.
>
> If we can't have "X-Content-Type-Options: nosniff" in Firefox, can we just
> have this? :-)
We can try, but this is the kind of thing that runs the risk of breaking websites so it's not a good fix for a bugzilla vulnerability. It also won't fix anything for Safari users.

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=1232785#c80)• 9 years ago |
|  | |

Comment on [attachment 8699686](/attachment.cgi?id=8699686 "1232785_3.patch") [[details]](/attachment.cgi?id=8699686&action=edit "1232785_3.patch") [[diff]](/attachment.cgi?id=8699686&action=diff "1232785_3.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699686)
1232785\_3.patch
Review of [attachment 8699686](/attachment.cgi?id=8699686 "1232785_3.patch") [[details]](/attachment.cgi?id=8699686&action=edit "1232785_3.patch") [[diff]](/attachment.cgi?id=8699686&action=diff "1232785_3.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1232785&attachment=8699686):
-----------------------------------------------------------------
r=dkl
[Attachment #8699686](/attachment.cgi?id=8699686&action=edit "1232785_3.patch") -
Flags: review?(dkl) → review+

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=1232785#c81)• 9 years ago |
|  | |

The patch cleanly applies and works in 4.4 and 5.0Flags: approval5.0?Flags: approval4.4?

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a250640_491519)• 9 years ago |

Summary: [SECURITY] Attachments are able to read remote buglists containing restricted bugs → [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a261315_5898)• 9 years ago |

Flags: approval5.0?Flags: approval5.0+Flags: approval4.4?Flags: approval4.4+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=1232785#c82)• 9 years ago |
|  | |

(In reply to :Ehsan Akhgari from [comment #79](/show_bug.cgi?id=1232785#c79 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> We can try, but this is the kind of thing that runs the risk of breaking
> websites so it's not a good fix for a bugzilla vulnerability.
You think there are websites out there serving valid JavaScript specifically as text/csv?
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=1232785#c83)• 9 years ago |
|  | |

I think that this patch silently changes data, which could have any number of unknown or unpredictable effects. I still prefer the trailing-comma-on-first-line fix. But there you go.
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=1232785#c84)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #82](/show_bug.cgi?id=1232785#c82 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> You think there are websites out there serving valid JavaScript specifically
> as text/csv?
I don't think that's the case, because 1) they are abusing what a CSV file is used for, and 2) Chrome refuses to use them in <script>, and so these websites would be broken for Chrome users.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=1232785#c85)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #83](/show_bug.cgi?id=1232785#c83 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> I think that this patch silently changes data, which could have any number
> of unknown or unpredictable effects. I still prefer the
> trailing-comma-on-first-line fix. But there you go.
>
> Gerv
It would have two be two trailing commas. It would also not work for the case of someone using semicolons.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=1232785#c86)• 9 years ago |
|  | |

> It would have two be two trailing commas. It would also not work for the
> case of someone using semicolons.
I think the user preference to allow people to have their comma-separated values files using commas or semicolons is a dumb preference and I would be very happy to see it eliminated entirely. :-)
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=1232785#c87)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #86](/show_bug.cgi?id=1232785#c86 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> I think the user preference to allow people to have their comma-separated
> values files using commas or semicolons is a dumb preference and I would be
> very happy to see it eliminated entirely. :-)
Just because it makes this bug harder to fix? That's a weak reason. This user pref has been implemented in Bugzilla 2.20 because Excel uses either commas or semicolons to parse CSV files, depending on the localization of your Windows installation, see [bug 257767 comment 12](/show_bug.cgi?id=257767#c12 "RESOLVED FIXED - Option to have CSV files separated with semicolons instead of commas"). For instance, English uses commas, but both French and German use semicolons.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=1232785#c88)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #87](/show_bug.cgi?id=1232785#c87 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Just because it makes this bug harder to fix? That's a weak reason. This
> user pref has been implemented in Bugzilla 2.20 because Excel uses either
> commas or semicolons to parse CSV files, depending on the localization of
> your Windows installation, see [bug 257767 comment 12](/show_bug.cgi?id=257767#c12 "RESOLVED FIXED - Option to have CSV files separated with semicolons instead of commas"). For instance, English
> uses commas, but both French and German use semicolons.
LibreOffice lets you decide what separator to use when importing the file; has Excel not yet caught up with this useful facility, then?
The idea of shipping a spreadsheet which imports "Comma-Separated Values" files but doesn't support using commas to separate the values is a comedy move from Microsoft :-)
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=1232785#c89)• 9 years ago |
|  | |

No, it is an example of MS not being anglo-centric. Lots of languages use , as a decimal seperator. Numbers don't have to be quoted, so using a semicolon makes a lot of sense. On BMO more than 200 people use semicolons. I wonder if we should consider exporting ods and xls formats and remove csv from future releases.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=1232785#c90)• 9 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #89](/show_bug.cgi?id=1232785#c89 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> No, it is an example of MS not being anglo-centric. Lots of languages use ,
> as a decimal seperator.
I know. It's the fact that it can't \_import\_ the comma-using version which is clownshoes. If it could, we could just always export with commas and there would be no need for the preference. (We don't put decimal separators into our numbers when we export, so no extra quoting.)
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a405724_120380)• 9 years ago |

Blocks: [1229728](/show_bug.cgi?id=1229728 "RESOLVED FIXED - Security advisory for Bugzilla 5.0.2, 4.4.11 and 4.2.16")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=1232785#c91)• 9 years ago |
|  | |

dveditz, can we get a CVE for this please?
dklFlags: needinfo?(dveditz)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a513966_5898)• 9 years ago |

Blocks: [1234237](/show_bug.cgi?id=1234237 "RESOLVED FIXED - Backport upstream bug 1232785 to bmo/4.2 [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=1232785#c92)• 9 years ago |
|  | |

dveditz on pto. abillings is getting us a CVEFlags: needinfo?(dveditz)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a522677_280903)• 9 years ago |

Alias: CVE-2015-8509

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=1232785#c93)• 9 years ago |
|  | |

Any estimate date for this going public?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a584901_120380)• 9 years ago |

No longer depends on: [471020](/show_bug.cgi?id=471020 "RESOLVED FIXED - Add X-Content-Type-Options: nosniff support to Firefox")Flags: approval4.2?Target Milestone: Bugzilla 4.4 → Bugzilla 4.2

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=1232785#c94)• 9 years ago |
|  | |

(In reply to Mario Gomes from [comment #93](/show_bug.cgi?id=1232785#c93 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> Any estimate date for this going public?
Trying for pushing a release today. We will see how it goes.Flags: approval4.2? → approval4.2+

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=1232785#c95)• 9 years ago |
|  | |

To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[49b2e90..c899b36 4.2 -> 4.2](https://github.com/bugzilla/bugzilla/commit/c899b36)
5f7540c..ce87073 4.4 -> 4.4
dc076ed..a118534 5.0 -> 5.0
e69201a..34f8910 master -> masterStatus: ASSIGNED → RESOLVEDClosed: 9 years agoResolution: --- → FIXED

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a608954_5898)• 9 years ago |

Group: bugzilla-security

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a1112657_280903)• 9 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=1232785#c96)• 9 years ago |
|  | |

A bit late here, but had anyone considered checking referrer headers as a mitigation?

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=1232785#c97)• 9 years ago |
|  | |

How about adding an extra comma regardless of the separator that the user specified?
"Bug ID";"Product";"Component";"Assignee";"Status";"Resolution";"Summary";"Changed";,
is still invalid as JS, a data in the last (dummy) field as CSV.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=1232785#c98)• 9 years ago |
|  | |

(In reply to Masatoshi Kimura [:emk] from [comment #97](/show_bug.cgi?id=1232785#c97 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> How about adding an extra comma regardless of the separator that the user
> specified?
> "Bug
> ID";"Product";"Component";"Assignee";"Status";"Resolution";"Summary";
> "Changed";,
> is still invalid as JS, a data in the last (dummy) field as CSV.
That would lead to an additional final field containing just the text ",", when the separator was colon. It's not ideal to add additional fields with actual content.
(In reply to Boris Zbarsky [:bz] (Vacation until Jan 4) from [comment #96](/show_bug.cgi?id=1232785#c96 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> A bit late here, but had anyone considered checking referrer headers as a
> mitigation?
CSV is used as a format by software interfacing with Bugzilla; it's not just people clicking the link on the buglist page. What would the check be? "Referrer has to be blank, or the Bugzilla itself"?
Gerv

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=1232785#c99)• 9 years ago |
|  | |

> "Referrer has to be blank, or the Bugzilla itself"?
Yes. That wouldn't help if people have their browsers configured to not send referrer, of course, but it should help in the common case.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=1232785#c100)• 9 years ago |
|  | |

:dkl, :dylan: views?
GervFlags: needinfo?(dylan)Flags: needinfo?(dkl)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 101](/show_bug.cgi?id=1232785#c101)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #100](/show_bug.cgi?id=1232785#c100 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> :dkl, :dylan: views?
>
> Gerv
I would rather never use Referer as any means of protection as it is freely alterable and interceptable. And not to mention some people use dashboards that access CSV directly without coming from the CSV link in buglist.cgi.
dklFlags: needinfo?(dkl)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=1232785#c102)• 9 years ago |
|  | |

(In reply to David Lawrence [:dkl] from [comment #101](/show_bug.cgi?id=1232785#c101 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> I would rather never use Referer as any means of protection as it is freely
> alterable and interceptable.
If I'm trying to conduct an XSS attack on you, what mechanisms can I use to get your browser to send a bogus Referer?
> And not to mention some people use dashboards
> that access CSV directly without coming from the CSV link in buglist.cgi.
How do they do that? Same Origin Policy should mean the dashboard can't access the data...
Gerv

|  | [Mario Gomes](/user_profile?user_id=423436)  Reporter |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=1232785#c103)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #102](/show_bug.cgi?id=1232785#c102 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> If I'm trying to conduct an XSS attack on you, what mechanisms can I use to
> get your browser to send a bogus Referer?
Hey, I can answer that :) It's possible to send "blank referer" requests using data URLS on Firefox.

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=1232785#c104)• 9 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #102](/show_bug.cgi?id=1232785#c102 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> > And not to mention some people use dashboards
> > that access CSV directly without coming from the CSV link in buglist.cgi.
>
> How do they do that? Same Origin Policy should mean the dashboard can't
> access the data...
By accessing a query URL directly for public bugs only such as:
<https://bugzilla.mozilla.org/buglist.cgi?bug_status=NEW&component=Administration&product=Bugzilla&ctype=csv>
dkl

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=1232785#c105)• 9 years ago |
|  | |

(In reply to David Lawrence [:dkl] from [comment #104](/show_bug.cgi?id=1232785#c104 "RESOLVED FIXED - [SECURITY] Buglists in CSV format can be parsed as valid javascript in some browsers"))
> By accessing a query URL directly for public bugs only such as:
>
> <https://bugzilla.mozilla.org/buglist>.
> cgi?bug\_status=NEW&component=Administration&product=Bugzilla&ctype=csv
Sorry if I'm being dense, but surely an HTML dashboard hosted at a random domain can't XHR such a URL and read the result because of the same origin policy?
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519)  Assignee |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=1232785#c106)• 9 years ago |
|  | |

Such dashboards can access that server-side, which has no restrictions. The fix we have in place is the best possible one given the universe we live in.Flags: needinfo?(dylan)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1232785#a266871811_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1232785&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Mario Gomes](/user_profile?user_id=423436)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from packetstormsecurity.com_781dfea3_20250125_144202.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_093535.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.bugzilla.org_6db3a99d_20250125_144205.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 5.0.1, 4.4.10, and 4.2.15 Security Advisory

# 5.0.1, 4.4.10, and 4.2.15 Security Advisory

Tuesday, Dec 22nd, 2015
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* Unfiltered HTML injected into a dependency graph could be used to
  create a cross-site scripting attack.

* Some web browsers incorrectly parse CSV files as valid JavaScript
  code which could lead to data leak.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Cross-Site Scripting
Affected:    Bugzilla 2.6 to 4.2.15, 4.3.1 to 4.4.10, 4.5.1 to 5.0.1
Fixed In:    4.2.16, 4.4.11, 5.0.2
Description: During the generation of a dependency graph, the code for
             the HTML image map is generated locally if a local dot
             installation is used. With escaped HTML characters in a bug
             summary, it is possible to inject unfiltered HTML code in
             the map file which the CreateImagemap function generates.
             This could be used for a cross-site scripting attack.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1221518
CVE Number:  CVE-2015-8508

Class:       Information Leak
Affected:    Bugzilla 2.17.1 to 4.2.15, 4.3.1 to 4.4.10, 4.5.1 to 5.0.1
Fixed In:    4.2.16, 4.4.11, 5.0.2
Description: If an external HTML page contains a <script> element with
             its src attribute pointing to a buglist in CSV format, some
             web browsers incorrectly try to parse the CSV file as valid
             JavaScript code. As the buglist is generated based on the
             privileges of the user logged into Bugzilla, the external
             page could collect confidential data contained in the CSV
             file.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1232785
CVE Number:  CVE-2015-8509

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: Holger Fuhrmannek
Issue 1 Fixed by: Frédéric Buclin, Dylan William Hardison, David Lawrence, Gervase Markham

Issue 2 Reporter: Mario Gomes
Issue 2 Fixed by: Frédéric Buclin, Dylan William Hardison, David Lawrence, Gervase Markham

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright © 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)



=== Content from wiki.mozilla.org_0da4fc4f_20250126_093534.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


