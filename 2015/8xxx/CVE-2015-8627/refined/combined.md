=== Content from phabricator.wikimedia.org_83f53bf4_20250125_044033.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT97897)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T97897
# Incorrect parsing of IPs for global blockClosed, Resolved[Public](/policy/explain/PHID-TASK-qg2zj64jg5qt5wstvzea/view/)Actions

* [Edit Task](/maniphest/task/edit/97897/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/97897/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* [Protect as security issue](/wmf/escalate-task/97897/)
* [Award Token](/token/give/PHID-TASK-qg2zj64jg5qt5wstvzea/)
* [Flag For Later](/flag/edit/PHID-TASK-qg2zj64jg5qt5wstvzea/)

Assigned To

|  | [• dpatrick](/p/dpatrick/) |
| --- | --- |

Authored By

|  | [Vituzzu](/p/Vituzzu/) |
| --- | --- |
| May 2 2015, 2:35 PM2015-05-02 14:35:14 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Stewards-and-global-tools](/tag/stewards-and-global-tools/) [(Closed)](/project/board/1596/)
* [MediaWiki-User-management](/tag/mediawiki-user-management/) [(Backlog)](/project/board/198/)
* [Security](/tag/security/)
Referenced Files

|  | [F3105795: T97897-REL1\_23.patch](/F3105795) |
| --- | --- |
| Dec 15 2015, 7:39 PM2015-12-15 19:39:09 (UTC+0) |

|  | [F2961639: T97897\_03.patch](/F2961639) |
| --- | --- |
| Nov 14 2015, 4:22 AM2015-11-14 04:22:38 (UTC+0) |

|  | [F191969: T97897\_02.patch](/F191969) |
| --- | --- |
| Jul 14 2015, 5:01 AM2015-07-14 05:01:12 (UTC+0) |

|  | [F191828: T97897\_01.patch](/F191828) |
| --- | --- |
| Jul 13 2015, 6:06 PM2015-07-13 18:06:06 (UTC+0) |

|  | [F176994: T97897\_w\_Anomie.patch](/F176994) |
| --- | --- |
| Jun 9 2015, 6:12 PM2015-06-09 18:12:20 (UTC+0) |

|  | [F176995: T97897\_dpatrick\_refactor.patch](/F176995) |
| --- | --- |
| Jun 9 2015, 6:12 PM2015-06-09 18:12:20 (UTC+0) |

|  | [F159702: T97897.patch](/F159702) |
| --- | --- |
| May 2 2015, 4:53 PM2015-05-02 16:53:12 (UTC+0) |

Subscribers

|  | [Bsadowski1](/p/Bsadowski1/) |
| --- | --- |

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [• demon](/p/demon/) |
| --- | --- |

|  | [Grunny](/p/Grunny/) |
| --- | --- |

|  | [hoo](/p/hoo/) |
| --- | --- |

|  | [Jalexander](/p/Jalexander/) |
| --- | --- |

|  | [JEumerus](/p/JEumerus/) |
| --- | --- |

[View All 15 Subscribers](/subscriptions/list/PHID-TASK-qg2zj64jg5qt5wstvzea/)
# Description

Today I mistakenly gave an IP in the form X.000.X.X to my steward bot and this apparently blocked all newly registered users (it was showed on the top of newbies' contribs). I was afk and Melos tried unblocking it via unblock form but it wasn't listed as being blocked, then he eventually managed to unblock it via api.

Here's the "IP" <https://meta.wikimedia.org/w/index.php?title=Special%3ALog&type=&user=&page=User%3A141.000.11.253&year=&month=-1&tagfilter=&hide_patrol_log=1&hide_tag_log=1&hide_thanks_log=1>

---

**patches:**

* 1.24 - master: T97897\_03.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/kwum3sphczmreumi6y7m/PHID-FILE-vqev7i3kgytnqmibtdtj/T97897_03.patch)
* 1.23: T97897-REL1\_23.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/lqvtgbf223t2oqeas4pt/PHID-FILE-2qmr6gsrzxwhukgjgcmc/T97897-REL1_23.patch)

**CVE:** CVE-2015-8627

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [Fix IP::toHex for IPv4 addresses with a double/triple 0 block](https://gerrit.wikimedia.org/r/c/259950) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/master) | +44 -11 |
|  | [Fix IP::toHex for IPv4 addresses with a double/triple 0 block](https://gerrit.wikimedia.org/r/c/259939) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_26](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_26) | +44 -11 |
|  | [Fix IP::toHex for IPv4 addresses with a double/triple 0 block](https://gerrit.wikimedia.org/r/c/259928) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_25](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_25) | +44 -11 |
|  | [Fix IP::toHex for IPv4 addresses with a double/triple 0 block](https://gerrit.wikimedia.org/r/c/259904) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_23](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_23) | +44 -11 |
|  | [Fix IP::toHex for IPv4 addresses with a double/triple 0 block](https://gerrit.wikimedia.org/r/c/259915) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_24](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_24) | +44 -11 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T97897)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [• demon](/p/demon/) | T115722 [MediaWiki Security release 1.25.4](/T115722) |
|  |  | Resolved |  | [• dpatrick](/p/dpatrick/) | T97897 [Incorrect parsing of IPs for global block](/T97897) |

Mentioned In [T117471: Special:Contribs cuts last "0" in the username](/T117471)
[T115522: Passwords generated by User::randomPassword() may be shorter than $wgMinimalPasswordLength](/T115522) Mentioned Here [T117476: User can't log in and contribution or user page can't be opened](/T117476)
[T117471: Special:Contribs cuts last "0" in the username](/T117471)
[T115522: Passwords generated by User::randomPassword() may be shorter than $wgMinimalPasswordLength](/T115522)
[T62035: Block::newLoad malformed db query](/T62035)
### Event Timeline

[Maniphest](/maniphest/) changed the visibility from "Public (No Login Required)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-rnpnc6hahifils5/)".[May 2 2015, 2:35 PM2015-05-02 14:35:14 (UTC+0)](#1254549)[Maniphest](/maniphest/) changed the edit policy from "All Users" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-fscrxe2drizjrj5/)".Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/691936/)[May 2 2015, 2:35 PM2015-05-02 14:35:14 (UTC+0)](#1254551)[Vituzzu](/p/Vituzzu/) created this task.[May 2 2015, 2:35 PM2015-05-02 14:35:14 (UTC+0)](#1254552)[Vituzzu](/p/Vituzzu/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-ycsefdni6fnrgdy/)[Vituzzu](/p/Vituzzu/) added a project: [acl\*security](/tag/acl_security/).[Vituzzu](/p/Vituzzu/) changed Security from None to Software security bug.[Vituzzu](/p/Vituzzu/) edited subscribers, added: [Vituzzu](/p/Vituzzu/), [Melos](/p/Melos/), [hoo](/p/hoo/), [Krenair](/p/Krenair/); removed: [Aklapper](/p/Aklapper/).[Krenair](/p/Krenair/) merged a task: Restricted Task.[May 2 2015, 4:27 PM2015-05-02 16:27:45 (UTC+0)](#1254659)[hoo](/p/hoo/) added a comment.[May 2 2015, 4:53 PM2015-05-02 16:53:12 (UTC+0)](#1254681)Comment Actions

T97897.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/oqkaxvl56bl7vy3vy63u/PHID-FILE-yyxgijelj26tbhgtgs4j/T97897.patch)

The root cause for this is that MediaWiki's IP class considers these IP addresses valid, but is not able to convert them to hex. I fixed the conversion to hex. See also [T62035](/T62035).

[Anomie](/p/Anomie/) subscribed.[May 4 2015, 2:08 PM2015-05-04 14:08:16 (UTC+0)](#1256856)Comment Actions
> '/(?<=\.)0+(?=([1-9]|0\.))/'

Unnecessary parens inside the (?=).

Also, consider this address: 00192.0.2.000, the extraneous zeros won't be stripped. I'd recommend using '/(?:^|(?<=\.))0+(?=[1-9]|0\.|0$)/' instead.

[Vituzzu](/p/Vituzzu/) added a subscriber: [saper](/p/saper/).[May 5 2015, 8:19 PM2015-05-05 20:19:20 (UTC+0)](#1262360)[• dpatrick](/p/dpatrick/) claimed this task.[May 21 2015, 9:49 PM2015-05-21 21:49:53 (UTC+0)](#1302675)[• dpatrick](/p/dpatrick/) triaged this task as Medium priority.[• dpatrick](/p/dpatrick/) added a project: [Security-Team](/tag/security-team/).[May 21 2015, 10:02 PM2015-05-21 22:02:05 (UTC+0)](#1302736)[• dpatrick](/p/dpatrick/) moved this task from [Incoming](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[• dpatrick](/p/dpatrick/) added a comment.[Jun 3 2015, 6:37 PM2015-06-03 18:37:04 (UTC+0)](#1334933)Comment Actions

I concur with [@Anomie](/p/Anomie/)'s regex correction. However, can we refactor out the preg\_replace() into a separate function so that we can unit test that more effectively? Or, toward the same aim, can that preg\_replace() be moved to the IPv4 handling portion of sanitizeIP()?

[• dpatrick](/p/dpatrick/) moved this task from [In Progress](/project/board/1179/) to [Waiting](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 4 2015, 10:12 PM2015-06-04 22:12:53 (UTC+0)](#1339212)[• dpatrick](/p/dpatrick/) moved this task from [Waiting](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[• dpatrick](/p/dpatrick/) added a comment.[Jun 9 2015, 6:12 PM2015-06-09 18:12:20 (UTC+0)](#1350038)Comment Actions

Attached for review/comments are two patches:

T97897\_w\_Anomie.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/pkyqkmjqc3axkfh3faah/PHID-FILE-bfxyqionjhz3rjyhtx44/T97897_w_Anomie.patch) which is just the original patch, but with [@Anomie](/p/Anomie/)'s regex correction;

T97897\_dpatrick\_refactor.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/yoxw3kk3nfcryf3lrena/PHID-FILE-egcmpkg376egenrntbaa/T97897_dpatrick_refactor.patch) is a refactor which pulls out the preg\_match() and adds additional test cases.

I think the latter is preferable for maintenance and code review reasons. What say others?

[• dpatrick](/p/dpatrick/) moved this task from [In Progress](/project/board/1179/) to [Waiting](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 9 2015, 6:13 PM2015-06-09 18:13:26 (UTC+0)](#1350043)

[Anomie](/p/Anomie/) added a comment.[Jun 10 2015, 5:22 PM2015-06-10 17:22:25 (UTC+0)](#1353830)Comment Actions
> In [T97897#1350038](/T97897#1350038), [@dpatrick](/p/dpatrick/) wrote:
>
> T97897\_w\_Anomie.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/pkyqkmjqc3axkfh3faah/PHID-FILE-bfxyqionjhz3rjyhtx44/T97897_w_Anomie.patch) which is just the original patch, but with [@Anomie](/p/Anomie/)'s regex correction;

Looks ok. Haven't tested.

> T97897\_dpatrick\_refactor.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/yoxw3kk3nfcryf3lrena/PHID-FILE-egcmpkg376egenrntbaa/T97897_dpatrick_refactor.patch) is a refactor which pulls out the preg\_match() and adds additional test cases.

I'm not liking that we would now have IP::sanitizeIP()/IP::prettifyIP() that mostly ignores IPv4 and IP::standardizeIPv4() that does real cleanup for v4 but returns false for v6. I'd rather see the public behavior of your IP::standardizeIPv4() integrated into IP::sanitizeIP(). Then just use IP::sanitizeIP() inside the IP::toHex() case for IPv4 like it already does for IPv6. Or is there some sort of BC concern that prevents that?

Code-wise I don't care whether you put the logic from IP::standardizeIPv4() directly into IP::sanitizeIP() or split both the IPv4 and IPv6 logic into private functions with IP::sanitizeIP() just checking the type and calling the appropriate one. As for IP::toHex(), since we're touching it to this extent IMO either IP::IPv6ToRawHex() should be merged in or the IPv4 logic should be split out to a private IP::IPv4ToRawHex(), as it is now it's just weird.

[• dpatrick](/p/dpatrick/) moved this task from [Waiting](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 10 2015, 5:34 PM2015-06-10 17:34:23 (UTC+0)](#1353863)[• dpatrick](/p/dpatrick/) added a comment.[Jun 10 2015, 11:42 PM2015-06-10 23:42:08 (UTC+0)](#1355362)Comment Actions
> In [T97897#1353830](/T97897#1353830), [@Anomie](/p/Anomie/) wrote:
> > In [T97897#1350038](/T97897#1350038), [@dpatrick](/p/dpatrick/) wrote:
> >
> > T97897\_dpatrick\_refactor.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/yoxw3kk3nfcryf3lrena/PHID-FILE-egcmpkg376egenrntbaa/T97897_dpatrick_refactor.patch) is a refactor which pulls out the preg\_match() and adds additional test cases.
>
> I'm not liking that we would now have IP::sanitizeIP()/IP::prettifyIP() that mostly ignores IPv4 and IP::standardizeIPv4() that does real cleanup for v4 but returns false for v6. I'd rather see the public behavior of your IP::standardizeIPv4() integrated into IP::sanitizeIP(). Then just use IP::sanitizeIP() inside the IP::toHex() case for IPv4 like it already does for IPv6. Or is there some sort of BC concern that prevents that?

I do have backwards compatibility concerns, yes. That's why i didn't add the code to sanitizeIP() in this patch. Here are some examples:

* [[[https://git.wikimedia.org/blob/mediawiki%2Fcore/8af83f4ff833b40ce9497e25ff2df439a0fa18a3/includes%2Fapi%2FApiQueryLogEvents.php#L168|](https://git.wikimedia.org/blob/mediawiki/core/8af83f4ff833b40ce9497e25ff2df439a0fa18a3/includes/api/ApiQueryLogEvents.php#L168|)core/includes/api/ApiQueryLogEvents.php:168]] and [[[https://git.wikimedia.org/blob/mediawiki%2Fcore/8af83f4ff833b40ce9497e25ff2df439a0fa18a3/includes%2Flogging%2FLogPager.php#L170|](https://git.wikimedia.org/blob/mediawiki/core/8af83f4ff833b40ce9497e25ff2df439a0fa18a3/includes/logging/LogPager.php#L170|)core/includes/logging/LogPager.php:170]] call IP::sanitizeIP() when searching logs by user. In theory, anonymous users may have leading zeros in their IP octets. If we change IP::sanitizeIP() to remove leading zeros, then searches may fail to find results.
* [[[https://git.wikimedia.org/blob/mediawiki%2Fcore/8af83f4ff833b40ce9497e25ff2df439a0fa18a3/includes%2FWebRequest.php#L1125](https://git.wikimedia.org/blob/mediawiki/core/8af83f4ff833b40ce9497e25ff2df439a0fa18a3/includes/WebRequest.php#L1125) |core/includes/WebRequest.php:1125]] determines the current user's originating IP address from the X-Forwarded-For header, then calls IP::sanitizeIP(). The same sort of failure to locate all changes made by a give user may occur if IP::sanitizeIP() is changed.
* [[[https://git.wikimedia.org/blob/mediawiki%2Fextensions%2FAbuseFilter/f0b0f2826558528115c1bc7356272b9da95115a2/api%2FApiQueryAbuseLog.php#L117|](https://git.wikimedia.org/blob/mediawiki/extensions/AbuseFilter/f0b0f2826558528115c1bc7356272b9da95115a2/api/ApiQueryAbuseLog.php#L117|)AbuseFilter/api/ApiQueryAbuseLog.php:117]], same deal as the first two instances.
* [[[https://git.wikimedia.org/blob/mediawiki%2Fextensions%2FAbuseFilter/f0b0f2826558528115c1bc7356272b9da95115a2/special%2FSpecialAbuseLog.php#L92|](https://git.wikimedia.org/blob/mediawiki/extensions/AbuseFilter/f0b0f2826558528115c1bc7356272b9da95115a2/special/SpecialAbuseLog.php#L92|)AbuseFilter/special/SpecialAbuseLog.php:92]], again.

I stopped examining grep results there, but there were other calls to IP::sanitizeIP() from the CheckUser, GlobalBlocking, ProofreadPage, and TorBlock extensions. In short, I hated to add another method, but I was concerned about breaking stuff by changing the behavior of IP::sanitizeIP().

> Code-wise I don't care whether you put the logic from IP::standardizeIPv4() directly into IP::sanitizeIP() or split both the IPv4 and IPv6 logic into private functions with IP::sanitizeIP() just checking the type and calling the appropriate one. As for IP::toHex(), since we're touching it to this extent IMO either IP::IPv6ToRawHex() should be merged in or the IPv4 logic should be split out to a private IP::IPv4ToRawHex(), as it is now it's just weird.

We can't merge IP::IPv6ToRawHex() into IP::toHex() because it's called from IP::parseCIDR6(). I suppose it makes sense to pull the IPv4 functionality out into a separate IP::IPv4ToRawHex() function, but that function would still need to invoke a separate IP::standardizeIPv4()/IP::removeLeadingIPv4OctetZeros()/whatever in order to meet me original goal of improving testability of the preg\_replace().

[• dpatrick](/p/dpatrick/) moved this task from [In Progress](/project/board/1179/) to [Waiting](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 12 2015, 11:39 PM2015-06-12 23:39:06 (UTC+0)](#1362027)

[Anomie](/p/Anomie/) added a comment.[Jun 15 2015, 5:53 PM2015-06-15 17:53:48 (UTC+0)](#1366668)Comment Actions

I'd rather actually look into those calls to see if anything really would break. XFF header parsing, for example, really *should* be normalizing the zeros to prevent spurious non-matches if some upstream is injecting IPs with the abnormal zeros.

[• dpatrick](/p/dpatrick/) moved this task from [Waiting](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jul 7 2015, 6:59 PM2015-07-07 18:59:56 (UTC+0)](#1435520)[• dpatrick](/p/dpatrick/) added a comment.[Jul 13 2015, 6:06 PM2015-07-13 18:06:06 (UTC+0)](#1450079)Comment Actions

This patch integrates zero trimming into sanitizeIP: T97897\_01.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/yalwuohhhtgcsaggilrd/PHID-FILE-piuz4wrdoelzhvjdihwz/T97897_01.patch)

[• dpatrick](/p/dpatrick/) moved this task from [In Progress](/project/board/1179/) to [Waiting](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jul 13 2015, 6:07 PM2015-07-13 18:07:49 (UTC+0)](#1450084)[• csteipp](/p/csteipp/) subscribed.[Jul 13 2015, 10:19 PM2015-07-13 22:19:29 (UTC+0)](#1450835)Comment Actions
> In [T97897#1450079](/T97897#1450079), [@dpatrick](/p/dpatrick/) wrote:
>
> This patch integrates zero trimming into sanitizeIP: T97897\_01.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/yalwuohhhtgcsaggilrd/PHID-FILE-piuz4wrdoelzhvjdihwz/T97897_01.patch)

Comment for sanitizeIP should be updated to reflect the change for ipv4. Otherwise I think that addresses [@Anomie](/p/Anomie/)'s comments.

[• dpatrick](/p/dpatrick/) added a comment.[Jul 14 2015, 5:01 AM2015-07-14 05:01:12 (UTC+0)](#1451270)Comment Actions

[@csteipp](/p/csteipp/), thanks. Updated and rebased: T97897\_02.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/k5bw5txpd2zzay7bq3wd/PHID-FILE-lba5wriaqmyjlb5tpfe3/T97897_02.patch)

[• dpatrick](/p/dpatrick/) added a comment.[Aug 4 2015, 10:36 PM2015-08-04 22:36:29 (UTC+0)](#1508287)Comment Actions

[@Anomie](/p/Anomie/), any more comments?

[Platonides](/p/Platonides/) subscribed.[Sep 10 2015, 12:20 AM2015-09-10 00:20:31 (UTC+0)](#1623297)[• dpatrick](/p/dpatrick/) added a comment.[Sep 25 2015, 7:23 PM2015-09-25 19:23:39 (UTC+0)](#1675916)Comment Actions

[@Anomie](/p/Anomie/)?

[Anomie](/p/Anomie/) added a comment.[Sep 25 2015, 8:29 PM2015-09-25 20:29:18 (UTC+0)](#1676302)Comment Actions

T97897\_02.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/k5bw5txpd2zzay7bq3wd/PHID-FILE-lba5wriaqmyjlb5tpfe3/T97897_02.patch) seems ok to me. Haven't tested.

[• csteipp](/p/csteipp/) added a comment.[Oct 13 2015, 11:46 PM2015-10-13 23:46:07 (UTC+0)](#1723987)Comment Actions

I wasn't able to duplicate Vituzzu original issue in my testing, where all newbies were blocked. But I can confirm that after this patch, adding a block with 000 in it is normalized correctly to a 0, and the IP is actually blocked, where before the IP wasn't. Both via the Special page and API. Setting a local block exemption seems to work correctly with the patch as well.

Also, if a trusted proxy adds an IP with a 00 in it, the user is still correctly blocked, although there's a php warning,

```
Warning: inet_pton(): Unrecognized address 141.00.11.253 in <b>/var/www/wiki/en/vendor/wikimedia/ip-set/src/IPSet.php
```

I'll go ahead and deploy this in the next day or two.

[• dpatrick](/p/dpatrick/) added a comment.[Oct 14 2015, 12:03 AM2015-10-14 00:03:45 (UTC+0)](#1724063)Comment Actions

Swell. Thanks Chris. Is that warning worth mentioning to the IPSet maintainer?

[• csteipp](/p/csteipp/) closed this task as Resolved.[Nov 2 2015, 7:07 PM2015-11-02 19:07:15 (UTC+0)](#1774872)[• csteipp](/p/csteipp/) added a parent task: [T115722: MediaWiki Security release 1.25.4](/T115722).Comment Actions

18:53 csteipp: deployed patches for [T97897](/T97897) & [T115522](/T115522)

[• csteipp](/p/csteipp/) mentioned this in [T115522: Passwords generated by User::randomPassword() may be shorter than $wgMinimalPasswordLength](/T115522).[Nov 2 2015, 7:08 PM2015-11-02 19:08:54 (UTC+0)](#1774884)[• csteipp](/p/csteipp/) mentioned this in [T117471: Special:Contribs cuts last "0" in the username](/T117471).[Nov 2 2015, 8:39 PM2015-11-02 20:39:31 (UTC+0)](#1775302)

[Legoktm](/p/Legoktm/) reopened this task as Open.[Nov 2 2015, 8:40 PM2015-11-02 20:40:54 (UTC+0)](#1775306)[Legoktm](/p/Legoktm/) subscribed.Comment Actions

Patch caused [T117471: Special:Contribs cuts last "0" in the username](/T117471) and was reverted.

[• dpatrick](/p/dpatrick/) moved this task from [Waiting](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Nov 9 2015, 9:17 PM2015-11-09 21:17:04 (UTC+0)](#1794587)[• dpatrick](/p/dpatrick/) added a comment.[Nov 14 2015, 4:22 AM2015-11-14 04:22:38 (UTC+0)](#1805290)Comment Actions

Here is an updated patch T97897\_03.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/kwum3sphczmreumi6y7m/PHID-FILE-vqev7i3kgytnqmibtdtj/T97897_03.patch) which addresses [T117471](/T117471) and [T117476](/T117476). These were both caused by sanitizeIP() being invoked on login via User -> Title -> MediaWikiTitleCodec. The patch limits 0 removal to only strings which appear as valid IPv4 addresses.

[• dpatrick](/p/dpatrick/) moved this task from [In Progress](/project/board/1179/) to [Waiting](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Nov 14 2015, 4:22 AM2015-11-14 04:22:52 (UTC+0)](#1805292)[• csteipp](/p/csteipp/) added a comment.[Nov 19 2015, 8:39 PM2015-11-19 20:39:28 (UTC+0)](#1818516)Comment Actions

T97897\_03.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/kwum3sphczmreumi6y7m/PHID-FILE-vqev7i3kgytnqmibtdtj/T97897_03.patch)

LGTM

[• csteipp](/p/csteipp/) closed this task as Resolved.[Nov 19 2015, 10:27 PM2015-11-19 22:27:58 (UTC+0)](#1818879)Comment Actions

22:11 csteipp: deployed patch for [T97897](/T97897)

[Jalexander](/p/Jalexander/) added subscribers: [Bsadowski1](/p/Bsadowski1/), [Jalexander](/p/Jalexander/).[Dec 3 2015, 9:06 PM2015-12-03 21:06:29 (UTC+0)](#1850018)[Jalexander](/p/Jalexander/) added a subscriber: [Matanya](/p/Matanya/).[Dec 3 2015, 9:13 PM2015-12-03 21:13:48 (UTC+0)](#1850040)[Vituzzu](/p/Vituzzu/) added a project: [Stewards-and-global-tools](/tag/stewards-and-global-tools/).[Dec 3 2015, 9:14 PM2015-12-03 21:14:17 (UTC+0)](#1850041)[• demon](/p/demon/) subscribed.[Dec 15 2015, 7:39 PM2015-12-15 19:39:09 (UTC+0)](#1881883)Comment Actions
> In [T97897#1818516](/T97897#1818516), [@csteipp](/p/csteipp/) wrote:
>
> T97897\_03.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/kwum3sphczmreumi6y7m/PHID-FILE-vqev7i3kgytnqmibtdtj/T97897_03.patch)
>
> LGTM

Patch applies cleanly to 1.24 and beyond.

Patch for 1.23: T97897-REL1\_23.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/lqvtgbf223t2oqeas4pt/PHID-FILE-2qmr6gsrzxwhukgjgcmc/T97897-REL1_23.patch)

[• demon](/p/demon/) added a subscriber: [Grunny](/p/Grunny/).[Dec 17 2015, 1:19 AM2015-12-17 01:19:23 (UTC+0)](#1886678)[• demon](/p/demon/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-yme342yemzeanej/)" to "Public (No Login Required)".[Dec 18 2015, 12:40 AM2015-12-18 00:40:33 (UTC+0)](#1889496)[• demon](/p/demon/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-pmvbbbzk7ch5otm/)" to "All Users".Restricted Application changed the visibility from "Public (No Login Required)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-gu7554cbqd2q4ts/)".  · [View Herald Transcript](/herald/transcript/1099312/)[Dec 18 2015, 12:40 AM2015-12-18 00:40:33 (UTC+0)](#1889498)Restricted Application changed the edit policy from "All Users" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-okt2tx7xv5n7ly5/)".  · [View Herald Transcript](/herald/transcript/1099312/)[Reedy](/p/Reedy/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-hi6k7o2abvez2e6/)" to "Public (No Login Required)".[Dec 18 2015, 6:41 PM2015-12-18 18:41:43 (UTC+0)](#1891181)[Reedy](/p/Reedy/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-5feiivzqvgokcxy/)" to "All Users".[Reedy](/p/Reedy/) changed Security from Software security bug to None.[Reedy](/p/Reedy/) added a project: [MediaWiki-User-management](/tag/mediawiki-user-management/).[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-4zdpmcouoqeer6e/)[Dec 24 2015, 12:12 AM2015-12-24 00:12:09 (UTC+0)](#1902807)Restricted Application added a subscriber: [Luke081515](/p/Luke081515/).  · [View Herald Transcript](/herald/transcript/1106418/)[Dec 24 2015, 12:12 AM2015-12-24 00:12:09 (UTC+0)](#1902808)[MarcoAurelio](/p/MarcoAurelio/) moved this task from [Untriaged](/project/board/1596/) to [Closed](/project/board/1596/) on the [Stewards-and-global-tools](/tag/stewards-and-global-tools/) board.[Jan 24 2016, 2:41 PM2016-01-24 14:41:58 (UTC+0)](#1960209)Restricted Application added a subscriber: [JEumerus](/p/JEumerus/).  · [View Herald Transcript](/herald/transcript/1139921/)[Jan 24 2016, 2:41 PM2016-01-24 14:41:58 (UTC+0)](#1960210)[sbassett](/p/sbassett/) moved this task from [Waiting](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 11 2019, 6:03 PM2019-06-11 18:03:48 (UTC+0)](#5250711)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:59 PM2020-02-10 22:59:38 (UTC+0)](#5869794) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:17 PM2020-02-20 20:17:57 (UTC+0)](#5904819) · [Aklapper](/p/Aklapper/) removed a subscriber: [Anomie](/p/Anomie/).[Oct 16 2020, 5:42 PM2020-10-16 17:42:28 (UTC+0)](#6555141) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from www.openwall.com_2fbecf2b_20250125_044031.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2015/12/21/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151223190658.1F7406FC009@smtpvmsrv1.mitre.org>
Date: Wed, 23 Dec 2015 14:06:58 -0500 (EST)
From: cve-assign@...re.org
To: csteipp@...imedia.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE requests for MediaWiki 1.26.1, 1.25.4, 1.24.5 and 1.23.12

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> * (T117899) XSS from wikitext when $wgArticlePath='$1'. Internal review
> discovered an XSS vector when MediaWiki is configured with a non-standard
> configuration.
> <<https://phabricator.wikimedia.org/T117899>>

Use CVE-2015-8622.

> * (T119309) User::matchEditToken should use constant-time string
> comparison. Internal review discovered that tokens were being compared as
> strings, which could allow a timing attack. This should possibly have 2
> CVE's assigned,

> one for the original patch to use hash_equals in
> <https://gerrit.wikimedia.org/r/#/c/156336/5/includes/User.php> (released as
> part of MediaWiki 1.25, and backported to 1.24 and 1.23 as part of this
> patch)

Use CVE-2015-8623.

> one to fix T119309, related to the debugging statement.
> <<https://phabricator.wikimedia.org/T119309>>

Use CVE-2015-8624.

(Neither of the above two CVEs is the same as CVE-2015-6728, which
involves a different type of token.)

> * (T118032) Error thrown by VirtualRESTService when POST variable starts
> with '@'. Internal review discovered that MediaWiki was not sanitizing
> parameters passed to the curl library, which could cause curl to upload
> files from the webserver to an attacker.
> <<https://phabricator.wikimedia.org/T118032>>

> allows curl to try to be "helpful" by interpreting
> array( 'foo' => '@...' ) as a file upload.

Use CVE-2015-8625.

> <https://github.com/facebook/hhvm/issues/6569>

There is currently no CVE ID assigned for any related HHVM behavior.
It is conceivable that a CVE ID should exist if the
CURLOPT_SAFE_UPLOAD feature is required for HHVM's security policy,
or if it happens to be dangerously misleading to use the 5.6.99
version number but not address this curl concern.

> * (T115522) Passwords generated by User::randomPassword() may be shorter
> than $wgMinimalPasswordLength. MediaWiki user Frank R. Farmer reported that
> the password reset token could be shorter than the minimum required
> password length.
> <<https://phabricator.wikimedia.org/T115522>>

Use CVE-2015-8626.

> * (T97897) Incorrect parsing of IPs for global block. Wikimedia steward
> Vituzzu reported that blocking IP addresses with zero-padded octets
> resulted in a failure to block the IP address.
> <<https://phabricator.wikimedia.org/T97897>>

The security problem needing a CVE is that a partially privileged user
may falsely conclude that an address was successfully blocked, but the
address was actually not blocked. There is potentially a second
security problem in which a malicious partially privileged user could
have intentionally used extra zero characters to block a wide range of
legitimate editing ("this apparently blocked all newly registered
users"), leaving behind only a log entry that seemed to be about
blocking a single IP address. We are not sure whether this second
problem is relevant in the context of any MediaWiki threat model.

Use CVE-2015-8627.

> * (T109724) A combination of Special:MyPage redirects and pagecounts allows
> an external site to know the wikipedia login of an user. Wikimedia
> user Xavier Combelle reported a way to identify user, when detailed page
> view data is also released.
> <<https://phabricator.wikimedia.org/T109724>>

Our feeling is that the previous behavior should have a CVE because it
violates reasonable expectations about whether the set of visited URIs
contains, by itself, user identities. In the T109724 example, if a
client had visited a User:Xavier_Combelle page, no user identity is
potentially exposed because there is no discernible relationship
between the client and the name "Xavier Combelle." A visit to a
Special:MyPage page is an entirely different situation. Here, the
MediaWiki software is, in effect, combining the basic visited-URI
information with session information (the session belongs to Xavier
Combelle's account) in order to expand the scope of the visited-URI
concept. If that had been completely obvious (e.g., if MediaWiki had
always expressed visited URIs as something like
/Main_Page?logged_in_user=Xavier_Combelle and
/Special:MyPage?logged_in_user=Xavier_Combelle), then it wouldn't be a
vulnerability because people constructing reasonable analytics would
know to strip out the "logged_in_user=" fields. However, it's not
obvious at all: the server-side transformation of Special:MyPage to
User:Xavier_Combelle doesn't signal that an analytics implementation
needs to be concerned about an information leak. Also, we don't think
it can be considered a bug in any analytics product or site-specific
analytics methodology, because the information leak can also occur if
analytics are done informally by hand. For example, a site's owner
might announce something like "Our top five pages for 2015 were /ABC,
/DEF, /GHI, /JKL, and /User:Xavier_Combelle - not sure why that last
one was popular, but it was." Here, the actual situation could have
been the <https://phabricator.wikimedia.org/T109724#1637543> "if you can
convince the user to load special:mypage via say a hidden iframe, you
can just as easily convince them to load it 500 times" attack.

Use CVE-2015-8628.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWevBCAAoJEL54rhJi8gl5xEEP/iecCWFKyUu1OktHZ9kTYsez
Rh/0CZKaADtQkqX+lz6RhB6LruS0lOnWdBB2yjTx5iveDgApn0gQ753pubqm3xBV
8EHdRwgN91X6iUWVDP777CcaDdPhQPinW2Az8sWI1i6walS7G2fst6JcWHM9vJ2W
Zu2BVUFPXvsFdUgPmLrJ0RzbrmNFsj0req/fapBEdQ6dUdKxYLQA3RSfiRz4ZMB5
D1t+Y3/c0MBnusmpS2bDoobfVIUuyqwB0SHOvEnlyBcgX3fgxIIdexFhh5d9FGgC
DH9/KtPZkU9Jtv1OiDLKib5/Nl1mjgZHj9kY7I6gUqEw2aw31tAMQGzqcDanIkJv
L0HXeIMvJu7XHoOWW8r3xunWKsdmqFXzJiLAX9Jnl5Dhlwsm3InI0myC8xdSLBPD
jW/XPWtSA41B8ZNyz1CGFxRcQH41tQ+LB6p0V4Fm2Kpq+9mdR4e4j2nACTt/IZey
/Fh93SZqIVfQ9XIkafvXVBS6a6hv6nGdhe+PTtUbG0xUAPaeacUuBTgscSdXzUmi
mTsNd2phjtH3TNB1aWue8OmFYeCp0Ru5NkzBAJDlsa6zCX+DJShN0QpM0ljp5eqq
nrtGytRfrmGSZ6zO/n7Y9M6Pgt9y7jpcrbY0OzMCIleHGvYMVe+q5K7hsbwQGyOZ
5w4zLSpVVCp1bY6bvHpN
=zTit
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from phab.wmfusercontent.org_388d6901_20250126_060151.html ===
From 9947848ca1a71a3288c392f9a85d65fc682052d5 Mon Sep 17 00:00:00 2001
From: Chad Horohoe
Date: Tue, 15 Dec 2015 11:37:21 -0800
Subject: [PATCH] Fix IP::toHex for IPv4 addresses with a double/triple 0 block
Bug: T97897
Change-Id: I5c0a37be42ae2c5091ead487a6d19f6e0dd89b36
---
includes/utils/IP.php | 22 +++++++++++++++------
tests/phpunit/includes/utils/IPTest.php | 35 +++++++++++++++++++++++++++------
2 files changed, 45 insertions(+), 12 deletions(-)
diff --git a/includes/utils/IP.php b/includes/utils/IP.php
index 871f71b..9390dd8 100644
--- a/includes/utils/IP.php
+++ b/includes/utils/IP.php
@@ -127,8 +127,9 @@ class IP {
/\*\*
\* Convert an IP into a verbose, uppercase, normalized form.
- \* IPv6 addresses in octet notation are expanded to 8 words.
- \* IPv4 addresses are just trimmed.
+ \* Both IPv4 and IPv6 addresses are trimmed. Additionally,
+ \* IPv6 addresses in octet notation are expanded to 8 words;
+ \* IPv4 addresses have leading zeros, in each octet, removed.
\*
\* @param string $ip IP address in quad or octet form (CIDR or not).
\* @return String
@@ -138,8 +139,16 @@ class IP {
if ( $ip === '' ) {
return null;
}
- if ( self::isIPv4( $ip ) || !self::isIPv6( $ip ) ) {
- return $ip; // nothing else to do for IPv4 addresses or invalid ones
+ /\* If not an IP, just return trimmed value, since sanitizeIP() is called
+ \* in a number of contexts where usernames are supplied as input.
+ \*/
+ if ( !self::isIPAddress($ip) ) {
+ return $ip;
+ }
+ if ( self::isIPv4( $ip ) ) {
+ // Remove leading 0's from octet representation of IPv4 address
+ $ip = preg\_replace( '/(?:^|(?<=\.))0+(?=[1-9]|0\.|0$)/', '', $ip );
+ return $ip;
}
// Remove any whitespaces, convert to upper case
$ip = strtoupper( $ip );
@@ -489,8 +498,9 @@ class IP {
if ( self::isIPv6( $ip ) ) {
$n = self::toUnsigned6( $ip );
} else {
- // Bug 60035: an IP with leading 0's fails in ip2long sometimes (e.g. \*.08)
- $ip = preg\_replace( '/(?<=\.)0+(?=[1-9])/', '', $ip );
+ // T62035/T97897: An IP with leading 0's fails in ip2long sometimes (e.g. \*.08),
+ // also double/triple 0 needs to be changed to just a single 0 for ip2long.
+ $ip = self::sanitizeIP( $ip );
$n = ip2long( $ip );
if ( $n < 0 ) {
$n += pow( 2, 32 );
diff --git a/tests/phpunit/includes/utils/IPTest.php b/tests/phpunit/includes/utils/IPTest.php
index 1267268..bcba179 100644
--- a/tests/phpunit/includes/utils/IPTest.php
+++ b/tests/phpunit/includes/utils/IPTest.php
@@ -270,15 +270,37 @@ class IPTest extends MediaWikiTestCase {
}
/\*\*
- \* Improve IP::sanitizeIP() code coverage
- \* @todo Most probably incomplete
- \*/
- public function testSanitizeIP() {
- $this->assertNull( IP::sanitizeIP( '' ) );
- $this->assertNull( IP::sanitizeIP( ' ' ) );
+ \* @covers IP::sanitizeIP
+ \* @dataProvider provideSanitizeIP
+ \*/
+ public function testSanitizeIP( $expected, $input ) {
+ $result = IP::sanitizeIP( $input );
+ $this->assertEquals( $expected, $result );
}
/\*\*
+ \* Provider for IP::testSanitizeIP()
+ \*/
+ public static function provideSanitizeIP() {
+ return array(
+ array( '0.0.0.0', '0.0.0.0' ),
+ array( '0.0.0.0', '00.00.00.00' ),
+ array( '0.0.0.0', '000.000.000.000' ),
+ array( '141.0.11.253', '141.000.011.253' ),
+ array( '1.2.4.5', '1.2.4.5' ),
+ array( '1.2.4.5', '01.02.04.05' ),
+ array( '1.2.4.5', '001.002.004.005' ),
+ array( '10.0.0.1', '010.0.000.1' ),
+ array( '80.72.250.4', '080.072.250.04' ),
+ array( 'Foo.1000.00', 'Foo.1000.00'),
+ array( 'Bar.01', 'Bar.01'),
+ array( 'Bar.010', 'Bar.010'),
+ array( null, ''),
+ array( null, ' ')
+ );
+ }
+
+ /\*\*
\* @covers IP::toUnsigned
\* @dataProvider provideToUnsigned
\*/
@@ -331,6 +353,7 @@ class IPTest extends MediaWikiTestCase {
array( '80000000', '128.0.0.0' ),
array( 'DEADCAFE', '222.173.202.254' ),
array( 'FFFFFFFF', '255.255.255.255' ),
+ array( '8D000BFD', '141.000.11.253' ),
array( false, 'IN.VA.LI.D' ),
array( 'v6-00000000000000000000000000000001', '::1' ),
array( 'v6-20010DB885A3000000008A2E03707334', '2001:0db8:85a3:0000:0000:8a2e:0370:7334' ),
--
2.6.4


=== Content from gerrit.wikimedia.org_4bd6a893_20250126_060151.html ===




=== Content from www.openwall.com_6eb38e78_20250125_044030.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[thread-next>]](../../../2015/12/23/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAKcmtDwuatO7TaTOdeun9q4s9Wv_SfWK6Hzk24b2J227YnL23Q@mail.gmail.com>
Date: Mon, 21 Dec 2015 11:37:14 -0800
From: Chris Steipp <csteipp@...imedia.org>
To: oss-security@...ts.openwall.com
Subject: CVE requests for MediaWiki 1.26.1, 1.25.4, 1.24.5 and 1.23.12

We recently released security fixes for MediaWiki. I believe the first five
issues should have CVE's assigned. The last issue (T109724) requires that
the organization running the wiki also releases detailed page view data
publicly, and probably not worth tracking with a CVE. However I'm happy for
mitre to assign one of they think this generally qualifies.

* (T117899) XSS from wikitext when $wgArticlePath='$1'. Internal review
discovered an XSS vector when MediaWiki is configured with a non-standard
configuration.
<<https://phabricator.wikimedia.org/T117899>>

* (T119309) User::matchEditToken should use constant-time string
comparison. Internal review discovered that tokens were being compared as
strings, which could allow a timing attack. This should possibly have 2
CVE's assigned, one for the original patch to use hash_equals in
<https://gerrit.wikimedia.org/r/#/c/156336/5/includes/User.php> (released as
part of MediaWiki 1.25, and backported to 1.24 and 1.23 as part of this
patch) and one to fix T119309, related to the debugging statement.
<<https://phabricator.wikimedia.org/T119309>>

* (T118032) Error thrown by VirtualRESTService when POST variable starts
with '@'. Internal review discovered that MediaWiki was not sanitizing
parameters passed to the curl library, which could cause curl to upload
files from the webserver to an attacker.
<<https://phabricator.wikimedia.org/T118032>>

* (T115522) Passwords generated by User::randomPassword() may be shorter
than $wgMinimalPasswordLength. MediaWiki user Frank R. Farmer reported that
the password reset token could be shorter than the minimum required
password length.
<<https://phabricator.wikimedia.org/T115522>>

* (T97897) Incorrect parsing of IPs for global block. Wikimedia steward
Vituzzu reported that blocking IP addresses with zero-padded octets
resulted in a failure to block the IP address.
<<https://phabricator.wikimedia.org/T97897>>

* (T109724) A combination of Special:MyPage redirects and pagecounts allows
an external site to know the wikipedia login of an user. Wikimedia
user Xavier Combelle reported a way to identify user, when detailed page
view data is also released.
<<https://phabricator.wikimedia.org/T109724>>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.wikimedia.org_9e104674_20250125_044031.html ===


[lists.wikimedia.org](/hyperkitty/)

[Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/R3SCYWFP4J6IXVKWQORH74XTD4TO44MA/)
[Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/R3SCYWFP4J6IXVKWQORH74XTD4TO44MA/)

* [Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/R3SCYWFP4J6IXVKWQORH74XTD4TO44MA/)
* [Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/R3SCYWFP4J6IXVKWQORH74XTD4TO44MA/)

* [Manage this list](/postorius/lists/mediawiki-announce.lists.wikimedia.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2025/1/)

### 2024

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/1/)

### 2023

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/1/)

### 2022

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/1/)

### 2021

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/1/)

### 2020

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/1/)

### 2019

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/1/)

### 2018

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/1/)

### 2017

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/1/)

### 2016

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/1/)

### 2015

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/1/)

### 2014

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/1/)

### 2013

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/1/)

### 2012

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/1/)

### 2011

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/1/)

### 2010

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/1/)

### 2009

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/1/)

### 2008

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/1/)

### 2007

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/1/)

### 2006

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/1/)

### 2005

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/1/)

### 2004

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2004/12/)

[List overview](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

[Download](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/export/mediawiki-announce%40lists.wikimedia.org-R3SCYWFP4J6IXVKWQORH74XTD4TO44MA.mbox.gz?message=R3SCYWFP4J6IXVKWQORH74XTD4TO44MA "This message in gzipped mbox format")

[thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/R3SCYWFP4J6IXVKWQORH74XTD4TO44MA/#R3SCYWFP4J6IXVKWQORH74XTD4TO44MA)

# [MediaWiki-announce] Security Release: 1.26.1, 1.25.4, 1.24.5 and 1.23.12

[Chad](/hyperkitty/users/106c86c03e624f118ae876f1a13c1316/ "See the profile for Chad")

18 Dec
2015

18 Dec
'15

7:25 a.m.

I would like to announce the release of MediaWiki 1.26.1, 1.25.4, 1.24.5,
and
1.23.12.

These releases fix five security issues in core, in addition to other bug
fixes. Download links are given at the end of this email

== Security fixes ==

(T117899) SECURITY: $wgArticlePath can no longer be set to relative paths
that
do not begin with a slash. This enabled trivial XSS attacks. Configuration
values such as "[http://my.wiki.com/wiki/$1](http://my.wiki.com/wiki/%241)" are fine, as are "/wiki/$1". A
value such as "$1" or "wiki/$1" is not and will now throw an error

(T119309) SECURITY: Use hash\_compare() for edit token comparison

(T118032) SECURITY: Don't allow cURL to interpret POST parameters starting
with
'@' as file uploads

(T115522) SECURITY: Passwords generated by User::randomPassword() can no
longer
be shorter than $wgMinimalPasswordLength

(T97897) SECURITY: Improve IP parsing and trimming. Previous behavior could
result in improper blocks being issued

(T109724) SECURITY: Special:MyPage, Special:MyTalk, Special:MyContributions
and
related pages no longer use HTTP redirects and are now redirected by
MediaWiki

== Note about EOL of 1.24.x ==

Please note that 1.24.5 marks the end of support for the 1.24.x series of
releases. Technically this ended a few weeks ago with the release of 1.26.0
but
we dropped one final release of 1.24.x here to give it a nicer send off for
those who have not yet upgraded.

== Release notes ==

Full release notes for 1.26.1:
<https://www.mediawiki.org/wiki/Release_notes/1.26>

Full release notes for 1.25.4:
<https://www.mediawiki.org/wiki/Release_notes/1.25>

Full release notes for 1.24.5:
<https://www.mediawiki.org/wiki/Release_notes/1.24>

Full release notes for 1.23.12:
<https://www.mediawiki.org/wiki/Release_notes/1.23>

For information about how to upgrade, see
[https://www.mediawiki.org/wiki/Manual:Upgrading](https://www.mediawiki.org/wiki/Manual%3AUpgrading)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.26.1
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<https://releases.wikimedia.org/mediawiki/1.26/mediawiki-1.26.1.tar.gz>
<https://releases.wikimedia.org/mediawiki/1.26/mediawiki-core-1.26.1.tar.gz>

Patch to previous version:
<https://releases.wikimedia.org/mediawiki/1.26/mediawiki-1.26.1.patch.gz>
<https://releases.wikimedia.org/mediawiki/1.26/mediawiki-i18n-1.26.1.patch.gz>

GPG signatures:
<https://releases.wikimedia.org/mediawiki/1.26/mediawiki-1.26.1.tar.gz.sig>
<https://releases.wikimedia.org/mediawiki/1.26/mediawiki-1.26.1.patch.gz.sig>
[https://releases.wikimedia.org/mediawiki/1.26/mediawiki-core-1.26.1.tar.gz.s...](https://releases.wikimedia.org/mediawiki/1.26/mediawiki-core-1.26.1.tar.gz.sig)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.25.4
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<https://releases.wikimedia.org/mediawiki/1.25/mediawiki-1.25.4.tar.gz>
<https://releases.wikimedia.org/mediawiki/1.25/mediawiki-core-1.25.4.tar.gz>

Patch to previous version:
<https://releases.wikimedia.org/mediawiki/1.25/mediawiki-1.25.4.patch.gz>
<https://releases.wikimedia.org/mediawiki/1.25/mediawiki-i18n-1.25.4.patch.gz>

GPG signatures:
<https://releases.wikimedia.org/mediawiki/1.25/mediawiki-1.25.4.tar.gz.sig>
<https://releases.wikimedia.org/mediawiki/1.25/mediawiki-1.25.4.patch.gz.sig>
[https://releases.wikimedia.org/mediawiki/1.25/mediawiki-core-1.25.4.tar.gz.s...](https://releases.wikimedia.org/mediawiki/1.25/mediawiki-core-1.25.4.tar.gz.sig)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.24.5
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<https://releases.wikimedia.org/mediawiki/1.24/mediawiki-1.24.5.tar.gz>
<https://releases.wikimedia.org/mediawiki/1.24/mediawiki-core-1.24.5.tar.gz>

Patch to previous version:
<https://releases.wikimedia.org/mediawiki/1.24/mediawiki-1.24.5.patch.gz>
<https://releases.wikimedia.org/mediawiki/1.24/mediawiki-i18n-1.24.5.patch.gz>

GPG signatures:
<https://releases.wikimedia.org/mediawiki/1.24/mediawiki-1.24.5.tar.gz.sig>
<https://releases.wikimedia.org/mediawiki/1.24/mediawiki-1.24.5.patch.gz.sig>
[https://releases.wikimedia.org/mediawiki/1.24/mediawiki-core-1.24.5.tar.gz.s...](https://releases.wikimedia.org/mediawiki/1.24/mediawiki-core-1.24.5.tar.gz.sig)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.23.12
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<https://releases.wikimedia.org/mediawiki/1.23/mediawiki-1.23.12.tar.gz>
<https://releases.wikimedia.org/mediawiki/1.23/mediawiki-core-1.23.12.tar.gz>

Patch to previous version:
<https://releases.wikimedia.org/mediawiki/1.23/mediawiki-1.23.12.patch.gz>
[https://releases.wikimedia.org/mediawiki/1.23/mediawiki-i18n-1.23.12.patch.g...](https://releases.wikimedia.org/mediawiki/1.23/mediawiki-i18n-1.23.12.patch.gz)

GPG signatures:
<https://releases.wikimedia.org/mediawiki/1.23/mediawiki-1.23.12.tar.gz.sig>
<https://releases.wikimedia.org/mediawiki/1.23/mediawiki-1.23.12.patch.gz.sig>
[https://releases.wikimedia.org/mediawiki/1.23/mediawiki-core-1.23.12.tar.gz....](https://releases.wikimedia.org/mediawiki/1.23/mediawiki-core-1.23.12.tar.gz.sig)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

-Chad H. & Chris S.

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/R3SCYWFP4J6IXVKWQORH74XTD4TO44MA/#R3SCYWFP4J6IXVKWQORH74XTD4TO44MA)

[Back to the list](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.


