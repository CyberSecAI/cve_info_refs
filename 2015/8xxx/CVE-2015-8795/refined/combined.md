=== Content from issues.apache.org_7504e4ae_20250125_135619.html ===


[Log in](/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-7346)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![ASF JIRA](/jira/s/xd97tr/820010/13pdxe5/_/jira-logo-scaled.png)](https://issues.apache.org/jira/secure/MyJiraHome.jspa)

* [Dashboards](/jira/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/jira/browse/SOLR "View recent projects and browse a list of projects")
* [Issues](/jira/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/jira/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/jira/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/jira/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-7346)

Public signup for this instance is **disabled**. Go to our [Self serve sign up page](https://selfserve.apache.org/jira-account.html) to request an account. Report potential security issues [privately](https://apache.org/security/#reporting-a-vulnerability)

![Uploaded image for project: 'Solr'](https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151)

1. [Solr](/jira/browse/SOLR)
2. [SOLR-7346](/jira/browse/SOLR-7346)

# Stored XSS in Admin UI Schema-Browser page and Analysis page

[Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-7346 "Log In")Export

XMLWordPrintableJSON
#### Details

* **Type:**
  ![](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Status:**
  Closed
* **Priority:**
  ![](/jira/images/icons/priorities/major.svg "Major - Major loss of function.") Major
* **Resolution:**
  Fixed
* **Affects Version/s:**
  4.10.2, 5.0
* **Fix Version/s:**
  [5.1](/jira/issues/?jql=project+%3D+SOLR+AND+fixVersion+%3D+5.1 "5.1 Major release after 5.0"), [6.0](/jira/issues/?jql=project+%3D+SOLR+AND+fixVersion+%3D+6.0 "6.0 First 6.x release, Major release after 5.5")
* **Component/s:**
  [Admin UI](/jira/issues/?jql=project+%3D+SOLR+AND+component+%3D+%22Admin+UI%22 "Admin UI Solr's Web Admin GUI (AngularJS)")
* **Labels:**
  + [patch](/jira/issues/?jql=labels+%3D+patch "patch")
  + [security](/jira/issues/?jql=labels+%3D+security "security")
* **Environment:**

  linux x86\_64

  jdk 1.7.0.75

  apache tomcat-7.0.57

  solr 5.0.0
#### Description

Like CVE-2014-3628 , the vulnerability also exists in Admin UI Schema-Browser page and Analysis page, which was caused by improper validation of user-supplied input, for example, create fields by Schema API. When the Schema-Browser page or Analysis page url is clicked, an XSS will be triggered. An attacker could use this vulnerability to steal the victim's cookie-based authentication credentials.

patch for solr5.0.0

```
solr/webapp/web/js/scripts/schema-browser.js
    --- schema-browser.js   2015-04-03 14:42:19.000000000 +0800
+++ schema-browser_patch.js     2015-04-03 14:42:59.000000000 +0800
@@ -596,7 +596,7 @@
                     {
                       fields.push
                       (
-                        '<option value="?field=' + field_name + '">' + field_name + '</option>'
+                        '<option value="?field=' + field_name.esc() + '">' + field_name.esc() + '</option>'
                       );
                     }
                     if( 0 !== fields.length )

solr/webapp/web/js/scripts/analysis.js
--- analysis.js 2015-04-03 14:22:34.000000000 +0800
+++ analysis_patch.js   2015-04-03 14:23:09.000000000 +0800
@@ -80,7 +80,7 @@
               {
                 fields.push
                 (
-                  '<option value="fieldname=' + field_name + '">' + field_name + '</option>'
+                  '<option value="fieldname=' + field_name.esc() + '">' + field_name.esc() + '</option>'
                 );
               }
               if( 0 !== fields.length )

```

#### Attachments

#### Activity

#### People

Assignee:

![thelabdude](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Timothy Potter

Reporter:

![meilin](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Mei Wang

Votes:
0
Vote for this issue

Watchers:
4
Start watching this issue

#### Dates

Created:

03/Apr/15 06:46

Updated:

09/May/16 18:43

Resolved:

06/Apr/15 16:51

#### Time Tracking

Estimated:

| Original Estimate - 96h |
| --- |

96h

Remaining:

| Remaining Estimate - 96h |
| --- |

96h

Logged:

| Time Spent - Not Specified |
| --- |

Not Specified

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/jira/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/jira/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Apache Software Foundation. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


