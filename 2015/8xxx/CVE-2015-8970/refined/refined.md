```
{
  "CVE-2015-8970": {
    "Metadata": {
      "Source": "Multiple",
      "Curation_Level": "Complete",
      "Publish_Date": "2016-04-25",
      "Translations": {
        "en": "The lrw_crypt() function in 'crypto/lrw.c' in the Linux kernel before 4.5 allows local users to cause a system crash and a denial of service by the NULL pointer dereference via accept(2) system call for AF_ALG socket without calling setkey() first to set a cipher key."
      }
    },
    "Vulnerability Details": {
      "Root Cause": "The `lrw_crypt()` function in `crypto/lrw.c` in the Linux kernel does not check if a cipher key has been set before trying to use it, resulting in a null pointer dereference.",
      "Weaknesses": [
        "Null Pointer Dereference",
        "Missing Input Validation"
      ],
      "Impact": "A local user can cause a system crash and a denial of service.",
      "Attack Vectors": [
        "Local access to an AF_ALG socket",
        "Calling accept(2) on the socket without prior setkey()"
      ],
      "Required Capabilities": "Local user privileges to open a socket and use the cryptographic API.",
	 "Affected Components": [
        "crypto/lrw.c",
        "AF_ALG socket API"
      ]
	, "Affected Versions": "Linux kernel before 4.5"
	, "Patches" : [
	  {
		"commit" : "dd504589577d8e8e70f51f997ad487a4cb6c026f",
		"description" : "crypto: algif_skcipher - Require setkey before accept(2)"
	   }
	 ]
   , "Additional Information": [
       "This vulnerability does not directly lead to privilege escalation but rather weakens the system's security. It needs to be combined with another kernel vulnerability for privilege escalation.",
        "The vulnerable code is present in the Linux kernel as shipped with Red Hat Enterprise Linux 5, 6 and 7.",
        "The fix involves enforcing a check in the kernel to ensure `setkey()` is called prior to `accept()` on AF_ALG sockets. This prevents the null pointer dereference.",
		"A patch was introduced to the Linux kernel's mainline to avoid having all binaries with executable brk and instead, only have it for programs linked with \"old PLT style\". The --secure-plt linked ones won't be mapped executable."
      ]
    }
  }
}
```