```
{
  "cveId": "CVE-2015-8080",
  "description": "Integer overflow in the getnum function in lua_struct.c in Redis 2.8.x before 2.8.24 and 3.0.x before 3.0.6 allows context-dependent attackers with permission to run Lua code in a Redis session to cause a denial of service (memory corruption and application crash) or possibly bypass intended sandbox restrictions via a large number, which triggers a stack-based buffer overflow.",
  "vulnerability": {
    "rootCause": "The `getnum` function in `lua_struct.c` is vulnerable to an integer wraparound. This occurs when a large size number is provided as input, causing the function to return a negative value due to integer overflow.",
    "weaknesses": [
      "Integer overflow in `getnum` function leading to negative return value.",
      "Lack of lower bound/negative check in `optsize` function, which uses the potentially negative value returned by `getnum`.",
      "Implicit `int` to `size_t` promotion in `optsize` function, resulting in a very large (unsigned) size value when a negative value is promoted.",
      "Further `int`/`size_t` confusion in the module, potentially resulting in stack-based buffer overflows in functions like `putinteger`."
    ],
    "impact": "A user with access to run Lua code in a Redis session could use this flaw to cause a denial of service (server crash) or gain code execution outside of the Lua sandbox due to memory corruption and stack-based buffer overflows.",
    "attackVectors": [
      "By exploiting the integer overflow in `getnum` with a large size input in lua scripts.",
       "By using `struct.pack` with a large size to trigger buffer overflow in `putinteger`."
    ],
    "requiredCapabilities": "The attacker needs the ability to execute Lua code within a Redis session and control data used in scripts. "
  }
}
```