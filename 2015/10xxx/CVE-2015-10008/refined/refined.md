The provided content is related to CVE-2015-10008. This commit introduces security fixes including SQL injection and XSS filtering.

**Root cause of vulnerability:**
- The code was vulnerable to SQL injection due to direct embedding of user-supplied input into SQL queries.
- The code was vulnerable to XSS due to lack of proper sanitization of user-supplied input.

**Weaknesses/vulnerabilities present:**
- SQL Injection: The code used string concatenation instead of prepared statements which made it vulnerable to SQL injection. Specifically the `commercial.php` file has a line
 `$package_info = DB::fetch_first("SELECT `Package`, `Name`, `Tag`, `Level`, `Price`, `Purchase_Link` FROM `".DCRM_CON_PREFIX."Packages` WHERE `Package` = '".$_GET['Package']."' AND `Stat` = '1'");`
- XSS: Lack of proper sanitization in the `commercial.php` file.

**Impact of exploitation:**
- SQL injection could allow attackers to bypass authentication, modify or delete data, or potentially execute arbitrary code on the database server.
- XSS could allow attackers to execute malicious scripts in the browsers of other users, potentially leading to session hijacking, defacement, or phishing attacks.

**Attack vectors:**
- SQL injection: By manipulating the `Package` parameter in the HTTP GET request to `commercial.php`.
- XSS: By manipulating any of the GET parameters that are then used inside the `commercial.php` file.

**Required attacker capabilities/position:**
- The attacker needs to be able to send crafted HTTP GET requests to the vulnerable application.