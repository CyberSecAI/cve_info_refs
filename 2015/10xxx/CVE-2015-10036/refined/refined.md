The provided content is related to a commit that addresses SQL injection vulnerabilities in a location history application.

**Root cause of vulnerability:**
The application was vulnerable to SQL injection due to the direct inclusion of user-supplied data in SQL queries without proper sanitization or parameterization. This was evident in multiple files where `htmlspecialchars()` was used instead of proper escaping or prepared statements.

**Weaknesses/vulnerabilities present:**
SQL injection vulnerabilities were present in the following files:
- `location_history/controllers/__build_query.php`: The date filter and day filter values were being directly concatenated into the SQL query.
- `location_history/controllers/graph.php`: The `location_id` parameter was being directly inserted into the query.
- `location_history/controllers/main.php`: The limit clause was being added to the query without proper sanitization.
- `location_history/controllers/trips.php`: The `location_id` was directly inserted into the query.
- `location_history/controllers/visits.php`:  The `location_id` was directly inserted into the query.
- `location_history/controllers/__parse_query.php` : The limit and day filters were directly added to the query.

**Impact of exploitation:**
Successful exploitation could lead to:
- Unauthorized access to sensitive data
- Data modification or deletion
- Potential compromise of the entire application
- Execution of arbitrary SQL commands

**Attack vectors:**
Attackers could exploit these vulnerabilities by crafting malicious input within the following parameters:
- `dateFilter` (date range)
- `dayFilter` (days of the week to filter out)
- `location_id` (location identifier)
- `limit` (number of results to return)

**Required attacker capabilities/position:**
The attacker would need to be able to submit HTTP POST requests to the affected application endpoints and manipulate the above mentioned parameters.