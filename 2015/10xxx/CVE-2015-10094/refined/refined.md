The provided content relates to CVE-2015-10094.

**Root cause of vulnerability:**

*   The WordPress Fastly plugin, prior to version 0.98, had potential Cross-Site Scripting (XSS) and Cross-Site Request Forgery (CSRF) vulnerabilities.
*   Specifically, the plugin's admin panel did not properly sanitize option values before outputting them into the HTML, leading to potential XSS.
*   Additionally, AJAX handlers `FastlyAdmin::ajaxSetPage()` and `FastlyAdmin::ajaxSignUp()` were not enforcing the presence of a CSRF token, leading to potential CSRF.
*   Furthermore, calls to `update_option()` with dynamic content were not sanitized which could lead to SQL Injection (SQLi).

**Weaknesses/vulnerabilities present:**

*   Cross-Site Scripting (XSS) due to lack of output sanitization in admin panel.
*   Cross-Site Request Forgery (CSRF) due to missing CSRF token validation in AJAX handlers.
*   SQL Injection (SQLi) due to lack of input sanitization in calls to `update_option()` with dynamic content.

**Impact of exploitation:**

*   XSS: An attacker could inject malicious scripts into the admin panel, potentially leading to session hijacking, defacement, or other malicious activities.
*   CSRF: An attacker could trick an authenticated administrator into performing unintended actions, such as changing plugin settings.
*   SQLi: An attacker could potentially manipulate the database, leading to data compromise or other malicious activities.

**Attack vectors:**

*   XSS: An attacker could exploit the lack of output sanitization by injecting malicious content through plugin settings.
*   CSRF: An attacker could craft a malicious request and trick a logged-in admin into submitting it.
*   SQLi: An attacker could manipulate data passed to the `update_option()` function to inject malicious SQL statements.

**Required attacker capabilities/position:**

*   For XSS, an attacker would need to find a way to inject malicious content through plugin settings or options.
*   For CSRF, an attacker needs to trick a logged-in administrator into submitting a crafted malicious request.
*   For SQLi, an attacker would need to manipulate the data passed to the `update_option()` function.

**Mitigation:**
*   The vulnerabilities were addressed in version 0.98 by:
    *   Using `esc_attr()` and `esc_url()` on the Fastly option values before outputting them in the context of the HTML in the admin panel.
    *   Modifying the AJAX handlers `FastlyAdmin::ajaxSetPage()` and `FastlyAdmin::ajaxSignUp()` to use `wp_verify_nonce()` for CSRF token validation.
    *   Modifying AJAX posts to include a CSRF token generated with `wp_create_nonce()` and injected into the script's context using `wp_localize_script()`.
    *   Using `esc_sql()` on dynamic data before passing it to `update_option()`.