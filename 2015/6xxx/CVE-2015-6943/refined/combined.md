=== Content from blog.s9y.org_d765c7b4_20250125_215317.html ===

[Menu](#site-nav)

* [Start](https://www.s9y.org)
* [Docs](http://docs.s9y.org/docs/index.html)
* [Blog](https://blog.s9y.org/)
* [Forums](https://board.s9y.org)
* [Plugins](http://spartacus.s9y.org/)
* [Themes](http://spartacus.s9y.org/index.php?mode=template_all)
* [GitHub](https://github.com/s9y)

# Serendipity 2.0.2 Security Fix Release – Serendipity

Not mainstream since 2002

## [Serendipity 2.0.2 Security Fix Release](/archives/265-Serendipity-2.0.2-Security-Fix-Release.html)

Thanks to the report of Tim Coen (of [Curesec GmbH](http://www.curesec.com)) we were able to adress three security issues in the Serendipity Code.

The first issue was found because authenticed authors are allowed to upload files with extension .pht(ml), that can be executed for PHP code on Apache webserver configurations that use this suffix. If your blog allows upload access for untrusted authors, you should regard this issue as a critical risk.

The second issue is a missing escaping of comment approval tokens, when enabled in your blog which allows for possible SQL injection for data leak and DOS, and also an authenticated user must be tricked into clicking a specifically crafted URL to exploit this (medium risk).

The third issue is missing escaping of a commenting user's name by a javascript of the 2k11 theme (used by default) which is triggered when a user clicks on the "Reply" link (medium risk).

We have prepared two new releases for each of our currently maintained Serendipity version branches and suggest to update your Serendipity version:

* **2.0.2** is the recommended release
* **1.7.9** is the hotfix release for everyone not yet running Serendipity 2.x (you should!)

Check out the **[download locations](http://www.s9y.org/12.html)** for the release files.

Of course, everyone who is using our [Github repository](https://github.com/s9y/Serendipity/) to checkout the Serendipity files will get the patches by pulling our **2.0 branch** or the **master** (2.1.x) for our current development version.

Updating Serendipity is painless; upload/checkout the release files and go to the Administration suite where you can confirm the upgrade. Also, by using the auto-update plugin you can install the blog from within your administration suite once we are able to upload the release to our SourceForge repository (which is down right now).

We are happy to be able to coordinate this release with Tim and provide improved security for our users.

Geschrieben von [Garvin Hicking](https://blog.s9y.org/authors/3-Garvin-Hicking) in [Announcements](https://blog.s9y.org/categories/1-Announcements), [Development](https://blog.s9y.org/categories/3-Development), [Security](https://blog.s9y.org/categories/2-Security) am Freitag, 24. Juli 2015 um 14:54

* [5 Kommentare](/archives/265-Serendipity-2.0.2-Security-Fix-Release.html#comments)
* [0 Trackbacks](/archives/265-Serendipity-2.0.2-Security-Fix-Release.html#trackbacks)

### Trackbacks

[Trackback-URL für diesen Eintrag](https://blog.s9y.org/comment.php?type=trackback&entry_id=265 "Dieser Link ist nicht aktiv. Er enthält die Trackback-URI zu diesem Eintrag. Sie können diese URI benutzen, um Ping- und Trackbacks von Ihrem eigenen Blog zu diesem Eintrag zu schicken. Um den Link zu kopieren, klicken Sie ihn mit der rechten Maustaste an und wählen \"Verknüpfung kopieren\" im Internet Explorer oder \"Linkadresse kopieren\" in Mozilla/Firefox.")

* Hommel-Net Weblog am Freitag, 24. Juli 2015: [Sicherheitsupdate für Serendipity verfügbar](http://blog.hommel-net.de/archives/349-Sicherheitsupdate-fuer-Serendipity-verfuegbar.html)
* Dirks Logbuch am Montag, 27. Juli 2015: [Serendipity 2.0.2 ...](http://www.deimeke.net/dirk/blog/index.php?/archives/3591-Serendipity-2.0.2-....html)
* onli blogging am Montag, 27. Juli 2015: [Was Serendipity 2.0.2 sonst noch bringt](http://www.onli-blogging.de/1491/Was-Serendipity-2.0.2-sonst-noch-bringt.html)

### Kommentare

Ansicht der Kommentare:
([Linear](/index.php?url=archives/265-Serendipity-2.0.2-Security-Fix-Release.html&serendipity%5Bcview%5D=linear#comments) | Verschachtelt)

#### Ian am Freitag, 24. Juli 2015 um 16:58:

Please Note:
If you wait until tomorrow and update the Serendipity Autoupdate plugin to version 1.1.4 via Spartacus first, you can use the automatic update like ever! We have changed the download URL to fetch and check via GitHuB now.
If you don't want to wait and are in a hurry, download this file and drop it onto yours 'plugins/serendipity*event*autoupdate/serendipity*event*autoupdate.php' file: [https://raw.githubusercontent.com/s9y/additional*plugins/master/serendipity*event*autoupdate/serendipity*event\_autoupdate.php](https://raw.githubusercontent.com/s9y/additional_plugins/master/serendipity_event_autoupdate/serendipity_event_autoupdate.php)

[#39850](#c39850) | [Antwort](#serendipity_CommentForm)

#### Ian am Freitag, 24. Juli 2015 um 18:04:

Maybe it is worth to mention here, that there are a bunch of other interesting fixes, upgrades, enhancements, etc coming with v.2.0.2 too. The addressed flaws were just the reason to get this immediately out now. :)

[#39854](#c39854) | [Antwort](#serendipity_CommentForm)

#### hoschi am Donnerstag, 30. Juli 2015 um 11:02:

@1:
Autoupdate failes, it seems to fetch the right checksum from the website, but either it fetches the wrong update or something other (with a different checksum).

[#40426](#c40426) | [Antwort](#serendipity_CommentForm)

#### Ian am Freitag, 31. Juli 2015 um 11:00:

@hoschi
Please use the forum for issues.
The autoupdate is working with version 1.1.4, which was immediately updated after the 2.0.2 release. We changed the download and checksum origins, while sourceforge had troubles.
If you already did update the autoupdater, and still have this message, please check, if you have a uncompleted download zip file in templates\_c. A complete ones is about ~7.5 MB. Delete that file and autoupdate again then.

[#40494](#c40494) | [Antwort](#serendipity_CommentForm)

#### Anonym am Freitag, 31. Juli 2015 um 12:23:

I just released Serendipity autoupdater plugin v.1.1.5, which can now automatically take care about previously broken download zips.
Tomorrow on Spartacus.

[#40497](#c40497) | [Antwort](#serendipity_CommentForm)

### Kommentar schreiben

Name

E-Mail

Homepage

Kommentar

Antwort zu
[ Ursprung ]#1: Ian am 24.07.2015 16:58
#2: Ian am 24.07.2015 18:04
#3: hoschi am 30.07.2015 11:02
#4: Ian am 31.07.2015 11:00
#5: Anonym am 31.07.2015 12:23

Phone\*

Was ist Null plus Fünf?

Die angegebene E-Mail-Adresse wird nicht dargestellt, sondern nur für eventuelle Benachrichtigungen verwendet.

Um maschinelle und automatische Übertragung von Spamkommentaren zu verhindern, bitte die Zeichenfolge im dargestellten Bild in der Eingabemaske eintragen. Nur wenn die Zeichenfolge richtig eingegeben wurde, kann der Kommentar angenommen werden. Bitte beachten Sie, dass Ihr Browser Cookies unterstützen muss, um dieses Verfahren anzuwenden.
![CAPTCHA](https://blog.s9y.org/plugin/captcha_a2a33d5725b0c73f5ab57fc603569122 "Bitte die dargestellte Zeichenfolge in die Eingabemaske eintragen!")
Hier die Zeichenfolge der Spamschutz-Grafik eintragen:
[BBCode](http://www.phpbb.com/phpBB/faq.php?mode=bbcode)-Formatierung erlaubt[Markdown](https://daringfireball.net/projects/markdown/syntax)-Formatierung erlaubt
I agree that my data will be stored. Please review the [terms of usage / legal notice](/index.php?serendipity[subpage]=dsgvo_gdpr_privacy) for further details.

 Daten merken?

 Bei Aktualisierung dieser Kommentare benachrichtigen

## More info

### Suche

Suche

### Categories

* [![XML](/templates/Serendipity/img/xml.gif)](/feeds/categories/1-Announcements.rss) [Announcements](/categories/1-Announcements)
* [![XML](/templates/Serendipity/img/xml.gif)](/feeds/categories/3-Development.rss) [Development](/categories/3-Development)
* [![XML](/templates/Serendipity/img/xml.gif)](/feeds/categories/6-Infrastructure.rss) [Infrastructure](/categories/6-Infrastructure)
* [![XML](/templates/Serendipity/img/xml.gif)](/feeds/categories/5-Personal.rss) [Personal](/categories/5-Personal)
* [![XML](/templates/Serendipity/img/xml.gif)](/feeds/categories/4-Plugins.rss) [Plugins](/categories/4-Plugins)
* [![XML](/templates/Serendipity/img/xml.gif)](/feeds/categories/2-Security.rss) [Security](/categories/2-Security)
* [![XML](/templates/Serendipity/img/xml.gif)](/feeds/categories/7-Templates.rss) [Templates](/categories/7-Templates)

### Archive

* [Januar 2025](/archives/2025/01.html "Januar 2025")
* [Dezember 2024](/archives/2024/12.html "Dezember 2024")
* [November 2024](/archives/2024/11.html "November 2024")
* [Das Neueste ...](/index.php?frontpage)
* [Älteres ...](https://blog.s9y.org/archive)

### Development state

The current nightly/GitHub trunk state is:2.6-alpha1
Recommendation(s):
2.5.0

* [Changelog](https://raw.githubusercontent.com/s9y/Serendipity/master/docs/NEWS) for Github trunk (master)

Please report issues and bugs on our [Forums](http://board.s9y.org/). Your help is very much appreciated.

### Syndicate This Blog

* [![XML](/templates/2k11/img/subtome.png)](https://blog.s9y.org/feeds/index.rss2)
* [![XML](/templates/Serendipity/img/xml.gif)](https://blog.s9y.org/feeds/comments.rss2)
  [Kommentare](https://blog.s9y.org/feeds/comments.rss2)

### More Feeds/Information

* [Event Plugins](https://raw.githubusercontent.com/s9y/additional_plugins/master/package_RSSevent.xml)
* [Sidebar Plugins](https://raw.githubusercontent.com/s9y/additional_plugins/master/package_RSSsidebar.xml)
* [s9y Github](https://github.com/s9y/)

* [Back to top](#top)
* [Privacy policy](https://blog.s9y.org/index.php?serendipity[subpage]=dsgvo_gdpr_privacy)

These pages are hosted by **Uberspace**.

[Privacy statement / legal notice / Imprint](/index.php?serendipity[subpage]=dsgvo_gdpr_privacy)



=== Content from seclists.org_6667aac9_20250125_215321.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](9)
[By Date](date.html#10)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](9)
[By Thread](index.html#10)
[![Next](/images/right-icon-16x16.png)](7)

![](/shared/images/nst-icons.svg#search)

# Serendipity 2.0.1 - Blind SQL Injection

---

*From*: "Curesec Research Team (CRT)" <crt () curesec com>

*Date*: Tue, 1 Sep 2015 13:46:23 +0200

---

```
Serendipity 2.0.1: Blind SQL Injection
Security Advisory – Curesec Research Team

1. Introduction

Affected Product:       Serendipity 2.0.1
Fixed in:               2.0.2
Fixed Version Link:
<https://github.com/s9y/Serendipity/releases/download/2.0.2/serendipity-2.0.2.zip>

Vendor Contact:         serendipity () supergarv de
Vulnerability Type:     Blind SQL Injection
Remote Exploitable:     Yes
Reported to vendor:     07/21/2015
Disclosed to public:    09/01/2015
Release mode:           Coordinated release
CVE:    n/a
Credits                 Tim Coen of Curesec GmbH

2. Vulnerability Description

There is a blind SQL injection in Serendipity 2.0.1 when approving
comments. It can be exploited content-based, but this requires an Email
token. Timing-based exploitation does not require a token and is thus
easier to exploit.

To prepare for the attack, an attacker has to visit the Configuration
and set "Use Tokens for Comment Moderation" to true.

Please note that admin credentials are required.

3. Proof of Concept

[http://localhost/serendipity/serendipity_admin.php?serendipity[action]=admin&serendipity[adminModule]=comments&serendipity[adminAction]=pending&serendipity[id]=8'](http://localhost/serendipity/serendipity_admin.php?serendipity[action]=admin&serendipity[adminModule]=comments&serendipity[adminAction]=pending&serendipity[id]=8&apos);
AND IF(SUBSTRING(version(), 1,
1)='5',BENCHMARK(50000000,ENCODE('MSG','by 5 seconds')),null)
%23&serendipity[token]=ValidAntiCSRFToken
-> true

[http://localhost//serendipity/serendipity_admin.php?serendipity[action]=admin&serendipity[adminModule]=comments&serendipity[adminAction]=approve&serendipity[id]=8'](http://localhost//serendipity/serendipity_admin.php?serendipity[action]=admin&serendipity[adminModule]=comments&serendipity[adminAction]=approve&serendipity[id]=8&apos);
AND IF(SUBSTRING(version(), 1,
1)='4',BENCHMARK(50000000,ENCODE('MSG','by 5 seconds')),null)
%23&serendipity[token]=ValidAntiCSRFToken
-> false
Note that the id must be that of an existing comment, the action must be
acceptable - ie only pending comments can be approved and only approved
comments can be set to pending - and the CSRF token must be valid.

4. Code

        /include/admin/comments.inc.php
        serendipity_approveComment($serendipity['GET']['id'],
$rs['entry_id']); <- user input

        /include/functions_comments.inc.php
        function serendipity_approveComment($cid, $entry_id, $force =
false, $moderate = false, $token = false) {
            global $serendipity;

            $goodtoken = serendipity_checkCommentToken($token, $cid); <-
not secured
        [...]
        }

        function serendipity_checkCommentToken($token, $cid) {
            global $serendipity;

            $goodtoken = false;
            if ($serendipity['useCommentTokens']) {
                // Delete any comment tokens older than 1 week.
                serendipity_db_query("DELETE FROM
{$serendipity['dbPrefix']}options
                                      WHERE okey LIKE 'comment_%' AND
name < " . (time() - 604800) );
                // Get the token for this comment id
                $tokencheck = serendipity_db_query("SELECT * FROM
{$serendipity['dbPrefix']}options
                                                     WHERE okey =
'comment_" . $cid . "' LIMIT 1", true, 'assoc'); <- still not secured
        [...]
        }

5. Solution

To mitigate this issue please upgrade at least to version 2.0.2:

<https://github.com/s9y/Serendipity/releases/download/2.0.2/serendipity-2.0.2.zip>

Please note that a newer version might already be available.

5. Report Timeline

07/21/2015      Informed Vendor about Issue
07/24/2015      Vendor releases Version 2.0.2
09/01/2015      Disclosed to public

6. Blog Reference:
<http://blog.curesec.com/article/blog/Serendipity-201-Blind-SQL-Injection-52.html>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](9)
[By Date](date.html#10)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](9)
[By Thread](index.html#10)
[![Next](/images/right-icon-16x16.png)](7)

### Current thread:

* **Serendipity 2.0.1 - Blind SQL Injection** *Curesec Research Team (CRT) (Sep 02)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_a084c4c7_20250125_215320.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


