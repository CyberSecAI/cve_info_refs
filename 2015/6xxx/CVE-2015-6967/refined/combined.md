=== Content from seclists.org_efc20d8c_20250125_055412.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#5)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](4)
[By Thread](index.html#5)
[![Next](/images/right-icon-16x16.png)](6)

![](/shared/images/nst-icons.svg#search)

# NibbleBlog 4.0.3 - Code Execution - Not fixed

---

*From*: "Curesec Research Team (CRT)" <crt () curesec com>

*Date*: Tue, 1 Sep 2015 13:40:19 +0200

---

```
NibbleBlog 4.0.3: Code Execution
Security Advisory – Curesec Research Team

1. Introduction

Affected Product:       NibbleBlog 4.0.3
Fixed in:               not fixed
Fixed Version Link:     n/a
Vendor Contact:         Website: <http://www.nibbleblog.com/>
Vulnerability Type:     Code Execution
Remote Exploitable:     Yes
Reported to vendor:     07/21/2015
Disclosed to public:    09/01/2015
Release mode:           Full Disclosure
CVE:                    n/a
Credits                 Tim Coen of Curesec GmbH

2. Vulnerability Description

When uploading image files via the "My image" plugin - which is
delivered with NibbleBlog by default - , NibbleBlog 4.0.3 keeps the
original extension of uploaded files. This extension or the actual file
type are not checked, thus it is possible to upload PHP files and gain
code execution.

Please note that admin credentials are required.

3. Proof of Concept

    Obtain Admin credentials (for example via Phishing via XSS which can
be gained via CSRF, see advisory about CSRF in NibbleBlog 4.0.3)
    Activate My image plugin by visiting
<http://localhost/nibbleblog/admin.php?controller=plugins&action=install&plugin=my_image>
    Upload PHP shell, ignore warnings
    Visit
<http://localhost/nibbleblog/content/private/plugins/my_image/image.php>.
This is the default name of images uploaded via the plugin.

4. Code

                if( $plugin->init_db() )
                {
                        // upload files
                        foreach($_FILES as $field_name=>$file)
                        {
                                $extension = strtolower(pathinfo($file['name'],
PATHINFO_EXTENSION));
                                $destination = PATH_PLUGINS_DB.$plugin->get_dir_name();
                                $complete = $destination.'/'.$field_name.'.'.$extension;

                                // Upload the new file and move
                                if(move_uploaded_file($file["tmp_name"], $complete))
                                {
                                        // Resize images if requested by the plugin
                                        if(isset($_POST[$field_name.'_resize']))
                                        {
                                                $width =
isset($_POST[$field_name.'_width'])?$_POST[$field_name.'_width']:200;
                                                $height =
isset($_POST[$field_name.'_height'])?$_POST[$field_name.'_height']:200;
                                                $option =
isset($_POST[$field_name.'_option'])?$_POST[$field_name.'_option']:'auto';
                                                $quality =
isset($_POST[$field_name.'_quality'])?$_POST[$field_name.'_quality']:100;

                                                $Resize->setImage($complete, $width, $height, $option);
                                                $Resize->saveImage($complete, $quality, true);
                                        }
                                }
                        }

                        unset($_POST['plugin']);

                        // update fields
                        $plugin->set_fields_db($_POST);

                        Session::set_alert($_LANG['CHANGES_HAS_BEEN_SAVED_SUCCESSFULLY']);
                }
        }

5. Solution

This issue was not fixed by the vendor.

6. Report Timeline

07/21/2015      Informed Vendor about Issue
07/22/2015      Vendor Replied
08/18/2015      Reminded Vendor of release date (no reply)
09/01/2015      Disclosed to public

7. Blog Reference
<http://blog.curesec.com/article/blog/NibbleBlog-403-Code-Execution-47.html>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#5)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](4)
[By Thread](index.html#5)
[![Next](/images/right-icon-16x16.png)](6)

### Current thread:

* **NibbleBlog 4.0.3 - Code Execution - Not fixed** *Curesec Research Team (CRT) (Sep 02)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_21e0435e_20250125_055411.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


