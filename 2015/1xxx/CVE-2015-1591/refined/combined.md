=== Content from bugs.debian.org_453387e1_20250125_134815.html ===

# Debian Bug report logs - #775681 kamailio: multiple /tmp file vulnerabilities (CVE-2015-1590 CVE-2015-1591)

[![version graph](version.cgi?fixed=kamailio%2F4.2.0-2;height=2;absolute=0;width=2;collapse=1;found=kamailio%2F4.2.0-1.1;package=kamailio)](version.cgi?fixed=kamailio%2F4.2.0-2;info=1;absolute=0;collapse=1;found=kamailio%2F4.2.0-1.1;package=kamailio)

Package:
[kamailio](pkgreport.cgi?package=kamailio);
Maintainer for [kamailio](pkgreport.cgi?package=kamailio) is [Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>](pkgreport.cgi?maint=pkg-voip-maintainers%40lists.alioth.debian.org); Source for [kamailio](pkgreport.cgi?package=kamailio) is [src:kamailio](pkgreport.cgi?src=kamailio) ([PTS](https://tracker.debian.org/pkg/kamailio), [buildd](https://buildd.debian.org/kamailio), [popcon](https://qa.debian.org/popcon.php?package=kamailio)).

Reported by: [Helmut Grohne <helmut@subdivi.de>](pkgreport.cgi?submitter=helmut%40subdivi.de)

Date: Sun, 18 Jan 2015 16:21:01 UTC

Severity: *serious*

Tags: security

Found in version kamailio/4.2.0-1.1

Fixed in version kamailio/4.2.0-2

**Done:** Victor Seva <linuxmaniac@torreviejawireless.org>

Bug is archived. No further changes may be made.

Forwarded to <https://github.com/kamailio/kamailio/issues/48>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=775681;mbox=yes), [status mbox](bugreport.cgi?bug=775681;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=775681;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`:

`Bug#775681`; Package `kamailio`.
(Sun, 18 Jan 2015 16:21:06 GMT) ([full text](bugreport.cgi?bug=775681;msg=2), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Helmut Grohne <helmut@subdivi.de>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`.
(Sun, 18 Jan 2015 16:21:06 GMT) ([full text](bugreport.cgi?bug=775681;msg=4), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=775681;msg=5), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=helmut%40subdivi.de)
From: Helmut Grohne <helmut@subdivi.de>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: multiple /tmp file vulnerabilities
Date: Sun, 18 Jan 2015 17:16:19 +0100
```
Package: kamailio
Version: 4.2.0-1.1
Severity: important
Tags: security

The kamailio package now installs /etc/kamailio/kamailio-basic.cfg which
can be selected via the CFGFILE= setting in /etc/default/kamailio. The
configuration contains:

modparam("mi_fifo", "fifo_name", "/tmp/kamailio_fifo")

This setting is insecure and may allow local users to elevate privileges
to the kamailio user.

The issue extends to kamailio-advanced.cfg. It seems that this is due to
an incomplete fix of #712083. Looking further, the state of /tmp file
vulnerabilities in kamailio looks worrisome. Most of the results of the
following command (to be executed in the kamailio source) are likely
vulnerable if executed:

grep '/tmp/[a-z0-9_.-]\+\(\$\$\)\?\([" ]\|$\)' -r .

Granted, some of the results are examples, documentation or obsolete.
But quite a few reach the default settings:

 * kamcmd defaults to connecting to unixs:/tmp/kamailio_ctl.
 * The kamailio build definitely is vulnerable as can be seen in
   utils/kamctl/Makefile.

More research clearly is required here.  Given these findings, the
security team may want to veto the inclusion of kamailio in a stable
release, which would be very unfortunate as kamailio is quite a unique
piece of software with little competitors in its field.

Helmut

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`:

`Bug#775681`; Package `kamailio`.
(Tue, 20 Jan 2015 09:54:04 GMT) ([full text](bugreport.cgi?bug=775681;msg=7), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Victor Seva <linuxmaniac@torreviejawireless.org>`:

Extra info received and forwarded to list. Copy sent to `Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`.
(Tue, 20 Jan 2015 09:54:04 GMT) ([full text](bugreport.cgi?bug=775681;msg=9), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 775681@bugs.debian.org ([full text](bugreport.cgi?bug=775681;msg=10), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=linuxmaniac%40torreviejawireless.org)
From: Victor Seva <linuxmaniac@torreviejawireless.org>
To: control@bugs.debian.org
Cc: 775681@bugs.debian.org
Subject: Re: Bug#775681: multiple /tmp file vulnerabilities
Date: Tue, 20 Jan 2015 10:51:14 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=775681;msg=10) (text/plain, inline)]
```
```
forwarded 775681 <https://github.com/kamailio/kamailio/issues/48>
thanks
--

I opened a dialog with upstream about the issue and I will change the
example settings in the package in the next upload

Thanks for the report,
Victor Seva

```
```
[[signature.asc](bugreport.cgi?att=1;bug=775681;filename=signature.asc;msg=10) (application/pgp-signature, attachment)]
```

---

**Set Bug forwarded-to-address to '<https://github.com/kamailio/kamailio/issues/48>'.**
Request was from `Victor Seva <linuxmaniac@torreviejawireless.org>`
to `control@bugs.debian.org`.
(Tue, 20 Jan 2015 09:54:07 GMT) ([full text](bugreport.cgi?bug=775681;msg=12), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`:

`Bug#775681`; Package `kamailio`.
(Sat, 24 Jan 2015 13:33:04 GMT) ([full text](bugreport.cgi?bug=775681;msg=14), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `Victor Seva <linuxmaniac@torreviejawireless.org>`:

Extra info received and forwarded to list. Copy sent to `Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`.
(Sat, 24 Jan 2015 13:33:04 GMT) ([full text](bugreport.cgi?bug=775681;msg=16), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 775681@bugs.debian.org ([full text](bugreport.cgi?bug=775681;msg=17), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=linuxmaniac%40torreviejawireless.org)
From: Victor Seva <linuxmaniac@torreviejawireless.org>
To: Helmut Grohne <helmut@subdivi.de>, 775681@bugs.debian.org
Subject: Re: Bug#775681: multiple /tmp file vulnerabilities
Date: Sat, 24 Jan 2015 14:30:37 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=775681;msg=17) (text/plain, inline)]
```
```
On 01/18/2015 05:16 PM, Helmut Grohne wrote:
> Granted, some of the results are examples, documentation or obsolete.
> But quite a few reach the default settings:
>
>  * kamcmd defaults to connecting to unixs:/tmp/kamailio_ctl.

- added default_ctl.patch.
  ctl defaults to /var/run/kamailio/kamailio_ctl.
  add ctl binrpc module parameter to etc/kamailio/kamailio*cfg
  to point this change.

>  * The kamailio build definitely is vulnerable as can be seen in
>    utils/kamctl/Makefile.

- kamctl_build.patch.
  use basedir instead of /tmp

> More research clearly is required here.  Given these findings, the
> security team may want to veto the inclusion of kamailio in a stable
> release, which would be very unfortunate as kamailio is quite a unique
> piece of software with little competitors in its field.

From my POW this is a matter of configuration. Kamailio has a complex
configuration,
and my changes will try to have proper default configs in /etc/kamailio
*examples*.

Helmut, do you agree with this proposed changes to deal with your findings?

PD: I will document on README.Debian any final changes on the kamailio
defaults

Thanks,
Victor

```
```
[[0001-fix-fifo-and-ctl-defaults-pointing-to-unsecure-tmp-d.patch](bugreport.cgi?att=1;bug=775681;filename=0001-fix-fifo-and-ctl-defaults-pointing-to-unsecure-tmp-d.patch;msg=17) (text/x-patch, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=775681;filename=signature.asc;msg=17) (application/pgp-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`:

`Bug#775681`; Package `kamailio`.
(Sun, 25 Jan 2015 20:57:12 GMT) ([full text](bugreport.cgi?bug=775681;msg=19), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent**
to `Helmut Grohne <helmut@subdivi.de>`:

Extra info received and forwarded to list. Copy sent to `Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`.
(Sun, 25 Jan 2015 20:57:12 GMT) ([full text](bugreport.cgi?bug=775681;msg=21), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 775681@bugs.debian.org ([full text](bugreport.cgi?bug=775681;msg=22), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=helmut%40subdivi.de)
From: Helmut Grohne <helmut@subdivi.de>
To: Victor Seva <linuxmaniac@torreviejawireless.org>
Cc: 775681@bugs.debian.org
Subject: Re: Bug#775681: multiple /tmp file vulnerabilities
Date: Sun, 25 Jan 2015 21:52:45 +0100
```
Control: severity -1 serious

Hi Victor,

Thank you very much for investing your time in addressing these issues!

On Sat, Jan 24, 2015 at 02:30:37PM +0100, Victor Seva wrote:
> On 01/18/2015 05:16 PM, Helmut Grohne wrote:
> > Granted, some of the results are examples, documentation or obsolete.
> > But quite a few reach the default settings:
> >
> >  * kamcmd defaults to connecting to unixs:/tmp/kamailio_ctl.
>
> - added default_ctl.patch.
>   ctl defaults to /var/run/kamailio/kamailio_ctl.
>   add ctl binrpc module parameter to etc/kamailio/kamailio*cfg
>   to point this change.
>
>
> >  * The kamailio build definitely is vulnerable as can be seen in
> >    utils/kamctl/Makefile.
>
> - kamctl_build.patch.
>   use basedir instead of /tmp

All of these fixes are appropriate for a Debian Security Advisory. Thus
they should also be appropriate for a freeze unblock. Please file a pre
approval unblock bug.

In particular, I am raising the severity of this bug to serious, because
 1) the build process is definitely exploitable,
 2) there is a patch, and
 3) we have fixed similar issues via DSAs earlier.
    (examples: DSA-2945-1, DSA-2649-1, DSA-2435-1)

> > More research clearly is required here.  Given these findings, the
> > security team may want to veto the inclusion of kamailio in a stable
> > release, which would be very unfortunate as kamailio is quite a unique
> > piece of software with little competitors in its field.
>
> From my POW this is a matter of configuration. Kamailio has a complex
> configuration,
> and my changes will try to have proper default configs in /etc/kamailio
> *examples*.

Yes, many of these instances are configuration examples and users should
use them with care. Yet, we should try to make these examples as safe as
possible and in particular, we should make the default configuration
safe.

> Helmut, do you agree with this proposed changes to deal with your findings?

I am not sure that your patches indeed do make the default configuration
safe wrt /tmp usage, but they definitely go a long way in the right
direction and I cannot point to particular issues they miss without
taking a much more detailed look.

Please proceed!

> PD: I will document on README.Debian any final changes on the kamailio
> defaults

I think that having your patches in jessie would be very good, because
then we don't have to change ctl paths in a DSA later when a working
exploit is discovered.

Big thanks!

Helmut

```

---

**Severity set to 'serious' from 'important'**
Request was from `Helmut Grohne <helmut@subdivi.de>`
to `775681-submit@bugs.debian.org`.
(Sun, 25 Jan 2015 20:57:12 GMT) ([full text](bugreport.cgi?bug=775681;msg=24), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=24), [link](#23)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`:

`Bug#775681`; Package `kamailio`.
(Wed, 28 Jan 2015 21:00:05 GMT) ([full text](bugreport.cgi?bug=775681;msg=26), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent**
to `Victor Seva <linuxmaniac@torreviejawireless.org>`:

Extra info received and forwarded to list. Copy sent to `Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>`.
(Wed, 28 Jan 2015 21:00:05 GMT) ([full text](bugreport.cgi?bug=775681;msg=28), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 775681@bugs.debian.org ([full text](bugreport.cgi?bug=775681;msg=29), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=linuxmaniac%40torreviejawireless.org)
From: Victor Seva <linuxmaniac@torreviejawireless.org>
To: Helmut Grohne <helmut@subdivi.de>
Cc: 775681@bugs.debian.org
Subject: Re: Bug#775681: multiple /tmp file vulnerabilities
Date: Wed, 28 Jan 2015 21:57:22 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=775681;msg=29) (text/plain, inline)]
```
```
On 01/25/2015 09:52 PM, Helmut Grohne wrote:
> On Sat, Jan 24, 2015 at 02:30:37PM +0100, Victor Seva wrote:
>> On 01/18/2015 05:16 PM, Helmut Grohne wrote:
[snip]
> All of these fixes are appropriate for a Debian Security Advisory. Thus
> they should also be appropriate for a freeze unblock. Please file a pre
> approval unblock bug.

preapproval unblock bugreport [0]

[0] <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=776508>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=775681;filename=signature.asc;msg=29) (application/pgp-signature, attachment)]
```

---

**Reply sent**
to `Victor Seva <linuxmaniac@torreviejawireless.org>`:

You have taken responsibility.
(Thu, 29 Jan 2015 18:51:14 GMT) ([full text](bugreport.cgi?bug=775681;msg=31), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=31), [link](#30)).

---

**Notification sent**
to `Helmut Grohne <helmut@subdivi.de>`:

Bug acknowledged by developer.
(Thu, 29 Jan 2015 18:51:14 GMT) ([full text](bugreport.cgi?bug=775681;msg=33), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=33), [link](#32)).

---

[Message #34](#34) received at 775681-close@bugs.debian.org ([full text](bugreport.cgi?bug=775681;msg=34), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=34), reply):

![](/cgi-bin/libravatar.cgi?email=linuxmaniac%40torreviejawireless.org)
From: Victor Seva <linuxmaniac@torreviejawireless.org>
To: 775681-close@bugs.debian.org
Subject: Bug#775681: fixed in kamailio 4.2.0-2
Date: Thu, 29 Jan 2015 18:49:10 +0000
```
Source: kamailio
Source-Version: 4.2.0-2

We believe that the bug you reported is fixed in the latest version of
kamailio, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 775681@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Victor Seva <linuxmaniac@torreviejawireless.org> (supplier of updated kamailio package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Wed, 28 Jan 2015 20:43:44 +0100
Source: kamailio
Binary: kamailio kamailio-dbg kamailio-geoip-modules kamailio-sqlite-modules kamailio-json-modules kamailio-memcached-modules kamailio-lua-modules kamailio-mono-modules kamailio-python-modules kamailio-redis-modules kamailio-mysql-modules kamailio-postgres-modules kamailio-cpl-modules kamailio-radius-modules kamailio-unixodbc-modules kamailio-presence-modules kamailio-perl-modules kamailio-snmpstats-modules kamailio-xmpp-modules kamailio-xml-modules kamailio-carrierroute-modules kamailio-berkeley-modules kamailio-berkeley-bin kamailio-ldap-modules kamailio-ims-modules kamailio-utils-modules kamailio-sctp-modules kamailio-java-modules kamailio-tls-modules kamailio-outbound-modules kamailio-websocket-modules kamailio-dnssec-modules kamailio-autheph-modules kamailio-extra-modules
Architecture: source amd64
Version: 4.2.0-2
Distribution: unstable
Urgency: medium
Maintainer: Debian VoIP Team <pkg-voip-maintainers@lists.alioth.debian.org>
Changed-By: Victor Seva <linuxmaniac@torreviejawireless.org>
Description:
 kamailio   - very fast and configurable SIP proxy
 kamailio-autheph-modules - authentication using ephemeral credentials module for Kamailio
 kamailio-berkeley-bin - Berkeley database module for Kamailio - helper program
 kamailio-berkeley-modules - Berkeley database module for Kamailio
 kamailio-carrierroute-modules - carrierroute module for Kamailio
 kamailio-cpl-modules - CPL module (CPL interpreter engine) for Kamailio
 kamailio-dbg - very fast and configurable SIP proxy [debug symbols]
 kamailio-dnssec-modules - contains the dnssec module
 kamailio-extra-modules - extra modules for Kamailio
 kamailio-geoip-modules - contains the geoip module
 kamailio-ims-modules - IMS module for Kamailio
 kamailio-java-modules - contains the app_java module
 kamailio-json-modules - Json parser and jsonrpc modules for Kamailio
 kamailio-ldap-modules - LDAP modules for Kamailio
 kamailio-lua-modules - contains the app_lua module
 kamailio-memcached-modules - Provides the memcached module, an interface to the memcached serv
 kamailio-mono-modules - contains the app_mono module
 kamailio-mysql-modules - MySQL database connectivity module for Kamailio
 kamailio-outbound-modules - Outbound module for Kamailio
 kamailio-perl-modules - Perl extensions and database driver for Kamailio
 kamailio-postgres-modules - PostgreSQL database connectivity module for Kamailio
 kamailio-presence-modules - SIMPLE presence modules for Kamailio
 kamailio-python-modules - contains the app_python module
 kamailio-radius-modules - RADIUS modules for Kamailio
 kamailio-redis-modules - Redis database connectivity module for Kamailio
 kamailio-sctp-modules - sctp module for Kamailio
 kamailio-snmpstats-modules - SNMP AgentX subagent module for Kamailio
 kamailio-sqlite-modules - SQLite database connectivity module for Kamailio
 kamailio-tls-modules - contains the TLS kamailio transport module
 kamailio-unixodbc-modules - unixODBC database connectivity module for Kamailio
 kamailio-utils-modules - Provides a set utility functions for Kamailio
 kamailio-websocket-modules - Websocket module for kamailio
 kamailio-xml-modules - XML based extensions for Kamailio's Management Interface
 kamailio-xmpp-modules - XMPP gateway module for Kamailio
Closes: [775681](bugreport.cgi?bug=775681)
Changes:
 kamailio (4.2.0-2) unstable; urgency=medium
 .
   * [d614569] fix fifo and ctl defaults pointing to unsecure /tmp dir
     Closes: #[775681](bugreport.cgi?bug=775681)
Checksums-Sha1:
 4d6193bfed84808dd4114dfe23ff5044d6a17d16 6310 kamailio_4.2.0-2.dsc
 49ef0101dbc78b601e853205f131a9fce2c365c2 22872 kamailio_4.2.0-2.debian.tar.xz
 b9dc7df5427aca96ffc42e9db5465d0100732f78 6712524 kamailio_4.2.0-2_amd64.deb
 2bf176e4d3dd1328b200fb240b9985dc2eadf8b5 15774748 kamailio-dbg_4.2.0-2_amd64.deb
 ff98d89dd16cc68a1c13b5c2698a47007bb15b34 131588 kamailio-geoip-modules_4.2.0-2_amd64.deb
 b6550b64eb5d8acfb5fea8e09c98cb7c4188dfb4 137424 kamailio-sqlite-modules_4.2.0-2_amd64.deb
 d353f13f8793392baac71adff5924de8be381c19 151762 kamailio-json-modules_4.2.0-2_amd64.deb
 e6d168174698de9a3e82e7f668e516b1d3e16852 139332 kamailio-memcached-modules_4.2.0-2_amd64.deb
 2b16a50c4430c85504d8832117a4f744343a2734 226938 kamailio-lua-modules_4.2.0-2_amd64.deb
 49602d4a36cfa33d4b3b52e73ed991d9da586086 142486 kamailio-mono-modules_4.2.0-2_amd64.deb
 61023e60d3807d7d17cd30935c6ad01fbbea1696 140236 kamailio-python-modules_4.2.0-2_amd64.deb
 91f19660ec9f1d11d934d4215c611a9076be53da 146094 kamailio-redis-modules_4.2.0-2_amd64.deb
 771f87b25bd15321fe87be10805998876e9ff7fe 198892 kamailio-mysql-modules_4.2.0-2_amd64.deb
 ddaaccb3a8a13e3b222a407f594c4f43c6413063 231142 kamailio-postgres-modules_4.2.0-2_amd64.deb
 434a4f6b016c9907ceafbdd342f3fb18b4f1e2e5 318366 kamailio-cpl-modules_4.2.0-2_amd64.deb
 54d7ebf94ff573d78a383afca281a8969d405f7e 204178 kamailio-radius-modules_4.2.0-2_amd64.deb
 d72dd4b6376d3f9fda87e7aaf48e00bf9be15242 155456 kamailio-unixodbc-modules_4.2.0-2_amd64.deb
 03e400e2a908584b865aef434c98072c71e3166c 972508 kamailio-presence-modules_4.2.0-2_amd64.deb
 1b91df5e00b64c5f165841a6323dca71ea39a801 195820 kamailio-perl-modules_4.2.0-2_amd64.deb
 87b2bebf211076d82999546ba32c59aef7a00869 199934 kamailio-snmpstats-modules_4.2.0-2_amd64.deb
 14c6944eda2f7bfb2d18d0fa042867a21b22fba5 182258 kamailio-xmpp-modules_4.2.0-2_amd64.deb
 c09e77fee6e81197b4861492235d5cfcc5bcbaea 303742 kamailio-xml-modules_4.2.0-2_amd64.deb
 d89465746e8845faa902b0743f837fdd6fb4a610 257948 kamailio-carrierroute-modules_4.2.0-2_amd64.deb
 ac725b0a70e2af7270d568d0d193f315c41ee76a 234644 kamailio-berkeley-modules_4.2.0-2_amd64.deb
 5e86c34ef34b940af59cee95e641157bbb35a5de 127030 kamailio-berkeley-bin_4.2.0-2_amd64.deb
 e0d36e3409ce018dd9aff76f9dd6fd083d652959 246354 kamailio-ldap-modules_4.2.0-2_amd64.deb
 2f4babd7795ad7f7603a053bb10d69593a16f90c 1533402 kamailio-ims-modules_4.2.0-2_amd64.deb
 b8d3ad5174744a865336fbc4d812977a92cbb14c 166378 kamailio-utils-modules_4.2.0-2_amd64.deb
 ddd9cf2ded9e250d07e9fcda3f2c14af0ad81471 127386 kamailio-sctp-modules_4.2.0-2_amd64.deb
 be247616409b670e9bfc2faa8e10d50713d89cf7 152312 kamailio-java-modules_4.2.0-2_amd64.deb
 3012d3101ace0b45aec1a538bbcbd3b4e9764080 329458 kamailio-tls-modules_4.2.0-2_amd64.deb
 af1422f2ce336e7a0df6ee788de2b064c2e4e466 138298 kamailio-outbound-modules_4.2.0-2_amd64.deb
 0b77ddec8335a62433448da83bd1e4293208ab78 180258 kamailio-websocket-modules_4.2.0-2_amd64.deb
 420a3ed16ade1b45d46fd3624af183a5d97bd678 127554 kamailio-dnssec-modules_4.2.0-2_amd64.deb
 84fa69a13e9617fc6bf97bb54fd2de287daa553d 156174 kamailio-autheph-modules_4.2.0-2_amd64.deb
 8b811e0ca3773ea7cc01083d5886e40a6481d5c6 155128 kamailio-extra-modules_4.2.0-2_amd64.deb
Checksums-Sha256:
 bc3c3ff59212db91ec4a0d7306d7e8248530732596440fb85bbb45f30401d20c 6310 kamailio_4.2.0-2.dsc
 4ac4dd63611ac80b4804fc23dacecad3e682cb367e85b0f2ed60efb83677d45a 22872 kamailio_4.2.0-2.debian.tar.xz
 78c41a577e22297d698c5b4dc4f4a8cbae75dec985c5ae8a1aa07f3727e505b8 6712524 kamailio_4.2.0-2_amd64.deb
 68dc3d8afe74c7b9b9054450ba76b537e9a5db1c61349b46749452a839a80ff5 15774748 kamailio-dbg_4.2.0-2_amd64.deb
 222eed5cedb9727038a2490bbdda1482e5c69472fbc28bfb786d8882702d6b78 131588 kamailio-geoip-modules_4.2.0-2_amd64.deb
 afa843e8d2abccec8261296d1d97c1d604f982fb8fc885bd6b431e9d9ce2d324 137424 kamailio-sqlite-modules_4.2.0-2_amd64.deb
 e0c72a2c5f020a5c779c220f4328e6300206513ae30523bd4c390a6ab78d862d 151762 kamailio-json-modules_4.2.0-2_amd64.deb
 aaed753fe9a22fbf1755126da93849548992196faa6cebb6c2ed8e510a7eb3a1 139332 kamailio-memcached-modules_4.2.0-2_amd64.deb
 d06a8834407d4d970e3c79697166ae61736ea037c53d44950fb1f16e51973d1a 226938 kamailio-lua-modules_4.2.0-2_amd64.deb
 a4fc7c235bbff1ee4ba136b5778221182e2e6a149ae10304d0cdd2d53e469254 142486 kamailio-mono-modules_4.2.0-2_amd64.deb
 80393aa45cd5caa3464c44fba369ac635c257d9989e5d4118000d338a0fd2d3a 140236 kamailio-python-modules_4.2.0-2_amd64.deb
 f25a2e47d1889a70c357adbabfaf68ef5b5745c371aa3062aa06867dffbd1cbc 146094 kamailio-redis-modules_4.2.0-2_amd64.deb
 b1937a2b596a1d96441ff5f48e80840a181ef1a65bb8c792b37526fae860974b 198892 kamailio-mysql-modules_4.2.0-2_amd64.deb
 d02be42b96bee4dd03f1a81a7b66b9d63ed2ac9113a15e804671731c8537b13e 231142 kamailio-postgres-modules_4.2.0-2_amd64.deb
 018b1d60f5cc505438ec59efd2e6249e55287ddfb933378a99b5c018cca0b071 318366 kamailio-cpl-modules_4.2.0-2_amd64.deb
 701ee5d05647b20ec16c706a7264c4c806439c3bf48e9bb9897192d5ca746516 204178 kamailio-radius-modules_4.2.0-2_amd64.deb
 32fc9d0e0d359c53930aba96555ecfdd279ddd8c0dc36149aa56525c2ce1a0df 155456 kamailio-unixodbc-modules_4.2.0-2_amd64.deb
 122a4b005aaf11ffe824904e5c3e8367134ca8b96540c6ef22fe1d1a53aacda1 972508 kamailio-presence-modules_4.2.0-2_amd64.deb
 000a0d4c35069e998c9c339c2095e1b28081283c4295b5331a4f50a1a648ad00 195820 kamailio-perl-modules_4.2.0-2_amd64.deb
 9fbd467d7c0ce99337d979fca790eec5d70c2d7d9e8dd592795c65279301287a 199934 kamailio-snmpstats-modules_4.2.0-2_amd64.deb
 d4b70c0fe8cf65477e50fe024581028435da6f7d296578509e10344f0836b41c 182258 kamailio-xmpp-modules_4.2.0-2_amd64.deb
 813cf20e2a87d1bc179950c6838c6258a4c77f50467af71af8cc1580ee5b4002 303742 kamailio-xml-modules_4.2.0-2_amd64.deb
 f0ec17d0965316b46bac824009dc7bf47b769bf31135aac4536e4aac48cf45e8 257948 kamailio-carrierroute-modules_4.2.0-2_amd64.deb
 810362a4afc356955970546454c5f396e3a38ce243b04f461a8263b6ef52f3d2 234644 kamailio-berkeley-modules_4.2.0-2_amd64.deb
 238e3725445d1a63270003cfcd92306ca313a72484b8944e216a01870bb8c7b9 127030 kamailio-berkeley-bin_4.2.0-2_amd64.deb
 8fe001734793ff508a5d3c90c525682f95b81187015c5e17a9c0b8129d45ac0e 246354 kamailio-ldap-modules_4.2.0-2_amd64.deb
 454c9b47bb3ab188b8078fd64212ee94985e1827303fa2a0beb9ef7423ea0d6a 1533402 kamailio-ims-modules_4.2.0-2_amd64.deb
 d9e5683c6d5b94d01454db2a1618e4894288836c1cfe77e5127fadf4de15a454 166378 kamailio-utils-modules_4.2.0-2_amd64.deb
 132602df755abdcc325eadc1edc297f62fb40cf3ac4f19e3edb452665ac0b989 127386 kamailio-sctp-modules_4.2.0-2_amd64.deb
 e7044dae858feda1abd3cd5136d62e4178719abea2560a7d476d7c7226e8920d 152312 kamailio-java-modules_4.2.0-2_amd64.deb
 ab9f08da7f600468f9831a2db19b079961c0450f0ba388fc075eebf5269b5ac4 329458 kamailio-tls-modules_4.2.0-2_amd64.deb
 adace6d23f59a2b2a9b9c723454d045f774d24742d32eb50fe353e40607d3282 138298 kamailio-outbound-modules_4.2.0-2_amd64.deb
 3a1cec76bcd06ddf00e88d18ebafaf7ec9123bab90931996d9f9bd75c46bc75c 180258 kamailio-websocket-modules_4.2.0-2_amd64.deb
 313f262cdbeb3abc009157f836bfb76e603f1c9dbf72a26fd6c22273099cffaf 127554 kamailio-dnssec-modules_4.2.0-2_amd64.deb
 8ff9f72c51842723d63427b52ed7fc0178508d8effedcb8c5a36c061ef0883a2 156174 kamailio-autheph-modules_4.2.0-2_amd64.deb
 4ffcada8c9caab1edd4da9108adacb873ebf67187cdbc15d80c7c9b0f5a1b1d3 155128 kamailio-extra-modules_4.2.0-2_amd64.deb
Files:
 e147d7a20bd09a306d38436b3cb83f4f 6310 net optional kamailio_4.2.0-2.dsc
 ffccdbe028e1bd7816007531fb6564a9 22872 net optional kamailio_4.2.0-2.debian.tar.xz
 a70cf5d6fba25dfbfb6facbc5bf385be 6712524 net optional kamailio_4.2.0-2_amd64.deb
 73f0970356ab3e54178b2c83854d1ff5 15774748 debug extra kamailio-dbg_4.2.0-2_amd64.deb
 f25723561fdc3c8d5acbbb8652ee7e63 131588 net optional kamailio-geoip-modules_4.2.0-2_amd64.deb
 8d141445cfd18ce9b8419ab617440fe0 137424 net optional kamailio-sqlite-modules_4.2.0-2_amd64.deb
 ccbf7c46e0e52eae86731fe1239c1ba8 151762 net optional kamailio-json-modules_4.2.0-2_amd64.deb
 74b2c8a63607187e78abe03a7c45d539 139332 net optional kamailio-memcached-modules_4.2.0-2_amd64.deb
 5be7bd041fea648490f3886a8d839496 226938 net optional kamailio-lua-modules_4.2.0-2_amd64.deb
 48b1d80013cea3ee19a5a4787657002f 142486 net optional kamailio-mono-modules_4.2.0-2_amd64.deb
 a41562378e7de37683f7d53f11f8cad3 140236 net optional kamailio-python-modules_4.2.0-2_amd64.deb
 44184cd7d26215e4cd6d497f89de076a 146094 net optional kamailio-redis-modules_4.2.0-2_amd64.deb
 c5e06581be9f5623c27bb8c0c87d6226 198892 net optional kamailio-mysql-modules_4.2.0-2_amd64.deb
 583e3d25a22daee16a23b421db6acf28 231142 net optional kamailio-postgres-modules_4.2.0-2_amd64.deb
 ee2ef1f6dbc4d03b06014bdb18b4875a 318366 net optional kamailio-cpl-modules_4.2.0-2_amd64.deb
 288ee93aae79c711d93f2d96ecd5764f 204178 net optional kamailio-radius-modules_4.2.0-2_amd64.deb
 9fdfca744d19deac125f4ecb13883bb6 155456 net optional kamailio-unixodbc-modules_4.2.0-2_amd64.deb
 71ecf1bec2ebca9967013327abdd3898 972508 net optional kamailio-presence-modules_4.2.0-2_amd64.deb
 1129d7e03ba93445a22999cd6c8f6a11 195820 net optional kamailio-perl-modules_4.2.0-2_amd64.deb
 6e6d24154b928c0b3533446e2feeb140 199934 net optional kamailio-snmpstats-modules_4.2.0-2_amd64.deb
 151b7d9884d8f39aa62ff864e3c65799 182258 net optional kamailio-xmpp-modules_4.2.0-2_amd64.deb
 e715e60c144e4aefd8bfd495b57b283a 303742 net optional kamailio-xml-modules_4.2.0-2_amd64.deb
 3e8cdf7bc50003b2fa4883df8102e4c3 257948 net optional kamailio-carrierroute-modules_4.2.0-2_amd64.deb
 5d4bd1aa4d74e7a475d8253076d220d8 234644 net optional kamailio-berkeley-modules_4.2.0-2_amd64.deb
 1108d2f90ff5a554f4a80e4c8de7a073 127030 net optional kamailio-berkeley-bin_4.2.0-2_amd64.deb
 eab5289d02e0252c0d5cae81ad65a4f4 246354 net optional kamailio-ldap-modules_4.2.0-2_amd64.deb
 5a8a37c316aed878a484ae1af35fc4c2 1533402 net optional kamailio-ims-modules_4.2.0-2_amd64.deb
 ca4af1135cfc10a3990ceb8712e0fea4 166378 net optional kamailio-utils-modules_4.2.0-2_amd64.deb
 2e40ca6b9bd29ab98da324e4cc2f70fb 127386 net optional kamailio-sctp-modules_4.2.0-2_amd64.deb
 577d52e0d9fb08ec53ccf2297fe72c75 152312 net optional kamailio-java-modules_4.2.0-2_amd64.deb
 55d5e50147ae021253669cec659b2931 329458 net optional kamailio-tls-modules_4.2.0-2_amd64.deb
 2a6724d89c0ea5869220505daf07fd9b 138298 net optional kamailio-outbound-modules_4.2.0-2_amd64.deb
 f2a39421d6d9ea5178621ea1b76400d1 180258 net optional kamailio-websocket-modules_4.2.0-2_amd64.deb
 f656b1a83d4a732ab71c89eac5c7216d 127554 net optional kamailio-dnssec-modules_4.2.0-2_amd64.deb
 20811db90dfe9ccd77022a7d9ac8ec8b 156174 net optional kamailio-autheph-modules_4.2.0-2_amd64.deb
 0dc6d0da7c72500daeddf99e834ee3dd 155128 net optional kamailio-extra-modules_4.2.0-2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJUyn2CAAoJEFGgmxjPWlBoceIP+wWzCRbw9LYrv7ceIWZQXhdR
L0DObR9sEw013F5HmBSLM8NsQnowW/MJMZlo6ONfC5c/36gv6vNqzOBCg2U1/FUw
XPZKYrP71GkuYSQ36nTxTmPaMlEEW55nbwDWiRsXZAx2uGRFYevnaxa+gOS6aL+u
hHAR2SAhFPu00Duud7y+ayVGZ6tvWAgWIEouaEMYcAvdCzAfSE0m06Ej5pSuWHtn
gf+SHeWIT3eptr2gy8LsgYwfqWBTjs2L33lDCsc+KybRnc3ZMXmsdVnarLAvwO9H
ukPgYvMhhB0Ci092k/5BeuHLTnso8ix37WEOX40liAuc+VPGIBcHPYUEt+BBE2y/
0lWzUvZibrfkaSmM/LZ+Tm2KEnUwk5AEhvUxgi3QKpY/K8TQNPRpqxmrHZkJqLT7
iEtBRhdhduuUMGHOuhu0LajsTUK5LIktg9sxMtvkrI3HoGgqUrttMDQmBvRUMuPh
Wx9Vj00sbQnWgXqct5b56l+Rr+x4xmFHgjQoyG+fP2WbF1xmwlVRJ6yuxGbD2OVl
FihiOvzFd0bV2WzAFxN4gV2VS8KS/wToCk0l59pS6vdrQgSmI0imi6dn5o8Nd+q4
yStoZFWeFD7PlvH0xp0vFxhSsUAyfY+65V7iUFQ3Z9uTUv7iupWbCnp5p6fSfU5A
KLCYVPMQ2sfmqROqcMNf
=mdAx
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'kamailio: multiple /tmp file vulnerabilities (CVE-2015-1590 CVE-2015-1591)' from 'multiple /tmp file vulnerabilities'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 12 Feb 2015 15:57:10 GMT) ([full text](bugreport.cgi?bug=775681;msg=36), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=36), [link](#35)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 13 Mar 2015 07:27:42 GMT) ([full text](bugreport.cgi?bug=775681;msg=38), [mbox](bugreport.cgi?bug=775681;mbox=yes;msg=38), [link](#37)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=775681).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 13:48:15 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from people.canonical.com_3769d234_20250125_134817.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# CVE-2015-1591

Publication date 27 June 2017

Last updated 24 July 2024

---

Ubuntu priority

![](https://assets.ubuntu.com/v1/8010f9e0-CVE-Priority-icon-Medium.svg)

**Medium**

[Why this priority?](/security/cves/about#priority )

## Cvss 3 Severity Score

![](https://assets.ubuntu.com/v1/3887354e-CVE-Priority-icon-High.svg)

**7.8 · High**

[Score breakdown](#impact-score)

Toggle side navigation

Toggle table of contents

* [Description](#description)
* [Status](#status)
* [Severity score breakdown](#impact-score)
* [References](#references)

The kamailio build in kamailio before 4.2.0-2 process allows local users to
gain privileges.

## Status

Show unmaintained releases

| Package | Ubuntu Release | Status |
| --- | --- | --- |
| kamailio | 19.04 disco | Not affected |
| 18.10 cosmic | Not affected |
| 18.04 LTS bionic | Not affected |
| 17.10 artful | Not affected |
| 17.04 zesty | Not affected |
| 16.10 yakkety | Not affected |
| 16.04 LTS xenial | Not affected |
| 15.10 wily | Not affected |
| 15.04 vivid | Not affected |
| 14.10 utopic | Ignored end of life |
| 14.04 LTS trusty | Not in release |
| 12.04 LTS precise | Not in release |
| 10.04 LTS lucid | Not in release |

---

* [How can I get the fixes?](/security/cves/about#security)
* [What do statuses mean?](/security/cves/about#statuses)

## Severity score breakdown

| Parameter | Value |
| --- | --- |
| Base score | 7.8 · High |
| Attack vector | Local |
| Attack complexity | Low |
| Privileges required | Low |
| User interaction | None |
| Scope | Unchanged |
| Confidentiality | High |
| Integrity impact | High |
| Availability impact | High |
| Vector | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

## References

* [MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1591)
* [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-1591)
* [Launchpad](https://launchpad.net/bugs/cve/CVE-2015-1591)
* [Debian](https://security-tracker.debian.org/tracker/CVE-2015-1591)

### Other references

* <https://github.com/kamailio/kamailio/issues/48>
* <http://www.openwall.com/lists/oss-security/2015/02/12/7>
* <https://www.cve.org/CVERecord?id=CVE-2015-1591>

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugs.debian.org_1e199e18_20250126_090717.html ===
From d614569fc5ae36c3a985f69b5664939a0b55dc5a Mon Sep 17 00:00:00 2001
From: Victor Seva
Date: Sat, 24 Jan 2015 13:25:23 +0100
Subject: [PATCH 1/2] fix fifo and ctl defaults pointing to unsecure /tmp dir
- change default binrpc parameter of module ctl from
/tmp/kamailio\_ctl to /var/run/kamailio/kamailio\_ctl
- set that parameter on the configs etc/kamailio\*cfg
to reflect the change
- set fifo\_name to /var/run/kamailio/kamailio\_fifo at all
etc/kamailio\*cfg files.
This was already the default for kamctl since (#712083)
---
debian/patches/default\_ctl.patch | 47 ++++++++
debian/patches/default\_fifo.patch | 28 ++++-
debian/patches/kamctl\_build.patch | 236 ++++++++++++++++++++++++++++++++++++++
debian/patches/series | 2 +
4 files changed, 310 insertions(+), 3 deletions(-)
create mode 100644 debian/patches/default\_ctl.patch
create mode 100644 debian/patches/kamctl\_build.patch
diff --git a/debian/patches/default\_ctl.patch b/debian/patches/default\_ctl.patch
new file mode 100644
index 0000000..c702911
--- /dev/null
+++ b/debian/patches/default\_ctl.patch
@@ -0,0 +1,47 @@
+Description: change default ctl file
+Author: Victor Seva
+
+--- a/etc/kamailio-basic.cfg
++++ b/etc/kamailio-basic.cfg
+@@ -193,6 +193,8 @@
+ # ----- mi\_fifo params -----
+ modparam("mi\_fifo", "fifo\_name", "/var/run/kamailio/kamailio\_fifo")
+
++# ----- ctl params -----
++modparam("ctl", "binrpc", "unix:/var/run/kamailio/kamailio\_ctl")
+
+ # ----- tm params -----
+ # auto-discard branches from previous serial forking leg
+--- a/etc/kamailio-oob.cfg
++++ b/etc/kamailio-oob.cfg
+@@ -317,6 +317,8 @@
+ # ----- mi\_fifo params -----
+ modparam("mi\_fifo", "fifo\_name", "/var/run/kamailio/kamailio\_fifo")
+
++# ----- ctl params -----
++modparam("ctl", "binrpc", "unix:/var/run/kamailio/kamailio\_ctl")
+
+ # ----- tm params -----
+ # auto-discard branches from previous serial forking leg
+--- a/etc/kamailio.cfg
++++ b/etc/kamailio.cfg
+@@ -290,6 +290,8 @@
+ # ----- mi\_fifo params -----
+ modparam("mi\_fifo", "fifo\_name", "/var/run/kamailio/kamailio\_fifo")
+
++# ----- ctl params -----
++modparam("ctl", "binrpc", "unix:/var/run/kamailio/kamailio\_ctl")
+
+ # ----- tm params -----
+ # auto-discard branches from previous serial forking leg
+--- a/modules/ctl/ctl\_defaults.h
++++ b/modules/ctl/ctl\_defaults.h
+@@ -6,7 +6,7 @@
+ /\*listen by default on: \*/
+ #ifdef SRNAME
+ /\* this is used when compiling sercmd tool \*/
+-#define DEFAULT\_CTL\_SOCKET "unixs:/tmp/" SRNAME "\_ctl"
++#define DEFAULT\_CTL\_SOCKET "unixs:/var/run/" SRNAME "/" SRNAME "\_ctl"
+ #else
+ /\* this is used when compiling sip server \*/
+ #define DEFAULT\_CTL\_SOCKET "unixs:/tmp/" NAME "\_ctl"
diff --git a/debian/patches/default\_fifo.patch b/debian/patches/default\_fifo.patch
index 68d2e72..3a6ac0b 100644
--- a/debian/patches/default\_fifo.patch
+++ b/debian/patches/default\_fifo.patch
@@ -3,7 +3,7 @@ Author: Victor Seva
--- a/etc/kamailio.cfg
+++ b/etc/kamailio.cfg
-@@ -287,7 +287,7 @@
+@@ -288,7 +288,7 @@
# ----- mi\_fifo params -----
@@ -25,7 +25,7 @@ Author: Victor Seva
fi
--- a/utils/kamctl/kamctlrc
+++ b/utils/kamctl/kamctlrc
-@@ -122,7 +122,7 @@
+@@ -124,7 +124,7 @@
# CTLENGINE="FIFO"
## path to FIFO file
@@ -34,7 +34,7 @@ Author: Victor Seva
## check ACL names; default on (1); off (0)
# VERIFY\_ACL=1
-@@ -140,7 +140,7 @@
+@@ -142,7 +142,7 @@
## Kamailio START Options
## PID file path - default is: /var/run/kamailio.pid
@@ -43,3 +43,25 @@ Author: Victor Seva
## Extra start options - default is: not set
# example: start Kamailio with 64MB share memory: STARTOPTIONS="-m 64"
+--- a/etc/kamailio-basic.cfg
++++ b/etc/kamailio-basic.cfg
+@@ -191,7 +191,7 @@
+
+
+ # ----- mi\_fifo params -----
+-modparam("mi\_fifo", "fifo\_name", "/tmp/kamailio\_fifo")
++modparam("mi\_fifo", "fifo\_name", "/var/run/kamailio/kamailio\_fifo")
+
+
+ # ----- tm params -----
+--- a/etc/kamailio-oob.cfg
++++ b/etc/kamailio-oob.cfg
+@@ -315,7 +315,7 @@
+
+
+ # ----- mi\_fifo params -----
+-modparam("mi\_fifo", "fifo\_name", "/tmp/kamailio\_fifo")
++modparam("mi\_fifo", "fifo\_name", "/var/run/kamailio/kamailio\_fifo")
+
+
+ # ----- tm params -----
diff --git a/debian/patches/kamctl\_build.patch b/debian/patches/kamctl\_build.patch
new file mode 100644
index 0000000..3342ec3
--- /dev/null
+++ b/debian/patches/kamctl\_build.patch
@@ -0,0 +1,236 @@
+--- a/utils/kamctl/Makefile
++++ b/utils/kamctl/Makefile
+@@ -25,63 +25,63 @@
+ cat kamctl | \
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" | \
+ sed -e "s#/usr/local/lib/kamailio#$(lib\_target)#g" | \
+- sed -e "s#/usr/local/etc/kamailio#$(cfg\_target)#g" >/tmp/kamctl
++ sed -e "s#/usr/local/etc/kamailio#$(cfg\_target)#g" >$(basedir)/kamctl
+ $(INSTALL\_TOUCH) $(bin\_prefix)/$(bin\_dir)/kamctl
+- $(INSTALL\_BIN) /tmp/kamctl $(bin\_prefix)/$(bin\_dir)
+- rm -fr /tmp/kamctl
++ $(INSTALL\_BIN) $(basedir)/kamctl $(bin\_prefix)/$(bin\_dir)
++ rm -fr $(basedir)/kamctl
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" \
+- < kamctl.base > /tmp/kamctl.base
++ < kamctl.base > $(basedir)/kamctl.base
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl
+ $(INSTALL\_TOUCH) \
+ $(modules\_prefix)/$(lib\_dir)/kamctl
+- $(INSTALL\_CFG) /tmp/kamctl.base \
++ $(INSTALL\_CFG) $(basedir)/kamctl.base \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.base
+- rm -fr /tmp/kamctl.base
++ rm -fr $(basedir)/kamctl.base
+ sed -e "s#/usr/local#$(bin\_target)#g" \
+- < kamctl.ctlbase > /tmp/kamctl.ctlbase
+- $(INSTALL\_CFG) /tmp/kamctl.ctlbase \
++ < kamctl.ctlbase > $(basedir)/kamctl.ctlbase
++ $(INSTALL\_CFG) $(basedir)/kamctl.ctlbase \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.ctlbase
+- rm -fr /tmp/kamctl.ctlbase
++ rm -fr $(basedir)/kamctl.ctlbase
+ sed -e "s#/usr/local#$(bin\_target)#g" \
+- < kamctl.fifo > /tmp/kamctl.fifo
+- $(INSTALL\_CFG) /tmp/kamctl.fifo \
++ < kamctl.fifo > $(basedir)/kamctl.fifo
++ $(INSTALL\_CFG) $(basedir)/kamctl.fifo \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.fifo
+- rm -fr /tmp/kamctl.fifo
++ rm -fr $(basedir)/kamctl.fifo
+ sed -e "s#/usr/local#$(bin\_target)#g" \
+- < kamctl.ser > /tmp/kamctl.ser
+- $(INSTALL\_CFG) /tmp/kamctl.ser \
++ < kamctl.ser > $(basedir)/kamctl.ser
++ $(INSTALL\_CFG) $(basedir)/kamctl.ser \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.ser
+- rm -fr /tmp/kamctl.ser
++ rm -fr $(basedir)/kamctl.ser
+ sed -e "s#/usr/local#$(bin\_target)#g" \
+- < kamctl.ser\_mi > /tmp/kamctl.ser\_mi
+- $(INSTALL\_CFG) /tmp/kamctl.ser\_mi \
++ < kamctl.ser\_mi > $(basedir)/kamctl.ser\_mi
++ $(INSTALL\_CFG) $(basedir)/kamctl.ser\_mi \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.ser\_mi
+- rm -fr /tmp/kamctl.ser\_mi
++ rm -fr $(basedir)/kamctl.ser\_mi
+ sed -e "s#/usr/local#$(bin\_target)#g" \
+- < kamctl.unixsock > /tmp/kamctl.unixsock
+- $(INSTALL\_CFG) /tmp/kamctl.unixsock \
++ < kamctl.unixsock > $(basedir)/kamctl.unixsock
++ $(INSTALL\_CFG) $(basedir)/kamctl.unixsock \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.unixsock
+- rm -fr /tmp/kamctl.unixsock
++ rm -fr $(basedir)/kamctl.unixsock
+ sed -e "s#/usr/local#$(bin\_target)#g" \
+- < kamctl.sqlbase > /tmp/kamctl.sqlbase
+- $(INSTALL\_CFG) /tmp/kamctl.sqlbase \
++ < kamctl.sqlbase > $(basedir)/kamctl.sqlbase
++ $(INSTALL\_CFG) $(basedir)/kamctl.sqlbase \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.sqlbase
+- rm -fr /tmp/kamctl.sqlbase
++ rm -fr $(basedir)/kamctl.sqlbase
+ # install db setup base script
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" \
+ -e "s#/usr/local/etc/kamailio#$(cfg\_target)#g" \
+ -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbctl.base > /tmp/kamdbctl.base
+- $(INSTALL\_CFG) /tmp/kamdbctl.base \
++ < kamdbctl.base > $(basedir)/kamdbctl.base
++ $(INSTALL\_CFG) $(basedir)/kamdbctl.base \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbctl.base
+- rm -fr /tmp/kamdbctl.base
++ rm -fr $(basedir)/kamdbctl.base
+ cat kamdbctl | \
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" | \
+ sed -e "s#/usr/local/lib/kamailio#$(lib\_target)#g" | \
+- sed -e "s#/usr/local/etc/kamailio#$(cfg\_target)#g" >/tmp/kamdbctl
++ sed -e "s#/usr/local/etc/kamailio#$(cfg\_target)#g" >$(basedir)/kamdbctl
+ $(INSTALL\_TOUCH) $(bin\_prefix)/$(bin\_dir)/kamdbctl
+- $(INSTALL\_BIN) /tmp/kamdbctl $(bin\_prefix)/$(bin\_dir)
+- rm -fr /tmp/kamdbctl
++ $(INSTALL\_BIN) $(basedir)/kamdbctl $(bin\_prefix)/$(bin\_dir)
++ rm -fr $(basedir)/kamdbctl
+
+ install-man: $(man\_prefix)/$(man\_dir)/man8 $(man\_prefix)/$(man\_dir)/man5
+ sed -e "s#/etc/$(NAME)/$(NAME)\.cfg#$(cfg\_target)$(NAME).cfg#g" \
+@@ -105,15 +105,15 @@
+ if [ "$(MYSQLON)" = "yes" ]; then \
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl ; \
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" \
+- < kamctl.mysql > /tmp/kamctl.mysql ; \
+- $(INSTALL\_CFG) /tmp/kamctl.mysql \
++ < kamctl.mysql > $(basedir)/kamctl.mysql ; \
++ $(INSTALL\_CFG) $(basedir)/kamctl.mysql \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.mysql ; \
+- rm -fr /tmp/kamctl.mysql ; \
++ rm -fr $(basedir)/kamctl.mysql ; \
+ sed -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbctl.mysql > /tmp/kamdbctl.mysql ; \
++ < kamdbctl.mysql > $(basedir)/kamdbctl.mysql ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbctl.mysql ; \
+- $(INSTALL\_CFG) /tmp/kamdbctl.mysql $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
+- rm -fr /tmp/kamdbctl.mysql ; \
++ $(INSTALL\_CFG) $(basedir)/kamdbctl.mysql $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
++ rm -fr $(basedir)/kamdbctl.mysql ; \
+ mkdir -p $(data\_prefix)/$(data\_dir)/mysql ; \
+ for FILE in $(wildcard mysql/\*) ; do \
+ if [ -f $$FILE ] ; then \
+@@ -128,15 +128,15 @@
+ if [ "$(PGSQLON)" = "yes" ]; then \
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl ; \
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" \
+- < kamctl.pgsql > /tmp/kamctl.pgsql ; \
+- $(INSTALL\_CFG) /tmp/kamctl.pgsql \
++ < kamctl.pgsql > $(basedir)/kamctl.pgsql ; \
++ $(INSTALL\_CFG) $(basedir)/kamctl.pgsql \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.pgsql ; \
+- rm -fr /tmp/kamctl.pgsql ; \
++ rm -fr $(basedir)/kamctl.pgsql ; \
+ sed -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbctl.pgsql > /tmp/kamdbctl.pgsql ; \
++ < kamdbctl.pgsql > $(basedir)/kamdbctl.pgsql ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbctl.pgsql ; \
+- $(INSTALL\_CFG) /tmp/kamdbctl.pgsql $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
+- rm -fr /tmp/kamdbctl.pgsql ; \
++ $(INSTALL\_CFG) $(basedir)/kamdbctl.pgsql $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
++ rm -fr $(basedir)/kamdbctl.pgsql ; \
+ mkdir -p $(data\_prefix)/$(data\_dir)/postgres ; \
+ for FILE in $(wildcard postgres/\*) ; do \
+ if [ -f $$FILE ] ; then \
+@@ -151,20 +151,20 @@
+ if [ "$(ORACLEON)" = "yes" ]; then \
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl ; \
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" \
+- < kamctl.oracle > /tmp/kamctl.oracle ; \
+- $(INSTALL\_CFG) /tmp/kamctl.oracle \
++ < kamctl.oracle > $(basedir)/kamctl.oracle ; \
++ $(INSTALL\_CFG) $(basedir)/kamctl.oracle \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.oracle ; \
+- rm -fr /tmp/kamctl.oracle ; \
++ rm -fr $(basedir)/kamctl.oracle ; \
+ sed -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbctl.oracle > /tmp/kamdbctl.oracle ; \
++ < kamdbctl.oracle > $(basedir)/kamdbctl.oracle ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbctl.oracle ; \
+- $(INSTALL\_CFG) /tmp/kamdbctl.oracle $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
+- rm -fr /tmp/kamdbctl.oracle ; \
++ $(INSTALL\_CFG) $(basedir)/kamdbctl.oracle $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
++ rm -fr $(basedir)/kamdbctl.oracle ; \
+ sed -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbfunc.oracle > /tmp/kamdbfunc.oracle ; \
++ < kamdbfunc.oracle > $(basedir)/kamdbfunc.oracle ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbfunc.oracle ; \
+- $(INSTALL\_CFG) /tmp/kamdbfunc.oracle $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
+- rm -fr /tmp/kamdbfunc.oracle ; \
++ $(INSTALL\_CFG) $(basedir)/kamdbfunc.oracle $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
++ rm -fr $(basedir)/kamdbfunc.oracle ; \
+ mkdir -p $(data\_prefix)/$(data\_dir)/oracle ; \
+ for FILE in $(wildcard oracle/\*) ; do \
+ if [ -f $$FILE ] ; then \
+@@ -199,15 +199,15 @@
+ if [ "$(BERKELEYDBON)" = "yes" ]; then \
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl ; \
+ sed -e "s#/usr/local/share/kamailio/#$(data\_target)#g" \
+- < kamctl.db\_berkeley > /tmp/kamctl.db\_berkeley ; \
+- $(INSTALL\_CFG) /tmp/kamctl.db\_berkeley \
++ < kamctl.db\_berkeley > $(basedir)/kamctl.db\_berkeley ; \
++ $(INSTALL\_CFG) $(basedir)/kamctl.db\_berkeley \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.db\_berkeley ; \
+- rm -fr /tmp/kamctl.db\_berkeley ; \
++ rm -fr $(basedir)/kamctl.db\_berkeley ; \
+ sed -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbctl.db\_berkeley > /tmp/kamdbctl.db\_berkeley ; \
++ < kamdbctl.db\_berkeley > $(basedir)/kamdbctl.db\_berkeley ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbctl.db\_berkeley ; \
+- $(INSTALL\_CFG) /tmp/kamdbctl.db\_berkeley $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
+- rm -fr /tmp/kamdbctl.db\_berkeley ; \
++ $(INSTALL\_CFG) $(basedir)/kamdbctl.db\_berkeley $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
++ rm -fr $(basedir)/kamdbctl.db\_berkeley ; \
+ mkdir -p $(data\_prefix)/$(data\_dir)/db\_berkeley/kamailio ; \
+ for FILE in $(wildcard db\_berkeley/kamailio/\*) ; do \
+ if [ -f $$FILE ] ; then \
+@@ -224,15 +224,15 @@
+ if [ "$(DBTEXTON)" = "yes" ]; then \
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl ; \
+ sed -e "s#/usr/local/share/kamailio/#$(data\_target)#g" \
+- < kamctl.dbtext > /tmp/kamctl.dbtext ; \
+- $(INSTALL\_CFG) /tmp/kamctl.dbtext \
++ < kamctl.dbtext > $(basedir)/kamctl.dbtext ; \
++ $(INSTALL\_CFG) $(basedir)/kamctl.dbtext \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.dbtext ; \
+- rm -fr /tmp/kamctl.dbtext ; \
++ rm -fr $(basedir)/kamctl.dbtext ; \
+ sed -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbctl.dbtext > /tmp/kamdbctl.dbtext ; \
++ < kamdbctl.dbtext > $(basedir)/kamdbctl.dbtext ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbctl.dbtext ; \
+- $(INSTALL\_CFG) /tmp/kamdbctl.dbtext $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
+- rm -fr /tmp/kamdbctl.dbtext ; \
++ $(INSTALL\_CFG) $(basedir)/kamdbctl.dbtext $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
++ rm -fr $(basedir)/kamdbctl.dbtext ; \
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl/dbtextdb ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/dbtextdb/dbtextdb.py ; \
+ $(INSTALL\_BIN) dbtextdb/dbtextdb.py $(modules\_prefix)/$(lib\_dir)/kamctl/dbtextdb/ ; \
+@@ -250,15 +250,15 @@
+ if [ "$(SQLITEON)" = "yes" ]; then \
+ mkdir -p $(modules\_prefix)/$(lib\_dir)/kamctl ; \
+ sed -e "s#/usr/local/sbin#$(bin\_target)#g" \
+- < kamctl.sqlite > /tmp/kamctl.sqlite ; \
+- $(INSTALL\_CFG) /tmp/kamctl.sqlite \
++ < kamctl.sqlite > $(basedir)/kamctl.sqlite ; \
++ $(INSTALL\_CFG) $(basedir)/kamctl.sqlite \
+ $(modules\_prefix)/$(lib\_dir)/kamctl/kamctl.sqlite ; \
+- rm -fr /tmp/kamctl.sqlite ; \
++ rm -fr $(basedir)/kamctl.sqlite ; \
+ sed -e "s#/usr/local/share/kamailio#$(data\_target)#g" \
+- < kamdbctl.sqlite > /tmp/kamdbctl.sqlite ; \
++ < kamdbctl.sqlite > $(basedir)/kamdbctl.sqlite ; \
+ $(INSTALL\_TOUCH) $(modules\_prefix)/$(lib\_dir)/kamctl/kamdbctl.sqlite ; \
+- $(INSTALL\_CFG) /tmp/kamdbctl.sqlite $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
+- rm -fr /tmp/kamdbctl.sqlite ; \
++ $(INSTALL\_CFG) $(basedir)/kamdbctl.sqlite $(modules\_prefix)/$(lib\_dir)/kamctl/ ; \
++ rm -fr $(basedir)/kamdbctl.sqlite ; \
+ mkdir -p $(data\_prefix)/$(data\_dir)/db\_sqlite ; \
+ for FILE in $(wildcard db\_sqlite/\*) ; do \
+ if [ -f $$FILE ] ; then \
diff --git a/debian/patches/series b/debian/patches/series
index 8b9d3d4..ea0be66 100644
--- a/debian/patches/series
+++ b/debian/patches/series
@@ -2,4 +2,6 @@ no\_lib64\_on\_64\_bits.patch
no\_INSTALL\_file.patch
fix\_export.patch
default\_fifo.patch
+kamctl\_build.patch
+default\_ctl.patch
fix-mips.patch
--
2.1.4


=== Content from github.com_dda09eed_20250126_090713.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkamailio%2Fkamailio%2Fissues%2F48)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkamailio%2Fkamailio%2Fissues%2F48)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=kamailio%2Fkamailio)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kamailio](/kamailio)
/
**[kamailio](/kamailio/kamailio)**
Public

* [Notifications](/login?return_to=%2Fkamailio%2Fkamailio) You must be signed in to change notification settings
* [Fork
  967](/login?return_to=%2Fkamailio%2Fkamailio)
* [Star
   2.4k](/login?return_to=%2Fkamailio%2Fkamailio)

* [Code](/kamailio/kamailio)
* [Issues
  27](/kamailio/kamailio/issues)
* [Pull requests
  16](/kamailio/kamailio/pulls)
* [Actions](/kamailio/kamailio/actions)
* [Projects
  0](/kamailio/kamailio/projects)
* [Wiki](/kamailio/kamailio/wiki)
* [Security](/kamailio/kamailio/security)
* [Insights](/kamailio/kamailio/pulse)

Additional navigation options

* [Code](/kamailio/kamailio)
* [Issues](/kamailio/kamailio/issues)
* [Pull requests](/kamailio/kamailio/pulls)
* [Actions](/kamailio/kamailio/actions)
* [Projects](/kamailio/kamailio/projects)
* [Wiki](/kamailio/kamailio/wiki)
* [Security](/kamailio/kamailio/security)
* [Insights](/kamailio/kamailio/pulse)

# multiple /tmp file vulnerabilities #48

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[multiple /tmp file vulnerabilities](#top)#48Copy link[![@linuxmaniac](https://avatars.githubusercontent.com/u/63080?v=4&size=80)](/linuxmaniac)
## Description

[![@linuxmaniac](https://avatars.githubusercontent.com/u/63080?v=4&size=48)](/linuxmaniac)[linuxmaniac](https://github.com/linuxmaniac)opened [on Jan 20, 2015](https://github.com/kamailio/kamailio/issues/48#issue-54862309)

Reported by: Helmut Grohne helmut@subdivi.de

The kamailio package now installs /etc/kamailio/kamailio-basic.cfg which

can be selected via the CFGFILE= setting in /etc/default/kamailio. The

configuration contains:

```
modparam("mi_fifo", "fifo_name", "/tmp/kamailio_fifo")

```

This setting is insecure and may allow local users to elevate privileges

to the kamailio user.

The issue extends to kamailio-advanced.cfg. It seems that this is due to

an incomplete fix of #712083. Looking further, the state of /tmp file

vulnerabilities in kamailio looks worrisome. Most of the results of the

following command (to be executed in the kamailio source) are likely

vulnerable if executed:

```
grep '/tmp/[a-z0-9_.-]\+\(\$\$\)\?\([" ]\|$\)' -r .

```

Granted, some of the results are examples, documentation or obsolete.

But quite a few reach the default settings:

* kamcmd defaults to connecting to unixs:/tmp/kamailio\_ctl.
* The kamailio build definitely is vulnerable as can be seen in

  utils/kamctl/Makefile.

More research clearly is required here. Given these findings, the

security team may want to veto the inclusion of kamailio in a stable

release, which would be very unfortunate as kamailio is quite a unique

piece of software with little competitors in its field.

Helmut

<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=775681>

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security-tracker.debian.org_d0bedb27_20250126_090714.html ===

# CVE-2015-1591

| **Name** | CVE-2015-1591 |
| --- | --- |
| **Description** | The kamailio build in kamailio before 4.2.0-2 process allows local users to gain privileges. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-1591) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-1591); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-1591), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-1591), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-1591), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-1591), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-1591), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-1591), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-1591), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-1591)/[CVE](https://www.suse.com/security/cve/CVE-2015-1591/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-1591)/[code](https://github.com/search?type=Code&q=%22CVE-2015-1591%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-1591%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-1591%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [775681](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=775681) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [kamailio](/tracker/source-package/kamailio) ([PTS](https://tracker.debian.org/pkg/kamailio)) | bullseye | 5.4.4-1 | fixed |
|  | bookworm | 5.6.3-2 | fixed |
|  | sid, trixie | 5.8.4-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [kamailio](/tracker/source-package/kamailio) | source | (unstable) | 4.2.0-2 |  |  | [775681](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=775681) |

## Notes

```
<https://github.com/kamailio/kamailio/issues/48>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from assets.ubuntu.com_9a4aab3c_20250126_090714.html ===
!�   ������l��Ж���M��=�z���`" ��mQ�G9�A�nc;�Nj�8��a�%���v���=�xT\n��Q�=��������<]7��ss���`<�]7��k����Ϻ�;t���Ǥ�զ{��c[ gy��H�b���6��d��f~ݴ��u��$�\_t/p�zݍ���I����9��yI�$T�+<R-Q�sR,Y�ap�^��I!��������#��W�D���ZIa-�&d���Ţ�$��k�Z�φ��MJR,┩�#��,IP���`B� cN��=�WSO���n�U��\*GQ`t�Ȯ��#a�>�����l6fx�а0��R���\���$�Hd ]��K���M���7=

=== Content from www.openwall.com_bfc128d5_20250125_134813.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2015/01/26/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Pine.LNX.4.64.1502120931560.17759@beijing.mitre.org>
Date: Thu, 12 Feb 2015 09:33:28 -0500 (EST)
From: cve-assign@...re.org
To: Helmut Grohne <helmut@...divi.de>
cc: oss-security@...ts.openwall.com,
        Victor Seva <linuxmaniac@...reviejawireless.org>, cve-assign@...re.org
Subject: Re: kamailio: multiple /tmp file vulnerabilities

> There are multiple /tmp file vulnerabilities to be found in the kamailio
> SIP proxy. While many of these issues only affect configuration examples
> or outdated components, some do affect the default configuration.
>
> Initial disclosures:
> <http://bugs.debian.org/712083> (2013)
> <http://bugs.debian.org/775681> (2015)
> Upstream issue:
> <https://github.com/kamailio/kamailio/issues/48>
>
> At this point, three issues are well understood:
> * The kamctl administrative utility and default configuration would use
>   /tmp/kamailio_fifo (#712083, 2013, fixed in Debian's kamailio
>   4.0.2-1).

Use CVE-2013-7426.

> * The kamcmd administrative utility and default configuration would use
>   /tmp/kamailio_ctl (#775681, 2015, patch available).

Use CVE-2015-1590.

> * The kamailio build process would use constant filenames in /tmp
>   allowing to elevate privileges to the build user (#775681, 2015,
>   patch available).

Use CVE-2015-1591.

> The combined patch can be found at:
> <https://bugs.debian.org/cgi-bin/bugreport.cgi?msg=17;filename=0001-fix-fifo-and-ctl-defaults-pointing-to-unsecure-tmp-d.patch;att=1;bug=775681>
>
> While the last issue definitely affects the upstream kamailio build,
> arguably the first two issues are packaging specific. If they are
> treated as such, it is worth noting that kamailio was never part of a
> Debian stable release and thus this may not be worth issuing a CVE.
>
> I would like to thank Victor Seva for his timely responses, kind
> interaction and providing patches for all of these issues.
>
> Helmut

---

CVE assignment team, MITRE CVE Numbering Authority M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from launchpad.net_e6022c55_20250126_090715.html ===

[Log in / Register](https://launchpad.net/bugs/cve/CVE-2015-1591/%2Blogin)

![](/@@/launchpad-logo)

## Launchpad.net

* [Launchpad Home](https://launchpad.net/)
* [Code](https://code.launchpad.net/)
* [Bugs](https://bugs.launchpad.net/)
* [Blueprints](https://blueprints.launchpad.net/)
* [Translations](https://translations.launchpad.net/)
* [Answers](https://answers.launchpad.net/)

[Launchpad CVE tracker](/bugs/cve)
# CVE 2015-1591

The kamailio build in kamailio before 4.2.0-2 process allows local users to gain privileges.

See the ![](/@@/link)
[CVE page on Mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-1591)
for more details.

## Related bugs

*No related bugs.*

* [Link to bug](%2Blinkbug)
* [Remove bug link](%2Bunlinkbug)

## References

* MLIST:
  [[oss-security] 2015021...](http://www.openwall.com/lists/oss-security/2015/02/12/7)
* MISC:
  [http://cve.killedkenny...](http://cve.killedkenny.io/cve/CVE-2015-1591)
* MISC:
  [https://people.canonic...](https://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1591.html)
* CONFIRM:
  [https://bugs.debian.or...](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=775681)
* CONFIRM:
  [https://bugs.debian.or...](https://bugs.debian.org/cgi-bin/bugreport.cgi?msg=17;filename=0001-fix-fifo-and-ctl-defaults-pointing-to-unsecure-tmp-d.patch;att=1;bug=775681)
* CONFIRM:
  [https://github.com/kam...](https://github.com/kamailio/kamailio/issues/48)

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from cve.killedkenny.io_bbbc2159_20250125_134813.html ===

# \*\* RESERVED \*\*

* [home](https://cve.killedkenny.io/)
* [about](https://cve.killedkenny.io/p/about/)

### [CVE-2015-1591](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1591)


