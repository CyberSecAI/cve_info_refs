=== Content from www.mandriva.com_541d58f9_20250125_211537.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.libssh2.org_ed81c1f6_20250125_211535.html ===

[/](https://libssh2.org/) |
[Mailing list](/mail.cgi) |
[Docs](/docs.html) |
[Examples](/examples/) |
[GitHub](https://github.com/libssh2/libssh2)
 libssh2 Security Advisory
# Using `SSH_MSG_KEXINIT` data unbounded

Project libssh2 Security Advisory, March 11th 2015 -
[Permalink](https://www.libssh2.org/adv_20150311.html)

## VULNERABILITY

When negotiating a new SSH session with a remote server, one of libssh2's
functions for doing the key exchange (`kex_agree_methods()`) was naively
reading data from the incoming packet and using it without doing sufficient
range checks. The `SSH_MSG_KEXINIT` packet arrives to libssh2 with a set of
strings, sent as a series of LENGTH + DATA pairs. libssh2 would go through the
list and read the LENGTH field, read the string following the LENGTH and then
advance the pointer LENGTH bytes in memory and expect to find the next LENGTH
+ DATA pair there. Then move on until seven subsequent strings are taken care
of. It would naively assume that the (unsigned 32 bit) LENGTH fields were
valid.

This packet arrives in the negotiating phase so the remote server has not yet
been deemed to be a known or trusted party.

A malicious attacker could man in the middle a real server and cause libssh2
using clients to crash (denial of service) or otherwise read and use
completely unintended memory areas in this process.

There are no known exploits of this flaw at this time.

## INFO

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2015-1782 to this issue.

## AFFECTED VERSIONS

* Affected versions: all versions to and including 1.4.3
* Not affected versions: libssh2 >= 1.5.0

libssh2 is used by many applications, but not always advertised as such!

## THE SOLUTION

libssh2 1.5.0 makes sure that the LENGTH fields read from the packet fit
within the received packet size before attempting to read them, or it fails
graciously.

A patch for this problem is available at:

```
https://www.libssh2.org/CVE-2015-1782.patch

```
## RECOMMENDATIONS

We suggest you take one of the following actions immediately, in order of
preference:

A - Upgrade to libssh2 1.5.0

B - Apply the patch and rebuild libssh2

## TIME LINE

It was first reported to the libssh2 project on January 25 2015. We contacted
distros@openwall on March 6.

libssh2 1.5.0 was released on March 11th 2015, coordinated with the
publication of this advisory.

## CREDITS

Reported by Mariusz Ziulek. Patch written by Mariusz Ziulek and Daniel Stenberg,

Thanks a lot!



=== Content from www.libssh2.org_8a04583f_20250126_120027.html ===
From dd57ee000d2241274ef46ad5e08802c35ba0eb2c Mon Sep 17 00:00:00 2001
From: Mariusz Ziulek
Date: Sat, 21 Feb 2015 23:31:36 +0100
Subject: [PATCH] kex: bail out on rubbish in the incoming packet
CVE-2015-1782
Bug: https://www.libssh2.org/adv\_20150311.html
---
src/kex.c | 73 +++++++++++++++++++++++++++++++++++----------------------------
1 file changed, 41 insertions(+), 32 deletions(-)
diff --git a/src/kex.c b/src/kex.c
index fa4c4e1..ad7498a 100644
--- a/src/kex.c
+++ b/src/kex.c
@@ -1547,10 +1547,34 @@ static int kex\_agree\_comp(LIBSSH2\_SESSION \*session,
/\* TODO: When in server mode we need to turn this logic on its head
\* The Client gets to make the final call on "agreed methods"
\*/
+/\*
+ \* kex\_string\_pair() extracts a string from the packet and makes sure it fits
+ \* within the given packet.
+ \*/
+static int kex\_string\_pair(unsigned char \*\*sp, /\* parsing position \*/
+ unsigned char \*data, /\* start pointer to packet \*/
+ size\_t data\_len, /\* size of total packet \*/
+ size\_t \*lenp, /\* length of the string \*/
+ unsigned char \*\*strp) /\* pointer to string start \*/
+{
+ unsigned char \*s = \*sp;
+ \*lenp = \_libssh2\_ntohu32(s);
+
+ /\* the length of the string must fit within the current pointer and the
+ end of the packet \*/
+ if (\*lenp > (data\_len - (s - data) -4))
+ return 1;
+ \*strp = s + 4;
+ s += 4 + \*lenp;
+
+ \*sp = s;
+ return 0;
+}
+
/\* kex\_agree\_methods
\* Decide which specific method to use of the methods offered by each party
\*/
static int kex\_agree\_methods(LIBSSH2\_SESSION \* session, unsigned char \*data,
unsigned data\_len)
@@ -1566,42 +1590,27 @@ static int kex\_agree\_methods(LIBSSH2\_SESSION \* session, unsigned char \*data,
/\* Skip cookie, don't worry, it's preserved in the kexinit field \*/
s += 16;
/\* Locate each string \*/
- kex\_len = \_libssh2\_ntohu32(s);
- kex = s + 4;
- s += 4 + kex\_len;
- hostkey\_len = \_libssh2\_ntohu32(s);
- hostkey = s + 4;
- s += 4 + hostkey\_len;
- crypt\_cs\_len = \_libssh2\_ntohu32(s);
- crypt\_cs = s + 4;
- s += 4 + crypt\_cs\_len;
- crypt\_sc\_len = \_libssh2\_ntohu32(s);
- crypt\_sc = s + 4;
- s += 4 + crypt\_sc\_len;
- mac\_cs\_len = \_libssh2\_ntohu32(s);
- mac\_cs = s + 4;
- s += 4 + mac\_cs\_len;
- mac\_sc\_len = \_libssh2\_ntohu32(s);
- mac\_sc = s + 4;
- s += 4 + mac\_sc\_len;
- comp\_cs\_len = \_libssh2\_ntohu32(s);
- comp\_cs = s + 4;
- s += 4 + comp\_cs\_len;
- comp\_sc\_len = \_libssh2\_ntohu32(s);
- comp\_sc = s + 4;
-#if 0
- s += 4 + comp\_sc\_len;
- lang\_cs\_len = \_libssh2\_ntohu32(s);
- lang\_cs = s + 4;
- s += 4 + lang\_cs\_len;
- lang\_sc\_len = \_libssh2\_ntohu32(s);
- lang\_sc = s + 4;
- s += 4 + lang\_sc\_len;
-#endif
+ if(kex\_string\_pair(&s, data, data\_len, &kex\_len, &kex))
+ return -1;
+ if(kex\_string\_pair(&s, data, data\_len, &hostkey\_len, &hostkey))
+ return -1;
+ if(kex\_string\_pair(&s, data, data\_len, &crypt\_cs\_len, &crypt\_cs))
+ return -1;
+ if(kex\_string\_pair(&s, data, data\_len, &crypt\_sc\_len, &crypt\_sc))
+ return -1;
+ if(kex\_string\_pair(&s, data, data\_len, &mac\_cs\_len, &mac\_cs))
+ return -1;
+ if(kex\_string\_pair(&s, data, data\_len, &mac\_sc\_len, &mac\_sc))
+ return -1;
+ if(kex\_string\_pair(&s, data, data\_len, ∁\_cs\_len, ∁\_cs))
+ return -1;
+ if(kex\_string\_pair(&s, data, data\_len, ∁\_sc\_len, ∁\_sc))
+ return -1;
+
/\* If the server sent an optimistic packet, assume that it guessed wrong.
\* If the guess is determined to be right (by kex\_agree\_kex\_hostkey)
\* This flag will be reset to zero so that it's not ignored \*/
session->burn\_optimistic\_kexinit = \*(s++);
/\* Next uint32 in packet is all zeros (reserved) \*/
--
2.1.4


=== Content from www.debian.org_8add9c44_20250125_211533.html ===


---

[[Date Prev](msg00066.html)][[Date Next](msg00068.html)]
[[Thread Prev](msg00066.html)][[Thread Next](msg00068.html)]
[[Date Index](maillist.html#00067)]
[[Thread Index](threads.html#00067)]

# [SECURITY] [DSA 3182-1] libssh2 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3182-1] libssh2 security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Wed, 11 Mar 2015 11:04:21 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1YVeR3-0000Di-8S%40master.debian.org) [E1YVeR3-0000Di-8S@master.debian.org](msg00067.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3182-1                   security@debian.org
<http://www.debian.org/security/>                      Salvatore Bonaccorso
March 11, 2015                         <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libssh2
CVE ID         : CVE-2015-1782
Debian Bug     : 780249

Mariusz Ziulek reported that libssh2, a SSH2 client-side library, was
reading and using the SSH_MSG_KEXINIT packet without doing sufficient
range checks when negotiating a new SSH session with a remote server. A
malicious attacker could man in the middle a real server and cause a
client using the libssh2 library to crash (denial of service) or
otherwise read and use unintended memory areas in this process.

For the stable distribution (wheezy), this problem has been fixed in
version 1.4.2-1.1+deb7u1.

We recommend that you upgrade your libssh2 packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJVACENAAoJEAVMuPMTQ89EaQUP/2/BvcclSp6qUZhPMDszG7jZ
jW+0TdsnhP2SX+vemQFfQDmNFK1QTyBR7mUwvaLlO529OqnHg1WYQnApHNG/dGqT
2lpSmMmNeYRBlqGcJV0kb/nIfjPjQIiBdv6qNj9D5pt71OGkrps7SVRbZVVp1Xxz
Gfrnr/h9fi2VISA6QNuq4/+qFwL9xML0PhJJUvnNKBGcsFH2HDg8Pm7PQafxRxtc
AvPZIiXk8ngeCX8TQ3xhAqJiBnEEAHbD61wDwoBYbGcVbJGzP8LRo29fD3yLMnRz
5VfY3uHksV5+VzBtA0YXtZO6oc6OceD2Au+uNTZ3g+kZfplNQ74uDQJq6XrN7job
uptTRFznlsQtjfPJtbisykUJZp/MnsE6bKzuBks4UI31nKhfOVOMu6e56AJLoSIM
V8pO+LfQiHVaP3gCJoxiFX5vs31YFth5uf1jyxxDcY4DAgWNxufppwL1l3L6ueK1
JIXbyJnUTejX3z3rQL4zvBMgm6MKdtavg6JGS6C1FBJq1bzZpPp+DN60u5wzyZHv
rS3YgcWszHzW1xX3R6lscl+gCG6XI+XTXsbt1TttwqpM7nDsqlwAzcZlkKGyes+V
FeAc9BmLEXPb28v9ohjxY2vkUz0oGwxaky3FRcdZScCUKX/lZngISdht/ZDnD3yN
zrTl1R/3xXbmqt02V5nb
=vBtz
-----END PGP SIGNATURE-----

```

---


