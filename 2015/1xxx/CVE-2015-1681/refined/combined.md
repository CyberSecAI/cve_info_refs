=== Content from docs.microsoft.com_ccd1d060_20250125_204655.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2015/ms15-054.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS15-054 - Important

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Vulnerability in Microsoft Management Console File Format Could Allow Denial of Service (3051768)

Published: May 12, 2015

**Version:** 1.0

## Executive Summary

This security update resolves a vulnerability in Microsoft Windows. The vulnerability could allow denial of service if a remote, unauthenticated attacker convinces a user to open a share containing a specially crafted .msc file. However, an attacker would have no way of forcing a user to visit the share or view the file.

This security update is rated Important for all supported editions of Microsoft Windows Vista, Windows Server 2008, Windows 7, Windows Server 2008 R2, Windows 8, Windows Server 2012, Windows RT, Windows 8.1, Windows Server 2012 R2, and Windows RT 8.1. For more information, see the **Affected Software** section.

The security update addresses the vulnerability by correcting how Windows validates the destination buffers in certain scenarios. For more information about the vulnerability, see the **Vulnerability Information** section.

For more information about this update, see [Microsoft Knowledge Base Article 3051768](https://support.microsoft.com/kb/3051768).

## Affected Software

The following software versions or editions are affected. Versions or editions that are not listed are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

| **Operating System** | **Maximum Security Impact** | **Aggregate Severity Rating** | **Updates Replaced** |
| --- | --- | --- | --- |
| **Windows Vista** |  |  |  |
| [Windows Vista Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7e01227d-376c-4812-8f58-5613b28ef9de) (3051768) | Denial of Service | Important | None |
| [Windows Vista x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=41fc63b5-2c22-41d2-ab4e-0bfbb8942934) (3051768) | Denial of Service | Important | None |
| **Windows Server 2008** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=42d6386e-ac67-42e6-bf53-e7af06f53b49) (3051768) | Denial of Service | Important | None |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=0f9e0bd8-96e1-40e4-9ff5-eb5885806307) (3051768) | Denial of Service | Important | None |
| [Windows Server 2008 for Itanium-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=2d1696be-202a-4058-a6d7-18baf7b19461) (3051768) | Denial of Service | Important | None |
| **Windows 7** |  |  |  |
| [Windows 7 for 32-bit Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=80d86b9a-efa5-448e-9b30-3f426090107e) (3051768) | Denial of Service | Important | None |
| [Windows 7 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=ff96f919-b75a-4dcf-8cd0-3e36894c5597) (3051768) | Denial of Service | Important | None |
| **Windows Server 2008 R2** |  |  |  |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=126b3cfd-580f-4aa1-85e7-6a25b56bd2a0) (3051768) | Denial of Service | Important | None |
| [Windows Server 2008 R2 for Itanium-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=5f0e437e-868b-405b-be43-9faa54e669f0) (3051768) | Denial of Service | Important | None |
| **Windows 8 and Windows 8.1** |  |  |  |
| [Windows 8 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=b1752962-04c1-46e4-9c69-ad0a095c2b69) (3051768) | Denial of Service | Important | None |
| [Windows 8 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=f65c4ccd-0f89-409f-ae39-eb9d226ca89c) (3051768) | Denial of Service | Important | None |
| [Windows 8.1 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=6947a50d-35ca-4e0f-963e-ee33834112bd) (3051768) | Denial of Service | Important | None |
| [Windows 8.1 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=7fe62f2c-2aea-445e-b2b9-bd4f31baa7c6) (3051768) | Denial of Service | Important | None |
| **Windows Server 2012 and Windows Server 2012 R2** |  |  |  |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=001d2302-9f3c-4758-b9d3-7af54393ef02) (3051768) | Denial of Service | Important | None |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=b3115e79-37f6-4273-b409-32a340508262) (3051768) | Denial of Service | Important | None |
| **Windows RT and Windows RT 8.1** |  |  |  |
| Windows RT[1](3051768) | Denial of Service | Important | None |
| Windows RT 8.1[1](3051768) | Denial of Service | Important | None |
| **Server Core installation option** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=42d6386e-ac67-42e6-bf53-e7af06f53b49) (Server Core installation) (3051768) | Denial of Service | Important | None |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=0f9e0bd8-96e1-40e4-9ff5-eb5885806307) (Server Core installation) (3051768) | Denial of Service | Important | None |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=126b3cfd-580f-4aa1-85e7-6a25b56bd2a0) (Server Core installation) (3051768) | Denial of Service | Important | None |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=001d2302-9f3c-4758-b9d3-7af54393ef02) (Server Core installation) (3051768) | Denial of Service | Important | None |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=b3115e79-37f6-4273-b409-32a340508262) (Server Core installation) (3051768) | Denial of Service | Important | None |

**Note** The update is available for Windows Technical Preview and Windows Server Technical Preview. Customers running these operating systems are encouraged to apply the update, which is available via Windows Update.

[1]This update is available via [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130) only.

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [May bulletin summary](https://technet.microsoft.com/library/security/ms15-may).

| **Vulnerability Severity Rating and Maximum Security Impact by Affected Software** |  |  |
| --- | --- | --- |
| **Affected Software** | [**Microsoft Management Console File Format Denial of Service Vulnerability - CVE-2015-1681**](https://www.cve.org/CVERecord?id=CVE-2015-1681) | **Aggregate Severity Rating** |
| **Windows Vista** |  |  |
| Windows Vista Service Pack 2 (3051768) | **Important**  Denial of Service | **Important** |
| Windows Vista x64 Edition Service Pack 2 (3051768) | **Important**  Denial of Service | **Important** |
| **Windows Server 2008** |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2008 for x64-based Systems Service Pack 2 (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2008 for Itanium-based Systems Service Pack 2 (3051768) | **Important**  Denial of Service | **Important** |
| **Windows 7** |  |  |
| Windows 7 for 32-bit Systems Service Pack 1 (3051768) | **Important**  Denial of Service | **Important** |
| Windows 7 for x64-based Systems Service Pack 1 (3051768) | **Important**  Denial of Service | **Important** |
| **Windows Server 2008 R2** |  |  |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (3051768) | **Important**  Denial of Service | **Important** |
| **Windows 8 and Windows 8.1** |  |  |
| Windows 8 for 32-bit Systems (3051768) | **Important**  Denial of Service | **Important** |
| Windows 8 for x64-based Systems (3051768) | **Important**  Denial of Service | **Important** |
| Windows 8.1 for 32-bit Systems (3051768) | **Important**  Denial of Service | **Important** |
| Windows 8.1 for x64-based Systems (3051768) | **Important**  Denial of Service | **Important** |
| **Windows Server 2012 and Windows Server 2012 R2** |  |  |
| Windows Server 2012 (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2012 R2 (3051768) | **Important**  Denial of Service | **Important** |
| **Windows RT and Windows RT 8.1** |  |  |
| Windows RT (3051768) | **Important**  Denial of Service | **Important** |
| Windows RT 8.1 (3051768) | **Important**  Denial of Service | **Important** |
| **Server Core installation option** |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2012 (Server Core installation) (3051768) | **Important**  Denial of Service | **Important** |
| Windows Server 2012 R2 (Server Core installation) (3051768) | **Important**  Denial of Service | **Important** |

## Vulnerability Information

## Microsoft Management Console File Format Denial of Service Vulnerability - CVE-2015-1681

A denial of service vulnerability exists when Windows attempts to access a specially crafted .msc file to retrieve the icon information, and then fails to properly validate a destination buffer, resulting in a denial of service. An unauthenticated attacker could exploit this vulnerability by convincing a user to open a share containing a specially crafted .msc file. However, the attacker has no means to force a user to visit the share or view the file.

Servers and workstations are most at risk from this vulnerability. The update addresses the vulnerability by correcting how Windows validates the destination buffers in certain scenarios.

Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was originally issued Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers.

### Mitigating Factors

Microsoft has not identified any [mitigating factors](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### Workaround

The following [workaround](https://technet.microsoft.com/library/security/dn848375.aspx) may be helpful in your situation:

* **Turn off metafile processing by modifying the registry**

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.

  1. Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.
  2. Locate and then click the following registry subkey:

     ```
         HKEY_CLASSES_ROOT\lnkfile\shellex\mscfile

     ```
  3. Click the **File** menu and then click **Export**.
  4. In the **Export Registry File** dialog box, type **MSC\_Icon\_Backup.reg** and then click **Save**.

     **Note** This will create a backup of this registry key in the My Documents folder by default.
  5. In the right pane of the Registry Editor, select the value **(Default)**. Press Enter to edit the value of the key. Delete the value, so that the value is blank, and then press Enter.
  6. Log all users off and on again, or then restart the computer.

  **Impact of workaround.** Disabling icons from displaying for the Microsoft Management Console Snap-in Control (.msc) files prevents the issue from being exploited on affected systems. When this workaround is implemented, the system may display some icons as a "white" default objects.

  **How to undo the workaround.**

  1. Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.
  2. Click the **File** menu and then click **Import**.
  3. In the **Import Registry File** dialog box, select **MSC\_Icon\_Backup.reg**, and then click **Open**.
  4. Exit the Registry Editor.
  5. Restart the computer.

## Security Update Deployment

For Security Update Deployment information, see the Microsoft Knowledge Base article referenced in the Executive Summary.

## Acknowledgments

Microsoft recognizes the efforts of those in the security community who help us protect customers through coordinated vulnerability disclosure. See [Acknowledgments](https://technet.microsoft.com/library/security/dn903755.aspx) for more information.

## Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

## Revisions

* V1.0 (May 12, 2015): Bulletin published.

*Page generated 2015-09-16 10:09Z-07:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


