```
{
  "vulnerability": {
    "root_cause": "The PKIX trust components in Shibboleth Identity Provider and OpenSAML Java trust an X.509 credential even if no trusted names are available for the candidate entityID.",
    "weaknesses": [
      "Improper validation of X.509 certificate names",
      "Insufficient checks in PKIX trust engine"
    ],
    "impact": "An attacker with a certificate issued by a trusted authority can impersonate any entity within the scope of that authority by exploiting the lack of trusted name validation.",
     "attack_vectors": [
       "Man-in-the-middle attack",
       "Impersonation of a service provider"
     ],
    "required_capabilities": [
      "Possession of a certificate issued by a shibmd:KeyAuthority trust anchor",
       "Target entity must lack a KeyName element in its metadata"
     ],
   "additional_details": "The vulnerability occurs in MetadataPKIX trust engines when an entity's metadata lacks a `KeyName` element within its `KeyDescriptor`. This allows an attacker with a valid certificate from a trusted authority to impersonate the entity. Mitigation involves upgrading software or adding `KeyName` elements to metadata. The issue is triggered when a relying party or Identity Provider uses metadata-based PKIX trust engines and a certificate from a trusted authority is presented for an entity that is missing a `KeyName`. Specifically, if the Identity Provider (IdP) has a metadata-based PKIX trust engine enabled, a malicious party that possesses a certificate from one of the configured `shibmd:KeyAuthority` trust anchors may impersonate any entity within the scope of that `shibmd:KeyAuthority` which does not contain at least one `KeyName` within its `RoleDescriptor`'s `KeyDescriptor` element. Mitigation strategies include disabling PKIX trust engines, adding `KeyName` elements, splitting metadata into PKIX and non-PKIX documents, or scoping `KeyAuthority` elements."
  }
}
```