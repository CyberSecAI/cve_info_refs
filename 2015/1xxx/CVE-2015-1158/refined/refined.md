CVE-2015-1158:

- **Root cause of vulnerability**: Incorrect string reference counting in cupsd. When parsing a print job request, cupsd over-decrements the reference count for a string from the request.
- **Weaknesses/vulnerabilities present**: String reference count bug leading to premature freeing of string objects.
- **Impact of exploitation**: An attacker could submit a malicious print job that exploits this flaw to dismantle ACLs protecting privileged operations, allowing a replacement configuration file to be uploaded, which in turn allowed the attacker to run arbitrary code on the CUPS server. Privilege escalation.
- **Attack vectors**: Sending a crafted IPP_CREATE_JOB or IPP_PRINT_JOB request with a multi-value 'job-originating-host-name' attribute.
- **Required attacker capabilities/position**:
    - Ability to send print jobs to the CUPS server (typically requires being on the same network as the CUPS server).
    - To fully exploit the vulnerability, combination with CVE-2015-1159 is needed.
    - Difficult exploitation requiring precise matching of conditions.
    - CUPS web interface has to be listening on a network-reachable port.

CVE-2015-1159:

- **Root cause of vulnerability**: Cross-site scripting (XSS) vulnerability in the CUPS web templating engine. In certain cases, the CGI template can echo user input to file rather than escaping the text first.
- **Weaknesses/vulnerabilities present**: XSS vulnerability in the CUPS web UI.
- **Impact of exploitation**: An attacker could use this flaw to bypass the default configuration settings that bind the CUPS scheduler to the 'localhost' or loopback interface.  Execution of arbitrary javascript in a user's browser.
- **Attack vectors**:  Crafting a QUERY parameter in the web interface help page.
- **Required attacker capabilities/position**:
    - Ability to trigger a user to browse a malicious URL to the CUPS web interface.
    - CUPS web interface has to be enabled.
    - Accessible CUPS web interface.

The Red Hat Bugzilla entry for Bug 1221641 notes the following regarding the exploitability of CVE-2015-1158:
1. Permissions to print on the cups-server are needed.
2. The flaw has to be combined with CVE-2015-1159.
3. Exploitation is difficult and needs exact conditions to be matched.
4. CUPS needs to be listening on a network interface connected to the internet for it to be exploited by the general public.
5. CUPS web interface also needs to be listening on a network-reachable port.

The SUSE bugzilla entry for Bug 924208 lists CVE-2015-1158 and CVE-2015-1159 as privilege escalation via cross-site scripting and bad print job submission used to replace cupsd.conf on server (plus weird ld.so interaction)