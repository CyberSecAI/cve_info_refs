=== Content from android.googlesource.com_865c68df_20250125_201149.html ===
ZGlmZiAtLWdpdCBhL2luY2x1ZGUvbWVkaWEvQXVkaW9FZmZlY3QuaCBiL2luY2x1ZGUvbWVkaWEvQXVkaW9FZmZlY3QuaAppbmRleCA0OTMyZDQwLi41ODM2OTVkIDEwMDY0NAotLS0gYS9pbmNsdWRlL21lZGlhL0F1ZGlvRWZmZWN0LmgKKysrIGIvaW5jbHVkZS9tZWRpYS9BdWRpb0VmZmVjdC5oCkBAIC0xMzMsMTAgKzEzMywxMSBAQAogICAgICAqCiAgICAgICogUmV0dXJuZWQgdmFsdWUKICAgICAgKiAgICpkZXNjcmlwdG9yIHVwZGF0ZWQgd2l0aCBkZXNjcmlwdG9ycyBvZiBwcmUgcHJvY2Vzc2luZ3MgZW5hYmxlZCBieSBkZWZhdWx0Ci0gICAgICogICAqY291bnQgICAgICBudW1iZXIgb2YgZGVzY3JpcHRvcnMgcmV0dXJuZWQgaWYgcmV0dXJuZWQgc3RhdHVzIGlzIE5fRVJST1IuCisgICAgICogICAqY291bnQgICAgICBudW1iZXIgb2YgZGVzY3JpcHRvcnMgcmV0dXJuZWQgaWYgcmV0dXJuZWQgc3RhdHVzIGlzIE5PX0VSUk9SLgogICAgICAqICAgICAgICAgICAgICAgdG90YWwgbnVtYmVyIG9mIHByZSBwcm9jZXNzaW5nIGVuYWJsZWQgYnkgZGVmYXVsdCBpZiByZXR1cm5lZCBzdGF0dXMgaXMKICAgICAgKiAgICAgICAgICAgICAgIE5PX01FTU9SWS4gVGhpcyBoYXBwZW5zIGlmIHRoZSBjb3VudCBwYXNzZWQgYXMgaW5wdXQgaXMgbGVzcyB0aGFuIHRoZSBudW1iZXIKLSAgICAgKiAgICAgICAgICAgICAgIG9mIGRlc2NyaXB0b3JzIHRvIHJldHVybgorICAgICAqICAgICAgICAgICAgICAgb2YgZGVzY3JpcHRvcnMgdG8gcmV0dXJuLgorICAgICAqICAgICAgICAgICAgICAgKmNvdW50IGlzIGxpbWl0ZWQgdG8ga01heFByZVByb2Nlc3Npbmcgb24gcmV0dXJuLgogICAgICAqLwogICAgIHN0YXRpYyBzdGF0dXNfdCBxdWVyeURlZmF1bHRQcmVQcm9jZXNzaW5nKGludCBhdWRpb1Nlc3Npb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWZmZWN0X2Rlc2NyaXB0b3JfdCAqZGVzY3JpcHRvcnMsCkBAIC0zOTEsNiArMzkyLDEwIEBACiAgICAgICAqLwogICAgICBzdGF0aWMgc3RhdHVzX3QgZ3VpZFRvU3RyaW5nKGNvbnN0IGVmZmVjdF91dWlkX3QgKmd1aWQsIGNoYXIgKnN0ciwgc2l6ZV90IG1heExlbik7CiAKKyAgICAgLy8ga01heFByZVByb2Nlc3NpbmcgaXMgYSByZWFzb25hYmxlIHZhbHVlIGZvciB0aGUgbWF4aW11bSBudW1iZXIgb2YgcHJlcHJvY2Vzc2luZyBlZmZlY3RzCisgICAgIC8vIHRoYXQgY2FuIGJlIGFwcGxpZWQgc2ltdWx0YW5lb3VzbHkuCisgICAgIHN0YXRpYyBjb25zdCB1aW50MzJfdCBrTWF4UHJlUHJvY2Vzc2luZyA9IDEwOworCiBwcm90ZWN0ZWQ6CiAgICAgIGJvb2wgICAgICAgICAgICAgICAgICAgIG1FbmFibGVkOyAgICAgICAgICAgLy8gZW5hYmxlIHN0YXRlCiAgICAgIGludDMyX3QgICAgICAgICAgICAgICAgIG1TZXNzaW9uSWQ7ICAgICAgICAgLy8gYXVkaW8gc2Vzc2lvbiBJRApkaWZmIC0tZ2l0IGEvbWVkaWEvbGlibWVkaWEvSUF1ZGlvUG9saWN5U2VydmljZS5jcHAgYi9tZWRpYS9saWJtZWRpYS9JQXVkaW9Qb2xpY3lTZXJ2aWNlLmNwcAppbmRleCAyNTZjYjNmLi4xODBmNWZiIDEwMDY0NAotLS0gYS9tZWRpYS9saWJtZWRpYS9JQXVkaW9Qb2xpY3lTZXJ2aWNlLmNwcAorKysgYi9tZWRpYS9saWJtZWRpYS9JQXVkaW9Qb2xpY3lTZXJ2aWNlLmNwcApAQCAtMjMsNiArMjMsNyBAQAogCiAjaW5jbHVkZSA8YmluZGVyL1BhcmNlbC5oPgogCisjaW5jbHVkZSA8bWVkaWEvQXVkaW9FZmZlY3QuaD4KICNpbmNsdWRlIDxtZWRpYS9JQXVkaW9Qb2xpY3lTZXJ2aWNlLmg+CiAKICNpbmNsdWRlIDxzeXN0ZW0vYXVkaW8uaD4KQEAgLTkxNiwxNiArOTE3LDE4IEBACiAgICAgICAgICAgICBDSEVDS19JTlRFUkZBQ0UoSUF1ZGlvUG9saWN5U2VydmljZSwgZGF0YSwgcmVwbHkpOwogICAgICAgICAgICAgaW50IGF1ZGlvU2Vzc2lvbiA9IGRhdGEucmVhZEludDMyKCk7CiAgICAgICAgICAgICB1aW50MzJfdCBjb3VudCA9IGRhdGEucmVhZEludDMyKCk7CisgICAgICAgICAgICBpZiAoY291bnQgPiBBdWRpb0VmZmVjdDo6a01heFByZVByb2Nlc3NpbmcpIHsKKyAgICAgICAgICAgICAgICBjb3VudCA9IEF1ZGlvRWZmZWN0OjprTWF4UHJlUHJvY2Vzc2luZzsKKyAgICAgICAgICAgIH0KICAgICAgICAgICAgIHVpbnQzMl90IHJldENvdW50ID0gY291bnQ7Ci0gICAgICAgICAgICBlZmZlY3RfZGVzY3JpcHRvcl90ICpkZXNjcmlwdG9ycyA9Ci0gICAgICAgICAgICAgICAgICAgIChlZmZlY3RfZGVzY3JpcHRvcl90ICopbmV3IGNoYXJbY291bnQgKiBzaXplb2YoZWZmZWN0X2Rlc2NyaXB0b3JfdCldOworICAgICAgICAgICAgZWZmZWN0X2Rlc2NyaXB0b3JfdCAqZGVzY3JpcHRvcnMgPSBuZXcgZWZmZWN0X2Rlc2NyaXB0b3JfdFtjb3VudF07CiAgICAgICAgICAgICBzdGF0dXNfdCBzdGF0dXMgPSBxdWVyeURlZmF1bHRQcmVQcm9jZXNzaW5nKGF1ZGlvU2Vzc2lvbiwgZGVzY3JpcHRvcnMsICZyZXRDb3VudCk7CiAgICAgICAgICAgICByZXBseS0+d3JpdGVJbnQzMihzdGF0dXMpOwogICAgICAgICAgICAgaWYgKHN0YXR1cyAhPSBOT19FUlJPUiAmJiBzdGF0dXMgIT0gTk9fTUVNT1JZKSB7CiAgICAgICAgICAgICAgICAgcmV0Q291bnQgPSAwOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgcmVwbHktPndyaXRlSW50MzIocmV0Q291bnQpOwotICAgICAgICAgICAgaWYgKHJldENvdW50KSB7CisgICAgICAgICAgICBpZiAocmV0Q291bnQgIT0gMCkgewogICAgICAgICAgICAgICAgIGlmIChyZXRDb3VudCA8IGNvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgIGNvdW50ID0gcmV0Q291bnQ7CiAgICAgICAgICAgICAgICAgfQo=
