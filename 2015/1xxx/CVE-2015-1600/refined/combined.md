=== Content from isc.sans.edu_b7d4e9ac_20250125_045756.html ===

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Jesse La Grew](/handler_list.html#jesse-la-grew "Jesse La Grew")

Threat Level: [green](/infocon.html)

* [previous](/diary/19323)
* [next](/diary/19331)

My next class:

| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/cyber-security-east-jan-2025/course/application-security-securing-web-apps-api-microservices) | Online | US Eastern | Jan 27th - Feb 1st 2025 |
| --- | --- | --- |

# [Did You Remove That Debug Code? Netatmo Weather Station Sending WPA Passphrase in the Clear](/forums/diary/Did%2BYou%2BRemove%2BThat%2BDebug%2BCode%2BNetatmo%2BWeather%2BStation%2BSending%2BWPA%2BPassphrase%2Bin%2Bthe%2BClear/19327/)

**Published**: 2015-02-12. **Last Updated**: 2015-02-13 11:59:27 UTC

**by** [Johannes Ullrich](https://plus.google.com/101587262224166552564?rel=author) (Version: 1)

[7 comment(s)](/diary/Did%2BYou%2BRemove%2BThat%2BDebug%2BCode%2BNetatmo%2BWeather%2BStation%2BSending%2BWPA%2BPassphrase%2Bin%2Bthe%2BClear/19327/#comments)

(BTW: it looks like the firmware update released this week by netatmo after reporting this issue fixes the problem. Still trying to completely verify that this is the case)

I have the bad habit of playing with home automation and various data acquisition tools. I could quit any time if I wanted to, but so far, I decided not to. My latest toy to add to the collection was a "Netatmo" weather station. It fits in nicely with the aluminum design of my MacBook, so who cares if the manufacturer considered security in its design, as long as it looks cool and is easy to set up.

![](https://isc.sans.edu/diaryimages/images/IMG_1839.JPG)

Setting up the device was pretty straight forward, and looked "secure". It requires connecting to the device via USB, and a custom application is used to configure the device with your username, password and WiFi settings including the WiFi password. After the initial setup, the station needs USB for power only, and communicates via WiFi to the "Cloud".

But after the simple setup, a nice "surprise" waited for me in my snort logs:

 [\*\*] [1:1000284:0] WPA PSK Passphrase Leak [\*\*] [Priority: 0] {TCP} a.b.c.d:21908 -> 195.154.176.41:25050

I do have a custom rule in my snort rule set, alerting me of the passphrase being sent in the clear. Lets just say that it happened before. The rule is very simple:

alert ip any any -> any any ( sid: 1000284; msg: "WPA PSK Passphrase Leak"; content: "[Iamnotgoingtotellyou]"; )

So what happened? After looking at the full capture of the data, I found that indeed the weather station sent my password to "the cloud", along with some other data. The data include the weather stations MAC address, the SSID of the WiFi network, and some hex encoded snippets.

Not only should data like this not be transmitted "in the clear", but in addition, there is no need for Netatmo to know the WPA password for my network.

I reported the problem to Netatmo, and got the following reply:

> Hi,
>
> Indeed at first startup we dump weather station memory for debug purposes, we will not dump it anymore.
> We will remove this debug memory very soon (coming weeks).

So far I haven't seen any additional transmissions from the weather station containing the password, even after restarting it. I didn't do a full factory reset yet. But in general, the data appears to be unencrypted. The MAC address of the station and the outdoor sensor are easily found in the payload. So far, I couldn't find a documentation for the protocol, so it will take a bit more time to reverse it.

According to the weather station map provided by Netatmo, these devices are already quite popuplar. Here a snapshot of the map in my "Neighborhood":

![](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202015-02-12%20at%2012_16_25%20PM.png)

---

Johannes B. Ullrich, Ph.D.

[STI](http://www.sans.edu)|[Twitter](http://jbu.me/164)|[LinkedIn](http://jbu.me/163)

Keywords: [debug](/tag.html?tag=debug) [iot](/tag.html?tag=iot) [netatmo](/tag.html?tag=netatmo)
[7 comment(s)](/diary/Did%2BYou%2BRemove%2BThat%2BDebug%2BCode%2BNetatmo%2BWeather%2BStation%2BSending%2BWPA%2BPassphrase%2Bin%2Bthe%2BClear/19327/#comments)
My next class:

| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/cyber-security-east-jan-2025/course/application-security-securing-web-apps-api-microservices) | Online | US Eastern | Jan 27th - Feb 1st 2025 |
| --- | --- | --- |

* [previous](/diary/19323)
* [next](/diary/19331)

### Comments

So this "High Tech" weather station is still using low tech encryption? Hummm.... Dr. "J" you play with some odd toys! :o
#### Anonymous

#### Feb 13th 20159 years ago

Feb 13 : Netatmo weather stations no longer send debug information at installation time. Thanks for reporting this.
#### Anonymous

#### Feb 13th 20159 years ago

I have this message from Netatmo support after inquiring about this issue:

This morning, at 6:54 AM, EST.

Hi,

Thank you for your email. Netatmo weather stations no longer send debug information at installation time.

Sincerely,

Nathalie - Netatmo

So--they believe it is fixed...
#### Anonymous

#### Feb 13th 20159 years ago

Yes. this has been fixed as of Firmware Version 101 (for the 'indoor module'). CVE-2015-1600 was assigned to this vulnerability. The firmware update will happen automatically without user interaction via Netatmo's cloud service.
#### Anonymous

#### Feb 13th 20159 years ago

Nice catch! I was curious about your snort/ids/security setup. If it's not a secret, it might be great for a topic some rainy day.
#### Anonymous

#### Feb 14th 20159 years ago

Hey, nice find, do you know, if they fixed the unencrypted data transmission as well? (i mean the weather/temp/co2/humidity/noise data)

Thanks
#### Anonymous

#### Nov 22nd 20159 years ago

Has anyone tried to dump the outdoor remote sensor which has the ability to both tx and Rx to do a lateral wifi password grab from the base station?
#### Aquahoodjd

#### Oct 5th 20231 year ago

[Login here to join the discussion.](/login)

Top of page

×

![modal content]()

[Diary Archives](/diaryarchive.html)

* [Homepage](/index.html)
* [Diaries](/diaryarchive.html)
* [Podcasts](/podcast.html)
* [Jobs](/jobs)
* [Data](/data)
  + [TCP/UDP Port Activity](/data/port.html)
  + [Port Trends](/data/trends.html)
  + [SSH/Telnet Scanning Activity](/data/ssh.html)
  + [Weblogs](/weblogs)
  + [Threat Feeds Activity](/data/threatfeed.html)
  + [Threat Feeds Map](/data/threatmap.html)
  + [Useful InfoSec Links](/data/links.html)
  + [Presentations & Papers](/data/presentation.html)
  + [Research Papers](/data/researchpapers.html)
  + [API](/api)
* [Tools](/tools/)
  + [DShield Sensor](/howto.html)
  + [DNS Looking Glass](/tools/dnslookup)
  + [Honeypot (RPi/AWS)](/tools/honeypot)
  + [InfoSec Glossary](/tools/glossary)
* [Contact Us](/contact.html)
  + [Contact Us](/contact.html)
  + [About Us](/about.html)
  + [Handlers](/handler_list.html)* [About Us](/about.html)

[Slack Channel](/slack/index.html)

[Mastodon](https://infosec.exchange/%40sans_isc)

[Bluesky](https://bsky.app/profile/sansisc.bsky.social)

[X](https://twitter.com/sans_isc)

![](/adimg.html?id=)

© 2025 SANS™ Internet Storm Center
Developers: We have an [API](/api/) for you!   [![Creative Commons License](/images/cc.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

* [Link To Us](/linkback.html)
* [About Us](/about.html)
* [Handlers](/handler_list.html)
* [Privacy Policy](/privacy.html)



=== Content from packetstormsecurity.com_06c81751_20250125_045754.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


