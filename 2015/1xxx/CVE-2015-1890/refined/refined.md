- **Root cause of vulnerability**: The `gpfs.snap` tool in IBM General Parallel File System (GPFS) V4.1 inadvertently collects private keys used for TLS communication between GPFS daemons and between GPFS daemons and remote key servers in the generated snap file.
- **Weaknesses/vulnerabilities present**:
    - Private keys are included in the diagnostic data collected by the `gpfs.snap` tool.
    - The generated snap file (a `tar` archive) can be accessed by non-root users if its permissions are modified, allowing access to the private keys within.
- **Impact of exploitation**:
    - An attacker with access to the snap file can obtain the private keys.
    - Using these keys, an attacker can impersonate a GPFS node within the cluster.
    - An attacker can decrypt messages exchanged between legitimate GPFS daemons.
    - Master encryption keys used for file encryption can also be retrieved, potentially leading to data breaches.
- **Attack vectors**:
    - An attacker needs access to a snap file generated by the `gpfs.snap` tool.
    - This access could be obtained through a compromised system or by gaining access to the file system where the snap file is stored.
- **Required attacker capabilities/position**:
    - Attacker needs access to the diagnostic snap file generated by `gpfs.snap` tool.
    - Ability to extract files from the tar archive.
    - The attacker needs to have some privileges to access the snap file, either by being root or through administrative changes to file permissions.