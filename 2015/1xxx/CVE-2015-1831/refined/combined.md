=== Content from struts.apache.org_6c34a893_20250125_132409.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-024)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-024)

[![Apache Struts 2 Wiki](/confluence/images/logo/default-space-logo.svg)](/confluence/display/WW/Home "Apache Struts 2 Wiki")[Apache Struts 2 Wiki](/confluence/display/WW/Home "Apache Struts 2 Wiki")
##### Child pages

* [Security Bulletins](/confluence/display/WW/Security%2BBulletins "Security Bulletins")

* S2-024
Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=56068279 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=56068279)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=56068279)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=WW&openId=56068279#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=56068279)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=56068279)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=56068279)
  + [Export to Word](/confluence/exportword?pageId=56068279)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=56068279)

1. [Pages](/confluence/collector/pages.action?key=WW)- [Home](/confluence/display/WW/Home)- [Security Bulletins](/confluence/display/WW/Security%2BBulletins)

* Jira links
# [S2-024](/confluence/display/WW/S2-024)

* Created by  [Lukasz Lenart](/confluence/display/~lukaszlenart), last modified on [Feb 13, 2021](/confluence/pages/diffpagesbyversion.action?pageId=56068279&selectedPageVersions=6&selectedPageVersions=7 "Show changes")

## Summary

Wrong `excludeParams` overrides those defined in `DefaultExcludedPatternsChecker`

| Who should read this | All Struts 2 developers and users |
| --- | --- |
| Impact of vulnerability | If default settings are used, the attacker can compromise internal state of an application |
| Maximum security rating | Moderate |
| Recommendation | Developers should immediately upgrade to [Struts 2.3.20.1](http://struts.apache.org/download.cgi#struts23201) or introduce the below change in framework's settings |
| Affected Software | Struts 2.3.20 |
| Reporter | Jasper Rosenberg at Cargurus |
| CVE Identifier | CVE-2015-1831 |

## Problem

Wrong default exclude patterns were introduced in version 2.3.20 of Struts, if default settings are used, the attacker can compromise internal application's state.

## Solution

In Struts 2.3.20.1 a better set of exlude patterns was defined.

## Backward compatibility

No backward compatibility problems are expected.

## Workaround

If you cannot migrate to the latest version it's highly recommended to re-define `defaultStack` from `struts-default.xml` to this one below (or any other which is used in your application and drop `excludeParams` parameter):

**Redefined defaultStack**
```
<interceptor-stack name="myDefaultStack">
    <interceptor-ref name="exception"/>
    <interceptor-ref name="alias"/>
    <interceptor-ref name="servletConfig"/>
    <interceptor-ref name="i18n"/>
    <interceptor-ref name="prepare"/>
    <interceptor-ref name="chain"/>
    <interceptor-ref name="scopedModelDriven"/>
    <interceptor-ref name="modelDriven"/>
    <interceptor-ref name="fileUpload"/>
    <interceptor-ref name="checkbox"/>
    <interceptor-ref name="datetime"/>
    <interceptor-ref name="multiselect"/>
    <interceptor-ref name="staticParams"/>
    <interceptor-ref name="actionMappingParams"/>
    <interceptor-ref name="params"/>
    <interceptor-ref name="conversionError"/>
    <interceptor-ref name="validation">
        <param name="excludeMethods">input,back,cancel,browse</param>
    </interceptor-ref>
    <interceptor-ref name="workflow">
        <param name="excludeMethods">input,back,cancel,browse</param>
    </interceptor-ref>
    <interceptor-ref name="debugging"/>
    <interceptor-ref name="deprecation"/>
</interceptor-stack>
```

and define the following constant in `struts.xml`

```
<constant name="struts.additional.excludedPatterns" value="^(action|method):.*"/>
```

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 76, "requestCorrelationId": "585ffdeca5d6fec6"}

