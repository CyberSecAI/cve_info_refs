=== Content from launchpad.net_5a714efc_20250126_075525.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/cpio/2.11-7ubuntu3.2/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[cpio package](https://launchpad.net/ubuntu/%2Bsource/cpio)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/cpio)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/cpio)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/cpio)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/cpio)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/cpio)

# cpio 2.11-7ubuntu3.2 source package in Ubuntu

## Changelog

```
cpio (2.11-7ubuntu3.2) precise-security; urgency=medium

  * SECURITY UPDATE: file overwrite via symlink attack
    - debian/patches/CVE-2015-1197.patch: don't write files over symlinks
      unless --extract-over-symlinks is used in doc/cpio.1, src/copyin.c,
      src/extern.h, src/global.c, src/main.c.
    - CVE-2015-1197
  * SECURITY UPDATE: out-of-bounds write
    - debian/patches/CVE-2016-2037.patch: make sure there is at least two
      bytes available in src/copyin.c, added comment to src/util.c.
    - CVE-2016-2037
  * debian/patches/fix-symlink-test.patch: fix date-sensitive test.

 -- Marc Deslauriers <email address hidden>  Thu, 18 Feb 2016 09:19:26 -0500
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2016-02-18

Uploaded to:
[Precise](/ubuntu/precise)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any

Section:
utils

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Precise](/ubuntu/precise):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9032934)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armel](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9032935)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9032936)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9032937)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9032938)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [cpio\_2.11.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/cpio/2.11-7ubuntu3.2/cpio_2.11.orig.tar.gz) | 1.3 MiB | 58b8f22f34c905d5fbf320f5abb691b1880661f06a78e93058c57060c64a18b6 |
| [cpio\_2.11-7ubuntu3.2.debian.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/cpio/2.11-7ubuntu3.2/cpio_2.11-7ubuntu3.2.debian.tar.gz) | 37.9 KiB | 30b3c732a784e6cc05f124bb9f9110029e27354fa9d7baf3a450da7de5805844 |
| [cpio\_2.11-7ubuntu3.2.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/cpio/2.11-7ubuntu3.2/cpio_2.11-7ubuntu3.2.dsc) | 1.9 KiB | d244022471f22a178374ae2a2a2e06ae03028f6be127cd7ba964399bd66b05a4 |

### Available diffs

* [diff from 2.11-7ubuntu3.1 to 2.11-7ubuntu3.2](http://launchpadlibrarian.net/240368280/cpio_2.11-7ubuntu3.1_2.11-7ubuntu3.2.diff.gz) (3.4 KiB)

[View changes file](http://launchpadlibrarian.net/240368207/cpio_2.11-7ubuntu3.2_source.changes)

## Binary packages built by this source

[cpio](/ubuntu/precise/%2Bpackage/cpio):
GNU cpio -- a program to manage archives of files

GNU cpio is a tool for creating and extracting archives, or copying

 files from one place to another. It handles a number of cpio formats

 as well as reading and writing tar files.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.mandriva.com_6e02b47e_20250125_100223.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.openwall.com_7c831aa9_20250125_100224.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2023/12/26/5) [[next>]](../../../2023/12/28/1) [[thread-next>]](../../../2023/12/29/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <658c0eaf.45f2b459.bm000@oddnet.de>
Date: Wed, 27 Dec 2023 12:46:54 +0100
From: Ingo Brückl <ib@...net.de>
To: oss-security@...ts.openwall.com
Cc: Markus Koschany <apo@...ian.org>
Subject: xarchiver: Path traversal with crafted cpio archives

Hi,

I was alerted by febinrev on GitHub to a vulnerability in xarchiver that
stems from a vulnerability in cpio, which is called by xarchiver to extract
cpio and rpm archives.

It is a path traversal vulnerability with maliciously crafted cpio archives
that affects all cpio versions up to and including 2.12 (see CVE-2015-1197).
The vulnerability has been fixed in cpio 2.13.

However, due to two bug reports (#946267 and #946469), Debian has patched
cpio 2.13 which re-enables the path traversal vulnerability, thus affecting
all distributions that use Debian cpio 2.13 directly or have applied their
"revert-CVE-2015-1197-handling" patch. Debian has been informed and is
working on a security fix.

Instructions from febinrev to craft a cpio archive to demonstrate the
vulnerability:

  mkdir test_cpio
  ln -sf /tmp/ test_cpio/tmp
  echo "TEST Traversal" > test_cpio/tmpYtrav.txt
  cd test_cpio/
  ls | cpio -ov > ../trav.cpio
  cd ../
  sed -i s/"tmpY"/"tmp\/"/g trav.cpio

Even

  cpio -id --no-absolute-filenames -I trav.cpio

doesn't prevent path traversal with affected cpio versions, and such an
archive can be further obfuscated with file extensions such as .rar or
.tar.gz.

Malicious cpio archives that exploit this vulnerability can overwrite files
in locations such as ~/.ssh, ~/.bashrc, ~/.config/autostart/, etc.

In addition to xarchiver, all other GUI front-ends for archive management
that call cpio as a command-line program are most likely also affected!

Ingo

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from advisories.mageia.org_355170ea_20250125_100220.html ===

# [Advisories](index.html) » MGASA-2015-0080

## Updated cpio package fixes security vulnerability

Publication date: 19 Feb 2015

Modification date: 19 Feb 2015

Type: security

Affected Mageia releases :
[4](4.html)

CVE:
[CVE-2014-1197](CVE-2014-1197.html)

## Description

```
In GNU Cpio 2.11, the --no-absolute-filenames option limits extracting
contents of an archive to be strictly inside a current directory. However,
it can be bypassed with symlinks. While extracting an archive, it will
extract symlinks and then follow them if they are referenced in further
entries. This can be exploited by a rogue archive to write files outside
the current directory (CVE-2015-1197).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=15308>
* <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1197>

## SRPMS

### 4/core

* cpio-2.11-6.3.mga4



=== Content from lists.ubuntu.com_be8ed54b_20250126_075524.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from lists.gnu.org_b1eb1e24_20250125_100229.html ===


| | **bug-cpio** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-cpio)

---

[Date Prev][[Date Next](msg00001.html)][Thread Prev][[Thread Next](msg00001.html)][[Date Index](index.html#00000)][[Thread Index](threads.html#00000)]

## [Bug-cpio] cpio: directory traversal vulnerability via symlinks

---

| **From**: | Alexander Cherepanov |
| --- | --- |

| **Subject**: | [Bug-cpio] cpio: directory traversal vulnerability via symlinks |
| **Date**: | Thu, 08 Jan 2015 02:34:44 +0300 |

---

```

Hi!

```
--no-absolute-filenames option seems to be intended to limit extracting
contents of an archive to be strictly inside a current directory (it
guards against both absolute paths and relative paths with .. in them).
However it can be bypassed with symlinks. While extracting an archive,
it will extract symlinks and then follow them if they are referenced in
further entries. This can be exploited by a rogue archive to write files
outside the current directory.
```

For example, let's create a sample archive:

ln -s /tmp dir
touch /tmp/file
echo 'dir
dir/file' | cpio -ov > test.cpio
rm dir /tmp/file

and then test it:

cpio --no-absolute-filenames -iv < test.cpio

```
This will create a symlink "dir" in the current directory and a file
"/tmp/file" by following this symlink.
```

```
BTW why --no-absolute-filenames is not default? In contrast with tar
which is secure by default.
```

--
Alexander Cherepanov

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg00001.html)] |
| --- | --- | --- |

* **[Bug-cpio] cpio: directory traversal vulnerability via symlinks**,
  *Alexander Cherepanov* **<=**
  + **[Re: [Bug-cpio] cpio: directory traversal vulnerability via symlinks](msg00001.html)**, *Alexander Cherepanov*, 2015/01/18

---

* Next by Date:
  **[Re: [Bug-cpio] cpio: directory traversal vulnerability via symlinks](msg00001.html)**
* Next by thread:
  **[Re: [Bug-cpio] cpio: directory traversal vulnerability via symlinks](msg00001.html)**
* Index(es):
  + [**Date**](index.html#00000)
  + [**Thread**](threads.html#00000)



=== Content from www.openwall.com_083ad577_20250125_100224.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[thread-next>]](../../../2024/01/05/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <65846ba9.7d4fbb18.bm000@oddnet.de>
Date: Thu, 21 Dec 2023 17:44:50 +0100
From: Ingo Brückl <ib@...net.de>
To: oss-security@...ts.openwall.com
Subject: Security vulnerability in Debian's cpio 2.13

Debian has applied patch "revert-CVE-2015-1197-handling" to cpio
(2.13+dfsg-7.1) to "Fix a regression in handling of CVE-2015-1197 &
--no-absolute-filenames by reverting part of an upstream commit." and to
close Debian bugs #946267 ("cpio -i --no-absolute-filenames breaks symlinks
starting with / or /..") and #946469 ("initramfs-tools-core: unmkinitrams
creates broken binaries").

This patch made Debian cpio 2.13 vulnerable to path traversal.

The vulnerability has been reported to the Debian bug tracking system:

  <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1059163>

Instructions to craft a cpio archive to demonstrate the vulnerability:

  mkdir test_cpio
  ln -sf /tmp/ test_cpio/tmp
  echo "TEST Traversal" > test_cpio/tmpYtrav.txt
  cd test_cpio/
  ls | cpio -ov > ../trav.cpio
  cd ../
  sed -i s/"tmpY"/"tmp\/"/g trav.cpio

Even

  cpio -id --no-absolute-filenames -I trav.cpio

doesn't prevent path traversal with Debian's cpio, although it does with the
original cpio.

Ingo

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_501931b6_20250126_075522.html ===

# Debian Bug report logs - #774669 cpio: CVE-2015-1197: directory traversal

[![version graph](version.cgi?fixed=cpio%2F2.11%2Bdfsg-4.1;width=2;package=cpio;collapse=1;height=2;found=cpio%2F2.11%2Bdfsg-0.1;absolute=0)](version.cgi?absolute=0;collapse=1;found=cpio%2F2.11%2Bdfsg-0.1;fixed=cpio%2F2.11%2Bdfsg-4.1;package=cpio;info=1)

Package:
[cpio](pkgreport.cgi?package=cpio);
Maintainer for [cpio](pkgreport.cgi?package=cpio) is [Anibal Monsalve Salazar <anibal@debian.org>](pkgreport.cgi?maint=anibal%40debian.org); Source for [cpio](pkgreport.cgi?package=cpio) is [src:cpio](pkgreport.cgi?src=cpio) ([PTS](https://tracker.debian.org/pkg/cpio), [buildd](https://buildd.debian.org/cpio), [popcon](https://qa.debian.org/popcon.php?package=cpio)).

Reported by: [Alexander Cherepanov <cherepan@mccme.ru>](pkgreport.cgi?submitter=cherepan%40mccme.ru)

Date: Mon, 5 Jan 2015 21:54:01 UTC

Severity: normal

Tags: patch, security

Found in version cpio/2.11+dfsg-0.1

Fixed in version cpio/2.11+dfsg-4.1

**Done:** Moritz Muehlenhoff <jmm@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <http://lists.gnu.org/archive/html/bug-cpio>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=774669;mbox=yes), [status mbox](bugreport.cgi?bug=774669;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=774669;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Mon, 05 Jan 2015 21:54:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=2), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

New Bug report received and forwarded. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Mon, 05 Jan 2015 21:54:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=4), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=5), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=cherepan%40mccme.ru)
From: Alexander Cherepanov <cherepan@mccme.ru>
To: submit@bugs.debian.org
Subject: Directory traversal through symlinks
Date: Tue, 06 Jan 2015 00:50:18 +0300
```
Package: cpio
Version: 2.11+dfsg-0.1+deb7u1
Tags: security

cpio is susceptible to a directory traversal vulnerability. While
extracting an archive, it will extract symlinks and then follow them if
they are referenced in further entries. This can be exploited by a rogue
archive to write files outside the current directory.

Example:

1) create a sample archive:

ln -s /tmp dir
echo dir | cpio -oF test.cpio
rm dir
mkdir dir
echo hello > dir/file
echo dir/file | cpio -oAF test.cpio
rm -r dir

2) test it:

cpio --no-absolute-filenames -ivF test.cpio

This will create a symlink "dir" in the current directory and a file
"/tmp/file".

--
Alexander Cherepanov

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Wed, 07 Jan 2015 14:45:05 GMT) ([full text](bugreport.cgi?bug=774669;msg=7), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Vasyl Kaigorodov <vkaigoro@redhat.com>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Wed, 07 Jan 2015 14:45:05 GMT) ([full text](bugreport.cgi?bug=774669;msg=9), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=10), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=vkaigoro%40redhat.com)
From: Vasyl Kaigorodov <vkaigoro@redhat.com>
To: 774669@bugs.debian.org
Subject: Directory traversal through symlinks
Date: Wed, 7 Jan 2015 15:43:54 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=774669;msg=10) (text/plain, inline)]
```
```
Hi Alexander,

My quick test shows that with the proper filesystem permissions no
harm could be done:

$ pwd
/home/vk/cpio
$ ls -lad /home/postgres/
drwx------ 4 postgres postgres 4096 May 21  2014 /home/postgres/
$ ln -s /home/postgres/.mozilla dir
...
$ cpio --no-absolute-filenames -ivF test.cpio
dir
cpio: dir/file: Cannot open: Permission denied
dir/file
1 block

Do you think this is a valid case for a CVE?

--
Vasyl Kaigorodov | Red Hat Product Security
PGP:  0xABB6E828 A7E0 87FF 5AB5 48EB 47D0 2868 217B F9FC ABB6 E828

```
```
[[Message part 2](bugreport.cgi?att=1;bug=774669;msg=10) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Wed, 07 Jan 2015 23:48:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=12), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Wed, 07 Jan 2015 23:48:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=14), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=15), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=cherepan%40mccme.ru)
From: Alexander Cherepanov <cherepan@mccme.ru>
To: bug-cpio@gnu.org
Cc: 774669@bugs.debian.org
Subject: cpio: directory traversal vulnerability via symlinks
Date: Thu, 08 Jan 2015 02:34:44 +0300
```
Hi!

--no-absolute-filenames option seems to be intended to limit extracting
contents of an archive to be strictly inside a current directory (it
guards against both absolute paths and relative paths with .. in them).
However it can be bypassed with symlinks. While extracting an archive,
it will extract symlinks and then follow them if they are referenced in
further entries. This can be exploited by a rogue archive to write files
outside the current directory.

For example, let's create a sample archive:

ln -s /tmp dir
touch /tmp/file
echo 'dir
dir/file' | cpio -ov > test.cpio
rm dir /tmp/file

and then test it:

cpio --no-absolute-filenames -iv < test.cpio

This will create a symlink "dir" in the current directory and a file
"/tmp/file" by following this symlink.

BTW why --no-absolute-filenames is not default? In contrast with tar
which is secure by default.

--
Alexander Cherepanov

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Thu, 08 Jan 2015 00:09:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=17), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Thu, 08 Jan 2015 00:09:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=19), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=20), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=cherepan%40mccme.ru)
From: Alexander Cherepanov <cherepan@mccme.ru>
To: Vasyl Kaigorodov <vkaigoro@redhat.com>
Cc: 774669@bugs.debian.org
Subject: Re: Directory traversal through symlinks
Date: Thu, 08 Jan 2015 03:05:38 +0300
```
Hi Vasyl,

On Wed, 7 Jan 2015 15:43:54 +0100 Vasyl Kaigorodov <vkaigoro@redhat.com>
wrote:
> My quick test shows that with the proper filesystem permissions no
> harm could be done:
>
> $ pwd
> /home/vk/cpio
> $ ls -lad /home/postgres/
> drwx------ 4 postgres postgres 4096 May 21  2014 /home/postgres/
> $ ln -s /home/postgres/.mozilla dir
> ...
> $ cpio --no-absolute-filenames -ivF test.cpio
> dir
> cpio: dir/file: Cannot open: Permission denied
> dir/file
> 1 block

The problem is not that you can bypass filesystem permissions with cpio.
cpio is not setuid or special in any other way. Hence filesystem
permissions protect from it just fine.

The problem is with unpacking untrusted archives (downloaded from the
Web, received by email etc.). If unpacker doesn't protect from directory
traversals extracting contents of a malicious archive could lead to
overwriting sensitive files such as /home/vkaigoro/.ssh/authorized_keys,
i.e. your own files, strictly within filesystem permissions.

> Do you think this is a valid case for a CVE?

Yes.

--
Alexander Cherepanov

```

---

**Marked as found in versions cpio/2.11+dfsg-0.1.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Thu, 08 Jan 2015 00:45:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=22), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=22), [link](#21)).

---

**No longer marked as found in versions cpio/2.11+dfsg-0.1+deb7u1.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Thu, 08 Jan 2015 00:45:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=24), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=24), [link](#23)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Sun, 18 Jan 2015 20:42:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=26), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Sun, 18 Jan 2015 20:42:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=28), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=29), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Alexander Cherepanov <cherepan@mccme.ru>, 774669@bugs.debian.org
Subject: Re: Bug#774669: Directory traversal through symlinks
Date: Sun, 18 Jan 2015 21:39:21 +0100
```
Control: retitle -1 cpio: [CVE-2015-1197](https://security-tracker.debian.org/tracker/CVE-2015-1197): directory traversal

Hi,

This issue has been assigned [CVE-2015-1197](https://security-tracker.debian.org/tracker/CVE-2015-1197) by MITRE.

Regards,
Salvatore

```

---

**Changed Bug title to 'cpio: CVE-2015-1197: directory traversal' from 'Directory traversal through symlinks'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `774669-submit@bugs.debian.org`.
(Sun, 18 Jan 2015 20:42:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=31), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=31), [link](#30)).

---

**Set Bug forwarded-to-address to '<http://lists.gnu.org/archive/html/bug-cpio>'.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Mon, 26 Jan 2015 02:51:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=33), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=33), [link](#32)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Mon, 02 Feb 2015 18:15:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=35), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Mon, 02 Feb 2015 18:15:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=37), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=38), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 774669@bugs.debian.org
Subject: Re: Bug#774669: Directory traversal through symlinks
Date: Mon, 2 Feb 2015 19:12:03 +0100
```
Hi,

Additional reference: SUSE used the patch attached to
<https://marc.info/?l=oss-security&m=142289947619786&w=2>

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Sat, 21 Feb 2015 13:24:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=40), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=40), [link](#39)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Sat, 21 Feb 2015 13:24:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=42), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=42), [link](#41)).

---

[Message #43](#43) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=43), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=43), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 774669@bugs.debian.org
Subject: Re: Bug#774669: Directory traversal through symlinks
Date: Sat, 21 Feb 2015 14:15:38 +0100
```
On Mon, Feb 02, 2015 at 07:12:03PM +0100, Salvatore Bonaccorso wrote:
> Hi,
>
> Additional reference: SUSE used the patch attached to
> <https://marc.info/?l=oss-security&m=142289947619786&w=2>

Anibal, can you please upload a fixed package?

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Thu, 05 Mar 2015 18:15:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=45), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=45), [link](#44)).

---

**Acknowledgement sent**
to `Moritz Mühlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Thu, 05 Mar 2015 18:15:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=47), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=48), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Mühlenhoff <jmm@inutil.org>
To: 774669@bugs.debian.org
Subject: cpio: diff for NMU version 2.11+dfsg-4.1
Date: Thu, 5 Mar 2015 19:11:31 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=774669;msg=48) (text/plain, inline)]
```
```
Control: tags 774669 + patch
Control: tags 774669 + pending

Anibal,
I've prepared an NMU for cpio (versioned as 2.11+dfsg-4.1) and
uploaded it to DELAYED/2. Please feel free to tell me if I
should delay it longer.

Cheers,
        Moritz

```
```
[[cpio-2.11+dfsg-4.1-nmu.diff](bugreport.cgi?att=1;bug=774669;filename=cpio-2.11%2Bdfsg-4.1-nmu.diff;msg=48) (text/x-diff, attachment)]
```

---

**Added tag(s) patch.**
Request was from `Moritz Mühlenhoff <jmm@inutil.org>`
to `774669-submit@bugs.debian.org`.
(Thu, 05 Mar 2015 18:15:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=50), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=50), [link](#49)).

---

**Added tag(s) pending.**
Request was from `Moritz Mühlenhoff <jmm@inutil.org>`
to `774669-submit@bugs.debian.org`.
(Thu, 05 Mar 2015 18:15:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=52), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=52), [link](#51)).

---

**Reply sent**
to `Moritz Muehlenhoff <jmm@debian.org>`:

You have taken responsibility.
(Sat, 07 Mar 2015 18:36:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=54), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=54), [link](#53)).

---

**Notification sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

Bug acknowledged by developer.
(Sat, 07 Mar 2015 18:36:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=56), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=56), [link](#55)).

---

[Message #57](#57) received at 774669-close@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=57), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=57), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40debian.org)
From: Moritz Muehlenhoff <jmm@debian.org>
To: 774669-close@bugs.debian.org
Subject: Bug#774669: fixed in cpio 2.11+dfsg-4.1
Date: Sat, 07 Mar 2015 18:33:37 +0000
```
Source: cpio
Source-Version: 2.11+dfsg-4.1

We believe that the bug you reported is fixed in the latest version of
cpio, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 774669@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Moritz Muehlenhoff <jmm@debian.org> (supplier of updated cpio package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Thu, 05 Mar 2015 11:44:25 +0100
Source: cpio
Binary: cpio cpio-win32
Architecture: source all amd64
Version: 2.11+dfsg-4.1
Distribution: unstable
Urgency: medium
Maintainer: Anibal Monsalve Salazar <anibal@debian.org>
Changed-By: Moritz Muehlenhoff <jmm@debian.org>
Description:
 cpio       - GNU cpio -- a program to manage archives of files
 cpio-win32 - GNU cpio -- a program to manage archives of files (win32 build)
Closes: [774669](bugreport.cgi?bug=774669)
Changes:
 cpio (2.11+dfsg-4.1) unstable; urgency=medium
 .
   * Apply patch by Vitezslav Cizek of SuSE to fix [CVE-2015-1197](https://security-tracker.debian.org/tracker/CVE-2015-1197).
     Upstream is dormant or no longer existing. To restore the old
     behaviour use --extract-over-symlinks (Closes: #[774669](bugreport.cgi?bug=774669))
     This issue has been discovered by Alexander Cherepanov.
Checksums-Sha1:
 b527b273defef077630777c06d25bb1c9b8c8f4d 1849 cpio_2.11+dfsg-4.1.dsc
 6c0dd7b033bc9f4e22918ff329558572f8c30a58 19076 cpio_2.11+dfsg-4.1.debian.tar.xz
 948decc4171afb2878689f44321fefc4d6a40b83 59652 cpio-win32_2.11+dfsg-4.1_all.deb
 e8f80f6d1398c74c24370dd62a6cd0790380509e 176328 cpio_2.11+dfsg-4.1_amd64.deb
Checksums-Sha256:
 7b50bd8b97c4485518bd4439e9ccdc04776c6875700274cfd31673a7a3d75347 1849 cpio_2.11+dfsg-4.1.dsc
 12018c408e4b42c437b11cf77828d8ecfb381c6862349567abc26a1da165dd54 19076 cpio_2.11+dfsg-4.1.debian.tar.xz
 b4b09cad9df06d8b4783d8d44f335e68cc4ff9a5898ace42e7f9986d119f9bbf 59652 cpio-win32_2.11+dfsg-4.1_all.deb
 bb711cb6818d14cd5e140eaec6f2ab9cfb2d6d63fa3bcd9a95eba4e0fb92522d 176328 cpio_2.11+dfsg-4.1_amd64.deb
Files:
 7c649f4a8a4502b2f57484bf3bd70d2e 1849 utils important cpio_2.11+dfsg-4.1.dsc
 04a8fe34d792c08d590e2ff03199be87 19076 utils important cpio_2.11+dfsg-4.1.debian.tar.xz
 5575bbe4447c3c0bae8553e072445602 59652 utils extra cpio-win32_2.11+dfsg-4.1_all.deb
 909a9f456884acfec7349c64ac0168c2 176328 utils important cpio_2.11+dfsg-4.1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJU+D7bAAoJEBDCk7bDfE42kPUP/1d2eYvb0KOO4Xvn9eAhJjeo
+RNlrgtCNG+jCU3RuDZoUtbbkmeitabhiD5IU1+Pgm7luA0jLSsBH4tdOmsYWJNM
GptBzRxO6VHK45rhQNqO1EqYEj7TzdZO4t0VmoM/lF6+fNQt1OHLG/fzAkpbJ0Yv
sWcyJ5JlYPXaqXQUiHr+Fu0+csf3BTYw2Xp4e06KTmoL+Mn1VXuWTMgMfiMMb/Wy
q5FSe3TVeZJXTHfnNHHgls0YUiwEry5suaLODKBCwDqb2bR19uEQXk5Yi/lU6QyF
WWMRCAA9PAT1HSSpFOVVZneLaq3R/uEDxx8m3FH0gt4eOrPYgYw4LHIwCIxeve8w
13UQUNEbzwoPeqOpDPQfeIwluxWptDlVoSJ6RNxAs2Os/oQVBBWYMQ1+3a5bWyEj
5S/hYTHwlK6BOSxwQai6WLgSB9WEqLRK56PcCvYstlF52v1tHmPi9nBoAca3WTHL
RcUCfi6E1zRf/M7B7dJRUwqWOx5kETDeONEq5mUNE5XpFsSNrZApeH+tXivDrq4H
+rKtdwpykQ8dHZWB+xoUyYFQHOBkBUZJmlSAfQk9GFjYBptZRSjrdKxfsHcl/jt6
1cUm4EYvvqo/G5suFtS/aAC4nmZjlcVoQj1ILvWcvXFtShYiU2EOqjWGYGjIRgiJ
jh6k9My6YnuqvVB+oL/7
=xcnc
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 10 Apr 2015 07:27:25 GMT) ([full text](bugreport.cgi?bug=774669;msg=59), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=59), [link](#58)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=774669).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 07:55:21 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from bugs.mageia.org_c67bd935_20250126_075524.html ===


Mageia Bugzilla – Bug 15308
cpio new security issue CVE-2015-1197
Last modified: 2015-02-19 15:43:58 CET

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=15308&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 15308**](show_bug.cgi?id=15308)
- cpio new security issue CVE-2015-1197

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
cpio new security issue CVE-2015-1197

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/633542/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | has\_procedure MGA4-32-OK MGA4-64-OK a... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2015-02-17 16:17 CET by David Walser | | --- | --- | | Modified: | 2015-02-19 15:43 CET ([History](show_activity.cgi?id=15308)) | | CC List: | 3 users (show)  herman.viaene rverschelde sysadmin-bugs | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | cpio-2.11-6.2.mga4.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=15308&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=15308#c0)  David Walser    2015-02-17 16:17:45 CET  ``` Gentoo has issued an advisory on February 15: <http://www.gentoo.org/security/en/glsa/glsa-201502-11.xml>  We fixed CVE-2014-9112 in [Bug 14765](show_bug.cgi?id=14765 "RESOLVED FIXED - cpio new security issue CVE-2014-9112").  Looking at the patch that Gentoo added for this update: <http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/app-arch/cpio/files/cpio-2.11-security.patch?revision=1.1&view=markup>  They fixed that CVE as well as some additional issues that we found in the process of fixing that one, but they didn't actually fix CVE-2015-1197, as their advisory claims.  This is assuming that CVE does actually correspond to this issue: <https://marc.info/?l=oss-security&m=142289947619786&w=2>  as Debian said here: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669#29>  I never saw the CVE-2015-1197 assignment happen on the list.  I can confirm that that issue is *not* fixed by the patches I had added in the previous update, which is the same as what Gentoo added in theirs.  I have actually added the SuSE patch that was mentioned in the oss-security post and Debian bug above, and can confirm that the issue is fixed, via the PoC here: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669#15>  Patched packages uploaded for Mageia 4 and Cauldron.  Advisory: ========================  Updated cpio package fixes security vulnerability:  In GNU Cpio 2.11, the --no-absolute-filenames option limits extracting contents of an archive to be strictly inside a current directory. However, it can be bypassed with symlinks. While extracting an archive, it will extract symlinks and then follow them if they are referenced in further entries. This can be exploited by a rogue archive to write files outside the current directory (CVE-2015-1197).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1197> <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669> ========================  Updated packages in core/updates_testing: ======================== cpio-2.11-6.3.mga4  from cpio-2.11-6.3.mga4.src.rpm  Reproducible:   Steps to Reproduce: ```  David Walser    2015-02-17 16:17:54 CET   Whiteboard: (none) => has\_procedure MGA4-32-OK  [Comment 1](show_bug.cgi?id=15308#c1)  Herman Viaene    2015-02-18 11:35:17 CET  ``` MGA4-64 on HP Probook 6555b KDE No installation issues. Following PoC as above I get at the CLI: [xxx@yyy ~]$ ln -s /tmp dir [xxx@yyy ~]$ touch /tmp/file [xxx@yyyy ~]$ echo 'dir > dir/file' | cpio -ov > test.cpio dir dir/file 1 blok [xxx@yyy ~]$ rm dir /tmp/file rm: remove symbolic link âdirâ? y rm: remove regular empty file â/tmp/fileâ? y [xxx@yyy ~]$ cpio --no-absolute-filenames -iv < test.cpio dir cpio: Can't write over symlinks: dir/file ```  ---   CC: (none) => herman.viaeneWhiteboard: has\_procedure MGA4-32-OK => has\_procedure MGA4-32-OK MGA4-64-OK  [Comment 2](show_bug.cgi?id=15308#c2)  Rémi Verschelde    2015-02-19 12:28:04 CET  ``` Advisory uploaded. ```  ---   CC: (none) => remiWhiteboard: has\_procedure MGA4-32-OK MGA4-64-OK => has\_procedure MGA4-32-OK MGA4-64-OK advisory  [Comment 3](show_bug.cgi?id=15308#c3)  claire robinson    2015-02-19 13:45:32 CET  ``` Validating.  Please push to 4 updates  Thanks ```  ---   Keywords: (none) => validated\_updateCC: (none) => sysadmin-bugs  [Comment 4](show_bug.cgi?id=15308#c4)  Mageia Robot    2015-02-19 15:43:58 CET  ``` An update for this issue has been pushed to Mageia Updates repository.  <http://advisories.mageia.org/MGASA-2015-0080.html> ```  ---   Status: NEW => RESOLVEDResolution: (none) => FIXED |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=15308&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=15308)
* - [XML](show_bug.cgi?ctype=xml&id=15308)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=15308&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=15308&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from packetstormsecurity.com_08b7473f_20250125_100222.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from bugs.debian.org_501931b6_20250125_100229.html ===

# Debian Bug report logs - #774669 cpio: CVE-2015-1197: directory traversal

[![version graph](version.cgi?width=2;collapse=1;fixed=cpio%2F2.11%2Bdfsg-4.1;found=cpio%2F2.11%2Bdfsg-0.1;package=cpio;height=2;absolute=0)](version.cgi?collapse=1;info=1;fixed=cpio%2F2.11%2Bdfsg-4.1;found=cpio%2F2.11%2Bdfsg-0.1;package=cpio;absolute=0)

Package:
[cpio](pkgreport.cgi?package=cpio);
Maintainer for [cpio](pkgreport.cgi?package=cpio) is [Anibal Monsalve Salazar <anibal@debian.org>](pkgreport.cgi?maint=anibal%40debian.org); Source for [cpio](pkgreport.cgi?package=cpio) is [src:cpio](pkgreport.cgi?src=cpio) ([PTS](https://tracker.debian.org/pkg/cpio), [buildd](https://buildd.debian.org/cpio), [popcon](https://qa.debian.org/popcon.php?package=cpio)).

Reported by: [Alexander Cherepanov <cherepan@mccme.ru>](pkgreport.cgi?submitter=cherepan%40mccme.ru)

Date: Mon, 5 Jan 2015 21:54:01 UTC

Severity: normal

Tags: patch, security

Found in version cpio/2.11+dfsg-0.1

Fixed in version cpio/2.11+dfsg-4.1

**Done:** Moritz Muehlenhoff <jmm@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <http://lists.gnu.org/archive/html/bug-cpio>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=774669;mbox=yes), [status mbox](bugreport.cgi?bug=774669;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=774669;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Mon, 05 Jan 2015 21:54:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=2), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

New Bug report received and forwarded. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Mon, 05 Jan 2015 21:54:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=4), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=5), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=cherepan%40mccme.ru)
From: Alexander Cherepanov <cherepan@mccme.ru>
To: submit@bugs.debian.org
Subject: Directory traversal through symlinks
Date: Tue, 06 Jan 2015 00:50:18 +0300
```
Package: cpio
Version: 2.11+dfsg-0.1+deb7u1
Tags: security

cpio is susceptible to a directory traversal vulnerability. While
extracting an archive, it will extract symlinks and then follow them if
they are referenced in further entries. This can be exploited by a rogue
archive to write files outside the current directory.

Example:

1) create a sample archive:

ln -s /tmp dir
echo dir | cpio -oF test.cpio
rm dir
mkdir dir
echo hello > dir/file
echo dir/file | cpio -oAF test.cpio
rm -r dir

2) test it:

cpio --no-absolute-filenames -ivF test.cpio

This will create a symlink "dir" in the current directory and a file
"/tmp/file".

--
Alexander Cherepanov

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Wed, 07 Jan 2015 14:45:05 GMT) ([full text](bugreport.cgi?bug=774669;msg=7), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Vasyl Kaigorodov <vkaigoro@redhat.com>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Wed, 07 Jan 2015 14:45:05 GMT) ([full text](bugreport.cgi?bug=774669;msg=9), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=10), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=vkaigoro%40redhat.com)
From: Vasyl Kaigorodov <vkaigoro@redhat.com>
To: 774669@bugs.debian.org
Subject: Directory traversal through symlinks
Date: Wed, 7 Jan 2015 15:43:54 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=774669;msg=10) (text/plain, inline)]
```
```
Hi Alexander,

My quick test shows that with the proper filesystem permissions no
harm could be done:

$ pwd
/home/vk/cpio
$ ls -lad /home/postgres/
drwx------ 4 postgres postgres 4096 May 21  2014 /home/postgres/
$ ln -s /home/postgres/.mozilla dir
...
$ cpio --no-absolute-filenames -ivF test.cpio
dir
cpio: dir/file: Cannot open: Permission denied
dir/file
1 block

Do you think this is a valid case for a CVE?

--
Vasyl Kaigorodov | Red Hat Product Security
PGP:  0xABB6E828 A7E0 87FF 5AB5 48EB 47D0 2868 217B F9FC ABB6 E828

```
```
[[Message part 2](bugreport.cgi?att=1;bug=774669;msg=10) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Wed, 07 Jan 2015 23:48:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=12), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Wed, 07 Jan 2015 23:48:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=14), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=15), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=cherepan%40mccme.ru)
From: Alexander Cherepanov <cherepan@mccme.ru>
To: bug-cpio@gnu.org
Cc: 774669@bugs.debian.org
Subject: cpio: directory traversal vulnerability via symlinks
Date: Thu, 08 Jan 2015 02:34:44 +0300
```
Hi!

--no-absolute-filenames option seems to be intended to limit extracting
contents of an archive to be strictly inside a current directory (it
guards against both absolute paths and relative paths with .. in them).
However it can be bypassed with symlinks. While extracting an archive,
it will extract symlinks and then follow them if they are referenced in
further entries. This can be exploited by a rogue archive to write files
outside the current directory.

For example, let's create a sample archive:

ln -s /tmp dir
touch /tmp/file
echo 'dir
dir/file' | cpio -ov > test.cpio
rm dir /tmp/file

and then test it:

cpio --no-absolute-filenames -iv < test.cpio

This will create a symlink "dir" in the current directory and a file
"/tmp/file" by following this symlink.

BTW why --no-absolute-filenames is not default? In contrast with tar
which is secure by default.

--
Alexander Cherepanov

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Thu, 08 Jan 2015 00:09:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=17), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Thu, 08 Jan 2015 00:09:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=19), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=20), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=cherepan%40mccme.ru)
From: Alexander Cherepanov <cherepan@mccme.ru>
To: Vasyl Kaigorodov <vkaigoro@redhat.com>
Cc: 774669@bugs.debian.org
Subject: Re: Directory traversal through symlinks
Date: Thu, 08 Jan 2015 03:05:38 +0300
```
Hi Vasyl,

On Wed, 7 Jan 2015 15:43:54 +0100 Vasyl Kaigorodov <vkaigoro@redhat.com>
wrote:
> My quick test shows that with the proper filesystem permissions no
> harm could be done:
>
> $ pwd
> /home/vk/cpio
> $ ls -lad /home/postgres/
> drwx------ 4 postgres postgres 4096 May 21  2014 /home/postgres/
> $ ln -s /home/postgres/.mozilla dir
> ...
> $ cpio --no-absolute-filenames -ivF test.cpio
> dir
> cpio: dir/file: Cannot open: Permission denied
> dir/file
> 1 block

The problem is not that you can bypass filesystem permissions with cpio.
cpio is not setuid or special in any other way. Hence filesystem
permissions protect from it just fine.

The problem is with unpacking untrusted archives (downloaded from the
Web, received by email etc.). If unpacker doesn't protect from directory
traversals extracting contents of a malicious archive could lead to
overwriting sensitive files such as /home/vkaigoro/.ssh/authorized_keys,
i.e. your own files, strictly within filesystem permissions.

> Do you think this is a valid case for a CVE?

Yes.

--
Alexander Cherepanov

```

---

**Marked as found in versions cpio/2.11+dfsg-0.1.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Thu, 08 Jan 2015 00:45:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=22), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=22), [link](#21)).

---

**No longer marked as found in versions cpio/2.11+dfsg-0.1+deb7u1.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Thu, 08 Jan 2015 00:45:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=24), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=24), [link](#23)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Sun, 18 Jan 2015 20:42:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=26), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Sun, 18 Jan 2015 20:42:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=28), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=29), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Alexander Cherepanov <cherepan@mccme.ru>, 774669@bugs.debian.org
Subject: Re: Bug#774669: Directory traversal through symlinks
Date: Sun, 18 Jan 2015 21:39:21 +0100
```
Control: retitle -1 cpio: [CVE-2015-1197](https://security-tracker.debian.org/tracker/CVE-2015-1197): directory traversal

Hi,

This issue has been assigned [CVE-2015-1197](https://security-tracker.debian.org/tracker/CVE-2015-1197) by MITRE.

Regards,
Salvatore

```

---

**Changed Bug title to 'cpio: CVE-2015-1197: directory traversal' from 'Directory traversal through symlinks'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `774669-submit@bugs.debian.org`.
(Sun, 18 Jan 2015 20:42:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=31), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=31), [link](#30)).

---

**Set Bug forwarded-to-address to '<http://lists.gnu.org/archive/html/bug-cpio>'.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Mon, 26 Jan 2015 02:51:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=33), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=33), [link](#32)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Mon, 02 Feb 2015 18:15:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=35), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Mon, 02 Feb 2015 18:15:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=37), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=38), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 774669@bugs.debian.org
Subject: Re: Bug#774669: Directory traversal through symlinks
Date: Mon, 2 Feb 2015 19:12:03 +0100
```
Hi,

Additional reference: SUSE used the patch attached to
<https://marc.info/?l=oss-security&m=142289947619786&w=2>

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Sat, 21 Feb 2015 13:24:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=40), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=40), [link](#39)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Sat, 21 Feb 2015 13:24:04 GMT) ([full text](bugreport.cgi?bug=774669;msg=42), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=42), [link](#41)).

---

[Message #43](#43) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=43), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=43), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 774669@bugs.debian.org
Subject: Re: Bug#774669: Directory traversal through symlinks
Date: Sat, 21 Feb 2015 14:15:38 +0100
```
On Mon, Feb 02, 2015 at 07:12:03PM +0100, Salvatore Bonaccorso wrote:
> Hi,
>
> Additional reference: SUSE used the patch attached to
> <https://marc.info/?l=oss-security&m=142289947619786&w=2>

Anibal, can you please upload a fixed package?

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar <anibal@debian.org>`:

`Bug#774669`; Package `cpio`.
(Thu, 05 Mar 2015 18:15:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=45), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=45), [link](#44)).

---

**Acknowledgement sent**
to `Moritz Mühlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Anibal Monsalve Salazar <anibal@debian.org>`.
(Thu, 05 Mar 2015 18:15:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=47), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 774669@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=48), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Mühlenhoff <jmm@inutil.org>
To: 774669@bugs.debian.org
Subject: cpio: diff for NMU version 2.11+dfsg-4.1
Date: Thu, 5 Mar 2015 19:11:31 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=774669;msg=48) (text/plain, inline)]
```
```
Control: tags 774669 + patch
Control: tags 774669 + pending

Anibal,
I've prepared an NMU for cpio (versioned as 2.11+dfsg-4.1) and
uploaded it to DELAYED/2. Please feel free to tell me if I
should delay it longer.

Cheers,
        Moritz

```
```
[[cpio-2.11+dfsg-4.1-nmu.diff](bugreport.cgi?att=1;bug=774669;filename=cpio-2.11%2Bdfsg-4.1-nmu.diff;msg=48) (text/x-diff, attachment)]
```

---

**Added tag(s) patch.**
Request was from `Moritz Mühlenhoff <jmm@inutil.org>`
to `774669-submit@bugs.debian.org`.
(Thu, 05 Mar 2015 18:15:08 GMT) ([full text](bugreport.cgi?bug=774669;msg=50), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=50), [link](#49)).

---

**Added tag(s) pending.**
Request was from `Moritz Mühlenhoff <jmm@inutil.org>`
to `774669-submit@bugs.debian.org`.
(Thu, 05 Mar 2015 18:15:09 GMT) ([full text](bugreport.cgi?bug=774669;msg=52), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=52), [link](#51)).

---

**Reply sent**
to `Moritz Muehlenhoff <jmm@debian.org>`:

You have taken responsibility.
(Sat, 07 Mar 2015 18:36:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=54), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=54), [link](#53)).

---

**Notification sent**
to `Alexander Cherepanov <cherepan@mccme.ru>`:

Bug acknowledged by developer.
(Sat, 07 Mar 2015 18:36:06 GMT) ([full text](bugreport.cgi?bug=774669;msg=56), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=56), [link](#55)).

---

[Message #57](#57) received at 774669-close@bugs.debian.org ([full text](bugreport.cgi?bug=774669;msg=57), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=57), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40debian.org)
From: Moritz Muehlenhoff <jmm@debian.org>
To: 774669-close@bugs.debian.org
Subject: Bug#774669: fixed in cpio 2.11+dfsg-4.1
Date: Sat, 07 Mar 2015 18:33:37 +0000
```
Source: cpio
Source-Version: 2.11+dfsg-4.1

We believe that the bug you reported is fixed in the latest version of
cpio, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 774669@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Moritz Muehlenhoff <jmm@debian.org> (supplier of updated cpio package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Thu, 05 Mar 2015 11:44:25 +0100
Source: cpio
Binary: cpio cpio-win32
Architecture: source all amd64
Version: 2.11+dfsg-4.1
Distribution: unstable
Urgency: medium
Maintainer: Anibal Monsalve Salazar <anibal@debian.org>
Changed-By: Moritz Muehlenhoff <jmm@debian.org>
Description:
 cpio       - GNU cpio -- a program to manage archives of files
 cpio-win32 - GNU cpio -- a program to manage archives of files (win32 build)
Closes: [774669](bugreport.cgi?bug=774669)
Changes:
 cpio (2.11+dfsg-4.1) unstable; urgency=medium
 .
   * Apply patch by Vitezslav Cizek of SuSE to fix [CVE-2015-1197](https://security-tracker.debian.org/tracker/CVE-2015-1197).
     Upstream is dormant or no longer existing. To restore the old
     behaviour use --extract-over-symlinks (Closes: #[774669](bugreport.cgi?bug=774669))
     This issue has been discovered by Alexander Cherepanov.
Checksums-Sha1:
 b527b273defef077630777c06d25bb1c9b8c8f4d 1849 cpio_2.11+dfsg-4.1.dsc
 6c0dd7b033bc9f4e22918ff329558572f8c30a58 19076 cpio_2.11+dfsg-4.1.debian.tar.xz
 948decc4171afb2878689f44321fefc4d6a40b83 59652 cpio-win32_2.11+dfsg-4.1_all.deb
 e8f80f6d1398c74c24370dd62a6cd0790380509e 176328 cpio_2.11+dfsg-4.1_amd64.deb
Checksums-Sha256:
 7b50bd8b97c4485518bd4439e9ccdc04776c6875700274cfd31673a7a3d75347 1849 cpio_2.11+dfsg-4.1.dsc
 12018c408e4b42c437b11cf77828d8ecfb381c6862349567abc26a1da165dd54 19076 cpio_2.11+dfsg-4.1.debian.tar.xz
 b4b09cad9df06d8b4783d8d44f335e68cc4ff9a5898ace42e7f9986d119f9bbf 59652 cpio-win32_2.11+dfsg-4.1_all.deb
 bb711cb6818d14cd5e140eaec6f2ab9cfb2d6d63fa3bcd9a95eba4e0fb92522d 176328 cpio_2.11+dfsg-4.1_amd64.deb
Files:
 7c649f4a8a4502b2f57484bf3bd70d2e 1849 utils important cpio_2.11+dfsg-4.1.dsc
 04a8fe34d792c08d590e2ff03199be87 19076 utils important cpio_2.11+dfsg-4.1.debian.tar.xz
 5575bbe4447c3c0bae8553e072445602 59652 utils extra cpio-win32_2.11+dfsg-4.1_all.deb
 909a9f456884acfec7349c64ac0168c2 176328 utils important cpio_2.11+dfsg-4.1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJU+D7bAAoJEBDCk7bDfE42kPUP/1d2eYvb0KOO4Xvn9eAhJjeo
+RNlrgtCNG+jCU3RuDZoUtbbkmeitabhiD5IU1+Pgm7luA0jLSsBH4tdOmsYWJNM
GptBzRxO6VHK45rhQNqO1EqYEj7TzdZO4t0VmoM/lF6+fNQt1OHLG/fzAkpbJ0Yv
sWcyJ5JlYPXaqXQUiHr+Fu0+csf3BTYw2Xp4e06KTmoL+Mn1VXuWTMgMfiMMb/Wy
q5FSe3TVeZJXTHfnNHHgls0YUiwEry5suaLODKBCwDqb2bR19uEQXk5Yi/lU6QyF
WWMRCAA9PAT1HSSpFOVVZneLaq3R/uEDxx8m3FH0gt4eOrPYgYw4LHIwCIxeve8w
13UQUNEbzwoPeqOpDPQfeIwluxWptDlVoSJ6RNxAs2Os/oQVBBWYMQ1+3a5bWyEj
5S/hYTHwlK6BOSxwQai6WLgSB9WEqLRK56PcCvYstlF52v1tHmPi9nBoAca3WTHL
RcUCfi6E1zRf/M7B7dJRUwqWOx5kETDeONEq5mUNE5XpFsSNrZApeH+tXivDrq4H
+rKtdwpykQ8dHZWB+xoUyYFQHOBkBUZJmlSAfQk9GFjYBptZRSjrdKxfsHcl/jt6
1cUm4EYvvqo/G5suFtS/aAC4nmZjlcVoQj1ILvWcvXFtShYiU2EOqjWGYGjIRgiJ
jh6k9My6YnuqvVB+oL/7
=xcnc
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 10 Apr 2015 07:27:25 GMT) ([full text](bugreport.cgi?bug=774669;msg=59), [mbox](bugreport.cgi?bug=774669;mbox=yes;msg=59), [link](#58)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=774669).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 10:02:28 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.ubuntu.com_a17dfe4d_20250125_100225.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2906-1: GNU cpio vulnerabilities

22 February 2016

Several security issues were fixed in GNU cpio.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 15.10](/security/notices?release=wily)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [cpio](/security/cves?package=cpio) - a tool to manage archives of files

## Details

Alexander Cherepanov discovered that GNU cpio incorrectly handled symbolic

links when used with the --no-absolute-filenames option. If a user or

automated system were tricked into extracting a specially-crafted cpio

archive, a remote attacker could possibly use this issue to write arbitrary

files. This issue only affected Ubuntu 12.04 LTS and Ubuntu 14.04 LTS.

([CVE-2015-1197](/security/CVE-2015-1197))

Gustavo Grieco discovered that GNU cpio incorrectly handled memory when

extracting archive files. If a user or automated system were tricked into

extracting a specially-crafted cpio archive, a remote attacker could use

this issue to cause GNU cpio to crash, resulting in a denial of service, or

possibly execute arbitrary code. ([CVE-2016-2037](/security/CVE-2016-2037))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 15.10

* [cpio](https://launchpad.net/ubuntu/%2Bsource/cpio)
  -
  [2.11+dfsg-4.1ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/cpio/2.11%2Bdfsg-4.1ubuntu1.1)

##### Ubuntu 14.04

* [cpio](https://launchpad.net/ubuntu/%2Bsource/cpio)
  -
  [2.11+dfsg-1ubuntu1.2](https://launchpad.net/ubuntu/%2Bsource/cpio/2.11%2Bdfsg-1ubuntu1.2)

##### Ubuntu 12.04

* [cpio](https://launchpad.net/ubuntu/%2Bsource/cpio)
  -
  [2.11-7ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/cpio/2.11-7ubuntu3.2)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2015-1197](/security/CVE-2015-1197)
* [CVE-2016-2037](/security/CVE-2016-2037)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from security-tracker.debian.org_6cc5f076_20250126_075524.html ===

# CVE-2015-1197

| **Name** | CVE-2015-1197 |
| --- | --- |
| **Description** | cpio 2.11, when using the --no-absolute-filenames option, allows local users to write to arbitrary files via a symlink attack on a file in an archive. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-1197) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-1197); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-1197), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-1197), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-1197), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-1197), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-1197), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-1197), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-1197), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-1197)/[CVE](https://www.suse.com/security/cve/CVE-2015-1197/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-1197)/[code](https://github.com/search?type=Code&q=%22CVE-2015-1197%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-1197%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-1197%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [774669](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [cpio](/tracker/source-package/cpio) ([PTS](https://tracker.debian.org/pkg/cpio)) | bullseye | 2.13+dfsg-7.1~deb11u1 | fixed |
|  | bookworm | 2.13+dfsg-7.1 | fixed |
|  | sid, trixie | 2.15+dfsg-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [cpio](/tracker/source-package/cpio) | source | (unstable) | 2.11+dfsg-4.1 | low |  | [774669](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669) |

## Notes

```
[wheezy] - cpio <no-dsa> (Minor issue)
[squeeze] - cpio <no-dsa> (Minor issue)
Patch used in SUSE: <https://bugzilla.suse.com/attachment.cgi?id=599460&action=diff>
<https://git.savannah.gnu.org/cgit/cpio.git/commit/?id=45b0ee2b407913c533f7ded8d6f8cbeec16ff6ca>
Regression in upstream's handling of patch <https://bugs.debian.org/946267>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.openwall.com_7f1bfd02_20250125_100223.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2015/01/16/8) [[thread-next>]](../../../2015/02/02/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Pine.LNX.4.64.1501181515270.14308@beijing.mitre.org>
Date: Sun, 18 Jan 2015 15:25:14 -0500 (EST)
From: cve-assign@...re.org
To: Alexander Cherepanov <ch3root@...nwall.com>
cc: oss-security@...ts.openwall.com, cve-assign@...re.org
Subject: Re: CVE Request: cpio -- directory traversal

On Fri, 16 Jan 2015, Alexander Cherepanov wrote:

> Hi!
>
> cpio is susceptible to a directory traversal vulnerability via symlinks.
>
> Initial report:
> <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774669>
>
> Upstream report:
> <https://lists.gnu.org/archive/html/bug-cpio/2015-01/msg00000.html>
>
> Some discussion:
> <http://www.openwall.com/lists/oss-security/2015/01/07/5>
> <http://www.openwall.com/lists/oss-security/2015/01/08/4>
>
> Could CVE(s) please be assigned?
>
> --
> Alexander Cherepanov

Use CVE-2015-1197.

---

CVE assignment team, MITRE CVE Numbering Authority M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_9eb39673_20250125_100223.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2015/01/08/1) [[thread-next>]](../../../2015/01/08/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54ADC49F.1000800@mccme.ru>
Date: Thu, 08 Jan 2015 02:43:27 +0300
From: Alexander Cherepanov <cherepan@...me.ru>
To: oss-security@...ts.openwall.com
Subject: Directory traversals in cpio and friends?

Hi!

I've taken a look at how dir traversals are dealt with in several
implementations of tar and cpio. The picture is kinda strange.

First of all, I believe it's usually agreed that archivers must not
touch files outside the current directory by default. Is there an
authoritative link for this?

Then, it seems there are 3 main ways to exploit dir traversals in
through archives:

1) via absolute paths, the column 'abs' below;

2) via relative paths with '..', the column 'rel' below;

3) via symlinks to directories, the column 'link' below.

Software:

1) GNU tar and cpio, called 'tar' and 'cpio' below, tested versions from
Debian jessie and git head;

2) BSD tar and cpio (based on libarchive), called 'bsdtar' and 'bsdcpio'
below, tested versions from Debian jessie and git head;

3) OpenBSD-derived(?) pax, with tools called 'paxtar', 'paxcpio' and
'pax' below, tested versions from Debian jessie and FreeBSD
10.0-RELEASE-p12.

The results of tests of tar and cpio archives against various commands
follow. '=' means that the corresponding file is not extracted, 'x'
means that it is extracted. IMHO secure configuration should list three
'=', insecure configuration should list three 'x', everything else is
inconsistent. The list created by the attached scripts.

=== tar ===
abs     rel     link    cmd
=       =       =       tar -x
x       x       x       tar -x -P
=       =       =       bsdtar -x
x       x       x       bsdtar -x -P
=       x       x       paxtar -x
x       x       x       paxtar -x -P
x       x       x       pax -r

=== cpio ===
abs     rel     link    cmd
x       x       x       cpio -i
=       =       x       cpio -i --no-absolute-filenames
x       =       =       bsdcpio -i
x       x       x       bsdcpio -i --insecure
x       x       x       paxcpio -i

tar and bsdtar are ok. Good. But not much.

Question 1. Perhaps there are some reasons why all cpio variants (unlike
tar) extract files with absolute paths by default?

Question 2. BSD folks which are behind pax* tools don't consider
directory traversal a vulnerability, do they?

The only 'x' in the line for `cpio -i --no-absolute-filenames` seems to
be a clear vuln. Reported here: <https://bugs.debian.org/774669> and now
sent to upstream ml.

--
Alexander Cherepanov

View attachment "[test-tar-1.sh.txt](5/1)" of type "text/plain" (713 bytes)

View attachment "[test-tar-all.sh.txt](5/2)" of type "text/plain" (428 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


