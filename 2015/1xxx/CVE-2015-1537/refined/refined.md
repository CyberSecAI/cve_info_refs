- **Root cause of vulnerability:** Integer overflow when calculating the buffer size for `malloc`. The code previously calculated `bufSize` as `2 * size` without checking for potential integer overflows. If `size` was a large value, multiplying it by 2 could cause an integer overflow, resulting in a smaller-than-expected value for `bufSize`.  This would lead to a heap buffer overflow when writing to the allocated memory with `data.read()`.
- **Weaknesses/vulnerabilities present:** Integer overflow leading to a heap buffer overflow vulnerability.
- **Impact of exploitation:** A heap buffer overflow could lead to arbitrary code execution.
- **Attack vectors:** Sending a crafted size value via the Binder interface to `IHDCP::onTransact()` using the `HDCP_ENCRYPT` or `HDCP_DECRYPT` cases would trigger the vulnerability.
- **Required attacker capabilities/position:** An attacker needs to be able to send specially crafted messages via the Binder interface to trigger the vulnerability. This may require an attacker to have local access to the device.