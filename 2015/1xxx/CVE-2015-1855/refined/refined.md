```
{
  "CVE_data_meta": {
    "ASSIGNER": "cve@mitre.org",
    "ID": "CVE-2015-1855",
    "STATE": "PUBLIC"
  },
  "affects": {
    "vendor": {
      "vendor_data": []
    }
  },
  "data_format": "MITRE",
  "data_type": "CVE",
  "data_version": "4.0",
  "description": {
    "description_data": [
      {
        "lang": "en",
        "value": "The Ruby OpenSSL extension did not properly implement hostname matching, in violation of RFC 6125. This could allow remote attackers to perform a man-in-the-middle attack via crafted SSL certificates."
      }
    ]
  },
  "problemtype": {
    "problemtype_data": [
      {
        "description": [
          {
            "lang": "en",
            "value": "Improper Certificate Validation"
          }
        ]
      }
    ]
  },
  "references": {
    "reference_data": [
      {
        "refsource": "MISC",
        "name": "https://www.ruby-lang.org/en/news/2015/04/13/ruby-openssl-hostname-verification-vulnerability/",
        "url": "https://www.ruby-lang.org/en/news/2015/04/13/ruby-openssl-hostname-verification-vulnerability/"
      },
        {
            "refsource": "MISC",
            "name": "https://bugzilla.mozilla.org/show_bug.cgi?id=903885",
            "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=903885"
        },
         {
            "refsource": "MISC",
            "name": "https://bugs.python.org/issue17997",
             "url": "https://bugs.python.org/issue17997"
        },
      {
        "refsource": "MISC",
        "name": "https://www.debian.org/security/2015/dsa-3245",
        "url": "https://www.debian.org/security/2015/dsa-3245"
      },
         {
            "refsource": "MISC",
            "name": "https://www.debian.org/security/2015/dsa-3246",
            "url": "https://www.debian.org/security/2015/dsa-3246"
        },
         {
            "refsource": "MISC",
             "name":"https://www.debian.org/security/2015/dsa-3247",
            "url": "https://www.debian.org/security/2015/dsa-3247"
         },
        {
            "refsource": "MISC",
            "name": "https://tools.ietf.org/html/rfc6125",
             "url": "https://tools.ietf.org/html/rfc6125"
        },
        {
         "refsource": "MISC",
         "name": "https://tools.ietf.org/html/rfc5280",
          "url": "https://tools.ietf.org/html/rfc5280"
         },
        {
         "refsource": "MISC",
         "name": "https://bugs.ruby-lang.org/issues/9644",
         "url": "https://bugs.ruby-lang.org/issues/9644"
        }
    ]
  },
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
             "scope": "UNCHANGED",
             "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "version": "3.1"
        }
    },
  "source": {
    "discovery": "EXTERNAL"
  },
"work_around": "Upgrade to the patched version of ruby"
}
```
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:** The vulnerability stems from the Ruby OpenSSL extension's incorrect implementation of hostname matching, specifically concerning wildcard certificates and internationalized domain names (IDNA). The implementation did not fully adhere to the stricter matching rules defined in RFC 6125 and RFC 5280.

**Weaknesses/Vulnerabilities:**

*   **Overly Permissive Wildcard Matching:** The Ruby OpenSSL extension allowed for wildcard characters (`*`) in positions other than the leftmost part of the hostname, which is not compliant with RFC 6125. For example, it would match `www.*.foo.bar` or `www.*.*.*`, which are invalid according to the RFC. Additionally, the implementation was doing a global string replacement with `[^.]+`, allowing multiple wildcards.
*   **Improper IDNA Handling:** The code did not properly handle IDNA labels, leading to false positive matches with wildcard rules. Substring wildcards were incorrectly matching IDN A-label fragments.
*   **Inconsistent Protocol Handling:** The hostname verification was using the same logic for HTTP, SMTP, IMAP and POP, even though RFC standards specify different verification schemes for different protocols.

**Impact of Exploitation:**
*   **Man-in-the-Middle (MitM) Attacks:** An attacker could exploit this vulnerability to perform MitM attacks. By crafting a malicious SSL certificate with carefully constructed wildcard patterns and/or IDNA names, the attacker could impersonate a legitimate server to an unsuspecting client that relies on the vulnerable Ruby implementation for hostname verification.

**Attack Vectors:**
*   **Network-based:** The attack would be network-based, requiring an attacker to intercept and manipulate the network traffic between a client and a server.

**Required Attacker Capabilities/Position:**
*   **Network Interception:** The attacker needs to be in a position to intercept and modify network traffic (i.e., be "in the middle" of the communication).
*   **Malicious Certificate Creation:** The attacker must be able to create a malicious SSL certificate with a crafted hostname, exploiting the vulnerability.
* **No User Interaction Required:** This attack does not require user interaction.

**Additional details:**

*   The vulnerability was also found and fixed in other languages, such as Python (CVE-2013-2099, related to [bug 17997](https://bugs.python.org/issue17997)) and Mozilla's NSS library (CVE-2014-1492, related to [bug 903885](https://bugzilla.mozilla.org/show_bug.cgi?id=903885)).
*   The fix involved implementing stricter string-based matching algorithm that is compliant with RFC 6125 and RFC 5280, including case-insensitive comparisons. The fix also limits wildcard characters to one in the left-most part of the hostname and requires subject/SAN to be limited to ASCII characters.
*   The bug was initially discovered by a Perl developer, Steffen Ullrich, while comparing the wildcard matching rules in different programming languages.
*   Patches to address the issue were developed by Tony Arcieri and Hiroshi Nakamura and backported to Ruby 1.8, 1.9, 2.0, and 2.1.
*   The issue was assigned CVE-2015-1855 and fixed by Ruby team (commit r50292), and included in Debian security updates (DSA-3245-1, DSA-3246-1, DSA-3247-1) for versions 1.8, 1.9, and 2.1.