```
{
  "cveId": "CVE-2015-1336",
  "description": "The daily mandb cleanup job in Man-db before 2.7.6.1-1 as packaged in Ubuntu and Debian allows local users with access to the man account to gain privileges via vectors involving insecure chown use.",
  "vulnerabilityDetails": {
    "rootCause": "The daily mandb cleanup job for old catman pages changes the permissions of all non-man files to user man using `find` and `chown`. This process is vulnerable to a Time-of-Check-Time-of-Use (TOCTOU) race condition.",
    "weaknesses": [
      "TOCTOU race condition",
      "Insecure use of chown in a cron job",
      "Lack of proper permission checks by PAM/shadow utils"
    ],
    "impact": "A local user with access to the 'man' account can escalate privileges to root. By exploiting the race condition, the attacker can change the ownership of critical system files, such as /etc/shadow, allowing password modification and root access.",
    "attackVectors": "The attack involves creating a hard link to a system file (not owned by the `man` user) within the `/var/cache/man` directory. The cron job's `find` command identifies files not owned by user man and then `chown` is used to change the ownership to the `man` user. By winning the race condition, attacker changes the ownership of target system files.",
    "requiredCapabilities": "The attacker needs to have local access to a 'man' account and the ability to create hard links. The attacker must also be able to execute code as the 'man' user in order to exploit the race condition."
  },
    "affectedSystems":[
        "man-db versions prior to 2.7.6.1-1 on Ubuntu and Debian",
        "Ubuntu 16.04 LTS"
    ],
  "additionalNotes": "The vulnerability is caused by a combination of insecure cron job implementation, setgid-root directories, and lack of proper file permission checks. The fix involves changing the ownership of cache files and directories to man:man, making man and mandb setgid man as well as setuid man, and removing the recursive chown from the cron job. Additionally, PAM/shadow should verify the permissions on /etc/shadow and other related files."
}
```