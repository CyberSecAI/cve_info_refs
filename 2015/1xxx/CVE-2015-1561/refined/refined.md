```
{
  "Root cause": "The vulnerability lies in the `getStats.php` file, where user-supplied GET parameters are not properly sanitized before being used in a command executed by `popen()`. Specifically, the `escape_command()` function only removes backslashes, dollar signs, and backticks, while the `filter_get()` function only matches alphanumeric characters, underscores, hyphens, percent signs, and spaces. The code also splits GET parameters by semicolons, taking only the first part, before filtering. It does not prevent other characters such as '|' from being passed in as a parameter, which can be used for command injection.",
  "Weaknesses": [
    "Insufficient input sanitization of GET parameters used in shell commands.",
    "Inadequate escaping of special characters in shell commands.",
    "Use of `popen()` with unsanitized user input."
  ],
  "Impact": "Arbitrary command execution on the server, potentially leading to complete system compromise.",
  "Attack vectors": "By crafting a malicious GET request with specially crafted parameters, an attacker can inject commands into the command executed by `popen()`.",
   "Required attacker capabilities/position": "The attacker needs to be able to send HTTP requests to the vulnerable `getStats.php` script, meaning network access to the server."
}
```