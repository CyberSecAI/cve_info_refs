Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2015-1494:

**Root Cause of Vulnerability:**

The root cause is a lack of sufficient sanitization of user-supplied input within the "FancyBox for WordPress" plugin. Specifically, the plugin did not properly sanitize user input when processing the `mfbfw` parameter in a POST request, which is then used to update plugin options in the WordPress database.

**Weaknesses/Vulnerabilities Present:**

*   **Persistent Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS issue. Malicious code injected via the vulnerable `mfbfw` parameter is stored in the database and executed when the plugin settings page is viewed by an administrator.
*   **Insecure Handling of User Input:** The plugin uses `stripslashes_deep` and `array_map` with `convert_chars` which are not sufficient to prevent the injection of malicious scripts.

**Impact of Exploitation:**

*   **Arbitrary JavaScript Execution:** An attacker can inject malicious JavaScript code into the plugin settings.
*   **Website Compromise:** When an administrator views the plugin's options page, the injected JavaScript will execute within the administrator's browser, potentially leading to:
    *   **Session Hijacking:** Stealing administrator session cookies.
    *   **Arbitrary Actions:** Performing unauthorized actions within the WordPress admin panel, such as creating new admin users or modifying site settings.
    *   **Malware Injection:** Redirecting users to malicious websites or injecting further malware.
*   **Malware Distribution:** The vulnerability was actively exploited to inject an iframe redirecting to a malicious domain.

**Attack Vectors:**

*   **HTTP POST Request:** The attack vector is an HTTP POST request to the `wp-admin/admin-post.php` endpoint, specifically targeting the "FancyBox for WordPress" plugin settings page.
*   **`mfbfw` Parameter:** The malicious payload is injected through the `mfbfw` parameter.
*   **No Authentication Check:** It is noted that the `admin-post.php` endpoint does not properly validate that the user is logged in, allowing unauthenticated requests to trigger the vulnerable code path.

**Required Attacker Capabilities/Position:**

*   **No Prior Authentication:** The attacker does not need to be logged into WordPress to exploit the vulnerability, they need only to craft a specific POST request.
*   **Knowledge of Plugin Settings:** The attacker needs knowledge of the vulnerable `mfbfw` parameter.
*   **Ability to Send HTTP Requests:** The attacker needs to send a crafted HTTP POST request to the vulnerable endpoint.

**Additional Notes:**

*   The vulnerability was actively exploited, leading to widespread compromise of WordPress websites.
*   The plugin was temporarily removed from the WordPress plugin repository, but a patched version (3.0.3) was released to address the issue. Version 3.0.4 further mitigated the impact by renaming the vulnerable setting.
*   The injected malware was observed to redirect users to the `203koko.eu` domain via an iframe.
*   The issue was reported by mickaelb, with a fix provided by Konstantin Kovshenin.

The provided content gives a more detailed and specific picture of how the vulnerability was exploited and its impact than the generic CVE description.