=== Content from bugs.debian.org_ea037bcb_20250124_230350.html ===

# Debian Bug report logs - #590670 insecure setuid usage, local root exploit

[![version graph](version.cgi?collapse=1;width=2;found=hsolink%2F1.0.118-3;height=2;absolute=0;package=hsolink)](version.cgi?package=hsolink;absolute=0;info=1;found=hsolink%2F1.0.118-3;collapse=1)

Package:
[hsolink](pkgreport.cgi?package=hsolink);
Maintainer for [hsolink](pkgreport.cgi?package=hsolink) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Thijs Kinkhorst <thijs@debian.org>](pkgreport.cgi?submitter=thijs%40debian.org)

Date: Wed, 28 Jul 2010 11:12:02 UTC

Severity: *critical*

Tags: security

Found in version hsolink/1.0.118-3

**Done:** Moritz Muehlenhoff <jmm@inutil.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=590670;mbox=yes), [status mbox](bugreport.cgi?bug=590670;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=590670;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Debian QA Group <packages@qa.debian.org>`:

`Bug#590670`; Package `hsolink`.
(Wed, 28 Jul 2010 11:12:05 GMT) ([full text](bugreport.cgi?bug=590670;msg=2), [mbox](bugreport.cgi?bug=590670;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Thijs Kinkhorst <thijs@debian.org>`:

New Bug report received and forwarded. Copy sent to `Debian QA Group <packages@qa.debian.org>`.
(Wed, 28 Jul 2010 11:12:05 GMT) ([full text](bugreport.cgi?bug=590670;msg=4), [mbox](bugreport.cgi?bug=590670;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=590670;msg=5), [mbox](bugreport.cgi?bug=590670;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: submit@bugs.debian.org
Subject: insecure setuid usage, local root exploit
Date: Wed, 28 Jul 2010 13:09:06 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=590670;msg=5) (text/plain, inline)]
```
```
Package: hsolink
Version: 1.0.118-3
Severity: critical
Tags: security

Hi,

Following was reported by Christian Jaeger.

----------

hsolink-1.0.118 contains a binary hsolinkcontrol that is setuid root.
The binary

- neither sets PATH
- nor fixes other environment variables
- nor checks commandline arguments
- but uses system(3)
(- and may be overflowing fixed-size buffers as well, I didn't check anymore)

and thus is a trivial target to get root, for example:

(I've tested from the files in an ar-unpacked .deb instead of
installing the deb, to avoid exposing my system. Note: apparently the
binary has to be at root-owned paths or the Linux kernel will ignore
the setuid bit.)

novo:~/chris# l -a
total 12
-rwsr-xr-x  1 root root  7072 2010-07-09 22:20 hsolinkcontrol
drwxr-x---  2 root chris   80 2010-07-09 22:55 .
drwxr-xr-x 50 root root  4272 2010-07-09 22:55 ..

chris@novo:/root/chris$ ./hsolinkcontrol down '; bash'
Using resolvconf.
root@novo:/root/chris# id
uid=0(root) gid=1000(chris) groups=.....

The setuid recommendation is coming from the upstream author
(<http://www.pharscape.org/hsolinkcontrol.html>), who apparently is not
aware of the implications of the setuid bit, and good security in
general as evidenced by the problems I've listed above. I have not
informed him of the problem [yet].

I don't know about the right solution; maybe using sudo instead of
setuit and adding commandline argument checking and replacing system
calls with fork/exec* calls. Or, to be safer, instead rather turn it
into a daemon. Iff it needs to be run as ordinary users at all--I'm
used to have to run "pon" as root, for example, the charge to enable a
normal user to run hsolinkcontrol (or the program that uses it) as
root (by setting up sudo, for example) could possibly just be left to
the user (I can't say as I haven't used the program yet).

----------

Debian has assigned [CVE-2010-1671](https://security-tracker.debian.org/tracker/CVE-2010-1671) to this issue.

Cheers,
Thijs

```
```
[[signature.asc](bugreport.cgi?att=1;bug=590670;filename=signature.asc;msg=5) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

You have taken responsibility.
(Thu, 29 Jul 2010 21:51:04 GMT) ([full text](bugreport.cgi?bug=590670;msg=7), [mbox](bugreport.cgi?bug=590670;mbox=yes;msg=7), [link](#6)).

---

**Notification sent**
to `Thijs Kinkhorst <thijs@debian.org>`:

Bug acknowledged by developer.
(Thu, 29 Jul 2010 21:51:04 GMT) ([full text](bugreport.cgi?bug=590670;msg=9), [mbox](bugreport.cgi?bug=590670;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 590670-done@bugs.debian.org ([full text](bugreport.cgi?bug=590670;msg=10), [mbox](bugreport.cgi?bug=590670;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Thijs Kinkhorst <thijs@debian.org>
Cc: 590670-done@bugs.debian.org
Subject: Re: insecure setuid usage, local root exploit
Date: Thu, 29 Jul 2010 17:46:00 -0400
```
On Wed, Jul 28, 2010 at 01:09:06PM +0200, Thijs Kinkhorst wrote:
> Package: hsolink
> Version: 1.0.118-3
> Severity: critical
> Tags: security
>
> Hi,
>
> Following was reported by Christian Jaeger.
>
> ----------
>
> hsolink-1.0.118 contains a binary hsolinkcontrol that is setuid root.
> The binary

I have filed a removal bug and hsolink has been removed (#590751).

Closing the bug.

Cheers,
        Moritz

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 27 Aug 2010 07:36:36 GMT) ([full text](bugreport.cgi?bug=590670;msg=12), [mbox](bugreport.cgi?bug=590670;mbox=yes;msg=12), [link](#11)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=590670).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 23:03:50 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


