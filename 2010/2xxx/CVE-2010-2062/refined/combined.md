=== Content from dzcore.wordpress.com_37579fcc_20250126_091546.html ===

# [DZCORE](https://dzcore.wordpress.com/)

Open Source & Computer Security

* [Home](https://dzcore.wordpress.com/)
* [About](https://dzcore.wordpress.com/about/)
* [Advisories](https://dzcore.wordpress.com/advisories/)

## [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow

hello

I have published a security advisory for Mplayer and VLC: [[DZC-2009-001]](https://sites.google.com/site/dzcore/misc/dzcore-2009-001-advisory.txt)

Advisory blog post:

Advisory:

The Movie Player and VLC Media Player Real Data Transport

parsing integer underflow.

Affected products:

The Movie player <= svn r29446 [1]

VLC media player <= 1.0.0 [2]

Possible others applications that use the xine lib code [3].

Discovred by:

tixxDZ

DZCORE Labs, Algeria

Date reported:

2009/07/25

Release Date:

2009/07/27

Solutions:

VLC: update to VLC media player 1.0.1 [2] [4].

Mplayer: update to svn r29447.

———

Abstract:

———

Mplayer

Source file: stream/realrtsp/real.c

function: int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, char \*\*buffer, int rdt\_rawdata)

VLC

Source file: modules/access/rtsp/real.c

function: int real\_get\_rdt\_chunk\_header(rtsp\_client\_t \*rtsp\_session, rmff\_pheader\_t \*ph)

The original code is part of the xine library [3]:

Source file: src/input/libreal/real.c

function:  int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer)

Function real\_get\_rdt\_chunk() calls rtsp\_read\_data() to read RDT (Real Data Transport) chunks headers from the network and after that it will parse them.

A controled variable is used to allocate a buffer and later passed on to the rtsp\_read\_data() function in order to specify the length of an RDT chunk data to read from the network.

An integer underflow can be triggered when parsing a malformed RDT header chunk, a remote attacker can exploit it to execute arbitrary code in the context of the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the xio\_rw\_abort() funcion (file: src/xine-engine/io\_helper.c), which takes the length of an RDT packet as an off\_t type and performs some comparison checks (line: 350) before reading chunks from the network.

The Movie player [1] and the VLC media player [2] are vulnerable, the length of an RDT packet is passed as an unsigned int to their own network read functions.

———–

Descripton:

———–

xine-lib source file: src/input/libreal/real.c

int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer) {

int n=1;

uint8\_t header[8];

rmff\_pheader\_t ph;

int size;

int flags1;

int unknown1;

uint32\_t ts;

n=rtsp\_read\_data(rtsp\_session, header, 8);

if (n<8) return 0;

if (header[0] != 0x24)

{

lprintf(“rdt chunk not recognized: got 0x%02x\n”, header[0]);

return 0;

}

size=(header[1]<<16)+(header[2]<<8)+(header[3]); **/\* [1] \*/**

flags1=header[4];

if ((flags1!=0x40)&&(flags1!=0x42))

{

lprintf(“got flags1: 0x%02x\n”,flags1);

if (header[6]==0x06)

{

lprintf(“got end of stream packet\n”);

return 0;

}

…

size-=9; **/\* [2] \*/**

}

unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);

n=rtsp\_read\_data(rtsp\_session, header, 6);

if (n<6) return 0;

ts=\_X\_BE\_32(header);

lprintf(“ts: %u size: %u, flags: 0x%02x, unknown values: %u

0x%02x 0x%02x\n”,

ts, size, flags1, unknown1, header[4], header[5]);

size+=2; **/\* [3] \*/**

ph->object\_version=0;

ph->length=size; **/\* [4] \*/**

ph->stream\_number=(flags1>>1)&1;

ph->timestamp=ts;

ph->reserved=0;

ph->flags=0; /\* TODO: determine keyframe flag and insert here? \*/

xine\_buffer\_ensure\_size(\*buffer, 12+size); **/\* [5] \*/**

rmff\_dump\_pheader(&ph, \*buffer);

size-=12; **/\* [6] \*/**

n=rtsp\_read\_data(rtsp\_session, (\*buffer)+12, size); **/\* [7] \*/**

return (n <= 0) ? 0 : n+12;

}

**[1]** The signed int size variable is filled with data from the network.

**[2] [3]** Some arithmetics operations, we assume that at the end size == 11.

**[4]** The value of the size variable is assigned to the ph->length.

**[5]** The size variable is used to allocate (realloc) space for the buffer.

**[6]** An integer underflow is triggered, size == 0xffffffff.

**[7]** The size variable is passed to the rtsp\_read\_data() function as an

unsigned integer in order to specify the length of an RDT packet.

Mplayer:

Mplayer is vulnerable, the rtsp\_read\_data() function passes the

length to the read\_stream() function (file: stream/librtsp/rtsp.c) as

a size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

VLC:

VLC is vulnerable, the real\_get\_rdt\_chunk\_header() function will read

and parse the header, the vulnerable call to the rtsp\_read\_data()

function is made by the real\_get\_rdt\_chunk() function, the length is

passed to the \_\_net\_Read() function (file: src/network/io.c) as a

size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

——–

Patches:

——–

VLC

Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer

Official patch by the Mplayer team, please update svn to revision 29447.

———–

References:

———–

[1] <http://www.mplayerhq.hu/>

[2] <http://www.videolan.org/>

[3] <http://www.xine-project.org/>

[4] <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>

c08674676e209afa842053aca

———–

Disclaimer:

———–

The document is provided as is without warranty of any kind. The content

may change without notice. In no event shall the author be liable for any

special, direct or indirect damages, losses or unlawful offences.

Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

#end

PS: the [original Advisory](http://archives.neohapsis.com/archives/bugtraq/2009-07/0198.html) published on bugtraq contains an unofficial patch of mine to the Mplayer, however the Mplayer Team responded quickly and a patch is available, please update to svn revision 29447.

PS: the VideoLan team had already corrected the bug and normally the VLC version 1.0.1 will be available soon.

**EDIT:**

**[5]** Allocating (realloc) memory for the buffer (memory size: 12 + 11 bytes)

**[6]** Integer underflow, size == -1 == 0xffffffff

**[7]** The size variable is used as an unsigned integer to read data from the network, please see the conversion table below:

* 32bit signed int max value:  2147483647 (0x7fffffff)
* 32bit signed int min value:   -2147483648 (0x80000000)
* 32bit unsigned int max value:  4294967295 (0xffffffff)
* 32bit unsigned int min value:   0

so if we are dealing with an unsigned int the value -1 will be converted to 4294967295 and in this case the network function will try to read 4GB of data into the buffer.

### Share this:

* [Facebook](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=facebook "Click to share on Facebook")
* [X](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Monday, July 27th, 2009 at 8:42 pm and is filed under [Advisories](https://dzcore.wordpress.com/category/advisories/). You can follow any responses to this entry through the [RSS 2.0](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/feed/) feed.
You can [leave a response](#respond), or [trackback](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/trackback/) from your own site.

### Post navigation

[Next Post »](https://dzcore.wordpress.com/2011/01/19/new-home/)

### 20 Responses to *[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow*

1. [FreeFoxTV (butterflyoffire) 's status on Tuesday, 28-Jul-09 08:20:23 UTC - Identi.ca](http://identi.ca/notice/7133249) says:
   [July 28, 2009 at 8:20 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-2)

   […] [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow … […]

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=2#respond)
3. [ButterflyOfFire](http://www.freefoxtv.net) says:
   [July 28, 2009 at 8:29 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-3)

   Thanks tixxDZ, I’ll send a notification through identi.ca.

   Ihope that a patch will be released soon ;)

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=3#respond)
   * tixxdz says:
     [July 28, 2009 at 11:06 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-5)

     salam ButterflyOfFire,

     VLC patch at <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834c08674676e209afa842053aca>

     Mplayer patch: update svn to revision 29447.

     New Releases: ??

     thx.

     [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=5#respond)
5. [zendyani](http://www.webmaster-dz.com) says:
   [July 28, 2009 at 12:06 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-6)

   bon courage a toi tixxdz, jolie travail.

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=6#respond)
7. [secdz](http://secdz.blogspot.com) says:
   [July 28, 2009 at 8:21 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-7)

   J’ai pas encore lu le billet …je veux juste te féliciter pour le nouveau blog …enfin :)

   Je reviendrais pour apprendre de ton billet

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=7#respond)
9. [Amar De Annaba](http://amarannaba.wordpress.com) says:
   [July 28, 2009 at 11:03 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-8)

   Un petit blog pour l’homme mais un grand pas pour les human being !!! :-)

   Bon courage !!!

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=8#respond)
11. Rama says:
    [July 29, 2009 at 3:04 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-9)

    It’s very enjoying to know someone (algerian) trying the adventure in the shakespeare’s way!

    i’m a real dummy in security but I see that you’re an expert and you really know what you’re talking about!

    anyway, you’re already caught in my reader! :D

    congratulation for the rocket’s launching as said KT! :D hope reading you very soon!

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=9#respond)
13. tixxdz says:
    [July 29, 2009 at 12:29 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-10)

    thx for all your comments and please see the EDIT to clarify the conversion issues.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=10#respond)
15. hnawelhik says:
    [July 29, 2009 at 6:05 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-11)

    je vais posé une question un peut naïve, mais vous parlez de quoi? entre programmation et anglais je suis perdu.

    salamalikom

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=11#respond)
    * tixxdz says:
      [August 1, 2009 at 12:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-13)

      salam, désolé hnawelhik pour le retard, je suis lhik maintenant (douar sans connection).

      oui effectivement le sujet parle de programmation, vulnérabilité … etc en anglais.

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=13#respond)
17. [barabas](http://pwncafe.wordpress.com/) says:
    [October 5, 2009 at 5:09 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-22)

    nice work…keep it up

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=22#respond)
    * tixxdz says:
      [October 8, 2009 at 11:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-24)

      thx barabas and nice to see you here

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=24#respond)
19. Xuphanc says:
    [July 3, 2010 at 1:26 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-26)

    Hey..

    I’ve seen before the RTSP and SSA support vuln through my debuging system..LOL, It seem A nice to make a POC,I think that the new versoion has not yet fixed the integer underflow in Real pseudo-RTSP module? Any way congrtatulation weld bladi..I m so happy to hear/t ;) good new about you..Inchallah more and more..

    Keep doing..

    /Xuphanc.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=26#respond)
21. Jugurtha Hadjar says:
    [December 11, 2010 at 12:03 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-28)

    J’étais en train de regarder une vidéo [La présentation de Fyodor au Defcon18, Nmap Scripting Engine] .. Il y avait un certain “nfs-ls”…

    J’ai vu le nom de l’auteur, qui sonnait plutôt familier.. A Google query later.. ça a donné des échanges archivés des mailing lists, avec le co-auteur, ainsi que ce blog.

    Intéressant :)

    Bookmarked of course.

    Keep it up,

    USTHB.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=28#respond)
23. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](http://007software.net/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 6, 2015 at 3:30 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-44)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=44#respond)
25. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](http://extracheesy.net/news/2015/01/07/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 7, 2015 at 11:16 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-46)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=46#respond)
27. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 « ECI Blog @WordPress](https://ecinetworks.wordpress.com/2015/01/10/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-47)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=47#respond)
29. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-48)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=48#respond)
31. [(SB15-005) Vulnerability Summary for the Week of December 29, 2014 | ECI Networks](http://ecinetworks.com/?p=2463) says:
    [February 14, 2015 at 8:42 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-52)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=52#respond)
33. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](http://www.isecurestuff.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [February 23, 2015 at 10:18 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-54)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=54#respond)

### Leave a reply to [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](#comment-46) [Cancel reply](/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#respond)

Δ

* Search
* ## DZCORE

  + [Code](https://sites.google.com/site/dzcore/code/)
  + [Advisories](https://dzcore.wordpress.com/advisories/)
  + [About](https://dzcore.wordpress.com/about/)
* ## Algerian Blogs

  + [Agence84 Technologies](http://www.agence84.com/blog/ "Agence84 Technologies Web & Mobile Blog")
  + [Amar De Annaba](http://amarannaba.wordpress.com/ "Amar Super Blog")
  + [Bikora Questions/Réponses](http://bikora.com)
  + [FreeFoxTV](http://www.freefoxtv.net/ "ButterflyOfFire blog")
  + [Gineblog](http://gineblog.olympe-network.com/ "Gineblog")
  + [KT Algerie](http://ktalgerie.blogspot.com/ "KT Algerie blog")
  + [Youknowriad](http://youknowriad.nomade-dz.com/ "Youknowriad Blog")
* ## Algerian Open Source Blogs

  + [InalGnu == Open source](http://inalgnu.nomade-dz.com/ "InalGnu Blog")
  + [Le Blog De Amarsoft](http://amarsoftdz.blogspot.com/ "Amarsoft blog")
  + [Le bric-à-brac](http://lebricabrac.wordpress.com/ "Havoc Blog")
  + [Tuxargon Open Source Power](http://pressenux.tuxfamily.org/ "Tuxargon blog")
  + [Ubuntu Algérie](http://ubuntu-algerie.blogspot.com/)
* ## Algerian Security Blogs

  + [Hack your mind](http://www.webmaster-dz.com/ "Hack your mind")
  + [InfoSecDz](http://infosecdz.blogspot.com/ "infosecdz blog")
  + [IT & Security in Algeria](http://secdz.blogspot.com/ "secdz blog")
  + [Th3 Under9rond Rev0Lut!oN](http://hors-sujets.blogspot.com/ "Th3 Under9rond Rev0Lut!oN Blog")
* ## Archives

  + [January 2011](https://dzcore.wordpress.com/2011/01/)
  + [July 2009](https://dzcore.wordpress.com/2009/07/)
* ## Categories

  + [Advisories](https://dzcore.wordpress.com/category/advisories/)
  + [Uncategorized](https://dzcore.wordpress.com/category/uncategorized/)

* [Comment](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pxpYP-k)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/)
  + [View post in Reader](https://wordpress.com/read/blogs/7964695/posts/20)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from seclists.org_b43da489_20250125_141019.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](417)
[By Date](date.html#418)
[![Next](/images/right-icon-16x16.png)](419)

[![Previous](/images/left-icon-16x16.png)](417)
[By Thread](index.html#418)
[![Next](/images/right-icon-16x16.png)](419)

![](/shared/images/nst-icons.svg#search)

# [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow.

---

*From*: tixxDZ <tixxdz () gmail com>

*Date*: Mon, 27 Jul 2009 17:32:35 +0100

---

```
Advisory:
       The Movie Player and VLC Media Player Real Data Transport
       parsing integer underflow.

Affected products:
       The Movie player svn r29438 [1]
       VLC media player <= 1.0.0 [2]
       Possible others applications that use the xine lib code [3].

Discovred by:
       tixxDZ <tixxdz at gmail dot com>
       DZCORE Labs, Algeria

Date reported:
       2009/07/25

Release Date:
       2009/07/27

Solutions:
       VLC: update to VLC media player 1.0.1 [2] [4].
       Mplayer: please see Patches section.

---------
Abstract:
---------

Mplayer
Source file:    stream/realrtsp/real.c
function:       int real_get_rdt_chunk(rtsp_t *rtsp_session,
                                      char **buffer,
                                      int rdt_rawdata)

VLC
Source file:    modules/access/rtsp/real.c
function:       int real_get_rdt_chunk_header(rtsp_client_t *rtsp_session,
                                             rmff_pheader_t *ph)

The original code is part of the xine library [3]:
Source file:    src/input/libreal/real.c
function:       int real_get_rdt_chunk(rtsp_t *rtsp_session,
                                      unsigned char **buffer)

Function real_get_rdt_chunk() calls rtsp_read_data() to read RDT
(Real Data Transport) chunks headers from the network and after that it will
parse them.
A controled variable is used to allocate a buffer and later passed on to the
rtsp_read_data() function in order to specify the length of an RDT chunk
data to read from the network.
An integer underflow can be triggered when parsing a malformed RDT header chunk,
a remote attacker can exploit it to execute arbitrary code in the context of
the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the
xio_rw_abort() funcion (file: src/xine-engine/io_helper.c), which takes the
length of an RDT packet as an off_t type and performs some comparison checks
(line: 350) before reading chunks from the network.
The Movie player [1] and the VLC media player [2] are vulnerable, the length
of an RDT packet is passed as an unsigned int to their own network read
functions.

-----------
Descripton:
-----------
xine-lib source file:   src/input/libreal/real.c

int real_get_rdt_chunk(rtsp_t *rtsp_session, unsigned char **buffer) {

       int n=1;
       uint8_t header[8];
       rmff_pheader_t ph;
       int size;
       int flags1;
       int unknown1;
       uint32_t ts;

       n=rtsp_read_data(rtsp_session, header, 8);
       if (n<8) return 0;
       if (header[0] != 0x24)
       {
               lprintf("rdt chunk not recognized: got 0x%02x\n", header[0]);
               return 0;
       }
[1]     size=(header[1]<<16)+(header[2]<<8)+(header[3]);
       flags1=header[4];
       if ((flags1!=0x40)&&(flags1!=0x42))
       {
               lprintf("got flags1: 0x%02x\n",flags1);
               if (header[6]==0x06)
               {
                       lprintf("got end of stream packet\n");
                       return 0;
               }
               ...
[2]             size-=9;
       }
       unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);
       n=rtsp_read_data(rtsp_session, header, 6);
       if (n<6) return 0;
       ts=_X_BE_32(header);

       lprintf("ts: %u size: %u, flags: 0x%02x, unknown values: %u
0x%02x 0x%02x\n",
               ts, size, flags1, unknown1, header[4], header[5]);

[3]     size+=2;
       ph->object_version=0;
[4]     ph->length=size;
       ph->stream_number=(flags1>>1)&1;
       ph->timestamp=ts;
       ph->reserved=0;
       ph->flags=0;      /* TODO: determine keyframe flag and insert here? */
[5]     xine_buffer_ensure_size(*buffer, 12+size);
       rmff_dump_pheader(&ph, *buffer);
[6]     size-=12;
[7]     n=rtsp_read_data(rtsp_session, (*buffer)+12, size);

       return (n <= 0) ? 0 : n+12;
}

[1]     The signed int size variable is filled with data from the network.

[2] [3] Some arithmetics operations, we assume that at the end size == 11.

[4]     The value of the size variable is assigned to the ph->length.

[5]     The size variable is used to allocate (realloc) space for the buffer.

[6]     An integer underflow is triggered, size == 0xffffffff.

[7]     The size variable is passed to the rtsp_read_data() function as an
       unsigned integer in order to specify the length of an RDT packet.

       Mplayer:
       Mplayer is vulnerable, the rtsp_read_data() function passes the length
       to the read_stream() function (file: stream/librtsp/rtsp.c) as a size_t
       type which can lead to read a big amount of data from the network and
       cause a heap overflow.

       VLC:
       VLC is vulnerable, the real_get_rdt_chunk_header() function will read
       and parse the header, the vulnerable call to the rtsp_read_data()
       function is made by the real_get_rdt_chunk() function, the length is
       passed to the __net_Read() function (file: src/network/io.c) as a
       size_t type which can lead to read a big amount of data from the
       network and cause a heap overflow.

--------
Patches:
--------

VLC
Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer
Unofficial patch by tixxDZ

diff -Naur stream/realrtsp/real.c stream/realrtsp/real.c.new
--- stream/realrtsp/real.c      2009-07-27 01:09:18.000000000 +0100
+++ stream/realrtsp/real.c.new  2009-07-27 01:12:35.000000000 +0100
@@ -386,6 +386,7 @@
    return (n <= 0) ? 0 : n;
  }
  rmff_dump_pheader(&ph, *buffer);
+  if (size<12) return 0;
  size-=12;
  n=rtsp_read_data(rtsp_session, (*buffer)+12, size);

-----------
References:
-----------

[1]     <http://www.mplayerhq.hu/>
[2]     <http://www.videolan.org/>
[3]     <http://www.xine-project.org/>
[4]     <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>
       c08674676e209afa842053aca

-----------
Disclaimer:
-----------

The document is provided as is without warranty of any kind. The content
may change without notice. In no event shall the author be liable for any
special, direct or indirect damages, losses or unlawful offences.
Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

--
tix or tixxDZ

```

**Attachment:
[dzcore-2009-001-advisory.txt](att-418/dzcore-2009-001-advisory.txt)**

*Description:*

```
_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](417)
[By Date](date.html#418)
[![Next](/images/right-icon-16x16.png)](419)

[![Previous](/images/left-icon-16x16.png)](417)
[By Thread](index.html#418)
[![Next](/images/right-icon-16x16.png)](419)

### Current thread:

* **[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow.** *tixxDZ (Jul 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from dzcore.wordpress.com_a3b68ea8_20250126_091546.html ===

# [DZCORE](https://dzcore.wordpress.com/)

Open Source & Computer Security

* [Home](https://dzcore.wordpress.com/)
* [About](https://dzcore.wordpress.com/about/)
* [Advisories](https://dzcore.wordpress.com/advisories/)

## [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow

hello

I have published a security advisory for Mplayer and VLC: [[DZC-2009-001]](https://sites.google.com/site/dzcore/misc/dzcore-2009-001-advisory.txt)

Advisory blog post:

Advisory:

The Movie Player and VLC Media Player Real Data Transport

parsing integer underflow.

Affected products:

The Movie player <= svn r29446 [1]

VLC media player <= 1.0.0 [2]

Possible others applications that use the xine lib code [3].

Discovred by:

tixxDZ

DZCORE Labs, Algeria

Date reported:

2009/07/25

Release Date:

2009/07/27

Solutions:

VLC: update to VLC media player 1.0.1 [2] [4].

Mplayer: update to svn r29447.

———

Abstract:

———

Mplayer

Source file: stream/realrtsp/real.c

function: int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, char \*\*buffer, int rdt\_rawdata)

VLC

Source file: modules/access/rtsp/real.c

function: int real\_get\_rdt\_chunk\_header(rtsp\_client\_t \*rtsp\_session, rmff\_pheader\_t \*ph)

The original code is part of the xine library [3]:

Source file: src/input/libreal/real.c

function:  int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer)

Function real\_get\_rdt\_chunk() calls rtsp\_read\_data() to read RDT (Real Data Transport) chunks headers from the network and after that it will parse them.

A controled variable is used to allocate a buffer and later passed on to the rtsp\_read\_data() function in order to specify the length of an RDT chunk data to read from the network.

An integer underflow can be triggered when parsing a malformed RDT header chunk, a remote attacker can exploit it to execute arbitrary code in the context of the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the xio\_rw\_abort() funcion (file: src/xine-engine/io\_helper.c), which takes the length of an RDT packet as an off\_t type and performs some comparison checks (line: 350) before reading chunks from the network.

The Movie player [1] and the VLC media player [2] are vulnerable, the length of an RDT packet is passed as an unsigned int to their own network read functions.

———–

Descripton:

———–

xine-lib source file: src/input/libreal/real.c

int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer) {

int n=1;

uint8\_t header[8];

rmff\_pheader\_t ph;

int size;

int flags1;

int unknown1;

uint32\_t ts;

n=rtsp\_read\_data(rtsp\_session, header, 8);

if (n<8) return 0;

if (header[0] != 0x24)

{

lprintf(“rdt chunk not recognized: got 0x%02x\n”, header[0]);

return 0;

}

size=(header[1]<<16)+(header[2]<<8)+(header[3]); **/\* [1] \*/**

flags1=header[4];

if ((flags1!=0x40)&&(flags1!=0x42))

{

lprintf(“got flags1: 0x%02x\n”,flags1);

if (header[6]==0x06)

{

lprintf(“got end of stream packet\n”);

return 0;

}

…

size-=9; **/\* [2] \*/**

}

unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);

n=rtsp\_read\_data(rtsp\_session, header, 6);

if (n<6) return 0;

ts=\_X\_BE\_32(header);

lprintf(“ts: %u size: %u, flags: 0x%02x, unknown values: %u

0x%02x 0x%02x\n”,

ts, size, flags1, unknown1, header[4], header[5]);

size+=2; **/\* [3] \*/**

ph->object\_version=0;

ph->length=size; **/\* [4] \*/**

ph->stream\_number=(flags1>>1)&1;

ph->timestamp=ts;

ph->reserved=0;

ph->flags=0; /\* TODO: determine keyframe flag and insert here? \*/

xine\_buffer\_ensure\_size(\*buffer, 12+size); **/\* [5] \*/**

rmff\_dump\_pheader(&ph, \*buffer);

size-=12; **/\* [6] \*/**

n=rtsp\_read\_data(rtsp\_session, (\*buffer)+12, size); **/\* [7] \*/**

return (n <= 0) ? 0 : n+12;

}

**[1]** The signed int size variable is filled with data from the network.

**[2] [3]** Some arithmetics operations, we assume that at the end size == 11.

**[4]** The value of the size variable is assigned to the ph->length.

**[5]** The size variable is used to allocate (realloc) space for the buffer.

**[6]** An integer underflow is triggered, size == 0xffffffff.

**[7]** The size variable is passed to the rtsp\_read\_data() function as an

unsigned integer in order to specify the length of an RDT packet.

Mplayer:

Mplayer is vulnerable, the rtsp\_read\_data() function passes the

length to the read\_stream() function (file: stream/librtsp/rtsp.c) as

a size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

VLC:

VLC is vulnerable, the real\_get\_rdt\_chunk\_header() function will read

and parse the header, the vulnerable call to the rtsp\_read\_data()

function is made by the real\_get\_rdt\_chunk() function, the length is

passed to the \_\_net\_Read() function (file: src/network/io.c) as a

size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

——–

Patches:

——–

VLC

Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer

Official patch by the Mplayer team, please update svn to revision 29447.

———–

References:

———–

[1] <http://www.mplayerhq.hu/>

[2] <http://www.videolan.org/>

[3] <http://www.xine-project.org/>

[4] <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>

c08674676e209afa842053aca

———–

Disclaimer:

———–

The document is provided as is without warranty of any kind. The content

may change without notice. In no event shall the author be liable for any

special, direct or indirect damages, losses or unlawful offences.

Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

#end

PS: the [original Advisory](http://archives.neohapsis.com/archives/bugtraq/2009-07/0198.html) published on bugtraq contains an unofficial patch of mine to the Mplayer, however the Mplayer Team responded quickly and a patch is available, please update to svn revision 29447.

PS: the VideoLan team had already corrected the bug and normally the VLC version 1.0.1 will be available soon.

**EDIT:**

**[5]** Allocating (realloc) memory for the buffer (memory size: 12 + 11 bytes)

**[6]** Integer underflow, size == -1 == 0xffffffff

**[7]** The size variable is used as an unsigned integer to read data from the network, please see the conversion table below:

* 32bit signed int max value:  2147483647 (0x7fffffff)
* 32bit signed int min value:   -2147483648 (0x80000000)
* 32bit unsigned int max value:  4294967295 (0xffffffff)
* 32bit unsigned int min value:   0

so if we are dealing with an unsigned int the value -1 will be converted to 4294967295 and in this case the network function will try to read 4GB of data into the buffer.

### Share this:

* [Facebook](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=facebook "Click to share on Facebook")
* [X](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Monday, July 27th, 2009 at 8:42 pm and is filed under [Advisories](https://dzcore.wordpress.com/category/advisories/). You can follow any responses to this entry through the [RSS 2.0](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/feed/) feed.
You can [leave a response](#respond), or [trackback](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/trackback/) from your own site.

### Post navigation

[Next Post »](https://dzcore.wordpress.com/2011/01/19/new-home/)

### 20 Responses to *[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow*

1. [FreeFoxTV (butterflyoffire) 's status on Tuesday, 28-Jul-09 08:20:23 UTC - Identi.ca](http://identi.ca/notice/7133249) says:
   [July 28, 2009 at 8:20 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-2)

   […] [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow … […]

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=2#respond)
3. [ButterflyOfFire](http://www.freefoxtv.net) says:
   [July 28, 2009 at 8:29 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-3)

   Thanks tixxDZ, I’ll send a notification through identi.ca.

   Ihope that a patch will be released soon ;)

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=3#respond)
   * tixxdz says:
     [July 28, 2009 at 11:06 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-5)

     salam ButterflyOfFire,

     VLC patch at <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834c08674676e209afa842053aca>

     Mplayer patch: update svn to revision 29447.

     New Releases: ??

     thx.

     [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=5#respond)
5. [zendyani](http://www.webmaster-dz.com) says:
   [July 28, 2009 at 12:06 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-6)

   bon courage a toi tixxdz, jolie travail.

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=6#respond)
7. [secdz](http://secdz.blogspot.com) says:
   [July 28, 2009 at 8:21 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-7)

   J’ai pas encore lu le billet …je veux juste te féliciter pour le nouveau blog …enfin :)

   Je reviendrais pour apprendre de ton billet

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=7#respond)
9. [Amar De Annaba](http://amarannaba.wordpress.com) says:
   [July 28, 2009 at 11:03 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-8)

   Un petit blog pour l’homme mais un grand pas pour les human being !!! :-)

   Bon courage !!!

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=8#respond)
11. Rama says:
    [July 29, 2009 at 3:04 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-9)

    It’s very enjoying to know someone (algerian) trying the adventure in the shakespeare’s way!

    i’m a real dummy in security but I see that you’re an expert and you really know what you’re talking about!

    anyway, you’re already caught in my reader! :D

    congratulation for the rocket’s launching as said KT! :D hope reading you very soon!

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=9#respond)
13. tixxdz says:
    [July 29, 2009 at 12:29 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-10)

    thx for all your comments and please see the EDIT to clarify the conversion issues.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=10#respond)
15. hnawelhik says:
    [July 29, 2009 at 6:05 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-11)

    je vais posé une question un peut naïve, mais vous parlez de quoi? entre programmation et anglais je suis perdu.

    salamalikom

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=11#respond)
    * tixxdz says:
      [August 1, 2009 at 12:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-13)

      salam, désolé hnawelhik pour le retard, je suis lhik maintenant (douar sans connection).

      oui effectivement le sujet parle de programmation, vulnérabilité … etc en anglais.

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=13#respond)
17. [barabas](http://pwncafe.wordpress.com/) says:
    [October 5, 2009 at 5:09 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-22)

    nice work…keep it up

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=22#respond)
    * tixxdz says:
      [October 8, 2009 at 11:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-24)

      thx barabas and nice to see you here

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=24#respond)
19. Xuphanc says:
    [July 3, 2010 at 1:26 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-26)

    Hey..

    I’ve seen before the RTSP and SSA support vuln through my debuging system..LOL, It seem A nice to make a POC,I think that the new versoion has not yet fixed the integer underflow in Real pseudo-RTSP module? Any way congrtatulation weld bladi..I m so happy to hear/t ;) good new about you..Inchallah more and more..

    Keep doing..

    /Xuphanc.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=26#respond)
21. Jugurtha Hadjar says:
    [December 11, 2010 at 12:03 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-28)

    J’étais en train de regarder une vidéo [La présentation de Fyodor au Defcon18, Nmap Scripting Engine] .. Il y avait un certain “nfs-ls”…

    J’ai vu le nom de l’auteur, qui sonnait plutôt familier.. A Google query later.. ça a donné des échanges archivés des mailing lists, avec le co-auteur, ainsi que ce blog.

    Intéressant :)

    Bookmarked of course.

    Keep it up,

    USTHB.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=28#respond)
23. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](http://007software.net/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 6, 2015 at 3:30 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-44)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=44#respond)
25. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](http://extracheesy.net/news/2015/01/07/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 7, 2015 at 11:16 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-46)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=46#respond)
27. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 « ECI Blog @WordPress](https://ecinetworks.wordpress.com/2015/01/10/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-47)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=47#respond)
29. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-48)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=48#respond)
31. [(SB15-005) Vulnerability Summary for the Week of December 29, 2014 | ECI Networks](http://ecinetworks.com/?p=2463) says:
    [February 14, 2015 at 8:42 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-52)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=52#respond)
33. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](http://www.isecurestuff.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [February 23, 2015 at 10:18 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-54)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=54#respond)

### Leave a comment [Cancel reply](/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#respond)

Δ

* Search
* ## DZCORE

  + [Code](https://sites.google.com/site/dzcore/code/)
  + [Advisories](https://dzcore.wordpress.com/advisories/)
  + [About](https://dzcore.wordpress.com/about/)
* ## Algerian Blogs

  + [Agence84 Technologies](http://www.agence84.com/blog/ "Agence84 Technologies Web & Mobile Blog")
  + [Amar De Annaba](http://amarannaba.wordpress.com/ "Amar Super Blog")
  + [Bikora Questions/Réponses](http://bikora.com)
  + [FreeFoxTV](http://www.freefoxtv.net/ "ButterflyOfFire blog")
  + [Gineblog](http://gineblog.olympe-network.com/ "Gineblog")
  + [KT Algerie](http://ktalgerie.blogspot.com/ "KT Algerie blog")
  + [Youknowriad](http://youknowriad.nomade-dz.com/ "Youknowriad Blog")
* ## Algerian Open Source Blogs

  + [InalGnu == Open source](http://inalgnu.nomade-dz.com/ "InalGnu Blog")
  + [Le Blog De Amarsoft](http://amarsoftdz.blogspot.com/ "Amarsoft blog")
  + [Le bric-à-brac](http://lebricabrac.wordpress.com/ "Havoc Blog")
  + [Tuxargon Open Source Power](http://pressenux.tuxfamily.org/ "Tuxargon blog")
  + [Ubuntu Algérie](http://ubuntu-algerie.blogspot.com/)
* ## Algerian Security Blogs

  + [Hack your mind](http://www.webmaster-dz.com/ "Hack your mind")
  + [InfoSecDz](http://infosecdz.blogspot.com/ "infosecdz blog")
  + [IT & Security in Algeria](http://secdz.blogspot.com/ "secdz blog")
  + [Th3 Under9rond Rev0Lut!oN](http://hors-sujets.blogspot.com/ "Th3 Under9rond Rev0Lut!oN Blog")
* ## Archives

  + [January 2011](https://dzcore.wordpress.com/2011/01/)
  + [July 2009](https://dzcore.wordpress.com/2009/07/)
* ## Categories

  + [Advisories](https://dzcore.wordpress.com/category/advisories/)
  + [Uncategorized](https://dzcore.wordpress.com/category/uncategorized/)

* [Comment](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pxpYP-k)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/)
  + [View post in Reader](https://wordpress.com/read/blogs/7964695/posts/20)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from dzcore.wordpress.com_eac7fdcd_20250126_091545.html ===

# [DZCORE](https://dzcore.wordpress.com/)

Open Source & Computer Security

* [Home](https://dzcore.wordpress.com/)
* [About](https://dzcore.wordpress.com/about/)
* [Advisories](https://dzcore.wordpress.com/advisories/)

## [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow

hello

I have published a security advisory for Mplayer and VLC: [[DZC-2009-001]](https://sites.google.com/site/dzcore/misc/dzcore-2009-001-advisory.txt)

Advisory blog post:

Advisory:

The Movie Player and VLC Media Player Real Data Transport

parsing integer underflow.

Affected products:

The Movie player <= svn r29446 [1]

VLC media player <= 1.0.0 [2]

Possible others applications that use the xine lib code [3].

Discovred by:

tixxDZ

DZCORE Labs, Algeria

Date reported:

2009/07/25

Release Date:

2009/07/27

Solutions:

VLC: update to VLC media player 1.0.1 [2] [4].

Mplayer: update to svn r29447.

———

Abstract:

———

Mplayer

Source file: stream/realrtsp/real.c

function: int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, char \*\*buffer, int rdt\_rawdata)

VLC

Source file: modules/access/rtsp/real.c

function: int real\_get\_rdt\_chunk\_header(rtsp\_client\_t \*rtsp\_session, rmff\_pheader\_t \*ph)

The original code is part of the xine library [3]:

Source file: src/input/libreal/real.c

function:  int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer)

Function real\_get\_rdt\_chunk() calls rtsp\_read\_data() to read RDT (Real Data Transport) chunks headers from the network and after that it will parse them.

A controled variable is used to allocate a buffer and later passed on to the rtsp\_read\_data() function in order to specify the length of an RDT chunk data to read from the network.

An integer underflow can be triggered when parsing a malformed RDT header chunk, a remote attacker can exploit it to execute arbitrary code in the context of the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the xio\_rw\_abort() funcion (file: src/xine-engine/io\_helper.c), which takes the length of an RDT packet as an off\_t type and performs some comparison checks (line: 350) before reading chunks from the network.

The Movie player [1] and the VLC media player [2] are vulnerable, the length of an RDT packet is passed as an unsigned int to their own network read functions.

———–

Descripton:

———–

xine-lib source file: src/input/libreal/real.c

int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer) {

int n=1;

uint8\_t header[8];

rmff\_pheader\_t ph;

int size;

int flags1;

int unknown1;

uint32\_t ts;

n=rtsp\_read\_data(rtsp\_session, header, 8);

if (n<8) return 0;

if (header[0] != 0x24)

{

lprintf(“rdt chunk not recognized: got 0x%02x\n”, header[0]);

return 0;

}

size=(header[1]<<16)+(header[2]<<8)+(header[3]); **/\* [1] \*/**

flags1=header[4];

if ((flags1!=0x40)&&(flags1!=0x42))

{

lprintf(“got flags1: 0x%02x\n”,flags1);

if (header[6]==0x06)

{

lprintf(“got end of stream packet\n”);

return 0;

}

…

size-=9; **/\* [2] \*/**

}

unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);

n=rtsp\_read\_data(rtsp\_session, header, 6);

if (n<6) return 0;

ts=\_X\_BE\_32(header);

lprintf(“ts: %u size: %u, flags: 0x%02x, unknown values: %u

0x%02x 0x%02x\n”,

ts, size, flags1, unknown1, header[4], header[5]);

size+=2; **/\* [3] \*/**

ph->object\_version=0;

ph->length=size; **/\* [4] \*/**

ph->stream\_number=(flags1>>1)&1;

ph->timestamp=ts;

ph->reserved=0;

ph->flags=0; /\* TODO: determine keyframe flag and insert here? \*/

xine\_buffer\_ensure\_size(\*buffer, 12+size); **/\* [5] \*/**

rmff\_dump\_pheader(&ph, \*buffer);

size-=12; **/\* [6] \*/**

n=rtsp\_read\_data(rtsp\_session, (\*buffer)+12, size); **/\* [7] \*/**

return (n <= 0) ? 0 : n+12;

}

**[1]** The signed int size variable is filled with data from the network.

**[2] [3]** Some arithmetics operations, we assume that at the end size == 11.

**[4]** The value of the size variable is assigned to the ph->length.

**[5]** The size variable is used to allocate (realloc) space for the buffer.

**[6]** An integer underflow is triggered, size == 0xffffffff.

**[7]** The size variable is passed to the rtsp\_read\_data() function as an

unsigned integer in order to specify the length of an RDT packet.

Mplayer:

Mplayer is vulnerable, the rtsp\_read\_data() function passes the

length to the read\_stream() function (file: stream/librtsp/rtsp.c) as

a size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

VLC:

VLC is vulnerable, the real\_get\_rdt\_chunk\_header() function will read

and parse the header, the vulnerable call to the rtsp\_read\_data()

function is made by the real\_get\_rdt\_chunk() function, the length is

passed to the \_\_net\_Read() function (file: src/network/io.c) as a

size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

——–

Patches:

——–

VLC

Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer

Official patch by the Mplayer team, please update svn to revision 29447.

———–

References:

———–

[1] <http://www.mplayerhq.hu/>

[2] <http://www.videolan.org/>

[3] <http://www.xine-project.org/>

[4] <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>

c08674676e209afa842053aca

———–

Disclaimer:

———–

The document is provided as is without warranty of any kind. The content

may change without notice. In no event shall the author be liable for any

special, direct or indirect damages, losses or unlawful offences.

Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

#end

PS: the [original Advisory](http://archives.neohapsis.com/archives/bugtraq/2009-07/0198.html) published on bugtraq contains an unofficial patch of mine to the Mplayer, however the Mplayer Team responded quickly and a patch is available, please update to svn revision 29447.

PS: the VideoLan team had already corrected the bug and normally the VLC version 1.0.1 will be available soon.

**EDIT:**

**[5]** Allocating (realloc) memory for the buffer (memory size: 12 + 11 bytes)

**[6]** Integer underflow, size == -1 == 0xffffffff

**[7]** The size variable is used as an unsigned integer to read data from the network, please see the conversion table below:

* 32bit signed int max value:  2147483647 (0x7fffffff)
* 32bit signed int min value:   -2147483648 (0x80000000)
* 32bit unsigned int max value:  4294967295 (0xffffffff)
* 32bit unsigned int min value:   0

so if we are dealing with an unsigned int the value -1 will be converted to 4294967295 and in this case the network function will try to read 4GB of data into the buffer.

### Share this:

* [Facebook](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=facebook "Click to share on Facebook")
* [X](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Monday, July 27th, 2009 at 8:42 pm and is filed under [Advisories](https://dzcore.wordpress.com/category/advisories/). You can follow any responses to this entry through the [RSS 2.0](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/feed/) feed.
You can [leave a response](#respond), or [trackback](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/trackback/) from your own site.

### Post navigation

[Next Post »](https://dzcore.wordpress.com/2011/01/19/new-home/)

### 20 Responses to *[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow*

1. [FreeFoxTV (butterflyoffire) 's status on Tuesday, 28-Jul-09 08:20:23 UTC - Identi.ca](http://identi.ca/notice/7133249) says:
   [July 28, 2009 at 8:20 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-2)

   […] [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow … […]

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=2#respond)
3. [ButterflyOfFire](http://www.freefoxtv.net) says:
   [July 28, 2009 at 8:29 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-3)

   Thanks tixxDZ, I’ll send a notification through identi.ca.

   Ihope that a patch will be released soon ;)

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=3#respond)
   * tixxdz says:
     [July 28, 2009 at 11:06 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-5)

     salam ButterflyOfFire,

     VLC patch at <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834c08674676e209afa842053aca>

     Mplayer patch: update svn to revision 29447.

     New Releases: ??

     thx.

     [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=5#respond)
5. [zendyani](http://www.webmaster-dz.com) says:
   [July 28, 2009 at 12:06 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-6)

   bon courage a toi tixxdz, jolie travail.

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=6#respond)
7. [secdz](http://secdz.blogspot.com) says:
   [July 28, 2009 at 8:21 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-7)

   J’ai pas encore lu le billet …je veux juste te féliciter pour le nouveau blog …enfin :)

   Je reviendrais pour apprendre de ton billet

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=7#respond)
9. [Amar De Annaba](http://amarannaba.wordpress.com) says:
   [July 28, 2009 at 11:03 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-8)

   Un petit blog pour l’homme mais un grand pas pour les human being !!! :-)

   Bon courage !!!

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=8#respond)
11. Rama says:
    [July 29, 2009 at 3:04 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-9)

    It’s very enjoying to know someone (algerian) trying the adventure in the shakespeare’s way!

    i’m a real dummy in security but I see that you’re an expert and you really know what you’re talking about!

    anyway, you’re already caught in my reader! :D

    congratulation for the rocket’s launching as said KT! :D hope reading you very soon!

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=9#respond)
13. tixxdz says:
    [July 29, 2009 at 12:29 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-10)

    thx for all your comments and please see the EDIT to clarify the conversion issues.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=10#respond)
15. hnawelhik says:
    [July 29, 2009 at 6:05 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-11)

    je vais posé une question un peut naïve, mais vous parlez de quoi? entre programmation et anglais je suis perdu.

    salamalikom

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=11#respond)
    * tixxdz says:
      [August 1, 2009 at 12:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-13)

      salam, désolé hnawelhik pour le retard, je suis lhik maintenant (douar sans connection).

      oui effectivement le sujet parle de programmation, vulnérabilité … etc en anglais.

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=13#respond)
17. [barabas](http://pwncafe.wordpress.com/) says:
    [October 5, 2009 at 5:09 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-22)

    nice work…keep it up

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=22#respond)
    * tixxdz says:
      [October 8, 2009 at 11:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-24)

      thx barabas and nice to see you here

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=24#respond)
19. Xuphanc says:
    [July 3, 2010 at 1:26 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-26)

    Hey..

    I’ve seen before the RTSP and SSA support vuln through my debuging system..LOL, It seem A nice to make a POC,I think that the new versoion has not yet fixed the integer underflow in Real pseudo-RTSP module? Any way congrtatulation weld bladi..I m so happy to hear/t ;) good new about you..Inchallah more and more..

    Keep doing..

    /Xuphanc.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=26#respond)
21. Jugurtha Hadjar says:
    [December 11, 2010 at 12:03 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-28)

    J’étais en train de regarder une vidéo [La présentation de Fyodor au Defcon18, Nmap Scripting Engine] .. Il y avait un certain “nfs-ls”…

    J’ai vu le nom de l’auteur, qui sonnait plutôt familier.. A Google query later.. ça a donné des échanges archivés des mailing lists, avec le co-auteur, ainsi que ce blog.

    Intéressant :)

    Bookmarked of course.

    Keep it up,

    USTHB.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=28#respond)
23. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](http://007software.net/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 6, 2015 at 3:30 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-44)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=44#respond)
25. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](http://extracheesy.net/news/2015/01/07/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 7, 2015 at 11:16 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-46)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=46#respond)
27. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 « ECI Blog @WordPress](https://ecinetworks.wordpress.com/2015/01/10/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-47)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=47#respond)
29. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-48)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=48#respond)
31. [(SB15-005) Vulnerability Summary for the Week of December 29, 2014 | ECI Networks](http://ecinetworks.com/?p=2463) says:
    [February 14, 2015 at 8:42 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-52)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=52#respond)
33. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](http://www.isecurestuff.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [February 23, 2015 at 10:18 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-54)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=54#respond)

### Leave a reply to [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](#comment-44) [Cancel reply](/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#respond)

Δ

* Search
* ## DZCORE

  + [Code](https://sites.google.com/site/dzcore/code/)
  + [Advisories](https://dzcore.wordpress.com/advisories/)
  + [About](https://dzcore.wordpress.com/about/)
* ## Algerian Blogs

  + [Agence84 Technologies](http://www.agence84.com/blog/ "Agence84 Technologies Web & Mobile Blog")
  + [Amar De Annaba](http://amarannaba.wordpress.com/ "Amar Super Blog")
  + [Bikora Questions/Réponses](http://bikora.com)
  + [FreeFoxTV](http://www.freefoxtv.net/ "ButterflyOfFire blog")
  + [Gineblog](http://gineblog.olympe-network.com/ "Gineblog")
  + [KT Algerie](http://ktalgerie.blogspot.com/ "KT Algerie blog")
  + [Youknowriad](http://youknowriad.nomade-dz.com/ "Youknowriad Blog")
* ## Algerian Open Source Blogs

  + [InalGnu == Open source](http://inalgnu.nomade-dz.com/ "InalGnu Blog")
  + [Le Blog De Amarsoft](http://amarsoftdz.blogspot.com/ "Amarsoft blog")
  + [Le bric-à-brac](http://lebricabrac.wordpress.com/ "Havoc Blog")
  + [Tuxargon Open Source Power](http://pressenux.tuxfamily.org/ "Tuxargon blog")
  + [Ubuntu Algérie](http://ubuntu-algerie.blogspot.com/)
* ## Algerian Security Blogs

  + [Hack your mind](http://www.webmaster-dz.com/ "Hack your mind")
  + [InfoSecDz](http://infosecdz.blogspot.com/ "infosecdz blog")
  + [IT & Security in Algeria](http://secdz.blogspot.com/ "secdz blog")
  + [Th3 Under9rond Rev0Lut!oN](http://hors-sujets.blogspot.com/ "Th3 Under9rond Rev0Lut!oN Blog")
* ## Archives

  + [January 2011](https://dzcore.wordpress.com/2011/01/)
  + [July 2009](https://dzcore.wordpress.com/2009/07/)
* ## Categories

  + [Advisories](https://dzcore.wordpress.com/category/advisories/)
  + [Uncategorized](https://dzcore.wordpress.com/category/uncategorized/)

* [Comment](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pxpYP-k)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/)
  + [View post in Reader](https://wordpress.com/read/blogs/7964695/posts/20)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from dzcore.wordpress.com_bf343b06_20250126_091545.html ===

# [DZCORE](https://dzcore.wordpress.com/)

Open Source & Computer Security

* [Home](https://dzcore.wordpress.com/)
* [About](https://dzcore.wordpress.com/about/)
* [Advisories](https://dzcore.wordpress.com/advisories/)

## [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow

hello

I have published a security advisory for Mplayer and VLC: [[DZC-2009-001]](https://sites.google.com/site/dzcore/misc/dzcore-2009-001-advisory.txt)

Advisory blog post:

Advisory:

The Movie Player and VLC Media Player Real Data Transport

parsing integer underflow.

Affected products:

The Movie player <= svn r29446 [1]

VLC media player <= 1.0.0 [2]

Possible others applications that use the xine lib code [3].

Discovred by:

tixxDZ

DZCORE Labs, Algeria

Date reported:

2009/07/25

Release Date:

2009/07/27

Solutions:

VLC: update to VLC media player 1.0.1 [2] [4].

Mplayer: update to svn r29447.

———

Abstract:

———

Mplayer

Source file: stream/realrtsp/real.c

function: int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, char \*\*buffer, int rdt\_rawdata)

VLC

Source file: modules/access/rtsp/real.c

function: int real\_get\_rdt\_chunk\_header(rtsp\_client\_t \*rtsp\_session, rmff\_pheader\_t \*ph)

The original code is part of the xine library [3]:

Source file: src/input/libreal/real.c

function:  int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer)

Function real\_get\_rdt\_chunk() calls rtsp\_read\_data() to read RDT (Real Data Transport) chunks headers from the network and after that it will parse them.

A controled variable is used to allocate a buffer and later passed on to the rtsp\_read\_data() function in order to specify the length of an RDT chunk data to read from the network.

An integer underflow can be triggered when parsing a malformed RDT header chunk, a remote attacker can exploit it to execute arbitrary code in the context of the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the xio\_rw\_abort() funcion (file: src/xine-engine/io\_helper.c), which takes the length of an RDT packet as an off\_t type and performs some comparison checks (line: 350) before reading chunks from the network.

The Movie player [1] and the VLC media player [2] are vulnerable, the length of an RDT packet is passed as an unsigned int to their own network read functions.

———–

Descripton:

———–

xine-lib source file: src/input/libreal/real.c

int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer) {

int n=1;

uint8\_t header[8];

rmff\_pheader\_t ph;

int size;

int flags1;

int unknown1;

uint32\_t ts;

n=rtsp\_read\_data(rtsp\_session, header, 8);

if (n<8) return 0;

if (header[0] != 0x24)

{

lprintf(“rdt chunk not recognized: got 0x%02x\n”, header[0]);

return 0;

}

size=(header[1]<<16)+(header[2]<<8)+(header[3]); **/\* [1] \*/**

flags1=header[4];

if ((flags1!=0x40)&&(flags1!=0x42))

{

lprintf(“got flags1: 0x%02x\n”,flags1);

if (header[6]==0x06)

{

lprintf(“got end of stream packet\n”);

return 0;

}

…

size-=9; **/\* [2] \*/**

}

unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);

n=rtsp\_read\_data(rtsp\_session, header, 6);

if (n<6) return 0;

ts=\_X\_BE\_32(header);

lprintf(“ts: %u size: %u, flags: 0x%02x, unknown values: %u

0x%02x 0x%02x\n”,

ts, size, flags1, unknown1, header[4], header[5]);

size+=2; **/\* [3] \*/**

ph->object\_version=0;

ph->length=size; **/\* [4] \*/**

ph->stream\_number=(flags1>>1)&1;

ph->timestamp=ts;

ph->reserved=0;

ph->flags=0; /\* TODO: determine keyframe flag and insert here? \*/

xine\_buffer\_ensure\_size(\*buffer, 12+size); **/\* [5] \*/**

rmff\_dump\_pheader(&ph, \*buffer);

size-=12; **/\* [6] \*/**

n=rtsp\_read\_data(rtsp\_session, (\*buffer)+12, size); **/\* [7] \*/**

return (n <= 0) ? 0 : n+12;

}

**[1]** The signed int size variable is filled with data from the network.

**[2] [3]** Some arithmetics operations, we assume that at the end size == 11.

**[4]** The value of the size variable is assigned to the ph->length.

**[5]** The size variable is used to allocate (realloc) space for the buffer.

**[6]** An integer underflow is triggered, size == 0xffffffff.

**[7]** The size variable is passed to the rtsp\_read\_data() function as an

unsigned integer in order to specify the length of an RDT packet.

Mplayer:

Mplayer is vulnerable, the rtsp\_read\_data() function passes the

length to the read\_stream() function (file: stream/librtsp/rtsp.c) as

a size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

VLC:

VLC is vulnerable, the real\_get\_rdt\_chunk\_header() function will read

and parse the header, the vulnerable call to the rtsp\_read\_data()

function is made by the real\_get\_rdt\_chunk() function, the length is

passed to the \_\_net\_Read() function (file: src/network/io.c) as a

size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

——–

Patches:

——–

VLC

Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer

Official patch by the Mplayer team, please update svn to revision 29447.

———–

References:

———–

[1] <http://www.mplayerhq.hu/>

[2] <http://www.videolan.org/>

[3] <http://www.xine-project.org/>

[4] <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>

c08674676e209afa842053aca

———–

Disclaimer:

———–

The document is provided as is without warranty of any kind. The content

may change without notice. In no event shall the author be liable for any

special, direct or indirect damages, losses or unlawful offences.

Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

#end

PS: the [original Advisory](http://archives.neohapsis.com/archives/bugtraq/2009-07/0198.html) published on bugtraq contains an unofficial patch of mine to the Mplayer, however the Mplayer Team responded quickly and a patch is available, please update to svn revision 29447.

PS: the VideoLan team had already corrected the bug and normally the VLC version 1.0.1 will be available soon.

**EDIT:**

**[5]** Allocating (realloc) memory for the buffer (memory size: 12 + 11 bytes)

**[6]** Integer underflow, size == -1 == 0xffffffff

**[7]** The size variable is used as an unsigned integer to read data from the network, please see the conversion table below:

* 32bit signed int max value:  2147483647 (0x7fffffff)
* 32bit signed int min value:   -2147483648 (0x80000000)
* 32bit unsigned int max value:  4294967295 (0xffffffff)
* 32bit unsigned int min value:   0

so if we are dealing with an unsigned int the value -1 will be converted to 4294967295 and in this case the network function will try to read 4GB of data into the buffer.

### Share this:

* [Facebook](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=facebook "Click to share on Facebook")
* [X](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Monday, July 27th, 2009 at 8:42 pm and is filed under [Advisories](https://dzcore.wordpress.com/category/advisories/). You can follow any responses to this entry through the [RSS 2.0](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/feed/) feed.
You can [leave a response](#respond), or [trackback](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/trackback/) from your own site.

### Post navigation

[Next Post »](https://dzcore.wordpress.com/2011/01/19/new-home/)

### 20 Responses to *[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow*

1. [FreeFoxTV (butterflyoffire) 's status on Tuesday, 28-Jul-09 08:20:23 UTC - Identi.ca](http://identi.ca/notice/7133249) says:
   [July 28, 2009 at 8:20 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-2)

   […] [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow … […]

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=2#respond)
3. [ButterflyOfFire](http://www.freefoxtv.net) says:
   [July 28, 2009 at 8:29 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-3)

   Thanks tixxDZ, I’ll send a notification through identi.ca.

   Ihope that a patch will be released soon ;)

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=3#respond)
   * tixxdz says:
     [July 28, 2009 at 11:06 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-5)

     salam ButterflyOfFire,

     VLC patch at <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834c08674676e209afa842053aca>

     Mplayer patch: update svn to revision 29447.

     New Releases: ??

     thx.

     [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=5#respond)
5. [zendyani](http://www.webmaster-dz.com) says:
   [July 28, 2009 at 12:06 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-6)

   bon courage a toi tixxdz, jolie travail.

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=6#respond)
7. [secdz](http://secdz.blogspot.com) says:
   [July 28, 2009 at 8:21 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-7)

   J’ai pas encore lu le billet …je veux juste te féliciter pour le nouveau blog …enfin :)

   Je reviendrais pour apprendre de ton billet

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=7#respond)
9. [Amar De Annaba](http://amarannaba.wordpress.com) says:
   [July 28, 2009 at 11:03 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-8)

   Un petit blog pour l’homme mais un grand pas pour les human being !!! :-)

   Bon courage !!!

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=8#respond)
11. Rama says:
    [July 29, 2009 at 3:04 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-9)

    It’s very enjoying to know someone (algerian) trying the adventure in the shakespeare’s way!

    i’m a real dummy in security but I see that you’re an expert and you really know what you’re talking about!

    anyway, you’re already caught in my reader! :D

    congratulation for the rocket’s launching as said KT! :D hope reading you very soon!

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=9#respond)
13. tixxdz says:
    [July 29, 2009 at 12:29 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-10)

    thx for all your comments and please see the EDIT to clarify the conversion issues.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=10#respond)
15. hnawelhik says:
    [July 29, 2009 at 6:05 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-11)

    je vais posé une question un peut naïve, mais vous parlez de quoi? entre programmation et anglais je suis perdu.

    salamalikom

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=11#respond)
    * tixxdz says:
      [August 1, 2009 at 12:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-13)

      salam, désolé hnawelhik pour le retard, je suis lhik maintenant (douar sans connection).

      oui effectivement le sujet parle de programmation, vulnérabilité … etc en anglais.

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=13#respond)
17. [barabas](http://pwncafe.wordpress.com/) says:
    [October 5, 2009 at 5:09 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-22)

    nice work…keep it up

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=22#respond)
    * tixxdz says:
      [October 8, 2009 at 11:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-24)

      thx barabas and nice to see you here

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=24#respond)
19. Xuphanc says:
    [July 3, 2010 at 1:26 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-26)

    Hey..

    I’ve seen before the RTSP and SSA support vuln through my debuging system..LOL, It seem A nice to make a POC,I think that the new versoion has not yet fixed the integer underflow in Real pseudo-RTSP module? Any way congrtatulation weld bladi..I m so happy to hear/t ;) good new about you..Inchallah more and more..

    Keep doing..

    /Xuphanc.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=26#respond)
21. Jugurtha Hadjar says:
    [December 11, 2010 at 12:03 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-28)

    J’étais en train de regarder une vidéo [La présentation de Fyodor au Defcon18, Nmap Scripting Engine] .. Il y avait un certain “nfs-ls”…

    J’ai vu le nom de l’auteur, qui sonnait plutôt familier.. A Google query later.. ça a donné des échanges archivés des mailing lists, avec le co-auteur, ainsi que ce blog.

    Intéressant :)

    Bookmarked of course.

    Keep it up,

    USTHB.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=28#respond)
23. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](http://007software.net/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 6, 2015 at 3:30 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-44)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=44#respond)
25. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](http://extracheesy.net/news/2015/01/07/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 7, 2015 at 11:16 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-46)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=46#respond)
27. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 « ECI Blog @WordPress](https://ecinetworks.wordpress.com/2015/01/10/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-47)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=47#respond)
29. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-48)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=48#respond)
31. [(SB15-005) Vulnerability Summary for the Week of December 29, 2014 | ECI Networks](http://ecinetworks.com/?p=2463) says:
    [February 14, 2015 at 8:42 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-52)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=52#respond)
33. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](http://www.isecurestuff.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [February 23, 2015 at 10:18 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-54)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=54#respond)

### Leave a comment [Cancel reply](/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#respond)

Δ

* Search
* ## DZCORE

  + [Code](https://sites.google.com/site/dzcore/code/)
  + [Advisories](https://dzcore.wordpress.com/advisories/)
  + [About](https://dzcore.wordpress.com/about/)
* ## Algerian Blogs

  + [Agence84 Technologies](http://www.agence84.com/blog/ "Agence84 Technologies Web & Mobile Blog")
  + [Amar De Annaba](http://amarannaba.wordpress.com/ "Amar Super Blog")
  + [Bikora Questions/Réponses](http://bikora.com)
  + [FreeFoxTV](http://www.freefoxtv.net/ "ButterflyOfFire blog")
  + [Gineblog](http://gineblog.olympe-network.com/ "Gineblog")
  + [KT Algerie](http://ktalgerie.blogspot.com/ "KT Algerie blog")
  + [Youknowriad](http://youknowriad.nomade-dz.com/ "Youknowriad Blog")
* ## Algerian Open Source Blogs

  + [InalGnu == Open source](http://inalgnu.nomade-dz.com/ "InalGnu Blog")
  + [Le Blog De Amarsoft](http://amarsoftdz.blogspot.com/ "Amarsoft blog")
  + [Le bric-à-brac](http://lebricabrac.wordpress.com/ "Havoc Blog")
  + [Tuxargon Open Source Power](http://pressenux.tuxfamily.org/ "Tuxargon blog")
  + [Ubuntu Algérie](http://ubuntu-algerie.blogspot.com/)
* ## Algerian Security Blogs

  + [Hack your mind](http://www.webmaster-dz.com/ "Hack your mind")
  + [InfoSecDz](http://infosecdz.blogspot.com/ "infosecdz blog")
  + [IT & Security in Algeria](http://secdz.blogspot.com/ "secdz blog")
  + [Th3 Under9rond Rev0Lut!oN](http://hors-sujets.blogspot.com/ "Th3 Under9rond Rev0Lut!oN Blog")
* ## Archives

  + [January 2011](https://dzcore.wordpress.com/2011/01/)
  + [July 2009](https://dzcore.wordpress.com/2009/07/)
* ## Categories

  + [Advisories](https://dzcore.wordpress.com/category/advisories/)
  + [Uncategorized](https://dzcore.wordpress.com/category/uncategorized/)

* [Comment](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pxpYP-k)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/)
  + [View post in Reader](https://wordpress.com/read/blogs/7964695/posts/20)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from dzcore.wordpress.com_3a3ea6d8_20250126_091543.html ===

# [DZCORE](https://dzcore.wordpress.com/)

Open Source & Computer Security

* [Home](https://dzcore.wordpress.com/)
* [About](https://dzcore.wordpress.com/about/)
* [Advisories](https://dzcore.wordpress.com/advisories/)

## [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow

hello

I have published a security advisory for Mplayer and VLC: [[DZC-2009-001]](https://sites.google.com/site/dzcore/misc/dzcore-2009-001-advisory.txt)

Advisory blog post:

Advisory:

The Movie Player and VLC Media Player Real Data Transport

parsing integer underflow.

Affected products:

The Movie player <= svn r29446 [1]

VLC media player <= 1.0.0 [2]

Possible others applications that use the xine lib code [3].

Discovred by:

tixxDZ

DZCORE Labs, Algeria

Date reported:

2009/07/25

Release Date:

2009/07/27

Solutions:

VLC: update to VLC media player 1.0.1 [2] [4].

Mplayer: update to svn r29447.

———

Abstract:

———

Mplayer

Source file: stream/realrtsp/real.c

function: int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, char \*\*buffer, int rdt\_rawdata)

VLC

Source file: modules/access/rtsp/real.c

function: int real\_get\_rdt\_chunk\_header(rtsp\_client\_t \*rtsp\_session, rmff\_pheader\_t \*ph)

The original code is part of the xine library [3]:

Source file: src/input/libreal/real.c

function:  int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer)

Function real\_get\_rdt\_chunk() calls rtsp\_read\_data() to read RDT (Real Data Transport) chunks headers from the network and after that it will parse them.

A controled variable is used to allocate a buffer and later passed on to the rtsp\_read\_data() function in order to specify the length of an RDT chunk data to read from the network.

An integer underflow can be triggered when parsing a malformed RDT header chunk, a remote attacker can exploit it to execute arbitrary code in the context of the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the xio\_rw\_abort() funcion (file: src/xine-engine/io\_helper.c), which takes the length of an RDT packet as an off\_t type and performs some comparison checks (line: 350) before reading chunks from the network.

The Movie player [1] and the VLC media player [2] are vulnerable, the length of an RDT packet is passed as an unsigned int to their own network read functions.

———–

Descripton:

———–

xine-lib source file: src/input/libreal/real.c

int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer) {

int n=1;

uint8\_t header[8];

rmff\_pheader\_t ph;

int size;

int flags1;

int unknown1;

uint32\_t ts;

n=rtsp\_read\_data(rtsp\_session, header, 8);

if (n<8) return 0;

if (header[0] != 0x24)

{

lprintf(“rdt chunk not recognized: got 0x%02x\n”, header[0]);

return 0;

}

size=(header[1]<<16)+(header[2]<<8)+(header[3]); **/\* [1] \*/**

flags1=header[4];

if ((flags1!=0x40)&&(flags1!=0x42))

{

lprintf(“got flags1: 0x%02x\n”,flags1);

if (header[6]==0x06)

{

lprintf(“got end of stream packet\n”);

return 0;

}

…

size-=9; **/\* [2] \*/**

}

unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);

n=rtsp\_read\_data(rtsp\_session, header, 6);

if (n<6) return 0;

ts=\_X\_BE\_32(header);

lprintf(“ts: %u size: %u, flags: 0x%02x, unknown values: %u

0x%02x 0x%02x\n”,

ts, size, flags1, unknown1, header[4], header[5]);

size+=2; **/\* [3] \*/**

ph->object\_version=0;

ph->length=size; **/\* [4] \*/**

ph->stream\_number=(flags1>>1)&1;

ph->timestamp=ts;

ph->reserved=0;

ph->flags=0; /\* TODO: determine keyframe flag and insert here? \*/

xine\_buffer\_ensure\_size(\*buffer, 12+size); **/\* [5] \*/**

rmff\_dump\_pheader(&ph, \*buffer);

size-=12; **/\* [6] \*/**

n=rtsp\_read\_data(rtsp\_session, (\*buffer)+12, size); **/\* [7] \*/**

return (n <= 0) ? 0 : n+12;

}

**[1]** The signed int size variable is filled with data from the network.

**[2] [3]** Some arithmetics operations, we assume that at the end size == 11.

**[4]** The value of the size variable is assigned to the ph->length.

**[5]** The size variable is used to allocate (realloc) space for the buffer.

**[6]** An integer underflow is triggered, size == 0xffffffff.

**[7]** The size variable is passed to the rtsp\_read\_data() function as an

unsigned integer in order to specify the length of an RDT packet.

Mplayer:

Mplayer is vulnerable, the rtsp\_read\_data() function passes the

length to the read\_stream() function (file: stream/librtsp/rtsp.c) as

a size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

VLC:

VLC is vulnerable, the real\_get\_rdt\_chunk\_header() function will read

and parse the header, the vulnerable call to the rtsp\_read\_data()

function is made by the real\_get\_rdt\_chunk() function, the length is

passed to the \_\_net\_Read() function (file: src/network/io.c) as a

size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

——–

Patches:

——–

VLC

Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer

Official patch by the Mplayer team, please update svn to revision 29447.

———–

References:

———–

[1] <http://www.mplayerhq.hu/>

[2] <http://www.videolan.org/>

[3] <http://www.xine-project.org/>

[4] <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>

c08674676e209afa842053aca

———–

Disclaimer:

———–

The document is provided as is without warranty of any kind. The content

may change without notice. In no event shall the author be liable for any

special, direct or indirect damages, losses or unlawful offences.

Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

#end

PS: the [original Advisory](http://archives.neohapsis.com/archives/bugtraq/2009-07/0198.html) published on bugtraq contains an unofficial patch of mine to the Mplayer, however the Mplayer Team responded quickly and a patch is available, please update to svn revision 29447.

PS: the VideoLan team had already corrected the bug and normally the VLC version 1.0.1 will be available soon.

**EDIT:**

**[5]** Allocating (realloc) memory for the buffer (memory size: 12 + 11 bytes)

**[6]** Integer underflow, size == -1 == 0xffffffff

**[7]** The size variable is used as an unsigned integer to read data from the network, please see the conversion table below:

* 32bit signed int max value:  2147483647 (0x7fffffff)
* 32bit signed int min value:   -2147483648 (0x80000000)
* 32bit unsigned int max value:  4294967295 (0xffffffff)
* 32bit unsigned int min value:   0

so if we are dealing with an unsigned int the value -1 will be converted to 4294967295 and in this case the network function will try to read 4GB of data into the buffer.

### Share this:

* [Facebook](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=facebook "Click to share on Facebook")
* [X](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Monday, July 27th, 2009 at 8:42 pm and is filed under [Advisories](https://dzcore.wordpress.com/category/advisories/). You can follow any responses to this entry through the [RSS 2.0](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/feed/) feed.
You can [leave a response](#respond), or [trackback](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/trackback/) from your own site.

### Post navigation

[Next Post »](https://dzcore.wordpress.com/2011/01/19/new-home/)

### 20 Responses to *[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow*

1. [FreeFoxTV (butterflyoffire) 's status on Tuesday, 28-Jul-09 08:20:23 UTC - Identi.ca](http://identi.ca/notice/7133249) says:
   [July 28, 2009 at 8:20 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-2)

   […] [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow … […]

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=2#respond)
3. [ButterflyOfFire](http://www.freefoxtv.net) says:
   [July 28, 2009 at 8:29 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-3)

   Thanks tixxDZ, I’ll send a notification through identi.ca.

   Ihope that a patch will be released soon ;)

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=3#respond)
   * tixxdz says:
     [July 28, 2009 at 11:06 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-5)

     salam ButterflyOfFire,

     VLC patch at <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834c08674676e209afa842053aca>

     Mplayer patch: update svn to revision 29447.

     New Releases: ??

     thx.

     [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=5#respond)
5. [zendyani](http://www.webmaster-dz.com) says:
   [July 28, 2009 at 12:06 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-6)

   bon courage a toi tixxdz, jolie travail.

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=6#respond)
7. [secdz](http://secdz.blogspot.com) says:
   [July 28, 2009 at 8:21 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-7)

   J’ai pas encore lu le billet …je veux juste te féliciter pour le nouveau blog …enfin :)

   Je reviendrais pour apprendre de ton billet

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=7#respond)
9. [Amar De Annaba](http://amarannaba.wordpress.com) says:
   [July 28, 2009 at 11:03 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-8)

   Un petit blog pour l’homme mais un grand pas pour les human being !!! :-)

   Bon courage !!!

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=8#respond)
11. Rama says:
    [July 29, 2009 at 3:04 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-9)

    It’s very enjoying to know someone (algerian) trying the adventure in the shakespeare’s way!

    i’m a real dummy in security but I see that you’re an expert and you really know what you’re talking about!

    anyway, you’re already caught in my reader! :D

    congratulation for the rocket’s launching as said KT! :D hope reading you very soon!

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=9#respond)
13. tixxdz says:
    [July 29, 2009 at 12:29 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-10)

    thx for all your comments and please see the EDIT to clarify the conversion issues.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=10#respond)
15. hnawelhik says:
    [July 29, 2009 at 6:05 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-11)

    je vais posé une question un peut naïve, mais vous parlez de quoi? entre programmation et anglais je suis perdu.

    salamalikom

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=11#respond)
    * tixxdz says:
      [August 1, 2009 at 12:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-13)

      salam, désolé hnawelhik pour le retard, je suis lhik maintenant (douar sans connection).

      oui effectivement le sujet parle de programmation, vulnérabilité … etc en anglais.

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=13#respond)
17. [barabas](http://pwncafe.wordpress.com/) says:
    [October 5, 2009 at 5:09 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-22)

    nice work…keep it up

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=22#respond)
    * tixxdz says:
      [October 8, 2009 at 11:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-24)

      thx barabas and nice to see you here

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=24#respond)
19. Xuphanc says:
    [July 3, 2010 at 1:26 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-26)

    Hey..

    I’ve seen before the RTSP and SSA support vuln through my debuging system..LOL, It seem A nice to make a POC,I think that the new versoion has not yet fixed the integer underflow in Real pseudo-RTSP module? Any way congrtatulation weld bladi..I m so happy to hear/t ;) good new about you..Inchallah more and more..

    Keep doing..

    /Xuphanc.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=26#respond)
21. Jugurtha Hadjar says:
    [December 11, 2010 at 12:03 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-28)

    J’étais en train de regarder une vidéo [La présentation de Fyodor au Defcon18, Nmap Scripting Engine] .. Il y avait un certain “nfs-ls”…

    J’ai vu le nom de l’auteur, qui sonnait plutôt familier.. A Google query later.. ça a donné des échanges archivés des mailing lists, avec le co-auteur, ainsi que ce blog.

    Intéressant :)

    Bookmarked of course.

    Keep it up,

    USTHB.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=28#respond)
23. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](http://007software.net/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 6, 2015 at 3:30 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-44)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=44#respond)
25. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](http://extracheesy.net/news/2015/01/07/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 7, 2015 at 11:16 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-46)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=46#respond)
27. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 « ECI Blog @WordPress](https://ecinetworks.wordpress.com/2015/01/10/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-47)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=47#respond)
29. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-48)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=48#respond)
31. [(SB15-005) Vulnerability Summary for the Week of December 29, 2014 | ECI Networks](http://ecinetworks.com/?p=2463) says:
    [February 14, 2015 at 8:42 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-52)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=52#respond)
33. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](http://www.isecurestuff.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [February 23, 2015 at 10:18 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-54)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=54#respond)

### Leave a reply to [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](#comment-54) [Cancel reply](/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#respond)

Δ

* Search
* ## DZCORE

  + [Code](https://sites.google.com/site/dzcore/code/)
  + [Advisories](https://dzcore.wordpress.com/advisories/)
  + [About](https://dzcore.wordpress.com/about/)
* ## Algerian Blogs

  + [Agence84 Technologies](http://www.agence84.com/blog/ "Agence84 Technologies Web & Mobile Blog")
  + [Amar De Annaba](http://amarannaba.wordpress.com/ "Amar Super Blog")
  + [Bikora Questions/Réponses](http://bikora.com)
  + [FreeFoxTV](http://www.freefoxtv.net/ "ButterflyOfFire blog")
  + [Gineblog](http://gineblog.olympe-network.com/ "Gineblog")
  + [KT Algerie](http://ktalgerie.blogspot.com/ "KT Algerie blog")
  + [Youknowriad](http://youknowriad.nomade-dz.com/ "Youknowriad Blog")
* ## Algerian Open Source Blogs

  + [InalGnu == Open source](http://inalgnu.nomade-dz.com/ "InalGnu Blog")
  + [Le Blog De Amarsoft](http://amarsoftdz.blogspot.com/ "Amarsoft blog")
  + [Le bric-à-brac](http://lebricabrac.wordpress.com/ "Havoc Blog")
  + [Tuxargon Open Source Power](http://pressenux.tuxfamily.org/ "Tuxargon blog")
  + [Ubuntu Algérie](http://ubuntu-algerie.blogspot.com/)
* ## Algerian Security Blogs

  + [Hack your mind](http://www.webmaster-dz.com/ "Hack your mind")
  + [InfoSecDz](http://infosecdz.blogspot.com/ "infosecdz blog")
  + [IT & Security in Algeria](http://secdz.blogspot.com/ "secdz blog")
  + [Th3 Under9rond Rev0Lut!oN](http://hors-sujets.blogspot.com/ "Th3 Under9rond Rev0Lut!oN Blog")
* ## Archives

  + [January 2011](https://dzcore.wordpress.com/2011/01/)
  + [July 2009](https://dzcore.wordpress.com/2009/07/)
* ## Categories

  + [Advisories](https://dzcore.wordpress.com/category/advisories/)
  + [Uncategorized](https://dzcore.wordpress.com/category/uncategorized/)

* [Comment](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pxpYP-k)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/)
  + [View post in Reader](https://wordpress.com/read/blogs/7964695/posts/20)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from dzcore.wordpress.com_d85534db_20250126_091544.html ===

# [DZCORE](https://dzcore.wordpress.com/)

Open Source & Computer Security

* [Home](https://dzcore.wordpress.com/)
* [About](https://dzcore.wordpress.com/about/)
* [Advisories](https://dzcore.wordpress.com/advisories/)

## [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow

hello

I have published a security advisory for Mplayer and VLC: [[DZC-2009-001]](https://sites.google.com/site/dzcore/misc/dzcore-2009-001-advisory.txt)

Advisory blog post:

Advisory:

The Movie Player and VLC Media Player Real Data Transport

parsing integer underflow.

Affected products:

The Movie player <= svn r29446 [1]

VLC media player <= 1.0.0 [2]

Possible others applications that use the xine lib code [3].

Discovred by:

tixxDZ

DZCORE Labs, Algeria

Date reported:

2009/07/25

Release Date:

2009/07/27

Solutions:

VLC: update to VLC media player 1.0.1 [2] [4].

Mplayer: update to svn r29447.

———

Abstract:

———

Mplayer

Source file: stream/realrtsp/real.c

function: int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, char \*\*buffer, int rdt\_rawdata)

VLC

Source file: modules/access/rtsp/real.c

function: int real\_get\_rdt\_chunk\_header(rtsp\_client\_t \*rtsp\_session, rmff\_pheader\_t \*ph)

The original code is part of the xine library [3]:

Source file: src/input/libreal/real.c

function:  int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer)

Function real\_get\_rdt\_chunk() calls rtsp\_read\_data() to read RDT (Real Data Transport) chunks headers from the network and after that it will parse them.

A controled variable is used to allocate a buffer and later passed on to the rtsp\_read\_data() function in order to specify the length of an RDT chunk data to read from the network.

An integer underflow can be triggered when parsing a malformed RDT header chunk, a remote attacker can exploit it to execute arbitrary code in the context of the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the xio\_rw\_abort() funcion (file: src/xine-engine/io\_helper.c), which takes the length of an RDT packet as an off\_t type and performs some comparison checks (line: 350) before reading chunks from the network.

The Movie player [1] and the VLC media player [2] are vulnerable, the length of an RDT packet is passed as an unsigned int to their own network read functions.

———–

Descripton:

———–

xine-lib source file: src/input/libreal/real.c

int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer) {

int n=1;

uint8\_t header[8];

rmff\_pheader\_t ph;

int size;

int flags1;

int unknown1;

uint32\_t ts;

n=rtsp\_read\_data(rtsp\_session, header, 8);

if (n<8) return 0;

if (header[0] != 0x24)

{

lprintf(“rdt chunk not recognized: got 0x%02x\n”, header[0]);

return 0;

}

size=(header[1]<<16)+(header[2]<<8)+(header[3]); **/\* [1] \*/**

flags1=header[4];

if ((flags1!=0x40)&&(flags1!=0x42))

{

lprintf(“got flags1: 0x%02x\n”,flags1);

if (header[6]==0x06)

{

lprintf(“got end of stream packet\n”);

return 0;

}

…

size-=9; **/\* [2] \*/**

}

unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);

n=rtsp\_read\_data(rtsp\_session, header, 6);

if (n<6) return 0;

ts=\_X\_BE\_32(header);

lprintf(“ts: %u size: %u, flags: 0x%02x, unknown values: %u

0x%02x 0x%02x\n”,

ts, size, flags1, unknown1, header[4], header[5]);

size+=2; **/\* [3] \*/**

ph->object\_version=0;

ph->length=size; **/\* [4] \*/**

ph->stream\_number=(flags1>>1)&1;

ph->timestamp=ts;

ph->reserved=0;

ph->flags=0; /\* TODO: determine keyframe flag and insert here? \*/

xine\_buffer\_ensure\_size(\*buffer, 12+size); **/\* [5] \*/**

rmff\_dump\_pheader(&ph, \*buffer);

size-=12; **/\* [6] \*/**

n=rtsp\_read\_data(rtsp\_session, (\*buffer)+12, size); **/\* [7] \*/**

return (n <= 0) ? 0 : n+12;

}

**[1]** The signed int size variable is filled with data from the network.

**[2] [3]** Some arithmetics operations, we assume that at the end size == 11.

**[4]** The value of the size variable is assigned to the ph->length.

**[5]** The size variable is used to allocate (realloc) space for the buffer.

**[6]** An integer underflow is triggered, size == 0xffffffff.

**[7]** The size variable is passed to the rtsp\_read\_data() function as an

unsigned integer in order to specify the length of an RDT packet.

Mplayer:

Mplayer is vulnerable, the rtsp\_read\_data() function passes the

length to the read\_stream() function (file: stream/librtsp/rtsp.c) as

a size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

VLC:

VLC is vulnerable, the real\_get\_rdt\_chunk\_header() function will read

and parse the header, the vulnerable call to the rtsp\_read\_data()

function is made by the real\_get\_rdt\_chunk() function, the length is

passed to the \_\_net\_Read() function (file: src/network/io.c) as a

size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

——–

Patches:

——–

VLC

Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer

Official patch by the Mplayer team, please update svn to revision 29447.

———–

References:

———–

[1] <http://www.mplayerhq.hu/>

[2] <http://www.videolan.org/>

[3] <http://www.xine-project.org/>

[4] <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>

c08674676e209afa842053aca

———–

Disclaimer:

———–

The document is provided as is without warranty of any kind. The content

may change without notice. In no event shall the author be liable for any

special, direct or indirect damages, losses or unlawful offences.

Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

#end

PS: the [original Advisory](http://archives.neohapsis.com/archives/bugtraq/2009-07/0198.html) published on bugtraq contains an unofficial patch of mine to the Mplayer, however the Mplayer Team responded quickly and a patch is available, please update to svn revision 29447.

PS: the VideoLan team had already corrected the bug and normally the VLC version 1.0.1 will be available soon.

**EDIT:**

**[5]** Allocating (realloc) memory for the buffer (memory size: 12 + 11 bytes)

**[6]** Integer underflow, size == -1 == 0xffffffff

**[7]** The size variable is used as an unsigned integer to read data from the network, please see the conversion table below:

* 32bit signed int max value:  2147483647 (0x7fffffff)
* 32bit signed int min value:   -2147483648 (0x80000000)
* 32bit unsigned int max value:  4294967295 (0xffffffff)
* 32bit unsigned int min value:   0

so if we are dealing with an unsigned int the value -1 will be converted to 4294967295 and in this case the network function will try to read 4GB of data into the buffer.

### Share this:

* [Facebook](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=facebook "Click to share on Facebook")
* [X](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Monday, July 27th, 2009 at 8:42 pm and is filed under [Advisories](https://dzcore.wordpress.com/category/advisories/). You can follow any responses to this entry through the [RSS 2.0](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/feed/) feed.
You can [leave a response](#respond), or [trackback](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/trackback/) from your own site.

### Post navigation

[Next Post »](https://dzcore.wordpress.com/2011/01/19/new-home/)

### 20 Responses to *[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow*

1. [FreeFoxTV (butterflyoffire) 's status on Tuesday, 28-Jul-09 08:20:23 UTC - Identi.ca](http://identi.ca/notice/7133249) says:
   [July 28, 2009 at 8:20 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-2)

   […] [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow … […]

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=2#respond)
3. [ButterflyOfFire](http://www.freefoxtv.net) says:
   [July 28, 2009 at 8:29 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-3)

   Thanks tixxDZ, I’ll send a notification through identi.ca.

   Ihope that a patch will be released soon ;)

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=3#respond)
   * tixxdz says:
     [July 28, 2009 at 11:06 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-5)

     salam ButterflyOfFire,

     VLC patch at <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834c08674676e209afa842053aca>

     Mplayer patch: update svn to revision 29447.

     New Releases: ??

     thx.

     [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=5#respond)
5. [zendyani](http://www.webmaster-dz.com) says:
   [July 28, 2009 at 12:06 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-6)

   bon courage a toi tixxdz, jolie travail.

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=6#respond)
7. [secdz](http://secdz.blogspot.com) says:
   [July 28, 2009 at 8:21 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-7)

   J’ai pas encore lu le billet …je veux juste te féliciter pour le nouveau blog …enfin :)

   Je reviendrais pour apprendre de ton billet

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=7#respond)
9. [Amar De Annaba](http://amarannaba.wordpress.com) says:
   [July 28, 2009 at 11:03 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-8)

   Un petit blog pour l’homme mais un grand pas pour les human being !!! :-)

   Bon courage !!!

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=8#respond)
11. Rama says:
    [July 29, 2009 at 3:04 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-9)

    It’s very enjoying to know someone (algerian) trying the adventure in the shakespeare’s way!

    i’m a real dummy in security but I see that you’re an expert and you really know what you’re talking about!

    anyway, you’re already caught in my reader! :D

    congratulation for the rocket’s launching as said KT! :D hope reading you very soon!

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=9#respond)
13. tixxdz says:
    [July 29, 2009 at 12:29 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-10)

    thx for all your comments and please see the EDIT to clarify the conversion issues.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=10#respond)
15. hnawelhik says:
    [July 29, 2009 at 6:05 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-11)

    je vais posé une question un peut naïve, mais vous parlez de quoi? entre programmation et anglais je suis perdu.

    salamalikom

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=11#respond)
    * tixxdz says:
      [August 1, 2009 at 12:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-13)

      salam, désolé hnawelhik pour le retard, je suis lhik maintenant (douar sans connection).

      oui effectivement le sujet parle de programmation, vulnérabilité … etc en anglais.

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=13#respond)
17. [barabas](http://pwncafe.wordpress.com/) says:
    [October 5, 2009 at 5:09 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-22)

    nice work…keep it up

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=22#respond)
    * tixxdz says:
      [October 8, 2009 at 11:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-24)

      thx barabas and nice to see you here

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=24#respond)
19. Xuphanc says:
    [July 3, 2010 at 1:26 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-26)

    Hey..

    I’ve seen before the RTSP and SSA support vuln through my debuging system..LOL, It seem A nice to make a POC,I think that the new versoion has not yet fixed the integer underflow in Real pseudo-RTSP module? Any way congrtatulation weld bladi..I m so happy to hear/t ;) good new about you..Inchallah more and more..

    Keep doing..

    /Xuphanc.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=26#respond)
21. Jugurtha Hadjar says:
    [December 11, 2010 at 12:03 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-28)

    J’étais en train de regarder une vidéo [La présentation de Fyodor au Defcon18, Nmap Scripting Engine] .. Il y avait un certain “nfs-ls”…

    J’ai vu le nom de l’auteur, qui sonnait plutôt familier.. A Google query later.. ça a donné des échanges archivés des mailing lists, avec le co-auteur, ainsi que ce blog.

    Intéressant :)

    Bookmarked of course.

    Keep it up,

    USTHB.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=28#respond)
23. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](http://007software.net/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 6, 2015 at 3:30 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-44)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=44#respond)
25. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](http://extracheesy.net/news/2015/01/07/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 7, 2015 at 11:16 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-46)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=46#respond)
27. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 « ECI Blog @WordPress](https://ecinetworks.wordpress.com/2015/01/10/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-47)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=47#respond)
29. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-48)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=48#respond)
31. [(SB15-005) Vulnerability Summary for the Week of December 29, 2014 | ECI Networks](http://ecinetworks.com/?p=2463) says:
    [February 14, 2015 at 8:42 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-52)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=52#respond)
33. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](http://www.isecurestuff.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [February 23, 2015 at 10:18 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-54)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=54#respond)

### Leave a comment [Cancel reply](/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#respond)

Δ

* Search
* ## DZCORE

  + [Code](https://sites.google.com/site/dzcore/code/)
  + [Advisories](https://dzcore.wordpress.com/advisories/)
  + [About](https://dzcore.wordpress.com/about/)
* ## Algerian Blogs

  + [Agence84 Technologies](http://www.agence84.com/blog/ "Agence84 Technologies Web & Mobile Blog")
  + [Amar De Annaba](http://amarannaba.wordpress.com/ "Amar Super Blog")
  + [Bikora Questions/Réponses](http://bikora.com)
  + [FreeFoxTV](http://www.freefoxtv.net/ "ButterflyOfFire blog")
  + [Gineblog](http://gineblog.olympe-network.com/ "Gineblog")
  + [KT Algerie](http://ktalgerie.blogspot.com/ "KT Algerie blog")
  + [Youknowriad](http://youknowriad.nomade-dz.com/ "Youknowriad Blog")
* ## Algerian Open Source Blogs

  + [InalGnu == Open source](http://inalgnu.nomade-dz.com/ "InalGnu Blog")
  + [Le Blog De Amarsoft](http://amarsoftdz.blogspot.com/ "Amarsoft blog")
  + [Le bric-à-brac](http://lebricabrac.wordpress.com/ "Havoc Blog")
  + [Tuxargon Open Source Power](http://pressenux.tuxfamily.org/ "Tuxargon blog")
  + [Ubuntu Algérie](http://ubuntu-algerie.blogspot.com/)
* ## Algerian Security Blogs

  + [Hack your mind](http://www.webmaster-dz.com/ "Hack your mind")
  + [InfoSecDz](http://infosecdz.blogspot.com/ "infosecdz blog")
  + [IT & Security in Algeria](http://secdz.blogspot.com/ "secdz blog")
  + [Th3 Under9rond Rev0Lut!oN](http://hors-sujets.blogspot.com/ "Th3 Under9rond Rev0Lut!oN Blog")
* ## Archives

  + [January 2011](https://dzcore.wordpress.com/2011/01/)
  + [July 2009](https://dzcore.wordpress.com/2009/07/)
* ## Categories

  + [Advisories](https://dzcore.wordpress.com/category/advisories/)
  + [Uncategorized](https://dzcore.wordpress.com/category/uncategorized/)

* [Comment](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pxpYP-k)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/)
  + [View post in Reader](https://wordpress.com/read/blogs/7964695/posts/20)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from openwall.com_6546ba0e_20250125_141017.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2010/06/03/6) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <771209333.1202871275682090696.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Fri, 4 Jun 2010 16:08:10 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: coley <coley@...re.org>
Subject: Re: CVE requests for mplayer/vlc and abcm2ps

----- "Moritz Muehlenhoff" <jmm@...ian.org> wrote:

> Hi,
> please assign CVE IDs for these issues:
>
> 1. mplayer/VLC:
> <http://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/>
> <http://www.debian.org/security/2010/dsa-2044>
> <http://www.debian.org/security/2010/dsa-2043>

It's the same code that causes both of these. We'll use one id:
CVE-2010-2062

>
> 2. abcm2ps:
> <http://moinejf.free.fr/abcm2ps-5.txt>
>

Steve,

Can you deal with this one. I lack the time or talent to parse "Fix more
security vulnerabilities"

Thanks.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from dzcore.wordpress.com_8b9cd94b_20250125_141021.html ===

# [DZCORE](https://dzcore.wordpress.com/)

Open Source & Computer Security

* [Home](https://dzcore.wordpress.com/)
* [About](https://dzcore.wordpress.com/about/)
* [Advisories](https://dzcore.wordpress.com/advisories/)

## [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow

hello

I have published a security advisory for Mplayer and VLC: [[DZC-2009-001]](https://sites.google.com/site/dzcore/misc/dzcore-2009-001-advisory.txt)

Advisory blog post:

Advisory:

The Movie Player and VLC Media Player Real Data Transport

parsing integer underflow.

Affected products:

The Movie player <= svn r29446 [1]

VLC media player <= 1.0.0 [2]

Possible others applications that use the xine lib code [3].

Discovred by:

tixxDZ

DZCORE Labs, Algeria

Date reported:

2009/07/25

Release Date:

2009/07/27

Solutions:

VLC: update to VLC media player 1.0.1 [2] [4].

Mplayer: update to svn r29447.

———

Abstract:

———

Mplayer

Source file: stream/realrtsp/real.c

function: int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, char \*\*buffer, int rdt\_rawdata)

VLC

Source file: modules/access/rtsp/real.c

function: int real\_get\_rdt\_chunk\_header(rtsp\_client\_t \*rtsp\_session, rmff\_pheader\_t \*ph)

The original code is part of the xine library [3]:

Source file: src/input/libreal/real.c

function:  int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer)

Function real\_get\_rdt\_chunk() calls rtsp\_read\_data() to read RDT (Real Data Transport) chunks headers from the network and after that it will parse them.

A controled variable is used to allocate a buffer and later passed on to the rtsp\_read\_data() function in order to specify the length of an RDT chunk data to read from the network.

An integer underflow can be triggered when parsing a malformed RDT header chunk, a remote attacker can exploit it to execute arbitrary code in the context of the application.

The xine lib [3] seems not to be vulnerable due to an additional check in the xio\_rw\_abort() funcion (file: src/xine-engine/io\_helper.c), which takes the length of an RDT packet as an off\_t type and performs some comparison checks (line: 350) before reading chunks from the network.

The Movie player [1] and the VLC media player [2] are vulnerable, the length of an RDT packet is passed as an unsigned int to their own network read functions.

———–

Descripton:

———–

xine-lib source file: src/input/libreal/real.c

int real\_get\_rdt\_chunk(rtsp\_t \*rtsp\_session, unsigned char \*\*buffer) {

int n=1;

uint8\_t header[8];

rmff\_pheader\_t ph;

int size;

int flags1;

int unknown1;

uint32\_t ts;

n=rtsp\_read\_data(rtsp\_session, header, 8);

if (n<8) return 0;

if (header[0] != 0x24)

{

lprintf(“rdt chunk not recognized: got 0x%02x\n”, header[0]);

return 0;

}

size=(header[1]<<16)+(header[2]<<8)+(header[3]); **/\* [1] \*/**

flags1=header[4];

if ((flags1!=0x40)&&(flags1!=0x42))

{

lprintf(“got flags1: 0x%02x\n”,flags1);

if (header[6]==0x06)

{

lprintf(“got end of stream packet\n”);

return 0;

}

…

size-=9; **/\* [2] \*/**

}

unknown1=(header[5]<<16)+(header[6]<<8)+(header[7]);

n=rtsp\_read\_data(rtsp\_session, header, 6);

if (n<6) return 0;

ts=\_X\_BE\_32(header);

lprintf(“ts: %u size: %u, flags: 0x%02x, unknown values: %u

0x%02x 0x%02x\n”,

ts, size, flags1, unknown1, header[4], header[5]);

size+=2; **/\* [3] \*/**

ph->object\_version=0;

ph->length=size; **/\* [4] \*/**

ph->stream\_number=(flags1>>1)&1;

ph->timestamp=ts;

ph->reserved=0;

ph->flags=0; /\* TODO: determine keyframe flag and insert here? \*/

xine\_buffer\_ensure\_size(\*buffer, 12+size); **/\* [5] \*/**

rmff\_dump\_pheader(&ph, \*buffer);

size-=12; **/\* [6] \*/**

n=rtsp\_read\_data(rtsp\_session, (\*buffer)+12, size); **/\* [7] \*/**

return (n <= 0) ? 0 : n+12;

}

**[1]** The signed int size variable is filled with data from the network.

**[2] [3]** Some arithmetics operations, we assume that at the end size == 11.

**[4]** The value of the size variable is assigned to the ph->length.

**[5]** The size variable is used to allocate (realloc) space for the buffer.

**[6]** An integer underflow is triggered, size == 0xffffffff.

**[7]** The size variable is passed to the rtsp\_read\_data() function as an

unsigned integer in order to specify the length of an RDT packet.

Mplayer:

Mplayer is vulnerable, the rtsp\_read\_data() function passes the

length to the read\_stream() function (file: stream/librtsp/rtsp.c) as

a size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

VLC:

VLC is vulnerable, the real\_get\_rdt\_chunk\_header() function will read

and parse the header, the vulnerable call to the rtsp\_read\_data()

function is made by the real\_get\_rdt\_chunk() function, the length is

passed to the \_\_net\_Read() function (file: src/network/io.c) as a

size\_t type which can lead to read a big amount of data from the

network and cause a heap overflow.

——–

Patches:

——–

VLC

Official patch by the VideoLAN team (Patch development time: 2 hours) [4].

Mplayer

Official patch by the Mplayer team, please update svn to revision 29447.

———–

References:

———–

[1] <http://www.mplayerhq.hu/>

[2] <http://www.videolan.org/>

[3] <http://www.xine-project.org/>

[4] <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834>

c08674676e209afa842053aca

———–

Disclaimer:

———–

The document is provided as is without warranty of any kind. The content

may change without notice. In no event shall the author be liable for any

special, direct or indirect damages, losses or unlawful offences.

Use at your own risk.

Copyright (c) 2009 tix tixxDZ, DZCORE Labs. All rights reserved.

#end

PS: the [original Advisory](http://archives.neohapsis.com/archives/bugtraq/2009-07/0198.html) published on bugtraq contains an unofficial patch of mine to the Mplayer, however the Mplayer Team responded quickly and a patch is available, please update to svn revision 29447.

PS: the VideoLan team had already corrected the bug and normally the VLC version 1.0.1 will be available soon.

**EDIT:**

**[5]** Allocating (realloc) memory for the buffer (memory size: 12 + 11 bytes)

**[6]** Integer underflow, size == -1 == 0xffffffff

**[7]** The size variable is used as an unsigned integer to read data from the network, please see the conversion table below:

* 32bit signed int max value:  2147483647 (0x7fffffff)
* 32bit signed int min value:   -2147483648 (0x80000000)
* 32bit unsigned int max value:  4294967295 (0xffffffff)
* 32bit unsigned int min value:   0

so if we are dealing with an unsigned int the value -1 will be converted to 4294967295 and in this case the network function will try to read 4GB of data into the buffer.

### Share this:

* [Facebook](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=facebook "Click to share on Facebook")
* [X](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Monday, July 27th, 2009 at 8:42 pm and is filed under [Advisories](https://dzcore.wordpress.com/category/advisories/). You can follow any responses to this entry through the [RSS 2.0](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/feed/) feed.
You can [leave a response](#respond), or [trackback](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/trackback/) from your own site.

### Post navigation

[Next Post »](https://dzcore.wordpress.com/2011/01/19/new-home/)

### 20 Responses to *[DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow*

1. [FreeFoxTV (butterflyoffire) 's status on Tuesday, 28-Jul-09 08:20:23 UTC - Identi.ca](http://identi.ca/notice/7133249) says:
   [July 28, 2009 at 8:20 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-2)

   […] [DZC-2009-001] The Movie Player and VLC Media Player Real Data Transport parsing integer underflow … […]

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=2#respond)
3. [ButterflyOfFire](http://www.freefoxtv.net) says:
   [July 28, 2009 at 8:29 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-3)

   Thanks tixxDZ, I’ll send a notification through identi.ca.

   Ihope that a patch will be released soon ;)

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=3#respond)
   * tixxdz says:
     [July 28, 2009 at 11:06 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-5)

     salam ButterflyOfFire,

     VLC patch at <http://git.videolan.org/?p=vlc.git;a=commitdiff;h=dc74600c97eb834c08674676e209afa842053aca>

     Mplayer patch: update svn to revision 29447.

     New Releases: ??

     thx.

     [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=5#respond)
5. [zendyani](http://www.webmaster-dz.com) says:
   [July 28, 2009 at 12:06 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-6)

   bon courage a toi tixxdz, jolie travail.

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=6#respond)
7. [secdz](http://secdz.blogspot.com) says:
   [July 28, 2009 at 8:21 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-7)

   J’ai pas encore lu le billet …je veux juste te féliciter pour le nouveau blog …enfin :)

   Je reviendrais pour apprendre de ton billet

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=7#respond)
9. [Amar De Annaba](http://amarannaba.wordpress.com) says:
   [July 28, 2009 at 11:03 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-8)

   Un petit blog pour l’homme mais un grand pas pour les human being !!! :-)

   Bon courage !!!

   [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=8#respond)
11. Rama says:
    [July 29, 2009 at 3:04 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-9)

    It’s very enjoying to know someone (algerian) trying the adventure in the shakespeare’s way!

    i’m a real dummy in security but I see that you’re an expert and you really know what you’re talking about!

    anyway, you’re already caught in my reader! :D

    congratulation for the rocket’s launching as said KT! :D hope reading you very soon!

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=9#respond)
13. tixxdz says:
    [July 29, 2009 at 12:29 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-10)

    thx for all your comments and please see the EDIT to clarify the conversion issues.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=10#respond)
15. hnawelhik says:
    [July 29, 2009 at 6:05 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-11)

    je vais posé une question un peut naïve, mais vous parlez de quoi? entre programmation et anglais je suis perdu.

    salamalikom

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=11#respond)
    * tixxdz says:
      [August 1, 2009 at 12:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-13)

      salam, désolé hnawelhik pour le retard, je suis lhik maintenant (douar sans connection).

      oui effectivement le sujet parle de programmation, vulnérabilité … etc en anglais.

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=13#respond)
17. [barabas](http://pwncafe.wordpress.com/) says:
    [October 5, 2009 at 5:09 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-22)

    nice work…keep it up

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=22#respond)
    * tixxdz says:
      [October 8, 2009 at 11:33 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-24)

      thx barabas and nice to see you here

      [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=24#respond)
19. Xuphanc says:
    [July 3, 2010 at 1:26 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-26)

    Hey..

    I’ve seen before the RTSP and SSA support vuln through my debuging system..LOL, It seem A nice to make a POC,I think that the new versoion has not yet fixed the integer underflow in Real pseudo-RTSP module? Any way congrtatulation weld bladi..I m so happy to hear/t ;) good new about you..Inchallah more and more..

    Keep doing..

    /Xuphanc.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=26#respond)
21. Jugurtha Hadjar says:
    [December 11, 2010 at 12:03 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-28)

    J’étais en train de regarder une vidéo [La présentation de Fyodor au Defcon18, Nmap Scripting Engine] .. Il y avait un certain “nfs-ls”…

    J’ai vu le nom de l’auteur, qui sonnait plutôt familier.. A Google query later.. ça a donné des échanges archivés des mailing lists, avec le co-auteur, ainsi que ce blog.

    Intéressant :)

    Bookmarked of course.

    Keep it up,

    USTHB.

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=28#respond)
23. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | 007 Software](http://007software.net/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 6, 2015 at 3:30 am](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-44)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=44#respond)
25. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | ECNN](http://extracheesy.net/news/2015/01/07/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 7, 2015 at 11:16 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-46)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=46#respond)
27. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 « ECI Blog @WordPress](https://ecinetworks.wordpress.com/2015/01/10/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-47)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=47#respond)
29. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [January 10, 2015 at 10:49 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-48)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=48#respond)
31. [(SB15-005) Vulnerability Summary for the Week of December 29, 2014 | ECI Networks](http://ecinetworks.com/?p=2463) says:
    [February 14, 2015 at 8:42 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-52)

    […] MISC (link is external) FULLDISC MLIST (link is external) […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=52#respond)
33. [SB15-005: Vulnerability Summary for the Week of December 29, 2014 - iSecurestuff](http://www.isecurestuff.com/sb15-005-vulnerability-summary-for-the-week-of-december-29-2014/) says:
    [February 23, 2015 at 10:18 pm](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comment-54)

    […] CVE-2010-2062MISCFULLDISCMLISTCONFIRM […]

    [Reply](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/?replytocom=54#respond)

### Leave a comment [Cancel reply](/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#respond)

Δ

* Search
* ## DZCORE

  + [Code](https://sites.google.com/site/dzcore/code/)
  + [Advisories](https://dzcore.wordpress.com/advisories/)
  + [About](https://dzcore.wordpress.com/about/)
* ## Algerian Blogs

  + [Agence84 Technologies](http://www.agence84.com/blog/ "Agence84 Technologies Web & Mobile Blog")
  + [Amar De Annaba](http://amarannaba.wordpress.com/ "Amar Super Blog")
  + [Bikora Questions/Réponses](http://bikora.com)
  + [FreeFoxTV](http://www.freefoxtv.net/ "ButterflyOfFire blog")
  + [Gineblog](http://gineblog.olympe-network.com/ "Gineblog")
  + [KT Algerie](http://ktalgerie.blogspot.com/ "KT Algerie blog")
  + [Youknowriad](http://youknowriad.nomade-dz.com/ "Youknowriad Blog")
* ## Algerian Open Source Blogs

  + [InalGnu == Open source](http://inalgnu.nomade-dz.com/ "InalGnu Blog")
  + [Le Blog De Amarsoft](http://amarsoftdz.blogspot.com/ "Amarsoft blog")
  + [Le bric-à-brac](http://lebricabrac.wordpress.com/ "Havoc Blog")
  + [Tuxargon Open Source Power](http://pressenux.tuxfamily.org/ "Tuxargon blog")
  + [Ubuntu Algérie](http://ubuntu-algerie.blogspot.com/)
* ## Algerian Security Blogs

  + [Hack your mind](http://www.webmaster-dz.com/ "Hack your mind")
  + [InfoSecDz](http://infosecdz.blogspot.com/ "infosecdz blog")
  + [IT & Security in Algeria](http://secdz.blogspot.com/ "secdz blog")
  + [Th3 Under9rond Rev0Lut!oN](http://hors-sujets.blogspot.com/ "Th3 Under9rond Rev0Lut!oN Blog")
* ## Archives

  + [January 2011](https://dzcore.wordpress.com/2011/01/)
  + [July 2009](https://dzcore.wordpress.com/2009/07/)
* ## Categories

  + [Advisories](https://dzcore.wordpress.com/category/advisories/)
  + [Uncategorized](https://dzcore.wordpress.com/category/uncategorized/)

* [Comment](https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) DZCORE](https://dzcore.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdzcore.wordpress.com%2F2009%2F07%2F27%2Fdzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pxpYP-k)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://dzcore.wordpress.com/2009/07/27/dzc-2009-001-the-movie-player-and-vlc-media-player-real-data-transport-parsing-integer-underflow/)
  + [View post in Reader](https://wordpress.com/read/blogs/7964695/posts/20)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)


