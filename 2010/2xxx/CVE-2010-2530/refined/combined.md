=== Content from www.openwall.com_9ee76409_20250125_005524.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2010/07/12/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1014759682.654471279292894070.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Fri, 16 Jul 2010 11:08:14 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: security-alert@...bsd.org, secteam@...ebsd.org, product-security@...le.com,
        coley <coley@...re.org>
Subject: Re: CVE request: NetSMB BSD kernel module (minor)

Please use CVE-2010-2530

Sorry for the delay.

--
    JB

----- "Dan Rosenberg" <dan.j.rosenberg@...il.com> wrote:

> I discovered and reported a minor security issue in the netsmb kernel
> module for NetBSD and FreeBSD.  The issue also affects Mac OS X 10.x,
> where netsmb is available as a kernel extension.
>
> Several of the subroutines in the netsmb module (see reference below
> for vulnerable functions), which are reachable by unprivileged local
> users via device ioctls sent to a /dev/nsmb* device, had signedness
> errors.  By providing a negative value for a size field for certain
> device ioctls (including SMBIOC_LOOKUP and SMBIOC_OPENSESSION for
> *BSD), a size check will be bypassed and a memory overallocation will
> occur, causing a kernel panic.  NetBSD committed their fix to CVS
> today:
>
> <http://cvsweb.netbsd.org/bsdweb.cgi/src/sys/netsmb/smb_subr.c.diff?r1=1.34&r2=1.35&only_with_tag=MAIN&f=h>
>
> Regards,
> Dan Rosenberg

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_865fe052_20250125_005523.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[thread-next>]](../../../2010/07/16/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <AANLkTikiFgeQgr18P6Iwavf9kYBSfJky0I_GJ-cOKhBX@mail.gmail.com>
Date: Mon, 12 Jul 2010 14:33:31 -0400
From: Dan Rosenberg <dan.j.rosenberg@...il.com>
To: oss-security@...ts.openwall.com, coley <coley@...re.org>
Cc: security-alert@...bsd.org, secteam@...ebsd.org, product-security@...le.com
Subject: CVE request: NetSMB BSD kernel module (minor)

I discovered and reported a minor security issue in the netsmb kernel
module for NetBSD and FreeBSD.  The issue also affects Mac OS X 10.x,
where netsmb is available as a kernel extension.

Several of the subroutines in the netsmb module (see reference below
for vulnerable functions), which are reachable by unprivileged local
users via device ioctls sent to a /dev/nsmb* device, had signedness
errors.  By providing a negative value for a size field for certain
device ioctls (including SMBIOC_LOOKUP and SMBIOC_OPENSESSION for
*BSD), a size check will be bypassed and a memory overallocation will
occur, causing a kernel panic.  NetBSD committed their fix to CVS
today:

<http://cvsweb.netbsd.org/bsdweb.cgi/src/sys/netsmb/smb_subr.c.diff?r1=1.34&r2=1.35&only_with_tag=MAIN&f=h>

Regards,
Dan Rosenberg

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from cvsweb.netbsd.org_a34c93b9_20250125_005522.html ===


| [[BACK]](/bsdweb.cgi/src/sys/netsmb/Attic/smb_subr.c?f=h;only_with_tag=MAIN#rev1.35)**Return to [smb\_subr.c](/bsdweb.cgi/src/sys/netsmb/Attic/smb_subr.c?f=h;only_with_tag=MAIN#rev1.35) CVS log** [TXT] | [DIR] **Up to [[cvs.NetBSD.org]](/bsdweb.cgi/?f=h;only_with_tag=MAIN#dirlist) / [src](/bsdweb.cgi/src/?f=h;only_with_tag=MAIN#dirlist) / [sys](/bsdweb.cgi/src/sys/?f=h;only_with_tag=MAIN#dirlist) / [netsmb](/bsdweb.cgi/src/sys/netsmb/?f=h;only_with_tag=MAIN#dirlist)** |
| --- | --- |

| Please note that diffs are not public domain; they are subject to the copyright notices on the relevant files. |
| --- |

### Diff for /src/sys/netsmb/Attic/smb\_subr.c between versions 1.34 and 1.35

| [version 1.34](smb_subr.c?f=h;only_with_tag=MAIN;rev=1.34), 2009/04/18 14:58:07 | [version 1.35](smb_subr.c?f=h;only_with_tag=MAIN;rev=1.35), 2010/07/12 02:58:01 |
| --- | --- |
| **[Line 96](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.34#l96)**  char \* | **[Line 96](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.35#l96)**  char \* |
| smb\_strdup(const char \*s) | smb\_strdup(const char \*s) |
| { | { |
| char \*p; | char \*p; |
| int len; | size\_t len; |
|  |  |
| len = s ? strlen(s) + 1 : 1; | len = s ? strlen(s) + 1 : 1; |
| p = malloc(len, M\_SMBSTR, M\_WAITOK); | p = malloc(len, M\_SMBSTR, M\_WAITOK); |
| **[Line 111](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.34#l111)**  smb\_strdup(const char \*s) | **[Line 111](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.35#l111)**  smb\_strdup(const char \*s) |
| \* duplicate string from a user space. | \* duplicate string from a user space. |
| \*/ | \*/ |
| char \* | char \* |
| smb\_strdupin(char \*s, int maxlen) | smb\_strdupin(char \*s, size\_t maxlen) |
| { | { |
| char \*p, bt; | char \*p, bt; |
| int len = 0; | size\_t len = 0; |
|  |  |
| for (p = s; ;p++) { | for (p = s; ;p++) { |
| if (copyin(p, &bt, 1)) | if (copyin(p, &bt, 1)) |
| **[Line 134](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.34#l134)**  smb\_strdupin(char \*s, int maxlen) | **[Line 134](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.35#l134)**  smb\_strdupin(char \*s, int maxlen) |
| \* duplicate memory block from a user space. | \* duplicate memory block from a user space. |
| \*/ | \*/ |
| void \* | void \* |
| smb\_memdupin(void \*umem, int len) | smb\_memdupin(void \*umem, size\_t len) |
| { | { |
| char \*p; | char \*p; |
|  |  |
| **[Line 160](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.34#l160)**  smb\_memfree(void \*s) | **[Line 160](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.35#l160)**  smb\_memfree(void \*s) |
| } | } |
|  |  |
| void \* | void \* |
| smb\_zmalloc(unsigned long size, struct malloc\_type \*type, int flags) | smb\_zmalloc(size\_t size, struct malloc\_type \*type, int flags) |
| { | { |
|  |  |
| return malloc(size, type, flags | M\_ZERO); | return malloc(size, type, flags | M\_ZERO); |
| **[Line 179](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.34#l179)**  smb\_strtouni(u\_int16\_t \*dst, const char | **[Line 179](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.35#l179)**  smb\_strtouni(u\_int16\_t \*dst, const char |
| void | void |
| m\_dumpm(struct mbuf \*m) { | m\_dumpm(struct mbuf \*m) { |
| char \*p; | char \*p; |
| int len; | size\_t len; |
| printf("d="); | printf("d="); |
| while(m) { | while(m) { |
| p=mtod(m,char \*); | p = mtod(m,char \*); |
| len=m->m\_len; | len = m->m\_len; |
| printf("(%d)",len); | printf("(%zu)", len); |
| while(len--){ | while(len--){ |
| printf("%02x ",((int)\*(p++)) & 0xff); | printf("%02x ",((int)\*(p++)) & 0xff); |
| } | } |
| **[Line 315](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.34#l315)**  smb\_copy\_iconv(struct mbchain \*mbp, cons | **[Line 315](smb_subr.c?f=h;only_with_tag=MAIN;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.35#l315)**  smb\_copy\_iconv(struct mbchain \*mbp, cons |
|  |  |
| int | int |
| smb\_put\_dmem(struct mbchain \*mbp, struct smb\_vc \*vcp, const char \*src, | smb\_put\_dmem(struct mbchain \*mbp, struct smb\_vc \*vcp, const char \*src, |
| int size, int caseopt) | size\_t size, int caseopt) |
| { | { |
| struct iconv\_drv \*dp = vcp->vc\_toserver; | struct iconv\_drv \*dp = vcp->vc\_toserver; |
|  |  |

---

Diff format:

Colored
Long colored
Unified
Context
Side by side

| Removed from v.1.34 |  |
| --- | --- |
| changed lines | |
|  | Added in v.1.35 |

---

CVSweb <webmaster@jp.NetBSD.org>

