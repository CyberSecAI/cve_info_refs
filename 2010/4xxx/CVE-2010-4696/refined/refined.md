```
Message-ID: <20101112224816.73b27d22@foo.fgeek.fi>
Date: Fri, 12 Nov 2010 22:48:16 +0200
From: Henri Salo <henri@...v.fi>
To: "oss-security" <oss-security@...ts.openwall.com>
Subject: CVE request: Joomla 1.5.21 SQL Injection and Information Disclosure

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Can I get CVE-identifier for this issue?

"Multiple vulnerabilities have been discovered in Joomla, which can be
exploited by malicious people to conduct SQL injection attacks.

Input passed via the "filter_order" and "filter_order_Dir" parameters
to index.php (e.g. when "option" is set to "com_weblinks",
"com_contact", or "com_messages") is not properly verified before being
used in a SQL query. This can be exploited to manipulate SQL queries by
injecting limited SQL code, which may result in e.g. information
disclosure via database errors."

Vulnerable versions: 1.5.21 and all previous 1.5 releases
Solution: Update to 1.5.22 (or later)

Referers:
<http://secunia.com/advisories/42133>
<http://developer.joomla.org/security/news/9-security/10-core-security/323-20101101-core-sqli-info-disclosurevulnerabilities.html>
<http://archives.neohapsis.com/archives/fulldisclosure/2010-10/0514.html>

Best regards,
Henri Salo
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkzdqBAACgkQXf6hBi6kbk8lFACgmpIFET/szRnKRNpVO0COQuFd
pXcAoMwVjrf3/8PzOIOBuWkxMBW9lodS
=AgJf
-----END PGP SIGNATURE-----
```
```
Message-ID: <45808337.880901289596807903.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Fri, 12 Nov 2010 16:20:07 -0500 (EST)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: coley <coley@...re.org>
Subject: Re: CVE request: Joomla 1.5.21 SQL Injection and
 Information Disclosure

----- "Henri Salo" <henri@...v.fi> wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Can I get CVE-identifier for this issue?
>
> "Multiple vulnerabilities have been discovered in Joomla, which can be
> exploited by malicious people to conduct SQL injection attacks.
>
> Input passed via the "filter_order" and "filter_order_Dir" parameters to
> index.php (e.g. when "option" is set to "com_weblinks", "com_contact", or
> "com_messages") is not properly verified before being used in a SQL
> query. This can be exploited to manipulate SQL queries by injecting
> limited SQL code, which may result in e.g. information disclosure via
> database errors."
>
> Vulnerable versions: 1.5.21 and all previous 1.5 releases
> Solution: Update to 1.5.22 (or later)
>
> Referers:
> <http://secunia.com/advisories/42133>
> <http://developer.joomla.org/security/news/9-security/10-core-security/323-20101101-core-sqli-info-disclosurevulnerabilities.html>
> <http://archives.neohapsis.com/archives/fulldisclosure/2010-10/0514.html>
>

This one is confusing. The full-disclosure post also seems to cover
CVE-2010-3712, which was fixed in Joomla 1.5.21.

For the SQL injection issues, let's use CVE-2010-4166.

Thanks.

--
    JB
```
Based on the provided content, specifically the email thread, the following information can be extracted regarding the vulnerability:

**Root Cause of Vulnerability:**
- Improper sanitization of user-supplied input passed through the `filter_order` and `filter_order_Dir` parameters within the `index.php` file.

**Weaknesses/Vulnerabilities Present:**
- SQL Injection: The vulnerability lies in the fact that the unsanitized input is directly used in SQL queries, allowing attackers to inject malicious SQL code.

**Impact of Exploitation:**
- Information Disclosure: Successful exploitation could allow an attacker to manipulate SQL queries leading to information disclosure through database errors.

**Attack Vectors:**
- HTTP GET parameters: Attackers exploit the vulnerability by injecting malicious SQL code through the `filter_order` and `filter_order_Dir` parameters within HTTP requests.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send HTTP requests to the vulnerable Joomla application with crafted `filter_order` and `filter_order_Dir` parameters. No authentication is mentioned as a requirement.

**Additional Notes:**

*   The vulnerability affects Joomla versions 1.5.21 and all previous 1.5 releases.
*   The vulnerability can be triggered when the `option` parameter is set to `com_weblinks`, `com_contact`, or `com_messages`.
*   The recommended solution is to upgrade to Joomla version 1.5.22 or later.
*   The content mentions that the full-disclosure post seems to cover CVE-2010-3712, which was fixed in Joomla 1.5.21, indicating some overlap or confusion.
*   CVE-2010-4166 is designated for the SQL injection issue described.