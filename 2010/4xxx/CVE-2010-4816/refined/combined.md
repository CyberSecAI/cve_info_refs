=== Content from seclists.org_05a73505_20250124_193120.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](116)
[By Date](date.html#117)
[![Next](/images/right-icon-16x16.png)](118)

[![Previous](/images/left-icon-16x16.png)](116)
[By Thread](index.html#117)
[![Next](/images/right-icon-16x16.png)](138)

![](/shared/images/nst-icons.svg#search)

# FreeBSD and OpenBSD ftpd bug (not exploitable?)

---

*From*: Kingcope <kcope2 () googlemail com>

*Date*: Fri, 05 Mar 2010 16:19:12 +0100

---

```
FreeBSD ftpd globbing bug - null pointer dereference ?

Affected FreeBSD Releases
+-+-+-+-+-+-+-+-+-+
FreeBSD 8.0, 6.3 and 4.9

Affected OpenBSD Releases
+-+-+-+-+-+-+-+-+-+
OpenBSD 4.6

Testing Environment
+-+-+-+-+-+-+-+-+-+
FreeBSD localhost.Belkin 8.0-RELEASE FreeBSD 8.0-RELEASE #0: Sat Nov 21
15:48:17 UTC 2009
root () almeida cse buffalo edu:/usr/obj/usr/src/sys/GENERIC  i386

Full Description
+-+-+-+-+-+-+-+-+-+
FreeBSD (tested back to 4.9-Release) (and OpenBSD 4.6) has a bug in its
ftpd when handling globbing requests.

My investigation results in this being a null pointer dereference in
popen.c.
I am not sure if this could be a heap overrun, but I don't think so.

from popen.c:

        /* glob each piece */
        gargv[0] = argv[0];
        for (gargc = argc = 1; argv[argc] && gargc < (MAXGLOBARGS-1); argc++) {
                glob_t gl;
                int flags = GLOB_BRACE|GLOB_NOCHECK|GLOB_TILDE;

                memset(&gl, 0, sizeof(gl));
                gl.gl_matchc = MAXGLOBARGS;
                flags |= GLOB_LIMIT;
[1]             if (glob(argv[argc], flags, NULL, &gl))
                        gargv[gargc++] = strdup(argv[argc]);
[2]             else
[3]                     for (pop = gl.gl_pathv; *pop && gargc < (MAXGLOBARGS-1);
                             pop++)
                                gargv[gargc++] = strdup(*pop);
                globfree(&gl);
        }

At [1] glob() is called. if theres a long directory (for example "A" x
200) and a request like described
in "how to repeat this problem" is sent to the ftpd it crashes. My
assumption is because it lands in the
else clause [2], glob doesn't fail but gives back a zeroed out gl
structure. In [3] then there's no check
if pop is null and therefore *pop gets dereferenced which is a null
pointer and the ftpd instance crashes.

Could someone please shed some light into why glob doesn't fail but
gives a zeroed out structure back?

How to repeat the problem
+-+-+-+-+-+-+-+-+-+-+-+-+-+

$ ftp 192.168.2.11
Connected to 192.168.2.11.
220 localhost.Belkin FTP server (Version 6.00LS) ready.
Name (192.168.2.11:nr): kcope
331 Password required for kcope.
Password:
230 User kcope logged in.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> mkdir
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
257
"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW"
 directory created.
ftp> ls {W*/../W*/../W*/../W*/../W*/../W*/../W*/}
200 PORT command successful.
---snip---

on the other side:

---snip---
0x282261e5 in read () at read.S:3
3       RSYSCALL(read)
Current language:  auto; currently asm
(gdb) c
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x0805622c in getline ()
(gdb) i r
eax            0x0      0
ecx            0x0      0
edx            0x0      0
ebx            0xbfbfd911       -1077946095
esp            0xbfbfba70       0xbfbfba70
ebp            0xbfbfcc08       0xbfbfcc08
esi            0x1      1
edi            0xbfbfcbf4       -1077949452
eip            0x805622c        0x805622c
eflags         0x10293  66195
cs             0x33     51
ss             0x3b     59
ds             0x3b     59
es             0x3b     59
fs             0x3b     59
gs             0x1b     27
(gdb) x/10i $eip
0x805622c <getline+12620>:      mov    (%edx),%eax
0x805622e <getline+12622>:      setle  %cl
0x8056231 <getline+12625>:      mov    %ecx,%esi
0x8056233 <getline+12627>:      test   %eax,%eax
0x8056235 <getline+12629>:      je     0x8056281 <getline+12705>
0x8056237 <getline+12631>:      test   %cl,%cl
0x8056239 <getline+12633>:      je     0x8056281 <getline+12705>
0x805623b <getline+12635>:      mov    %edx,%ebx
0x805623d <getline+12637>:      mov    0xffffee7c(%ebp),%edx
0x8056243 <getline+12643>:      lea    0xffffee90(%ebp,%edx,4),%edi
(gdb) i f
Stack level 0, frame at 0xbfbfcc10:
 eip = 0x805622c in getline; saved eip 0x805047b
 called by frame at 0xbfbfcc14
 Arglist at 0xbfbfcc08, args:
 Locals at 0xbfbfcc08, Previous frame's sp is 0xbfbfcc10
 Saved registers:
  ebx at 0xbfbfcbfc, ebp at 0xbfbfcc08, esi at 0xbfbfcc00, edi at
0xbfbfcc04,
  eip at 0xbfbfcc0c
(gdb)

Testing program:

---snip---

#include <glob.h>
#include <stdio.h>

#define MAXUSRARGS      100
#define MAXGLOBARGS     1000

void do_glob() {
        glob_t gl;
        char **pop;

        char buffer[256];
        strcpy(buffer, "{A*/../A*/../A*/../A*/../A*/../A*/../A*}");

        int flags = GLOB_BRACE|GLOB_NOCHECK|GLOB_TILDE;
        memset(&gl, 0, sizeof(gl));
        gl.gl_matchc = MAXGLOBARGS;
        flags |= GLOB_LIMIT;
        if (glob(buffer, flags, NULL, &gl)) {
                printf("GLOB FAILED!\n");
                return 0;
        }
        else
//                for (pop = gl.gl_pathv; pop && *pop && 1 <
(MAXGLOBARGS-1);
                for (pop = gl.gl_pathv; *pop && 1 < (MAXGLOBARGS-1);
                     pop++) {
                        printf("glob success");
                        return 0;
                }
        globfree(&gl);
}

main(int argc, char **argv) {
        do_glob();
        do_glob();
}
---snip---

05 March 2010
/kingcope

```
```
_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](116)
[By Date](date.html#117)
[![Next](/images/right-icon-16x16.png)](118)

[![Previous](/images/left-icon-16x16.png)](116)
[By Thread](index.html#117)
[![Next](/images/right-icon-16x16.png)](138)

### Current thread:

* **FreeBSD and OpenBSD ftpd bug (not exploitable?)** *Kingcope (Mar 05)*
  + [Re: FreeBSD and OpenBSD ftpd bug (not exploitable?)](138) *Patrick Lamaiziere (Mar 07)*
    - [Re: FreeBSD and OpenBSD ftpd bug (not exploitable?)](258) *David Berard (Mar 15)*
  + [Re: FreeBSD and OpenBSD ftpd bug (not exploitable?)](139) *Patrick Lamaiziere (Mar 07)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_0cb057b5_20250124_193121.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](283)
[By Date](date.html#284)
[![Next](/images/right-icon-16x16.png)](285)

[![Previous](/images/left-icon-16x16.png)](281)
[By Thread](index.html#284)
[![Next](/images/right-icon-16x16.png)](357)

![](/shared/images/nst-icons.svg#search)

# Re: CVE-request: FreeBSD/NetBSD/OpenBSD(?) ftpd remote crash (2010)

---

*From*: "Mike O'Connor" <mjo () dojo mi org>

*Date*: Thu, 4 Aug 2011 15:13:24 -0400

---

```
:Can I get 2010 CVE-ID for this issue? I am not sure if other distributions/operating systems need their own IDs. If I
am correct one ID should be enough.
:
:Original discussion: <http://seclists.org/fulldisclosure/2010/Mar/117>
:Bug report to FreeBSD: <http://www.freebsd.org/cgi/query-pr.cgi?pr=144761>
:NetBSD: <http://www.netbsd.org/cgi-bin/query-pr-single.pl?number=43023>
:Reported to OpenBSD (and patched), but can't find references.

FWIW, a reference for OpenBSD is:

ftp://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/013_ftpd.patch

--
 Michael J. O'Connor                                          mjo () dojo mi org
 =--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--==--=
"All my autopsies have been performed on dead people."     -Anguished English

```

**Attachment:
[\_bin](att-284/_bin)**

*Description:*

---

[![Previous](/images/left-icon-16x16.png)](283)
[By Date](date.html#284)
[![Next](/images/right-icon-16x16.png)](285)

[![Previous](/images/left-icon-16x16.png)](281)
[By Thread](index.html#284)
[![Next](/images/right-icon-16x16.png)](357)

### Current thread:

* [CVE-request: FreeBSD/NetBSD/OpenBSD(?) ftpd remote crash (2010)](281) *Henri Salo (Aug 04)*
  + **Re: CVE-request: FreeBSD/NetBSD/OpenBSD(?) ftpd remote crash (2010)** *Mike O'Connor (Aug 04)*
  + [Re: CVE-request: FreeBSD/NetBSD/OpenBSD(?) ftpd remote crash (2010)](357) *Josh Bressers (Aug 19)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from bugs.freebsd.org_1b2481e1_20250124_193119.html ===


FreeBSD Bugzilla – Bug 144761
FTPD bug remote crash
Last modified: 2010-04-01 01:40:04 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](page.cgi?id=reporting.html)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=144761&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=144761&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 144761**](show_bug.cgi?id=144761)
- FTPD bug remote crash

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
FTPD bug remote crash

| | [Status](page.cgi?id=fields.html#bug_status): | Closed FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Base System | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Base System "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | bin ([show other bugs](buglist.cgi?component=bin&product=Base%20System&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 8.0-RELEASE | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Any Any | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal Affects Only Me | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Xin LI | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2010-03-15 12:40 UTC by David BERARD | | --- | --- | | Modified: | 2010-04-01 01:40 UTC ([History](show_activity.cgi?id=144761)) | | CC List: | 1 user (show)  laurent | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**ftpd\_popen.patch**](attachment.cgi?id=104564 "View the content of the attachment") (461 bytes, patch)  [2010-03-15 12:40 UTC](#attach_104564 "Go to the comment associated with the attachment"), David BERARD | *no flags* | [Details](attachment.cgi?id=104564&action=edit) | [Diff](attachment.cgi?id=104564&action=diff) | | [View All](attachment.cgi?bugid=144761&action=viewall)  [Add an attachment](attachment.cgi?bugid=144761&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=144761&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=144761#c0)  David BERARD    2010-03-15 12:40:07 UTC  ``` FTPD child process can die with signal 11, bug found by Kingcope 	kernel: pid 46033 (ftpd), uid 1001: exited on signal 11 References : 	<http://seclists.org/fulldisclosure/2010/Mar/117> 	<http://seclists.org/fulldisclosure/2010/Mar/138> 	<http://seclists.org/fulldisclosure/2010/Mar/139>  Fix: See the attached patch, should fix issue How-To-Repeat: 	ftp localhost 	[....login....] 	ftp> mkdir WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW 	ftp> ls {W*/../W*/../W*/../W*/../W*/../W*/../W*/} 	[....Server close connection....] ```  [Comment 1](show_bug.cgi?id=144761#c1)  Gavin Atkinson   freebsd_committer freebsd_triage  2010-03-20 14:48:34 UTC  ``` Responsible Changed From-To: freebsd-standards->freebsd-bugs  Not a PR for standards@ ```  [Comment 2](show_bug.cgi?id=144761#c2)  Rebecca Cran   freebsd_committer freebsd_triage  2010-03-20 22:51:45 UTC  ``` This has been fixed in the NetBSD repository - see <http://www.netbsd.org/cgi>- bin/query-pr-single.pl?number=43023  --  Bruce Cran ```  [Comment 3](show_bug.cgi?id=144761#c3)  Xin LI   freebsd_committer freebsd_triage  2010-03-25 22:41:11 UTC  ``` State Changed From-To: open->patched  Patch from OpenBSD applied, thanks for bringing this to our  attention!     ```  [Comment 4](show_bug.cgi?id=144761#c4)  Xin LI   freebsd_committer freebsd_triage  2010-03-25 22:41:11 UTC  ``` Responsible Changed From-To: freebsd-bugs->delphij  Take since I have patched this issue. ```  [Comment 5](show_bug.cgi?id=144761#c5)  dfilter service   freebsd_committer freebsd_triage  2010-03-25 22:41:11 UTC  ``` Author: delphij Date: Thu Mar 25 22:41:01 2010 New Revision: 205656 URL: <http://svn.freebsd.org/changeset/base/205656>  Log:   Check that gl_pathc is bigger than zero before derefencing gl_pathv.   When gl_pathc == 0, the content of gl_pathv is undefined.      PR:		bin/144761   Submitted by:	David BERARD <contact davidberard fr>   Obtained from:	OpenBSD   MFC after:	1 week  Modified:   head/libexec/ftpd/popen.c  Modified: head/libexec/ftpd/popen.c ============================================================================== --- head/libexec/ftpd/popen.c	Thu Mar 25 20:07:30 2010	(r205655) +++ head/libexec/ftpd/popen.c	Thu Mar 25 22:41:01 2010	(r205656) @@ -110,10 +110,11 @@ ftpd_popen(char *program, char *type)  		flags |= GLOB_LIMIT;  		if (glob(argv[argc], flags, NULL, &gl))  			gargv[gargc++] = strdup(argv[argc]); -		else +		else if (gl.gl_pathc > 0) {  			for (pop = gl.gl_pathv; *pop && gargc < (MAXGLOBARGS-1);  			     pop++)  				gargv[gargc++] = strdup(*pop); +		}  		globfree(&gl);  	}  	gargv[gargc] = NULL; _______________________________________________ svn-src-all@freebsd.org mailing list <http://lists.freebsd.org/mailman/listinfo/svn-src-all> To unsubscribe, send any mail to "svn-src-all-unsubscribe@freebsd.org" ```  [Comment 6](show_bug.cgi?id=144761#c6)  dfilter service   freebsd_committer freebsd_triage  2010-04-01 01:38:48 UTC  ``` Author: delphij Date: Thu Apr  1 00:38:38 2010 New Revision: 206025 URL: <http://svn.freebsd.org/changeset/base/206025>  Log:   MFC r205656:      Check that gl_pathc is bigger than zero before derefencing gl_pathv.   When gl_pathc == 0, the content of gl_pathv is undefined.      PR:		bin/144761   Submitted by:	David BERARD <contact davidberard fr>   Obtained from:	OpenBSD  Modified:   stable/8/libexec/ftpd/popen.c Directory Properties:   stable/8/libexec/ftpd/   (props changed)  Changes in other areas also in this revision: Modified:   stable/6/libexec/ftpd/popen.c   stable/7/libexec/ftpd/popen.c Directory Properties:   stable/6/libexec/ftpd/   (props changed)   stable/7/libexec/ftpd/   (props changed)  Modified: stable/8/libexec/ftpd/popen.c ============================================================================== --- stable/8/libexec/ftpd/popen.c	Thu Apr  1 00:36:40 2010	(r206024) +++ stable/8/libexec/ftpd/popen.c	Thu Apr  1 00:38:38 2010	(r206025) @@ -110,10 +110,11 @@ ftpd_popen(char *program, char *type)  		flags |= GLOB_LIMIT;  		if (glob(argv[argc], flags, NULL, &gl))  			gargv[gargc++] = strdup(argv[argc]); -		else +		else if (gl.gl_pathc > 0) {  			for (pop = gl.gl_pathv; *pop && gargc < (MAXGLOBARGS-1);  			     pop++)  				gargv[gargc++] = strdup(*pop); +		}  		globfree(&gl);  	}  	gargv[gargc] = NULL; _______________________________________________ svn-src-all@freebsd.org mailing list <http://lists.freebsd.org/mailman/listinfo/svn-src-all> To unsubscribe, send any mail to "svn-src-all-unsubscribe@freebsd.org" ```  [Comment 7](show_bug.cgi?id=144761#c7)  Xin LI   freebsd_committer freebsd_triage  2010-04-01 01:38:53 UTC  ``` State Changed From-To: patched->closed  Fixed in {6,7.8}-STABLE. ```  [Comment 8](show_bug.cgi?id=144761#c8)  dfilter service   freebsd_committer freebsd_triage  2010-04-01 01:39:09 UTC  ``` Author: delphij Date: Thu Apr  1 00:38:38 2010 New Revision: 206025 URL: <http://svn.freebsd.org/changeset/base/206025>  Log:   MFC r205656:      Check that gl_pathc is bigger than zero before derefencing gl_pathv.   When gl_pathc == 0, the content of gl_pathv is undefined.      PR:		bin/144761   Submitted by:	David BERARD <contact davidberard fr>   Obtained from:	OpenBSD  Modified:   stable/7/libexec/ftpd/popen.c Directory Properties:   stable/7/libexec/ftpd/   (props changed)  Changes in other areas also in this revision: Modified:   stable/6/libexec/ftpd/popen.c   stable/8/libexec/ftpd/popen.c Directory Properties:   stable/6/libexec/ftpd/   (props changed)   stable/8/libexec/ftpd/   (props changed)  Modified: stable/7/libexec/ftpd/popen.c ============================================================================== --- stable/7/libexec/ftpd/popen.c	Thu Apr  1 00:36:40 2010	(r206024) +++ stable/7/libexec/ftpd/popen.c	Thu Apr  1 00:38:38 2010	(r206025) @@ -110,10 +110,11 @@ ftpd_popen(char *program, char *type)  		flags |= GLOB_LIMIT;  		if (glob(argv[argc], flags, NULL, &gl))  			gargv[gargc++] = strdup(argv[argc]); -		else +		else if (gl.gl_pathc > 0) {  			for (pop = gl.gl_pathv; *pop && gargc < (MAXGLOBARGS-1);  			     pop++)  				gargv[gargc++] = strdup(*pop); +		}  		globfree(&gl);  	}  	gargv[gargc] = NULL; _______________________________________________ svn-src-all@freebsd.org mailing list <http://lists.freebsd.org/mailman/listinfo/svn-src-all> To unsubscribe, send any mail to "svn-src-all-unsubscribe@freebsd.org" ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=144761)
* - [XML](show_bug.cgi?ctype=xml&id=144761)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=144761)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](page.cgi?id=reporting.html)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=144761&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=144761&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


