=== Content from github.com_eaf2711a_20250125_142308.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fseb-m%2Fjpake)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fseb-m%2Fjpake)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=seb-m%2Fjpake)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[seb-m](/seb-m)
/
**[jpake](/seb-m/jpake)**
Public

* [Notifications](/login?return_to=%2Fseb-m%2Fjpake) You must be signed in to change notification settings
* [Fork
  15](/login?return_to=%2Fseb-m%2Fjpake)
* [Star
   23](/login?return_to=%2Fseb-m%2Fjpake)

Small-subgroup confinement issue in the OpenSSL and OpenSSH implementations of J-PAKE.

[23
stars](/seb-m/jpake/stargazers) [15
forks](/seb-m/jpake/forks) [Branches](/seb-m/jpake/branches) [Tags](/seb-m/jpake/tags) [Activity](/seb-m/jpake/activity)
 [Star](/login?return_to=%2Fseb-m%2Fjpake)

 [Notifications](/login?return_to=%2Fseb-m%2Fjpake) You must be signed in to change notification settings

* [Code](/seb-m/jpake)
* [Pull requests
  0](/seb-m/jpake/pulls)
* [Actions](/seb-m/jpake/actions)
* [Projects
  0](/seb-m/jpake/projects)
* [Security](/seb-m/jpake/security)
* [Insights](/seb-m/jpake/pulse)

Additional navigation options

* [Code](/seb-m/jpake)
* [Pull requests](/seb-m/jpake/pulls)
* [Actions](/seb-m/jpake/actions)
* [Projects](/seb-m/jpake/projects)
* [Security](/seb-m/jpake/security)
* [Insights](/seb-m/jpake/pulse)

# seb-m/jpake

    master[Branches](/seb-m/jpake/branches)[Tags](/seb-m/jpake/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/seb-m/jpake/commits/master/) | | |
| [openssh-jpake](/seb-m/jpake/tree/master/openssh-jpake "openssh-jpake") | | [openssh-jpake](/seb-m/jpake/tree/master/openssh-jpake "openssh-jpake") |  |  |
| [openssl-jpake](/seb-m/jpake/tree/master/openssl-jpake "openssl-jpake") | | [openssl-jpake](/seb-m/jpake/tree/master/openssl-jpake "openssl-jpake") |  |  |
| [.gitignore](/seb-m/jpake/blob/master/.gitignore ".gitignore") | | [.gitignore](/seb-m/jpake/blob/master/.gitignore ".gitignore") |  |  |
| [README](/seb-m/jpake/blob/master/README "README") | | [README](/seb-m/jpake/blob/master/README "README") |  |  |
| [jpake-session-key-retrieval.pdf](/seb-m/jpake/blob/master/jpake-session-key-retrieval.pdf "jpake-session-key-retrieval.pdf") | | [jpake-session-key-retrieval.pdf](/seb-m/jpake/blob/master/jpake-session-key-retrieval.pdf "jpake-session-key-retrieval.pdf") |  |  |
| View all files | | |

## Repository files navigation

* README
```
Small subgroup confinement issue with session key retrieval in the J-PAKE
implementations of OpenSSL and OpenSSH.

Repository:
  jpake-session-key-retrieval.pdf - note about this issue
  openssl-jpake/ - demo code for OpenSSL
  openssh-jpake/ - demo code for OpenSSH

```

## About

Small-subgroup confinement issue in the OpenSSL and OpenSSH implementations of J-PAKE.

### Resources

[Readme](#readme-ov-file)

[Activity](/seb-m/jpake/activity)
### Stars

[**23**
stars](/seb-m/jpake/stargazers)
### Watchers

[**2**
watching](/seb-m/jpake/watchers)
### Forks

[**15**
forks](/seb-m/jpake/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fseb-m%2Fjpake&report=seb-m+%28user%29)

## [Releases](/seb-m/jpake/releases)

No releases published

## [Packages 0](/users/seb-m/packages?repo_name=jpake)

No packages published

## Languages

* [C
  100.0%](/seb-m/jpake/search?l=c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.redhat.com_69fc2274_20250125_142307.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D659297)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D659297)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D659297)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 659297

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 659297**](show_bug.cgi?id=659297)
(CVE-2010-4252)
- [CVE-2010-4252](https://access.redhat.com/security/cve/CVE-2010-4252) openssl: session key retrieval flaw in J-PAKE implementation

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2010-4252 openssl: session key retrieval flaw in J-PAKE implementation

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2010-4252 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=659297&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=659297&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2010-12-02 13:01 UTC by Tomas Hoger | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-09-13 19:45 UTC ([History](show_activity.cgi?id=659297)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  mehmetgelisin rcvalle tmraz wnefal+redhatbugzilla | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2010-12-02 13:06:18 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Reproducer**](attachment.cgi?id=464242 "View the content of the attachment") (6.15 KB, patch)  [2010-12-02 13:04 UTC](#attach_464242 "Go to the comment associated with the attachment"), Tomas Hoger | *no flags* | [Details](attachment.cgi?id=464242&action=edit) | [Diff](attachment.cgi?id=464242&action=diff) | | [View All](attachment.cgi?bugid=659297&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=659297#c0)  Tomas Hoger    2010-12-02 13:01:16 UTC  ``` Sébastien Martini discovered a flaw in the OpenSSL's implementation of the J-PAKE authentication protocol.  OpenSSL preformed insufficient validation of the public parameters received from the untrusted party, which could use this flaw to make J-PAKE protocol generate predictable session key.  Hence an attacker could use this implementation flaw to successfully authenticate (i.e. prove knowledge of the shared secret) to the peer, usually server.  Sébastien Martini paper describing this flaw, as well as proof of concept code can be found in the following github repository:   <https://github.com/seb-m/jpake>  OpenSSL upstream fix for the issue, which should be included in version 0.9.8q and 1.0.0c:   <http://cvs.openssl.org/chngview?cn=20098>  Note: J-PAKE implementation is considered experimental upstream and is not enabled by default.   ```  [Comment 1](show_bug.cgi?id=659297#c1)  Tomas Hoger    2010-12-02 13:04:41 UTC  ``` Created [attachment 464242](attachment.cgi?id=464242&action=diff "Reproducer") [[details]](attachment.cgi?id=464242&action=edit "Reproducer") Reproducer  Sébastien Martini reproducer.  Source: <https://github.com/seb-m/jpake/tree/master/openssl-jpake/>  Git repository provides couple of files that should replace original files in openssl 1.0.0a that are needed to build modified client exploiting this flaw.  This attachment contains a diff between vanilla 1.0.0a and 1.0.0a with Sébastien's modifications applied.   ```  [Comment 2](show_bug.cgi?id=659297#c2)  Tomas Hoger    2010-12-02 13:06:18 UTC  ``` (In reply to [comment #0](show_bug.cgi?id=659297#c0)) > Note: J-PAKE implementation is considered experimental upstream and is not > enabled by default.  J-PAKE is not enabled in Red Hat Enterprise Linux and Fedora OpenSSL packages either.  Statement:  Not vulnerable. This issue did not affect the versions of openssl as shipped with Red Hat Enterprise Linux 4, 5, or 6.   ```  [Comment 3](show_bug.cgi?id=659297#c3)  Tomas Hoger    2010-12-02 13:10:20 UTC  ``` Same flaws was reported for OpenSSH J-PAKE implementation too and fixed in:  <http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/jpake.c#rev1.5>  As with OpenSSL, OpenSSH code is experimental and not enabled by default or in RHEL / Fedora builds.   ```  [Comment 4](show_bug.cgi?id=659297#c4)  Tomas Hoger    2010-12-02 20:10:56 UTC  ``` (In reply to [comment #0](show_bug.cgi?id=659297#c0)) > OpenSSL upstream fix for the issue, which should be included in version 0.9.8q > and 1.0.0c: >   <http://cvs.openssl.org/chngview?cn=20098>  Upstream security advisory:   <http://openssl.org/news/secadv_20101202.txt>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=659297&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from kb.juniper.net_dd74a83d_20250125_142304.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from seb.dbzteam.org_68b2a05b_20250125_142304.html ===
Session Key Retrieval in J-PAKE Implementations of OpenSSL and OpenSSH

S´ebastien Martini – seb@dbzteam.org

September 12, 2010

1 Description

This issue aﬀects the implementations of J-PAKE [1] in OpenSSL [2] and OpenSSH [3]. These
implementations referred as experimental [4, 5] and work-in-progress [5], both contain the same
ﬂaw, namely, there aren’t adequately verifying the public parameters received from untrusted
parties. These parameters must be reduced modulo p in order to prevent an attacker to bypass
important non-modular checks. This deﬁciency may enable an attacker not knowing the secret
password to conﬁne the computations of her victim into a small subgroup [6] eventually leading
her to always derive her session key from the value K = 1. Like J-PAKE, this issue is symmetric,
meaning that in the usual client/server model, the attacker could be a client trying to authenticate
to a server, or a server trying to impersonate another server to an honest client.

2 Modiﬁed Protocol Rounds

Eve, in order to perform her attack, modiﬁes the rounds 1 and 2 of the original protocol (see [1]
section 3) to send to her victim Alice carefully selected values instead of the randomly chosen
ephemeral ones.

− Round 1’: Eve randomly selects x1 exactly like in the original ﬁrst round, then she picks
x2 = 0 and gx2 = p + 1 and calculates a knowledge proof of 0 using the term gx2 = p + 1 in
the hash computation. She then sends out these values to Alice.

− Round 2’: Eve selects B = 1 along with a knowledge proof of zero and sends out these

values to Alice.

Alice follows the original protocol but mistakenly does not reduce gx2 mod p thus both parties
validate every steps of the protocol. Which eventually lead Eve and Alice to invariably share the
same value K = 1.

3 Remarks

3.1 OpenSSH

The value of x1 in OpenSSH is required to be diﬀerent than zero and the value of B must be
strictly greater than one. Hence, round 2’ must be modiﬁed to take the value of a congruent of
1 mod p diﬀerent than 1.

3.2 SRP

[7] demonstrated the eﬀective need for validating SRP [8] input values. Hence, this issue may also
apply to uncareful SRP implementations using non-modular veriﬁcations.

References

[1] F. Hao and P. Ryan. J-PAKE: Authenticated Key Exchange Without PKI. Cryptology ePrint Archive,

Report 2010/190. http://eprint.iacr.org/. 2010.

[2] OpenSSL. http://www.openssl.org/.
[3] OpenSSH. http://www.openssh.org/.
[4] OpenSSL J-PAKE. http://cvs.openssl.org/chngview?cn=17623.

[5]

Initial OpenSSH J-PAKE commit. http://www.openbsd.org/cgi- bin/cvsweb/src/usr.bin/ssh/
jpake.c?rev=1.1;only_with_tag=MAIN.

[6] P. C. Van Oorschot and M. J. Wiener. “On diﬃe-hellman key agreement with short exponents”. In:

Advances in Cryptology – EUROCRYPT’96. Springer-Verlag, 1996, pp. 332–343.

[7] T. Ptacek and T. Perrin. Flawed input parameter validation in SRP. http://trac.la-samhna.de/

samhain/ticket/150.

[8] T. Wu. The Stanford SRP Authentication Project. http://srp.stanford.edu/.


