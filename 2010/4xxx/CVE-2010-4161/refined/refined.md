```
{
  "CVE-2010-4161": {
    "related": true,
    "description": "The provided content describes a kernel deadlock issue related to commit 6865201191 in Red Hat Enterprise Linux 5 (RHEL5). This deadlock occurs during the processing of network packets, specifically when using socket filters. The issue is triggered by a specific sequence of operations involving the `udp_queue_rcv_skb` function, leading to a race condition within `bh_lock_sock(sk)`. The vulnerability is a regression caused by the mentioned commit. Upstream was not vulnerable due to adoption of RCU protection for sk_filter which RHEL5 didn't have backported.",
    "vulnerability_details": {
      "root_cause": "A race condition in the `bh_lock_sock(sk)` function within the UDP receive path, triggered by commit 6865201191 in RHEL5. The `sk_filter` function in upstream used RCU protection which was not adopted by RHEL5.",
      "weaknesses": [
        "Race condition",
        "Deadlock",
        "Improper locking"
      ],
      "impact": "Denial of service due to system deadlock. The system becomes unresponsive and requires a restart.",
       "attack_vectors": [
         "Network traffic triggering specific packet processing path involving socket filters."
        ],
      "attacker_capabilities": [
        "Ability to send network traffic to trigger the vulnerable code path.",
        "No special privileges required."
      ],
    "additional_details": [
        "The issue was found using the same reproducer for CVE-2010-4158.",
        "The vulnerability exists because RHEL5 did not backport the upstream fix involving RCU protection for `sk_filter`.",
        "The fix was delivered in RHSA-2011:0004",
        "VMware ESX is also listed as affected in advisory VMSA-2011-0012, as it includes vulnerable components."
      ]
    }
  }
}
```