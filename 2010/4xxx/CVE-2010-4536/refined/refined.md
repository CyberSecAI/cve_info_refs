Based on the provided information, here's an analysis of CVE-2010-4536:

**Root Cause of Vulnerability:**

The root cause lies in how WordPress's KSES (kses.php) HTML sanitization library handled attribute names and protocols within HTML tags, specifically in the `esc_url()` function and `wp_kses_bad_protocol()` function.

**Weaknesses/Vulnerabilities Present:**

1.  **Case-Insensitive Attribute Names:** The code was not case-insensitive when checking attribute names (e.g., `style`), allowing for bypasses where attackers could use variations in case to inject malicious code.
2.  **Padded Entities in URLs:** The `wp_kses_bad_protocol` function did not properly handle URLs with padded entities. This could also bypass sanitization if the protocol was encoded using padded HTML entities.
3.  **Inconsistent Entity Normalization:** The `esc_url()` function didn't normalize entities before checking for bad protocols, resulting in bypasses by encoding the protocol using HTML entities.

**Impact of Exploitation:**

*   **Cross-Site Scripting (XSS):** By exploiting these vulnerabilities, an attacker could inject arbitrary JavaScript code into a WordPress site. This allows an attacker to:
    *   Steal user session cookies
    *   Redirect users to malicious sites
    *   Perform actions on behalf of a logged-in user
    *   Deface the website

**Attack Vectors:**

*   **HTML Input:**  Attackers could inject malicious HTML code via any input field that utilizes KSES for sanitization. This could include comments, posts, user profiles, or other fields where HTML input is allowed.
*   **URL Attributes:** Attackers could inject malicious code within URL attributes of HTML elements (e.g., `href`, `src`, etc.).
*   **Style Attributes:** The style attribute is also a potential attack vector.

**Required Attacker Capabilities/Position:**

*   **Ability to Submit HTML:** Attackers need to have the ability to submit or inject HTML code into the vulnerable WordPress site. This could be through a publicly accessible comment form, a post submission system, or some other method that allows HTML input.

**Technical Details:**

*   The fix in changeset [17172](https://core.trac.wordpress.org/changeset/17172/branches/3.0) for WordPress 3.0.4 addresses the issues by:
    *   Using `strtolower()` when comparing attribute names, ensuring case-insensitivity.
    *   Normalizing HTML entities before checking for bad protocols in `esc_url()`, as shown in the change to `formatting.php`.
    *   Modifying `wp_kses_bad_protocol_once` in `kses.php` to use `preg_split` with specific delimiters (`:`, `&#58;`, `&#x3a;`) to handle padded colon entities. Additionally, the protocol is normalized before comparison with the allowed protocols list in `wp_kses_bad_protocol_once2`.
*   The vulnerabilities affect all versions of WordPress before 3.0.4, including the 2.x series, necessitating an upgrade for all users.

**Additional Notes:**

*   The WordPress team considered this a "critical" release due to the severity of the vulnerability.
*   The vulnerability was discovered and reported by Mauro Gentile and Jon Cave.

In summary, CVE-2010-4536 represents a critical XSS vulnerability in WordPress stemming from inadequate sanitization and validation of user-provided HTML, particularly in how attribute names and URL protocols were processed. This was addressed in WordPress 3.0.4 with several key code changes in kses.php and formatting.php.