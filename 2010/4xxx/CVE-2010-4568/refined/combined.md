=== Content from www.vupen.com_16be69a6_20250125_190029.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.debian.org_11789462_20250125_190026.html ===


---

[[Date Prev](msg00198.html)][[Date Next](msg00200.html)]
[[Thread Prev](msg00198.html)][[Thread Next](msg00200.html)]
[[Date Index](maillist.html#00199)]
[[Thread Index](threads.html#00199)]

# [SECURITY] [DSA 2322-1] bugzilla security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2322-1] bugzilla security update
* *From*: Jonathan Wiltshire <jmw@debian.org>
* *Date*: Mon, 10 Oct 2011 18:12:14 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20111010161214.GA4881%40pisco.westfalen.local)Â [20111010161214.GA4881@pisco.westfalen.local](msg00199.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2322-1                   security@debian.org
<http://www.debian.org/security/>                        Jonathan Wiltshire
October 10, 2011                       <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : bugzilla
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-201-2979 CVE-2010-4567 CVE-2010-4568 CVE-2010-4572
                 CVE-2011-0046 CVE-2011-0048 CVE-2011-2379 CVE-2011-2380
                 CVE-2011-2381 CVE-2011-2978

Several vulnerabilities were discovered in Bugzilla, a web-based bug
tracking system.

CVE-2010-4572

  By inserting particular strings into certain URLs, it was
  possible to inject both headers and content to any
  browser.

CVE-2010-4567, CVE-2011-0048

  Bugzilla has a "URL" field that can contain several types
  of URL, including "javascript:" and "data:" URLs. However,
  it does not make "javascript:" and "data:" URLs into
  clickable links, to protect against cross-site scripting
  attacks or other attacks. It was possible to bypass this
  protection by adding spaces into the URL in places that
  Bugzilla did not expect them. Also, "javascript:" and
  "data:" links were *always* shown as clickable to
  logged-out users.

CVE-2010-4568

  It was possible for a user to gain unauthorized access to
  any Bugzilla account in a very short amount of time (short
  enough that the attack is highly effective).

CVE-2011-0046

  Various pages were vulnerable to Cross-Site Request
  Forgery attacks. Most of these issues are not as serious
  as previous CSRF vulnerabilities.

CVE-2011-2978

  When a user changes his email address, Bugzilla trusts
  a user-modifiable field for obtaining the current e-mail
  address to send a confirmation message to. If an attacker
  has access to the session of another user (for example,
  if that user left their browser window open in a public
  place), the attacker could alter this field to cause
  the email-change notification to go to their own address.
  This means that the user would not be notified that his
  account had its email address changed by the attacker.

CVE-2011-2381

  For flagmails only, attachment descriptions with a newline
  in them could lead to the injection of crafted headers in
  email notifications when an attachment flag is edited.

CVE-2011-2379

  Bugzilla uses an alternate host for attachments when
  viewing them in raw format to prevent cross-site scripting
  attacks. This alternate host is now also used when viewing
  patches in "Raw Unified" mode because Internet Explorer 8
  and older, and Safari before 5.0.6 do content sniffing,
  which could lead to the execution of malicious code.

CVE-2011-2380 CVE-201-2979

  Normally, a group name is confidential and is only visible
  to members of the group, and to non-members if the group
  is used in bugs. By crafting the URL when creating or
  editing a bug, it was possible to guess if a group existed
  or not, even for groups which weren't used in bugs and so
  which were supposed to remain confidential.

For the oldstable distribution (lenny), it has not been practical to
backport patches to fix these bugs. Users of bugzilla on lenny are
strongly advised to upgrade to the version in the squeeze distribution.

For the stable distribution (squeeze), these problems have been fixed in
version 3.6.2.0-4.4.

For the testing distribution (wheezy) and the unstable distribution (sid),
the bugzilla packages have been removed.

We recommend that you upgrade your bugzilla packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iEYEARECAAYFAk6TGQMACgkQXm3vHE4uylrKoACgpP8nXm2Nj6cmEPNLL5n4VVqQ
cMsAoNuj8KxXmA437xUP1NZqnJrbWwFD
=kZIo
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_9acec8db_20250126_111400.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/619594)
* [XML](/show_bug.cgi?ctype=xml&id=619594)

Closed
[Bug 619594](/show_bug.cgi?id=619594)
(CVE-2010-4568)

Opened 14 years ago
Closed 14 years ago

# [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account

## Categories

### (Bugzilla :: User Accounts, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
â–¾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=User%20Accounts#User%20Accounts)

User Accounts
â–¾

Bugzilla :: User Accounts
Anything about managing a user account from the user's perspective. `userprefs.cgi`, saved queries, creating accounts, changing passwords, logging in, etc.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=User%20Accounts)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.14

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 3.2

## People

### (Reporter: willem, Assigned: mkanat)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8d3dd762c1c841898a384ebc42abec97?d=mm&size=40)  [mkanat](/user_profile?user_id=73187)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/f3c3dc6a53dcac6c1ad51ee591fdc0a7?d=mm&size=40)  [willem](/user_profile?user_id=401840)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[620540](/show_bug.cgi?id=620540 "RESOLVED FIXED - Security Advisory for Bugzilla 4.0rc2, 3.6.4, 3.4.10 and 3.2.10"), [621591](/show_bug.cgi?id=621591 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"), [646578](/show_bug.cgi?id=646578 "RESOLVED FIXED - Math::Random::Secure's dependencies frequently do not install properly")

Dependency [tree](/showdependencytree.cgi?id=619594&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=619594)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [infrasec:auth][ws:critical])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2010-4568

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[wsec-authorization](/buglist.cgi?keywords=wsec-authorization&resolution=---),
[wsec-crypto](/buglist.cgi?keywords=wsec-crypto&resolution=---),
[wsec-impersonation](/buglist.cgi?keywords=wsec-impersonation&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[infrasec:auth][ws:critical]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [LpSolit](/user_profile?user_id=120380) | [approval](#a3419141_120380 "14 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [approval4.0](#a3419141_120380 "14 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval4.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.0](#c56 "14 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [approval3.6](#a3419141_120380 "14 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval3.6 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking3.6.4](#c4 "14 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking3.6.4 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [approval3.4](#a3419141_120380 "14 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval3.4 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking3.4.10](#c4 "14 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking3.4.10 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [approval3.2](#a3419141_120380 "14 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval3.2 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking3.2.10](#a19894_73187 "14 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking3.2.10 | + |
| --- | --- | --- |
| [rforbes](/user_profile?user_id=411311) | [sec-bounty](#a91228032_411311 "11 years ago") | + |
| --- | --- | --- |
| [rforbes](/user_profile?user_id=411311) | sec-bounty | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (13 files, 20 obsolete files)

| [v1](/attachment.cgi?id=498053)  [14 years ago](#c15)  [Max Kanat-Alexander](/user_profile?user_id=73187)   2.40 KB, patch | glob : [review+](#c16 "14 years ago") | [Details](/attachment.cgi?id=498053&action=edit) | [Diff](/attachment.cgi?id=498053&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498053) |
| --- | --- | --- |
| [v2](/attachment.cgi?id=498181)  [14 years ago](#c25)  [Max Kanat-Alexander](/user_profile?user_id=73187)   3.59 KB, patch |  | [Details](/attachment.cgi?id=498181&action=edit) | [Diff](/attachment.cgi?id=498181&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498181) |
| [Simplest Patch That Defeats Randfindclean](/attachment.cgi?id=498238)  [14 years ago](#c42)  [Max Kanat-Alexander](/user_profile?user_id=73187)   356 bytes, patch |  | [Details](/attachment.cgi?id=498238&action=edit) | [Diff](/attachment.cgi?id=498238&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498238) |
| [generate\_random\_password](/attachment.cgi?id=499252)  [14 years ago](#c77)  [:glob âœ±](/user_profile?user_id=13647)   1.82 KB, patch |  | [Details](/attachment.cgi?id=499252&action=edit) | [Diff](/attachment.cgi?id=499252&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=499252) |
| [RNG Speed Test](/attachment.cgi?id=499377)  [14 years ago](#c85)  [Max Kanat-Alexander](/user_profile?user_id=73187)   2.38 KB, text/plain |  | [Details](/attachment.cgi?id=499377&action=edit) |
| [Crypt::Random::Source::Win32, Work In Progress](/attachment.cgi?id=499438)  [14 years ago](#c92)  [Max Kanat-Alexander](/user_profile?user_id=73187)   3.97 KB, text/plain |  | [Details](/attachment.cgi?id=499438&action=edit) |
| [trunk, v1](/attachment.cgi?id=500123)  [14 years ago](#c100)  [Max Kanat-Alexander](/user_profile?user_id=73187)   1.79 KB, patch | LpSolit : [review+](#c136 "14 years ago") | [Details](/attachment.cgi?id=500123&action=edit) | [Diff](/attachment.cgi?id=500123&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500123) |
| [Calling Windows Perl's srand more than once is bad](/attachment.cgi?id=500172)  [14 years ago](#c106)  [Max Kanat-Alexander](/user_profile?user_id=73187)   373 bytes, text/plain |  | [Details](/attachment.cgi?id=500172&action=edit) |
| [Better Windows Demonstration Script](/attachment.cgi?id=500174)  [14 years ago](#c107)  [Max Kanat-Alexander](/user_profile?user_id=73187)   457 bytes, text/plain |  | [Details](/attachment.cgi?id=500174&action=edit) |
| [The Real Windows Problem](/attachment.cgi?id=500176)  [14 years ago](#c109)  [Max Kanat-Alexander](/user_profile?user_id=73187)   335 bytes, text/plain |  | [Details](/attachment.cgi?id=500176&action=edit) |
| [compare CORE::rand() and Math::Random::Secure::rand()](/attachment.cgi?id=500216)  [14 years ago](#c116)  [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380)   508 bytes, text/plain |  | [Details](/attachment.cgi?id=500216&action=edit) |
| [Patch for 3.2, v1](/attachment.cgi?id=500276)  [14 years ago](#c124)  [Max Kanat-Alexander](/user_profile?user_id=73187)   3.96 KB, patch |  | [Details](/attachment.cgi?id=500276&action=edit) | [Diff](/attachment.cgi?id=500276&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500276) |
| [Test generate\_random\_password](/attachment.cgi?id=500278)  [14 years ago](#c125)  [Max Kanat-Alexander](/user_profile?user_id=73187)   375 bytes, text/plain |  | [Details](/attachment.cgi?id=500278&action=edit) |
| [Patch for 3.4, v1](/attachment.cgi?id=500280)  [14 years ago](#c127)  [Max Kanat-Alexander](/user_profile?user_id=73187)   3.98 KB, patch |  | [Details](/attachment.cgi?id=500280&action=edit) | [Diff](/attachment.cgi?id=500280&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500280) |
| [Patch for 3.6, v1](/attachment.cgi?id=500281)  [14 years ago](#c128)  [Max Kanat-Alexander](/user_profile?user_id=73187)   4.55 KB, patch | LpSolit : [review+](#c139 "14 years ago") | [Details](/attachment.cgi?id=500281&action=edit) | [Diff](/attachment.cgi?id=500281&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500281) |
| [Patch For 4.0, v1](/attachment.cgi?id=502620)  [14 years ago](#c138)  [Max Kanat-Alexander](/user_profile?user_id=73187)   4.55 KB, patch |  | [Details](/attachment.cgi?id=502620&action=edit) | [Diff](/attachment.cgi?id=502620&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=502620) |
| [Patch for 4.0, v2](/attachment.cgi?id=503819)  [14 years ago](#c141)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.63 KB, patch |  | [Details](/attachment.cgi?id=503819&action=edit) | [Diff](/attachment.cgi?id=503819&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503819) |
| [Patch for trunk, v2](/attachment.cgi?id=503820)  [14 years ago](#c143)  [Max Kanat-Alexander](/user_profile?user_id=73187)   3.82 KB, patch | LpSolit : [review+](#c154 "14 years ago") | [Details](/attachment.cgi?id=503820&action=edit) | [Diff](/attachment.cgi?id=503820&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503820) |
| [Patch for 3.6, v2](/attachment.cgi?id=503824)  [14 years ago](#c144)  [Max Kanat-Alexander](/user_profile?user_id=73187)   4.55 KB, patch |  | [Details](/attachment.cgi?id=503824&action=edit) | [Diff](/attachment.cgi?id=503824&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503824) |
| [Patch for 3.6, v2 (Actual)](/attachment.cgi?id=503826)  [14 years ago](#c145)  [Max Kanat-Alexander](/user_profile?user_id=73187)   5.32 KB, patch |  | [Details](/attachment.cgi?id=503826&action=edit) | [Diff](/attachment.cgi?id=503826&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503826) |
| [Patch for 3.4, v2](/attachment.cgi?id=503828)  [14 years ago](#c146)  [Max Kanat-Alexander](/user_profile?user_id=73187)   4.75 KB, patch | mkanat : [review-](#c148 "14 years ago") | [Details](/attachment.cgi?id=503828&action=edit) | [Diff](/attachment.cgi?id=503828&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503828) |
| [Patch for 3.6, v3](/attachment.cgi?id=503831)  [14 years ago](#c149)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.70 KB, patch |  | [Details](/attachment.cgi?id=503831&action=edit) | [Diff](/attachment.cgi?id=503831&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503831) |
| [Patch for 3.4, v3](/attachment.cgi?id=503833)  [14 years ago](#c150)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.09 KB, patch |  | [Details](/attachment.cgi?id=503833&action=edit) | [Diff](/attachment.cgi?id=503833&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503833) |
| [Patch for 3.2, v2](/attachment.cgi?id=503836)  [14 years ago](#c151)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.79 KB, patch |  | [Details](/attachment.cgi?id=503836&action=edit) | [Diff](/attachment.cgi?id=503836&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503836) |
| [Use Win32::GuidGen()](/attachment.cgi?id=504237)  [14 years ago](#c163)  [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380)   1.14 KB, text/plain |  | [Details](/attachment.cgi?id=504237&action=edit) |
| [Patch for 3.2, v4](/attachment.cgi?id=504640)  [14 years ago](#c172)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.27 KB, patch |  | [Details](/attachment.cgi?id=504640&action=edit) | [Diff](/attachment.cgi?id=504640&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504640) |
| [Patch for 3.4, v4](/attachment.cgi?id=504641)  [14 years ago](#c173)  [Max Kanat-Alexander](/user_profile?user_id=73187)   5.56 KB, patch | LpSolit : [review+](#c180 "14 years ago") | [Details](/attachment.cgi?id=504641&action=edit) | [Diff](/attachment.cgi?id=504641&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504641) |
| [Patch for 3.6, v4](/attachment.cgi?id=504642)  [14 years ago](#c174)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.05 KB, patch | LpSolit : [review+](#c177 "14 years ago") | [Details](/attachment.cgi?id=504642&action=edit) | [Diff](/attachment.cgi?id=504642&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504642) |
| [Patch for 4.0, v4](/attachment.cgi?id=504643)  [14 years ago](#c175)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.05 KB, patch | LpSolit : [review+](#c176 "14 years ago") | [Details](/attachment.cgi?id=504643&action=edit) | [Diff](/attachment.cgi?id=504643&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504643) |
| [Patch for 4.0, v5](/attachment.cgi?id=506019)  [14 years ago](#c178)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.05 KB, patch | mkanat : [review+](#c179 "14 years ago") | [Details](/attachment.cgi?id=506019&action=edit) | [Diff](/attachment.cgi?id=506019&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506019) |
| [Patch for 3.6, v5](/attachment.cgi?id=506022)  [14 years ago](#c181)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.12 KB, patch | mkanat : [review+](#c181 "14 years ago") | [Details](/attachment.cgi?id=506022&action=edit) | [Diff](/attachment.cgi?id=506022&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506022) |
| [Patch for 3.4, v5](/attachment.cgi?id=506023)  [14 years ago](#c182)  [Max Kanat-Alexander](/user_profile?user_id=73187)   5.63 KB, patch | LpSolit : [review+](#a3191941_120380 "14 years ago") | [Details](/attachment.cgi?id=506023&action=edit) | [Diff](/attachment.cgi?id=506023&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506023) |
| [Patch for 3.2, v5](/attachment.cgi?id=506025)  [14 years ago](#c183)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.27 KB, patch | LpSolit : [review+](#c184 "14 years ago") | [Details](/attachment.cgi?id=506025&action=edit) | [Diff](/attachment.cgi?id=506025&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506025) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [willem](/user_profile?user_id=401840)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=619594#c0)â€¢ 14 years ago |
|  | |

User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.13) Gecko/20101212 Gentoo Firefox/3.6.13
Build Identifier: Bugzilla-3.6.3, as well as the version running on bugzilla.mozilla.org
To Whom It May Concern,
the Bugzilla 3.6.3, the bugzilla.mozilla.org website, and likely other versions and instances of Bugzilla contain a critical vulnerability that can be used to recover a password reset token for any account. An attacker with an account on the bugzilla system can request a password reset for any other account and through efficient bruteforce recover the token, the attacker can use the token to changethe password of the victim's account and login as the victim.
A Quick explanation.
Bugzilla uses rand and srand in perl, which are based on srand48 and drand48 on Linux (and possibly other OS's) srand48 is seeded with at most 32 bit of entropy. Using a modern machine one can go through these 32bits in a very short amount of time, less than 10 minutes on my machine.
Bugzilla uses (s)rand to generate their tokens and to generate their login cookie. When accessing token.cgi with the attackers login credentials Bugzilla will login the attacker and send him a login cookie made using generate\_random\_password, the attacker can recover the seed used for srand from this, and use it to know the full internal state of the random number generator.
The same request is used by the attacker to request a password reset for the account the attackers wants to take over. For the reset procedure a token will be generated and send to the victim, if the attacker can find this token he can reset the victims password. Since the token is also created using generate\_random\_password and uses the internal random state that was left after making the login cookie the attacker can easily deduce the token send to the victim.
Steps for a succesful attack:
request a password reset for the victim account, while logging into to Bugzilla:
POST /token.cgi
---
Bugzilla\_login=<ATTACKER\_LOGIN>&Bugzilla\_password=<ATTACKER\_PASSWORD>&Bugzilla\_remember=on&loginname=<VICTIMLOGINNAME>&a=reqpw
the response from the server will contain:
Set-Cookie: Bugzilla\_logincookie=LPfN86mTdY; path=/; expires=Fri, 01-Jan-2038 00:00:00 GMT; secure; HttpOnly
while the victim will be sent an email with a token in it.
Next the attacker finds the random state used to generate his login Cookie and calculates the next token that BugZilla generated:
./randfindclean LPfN86mTdY
found at seed: -43631713 // fd663b9f
YKWG0y4oQT
(randfindclean finds the seed used to make the logincookie, and then calculates the token based on rand state)
and uses the token to login as the victim and change their password.
---- copy paste from the victims email ---
You have (or someone impersonating you has) requested to change your
Bugzilla password. To complete the change, visit the following link:
<https://bugzilla.mozilla.org/token.cgi?t=YKWG0y4oQT&a=cfmpw>
-----
If there are any questions, please don't hesitate to contact me,
Willem Pinckaers.
Reproducible: Always
Steps to Reproduce:
1.login while requestion a password change for the victim
2.based on logincookie, calculate the password token
3.change the victim password and login as the victim
Actual Results:
Got access to the victim's account
Expected Results:
r

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a7047_159758)â€¢ 14 years ago |

Version: unspecified â†’ 3.6.3

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a9449_159758)â€¢ 14 years ago |

Whiteboard: [infrasec:auth][ws:critical]

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a9688_159758)â€¢ 14 years ago |

Status: UNCONFIRMED â†’ NEWEver confirmed: trueSummary: An attacker can recover a password change token, and change the password of any account. â†’ [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=619594#c4)â€¢ 14 years ago |
|  | |

This is an extremely impressive security bug. I haven't tested it yet to reproduce, but I am fairly confident that the description is correct and the vulnerability is valid.
The solution, I suspect, is to use a better system than Perl's rand(), which should be fairly simple. I wasn't aware that Perl's rand was so weak; that's very unfortunate.Flags: blocking3.6.4+Flags: blocking3.4.10+OS: Linux â†’ Windows CEPriority: -- â†’ P1Target Milestone: --- â†’ Bugzilla 3.4

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=619594#c5)â€¢ 14 years ago |
|  | |

Due to the severity of this issue, the security process for this bug will be different than previous bugs. We will patch the problem by fixing rand, but with an innocuous commit message, something like "use a better random number generator than Perl's built-in rand()", keep this bug closed, and release the fixed versions. We will probably also send out a security advisory with the release, but without too many details. Then we will open up this bug between a week and a month later.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=619594#c6)â€¢ 14 years ago |
|  | |

This is quite impressive.
The fact that we use the same random generator for the login cookie and the token makes this easier to exploit, but we'd be vulnerable even without this.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=619594#c7)â€¢ 14 years ago |
|  | |

<http://wellington.pm.org/archive/200704/randomness/> has some information on Perl's RNG and possible alternatives.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a15694_159758)â€¢ 14 years ago |

OS: Windows CE â†’ AllHardware: x86 â†’ All

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=619594#c8)â€¢ 14 years ago |
|  | |

other mozilla perl tools should be audited for this issue too; from what i can see despot, litmus and mozbot may all be affected.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=619594#c9)â€¢ 14 years ago |
|  | |

So, it looks like the best solution that I've found, so far, is to use Math::Random::MT::Auto to generate random numbers instead of Perl's built-in rand(). I'd like to find a module that would just do all our random string generation for us, but I don't see any module on CPAN that will do that securely.
I believe that we will also have to seed the module's random number generator the PerlChildInitHandler for each httpd child, also, just like we do with Perl's core srand() now.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a17904_159758)â€¢ 14 years ago |

Flags: blocking4.0?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=619594#c10)â€¢ 14 years ago |
|  | |

Due to the way that release schedules work, I'm pretty sure I won't be able to block 4.0 on this. When we do major releases, we want to release \*just\* that release in the release announcement. What this means is that we'll do 4.0 and then we'll do 4.0.1 shortly after with this fix. I also really don't want to spring a fix like this on administrators during the holidays when they aren't around to patch their Bugzillas.
Unfortunately this means that the fix for this probably won't be released until January, as terrifically painful as that is for me to say, and even though I'd like to have a patch for it tonight.Flags: blocking4.0? â†’ blocking4.0-

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=619594#c11)â€¢ 14 years ago |
|  | |

I disagree. The holidays are generally some of the \*best\* times to get downtime in order do upgrades such as this. This is too important to hold until January.

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=619594#c12)â€¢ 14 years ago |
|  | |

i agree w/ reed's [comment 11](/show_bug.cgi?id=619594#c11 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account").
further, i'd much rather bury this fix in a major release upgrade than let people notice it in a minor release.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=619594#c13)â€¢ 14 years ago |
|  | |

Reed and timeless: I see where you're coming from, but I don't think that the holidays are good times for the large majority of the 10,000 or so Bugzilla installations in the world, particularly many small-to-medium shops where there are 0 or 1 IT people who are certainly on vacation over the holidays.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=619594#c14)â€¢ 14 years ago |
|  | |

We could do all the releases simultaneously with 4.0, though, and just send out separate emails and do a separate news announcement. That would probably be OK.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a19888_73187)â€¢ 14 years ago |

Assignee: user-accounts â†’ mkanatStatus: NEW â†’ ASSIGNEDTarget Milestone: Bugzilla 3.4 â†’ Bugzilla 3.2

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a19894_73187)â€¢ 14 years ago |

Flags: blocking3.2.10+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=619594#c15)â€¢ 14 years ago |
|  | |

Attached patch

[v1](attachment.cgi?id=498053&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=498053&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498053)

This switches us to using Math::Random::MT::Auto for token generation. I also made the tokens longer while I was at it, for good measure.
[Attachment #498053](/attachment.cgi?id=498053&action=edit "v1") -
Flags: review?(glob)
[Attachment #498053](/attachment.cgi?id=498053&action=edit "v1") -
Flags: review?(LpSolit)

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=619594#c16)â€¢ 14 years ago |
|  | |

Comment on [attachment 498053](/attachment.cgi?id=498053 "v1") [[details]](/attachment.cgi?id=498053&action=edit "v1") [[diff]](/attachment.cgi?id=498053&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498053)
v1
r=glob: this looks good to me, and works as advertised.
[Attachment #498053](/attachment.cgi?id=498053&action=edit "v1") -
Flags: review?(glob) â†’ review+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=619594#c17)â€¢ 14 years ago |
|  | |

The docs for M::R::M::A say:
"You don't even need to bother seeding the PRNG (i.e., you don't need to call "srand"), as that gets done automatically when the module is loaded by Perl."
<http://search.cpan.org/~jdhedden/Math-Random-MT-Auto-6.15/lib/Math/Random/MT/Auto.pm#QUICKSTART>
Gerv

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=619594#c18)â€¢ 14 years ago |
|  | |

Comment on [attachment 498053](/attachment.cgi?id=498053 "v1") [[details]](/attachment.cgi?id=498053&action=edit "v1") [[diff]](/attachment.cgi?id=498053&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498053)
v1
Instead of requiring another Perl module, why not simply encrypt the token generated by rand() with SHA256 using our site\_wide\_secret local parameter? I doubt the attacker can crack that.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=619594#c19)â€¢ 14 years ago |
|  | |

(In reply to [comment #14](/show_bug.cgi?id=619594#c14 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> We could do all the releases simultaneously with 4.0, though
... or release 4.0rc2 instead, if we have tons of security bugs, and release 4.0 final alone 10 days later if no regression is found.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=619594#c20)â€¢ 14 years ago |
|  | |

(In reply to [comment #17](/show_bug.cgi?id=619594#c17 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> "You don't even need to bother seeding the PRNG (i.e., you don't need to call
> "srand"), as that gets done automatically when the module is loaded by Perl."
Each httpd child must be seeded separately or all children have the same random seed. There was a critical security bug filed about it a few years back.
(In reply to [comment #18](/show_bug.cgi?id=619594#c18 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Instead of requiring another Perl module, why not simply encrypt the token
> generated by rand() with SHA256 using our site\_wide\_secret local parameter? I
> doubt the attacker can crack that.
There are various problems with that:
1) There are only 2^32 (on Linux/BSD) possible random strings that generate\_random\_password can generate. So, hashing them would make the attack take a few milliseconds more, but not help.
2) On Windows, there are only 32768 possible random strings that generate\_random\_password can generate. This means that there are only 2^15 possible site\_wide\_secret values on Windows.
3) We need to generate secure random strings that are longer than a SHA1 hash sometimes--for example, for site\_wide\_secret. Also, secure random strings that are shorter than a SHA1 hash--for example, for the multipart separator in Bugzilla::CGI.
4) A SHA1 hash is longer than tokens.token, so we would have to do a schema change on the stable branches.
It's also possible that extensions or customizations are dependent upon the security of generate\_random\_password.
More or less, I don't want to have to figure out explicitly everywhere that we use generate\_random\_password and make the call points secure. I just want to make generate\_random\_password itself secure.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=619594#c21)â€¢ 14 years ago |
|  | |

(In reply to [comment #19](/show_bug.cgi?id=619594#c19 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> ... or release 4.0rc2 instead, if we have tons of security bugs, and release
> 4.0 final alone 10 days later if no regression is found.
Ah, yeah, that's probably the best plan.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=619594#c22)â€¢ 14 years ago |
|  | |

Do you think we need to make people regenerate their site\_wide\_secret then, if there are only a few possible values it can have (even though it's very long)?
I agree we should wait for the storm of bounty-fuelled security bugs to die down, then release a 4.0rc2 along with stable releases with the fixes, then 4.0 final a little later.
Gerv

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=619594#c23)â€¢ 14 years ago |
|  | |

(In reply to [comment #22](/show_bug.cgi?id=619594#c22 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Do you think we need to make people regenerate their site\_wide\_secret then, if
> there are only a few possible values it can have (even though it's very long)?
Yes. I'll post a new patch that does that.
> I agree we should wait for the storm of bounty-fuelled security bugs to die
> down, then release a 4.0rc2 along with stable releases with the fixes, then 4.0
> final a little later.
Or release 4.0.1 with all the bounty-fueled issues. I'd really like to get 4.0 out as soon as is reasonably possible, and since we don't know when the filing storm will die down, I think it might just be best to wait, but to inform selected large, public installations about this particular issue and let them patch it quietly themselves.
This particular bug has been in Bugzilla as long as we've used token-based resets (several years), and nobody had reported it to us before yesterday, so I don't think we're in much danger of it being discovered again and exploited before January.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=619594#c24)â€¢ 14 years ago |
|  | |

I don't like the idea of making a new release with known security issues in it that we have patches for. When the security release does come out, that's telling everyone "we didn't care enough about this to fix it in this release, even though we knew about it." Schedule be damned, unfortunately. This is a good reason to break the schedule.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=619594#c25)â€¢ 14 years ago |
|  | |

Attached patch

[v2](attachment.cgi?id=498181&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=498181&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498181)

This one also forcibly regenerates site\_wide\_secret.
[Attachment #498053](/attachment.cgi?id=498053&action=edit "v1") -
Attachment is obsolete: true
[Attachment #498181](/attachment.cgi?id=498181&action=edit "v2") -
Flags: review?(glob)
[Attachment #498181](/attachment.cgi?id=498181&action=edit "v2") -
Flags: review?(LpSolit)
[Attachment #498053](/attachment.cgi?id=498053&action=edit "v1") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=619594#c26)â€¢ 14 years ago |
|  | |

(In reply to [comment #23](/show_bug.cgi?id=619594#c23 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Or release 4.0.1 with all the bounty-fueled issues. I'd really like to get
> 4.0 out as soon as is reasonably possible
I also would like to release 4.0 asap, but I have several concerns:
1) Releasing 4.0rc2 means we will also release 3.2.10. Releasing 4.0 alone first, then 4.0.1 with the security fixes means we won't, as 3.2 would have reached EOL. This is not a minor thing, IMO (even if they should upgrade to a newer version).
2) Releasing 4.0rc2 first means that when 4.0 final comes out, we won't then require another new module. I much prefer that we don't ask admins to again install a new one, if possible. We have to do that for stable branches already, that is very unfortunate.
3) If several other sec bugs are filed in the coming weeks, I would prefer the rc2 -> final -> .1 way (if we missed some), than final -> .1 -> .2 in a quick cycle. I feel bad about it as the QA lead.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=619594#c27)â€¢ 14 years ago |
|  | |

(In reply to [comment #24](/show_bug.cgi?id=619594#c24 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> I don't like the idea of making a new release with known security issues in it
> that we have patches for. When the security release does come out, that's
> telling everyone "we didn't care enough about this to fix it in this release,
> even though we knew about it." Schedule be damned, unfortunately. This is a
> good reason to break the schedule.
+1

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=619594#c28)â€¢ 14 years ago |
|  | |

I see where both of you are coming from. However, we need to also give some admins at least a few weeks to apply this patch before we can even release. So we'd be missing our release window for 4.0 without doing any release at all.
This vulnerability has been around for years; it's not going to start radioactively mutating and become The Blob and eat us all in a few weeks.
Also, we don't want to rush out a fix for this if the fix isn't going to be right. We should give admins time to test this patch and respond, and make sure that we have a really solid fix.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=619594#c29)â€¢ 14 years ago |
|  | |

I advise bundling Math::Random::MT::Perl into Bugzilla and supporting an optional dependency Math::Random::MT::Auto, so that a secure RNG is available to all users immediately, and those that install the optional XS dependency (MT::Auto) gain improved RNG performance.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=619594#c30)â€¢ 14 years ago |
|  | |

Okay, I just looked at Math::Random::MT::Perl, and its default seeding system is not adequate. We'd have to re-implement sections of Math::Random::MT::Auto, and re-implementing anything involving or surrounding security is something I'd rather not do unless it's necessary.
Also, Math::Random::MT::Perl requires Time::HiRes, which is an XS module, so we can't bundle Time::HiRes. I thought that we required Time::HiRes already, but we actually don't seem to. So even though I thought we could bundle MT::Perl, we can't.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=619594#c31)â€¢ 14 years ago |
|  | |

Time::HiRes is in the core modules of Perl, see e.g.:
<http://perldoc.perl.org/5.8.8/Time/HiRes.html>

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=619594#c32)â€¢ 14 years ago |
|  | |

Ah, indeed it is. It was missing from my 5.8.1 installation for some reason.
I still feel more comfortable with the auto-seeding algorithm of MT::Auto than I do with the usage of MT::Perl. After all, it's the seed that's our problem here, not the RNG itself.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=619594#c33)â€¢ 14 years ago |
|  | |

(In reply to [comment #32](/show_bug.cgi?id=619594#c32 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> I still feel more comfortable with the auto-seeding algorithm of MT::Auto than
> I do with the usage of MT::Perl. After all, it's the seed that's our problem
> here, not the RNG itself.
not really - the problem is that we have two consecutive queries being run on the same seed. The attack doesn't rely on knowing the seed as much as it relies on the RNG being effectively deterministic.
And I agree with Dave, BTW. And we should release 3.2 as well.
(The alternate way of doing this is to hash the id and timestamp and have the cookie contain (id,timestamp,hash) and not use a token at all)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=619594#c34)â€¢ 14 years ago |
|  | |

I know it's a shame to miss a release date we were hoping to hit, but this seems to be rather an unusual situation. Max: you talk about a "release window" - is that just "when we were hoping to release", or is there some other reason why the window has an "end"?
This discussion isn't just about this bug - it's about the four others we already have, and the others which will be filed over the coming days and weeks. We should plan for getting more, and that means the wisest thing IMO is to delay the 4.0 release.
Gerv

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=619594#c35)â€¢ 14 years ago |
|  | |

(In reply to [comment #33](/show_bug.cgi?id=619594#c33 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> not really - the problem is that we have two consecutive queries being run on
> the same seed.
The fact that Perl's srand is poorly seeded \*is\* the underlying vulnerability. If it weren't, this vulnerability would not be a vulnerability. For example, with MT::Auto, I believe you'd be running randfindclean until the end of time.
> (The alternate way of doing this is to hash the id and timestamp and have the
> cookie contain (id,timestamp,hash) and not use a token at all)
That's not a valid method of session persistence. It contains a timestamp.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=619594#c36)â€¢ 14 years ago |
|  | |

(In reply to [comment #34](/show_bug.cgi?id=619594#c34 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> I know it's a shame to miss a release date we were hoping to hit, but this
> seems to be rather an unusual situation. Max: you talk about a "release window"
> - is that just "when we were hoping to release", or is there some other reason
> why the window has an "end"?
The current planned release date of Bugzilla 4.0 is Tuesday, December 21.
For PR reasons, the best days to do major releases are Tuesdays.
So our next Tuesday after that would be the 28th. No good--everybody's on vacation, including a lot of journalists.
After that would be January 4. Possibly decent, but not great, because everybody's just gotten back from vacation and is super-busy.
So then we'd be looking at January 11, realistically.
By the way, all of these reasons are also reasons that we should not be doing a security release in this timeframe. So I'd like to release 4.0 on December 21 and our security releases on January 11, which is a time when people are actually likely to be around and available to do the installation.
> We should plan for getting more, and that means the wisest thing IMO is
> to delay the 4.0 release.
No, actually if we plan to get more, the wisest thing to do would be to release 4.0 instead of delaying it by some uncertain amount of time. Bugzilla's release history shows that it is much better to release soon than to wait for an uncertain period.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=619594#c37)â€¢ 14 years ago |
|  | |

 Also, I'd like two separate press focuses--one that is "Hey, we've released Bugzilla 4.0! Hooray!" and another that is, "Hey, there is a serious issue that you need to patch!"
Both of those really deserve their own media period.
Remember that we are interested not just in this very important security issue, but also the long-term success of the Bugzilla Project and the culmination of the work that we've been doing for this past year.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=619594#c38)â€¢ 14 years ago |
|  | |

 Ah, MT::Auto may not be sufficient for our purposes. From the Wikipedia page on the Mersenne Twister:
"The algorithm in its native form is not suitable for cryptography (unlike Blum Blum Shub). Observing a sufficient number of iterates (624 in the case of MT19937) allows one to predict all future iterates."
Under mod\_perl it might be possible to get 624 iterates from one httpd child, if one worked cleverly at it.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=619594#c39)â€¢ 14 years ago |
|  | |

 So far, the only reasonable alternative I see on CPAN is Math::Random::ISAAC. However, to get reasonable performance out of it, you have to install Math::Random::ISAAC::XS also. Also, Math::Random::ISAAC doesn't seed itself, so we'd have to basically re-implement the seeding code from Math::Random::MT::Auto.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=619594#c40)â€¢ 14 years ago |
|  | |

I'm sure there must be a way of using Math::Random::MT::Auto which avoids the "624" problem. Can we combine values? Can we reseed periodically using one of the random values? Or the current time?
Are there really no Perl modules which provide cryptographic randomness? What's wrong with Crypt::OpenSSL::Random? Dependencies too large? Does Crypt::Random not run on Windows?
Gerv

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=619594#c41)â€¢ 14 years ago |
|  | |

(In reply to [comment #40](/show_bug.cgi?id=619594#c40 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Are there really no Perl modules which provide cryptographic randomness?
Math::Random::ISAAC should.
> What's wrong with Crypt::OpenSSL::Random?
It doesn't compile on Windows.
> Does Crypt::Random not run on Windows?
It doesn't support Windows in its randomness sources.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=619594#c42)â€¢ 14 years ago |
|  | |

Attached patch

[Simplest Patch That Defeats Randfindclean](attachment.cgi?id=498238&action=diff)
â€” [Details](attachment.cgi?id=498238&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498238)

This is the simplest possible patch that defeats randfindclean. Perl seeds from /dev/urandom if it is available, so this is probably actually a secure solution, on Linux. Every string that we send to the user will have a different seed, so no string is guessable from the previous seed.
However, on Windows, I believe that Perl's rand() may still be critically weak, if it does indeed have a period of 2^15.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=619594#c43)â€¢ 14 years ago |
|  | |

So, on Windows the first solution that I would think of would be to use MT::Auto \*and\* call srand() on every generate\_random\_password() call.
However, this turns out to be really very slow, particularly compared to just using Math::Random::ISAAC with MT::Auto's seeding code:
Benchmark: timing 10000 iterations of isaac\_pp, isaac\_xs, mt\_auto...
isaac\_pp: 1 wallclock secs ( 0.40 usr + 0.00 sys = 0.40 CPU) @ 25000.00/s
isaac\_xs: 0 wallclock secs ( 0.12 usr + 0.00 sys = 0.12 CPU) @ 83333.33/s
mt\_auto: 11 wallclock secs ( 4.73 usr + 6.26 sys = 10.99 CPU) @ 909.92/s
Because ISAAC is a secure PRNG, we don't have to re-seed it on every generate\_random\_password call, making it considerably faster than using MT::Auto in our case. Even the pure-perl version of ISAAC is fast enough for us.
The only thing we'd have to do is to take all the seeding code from MT::Auto, which would probably be good to do anyway, since then we could also eliminate MT::Auto's possibility of calling out to random.org for bits.
The only remaining question is--does ISAAC work on ActiveState and Strawberry?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=619594#c44)â€¢ 14 years ago |
|  | |

And for those curious, the speed of doing Perl's built-in srand before every generate\_random\_password call is:
builtin\_sr: 0 wallclock secs ( 0.09 usr + 0.07 sys = 0.16 CPU) @ 62500.00/s
So it's much faster than ISAAC still, but I don't think that the speed difference is going to be really significant to us. On most page loads, we call generate\_random\_password once or twice at most. There are some places that may call it more often, and I'd still like those to be fast, but we don't need it to be super-instantaneous.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=619594#c45)â€¢ 14 years ago |
|  | |

(In reply to [comment #43](/show_bug.cgi?id=619594#c43 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> The only remaining question is--does ISAAC work on ActiveState and Strawberry?
I cannot find it in ActivePerl.

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=619594#c46)â€¢ 14 years ago |
|  | |

(In reply to [comment #43](/show_bug.cgi?id=619594#c43 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> The only remaining question is--does ISAAC work on ActiveState and Strawberry?
strawberry: yes (including XS module)
activestate: core is in activestate's repo, but the XS module isn't
[http://searchcpan.activestate.com/module/Math::Random::ISAAC](http://searchcpan.activestate.com/module/Math%3A%3ARandom%3A%3AISAAC)
[http://searchcpan.activestate.com/module/Math::Random::ISAAC::XS](http://searchcpan.activestate.com/module/Math%3A%3ARandom%3A%3AISAAC%3A%3AXS)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=619594#c47)â€¢ 14 years ago |
|  | |

(In reply to [comment #36](/show_bug.cgi?id=619594#c36 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> The current planned release date of Bugzilla 4.0 is Tuesday, December 21.
The "current planned release date" is only a few days old. We initially planned to release 4.0 on Tuesday, Dec 13, i.e. last week, but we delayed it because QA is not done yet, and we still have one open blocker (which got a patch after Dec 13). So nothing is written in stone here. And despite you see where we "are coming from", your arguments are not better than ours, and there are several votes in favor of 4.0rc2, including justdave, who remains our project lead, AFAIK. Much better is to come to a consensus than impose an unilateral decision.

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=619594#c48)â€¢ 14 years ago |
|  | |

for what it's worth, rc2 gets my vote too.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=619594#c49)â€¢ 14 years ago |
|  | |

(In reply to [comment #46](/show_bug.cgi?id=619594#c46 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> activestate: core is in activestate's repo, but the XS module isn't
> [http://searchcpan.activestate.com/module/Math::Random::ISAAC](http://searchcpan.activestate.com/module/Math%3A%3ARandom%3A%3AISAAC)
> [http://searchcpan.activestate.com/module/Math::Random::ISAAC::XS](http://searchcpan.activestate.com/module/Math%3A%3ARandom%3A%3AISAAC%3A%3AXS)
ISAAC is only available on Perl 5.8 and 5.10, not on 5.12, AFAICS.

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=619594#c50)â€¢ 14 years ago |
|  | |

(In reply to [comment #49](/show_bug.cgi?id=619594#c49 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> ISAAC is only available on Perl 5.8 and 5.10, not on 5.12, AFAICS.
ah, right. sorry about that.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=619594#c51)â€¢ 14 years ago |
|  | |

<http://search.cpan.org/~jawnsy/Math-Random-ISAAC-1.002/lib/Math/Random/ISAAC.pm#USAGE_WARNING> says that Time::HiRes is as good as /dev/random as seed. The advantage of using Time::HiRes over /dev/random is that it is available on Windows too. rsoderberg suggested to combine it e.g. with our site\_wide\_secret key to make the seed even harder to crack.
If we call srand() right before rand(), this means we wouldn't need any other dependency, right?

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=619594#c52)â€¢ 14 years ago |
|  | |

(In reply to [comment #35](/show_bug.cgi?id=619594#c35 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> (In reply to [comment #33](/show_bug.cgi?id=619594#c33 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> > not really - the problem is that we have two consecutive queries being run on
> > the same seed.
>
> The fact that Perl's srand is poorly seeded \*is\* the underlying
> vulnerability. If it weren't, this vulnerability would not be a vulnerability.
> For example, with MT::Auto, I believe you'd be running randfindclean until the
> end of time.
No, that's not the seeding. If srand seeded using /dev/urandom we'd still be vulnerable because the algorithm used is predictable. Its the search-space of the algorithm.
> > (The alternate way of doing this is to hash the id and timestamp and have the
> > cookie contain (id,timestamp,hash) and not use a token at all)
>
> That's not a valid method of session persistence. It contains a timestamp.
which is used as an expiry time. We can use a token instead/as well, but still have the signed hash.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=619594#c53)â€¢ 14 years ago |
|  | |

(In reply to [comment #51](/show_bug.cgi?id=619594#c51 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> <http://search.cpan.org/~jawnsy/Math-Random-ISAAC-1.002/lib/Math/Random/ISAAC.pm#USAGE_WARNING>
> says that Time::HiRes is as good as /dev/random as seed.
That is not true. The seed needs to be composed of far more than 32 (or even 51/64) bits to be secure. I am sure that the writing in that POD is a typo, and it meant "the same as option 3" (which is "localtime").
> If we call srand() right before rand(), this means we wouldn't need any other
> dependency, right?
Unfortunately, on Windows, we still need another module. The problem is that rand() on Windows can only produce 32768 random values, no matter what.
So what we will do, for the branches, is:
\* If we're on Windows, require Math::Random::ISAAC and use it.
\* If we're not on Windows, use Math::Random::ISAAC if it's available,
otherwise do an "srand" at the start of generate\_random\_password and
use the system rand().
For trunk (and probably 4.0) we will just always use Math::Random::ISAAC, possibly even requiring the XS version if we can get it into ActiveState and there's no cross-platform barrier in general with it.
This will involve creating a new module, something like Bugzilla::RNG or Bugzilla::Random, that includes the seed-gathering code from Math::Random::MT::Auto and uses it to properly seed Math::Random::ISAAC.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=619594#c54)â€¢ 14 years ago |
|  | |

(In reply to [comment #52](/show_bug.cgi?id=619594#c52 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> which is used as an expiry time. We can use a token instead/as well, but still
> have the signed hash.
Yeah, that's true, we could do that actually. I don't feel too confident about using site\_wide\_secret for things that are that critically important though--I don't want the exposure of site\_wide\_secret to allow you to log in as anybody.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=619594#c55)â€¢ 14 years ago |
|  | |

Its an extra layer not a replacement if you sign the token. But separate bug to this.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=619594#c56)â€¢ 14 years ago |
|  | |

(In reply to [comment #54](/show_bug.cgi?id=619594#c54 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Yeah, that's true, we could do that actually. I don't feel too confident
> about using site\_wide\_secret for things that are that critically important
> though--I don't want the exposure of site\_wide\_secret to allow you to log in as
> anybody.
You mean you fear that someone could crack site\_wide\_secret and use it?
I'm marking this bug as blocking 4.0 as we are going to release 4.0rc2 which will contain various security fixes, including this one I hope.Flags: blocking4.0- â†’ blocking4.0+

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=619594#c57)â€¢ 14 years ago |
|  | |

Comment on [attachment 498181](/attachment.cgi?id=498181 "v2") [[details]](/attachment.cgi?id=498181&action=edit "v2") [[diff]](/attachment.cgi?id=498181&action=diff "v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=498181)
v2
Cancelling reviews as it seems we won't use this patch, per the recent comments.
I would like bbaetz and mkanat to agree on the root cause(s) of the problem. From my own understanding (which is pretty limited in this area), it seems that the problem is that once the seed is known, it's currently easy to guess the next random token. But maybe the problem is also that it's currently too easy to guess the seed? In which case the problem is on both sides: make it harder to guess the seed, and make it harder to guess the next token even if the seed is known.
[Attachment #498181](/attachment.cgi?id=498181&action=edit "v2") -
Flags: review?(glob)
[Attachment #498181](/attachment.cgi?id=498181&action=edit "v2") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=619594#c58)â€¢ 14 years ago |
|  | |

(In reply to [comment #42](/show_bug.cgi?id=619594#c42 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> This is the simplest possible patch that defeats randfindclean. Perl seeds from
> /dev/urandom if it is available, so this is probably actually a secure
> solution, on Linux. Every string that we send to the user will have a different
> seed, so no string is guessable from the previous seed.
Is it really the right thing to do? Per <http://perldoc.perl.org/functions/srand.html>, we shouldn't call srand() more than once:
"Do not call srand() (i.e., without an argument) more than once per process. The internal state of the random number generator should contain more entropy than can be provided by any seed, so calling srand() again actually loses randomness."

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=619594#c59)â€¢ 14 years ago |
|  | |

Its a bit of both. On unix, the seed isn't guessable (it uses /dev/urandom), but the search-space is small enough that that we can just try them all.
As well, there's basically only one seed that gives the first string, so once you've found it you know that you're right. Even if the search space was 2^64
> Is it really the right thing to do? Per
> <http://perldoc.perl.org/functions/srand.html>, we shouldn't call srand() more
> than once:
I \*suspect\* it doesn't hurt in this case, because we're generating a single string and then stopping, and outside of this issue we're only going to generate one per seed anyway. But this stuff isn't something I'm exactly an expert on...
perl-Math-Random-MT-Auto is packaged by Fedora, which is a plus. But it looks like that module auto-seeds using random.org if it can't find anything else. That's an Interesting designing choice, and we should probably turn that "feature" off.
Note that for windows, the function it uses is only available in XP and win2003 or greater. Do we support win2000? (Its also documented as deprecated - <http://msdn.microsoft.com/en-us/library/aa387694%28VS.85%29.aspx>)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=619594#c60)â€¢ 14 years ago |
|  | |

(In reply to [comment #59](/show_bug.cgi?id=619594#c59 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> As well, there's basically only one seed that gives the first string, so once
> you've found it you know that you're right. Even if the search space was 2^64
Ah ok, so that's a problem. ISAAC is not affected by this problem, right? i.e. different seeds can generate the same string at some point and then differ again, which makes it impossible to know the seed for sure?
> I \*suspect\* it doesn't hurt in this case, because we're generating a single
> string and then stopping, and outside of this issue we're only going to
> generate one per seed anyway.
But if the seed becomes too easy to guess, you could also guess the generated string. At least, that's how I understand it.
> Note that for windows, the function it uses is only available in XP and win2003
> or greater. Do we support win2000?
Windows 2000 and Windows XP SP2 reached EOL earlier this year. Now, I wouldn't want to break compatibility with these OSes as probably some older Bugzilla installations still run on these OS (especially Bugzilla 3.2 and 3.4). In that case, we should make these extra modules optional.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=619594#c61)â€¢ 14 years ago |
|  | |

Hey hey. I've been away for a few days, but I just read all the recent comments and I can clarify what the problem is and what the solution is:
The way randfindclean works is that it determines the seed used to generate the cookie. It does this by trying every number between 0 and 2^32 as the seed for srand(), and seeing which one generates that cookie. Then, it knows exactly how many times rand() was called after that, so it can just regenerate the password-reset token by essentially doing generate\_random\_password itself, using that found seed. Adding in an srand() at the start of generate\_random\_password means that the token is generated from a different seed than the cookie was, so knowing the cookie's seed doesn't help you, and randfindclean is defeated. This isn't a perfect solution, but it keeps Bugzilla effectively secure, as long as Bugzilla isn't running on Windows.
On Windows, there is another problem: there are only 32768 seeds. This mean there are only about 32768 possible tokens that Bugzilla could generate, making it far too easy to guess even with brute force. This happens because the random number generator in Windows is bad, and Perl uses that bad random number generator.
MT::Auto is a reasonable solution, because it uses something like 19973 bits as its seed, so you can't just try all the seeds. However, MT auto is not considered suitable for cryptographic purposes--even the authors of the Mersenne Twister algorithm (which is what MT::Auto uses--that's what MT stands for) say so in their original paper on the algorithm.
So, I want to use ISAAC, an algorithm that is considered appropriate for cryptographic purposes, and also has a very large seed--256 32-bit integers. The advantage of ISAAC is that even if I gave you the entire sequence of numbers it generated, you couldn't guess the next number unless you already knew the seed, which is unguessable.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=619594#c62)â€¢ 14 years ago |
|  | |

As far as Windows 2000 support, yes, this fix will end Windows 2000 support. There is no reasonable way to have a secure Bugzilla on any version of Windows that lacks RtlGenRand.
To be clear, here is my plan:
\* On the branches, for Windows we will require and use ISAAC.
\* On the branches, for non-Windows installations we will simply call srand at the start of generate\_random\_password, or optionally, if ISAAC is installed, use it.
\* On trunk, we will require and use ISAAC always.
The only problem is that the ISAAC module on CPAN does not know where to get a proper random seed from. The MT::Auto module \*does\* know where to get a proper random seed from. So, I need to copy the seeding code from MT::Auto and modify it to seed ISAAC. This will probably involve creating and publishing an ISAAC::Auto CPAN module, which could take some time, so I may just include that code directly in Bugzilla for the branches.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=619594#c63)â€¢ 14 years ago |
|  | |

(In reply to [comment #62](/show_bug.cgi?id=619594#c62 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> As far as Windows 2000 support, yes, this fix will end Windows 2000 support.
This is a problem. We cannot throw Windows 2000 users in the dust on stable branches, especially security ones. Moreover, Bugzilla will notify Windows 2000 admins that a new version is available, respectively 3.2.10 and 3.4.10, and when installing it, it will miserably fail. What do you plan to do with them? Just don't care?

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=619594#c64)â€¢ 14 years ago |
|  | |

Hum, this is weird:
<http://msdn.microsoft.com/en-us/library/aa387694%28VS.85%29.aspx>
says that you need at least Windows XP to use RtlGenRandom, but it also recommends to use CryptGenRandom, which is available on Windows 2000:
[http://msdn.microsoft.com/en-us/library/aa379942%28v=VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa379942%28v%3DVS.85%29.aspx)
Maybe we could ask the maintainer of the ISAAC Perl module to use CryptGenRandom instead. This would save installations still running on Windows 2000.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=619594#c65)â€¢ 14 years ago |
|  | |

(In reply to [comment #64](/show_bug.cgi?id=619594#c64 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Maybe we could ask the maintainer of the ISAAC Perl module
err.... I meant of Math::Random::MT::Auto.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=619594#c66)â€¢ 14 years ago |
|  | |

I filed <https://rt.cpan.org/Public/Bug/Display.html?id=64058> about this.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=619594#c67)â€¢ 14 years ago |
|  | |

Its times like this I prefer python....
So ISAAC, seeded with Crypt::Random on unix and CryptGenRandom on windows?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=619594#c68)â€¢ 14 years ago |
|  | |

(In reply to [comment #64](/show_bug.cgi?id=619594#c64 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Maybe we could ask the maintainer of the ISAAC Perl module to use
> CryptGenRandom instead.
The ISAAC perl module doesn't seed itself at all. The seeding is work that I would be doing. But yes, I would be basing it on the code from MT::Auto.
I would need a Windows 2000 installation that I had personal access to in order to test this, and the fix would delay the fixes for all the other branches, possibly by a significant amount (working with Win32::API is not easy).
Also, CryptGenRandom is not the ideally recommended method for generating this data, because apparently it pulls in the whole crypto API code, which may not be what's wanted. I'm not sure if that's just a memory issue, or if the problem is that the code might not be in the library, or if it's just a disk space issue, though.
(In reply to [comment #67](/show_bug.cgi?id=619594#c67 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> So ISAAC, seeded with Crypt::Random on unix and CryptGenRandom on windows?
Yes, that's pretty much the solution. Except I really think it would be better to use RtlGenRandom when we can.

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=619594#c69)â€¢ 14 years ago |
|  | |

it seems to me the problem is the //predictability// of generated tokens... is there anything wrong with using the existing code to generate a random value, but have the token module return a MD5 of the random value + salt as the token?

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=619594#c70)â€¢ 14 years ago |
|  | |

(In reply to [comment #68](/show_bug.cgi?id=619594#c68 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Also, CryptGenRandom is not the ideally recommended method for generating
> this data, because apparently it pulls in the whole crypto API code
Yeah, I checked, and it's fine to use RtlGenRandom, see the discussion in [bug 504270](/show_bug.cgi?id=504270 "RESOLVED WONTFIX - win_rand.c calls RtlGenRandom instead of CryptGenRandom on modern windows"). So forget my suggestion. :) This is still a problem to throw all Windows 2000 installations into the dust, though.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=619594#c71)â€¢ 14 years ago |
|  | |

(In reply to [comment #69](/show_bug.cgi?id=619594#c69 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> it seems to me the problem is the //predictability// of generated tokens... is
> there anything wrong with using the existing code to generate a random value,
> but have the token module return a MD5 of the random value + salt as the token?
There are a few problems:
1) An MD5 hash is longer than the tokens.token column, so would require a schema change on the branches.
2) It somewhat depends on what the salt is that you use, but because there are only 2^32 seeds, almost anything you pick that's based on srand/rand will be crackable. Basically, no matter how many contortions you put the token through, the cracker can put the token through the same contortions simply by trying all 2^32 possibilities. Even squaring it and making it 2^64 would mean that the token could be cracked in about six months, which is still too short of a time period. Imagine the resources that an attacker would dedicate to immediately know every non-public security flaw in both Firefox and WebKit.
3) Any solution that doesn't have a mathematical proof that's stood up to the test of time is likely to have hidden flaws that we can't predict.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a419426_120380)â€¢ 14 years ago |

Blocks: [620540](/show_bug.cgi?id=620540 "RESOLVED FIXED - Security Advisory for Bugzilla 4.0rc2, 3.6.4, 3.4.10 and 3.2.10")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=619594#c72)â€¢ 14 years ago |
|  | |

[CVE-2010-4568](https://www.cve.org/CVERecord?id=CVE-2010-4568)Alias: CVE-2010-4568

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=619594#c73)â€¢ 14 years ago |
|  | |

I've been working on this, today. I provided a patch to Crypt::Source::Random on CPAN to have it use Any::Moose instead of Moose, so that we can use it. Then I'm going to write and upload a Crypt::Source::Random::Win32. Finally, I'm going to write and upload a Math::Random::ISAAC::Auto module that uses Math::Random::ISAAC but seeds itself properly with Crypt::Source::Random (using and requiring the proper Win32 module on Windows).
Trunk and 4.0 will use and require Math::Random::ISAAC::Auto.
For the branches, I'm not sure--I may just integrate a bunch of seed-generation code into Bugzilla itself.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=619594#c74)â€¢ 14 years ago |
|  | |

(In reply to [comment #73](/show_bug.cgi?id=619594#c73 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> I've been working on this, today. I provided a patch to Crypt::Source::Random
> on CPAN to have it use Any::Moose instead of Moose, so that we can use it.
Crypt::Source::Random has many dependencies, including either Moose or Mouse. I see no reason to use this module, especially because it has never been discussed nor suggested above. I had the feeling that there was an agreement to copy the seed code used by Math::Random::MT::Auto, which requires no other dependencies.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=619594#c75)â€¢ 14 years ago |
|  | |

(In reply to [comment #74](/show_bug.cgi?id=619594#c74 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Crypt::Source::Random has many dependencies, including either Moose or Mouse.
That's fine. Understand that I am updating it with a new version that uses Any::Moose instead of Moose.
> I
> see no reason to use this module, especially because it has never been
> discussed nor suggested above.
Because it's better to use an existing module than to create our own. Also, it's better to re-use library code than to copy code around. In fact, copying code around is, in general, a really terrible thing to do. Also, using a purpose-built crypto library will give us more reliability. Finally, setting up these modules this way will allow me to pull in the right dependencies on the right platforms, meaning that Win32 users won't have to pull in Unix-specific things, and Unix users won't have to pull in the Win32 modules. Also, I would have had to re-write a lot of the MT::Auto code to be more appropriate for our uses, and I won't have to, this way.
There are lots of other good reasons to do this, but I sort of figure that the advantage of using libraries and publishing code as individual modules on the CPAN should be self-evident.
Using libraries is good software design. "This library has a lot of dependencies" is not, by itself, an argument that stands up in any form of software design, particularly given that we have install-module.pl, which does an excellent job of installing all dependencies no matter how many of them there are.

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=619594#c76)â€¢ 14 years ago |
|  | |

while i'm hesitant to turn this into another moose argument; i have concerns about making moose mandatory, due to the massive performance hit it imposes on mod\_cgi clients.
while using any::moose may //seem// better, "there's a VERY strong recommendation from the maintainers of Mouse itself to \*not use it\*", which leaves us with with no viable option for production mod\_cgi environments.

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=619594#c77)â€¢ 14 years ago |
|  | |

Attached patch

[generate\_random\_password](attachment.cgi?id=499252&action=diff)
â€” [Details](attachment.cgi?id=499252&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=499252)

note using RtlGenRandom isn't recommended by microsoft, and has caused problems in firefox before (see [bug 501605](/show_bug.cgi?id=501605 "RESOLVED FIXED - very slow startup for Firefox 3.5 due to accessing IE Internet Temporary Files and Windows Temp folder")); CryptGenRandom should be used instead.
here's sample code which calls CryptGenRandom on windows, and uses /dev/urandom or /dev/random on unix. it's a dependency free pure-perl solution using proven prng's.
right now it's slim on error checking and fallback, but that can be added if we agree to do this instead of pulling in more cpan modules.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=619594#c78)â€¢ 14 years ago |
|  | |

Comment on [attachment 499252](/attachment.cgi?id=499252 "generate_random_password") [[details]](/attachment.cgi?id=499252&action=edit "generate_random_password") [[diff]](/attachment.cgi?id=499252&action=diff "generate_random_password") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=499252)
generate\_random\_password
>+ my $chars =
>+ [ qw/ a b c d e f g h i j k l m n o p q r s t u v w x y z
>+ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
>+ 1 2 3 4 5 6 7 8 9 / ];
You're missing '0' (zero).

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=619594#c79)â€¢ 14 years ago |
|  | |

I agree that this is simpler.
Don't eval 'use'; just require.
Doesn't Solaris need to do something fancy with having egd running, or something?
/dev/random blocks, which will be a problem. I'm not sure if having that as a fallback is a good idea.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a548626_120380)â€¢ 14 years ago |

[Attachment #499252](/attachment.cgi?id=499252&action=edit "generate_random_password") -
Attachment is patch: true

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=619594#c80)â€¢ 14 years ago |
|  | |

(In reply to [comment #76](/show_bug.cgi?id=619594#c76 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> i have concerns
> about making moose mandatory,
We're not making Moose mandatory, or even used.
<http://search.cpan.org/dist/Any-Moose/lib/Any/Moose.pm>
> while using any::moose may //seem// better, "there's a VERY strong
> recommendation from the maintainers of Mouse itself to \*not use it\*",
I talked to the Moose folks themselves before switching over Crypt::Random::Source to use Any::Moose.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=619594#c81)â€¢ 14 years ago |
|  | |

(In reply to [comment #79](/show_bug.cgi?id=619594#c79 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Doesn't Solaris need to do something fancy with having egd running, or
> something?
Does Solaris lack /dev/random?
> /dev/random blocks, which will be a problem. I'm not sure if having that as a
> fallback is a good idea.
On platforms where there is no /dev/urandom, /dev/random usually acts just like urandom.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=619594#c82)â€¢ 14 years ago |
|  | |

glob: re RtlGenRandom, see [bug 504270](/show_bug.cgi?id=504270 "RESOLVED WONTFIX - win_rand.c calls RtlGenRandom instead of CryptGenRandom on modern windows"), which was the follow-up bug created after the bug you linked to.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=619594#c83)â€¢ 14 years ago |
|  | |

Comment on [attachment 499252](/attachment.cgi?id=499252 "generate_random_password") [[details]](/attachment.cgi?id=499252&action=edit "generate_random_password") [[diff]](/attachment.cgi?id=499252&action=diff "generate_random_password") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=499252)
generate\_random\_password
>--- Bugzilla/Util.pm 2010-09-30 00:54:55 +0000
>+{
>+ my($context, $genRandom);
That won't work on mod\_perl. Only "our" variables will persist across calls.
It would also be interesting to know whether or not doing this is thread-safe (for mod\_perl support on Windows).
>+ my $chars =
>+ [ qw/ a b c d e f g h i j k l m n o p q r s t u v w x y z
>+ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
>+ 1 2 3 4 5 6 7 8 9 / ];
You know, these can probably be in a constant. Also, the map() solution (or just doing ('A'..'Z')) is a little cleaner to read.
>+ if ($^O =~ /win32/i) {
Use ON\_WINDOWS instead.
>+ eval 'use Win32::API';
Agreed with an above commenter, you should "require Win32::API" here (and we should throw an error if it is not installed).
>+ $context ||= Win32::API->new("advapi32", "CryptAcquireContextA", "PNNNN", "N")
>+ or die "$^E\n";
That is $^E?
>+ $genRandom ||= Win32::API->new("advapi32", "CryptGenRandom", "NNP", "N")
>+ or die "$^E\n";
There are comments on various blogs and bugs that using CryptGenRandom will pull in the entire CryptoAPI. Does this mean that Bugzilla process will use significantly more memory on Windows than they do now? Also, does this take any extra time?
>+ $random = "\0" x $length;
>+ my $h = "\0" x 4;
>+ my $r = $context->Call($h, 0, 0, 1, 0xF0000000);
>+ $h = unpack('L', $h);
I'm sure you were going to do this anyhow (and I understand that this patch is just a PoC) but if these lines could get some comments explaining them, that would be pretty great.
>+ my $dev;
>+ if (-e "/dev/urandom") {
>+ $dev = "/dev/urandom";
>+ } elsif (-e "/dev/random") {
>+ $dev = "/dev/random";
>+ } else {
>+ # current token code
>+ }
Ah, the current token code is insecure. I would just suggest dying if we don't have a valid source of entropy.
One of the nice things about Crypt::Source::Random is that it has a ton of plugins that provide various sorts of random-data sources for various platforms and situations, that people could install if they need to.
>+ open(DEV, $dev) or die $!;
>+ read(DEV, $randomBytes, $length);
>+ close(DEV);
It would be best to do:
open(my $dev\_fh, '<', $dev) or die $!;
>+ my $token = '';
>+ foreach my $byte (split(//, $randomBytes)) {
So, you're only reading in eight bits of entropy for each character. At larger bit sizes this isn't as important, but I think you're going to generate non-uniform tokens, dividing 256 by 62.
I'll also test the performance of this vs. the current solution.
Finally, I'm not entirely sure of the mathematical characteristics of generating each character out of eight bits of entropy.
If all of these could be resolved, though, I think this could be a reasonable solution for the branches.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=619594#c84)â€¢ 14 years ago |
|  | |

(In reply to [comment #83](/show_bug.cgi?id=619594#c83 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> >+ my($context, $genRandom);
>
> That won't work on mod\_perl. Only "our" variables will persist across calls.
Simply store them in Bugzilla->request\_cache.
> If all of these could be resolved, though, I think this could be a reasonable
> solution for the branches.
This looks like a reasonable solution even on trunk, to generate the seed for ISAAC.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=619594#c85)â€¢ 14 years ago |
|  | |

Attached file
[RNG Speed Test](attachment.cgi?id=499377)
â€” [Details](attachment.cgi?id=499377&action=edit)

Here's the script that I'm using to do timing tests. The current results that I get from this are:
builtin: 1 wallclock secs ( 0.07 usr + 0.00 sys = 0.07 CPU) @ 142857.14/s
builtin\_sr: 0 wallclock secs ( 0.09 usr + 0.06 sys = 0.15 CPU) @ 66666.67/s
glob: 6 wallclock secs ( 0.25 usr + 5.97 sys = 6.22 CPU) @ 1607.72/s
isaac\_pp: 0 wallclock secs ( 0.40 usr + 0.00 sys = 0.40 CPU) @ 25000.00/s
isaac\_xs: 1 wallclock secs ( 0.12 usr + 0.00 sys = 0.12 CPU) @ 83333.33/s
mt\_auto: 0 wallclock secs ( 0.09 usr + 0.00 sys = 0.09 CPU) @ 111111.11/s
mt\_auto\_sr: 11 wallclock secs ( 4.87 usr + 6.10 sys = 10.97 CPU) @ 911.58/s
As we can see, reading from /dev/urandom for every generate\_random\_password call is significantly slower than using a PRNG, provided that we don't have to seed the PRNG on every call.
However, on most calls we only do generate\_random\_password once--this means that in the most common case under mod\_cgi, glob's solution will actually be faster than using ISAAC, because ISAAC has to seed itself with 256 32-bit integers (1024 bytes) and glob's solution only reads out about 10 bytes per invocation. Since we're doing only one invocation, usually (which will require seeding ISAAC) reading 10 bytes is faster than reading 1024 bytes (although I suspect the general difference will be negligible in practice).
Also, 1607 calls per second is fast enough--that means that a single generate\_random\_password call happens in under 1ms on my machine (a Core 2 Duo 2.66Ghz). /dev/urandom may have varying performance characteristics on various platforms, though--I don't know.
Really what we probably need is secure\_random\_string() for tokens, site\_wide\_secret, etc., and fast\_random\_string() (or just random\_string()) for places where were just happen to need randomness (like in the tests) and would rather have something fast than something secure.
I'd be interested to know what numbers this test does on Windows, also.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=619594#c86)â€¢ 14 years ago |
|  | |

 Note that under mod\_perl, using ISAAC will always be faster--srand happens during PerlChildInitHandler (meaning that it happens when Apache spawns a new httpd process) and will never affect any performance that the user can perceive.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=619594#c87)â€¢ 14 years ago |
|  | |

(In reply to [comment #84](/show_bug.cgi?id=619594#c84 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> This looks like a reasonable solution even on trunk, to generate the seed for
> ISAAC.
Ahh, the problem with that is that we become forever responsible for seed-generation on all platforms and under all possible configurations. I'd rather have a CPAN module do seed-generation, and then it can be updated independently for newer configurations or to be more secure.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=619594#c88)â€¢ 14 years ago |
|  | |

And by the way, for anybody who's concerned about Mouse:
time perl -MAny::Moose -e1
real 0m0.028s
user 0m0.023s
sys 0m0.004s
time perl -MCGI -e1
real 0m0.025s
user 0m0.021s
sys 0m0.003s
So if you're concerned about the performance aspects of Mouse, I suppose we'd better stop using CGI.pm too. :-)
Also, using Any::Moose generally alleviates the concerns about using Mouse. I still would only use Any::Moose for smaller systems like Crypt::Random::Source that are unlikely to run into any Mouse bugs or Moose/Mouse incompatibilities. (Those are the real worries with using Any::Moose in larger systems--the strange things that may happen when a Moose module extends a Mouse module, if they have complex relationships, which thankfully Crypt::Source::Random does not.)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=619594#c89)â€¢ 14 years ago |
|  | |

Just to record this information, here are all the Perl platforms that do not have /dev/urandom (as determined by a careful analysis of the Perl source code):
\* Windows
\* OS/2
\* DOS
\* Netware
\* Symbian (and its predecessor, EPOC)
I'm pretty sure we don't need to support OS/2, DOS, Netware, or Symbian (I doubt anybody's running Bugzilla on their clamshell phone). So we should be covered by using /dev/urandom on all platforms except for Windows, at least currently.

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=619594#c90)â€¢ 14 years ago |
|  | |

Comment on [attachment 499252](/attachment.cgi?id=499252 "generate_random_password") [[details]](/attachment.cgi?id=499252&action=edit "generate_random_password") [[diff]](/attachment.cgi?id=499252&action=diff "generate_random_password") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=499252)
generate\_random\_password
>--- Bugzilla/Util.pm 2010-09-30 00:54:55 +0000
>+++ Bugzilla/Util.pm 2010-12-22 08:53:25 +0000
>+ my $dev;
>+ if (-e "/dev/urandom") {
>+ $dev = "/dev/urandom";
>+ } elsif (-e "/dev/random") {
>+ $dev = "/dev/random";
>+ } else {
>+ # current token code
>+ }
If open and read fails on /dev/urandom but works on /dev/random, will we choose the latter?
Will users be permitted to select an alternate random device such as /dev/egd?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=619594#c91)â€¢ 14 years ago |
|  | |

 Ah, problem: Win32::API doesn't compile on 64-bit Perls.
<https://rt.cpan.org/Public/Bug/Display.html?id=55660>

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=619594#c92)â€¢ 14 years ago |
|  | |

Attached file
[Crypt::Random::Source::Win32, Work In Progress](attachment.cgi?id=499438) (obsolete)
â€” [Details](attachment.cgi?id=499438&action=edit)

This is a WIP Win32 provider for Crypt::Random::Source. I don't even know if it compiles yet, though, because I'm still working on getting a 32-bit Perl on my machine.
I do know that Crypt::Random::Source itself doesn't pass tests on Windows, but I can provide a patch to fix that.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=619594#c93)â€¢ 14 years ago |
|  | |

Comment on [attachment 499438](/attachment.cgi?id=499438 "Crypt::Random::Source::Win32, Work In Progress") [[details]](/attachment.cgi?id=499438&action=edit "Crypt::Random::Source::Win32, Work In Progress")
Crypt::Random::Source::Win32, Work In Progress
I finished the Win32 crypto provider. When it finishes uploading, it will be at:
<http://search.cpan.org/dist/Crypt-Random-Source-Strong-Win32/>
Because I felt like it would be fun, I also made it support CryptGenRandom for Windows 2000. So I suppose we may end up continuing support for Win2K on the branches.
This doesn't solve the "Win32::API doesn't work on 64-bit Perl" problem though.
[Attachment #499438](/attachment.cgi?id=499438&action=edit "Crypt::Random::Source::Win32, Work In Progress") -
Attachment is obsolete: true

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=619594#c94)â€¢ 14 years ago |
|  | |

(In reply to [comment #90](/show_bug.cgi?id=619594#c90 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> If open and read fails on /dev/urandom but works on /dev/random, will we choose
> the latter?
I think we shouldn't, because I can't think of any case where that would happen, and more importantly /dev/random blocks. Using /dev/random is thus a dos - you can hit MaxChild just by generating enough tokens.
> Will users be permitted to select an alternate random device such as /dev/egd?
I tihnk we've gone with Crypt::Random, in which case it'll be available, I guess, although I tihnk making this user-selectable is asking for problems.
I don't suppose Win32::API not working on 64-bit perl also breaks any other module we already depend on?

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=619594#c95)â€¢ 14 years ago |
|  | |

I think this bug depends on [bug 599539](/show_bug.cgi?id=599539 "RESOLVED FIXED - Update the mod_perl.pl code for Apache2::SizeLimit 0.92") on trunk and 4.0 as it already adds Win32::API to the requirement list.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=619594#c96)â€¢ 14 years ago |
|  | |

token.cgi was added on 2001-07-11, which is before 2.14, so I'm assuming Bugzilla has been vulnerable to this since 2.14.Version: 3.6.3 â†’ 2.14

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a1022338_73187)â€¢ 14 years ago |

Blocks: [621591](/show_bug.cgi?id=621591 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch")

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=619594#c97)â€¢ 14 years ago |
|  | |

I've finished the code and POD of Math::Random::Secure. Now I just have to write tests for it, package it up, and ship it to CPAN.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=619594#c98)â€¢ 14 years ago |
|  | |

I have uploaded Math::Random::Secure to CPAN:
<http://search.cpan.org/dist/Math-Random-Secure/>
Security-related review (and possibly other review) would be welcome.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=619594#c99)â€¢ 14 years ago |
|  | |

(In reply to [comment #98](/show_bug.cgi?id=619594#c98 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> I have uploaded Math::Random::Secure to CPAN:
We now need it available with ActivePerl, including all its dependencies.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=619594#c100)â€¢ 14 years ago |
|  | |

Attached patch

[trunk, v1](attachment.cgi?id=500123&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=500123&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500123)

Here's a patch to use Math::Random::Secure on trunk and 4.0.
Right now Crypt::Random::Source causes a warning during END every time it's used, but I've submitted a patch for that to the maintainer and it should be out in 0.07.
Also, Crypt::Random::Source doesn't pass tests on Windows, but it works fine anyway. It will pass tests as of 0.07 (I wrote the code and it's pending review by the maintainer).
Finally, there's the problem of Win32::API not working with 64-bit Perls. In response, Jan Dubois, the Windows ActivePerl maintainer, has offered to either fix Win32::API or to create a separate Win32:: module to just call the functions that we need. So we'll see how that plays out.
[Attachment #498181](/attachment.cgi?id=498181&action=edit "v2") -
Attachment is obsolete: true
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(glob)
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(LpSolit)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 101](/show_bug.cgi?id=619594#c101)â€¢ 14 years ago |
|  | |

Comment on [attachment 500123](/attachment.cgi?id=500123 "trunk, v1") [[details]](/attachment.cgi?id=500123&action=edit "trunk, v1") [[diff]](/attachment.cgi?id=500123&action=diff "trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500123)
trunk, v1
> sub generate\_random\_password {
> my $size = shift || 10; # default to 10 chars if nothing specified
>- return join("", map{ ('0'..'9','a'..'z','A'..'Z')[rand 62] } (1..$size));
>+ return join("", map{ ('0'..'9','a'..'z','A'..'Z')[irand 62] } (1..$size));
> }
This seems like a pretty inefficient use of randomness to me. irand creates a 32-bit random integer, and mods it down to the limit. So we are taking 32 bits of randomness and modding them down to 6 bits. In other words, generating a 10-character random password should take 60 bits of randomness, but actually draws 320 from the generator. If this function is called a lot, is there a risk of running out of entropy? One somewhat better implementation would be to call irand for a 32-bit number and then convert 5 lots of six bits to an index each, discarding the value if it's 62 or 63.
> # This loads most of our modules.
> use Bugzilla ();
>@@ -61,7 +62,7 @@
> my $server = Apache2::ServerUtil->server;
> my $conf = <<EOT;
> # Make sure each httpd child receives a different random seed ([bug 476622](/show_bug.cgi?id=476622 "RESOLVED FIXED - Assure that mod_perl children always receive a different srand() seed"))
>-PerlChildInitHandler "sub { srand(); }"
>+PerlChildInitHandler "sub { Math::Random::Secure::srand(); srand(); }"
Do we now only support Apache? If not, where is srand() called for non-Apache servers?
Gerv

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=619594#c102)â€¢ 14 years ago |
|  | |

(In reply to [comment #101](/show_bug.cgi?id=619594#c101 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> This seems like a pretty inefficient use of randomness to me.
It's not--ISAAC is highly efficient, and is optimized to generate 32 bit integers, specifically, using particular CPU instructions that are known to be fast.
> If this function is called a lot, is there a risk
> of running out of entropy?
No, cycles in ISAAC are minimally 2^40 values, and average 2^8295 values.
> One somewhat better implementation would be to call
> irand for a 32-bit number and then convert 5 lots of six bits to an index each,
> discarding the value if it's 62 or 63.
That's an overly complex implementation with no cryptographic advantage.
> Do we now only support Apache?
No, that's just the mod\_perl code.
> If not, where is srand() called for non-Apache servers?
It doesn't have to be called, irand() and rand() call it automatically. (See the docs of Math::Random::Secure.)

|  | [:Atoll](/user_profile?user_id=392417) |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=619594#c103)â€¢ 14 years ago |
|  | |

(In reply to [comment #101](/show_bug.cgi?id=619594#c101 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Comment on [attachment 500123](/attachment.cgi?id=500123 "trunk, v1") [[details]](/attachment.cgi?id=500123&action=edit "trunk, v1") [[diff]](/attachment.cgi?id=500123&action=diff "trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500123)
> trunk and 4.0, v1
> > # Make sure each httpd child receives a different random seed ([bug 476622](/show_bug.cgi?id=476622 "RESOLVED FIXED - Assure that mod_perl children always receive a different srand() seed"))
this comment should be updated to clarify why we're calling srand twice, to prevent well-intended corrections later

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=619594#c104)â€¢ 14 years ago |
|  | |

OK, fair enough :-)
Gerv

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=619594#c105)â€¢ 14 years ago |
|  | |

(In reply to [comment #103](/show_bug.cgi?id=619594#c103 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> this comment should be updated to clarify why we're calling srand twice, to
> prevent well-intended corrections later
Agreed.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=619594#c106)â€¢ 14 years ago |
|  | |

Attached file
[Calling Windows Perl's srand more than once is bad](attachment.cgi?id=500172)
â€” [Details](attachment.cgi?id=500172&action=edit)

Here's a short Perl script that proves the problem on Windows. It shows that, given a million attempts to generate a seed, only a very small number of different seeds are generated.
This script actually shows an even worse problem than Windows has, because the data that srand() is using on Windows won't change very much during the script. A better demonstration could possibly be done by putting "sleep 0.01" into the for loop, but brief experiments with that show that it does not improve the randomness at all.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 107](/show_bug.cgi?id=619594#c107)â€¢ 14 years ago |
|  | |

Attached file
[Better Windows Demonstration Script](attachment.cgi?id=500174) (obsolete)
â€” [Details](attachment.cgi?id=500174&action=edit)

This script starts a whole new Perl process for each sequence generated. This is just like what would actually be happening in a CGI environment. This is MUCH slower, though, so I haven't been able to run it to completion. Running it in short numbers so far indicates that the Windows Perl RNG may actually not be as weak as we thought, but I'll have to do more testing to be sure.
Anybody with a very fast Windows machine is welcome to test this with a million loops and see how it does.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 108](/show_bug.cgi?id=619594#c108)â€¢ 14 years ago |
|  | |

Comment on [attachment 500172](/attachment.cgi?id=500172 "Calling Windows Perl's srand more than once is bad") [[details]](/attachment.cgi?id=500172&action=edit "Calling Windows Perl's srand more than once is bad")
Calling Windows Perl's srand more than once is bad
Okay, this script actually just demonstrates that calling srand() more than once in the same process on Windows is not a good solution, and in fact is VERY bad--far far worse than it is on \*nix.
A real script to demonstrate the "Windows problem" is forthcoming.
[Attachment #500172](/attachment.cgi?id=500172&action=edit "Calling Windows Perl's srand more than once is bad") -
Attachment description: Prove the Windows Problem â†’ Calling Windows Perl's srand more than once is bad

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a1151714_73187)â€¢ 14 years ago |

[Attachment #500174](/attachment.cgi?id=500174&action=edit "Better Windows Demonstration Script") -
Attachment is obsolete: true

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 109](/show_bug.cgi?id=619594#c109)â€¢ 14 years ago |
|  | |

Attached file
[The Real Windows Problem](attachment.cgi?id=500176)
â€” [Details](attachment.cgi?id=500176&action=edit)

Here's the real Windows problem. On Windows Perl (Strawberry or ActiveState both, I believe--I tested Strawberry), this script will generate the same output every single time it is run. Perl's rand() on Windows is only capable of generating 2^15 values, period. They do come in different orders every time, based on the seed, though.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 110](/show_bug.cgi?id=619594#c110)â€¢ 14 years ago |
|  | |

That is really quite serious. However, Googling suggests it's not a new discovery:
<http://www.perlmonks.org/?node_id=803632>
However, have people realised the security implications? I suspect there are quite a lot of web apps out there which use Perl's rand() to generate random session cookies or stuff like that...
Gerv

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 111](/show_bug.cgi?id=619594#c111)â€¢ 14 years ago |
|  | |

As calling srand() several times is bad, couldn't we do the following on branches (as we don't plan to require new dependencies) to mitigate the problem:
1) append the login name to the URL to change the new password, to avoid brute force. So, instead of (sample stolen from [comment 0](/show_bug.cgi?id=619594#c0 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account")):
---- copy paste from the victims email ---
You have (or someone impersonating you has) requested to change your
Bugzilla password. To complete the change, visit the following link:
<https://bugzilla.mozilla.org/token.cgi?t=YKWG0y4oQT&a=cfmpw>
-----
you would now have:
---- copy paste from the victims email ---
You have (or someone impersonating you has) requested to change your
Bugzilla password. To complete the change, visit the following link:
<https://bugzilla.mozilla.org/token.cgi?l=foo@bar.com&t=YKWG0y4oQT&a=cfmpw>
-----
This way, you cannot just try all tokens randomly. You would have to know which email address you want to attack. Else, even when calling srand() every time generate\_random\_password() is called, you would still have a limited set of tokens to try, and one will probably succeed (though maybe not with the expected credentials, if you managed to crack a powerless user account).
2) If we append the login name to the URL, then we can use the same lock system as we use for login attemps, i.e. reject any new request after 5 attempts. So if an attacker tries 5 incorrect tokens against some given user account, then we don't validate new tokens for this user account from this IP address anymore for the next 30 minutes.
Note that my two proposals above aren't a replacement for srand() being called every time generate\_random\_password() is called, because without these calls to srand(), an attacker could still use the attack described in [comment 0](/show_bug.cgi?id=619594#c0 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"). But without my proposals, and with no other alternative than calling srand(), you still get a limited set of tokens which you can try randomly, and hope one will work.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 112](/show_bug.cgi?id=619594#c112)â€¢ 14 years ago |
|  | |

(In reply to [comment #99](/show_bug.cgi?id=619594#c99 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> We now need it available with ActivePerl, including all its dependencies.
and Fedora, Debian, Ubuntu, etc.
I think that for non-trunk we really need to use the patch from [comment 77](/show_bug.cgi?id=619594#c77 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"), at least for non-windows.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 113](/show_bug.cgi?id=619594#c113)â€¢ 14 years ago |
|  | |

(In reply to [comment #112](/show_bug.cgi?id=619594#c112 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> (In reply to [comment #99](/show_bug.cgi?id=619594#c99 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> > We now need it available with ActivePerl, including all its dependencies.
>
> and Fedora, Debian, Ubuntu, etc.
This is less of a problem for Linux distros, because you can call ./install-module.pl, and it will get missing modules from CPAN. Also, once these distros package Bugzilla 4.0, they will be forced to include these modules anyway. But ActiveState doesn't package Bugzilla, AFAIK. ;)

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 114](/show_bug.cgi?id=619594#c114)â€¢ 14 years ago |
|  | |

That's fine for people who roll their own, but not for distributions. A new package has to be created, approved, built, etc. Yes, its needed for 4.0, but that's a (planned) upgrade not a critical security fix.
Or is the plan for 3.6 to just do the srand thing for non-windows?

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 115](/show_bug.cgi?id=619594#c115)â€¢ 14 years ago |
|  | |

(In reply to [comment #111](/show_bug.cgi?id=619594#c111 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> This way, you cannot just try all tokens randomly. You would have to know which
> email address you want to attack.
I take that back. We don't display anywhere in the page which user account we are talking about. So even if the token is valid, the attacker won't know which user account to abuse.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 116](/show_bug.cgi?id=619594#c116)â€¢ 14 years ago |
|  | |

Attached file
[compare CORE::rand() and Math::Random::Secure::rand()](attachment.cgi?id=500216)
â€” [Details](attachment.cgi?id=500216&action=edit)

Something bothers me with Math::Random::Secure. My script shows than calling rand() 10 million times gives some duplicated numbers when using Math::Random::Secure::rand(), while they are all distinct when using CORE::rand():
# ./rand.pl
Results for core\_rand:
1: 10000000
10000000 distinct seeds
Results for math\_random\_secure\_rand:
1: 9976495
2: 11724
3: 19
9988238 distinct seeds
"3: 19" means that 19 numbers appeared 3 times.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 117](/show_bug.cgi?id=619594#c117)â€¢ 14 years ago |
|  | |

A stream where no number reoccurs is not random. There are 4 294 967 296 possible results (2^32). You are generating 1/429th of the space - I'm not at all surprised that there are some repeats. In fact, I'd expect it.
Gerv

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 118](/show_bug.cgi?id=619594#c118)â€¢ 14 years ago |
|  | |

(In reply to [comment #110](/show_bug.cgi?id=619594#c110 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> That is really quite serious. However, Googling suggests it's not a new
> discovery:
> <http://www.perlmonks.org/?node_id=803632>
Yes. However, for our case, 16 bits of randomness \*per character\* is enough for us, at least on the branches, as long as each generated token has a different seed (so that you can't work back to the seed from any generated token). The seeds are still 32 bits on Windows--I was afraid that they were only 16 bits.
If anybody doesn't understand how or why this is okay, ask me on IRC.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 119](/show_bug.cgi?id=619594#c119)â€¢ 14 years ago |
|  | |

(In reply to [comment #117](/show_bug.cgi?id=619594#c117 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> A stream where no number reoccurs is not random. There are 4 294 967 296
> possible results (2^32). You are generating 1/429th of the space - I'm not at
> all surprised that there are some repeats. In fact, I'd expect it.
Yes, you are right. Some maths tells me that the probability to get at least twice the same number in my sample is... 100%. :) The probability is already 70% with 100,000 iterations.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 120](/show_bug.cgi?id=619594#c120)â€¢ 14 years ago |
|  | |

(In reply to [comment #111](/show_bug.cgi?id=619594#c111 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Else, even when calling srand() every time
> generate\_random\_password() is called, you would still have a limited set of
> tokens to try, and one will probably succeed (though maybe not with the
> expected credentials, if you managed to crack a powerless user account).
I suspect that the time required to do 2^32 web requests against a remote server is a rather significant amount of time.
I actually went and tested this using "ab", the Apache web performance tool (it's short for ApacheBench). I used this command line:
ab -n 1000 -c 10 '<http://localhost/bugzilla-tip/token.cgi?t=abcdefg&a=cfmpw>'
It took about 60 seconds to do 1000 requests with 10 concurrent requests, and that's without any network latency, on a mod\_perl host. That gives us an average of 0.06 seconds per request. This means that trying 2^32 tokens would take 257698038 seconds, which is 71582 hours, which is 2982 days, which is about eight years.
Since password reset tokens are only valid for three days, and any admin would notice that level of activity, I think we're safe.
As such, we are not in danger from brute force attacks against tokens, even from somebody who is on the local host.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 121](/show_bug.cgi?id=619594#c121)â€¢ 14 years ago |
|  | |

(In reply to [comment #120](/show_bug.cgi?id=619594#c120 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> That gives us an average of 0.06 seconds per request.
Oh actually, there was an error in my testing. It turns out that 0.06 seconds is just the time it takes to return a "301 Moved Permanently" when calling an "ssl: always" installation over http://.
With a real token.cgi call, I could do about 4.5 requests per second, which is considerably slower, making a brute-force attack even less likely.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 122](/show_bug.cgi?id=619594#c122)â€¢ 14 years ago |
|  | |

I have a planned patch for the branches that I think will work just fine, and even a likely-decent solution for Windows on the branches.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 123](/show_bug.cgi?id=619594#c123)â€¢ 14 years ago |
|  | |

Comment on [attachment 500123](/attachment.cgi?id=500123 "trunk, v1") [[details]](/attachment.cgi?id=500123&action=edit "trunk, v1") [[diff]](/attachment.cgi?id=500123&action=diff "trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500123)
trunk, v1
When trying to log in, Bugzilla crashes with:
Software error:
Attribute (weak\_source) does not pass the type constraint because: Validation failed for 'ClassName' failed with value undef at lib/Crypt/Random/Source/Factory.pm line 76
Crypt::Random::Source::Factory::\_build\_any\_source('Crypt::Random::Source::Factory=HASH(0xa0d2cf8)') called at /usr/lib/perl5/vendor\_perl/5.10.1/i386-linux-thread-multi/Mouse/Meta/Method/Delegation.pm line 36
Crypt::Random::Source::Factory::new\_any('Crypt::Random::Source::Factory=HASH(0xa0d2cf8)') called at lib/Crypt/Random/Source/Factory.pm line 27
Crypt::Random::Source::Factory::get('Crypt::Random::Source::Factory=HASH(0xa0d2cf8)') called at lib/Math/Random/Secure/RNG.pm line 22
Math::Random::Secure::RNG::\_build\_seeder('Math::Random::Secure::RNG=HASH(0xa0d2b88)') called at lib/Math/Random/Secure/RNG.pm line 33
Math::Random::Secure::RNG::\_build\_seed('Math::Random::Secure::RNG=HASH(0xa0d2b88)') called at lib/Math/Random/Secure.pm line 45
eval {...} called at lib/Math/Random/Secure.pm line 45
Math::Random::Secure::srand() called at lib/Math/Random/Secure.pm line 51
Math::Random::Secure::\_srand\_if\_necessary() called at lib/Math/Random/Secure.pm line 26
Math::Random::Secure::irand(62) called at Bugzilla/Util.pm line 541
Bugzilla::Util::generate\_random\_password() called at Bugzilla/Token.pm line 255
Bugzilla::Token::GenerateUniqueToken('logincookies', 'cookie') called at Bugzilla/Auth/Persist/Cookie.pm line 63
Bugzilla::Auth::Persist::Cookie::persist\_login('Bugzilla::Auth::Persist::Cookie=HASH(0x9fd1580)', 'Bugzilla::User=HASH(0xa0883d0)') called at Bugzilla/Auth.pm line 155
Bugzilla::Auth::\_handle\_login\_result('Bugzilla::Auth=HASH(0x9fc2c20)', 'HASH(0x97e1d70)', 2) called at Bugzilla/Auth.pm line 95
Bugzilla::Auth::login('Bugzilla::Auth=HASH(0x9fc2c20)', 2) called at Bugzilla.pm line 336
Bugzilla::login('Bugzilla', 0) called at /var/www/html/bugzilla/index.cgi line 40
at lib/Crypt/Random/Source/Factory.pm line 76
Crypt::Random::Source::Factory::\_build\_any\_source('Crypt::Random::Source::Factory=HASH(0xa0d2cf8)') called at /usr/lib/perl5/vendor\_perl/5.10.1/i386-linux-thread-multi/Mouse/Meta/Method/Delegation.pm line 36
Crypt::Random::Source::Factory::new\_any('Crypt::Random::Source::Factory=HASH(0xa0d2cf8)') called at lib/Crypt/Random/Source/Factory.pm line 27
Crypt::Random::Source::Factory::get('Crypt::Random::Source::Factory=HASH(0xa0d2cf8)') called at lib/Math/Random/Secure/RNG.pm line 22
Math::Random::Secure::RNG::\_build\_seeder('Math::Random::Secure::RNG=HASH(0xa0d2b88)') called at lib/Math/Random/Secure/RNG.pm line 33
Math::Random::Secure::RNG::\_build\_seed('Math::Random::Secure::RNG=HASH(0xa0d2b88)') called at lib/Math/Random/Secure.pm line 45
eval {...} called at lib/Math/Random/Secure.pm line 45
Math::Random::Secure::srand() called at lib/Math/Random/Secure.pm line 51
Math::Random::Secure::\_srand\_if\_necessary() called at lib/Math/Random/Secure.pm line 26
Math::Random::Secure::irand(62) called at Bugzilla/Util.pm line 541
Bugzilla::Util::generate\_random\_password() called at Bugzilla/Token.pm line 255
Bugzilla::Token::GenerateUniqueToken('logincookies', 'cookie') called at Bugzilla/Auth/Persist/Cookie.pm line 63
Bugzilla::Auth::Persist::Cookie::persist\_login('Bugzilla::Auth::Persist::Cookie=HASH(0x9fd1580)', 'Bugzilla::User=HASH(0xa0883d0)') called at Bugzilla/Auth.pm line 155
Bugzilla::Auth::\_handle\_login\_result('Bugzilla::Auth=HASH(0x9fc2c20)', 'HASH(0x97e1d70)', 2) called at Bugzilla/Auth.pm line 95
Bugzilla::Auth::login('Bugzilla::Auth=HASH(0x9fc2c20)', 2) called at Bugzilla.pm line 336
Bugzilla::login('Bugzilla', 0) called at /var/www/html/bugzilla/index.cgi line 40
at lib/Math/Random/Secure.pm line 45
Math::Random::Secure::srand() called at lib/Math/Random/Secure.pm line 51
Math::Random::Secure::\_srand\_if\_necessary() called at lib/Math/Random/Secure.pm line 26
Math::Random::Secure::irand(62) called at Bugzilla/Util.pm line 541
Bugzilla::Util::generate\_random\_password() called at Bugzilla/Token.pm line 255
Bugzilla::Token::GenerateUniqueToken('logincookies', 'cookie') called at Bugzilla/Auth/Persist/Cookie.pm line 63
Bugzilla::Auth::Persist::Cookie::persist\_login('Bugzilla::Auth::Persist::Cookie=HASH(0x9fd1580)', 'Bugzilla::User=HASH(0xa0883d0)') called at Bugzilla/Auth.pm line 155
Bugzilla::Auth::\_handle\_login\_result('Bugzilla::Auth=HASH(0x9fc2c20)', 'HASH(0x97e1d70)', 2) called at Bugzilla/Auth.pm line 95
Bugzilla::Auth::login('Bugzilla::Auth=HASH(0x9fc2c20)', 2) called at Bugzilla.pm line 336
Bugzilla::login('Bugzilla', 0) called at /var/www/html/bugzilla/index.cgi line 40
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(glob)
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(LpSolit)
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review-

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 124](/show_bug.cgi?id=619594#c124)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.2, v1](attachment.cgi?id=500276&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=500276&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500276)

This is a patch for 3.2.
If Math::Random::Secure is installed, we use it.
If Math::Random::Secure is not installed:
\* On non-Windows platforms, we just do "srand", like the "Simplest Patch"
above.
\* On Windows, we have our own routine to generate a random-enough seed for
srand. It's not cryptographically ideal (because both Time::HiRes::time
and refaddr({}) are not perfectly random--they always increase) but it
does generate a unique seed every time, even when called in a very
tight loop, and that's all we need.
I'll also attach a test script that anyone can use on their platform to make sure that any generate\_random\_password implementation does in fact produce unique tokens every time (or almost every time).
[Attachment #500276](/attachment.cgi?id=500276&action=edit "Patch for 3.2, v1") -
Flags: review?(glob)
[Attachment #500276](/attachment.cgi?id=500276&action=edit "Patch for 3.2, v1") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 125](/show_bug.cgi?id=619594#c125)â€¢ 14 years ago |
|  | |

Attached file
[Test generate\_random\_password](attachment.cgi?id=500278)
â€” [Details](attachment.cgi?id=500278&action=edit)

Here's a script to test generate\_random\_password.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 126](/show_bug.cgi?id=619594#c126)â€¢ 14 years ago |
|  | |

(In reply to [comment #124](/show_bug.cgi?id=619594#c124 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Created [attachment 500276](/attachment.cgi?id=500276 "Patch for 3.2, v1") [[details]](/attachment.cgi?id=500276&action=edit "Patch for 3.2, v1") [[diff]](/attachment.cgi?id=500276&action=diff "Patch for 3.2, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500276)
> Patch for 3.2, v1
And I just ran the tests on Windows and I can confirm that this patch works fine there.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 127](/show_bug.cgi?id=619594#c127)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.4, v1](attachment.cgi?id=500280&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=500280&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500280)

Identical approach to 3.2, just requires a different patch for Util.pm because of conflicts.
[Attachment #500280](/attachment.cgi?id=500280&action=edit "Patch for 3.4, v1") -
Flags: review?(glob)
[Attachment #500280](/attachment.cgi?id=500280&action=edit "Patch for 3.4, v1") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 128](/show_bug.cgi?id=619594#c128)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.6, v1](attachment.cgi?id=500281&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=500281&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500281)

This is the same as the other branch patches, in spirit, but it uses Bugzilla->feature, since that's available on 3.6, and adds a string to strings.txt.pl, for the feature.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a1202219_73187)â€¢ 14 years ago |

[Attachment #500281](/attachment.cgi?id=500281&action=edit "Patch for 3.6, v1") -
Flags: review?(glob)
[Attachment #500281](/attachment.cgi?id=500281&action=edit "Patch for 3.6, v1") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 129](/show_bug.cgi?id=619594#c129)â€¢ 14 years ago |
|  | |

Reduced testcase for [comment 123](/show_bug.cgi?id=619594#c123 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"):
perl -I "lib" -MMath::Random::Secure -T -we 'Math::Random::Secure::srand'
Attribute (weak\_source) does not pass the type constraint because: Validation failed for 'ClassName' failed with value undef at lib/Crypt/Random/Source/Factory.pm line 76
Crypt::Random::Source::Factory::\_build\_any\_source('Crypt::Random::Source::Factory=HASH(0x8e17770)') called at /usr/lib/perl5/vendor\_perl/5.10.1/i386-linux-thread-multi/Mouse/Meta/Method/Delegation.pm line 36
Crypt::Random::Source::Factory::new\_any('Crypt::Random::Source::Factory=HASH(0x8e17770)') called at lib/Crypt/Random/Source/Factory.pm line 27
Crypt::Random::Source::Factory::get('Crypt::Random::Source::Factory=HASH(0x8e17770)') called at lib/Math/Random/Secure/RNG.pm line 22
Math::Random::Secure::RNG::\_build\_seeder('Math::Random::Secure::RNG=HASH(0x8b637b8)') called at lib/Math/Random/Secure/RNG.pm line 33
Math::Random::Secure::RNG::\_build\_seed('Math::Random::Secure::RNG=HASH(0x8b637b8)') called at lib/Math/Random/Secure.pm line 45
eval {...} called at lib/Math/Random/Secure.pm line 45
Math::Random::Secure::srand() called at -e line 1
If you remove -T, then it works correctly.
<mkanat> LpSolit: Ahh, I bet Crypt::Random::Source is not taint-safe.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 130](/show_bug.cgi?id=619594#c130)â€¢ 14 years ago |
|  | |

(In reply to [comment #129](/show_bug.cgi?id=619594#c129 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> <mkanat> LpSolit: Ahh, I bet Crypt::Random::Source is not taint-safe.
I've submitted a fix for Crypt::Random::Source to its maintainer. It should be out in Crypt::Random::Source 0.07.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 131](/show_bug.cgi?id=619594#c131)â€¢ 14 years ago |
|  | |

Comment on [attachment 500276](/attachment.cgi?id=500276 "Patch for 3.2, v1") [[details]](/attachment.cgi?id=500276&action=edit "Patch for 3.2, v1") [[diff]](/attachment.cgi?id=500276&action=diff "Patch for 3.2, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500276)
Patch for 3.2, v1
>=== modified file 'Bugzilla/Util.pm'
>+sub \_do\_srand {
>+ # On Windows, calling srand over and over in the same process produces
>+ # very bad results. We have to create our own seed by a somewhat-random
>+ # process. This is not perfect, cryptographically, but it should be
>+ # random-enough to generate a reasonable seed in a 32-bit space.
>+ if (ON\_WINDOWS) {
IMO, if Math::Random::Secure is not installed, we should fall back to calling the Crypto API ourselves using Win32::API if we are using Perl 32-bits. We should only fall back to this custom seed generator on Windows 64-bits (as we have no guarantee it's crypto-safe).

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 132](/show_bug.cgi?id=619594#c132)â€¢ 14 years ago |
|  | |

(In reply to [comment #131](/show_bug.cgi?id=619594#c131 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> IMO, if Math::Random::Secure is not installed, we should fall back to calling
> the Crypto API ourselves using Win32::API if we are using Perl 32-bits. We
> should only fall back to this custom seed generator on Windows 64-bits (as we
> have no guarantee it's crypto-safe).
Well, I thought about that, yeah, but the only barrier to installing Math::Random::Secure is whether or not you can install Win32::API. If you can install Win32::API, you can install Math::Random::Secure. So I don't really want to duplicate code between Bugzilla and Math::Random::Secure. I'll see if I can work with ActiveState to get Math::Random::Secure packaged, too, once it's available.
FWIW, the \_do\_srand() code is not \*cryptographically\* secure, in a mathematically-provable way. But as long as it generates separate seeds for every call to generate\_random\_password, it shouldn't matter, because reverse-engineering the seed from one generate\_random\_password call won't allow you to figure out the seed used in other generate\_random\_password calls. That is, we only have to worry about the cryptographic security of our algorithms if we use the same seed for different generate\_random\_password calls, which I'm pretty sure is impossible (or nearly impossible) with the \_do\_srand() code as it is now.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 133](/show_bug.cgi?id=619594#c133)â€¢ 14 years ago |
|  | |

Also, just to elaborate a bit more--we \*know\* the RNG shipped with Perl is not cryptographically secure. srand() is only getting 32 bits no matter what, and the rand() algorithm used is not that awesome. That's why we're calling srand every time, when Math::Random::Secure isn't installed--so that it doesn't matter how secure rand() is, because cracking the seed used for one token doesn't get youanything.
As long as we reliably generate separate seeds with each \_do\_srand() call, that's all we care about, and as far as I can see in my testing, we do. It could use some testing on a faster Windows machine than mine, though.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 134](/show_bug.cgi?id=619594#c134)â€¢ 14 years ago |
|  | |

(In reply to [comment #132](/show_bug.cgi?id=619594#c132 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Well, I thought about that, yeah, but the only barrier to installing
> Math::Random::Secure is whether or not you can install Win32::API. If you can
> install Win32::API, you can install Math::Random::Secure.
But the difference is that not everybody has or will have Math::Random::Secure installed, while Win32::API is installed by default, at least with ActivePerl (in fact, you cannot even uninstall it).

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 135](/show_bug.cgi?id=619594#c135)â€¢ 14 years ago |
|  | |

Comment on [attachment 500123](/attachment.cgi?id=500123 "trunk, v1") [[details]](/attachment.cgi?id=500123&action=edit "trunk, v1") [[diff]](/attachment.cgi?id=500123&action=diff "trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500123)
trunk, v1
This patch doesn't apply cleanly on the 4.0 branch due to [bug 599552](/show_bug.cgi?id=599552 "RESOLVED FIXED - CGI.pm compile options are different under mod_perl than normal") which landed on trunk only. You will have to attach a separate patch for 4.0. Also, you have to require Math::Random::Secure 0.04 at minimum due to the taint issue in older versions of Crypt::Random::Source.
I tested your patch in 4.1 on Linux, and it's working fine. Let's see if I can test it on Windows. Byron, help wanted for Windows (ActivePerl + Strawberry Perl). :)
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Attachment description: trunk and 4.0, v1 â†’ trunk, v1
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(glob)
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(LpSolit)
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review-

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 136](/show_bug.cgi?id=619594#c136)â€¢ 14 years ago |
|  | |

Comment on [attachment 500123](/attachment.cgi?id=500123 "trunk, v1") [[details]](/attachment.cgi?id=500123&action=edit "trunk, v1") [[diff]](/attachment.cgi?id=500123&action=diff "trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500123)
trunk, v1
Tested on Linux and Windows 7 (using Strawberry Perl 5.12.1) + Math::Random::Secure 0.05. r=LpSolit
Byron, do you have Windows XP in hands?
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(LpSolit) â†’ review+

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 137](/show_bug.cgi?id=619594#c137)â€¢ 14 years ago |
|  | |

(In reply to [comment #136](/show_bug.cgi?id=619594#c136 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Byron, do you have Windows XP in hands?
sorry, not until monday (i'm still on my christmas leave, and only have win7/64 at home).

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 138](/show_bug.cgi?id=619594#c138)â€¢ 14 years ago |
|  | |

Attached patch

[Patch For 4.0, v1](attachment.cgi?id=502620&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=502620&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=502620)

I went with a 3.6-like method for 4.0. I don't want to \*require\* Math::Random::Secure just yet for 4.0. We have no idea if or when Win32::API will work on 64-bit Windows Perl, which means we have no idea when those users will be able to install Math::Random::Secure. Also, I want to give packagers more time to be able to package M::R::S so that people can have packages available for it when they install 4.0.
[Attachment #502620](/attachment.cgi?id=502620&action=edit "Patch For 4.0, v1") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 139](/show_bug.cgi?id=619594#c139)â€¢ 14 years ago |
|  | |

Comment on [attachment 500281](/attachment.cgi?id=500281 "Patch for 3.6, v1") [[details]](/attachment.cgi?id=500281&action=edit "Patch for 3.6, v1") [[diff]](/attachment.cgi?id=500281&action=diff "Patch for 3.6, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=500281)
Patch for 3.6, v1
Tested on Linux and Windows 7, both with and without Math::Random::Secure, and seems to work fine. r=LpSolit
[Attachment #500281](/attachment.cgi?id=500281&action=edit "Patch for 3.6, v1") -
Flags: review?(LpSolit) â†’ review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 140](/show_bug.cgi?id=619594#c140)â€¢ 14 years ago |
|  | |

Okay, there is a problem with the branch version of this patch:
\* There are still only 2^32 possible site\_wide\_secret values if you're using \_do\_srand.
\* When generating hash tokens, the only secret component is the site\_wide\_secret.
So, site\_wide\_secret can be cracked in the same way as a token can be cracked in [comment 0](/show_bug.cgi?id=619594#c0 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"), using \_do\_srand. I have an idea for a patch that should make this better.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 141](/show_bug.cgi?id=619594#c141)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 4.0, v2](attachment.cgi?id=503819&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=503819&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503819)

This changes generate\_random\_password to re-generate a new seed every 8 characters if we are using \_do\_srand. Mathematically, this adds 32 to the total key size every time we grab a new key. (I'm sure there are limiting mathematical factors, though.) So if we call \_do\_srand twice in one generate\_random\_password call, we effectively have a 64-bit key. Calling it three times, we have a 96-bit key, etc.
I set it to regenerate every five characters. This makes the seed bit size and the string bit strength roughly equal. Here's a clearer explanation of what I mean:
With a 5-character string, we'd have roughly the equivalent of a 30-bit key. 10 characters gets us 60 bits, 15 would be 90, etc. So for a 5-character string we have a 32-bit seed and 30 bits of actual randomness in the string itself. For a 10-character string we have a 64-bit seed and 60 bits of randomness in the string itself, and so on.
I'm sure that in reality, the solution is slightly weaker than that due to various factors. All I \*really\* care about, though, is that this will give us roughly a 384-bit key strength for our site\_wide\_secret now.
The patch also forces a regeneration of the site\_wide\_secret.
Now that I understand more about key sizes, I see that a 256-character key was unnecessary, and 64 characters is plenty.
I also added a comment to generate\_random\_password explaining how to calculate the strength of strings it generates.
Some of these pieces I will have to forward-port to trunk.
[Attachment #502620](/attachment.cgi?id=502620&action=edit "Patch For 4.0, v1") -
Attachment is obsolete: true
[Attachment #503819](/attachment.cgi?id=503819&action=edit "Patch for 4.0, v2") -
Flags: review?(LpSolit)
[Attachment #502620](/attachment.cgi?id=502620&action=edit "Patch For 4.0, v1") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 142](/show_bug.cgi?id=619594#c142)â€¢ 14 years ago |
|  | |

(In reply to [comment #141](/show_bug.cgi?id=619594#c141 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> This changes generate\_random\_password to re-generate a new seed every 8
> characters
That should say "every 5 characters".

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 143](/show_bug.cgi?id=619594#c143)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for trunk, v2](attachment.cgi?id=503820&action=diff)
â€” [Details](attachment.cgi?id=503820&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503820)

This makes checksetup forcibly generate a new site\_wide\_secret if we're using an old-style site\_wide\_secret, and also adds the comment to Bugzilla::Util about calculating key strength.
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Attachment is obsolete: true
[Attachment #503820](/attachment.cgi?id=503820&action=edit "Patch for trunk, v2") -
Flags: review?(LpSolit)
[Attachment #500123](/attachment.cgi?id=500123&action=edit "trunk, v1") -
Flags: review?(glob)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 144](/show_bug.cgi?id=619594#c144)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.6, v2](attachment.cgi?id=503824&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=503824&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503824)

Updated 3.6 patch, same updates as the 4.0 patch.
[Attachment #500281](/attachment.cgi?id=500281&action=edit "Patch for 3.6, v1") -
Attachment is obsolete: true
[Attachment #503824](/attachment.cgi?id=503824&action=edit "Patch for 3.6, v2") -
Flags: review?(LpSolit)
[Attachment #500281](/attachment.cgi?id=500281&action=edit "Patch for 3.6, v1") -
Flags: review?(glob)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 145](/show_bug.cgi?id=619594#c145)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.6, v2 (Actual)](attachment.cgi?id=503826&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=503826&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503826)

Attached the wrong patch the first time.
[Attachment #503824](/attachment.cgi?id=503824&action=edit "Patch for 3.6, v2") -
Attachment is obsolete: true
[Attachment #503824](/attachment.cgi?id=503824&action=edit "Patch for 3.6, v2") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a2548211_73187)â€¢ 14 years ago |

[Attachment #503826](/attachment.cgi?id=503826&action=edit "Patch for 3.6, v2 (Actual)") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 146](/show_bug.cgi?id=619594#c146)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.4, v2](attachment.cgi?id=503828&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=503828&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503828)

Same updates.
[Attachment #500280](/attachment.cgi?id=500280&action=edit "Patch for 3.4, v1") -
Attachment is obsolete: true
[Attachment #503828](/attachment.cgi?id=503828&action=edit "Patch for 3.4, v2") -
Flags: review?(LpSolit)
[Attachment #500280](/attachment.cgi?id=500280&action=edit "Patch for 3.4, v1") -
Flags: review?(glob)
[Attachment #500280](/attachment.cgi?id=500280&action=edit "Patch for 3.4, v1") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 147](/show_bug.cgi?id=619594#c147)â€¢ 14 years ago |
|  | |

Comment on [attachment 503826](/attachment.cgi?id=503826 "Patch for 3.6, v2 (Actual)") [[details]](/attachment.cgi?id=503826&action=edit "Patch for 3.6, v2 (Actual)") [[diff]](/attachment.cgi?id=503826&action=diff "Patch for 3.6, v2 (Actual)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503826)
Patch for 3.6, v2 (Actual)
Oh wait, this is missing the localconfig-update code.
[Attachment #503826](/attachment.cgi?id=503826&action=edit "Patch for 3.6, v2 (Actual)") -
Attachment is obsolete: true
[Attachment #503826](/attachment.cgi?id=503826&action=edit "Patch for 3.6, v2 (Actual)") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 148](/show_bug.cgi?id=619594#c148)â€¢ 14 years ago |
|  | |

Comment on [attachment 503828](/attachment.cgi?id=503828 "Patch for 3.4, v2") [[details]](/attachment.cgi?id=503828&action=edit "Patch for 3.4, v2") [[diff]](/attachment.cgi?id=503828&action=diff "Patch for 3.4, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503828)
Patch for 3.4, v2
And so is this one.
[Attachment #503828](/attachment.cgi?id=503828&action=edit "Patch for 3.4, v2") -
Flags: review?(LpSolit) â†’ review-

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a2548610_73187)â€¢ 14 years ago |

[Attachment #503828](/attachment.cgi?id=503828&action=edit "Patch for 3.4, v2") -
Attachment is obsolete: true

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 149](/show_bug.cgi?id=619594#c149)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.6, v3](attachment.cgi?id=503831&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=503831&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503831)

Now this properly updates localconfig with the new site\_wide\_secret.
[Attachment #503831](/attachment.cgi?id=503831&action=edit "Patch for 3.6, v3") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 150](/show_bug.cgi?id=619594#c150)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.4, v3](attachment.cgi?id=503833&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=503833&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503833)

[Attachment #503833](/attachment.cgi?id=503833&action=edit "Patch for 3.4, v3") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 151](/show_bug.cgi?id=619594#c151)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.2, v2](attachment.cgi?id=503836&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=503836&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503836)

This has some extra Localconfig-related code compared to the other patches. Bugzilla 3.2 didn't re-write localconfig when it added new variables, so without this extra code, I was ending up with "$site\_wide\_secret" twice in "localconfig". Technically that was okay--it didn't affect the system's functionality. But since this has to do with security, I didn't want to leave the old one lying around and risk the chance that users might edit the file in some way that makes them continue to use the old one.
This does result in there being an extra comment in localconfig, but really, this is a very old branch at this point, and all I really think we need to do is to make it work.
[Attachment #500276](/attachment.cgi?id=500276&action=edit "Patch for 3.2, v1") -
Attachment is obsolete: true
[Attachment #503836](/attachment.cgi?id=503836&action=edit "Patch for 3.2, v2") -
Flags: review?(LpSolit)
[Attachment #500276](/attachment.cgi?id=500276&action=edit "Patch for 3.2, v1") -
Flags: review?(glob)
[Attachment #500276](/attachment.cgi?id=500276&action=edit "Patch for 3.2, v1") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 152](/show_bug.cgi?id=619594#c152)â€¢ 14 years ago |
|  | |

Also, please fix the minimum version of Math::Random::Secure required. We want 0.04 as a minimum.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 153](/show_bug.cgi?id=619594#c153)â€¢ 14 years ago |
|  | |

(In reply to [comment #152](/show_bug.cgi?id=619594#c152 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Also, please fix the minimum version of Math::Random::Secure required. We want
> 0.04 as a minimum.
Oh, right, arrrgh. Since this is holding up one of our most important releases ever and is one of the most critical security issues we've ever had, do you think that you could review the patches as they are and then I can just carry forward r+ on to some patches that have the updated Requirements? (Since it only requires editing the patch.)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 154](/show_bug.cgi?id=619594#c154)â€¢ 14 years ago |
|  | |

Comment on [attachment 503820](/attachment.cgi?id=503820 "Patch for trunk, v2") [[details]](/attachment.cgi?id=503820&action=edit "Patch for trunk, v2") [[diff]](/attachment.cgi?id=503820&action=diff "Patch for trunk, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503820)
Patch for trunk, v2
>=== modified file 'Bugzilla/Install/Requirements.pm'
>+ package => 'Math-Random-Secure',
>+ module => 'Math::Random::Secure',
>+ version => 0,
0 => 0.04. r=LpSolit with this fix.
[Attachment #503820](/attachment.cgi?id=503820&action=edit "Patch for trunk, v2") -
Flags: review?(LpSolit) â†’ review+

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 155](/show_bug.cgi?id=619594#c155)â€¢ 14 years ago |
|  | |

(In reply to [comment #154](/show_bug.cgi?id=619594#c154 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Comment on [attachment 503820](/attachment.cgi?id=503820 "Patch for trunk, v2") [[details]](/attachment.cgi?id=503820&action=edit "Patch for trunk, v2") [[diff]](/attachment.cgi?id=503820&action=diff "Patch for trunk, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503820)
> Patch for trunk, v2
>
> >=== modified file 'Bugzilla/Install/Requirements.pm'
>
> >+ package => 'Math-Random-Secure',
> >+ module => 'Math::Random::Secure',
> >+ version => 0,
>
> 0 => 0.04. r=LpSolit with this fix.
Why then is the 4.0 patch requiring 0.05?
From the 4.0 patch:
+ # This is the first version that installs properly on Windows.
+ version => '0.05',

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 156](/show_bug.cgi?id=619594#c156)â€¢ 14 years ago |
|  | |

(In reply to [comment #155](/show_bug.cgi?id=619594#c155 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Why then is the 4.0 patch requiring 0.05?
Because I remembered that 0.05 fixed a bug on Windows \*after\* I clicked "Submit", and I wrote an updated comment for s/0.04/0.05/, got distracted, and forgot to submit it. But yes, it should be "0.05". :)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 157](/show_bug.cgi?id=619594#c157)â€¢ 14 years ago |
|  | |

Also, note that Math::Random::ISAAC 1.002 and older do not pass tests on Windows with Perl 5.12, see <https://rt.cpan.org/Public/Bug/Display.html?id=64536>. This means ActivePerl 5.12.2 doesn't provide this package via ppm. This problem has been fixed in Math::Random::ISAAC 1.003, which has been uploaded to CPAN today. Maybe should Math::Random::Secure require this version as a minimum, to be sure to work with Perl 5.12 on Windows. This would mean a new version of Math::Random::Secure (0.06?). :(

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 158](/show_bug.cgi?id=619594#c158)â€¢ 14 years ago |
|  | |

Comment on [attachment 503819](/attachment.cgi?id=503819 "Patch for 4.0, v2") [[details]](/attachment.cgi?id=503819&action=edit "Patch for 4.0, v2") [[diff]](/attachment.cgi?id=503819&action=diff "Patch for 4.0, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=503819)
Patch for 4.0, v2
>=== modified file 'Bugzilla/Util.pm'
>+sub \_do\_srand {
>+ # On Windows, calling srand over and over in the same process produces
>+ # very bad results. We have to create our own seed by a somewhat-random
>+ # process. This is not perfect, cryptographically, but it should be
>+ # random-enough to generate a reasonable seed for our uses.
>+ if (ON\_WINDOWS) {
>+ # We start with the process id.
>+ # Then we add the current hi-res timestamp.
>+ # And finally we throw in the address of a just-created hashref, which
>+ # is fairly random (depends a lot upon timing).
>+ my @seed\_data = ($$, Time::HiRes::time(), refaddr({}));
>+ # Then we hash all of these together.
>+ my $seed = join('\*', @seed\_data);
>+ $seed = md5($seed);
>+ # And take the first four bytes of the md5 as a 32-bit integer.
>+ $seed = unpack('L', $seed);
>+ srand($seed);
>+ return;
>+ }
OK, I definitely don't trust too much what is done here. My opinion for Bugzilla 4.0 is that we should require Math::Random::Secure on \*nix. Linux packagers will add the missing dependencies when packaging Bugzilla 4.0. Once 4.0rc2 is out, we can notify them so that they have time before 4.0 final is out. Also, sysadmins who only want to depend on packages provided by their distro won't install Bugzilla 4.0 themselves, and if they do, then this means that they are fine to also install Math:Random::Secure themselves. Again, not a reason to not make it mandatory. For Bugzilla 3.6.4 and older, I agree to make it optional.
About Windows, and due to the fact that Win32::API doesn't work on Windows 64-bit, we unfortunately cannot make Math::Random::Secure mandatory (though it's now available on Windows 32-bit, see my previous comment). \*But\* there is IMO a better alternative than your hack (which gives us no guarantee of being cryptographically strong). On
[1] [http://msdn.microsoft.com/en-us/library/ff358862%28v=PROT.10%29.aspx](http://msdn.microsoft.com/en-us/library/ff358862%28v%3DPROT.10%29.aspx)
[2] [http://msdn.microsoft.com/en-us/library/d12e9f49-9aeb-40f8-95e7-5901e73836fb%28v=PROT.10%29#id16](http://msdn.microsoft.com/en-us/library/d12e9f49-9aeb-40f8-95e7-5901e73836fb%28v%3DPROT.10%29#id16)
[3] <http://tools.ietf.org/html/rfc4122#section-4.4>
you can read (from note #16 in [2]):
"For reasons of increased privacy protection for our customers, Microsoft systems, beginning with Windows 2000, prefer to generate version 4 GUIDs in which the 122 bits of nonformat information are random. Although only a small minority of version 4 GUIDs require cryptographic randomness, the random bits for all version 4 GUIDs built in Windows are obtained via the Windows CryptGenRandom cryptographic API or the equivalent, which is the same source that is used for the generation of cryptographic keys. This source is FIPS 140-certified in various versions of Windows"
The version 4 GUIDs mentions in this document is described in RFC 4122 [3], see section 4.4. As these randomly-generated GUIDs are available thanks to Win32::GuidGen(), which calls CoCreateGuid(), we can simply use them when generate\_random\_password() is called.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 159](/show_bug.cgi?id=619594#c159)â€¢ 14 years ago |
|  | |

(In reply to [comment #158](/show_bug.cgi?id=619594#c158 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> OK, I definitely don't trust too much what is done here. My opinion for
> Bugzilla 4.0 is that we should require Math::Random::Secure on \*nix. Linux
> packagers will add the missing dependencies when packaging Bugzilla 4.0. Once
> 4.0rc2 is out, we can notify them so that they have time before 4.0 final is
> out. Also, sysadmins who only want to depend on packages provided by their
> distro won't install Bugzilla 4.0 themselves, and if they do, then this means
> that they are fine to also install Math:Random::Secure themselves. Again, not a
> reason to not make it mandatory. For Bugzilla 3.6.4 and older, I agree to make
> it optional.
I agree. We shouldn't be making MRS optional for 4.0. For the branches, that's fine, but \*nix packagers are already going to have to do work to get 4.0 packaged, so they can deal with adding a new package for MRS if needed.
> About Windows, and due to the fact that Win32::API doesn't work on Windows
> 64-bit, we unfortunately cannot make Math::Random::Secure mandatory (though
> it's now available on Windows 32-bit, see my previous comment). \*But\* there is
> IMO a better alternative than your hack (which gives us no guarantee of being
> cryptographically strong).
....
> As these randomly-generated GUIDs are available thanks to
> Win32::GuidGen(), which calls CoCreateGuid(), we can simply use them when
> generate\_random\_password() is called.
Note that Win32::GuidGen() still doesn't help the Win64 case, as it uses Win32::API to call CoCreateGuid(). However, it is probably a better alternative to MRS if MRS is not available on a Win32 machine (in the case of the branches).

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 160](/show_bug.cgi?id=619594#c160)â€¢ 14 years ago |
|  | |

(In reply to [comment #158](/show_bug.cgi?id=619594#c158 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> section 4.4. As these randomly-generated GUIDs are available thanks to
> Win32::GuidGen(), which calls CoCreateGuid(), we can simply use them when
> generate\_random\_password() is called.
Some more info:
Win32::GuidGen returns GUIDs of the form:
{AE74EF6C-0854-4DC9-8635-C3B6CD65B68E}
{ 4 y }
Only the 2 characters I marked above (4 and y) aren't random. All others are usable.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 161](/show_bug.cgi?id=619594#c161)â€¢ 14 years ago |
|  | |

(In reply to [comment #159](/show_bug.cgi?id=619594#c159 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Note that Win32::GuidGen() still doesn't help the Win64 case, as it uses
> Win32::API to call CoCreateGuid().
Win32 doesn't depend on Win32::API.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 162](/show_bug.cgi?id=619594#c162)â€¢ 14 years ago |
|  | |

(In reply to [comment #161](/show_bug.cgi?id=619594#c161 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Win32 doesn't depend on Win32::API.
... which also means that Crypt::Random::Source::Strong::Win32 could fallback to Win32::GuidGen to call CryptGenRandom when Win32::API is not available, making it work with Windows 64-bit too.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 163](/show_bug.cgi?id=619594#c163)â€¢ 14 years ago |
|  | |

Attached file
[Use Win32::GuidGen()](attachment.cgi?id=504237)
â€” [Details](attachment.cgi?id=504237&action=edit)

Here is a script which generates random passwords on Windows using Win32::GuidGen (no need for Win32::API). I wrote it in a way which makes it easy to integrate in the real generate\_random\_password() subroutine of Bugzilla::Util.
That's the code I would like to see being used for Windows. This also means that we no longer need to call srand() ourselves. On \*nix, I still don't think there is a need to call srand() every 5 characters, first because it's bad to call srand() several times, and 2nd because this would only be critical to generate the site wide secret. In all other cases, this is IMO useless. This reseeding should either be removed or only happen every 16 characters (which is the usual upper limit used for tokens, which do not need reseeding).
And as we are no longer affected by the Win32::API problem on Windows 64-bit, it makes even more sense to make Math::Random::Secure mandatory for Bugzilla 4.0.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 164](/show_bug.cgi?id=619594#c164)â€¢ 14 years ago |
|  | |

(In reply to [comment #157](/show_bug.cgi?id=619594#c157 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Maybe should
> Math::Random::Secure require this version as a minimum, to be sure to work with
> Perl 5.12 on Windows.
There wouldn't be any reason to update Math::Random::Secure. The test that failed had nothing to do with the functionality of Math::Random::ISAAC, it was just an author-only test that should not have been being run during installation.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 165](/show_bug.cgi?id=619594#c165)â€¢ 14 years ago |
|  | |

(In reply to [comment #158](/show_bug.cgi?id=619594#c158 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> OK, I definitely don't trust too much what is done here.
Have you actually tested it? Try gen-test.pl on Windows with this patch.
> My opinion for
> Bugzilla 4.0 is that we should require Math::Random::Secure on \*nix.
This seems unrelated to your comment above, since your comment above is about the Windows code.
> Linux
> packagers will add the missing dependencies when packaging Bugzilla 4.0. Once
> 4.0rc2 is out, we can notify them so that they have time before 4.0 final is
> out.
You're making assumptions about things that you can't actually know, such as the configuration of every Bugzilla server in existence.
> Also, sysadmins who only want to depend on packages provided by their
> distro won't install Bugzilla 4.0 themselves,
That's not true. Many organizations install Bugzilla from the tarball but require all other things to be from packages.
> For Bugzilla 3.6.4 and older, I agree to make it optional.
Why is it okay for one stable branch but not for another? I understand why it would make a difference on trunk--it has to do with the ongoing maintenance of that code \*forever\*.
> your hack (which gives us no guarantee of being cryptographically strong).
I have explained this many times now, including several times in this bug. If you don't understand my explanation, please tell me and I will clarify it. I'll say it again (without the explanation): there is absolutely no need for that code to be cryptographically strong--it only has to generate unique values every single time it is called, even if called in a tight loop. In my tests on Windows, it does. Does it do so in your tests? If it doesn't, then we definitely need to fix that.
> The version 4 GUIDs mentions in this document is described in RFC 4122 [3], see
> section 4.4. As these randomly-generated GUIDs are available thanks to
> Win32::GuidGen(), which calls CoCreateGuid(), we can simply use them when
> generate\_random\_password() is called.
If this works on 64-bit Perl, then I agree that this is a good idea.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 166](/show_bug.cgi?id=619594#c166)â€¢ 14 years ago |
|  | |

Comment on [attachment 504237](/attachment.cgi?id=504237 "Use Win32::GuidGen()") [[details]](/attachment.cgi?id=504237&action=edit "Use Win32::GuidGen()")
Use Win32::GuidGen()
Cool! :-)
> my $rand = sub {
> $data = \_get\_guids($size) unless $data;
> # Extract 8 hexadecimal characters (= 32 bits) and convert it
> # into a random number.
> return hex(substr($data, 0, 8, "")) / 2\*\*32 \* $\_[0];
Instead of this we should just be using 32 bits of a GUID for srand, which will make things simpler. Real security comes from Math::Random::Secure--I don't want to otherwise make statements about our security.
> my @guids = map { Win32::GuidGen() } (1..$calls);
So that means that all we'd have to do is call Win32::GuidGen, remove the hyphens and brackets, and use the first six characters as a 32-bit integer in hex. Can the first 8 characters span the entire width from 0 - 2^32?

|  | [:glob âœ±](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 167](/show_bug.cgi?id=619594#c167)â€¢ 14 years ago |
|  | |

> If this works on 64-bit Perl, then I agree that this is a good idea.
works with 64-bit activeperl

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 168](/show_bug.cgi?id=619594#c168)â€¢ 14 years ago |
|  | |

 Sweet! In that case I will soon post a new patch that uses GuidGen for Windows instead of that custom code.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 169](/show_bug.cgi?id=619594#c169)â€¢ 14 years ago |
|  | |

(In reply to [comment #166](/show_bug.cgi?id=619594#c166 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Instead of this we should just be using 32 bits of a GUID for srand, which
> will make things simpler. Real security comes from Math::Random::Secure--I
> don't want to otherwise make statements about our security.
We don't need to call srand() as CrytGenRandom() already returns cryptographically strong data. This code is precisely for when Math::Random::Secure is not available, else M::R::S already does the job for us.
(In reply to [comment #165](/show_bug.cgi?id=619594#c165 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> Have you actually tested it? Try gen-test.pl on Windows with this patch.
I don't need to try gen-test.pl. All it does is to tell you if generated passwords have dupes or not. This doesn't tell you how hard they are to guess, which is precisely what this bug is about.
> This seems unrelated to your comment above, since your comment above is about
> the Windows code.
Right, this comment about \*nix is independent on how things work on Windows. It's easy to make a module mandatory on \*nix only thanks to "if ON\_WINDOWS". That's what I meant. :)
> You're making assumptions about things that you can't actually know, such as
> the configuration of every Bugzilla server in existence.
Which assumptions am I making which is incorrect? That's it's harder to use Math::Random::Secure with 4.0 than with 4.2? That the lack of time is the critical point here? That the distros planning to ship Bugzilla 4.0 won't necessarily have the ability to provide missing or up-to-date dependencies? I admit I know nothing about the process to ship new packages in Linux distros. But what I also know is that Bugzilla 4.0 doesn't exist yet, so why is it suddenly a problem? If there are stable Linux distros or beta Linux distros which are past "feature freeze" and which already ship 4.0rc1, then I fully agree that this would be a problem for them in case they cannot ship missing dependencies or update them, because they would be blocked with 4.0rc1 "forever" in these releases. If that's the case, then I totally agree to make Math::Random::Secure optional for 4.0; but that's something which worth being checked first, IMO.
> Why is it okay for one stable branch but not for another?
Because we didn't release 4.0 yet. It's not yet what I call a stable branch. It's a branch being stabilized and finalized. For 3.6 and older, we already released minor releases on each branch, and we shouldn't suddenly require a new module.
> say it again (without the explanation): there is absolutely no need for that
> code to be cryptographically strong--it only has to generate unique values
> every single time it is called, even if called in a tight loop.
Correct me if I'm wrong, but "unique values" doesn't mean "unguessable". A good example is [comment 0](/show_bug.cgi?id=619594#c0 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"). You are saying that we should trust your code more than what is returned by CryptGenRandom, on Windows. That's what I have a problem with.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 170](/show_bug.cgi?id=619594#c170)â€¢ 14 years ago |
|  | |

(In reply to [comment #169](/show_bug.cgi?id=619594#c169 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account"))
> We don't need to call srand() as CrytGenRandom() already returns
> cryptographically strong data. This code is precisely for when
> Math::Random::Secure is not available, else M::R::S already does the job for
> us.
As I have learned while writing Math::Random::Secure, you do not want to be writing your own rand() implementation if you can help it. There are too many ways for it to go wrong. There are other good reasons to keep the code as consistent as possible across platforms, too (which I'm sure that you know, since we've seen the problems that can come from code that most of us don't interact with, since we're not using Windows).
I agree that GuidGen is a good way to get a small piece of random data, though. On Windows, all we need that for is to seed the random number generator.
> I don't need to try gen-test.pl. All it does is to tell you if generated
> passwords have dupes or not. This doesn't tell you how hard they are to guess,
> which is precisely what this bug is about.
This bug is about being able to guess a seed by brute force. In any case, I don't care about my \_do\_srand implementation, because you are right that using GuidGen is a better way to get a seed.
> Which assumptions am I making which is incorrect? That's it's harder to use
> Math::Random::Secure with 4.0 than with 4.2? That the lack of time is the
> critical point here? That the distros planning to ship Bugzilla 4.0 won't
> necessarily have the ability to provide missing or up-to-date dependencies?
More or less. But also that we've already released an RC, and people will have made plans. They have existing Bugzilla servers that they want to continue to use, and since this will be an important security update (to an RC in particular) they will want to update to it immediately if they are using the previous RC or earlier 3.7.x code. However, if they can't install M::R::S, they will be vulnerable because they will be totally unable to upgrade.
Also, 4.0 is a very important release and I don't want new barriers suddenly popping up to its adoption. This bug has been around for a few weeks now, so it's not new to us, but this M::R::S requirement will be new \*instantly\* upon the release of rc2, and I don't like to spring things like that on people if I can help it. And we can help it, in this case.
Also, if people \*do\* choose to install M::R::S, they can. Also, as far as we are aware, the code that \*isn't\* using M::R::S is actually still secure.
I do want to be clear here, though, that I think that using the Win32 GUID generator was a really clever idea and definitely better than my \_do\_srand implementation. I definitely want to use the GUID generator to generate a seed.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 171](/show_bug.cgi?id=619594#c171)â€¢ 14 years ago |
|  | |

For everybody's information, here is what the Perl team says:
"Our goal is to have a new randomness implementation in the core in 5.13.10 (currently due on February 20), for a stable production release as part of 5.14.0 this spring."
I'm talking with the implementor about how it's going to work.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 172](/show_bug.cgi?id=619594#c172)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.2, v4](attachment.cgi?id=504640&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=504640&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504640)

Okay, here's a patch for 3.2 that uses GuidGen to generate the seed. I've tested this on my local copy of XP-64 and it seems to work fine.
[Attachment #503836](/attachment.cgi?id=503836&action=edit "Patch for 3.2, v2") -
Attachment is obsolete: true
[Attachment #504640](/attachment.cgi?id=504640&action=edit "Patch for 3.2, v4") -
Flags: review?(LpSolit)
[Attachment #503836](/attachment.cgi?id=503836&action=edit "Patch for 3.2, v2") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 173](/show_bug.cgi?id=619594#c173)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.4, v4](attachment.cgi?id=504641&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=504641&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504641)

Updated patch for 3.4 that uses GuidGen.
[Attachment #503833](/attachment.cgi?id=503833&action=edit "Patch for 3.4, v3") -
Attachment is obsolete: true
[Attachment #504641](/attachment.cgi?id=504641&action=edit "Patch for 3.4, v4") -
Flags: review?(LpSolit)
[Attachment #503833](/attachment.cgi?id=503833&action=edit "Patch for 3.4, v3") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 174](/show_bug.cgi?id=619594#c174)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.6, v4](attachment.cgi?id=504642&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=504642&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504642)

[Attachment #503831](/attachment.cgi?id=503831&action=edit "Patch for 3.6, v3") -
Attachment is obsolete: true
[Attachment #504642](/attachment.cgi?id=504642&action=edit "Patch for 3.6, v4") -
Flags: review?(LpSolit)
[Attachment #503831](/attachment.cgi?id=503831&action=edit "Patch for 3.6, v3") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 175](/show_bug.cgi?id=619594#c175)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 4.0, v4](attachment.cgi?id=504643&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=504643&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504643)

[Attachment #504643](/attachment.cgi?id=504643&action=edit "Patch for 4.0, v4") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a2902777_120380)â€¢ 14 years ago |

[Attachment #503819](/attachment.cgi?id=503819&action=edit "Patch for 4.0, v2") -
Attachment is obsolete: true
[Attachment #503819](/attachment.cgi?id=503819&action=edit "Patch for 4.0, v2") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 176](/show_bug.cgi?id=619594#c176)â€¢ 14 years ago |
|  | |

Comment on [attachment 504643](/attachment.cgi?id=504643 "Patch for 4.0, v4") [[details]](/attachment.cgi?id=504643&action=edit "Patch for 4.0, v4") [[diff]](/attachment.cgi?id=504643&action=diff "Patch for 4.0, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504643)
Patch for 4.0, v4
r=LpSolit. Note that I didn't test your code with mod\_perl, though. Please do it (with and without Math::Random::Secure) just to make sure there is no problem with it.
[Attachment #504643](/attachment.cgi?id=504643&action=edit "Patch for 4.0, v4") -
Flags: review?(LpSolit) â†’ review+

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 177](/show_bug.cgi?id=619594#c177)â€¢ 14 years ago |
|  | |

Comment on [attachment 504642](/attachment.cgi?id=504642 "Patch for 3.6, v4") [[details]](/attachment.cgi?id=504642&action=edit "Patch for 3.6, v4") [[diff]](/attachment.cgi?id=504642&action=diff "Patch for 3.6, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504642)
Patch for 3.6, v4
r=LpSolit
[Attachment #504642](/attachment.cgi?id=504642&action=edit "Patch for 3.6, v4") -
Flags: review?(LpSolit) â†’ review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 178](/show_bug.cgi?id=619594#c178)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 4.0, v5](attachment.cgi?id=506019&action=diff)
â€” [Details](attachment.cgi?id=506019&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506019)

The branch patches have an error in mod\_perl.pl--semicolons are in the wrong places. This fixes it.
I've now tested this on mod\_perl and am sure that it works, both with MRS installed and with it not installed.
[Attachment #506019](/attachment.cgi?id=506019&action=edit "Patch for 4.0, v5") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a3191167_73187)â€¢ 14 years ago |

[Attachment #504643](/attachment.cgi?id=504643&action=edit "Patch for 4.0, v4") -
Attachment is obsolete: true

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 179](/show_bug.cgi?id=619594#c179)â€¢ 14 years ago |
|  | |

Comment on [attachment 506019](/attachment.cgi?id=506019 "Patch for 4.0, v5") [[details]](/attachment.cgi?id=506019&action=edit "Patch for 4.0, v5") [[diff]](/attachment.cgi?id=506019&action=diff "Patch for 4.0, v5") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506019)
Patch for 4.0, v5
LpSolit says I can carry forward r+ here.
[Attachment #506019](/attachment.cgi?id=506019&action=edit "Patch for 4.0, v5") -
Flags: review?(LpSolit) â†’ review+

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 180](/show_bug.cgi?id=619594#c180)â€¢ 14 years ago |
|  | |

Comment on [attachment 504641](/attachment.cgi?id=504641 "Patch for 3.4, v4") [[details]](/attachment.cgi?id=504641&action=edit "Patch for 3.4, v4") [[diff]](/attachment.cgi?id=504641&action=diff "Patch for 3.4, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=504641)
Patch for 3.4, v4
r=LpSolit
[Attachment #504641](/attachment.cgi?id=504641&action=edit "Patch for 3.4, v4") -
Flags: review?(LpSolit) â†’ review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 181](/show_bug.cgi?id=619594#c181)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.6, v5](attachment.cgi?id=506022&action=diff)
â€” [Details](attachment.cgi?id=506022&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506022)

Same mod\_perl fix for the 3.6 branch.
[Attachment #506022](/attachment.cgi?id=506022&action=edit "Patch for 3.6, v5") -
Flags: review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 182](/show_bug.cgi?id=619594#c182)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.4, v5](attachment.cgi?id=506023&action=diff)
â€” [Details](attachment.cgi?id=506023&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506023)

Fixes mod\_perl for 3.4
[Attachment #504641](/attachment.cgi?id=504641&action=edit "Patch for 3.4, v4") -
Attachment is obsolete: true
[Attachment #504642](/attachment.cgi?id=504642&action=edit "Patch for 3.6, v4") -
Attachment is obsolete: true
[Attachment #506023](/attachment.cgi?id=506023&action=edit "Patch for 3.4, v5") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a3191941_120380)â€¢ 14 years ago |

[Attachment #506023](/attachment.cgi?id=506023&action=edit "Patch for 3.4, v5") -
Flags: review?(LpSolit) â†’ review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 183](/show_bug.cgi?id=619594#c183)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.2, v5](attachment.cgi?id=506025&action=diff)
â€” [Details](attachment.cgi?id=506025&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506025)

Fixes mod\_perl for 3.2.
[Attachment #504640](/attachment.cgi?id=504640&action=edit "Patch for 3.2, v4") -
Attachment is obsolete: true
[Attachment #506025](/attachment.cgi?id=506025&action=edit "Patch for 3.2, v5") -
Flags: review?(LpSolit)
[Attachment #504640](/attachment.cgi?id=504640&action=edit "Patch for 3.2, v4") -
Flags: review?(LpSolit)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 184](/show_bug.cgi?id=619594#c184)â€¢ 14 years ago |
|  | |

Comment on [attachment 506025](/attachment.cgi?id=506025 "Patch for 3.2, v5") [[details]](/attachment.cgi?id=506025&action=edit "Patch for 3.2, v5") [[diff]](/attachment.cgi?id=506025&action=diff "Patch for 3.2, v5") [[review]](/page.cgi?id=splinter.html&ignore=&bug=619594&attachment=506025)
Patch for 3.2, v5
r=LpSolit
[Attachment #506025](/attachment.cgi?id=506025&action=edit "Patch for 3.2, v5") -
Flags: review?(LpSolit) â†’ review+

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a3194726_120380)â€¢ 14 years ago |

Flags: approval?Flags: approval4.0?Flags: approval3.6?Flags: approval3.4?Flags: approval3.2?

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a3419141_120380)â€¢ 14 years ago |

Flags: approval?Flags: approval4.0?Flags: approval4.0+Flags: approval3.6?Flags: approval3.6+Flags: approval3.4?Flags: approval3.4+Flags: approval3.2?Flags: approval3.2+Flags: approval+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 185](/show_bug.cgi?id=619594#c185)â€¢ 14 years ago |
|  | |

Committing to: bzr+ssh://bzr.mozilla.org/bugzilla/trunk/
modified mod\_perl.pl
modified Bugzilla/Util.pm
modified Bugzilla/Install/Localconfig.pm
modified Bugzilla/Install/Requirements.pm
Committed revision 7676.
Committing to: bzr+ssh://bzr.mozilla.org/bugzilla/4.0/
modified mod\_perl.pl
modified Bugzilla/Util.pm
modified Bugzilla/Install/Localconfig.pm
modified Bugzilla/Install/Requirements.pm
modified template/en/default/setup/strings.txt.pl
Committed revision 7533.
Committing to: bzr+ssh://bzr.mozilla.org/bugzilla/3.6/
modified mod\_perl.pl
modified Bugzilla/Util.pm
modified Bugzilla/Install/Localconfig.pm
modified Bugzilla/Install/Requirements.pm
modified template/en/default/setup/strings.txt.pl
Committed revision 7226.
Committing to: bzr+ssh://bzr.mozilla.org/bugzilla/3.4/
modified mod\_perl.pl
modified Bugzilla/Util.pm
modified Bugzilla/Install/Localconfig.pm
modified Bugzilla/Install/Requirements.pm
Committed revision 6793.
Committing to: bzr+ssh://mkanat%40bugzilla.org@bzr.mozilla.org/bugzilla/3.2/
modified mod\_perl.pl
modified Bugzilla/Util.pm
modified Bugzilla/Install/Localconfig.pm
modified Bugzilla/Install/Requirements.pm
Committed revision 6415.Status: ASSIGNED â†’ RESOLVEDClosed: 14 years agoResolution: --- â†’ FIXED

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a9044474_120380)â€¢ 14 years ago |

Blocks: [646578](/show_bug.cgi?id=646578 "RESOLVED FIXED - Math::Random::Secure's dependencies frequently do not install properly")

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 186](/show_bug.cgi?id=619594#c186)â€¢ 13 years ago |
|  | |

This bug has been fixed more than 6 months ago. Bugzilla 4.0 and 4.2 are not vulnerable to this issue, and Bugzilla 3.6 has been patched since version 3.6.4. We also released 3.6.5 and 3.6.6 meanwhile so admins had a plenty of time to upgrade or patch their installation.
The initial description of this bug contains all the details related to the vulnerability, and will probably be useful to many other Perl installations across the world. So I'm removing the security flag, making this bug public.
On behalf of the Bugzilla team, I would like to thank you again Willem for the quality of your bug report and analysis. It was definitely the best security bug report we have ever seen.Group: bugzilla-security

|  | [Raymond Forbes[:rforbes]](/user_profile?user_id=411311) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a91228032_411311)â€¢ 11 years ago |

Flags: sec-bounty+

|  | [Adam Muntner [:adamm] (use NEEDINFO)](/user_profile?user_id=436630) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a157752309_436630)â€¢ 9 years ago |

Keywords: [wsec-authorization](/buglist.cgi?keywords=wsec-authorization&resolution=---),
[wsec-crypto](/buglist.cgi?keywords=wsec-crypto&resolution=---),
[wsec-impersonation](/buglist.cgi?keywords=wsec-impersonation&resolution=---)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=619594#a424555424_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=619594&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Max Kanat-Alexander](/user_profile?user_id=73187)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_40585956_20250126_111355.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_a8484407_20250126_111356.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_5a170e9d_20250125_190036.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

## Attachment #506031: Patch for 3.6.3 for [bug #621591](/show_bug.cgi?id=621591)

[View](attachment.cgi?id=506031)
| [Details](attachment.cgi?id=506031&action=edit)
| [RawÂ Unified](attachment.cgi?id=506031&action=diff&context=patch&collapsed=&headers=1&format=raw)
| Return to [bug 621591](/show_bug.cgi?id=621591 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch")

Collapse All |
Expand All

|  |  |  |  |
| --- | --- | --- | --- |
| (-)Bugzilla/Install/Localconfig.pm (-2Â /Â +11Â lines) | | | |
| | Line | [LinkÂ Here](#Bugzilla/Install/Localconfig.pm_sec1) | | --- | --- | | | | |
| | LinesÂ 205-211 | [LinkÂ Here](#Bugzilla/Install/Localconfig.pm_sec2) | | --- | --- | | | | |
| 205 | ```     }, ``` | 205 | ```     }, ``` |
| 206 | ```     { ``` | 206 | ```     { ``` |
| 207 | ```         name    => 'site_wide_secret', ``` | 207 | ```         name    => 'site_wide_secret', ``` |
| 208 | ```         default => sub { generate_random_password(256) }, ``` | 208 | ```         # 64 characters is roughly the equivalent of a 384-bit key, which ``` |
|  |  | 209 | ```         # is larger than anybody would ever be able to brute-force. ``` |
| 210 | ```         default => sub { generate_random_password(64) }, ``` |
| 209 | ```         desc    => <<EOT ``` | 211 | ```         desc    => <<EOT ``` |
| 210 | ``` # This secret key is used by your installation for the creation and ``` | 212 | ``` # This secret key is used by your installation for the creation and ``` |
| 211 | ``` # validation of encrypted tokens to prevent unsolicited changes, ``` | 213 | ``` # validation of encrypted tokens to prevent unsolicited changes, ``` |
| | LinesÂ 323-329 | [LinkÂ Here](#Bugzilla/Install/Localconfig.pm_sec3) | | --- | --- | | | | |
| 323 | ```     my @new_vars; ``` | 325 | ```     my @new_vars; ``` |
| 324 | ```     foreach my $var (LOCALCONFIG_VARS) { ``` | 326 | ```     foreach my $var (LOCALCONFIG_VARS) { ``` |
| 325 | ```         my $name = $var->{name}; ``` | 327 | ```         my $name = $var->{name}; ``` |
| 326 | ```         if (!defined $localconfig->{$name}) { ``` | 328 | ```         my $value = $localconfig->{$name}; ``` |
|  |  | 329 | ```         # Regenerate site_wide_secret if it was made by our old, weak ``` |
| 330 | ```         # generate_random_password. Previously we used to generate ``` |
| 331 | ```         # a 256-character string for site_wide_secret. ``` |
| 332 | ```         $value = undef if ($name eq 'site_wide_secret' and defined $value ``` |
| 333 | ```                            and length($value) == 256); ``` |
| 334 | ```          ``` |
| 335 | ```         if (!defined $value) { ``` |
| 327 | ```             push(@new_vars, $name); ``` | 336 | ```             push(@new_vars, $name); ``` |
| 328 | ```             $var->{default} = &{$var->{default}} if ref($var->{default}) eq 'CODE'; ``` | 337 | ```             $var->{default} = &{$var->{default}} if ref($var->{default}) eq 'CODE'; ``` |
| 329 | ```             if (exists $answer->{$name}) { ``` | 338 | ```             if (exists $answer->{$name}) { ``` |

|  |  |  |  |
| --- | --- | --- | --- |
| (-)Bugzilla/Install/Requirements.pm (+6Â lines) | | | |
| | Line | [LinkÂ Here](#Bugzilla/Install/Requirements.pm_sec1) | | --- | --- | | | | |
| | LinesÂ 288-293 | [LinkÂ Here](#Bugzilla/Install/Requirements.pm_sec2) | | --- | --- | | | | |
| 288 | ```         version => '1.999022', ``` | 288 | ```         version => '1.999022', ``` |
| 289 | ```         feature => ['mod_perl'], ``` | 289 | ```         feature => ['mod_perl'], ``` |
| 290 | ```     }, ``` | 290 | ```     }, ``` |
|  |  | 291 | ```     { ``` |
| 292 | ```         package => 'Math-Random-Secure', ``` |
| 293 | ```         module  => 'Math::Random::Secure', ``` |
| 294 | ```         version => '0.05', ``` |
| 295 | ```         feature => ['rand_security'], ``` |
| 296 | ```     }, ``` |
| 291 | ```     ); ``` | 297 | ```     ); ``` |
| 292 |  | 298 |  |
| 293 | ```     my $extra_modules = _get_extension_requirements('OPTIONAL_MODULES'); ``` | 299 | ```     my $extra_modules = _get_extension_requirements('OPTIONAL_MODULES'); ``` |

|  |  |  |  |
| --- | --- | --- | --- |
| (-)Bugzilla/Util.pm (-1Â /Â +48Â lines) | | | |
| | Line | [LinkÂ Here](#Bugzilla/Util.pm_sec1) | | --- | --- | | | | |
| | LinesÂ 551-559 | [LinkÂ Here](#Bugzilla/Util.pm_sec2) | | --- | --- | | | | |
| 551 | ```     return $crypted_password; ``` | 551 | ```     return $crypted_password; ``` |
| 552 | ``` } ``` | 552 | ``` } ``` |
| 553 |  | 553 |  |
|  |  | 554 | ``` # If you want to understand the security of strings generated by this ``` |
| 555 | ``` # function, here's a quick formula that will help you estimate: ``` |
| 556 | ``` # We pick from 62 characters, which is close to 64, which is 2^6. ``` |
| 557 | ``` # So 8 characters is (2^6)^8 == 2^48 combinations. Just multiply 6 ``` |
| 558 | ``` # by the number of characters you generate, and that gets you the equivalent ``` |
| 559 | ``` # strength of the string in bits. ``` |
| 554 | ``` sub generate_random_password { ``` | 560 | ``` sub generate_random_password { ``` |
| 555 | ```     my $size = shift || 10; # default to 10 chars if nothing specified ``` | 561 | ```     my $size = shift || 10; # default to 10 chars if nothing specified ``` |
| 556 | ```     return join("", map{ ('0'..'9','a'..'z','A'..'Z')[rand 62] } (1..$size)); ``` | 562 | ```     my $rand; ``` |
|  |  | 563 | ```     if (Bugzilla->feature('rand_security')) { ``` |
| 564 | ```         $rand = \&Math::Random::Secure::irand; ``` |
| 565 | ```     } ``` |
| 566 | ```     else { ``` |
| 567 | ```         # For details on why this block works the way it does, see bug 619594. ``` |
| 568 | ```         # (Note that we don't do this if Math::Random::Secure is installed, ``` |
| 569 | ```         # because we don't need to.) ``` |
| 570 | ```         my $counter = 0; ``` |
| 571 | ```         $rand = sub { ``` |
| 572 | ```             # If we regenerate the seed every 5 characters, our seed is roughly ``` |
| 573 | ```             # as strong (in terms of bit size) as our randomly-generated ``` |
| 574 | ```             # string itself. ``` |
| 575 | ```             _do_srand() if ($counter % 5) == 0; ``` |
| 576 | ```             $counter++; ``` |
| 577 | ```             return int(rand $_[0]); ``` |
| 578 | ```         }; ``` |
| 579 | ```     } ``` |
| 580 | ```     return join("", map{ ('0'..'9','a'..'z','A'..'Z')[$rand->(62)] }  ``` |
| 581 | ```                        (1..$size)); ``` |
| 582 | ``` } ``` |
| 583 |  |
| 584 | ``` sub _do_srand { ``` |
| 585 | ```     # On Windows, calling srand over and over in the same process produces ``` |
| 586 | ```     # very bad results. We need a stronger seed. ``` |
| 587 | ```     if (ON_WINDOWS) { ``` |
| 588 | ```         require Win32; ``` |
| 589 | ```         # GuidGen generates random data via Windows's CryptGenRandom ``` |
| 590 | ```         # interface, which is documented as being cryptographically secure. ``` |
| 591 | ```         my $guid = Win32::GuidGen(); ``` |
| 592 | ```         # GUIDs look like: ``` |
| 593 | ```         # {09531CF1-D0C7-4860-840C-1C8C8735E2AD} ``` |
| 594 | ```         $guid =~ s/[-{}]+//g; ``` |
| 595 | ```         # Get a 32-bit integer using the first eight hex digits. ``` |
| 596 | ```         my $seed = hex(substr($guid, 0, 8)); ``` |
| 597 | ```         srand($seed); ``` |
| 598 | ```         return; ``` |
| 599 | ```     } ``` |
| 600 |  |
| 601 | ```     # On *nix-like platforms, this uses /dev/urandom, so the seed changes ``` |
| 602 | ```     # enough on every invocation. ``` |
| 603 | ```     srand(); ``` |
| 557 | ``` } ``` | 604 | ``` } ``` |
| 558 |  | 605 |  |
| 559 | ``` sub validate_email_syntax { ``` | 606 | ``` sub validate_email_syntax { ``` |

|  |  |  |  |
| --- | --- | --- | --- |
| (-)mod\_perl.pl (-2Â /Â +11Â lines) | | | |
| | Line | [LinkÂ Here](#mod_perl.pl_sec1) | | --- | --- | | | | |
| | LinesÂ 46-51 | [LinkÂ Here](#mod_perl.pl_sec2) | | --- | --- | | | | |
| 46 | ``` use Bugzilla::Template (); ``` | 46 | ``` use Bugzilla::Template (); ``` |
| 47 | ``` use Bugzilla::Util (); ``` | 47 | ``` use Bugzilla::Util (); ``` |
| 48 |  | 48 |  |
|  |  | 49 | ``` # For PerlChildInitHandler ``` |
| 50 | ``` eval { require Math::Random::Secure }; ``` |
| 51 |  |
| 49 | ``` my ($sizelimit, $maxrequests) = ('', ''); ``` | 52 | ``` my ($sizelimit, $maxrequests) = ('', ''); ``` |
| 50 | ``` if (Bugzilla::Constants::ON_WINDOWS) { ``` | 53 | ``` if (Bugzilla::Constants::ON_WINDOWS) { ``` |
| 51 | ```     $maxrequests = "MaxRequestsPerChild 25"; ``` | 54 | ```     $maxrequests = "MaxRequestsPerChild 25"; ``` |
| | LinesÂ 64-71 | [LinkÂ Here](#mod_perl.pl_sec3) | | --- | --- | | | | |
| 64 | ``` my $server = Apache2::ServerUtil->server; ``` | 67 | ``` my $server = Apache2::ServerUtil->server; ``` |
| 65 | ``` my $conf = <<EOT; ``` | 68 | ``` my $conf = <<EOT; ``` |
| 66 | ``` $maxrequests ``` | 69 | ``` $maxrequests ``` |
| 67 | ``` # Make sure each httpd child receives a different random seed (bug 476622) ``` | 70 | ``` # Make sure each httpd child receives a different random seed (bug 476622). ``` |
| 68 | ``` PerlChildInitHandler "sub { srand(); }" ``` | 71 | ``` # Math::Random::Secure has one srand that needs to be called for ``` |
|  |  | 72 | ``` # every process, and Perl has another. (Various Perl modules still use ``` |
| 73 | ``` # the built-in rand(), even though we only use Math::Random::Secure in ``` |
| 74 | ``` # Bugzilla itself, so we need to srand() both of them.) However,  ``` |
| 75 | ``` # Math::Random::Secure may not be installed, so we call its srand in an ``` |
| 76 | ``` # eval. ``` |
| 77 | ``` PerlChildInitHandler "sub { eval { Math::Random::Secure::srand() }; srand(); }" ``` |
| 69 | ``` <Directory "$cgi_path"> ``` | 78 | ``` <Directory "$cgi_path"> ``` |
| 70 | ```     AddHandler perl-script .cgi ``` | 79 | ```     AddHandler perl-script .cgi ``` |
| 71 | ```     # No need to PerlModule these because they're already defined in mod_perl.pl ``` | 80 | ```     # No need to PerlModule these because they're already defined in mod_perl.pl ``` |

|  |  |  |  |
| --- | --- | --- | --- |
| (-)template/en/default/setup/strings.txt.pl (+1Â lines) | | | |
| | Line | [LinkÂ Here](#template/en/default/setup/strings.txt.pl_sec1) | | --- | --- | | | | |
| | LinesÂ 62-67 | [LinkÂ Here](#template/en/default/setup/strings.txt.pl_sec2) | | --- | --- | | | | |
| 62 | ```     feature_mod_perl          => 'mod_perl', ``` | 62 | ```     feature_mod_perl          => 'mod_perl', ``` |
| 63 | ```     feature_moving            => 'Move Bugs Between Installations', ``` | 63 | ```     feature_moving            => 'Move Bugs Between Installations', ``` |
| 64 | ```     feature_patch_viewer      => 'Patch Viewer', ``` | 64 | ```     feature_patch_viewer      => 'Patch Viewer', ``` |
|  |  | 65 | ```     feature_rand_security     => 'Improve cookie and token security', ``` |
| 65 | ```     feature_smtp_auth         => 'SMTP Authentication', ``` | 66 | ```     feature_smtp_auth         => 'SMTP Authentication', ``` |
| 66 | ```     feature_updates           => 'Automatic Update Notifications', ``` | 67 | ```     feature_updates           => 'Automatic Update Notifications', ``` |
| 67 | ```     feature_xmlrpc            => 'XML-RPC Interface', ``` | 68 | ```     feature_xmlrpc            => 'XML-RPC Interface', ``` |

Return to [bug 621591](/show_bug.cgi?id=621591 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch")



=== Content from bugzilla.mozilla.org_e5a77b07_20250126_111402.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/621591)
* [XML](/show_bug.cgi?ctype=xml&id=621591)

Closed
[Bug 621591](/show_bug.cgi?id=621591)

Opened 14 years ago
Closed 14 years ago

# Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch

## Categories

### (Bugzilla :: User Accounts, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
â–¾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=User%20Accounts#User%20Accounts)

User Accounts
â–¾

Bugzilla :: User Accounts
Anything about managing a user account from the user's perspective. `userprefs.cgi`, saved queries, creating accounts, changing passwords, logging in, etc.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=User%20Accounts)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.14

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 3.2

## People

### (Reporter: mkanat, Assigned: mkanat)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8d3dd762c1c841898a384ebc42abec97?d=mm&size=40)  [mkanat](/user_profile?user_id=73187)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8d3dd762c1c841898a384ebc42abec97?d=mm&size=40)  [mkanat](/user_profile?user_id=73187)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

40 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2010-4568](/show_bug.cgi?id=619594 "RESOLVED FIXED - [SECURITY] Tokens generated from weak source of randomness, allowing an attacker to guess a password change token and change the password of any account")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=621591&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=621591)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | approval | ? |
| --- | --- | --- |
|  | approval5.0 | ? |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 2 obsolete files)

| [Preliminary Patch](/attachment.cgi?id=499905)  [14 years ago](#c0)  [Max Kanat-Alexander](/user_profile?user_id=73187)   356 bytes, patch |  | [Details](/attachment.cgi?id=499905&action=edit) | [Diff](/attachment.cgi?id=499905&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=499905) |
| --- | --- | --- |
| [Patch for 4.1 (bad)](/attachment.cgi?id=506026)  [14 years ago](#c36)  [Max Kanat-Alexander](/user_profile?user_id=73187)   3.82 KB, patch | mkanat : [review+](#c36 "14 years ago") | [Details](/attachment.cgi?id=506026&action=edit) | [Diff](/attachment.cgi?id=506026&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506026) |
| [Patch for 3.7.x & 4.0](/attachment.cgi?id=506030)  [14 years ago](#c37)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.05 KB, patch | mkanat : [review+](#c37 "14 years ago") | [Details](/attachment.cgi?id=506030&action=edit) | [Diff](/attachment.cgi?id=506030&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506030) |
| [Patch for 3.6.3](/attachment.cgi?id=506031)  [14 years ago](#c38)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.12 KB, patch | mkanat : [review+](#c38 "14 years ago") | [Details](/attachment.cgi?id=506031&action=edit) | [Diff](/attachment.cgi?id=506031&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506031) |
| [Patch for 3.4.9](/attachment.cgi?id=506033)  [14 years ago](#c40)  [Max Kanat-Alexander](/user_profile?user_id=73187)   5.63 KB, patch | mkanat : [review+](#c40 "14 years ago") | [Details](/attachment.cgi?id=506033&action=edit) | [Diff](/attachment.cgi?id=506033&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506033) |
| [Patch for 3.2.9](/attachment.cgi?id=506034)  [14 years ago](#c41)  [Max Kanat-Alexander](/user_profile?user_id=73187)   6.27 KB, patch | mkanat : [review+](#c41 "14 years ago") | [Details](/attachment.cgi?id=506034&action=edit) | [Diff](/attachment.cgi?id=506034&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506034) |
| [Patch for 4.1](/attachment.cgi?id=506047)  [14 years ago](#c42)  [Max Kanat-Alexander](/user_profile?user_id=73187)   3.89 KB, patch | mkanat : [review+](#c42 "14 years ago") | [Details](/attachment.cgi?id=506047&action=edit) | [Diff](/attachment.cgi?id=506047&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506047) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=621591#c0)â€¢ 14 years ago |
|  | |

Attached patch

[Preliminary Patch](attachment.cgi?id=499905&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=499905&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=499905)

Dear Bugzilla Admins,
A critical security issue has been discovered in Bugzilla, and we are offering you an early-access patch so that you can patch your Bugzilla before we publicly disclose the issue. This issue affects Bugzilla versions 2.14 and higher. The impact of the issue is that a user could gain unauthorized access to any Bugzilla account in a very short amount of time (short enough that the attack is highly effective).
The patch currently attached to this bug is only a preliminary patch--the final patch released with the security advisory will be much more extensive. You will have to revert this patch before upgrading to the security release.
We are aware that, under normal circumstances, what this patch looks to be doing is a bad idea--one should not normally call srand() more than once per process. However, we assure you that for now, it will protect your Bugzilla from this security issue being exploited until a more extensive fix can be provided.
There is one slight exception--if you have Bugzilla installed on Windows, then this patch will not resolve the issue, and you will have to wait for the final security advisory and complete patch.
Please avoid exposing the existence of this issue or this patch until we have a final patch and a public security advisory. (In other words, don't check this patch into any publicly-available version-control repository, don't advertise its contents, etc.)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=621591#c1)â€¢ 14 years ago |
|  | |

dkl: Could you CC the appropriate people for Red Hat?
ghendricks: Could you CC the appropriate people for Novell?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=621591#c2)â€¢ 14 years ago |
|  | |

If each of you could let us know when your Bugzilla is patched, that would help us know when we can publicly release our final security fix.

|  | [w@apple.com](/user_profile?user_id=356839) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=621591#c3)â€¢ 14 years ago |
|  | |

WebKit Bugzilla is patched.

|  | [Robin H. Johnson [:robbat2]](/user_profile?user_id=185972) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=621591#c4)â€¢ 14 years ago |
|  | |

Gentoo Bugzilla is patched (production only, not bugs3 test instance, to avoid disclosure).

|  | [David Marshall](/user_profile?user_id=287170) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=621591#c5)â€¢ 14 years ago |
|  | |

Yahoo! isn't affected by this vulnerability, but thanks for the heads up.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=621591#c6)â€¢ 14 years ago |
|  | |

Mozilla got patched 3 or 4 days ago.
I suspect Novell is unaffected because they use external auth (it's tied into their support system's single-signon).

|  | [J.H.](/user_profile?user_id=232708) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=621591#c7)â€¢ 14 years ago |
|  | |

This has been applied to kernel.org - we should be good for now.

|  | [Vincent Danen](/user_profile?user_id=277899) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=621591#c8)â€¢ 14 years ago |
|  | |

I'm trying to find out who to pass this on to at Red Hat in case David isn't able to do that right away (or doesn't know). I also do not believe that Gustavo works at Mandriva anymore, so I don't think his email is valid either (I'm trying to find an appropriate contact there as well).

|  | [Vincent Danen](/user_profile?user_id=277899) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=621591#c9)â€¢ 14 years ago |
|  | |

Ignore the Red Hat bit, I just noticed Kevin was cc'd. Thanks, David.

|  | [Brion Vibber](/user_profile?user_id=137337) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=621591#c10)â€¢ 14 years ago |
|  | |

I've forwarded this on internally to current Wikimedia sysadmins, will add when confirmed patched.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=621591#c11)â€¢ 14 years ago |
|  | |

As it goes back as far as 2.14, can we contact the IssueZilla people at OpenOffice.org? Also, I don't see a Facebook person on the list...
Gerv

|  | [Luca Gibelli](/user_profile?user_id=357550) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=621591#c12)â€¢ 14 years ago |
|  | |

bugs.clamav.net patched. Thanks.

|  | [Kevin Baker](/user_profile?user_id=298392) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=621591#c13)â€¢ 14 years ago |
|  | |

(In reply to [comment #9](/show_bug.cgi?id=621591#c9 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> Ignore the Red Hat bit, I just noticed Kevin was cc'd. Thanks, David.
Simon Green will patch this. He's in Australia so it may take us another 12 hours.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=621591#c14)â€¢ 14 years ago |
|  | |

(In reply to [comment #8](/show_bug.cgi?id=621591#c8 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> I also do not believe that Gustavo works at Mandriva anymore
Indeed, but Oden is our contact person at Mandriva. :)

|  | [Andre Klapper](/user_profile?user_id=217879) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=621591#c15)â€¢ 14 years ago |
|  | |

bugs.maemo.org has been patched. Thanks!

|  | [Oden Eriksson](/user_profile?user_id=356332) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=621591#c16)â€¢ 14 years ago |
|  | |

qa.mandriva.com has been patched. Thanks!

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=621591#c17)â€¢ 14 years ago |
|  | |

Frank, do you want to patch GCC's Bugzilla or should I?

|  | [Zach Lipton [:zach]](/user_profile?user_id=15368) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=621591#c18)â€¢ 14 years ago |
|  | |

Other potential installations of note:
<https://software.sandia.gov/bugzilla/>
<http://bugs.developers.facebook.net/> - I can try to track down who runs it
<http://bugzilla.songbirdnest.com/>
<http://bugs.winehq.org/> - Max, looks like you've worked with them

|  | [Brion Vibber](/user_profile?user_id=137337) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=621591#c19)â€¢ 14 years ago |
|  | |

bugzilla.wikimedia.org patched.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=621591#c20)â€¢ 14 years ago |
|  | |

GCC and Sourceware Bugzilla both patched!

|  | [Denis Roy](/user_profile?user_id=128581) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=621591#c21)â€¢ 14 years ago |
|  | |

Eclipse Bugzilla patched. Thanks!

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=621591#c22)â€¢ 14 years ago |
|  | |

bugzilla.novell.com is now patched. Thanks!

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=621591#c23)â€¢ 14 years ago |
|  | |

(In reply to [comment #6](/show_bug.cgi?id=621591#c6 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> I suspect Novell is unaffected because they use external auth (it's tied into
> their support system's single-signon).
I suspect you're right, but I patched it anyway.

|  | [Kevin J. Woolley](/user_profile?user_id=402838) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=621591#c24)â€¢ 14 years ago |
|  | |

We use our own SSO for Bugzilla authentication but I have patched anyways, so we should be good. Thanks for the heads-up!

|  | [Matt Rogers](/user_profile?user_id=334952) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=621591#c25)â€¢ 14 years ago |
|  | |

bugs.kde.org has been patched. Thanks!

|  | [Paul Querna](/user_profile?user_id=177966) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=621591#c26)â€¢ 14 years ago |
|  | |

issues.apache.org has been patched, thank you

|  | [Andre Klapper](/user_profile?user_id=217879) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=621591#c27)â€¢ 14 years ago |
|  | |

[Adding the MeeGo Bugzilla maintainers to CC list.]

|  | [Olav Vitters](/user_profile?user_id=26173) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=621591#c28)â€¢ 14 years ago |
|  | |

bugzilla.gnome.org has been patched. Thanks!

|  | [Simon Green](/user_profile?user_id=124400) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=621591#c29)â€¢ 14 years ago |
|  | |

bugzilla.redhat.com has been patched.

|  | [Eric Le Roux](/user_profile?user_id=402822) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=621591#c31)â€¢ 14 years ago |
|  | |

bugs.meego.com has been patched. Thank you!

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=621591#c32)â€¢ 14 years ago |
|  | |

Adding Daniel for freedesktop.org. Daniel, let us know when f.d.o is patched.

|  | [Daniel Stone](/user_profile?user_id=254009) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=621591#c33)â€¢ 14 years ago |
|  | |

I've patched bugs.fd.o now - thanks!

|  | [Jim Walters](/user_profile?user_id=102677) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=621591#c34)â€¢ 14 years ago |
|  | |

Bugopolis has upgrade all managed servers.
What is the patch for version 2.16.7+? Thanks (Couldn't find the patch line in Util.pm)

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=621591#c35)â€¢ 14 years ago |
|  | |

(In reply to [comment #34](/show_bug.cgi?id=621591#c34 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> What is the patch for version 2.16.7+? Thanks (Couldn't find the patch line in
> Util.pm)
There is no patch for 2.16.7. This branch is unsupported since April 2006. But if you want to hack the code manually yourself, look at GenerateRandomPassword() in globals.pl, line 725.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=621591#a2170089_73187)â€¢ 14 years ago |

Version: unspecified â†’ 2.14

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=621591#c36)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 4.1 (bad)](attachment.cgi?id=506026&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=506026&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506026)

Here is the final patch for trunk (4.1). If you have already applied the preliminary patch, please revert it before applying this patch.
We plan to release this publicly in a security advisory on Monday. Until such time, please keep this equally as confidential as the original preliminary patch.
[Attachment #499905](/attachment.cgi?id=499905&action=edit "Preliminary Patch") -
Attachment is obsolete: true
[Attachment #506026](/attachment.cgi?id=506026&action=edit "Patch for 4.1 (bad)") -
Flags: review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=621591#c37)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.7.x & 4.0](attachment.cgi?id=506030&action=diff)
â€” [Details](attachment.cgi?id=506030&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506030)

This is the patch for the 3.7.x series and for 4.0rc1.
[Attachment #506030](/attachment.cgi?id=506030&action=edit "Patch for 3.7.x & 4.0") -
Flags: review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=621591#c38)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.6.3](attachment.cgi?id=506031&action=diff)
â€” [Details](attachment.cgi?id=506031&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506031)

[Attachment #506031](/attachment.cgi?id=506031&action=edit "Patch for 3.6.3") -
Flags: review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=621591#c39)â€¢ 14 years ago |
|  | |

Comment on [attachment 506026](/attachment.cgi?id=506026 "Patch for 4.1 (bad)") [[details]](/attachment.cgi?id=506026&action=edit "Patch for 4.1 (bad)") [[diff]](/attachment.cgi?id=506026&action=diff "Patch for 4.1 (bad)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506026)
Patch for 4.1 (bad)
There's a tiny error in this patch, a new patch is forthcoming. Only this patch is affected, the other patches I've already posted are fine.
[Attachment #506026](/attachment.cgi?id=506026&action=edit "Patch for 4.1 (bad)") -
Attachment description: Patch for 4.1 â†’ Patch for 4.1 (bad)
[Attachment #506026](/attachment.cgi?id=506026&action=edit "Patch for 4.1 (bad)") -
Attachment is obsolete: true

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=621591#c40)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.4.9](attachment.cgi?id=506033&action=diff)
â€” [Details](attachment.cgi?id=506033&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506033)

This patch should apply to any 3.4.x version, although it was written against 3.4.9 specifically.
[Attachment #506033](/attachment.cgi?id=506033&action=edit "Patch for 3.4.9") -
Flags: review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=621591#c41)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 3.2.9](attachment.cgi?id=506034&action=diff)
â€” [Details](attachment.cgi?id=506034&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506034)

This patch should apply to any 3.2.x, but was only tested on 3.2.9. It may also apply to 3.0.x, but we haven't tested it there.
[Attachment #506034](/attachment.cgi?id=506034&action=edit "Patch for 3.2.9") -
Flags: review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=621591#c42)â€¢ 14 years ago |
|  | |

Attached patch

[Patch for 4.1](attachment.cgi?id=506047&action=diff)
â€” [Details](attachment.cgi?id=506047&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506047)

Here is the correct patch for the 4.0 branch.
[Attachment #506047](/attachment.cgi?id=506047&action=edit "Patch for 4.1") -
Flags: review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=621591#c43)â€¢ 14 years ago |
|  | |

Note that if you have merely applied the preliminary patch, you are not fully secured, although you have protected yourself against the most immediately critical exploits of this issue.
Ultimately, though, only applying the final patch will protect you against all exploits of this issue, and we strongly recommend that all Bugzilla administrators apply these final patches as soon as possible.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=621591#c44)â€¢ 14 years ago |
|  | |

Comment on [attachment 506047](/attachment.cgi?id=506047 "Patch for 4.1") [[details]](/attachment.cgi?id=506047&action=edit "Patch for 4.1") [[diff]](/attachment.cgi?id=506047&action=diff "Patch for 4.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=621591&attachment=506047)
Patch for 4.1
This patch is \*not\* for the 4.0 branch. That's the one for 4.1 only. Make sure you applied the correct one.
[Attachment #506047](/attachment.cgi?id=506047&action=edit "Patch for 4.1") -
Attachment description: Patch for 3.7.x and 4.0rc1 â†’ Patch for 4.1

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=621591#c45)â€¢ 14 years ago |
|  | |

I see that Math::Random::Secure is in the optional section. What are the implications of not installing it?
Reason I ask: Crypt::Random::Source::Factory does not install for me on SUSE Linux Enterprise Server 10 SP2 (unless I force it).

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=621591#c46)â€¢ 14 years ago |
|  | |

I should have mentioned: our Bugzilla version is 3.4.3. I applied mrs-34.diff.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=621591#c47)â€¢ 14 years ago |
|  | |

(In reply to [comment #45](/show_bug.cgi?id=621591#c45 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> Reason I ask: Crypt::Random::Source::Factory does not install for me on SUSE
> Linux Enterprise Server 10 SP2 (unless I force it).
Which error do you get? Maybe should it be reported to CPAN.

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=621591#c48)â€¢ 14 years ago |
|  | |

(In reply to [comment #47](/show_bug.cgi?id=621591#c47 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> (In reply to [comment #45](/show_bug.cgi?id=621591#c45 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> > Reason I ask: Crypt::Random::Source::Factory does not install for me on SUSE
> > Linux Enterprise Server 10 SP2 (unless I force it).
>
> Which error do you get? Maybe should it be reported to CPAN.
Running make test
PERL\_DL\_NONLAZY=1 /usr/bin/perl "-MExtUtils::Command::MM" "-e" "test\_harness(0, 'blib/lib', 'blib/arch')" t/\*.t
t/blocking..............ok
t/dev\_random............ok
t/factory...............ok
t/proc..................Can't call method "read" on an undefined value at /root/.cpan/build/Crypt-Random-Source-0.07/blib/lib/Crypt/Random/Source/Base/Handle.pm line 38.

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=621591#c49)â€¢ 14 years ago |
|  | |

Crypt::Random::Source::Factory installs fine on openSUSE 11.2, so it might be a flaw in the older SUSE Linux Enterprise Server 10 SP2
I guess I'm concerned that CPAN won't be able to fix this before this bugzilla security disclosure goes live on Monday.

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=621591#c50)â€¢ 14 years ago |
|  | |

I see that generate\_random\_password() has an alternate algorithm if Math::Random::Secure is not installed, so it looks as if we're OK.

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=621591#c51)â€¢ 14 years ago |
|  | |

What time is the announcement? I need to coordinate this deployment with the Novell Change Control Board.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=621591#c52)â€¢ 14 years ago |
|  | |

(In reply to [comment #51](/show_bug.cgi?id=621591#c51 "RESOLVED FIXED - Critical Security Issue In Bugzilla Since 2.14: Early-Access Patch"))
> What time is the announcement? I need to coordinate this deployment with the
> Novell Change Control Board.
It's hard to say--it depends on when we finish the release work.

|  | [Simon Green](/user_profile?user_id=124400) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=621591#c53)â€¢ 14 years ago |
|  | |

Redhat bugzilla has final 3.6.3 patch applied.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=621591#c54)â€¢ 14 years ago |
|  | |

All of these patches have been checked in. You can consider this issue to be basically public as of now, although the security advisory won't go out for a few hours.Status: NEW â†’ RESOLVEDClosed: 14 years agoResolution: --- â†’ FIXED

|  | [Vance Baarda](/user_profile?user_id=174426) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=621591#c55)â€¢ 14 years ago |
|  | |

bugzilla.novell.com is now patched.

|  | [FrÃ©dÃ©ric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=621591#c56)â€¢ 14 years ago |
|  | |

Security advisory sent. Removing the security flag.Group: bugzilla-security
You need to [log in](/show_bug.cgi?id=621591&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Max Kanat-Alexander](/user_profile?user_id=73187)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250126_111356.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from secunia.com_2a3fe648_20250125_190013.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from secunia.com_a6923337_20250125_190008.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from www.bugzilla.org_7645e3f5_20250125_190021.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 3.2.9, 3.4.9, 3.6.3, and and 4.0rc1 Security Advisory

# 3.2.9, 3.4.9, 3.6.3, and and 4.0rc1 Security Advisory

Monday, Jan 24th, 2011
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* A weakness in Bugzilla could allow a user to gain unauthorized access
  to another Bugzilla account.

* A weakness in the Perl CGI.pm module allows injecting HTTP headers
  and content to users via several pages in Bugzilla.

* The new user autocomplete functionality in Bugzilla 4.0 is vulnerable
  to a cross-site scripting attack.

* The new automatic duplicate detection functionality in Bugzilla 4.0
  is vulnerable to a cross-site scripting attack.

* If you put a harmful "javascript:" or "data:" URL into Bugzilla's
  "URL" field, then there are multiple situations in which Bugzilla
  will unintentionally make that link clickable.

* Various pages lack protection against cross-site request forgeries.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Account Compromise
Affected:    2.14 to 3.2.9, 3.4.9, 3.6.3, 4.0rc1
Fixed In:    3.2.10, 3.4.10, 3.6.4, 4.0rc2
Description: It was possible for a user to gain unauthorized access to
             any Bugzilla account in a very short amount of time (short
             enough that the attack is highly effective). This is a
             critical vulnerability that should be patched immediately
             by all Bugzilla installations.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=621591
             https://bugzilla.mozilla.org/show_bug.cgi?id=619594
CVE Number:  CVE-2010-4568

Class:       HTTP Response Splitting
Affected:    Every Version Before 3.2.10, 3.4.10, 3.6.4, 4.0rc2
Fixed In:    3.2.10, 3.4.10, 3.6.4, 4.0rc2
Description: By inserting particular strings into certain URLs, it was
             possible to inject both headers and content to any
             browser.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=591165
             https://bugzilla.mozilla.org/show_bug.cgi?id=621572
             http://avatraxiom.livejournal.com/104105.html
             http://cwe.mitre.org/data/definitions/113.html
CVE Number:  CVE-2010-2761, CVE-2010-4411, CVE-2010-4572

Class:       Cross-Site Scripting
Affected:    3.7.1 to 4.0rc1
Fixed In:    4.0rc2
Description: Bugzilla 3.7.x and 4.0rc1 have a new client-side
             autocomplete mechanism for all fields where a username
             is entered. This mechanism was vulnerable to a cross-site
             scripting attack.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=619637
CVE Number:  CVE-2010-4569

Class:       Cross-Site Scripting
Affected:    3.7.1 to 4.0rc1
Fixed In:    4.0rc2
Description: Bugzilla 3.7.x and 4.0rc1 have a new mechanism on the
             bug entry page for automatically detecting if the bug
             you are filing is a duplicate of another existing bug.
             This mechanism was vulnerable to a cross-site scripting
             attack.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=619648
CVE Number:  CVE-2010-4570

Class:       Cross-Site Scripting
Affected:    Every Version Before 3.2.10, 3.4.10, 3.6.4, 4.0rc2
Fixed In:    3.2.10, 3.4.10, 3.6.4, 4.0rc2
Description: Bugzilla has a "URL" field that can contain several types
             of URL, including "javascript:" and "data:" URLs. However,
             it does not make "javascript:" and "data:" URLs into
             clickable links, to protect against cross-site scripting
             attacks or other attacks. It was possible to bypass this
             protection by adding spaces into the URL in places that
             Bugzilla did not expect them. Also, "javascript:" and
             "data:" links were *always- summary: |-
             shown as clickable to
             logged-out users.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=619588
             https://bugzilla.mozilla.org/show_bug.cgi?id=628034
CVE Number:  CVE-2010-4567, CVE-2011-0048

Class:       Cross-Site Request Forgery
Affected:    Every Version Before 3.2.10, 3.4.10, 3.6.4, 4.0rc2
Fixed In:    3.2.10, 3.4.10, 3.6.4, 4.0rc2
Description: Various pages were vulnerable to Cross-Site Request
             Forgery attacks. Most of these issues are not as serious
             as previous CSRF vulnerabilities. Some of these issues
             were only addressed on more recent branches of Bugzilla
             and not fixed in earlier branches, in order to avoid
             changing behavior that external applications may depend
             on. The links below in "References" describe which issues
             were fixed on which branches.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=621090
             https://bugzilla.mozilla.org/show_bug.cgi?id=621105
             https://bugzilla.mozilla.org/show_bug.cgi?id=621107
             https://bugzilla.mozilla.org/show_bug.cgi?id=621108
             https://bugzilla.mozilla.org/show_bug.cgi?id=621109
             https://bugzilla.mozilla.org/show_bug.cgi?id=621110
CVE Number:  CVE-2011-0046

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: Max Kanat-Alexander
Issue 1 Fixed by: Max Kanat-Alexander

Issue 2 Reporter: FrÃ©dÃ©ric Buclin, Michal Zalewski
Issue 2 Fixed by: Reed Loden, FrÃ©dÃ©ric Buclin, Max Kanat-Alexander

Issue 3 Reporter: Reed Loden
Issue 3 Fixed by: Reed Loden, Max Kanat-Alexander, Guy Pyrzak, FrÃ©dÃ©ric Buclin

Issue 4 Reporter: Reed Loden
Issue 4 Fixed by: Guy Pyrzak, Max Kanat-Alexander, FrÃ©dÃ©ric Buclin

Issue 5 Reporter: Alex Miller
Issue 5 Fixed by: FrÃ©dÃ©ric Buclin

Issue 6 Reporter: JosÃ© A. VÃ¡zquez, Reed Loden
Issue 6 Fixed by: David Lawrence, FrÃ©dÃ©ric Buclin, Willem Pinckaers

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright Â© 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)



=== Content from www.vupen.com_89631af8_20250125_190032.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


