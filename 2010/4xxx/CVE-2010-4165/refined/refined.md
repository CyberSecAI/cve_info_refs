CVE-2010-4165:

- **Root cause:** The `do_tcp_setsockopt` function in `net/ipv4/tcp.c` in the Linux kernel does not properly restrict `TCP_MAXSEG` (aka MSS) values, which allows local users to cause a denial of service (OOPS).
- **Vulnerability:** Divide-by-zero error in `tcp_select_initial_window` due to user-supplied `TCP_MAXSEG` value of 12 (or `TCPOLEN_TSTAMP_ALIGNED`).
- **Attack vector:** A local user can trigger the vulnerability by making a `setsockopt` call with a small `TCP_MAXSEG` value on a listening network socket and then establishing a TCP connection to the awaiting socket.
- **Impact:** Kernel oops, resulting in a denial-of-service.
- **Affected versions:** Linux Kernel 2.6.x branch (2.6.37 & below).
- **Required capabilities:** Local user privileges.