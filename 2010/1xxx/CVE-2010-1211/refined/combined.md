=== Content from bugzilla.mozilla.org_d1c8ca59_20250126_070859.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sat Jan 25 2025 23:08:59 PST

* **Bug ID:**
  567059,
  561539,
  570657,
  564705,
  559241,
  566136,
  535926,
  529087,
  574750,
  507775,
  528644

---

11 bugs found.

| [ID](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [567059](/show_bug.cgi?id=567059 "RESOLVED FIXED - Crash [@ js_LookupPropertyWithFlags] or \"Assertion failure: isNative(),\"") |  | [Crash [@ js\_LookupPropertyWithFlags] or "Assertion failure: isNative(),"](/show_bug.cgi?id=567059) | Core | JavaScript Engine | gal | RESO | FIXE | 2013-03-11 |
| [574750](/show_bug.cgi?id=574750 "RESOLVED FIXED - Code that iterates through nsCSSValue::Arrays should use size_t for index now") |  | [Code that iterates through nsCSSValue::Arrays should use size\_t for index now](/show_bug.cgi?id=574750) | Core | CSS Parsing and Comp | dholbert | RESO | FIXE | 2010-09-27 |
| [570657](/show_bug.cgi?id=570657 "RESOLVED FIXED - nsCOMArray is inconsistent with the order in which it releases and removes elements from the array, which can cause a refcount to be decreased more than necessary") |  | [nsCOMArray is inconsistent with the order in which it releases and removes elements from the array, which can cause a refcount to be decreased more than necessary](/show_bug.cgi?id=570657) | Core | XPCOM | ehsan.akhgari | RESO | FIXE | 2010-09-27 |
| [561539](/show_bug.cgi?id=561539 "RESOLVED FIXED - \"Assertion failure: isQName(), at ../jsobjinlines.h\" or \"Assertion failure: obj->getClass() == &js_NamespaceClass.base || IsQNameClass(obj->getClass()), at ../jsxml.cpp\" with e4x") |  | ["Assertion failure: isQName(), at ../jsobjinlines.h" or "Assertion failure: obj->getClass() == &js\_NamespaceClass.base || IsQNameClass(obj->getClass()), at ../jsxml.cpp" with e4x](/show_bug.cgi?id=561539) | Core | JavaScript Engine | igor | RESO | FIXE | 2013-03-18 |
| [566136](/show_bug.cgi?id=566136 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []") |  | [Assertion failure: isNative() after global.\_\_proto\_\_ = []](/show_bug.cgi?id=566136) | Core | JavaScript Engine | igor | RESO | FIXE | 2013-03-20 |
| [529087](/show_bug.cgi?id=529087 "RESOLVED FIXED - Crash [@ nsXBLBinding::AllowScripts]") |  | [Crash [@ nsXBLBinding::AllowScripts]](/show_bug.cgi?id=529087) | Core | XBL | jonas | RESO | FIXE | 2011-06-13 |
| [507775](/show_bug.cgi?id=507775 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]") |  | [Firefox crashes upon closing when selecting display:block for everything (\* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]](/show_bug.cgi?id=507775) | Core | Layout: Block and In | MatsPalmgren\_bugz | RESO | FIXE | 2015-10-16 |
| [559241](/show_bug.cgi?id=559241 "RESOLVED FIXED - ###!!! ASSERTION: this type of frame can't have overflow containers") |  | [###!!! ASSERTION: this type of frame can't have overflow containers](/show_bug.cgi?id=559241) | Core | Layout: Block and In | roc | RESO | FIXE | 2013-05-18 |
| [535926](/show_bug.cgi?id=535926 "RESOLVED FIXED - \"ASSERTION: This is unsafe\" with <iframe>, XBL") |  | ["ASSERTION: This is unsafe" with <iframe>, XBL](/show_bug.cgi?id=535926) | Core | DOM: Core & HTML | smaug | RESO | FIXE | 2019-03-13 |
| [564705](/show_bug.cgi?id=564705 "RESOLVED FIXED - String buffer underflow and crash [@ nsTextBoxFrame::UpdateAccessTitle]") |  | [String buffer underflow and crash [@ nsTextBoxFrame::UpdateAccessTitle]](/show_bug.cgi?id=564705) | Core | XUL | tnikkel | RESO | FIXE | 2011-06-13 |
| [528644](/show_bug.cgi?id=528644 "VERIFIED FIXED - Crash [@ js_GetUpvar]") |  | [Crash [@ js\_GetUpvar]](/show_bug.cgi?id=528644) | Core | JavaScript Engine | dmandelin | VERI | FIXE | 2012-03-23 |

11 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=567059%2C561539%2C570657%2C564705%2C559241%2C566136%2C535926%2C529087%2C574750%2C507775%2C528644&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from bugzilla.mozilla.org_994c20bb_20250125_071703.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/507775)
* [XML](/show_bug.cgi?ctype=xml&id=507775)

Closed
[Bug 507775](/show_bug.cgi?id=507775)

Opened 15 years ago
Closed 15 years ago

# Firefox crashes upon closing when selecting display:block for everything (\* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox crashes upon closing when selecting display:block for everything (\* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]

## Categories

### (Core :: Layout: Block and Inline, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline#Layout%3A%20Block%20and%20Inline)

Layout: Block and Inline
▾

Core :: Layout: Block and Inline

Issues with core layout and geometry for basic block and inline elements. This includes issues with ::first-letter and ::first-line.

Example bugs:

* margins between two blocks do not collapse properly
* button does not align its baseline correctly with the rest of the line it’s in

Specifications covered:

* CSS Box
* CSS Inline Layout

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

1.9.2 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla1.9.3a5

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| status1.9.2 | --- | [.5-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.5-fixed) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| status1.9.2 |  | .5-fixed |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Tobbi, Assigned: MatsPalmgren\_bugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/25bbdc5f339734fb410e1e2f63904218?d=mm&size=40)  [Tobbi](/user_profile?user_id=257029)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=40)  [jfkthame](/user_profile?user_id=329583)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, verified1.9.1, verified1.9.2, Whiteboard: [sg:critical] [qa-needs-str])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical] [qa-needs-str]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ @0x0 | @0x349d7ff ]](https://crash-stats.mozilla.org/signature/?signature=%400x0%20%7C%20%400x349d7ff)

[[@ @0x0 - nsLineLayout::ReflowFrame ]](https://crash-stats.mozilla.org/signature/?signature=%400x0%20-%20nsLineLayout%3A%3AReflowFrame)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [backtrace for this bug](/attachment.cgi?id=392142)  [15 years ago](#c4)  [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)   19.33 KB, text/plain |  | [Details](/attachment.cgi?id=392142&action=edit) |
| --- | --- | --- |
| [Example of XUL file I performed the crash with.](/attachment.cgi?id=393500)  [15 years ago](#c10)  [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)   3.65 KB, application/vnd.mozilla.xul+xml; charset=iso-8859-1 |  | [Details](/attachment.cgi?id=393500&action=edit) |
| [frame dump + stacks](/attachment.cgi?id=438192)  [15 years ago](#c24)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   43.56 KB, text/html |  | [Details](/attachment.cgi?id=438192&action=edit) |
| [Patch rev. 1, for branches.](/attachment.cgi?id=438195)  [15 years ago](#c25)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   1.16 KB, patch | bzbarsky : [review+](#c27 "15 years ago")  roc : [superreview+](#a22100912_5038 "15 years ago")  beltzner : [approval1.9.2.5+](#c36 "15 years ago")  beltzner : [approval1.9.1.11+](#c37 "15 years ago") | [Details](/attachment.cgi?id=438195&action=edit) | [Diff](/attachment.cgi?id=438195&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=438195) |
| [Patch rev. 1, for trunk.](/attachment.cgi?id=438196)  [15 years ago](#c26)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   1.11 KB, patch | bzbarsky : [review+](#a21770470_20209 "15 years ago")  roc : [superreview+](#a22100920_5038 "15 years ago") | [Details](/attachment.cgi?id=438196&action=edit) | [Diff](/attachment.cgi?id=438196&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=438196) |
| [non-working mochitest](/attachment.cgi?id=439031)  [15 years ago](#c34)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   2.43 KB, patch |  | [Details](/attachment.cgi?id=439031&action=edit) | [Diff](/attachment.cgi?id=439031&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=439031) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=507775#c0)• 15 years ago |
|  | |

I noticed that Firefox can crash upon closedown when you do the following:
1. Install Firebug from <https://addons.mozilla.org/de/firefox/addon/1843> and restart.
2. Load a random XUL document in Firefox.
3. Start up Firebug for this XUL document.
4. Go to the Styles tab on the right and select the '\*' selector.
5. Change the 'display' property to block.
6. Close Firefox.
--> Crash with <http://crash-stats.mozilla.com/report/index/226e45b8-3da0-4fee-90ca-164f62090731>
I can't really say what causes that crash, thus component 'General'.

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a1478_257029)• 15 years ago |

Summary: Firefox crashes upon closedown when selecting display:block for everything (\* selector) in CSS with Firebug → Firefox crashes upon closedown when selecting display:block for everything (\* selector) in CSS with Firebug in [ @@0x0 | @0x349d7ff]

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=507775#c1)• 15 years ago |
|  | |

Another crash report associated with this crash: <http://crash-stats.mozilla.com/report/index/e8919ee4-eb58-49ec-afe4-ebeb82090731> (@ @0x0).

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=507775#c2)• 15 years ago |
|  | |

Another person I asked (jaymac) crashed with [@@0x0|@0x323c7ff]. <http://crash-stats.mozilla.com/report/index/5169ccb1-eada-4830-8b3d-7e4942090801?p=1>Status: UNCONFIRMED → NEWblocking1.9.1: --- → ?Ever confirmed: true

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=507775#c3)• 15 years ago |
|  | |

<https://developer.mozilla.org/en/How_to_get_a_stacktrace_with_WinDbg>

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=507775#c4)• 15 years ago |
|  | |

Attached file
[backtrace for this bug](attachment.cgi?id=392142)
— [Details](attachment.cgi?id=392142&action=edit)

Stacktrace for this crash in plain text

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a111921_257029)• 15 years ago |

Component: General → XULProduct: Firefox → CoreQA Contact: general → xptoolkit.widgetsVersion: 3.5 Branch → 1.9.1 Branch

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a112929_15223)• 15 years ago |

Component: XUL → Layout: Block and InlineKeywords: [crash](/buglist.cgi?keywords=crash&resolution=---)QA Contact: xptoolkit.widgets → layout.block-and-inlineSummary: Firefox crashes upon closedown when selecting display:block for everything (\* selector) in CSS with Firebug in [ @@0x0 | @0x349d7ff] → Firefox crashes upon closedown when selecting display:block for everything (\* selector) in CSS with Firebug in [ @@0x0 | @0x349d7ff][@ 0x0 - nsLineLayout::ReflowFrame]

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a115631_257029)• 15 years ago |

Summary: Firefox crashes upon closedown when selecting display:block for everything (\* selector) in CSS with Firebug in [ @@0x0 | @0x349d7ff][@ 0x0 - nsLineLayout::ReflowFrame] → Firefox crashes upon closing when selecting display:block for everything (\* selector) in CSS with Firebug in [ @@0x0 | @0x349d7ff][@ 0x0 - nsLineLayout::ReflowFrame]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=507775#c5)• 15 years ago |
|  | |

Rob: can someone on your team look into this?Group: core-securityblocking1.9.1: ? → ---
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)Whiteboard: [sg:critical?] firebug-related?

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=507775#c6)• 15 years ago |
|  | |

yeah, taking a look.

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=507775#c7)• 15 years ago |
|  | |

I was able to crash Firefox 3.5.1 pretty easily by loading chrome://browser/content/browser.xul and changing \* to { display: block; } as the reporter describes. Still waiting for my stack-trace, but it should appear here momentarily:
<http://crash-stats.mozilla.com/report/index/de597de2-a2e6-48b3-8aee-fe4982090810?p=1>
One notable difference: I didn't have to close Firefox. I unfocused it by clicking on another window and then the crash occurred. Betting it happened on reflow.
Tobias: I'm curious what xul document you were inspecting when you triggered this crash?

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=507775#c8)• 15 years ago |
|  | |

one other thing: I don't think this is necessarily being caused by Firebug. I expect it's a result of modifying the xul document's css in a way that would normally never happen. Might be possible to duplicate this by modifying userAgent.css to include a | \* { display: block; } | rule.

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=507775#c9)• 15 years ago |
|  | |

whups, meant userChrome.css.
this, made my browser pretty ugly, but didn't crash. Makes sense I guess, because this seems to be stemming from a later reflow.
any theories from the layout people?Whiteboard: [sg:critical?] firebug-related? → [sg:critical?]

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=507775#c10)• 15 years ago |
|  | |

Attached file
[Example of XUL file I performed the crash with.](attachment.cgi?id=393500)
— [Details](attachment.cgi?id=393500&action=edit)

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=507775#c11)• 15 years ago |
|  | |

(In reply to [comment #7](/show_bug.cgi?id=507775#c7 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> Tobias: I'm curious what xul document you were inspecting when you triggered
> this crash?
I was just testing a random XUL file, such as the one I attached above.

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=507775#c12)• 15 years ago |
|  | |

happens on Mac too.
thank, Tobias. Guess it doesn't matter what the content is, just that it's xul.
based on the stack trace, looks like, nsLineLayout& aLineLayout parameter was null going in.
Not really sure how exploitable this is, Dan. Seems like it would be difficult to inject code from this. Would like to get some layout guys cc'd here to help debug.OS: Windows Vista → All

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=507775#c13)• 15 years ago |
|  | |

(In reply to [comment #12](/show_bug.cgi?id=507775#c12 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> based on the stack trace, looks like, nsLineLayout& aLineLayout parameter was
> null going in.
Sounds like something that should be getting wrapped in a block (non-XUL content inside XUL) isn't getting wrapped.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a813121_3881)• 15 years ago |

[Attachment #393500](/attachment.cgi?id=393500&action=edit "Example of XUL file I performed the crash with.") -
Attachment mime type: application/vnd.mozilla.xul+xml → application/vnd.mozilla.xul+xml; charset=iso-8859-1

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=507775#c14)• 15 years ago |
|  | |

(In reply to [comment #13](/show_bug.cgi?id=507775#c13 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> Sounds like something that should be getting wrapped in a block (non-XUL
> content inside XUL) isn't getting wrapped.
Er, except not if it's in nsBlockFrame::\*.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=507775#c15)• 15 years ago |
|  | |

For what it's worth, in a 1.9.0 build, if I modify the testcase to add:
<?xml-stylesheet href='data:text/css,window[foo] \*{display:block}' type='text/css'?>
and then enter this in the URL bar:
javascript:void(document.documentElement.setAttribute('foo', 'bar'))
I don't get a crash.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=507775#c16)• 15 years ago |
|  | |

(And, for what it's worth, being able to know whether this was fixed on trunk already is another reason it would be really great to have a Firebug that was compatible with trunk.)

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=507775#c17)• 15 years ago |
|  | |

Firebug 1.5 is compatible with trunk.
<http://getfirebug.com/releases/firebug/1.5X/>

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=507775#c18)• 15 years ago |
|  | |

just to loopback, I mentioned this in last weekend's meeting and we think we have a fix for it in Firebug.
we can get the origin of a rule and detect if that's coming from one of the userAgent.css files. If so, we can prevent modification of it. Should fix this.

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=507775#c19)• 15 years ago |
|  | |

(In reply to [comment #18](/show_bug.cgi?id=507775#c18 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> we can get the origin of a rule and detect if that's coming from one of the
> userAgent.css files. If so, we can prevent modification of it. Should fix this.
A remark on my site: Wouldn't that only fix the bug in Firebug, so that it can't be triggered using Firebug anymore, wouldn't the actual bug remain?

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=507775#c20)• 15 years ago |
|  | |

(In reply to [comment #19](/show_bug.cgi?id=507775#c19 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> (In reply to [comment #18](/show_bug.cgi?id=507775#c18 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> > we can get the origin of a rule and detect if that's coming from one of the
> > userAgent.css files. If so, we can prevent modification of it. Should fix this.
>
> A remark on my site: Wouldn't that only fix the bug in Firebug, so that it
> can't be triggered using Firebug anymore, wouldn't the actual bug remain?
yes. You would no longer be able to trigger this bug using Firebug. Morphing a display rule on XUL page will still crash if you can do it some other way.

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a4622502_2687)• 15 years ago |

Blocks: [518287](/show_bug.cgi?id=518287 "RESOLVED INCOMPLETE - twice as many \"no signature\" and other crashes in firefox 3.5.3 as 3.0.14")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a4668149_1689)• 15 years ago |

No longer blocks: [518287](/show_bug.cgi?id=518287 "RESOLVED INCOMPLETE - twice as many \"no signature\" and other crashes in firefox 3.5.3 as 3.0.14")Keywords: [testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a11200012_15223)• 15 years ago |

Summary: Firefox crashes upon closing when selecting display:block for everything (\* selector) in CSS with Firebug in [ @@0x0 | @0x349d7ff][@ 0x0 - nsLineLayout::ReflowFrame] → Firefox crashes upon closing when selecting display:block for everything (\* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=507775#c21)• 15 years ago |
|  | |

We don't have a standalone testcase here? Can someone try to make one?Assignee: nobody → matspal

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=507775#c22)• 15 years ago |
|  | |

Mats, any chance you can work on this soon?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=507775#c23)• 15 years ago |
|  | |

In a 1.9.2 debug build on x86-64 Linux I get:
\*\*\* stack smashing detected \*\*\*: /OBJDIR/usr/moz/1.9.2/dist/bin/firefox-bin terminated
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff34a0c27 in ?? () from /lib/libgcc\_s.so.1
(gdb) bt
#0 0x00007ffff34a0c27 in ?? () from /lib/libgcc\_s.so.1
#1 0x00007ffff34a148b in \_Unwind\_Backtrace () from /lib/libgcc\_s.so.1
#2 0x00007ffff321978e in \*\_\_GI\_\_\_backtrace (array=<value optimized out>, size=64) at ../sysdeps/x86\_64/../ia64/backtrace.c:85
#3 0x00007ffff318dcab in \_\_libc\_message (do\_abort=<value optimized out>, fmt=<value optimized out>) at ../sysdeps/unix/sysv/linux/libc\_fatal.c:168
#4 0x00007ffff3219647 in \*\_\_GI\_\_\_fortify\_fail (msg=0x7ffff3257d2e "stack smashing detected") at fortify\_fail.c:32
#5 0x00007ffff3219610 in \_\_stack\_chk\_fail () at stack\_chk\_fail.c:29
#6 0x00007ffff7191c30 in NS\_CopyUnicodeToNative (input=<value optimized out>, output=...) at /usr/moz/1.9.2/xpcom/io/nsNativeCharsetUtils.cpp:868
#7 0xdadadadadadadada in ?? ()
#8 0xdadadadadadadada in ?? ()
#9 0xdadadadadadadada in ?? ()
#10 0x00ff69ca0000ed80 in ?? ()
#11 0x000042c000ff58c0 in ?? ()
#12 0x0000b9e1000011a0 in ?? ()
#13 0x000000000000ec00 in ?? ()
#14 0x0000eccb0000ec40 in ?? ()
#15 0xdadadadadadadada in ?? ()
#16 0xdadadadadadadada in ?? ()
#17 0xdadadadadadadada in ?? ()
#18 0x0000ecca0000ec80 in ?? ()
#19 0xdadadadadadadada in ?? ()
#20 0xdadadadadadadada in ?? ()
#21 0xdadadadadadadada in ?? ()
#22 0x0000ecc90000ecc0 in ?? ()
...Whiteboard: [sg:critical?] → [sg:critical]Version: 1.9.1 Branch → 1.9.2 Branch

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=507775#c24)• 15 years ago |
|  | |

Attached file
[frame dump + stacks](attachment.cgi?id=438192)
— [Details](attachment.cgi?id=438192&action=edit)

There's a restyle request for the root box's popupgroup (reframing it),
it destroys the PopupSetFrame (lime) which destroys a bunch of
OOF MenuPopup frames, leaving dangling placeholder frames all over...
This dump shows the original frame tree, the stack for the restyle
request, some assertions associated with deleting the OOFs, then
the crash stack (in a debug build), and the broken frame tree
at that point.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=507775#c25)• 15 years ago |
|  | |

Attached patch

[Patch rev. 1, for branches.](attachment.cgi?id=438195&action=diff)
— [Details](attachment.cgi?id=438195&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=438195)

[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: review?(bzbarsky)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=507775#c26)• 15 years ago |
|  | |

Attached patch

[Patch rev. 1, for trunk.](attachment.cgi?id=438196&action=diff)
— [Details](attachment.cgi?id=438196&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=438196)

[Attachment #438196](/attachment.cgi?id=438196&action=edit "Patch rev. 1, for trunk.") -
Flags: review?(bzbarsky)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a21754559_5168)• 15 years ago |

Whiteboard: [sg:critical] → [sg:critical][needs review]

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=507775#c27)• 15 years ago |
|  | |

Comment on [attachment 438195](/attachment.cgi?id=438195 "Patch rev. 1, for branches.") [[details]](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") [[diff]](/attachment.cgi?id=438195&action=diff "Patch rev. 1, for branches.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=438195)
Patch rev. 1, for branches.
So the issue is that a frame contains OOFs but not their placeholders? <sigh>.
[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: review?(bzbarsky) → review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a21770470_20209)• 15 years ago |

[Attachment #438196](/attachment.cgi?id=438196&action=edit "Patch rev. 1, for trunk.") -
Flags: review?(bzbarsky) → review+

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=507775#c28)• 15 years ago |
|  | |

Thanks Mats!!! Can you attach a testcase here that when can land when it's safe to do so?

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a22087040_180188)• 15 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=507775#c29)• 15 years ago |
|  | |

As a security bug, this needs SR before landing, no?

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a22089127_159758)• 15 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)Whiteboard: [sg:critical][needs review] → [sg:critical][needs super-review]

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=507775#c30)• 15 years ago |
|  | |

(In reply to [comment #29](/show_bug.cgi?id=507775#c29 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> As a security bug, this needs SR before landing, no?
We got rid of that bogus rule (right?), but maybe this just needs regular SR.
/be

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=507775#c31)• 15 years ago |
|  | |

(In reply to [comment #30](/show_bug.cgi?id=507775#c30 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> (In reply to [comment #29](/show_bug.cgi?id=507775#c29 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> > As a security bug, this needs SR before landing, no?
>
> We got rid of that bogus rule (right?), but maybe this just needs regular SR.
Nope. According to <http://www.mozilla.org/hacking/reviewers.html> ("What needs super-review?"),
"""
All changes involving security
For security bugs, and changes to security models or mechanisms, we want extra experienced eyes to be involved with those changes.
"""

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a22094330_5168)• 15 years ago |

[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: superreview?(roc)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a22094349_5168)• 15 years ago |

[Attachment #438196](/attachment.cgi?id=438196&action=edit "Patch rev. 1, for trunk.") -
Flags: superreview?(roc)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a22100912_5038)• 15 years ago |

[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: superreview?(roc) → superreview+

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a22100920_5038)• 15 years ago |

[Attachment #438196](/attachment.cgi?id=438196&action=edit "Patch rev. 1, for trunk.") -
Flags: superreview?(roc) → superreview+

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=507775#c32)• 15 years ago |
|  | |

looks good for reviews. Mats, please check this in ASAP.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a22101352_159758)• 15 years ago |

Whiteboard: [sg:critical][needs super-review] → [sg:critical]

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=507775#c33)• 15 years ago |
|  | |

Rob, there's lot's of unstarred orange on m-c and people on
#developers seems to think it's a real error(s).

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=507775#c34)• 15 years ago |
|  | |

Attached patch

[non-working mochitest](attachment.cgi?id=439031&action=diff)
— [Details](attachment.cgi?id=439031&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=439031)

Attempt to make a mochitest. I can't make it crash!

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=507775#c35)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/1b4a2702d2dd>Status: NEW → RESOLVEDClosed: 15 years ago
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)Resolution: --- → FIXEDTarget Milestone: --- → mozilla1.9.3a5

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a24534413_5168)• 15 years ago |

[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: approval1.9.2.4?
[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: approval1.9.1.10?

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=507775#c36)• 15 years ago |
|  | |

Comment on [attachment 438195](/attachment.cgi?id=438195 "Patch rev. 1, for branches.") [[details]](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") [[diff]](/attachment.cgi?id=438195&action=diff "Patch rev. 1, for branches.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=438195)
Patch rev. 1, for branches.
a=beltzner for mozilla-1.9.1 and mozilla-1.9.2 default
[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: approval1.9.2.5+
[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: approval1.9.2.4?
[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: approval1.9.1.10?
[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: approval1.9.1.10+

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=507775#c37)• 15 years ago |
|  | |

Comment on [attachment 438195](/attachment.cgi?id=438195 "Patch rev. 1, for branches.") [[details]](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") [[diff]](/attachment.cgi?id=438195&action=diff "Patch rev. 1, for branches.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=507775&attachment=438195)
Patch rev. 1, for branches.
(oops, wrong flag!)
[Attachment #438195](/attachment.cgi?id=438195&action=edit "Patch rev. 1, for branches.") -
Flags: approval1.9.1.10+ → approval1.9.1.11+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=507775#c38)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/acc99e6c1c1c>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/36188af29584>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → [.5-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.5-fixed)

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=507775#c39)• 15 years ago |
|  | |

Was this expected to cause a 2.2% SunSpider regression? 'cause it did:
<http://mzl.la/9XcV5k>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=507775#c40)• 15 years ago |
|  | |

I responded to the 2.2% Dromaeo regression on mozilla.dev.tree-management.
There also a "Improvement: SunSpider decrease 5.11% on Win7 Firefox3.5"
on this changeset. Both are unexpected and "impossible" to have been
caused by this patch. I'm guessing something was changed in the test
and/or testing environment.
I'll be happy to backout/re-land to verify if you like.

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=507775#c41)• 15 years ago |
|  | |

I think you should back out and see if the perf changes revert, just to be safe.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=507775#c42)• 15 years ago |
|  | |

Temporarily backed out on 1.9.1 to investigate perf regression:
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/5edc3e8585de>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) → [?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=507775#c43)• 15 years ago |
|  | |

Dromaeo(V8) on WINNT 5.1 looked fine to me, so I re-landed:
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/c3e1d2040160>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a27419226_5168)• 15 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=507775#c44)• 15 years ago |
|  | |

(In reply to [comment #0](/show_bug.cgi?id=507775#c0 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> I noticed that Firefox can crash upon closedown when you do the following:
> 1. Install Firebug from <https://addons.mozilla.org/de/firefox/addon/1843> and
> restart.
> 2. Load a random XUL document in Firefox.
> 3. Start up Firebug for this XUL document.
> 4. Go to the Styles tab on the right and select the '\*' selector.
> 5. Change the 'display' property to block.
> 6. Close Firefox.
Did the UI change in Firebug? I see no '\*' selector in the Styles tab on the right in current Firebug. What version were you using for this?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=507775#c45)• 15 years ago |
|  | |

Looking at this in Firebug 1.4.1, the UI is the same so I'm just unclear on how to repro based on the above steps. I'm not a Firebug user normally.Whiteboard: [sg:critical] → [sg:critical] [qa-needs-str]

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=507775#c46)• 15 years ago |
|  | |

(In reply to [comment #45](/show_bug.cgi?id=507775#c45 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> Looking at this in Firebug 1.4.1, the UI is the same so I'm just unclear on how
> to repro based on the above steps. I'm not a Firebug user normally.
Load a XUL document, then open firebug. Click the styles tab. You should find a \* selector.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=507775#c47)• 15 years ago |
|  | |

If I load chrome://browser/content/browser.xul or the file attached here and open up Firebug, the right pane has tabs that say, "Style", "Computed Layout", and "DOM". Selecting style, the menu off of it says, "Show User Agent CSS", "Expand Shorthand Properties", ":active", and ":hover" with nothing else. Where is the \* selector?
So, I'm obviously not getting something here. I assume it is personal failure rather than Firebug but, as I said, I don't use Firebug normally.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=507775#c48)• 15 years ago |
|  | |

Ah, Tobbi made this clearer on IRC. I still can't reproduce the crash on either 1.9.1 and 1.9.2. He's going to look at this.

|  | [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)  Reporter |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=507775#c49)• 15 years ago |
|  | |

(In reply to [comment #48](/show_bug.cgi?id=507775#c48 "RESOLVED FIXED - Firefox crashes upon closing when selecting display:block for everything (* selector) in CSS with Firebug in [@ @0x0 | @0x349d7ff][@ @0x0 - nsLineLayout::ReflowFrame]"))
> Ah, Tobbi made this clearer on IRC. I still can't reproduce the crash on either
> 1.9.1 and 1.9.2. He's going to look at this.
I can't reproduce the crash either with the latest candidate builds (3.6.7 and 3.5.11).
Marking VERIFIED.Status: RESOLVED → VERIFIED

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=507775#c50)• 15 years ago |
|  | |

We use "Verified" for trunk verification. Please use verified1.9.1 and verified1.9.2 keywords for branch verifications.
Thanks for the help!Status: VERIFIED → RESOLVEDClosed: 15 years ago → 15 years ago

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a29006388_280903)• 15 years ago |

Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a36533588_1689)• 14 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a58882076_1)• 14 years ago |

Crash Signature: [@ @0x0 | @0x349d7ff]
[@ @0x0 - nsLineLayout::ReflowFrame]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=507775#a195918279_75935)• 9 years ago |

Keywords: [testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)
You need to [log in](/show_bug.cgi?id=507775&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tobias (:Tobbi) Markus](/user_profile?user_id=257029)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_a3015db8_20250125_071718.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/566136)
* [XML](/show_bug.cgi?ctype=xml&id=566136)

Closed
[Bug 566136](/show_bug.cgi?id=566136)

Opened 15 years ago
Closed 15 years ago

# Assertion failure: isNative() after global.\_\_proto\_\_ = []

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: isNative() after global.\_\_proto\_\_ = []

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Other Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [beta1+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=beta1%2B) |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [.11+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.11%2B) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | beta1+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | .11+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: igor, Assigned: igor)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/78556976aa7c7e7980d6865f27df11b8?d=mm&size=40)  [igor](/user_profile?user_id=50763)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/78556976aa7c7e7980d6865f27df11b8?d=mm&size=40)  [igor](/user_profile?user_id=50763)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[487039](/show_bug.cgi?id=487039 "VERIFIED FIXED - Name cache does not detect prototype mutations")

Dependency [tree](/showdependencytree.cgi?id=566136&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=566136)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:critical?] fixed-in-tracemonkey [critsmash:patch])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---),
[verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?] fixed-in-tracemonkey [critsmash:patch]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [decoder](/user_profile?user_id=395101) | [in-testsuite](#a89855642_395101 "12 years ago") | + |
| --- | --- | --- |
| [decoder](/user_profile?user_id=395101) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [v1](/attachment.cgi?id=445612)  [15 years ago](#c2)  [Igor Bukanov](/user_profile?user_id=50763)   1.43 KB, patch |  | [Details](/attachment.cgi?id=445612&action=edit) | [Diff](/attachment.cgi?id=445612&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=445612) |
| --- | --- | --- |
| [v2](/attachment.cgi?id=445617)  [15 years ago](#c5)  [Igor Bukanov](/user_profile?user_id=50763)   2.53 KB, patch | brendan : [review+](#a225138_1214 "15 years ago") | [Details](/attachment.cgi?id=445617&action=edit) | [Diff](/attachment.cgi?id=445617&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=445617) |
| [fix for 192 and 191](/attachment.cgi?id=453882)  [15 years ago](#c18)  [Igor Bukanov](/user_profile?user_id=50763)   653 bytes, patch | brendan : [review+](#a3575391_1214 "15 years ago")  christian : [approval1.9.2.7+](#a3805395_482154 "15 years ago")  christian : [approval1.9.1.11+](#a3805395_482154 "15 years ago") | [Details](/attachment.cgi?id=453882&action=edit) | [Diff](/attachment.cgi?id=453882&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=453882) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=566136#c0)• 15 years ago |
|  | |

The following scripts gives an assert in debug builds:
~/m/tm/js/src> cat ~/s/x.js
this.\_\_proto\_\_ = [];
print(length);
~/m/tm/js/src> ~/build/js/tdbg/js ~/s/x.js
Assertion failure: isNative(), at /home/igor/m/tm/js/src/jsscope.h:549
Aborted

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=566136#c1)• 15 years ago |
|  | |

The bug exists since the moment of introduction of the property cache so I nominate it for branches down to 190.blocking1.9.1: --- → ?blocking1.9.2: --- → ?blocking2.0: --- → ?Flags: blocking1.9.0.19?

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=566136#c2)• 15 years ago |
|  | |

Attached patch

[v1](attachment.cgi?id=445612&action=diff) (obsolete)
— [Details](attachment.cgi?id=445612&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=445612)

The patch adds the missing isNative checkAssignee: general → igor
[Attachment #445612](/attachment.cgi?id=445612&action=edit "v1") -
Flags: review?(brendan)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=566136#c3)• 15 years ago |
|  | |

Comment on [attachment 445612](/attachment.cgi?id=445612 "v1") [[details]](/attachment.cgi?id=445612&action=edit "v1") [[diff]](/attachment.cgi?id=445612&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=445612)
v1
Should we make fill test pobj->isNative() instead? I.e., are there other paths that could lead here?
/be

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=566136#c4)• 15 years ago |
|  | |

(In reply to [comment #3](/show_bug.cgi?id=566136#c3 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []"))
> (From update of [attachment 445612](/attachment.cgi?id=445612 "v1") [[details]](/attachment.cgi?id=445612&action=edit "v1") [[diff]](/attachment.cgi?id=445612&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=445612))
> Should we make fill test pobj->isNative() instead? I.e., are there other paths
> that could lead here?
That was really good point. js\_FindPropertyHelper also suffers from this bug as the following test case shows:
this.\_\_proto\_\_ = [];
function f() {
eval('Math');
length = 2;
}
f();
On the other hand AFAICS all other users of LookupProperty calls consistently check for native objects before casting prop to JSScopeProperty. Thus I prefer not to penalize the fill method and rather add the spot checks to the two bad users. But we should definitely do some fuzzing.
Gary, could you run a fuzzer after doing an assignments like this.\_\_proto\_\_ = [] or this.\_\_proto\_\_ = <xml/> ?

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=566136#c5)• 15 years ago |
|  | |

Attached patch

[v2](attachment.cgi?id=445617&action=diff)
— [Details](attachment.cgi?id=445617&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=445617)

v2 adds another spot check for non-native prototypes of the global objects.
[Attachment #445612](/attachment.cgi?id=445612&action=edit "v1") -
Attachment is obsolete: true
[Attachment #445617](/attachment.cgi?id=445617&action=edit "v2") -
Flags: review?(brendan)
[Attachment #445612](/attachment.cgi?id=445612&action=edit "v1") -
Flags: review?(brendan)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=566136#c6)• 15 years ago |
|  | |

js::PropertyCache::fill needs to be cold path or the cache isn't working. I suppose we can rely on the assertion plus fuzzing. I will wait till tomorrow to review in case fuzzing reveals other paths (in which case, or even so: let's test in fill and not worry until profile data shows it slows down benchmarks).
/be

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=566136#c7)• 15 years ago |
|  | |

(In reply to [comment #6](/show_bug.cgi?id=566136#c6 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []"))
> let's
> test in fill and not worry until profile data shows it slows down benchmarks).
Doing the check in the fill is not enough. Consider that js\_FindIdentifierBase is calling JS\_UNLOCK\_OBJ on the obj assuming that pobj is native. So we really have to monitor all the lookup users. For this reason I still prefer to do the check in the callers, not in the fill.

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=566136#c8)• 15 years ago |
|  | |

You're right that js\_FindIdentifierBase needs to follow the rules -- when did it stop? Did it used to loop over only js\_IsCacheableNonGlobalScope(obj) and more recently also the global object was included in the loop?
It's huge to be able to count on native-only proto chain, but the general case of obj->lookupProperty requires obj->dropProperty after (until we get rid of that as proposed elsewhere). Breaking the general rule proliferates if-not-native tests.
/be

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=566136#c9)• 15 years ago |
|  | |

I'm really asking whether it makes sense to unroll any final iteration of the loops in js\_FindPropertyHelper and js\_FindIdentifierBase if the global object is hit, since the cacheable non-global scope chain objects do not require this is-native checking, and indeed seem to share less code with the global object last-iteration case anyway.
/be

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=566136#c10)• 15 years ago |
|  | |

(In reply to [comment #4](/show_bug.cgi?id=566136#c4 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []"))
> all other users of LookupProperty calls consistently check for native objects
> before casting prop to JSScopeProperty
This is where the root problem lies; we'll continue to have problems as long as we keep doing this without including some sort of automatic checks. Could we provide a way of converting that will assert nativeness?
struct JSProperty {
JSScopeProperty\* asScopeProperty(JSObject\* obj) const {
union {
const JSProperty\* prop;
const JSScopeProperty\* sprop;
} u;
u.prop = this;
JS\_ASSERT(obj->scope()->hasProperty(u.sprop));
return u.sprop;
}
};
Or something in the same spirit with more rigor and less strawman-ness?

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=566136#c11)• 15 years ago |
|  | |

We're getting rid of the JSProperty \* opaque pointer type from JSObjectOps hooks, instead. See [bug 566143](/show_bug.cgi?id=566143 "RESOLVED WORKSFORME - Eliminate Shape from ObjectOps API").
/be

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=566136#c12)• 15 years ago |
|  | |

I'd be pretty cool with \_\_proto\_\_ setting on a JSCLASS\_IS\_GLOBAL\_OBJECT thing throwing an error, too. We're going to get rid of settable proto (vs initializable proto) in due course anyway, and it seems like we can take a first stab by blocking some of the more ludicrous uses. :-)

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=566136#c13)• 15 years ago |
|  | |

(In reply to [comment #12](/show_bug.cgi?id=566136#c12 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []"))
> I'd be pretty cool with \_\_proto\_\_ setting on a JSCLASS\_IS\_GLOBAL\_OBJECT thing
> throwing an error, too.
This would not help this bug as a rogue script can set the proto of global.\_\_proto\_\_. The latter is Object.prototype which is a plain object.
> We're going to get rid of settable proto
That helps but only if there is guarantee that it would be impossible to construct a global object with non-native on the prototype chain.

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=566136#c14)• 15 years ago |
|  | |

(In reply to [comment #8](/show_bug.cgi?id=566136#c8 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []"))
> You're right that js\_FindIdentifierBase needs to follow the rules -- when did
> it stop? Did it used to loop over only js\_IsCacheableNonGlobalScope(obj) and
> more recently also the global object was included in the loop?
This bug is a regression from my patch for the [bug 487039](/show_bug.cgi?id=487039 "VERIFIED FIXED - Name cache does not detect prototype mutations"). I was too zealous there optimizing the lookup.Blocks: [487039](/show_bug.cgi?id=487039 "VERIFIED FIXED - Name cache does not detect prototype mutations")

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=566136#c15)• 15 years ago |
|  | |

(In reply to [comment #9](/show_bug.cgi?id=566136#c9 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []"))
> I'm really asking whether it makes sense to unroll any final iteration of the
> loops in js\_FindPropertyHelper and js\_FindIdentifierBase
I have tried, but that makes the patch much bigger and I prefer a spot fixes here to simplify back-porting.

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a179946_137548)• 15 years ago |

blocking1.9.1: ? → .11+blocking1.9.2: ? → .5+blocking2.0: ? → beta1+Whiteboard: [sg:critical?]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a179980_1689)• 15 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a225138_1214)• 15 years ago |

[Attachment #445617](/attachment.cgi?id=445617&action=edit "v2") -
Flags: review?(brendan) → review+

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=566136#c16)• 15 years ago |
|  | |

<http://hg.mozilla.org/tracemonkey/rev/07756d509077>Whiteboard: [sg:critical?] → [sg:critical?] fixed-in-tracemonkey

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a277838_11608)• 15 years ago |

Keywords: [testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a277871_269330)• 15 years ago |

Whiteboard: [sg:critical?] fixed-in-tracemonkey → [sg:critical?] fixed-in-tracemonkey [critsmash:patch]

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=566136#c17)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/07756d509077>Status: NEW → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a2387983_1689)• 15 years ago |

blocking1.9.2: .5+ → .6+

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=566136#c18)• 15 years ago |
|  | |

Attached patch

[fix for 192 and 191](attachment.cgi?id=453882&action=diff)
— [Details](attachment.cgi?id=453882&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=453882)

Compared with the trunk on 192-191 there is no need to fix js\_FindIdentifierBase. The latter on those branches does not cache the lookup for globals as code there relies just on gvar optimization. In js\_FindPropertyHelper I also have not added an assert that the global should be native. I do not remember if a non-native global was completely disabled there.
Brendan, could you review this before before the freeze on Friday?
[Attachment #445617](/attachment.cgi?id=445617&action=edit "v2") -
Attachment is obsolete: true
[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: review?(brendan)

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a3481544_50763)• 15 years ago |

[Attachment #445617](/attachment.cgi?id=445617&action=edit "v2") -
Attachment is obsolete: false

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a3575391_1214)• 15 years ago |

[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: review?(brendan)
[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: review+
[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: approval1.9.2.6?
[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: approval1.9.1.11?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a3805395_482154)• 15 years ago |

[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: approval1.9.2.7?
[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: approval1.9.2.7+
[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: approval1.9.1.11?
[Attachment #453882](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") -
Flags: approval1.9.1.11+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=566136#c19)• 15 years ago |
|  | |

Comment on [attachment 453882](/attachment.cgi?id=453882 "fix for 192 and 191") [[details]](/attachment.cgi?id=453882&action=edit "fix for 192 and 191") [[diff]](/attachment.cgi?id=453882&action=diff "fix for 192 and 191") [[review]](/page.cgi?id=splinter.html&ignore=&bug=566136&attachment=453882)
fix for 192 and 191
a=LegNeato for 1.9.2.7 and 1.9.1.11. Please land this on mozilla-1.9.2 default and mozilla-1.9.1 default asap.
Thanks!

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=566136#c20)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/1151e590b153>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/1243f15ec0a8>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=566136#c21)• 15 years ago |
|  | |

Bob, can you verify this on 1.9.1 and 1.9.2?

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=566136#c22)• 15 years ago |
|  | |

tests in [comment 0](/show_bug.cgi?id=566136#c0 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []") and [comment 4](/show_bug.cgi?id=566136#c4 "RESOLVED FIXED - Assertion failure: isNative() after global.__proto__ = []") do not assert in the shell for 1.9.1, 1.9.2 on mac os x 10.5, linux 32/64 bit or winxp.
v 1.9.1, 1.9.2Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a11697706_1689)• 14 years ago |

Group: core-security

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a60057351_50763)• 13 years ago |

Flags: blocking1.9.0.19?

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=566136#c23)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1ea0203ab5fa>

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=566136#a89855642_395101)• 12 years ago |

Flags: in-testsuite+
You need to [log in](/show_bug.cgi?id=566136&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Igor Bukanov](/user_profile?user_id=50763)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_492be745_20250125_071720.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/567059)
* [XML](/show_bug.cgi?ctype=xml&id=567059)

Closed
[Bug 567059](/show_bug.cgi?id=567059)

Opened 15 years ago
Closed 15 years ago

# Crash [@ js\_LookupPropertyWithFlags] or "Assertion failure: isNative(),"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ js\_LookupPropertyWithFlags] or "Assertion failure: isNative(),"

## Categories

### (Core :: JavaScript Engine, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [betaN+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=betaN%2B) |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [.11+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.11%2B) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | betaN+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | .11+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: gal)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/86d014603512abf3c5966ea995551a53?d=mm&size=40)  [gal](/user_profile?user_id=310943)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[harmony:proxies](/show_bug.cgi?id=546590 "RESOLVED FIXED - Implement Harmony Proxies [ES6?]")

Dependency [tree](/showdependencytree.cgi?id=567059&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=567059)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:critical?], fixed-in-tracemonkey)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?], fixed-in-tracemonkey

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [decoder](/user_profile?user_id=395101) | [in-testsuite](#c26 "14 years ago") | - |
| --- | --- | --- |
| [decoder](/user_profile?user_id=395101) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ js\_LookupPropertyWithFlags ]](https://crash-stats.mozilla.org/signature/?signature=js_LookupPropertyWithFlags)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [patch](/attachment.cgi?id=446456)  [15 years ago](#c1)  [Andreas Gal :gal](/user_profile?user_id=310943)   824 bytes, patch | dvander : [review+](#a2287_309316 "15 years ago") | [Details](/attachment.cgi?id=446456&action=edit) | [Diff](/attachment.cgi?id=446456&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=567059&attachment=446456) |
| --- | --- | --- |
| [1.9.2 patch](/attachment.cgi?id=454234)  [15 years ago](#c13)  [Andreas Gal :gal](/user_profile?user_id=310943)   733 bytes, patch |  | [Details](/attachment.cgi?id=454234&action=edit) | [Diff](/attachment.cgi?id=454234&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=567059&attachment=454234) |
| [1.9.2 patch with missing ! restored](/attachment.cgi?id=454241)  [15 years ago](#c15)  [Brendan Eich [:brendan]](/user_profile?user_id=1214)   734 bytes, patch | brendan : [review+](#c15 "15 years ago")  christian : [approval1.9.2.7+](#a3429829_482154 "15 years ago") | [Details](/attachment.cgi?id=454241&action=edit) | [Diff](/attachment.cgi?id=454241&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=567059&attachment=454241) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=567059#c0)• 15 years ago |
|  | |

for (a = 0; a < 8; ++a) {
if (a) {
Proxy.create({}).t()
}
}
crashes js opt shell on TM tip with -j at js\_LookupPropertyWithFlags and asserts js debug shell on TM tip with -j at Assertion failure: isNative(), at ../jsscope.h:549
Tested on 64-bit Ubuntu Linux 10.04 and changeset tm-42457-f423fbc93e3f. Assuming related to harmony:proxies. Doesn't seem related to [bug 566908](/show_bug.cgi?id=566908 "RESOLVED DUPLICATE - Crash [@ js_LookupPropertyWithFlags] or \"Assertion failure: obj->isNative(), at ../jsobj.cpp\"").
Console stdout:
Program received signal SIGSEGV, Segmentation fault.
0x000000000046673d in js\_LookupPropertyWithFlags ()
(gdb) bt
#0 0x000000000046673d in js\_LookupPropertyWithFlags ()
#1 0x0000000000519d87 in js::TraceRecorder::test\_property\_cache(JSObject\*, nanojit::LIns\*, JSObject\*&, js::PCVal&) ()
#2 0x0000000000524424 in js::TraceRecorder::record\_JSOP\_CALLPROP() ()
#3 0x0000000000527e4d in js::TraceRecorder::monitorRecording(JSOp) ()
#4 0x000000000054d64a in js\_Interpret ()
#5 0x0000000000458421 in js\_Execute ()
#6 0x000000000040b6d6 in JS\_ExecuteScript ()
#7 0x00000000004069e5 in Process(JSContext\*, JSObject\*, char\*, int) ()
#8 0x0000000000407269 in main ()
(gdb) x/i $rip
=> 0x46673d <js\_LookupPropertyWithFlags+189>: cmp (%rdx),%rbx
(gdb) x/b $rdx
0xffffffff: Cannot access memory at address 0xffffffff

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=567059#c1)• 15 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=446456&action=diff)
— [Details](attachment.cgi?id=446456&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=567059&attachment=446456)

Our soon to be native xml and with objects would have hit this, too. Good thing we found it early.Assignee: general → gal
[Attachment #446456](/attachment.cgi?id=446456&action=edit "patch") -
Flags: review?(dvander)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=567059#c2)• 15 years ago |
|  | |

(In reply to [comment #1](/show_bug.cgi?id=567059#c1 "RESOLVED FIXED - Crash [@ js_LookupPropertyWithFlags] or \"Assertion failure: isNative(),\""))
> Our soon to be native xml and with objects would have hit this, too.
s/native/non-native/
We have non-native Java objects in 3.6 still. Wonder what the test does with such a LiveConnect critter instead of Proxy.create()'s return value.
/be

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=567059#c3)• 15 years ago |
|  | |

map will be null so its probably a fairly safe crashGroup: core-security

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=567059#c4)• 15 years ago |
|  | |

map will point to a singleton shared map statically pointed at by the non-native JSObjectOps singleton.
/be

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a2287_309316)• 15 years ago |

[Attachment #446456](/attachment.cgi?id=446456&action=edit "patch") -
Flags: review?(dvander) → review+

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=567059#c5)• 15 years ago |
|  | |

The actual effects are still a bit unclear but best case we generate bad jit code and more likely we crash.blocking2.0: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)OS: Linux → AllPriority: -- → P2Hardware: x86 → AllWhiteboard: [sg:investigate?]

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a79011_310943)• 15 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F) → ---
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → ---

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=567059#c6)• 15 years ago |
|  | |

<http://hg.mozilla.org/tracemonkey/rev/89d31a27e5b8>Whiteboard: [sg:investigate?] → [sg:investigate?], fixed-in-tracemonkey

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=567059#c7)• 15 years ago |
|  | |

Aehm ...
<http://hg.mozilla.org/tracemonkey/rev/89d31a27e5b8>

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=567059#c8)• 15 years ago |
|  | |

Double aehm ... Follow-up fix. 2-liner and we got it still wrong. That will teach me not to thoroughly test trivial fixes.
<http://hg.mozilla.org/tracemonkey/rev/aefd4f69b448>

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=567059#c9)• 15 years ago |
|  | |

Andreas: can you provide a roll-up patch for mozilla-1.9.2 landing and nominate for approval1.9.2.5?blocking1.9.2: ? → needed

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a137626_137548)• 15 years ago |

blocking1.9.1: ? → needed

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=567059#c10)• 15 years ago |
|  | |

#9: pulling 1.9.2. Patch today.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a424645_1689)• 15 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=567059#c11)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/89d31a27e5b8>Status: NEW → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a1337790_482154)• 15 years ago |

blocking1.9.1: needed → .11+blocking1.9.2: needed → .5+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a1990708_1689)• 15 years ago |

blocking1.9.2: .5+ → .6+Whiteboard: [sg:investigate?], fixed-in-tracemonkey → [sg:critical?][needs branch patch or approval request from :gal] fixed-in-tracemonkey

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=567059#c12)• 15 years ago |
|  | |

Any hope for branch patches for this?

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=567059#c13)• 15 years ago |
|  | |

Attached patch

[1.9.2 patch](attachment.cgi?id=454234&action=diff) (obsolete)
— [Details](attachment.cgi?id=454234&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=567059&attachment=454234)

[Attachment #446456](/attachment.cgi?id=446456&action=edit "patch") -
Attachment is obsolete: true

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a3193421_310943)• 15 years ago |

[Attachment #446456](/attachment.cgi?id=446456&action=edit "patch") -
Attachment is obsolete: false

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a3193434_310943)• 15 years ago |

[Attachment #454234](/attachment.cgi?id=454234&action=edit "1.9.2 patch") -
Attachment description: patch → 1.9.2 patch

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=567059#c14)• 15 years ago |
|  | |

Comment on [attachment 454234](/attachment.cgi?id=454234 "1.9.2 patch") [[details]](/attachment.cgi?id=454234&action=edit "1.9.2 patch") [[diff]](/attachment.cgi?id=454234&action=diff "1.9.2 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=567059&attachment=454234)
1.9.2 patch
Can someone land this for me please? (its a blocker so I am not sure I even need approval)
[Attachment #454234](/attachment.cgi?id=454234&action=edit "1.9.2 patch") -
Flags: approval1.9.2.6?

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a3193492_310943)• 15 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)Whiteboard: [sg:critical?][needs branch patch or approval request from :gal] fixed-in-tracemonkey → [sg:critical?], fixed-in-tracemonkey

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=567059#c15)• 15 years ago |
|  | |

Attached patch

[1.9.2 patch with missing ! restored](attachment.cgi?id=454241&action=diff)
— [Details](attachment.cgi?id=454241&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=567059&attachment=454241)

[Attachment #454234](/attachment.cgi?id=454234&action=edit "1.9.2 patch") -
Attachment is obsolete: true
[Attachment #454241](/attachment.cgi?id=454241&action=edit "1.9.2 patch with missing ! restored") -
Flags: review+
[Attachment #454241](/attachment.cgi?id=454241&action=edit "1.9.2 patch with missing ! restored") -
Flags: approval1.9.2.6?
[Attachment #454234](/attachment.cgi?id=454234&action=edit "1.9.2 patch") -
Flags: approval1.9.2.6?

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=567059#c16)• 15 years ago |
|  | |

Thanks for catching this. Pulling 1.9.1 right now over the hotel's 9600 baud connection.

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=567059#c17)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/1804452e19b1>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/98888b2f3bf8>
I wasn't able to build 1.9.2 js shell (debug or opt) on 64-bit Mac:
c++ -o jsregexp.o -c -fvisibility=hidden -DOSTYPE=\"Darwin10.4.0\" -DOSARCH=Darwin -DEXPORT\_JS\_API -DJS\_USE\_SAFE\_ARENA -I.. -I. -I./dist/include -I./dist/include/nsprpub -I.. -fPIC -fno-rtti -fno-exceptions -Wall -Wpointer-arith -Woverloaded-virtual -Wsynth -Wno-ctor-dtor-privacy -Wno-non-virtual-dtor -Wcast-align -Wno-invalid-offsetof -Wno-variadic-macros -Wno-long-long -fno-strict-aliasing -fpascal-strings -fno-common -pthread -pipe -DNDEBUG -DTRIMMED -O3 -fstrict-aliasing -DMOZILLA\_CLIENT -include ./js-confdefs.h -Wp,-MD,.deps/jsregexp.pp ../jsregexp.cpp
{standard input}:17427:suffix or operands invalid for `call'
make[1]: \*\*\* [jsregexp.o] Error 1
make: \*\*\* [default] Error 2
So I went in blind. Then opened my eyes and read the patch, and fixed the bug in it :-|.
Setting .6-fixed but if this goes in .7 due to another release intervening, please fix the status.
/be

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a3196724_1214)• 15 years ago |

[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Andreas Gal :gal](/user_profile?user_id=310943)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=567059#c18)• 15 years ago |
|  | |

Yeah that's why I didn't test either. Can't build 1.9.1 either. Trying to build for 32-bit. Maybe that works.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=567059#c19)• 15 years ago |
|  | |

(In reply to [comment #17](/show_bug.cgi?id=567059#c17 "RESOLVED FIXED - Crash [@ js_LookupPropertyWithFlags] or \"Assertion failure: isNative(),\""))
> Setting .6-fixed but if this goes in .7 due to another release intervening,
> please fix the status.
Is there a reason why this landed without approval? All branch patches require approval from drivers before landing.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=567059#c20)• 15 years ago |
|  | |

(In reply to [comment #14](/show_bug.cgi?id=567059#c14 "RESOLVED FIXED - Crash [@ js_LookupPropertyWithFlags] or \"Assertion failure: isNative(),\""))
> Can someone land this for me please? (its a blocker so I am not sure I even
> need approval)
\*All\* patches on the branches require approval. It seems dveditz needs to do his yearly reminder mail...
<http://groups.google.com/group/mozilla.dev.planning/browse_thread/thread/9b31b7523bd8cc48/5a289dbac727fead>

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a3198602_159758)• 15 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=567059#c21)• 15 years ago |
|  | |

Reed, you are not helping here.
/be

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a3429829_482154)• 15 years ago |

[Attachment #454241](/attachment.cgi?id=454241&action=edit "1.9.2 patch with missing ! restored") -
Flags: approval1.9.2.7? → approval1.9.2.7+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=567059#c22)• 15 years ago |
|  | |

a=LegNeato for 1.9.2.7, though we only want it if we can be sure we will be getting the 1.9.1 patch as well (don't want to leave those users vulnerable).

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=567059#c23)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/ae51fe8759e3>
/be
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=567059#c24)• 15 years ago |
|  | |

no crash with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.7pre) Gecko/20100701 Firefox/3.6.7pre
Garry can you reproduce the crash ?

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=567059#c25)• 15 years ago |
|  | |

Proxies are not defined for 1.9.1 and 1.9.2 so the underlying issue cannot be tested using the original testcase in [comment #0](/show_bug.cgi?id=567059#c0 "RESOLVED FIXED - Crash [@ js_LookupPropertyWithFlags] or \"Assertion failure: isNative(),\"").

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a6186167_180188)• 14 years ago |

blocking2.0: ? → betaN+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a11300631_1689)• 14 years ago |

Group: core-security

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a11318813_11608)• 14 years ago |

Flags: in-testsuite?

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=567059#a33649314_1)• 14 years ago |

Crash Signature: [@ js\_LookupPropertyWithFlags]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=567059#c26)• 12 years ago |
|  | |

Filter on qa-project-auto-change:
Bug in removed tracer code, setting in-testsuite- flag.Flags: in-testsuite? → in-testsuite-
You need to [log in](/show_bug.cgi?id=567059&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Andreas Gal :gal](/user_profile?user_id=310943)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_9c0ea8b1_20250125_071709.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/535926)
* [XML](/show_bug.cgi?ctype=xml&id=535926)

Closed
[Bug 535926](/show_bug.cgi?id=535926)

Opened 15 years ago
Closed 15 years ago

# "ASSERTION: This is unsafe" with <iframe>, XBL

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"ASSERTION: This is unsafe" with <iframe>, XBL

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [beta1+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=beta1%2B) |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [.11+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.11%2B) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | beta1+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | .11+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: smaug)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[343943](/show_bug.cgi?id=343943 "RESOLVED INACTIVE - [meta] HTML Element and Attribute fuzzer"), [531176](/show_bug.cgi?id=531176 "RESOLVED FIXED - Add assertion that it's safe to run scripts before dispatching any events (and fix the cases when events are dispatched at unsafe time)")

Dependency [tree](/showdependencytree.cgi?id=535926&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=535926)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:critical?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[fixed1.9.0.20](/buglist.cgi?keywords=fixed1.9.0.20&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jruderman](/user_profile?user_id=11608) | [in-testsuite](#c45 "14 years ago") | + |
| --- | --- | --- |
| [jruderman](/user_profile?user_id=11608) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 2 obsolete files)

| [testcase](/attachment.cgi?id=418470)  [15 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   561 bytes, text/html |  | [Details](/attachment.cgi?id=418470&action=edit) |
| --- | --- | --- |
| [stack trace](/attachment.cgi?id=418471)  [15 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   13.97 KB, text/plain |  | [Details](/attachment.cgi?id=418471&action=edit) |
| [patch](/attachment.cgi?id=441281)  [15 years ago](#c22)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   4.09 KB, patch |  | [Details](/attachment.cgi?id=441281&action=edit) | [Diff](/attachment.cgi?id=441281&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441281) |
| [v2](/attachment.cgi?id=441519)  [15 years ago](#c28)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   4.19 KB, patch | bzbarsky : [review+](#a11106511_20209 "15 years ago") | [Details](/attachment.cgi?id=441519&action=edit) | [Diff](/attachment.cgi?id=441519&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441519) |
| [+space](/attachment.cgi?id=441526)  [15 years ago](#c30)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   4.19 KB, patch | sicking : [superreview+](#a11124097_9186 "15 years ago") | [Details](/attachment.cgi?id=441526&action=edit) | [Diff](/attachment.cgi?id=441526&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441526) |
| [+some comments](/attachment.cgi?id=441743)  [15 years ago](#c32)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   4.46 KB, patch | christian : [approval1.9.2.7+](#c0 "15 years ago")  christian : [approval1.9.1.11+](#c38 "15 years ago")  dveditz : [approval1.9.0.next+](#c43 "15 years ago") | [Details](/attachment.cgi?id=441743&action=edit) | [Diff](/attachment.cgi?id=441743&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441743) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=535926#c0)• 15 years ago |
|  | |

Attached file
[testcase](attachment.cgi?id=418470)
— [Details](attachment.cgi?id=418470&action=edit)

###!!! ASSERTION: This is unsafe!: 'Error', file /Users/jruderman/mozilla-central/content/events/src/nsEventDispatcher.cpp, line 485
This is the assertion just added in [bug 531176](/show_bug.cgi?id=531176 "RESOLVED FIXED - Add assertion that it's safe to run scripts before dispatching any events (and fix the cases when events are dispatched at unsafe time)").
I'm not sure why I need the setTimeout.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=535926#c1)• 15 years ago |
|  | |

Attached file
[stack trace](attachment.cgi?id=418471)
— [Details](attachment.cgi?id=418471&action=edit)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=535926#c2)• 15 years ago |
|  | |

So nsBrowserStatusFilter::OnStateChange calls some JS code which end up to
progressmeter.xml which dispatches ValueChange.
In this particular case I wonder why we even call OnStateChange.
I believe the document is already loaded but
#21 0x00007f82d1f3e2ec in nsDocument::BlockOnload (this=0x261b070) at /home/smaug/mozilla/mozilla\_cvs/hg/src/content/base/src/nsDocument.cpp:7037
#22 0x00007f82d20e85c8 in nsBindingManager::AddToAttachedQueue (this=0x2158530, aBinding=0x226a5e0)
at /home/smaug/mozilla/mozilla\_cvs/hg/src/content/xbl/src/nsBindingManager.cpp:955
adds new request to load group which triggers the method call.
Investigating...

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=535926#c3)• 15 years ago |
|  | |

But still, I think we can't easily prevent progress listeners to dispatch
events.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=535926#c4)• 15 years ago |
|  | |

Hmm. We should avoid calling progress listeners for BlockOnload calls if we can do it...
Maybe we should stop faking the loadgroup thing and just directly have BlockOnload/UnblockOnload poke the docloader or something?

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=535926#c5)• 15 years ago |
|  | |

An example of this assertion can be seen on Windows 1.9.3 at least at <http://www.slacker.com/>

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a2330973_11608)• 15 years ago |

Whiteboard: [sg:critical?]

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=535926#c6)• 15 years ago |
|  | |

Not sure if this is sg:critical (at least when using the testcase).
That is happening in chrome, and during time we might get dom modifications anyway.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=535926#c7)• 15 years ago |
|  | |

I wonder if, at least for now, the assertion should fire only if the
target of the event is in content.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=535926#c8)• 15 years ago |
|  | |

Repeating this:
> Not sure if this is sg:critical (at least when using the testcase).
> That is happening in chrome, and during time we might get dom modifications
> anyway.
What in this bug makes this sg:critical ?

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=535926#c9)• 15 years ago |
|  | |

I only marked it as sg:critical because the assertion was added in an sg:critical bug. If this bug isn't a security bug, let's unmark the whiteboard and make it public.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=535926#c10)• 15 years ago |
|  | |

Well, I wouldn't remove the security flag from this bug, but
this just may not be sg:critical.

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a6985308_12352)• 15 years ago |

Assignee: nobody → jonasblocking2.0: --- → beta1

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=535926#c11)• 15 years ago |
|  | |

Olli, if this only results in events being fired at chrome windows, then why not remove the security flag?

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=535926#c12)• 15 years ago |
|  | |

Olli, any more thoughts on whether this needs to be sg:critical, or if it's even a security bug any more?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=535926#c13)• 15 years ago |
|  | |

[comment 4](/show_bug.cgi?id=535926#c4 "RESOLVED FIXED - \"ASSERTION: This is unsafe\" with <iframe>, XBL") says what should be done here, I think.
I think this doesn't need to be sg:critical, since there is no clear evidence
that content can trigger anything bad - unless ff ui or some extension starts
to handle status updates in a different way.
But this is still a security bug.

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=535926#c14)• 15 years ago |
|  | |

Looks like we should probably remove the sg:crit rating here, but there's ongoing discussion of what the ration should be. Thoughts?

|  | [Brandon Sterne (:bsterne)](/user_profile?user_id=296777) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=535926#c15)• 15 years ago |
|  | |

If this is a critical vulnerability only exposed to extension code presently, we should lower the severity to sg:high. If we think it's likely that FF UI code would add changes triggering this vuln, then sg:critical severity is appropriate.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=535926#c16)• 15 years ago |
|  | |

Or we can just fix this and not care too much about sg:\*. :)
Taking. I'll try to write the patch on Thursday.Assignee: jonas → Olli.Pettay

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=535926#c17)• 15 years ago |
|  | |

Um, I can't reproduce this atm.
I've tried on Linux and OSX, with and without html5 parser.
The assertion in this case was changed to a warning, but I can't see that either.
I wonder if [bug 557398](/show_bug.cgi?id=557398 "RESOLVED FIXED - \"ASSERTION: This is unsafe! Fix the caller!\" with <xul:wizard>, XBL, iframe") changed something here.
Testing...

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=535926#c18)• 15 years ago |
|  | |

Backing out [bug 557398](/show_bug.cgi?id=557398 "RESOLVED FIXED - \"ASSERTION: This is unsafe! Fix the caller!\" with <xul:wizard>, XBL, iframe") doesn't seem to affect to this bug.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=535926#c19)• 15 years ago |
|  | |

Ah, perhaps LazyFrameCtor changed timing here. Which means this would still
need to be fixed in 1.9.2.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=535926#c20)• 15 years ago |
|  | |

Not LazyFrameCtor. Still trying to find a build where I get the error

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=535926#c21)• 15 years ago |
|  | |

I can reproduce this at least on 1.9.2, when I added the same assertion/warning
what trunk has.
But patch needs to wait at least til tomorrow.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=535926#c22)• 15 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=441281&action=diff) (obsolete)
— [Details](attachment.cgi?id=441281&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441281)

I posted this to tryserver

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=535926#c23)• 15 years ago |
|  | |

Comment on [attachment 441281](/attachment.cgi?id=441281 "patch") [[details]](/attachment.cgi?id=441281&action=edit "patch") [[diff]](/attachment.cgi?id=441281&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441281)
patch
Passed tests on tryserver.
Boris, what do you think about this approach?
A bit ugly, but since I think we want this to 1.9.2 too, I didn't
want to make huge changes. And I'm not even sure what would be
the best way to change nsDocLoader or something.
It would be quite hackish to add onloadblocker-type-of-requests
and handle them specially in docloader.
This relies on script blockers to be on stack and
PostUnblockOnloadEvent to handle things truly async.
[Attachment #441281](/attachment.cgi?id=441281&action=edit "patch") -
Flags: review?(bzbarsky)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a11029436_39966)• 15 years ago |

Status: NEW → ASSIGNED

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=535926#c24)• 15 years ago |
|  | |

Would it make sense to do:
if (!nsContentUtils::IsSafeToRunScript()) {
++mAsyncOnloadBlockCount;
if (mAsyncOnloadBlockCount == 1) {
nsContentUtils::AddScriptRunner(
NS\_NEW\_RUNNABLE\_METHOD(nsDocument, this, AsyncBlockOnload));
}
return;
}
and have AsyncBlockOnload call BlockOnload mAsyncOnLoadBlockCount times, so as not to thrash things with lots of scriptrunners?
Having an API on docloader (whose job it is to keep track of when onload should fire) to block onload would be a lot less hacky than having this fake request, btw. But making it work right might be a pain...
Why is the new block in DoUnblockOnload needed? How can we get there with mAsyncOnloadBlockCount != 0?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=535926#c25)• 15 years ago |
|  | |

(In reply to [comment #24](/show_bug.cgi?id=535926#c24 "RESOLVED FIXED - \"ASSERTION: This is unsafe\" with <iframe>, XBL"))
> Would it make sense to do:
> ...
> and have AsyncBlockOnload call BlockOnload mAsyncOnLoadBlockCount times, so as
> not to thrash things with lots of scriptrunners?
That should work.
> Why is the new block in DoUnblockOnload needed? How can we get there with
> mAsyncOnloadBlockCount != 0?
If some script runner (which is added before the AsyncBlockOnload script runner, so it runs before it) processes event loop.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=535926#c26)• 15 years ago |
|  | |

Ah, ok. Do you want to post a patch with my suggestion from the beginning of [comment 24](/show_bug.cgi?id=535926#c24 "RESOLVED FIXED - \"ASSERTION: This is unsafe\" with <iframe>, XBL")?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=535926#c27)• 15 years ago |
|  | |

Yeah, I will, in a minute.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=535926#c28)• 15 years ago |
|  | |

Attached patch

[v2](attachment.cgi?id=441519&action=diff) (obsolete)
— [Details](attachment.cgi?id=441519&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441519)

Like this?
[Attachment #441281](/attachment.cgi?id=441281&action=edit "patch") -
Attachment is obsolete: true
[Attachment #441519](/attachment.cgi?id=441519&action=edit "v2") -
Flags: review?(bzbarsky)
[Attachment #441281](/attachment.cgi?id=441281&action=edit "patch") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=535926#c29)• 15 years ago |
|  | |

Comment on [attachment 441519](/attachment.cgi?id=441519 "v2") [[details]](/attachment.cgi?id=441519&action=edit "v2") [[diff]](/attachment.cgi?id=441519&action=diff "v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441519)
v2
Space after "while", please.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a11106511_20209)• 15 years ago |

[Attachment #441519](/attachment.cgi?id=441519&action=edit "v2") -
Flags: review?(bzbarsky) → review+

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=535926#c30)• 15 years ago |
|  | |

Attached patch

[+space](attachment.cgi?id=441526&action=diff)
— [Details](attachment.cgi?id=441526&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441526)

uh, how did I miss the space :/
Anyway, this is a security bug, so sr is needed.
[Attachment #441519](/attachment.cgi?id=441519&action=edit "v2") -
Attachment is obsolete: true
[Attachment #441526](/attachment.cgi?id=441526&action=edit "+space") -
Flags: superreview?(jonas)

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a11124097_9186)• 15 years ago |

[Attachment #441526](/attachment.cgi?id=441526&action=edit "+space") -
Flags: superreview?(jonas) → superreview+

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=535926#c31)• 15 years ago |
|  | |

Comment on [attachment 441526](/attachment.cgi?id=441526 "+space") [[details]](/attachment.cgi?id=441526&action=edit "+space") [[diff]](/attachment.cgi?id=441526&action=diff "+space") [[review]](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441526)
+space
Please add documentation on the member describing how it works. Took reading this a few times to figure it out.
And add a comment to ::BlockOnload describing \*why\* we're entering the if-statement.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=535926#c32)• 15 years ago |
|  | |

Attached patch

[+some comments](attachment.cgi?id=441743&action=diff)
— [Details](attachment.cgi?id=441743&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441743)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=535926#c33)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/6f7405a55a48>
<http://hg.mozilla.org/mozilla-central/rev/e5a075d4e5ba>Status: ASSIGNED → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=535926#c34)• 15 years ago |
|  | |

Just wanting to get this on the wanted/blocking list for future 1.9.2 release, as per earlier comments stating that this also affects 1.9.2.blocking1.9.2: --- → ?
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=535926#c35)• 15 years ago |
|  | |

Does this affect 1.9.1 as well?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a12067515_482154)• 15 years ago |

blocking1.9.2: ? → .5+
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a15130737_1689)• 15 years ago |

blocking1.9.2: .5+ → .6+

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=535926#c36)• 15 years ago |
|  | |

[Bug 569674](/show_bug.cgi?id=569674 "RESOLVED WORKSFORME - \"ASSERTION: CreateRenderingContext failure\" with XBL, iframe, contentEditable") is another regression from this, we need to figure that out before landing this on branches. Sorry I didn't mark it sooner.Blocks: [569674](/show_bug.cgi?id=569674 "RESOLVED WORKSFORME - \"ASSERTION: CreateRenderingContext failure\" with XBL, iframe, contentEditable")

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a15152198_20209)• 15 years ago |

No longer blocks: [569674](/show_bug.cgi?id=569674 "RESOLVED WORKSFORME - \"ASSERTION: CreateRenderingContext failure\" with XBL, iframe, contentEditable")URL: <569674>

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=535926#c37)• 15 years ago |
|  | |

Disregard [comment 36](/show_bug.cgi?id=535926#c36 "RESOLVED FIXED - \"ASSERTION: This is unsafe\" with <iframe>, XBL"), I was thinking this was a different bug.URL: <569674>

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a16178858_39966)• 15 years ago |

[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.2.6?
[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.1.11?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=535926#c38)• 15 years ago |
|  | |

Comment on [attachment 441743](/attachment.cgi?id=441743 "+some comments") [[details]](/attachment.cgi?id=441743&action=edit "+some comments") [[diff]](/attachment.cgi?id=441743&action=diff "+some comments") [[review]](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441743)
+some comments
a=LegNeato for 1.9.2.6 and 1.9.1.11. Please land this on mozilla-1.9.2 default and mozilla-1.9.1 default.
Code freeze is this Friday @ 11:59 pm PST.
[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.2.6?
[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.2.6+
[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.1.11?
[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.1.11+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a16293886_1689)• 15 years ago |

blocking1.9.1: --- → .11+
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=535926#c39)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/336a77f067c8>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/866db4f8b8f3>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=535926#c40)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/2c5245d56edb>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/e2498d527265>

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=535926#c41)• 15 years ago |
|  | |

Verified for 1.9.2 with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.7pre) Gecko/20100630 Namoroka/3.6.7pre ( .NET CLR 3.5.30729) using the attached testcase.Keywords: [verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Smokey Ardisson (offline for a while; not following bugs - do not email)](/user_profile?user_id=155027) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=535926#c42)• 15 years ago |
|  | |

Comment on [attachment 441743](/attachment.cgi?id=441743 "+some comments") [[details]](/attachment.cgi?id=441743&action=edit "+some comments") [[diff]](/attachment.cgi?id=441743&action=diff "+some comments") [[review]](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441743)
+some comments
Requesting approval1.9.0.next on this patch so that we can take it in upcoming Camino 2.0.x security and stability updates. If approved, I'll handle the checkins, unless the patch author requests otherwise.
[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.0.next?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=535926#c43)• 15 years ago |
|  | |

Comment on [attachment 441743](/attachment.cgi?id=441743 "+some comments") [[details]](/attachment.cgi?id=441743&action=edit "+some comments") [[diff]](/attachment.cgi?id=441743&action=diff "+some comments") [[review]](/page.cgi?id=splinter.html&ignore=&bug=535926&attachment=441743)
+some comments
Approved for 1.9.0.20, a=dveditz
[Attachment #441743](/attachment.cgi?id=441743&action=edit "+some comments") -
Flags: approval1.9.0.next? → approval1.9.0.next+

|  | [Smokey Ardisson (offline for a while; not following bugs - do not email)](/user_profile?user_id=155027) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=535926#c44)• 15 years ago |
|  | |

Checking in content/base/src/nsDocument.cpp;
/cvsroot/mozilla/content/base/src/nsDocument.cpp,v <-- nsDocument.cpp
new revision: 3.837; previous revision: 3.836
done
Checking in content/base/src/nsDocument.h;
/cvsroot/mozilla/content/base/src/nsDocument.h,v <-- nsDocument.h
new revision: 3.381; previous revision: 3.380
doneKeywords: [fixed1.9.0.20](/buglist.cgi?keywords=fixed1.9.0.20&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a24440253_1689)• 14 years ago |

Group: core-security

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=535926#c45)• 14 years ago |
|  | |

Crashtest: <http://hg.mozilla.org/mozilla-central/rev/524a5670133b>Flags: in-testsuite+

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=535926#a291288897_1)• 6 years ago |

Component: DOM → DOM: Core & HTML
You need to [log in](/show_bug.cgi?id=535926&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_70fd714e_20250125_071721.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/570657)
* [XML](/show_bug.cgi?ctype=xml&id=570657)

Closed
[Bug 570657](/show_bug.cgi?id=570657)

Opened 15 years ago
Closed 15 years ago

# nsCOMArray is inconsistent with the order in which it releases and removes elements from the array, which can cause a refcount to be decreased more than necessary

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

nsCOMArray is inconsistent with the order in which it releases and removes elements from the array, which can cause a refcount to be decreased more than necessary

## Categories

### (Core :: XPCOM, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XPCOM#XPCOM)

XPCOM
▾

Core :: XPCOM
This is the basis of our component technology; this covers the mozilla/xpcom source directory and includes the "repository". Unlikely a tester would be able to tell there was an XPCOM problem specifically.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XPCOM)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla1.9.3a5

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [beta1+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=beta1%2B) |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [.11+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.11%2B) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | beta1+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | .11+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ehsan.akhgari, Assigned: ehsan.akhgari)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/5aef682fbfd7590b9d85d6e8dbab10eb?d=mm&size=40)  [ehsan.akhgari](/user_profile?user_id=251051)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5aef682fbfd7590b9d85d6e8dbab10eb?d=mm&size=40)  [ehsan.akhgari](/user_profile?user_id=251051)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### ( [URL](http://mxr.mozilla.org/mozilla-central/source/xpcom/glue/nsCOMArray.cpp#158 "http://mxr.mozilla.org/mozilla-central/source/xpcom/glue/nsCOMArray.cpp#158") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[mxr.mozilla.org/mozilla-central/sourc...](http://mxr.mozilla.org/mozilla-central/source/xpcom/glue/nsCOMArray.cpp#158 "http://mxr.mozilla.org/mozilla-central/source/xpcom/glue/nsCOMArray.cpp#158")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [sg:critical] [qa-ntd-192] [qa-ntd-191])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical] [qa-ntd-192] [qa-ntd-191]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [ehsan.akhgari](/user_profile?user_id=251051) | [in-testsuite](#c6 "15 years ago") | + |
| --- | --- | --- |
| [ehsan.akhgari](/user_profile?user_id=251051) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 2 obsolete files)

| [Patch (v1)](/attachment.cgi?id=449799)  [15 years ago](#c1)  [(no longer active)](/user_profile?user_id=251051)   6.09 KB, patch |  | [Details](/attachment.cgi?id=449799&action=edit) | [Diff](/attachment.cgi?id=449799&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449799) |
| --- | --- | --- |
| [Patch (v1.1)](/attachment.cgi?id=449800)  [15 years ago](#c2)  [(no longer active)](/user_profile?user_id=251051)   6.16 KB, patch |  | [Details](/attachment.cgi?id=449800&action=edit) | [Diff](/attachment.cgi?id=449800&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449800) |
| [Patch (v1.2)](/attachment.cgi?id=449921)  [15 years ago](#c3)  [(no longer active)](/user_profile?user_id=251051)   6.15 KB, patch | shaver : [review+](#c4 "15 years ago")  dveditz : [approval1.9.2.7+](#c0 "15 years ago")  christian : [approval1.9.1.11+](#c7 "15 years ago") | [Details](/attachment.cgi?id=449921&action=edit) | [Diff](/attachment.cgi?id=449921&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449921) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=570657#c0)• 15 years ago |
|  | |

See [bug 570350 comment 6](/show_bug.cgi?id=570350#c6 "RESOLVED FIXED - Crash [@ nsTextServicesDocument::NodeHasOffsetEntry(nsTArray<OffsetEntry*>*, nsIDOMNode*, int*, int*) ] when enabling/disabling the spell checker") about what caused me to discover this issue.
When nsCOMArray::Clear is called, the interfaces are released \*before\* they're actually removed from the array. So, given an interface which calls nsCOMArray::RemoveObject (or other similar methods) from its Release method, you could get into situations where an object is attempted to be removed twice, and therefore decrementing its refcount more than necessary.
I also see similar things in other methods handling removing items from nsCOMArrays. I think we should have a well-defined order of "removing the object from the array and then calling Release on it, in order to avoid such problems.
The reason that I'm filing this in the security group is that it is (theoretically) possible to study our code to determine places in the code where this might happen (either now or in the future) and then construct a scenario when this caused an object to be deleted with outstanding interface pointers to it, and then use the dangling pointer in combination with other techniques to construct an attach scenario.

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a70_251051)• 15 years ago |

Assignee: nobody → ehsanStatus: NEW → ASSIGNED

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=570657#c1)• 15 years ago |
|  | |

Attached patch

[Patch (v1)](attachment.cgi?id=449799&action=diff) (obsolete)
— [Details](attachment.cgi?id=449799&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449799)

Patch + tests.
[Attachment #449799](/attachment.cgi?id=449799&action=edit "Patch (v1)") -
Flags: review?(shaver)

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=570657#c2)• 15 years ago |
|  | |

Attached patch

[Patch (v1.1)](attachment.cgi?id=449800&action=diff) (obsolete)
— [Details](attachment.cgi?id=449800&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449800)

Actually, make sure in the test that we never manage to remove the element from the destructor.
[Attachment #449799](/attachment.cgi?id=449799&action=edit "Patch (v1)") -
Attachment is obsolete: true
[Attachment #449800](/attachment.cgi?id=449800&action=edit "Patch (v1.1)") -
Flags: review?(shaver)
[Attachment #449799](/attachment.cgi?id=449799&action=edit "Patch (v1)") -
Flags: review?(shaver)

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a56259_269330)• 15 years ago |

Whiteboard: [sg:critical][critsmash:patch]

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=570657#c3)• 15 years ago |
|  | |

Attached patch

[Patch (v1.2)](attachment.cgi?id=449921&action=diff)
— [Details](attachment.cgi?id=449921&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449921)

I have \*no\* idea how this test was passing for me last night. But now the patch is actually correct, and passes the tests!
[Attachment #449800](/attachment.cgi?id=449800&action=edit "Patch (v1.1)") -
Attachment is obsolete: true
[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: review?(shaver)
[Attachment #449800](/attachment.cgi?id=449800&action=edit "Patch (v1.1)") -
Flags: review?(shaver)

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a56660_251051)• 15 years ago |

[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Attachment description: Patch (v1) → Patch (v1.2)

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=570657#c4)• 15 years ago |
|  | |

Comment on [attachment 449921](/attachment.cgi?id=449921 "Patch (v1.2)") [[details]](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") [[diff]](/attachment.cgi?id=449921&action=diff "Patch (v1.2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449921)
Patch (v1.2)
r=shaver
[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: review?(shaver) → review+

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=570657#c5)• 15 years ago |
|  | |

The fix here is localized and safe, and the exact threat level is not something which can be evaluated with certainty, so I'd recommend to block on this for all branches as well as 1.9.3.blocking1.9.1: --- → ?blocking1.9.2: --- → ?blocking2.0: --- → ?

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a57585_7044)• 15 years ago |

blocking2.0: ? → beta1+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a131979_482154)• 15 years ago |

blocking1.9.1: ? → .11+blocking1.9.2: ? → .6+

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=570657#c6)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/af44e6577313>Status: ASSIGNED → RESOLVEDClosed: 15 years agoFlags: in-testsuite+Resolution: --- → FIXEDWhiteboard: [sg:critical][critsmash:patch] → [sg:critical]Target Milestone: --- → mozilla1.9.3a5

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a139554_251051)• 15 years ago |

[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: approval1.9.2.5?
[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: approval1.9.1.11?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=570657#c7)• 15 years ago |
|  | |

Comment on [attachment 449921](/attachment.cgi?id=449921 "Patch (v1.2)") [[details]](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") [[diff]](/attachment.cgi?id=449921&action=diff "Patch (v1.2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=570657&attachment=449921)
Patch (v1.2)
a=LegNeato for 1.9.2.6 and 1.9.1.11. Please land this on mozilla-1.9.2 default and mozilla-1.9.1 default.
[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: approval1.9.2.5?
[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: approval1.9.2.5+
[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: approval1.9.1.11?
[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: approval1.9.1.11+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a325574_1689)• 15 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a355768_1689)• 15 years ago |

[Attachment #449921](/attachment.cgi?id=449921&action=edit "Patch (v1.2)") -
Flags: approval1.9.2.5+ → approval1.9.2.6+

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=570657#c8)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/b1f21f894e9d>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/12a069c6f52d>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=570657#c9)• 15 years ago |
|  | |

Two questions, Ehsan:
1) Are there no tests to be checked in for 1.9.2 and 1.9.1? I see that there is a test running on builds in mozilla central.
2) Since this is a security bug, shouldn't the tests for mozilla central not be checked in yet, per policy, until we unhide the bug?
For QA, I'm trying to figure out what needs to be done to verify this bug on branches.Whiteboard: [sg:critical] → [sg:critical] [qa-examined-192] [qa-examined-191]

|  | [(no longer active)](/user_profile?user_id=251051)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=570657#c10)• 15 years ago |
|  | |

Unfortunately (or maybe fortunately?) we don't have any STRs to exploit this problem. I found out about this problem while working on the editor using a half-baked patch, but that patch was never committed to any repository.
The tests for this bug only test the implementation, and do not uncover any potential attacks.
My mozilla-central patch modified the existing nsCOMArray test, but unfortunately that test does not exist on our branches.
Frankly, I can't think of any way to verify this except for reading the code and reasoning about it, but I'm not sure if that's good enough for your verification purposes.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=570657#c11)• 15 years ago |
|  | |

Nothing for QA to do further here then.Whiteboard: [sg:critical] [qa-examined-192] [qa-examined-191] → [sg:critical] [qa-ntd-192] [qa-ntd-191]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=570657#a9664317_1689)• 14 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=570657&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [(no longer active)](/user_profile?user_id=251051)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_56e695c1_20250125_071701.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2010-34

## Miscellaneous memory safety hazards (rv:1.9.2.7/ 1.9.1.11)

Announced
July 20, 2010
Reporter
Mozilla developers and community
Impact
Critical
Products
Firefox, SeaMonkey, Thunderbird
Fixed in

* Firefox 3.5.11
* Firefox 3.6.7
* SeaMonkey 2.0.6
* Thunderbird 3.0.6
* Thunderbird 3.1.1

### Description

Mozilla developers identified and fixed several memory safety bugs
in the browser engine used in Firefox and other Mozilla-based
products. Some of these bugs showed evidence of memory corruption
under certain circumstances, and we presume that with enough effort at
least some of these could be exploited to run arbitrary code.

### References

Jesse Ruderman, Ehsan Akhgari, Mats Palmgren, Igor Bukanov, Gary
Kwong, Tobias Markus and Daniel Holbert reported memory safety
problems that affected Firefox 3.6 and Firefox 3.5.

* [Memory safety bugs - Firefox 3.5, Firefox 3.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=567059,561539,570657,564705,559241,566136,535926,529087,574750,507775,528644)
* [CVE-2010-1211](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1211)

Jesse Ruderman, David Anderson and Johnny Stenback reported memory
safety problems that affected Firefox 3.6 only.

* [Memory safety bugs - Firefox 3.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=568855,530955,558618)
* [CVE-2010-1212](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1212)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_52206d7d_20250125_071711.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/559241)
* [XML](/show_bug.cgi?ctype=xml&id=559241)

Closed
[Bug 559241](/show_bug.cgi?id=559241)

Opened 15 years ago
Closed 15 years ago

# ###!!! ASSERTION: this type of frame can't have overflow containers

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

###!!! ASSERTION: this type of frame can't have overflow containers

## Categories

### (Core :: Layout: Block and Inline, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline#Layout%3A%20Block%20and%20Inline)

Layout: Block and Inline
▾

Core :: Layout: Block and Inline

Issues with core layout and geometry for basic block and inline elements. This includes issues with ::first-letter and ::first-line.

Example bugs:

* margins between two blocks do not collapse properly
* button does not align its baseline correctly with the rest of the line it’s in

Specifications covered:

* CSS Box
* CSS Inline Layout

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout%3A%20Block%20and%20Inline)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [final+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=final%2B) |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | final+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: MatsPalmgren\_bugz, Assigned: roc)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e1cadeaaf04bd425d597a571ffe0f522?d=mm&size=40)  [roc](/user_profile?user_id=5038)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=40)  [jfkthame](/user_profile?user_id=329583)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### ( [URL](https://bugzilla.mozilla.org/attachment.cgi?id=419851 "https://bugzilla.mozilla.org/attachment.cgi?id=419851") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[537631](/show_bug.cgi?id=537631 "VERIFIED WORKSFORME - \"ASSERTION: reflow roots should never split\" with -moz-column, fixed&abs pos")

Dependency [tree](/showdependencytree.cgi?id=559241&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=559241)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[bugzilla.mozilla.org/attachment.cgi?i...](https://bugzilla.mozilla.org/attachment.cgi?id=419851 "https://bugzilla.mozilla.org/attachment.cgi?id=419851")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: fixed1.9.0.20, testcase, Whiteboard: [sg:critical][critsmash:resolved])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed1.9.0.20](/buglist.cgi?keywords=fixed1.9.0.20&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical][critsmash:resolved]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [MatsPalmgren\_bugz](/user_profile?user_id=5168) | [in-testsuite](#c27 "15 years ago") | + |
| --- | --- | --- |
| [MatsPalmgren\_bugz](/user_profile?user_id=5168) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 2 obsolete files)

| [wip1](/attachment.cgi?id=438924)  [15 years ago](#c2)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   1.70 KB, patch |  | [Details](/attachment.cgi?id=438924&action=edit) | [Diff](/attachment.cgi?id=438924&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=438924) |
| --- | --- | --- |
| [fix](/attachment.cgi?id=446063)  [15 years ago](#c11)  [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)   2.04 KB, patch | dbaron : [review-](#c14 "15 years ago") | [Details](/attachment.cgi?id=446063&action=edit) | [Diff](/attachment.cgi?id=446063&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446063) |
| [fix v2](/attachment.cgi?id=446084)  [15 years ago](#c15)  [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)   2.19 KB, patch | dbaron : [review+](#c16 "15 years ago")  christian : [approval1.9.2.7+](#c0 "15 years ago")  christian : [approval1.9.1.11+](#c22 "15 years ago")  christian : [approval1.9.0.next+](#c22 "15 years ago") | [Details](/attachment.cgi?id=446084&action=edit) | [Diff](/attachment.cgi?id=446084&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446084) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=559241#c0)• 15 years ago |
|  | |

From [bug 537631 comment 2](/show_bug.cgi?id=537631#c2 "VERIFIED WORKSFORME - \"ASSERTION: reflow roots should never split\" with -moz-column, fixed&abs pos"):
========= Jesse Ruderman 2010-04-13 17:43:58 PDT
Also triggers an assertion recently added in [bug 509839](/show_bug.cgi?id=509839 "RESOLVED FIXED - Crash [@ nsViewManager::CreateView][@ nsCSSFrameConstructor::AddFrameConstructionItemsInternal] on closing print preview with -moz-transform, position: fixed table displays"):
###!!! ASSERTION: this type of frame can't have overflow containers:
'(aProperty != nsContainerFrame::OverflowContainersProperty() && aProperty !=
nsContainerFrame::ExcessOverflowContainersProperty()) ||
IsFrameOfType(nsIFrame::eCanContainOverflowContainers)', file
/Users/jruderman/mozilla-central/layout/generic/nsContainerFrame.cpp, line 1212

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=559241#c1)• 15 years ago |
|  | |

I suspect it can lead to a crash when destroying the shell, as in [bug 509839](/show_bug.cgi?id=509839 "RESOLVED FIXED - Crash [@ nsViewManager::CreateView][@ nsCSSFrameConstructor::AddFrameConstructionItemsInternal] on closing print preview with -moz-transform, position: fixed table displays").
The container frame is a ViewPortFrame, and we're adding a child frame
to the ExcessOverflowContainersProperty frame list on line 173:
<http://mxr.mozilla.org/mozilla-central/source/layout/generic/nsAbsoluteContainingBlock.cpp#169>
(The root cause of the problem is most likely what triggers the
assertion in [bug 537631](/show_bug.cgi?id=537631 "VERIFIED WORKSFORME - \"ASSERTION: reflow roots should never split\" with -moz-column, fixed&abs pos").)
We could wallpaper the problem the same way as in [bug 509839](/show_bug.cgi?id=509839 "RESOLVED FIXED - Crash [@ nsViewManager::CreateView][@ nsCSSFrameConstructor::AddFrameConstructionItemsInternal] on closing print preview with -moz-transform, position: fixed table displays")
by adding the eCanContainOverflowContainers bit to ViewPortFrame.
Anyone got a better idea?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=559241#c2)• 15 years ago |
|  | |

Attached patch

[wip1](attachment.cgi?id=438924&action=diff) (obsolete)
— [Details](attachment.cgi?id=438924&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=438924)

nsPageContentFrame inherits ViewportFrame so we can remove it there
without breaking [bug 509839](/show_bug.cgi?id=509839 "RESOLVED FIXED - Crash [@ nsViewManager::CreateView][@ nsCSSFrameConstructor::AddFrameConstructionItemsInternal] on closing print preview with -moz-transform, position: fixed table displays").Assignee: nobody → matspal
[Attachment #438924](/attachment.cgi?id=438924&action=edit "wip1") -
Flags: review?(fantasai.bugs)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a507796_5038)• 15 years ago |

Whiteboard: [sg:critical?] → [sg:critical?][needs review]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=559241#c3)• 15 years ago |
|  | |

Can we get a call as to whether or not this is really an sg:crit?

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=559241#c4)• 15 years ago |
|  | |

I'm not sure, but since we have a patch, no point in agonizing over it.Whiteboard: [sg:critical?][needs review] → [sg:critical][needs review]

|  | [fantasai](/user_profile?user_id=9018) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=559241#c5)• 15 years ago |
|  | |

Comment on [attachment 438924](/attachment.cgi?id=438924 "wip1") [[details]](/attachment.cgi?id=438924&action=edit "wip1") [[diff]](/attachment.cgi?id=438924&action=diff "wip1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=438924)
wip1
r=fantasai for branch, but not for trunk, because, if I'm understanding correctly, viewport frames shouldn't be causing splits in the first place and that's what should be fixed.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=559241#c6)• 15 years ago |
|  | |

Ok, but it needs to bake on trunk before landing on 1.9.2 and for that
I need r+. I could back it out from trunk once the baking is done,
but how would we remember to apply this patch if we make new branches
from trunk? I think it makes more sense to leave it on trunk and
file a new bug on "viewport frames causing splits".
It would be easy to add an assertion for that (checking frame type) in
nsContainerFrame::SetPropTableFrames.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=559241#c7)• 15 years ago |
|  | |

How about we just fix the underlying problem here instead of worrying about where to take a wallpaper fix?
It's probably a bug in nsColumnSetFrame. We should not be creating an overflow container for the nsColumnSetFrame.

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a1193152_269330)• 15 years ago |

Whiteboard: [sg:critical][needs review] → [sg:critical][needs review][critsmash:investigating]

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=559241#c8)• 15 years ago |
|  | |

TakingAssignee: matspal → roc

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a1797068_5038)• 15 years ago |

[Attachment #438924](/attachment.cgi?id=438924&action=edit "wip1") -
Flags: review?(fantasai.bugs)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a2400732_5038)• 15 years ago |

Whiteboard: [sg:critical][needs review][critsmash:investigating] → [sg:critical][critsmash:investigating]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=559241#c9)• 15 years ago |
|  | |

Roc promises to look at this before next CritSmash meeting, w/ Vlad.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=559241#c10)• 15 years ago |
|  | |

Using the testcase
<body style="position: fixed; -moz-column-count: 2;"><div style="position: absolute; height: 100px;"><br><br></div></body>
the column reflow log as we balance the columns narrows down the problem:
\*\*\* Doing column reflow pass: mLastBalanceHeight=1073741824, mColMaxHeight=3600, RTL=0
, mBalanceColCount=2, mColWidth=1, mColGap=960
\*\*\* Reflowing child #0 0x20011c70: availHeight=3600
\*\*\* Reflowed child #0 0x20011c70: status = 6, desiredSize=1,0
\*\*\* NEXT CHILD ORIGIN.x = 961
\*\*\* Reflowing child #1 0x151f138: availHeight=3600
\*\*\* Reflowed child #1 0x151f138: status = 0, desiredSize=1,0
\*\*\* DONE PASS feasible=1
...
\*\*\* Doing column reflow pass: mLastBalanceHeight=2700, mColMaxHeight=3599, RTL=0
, mBalanceColCount=2, mColWidth=1, mColGap=960
\*\*\* Reflowing child #0 0x20011c70: availHeight=3599
\*\*\* Reflowed child #0 0x20011c70: status = 4, desiredSize=1,0
\*\*\* NEXT CHILD ORIGIN.x = 961
\*\*\* Reflowing child #1 0x151f138: availHeight=3599
\*\*\* Reflowed child #1 0x151f138: status = 4, desiredSize=1,0
\*\*\* DONE PASS feasible=0
\*\*\* Doing column reflow pass: mLastBalanceHeight=3599, mColMaxHeight=3600, RTL=0
, mBalanceColCount=2, mColWidth=1, mColGap=960
\*\*\* Reflowing child #0 0x20011c70: availHeight=3600
\*\*\* Reflowed child #0 0x20011c70: status = 4, desiredSize=1,0
\*\*\* NEXT CHILD ORIGIN.x = 961
\*\*\* Reflowing child #1 0x151f138: availHeight=1073741824
\*\*\* Reflowed child #1 0x151f138: status = 4, desiredSize=1,0
\*\*\* DONE PASS feasible=0
We reflow once with column height 60px and the content fits (as it should). Later we try height 60px - epsilon and it doesn't fit, which is wrong, it should fit (in this case I believe the correct balanced column height would be 50px). Then we decide that height 60px must be the optimal height and do one last reflow with that height, and we still think the content doesn't fit and we start creating overflow frames.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=559241#c11)• 15 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=446063&action=diff) (obsolete)
— [Details](attachment.cgi?id=446063&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446063)

Really simple and safe fix.
We just neglected to reflow our overflow-container-children if they weren't dirty but the available vertical space had changed. Fixing that makes balancing work properly.
[Attachment #438924](/attachment.cgi?id=438924&action=edit "wip1") -
Attachment is obsolete: true
[Attachment #446063](/attachment.cgi?id=446063&action=edit "fix") -
Flags: review?(dbaron)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a3011836_5038)• 15 years ago |

Whiteboard: [sg:critical][critsmash:investigating] → [sg:critical][critsmash:investigating][needs review]

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=559241#c12)• 15 years ago |
|  | |

Would calling nsHTMLReflowState::ShouldReflowAllKids outside the loop be sufficient? It seems better not to reinvent that function one piece at a time.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=559241#c13)• 15 years ago |
|  | |

i.e., calling it outside the loop and making the condition
shouldReflowAllKids || NS\_SUBTREE\_DIRTY(frame)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=559241#c14)• 15 years ago |
|  | |

Comment on [attachment 446063](/attachment.cgi?id=446063 "fix") [[details]](/attachment.cgi?id=446063&action=edit "fix") [[diff]](/attachment.cgi?id=446063&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446063)
fix
Additionally, I think mVResize isn't meant to be used other than in combination with the way ShouldReflowAllKids uses it. So if ShouldReflowAllKids works, then we should really use that instead.
[Attachment #446063](/attachment.cgi?id=446063&action=edit "fix") -
Flags: review?(dbaron) → review-

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=559241#c15)• 15 years ago |
|  | |

Attached patch

[fix v2](attachment.cgi?id=446084&action=diff)
— [Details](attachment.cgi?id=446084&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446084)

Yes, this does work. Thanks.
[Attachment #446063](/attachment.cgi?id=446063&action=edit "fix") -
Attachment is obsolete: true
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: review?(dbaron)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=559241#c16)• 15 years ago |
|  | |

Comment on [attachment 446084](/attachment.cgi?id=446084 "fix v2") [[details]](/attachment.cgi?id=446084&action=edit "fix v2") [[diff]](/attachment.cgi?id=446084&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446084)
fix v2
r=dbaron
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: review?(dbaron) → review+

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a3017492_5038)• 15 years ago |

Whiteboard: [sg:critical][critsmash:investigating][needs review] → [sg:critical][critsmash:investigating][needs landing]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=559241#c17)• 15 years ago |
|  | |

Blocking 1.9.3 final as it's an sg:crit.blocking2.0: --- → final+

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=559241#c18)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/a55765a1c2f5>Status: NEW → RESOLVEDClosed: 15 years agoFlags: in-testsuite?Resolution: --- → FIXEDWhiteboard: [sg:critical][critsmash:investigating][needs landing] → [sg:critical][critsmash:investigating]

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=559241#c19)• 15 years ago |
|  | |

This patch fixed one assertion, on layout/generic/crashtests/514800-1.html.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=559241#c20)• 15 years ago |
|  | |

The assertion on that test was:
###!!! ASSERTION: StealFrame: can't find aChild: 'removed', file /builds/slave/mozilla-central-linux-debug/build/layout/generic/nsContainerFrame.cpp, line 1043

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a3174192_269330)• 15 years ago |

Whiteboard: [sg:critical][critsmash:investigating] → [sg:critical][critsmash:resolved]

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=559241#c21)• 15 years ago |
|  | |

Comment on [attachment 446084](/attachment.cgi?id=446084 "fix v2") [[details]](/attachment.cgi?id=446084&action=edit "fix v2") [[diff]](/attachment.cgi?id=446084&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446084)
fix v2
The patch applies cleanly to 1.9.0/1/2 branches.
I think we need it there.
The testcase in [bug 537631](/show_bug.cgi?id=537631 "VERIFIED WORKSFORME - \"ASSERTION: reflow roots should never split\" with -moz-column, fixed&abs pos") crashes on 1.9.0 in a way that looks exploitable (the patch fixes it).
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.2.5?
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.1.11?
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.0.next?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a3244766_5168)• 15 years ago |

Blocks: [537631](/show_bug.cgi?id=537631 "VERIFIED WORKSFORME - \"ASSERTION: reflow roots should never split\" with -moz-column, fixed&abs pos")

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a5088827_482154)• 15 years ago |

blocking1.9.2: --- → .6+
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=559241#c22)• 15 years ago |
|  | |

Comment on [attachment 446084](/attachment.cgi?id=446084 "fix v2") [[details]](/attachment.cgi?id=446084&action=edit "fix v2") [[diff]](/attachment.cgi?id=446084&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=559241&attachment=446084)
fix v2
a=LegNeato for 1.9.2.6 and 1.9.1.11. Please land this on mozilla-1.9.2 default and mozilla-1.9.1 default.
Also approving for 1.9.0, though you don't really need to check it in there as we won't be doing an update off that branch.
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.2.6+
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.2.5?
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.1.11?
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.1.11+
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.0.next?
[Attachment #446084](/attachment.cgi?id=446084&action=edit "fix v2") -
Flags: approval1.9.0.next+

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=559241#c23)• 15 years ago |
|  | |

1.9.1: a1e407b24260
1.9.2: 781a027428c7
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Smokey Ardisson (offline for a while; not following bugs - do not email)](/user_profile?user_id=155027) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=559241#c24)• 15 years ago |
|  | |

(In reply to [comment #22](/show_bug.cgi?id=559241#c22 "RESOLVED FIXED - ###!!! ASSERTION: this type of frame can't have overflow containers"))
> Also approving for 1.9.0, though you don't really need to check it in there as
> we won't be doing an update off that branch.
roc, would you mind if I checked this in for you on 1.9.0, given [comment 21](/show_bug.cgi?id=559241#c21 "RESOLVED FIXED - ###!!! ASSERTION: this type of frame can't have overflow containers") and that the patch already has approval for 1.9.0.next?

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=559241#c25)• 15 years ago |
|  | |

Please do!

|  | [Smokey Ardisson (offline for a while; not following bugs - do not email)](/user_profile?user_id=155027) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=559241#c26)• 15 years ago |
|  | |

Checking in layout/generic/nsColumnSetFrame.cpp;
/cvsroot/mozilla/layout/generic/nsColumnSetFrame.cpp,v <-- nsColumnSetFrame.cpp
new revision: 3.56; previous revision: 3.55
done
Checking in layout/generic/nsContainerFrame.cpp;
/cvsroot/mozilla/layout/generic/nsContainerFrame.cpp,v <-- nsContainerFrame.cpp
new revision: 1.317; previous revision: 1.316
done
Thanks!Keywords: [fixed1.9.0.20](/buglist.cgi?keywords=fixed1.9.0.20&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=559241#a10258845_1689)• 14 years ago |

Group: core-security

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=559241#c27)• 12 years ago |
|  | |

(test added in [bug 537631](/show_bug.cgi?id=537631 "VERIFIED WORKSFORME - \"ASSERTION: reflow roots should never split\" with -moz-column, fixed&abs pos"))Flags: in-testsuite? → in-testsuite+
You need to [log in](/show_bug.cgi?id=559241&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Mats Palmgren (inactive)](/user_profile?user_id=5168)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_e1adf63a_20250125_071707.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/529087)
* [XML](/show_bug.cgi?ctype=xml&id=529087)

Closed
[Bug 529087](/show_bug.cgi?id=529087)

Opened 15 years ago
Closed 15 years ago

# Crash [@ nsXBLBinding::AllowScripts]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ nsXBLBinding::AllowScripts]

## Categories

### (Core :: XBL, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XBL#XBL)

XBL
▾

Core :: XBL
The Extensible Binding Language, used to bind new behavior and new content to XUL and HTML elements.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XBL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XBL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XBL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [beta1+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=beta1%2B) |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [.11+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.11%2B) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | beta1+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | .11+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: MatsPalmgren\_bugz, Assigned: sicking)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/12de552ffa2a81f8a03733071b70caaa?d=mm&size=40)  [sicking](/user_profile?user_id=9186)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5e699d95460c943a64c4ce3e96ff24fe?d=mm&size=40)  [bgrins](/user_profile?user_id=476442)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[570880](/show_bug.cgi?id=570880 "RESOLVED DUPLICATE - Firefox 3.6.4 Crash Report [@ nsXBLBinding::AllowScripts() ]")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, Whiteboard: [sg:critical?][ccbr][critsmash:patch] [qa-needs-str])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?][ccbr][critsmash:patch] [qa-needs-str]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsXBLBinding::AllowScripts ]](https://crash-stats.mozilla.org/signature/?signature=nsXBLBinding%3A%3AAllowScripts)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Patch to fix](/attachment.cgi?id=441671)  [15 years ago](#c5)  [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)   1.92 KB, patch | smaug : [review+](#c9 "15 years ago")  dveditz : [approval1.9.2.7+](#c0 "15 years ago")  dveditz : [approval1.9.1.11+](#c21 "15 years ago") | [Details](/attachment.cgi?id=441671&action=edit) | [Diff](/attachment.cgi?id=441671&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=529087&attachment=441671) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=529087#c0)• 15 years ago |
|  | |

It's ranked #276 in the 3.5.5 (past 7 days) top crash list:
<http://crash-stats.mozilla.com/topcrasher/byversion/Firefox/3.5.5/7>
with 389 crashes, 380 on Win, 9 on OSX.
stack:
nsXBLBinding::AllowScripts content/xbl/src/nsXBLBinding.cpp:1380
nsXBLBinding::ExecuteAttachedHandler content/xbl/src/nsXBLBinding.cpp:977
nsXBLBinding::ExecuteAttachedHandler content/xbl/src/nsXBLBinding.cpp:975
nsRunnableMethod<nsFileUploadContentStream>::Run xpcom/nsThreadUtils.h:278
nsContentUtils::RemoveScriptBlocker content/base/src/nsContentUtils.cpp:4344
PresShell::DoFlushPendingNotifications layout/base/nsPresShell.cpp:4842
PresShell::FlushPendingNotifications layout/base/nsPresShell.cpp:4798
nsDocument::FlushPendingNotifications content/base/src/nsDocument.cpp:6375
nsQueryReferent::operator nsWeakReference.cpp:88
nsComputedDOMStyle::GetPropertyCSSValue layout/style/nsComputedDOMStyle.cpp:349
xul.dll@0x8c4807
There are also 2 crashes on trunk within the past week, so it appears
the bug hasn't been fixed yet.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=529087#c1)• 15 years ago |
|  | |

Line 1380 is:
1380 nsIDocument\* doc = mBoundElement->GetOwnerDoc();
right?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=529087#c2)• 15 years ago |
|  | |

Yes.
This crash might be what [bug 307562](/show_bug.cgi?id=307562 "RESOLVED INCOMPLETE - Crash [@ nsXBLBinding::AllowScripts]") was about?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=529087#c3)• 15 years ago |
|  | |

Hmm. mBoundElement is a weak ref, and is never unset, as far as I can tell. How's that supposed to work?Group: core-security

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a7607143_9186)• 15 years ago |

blocking2.0: --- → beta1

|  | [Brandon Sterne (:bsterne)](/user_profile?user_id=296777) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a8206056_296777)• 15 years ago |

Whiteboard: [sg:critical]

|  | [Brandon Sterne (:bsterne)](/user_profile?user_id=296777) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a8206515_296777)• 15 years ago |

Whiteboard: [sg:critical] → [sg:critical?]

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a9778164_12352)• 15 years ago |

Assignee: nobody → jonas

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a12789961_11608)• 15 years ago |

Whiteboard: [sg:critical?] → [sg:critical?][ccbr]

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=529087#c4)• 15 years ago |
|  | |

Taking this. ETA end of next week.

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=529087#c5)• 15 years ago |
|  | |

Attached patch

[Patch to fix](attachment.cgi?id=441671&action=diff)
— [Details](attachment.cgi?id=441671&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=529087&attachment=441671)

I think this should do it.
Usually we're protected by the fact that nodes are always UnbindFromTree'ed from their document before they die. And unbinding removes any xbl bindings.
However nodes with NODE\_FORCE\_XBL\_BINDINGS set can have xbl bindings without being in a document, and thus can die while still having bindings.
The change in this patch to nsNodeUtils takes care of this. This should ensure that mBoundElement never becomes dangling. This should be enough to take care of the security issues here.
However we also need to deal with that we can get a null mBoundElement while running nested constructors. Otherwise we would crash with a nullpointer deref and still have the topcrash reported in [comment 0](/show_bug.cgi?id=529087#c0 "RESOLVED FIXED - Crash [@ nsXBLBinding::AllowScripts]"). The change to nsXBLBinding should take care of that.
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: review?(bzbarsky)

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=529087#c6)• 15 years ago |
|  | |

I think I can come up with tests for this. Asking for review in the meantime though.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a13928233_39966)• 15 years ago |

[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Attachment is patch: true
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Attachment mime type: application/octet-stream → text/plain

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a13997534_269330)• 15 years ago |

Whiteboard: [sg:critical?][ccbr] → [sg:critical?][ccbr][critsmash:patch]

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a14604916_9186)• 15 years ago |

[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: review?(bzbarsky) → review?(Olli.Pettay)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=529087#c7)• 15 years ago |
|  | |

Olli, can you review this security bug fix?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=529087#c8)• 15 years ago |
|  | |

Yes, I will later this week. Sorry for the delay.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=529087#c9)• 15 years ago |
|  | |

Comment on [attachment 441671](/attachment.cgi?id=441671 "Patch to fix") [[details]](/attachment.cgi?id=441671&action=edit "Patch to fix") [[diff]](/attachment.cgi?id=441671&action=diff "Patch to fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=529087&attachment=441671)
Patch to fix
Ok, makes sense.
Though, if BindingManager() may return null, we should rename it to GetBindingManager().
In theory it may return null, but I think we need to change ownership back to what it used to be (so that we can have strong parent pointer - which is a different bug.).
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: review?(Olli.Pettay) → review+

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=529087#c10)• 15 years ago |
|  | |

I think it can only return null during cycle collection. But yes, ideally we should improve the situation there.

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=529087#c11)• 15 years ago |
|  | |

Can we get this landed?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=529087#c12)• 15 years ago |
|  | |

Security bugs need also sr.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a15854433_39966)• 15 years ago |

[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: superreview?(peterv)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=529087#c13)• 15 years ago |
|  | |

Comment on [attachment 441671](/attachment.cgi?id=441671 "Patch to fix") [[details]](/attachment.cgi?id=441671&action=edit "Patch to fix") [[diff]](/attachment.cgi?id=441671&action=diff "Patch to fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=529087&attachment=441671)
Patch to fix
Or if peterv is away for some time, perhaps jst could sr.
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: superreview?(peterv) → superreview?(jst)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=529087#c14)• 15 years ago |
|  | |

> Security bugs need also sr.
Not anymore. That rule was removed from the policy.
<http://www.mozilla.org/hacking/reviewers.html>
(the policy change was announced in mozilla.governance)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=529087#c15)• 15 years ago |
|  | |

Comment on [attachment 441671](/attachment.cgi?id=441671 "Patch to fix") [[details]](/attachment.cgi?id=441671&action=edit "Patch to fix") [[diff]](/attachment.cgi?id=441671&action=diff "Patch to fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=529087&attachment=441671)
Patch to fix
Huh, we're changing rules faster than people learn them.
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: superreview?(jst)

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=529087#c16)• 15 years ago |
|  | |

Can we land this?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=529087#c17)• 15 years ago |
|  | |

Checked in. Thanks for the review!
<http://hg.mozilla.org/mozilla-central/rev/60fda31d4012>blocking1.9.1: --- → ?blocking1.9.2: --- → ?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a16510959_9186)• 15 years ago |

[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: approval1.9.2.5?
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: approval1.9.1.11?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=529087#c18)• 15 years ago |
|  | |

Hrm.. also checked in bustage fix due to merge.
<http://hg.mozilla.org/mozilla-central/rev/adf3e43ffdd9>

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=529087#c19)• 15 years ago |
|  | |

This should be marked fixed now, no?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=529087#c20)• 15 years ago |
|  | |

Indeed! Somehow missed that in all the flag-setting.Status: NEW → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a17098124_1689)• 15 years ago |

blocking1.9.1: ? → .11+blocking1.9.2: ? → .5+
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=529087#c21)• 15 years ago |
|  | |

Comment on [attachment 441671](/attachment.cgi?id=441671 "Patch to fix") [[details]](/attachment.cgi?id=441671&action=edit "Patch to fix") [[diff]](/attachment.cgi?id=441671&action=diff "Patch to fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=529087&attachment=441671)
Patch to fix
Approved for 1.9.2.5 and 1.9.1.11, a=dveditz for release-drivers
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: approval1.9.2.5?
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: approval1.9.2.5+
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: approval1.9.1.11?
[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: approval1.9.1.11+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a17923430_1689)• 15 years ago |

blocking1.9.2: .5+ → .6+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a17924674_1689)• 15 years ago |

[Attachment #441671](/attachment.cgi?id=441671&action=edit "Patch to fix") -
Flags: approval1.9.2.5+ → approval1.9.2.6+

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=529087#c23)• 15 years ago |
|  | |

Fixed on 1.9.2 and 1.9.1
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/446e17503f87>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/15dccae78d7e>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=529087#c24)• 15 years ago |
|  | |

Are there STR that can be used for verification of this fix on 1.9.1 and 1.9.2?Whiteboard: [sg:critical?][ccbr][critsmash:patch] → [sg:critical?][ccbr][critsmash:patch] [qa-needs-str]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=529087#c25)• 15 years ago |
|  | |

Jonas? Mats? Any reply?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a27233180_1689)• 14 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=529087#a49581790_1)• 14 years ago |

Crash Signature: [@ nsXBLBinding::AllowScripts]
You need to [log in](/show_bug.cgi?id=529087&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_c5effb9a_20250125_071715.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/561539)
* [XML](/show_bug.cgi?ctype=xml&id=561539)

Closed
[Bug 561539](/show_bug.cgi?id=561539)

Opened 15 years ago
Closed 15 years ago

# "Assertion failure: isQName(), at ../jsobjinlines.h" or "Assertion failure: obj->getClass() == &js\_NamespaceClass.base || IsQNameClass(obj->getClass()), at ../jsxml.cpp" with e4x

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"Assertion failure: isQName(), at ../jsobjinlines.h" or "Assertion failure: obj->getClass() == &js\_NamespaceClass.base || IsQNameClass(obj->getClass()), at ../jsxml.cpp" with e4x

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [.11+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.11%2B) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | .11+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: igor)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/78556976aa7c7e7980d6865f27df11b8?d=mm&size=40)  [igor](/user_profile?user_id=50763)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS")

Dependency [tree](/showdependencytree.cgi?id=561539&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=561539)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: fixed-in-tracemonkey, [sg:critical][critsmash:resolved])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[fixed1.9.1.1](/buglist.cgi?keywords=fixed1.9.1.1&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

fixed-in-tracemonkey, [sg:critical][critsmash:resolved]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [decoder](/user_profile?user_id=395101) | [in-testsuite](#a91530243_395101 "12 years ago") | - |
| --- | --- | --- |
| [decoder](/user_profile?user_id=395101) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [fix for 192](/attachment.cgi?id=442062)  [15 years ago](#c9)  [Igor Bukanov](/user_profile?user_id=50763)   1.53 KB, patch |  | [Details](/attachment.cgi?id=442062&action=edit) | [Diff](/attachment.cgi?id=442062&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=561539&attachment=442062) |
| --- | --- | --- |
| [fix for 192 for real](/attachment.cgi?id=442063)  [15 years ago](#c10)  [Igor Bukanov](/user_profile?user_id=50763)   651 bytes, patch | brendan : [review+](#a363784_1214 "15 years ago")  dveditz : [approval1.9.2.7+](#c0 "15 years ago")  dveditz : [approval1.9.1.11+](#c13 "15 years ago")  dveditz : [approval1.9.0.next+](#c16 "15 years ago") | [Details](/attachment.cgi?id=442063&action=edit) | [Diff](/attachment.cgi?id=442063&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=561539&attachment=442063) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=561539#c0)• 15 years ago |
|  | |

gczeal(1)
x = <x>></x>
print(x..x)
asserts js debug shell on TM tip without -j at Assertion failure: isQName(), at ../jsobjinlines.h:333
Tested on 64-bit Mac 10.6.3. Setting s-s because this involves gczeal.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=561539#c1)• 15 years ago |
|  | |

This also asserts in 32-bit shells.
Another assert message can be Assertion failure: obj->getClass() == &js\_NamespaceClass.base || IsQNameClass(obj->getClass()), at ../jsxml.cpp:161
autoBisect shows this is probably related to [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS"):
The first bad revision is:
changeset: 41143:2d3e3a6cfba3
user: Igor Bukanov
date: Sat Apr 24 00:15:42 2010 +0200
summary: [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS") - remove GC\_LAST\_DITCH and GC\_KEEP\_ATOMS. r=jorendorffBlocks: [560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS")Summary: "Assertion failure: isQName(), at ../jsobjinlines.h" with e4x → "Assertion failure: isQName(), at ../jsobjinlines.h" or "Assertion failure: obj->getClass() == &js\_NamespaceClass.base || IsQNameClass(obj->getClass()), at ../jsxml.cpp" with e4x

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=561539#c2)• 15 years ago |
|  | |

This bug is sort-of regression from the [bug 366975](/show_bug.cgi?id=366975 "RESOLVED FIXED - js_NewGCThing asserts !flbase[flindex] because it assumes GC stays locked across last-ditch GC"). That bug introduced a protection against wiping out weak roots in the last ditch GC when the END\_GC callback allocates new GC things. But that was incomplete fix as in the patch I forgot to restore the weak roots back to the saved values. This was harmless as the browser callback does not allocate XML things.
The [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS") has started to use that functionality (now expressed in the form of AutoSaveWeakRoots class) on any path involving the last ditch GC. As such the last ditch GC would wipe out all weak roots after marking a copy. Thus a sequence that was safe previously like allocating XML thing and a string would be no longer a safe one.

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=561539#c3)• 15 years ago |
|  | |

I have landed the fix for the bug as a followup for the [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS"). But the rooting problem theoretically could exists on branches even if that is very unlikely. So we should fix this there using a trivial one-line of changes patch.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=561539#c4)• 15 years ago |
|  | |

(In reply to [comment #3](/show_bug.cgi?id=561539#c3 "RESOLVED FIXED - \"Assertion failure: isQName(), at ../jsobjinlines.h\" or \"Assertion failure: obj->getClass() == &js_NamespaceClass.base || IsQNameClass(obj->getClass()), at ../jsxml.cpp\" with e4x"))
> I have landed the fix for the bug as a followup for the [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS"). But the
> rooting problem theoretically could exists on branches even if that is very
> unlikely. So we should fix this there using a trivial one-line of changes
> patch.
Landed on TM by Igor.
<http://hg.mozilla.org/tracemonkey/rev/8e1084fb0cff>
Setting branch flags for nomination...blocking1.9.1: --- → ?blocking1.9.2: --- → ?Whiteboard: fixed-in-tracemonkey

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=561539#c5)• 15 years ago |
|  | |

Can we get a roll-up patch either here on on [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS") and both bugs nominated if we think we need them on the branches? Thanks!

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=561539#c6)• 15 years ago |
|  | |

[Bug 560358](/show_bug.cgi?id=560358 "RESOLVED FIXED - TM: cx->regExpStatics saving/restore a major bottleneck for string-unpack-code") uses "Preserve" as the single verb for what this bug's patch calls "SaveRestore". rs=me on renaming s/SaveRestore/Preserve/g.
/be

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a298970_180188)• 15 years ago |

Assignee: general → brendan

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a299076_180188)• 15 years ago |

Whiteboard: fixed-in-tracemonkey → fixed-in-tracemonkey, [sg:critical]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a300903_269330)• 15 years ago |

Whiteboard: fixed-in-tracemonkey, [sg:critical] → fixed-in-tracemonkey, [sg:critical][critsmash:patch]

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=561539#c7)• 15 years ago |
|  | |

Sayrer, this is Igor's [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS"), or a dup of it.
/beAssignee: brendan → igor

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=561539#c8)• 15 years ago |
|  | |

I have not made this bug a dup of the [bug 560471](/show_bug.cgi?id=560471 "RESOLVED FIXED - remove GC_LAST_DITCH and GC_KEEP_ATOMS") since branches would need different one-liner patch.

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=561539#c9)• 15 years ago |
|  | |

Attached patch

[fix for 192](attachment.cgi?id=442062&action=diff) (obsolete)
— [Details](attachment.cgi?id=442062&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=561539&attachment=442062)

[Attachment #442062](/attachment.cgi?id=442062&action=edit "fix for 192") -
Flags: review?(brendan)

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=561539#c10)• 15 years ago |
|  | |

Attached patch

[fix for 192 for real](attachment.cgi?id=442063&action=diff)
— [Details](attachment.cgi?id=442063&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=561539&attachment=442063)

The previous patch includes unrelated changes
[Attachment #442062](/attachment.cgi?id=442062&action=edit "fix for 192") -
Attachment is obsolete: true
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: review?(brendan)
[Attachment #442062](/attachment.cgi?id=442062&action=edit "fix for 192") -
Flags: review?(brendan)

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=561539#c11)• 15 years ago |
|  | |

<http://hg.mozilla.org/tracemonkey/rev/22928ec2f2d9> - renaming AutoSaveRestoreWealRoots into AutoPreserveWeakRoots

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a363784_1214)• 15 years ago |

[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: review?(brendan) → review+

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a365037_50763)• 15 years ago |

[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.2.5?
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.1.11?
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.0.19?

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a383535_137548)• 15 years ago |

blocking1.9.1: ? → .11+blocking1.9.2: ? → .5+

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=561539#c12)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/22928ec2f2d9>Status: NEW → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a2053975_1689)• 15 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a2053994_1689)• 15 years ago |

[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.0.19? → approval1.9.0.next?

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a2281895_269330)• 15 years ago |

Whiteboard: fixed-in-tracemonkey, [sg:critical][critsmash:patch] → fixed-in-tracemonkey, [sg:critical][critsmash:resolved]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=561539#c13)• 15 years ago |
|  | |

Comment on [attachment 442063](/attachment.cgi?id=442063 "fix for 192 for real") [[details]](/attachment.cgi?id=442063&action=edit "fix for 192 for real") [[diff]](/attachment.cgi?id=442063&action=diff "fix for 192 for real") [[review]](/page.cgi?id=splinter.html&ignore=&bug=561539&attachment=442063)
fix for 192 for real
Approved for 1.9.2.5 and 1.9.1.11, a=dveditz for release-drivers
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.2.5?
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.2.5+
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.1.11?
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.1.11+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a4225706_1689)• 15 years ago |

blocking1.9.2: .5+ → .6+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a4226975_1689)• 15 years ago |

[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.2.5+ → approval1.9.2.6+

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=561539#c14)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/90658753b7da>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/f4310a06ef2c>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)Keywords: [fixed1.9.1.1](/buglist.cgi?keywords=fixed1.9.1.1&resolution=---)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=561539#c15)• 15 years ago |
|  | |

Gary: can i use this testcase somehow in a Debug Build to verify this fix in 1.9.2/1.9.1 ?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=561539#c16)• 15 years ago |
|  | |

Comment on [attachment 442063](/attachment.cgi?id=442063 "fix for 192 for real") [[details]](/attachment.cgi?id=442063&action=edit "fix for 192 for real") [[diff]](/attachment.cgi?id=442063&action=diff "fix for 192 for real") [[review]](/page.cgi?id=splinter.html&ignore=&bug=561539&attachment=442063)
fix for 192 for real
Approved for 1.9.0.20, a=dveditz
[Attachment #442063](/attachment.cgi?id=442063&action=edit "fix for 192 for real") -
Flags: approval1.9.0.next? → approval1.9.0.next+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a9366281_1689)• 14 years ago |

Group: core-security

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=561539#a91530243_395101)• 12 years ago |

Flags: in-testsuite-
You need to [log in](/show_bug.cgi?id=561539&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Igor Bukanov](/user_profile?user_id=50763)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_57c9b636_20250125_071717.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/564705)
* [XML](/show_bug.cgi?ctype=xml&id=564705)

Closed
[Bug 564705](/show_bug.cgi?id=564705)

Opened 15 years ago
Closed 15 years ago

# String buffer underflow and crash [@ nsTextBoxFrame::UpdateAccessTitle]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

String buffer underflow and crash [@ nsTextBoxFrame::UpdateAccessTitle]

## Categories

### (Core :: XUL, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XUL#XUL)

XUL
▾

Core :: XUL

For bugs in the [XUL
language](http://www.mozilla.org/xpfe/xptoolkit/xulintro.html). (XUL is an XML-based language which specifies Mozilla's user interface.)

If you're not actually writing XUL code, this is probably not the right place for your bug.

Examples of appropriate bugs: Duplicate window ID causes infinite loop; or Scrollbars disappear after loading XUL document

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XUL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XUL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XUL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| status1.9.2 |  | .7-fixed |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: tnikkel)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0646a42110a02dd585f200f270716852?d=mm&size=40)  [tnikkel](/user_profile?user_id=255010)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[344486](/show_bug.cgi?id=344486 "RESOLVED FIXED - [meta] XUL Element and Attribute fuzzer"), [407584](/show_bug.cgi?id=407584 "RESOLVED FIXED - The auto appending accesskey is in wrong position when an ellipsis exists at non-tail of the caption")

Dependency [tree](/showdependencytree.cgi?id=564705&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=564705)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:low UMR])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:low UMR]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [tnikkel](/user_profile?user_id=255010) | [in-testsuite](#c9 "15 years ago") | + |
| --- | --- | --- |
| [tnikkel](/user_profile?user_id=255010) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsTextBoxFrame::UpdateAccessTitle ]](https://crash-stats.mozilla.org/signature/?signature=nsTextBoxFrame%3A%3AUpdateAccessTitle)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [testcase (may crash Firefox when loaded)](/attachment.cgi?id=444324)  [15 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   222 bytes, application/vnd.mozilla.xul+xml |  | [Details](/attachment.cgi?id=444324&action=edit) |
| --- | --- | --- |
| [patch](/attachment.cgi?id=444469)  [15 years ago](#c2)  [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)   971 bytes, patch | neil : [review+](#a91289_14006 "15 years ago")  dveditz : [approval1.9.2.7+](#c0 "15 years ago")  dveditz : [approval1.9.1.11+](#a2853869_1689 "15 years ago") | [Details](/attachment.cgi?id=444469&action=edit) | [Diff](/attachment.cgi?id=444469&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=564705&attachment=444469) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=564705#c0)• 15 years ago |
|  | |

Attached file
[testcase (may crash Firefox when loaded)](attachment.cgi?id=444324)
— [Details](attachment.cgi?id=444324&action=edit)

nsTextBoxFrame::UpdateAccessTitle tried to subtract 1 from 0 and got 2^32-1.
###!!! ASSERTION: index exceeds allowable range: 'i <= mLength', file nsTString.h, line 129
At least on a 64-bit system, a crash immediately follows the assertion.
#5 0x00007f9f2e7b9422 in nsString::CharAt (this=0x7f9f13b78ac8, i=4294967295) at ../../../dist/include/nsTString.h:130
#6 0x00007f9f2e7b9448 in nsString::operator[] (this=0x7f9f13b78ac8, i=4294967295) at ../../../dist/include/nsTString.h:135
#7 0x00007f9f2ec81bcd in nsTextBoxFrame::UpdateAccessTitle (this=0x7f9f13b78a78) at layout/xul/base/src/nsTextBoxFrame.cpp:878
#8 0x00007f9f2ec7fc9e in nsTextBoxFrame::UpdateAccesskey (this=0x7f9f13b78a78, aWeakThis=...)
at layout/xul/base/src/nsTextBoxFrame.cpp:264
#9 0x00007f9f2ec82b13 in nsAsyncAccesskeyUpdate::ReflowFinished (this=0x7f9f13b91060) at layout/xul/base/src/nsTextBoxFrame.cpp:224

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=564705#c1)• 15 years ago |
|  | |

Reported on 64-bit Linux. I can't reproduce even the assertion on 32-bit Mac.

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=564705#c2)• 15 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=444469&action=diff)
— [Details](attachment.cgi?id=444469&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=564705&attachment=444469)

The title consists of only the ellipsis, so the offset is zero, and we check the character before to see if it is a space. If we are at the start then we don't want to insert a separating space.Assignee: nobody → tnikkel
[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: review?(neil)

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=564705#a91289_14006)• 15 years ago |

[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: review?(neil) → review+

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=564705#c3)• 15 years ago |
|  | |

Landed
<http://hg.mozilla.org/mozilla-central/rev/e40cbab6a972>
but backed out because something in the push was causing orange
<http://hg.mozilla.org/mozilla-central/rev/01befa5163ee>

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=564705#c4)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/f0c737a853ac>Status: NEW → RESOLVEDClosed: 15 years agoFlags: in-testsuite?Resolution: --- → FIXED

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=564705#a348142_255010)• 15 years ago |

[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: approval1.9.2.5?
[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: approval1.9.1.11?

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=564705#a348365_255010)• 15 years ago |

Blocks: [407584](/show_bug.cgi?id=407584 "RESOLVED FIXED - The auto appending accesskey is in wrong position when an ellipsis exists at non-tail of the caption")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=564705#a2853869_1689)• 15 years ago |

[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: approval1.9.2.5?
[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: approval1.9.2.5+
[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: approval1.9.1.11?
[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: approval1.9.1.11+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=564705#c5)• 15 years ago |
|  | |

Comment on [attachment 444469](/attachment.cgi?id=444469 "patch") [[details]](/attachment.cgi?id=444469&action=edit "patch") [[diff]](/attachment.cgi?id=444469&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=564705&attachment=444469)
patch
Approved for 1.9.2.6 and 1.9.1.11, a=dveditz for release-drivers

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=564705#c6)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/9b99125fac02>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=564705#c7)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/e99ea6fb56e7>
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=564705#a3445336_1689)• 15 years ago |

[Attachment #444469](/attachment.cgi?id=444469&action=edit "patch") -
Flags: approval1.9.2.5+ → approval1.9.2.6+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=564705#c8)• 15 years ago |
|  | |

Verified for 1.9.2 on 64-bit Ubuntu 10.4 with Mozilla/5.0 (X11; U; Linux x86\_64; en-US; rv:1.9.2.6pre) Gecko/20100622 Namoroka/3.6.6pre. Crashes the 1.9.2.4 release with attached testcase.Keywords: [verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=564705#a12193367_1689)• 14 years ago |

Group: core-security

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=564705#c9)• 14 years ago |
|  | |

Added crashtest
<http://hg.mozilla.org/mozilla-central/rev/ec7b4a08a04e>Flags: in-testsuite? → in-testsuite+

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=564705#a34542015_1)• 14 years ago |

Crash Signature: [@ nsTextBoxFrame::UpdateAccessTitle]
You need to [log in](/show_bug.cgi?id=564705&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_652798aa_20250126_070900.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

## Related documentation

* [Searching for bugs](https://bmo.readthedocs.io/en/latest/query.html)
* [Bug lists](https://bmo.readthedocs.io/en/latest/query.html#list)
# Parameters Required

| You may not search, or create saved searches, without any search terms. |
| --- |

Please press **Back** and try again.



=== Content from bugzilla.mozilla.org_6267e3e8_20250125_071705.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/528644)
* [XML](/show_bug.cgi?ctype=xml&id=528644)

Closed
[Bug 528644](/show_bug.cgi?id=528644)

Opened 15 years ago
Closed 15 years ago

# Crash [@ js\_GetUpvar]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ js\_GetUpvar]

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [-](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=-) |
| blocking1.9.2 | --- | [needed](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=needed) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [needed](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=needed) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | - |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | needed |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: dmandelin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/a86fae4b06c1570a6c1a1bc1c5a6c1f6?d=mm&size=40)  [dmandelin](/user_profile?user_id=294323)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[488034](/show_bug.cgi?id=488034 "VERIFIED FIXED - Crash [@ js_GetUpvar] or \"Assertion failure: (script)->upvarsOffset != 0, at ../jsinterp.cpp\"")

Dependency [tree](/showdependencytree.cgi?id=528644&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=528644)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [sg:critical][ccbr][3.6.x]fixed-in-tracemonkey [rc-ridealong])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---),
[verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical][ccbr][3.6.x]fixed-in-tracemonkey [rc-ridealong]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [sayrer](/user_profile?user_id=180188) | [blocking1.9.2](#a491436_180188 "15 years ago") | - |
| --- | --- | --- |
| [sayrer](/user_profile?user_id=180188) | blocking1.9.2 | - |
| --- | --- | --- |
| [sayrer](/user_profile?user_id=180188) | [wanted1.9.2](#a491436_180188 "15 years ago") | + |
| --- | --- | --- |
| [sayrer](/user_profile?user_id=180188) | wanted1.9.2 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [wanted1.9.0.x](#a1639317_1689 "15 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | wanted1.9.0.x | - |
| --- | --- | --- |
| [jruderman](/user_profile?user_id=11608) | [in-testsuite](#a27486447_11608 "14 years ago") | + |
| --- | --- | --- |
| [jruderman](/user_profile?user_id=11608) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ js\_GetUpvar ]](https://crash-stats.mozilla.org/signature/?signature=js_GetUpvar)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Patch](/attachment.cgi?id=420408)  [15 years ago](#c5)  [David Mandelin [:dmandelin]](/user_profile?user_id=294323)   1.50 KB, patch | mrbkap : [review+](#a4659933_69426 "15 years ago")  christian : [approval1.9.2.7+](#c0 "15 years ago")  christian : [approval1.9.1.11+](#c10 "15 years ago") | [Details](/attachment.cgi?id=420408&action=edit) | [Diff](/attachment.cgi?id=420408&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=528644&attachment=420408) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=528644#c0)• 15 years ago |
|  | |

function g(foo) {
for (a in foo) function() {}
}
(g((eval("\
function() {\
for each(b in [0]) {\
\_\_defineGetter\_\_(\"x\", \
function(b) \
eval(\"new function() { yield print(b) }\" ) \
)\
} \
return x\
}\
"))()))()
crashes js debug and opt shell at js\_GetUpvar near null on TM tip on 10.5.8.
autoBisect shows this is probably related to [bug 488034](/show_bug.cgi?id=488034 "VERIFIED FIXED - Crash [@ js_GetUpvar] or \"Assertion failure: (script)->upvarsOffset != 0, at ../jsinterp.cpp\""):
The first bad revision is:
changeset: 27186:70111870bcf8
user: Brendan Eich
date: Mon Apr 13 14:16:15 2009 -0700
summary: [Bug 488034](/show_bug.cgi?id=488034 "VERIFIED FIXED - Crash [@ js_GetUpvar] or \"Assertion failure: (script)->upvarsOffset != 0, at ../jsinterp.cpp\"") - Crash [@ js\_GetUpvar] or "Assertion failure: (script)->upvarsOffset != 0, at ../jsinterp.cpp" (r=mrbkap).
Debug stack:
Exception Type: EXC\_BAD\_ACCESS (SIGBUS)
Exception Codes: KERN\_PROTECTION\_FAILURE at 0x0000000000000018
Crashed Thread: 0
Thread 0 Crashed:
0 js-dbg-tm-darwin 0x00098a46 js\_GetUpvar + 76
1 js-dbg-tm-darwin 0x0008d56c js\_Interpret + 111234
2 js-dbg-tm-darwin 0x0009e9ab \_\_ZL15SendToGeneratorP9JSContext13JSGeneratorOpP8JSObjectP11JSGeneratorl + 561
3 js-dbg-tm-darwin 0x0009ede8 \_\_ZL12generator\_opP9JSContext13JSGeneratorOpPlj + 610
4 js-dbg-tm-darwin 0x0009ee91 \_\_ZL14generator\_nextP9JSContextjPl + 39
5 js-dbg-tm-darwin 0x0009c1bb js\_Invoke + 1503
6 js-dbg-tm-darwin 0x0009cbb3 js\_InternalInvoke + 151
7 js-dbg-tm-darwin 0x0009fa60 js\_CallIteratorNext + 360
8 js-dbg-tm-darwin 0x000773a2 js\_Interpret + 20664
9 js-dbg-tm-darwin 0x0009b81b js\_Execute + 1169
10 js-dbg-tm-darwin 0x000111ba JS\_ExecuteScript + 54
11 js-dbg-tm-darwin 0x00009e5e \_\_ZL7ProcessP9JSContextP8JSObjectPci + 458
12 js-dbg-tm-darwin 0x0000aba0 \_\_ZL11ProcessArgsP9JSContextP8JSObjectPPci + 2272
13 js-dbg-tm-darwin 0x0000af6d main + 953
14 js-dbg-tm-darwin 0x00001d6b \_start + 209
15 js-dbg-tm-darwin 0x00001c99 start + 41Flags: blocking1.9.2?

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=528644#c1)• 15 years ago |
|  | |

(In reply to [comment #0](/show_bug.cgi?id=528644#c0 "VERIFIED FIXED - Crash [@ js_GetUpvar]"))
> crashes js debug and opt shell at js\_GetUpvar near null on TM tip on 10.5.8.
... and occurs without -j.Whiteboard: [ccbr]

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a491436_180188)• 15 years ago |

Flags: wanted1.9.2+Flags: blocking1.9.2?Flags: blocking1.9.2-

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a491448_180188)• 15 years ago |

blocking2.0: --- → ?

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a1628555_180188)• 15 years ago |

Group: core-security

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=528644#c2)• 15 years ago |
|  | |

Nominating blocking1.9.1? since it got turned security-sensitive and affects 1.9.1 branch.blocking1.9.1: --- → ?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a1639317_1689)• 15 years ago |

blocking1.9.1: ? → needed
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)Flags: wanted1.9.0.x-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a1639346_1689)• 15 years ago |

Whiteboard: [ccbr] → [ccbr][3.6.x]

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a1652930_1214)• 15 years ago |

Assignee: general → brendanStatus: NEW → ASSIGNEDOS: Mac OS X → AllHardware: x86 → All

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=528644#c3)• 15 years ago |
|  | |

Is this a nearly-null memory read, not exploitable?
/be

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a4480180_294323)• 15 years ago |

Assignee: brendan → dmandelin

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=528644#c4)• 15 years ago |
|  | |

I have the cause of the crash. The crash is in trying to access |b| in |yield print(b)|. This is compiled as a JSOP\_GETUPVAR in a function at static level 5 getting a variable |x| defined at static level 3 (|function (b) ...|). But the function at level 3 has returned by the time we re-enter the function that accesses |b|, so we crash.
It seems that the generator function should not be compiled with JSOP\_GETUPVAR at all, since it escapes. I'll have to dig in to the regressing patch and the closure compiler to figure out the exact cause and solution.

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=528644#c5)• 15 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=420408&action=diff)
— [Details](attachment.cgi?id=420408&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=528644&attachment=420408)

[Attachment #420408](/attachment.cgi?id=420408&action=edit "Patch") -
Flags: review?(mrbkap)

|  | [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a4659933_69426)• 15 years ago |

[Attachment #420408](/attachment.cgi?id=420408&action=edit "Patch") -
Flags: review?(mrbkap) → review+

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=528644#c6)• 15 years ago |
|  | |

<http://hg.mozilla.org/tracemonkey/rev/a578f79c7dd2>Whiteboard: [ccbr][3.6.x] → [ccbr][3.6.x]fixed-in-tracemonkey

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=528644#c7)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/a578f79c7dd2>Status: ASSIGNED → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a5334476_180188)• 15 years ago |

Whiteboard: [ccbr][3.6.x]fixed-in-tracemonkey → [ccbr][3.6.x]fixed-in-tracemonkey [rc-ridealong]

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a6303949_180188)• 15 years ago |

blocking2.0: ? → -

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=528644#c8)• 15 years ago |
|  | |

This "ridealong" got left behind.blocking1.9.2: --- → needed
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)Whiteboard: [ccbr][3.6.x]fixed-in-tracemonkey [rc-ridealong] → [sg:critical][ccbr][3.6.x]fixed-in-tracemonkey [rc-ridealong]

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a19344756_294323)• 15 years ago |

[Attachment #420408](/attachment.cgi?id=420408&action=edit "Patch") -
Flags: approval1.9.2.6?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=528644#c9)• 15 years ago |
|  | |

Comment on [attachment 420408](/attachment.cgi?id=420408 "Patch") [[details]](/attachment.cgi?id=420408&action=edit "Patch") [[diff]](/attachment.cgi?id=420408&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=528644&attachment=420408)
Patch
a=LegNeato for 1.9.2.6
[Attachment #420408](/attachment.cgi?id=420408&action=edit "Patch") -
Flags: approval1.9.2.6? → approval1.9.2.6+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=528644#c10)• 15 years ago |
|  | |

Comment on [attachment 420408](/attachment.cgi?id=420408 "Patch") [[details]](/attachment.cgi?id=420408&action=edit "Patch") [[diff]](/attachment.cgi?id=420408&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=528644&attachment=420408)
Patch
Also approving for 1.9.1.11
[Attachment #420408](/attachment.cgi?id=420408&action=edit "Patch") -
Flags: approval1.9.1.11+

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=528644#c11)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/65e8cc0b9c5c>

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=528644#c12)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/dc2e2f77450e>

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a19351936_294323)• 15 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=528644#c13)• 15 years ago |
|  | |

gary: is there is a way to verify this fix in a debug build ?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=528644#c14)• 15 years ago |
|  | |

Any update on this? Gary?

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=528644#c15)• 15 years ago |
|  | |

(In reply to [comment #14](/show_bug.cgi?id=528644#c14 "VERIFIED FIXED - Crash [@ js_GetUpvar]"))
> Any update on this? Gary?
I no longer crash using TM changeset 7cb520995757 on a 32-bit debug shell. Verified fixed.
Also verified on 1.9.2 changeset df760e6d4ddc and 1.9.1 changeset 2eb0724d74f8Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a27479067_1689)• 14 years ago |

Group: core-security

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a27486447_11608)• 14 years ago |

Flags: in-testsuite+

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=528644#a49827763_1)• 14 years ago |

Crash Signature: [@ js\_GetUpvar]

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=528644#c16)• 13 years ago |
|  | |

Verified per [comment 15](/show_bug.cgi?id=528644#c15 "VERIFIED FIXED - Crash [@ js_GetUpvar]").Status: RESOLVED → VERIFIED
You need to [log in](/show_bug.cgi?id=528644&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [David Mandelin [:dmandelin]](/user_profile?user_id=294323)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_acb0ba28_20250125_071723.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/574750)
* [XML](/show_bug.cgi?ctype=xml&id=574750)

Closed
[Bug 574750](/show_bug.cgi?id=574750)

Opened 15 years ago
Closed 15 years ago

# Code that iterates through nsCSSValue::Arrays should use size\_t for index now

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Code that iterates through nsCSSValue::Arrays should use size\_t for index now

## Categories

### (Core :: CSS Parsing and Computation, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=CSS%20Parsing%20and%20Computation#CSS%20Parsing%20and%20Computation)

CSS Parsing and Computation
▾

Core :: CSS Parsing and Computation

Issues with loading CSS style sheets from the network, parsing style sheets and style attributes in HTML markup, performing the CSS cascade, selector matching, and producing correct computed values for CSS properties.

Example bugs:

* toggling class name on an element does not restyle the element
* background-color property does not support hsl() values

Specifications covered:

* CSS Cascading
* CSS Conditional
* CSS Logical Properties
* CSS Namespaces
* CSS Scoping
* CSS Style Attributes
* CSS Syntax
* CSS Values
* CSS Variables
* Media Queries
* Selectors

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=CSS%20Parsing%20and%20Computation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=CSS%20Parsing%20and%20Computation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=CSS%20Parsing%20and%20Computation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [beta2+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=beta2%2B) |
| blocking1.9.2 | --- | [.7+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.7%2B) |
| status1.9.2 | --- | [.7-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.7-fixed) |
| blocking1.9.1 | --- | [.11+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.11%2B) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | beta2+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .7-fixed |
| blocking1.9.1 |  | .11+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dholbert, Assigned: dholbert)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=40)  [dholbert](/user_profile?user_id=278074)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=40)  [dholbert](/user_profile?user_id=278074)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### ( [URL](http://tinderbox.mozilla.org/showlog.cgi?log=MozillaTry/1277463487.1277467229.18848.gz "http://tinderbox.mozilla.org/showlog.cgi?log=MozillaTry/1277463487.1277467229.18848.gz") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2010-2752](/show_bug.cgi?id=574059 "RESOLVED FIXED - nsCSSValue::Array index integer overflow (can lead to remote code execution via CSS font-face) (ZDI-CAN-831)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=574750&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=574750)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[tinderbox.mozilla.org/showlog.cgi?log...](http://tinderbox.mozilla.org/showlog.cgi?log=MozillaTry/1277463487.1277467229.18848.gz "http://tinderbox.mozilla.org/showlog.cgi?log=MozillaTry/1277463487.1277467229.18848.gz")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [sg:critical?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [fix](/attachment.cgi?id=454105)  [15 years ago](#c1)  [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)   6.13 KB, patch | bzbarsky : [review+](#a2373_20209 "15 years ago") | [Details](/attachment.cgi?id=454105&action=edit) | [Diff](/attachment.cgi?id=454105&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=574750&attachment=454105) |
| --- | --- | --- |
| [fix for 1.9.2 & 1.9.1](/attachment.cgi?id=454109)  [15 years ago](#c6)  [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)   3.57 KB, patch | christian : [approval1.9.2.7+](#c0 "15 years ago")  christian : [approval1.9.1.11+](#c7 "15 years ago") | [Details](/attachment.cgi?id=454109&action=edit) | [Diff](/attachment.cgi?id=454109&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=574750&attachment=454109) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=574750#c0)• 15 years ago |
|  | |

Now that [Bug 574059](/show_bug.cgi?id=574059 "RESOLVED FIXED - nsCSSValue::Array index integer overflow (can lead to remote code execution via CSS font-face) (ZDI-CAN-831)") landed and nsCSSValue::Array::Count() returns a size\_t (instead of PRUint16), we need to do a s/PRUint16/size\_t/ on code that iterates through these arrays, too.
e.g.
278 nsCSSValue::Array \*array = aValue.GetArrayValue();
[...]
330 for (PRUint16 index = 1; index < array->Count(); ++index) {
331 AppendCSSValueToString(aProperty, array->Item(index), aResult);
332
333 /\* If we're not at the final element, append a comma. \*/
334 if (index + 1 != array->Count())
335 aResult.AppendLiteral(", ");
336 }
<http://mxr.mozilla.org/mozilla-central/source/layout/style/nsCSSDeclaration.cpp>

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=574750#c1)• 15 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=454105&action=diff)
— [Details](attachment.cgi?id=454105&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=574750&attachment=454105)

I think this catches all the instances. There are a few that don't matter as much (e.g. in nsStyleAnimation, where we use a PRUint32 as the loop counter, and we're only iterating up to 4), but I figured we might as well fix those too for consistency.Assignee: nobody → dholbertStatus: NEW → ASSIGNED

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=574750#c2)• 15 years ago |
|  | |

(meant to say: haven't compiled with the attached patch yet -- doing that now)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a937_278074)• 15 years ago |

OS: Linux → AllHardware: x86 → All

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=574750#c3)• 15 years ago |
|  | |

Comment on [attachment 454105](/attachment.cgi?id=454105 "fix") [[details]](/attachment.cgi?id=454105&action=edit "fix") [[diff]](/attachment.cgi?id=454105&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=574750&attachment=454105)
fix
This builds fine on my machine. bz, would you mind reviewing this?
[Attachment #454105](/attachment.cgi?id=454105&action=edit "fix") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a2373_20209)• 15 years ago |

[Attachment #454105](/attachment.cgi?id=454105&action=edit "fix") -
Flags: review?(bzbarsky) → review+

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=574750#c4)• 15 years ago |
|  | |

Landed on trunk:
<http://hg.mozilla.org/mozilla-central/rev/619563f026f5>
Requesting blocking1.9.1 & 1.9.2, to avoid complications on those branches from comparing PRUint16 list-counter vs. a size\_t Count() method as a result of [bug 574059](/show_bug.cgi?id=574059 "RESOLVED FIXED - nsCSSValue::Array index integer overflow (can lead to remote code execution via CSS font-face) (ZDI-CAN-831)").Status: ASSIGNED → RESOLVEDblocking1.9.1: --- → ?blocking1.9.2: --- → ?Closed: 15 years agoResolution: --- → FIXED

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=574750#c5)• 15 years ago |
|  | |

Marking as security-sensitive at reed's suggestion, to be on the safe side.Group: core-security

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a3799_159758)• 15 years ago |

blocking2.0: --- → ?

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a3830_159758)• 15 years ago |

Whiteboard: [sg:critical?]

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=574750#c6)• 15 years ago |
|  | |

Attached patch

[fix for 1.9.2 & 1.9.1](attachment.cgi?id=454109&action=diff)
— [Details](attachment.cgi?id=454109&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=574750&attachment=454109)

Here's the fix backported to 1.9.2 -- basically just removes the chunks for CSS calc() and nsStyleAnimation (which are new on m-c since 1.9.2 branched), and fixes contextual code.
This patch applies fine to 1.9.1, too, with fuzz=3 (for minor changes in contextual code).
[Attachment #454109](/attachment.cgi?id=454109&action=edit "fix for 1.9.2 & 1.9.1") -
Flags: approval1.9.2.6?
[Attachment #454109](/attachment.cgi?id=454109&action=edit "fix for 1.9.2 & 1.9.1") -
Flags: approval1.9.1.11?

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a4124_278074)• 15 years ago |

[Attachment #454105](/attachment.cgi?id=454105&action=edit "fix") -
Attachment description: fix? → fix

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a4249_482154)• 15 years ago |

blocking1.9.1: ? → .11+blocking1.9.2: ? → .6+
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=574750#c7)• 15 years ago |
|  | |

Comment on [attachment 454109](/attachment.cgi?id=454109 "fix for 1.9.2 & 1.9.1") [[details]](/attachment.cgi?id=454109&action=edit "fix for 1.9.2 & 1.9.1") [[diff]](/attachment.cgi?id=454109&action=diff "fix for 1.9.2 & 1.9.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=574750&attachment=454109)
fix for 1.9.2 & 1.9.1
a=LegNeato for 1.9.2.6 and 1.9.2.11.
Please submit to mozilla-1.9.2 default and mozilla-1.9.1 default asap, as code freeze is tonight!
[Attachment #454109](/attachment.cgi?id=454109&action=edit "fix for 1.9.2 & 1.9.1") -
Flags: approval1.9.2.6?
[Attachment #454109](/attachment.cgi?id=454109&action=edit "fix for 1.9.2 & 1.9.1") -
Flags: approval1.9.2.6+
[Attachment #454109](/attachment.cgi?id=454109&action=edit "fix for 1.9.2 & 1.9.1") -
Flags: approval1.9.1.11?
[Attachment #454109](/attachment.cgi?id=454109&action=edit "fix for 1.9.2 & 1.9.1") -
Flags: approval1.9.1.11+

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=574750#c8)• 15 years ago |
|  | |

Thanks for the quick turnaround on approval!
I'm going to wait for this to cycle on mozilla-central first, before landing the 1.9.1 / 1.9.2 version.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=574750#c9)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/f2a4c8e82d16>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/025191a13eb7>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.6-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.6-fixed)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a1049005_5038)• 15 years ago |

blocking2.0: ? → beta2+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=574750#c10)• 15 years ago |
|  | |

Is there a means for QA to verify this fix for 1.9.2.7 and 1.9.1.11?

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=574750#c11)• 15 years ago |
|  | |

Only via code inspection (making sure the patch landed).
I noticed the problem via code inspection in the first place -- we never had a testcase (though it's probably possible to make one).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=574750#a8143977_1689)• 14 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=574750&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


