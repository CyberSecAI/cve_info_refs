Based on the provided content, here's a breakdown of the vulnerability described in CVE-2010-1148:

**Root Cause of Vulnerability:**

*   The vulnerability lies in the `cifs_create()` function within the Linux kernel's CIFS (Common Internet File System) implementation.
*   When creating a file on a server supporting Unix extensions (like Samba), the `cifs_create()` function calls `cifs_posix_open()` to handle the creation with POSIX semantics.
*   The `cifs_create()` function does not check if the `nameidata` pointer (`nd`) is valid before passing `nd->path.mnt` to `cifs_posix_open()`. If nameidata is NULL (nd is NULL), this results in a NULL pointer dereference when `cifs_posix_open()` tries to access `nd->path.mnt`

**Weaknesses/Vulnerabilities Present:**

*   **NULL Pointer Dereference:** The primary vulnerability is a NULL pointer dereference. The code attempts to access a member of a structure via a pointer that may be NULL.

**Impact of Exploitation:**

*   **Kernel Crash/Denial of Service:** A NULL pointer dereference in the kernel typically leads to a system crash, resulting in a denial of service.
*   **Potential for Exploitation:** While the immediate impact is a crash, the blog post by xorl.wordpress suggests that there may be potential for more severe exploitation if an attacker can control memory layout and map appropriate pages to avoid the crash.

**Attack Vectors:**

*   **File Creation on CIFS Share:** The attack is triggered by creating a file on a CIFS share that supports Unix extensions (e.g., Samba).
*   **Missing `nameidata`:** The vulnerability is exposed when the file creation does not supply the `nameidata` structure.

**Required Attacker Capabilities/Position:**

*   **Access to CIFS Share:** The attacker needs to have access to a CIFS share on a server that supports Unix extensions.
*   **Ability to Create Files:** The attacker needs the ability to create files on the CIFS share.

**Additional Details:**

*   **Affected Kernel Versions:** Kernel versions from v2.6.29-rc6 onwards are affected by this vulnerability.
*   **Patch:** The fix involves adding a check to ensure that the `nd` pointer is not NULL before dereferencing it:
```c
-	if (tcon->unix_ext && (tcon->ses->capabilities & CAP_UNIX) &&
+	if (nd && tcon->unix_ext && (tcon->ses->capabilities & CAP_UNIX) &&
 	    (CIFS_UNIX_POSIX_PATH_OPS_CAP &
 			le64_to_cpu(tcon->fsUnixInfo.Capability))) {
```
*   **Red Hat's Assessment:**  Red Hat initially marked the bug as "NOTABUG" because it did not affect the versions of the Linux kernel that they shipped with Red Hat Enterprise Linux 3, 4, 5 and Red Hat Enterprise MRG, since those versions did not include support for posix opens on lookup.

This information provides a more comprehensive view of the vulnerability than the placeholder CVE description.