=== Content from www.theregister.co.uk_da02179d_20250124_165904.html ===


[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_extents_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_filled_extents_16x16.png)
Sign in / up](https://account.theregister.com/register/)

[![The Register® — Biting the hand that feeds IT](/design_picker/fa16d26efb42e6ba1052f1d387470f643c5aa18d/graphics/std/reg_logo_no_strapline.png)](https://www.theregister.com/)

[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/magnifying_glass_white_extents_16x16.png)](https://search.theregister.com/)

![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_close_16x16.png)

## Topics

[Security](#subnav-box-nav-security)
## [Security](#subnav-box-nav-security)

[All Security](https://www.theregister.com/security/)[Cyber-crime](https://www.theregister.com/security/cyber_crime/)[Patches](https://www.theregister.com/security/patches/)[Research](https://www.theregister.com/security/research/)[CSO](https://www.theregister.com/security/cso/)
[(X)](#masthead)

[Off-Prem](#subnav-box-nav-off_prem)
## [Off-Prem](#subnav-box-nav-off_prem)

[All Off-Prem](https://www.theregister.com/off_prem/)[Edge + IoT](https://www.theregister.com/off_prem/edge_iot/)[Channel](https://www.theregister.com/off_prem/channel/)[PaaS + IaaS](https://www.theregister.com/off_prem/paas_iaas/)[SaaS](https://www.theregister.com/off_prem/saas/)
[(X)](#masthead)

[On-Prem](#subnav-box-nav-on_prem)
## [On-Prem](#subnav-box-nav-on_prem)

[All On-Prem](https://www.theregister.com/on_prem/)[Systems](https://www.theregister.com/on_prem/systems/)[Storage](https://www.theregister.com/on_prem/storage/)[Networks](https://www.theregister.com/on_prem/networks/)[HPC](https://www.theregister.com/on_prem/hpc/)[Personal Tech](https://www.theregister.com/on_prem/personal_tech/)[CxO](https://www.theregister.com/on_prem/cxo/)[Public Sector](https://www.theregister.com/on_prem/public_sector/)
[(X)](#masthead)

[Software](#subnav-box-nav-software)
## [Software](#subnav-box-nav-software)

[All Software](https://www.theregister.com/software/)[AI + ML](https://www.theregister.com/software/ai_ml/)[Applications](https://www.theregister.com/software/applications/)[Databases](https://www.theregister.com/software/databases/)[DevOps](https://www.theregister.com/software/devops/)[OSes](https://www.theregister.com/software/oses/)[Virtualization](https://www.theregister.com/software/virtualization/)
[(X)](#masthead)

[Offbeat](#subnav-box-nav-offbeat)
## [Offbeat](#subnav-box-nav-offbeat)

[All Offbeat](https://www.theregister.com/offbeat/)[Debates](https://www.theregister.com/Debates/)[Columnists](https://www.theregister.com/offbeat/columnists/)[Science](https://www.theregister.com/offbeat/science/)[Geek's Guide](https://www.theregister.com/offbeat/geeks_guide/)[BOFH](https://www.theregister.com/offbeat/bofh/)[Legal](https://www.theregister.com/offbeat/legal/)[Bootnotes](https://www.theregister.com/offbeat/bootnotes/)[Site News](https://www.theregister.com/offbeat/site_news/)[About Us](https://www.theregister.com/offbeat/about_us/)
[(X)](#masthead)

[Special Features](#subnav-box-nav-special_features)
## Special Features

[All Special Features](https://www.theregister.com/special_features)
[The Future of the Datacenter](https://www.theregister.com/special_features/future_of_the_datacenter)
[Cybersecurity Month](https://www.theregister.com/special_features/cybersecurity_month)
[VMware Explore](https://www.theregister.com/special_features/vmware_explore)
[Cloud Infrastructure Month](https://www.theregister.com/special_features/cloud_infrastructure_month)

## Vendor Voice

[Vendor Voice](#subnav-box-nav-tag-vendor-voice)
## [Vendor Voice](#subnav-box-nav-tag-vendor-voice)

[All Vendor Voice](https://www.theregister.com/VendorVoice/)
[Amazon Web Services (AWS) New Horizon in Cloud Computing](https://www.theregister.com/VendorVoice/aws_new_horizon_financial_services/)
[Pure Storage](https://www.theregister.com/VendorVoice/pure_storage_portworx/)
[Kilka Tech](https://www.theregister.com/VendorVoice/aws_klika_tech/)
[HERE and AWS](https://www.theregister.com/VendorVoice/aws_here/)
[Vonage](https://www.theregister.com/VendorVoice/aws_vonage/)
[GE Vernova with AWS](https://www.theregister.com/VendorVoice/aws_ge_vernova_manufacturing/)
[Google Cloud Data Transformation](https://www.theregister.com/VendorVoice/google_cloud_data_transformation/)
[Google Gemini](https://www.theregister.com/VendorVoice/google_gemini/)
[(X)](#masthead)

[Resources](#subnav-box-nav-resources)
## Resources

[Whitepapers](https://whitepapers.theregister.com/)
[Webinars & Events](https://whitepapers.theregister.com/events/list/)
[Newsletters](https://account.theregister.com/edit/newsletter/)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

#### [Security](/security/)

[**17**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2010/05/10/drupal_security_bug/ "View comments on this article")

This article is more than **1 year old**

# White House devs overlooked gaping Drupal vuln

[**17**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2010/05/10/drupal_security_bug/ "View comments on this article")

## Is there an auditor in the house?

![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_red.svg)
[Dan Goodin](/Author/Dan-Goodin "Read more by this author")

Mon 10 May 2010  //
20:14 UTC

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)

A researcher has uncovered a potentially serious vulnerability in the open-source content management system used by the White House website and thousands of other sites.

The XSS, or cross-site scripting, bug resides in the [Drupal Context module](http://drupal.org/project/context), a plug-in that [Whitehouse.gov](http://whitehouse.gov/) and about [10,000 other sites](http://drupal.org/project/usage/context) use to manage how content is viewed on their sites. According to [an advisory](http://www.madirish.net/?article=457) published Monday by researcher Justin Klein Keane, the flaw allows attackers to inject malicious scripts into login pages that will reset the site's administrative password.

The discovery is notable because it comes less than three weeks after the White House released a plug-in of its own that requires use of the vulnerable Context module. It raises questions about the level of review carried out by the people who coded the [Context HTTP Headers](http://drupal.org/project/context_http_headers) module. Administration officials installed it on the sensitive Obama website and [released it to great fanfare](https://www.theregister.com/2010/04/21/white_house_open_sources_code/) in late April at the DrupalCon conference in San Francisco.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

"My worry is that they just launched this revamped Drupal site and it doesn't look like anybody did a serious security audit," said a security researcher who has reviewed the bug and asked that his name not be used in this article. "You can find this hole without much digging, but who knows what else may or may not be there. If one had done that kind of vulnerability assessment even casually, you would expect you would uncover these kinds of things."

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)

Officials with the Drupal project said the bug can be exploited only when attackers already have lower-level administrative privileges to the webserver. And even then, a vulnerable page would have to be set up to allow the attacker to create "blocks," which is Drupal parlance for widgets or other chunks of content.

"That's a very uncommon thing to have happen," said Greg Knaddison, a member of the Drupal security team who said he was speaking to *The Register* in his capacity as a partner with Growing Venture Solutions, a consultancy for websites built on Drupal. Because the vulnerability resides in a release-candidate module, the Drupal project won't be coordinating a security fix. Knaddison has posted a full set of mitigation steps [here](http://crackingdrupal.com/blog/greggles/mitigation-against-cve-2010-1584-drupal-context-module-xss), which also includes a link to a module patch.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

Drupal project managers said they had been communicating with the bug discoverer for several weeks prior to the disclosure.

The big selling point of open source software has long been that its source code can be reviewed by thousands or even millions of users, making it more likely that security flaws will be quickly diagnosed and fixed. And yet in this case, the easy-to-spot bug in the Context module went unnoticed by the White House developers even though it formed the foundation of their own revamped website and a newer module they released to world+dog.

It's not the first incident to raise questions about [how Whitehouse.gov is secured](https://www.theregister.com/2008/11/22/google_analytics_as_security_risk/).

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)

But Knaddison said discovery of the hard-to-exploit bug was proof that the open-source model does hold up to its promise.

"This kind of points to the benefits of investigating the code at a code level versus looking at it from a black-box perspective," he said. "If you can look at the code, then it's probably something that can be found very easily." ®

**Get our** [Tech Resources](https://whitepapers.theregister.com/)

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

#### More about

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

[**17**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)
COMMENTS](https://forums.theregister.com/forum/all/2010/05/10/drupal_security_bug/ "View comments on this article")

#### TIP US OFF

[Send us news](https://www.theregister.com/Profile/contact/)

---

### Other stories you might like

[#### Europe, UK weigh up response to Trump's proposed tariffs

Could a post-Brexit romance be on the cards?
Personal Tech24 Jan 2025 |](/2025/01/24/eu_uk_trump_tariffs/?td=keepreading)

[#### Don't want your Kubernetes Windows nodes hijacked? Patch this hole now

SYSTEM-level command injection via API parameter \*chef's kiss\*
Patches24 Jan 2025 |](/2025/01/24/kubernetes_windows_nodes_bug/?td=keepreading)

[#### Boeing warns of more financial charges due to strikes, costlier parts, and Starliner

Calamity Capsule continues to be calamitous for the bottom line
Science24 Jan 2025 | 5](/2025/01/24/boeing_results_q4/?td=keepreading)

[#### A rethink of parental leave policy

IT workers and programmers set to benefit as Sandvik implements HR reboot
Sponsored Feature](/2024/12/04/a_rethink_of_parental_leave/?td=keepreading)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z5PG2HDoPoLikXTPFZJJBwAAAZQ&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)

[#### North Korean dev who renamed himself 'Bane' accused of IT worker fraud scheme

5 indicted as FBI warns North Korea dials up aggression, plus Russian devs allegedly get in on the act
Cyber-crime24 Jan 2025 | 1](/2025/01/24/north_korean_devs_and_their/?td=keepreading)

[#### Mega UK datacenter greenlit, but we still don't know who's moving in

Hyperscaler mystery deepens as Hertfordshire braces for bit barn blitz
On-Prem24 Jan 2025 | 22](/2025/01/24/uk_mega_datacenter_approved/?td=keepreading)

[#### WINE 10 is still not an emulator, but Windows apps won't know the difference

New double-digit vintage goes well with all sorts of things
OSes24 Jan 2025 | 18](/2025/01/24/wine_turns_10/?td=keepreading)

[#### First all-Indian chips to debut this year, 25 more local designs in the works

28nm and fatter processes first, says minister, as semiconductor supply chain players move to cash in
Systems24 Jan 2025 | 11](/2025/01/24/india_semiconductor_industry_designs_debut/?td=keepreading)

[#### BOFH: How to innosplain your way through an audit

Episode 2 [ɪnəʊspleɪn] Verb. 1. The ability to prattle on in a condescending manner about technology that doesn't exist yet
BOFH24 Jan 2025 | 18](/2025/01/24/bofh_2025_episode_2/?td=keepreading)

[#### User said he did nothing that explained his dead PC – does a new motherboard count?

On Call Then suggested a bloke down the pub might be able to help fix it
Personal Tech24 Jan 2025 | 68](/2025/01/24/on_call/?td=keepreading)

[#### China and friends claim success in push to stamp out tech support cyber-scam slave camps

Paint a target on Myanmar, pledge more info-sharing to get the job done
Cyber-crime24 Jan 2025 | 8](/2025/01/24/lancang_mekong_anti_cyberscam_cooperation/?td=keepreading)

[#### Court rules FISA Section 702 surveillance of US resident was unconstitutional

'Public interest alone does not justify warrantless querying' says judge
Security24 Jan 2025 | 10](/2025/01/24/section_702_court/?td=keepreading)

The Register ![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_white.png) Biting the hand that feeds IT

#### About Us

* [Contact us](https://www.theregister.com/Profile/contact/)
* [Advertise with us](https://www.theregister.com/AdvertiseWithUs/)
* [Who we are](https://www.theregister.com/Profile/about_the_register/)

#### Our Websites

* [The Next Platform](https://www.nextplatform.com/)
* [DevClass](https://devclass.com/)
* [Blocks and Files](https://blocksandfiles.com/)

#### Your Privacy

* [Cookies Policy](https://www.theregister.com/Profile/cookies/)
* [Privacy Policy](https://www.theregister.com/Profile/privacy/)
* [Ts & Cs](https://www.theregister.com/Profile/terms_and_conditions_of_use/)

[![Situation Publishing](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/std/sitpublogo_2022.png)](https://situationpublishing.com/)

Copyright. All rights reserved © 1998–2025

![no-js](/Design/graphics/std/transparent_pixel.png)



=== Content from crackingdrupal.com_da39ecde_20250124_165901.html ===


[DRUPAL](https://drupal.org) | [WILEY & SONS](http://www.wiley.com)

"Cracking Drupal
 is probably going to be
 the first Drupal book I buy."
 - Angie 'webchick' Byron

**[Cracking Drupal](/ "Home")**
[![Home](/sites/all/themes/crack/images/title-home.gif)](/ "Home")
Drupal Security Book, Resources, Reviews

[Home](/) âº
# Mitigation against CVE-2010-1584 Drupal Context Module XSS

 in

* [Planet Drupal](/category/tags/planet-drupal)
* [XSS](/category/tags/xss)

Recently Justin Klein Keane posted information about a [vulnerability](http://www.madirish.net/?article=457) in the [Context Module](https://drupal.org/project/context) for Drupal.

Justin included information about mitigating factors:

> In order to execute arbitrary script injection malicious users must have 'Administer blocks' permission.

Here are some more concrete steps for mitigation of this particular vulnerability.

### 1. Ensure only trusted roles have the "Administer Blocks" permission

My coworker Ben Jeavons wrote previously in this blog about the importance of understanding [trusted and untrusted users on your site and how roles play in](http://crackingdrupal.com/blog/ben-jeavons/importance-user-roles-and-permissions-site-security). We also built a check for some important permissions into the [Security Review](https://drupal.org/project/security_review) module that Ben built as part of his work with [GVS](http://growingventuresolutions.com/).

To put it simply, while it's not on the list of roles that the Drupal Security Team considers to be [site owning permissions that mean there is no need for a Security Advisory](https://drupal.org/node/475848), **"Administer blocks" is an important permission and shouldn't be given out to untrusted people who might inject XSS into a block title reconfigure or disable all the blocks from the site.**

*Update: [Heine Deelstra](http://heine.familiedeelstra.com/) asked me to clarify that last line. In general, injecting XSS into a block title would merit an SA in the opinion of the Drupal Security Team. Granular permissions are a strength of Drupal and only permissions which allow for privilege escalation are included in the list [we will not do an SA for](https://drupal.org/node/475848).*

### 2. Upgrade Context to the latest code from the repository

As often happens, the Drupal community can move quite quickly and in this case [the issue has been fixed in the development version of code](https://drupal.org/node/794718) that exists in the source code repository. A big thanks goes to [Steven Jones](https://drupal.org/user/99644) and to [Young Hahn](https://drupal.org/user/264833) - two of the volunteer module maintainers - for helping out in this particular case . *I say "volunteer" because Steven and Young are not paid by the Drupal Security Team to do this kind of work, though their employers may pay them for it, their employers are only one of many companies that benefit from the existence of the modules.*

To get the code from CVS a site administrator could use this single command:

There is an issue to create a [development snapshot release for this vulnerable branch](https://drupal.org/node/795072) so it would be easier to download the new code and that release will be created automatically by the Drupal packaging system within 12 hours.

*Update: a [new release](https://drupal.org/node/795118) has been created.*

You should of course test an updated module in a test environment prior to releasing it onto a live site.

### 3. Disable the Context module

Only do this if you can't do steps 1 and 2. Really, both of those should be entirely possible and they are simpler.

The Context module provides a variety of features, but the most common one is a new way to show blocks on a site. So, if you can live without the features provided by context you can simply disable it.

Go to Administer > Site building > Modules and uncheck the checkbox next to the module and submit the form.

### My personal commentary

My personal take on this is that it's been given a bit more hoopla than it deserves. The mitigation steps are simple and most sites would not be vulnerable in the first place. The Drupal Security Team has a policy of not creating "Security Advisories" in the case of Release Candidate (RC) software and, ideally, the broader world of "Security Researchers" would respect that.

Of course, it would also be ideal if site administrators respected the "developer" nature of these kinds of modules, but the [project usage for Context](https://drupal.org/project/usage/context) shows that it is on well over 10,000 sites. Another solution to that would be for module developers to create official "1.0" releases of their modules if they are serious about letting them get used on lots of sites.

On a somewhat related note, the Verizon Security blog recently had a post about [Security Researchers vs. Narcissistic Vulnerability Pimps](http://securityblog.verizonbusiness.com/2010/04/22/redefining-security-researcher/).

* [Login](/user/login?destination=node%2F55%23comment-form) to post comments

## Comments

### [Don't hate](/blog/greggles/mitigation-against-cve-2010-1584-drupal-context-module-xss#comment-145)

Submitted by [Nohatersclub](http://www.narcissisticvulnerabilitypimps.com/) (not verified) on Mon, 05/10/2010 - 18:05.

Been pimpin' since pimpin' been pimp

* [Login](/user/login?destination=node%2F55%23comment-form) to post comments

### [^ don't being pimpers if just](/blog/greggles/mitigation-against-cve-2010-1584-drupal-context-module-xss#comment-146)

Submitted by uevsnx (not verified) on Tue, 05/11/2010 - 01:38.

^ don't being pimpers if just got pimped

* [Login](/user/login?destination=node%2F55%23comment-form) to post comments

### [the pimp thing](/blog/greggles/mitigation-against-cve-2010-1584-drupal-context-module-xss#comment-150)

Submitted by [justin](http://www.madirish.net) (not verified) on Wed, 05/12/2010 - 09:23.

The whole pimp comment is quite disturbing. I told Drupal security about this problem weeks before disclosure. Then, when told Drupal sec didn't do SA's for RC I asked for confirmation and waited a few more days. After all, the White House uses this module. You seem to insinuate that my motivations are narcissistic, but I get absolutely jack shit from putting my name on these disclosures. Actually, check that, I do get derission and harassment. All of it does serve as a good motivator to turn researchers away from responsible disclosure. I do my best to work with Drupal security and get very little but grief for my efforts.

* [Login](/user/login?destination=node%2F55%23comment-form) to post comments

### [multiple perspectives on the issue](/blog/greggles/mitigation-against-cve-2010-1584-drupal-context-module-xss#comment-151)

Submitted by [greggles](/users/greggles "View user profile.") on Wed, 05/12/2010 - 09:54.

I didn't call you a pimp. I said it was somewhat related to the situation. Don't overblow what I said.

In my opinion there are at least two individuals who are *potentially* acting like the "NVP" described in that post.

The Reg article calls this a "Gaping" hole. Gaping means "wide open" and there's nothing gaping about it. Using that word and the information about 10,000 sites to imply a widespread exploitable hole is strictly for shock value.

I feel disappointed that more of my advice wasn't included in the article. I explained that the hole is somewhat obvious when looked at from the code side and not from a black-box penetration side and, afaik, the White House did penetration tests and not necessarily code level analysis. Their particular configuration prevents this from being exploited at **multiple levels** including within Drupal. Stating otherwise ("gaping" meaning open) is insincere when I had explained the review process and some of the security features in place that prevent exploit.

There is of course concern, though no clear evidence, that the Reg article tip-off and their anonymous security researcher are you, Justin. And that would feel pretty clearly like a NVP. Without having certainty that it was you I left it as something to consider in the context of modern security research. I feel the labels used for researchers are a timely topic worth discussing even if the potential association grates on your nerves.

If in fact you get "jack shit" from doing these disclosures why do you include them on your blog and include your name on them when you send them to fulldisclosure? And why is the first thing in those e-mails to fulldisclosure a link back to your blog? From an information architecture perspective the first thing in the e-mail is the most important thing - you've shown that the most important thing to you is that link to your blog...

* [Login](/user/login?destination=node%2F55%23comment-form) to post comments

### [I was unaware of this](/blog/greggles/mitigation-against-cve-2010-1584-drupal-context-module-xss#comment-240)

Submitted by Jason (not verified) on Mon, 02/21/2011 - 14:52.

I was unaware of this security issue and will look over the administrator blocks permissions right away. I thank Justin for not only finding this vulnerability but for posting the fix for it as well. Kudos!

Jason

* [Login](/user/login?destination=node%2F55%23comment-form) to post comments

* [HOME](/)
* [BLOGUpdates and comments](/blog "Updates and comments")
* [EXCERPTSTable of Contents, Chapter 1, Index](/cracking-drupal-free-pdf-download "Table of Contents, Chapter 1, Index")
* [DOWNLOADSDefault install and example module](/content/drupal-vulnerable-module "Default install and example module")
* [ERRATAKnown errors and error report form](/errata "Known errors and error report form")
* [ABOUT THE AUTHORGreg Knaddison and Growing Venture Solutions](/node/1 "Greg Knaddison and Growing Venture Solutions")
* [PURCHASEBuy at Amazon.com](http://crackingdrupal.com/buy-amazon "Buy at Amazon.com")

## The Book, The Report

[![](http://crackingdrupal.com/sites/all/themes/crack/images/cracking_drupal_perspective_small.jpg)](http://crackingdrupal.com/buy-amazon)

### Cracking Drupal: A Drop in the Bucket

Written by a Drupal expert, this is the first book to reveal the vulnerabilities and security issues that exist in the sites that have been built with Drupal and how to prevent them from continuing.

* [Hard copy: $36 on Amazon.](http://crackingdrupal.com/buy-amazon)
* [Kindle copy: $22.80](https://www.amazon.com/Cracking-Drupal-Drop-Bucket-ebook/dp/B004RD85CQ/ref%3Dkinw_dp_ke?ie=UTF8&m=AG56TWVU5XWC2)

### Drupal Security White Paper

Curious about Drupal's security? Consider Drupal but want to make sure it's good enough? Read the [Drupal Security Report](http://drupalsecurityreport.org/)

## Security Review Module

If you are concerned about whether your site is secure, consider using the [Security Review Module](https://drupal.org/project/security_review) to get a free review of your site's security health. Did it find problems? Consider hiring a security expert from [Drupal Scout](http://www.drupalscout.com/) to audit your site.

## Recent Blog Posts

* [Improvements to Security in Drupal 7](/node/69)

  Posted by [greggles](/users/greggles "View user profile.")

  0 comments
* [Why counting vulnerabilities is not a sufficient method of comparing product security](/node/66)

  Posted by [greggles](/users/greggles "View user profile.")

  0 comments
* [Notes from Linux Security Tunables by Kees Cook](/node/65)

  Posted by [greggles](/users/greggles "View user profile.")

  0 comments

[more](/blog)

[Portions © 2009 Greg Knaddison and John Wiley & Sons, Inc.](/node/33)
[Drupal Scout](http://drupalscout.com)



=== Content from www.packetstormsecurity.com_7a2c8c90_20250124_165904.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.madirish.net_d051ebbd_20250124_165903.html ===


# [Mad Irish . net](https://www.madirish.net)

* [about](https://www.madirish.net/about "About me")
* contact
* [rss](https://www.madirish.net/rss.php "RSS feed")
* [github](https://github.com/madirish "Work")
* [LAMPSecurity](https://sourceforge.net/projects/lampsecurity/ "CTF")

# Drupal Context Module XSS

[disclosure](/tag/disclosure) [drupal](/tag/drupal)
30 November -0001
#### CVE

[CVE-2010-1584](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2010-1584)

#### Description of Vulnerability:

Drupal (<http://drupal.org>) is a robust content management system (CMS) written in PHP and MySQL. The Drupal Context module (<http://drupal.org/project/context>) "allows you to manage contextual conditions and reactions for different portions of your site." The Context module contains a cross site scripting (XSS) vulnerability because it fails to sanitize block descriptions before display.

#### Systems affected:

Drupal 6.16 with Context 6.x-2.0-rc3 was tested and shown to be vulnerable.

#### Impact

User could inject arbitrary scripts into pages affecting site users. This could result in administrative account compromise leading to web server process compromise.

#### Mitigating factors:

In order to execute arbitrary script injection malicious users must have 'Administer blocks' permission.

#### Technical discussion and proof of concept:

Users with 'administer blocks' permission can insert arbitrary script in block descriptions which is rendered by the Context module at ?q=admin/build/context/X where X is the block id.

#### Vendor Response

Drupal security responds that they do not coordinate security fixes for modules in release candidate designation. Vulnerability was reported to the module maintainer via the public issue queue at the direction of Drupal security. Ref <http://drupal.org/node/794718>

### Tags

* [apple](/tag/apple)
* [arbitrary\_code\_execution](/tag/arbitrary_code_execution)
* [blue\_team](/tag/blue_team)
* [disclosure](/tag/disclosure)
* [drupal](/tag/drupal)
* [editorial](/tag/editorial)
* [encryption](/tag/encryption)
* [exploit](/tag/exploit)
* [feature](/tag/feature)
* [how\_to](/tag/how_to)
* [html5](/tag/html5)
* [ios](/tag/ios)
* [iot](/tag/iot)
* [javascript](/tag/javascript)
* [linux](/tag/linux)
* [malware](/tag/malware)
* [mysql](/tag/mysql)
* [network](/tag/network)
* [osx](/tag/osx)
* [pen\_test](/tag/pen_test)
* [php](/tag/php)
* [privacy](/tag/privacy)
* [purple\_team](/tag/purple_team)
* [random](/tag/random)
* [raspberry\_pi](/tag/raspberry_pi)
* [research](/tag/research)
* [review](/tag/review)
* [sql](/tag/sql)
* [sql\_injection](/tag/sql_injection)
* [threat\_intel](/tag/threat_intel)
* [tools](/tag/tools)
* [tutorial](/tag/tutorial)
* [vuln](/tag/vuln)
* [web\_application](/tag/web_application)
* [windows](/tag/windows)
* [xss](/tag/xss)

[Copyright](http://www.madirish.net/copyright "My copyright statement") © Justin C. Klein Keane. Unauthorized reproduction is a violation of US and international law.


