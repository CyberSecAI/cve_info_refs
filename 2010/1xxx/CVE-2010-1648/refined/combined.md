=== Content from lists.wikimedia.org_f6b19a93_20250125_073630.html ===

# [MediaWiki-announce] MediaWiki security update: 1.15.4 and 1.16.0beta3

**Tim Starling**
tstarling at wikimedia.org

*Fri May 28 07:40:46 UTC 2010*

* **Messages sorted by:**
  [[ date ]](date.html#91)
  [[ thread ]](thread.html#91)
  [[ subject ]](subject.html#91)
  [[ author ]](author.html#91)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

This is a security and bugfix release of MediaWiki 1.15.4 and
MediaWiki 1.16 beta 3.

Two security vulnerabilities were discovered.

Kuriaki Takashi discovered an XSS vulnerability in MediaWiki. It
affects Internet Explorer clients only. The issue is presumed to
affect all recent versions of IE, it has been confirmed on IE 6 and 8.

Noncompliant CSS parsing behaviour in Internet Explorer allows
attackers to construct CSS strings which are treated as safe by
previous versions of MediaWiki, but are decoded to unsafe strings by
Internet Explorer. Full details can be found at:
<https://bugzilla.wikimedia.org/show_bug.cgi?id=23687>

A CSRF vulnerability was discovered in our login interface. Although
regular logins are protected as of 1.15.3, it was discovered that the
account creation and password reset features were not protected from
CSRF. This could lead to unauthorised access to private wikis. See
<https://bugzilla.wikimedia.org/show_bug.cgi?id=23371> for details.

These vulnerabilities are serious and all users are advised to
upgrade. Remember that CSRF and XSS vulnerabilities can be used even
against firewall-protected intranet installations, as long as the
attacker can guess the URL.

In addition to the security fix, MediaWiki 1.16 beta 3 also contains
many useful bug fixes to 1.16 beta 2. We expect to be able to do a
stable release of the 1.16 branch within the next week or two.

Both releases contain localisation updates courtesy of translatewiki.net.

Full release notes:
<http://svn.wikimedia.org/svnroot/mediawiki/tags/REL1_15_4/phase3/RELEASE-NOTES>
<http://svn.wikimedia.org/svnroot/mediawiki/tags/REL1_16_0beta3/phase3/RELEASE-NOTES>

**********************************************************************
   1.15.4
**********************************************************************
Download:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.tar.gz>

Patch to previous version (1.15.3), without interface text:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-i18n-1.15.4.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-i18n-1.15.4.patch.gz.sig>

Public keys:
<https://secure.wikimedia.org/keys.html>

**********************************************************************
   1.16 beta 3
**********************************************************************
Download:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.tar.gz>

Patch to previous version (1.16.0beta2), without interface text:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-i18n-1.16.0beta3.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-i18n-1.16.0beta3.patch.gz.sig>

Public keys:
<https://secure.wikimedia.org/keys.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iEYEARECAAYFAkv/c34ACgkQgkA+Wfn4zXnCTgCfb7CnMBkZZpcffdUauy8i4LAV
KN4Anj41b/jPfzqZwNfmMIH1/8NMaG9/
=k2UI
-----END PGP SIGNATURE-----

```

---

* **Messages sorted by:**
  [[ date ]](date.html#91)
  [[ thread ]](thread.html#91)
  [[ subject ]](subject.html#91)
  [[ author ]](author.html#91)

---

[More information about the MediaWiki-announce
mailing list](https://lists.wikimedia.org/mailman/listinfo/mediawiki-announce)



=== Content from bugzilla.wikimedia.org_181cc357_20250125_073632.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT25371)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T25371
# Special:Userlogin form is not token protectedClosed, Resolved[Public](/policy/explain/PHID-TASK-pbdervodz7jis3ceixqx/view/)Actions

* [Edit Task](/maniphest/task/edit/25371/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/25371/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-pbdervodz7jis3ceixqx/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-pbdervodz7jis3ceixqx/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-pbdervodz7jis3ceixqx/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-pbdervodz7jis3ceixqx/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-pbdervodz7jis3ceixqx/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-pbdervodz7jis3ceixqx/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-pbdervodz7jis3ceixqx/)
* [Protect as security issue](/wmf/escalate-task/25371/)
* [Award Token](/token/give/PHID-TASK-pbdervodz7jis3ceixqx/)
* [Flag For Later](/flag/edit/PHID-TASK-pbdervodz7jis3ceixqx/)

Assigned To

|  | [Platonides](/p/Platonides/) |
| --- | --- |

Authored By

|  | [Platonides](/p/Platonides/) |
| --- | --- |
| May 1 2010, 8:15 PM2010-05-01 20:15:00 (UTC+0) |

Tags

* [MediaWiki-General](/tag/mediawiki-general/)
Referenced FilesNoneSubscribers

|  | [Platonides](/p/Platonides/) |
| --- | --- |

# Description

The Special:Userlogin forms for login and account creating is not token

protected with a session, which caused bug 23076. However, r64677 only

fixed it for login (which is the most critical due to $wgAllowUserJs).

The hole remains for "E-mail me my password", "Create account" and

"Create by e-mail", with the following abuse cases:

\*For wikis allowing public account creation, an attacker could create

many accounts via proxying users, avoiding ip blocks, the anon gets

logged in (wikis using ConfirmEdit to request a captcha for createaccount

are protected from this).

\*If the victims were logged users, the attacker could create the

accounts by email and flood innocent parties using the wiki as gateway.

\*If the victim was a sysop, the attacker could not only bypass the

captcha protection, but also the username blacklist.

\*It also provides a way to bypass the blocks and ping limit for sending

many password resets flooding its targets.

\*On private wikis an account creation by targeting a sysop may expose

confidential information.

---

**Version**: 1.16.x

**Severity**: critical

# Details

Reference bz23371
### Event Timeline

[• bzimport](/p/bzimport/) raised the priority of this task from  to Medium.[Nov 21 2014, 11:04 PM2014-11-21 23:04:48 (UTC+0)](#277787)[• bzimport](/p/bzimport/) added a project: [MediaWiki-General](/tag/mediawiki-general/).[• bzimport](/p/bzimport/) set Reference to bz23371.[Platonides](/p/Platonides/) created this task.[May 1 2010, 8:15 PM2010-05-01 20:15:00 (UTC+0)](#277793)[Platonides](/p/Platonides/) added a comment.[May 1 2010, 8:18 PM2010-05-01 20:18:56 (UTC+0)](#277810)Comment Actions

Fixed on r65760

[Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)
