```
{
  "vulnerability": {
    "root_cause": "The vulnerability arises due to Firefox's behavior when handling redirects and the use of `location.href` and `location.reload()` in conjunction with `history.back()` and `history.forward()`.",
    "weaknesses": [
      "The browser fails to properly update the session history with the final redirected URL after a page reload using location.reload().",
       "The address bar displays the initial URL of a redirecting page even after a successful redirect, while the content of the page comes from the target URL."
    ],
    "impact": "An attacker can spoof the address bar to display a different URL than the actual content being displayed, potentially leading to phishing attacks.  A user might believe they are on a secure site due to the SSL indicator, while actually on a plaintext page.",
    "attack_vectors": [
      "An attacker sets up a page that redirects to an HTTPS site.",
      "The user visits the redirecting page, then returns to the original page without the redirection enabled, then re-enables redirection and reloads.",
      "Using javascript to navigate to a redirecting page, then reload. Finally using `history.back()` or `history.forward()` to exploit the inconsistent url display."
    ],
    "required_capabilities": "The attacker needs to control a web server and be able to setup a redirect for the targeted user. They must also be able to inject Javascript to use location and history APIs.",
    "additional_information": "The vulnerability can be triggered by manipulating the history via javascript after a redirect with a valid SSL/TLS certificate. The vulnerability can be exploited in the cases that a page redirects automatically to an HTTPS resource, and then a history manipulation occurs."
  },
  "fixes": [
    "The fix involves changing the load type to `LOAD_NORMAL_REPLACE` when a redirect is detected during a reload. This ensures the history entry is updated with the final redirected URL.",
    "The fix ensures that after a redirect, the address bar displays the correct final URL of the target resource."
  ],
   "cve": "CVE-2010-2751"
}
```