=== Content from www.theregister.co.uk_cf2ea21e_20250125_170722.html ===


[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_extents_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_filled_extents_16x16.png)
Sign in / up](https://account.theregister.com/register/)

[![The Register® — Biting the hand that feeds IT](/design_picker/fa16d26efb42e6ba1052f1d387470f643c5aa18d/graphics/std/reg_logo_no_strapline.png)](https://www.theregister.com/)

[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/magnifying_glass_white_extents_16x16.png)](https://search.theregister.com/)

![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_close_16x16.png)

## Topics

[Security](#subnav-box-nav-security)
## [Security](#subnav-box-nav-security)

[All Security](https://www.theregister.com/security/)[Cyber-crime](https://www.theregister.com/security/cyber_crime/)[Patches](https://www.theregister.com/security/patches/)[Research](https://www.theregister.com/security/research/)[CSO](https://www.theregister.com/security/cso/)
[(X)](#masthead)

[Off-Prem](#subnav-box-nav-off_prem)
## [Off-Prem](#subnav-box-nav-off_prem)

[All Off-Prem](https://www.theregister.com/off_prem/)[Edge + IoT](https://www.theregister.com/off_prem/edge_iot/)[Channel](https://www.theregister.com/off_prem/channel/)[PaaS + IaaS](https://www.theregister.com/off_prem/paas_iaas/)[SaaS](https://www.theregister.com/off_prem/saas/)
[(X)](#masthead)

[On-Prem](#subnav-box-nav-on_prem)
## [On-Prem](#subnav-box-nav-on_prem)

[All On-Prem](https://www.theregister.com/on_prem/)[Systems](https://www.theregister.com/on_prem/systems/)[Storage](https://www.theregister.com/on_prem/storage/)[Networks](https://www.theregister.com/on_prem/networks/)[HPC](https://www.theregister.com/on_prem/hpc/)[Personal Tech](https://www.theregister.com/on_prem/personal_tech/)[CxO](https://www.theregister.com/on_prem/cxo/)[Public Sector](https://www.theregister.com/on_prem/public_sector/)
[(X)](#masthead)

[Software](#subnav-box-nav-software)
## [Software](#subnav-box-nav-software)

[All Software](https://www.theregister.com/software/)[AI + ML](https://www.theregister.com/software/ai_ml/)[Applications](https://www.theregister.com/software/applications/)[Databases](https://www.theregister.com/software/databases/)[DevOps](https://www.theregister.com/software/devops/)[OSes](https://www.theregister.com/software/oses/)[Virtualization](https://www.theregister.com/software/virtualization/)
[(X)](#masthead)

[Offbeat](#subnav-box-nav-offbeat)
## [Offbeat](#subnav-box-nav-offbeat)

[All Offbeat](https://www.theregister.com/offbeat/)[Debates](https://www.theregister.com/Debates/)[Columnists](https://www.theregister.com/offbeat/columnists/)[Science](https://www.theregister.com/offbeat/science/)[Geek's Guide](https://www.theregister.com/offbeat/geeks_guide/)[BOFH](https://www.theregister.com/offbeat/bofh/)[Legal](https://www.theregister.com/offbeat/legal/)[Bootnotes](https://www.theregister.com/offbeat/bootnotes/)[Site News](https://www.theregister.com/offbeat/site_news/)[About Us](https://www.theregister.com/offbeat/about_us/)
[(X)](#masthead)

[Special Features](#subnav-box-nav-special_features)
## Special Features

[All Special Features](https://www.theregister.com/special_features)
[The Future of the Datacenter](https://www.theregister.com/special_features/future_of_the_datacenter)
[Cybersecurity Month](https://www.theregister.com/special_features/cybersecurity_month)
[VMware Explore](https://www.theregister.com/special_features/vmware_explore)
[Cloud Infrastructure Month](https://www.theregister.com/special_features/cloud_infrastructure_month)

## Vendor Voice

[Vendor Voice](#subnav-box-nav-tag-vendor-voice)
## [Vendor Voice](#subnav-box-nav-tag-vendor-voice)

[All Vendor Voice](https://www.theregister.com/VendorVoice/)
[Amazon Web Services (AWS) New Horizon in Cloud Computing](https://www.theregister.com/VendorVoice/aws_new_horizon_financial_services/)
[Pure Storage](https://www.theregister.com/VendorVoice/pure_storage_portworx/)
[Kilka Tech](https://www.theregister.com/VendorVoice/aws_klika_tech/)
[HERE and AWS](https://www.theregister.com/VendorVoice/aws_here/)
[Vonage](https://www.theregister.com/VendorVoice/aws_vonage/)
[GE Vernova with AWS](https://www.theregister.com/VendorVoice/aws_ge_vernova_manufacturing/)
[Google Cloud Data Transformation](https://www.theregister.com/VendorVoice/google_cloud_data_transformation/)
[Google Gemini](https://www.theregister.com/VendorVoice/google_gemini/)
[(X)](#masthead)

[Resources](#subnav-box-nav-resources)
## Resources

[Whitepapers](https://whitepapers.theregister.com/)
[Webinars & Events](https://whitepapers.theregister.com/events/list/)
[Newsletters](https://account.theregister.com/edit/newsletter/)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

#### [Security](/security/)

[**42**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2010/03/26/open_source_wireless_sniffer/ "View comments on this article")

This article is more than **1 year old**

# Kit attacks Microsoft keyboards (and a whole lot more)

[**42**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2010/03/26/open_source_wireless_sniffer/ "View comments on this article")

## Sniffing and injecting 'private' traffic

![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_red.svg)
[Dan Goodin](/Author/Dan-Goodin "Read more by this author")

Fri 26 Mar 2010  //
21:02 UTC

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)

Security researchers on Friday unveiled an open-source device that captures the traffic of a wide variety of wireless devices, including keyboards, medical devices, and remote controls.

Keykeriki version 2 captures the entire data stream sent between wireless devices using a popular series of chips made by Norway-based Nordic Semiconductor. That includes the device addresses and the raw payload being sent between them. The open-source package was developed by researchers of Switzerland-based Dreamlab Technologies and includes complete software, firmware, and schematics for building the $100 sniffer.

Keykeriki not only allows researchers or attackers to capture the entire layer 2 frames, it also allows them to send their own unauthorized payloads. That means devices that don't encrypt communications - or don't encrypt them properly - can be forced to cough up sensitive communications or be forced to execute rogue commands.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

At the CanSecWest conference in Vancouver, Dreamlab Senior Security Expert Thorsten Schroder demonstrated how Keykeriki could be used to attack wireless keyboards sold by Microsoft. The exploit worked because communications in the devices are protected by a weak form of encryption known as xor, which is trivial to break. As a result, he was able to intercept keyboard strokes as they were typed and to remotely send input that executed commands on the attached computer.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

"Microsoft made it easy for us because they used their own proprietary crypto," Schroder said. "Xor is not a very proper way to secure data."

Even when devices employ strong cryptography, Schroder said Keykeriki may still be able to remotely send unauthorized commands using a technique known as a replay attack, in which commands sent previously are recorded and then sent again.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

The device can also be used to spot weaknesses in cryptographic communications by comparing keystrokes to corresponding ciphertext. His analysis shows wireless keyboards made by Logitech most likely use 128-bit AES encryption. But even so, it may still be possible to decipher the contents by exploiting the way the secret key is exchanged.

"We still didn't figure out how to crack that one, but I think it's just a matter of time," he said. Keykeriki, which is the German equivalent of "cock-a-doodle-do," is available [here](http://www.remote-exploit.org/). ®

**Get our** [Tech Resources](https://whitepapers.theregister.com/)

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

#### More about

* [Microsoft](/Tag/Microsoft/)

More like these

×
### More about

* [Microsoft](/Tag/Microsoft/)

### Narrower topics

* [Active Directory](/Tag/Active%20Directory/)
* [Azure](/Tag/Azure/)
* [Bing](/Tag/Bing/)
* [BSoD](/Tag/BSoD/)
* [Excel](/Tag/Excel/)
* [Exchange Server](/Tag/Exchange%20Server/)
* [HoloLens](/Tag/HoloLens/)
* [Internet Explorer](/Tag/Internet%20Explorer/)
* [LinkedIn](/Tag/LinkedIn/)
* [Microsoft 365](/Tag/Microsoft%20365/)
* [Microsoft Build](/Tag/Microsoft%20Build/)
* [Microsoft Edge](/Tag/Microsoft%20Edge/)
* [Microsoft Ignite](/Tag/Microsoft%20Ignite/)
* [Microsoft Office](/Tag/Microsoft%20Office/)
* [Microsoft Surface](/Tag/Microsoft%20Surface/)
* [Microsoft Teams](/Tag/Microsoft%20Teams/)
* [.NET](/Tag/.NET/)
* [Office 365](/Tag/Office%20365/)
* [OS/2](/Tag/OS/2/)
* [Outlook](/Tag/Outlook/)
* [Patch Tuesday](/Tag/Patch%20Tuesday/)
* [Pluton](/Tag/Pluton/)
* [SharePoint](/Tag/SharePoint/)
* [Skype](/Tag/Skype/)
* [SQL Server](/Tag/SQL%20Server/)
* [Visual Studio](/Tag/Visual%20Studio/)
* [Visual Studio Code](/Tag/Visual%20Studio%20Code/)
* [Windows](/Tag/Windows/)
* [Windows 10](/Tag/Windows%2010/)
* [Windows 11](/Tag/Windows%2011/)
* [Windows 7](/Tag/Windows%207/)
* [Windows 8](/Tag/Windows%208/)
* [Windows Server](/Tag/Windows%20Server/)
* [Windows Server 2003](/Tag/Windows%20Server%202003/)
* [Windows Server 2008](/Tag/Windows%20Server%202008/)
* [Windows Server 2012](/Tag/Windows%20Server%202012/)
* [Windows Server 2013](/Tag/Windows%20Server%202013/)
* [Windows Server 2016](/Tag/Windows%20Server%202016/)
* [Windows Subsystem for Linux](/Tag/Windows%20Subsystem%20for%20Linux/)
* [Windows XP](/Tag/Windows%20XP/)
* [Xbox](/Tag/Xbox/)
* [Xbox 360](/Tag/Xbox%20360/)

### Broader topics

* [Bill Gates](/Tag/Bill%20Gates/)

#### More about

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

[**42**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)
COMMENTS](https://forums.theregister.com/forum/all/2010/03/26/open_source_wireless_sniffer/ "View comments on this article")

#### More about

* [Microsoft](/Tag/Microsoft/)

More like these

×
### More about

* [Microsoft](/Tag/Microsoft/)

### Narrower topics

* [Active Directory](/Tag/Active%20Directory/)
* [Azure](/Tag/Azure/)
* [Bing](/Tag/Bing/)
* [BSoD](/Tag/BSoD/)
* [Excel](/Tag/Excel/)
* [Exchange Server](/Tag/Exchange%20Server/)
* [HoloLens](/Tag/HoloLens/)
* [Internet Explorer](/Tag/Internet%20Explorer/)
* [LinkedIn](/Tag/LinkedIn/)
* [Microsoft 365](/Tag/Microsoft%20365/)
* [Microsoft Build](/Tag/Microsoft%20Build/)
* [Microsoft Edge](/Tag/Microsoft%20Edge/)
* [Microsoft Ignite](/Tag/Microsoft%20Ignite/)
* [Microsoft Office](/Tag/Microsoft%20Office/)
* [Microsoft Surface](/Tag/Microsoft%20Surface/)
* [Microsoft Teams](/Tag/Microsoft%20Teams/)
* [.NET](/Tag/.NET/)
* [Office 365](/Tag/Office%20365/)
* [OS/2](/Tag/OS/2/)
* [Outlook](/Tag/Outlook/)
* [Patch Tuesday](/Tag/Patch%20Tuesday/)
* [Pluton](/Tag/Pluton/)
* [SharePoint](/Tag/SharePoint/)
* [Skype](/Tag/Skype/)
* [SQL Server](/Tag/SQL%20Server/)
* [Visual Studio](/Tag/Visual%20Studio/)
* [Visual Studio Code](/Tag/Visual%20Studio%20Code/)
* [Windows](/Tag/Windows/)
* [Windows 10](/Tag/Windows%2010/)
* [Windows 11](/Tag/Windows%2011/)
* [Windows 7](/Tag/Windows%207/)
* [Windows 8](/Tag/Windows%208/)
* [Windows Server](/Tag/Windows%20Server/)
* [Windows Server 2003](/Tag/Windows%20Server%202003/)
* [Windows Server 2008](/Tag/Windows%20Server%202008/)
* [Windows Server 2012](/Tag/Windows%20Server%202012/)
* [Windows Server 2013](/Tag/Windows%20Server%202013/)
* [Windows Server 2016](/Tag/Windows%20Server%202016/)
* [Windows Subsystem for Linux](/Tag/Windows%20Subsystem%20for%20Linux/)
* [Windows XP](/Tag/Windows%20XP/)
* [Xbox](/Tag/Xbox/)
* [Xbox 360](/Tag/Xbox%20360/)

### Broader topics

* [Bill Gates](/Tag/Bill%20Gates/)

#### TIP US OFF

[Send us news](https://www.theregister.com/Profile/contact/)

---

### Other stories you might like

[#### How Windows got to version 3 – an illustrated history

Opinion With added manga and snark. What's not to like?
OSes18 Jan 2025 | 116](/2025/01/18/how_windows_got_to_v3/?td=keepreading)

[#### Microsoft joins CISPE, the Euro cloud crew that tried to curb its licensing

Exclusive From fighters to friends in six months, despite AWS voting against it
PaaS + IaaS21 Jan 2025 | 9](/2025/01/21/microsoft_joins_cispe/?td=keepreading)

[#### Where does Microsoft's NPU obsession leave Nvidia's AI PC ambitions?

Comment While Microsoft pushes AI PC experiences, Nvidia is busy wooing developers
AI + ML20 Jan 2025 | 26](/2025/01/20/microsoft_nvidia_ai_pcs/?td=keepreading)

[#### Fortify your data

How cyber resilient storage hardware can defeat ransomware
Sponsored Feature](/2024/11/26/fortify_your_data/?td=keepreading)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/front&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z5UaSTfmiQq7f-id6ODPmQAAAQs&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)

[#### Microsoft tests 45% M365 price hikes in Asia-Pacific to see how much you enjoy AI

Won’t say if other nations will be hit, but will ‘listen, learn, and improve’ as buyers react – so far with anger
SaaS13 Jan 2025 | 125](/2025/01/13/m365_price_rise_asia_pacific_test/?td=keepreading)

[#### Real datacenter emissions are a dirty secret

Amazon doesn't break out figures, but then again neither do Microsoft nor Google
On-Prem22 Jan 2025 | 9](/2025/01/22/datacenter_emissions_not_accurate/?td=keepreading)

[#### Microsoft sues 'foreign-based' cyber-crooks, seizes sites used to abuse AI

Scumbags stole API keys, then started a hacking-as-a-service biz, it is claimed
Security13 Jan 2025 | 4](/2025/01/13/microsoft_sues_foreignbased_crims_seizes/?td=keepreading)

[#### Microsoft fixes under-attack privilege-escalation holes in Hyper-V

Patch Tuesday Plus: Excel hell, angst for Adobe fans, and life's too Snort for Cisco
Patches15 Jan 2025 | 7](/2025/01/15/patch_tuesday_january_2025/?td=keepreading)

[#### Microsoft throws more cash at its carbon guilt by replanting Brazilian rainforest

Updated Meanwhile, datacenter emissions continue to soar
On-Prem22 Jan 2025 | 12](/2025/01/22/microsoft_carbon_credits/?td=keepreading)

[#### Windows Patch Tuesday hits snag with Citrix software, workarounds published

Microsoft starts 2025 as it hopefully doesn't mean to go on
Patches15 Jan 2025 | 8](/2025/01/15/windows_patch_tuesday_citrix/?td=keepreading)

[#### Russia's Star Blizzard phishing crew caught targeting WhatsApp accounts

updated FSB cyberspies venture into a new app for espionage, Microsoft says
Security16 Jan 2025 | 4](/2025/01/16/russia_star_blizzard_whatsapp/?td=keepreading)

[#### Microsoft issues out-of-band fix for Windows Server 2022 NUMA glitch

Update addresses boot failures on multi-node systems
Patches22 Jan 2025 | 6](/2025/01/22/windows_server_numa_glitch/?td=keepreading)

The Register ![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_white.png) Biting the hand that feeds IT

#### About Us

* [Contact us](https://www.theregister.com/Profile/contact/)
* [Advertise with us](https://www.theregister.com/AdvertiseWithUs/)
* [Who we are](https://www.theregister.com/Profile/about_the_register/)

#### Our Websites

* [The Next Platform](https://www.nextplatform.com/)
* [DevClass](https://devclass.com/)
* [Blocks and Files](https://blocksandfiles.com/)

#### Your Privacy

* [Cookies Policy](https://www.theregister.com/Profile/cookies/)
* [Privacy Policy](https://www.theregister.com/Profile/privacy/)
* [Ts & Cs](https://www.theregister.com/Profile/terms_and_conditions_of_use/)

[![Situation Publishing](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/std/sitpublogo_2022.png)](https://situationpublishing.com/)

Copyright. All rights reserved © 1998–2025

![no-js](/Design/graphics/std/transparent_pixel.png)



=== Content from www.remote-exploit.org_91b350cb_20250125_170720.html ===


|  | hacking for the fun of it |  |
| --- | --- | --- |

 [June 2014](http://www.remote-exploit.org/archives/2014/06/index.html)
| Su | Mo | Tu | We | Th | Fr | Sa |
| 1 | 2 | [3](http://www.remote-exploit.org/archives/2014/06/index.html#e2014-06-03T11_17_25.txt) | 4 | 5 | 6 | 7 |
| 8 | 9 | 10 | 11 | 12 | 13 | 14 |
| 15 | 16 | 17 | 18 | 19 | 20 | 21 |
| 22 | 23 | 24 | 25 | 26 | 27 | 28 |
| 29 | 30 |

Projects

[About](http://www.remote-exploit.org/articles/about/index.html)

[BackTrack](http://www.remote-exploit.org/articles/backtrack/index.html)

[KeyKeriki v1.0 – 27MHz](http://www.remote-exploit.org/articles/keykeriki_v1_0_-_27mhz/index.html)

[KeyKeriki v2.0 – 2.4GHz](http://www.remote-exploit.org/articles/keykeriki_v2_0__8211_2_4ghz/index.html)

[Misc Research & Code](http://www.remote-exploit.org/articles/misc_research__amp_code/index.html)

[PrintFS](http://www.remote-exploit.org/articles/printfs/index.html)

[SuisseID and nPA Weaknesses](http://www.remote-exploit.org/articles/suisseid_and_npa_weaknesses/index.html)

Links

[Main](http://www.remote-exploit.org/index.html)

[About[modzero AG](http://www.modzero.ch)

[Totalphase](http://www.totalphase.com)](http://www.remote-exploit.org/articles/about/index.html)

Recent entries

[Ride With The Devil](http://www.remote-exploit.org/archives/2014/06/03/ride_with_the_devil/index.html)

[Content Transfer Done](http://www.remote-exploit.org/archives/2012/02/21/content_transfer_done/index.html)

[Collected 1st & 2nd Level Domains](http://www.remote-exploit.org/archives/2012/01/09/collected_1st_and_2nd_level_domains/index.html)

[New Hosting, Simpler Layout](http://www.remote-exploit.org/archives/2012/01/09/new_hosting_simpler_layout/index.html)

[The Apple Idioten Vektor (IV)](http://www.remote-exploit.org/archives/2012/01/09/the_apple_idioten_vektor_iv/index.html)

Categories

[crypto](http://www.remote-exploit.org/archives/crypto/index.html) (1)

[hardware](http://www.remote-exploit.org/archives/hardware/index.html) (0)

Archives

[Archive Index](http://www.remote-exploit.org/archives/index.html)

[2014](http://www.remote-exploit.org/archives/2014/index.html) (1)

[2012](http://www.remote-exploit.org/archives/2012/index.html) (4)

## Tue Jun 3 11:17:25 CEST 2014

### Ride With The Devil

One of my beloved hobbies is to ride my motorcycle together with my
wife and to travel around. To increase the communication abilities I
was looking for a decent Bluetooth intercom kit. There are three main
players in this market. Cardo systems
(http://www.cardosystems.com) is one of the most recognisable brands
in this part of the world.

The main features I was looking for were sound quality, compatibility
and upgradeability of the firmware to get fixes and features. After
researching a bit, I decided to go with a scala rider Q3
(http://www.cardosystems.com/motorcycles/scala-rider-q3) which is a
mid-class product with nice features.

First of all, operationally and functionally I really do like this
system. It has good quality at a fair price. But thats pretty much
all. It is a completely different story when it comes to security.

According to the manual, the website cardosystems.com/upgrade can be
accessed to get the required software and to configure the Q3's
settings. After having access to the community, I could download the
required cardo-updater software, which is available for Windows and
OSX. So I download the OSX version
(http://community1.cardosystems.com/files/q0/macbcif/Cardo\_Updater\_1.7.pkg)
and installed it.

During the installation, I was informed by my application monitor
Hands Off! (https://www.oneperiodic.com/products/handsoff/) that a
new binary "cardo-updater" (running as root!) wants to bind itself to
TCP port 8080. Wait a minute. Wtf ... listening on port 8080? After
further investigation, I recognised that the binary is installed as a
LaunchAgent and thus the application is executed as root.
Just to make this clear - I just installed a service running as root and
listening on port 8080 on every interface of my computer -- what
could possibly go wrong?

```

 sudo lsof -i | grep LISTEN | grep -i cardo
 cardo-upd 37333           root    7u  IPv4 0x95ffbcff24844da1      0t0    TCP *:http-alt (LISTEN)

 $nc -v 127.0.0.1 8080
 found 0 associations
 found 1 connections:
     1:        flags=82
        outif lo0
        src 127.0.0.1 port 57910
        dst 127.0.0.1 port 8080
        rank info not available
        TCP aux info available

 Connection to 127.0.0.1 port 8080 [tcp/http-alt] succeeded!
 GET / HTTP/1.1

 HTTP/1.1 500 Internal error
 Cache: no-cache
 Content-Type: text/plain
 Content-Length: 28

```

I started a sniffer and the all beloved burp proxy and made sure that I see all the communication
going on between this service and anything else. As soon the the cardo-updater service was runing
the community website of cardosystems did recognize my Q3 device and displayed a website to configure
the individual settings, upgrade the firmware and synch the settings to my actual headset.

After a few minutes, it was obvious that Cardo did something very strange.
I played around with the web application and discovered that it works beautiful, but completely insecure! The
configuration website basically consists out of a GAZILLION of javascripts building requests, that are sent to
the locally installed and running webservice. The main API is available at
http://community1.cardosystems.com/application/modules/Headsets/externals/g9/scripts/cardojs.interface.js.

Depending on what setting you change on the Cardo website, a corresponding request will be constructed and executed.
The following URL sent to the local running service will set the fast-dial number (0049552222266) on my headset:

```

 http://XXX.XXX.XXX.XXX/cardo/api?callback=CardoJS.Interface.UniversalCallback&_id=t4Rk79EsoY&data={%22RequestType%22:%22WritePSKey%22,%22PSKey%22:{%22Key_no%22:674,%22Length%22:7,%22Value%22:%223030343935353232323232363600%22},%22RequestID%22:%22t4Rk79EsoY%22}

```

Yes, I know what your are thinking and yes ... it's completely
unauthenticated and the RequestID field is only an identifier used to
identify responses in case of asynchronous commands. If you post such an URL
to the Cardo community sites ... guess what. Everyone accessing the URL will automatically alter their
configuration of the fast-dial number in the attached headset. One could configure an expensive service/dialer number or just
changing other settings. - NO way!

Yep and it was even worse - check the following URL:

```

 http://127.0.0.1:8080/cardo/api?callback=CardoJS.Interface.UniversalCallback&_id=1r&data={%22RequestType%22:%22UpdateFirmware%22,%22CSR%22:%22http://www.modzero.ch/images/modzero-logo.png%22}

```

This specific request will initiate a firmware update of the device
with the firmware image provided as CSR parameter. Everyone able to
build a firmware or patch an existing one could distribute it
automatically to users clicking the link. CSR is referring to the
built-in bluetooth chip. The required IDE as well as the
corresponding tools like the BlueSuite can be acquired from CSR or
discovered in various download locations. Being an old Bluetooth guy
and knowing some bits about the CSR, i know that there are a lot of
tools built in into the Bluez framework of Linux. You can interact
with the chip using bccmd, pstool or dfutool. The later one allows
you to make a backup of your existing firmware of the device.

So to recapitulate, the cardo-updater is basically a webserver to libusb gateway, completely unprotected and
unauthenticated, binding to all interfaces, running as root on OSX
and as a regular user on windows (at least).

After playing around with the requests and reading some of the
JavaScript API, I identified a local privilege escalation that make any
file on the computer world readable. By using dtruss I could further
identify what happens when cardo-updater processes the firmware
update request. See the following attacking URL and the truncated output of dtruss:

```

Attacking URL: http://127.0.0.1:8080/cardo/api?callback=CardoJS.Interface.UniversalCallback&_id=1r&data={%22RequestType%22:%22UpdateFirmware%22,%22CSR%22:%22file:///etc/master.passwd%22}

```

```

write_nocancel(0x1, "Request: {\"RequestType\":\"UpdateFirmware\",\"CSR\":\"file:///etc/master.passwd\"}\n\0", 0x4C)                 = 76 0
write_nocancel(0x1, "Handling request '' of type UpdateFirmware\n\0", 0x2B)                 = 43 0
write_nocancel(0x1, "Synchronized request '' of type UpdateFirmware queued. Waiting completion\n\0", 0x4A)                 = 74 0

open_nocancel("/dev/random\0", 0x0, 0x0)                 = 14 0
lstat64("/var/tmp/tmp.0.kb5LLv\0", 0xB0114688, 0x80)                 = -1 Err#2
open_nocancel("/var/tmp/tmp.0.kb5LLv\0", 0x601, 0x1B6)                 = 12 0
write_nocancel(0x1, "Downloading new CSR firmware from website\n\0", 0x2A)                 = 42 0
open("/etc/master.passwd\0", 0x0, 0x0)                 = 14 0

```

In line with my assumptions, dtruss showed that the firmware file provided as a parameter to the URL
will be "downloaded" into a temporary file and later validated. In this case
/var/tmp/tmp.0.kb5LLv. Later in the procedure the update will fail,
as this is obviously no valid CSR firmware, but the tempfile is still there and readable fore everyone.

```

$ ls -las /var/tmp/tmp.0.kb5*
16 -rw-r--r--  1 root  wheel  5633 May 27 11:08 /var/tmp/tmp.0.kb5LLv

$ cat /var/tmp/tmp.0.kb5*
##
# User Database
#
# Note that this file is consulted directly only when the system is running
# in single-user mode.  At other times this information is provided by
# Open Directory.
#
# See the opendirectoryd(8) man page for additional information about
# Open Directory.
##
nobody:*:-2:-2::0:0:Unprivileged User:/var/empty:/usr/bin/false
root:*:0:0::0:0:System Administrator:/var/root:/bin/sh

```

While master.passwd is not a critical file, it served the purpose
well. This piece of crappy software is copying root-only files to the
temp location and makes it world-readable!

After playing around a bit with the API and URLs, I wondered what
else would work, and what vulnerability would be present. Using
strings the following list of commands have been discovered, I added
some comments to it:

```

UpdateFirmware (Initiate a firmware update on CSR chip or the DSP)
GetCurrentStatus (Get the status of the device)
GetResult (Get a result of a given operation, thats why RequestID is required)
Echo (Guess what :-))
ReadPSKey (Read a PSKey value)
WritePSKey (Write a PSKey value)
DeletePSKey (Delete a PSKey value)
WriteDSPMem (Could not be tested, as my device does not support DSP commands)
ReadDSPMem (Could not be tested, as my device does not support DSP commands)
ExecuteColdReset (Resets and reboots the device)

```

So e.g
http://127.0.0.1:8080/cardo/api?callback=CardoJS.Interface.UniversalCallback&\_id=1r&data={%22RequestType%22:%22ExecuteColdReset%22}
will instantly reboot the attached headset.

Using the PSKey commands you can alter the configuration of the
device, in fact this can be done using pstools or bccmd under linux
as well instead of using this crappy software. I wont explain the
concept of PSKey's here. Google for CSR bluecore and PSKey if you
like to know more about it. This is a common feature and Cardo uses this to store
its configuration values persistently. (E.g. The PSKey
with the value 674 (0x02a2) holds the quick dial number.)

So whats next. Well by browsing through the cardo-updater binary
using a disassembler, I discovered a strange URL.

```

http://127.0.0.1:8080/test

```

The cardo-updater crashed. So after attaching gdb, I learned that it
seems to have a NULL pointer issue.

```

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x00000000
[Switching to process 45870 thread 0x2503]
0x95c26710 in strlen ()
(gdb)
(gdb) bt
#0  0x95c26710 in strlen ()
#1  0x98aa94ca in std::string::operator= ()
#2  0x0003d4ec in Mediator::HandleNewRequest ()
#3  0x0003c954 in Mediator::HandleMongooseNewRequest ()
#4  0x0003c22b in HttpServer::MongooseEventHandler ()
#5  0x0000fea3 in call_user ()
#6  0x000195d0 in handle_request ()
#7  0x00019dce in process_new_connection ()
#8  0x00019fb8 in worker_thread ()
#9  0x901c75fb in _pthread_body ()
#10 0x901c7485 in _pthread_start ()
#11 0x901cccf2 in thread_start ()
(gdb)

```

In fact the reason for that issue is, that the software is expecting
to parse a parameter added to the test URL. See the following example
URL: http://127.0.0.1:8080/test?AAAAAA

So as the output of gdb indicates, it is assumed that the
cardo-updater wants to conduct a length check on the parameter. If
there is no parameter, the pointer will be NULL and thus the memory
access to 0x000000 will happen and the application will crash. Cardo,
what is wrong? To difficult to check the number of arguments?

This software takes your computer system at risk by opening a
unauthenticated, unencrypted listening port on all interfaces and
binding a fragile pice of software to it. Everyone with this software
running and the headset attached can be a target of a drive-by style
firmware upgrade or reconfiguration of their headset.

The vendor has been informed about this blogpost and the software is
removed from my systems. Everyone with the cardo-updater installed
should do the same.

Hey cardosystems, fix your stuff.

P.S. I don't have any insights on they G9x headsets and their software. There is an Android and an iOS application
available but I didn't investigated anything there, as my Q3 is not supported. Feel free to send me a G9x and I might check it out.

Posted by Max Moser
| [Permanent link](http://www.remote-exploit.org/archives/2014/06/03/ride_with_the_devil/index.html)

## Tue Feb 21 19:35:56 CET 2012

### Content Transfer Done

We did transfer the content from our old system to the new layout. Please drop us an E-Mail if you discover missing content or broken links.

We transfered the following content:

* [SuisseID and nPA Weaknesses](http://www.remote-exploit.org/articles/suisseid_and_npa_weaknesses/index.html)
* [KeyKeriki v1.0 - 27MHz Wireless Keyboard Analyzer](http://www.remote-exploit.org/articles/keykeriki_v1_0_-_27mhz/index.html)
* [Keykeriki v2.0 - 2.4GHz Wireless Keyboard Sniffer & Injector](http://www.remote-exploit.org/articles/keykeriki_v2_0__8211_2_4ghz/index.html)
* [PrintFS Project Page](http://www.remote-exploit.org/articles/printfs/index.html)
* [Our Archive Containing Misc Projects, Research and Codes](http://www.remote-exploit.org/articles/misc_research__amp_code/index.html)

## 2012-01-09 15:15:00

### Collected 1st & 2nd Level Domains

Every now and then, I go through the domain names like most of us. In late 2009-2011 the following top level domains allowed domain transfers:

```

AC,AG,AL,AN,AO,ARPA,AW,BA,BD,BI,BJ,BM,BN,BS,BV
CI,CU,CV,DE,ER,GD,GE,GN,GOV,GQ,GT,GY,IN,INT,IO
JM,JO,KE,KG,KH,KI,KZ,LB,LC,LK,LR,MA,MD,MG,MH,MP
MR,MT,MW,NE,NF,NG,NI,NP,PE,PF,PG,PW,PY,SH,SJ,SK
SL,SN,SO,SR,SV,SZ,TC,TJ,TM,TN,TRTZ,UG,UK,UY,VG
VI,YE,YU,ZW

```

After having the [files](http://www.remote-exploit.org/content/second-level-subdomain-transfers.txt.tgz) on my disk without beeing used too much lately, I decided to put [second-level-subdomain-transfers.txt.tgz](http://www.remote-exploit.org/content/second-level-subdomain-transfers.txt.tgz) up on our website ready for download.

You should be warned, [second-level-subdomain-transfers.txt.tgz](http://www.remote-exploit.org/content/second-level-subdomain-transfers.txt.tgz) is about **55 Megabytes of compressed text** and contains all the gathered 1st and 2nd level domain names. A lot of the domains are not updated since late 2009 but the information is still useful for statistics or 3rd level gathering etc.

Feel free to send me updates and/or third level domain scan results etc.

## Mon Jan 9 01:38:27 CET 2012

### New Hosting, Simpler Layout

As we move from one hoste to another, we also took the chance to further slim down the website and simplify the layout. If you miss a certain content, you might have to be patient drop us an E-Mail or be patient until we moved it to the new location.

Posted by remote-exploit.org
| [Permanent link](http://www.remote-exploit.org/archives/2012/01/09/new_hosting_simpler_layout/index.html)

## Mon Jan 9 00:16:33 CET 2012

### The Apple Idioten Vektor (IV)

We all agree that crypto is important and therefore should be left to the experts. Well, kind of. This "expert" thing is probably the most extensively construed thing in the world of IT security. We all know, that we have a vast amount of "experts" out there.

Apple still ignores the fact that Objective-C and Cocoa is the new PHP. Most iOS programmers ain't reflect anything that has been told to them - functionality matters, what else. You'll become a super-hero in your company if you have proven to be able adding security to your Apps! Fortunately, Apple provides a crypto library that isn't that complicated, so even your 17 years old iOS expert student is able to generate new buzzwords for your portfolio & keynote slides, hence more $$$.

So... let's call this thing that Apple must take care of:

### Responsibility

Responsibility regarding how secure and safe their software is, how unambiguous their application programming interfaces should look like, and how it is published and documented.

Apple provides documentation to their APIs in their online iOS and OSX [Developer Library](http://developer.apple.com/library/ios/navigation/). They also have some crypto stuff available here, let's have a look at the CryptoExercise - sounds promising to get a brief understanding about their high level crypto API:

> *This sample demonstrates the use of the two main Cryptographic API sets on the iPhone OS SDK. Asymmetric Key Encryption and random nonce generation is handled through the Security framework API set, whereas, Symmetric Key Encryption and Digest generation is handled by the CommonCrypto API set. The CryptoExercise sample brings both of these APIs together through a network service, discoverable via Bonjour, that performs a "dummy" cryptographic protocol between devices found on the same subnet.*
> Link: [Apple Crypto Exercise](http://developer.apple.com/library/ios/#samplecode/CryptoExercise/Introduction/Intro.html)

The CryptoExercise is the official "Related Sample Code" when it comes to "Secure Coding" and e.g. to the ["Certificate, Key, and Trust Services Reference"](http://developer.apple.com/library/ios/#documentation/Security/Reference/certifkeytrustservices/Reference/reference.html#//apple_ref/doc/uid/TP30000157).

They also provide a man-page for their ["Common Crypto Interface" CCCryptor(3cc)](http://developer.apple.com/library/ios/#documentation/System/Conceptual/ManPages_iPhoneOS/man3/CCCryptor.3cc.html#//apple_ref/doc/man/3cc/CCCryptor):
```

  CCCryptorCreate, CCryptorCreateFromData, CCCryptorRelease,
  CCCryptorUpdate, CCCryptorFinal, CCCryptorGetOutputLength,
  CCCryptorReset, CCCrypt -- Common Cryptographic Algorithm Interfaces

```

Using the CCCryptor, one can use common sounding functions such as `CCCryptorCreate`, `CCCryptorUpdate`, `CCCryptorFinal` (or simply `CCCrypt()` one-shot function) to perform symmetric encryption using different algorithms like AES, 3DES and hardcore security ciphers like RC4, DES, etc.

Apple supports ECB and CBC mode for their ciphers, and fortunately a developer really needs to explicitly prove stupidity by using ECB since APIs default to CBC, the Cipher Block Chaining mode. What could possibly go wrong? Right, there is some minor thing that is called the "IV". Apple supposedly translated the acronym IV to "Ignorance Vector" when writing their Common Crypto API man-pages, but we should read "Initialization Vector" - used to initialize the very first block of cipher text.

You can easily learn (even on [Wikipedia](http://en.wikipedia.org/wiki/Initialization_vector)), that IVs must be unique for any message encrypted with a given key. And also, that an IV must be unpredictable to avoid several types of cryptographic attacks. That's pretty well known, and there is exactly no single use case for an IV initialized entirely with zeros.

And this is how they [describe](http://www.opensource.apple.com/source/CommonCrypto/CommonCrypto-36064/CommonCrypto/CommonCryptor.h) their API and especially the usage of the IV:

> *Another option for block ciphers is Cipher Block Chaining, known as CBC mode. When using CBC mode, an Initialization Vector (IV) is provided along with the key when starting an encrypt or decrypt operation. If CBC mode is selected and no IV is provided, an IV of all zeroes will be used.*

Instead of simply returning ENOBRAIN, they initialize the IV with zeros without any warning. This is so damn unique and unpredictable, you can't make this up.

In their header files they call the Initialization Vector "optional":
```

@param	iv	Initialization vector, optional. Used by
		block ciphers when Cipher Block Chaining (CBC)
		mode is enabled. If present, must be the same
		length as the selected algorithm's block size.
		If CBC mode is selected (by the absence of the
		kCCOptionECBMode bit in the options flags) and no
		IV is present, a NULL (all zeroes) IV will be used.
		This parameter is ignored if ECB mode is used or
		if a stream cipher algorithm is selected.
...
CCCryptorStatus CCCryptorCreate(
	CCOperation op,             /* kCCEncrypt, etc. */
	CCAlgorithm alg,            /* kCCAlgorithmDES, etc. */
	CCOptions options,          /* kCCOptionPKCS7Padding, etc. */
	const void *key,            /* raw key material */
	size_t keyLength,
	const void *iv,             /* optional initialization vector */
	CCCryptorRef *cryptorRef);  /* RETURNED */
...

```

and the sample code looks like that:
```

...
uint8_t iv[kChosenCipherBlockSize];
memset((void *) iv, 0x0, (size_t) sizeof(iv));
...
// Create and Initialize the crypto reference.
ccStatus = CCCryptorCreate( encryptOrDecrypt,
                            kCCAlgorithmAES128,
                            *pkcs7,
                            (const void *)[symmetricKey bytes],
                            kChosenCipherKeySize,
                            (const void *)iv,
                            &thisEncipher
                        );
...

```

### At least they fail consistently.

Well done, Apple. Now imagine those guys that i have mentioned above, super special experts on iOS and OSX application security and crypto. They will use your documentation, your notes & hints and they will also use your official sample code. And nobody will ever question, what you have told them.
Now, go ahead and watch github projects forking like hell, using your broken code! This simple mistake might increase for a decent period of time due to code copy & paste mentality in iOS/OSX open source projects. Maybe even your recently featured, closed source OSX AppStore application that safely stores passwords, follow your guidelines :-)

### Wait! There is more!

There are people out there, who are abusing dead trees to spread the word. Using Google Books, i found two books, covering OSX/iOS application security and also crypto. 50 % of those books simply made it wrong as you did, Apple, **fifty per cent**. "Professional Cocoa Application Security By Graham J. Lee" did it right, this book is on "Amazon Best Sellers Rank: #527,874". The following book did it wrong: "Pro Core Data for IOS: Data Access and Persistence Engine for iPhone, iPad, and iPod touch" [sic!] By Michael Privat, Robert Warner - Chapter "Using Core Data in Advanced Applications - Creating an Application for Note and Password Storage and Encryption" - and guess what: "Amazon Best Sellers Rank: #289,601"

It's a mess.

[/\](#top)


