```json
{
  "CVE-2010-1239": {
    "related_content": [
      {
        "source": "blog.didierstevens.com_738fba54_20250125_183441.html",
        "content": "This is a special PDF hack: I managed to make a PoC PDF to execute an embedded executable without exploiting any vulnerability!\n\nI use a launch action triggered by the opening of my PoC PDF. With Adobe Reader, the user gets a warning asking for approval to launch the action, but I can (partially) control the message displayed by the dialog. Foxit Reader displays no warning at all, the action gets executed without user interaction.\n\nPDF viewers like Adobe Reader and Foxit Reader don’t allow embedded executables (like binaries and scripts) to be extracted and executed ...\nBut I found another way to launch a command (/Launch /Action), and ultimately run an executable I embedded using a special technique. With Adobe Reader, a launch action needs to be approved by the user ... But I can partially control the message displayed by this dialog box ... I can use this to social-engineer users to “Open” the file ... With Foxit Reader, no warning is displayed ... I’m not publishing my PoC PDF yet, but you can download a PDF that will just launch cmd.exe [here](http://didierstevens.com/files/data/launch-action-cmd.zip). Use it to test your PDF reader.\n\nWith Adobe Reader, the only thing preventing execution is a warning. Disabling JavaScript will not prevent this (I don’t use JavaScript in my PoC PDF), and patching Adobe Reader isn’t possible (I’m not exploiting a vulnerability, just being creative with the PDF language specs).\n\nI shared my PoC with Adobe’s PSIRT. Maybe they will come up with a solution to prevent this, should they consider that the protection offered by the warning dialog is not sufficient. BTW, [preventing Adobe Reader from creating new processes](https://blog.didierstevens.com/2009/10/05/preventing-applications-from-starting-malicious-applications/) blocks this trick.\n\nIn this case, Foxit Reader is probably worse than Adobe Reader, because no warning gets displayed to prevent the launch action. My PoC PDF requires some changes for Foxit Reader, because ultimately, the executable doesn’t run. But that’s probably due to some variation in the PDF language supported by Foxit Reader.",
        "root_cause": "The PDF specification allows for a /Launch action that can be triggered upon opening a PDF document.  The PDF viewer applications then execute the command specified by the /Launch action. While Adobe Reader displays a warning dialog, the message can be manipulated via social engineering, and Foxit Reader executes the action without user interaction.",
        "weaknesses": [
          "Lack of proper validation and user interaction when handling the /Launch action in PDF documents.",
          "Manipulable warning message in Adobe Reader.",
          "No warning message in Foxit Reader."
        ],
         "impact": "Execution of arbitrary commands, potentially leading to the execution of malicious code embedded inside the PDF document.  Successful exploitation could lead to system compromise.",
         "attack_vectors": [
          "Opening a specially crafted PDF document containing a /Launch action with an embedded executable.",
          "Social engineering to mislead users to ignore the warning displayed by Adobe Reader."
          ],
        "required_capabilities": "Attacker needs the ability to create a specially crafted PDF document."
      },
      {
        "source": "www.foxitsoftware.com_3cc06fed_20250125_183504.html",
        "content": "Security updates available in Foxit PDF Editor 12.1.7\n\nAddressed a potential issue where the application could be exposed to hidden dangers lurking in common tools when opening certain PDFs that include the Launch File action, which attackers could exploit to deceive users into executing harmful commands. This appears in the security warning dialog box as it shows “OK” as the default selected option, which may cause users to habitually click “OK” without understanding the potential risks involved.",
        "root_cause": "The default option in the security warning dialog box for the Launch File action is 'OK', which could induce users to approve the execution without carefully reviewing the security risks.",
        "weaknesses": [
          "Inadequate security warning dialog, with “OK” as the default option."
          ],
        "impact": "Deception of users, leading to arbitrary command execution.",
        "attack_vectors": [
           "Opening a specially crafted PDF document containing a /Launch action."
           ],
          "required_capabilities":"Attacker needs the ability to create a specially crafted PDF document."
      },
       {
        "source": "www.foxitsoftware.com_3cc06fed_20250125_183504.html",
        "content": "Security updates available in Foxit PDF Editor for Mac 13.1.2\n\nAddressed a potential issue where the application could be exposed to hidden dangers lurking in common tools when opening certain PDFs that include the Launch File action, which attackers could exploit to deceive users into executing harmful commands. This appears in the security warning dialog box as it shows “OK” as the default selected option, which may cause users to habitually click “OK” without understanding the potential risks involved.",
        "root_cause": "The default option in the security warning dialog box for the Launch File action is 'OK', which could induce users to approve the execution without carefully reviewing the security risks.",
        "weaknesses": [
          "Inadequate security warning dialog, with “OK” as the default option."
           ],
        "impact": "Deception of users, leading to arbitrary command execution.",
        "attack_vectors": [
           "Opening a specially crafted PDF document containing a /Launch action."
           ],
        "required_capabilities": "Attacker needs the ability to create a specially crafted PDF document."
      },
      {
        "source": "www.kb.cert.org_604c2efe_20250125_183505.html",
        "content": "Foxit Reader contains a vulnerability that may allow an attacker to execute arbitrary commands without requiring user interaction.\n\nFoxit Reader uses the ShellExecute function to handle PDFs that use a Launch action. In some cases, Foxit Reader will not prompt the user before an application is launched with a Launch action. It is also reported that the Launch Action can be used to launch an executable that is included in the PDF document, which results in arbitrary code execution.",
        "root_cause": "Foxit Reader's use of ShellExecute to handle PDF Launch actions, combined with the lack of user prompts before application launch, results in arbitrary command execution. Additionally, embedded executables can be launched.",
        "weaknesses": [
          "Lack of user interaction prior to application launch.",
          "Ability to launch embedded executables via the Launch action."
        ],
         "impact": "Remote, unauthenticated attackers may be able to execute arbitrary code on a vulnerable system, by convincing a user to open a malicious PDF document.",
         "attack_vectors": [
          "Opening a specially crafted PDF document containing a /Launch action with an embedded executable."
           ],
         "required_capabilities": "Attacker needs the ability to create a specially crafted PDF document."
      },
      {
        "source": "blog.didierstevens.com_84ce6f87_20250125_183444.html",
        "content": "Thanks to a tip from @riotz, I got my PoC PDF working on Foxit Reader. Remember, Foxit Reader issues no warning when launching a command! So I get to execute an embedded .EXE without any user interaction (except for the opening of the PDF document).",
        "root_cause": "Foxit Reader's behavior of launching commands without warnings.",
       "weaknesses": [
          "Lack of user interaction before launching a command."
        ],
         "impact": "Execution of arbitrary commands leading to potential malicious code execution.",
          "attack_vectors": [
           "Opening a specially crafted PDF document containing a /Launch action with an embedded executable."
         ],
        "required_capabilities": "Attacker needs the ability to create a specially crafted PDF document."
      },
      {
        "source": "www.f-secure.com_cae879e1_20250125_183451.html",
        "content": "The perfect example is the \"Escape from PDF\" demo from Didier Stevens' blog.Users of Foxit Reader: try opening Didier's demo PDF file. After opening, it will run CMD.EXE on your system; no questions asked. And this is a legitimate PDF file which uses no exploits.",
         "root_cause": "The ability within PDF specifications to launch executables.",
        "weaknesses": [
          "PDF specification allows the launch of executables.",
           "PDF viewer applications blindly execute these commands without sufficient warning or validation."
        ],
        "impact": "Arbitrary execution of commands and/or executable code.",
        "attack_vectors": [
           "Opening a specially crafted PDF document containing a /Launch action with an embedded executable."
         ],
          "required_capabilities": "Attacker needs the ability to create a specially crafted PDF document."
      }
    ],
        "summary": "CVE-2010-1239 describes a vulnerability in PDF viewers (specifically Adobe Reader and Foxit Reader) that allows for the execution of arbitrary commands or executables embedded within a PDF document, without exploiting a specific software flaw. The vulnerability stems from the design of the PDF specification itself, which allows for a /Launch action that, when triggered, executes a specified command. Adobe Reader provides a warning dialog that can be manipulated to socially engineer the user to approve the launch, while Foxit Reader executes the command without any warnings, providing an easy vector for attackers.",
    "details": "The root cause of the vulnerability lies in the PDF specification's inclusion of a /Launch action, which is intended to launch external applications or open/print documents, as a feature. Both Adobe and Foxit Reader's handling of this action is problematic.  Adobe Reader displays a security dialog before execution, however, the message and some of the displayed content can be controlled by the PDF, enabling social engineering.  Foxit Reader, by contrast, executes the launch action silently without requiring user approval.  Didier Stevens successfully demonstrated how to embed an executable within the PDF, which could then be executed by the PDF viewer application upon opening, highlighting that the issue is not in any specific code flaw, but due to the inherent design of the PDF standard.  This \"feature\" exposes PDF readers to abuse by attackers, allowing them to potentially achieve arbitrary command execution through PDF documents.",
        "vulnerabilities": [
        "Inadequate validation and security prompts for the /Launch action.",
          "Manipulable warning messages in Adobe Reader enabling social engineering.",
        "Foxit Reader's lack of warnings or interaction when executing launch actions.",
        "Use of ShellExecute in PDF viewers to execute the /Launch action."
          ],
    "impacts": [
        "Arbitrary command execution.",
          "Execution of embedded executables.",
        "Potential for system compromise due to execution of malicious code.",
        "Social engineering attacks exploiting user trust in PDF documents."
          ],
    "attack_vectors": [
          "Email attachments or malicious downloads.",
          "Social engineering to deceive users into opening a crafted PDF document.",
           "Exploitation of web browsers that automatically open PDFs."
          ],
        "required_capabilities": "Attackers require the ability to create specially crafted PDF documents containing malicious /Launch actions and optionally embedded executables. No further exploitation capabilities are required other than social engineering to entice users to open the malicious file."
  }
}
```