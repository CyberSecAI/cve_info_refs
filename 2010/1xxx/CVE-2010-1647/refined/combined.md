=== Content from lists.wikimedia.org_f6b19a93_20250124_214944.html ===

# [MediaWiki-announce] MediaWiki security update: 1.15.4 and 1.16.0beta3

**Tim Starling**
tstarling at wikimedia.org

*Fri May 28 07:40:46 UTC 2010*

* **Messages sorted by:**
  [[ date ]](date.html#91)
  [[ thread ]](thread.html#91)
  [[ subject ]](subject.html#91)
  [[ author ]](author.html#91)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

This is a security and bugfix release of MediaWiki 1.15.4 and
MediaWiki 1.16 beta 3.

Two security vulnerabilities were discovered.

Kuriaki Takashi discovered an XSS vulnerability in MediaWiki. It
affects Internet Explorer clients only. The issue is presumed to
affect all recent versions of IE, it has been confirmed on IE 6 and 8.

Noncompliant CSS parsing behaviour in Internet Explorer allows
attackers to construct CSS strings which are treated as safe by
previous versions of MediaWiki, but are decoded to unsafe strings by
Internet Explorer. Full details can be found at:
<https://bugzilla.wikimedia.org/show_bug.cgi?id=23687>

A CSRF vulnerability was discovered in our login interface. Although
regular logins are protected as of 1.15.3, it was discovered that the
account creation and password reset features were not protected from
CSRF. This could lead to unauthorised access to private wikis. See
<https://bugzilla.wikimedia.org/show_bug.cgi?id=23371> for details.

These vulnerabilities are serious and all users are advised to
upgrade. Remember that CSRF and XSS vulnerabilities can be used even
against firewall-protected intranet installations, as long as the
attacker can guess the URL.

In addition to the security fix, MediaWiki 1.16 beta 3 also contains
many useful bug fixes to 1.16 beta 2. We expect to be able to do a
stable release of the 1.16 branch within the next week or two.

Both releases contain localisation updates courtesy of translatewiki.net.

Full release notes:
<http://svn.wikimedia.org/svnroot/mediawiki/tags/REL1_15_4/phase3/RELEASE-NOTES>
<http://svn.wikimedia.org/svnroot/mediawiki/tags/REL1_16_0beta3/phase3/RELEASE-NOTES>

**********************************************************************
   1.15.4
**********************************************************************
Download:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.tar.gz>

Patch to previous version (1.15.3), without interface text:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-i18n-1.15.4.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-1.15.4.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.15/mediawiki-i18n-1.15.4.patch.gz.sig>

Public keys:
<https://secure.wikimedia.org/keys.html>

**********************************************************************
   1.16 beta 3
**********************************************************************
Download:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.tar.gz>

Patch to previous version (1.16.0beta2), without interface text:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-i18n-1.16.0beta3.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-1.16.0beta3.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.16/mediawiki-i18n-1.16.0beta3.patch.gz.sig>

Public keys:
<https://secure.wikimedia.org/keys.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iEYEARECAAYFAkv/c34ACgkQgkA+Wfn4zXnCTgCfb7CnMBkZZpcffdUauy8i4LAV
KN4Anj41b/jPfzqZwNfmMIH1/8NMaG9/
=k2UI
-----END PGP SIGNATURE-----

```

---

* **Messages sorted by:**
  [[ date ]](date.html#91)
  [[ thread ]](thread.html#91)
  [[ subject ]](subject.html#91)
  [[ author ]](author.html#91)

---

[More information about the MediaWiki-announce
mailing list](https://lists.wikimedia.org/mailman/listinfo/mediawiki-announce)



=== Content from bugzilla.wikimedia.org_738da260_20250124_214946.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT25687)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T25687
# Differences in CSS escape sequence parsing lead to XSS on IEClosed, Resolved[Public](/policy/explain/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/view/)Actions

* [Edit Task](/maniphest/task/edit/25687/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/25687/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* [Protect as security issue](/wmf/escalate-task/25687/)
* [Award Token](/token/give/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)
* [Flag For Later](/flag/edit/PHID-TASK-v6pqy2n5zw4hsrpl2wc6/)

Assigned ToNoneAuthored By

|  | [tstarling](/p/tstarling/) |
| --- | --- |
| May 28 2010, 7:05 AM2010-05-28 07:05:00 (UTC+0) |

Tags

* [MediaWiki-Parser](/tag/mediawiki-parser/) [(Backlog)](/project/board/136/)
Referenced FilesNoneSubscribers

|  | [Raymond](/p/Raymond/) |
| --- | --- |

|  | [tstarling](/p/tstarling/) |
| --- | --- |

|  | [• wikibugs-l-list](/p/wikibugs-l-list/) |
| --- | --- |

# Description

Kuriaki Takashi discovered an XSS vulnerability in MediaWiki 1.15.3. I've prepared a patch and it will be released shortly in 1.15.4 and 1.16beta3. The fix has been committed to trunk in r66990.

I thought at the time of the 1.15.2 release that Internet Explorer did not implement CSS escape sequences. It turns out that it does, it's just that its implementation is so broken that none of my test cases worked on it. Once you actually know how it's implemented, you can construct CSS which executes arbitrary JS via expression(), but skips the filter due to parsing differences between MW and IE.

In particular, Internet Explorer uses the platform-dependent iswspace() function to determine which characters to consume at the end of a hexadecimal escape sequence like "\72". It matches 21 space-like characters in Windows XP. This is incorrect, the CSS 2.0 specification clearly lists the (ASCII-only) characters which are to be considered whitespace.

For example, using the notation <U+xxxx> for a Unicode character: MediaWiki 1.15.3 would consider a sequence like "u\72<U+3000>l(...)" to decode to the safe string "ur<U+3000>l(...)", whereas Internet Explorer would decode it to the unsafe string "url(...)".

The fix I've committed involves normalising escape sequences to a form which can be processed accurately both by compliant browsers and by Internet Explorer. Unnecessary escape sequences are replaced with literal characters, and any remaining escape sequences are terminated by an ASCII space.

---

**Version**: 1.15.x

**Severity**: major

# Details

Reference bz23687
### Event Timeline

[• bzimport](/p/bzimport/) raised the priority of this task from  to Medium.[Nov 21 2014, 11:00 PM2014-11-21 23:00:04 (UTC+0)](#268685)[• bzimport](/p/bzimport/) added a project: [MediaWiki-Parser](/tag/mediawiki-parser/).[• bzimport](/p/bzimport/) set Reference to bz23687.[• bzimport](/p/bzimport/) added a subscriber: Unknown Object (MLST).[tstarling](/p/tstarling/) created this task.[May 28 2010, 7:05 AM2010-05-28 07:05:00 (UTC+0)](#268696)[Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)
