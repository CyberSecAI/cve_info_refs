Based on the provided content, here's an analysis of CVE-2010-3771:

**Root cause of vulnerability:**
The vulnerability stems from the improper handling of `<isindex>` elements within `about:blank` pages opened via `window.open()`. Specifically, the `<isindex>` element lacked a `CheckLoadURI` check, which is necessary to validate the target URI.

**Weaknesses/vulnerabilities present:**
*   **Missing `CheckLoadURI`:** The primary weakness was the absence of a `CheckLoadURI` validation when an `<isindex>` element is used in an about:blank page. This allowed a specially crafted page to open a new window with the `about:blank` location and inject a `<isindex>` element into it. When submitted, the form would redirect to a `chrome://` document, which should not have been possible.
*   **Incorrect base URI:** The `about:blank` document had an incorrect base URI, which also contributed to the exploit. This issue is addressed in Bug 610001 according to comment 13 of the bug report provided.
*   **Privilege Escalation:** The vulnerability could be leveraged to gain a reference to a `chrome`-privileged object, which allowed for privilege escalation.

**Impact of exploitation:**
*   **Privilege Escalation:** Attackers could potentially gain chrome privileges by manipulating the `<isindex>` element in a new window with `about:blank` location
*   **Arbitrary Code Execution:**  Attackers could potentially execute arbitrary code with chrome privileges.

**Attack vectors:**
*   **Malicious Website:** An attacker could host a malicious web page that exploits this vulnerability.
*   **`window.open()` and `<isindex>`:** The attack vector involves using `window.open()` to create a new `about:blank` window and injecting a specially crafted `<isindex>` element into it

**Required attacker capabilities/position:**
*   **Website Hosting:** Ability to host a malicious website.
*   **JavaScript Knowledge:** Understanding how to use JavaScript to open windows, inject HTML and use the `isindex` tag.
*   **User Interaction (possibly):** While it might be possible to use clickjacking or other social engineering techniques, the user may need to submit the `<isindex>` form.

**Additional Details:**

*   The vulnerability was discovered by "echo" and further analyzed by Mozilla security researchers.
*   The issue was fixed by adding the missing `CheckLoadURI` call in the `nsHTMLIsIndexElement.cpp` file as indicated in the patch.
*   The fix was applied to Firefox 3.5.16, 3.6.13 and Seamonkey 2.0.11.
*   The bug report shows the fix was also backported to `mozilla-1.9.2` and `mozilla-1.9.1` release branches.
*   The severity was determined to be "critical".