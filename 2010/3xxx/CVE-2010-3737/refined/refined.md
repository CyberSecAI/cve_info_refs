- **Root cause of vulnerability**: A memory leak occurs in the application heap when User-Defined Functions (UDFs) are executed under specific conditions.
- **Weaknesses/vulnerabilities present**: The vulnerability is a memory leak. It is triggered when the client application and database server use different code pages and the DB2 connection concentrator is enabled. The connection concentrator is enabled when `max_connections` is set higher than `max_coordagents`.
- **Impact of exploitation**: Repeated execution of UDFs under the vulnerable conditions leads to memory exhaustion in the application heap, causing frequent "out of memory" errors (SQL0954C) and potentially service disruption.
- **Attack vectors**: The vulnerability is triggered by executing UDFs. An attacker would likely need to control the client application and database server configuration, especially in terms of codepage and connection concentrator settings. They would also need to repeatedly trigger UDF execution.
- **Required attacker capabilities/position**: An attacker would need to be able to control the client application, database server and be able to execute UDFs. They need to be able to set the client application and database server code pages to be different. Also, they would have to configure the server such that the connection concentrator is enabled.