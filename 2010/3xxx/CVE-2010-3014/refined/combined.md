=== Content from svn.freebsd.org_6fbe577b_20250125_205209.html ===


| **</>[[base]](/base/)** |  |
| --- | --- |

![ViewVC logotype](/*docroot*/images/viewvc-logo.png)
# Revision 210997

---

| Jump to revision: | [Previous](/base?view=revision&revision=210996 "Previous Revision") [Next](/base?view=revision&revision=210998 "Next Revision") |
| --- | --- |
| Author: | rwatson |
| Date: | Sat Aug 7 08:08:14 2010 UTC *(14 years, 5 months ago)* |
| Changed paths: | **3** |
| Log Message: | ``` Properly bounds check ioctl/pioctl data arguments for Coda:  1. Use unsigned rather than signed lengths 2. Bound messages to/from Venus to VC_MAXMSGSIZE 3. Bound messages to/from general user processes to VC_MAXDATASIZE 4. Update comment regarding data limits for pioctl  Without (1) and (3), it may be possible for unprivileged user processes to read sensitive portions of kernel memory.  This issue is only present if the Coda kernel module is loaded and venus (the userspace Coda daemon) is running and has /coda mounted.  As Coda is considered experimental and production use is warned against in the coda(4) man page, and because Coda must be explicitly configured for a configuration to be vulnerable, we won't be issuing a security advisory. However, if you are using Coda, then you are advised to apply these fixes.  Reported by:	Dan J. Rosenberg <drosenberg at vsecurity.com> Obtained from:	NetBSD (Christos Zoulas) Security:	Kernel memory disclosure; no advisory as feature experimental MFC after:	3 days   ``` |

---

## Changed paths

| Path | Details |
| --- | --- |
| [Directoryhead/sys/fs/coda/coda.h](/base/head/sys/fs/coda/coda.h?view=markup&pathrev=210997 "View File Contents") | [modified](/base/head/sys/fs/coda/coda.h?view=log&pathrev=210997 "View Log") , [text changed](/base/head/sys/fs/coda/coda.h?r1=210997&r2=210996&pathrev=210997 "View Diff") |
| [Directoryhead/sys/fs/coda/coda\_venus.c](/base/head/sys/fs/coda/coda_venus.c?view=markup&pathrev=210997 "View File Contents") | [modified](/base/head/sys/fs/coda/coda_venus.c?view=log&pathrev=210997 "View Log") , [text changed](/base/head/sys/fs/coda/coda_venus.c?r1=210997&r2=210996&pathrev=210997 "View Diff") |
| [Directoryhead/sys/fs/coda/coda\_vnops.c](/base/head/sys/fs/coda/coda_vnops.c?view=markup&pathrev=210997 "View File Contents") | [modified](/base/head/sys/fs/coda/coda_vnops.c?view=log&pathrev=210997 "View Log") , [text changed](/base/head/sys/fs/coda/coda_vnops.c?r1=210997&r2=210996&pathrev=210997 "View Diff") |

---

|  | **[ViewVC Help](/%2Adocroot%2A/help_rootview.html)** |
| --- | --- |
| Powered by [ViewVC 1.1.27](http://viewvc.org/) |  |



=== Content from cvsweb.netbsd.org_04bb935c_20250125_205207.html ===
Please note that diffs are not public domain; they are subject to the
copyright notices on the relevant files.
--- src/sys/coda/coda.h 2009/09/28 10:51:35 1.15
+++ src/sys/coda/coda.h 2010/07/20 17:26:03 1.16
@@ -1,4 +1,4 @@
-/\* $NetBSD: coda.h,v 1.15 2009/09/28 10:51:35 blymn Exp $ \*/
+/\* $NetBSD: coda.h,v 1.16 2010/07/20 17:26:03 christos Exp $ \*/
/\*
@@ -793,8 +793,8 @@ union coda\_downcalls {
#define PIOCPARM\_MASK 0x0000ffff
struct ViceIoctl {
void \*in, \*out; /\* Data to be transferred in, or out \*/
- short in\_size; /\* Size of input buffer <= 2K \*/
- short out\_size; /\* Maximum size of output buffer, <= 2K \*/
+ unsigned short in\_size; /\* Size of input buffer <= 2K \*/
+ unsigned short out\_size;/\* Maximum size of output buffer, <= 2K \*/
};
struct PioctlData {

