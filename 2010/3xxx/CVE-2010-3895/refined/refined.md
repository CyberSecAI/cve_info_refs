```
{
  "vulnerability_details": [
    {
      "root_cause": "The `esRunCommand` application executes a user-provided command as root. The `estaskwrapper` application executes the `estasklight` application after setting the `LD_LIBRARY_PATH` and `LIBPATH` environment variables if the `ES_LIBRARY_PATH` environment variable is set by the user.",
      "weaknesses": [
        "Uncontrolled execution of user-supplied commands with elevated privileges (in `esRunCommand`).",
        "Uncontrolled setting of `LD_LIBRARY_PATH` and `LIBPATH` based on user-controlled environment variable (in `estaskwrapper`)."
      ],
      "impact": "Local privilege escalation to root. Attackers can execute arbitrary commands as root using `esRunCommand`. They can also execute arbitrary code as root by setting the `ES_LIBRARY_PATH` to a directory containing a malicious library and then executing the `estaskwrapper` with `estasklight` argument.",
      "attack_vectors": [
         "Execute `esRunCommand` with an arbitrary command as an argument.",
        "Set the `ES_LIBRARY_PATH` environment variable to a malicious path, create a malicious executable named `estasklight` in a user controlled directory, and then execute the `estaskwrapper` with `estasklight` argument."
       ],
      "attacker_capabilities": "Local user access is required."
    }
  ]
}
```