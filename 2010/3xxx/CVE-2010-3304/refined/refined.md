```
Message-ID: <20100916203441.7caee871@foo.fgeek.fi>
Date: Thu, 16 Sep 2010 20:34:41 +0300
From: Henri Salo <henri@...v.fi>
To: "oss-security" <oss-security@...ts.openwall.com>
Subject: CVE-identifier request for Dovecot ACL security bug
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Can I get CVE-identifier for this issue?
"This release fixes a bug in ACL plugin, which could be considered a
security bug: If Maildir is used with default settings (INBOX is same
as Maildir root dir) and user set some ACLs to INBOX, those ACLs were
copied to all newly created mailboxes. This should have been done only
for "default ACLs", but with Maildir the INBOX directory is the same as
the default ACL directory, so this mixup happened. This bug exists only
in v1.2.x releases."
URL to announcement:
<http://www.dovecot.org/list/dovecot-news/2010-July/000163.html>
Please note that this is different issue than: CVE-2010-0745
Best regards,
Henri Salo
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
iEYEARECAAYFAkySVTEACgkQXf6hBi6kbk9r9wCgs6z72LRTcywrsWIPtRiAR/R0
fxcAoLQuYxA3NDFPsUiUhe7uTBm6c5xI
=nWSw
-----END PGP SIGNATURE-----
```

```
Message-ID: <14109729.256731284667915233.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Thu, 16 Sep 2010 16:11:55 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: coley <coley@...re.org>
Subject: Re: CVE-identifier request for Dovecot ACL security
 bug
Please use CVE-2010-3304
Thanks.
--
    JB
----- "Henri Salo" <henri@...v.fi> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Can I get CVE-identifier for this issue?
>
> "This release fixes a bug in ACL plugin, which could be considered a
> security bug: If Maildir is used with default settings (INBOX is same
> as Maildir root dir) and user set some ACLs to INBOX, those ACLs were
> copied to all newly created mailboxes. This should have been done
> only
> for "default ACLs", but with Maildir the INBOX directory is the same
> as
> the default ACL directory, so this mixup happened. This bug exists
> only
> in v1.2.x releases."
>
> URL to announcement:
> <http://www.dovecot.org/list/dovecot-news/2010-July/000163.html>
>
> Please note that this is different issue than: CVE-2010-0745
>
> Best regards,
> Henri Salo
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.9 (GNU/Linux)
>
> iEYEARECAAYFAkySVTEACgkQXf6hBi6kbk9r9wCgs6z72LRTcywrsWIPtRiAR/R0
> fxcAoLQuYxA3NDFPsUiUhe7uTBm6c5xI
> =nWSw
> -----END PGP SIGNATURE-----
```

```
[Dovecot-news] v1.2.13 released

Timo Sirainen
tss at iki.fi
Sat Jul 24 00:03:52 EEST 2010

Previous message: [Dovecot-news] v2.0.rc3 released
Messages sorted by:
[ date ]
[ thread ]
[ subject ]
[ author ]

<http://dovecot.org/releases/1.2/dovecot-1.2.13.tar.gz>
<http://dovecot.org/releases/1.2/dovecot-1.2.13.tar.gz.sig>
This release fixes a bug in ACL plugin, which could be considered a security bug: If Maildir is used with default settings (INBOX is same as Maildir root dir) and user set some ACLs to INBOX, those ACLs were copied to all newly created mailboxes. This should have been done only for "default ACLs", but with Maildir the INBOX directory is the same as the default ACL directory, so this mixup happened. This bug exists only in v1.2.x releases.
Other fixes:
- Fixed iconv() crash when it was processing several kilobytes of
broken continuous input. This mainly could have caused a problem
with IMAP SEARCH. Possibly also with some Sieve checks.
- If MIME encoded-words contained line feeds, Dovecot logged
cache corruption errors.
- mbox: Renaming mailbox under newly created dir didn't move index
directory.
- mbox: When generating envelope to From_-line, don't append a second
@owndomain if username already has one.

Previous message: [Dovecot-news] v2.0.rc3 released
Messages sorted by:
[ date ]
[ thread ]
[ subject ]
[ author ]
More information about the Dovecot-news
mailing list
```

```
[security-announce] SUSE Security Summary Report: SUSE-SR:2010:017

Ludwig Nussel
21 Sep 2010

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
______________________________________________________________________
SUSE Security Summary Report
Announcement ID: SUSE-SR:2010:017
Date: Tue, 21 Sep 2010 11:00:00 +0000
Cross-References: CVE-2010-0084, CVE-2010-0085, CVE-2010-0087
CVE-2010-0088, CVE-2010-0089, CVE-2010-0091
CVE-2010-0095, CVE-2010-0397, CVE-2010-0407
CVE-2010-0743, CVE-2010-0839, CVE-2010-0840
CVE-2010-0841, CVE-2010-0842, CVE-2010-0843
CVE-2010-0844, CVE-2010-0846, CVE-2010-0847
CVE-2010-0848, CVE-2010-0849, CVE-2010-1157
CVE-2010-1205, CVE-2010-1512, CVE-2010-1860
CVE-2010-1862, CVE-2010-1864, CVE-2010-1866
CVE-2010-1914, CVE-2010-1915, CVE-2010-1917
CVE-2010-2059, CVE-2010-2093, CVE-2010-2094
CVE-2010-2097, CVE-2010-2100, CVE-2010-2101
CVE-2010-2190, CVE-2010-2191, CVE-2010-2221
CVE-2010-2225, CVE-2010-2227, CVE-2010-2237
CVE-2010-2238, CVE-2010-2239, CVE-2010-2242
CVE-2010-2249, CVE-2010-2526, CVE-2010-2531
CVE-2010-2950, CVE-2010-2956, CVE-2010-3062
CVE-2010-3063, CVE-2010-3064, CVE-2010-3065
CVE-2010-3081, CVE-2010-3087, CVE-2010-3301
CVE-2010-3304
Content of this advisory:
1) Solved Security Vulnerabilities:
- java-1\_4\_2-ibm
- sudo
- libpng
- php5
- tgt, iscsitarget
- aria2
- pcsc-lite
- tomcat5, tomcat6
- lvm2
- libvirt
- rpm
- libtiff
- dovecot12
2) Pending Vulnerabilities, Solutions, and Work-Arounds:
- kernel
3) Authenticity Verification and Additional Information
______________________________________________________________________
1) Solved Security Vulnerabilities
To avoid flooding mailing lists with SUSE Security Announcements for minor
issues, SUSE Security releases weekly summary reports for the low profile
vulnerability fixes. The SUSE Security Summary Reports do not list or
download URLs like the SUSE Security Announcements that are released for
more severe vulnerabilities.
Fixed packages for the following incidents are already available on our FTP
server and via the YaST Online Update.
(...)
- dovecot12
When using Maildir all ACLs on INBOX were copied to newly created mailboxes
although only default ACLs should have been copied (CVE-2010-3304).
Affected Products: openSUSE 11.2, 11.3
______________________________________________________________________
2) Pending Vulnerabilities, Solutions, and Work-Arounds
- kernel
Vulnerabilities in the kernel were found that allow local users to
gain root privileges on 64bit systems. Updates for all supported
distributions are in the works (CVE-2010-3301, CVE-2010-3081).
______________________________________________________________________
3) Authenticity Verification and Additional Information
(...)
-----END PGP SIGNATURE-----
```

```
USN-1059-1: Dovecot vulnerabilities
7 February 2011

It was discovered that the ACL plugin in Dovecot would incorrectly
propagate ACLs to new mailboxes. A remote authenticated user could possibly
read new mailboxes that were created with the wrong ACL. (CVE-2010-3304)
It was discovered that the ACL plugin in Dovecot would incorrectly merge
ACLs in certain circumstances. A remote authenticated user could possibly
bypass intended access restrictions and gain access to mailboxes.
(CVE-2010-3706, CVE-2010-3707)
It was discovered that the ACL plugin in Dovecot would incorrectly grant
the admin permission to owners of certain mailboxes. A remote authenticated
user could possibly bypass intended access restrictions and gain access to
mailboxes. (CVE-2010-3779)
It was discovered that Dovecot incorrecly handled the simultaneous
disconnect of a large number of sessions. A remote authenticated user could
use this flaw to cause Dovecot to crash, resulting in a denial of service.
(CVE-2010-3780)
```

Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a flaw in the Dovecot ACL plugin when used with Maildir storage. Specifically, when using default settings where the INBOX is the same as the Maildir root directory, ACLs set on the INBOX were incorrectly copied to newly created mailboxes. This was due to a mixup where the system was not distinguishing between default ACLs and those applied directly to the INBOX.

**Weaknesses/Vulnerabilities:**
- Improper ACL handling: The core issue is that ACLs set on the INBOX were being treated as "default ACLs", and therefore being applied to new mailboxes.
- Confusion of scope: The system failed to properly distinguish between default ACLs that should be applied to new mailboxes and specific ACLs on the INBOX.

**Impact of Exploitation:**
- Unauthorized access: A remote authenticated user could gain access to new mailboxes they weren't intended to access, potentially reading their contents.
- Information disclosure: The vulnerability could result in the exposure of email content in new mailboxes to unauthorized users.

**Attack Vectors:**
- Remote: An attacker needs to be an authenticated user of the mail system.

**Required Attacker Capabilities/Position:**
- The attacker must be a valid user of the email system.
- The attacker needs the ability to set ACLs, specifically on the INBOX.
- The mail server must be configured with Maildir storage using default settings where the INBOX is the root directory.
- The vulnerable version of Dovecot (v1.2.x) must be in use.

**Additional details from the provided content:**
- The vulnerability is specific to Dovecot v1.2.x.
- The fix is included in Dovecot v1.2.13.
- This is distinct from CVE-2010-0745.
- SUSE and Ubuntu issued security notices regarding this vulnerability, affecting specific versions of their operating systems.