```
{
  "cveId": "CVE-2010-3389",
  "description": "The (1) SAPDatabase and (2) SAPInstance scripts in OCF Resource Agents (aka resource-agents or cluster-agents) 1.0.3 in Linux-HA place a zero-length directory name in the LD\\_LIBRARY\\_PATH, which allows local users to gain privileges via a Trojan horse shared library in the current working directory.",
  "vulnerabilityDetails": {
    "rootCause": "The scripts modify the LD_LIBRARY_PATH environment variable by prepending a directory to it. When the LD_LIBRARY_PATH is empty or contains only colons (::), this results in the current working directory (.) being added to the path, allowing for a potential privilege escalation by loading a malicious shared library.",
    "weaknesses": [
      "Insecure modification of LD_LIBRARY_PATH by adding an empty component, which is interpreted as the current working directory."
    ],
    "impact": "Local users can gain elevated privileges by placing a malicious shared library in a directory from which the vulnerable scripts are executed. The scripts run as root, therefore providing the attacker with root level privileges.",
    "attackVectors": [
      "Local access is required. An attacker needs to have the ability to write to a directory from which the affected script is executed by the root user"
    ],
    "attackerCapabilities": "An attacker needs to be a local user capable of writing files in a directory from which the vulnerable scripts will be executed by root."
  },
  "affectedComponents": [
    {
      "component": "OCF Resource Agents (aka resource-agents or cluster-agents) 1.0.3",
       "files": [
         "/usr/lib/ocf/resource.d/heartbeat/SAPDatabase",
         "/usr/lib/ocf/resource.d/heartbeat/SAPInstance"
        ]
    }
  ],
  "additionalNotes": "The vulnerability is present in SAPDatabase and SAPInstance scripts of the OCF resource agents.  The Debian bug report includes detailed discussion on the vulnerability and its patch implementation, showing different patch approaches before finalizing on the fix.  The bug report also describes a similar vulnerability affecting qtparted with almost identical root cause and a similar fix approach."
}
```