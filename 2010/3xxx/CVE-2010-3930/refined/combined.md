=== Content from jvndb.jvn.jp_5d354187_20250126_040938.html ===


[![JVN iPedia - Æã«Îôîñf[^x[X](/common/img/logo.gif)](/)

[ypKChz](/nav/guide_sysadm.html)

[¤ÊÆã«^CvêCWEÆÍ](http://www.ipa.go.jp/security/vuln/CWE.html)

## CWE-22

Weakness ID:22(Weakness Class)

Status: Draft

## pXEgo[T

### ðà

#### ðàvñ

O©çÌüÍÉæèpX¼ðì¬µA§À³ê½efBNgzºÉÊu·ét@CâfBNgð¯Ê·é½ßÉp¢éæ¤È\tgEFAÉ¨¢ÄApX¼ÉÜÜêéÁêÈvfÌ³ø»ªKØÉsíêÈ¢êA§À³ê½fBNgÌO¤ÌpX¼ðªÂ\Å·B

#### Ú×Èðà

§À³ê½fBNgÌOÖ²¯oµAVXeàÌ¼Ìt@CâfBNgÖÌANZXðÂ\ÉµÜ·BT^IÈÁê¶ñÌáÆµÄA»ÝÌfBNgÌefBNgÆµÄðß³êé "../" ª°çêÜ·B±êÍÎpXÌgo[TÆÄÎêÜ·BÜ½ApXgo[TÍA"/usr/local/bin" Ìæ¤ÈâÎpXàpÅ«A\úµÈ¢t@CÖÌANZXÉ«p³êÜ·B±êÍâÎpXÌgo[TÆÄÎêÜ·B

½­ÌvO~O¾êÉ¨¢ÄA¶¬³ê½pX¼ÖÌ null ¶i0 Ü½Í NULjÌ}üÍA»Ì¶È~Ì¶ñÌØèÌÄðÓ¡µÜ·BUÒÍ null ¶Ì}üÉæèAUÅ«éÌæðL°Ü·Bá¦ÎASÄÌpX¼É ".txt" ðt^·é\tgEFAÉæèUÍÍðeLXgt@CÌÝÉÀèµæ¤Æµ½êÅàAnull ¶Ì}üÉæè±Ì§ÀÍÀã³ø»³êÜ·B

### Ê¼

#### fBNggo[T

#### pXgo[T

"fBNggo[T" æèà "pXgo[T" Ìûª§³êÜ·ªA¢¸êàUÉÅ\_ðu¢½¼ÌÅ·B

### ¼Ìâ«

¼ÌÆã«Æ¯lÉA¼ÌÍª{IÈÆã«ÅÍÈ­ì·éè@ÉîÃ­±Æª èÜ·BêÅÄÎêÄ¢é"fBNggo[T"Æ¢¤¼ÌÍAfBNgðz¦éÆ¢¤ÁÊÈÓ¡ðÂ ".." yÑ¯lÌV[PXÌCWFNVÌÝÉ¾y·éàÌÅ·B

"âÎpX¼" yÑ "hCu¼" Æ¢Á½ÞÌ¼ÌÍfBNggo[TÌ\*øÊ\*ð¿Ü·ªA".."  é¢Í¯Ì¶ñÍÜÜêÈ¢½ßAfBNggo[TÆÄÎêé±ÆÍÙÆñÇ èÜ¹ñB

### Æã«Ì­¶ú

A[LeN`¨æÑÝv

À

### Y·évbgtH[

#### ¾ê

¾êÉË¶

### êÊIÈe¿

| e¿ðó¯éÍÍ | e¿ |
| --- | --- |
| ®S« | ZpICpNgF ÀÌÈ¢R[hâR}hÌÀsUÒÍAvOâCuÌæ¤ÈR[hÀsÉgp³êé@§t@CÌì¬Íã«ªÂ\Å·B |
| ®S« | ZpICpNgFt@CâfBNgÌü´ñUÒÍAvOACuâdvf[^Ìæ¤È@§t@CÌì¬Íã«ªÂ\Å·BWIÌt@CªZLeBÌJjYÉgp³êÄ¢éêAUÒÍ»ÌJjYðñð·é±ÆªÂ\ÆÈèÜ·Bá¦ÎApX[ht@CÌöÉVKAJEgðÁ¦é±ÆÅAUÒÍFØðñð·é±ÆªÂ\Å·B |
| @§« | ZpICpNgFt@CâfBNgÌÇÝæèUÒÍA\úµÈ¢t@CÌàeðÇÞ±ÆªÂ\Å èAÉéf[^ðR¦¢³¹é±ÆªÂ\Å·BWIÌt@CªZLeBÌJjYÉgp³êÄ¢éêAUÒÍ»ÌJjYðñð·é±ÆªÂ\ÆÈèÜ·Bá¦ÎApX[ht@CÌÇÝæèÉæèAUÒÍVXeÌAJEgðgpµÄNüð·é½ßÉAu[gtH[XUÉæÁÄpX[hðª·é±ÆªÂ\Å·B |
| Âp« | ZpICpNgFDoS: crash / exit / restartUÒÍvOACuâdvf[^Ìæ¤È\úµÈ¢@§t@CðAã«AíAj¹·é±ÆªÂ\Å·B±êÉæè\tgEFAÌ@\ªW°çêAFØÌæ¤ÈÛìJjYÌêÉÍA\tgEFAÌSÄÌ[UªbNAEg³êéÂ\«ª èÜ·B |

### Uðó¯éÂ\«

¢`ñíÉ¢

### oèi

©®ÃIªÍ

©®»³ê½è@ÉæèApXgo[TÌÆã«ª¶Ý·éGAðT·±ÆªÂ\Å·BêûÅApXgo[TÌÆã«ðæè­±ÆâA\tgEFAÌÇÒâÁ [U¾¯ªUªÂ\Èæ¤ÉµÄDæxðº°é½ßÉÍA\tgEFAÌ`[jOâJX^}CYªKvÆÈèÜ·B

Lø«F

è®ÃIªÍ

è®ÉæézCg{bNXè@É¨¢ÄA§ÀÔÌ§ñàÅSÄÌt@CANZXìð]¿·é±ÆªÅ«éêA\ªÈR[hÍÍðJo[µ½ãÅAtH[X|WeBuð¸­³¹é±ÆªÂ\Å·B

Lø«F

### ÆãÈR[há

#### á 1:

ÈºÌR[hÍAe[UÌvtB[îñªÂÊÌt@CÆµÄi[³êÄ¢éA\[Vlbg[LOAvP[VÌáÅ·BSÄÌt@CÍ¯êÌfBNgÉÛ¶³êÄ¢Ü·B

Tv¾êF Perl i«¢áj
```

my $dataPath = "/users/cwe/profiles";
my $username = param("user");
my $profilePath = $dataPath . "/" . $username;

open(my $fh, "<$profilePath") || ExitError("profile read error: $profilePath");
print "<ul>¥n";
while (<$fh>) {
print "<li>$_</li>¥n";
}
print "</ul>¥n;"
```

vO}Í "/users/cwe/profiles/alice" â "/users/cwe/profiles/bob" Æ¢Á½ANZXt@CðzèµÄ¢é½ßA[Up[^ÌüÍÉÍêØmFðsÁÄ¢Ü¹ñBUÒÍÈºÌæ¤È¶ñðüÍµÜ·B

iUj
```

../../../etc/passwd

```

vOÍÈºÌæ¤ÈpX¼ðì¬µÜ·B

iÊj
```

/users/cwe/profiles/../../../etc/passwd

```

t@CªJ©êéÆ«AIy[eBOVXeÍpXÌ³K»É¨¢Ä "../" Ìððs¢AÀÛÉÍÈºÌt@CÉANZXµÜ·B

iÊj
```

/etc/passwd

```

»ÌÊAUÒÍpX[ht@CÌS¶ðÇÞ±ÆªÂ\ÆÈèÜ·B

tpX¼ªüÍ³êA[UÌp[^ª¶Ý·ét@Cðì¬µÈ©Á½êA±ÌR[hª error message information leak (CWE-209) ÌÆã«àÜÞÂ\«ª é±ÆÉÓµÄ­¾³¢Bæèo³ê½t@CÌoÍGR[fBOª@µÄ¢ÄA©ÂAvtB[É HTML ªÜÜêÄ¢éêÉÍANXTCgXNveBO(CWE-79) ÌÆã«à­¶·éÂ\«ª èÜ·B»Ì½ßA{Æã«ÉY·ét@CÈOÉ¨¢Äà¸·éKvª èÜ·B
#### á 2:

ÈºÌáÅÍAVXevpeBÉæèfBNVit@CÖÌpXªÇÜêAFile IuWFNgÌú»Égp³êÜ·B

Tv¾êF Java i«¢áj
```

String filename = System.getProperty("com.domain.application.dictionaryFile");
File dictionaryFile = new File(filename);

```

µ©µ±ÌpXÍAt@CIuWFNgðì¬·éOÉÎpXââÎpXV[PXðÜÞ±Æðh®½ßÌAÃ«ÌmFâC³ªsíêÄ¢Ü¹ñB±êÉæèAVXevpeBðRg[Å«élÅ êÎAÇÌt@Cðgp·é©èÅ«Ü·BpXÍ éíÌAvP[Vâ[UÌz[fBNgÉÎµÄð³êé×«Å·B
#### á 3:

ÈºÌR[hÍAMÅ«È¢üÍðó¯æèAüÍ©ç "../" ðtB^·é½ßÉ³K\»ðgpµÄ¢Ü·B»ÌãA»ÌÊÉÎµ /home/user/ fBNgðtÁµA»ÌÅIÊÌpXàÌt@CðÇÝà¤ÆµÄ¢Ü·B

Tv¾êF Perl i«¢áj
```

my $Username = GetUntrustedInput();
$Username =" s/¥.¥.¥///;
my $filename = "/home/user/" . $Username;
ReadAndSendFile($filename);

```

ãLÌ³K\»ÅÍ g IvV (global match modifier) ðgpµÄ¢È¢½ßA­©µ½"../" ÌÅÌCX^XÌÝµÜ·B»Ì½ßAÈºÌæ¤ÈlÌüÍÉ¨¢ÄÍA

iUj
```

../../../etc/passwd

```

PÂÚÌ "../" ª³êAÈºÌÊÆÈèÜ·B

iÊj
```

../../etc/passwd

```

±ÌlÍ /home/user/ ÌãÉt^³êAÈºÌÊÆÈèÜ·B

iÊj
```

/home/user/../../etc/passwd

```

±êÉæèAIy[VVXeªpX¼ÉÜÜêé ../ V[PXððßµ½\_Å /etc/passwd t@CðÇÝæçêÜ·B±ÌâèÍ relative path traversal (CWE-23) ðø«N±µÜ·B
#### á 4:

ÈºÌR[hÍAüÍ³ê½pXÉÎµzCgXgÉæéÃ«ÌØðs¢A¢Á½ñ^¦çê½t@CÉÎµAØ³ê½íðs¢Ü·B±ÌP[XÅÍA"/safe\_dir/" Æ¢¤¶ñ©çnÜéêApXÍÃÅ éÆ»f³êÜ·B

Tv¾êFJava i«¢áj
```

String path = getInputPath();
if (path.startsWith("/safe_dir/"))
{
File f = new File(path);
f.delete()
}

```

UÒÍÌæ¤ÈüÍªÂ\Å·B
```

/safe_dir/../important.dat

```

\tgEFAÍApXª "/safe\_path/" V[PX©çnÜÁÄ¢é½ßÃÅ éÆ©ÈµÜ·ªA "../" V[PXÉæèefBNgàÌ important.dat t@CðíµÄµÜ¢Ü·B
#### á 5:

ÈºÌR[hÍAJava T[ubgÉæé§À³êÄ¢È¢t@CÌAbv[hAyÑpXgo[TÌÆã«ÌfXg[Vðs¢Ü·BHTML R[hÍAOÉ¦µ½tH[Ì action ®«ðgÁ½t@CÌAbv[hMÌáÆ¯lÌàÌÅAPHP R[hÌãíèÉ Java T[ubgðp¢½àÌÅ·B

Tv¾êFHTML iÇ¢áj
```

<form action="FileUploadServlet" method="post" enctype="multipart/form-data">

Choose a file to upload:
<input type="file" name="filename"/>
<br/>
<input type="submit" name="submit" value="Submit"/>

</form>

```

Java T[ubgÌ doPost \bhªNGXgðó¯æÁ½Æ«AHTTP NGXgwb\_©çt@C¼ðæèoµANGXg³ê½t@CÌàeðÇÝÝAt@Cð[JÌAbv[hfBNgÖoÍµÜ·B

Tv¾êFJava i«¢áj
```

public class FileUploadServlet extends HttpServlet {
...
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

response.setContentType("text/html");
PrintWriter out = response.getWriter();
String contentType = request.getContentType();

// the starting position of the boundary header
int ind = contentType.indexOf("boundary=");
String boundary = contentType.substring(ind+9);

String pLine = new String();
String uploadLocation = new String(UPLOAD_DIRECTORY_STRING); //Constant value

// verify that content type is multipart form data
if (contentType != null && contentType.indexOf("multipart/form-data") != -1) {

// extract the filename from the Http header
BufferedReader br = new BufferedReader(new InputStreamReader(request.getInputStream()));
...
pLine = br.readLine();
String filename = pLine.substring(pLine.lastIndexOf("¥¥"), pLine.lastIndexOf("¥""));
...
// output the file to the local upload directory
try {
BufferedWriter bw = new BufferedWriter(new FileWriter(uploadLocation+filename, true));
for (String line; (line=br.readLine())!=null; ) {
if (line.indexOf(boundary) == -1) {
bw.write(line);
bw.newLine();
bw.flush();
}
} //end of for loop
bw.close();

} catch (IOException ex) {...}
// output successful upload response HTML page
}
// output unsuccessful upload response HTML page
else
{...}
}
...
}

```

±ÌR[hÍAwb\_©ç^¦çê½t@C¼Ì`FbNðs¢Ü¹ñB»Ì½ßUÒÍ "../" V[PXðgpµAÓ}µ½fBNgÌOÖt@Cð«Þ±ÆªÂ\Å·BÀsÂ«ÉæÁÄÍAUÒÍCÓÌt@CÌÇÝ«âAR[hÀsANXTCgXNveBOiCWE-79jAVXeNbVAlXÈÊðà½ç·±ÆªÂ\Å·B

Ü½A±ÌR[hÍAbv[h³êét@C^CvÌ`FbNðsÁÄ¢Ü¹ñB±êÉæèAUÒÍÀst@CâA«ÓÌ éR[hðÜÞt@CðAbv[h·é±ÆªÂ\Å·iCWE-434jB
### ­©³ê½á

| QÆ | Ú× |
| --- | --- |
| [CVE-2010-0467](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0467) | Newsletter module allows reading arbitrary files using "../" sequences. |
| [CVE-2009-4194](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4194) | FTP server allows deletion of arbitrary files using ".." in the DELE command. |
| [CVE-2009-4053](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4053) | FTP server allows creation of arbitrary directories using ".." in the MKD command. |
| [CVE-2009-0244](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0244) | OBEX FTP service for a Bluetooth device allows listing of directories, and creation or reading of files using ".." sequences.. |
| [CVE-2009-4013](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4013) | Software package maintenance program allows overwriting arbitrary files using "../" sequences. |
| [CVE-2009-4449](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4449) | Bulletin board allows attackers to determine the existence of files using the avatar. |
| [CVE-2009-4581](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4581) | PHP program allows arbitrary code execution using ".." in filenames that are fed to the include() function. |
| [CVE-2010-0012](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0012) | Overwrite of files using a .. in a Torrent file. |
| [CVE-2010-0013](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0013) | Chat program allows overwriting files using a custom smiley request. |
| [CVE-2008-5748](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5748) | Chain: external control of values for user's desired language and theme enables path traversal. |

### íQÌÉaô

#### tF[YFÀ

íªF üÍÌÃ«`FbN

SÄÌüÍÍ«ÓÌ éàÌÆzèµÄ­¾³¢BdlÉµ§É]¢Â·éüÍÌzCgXgðgp·éAùmÌó¯üêçêÄ¢éüÍÌÃ«`FbNè@ðp¢Ä­¾³¢BdlÉ½·éüÍðÛ·éA é¢ÍüÍðdlÉK·é`ÉÏ»³¹Ä­¾³¢BubNXgÉË¶µÄµÜ¤A«ÓÌ éA é¢Ís³ÈüÍðT·±ÆÌÝÉçÈ¢Å­¾³¢Bµ©µAubNXgÍ\ª³êéUÌmâA³ðÉÛ·é×«s³ÈüÍðè·éÛÉð§¿Ü·B

üÍlÌÃ«ð`FbN·éÛAÖAµ»¤ÈSÄÌvfi·³AüÍ^CvAe·élÌÍÍAüÍÌßs«A\¶AÖA·étB[hÔÌêÑ«AyÑrWlX[ÌêvAjÉÂ¢Äl¶µÄ­¾³¢BrWlX[ÌáÆµÄA"boat" Ípµ©ÜÜÈ¢½ß\¶IÉLøÅ·ªAàµJ­Òª "red" â "blue" Ìæ¤ÈFÌ¼Oðzè·éêÉÍLøÅÍÈ¢AÆ¢¤WbNª°çêÜ·B

t@C¼ÉÍAgp³êé¶Zbgðµµ­§Àµ½zCgXgðgpµÄ­¾³¢BÂ\Å êÎACWE-23 Ìæ¤ÈÆã«ðh®½ßÉA"." ÌÝðt@C¼ÉÜßé±ÆðÂµACWE-36 Ìæ¤ÈÆã«ðh®½ßÉA"/" Ìæ¤ÈfBNgZp[^ðO·éæ¤§ÀµÄ­¾³¢B

xFf[^ð³Q»·éêÍAÅIÊªë¯È`®ÉÈçÈ¢æ¤ÉµÄ­¾³¢BTj^CWOÉæèA "." ¨æÑ ";" ÈÇÌë¯È¶ñð·é±ÆªÂ\Å·ªAUÒÉæèATj^CWO@\ª\©êAf[^ðë¯È`Ö "Tj^CWO" ³êéÂ\«ª èÜ·BUÒªt@C¼ "sensitiveFile" É "." ð}üµA"sensi.tiveFile" Æµ½êðzèµÜ·B Tj^CWOÉæèë¯È¶ñ "." ª³êéÆALøÈt@C¼ "sensitiveFile" ÆÈèÜ·BüÍf[^ªÀSÆ»f³ê½êAt@CÌZLeB§ÀÍNQ³êÜ·BCWE-182 (Collapse of Data Into Unsafe Value) ðQÆµÄº³¢B

#### tF[YFA[LeN`¨æÑÝv

CWE-602 ðh®½ßÉANCAg¤ÅsíêéSÄÌZLeB`FbNªT[o¤Åà¯lÉsíêÄ¢é±ÆðmFµÄ­¾³¢BUÒÍ`FbNªsíê½ ÆÉlðü´ñ·éA é¢Í`FbNð®SÉÁ·é±ÆÅANCAg¤Ì`FbNðñð·é±ÆªÂ\Å·B»ÌêAü´ñ³ê½lªT[oÉM³êÜ·B

#### tF[YFÀ

íªFüÍÌÃ«`FbN

üÍ³ê½pX¼ÌÃ«ðmF·éOÉAAvP[VÌà\»ÉfR[hµA³K»µÄº³¢BñdfR[hÉÓµÄº³¢BÃ«ÌmFÌãÉë¯ÈüÍðæèÝAzCgXgÉæéØðñð³êéÂ\«ª èÜ·B

³K»³ê½pX¼ðñ·éArhCÌpXÌ³K»ÖiáFC¾êÌ realpath() jðgpµÄ­¾³¢B ".." V[PXâV{bNNiCWE-23ACWE-59jðøÊIÉíµÜ·B³K»ÖÍÈºÌàÌðÜÝÜ·F

ECF realpath()

EJavaF getCanonicalPath()

EASP.NETF GetFullPath()

EPerlF realpath() or abs\_path()

EPHPF realpath()

#### tF[YFA[LeN`¨æÑÝv

íªF CuAt[[N

{Æã«Ì­¶ðh®A é¢Í{Æã«ðñðµâ·¢\¢ðñ·éA\ªÉ¸³ê½Cuât[[NðgpµÄ­¾³¢B

#### tF[YFIy[V

íªF t@CAEH[

{Æã«ÉÎ·éUðm·éAvP[Vt@CAEH[ðgpµÄ­¾³¢BiT[hp[eBÇÉæèjR[hªC³Å«È©Á½êÉ¨¢ÄAæèIÈ\tgEFAÌÛØèiÆÈé½ßAÙ}ñðôÆµÄAÜ½Í½whäÌÚIÆµÄøÊIÅ·B

Lø«F

AvP[Vt@CAEH[ÍSÄÌüÍxN^[ðÔ·é±ÆªÅ«È¢Â\«ª èÜ·BÁ¦ÄAüÍðØ·éÉÎµÄs³È`®ÌüÍÉæèAhäJjYðIñ·éæ¤Ès×ªÂ\Å·B@\«ÉæÁÄÍAAvP[Vt@CAEH[ÍspÓÉ³ÈNGXgðÛAÜ½ÍC³µÄµÜ¤Â\«ª èÜ·BÅIIÉAè®ÉæéJX^}CYªKvÅ·B

#### tF[YFA[LeN`¨æÑÝvAIy[V

íªF Â«Ì­»

KvÈ^XNðÀs·é½ßÉßçêéÅ¬ÀÌ ÀðgpµÄR[hðÀsµÄ­¾³¢BÂ\Å êÎAêÂÌ^XNÌÝÉgp³êéA ÀðÀèµ½PÆÌAJEgðì¬µÄ­¾³¢B»êÉæèAUª¬÷µ½êÅàA¦ÀÉ¼Ì\tgEFAâ»ÌÂ«ÖANZX³êé±ÆÍh®±ÆªÅ«Ü·Bá¦ÎAÁÉúíIÈIy[VÉ¨¢ÄAßÁ½Éf[^x[XÌÇÒ ÀðKvÆµÈ¢f[^x[XAvP[Vª°çêÜ·B

#### tF[YFA[LeN`¨æÑÝvAIy[V

íªF Ï·Éæé­§

t@C¼âURLÌæ¤ÈðÉK·éIuWFNgª§À³êÄ¢éêA é¢ÍùmÅ éêAÅèµ½üÍliÌIDj©çÀÛÌt@C¼âURLÌ}bsOðì¬µA»êÈOÌüÍðÛµÄ­¾³¢B

á¦ÎAIDPÍ "inbox.txt" ÉAIDQÍ "profile.txt" É}bvµÄ¢«Ü·BESAPI AccessReferenceMap Ìæ¤È@\Í±Ì@\ðñµÜ·B

#### tF[YFA[LeN`¨æÑÝv

íªF Th{bNXAJail

vZXÆIy[eBOVXeÌÔÅµdÈ«Eð­§·é "jail" âAÞ·éTh{bNXÂ«ÌÅR[hðÀsµÄ­¾³¢B±êÉæèAÂXÌfBNgÉ¨¢ÄÇÌt@CÉÎµANZXÂ\©A é¢ÍA»Ì\tgEFAÉæÁÄÇÌR}hªÀsÂ\©ðøÊIÉ§ÀÂ\Å·B

OSxÌáÆµÄAUnix chroot jailAAppArmor yÑ SELinux ª°çêÜ·BêÊIÉA}l[WhR[hÍ¢­Â©Ìhä@\ðñµÜ·Bá¦ÎAJava SecurityManager ÌÂ java.io.FilePermission ÍAt@CÉ¨¯é§Àðwè·é±ÆªÂ\Å·B

±êÍAÓ³íµ¢ðôÅÍÈ¢Â\«ª èÜ·BÜ½AIy[eBOVXeÖÌíQðÀè·é¾¯Å èAcèÌAvP[VÍNQÌÎÛÌÜÜÅ·B

CWE-243 yÑ»Ì¼Ì jail ÉÖA·éÆã«ÌñðÉÍÓµÄ­¾³¢B

#### tF[YFA[LeN`¨æÑÝvAìÆ

íªF UÊÌÁèÆk¬

Â\Å êÎACut@CAinclude t@CyÑ[eBeBt@CÍ web hLgÌ root ÌOÉÛÇµÄ­¾³¢B é¢ÍAUÒª¼Ú»êçÌt@Cðv·é±Æðh®½ßÉAª£µ½fBNgÉÛÇµ web T[oÌANZX§ä@\ðgpµÄ­¾³¢BêÊIÈû@ÌêÂÆµÄÍA»ê¼êÌÄÑo·vOÉÅèÌèðè`µACuâ include t@CÉèª¶Ý·é©ð`FbNµÜ·Bàµèª¶ÝµÈ¢êA»Ìt@CÍ¼Úv³ê½àÌÅ èA¦ÀÉI¹ªÂ\Å·B

±êÉæèAUÒªinclude t@CàÉÍÈ¢x[XvOàÉ éA çäéhäJjYðñð·é@ïðµ­¸­³¹é±ÆªÂ\Å·BÜ½A±êÉæèSÌÉ¨¯éUÂ\ÈÊð¸­³¹é±ÆªÂ\Å·B

#### tF[YFÀ

G[bZ[WªÎÛÆÈéÇÒÉÆÁÄÌÝLvÈAÅ¬ÀÌÚ×îñµ©ÜÜÈ¢±ÆðmFµÄ­¾³¢BbZ[WÍKxÉBÉÈéæ¤oXðæéKvª èÜ·BG[àeð»Ê·éû@ðöJ·éKvÍK¸µà èÜ¹ñB»Ìæ¤ÈÚ×îñÍUª¬÷·é@ïðâ·½ßÌUè@ÌüÇÉp³êéÂ\«ª èÜ·B

àµAG[ªÚ×ðÇÕ·éKvª éêAObZ[WÉL^·éæ¤ÉµÄ­¾³¢Bµ©µAUÒªObZ[Wð{Â\Å éêÉ½ªN±é©àl¶µÄ­¾³¢BÇñÈ`®Å ÁÄàpX[hÌæ¤ÈÉéîñªL^³êé±ÆÍð¯é×«Å·BÜ½A[U¼ªLø©Û©Æ¢Á½AUÒÉàÌ\¶ðÙÌß©µÄµÜ¤æ¤ÈAêÑ«ÌÈ¢bZ[WÉÈçÈ¢æ¤ð¯Ä­¾³¢B

pXgo[TÌwiÉ¨¢ÄApXÌîñðJ¦·éæ¤ÈG[bZ[WÍAUÒÉæét@CVXeKwðÚ®·éæ¤ÈU¶Ìì¬ð£µÄµÜ¤Â\«ª èÜ·B

#### tF[YFIy[V¨æÑÀ

íªF Â«Ì­»

PHP ðgpµÄ¢éêÍAregister\_globals ðgpµÈ¢æ¤ÉAvP[VðÝèµÄ­¾³¢BÀÉ¨¢ÄÍA±Ì@\ÉçÈ¢æ¤AvP[VðJ­µÄ­¾³¢Bregister\_globals ÌÞ@\ÌÀÉ¨¢ÄÍ CWE-95ACWE-261 yÑÞ·éÆã«ÌÎÛÆÈçÈ¢æ¤xúµÄ­¾³¢B

### »Ì¼Ìâ«

s®SÈÆã«ÌªÍÜ½ÍñÉæèAe¿ð^¦éíÌÁèª¢ïÈêª èÜ·Bá¦ÎA"..\" ÉÂ¢ÄA»ÌÆã«ªwE³êéêûA¯lÌÆã«ª é "../" ÉÂ¢ÄÍØµÄ¢È¢êª èÜ·B

ÈºÌÚÌ·×ÄÌg¹ÍpXgo[TÌíÆÈéÂ\«ª èÜ·BCVE-2004-0325 ÉÄñ³ê½ "//../" ÍAêÉÍ èÜ¹ñB

### ­¶É¨¯é¼ÌÆã«ÆÌË¶ÖW

| Ë¶ÖW | Ú× |
| --- | --- |
| Æ§I | ¼ÌÆã«ÌL³ÉÖW¹¸AÆ§µÄ­¶ |
| Ë¶I | ¼ÌÆã«ª¶Ý·é±ÆÉæè­¶ |

### ÖW«

| Nature | Type | ID | Name | View(s) this relationship pertains to |
| --- | --- | --- | --- | --- |
| ChildOf | Category | 21 | [Pathname Traversal and Equivalence Errors](http://cwe.mitre.org/data/definitions/21.html) | **Development Concepts (primary)699** |
| ChildOf | Category | 632 | [Weaknesses that Affect Files or Directories](http://cwe.mitre.org/data/definitions/632.html) | **Resource-specific Weaknesses (primary)631** |
| ChildOf | Weakness Class | 668 | [Exposure of Resource to Wrong Sphere](http://cwe.mitre.org/data/definitions/668.html) | Research Concepts1000 |
| ChildOf | Weakness Class | 706 | [Use of Incorrectly-Resolved Name or Reference](http://cwe.mitre.org/data/definitions/706.html) | **Research Concepts (primary)1000** |
| ChildOf | Category | 715 | [OWASP Top Ten 2007 Category A4 - Insecure Direct Object Reference](http://cwe.mitre.org/data/definitions/715.html) | **Weaknesses in OWASP Top Ten (2007) (primary)629** |
| ChildOf | Category | 723 | [OWASP Top Ten 2004 Category A2 - Broken Access Control](http://cwe.mitre.org/data/definitions/723.html) | **Weaknesses in OWASP Top Ten (2004) (primary)711** |
| ChildOf | Category | 743 | [CERT C Secure Coding Section 09 - Input Output (FIO)](http://cwe.mitre.org/data/definitions/743.html) | **Weaknesses Addressed by the CERT C Secure Coding Standard (primary)734** |
| ChildOf | Category | 802 | [2010 Top 25 - Risky Resource Management](http://cwe.mitre.org/data/definitions/802.html) | **Weaknesses in the 2010 CWE/SANS Top 25 Most Dangerous Programming Errors(primary)800** |
| ChildOf | Category | 813 | [OWASP Top Ten 2010 Category A4 - Insecure Direct Object References](http://cwe.mitre.org/data/definitions/813.html) | **Weaknesses in OWASP Top Ten (2010)(primary)809** |
| ParentOf | Weakness Base | 23 | [Relative Path Traversal](http://cwe.mitre.org/data/definitions/23.html) | **Development Concepts (primary)699** |
| **Research Concepts (primary)1000** |
| ParentOf | Weakness Base | 36 | [Absolute Path Traversal](http://cwe.mitre.org/data/definitions/36.html) | **Development Concepts (primary)699** |
| **Research Concepts (primary)1000** |
| MemberOf | View | 635 | [Weaknesses Used by NVD](http://cwe.mitre.org/data/definitions/635.html) | **Weaknesses Used by NVD (primary)635** |
| CanFollow | Weakness Class | 20 | [Improper Input Validation](http://cwe.mitre.org/data/definitions/20.html) | Research Concepts1000 |
| CanFollow | Weakness Class | 73 | [External Control of File Name or Path](http://cwe.mitre.org/data/definitions/73.html) | Research Concepts1000 |
| CanFollow | Weakness Class | 172 | [Encoding Error](http://cwe.mitre.org/data/definitions/172.html) | Research Concepts1000 |

### ÖW«Ìâ«

pX¼Ì¯lÍA³K»G[ÌêíÆÝÈ³êéêª èÜ·B

pX¼Æ¯ÌâèÌ¤¿Ì¢­Â©ÍA¼ÚIÉÍfBNggo[TÆÖWÍÈ­AÞµëAUÒ©çÌt@CAfBNgÖÌANZXÂÛð»f·é½ßÌZLeBÖAÌ`FbNðñð·é½ßÉp³êÄ¢Ü·B

### v²¸ iCWE Ì©ðj

pXgo[TUÌ½­ÌíÞÉ¨¢ÄÍArootªø«N±·àÌÉÖµÄ¢¾¤Å·BCWE-790 yÑ CWE-182 Í±ÌMbvÌêðßnßÄ¢Ü·B

### e¿ðó¯éVXe\[X

t@C/fBNg

### ÖA·évpeB

Equivalence

### @\ªì

t@C

### ´öÌ«¿

¾m

### ¼gDÅÌªÞ

| gD¼Ü½ÍgDÅÌªÞ | m[h ID | CWEÌªÞÆÌKx | ªÞ¼ |
| --- | --- | --- | --- |
| PLOVER |  |  | Path Traversal |
| OWASP Top Ten 2007 | A4 | CWEÌûªÚ× | Insecure Direct Object Reference |
| OWASP Top Ten 2004 | A2 | CWEÌûªÚ× | Broken Access Control |
| CERT C Secure Coding | FIO02-C |  | Canonicalize path names originating from untrusted sources |
| WASC | 33 |  | Path Traversal |

### ÖA·éUp^[

| CAPEC-ID | Up^[¼ (CAPEC Version 1.5) |
| --- | --- |
| [23](http://capec.mitre.org/data/definitions/23.html) | File System Function Injection, Content Based |
| [64](http://capec.mitre.org/data/definitions/64.html) | Using Slashes and URL Encoding Combined to Bypass Validation Logic |
| [78](http://capec.mitre.org/data/definitions/78.html) | Using Escaped Slashes in Alternate Encoding |
| [79](http://capec.mitre.org/data/definitions/79.html) | Using Slashes in Alternate Encoding |
| [76](http://capec.mitre.org/data/definitions/76.html) | Manipulating Input to File System Calls |
| [139](http://capec.mitre.org/data/definitions/139.html) | Relative Path Traversal |

### QÆ

[REF-11] M. Howard and D. LeBlanc. "Writing Secure Code". Chapter 11, "Directory Traversal and Using Parent Paths (..)" Page 370. 2nd Edition. Microsoft. 2002.

[REF-17] OWASP. "OWASP Enterprise Security API (ESAPI) Project". <http://www.owasp.org/index.php/ESAPI>.

OWASP. "Testing for Path Traversal (OWASP-AZ-001)". <http://www.owasp.org/index.php/Testing\_for\_Path\_Traversal\_(OWASP-AZ-001)>.

Johannes Ullrich. "Top 25 Series - Rank 7 - Path Traversal". SANS Software Security Institute. 2010-03-09. <http://blogs.sans.org/appsecstreetfighter/2010/03/09/top-25-series-rank-7-path-traversal/>.

### XVð

[2011N0421ú]

  2010N1012ú\_Ìf[^ð³ÉXV

[2009N0629ú]

  2009N0202ú\_ÌºL URL ð³Éì¬

    <http://cwe.mitre.org/data/definitions/22.html>

---

o^ú 2011/04/21

ÅIXVú 2023/04/04

---

* ![JVN](/common/img/t_rnav_jvn.gif)
* [![HOME](/common/img/r_nav_1.gif)](https://jvn.jp/)
* [![JVNÆÍ](/common/img/r_nav_2.gif)](https://jvn.jp/nav/jvn.html)
* [![Æã«|[gÌÇÝû](/common/img/r_nav_3.gif)](https://jvn.jp/nav/jvnhelp.html)
* [![Æã«|[gê](/common/img/r_nav_4.gif)](https://jvn.jp/report/index.html)
* [![VN_JP](/common/img/r_nav_4_1.gif)](https://jvn.jp/jp/index.html)
* [![VN_JP As\](/common/img/r_nav_4_4.gif)](https://jvn.jp/adj/index.html)
* [![VN_VU](/common/img/r_nav_4_2.gif)](https://jvn.jp/vu/index.html)
* [![TA](/common/img/r_nav_4_3.gif)](https://jvn.jp/ta/index.html)
* [![TRnotes](/common/img/r_nav_5.gif)](https://jvn.jp/tr/index.html)
* [![JVN iPedia - Æã«Îôîñf[^x[X](/common/img/r_nav_10.gif)](/index.html)
* [![Æã«Îôîñf[^x[Xõ](/common/img/r_nav_10_1.gif)](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=ja)
* [![JVN iPediaÆÍ](/common/img/r_nav_10_2.gif)](/nav/jvndb.html)
* [![g¢û](/common/img/r_nav_10_3.gif)](/nav/jvndbhelp.html)
* [![MyJVN](/common/img/r_nav_10_4.gif)](/apis/myjvn/index.html)
* [![JVNJS/RSS](/common/img/r_nav_6.gif)](https://jvn.jp/rss/index.html)
* [![x_îñê](/common/img/r_nav_7.gif)](https://jvn.jp/nav/index.html)
* [![As\J­Òê](/common/img/r_nav_11.gif)](https://jvn.jp/reply/index.html)
* [![Æã«îñÌÍo](/common/img/r_nav_8.gif)](https://www.ipa.go.jp/security/vuln/report/)
* [![¨â¹æ](/common/img/r_nav_9.gif)](https://jvn.jp/contact/index.html)

[![CVEÝ·](/common/img/comp_compatible.gif)](https://cve.mitre.org/compatible/compatible.html#j)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from jvndb.jvn.jp_6906eca6_20250124_223503.html ===


[![JVN iPedia - Æã«Îôîñf[^x[X](/common/img/logo.gif)](/)
ÅIXVúF2011/01/26

[ypKChz](/nav/guide_sysadm.html)

| [[English]](/en/contents/2011/JVNDB-2011-000009.html) | |
| --- | --- |
| JVNDB-2011-000009 | |
| MODx Evolution É¨¯éfBNggo[TÌÆã« | |
| Tv | |
| MODx Evolution ÉÍAfBNggo[TÌÆã«ª¶ÝµÜ·B  MODx Evolution ÍAModx CMS Project ªñ·éRecÇVXe (CMS) Å·BMODx Evolution ÉÍAfBNggo[TÌÆã«ª¶ÝµÜ·B | |
|  | |
| CVSS Éæé[x ([CVSS ÆÍ?](/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS v2 Éæé[xî{l: [5.0](/cvss/ja/v2.html#AV:N/AC:L/Au:N/C:P/I:N/A:N) (x) [IPAl]**  * U³æª: lbg[N * UðÌ¡G³: á * UOÌFØvÛ: sv * @§«ÖÌe¿(C): ªI * ®S«ÖÌe¿(I): Èµ * Âp«ÖÌe¿(A): Èµ | |
| e¿ðó¯éVXe | |
|  | |
| MODX  * MODX Evolution 1.0.4 ¨æÑ»êÈO | |
|  | |
| zè³êée¿ | |
|  | |
| Îô | |
|  | |
| x\_îñ | |
| MODX  * MODX : [MODX Evolution 1.0.5 Tightens Security and Lots of Little Improvements](http://modxcms.com/forums/index.php/topic%2C60045.0.html) * MODX : [Get the latest MODx releases](http://modxcms.com/download) * MODX : [MODx Evolution 1.0.5 ú{êÅ](http://modx.jp/download/download_evo.html) | |
| CWEÉæéÆã«^Cvê  [CWEÆÍ?](http://www.ipa.go.jp/security/vuln/CWE.html) | |
| 1. [pXEgo[T(CWE-22)](https://jvndb.jvn.jp/ja/cwe/CWE-22.html) [IPA]¿] | |
| ¤ÊÆã«¯Êq(CVE)  [CVEÆÍ?](http://www.ipa.go.jp/security/vuln/CVE.html) | |
| 1. [CVE-2010-3930](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3930) | |
| Qlîñ | |
|  | |
| XVð | |
|  | |

| --- | |
| --- | --- |
| ö\ú | 2011/01/26 |
| o^ú | 2011/01/26 |
| ÅIXVú | 2011/01/26 |
| --- | |

* ![JVN](/common/img/t_rnav_jvn.gif)
* [![HOME](/common/img/r_nav_1.gif)](http://jvn.jp/)
* [![JVNÆÍ](/common/img/r_nav_2.gif)](http://jvn.jp/nav/jvn.html)
* [![Æã«|[gÌÇÝû](/common/img/r_nav_3.gif)](http://jvn.jp/nav/jvnhelp.html)
* [![Æã«|[gê](/common/img/r_nav_4.gif)](http://jvn.jp/report/index.html)
* [![VN_JP](/common/img/r_nav_4_1.gif)](http://jvn.jp/jp/index.html)
* [![VN_JP As\](/common/img/r_nav_4_4.gif)](http://jvn.jp/adj/index.html)
* [![VN_VU](/common/img/r_nav_4_2.gif)](http://jvn.jp/vu/index.html)
* [![TA](/common/img/r_nav_4_3.gif)](http://jvn.jp/ta/index.html)
* [![TRnotes](/common/img/r_nav_5.gif)](http://jvn.jp/tr/index.html)
* [![JVN iPedia - Æã«Îôîñf[^x[X](/common/img/r_nav_10.gif)](/index.html)
* [![Æã«Îôîñf[^x[Xõ](/common/img/r_nav_10_1.gif)](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=ja)
* [![JVN iPediaÆÍ](/common/img/r_nav_10_2.gif)](/nav/jvndb.html)
* [![g¢û](/common/img/r_nav_10_3.gif)](/nav/jvndbhelp.html)
* [![MyJVN](/common/img/r_nav_10_4.gif)](/apis/myjvn/index.html)
* [![JVNJS/RSS](/common/img/r_nav_6.gif)](http://jvn.jp/rss/index.html)
* [![x_îñê](/common/img/r_nav_7.gif)](http://jvn.jp/nav/index.html)
* [![As\J­Òê](/common/img/r_nav_11.gif)](http://jvn.jp/reply/index.html)
* [![Æã«îñÌÍo](/common/img/r_nav_8.gif)](http://www.ipa.go.jp/security/vuln/report/)
* [![¨â¹æ](/common/img/r_nav_9.gif)](http://jvn.jp/contact/index.html)

[![CVEÝ·](/common/img/comp_compatible.gif)](http://cve.mitre.org/compatible/compatible.html#j)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from jvn.jp_25228219_20250124_223501.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2011/01/26  Last Updated:2011/01/26
# JVN#95385972 MODx Evolution vulnerable to directory traversal

## Overview

MODx Evolution contains a directory traversal vulnerability.

## Products Affected

* MODx Evolution 1.0.4 and earlier

## Description

MODx provided by the MODx CMS Project is a Content Management System (CMS) software. MODx contains a directory traversal vulnerability.

## Impact

A remote attacker may access or view arbitrary files on the server.

## Solution

**Update the software**
Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| The MODx CMS Project | [MODX Evolution 1.0.5 Tightens Security and Lots of Little Improvements](http://modxcms.com/forums/index.php/topic%2C60045.0.html) |
|  | [Get the latest MODx releases](http://modxcms.com/download/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

**Analyzed on 2011.01.26**

| Measures | Conditions | Severity |
| Access Required | can be attacked over the Internet using packets | * High |
| Authentication | anonymous or no authentication (IP addresses do not count) | * High |
| User Interaction Required | the vulnerability can be exploited without an honest user taking any action | * High |
| Exploit Complexity | some expertise and/or luck required (most buffer overflows, guessing correctly in small space, expertise in Windows function calls) | * Mid-High |

[Description of each analysis measures](http://jvn.jp/en/nav/jvnhelp.html#analysys)

## Credit

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2010-3930](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3930) |
| JVN iPedia | [JVNDB-2011-000009](http://jvndb.jvn.jp/jvndb/JVNDB-2011-000009) |

* JVN
* HOME
* What is JVN ?
* Instructions
* List of Vulnerability Report
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* TRnotes
* JVN iPedia
* MyJVN
* JVNJS/RSS
* Vendor List
* List of unreachable developers
* Contact

Copyright (c) 2000-2011 JPCERT/CC and IPA. All rights reserved.


