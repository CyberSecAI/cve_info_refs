```
{
  "vulnerability": {
    "root_cause": "The INET_DIAG subsystem in the Linux kernel was inconsistent in how it looked up bytecode contained in a netlink message. It used nlmsg_find_attr() for auditing, but then used the first attribute when running the bytecode, potentially running unaudited bytecode.",
    "weaknesses": [
      "Inconsistent handling of bytecode lookup",
      "Execution of unaudited bytecode"
    ],
    "impact": "An attacker could cause the kernel to execute unaudited INET_DIAG bytecode, leading to a denial of service (e.g., infinite loop) and potentially other consequences.",
    "attack_vectors": {
      "vector_description": "By sending a crafted netlink message containing multiple attribute elements where only the second has type INET_DIAG_REQ_BYTECODE. The kernel would validate the bytecode from the second element but execute bytecode from the first.",
      "required_capabilities": "Local user access to the system."
     },
    "additional_details": "The vulnerability existed because `nlmsg_find_attr()` was used for bytecode auditing, but the first attribute was used when actually running the bytecode. This inconsistency allowed an attacker to bypass the auditing process. The fix consistently uses `nlmsg_find_attr()` for all bytecode lookups."
  }
}
```