=== Content from www.openwall.com_fdb3e384_20250125_040908.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2013/04/10/5) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <51661DD5.6060708@redhat.com>
Date: Wed, 10 Apr 2013 20:20:05 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: Open Source Security <oss-security@...ts.openwall.com>
Subject: CVE-2010-5109 libytnef buffer overflow

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

So the nice folks at iSIGHT Partners caught this and notified me.

<http://lists.fedoraproject.org/pipermail/package-announce/2012-July/083853.html>

<http://lists.fedoraproject.org/pipermail/package-announce/2012-July/083804.html>

<https://bugzilla.redhat.com/show_bug.cgi?id=831322>

<http://sourceforge.net/p/ytnef/bugs/13/>

Please use CVE-2010-5109 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRZh3VAAoJEBYNRVNeJnmTKpQQAIqEm83FKFq5r8vpH6tf7m/F
lq9FIT8yE4raldIgDSHhJHhLsNrh3yFrGc06tPddLLfVkNbPnPAdtKjilmMoNIPt
abnPzwngKiui846wKlYFxt5/hEvgOSmvM15rdUXrcn3wHd/gnAAYFysynyGJZlRw
ANkuLeIhkKWf1NBEjJCaxFsmk/D4nNsxhpj1ccPkmvgMMws59ias8DeCE2xdu0MS
5Lb9zsrj9ewhoef6pt6arVfVqBJy4O8b/RIcPulw+F155VEvKQmbIHJ+HjuIloMx
y9mBD2Ax3KxPtYgx6fYzj6mTNvk6oEBFHTITHCPffYGciZb0p36NYsWBrXlrmBRZ
UqDVTF9NKkRZA3ULeX3MNDy1KDBYgL6xVXi43hHnuFsq2uE3kQZdrnErDOW0F0lq
IbZuS5bSYGfWGAz69CoZ67uxoxQ58FyDWG2hGdxCurFGT6xqJvddFi8lzfPbnaQK
ebEK6ShRe8JSQsBsl2W3lyG6O0nkxkq1RUCRkQtWMXhwV2I4TQNN4cSrCko8lGjm
GBOp30aUp2nzwPJTJTmgyKylsJquGXJdLbFVhaoLmjo4iMRtrm6G+DqPtF5vYhyD
u9qqDtOkJgv40Ifbcc/VoQq3jwK65savIHuZLF/zlJBWXxcjR8dV9wxDeOt7Ladn
B10gwdklHGCTSFQtVXtf
=dPsg
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_7d6184c2_20250126_055152.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D831322)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D831322)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D831322)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 831322

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 831322**](show_bug.cgi?id=831322)
(CVE-2010-5109)
- [PATCH] fix possible buffer overflow

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
[PATCH] fix possible buffer overflow

| | [Keywords](describekeywords.cgi): |  | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2010-5109 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | libytnef | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | rawhide | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Andreas Bierfert | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://sourceforge.net/tracker/?func=...](http://sourceforge.net/tracker/?func=detail&aid=2949686&group_id=70352&atid=527487) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=831322&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=831322&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-06-12 19:03 UTC by Igor Vlasenko | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2013-04-11 02:21 UTC ([History](show_activity.cgi?id=831322)) | | [CC List:](page.cgi?id=fields.html#cclist) | 2 users (show)  andreas.bierfert ppisar | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Clones: | [838449](show_bug.cgi?id=838449 "CLOSED RAWHIDE - [PATCH] fix possible buffer overflow")  ([view as bug list](buglist.cgi?bug_id=838449)) | | | Environment: |  | | | Last Closed: | 2012-07-14 21:53:07 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**proposed patch to fix possible buffer overflows.**](attachment.cgi?id=591258 "View the content of the attachment") (422 bytes, patch)  [2012-06-12 19:03 UTC](#attach_591258 "Go to the comment associated with the attachment"), Igor Vlasenko | *no flags* | [Details](attachment.cgi?id=591258&action=edit) | [Diff](attachment.cgi?id=591258&action=diff) | | [**Better fix for the heap overflow**](attachment.cgi?id=596239 "View the content of the attachment") (1.02 KB, patch)  [2012-07-04 15:10 UTC](#attach_596239 "Go to the comment associated with the attachment"), Petr Pisar | *no flags* | [Details](attachment.cgi?id=596239&action=edit) | [Diff](attachment.cgi?id=596239&action=diff) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=831322&action=viewall&hide_obsolete=1) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=831322#c0)  Igor Vlasenko    2012-06-12 19:03:45 UTC  ``` Created [attachment 591258](attachment.cgi?id=591258&action=diff "proposed patch to fix possible buffer overflows.") [[details]](attachment.cgi?id=591258&action=edit "proposed patch to fix possible buffer overflows.") proposed patch to fix possible buffer overflows.  Description of problem: compiler warning: call ... will always overflow destination buffer. indeed, there is a trivial bug in the code, no space is reserved for trailing \0. patch to fix: --- libytnef-1.5/ytnef.c        2004-08-26 17:09:05.000000000 +0000 +++ libytnef-1.5/ytnef.c        2012-06-08 19:34:07.826123387 +0000 @@ -1327,7 +1327,7 @@      ULONG compressedSize, uncompressedSize, magic, crc32;        comp_Prebuf.size = strlen(RTF_PREBUF); -    comp_Prebuf.data = calloc(comp_Prebuf.size, 1); +    comp_Prebuf.data = calloc(comp_Prebuf.size+1, 1);      strcpy(comp_Prebuf.data, RTF_PREBUF);        src = p->data;   Version-Release number of selected component (if applicable): libytnef-1.5-7.fc17   ```  [Comment 1](show_bug.cgi?id=831322#c1)  Petr Pisar    2012-07-04 13:59:40 UTC  ``` The comp_Prebuf.data[] is never accessed beyond the end. I think more suitable is do memcpy() instead of strcpy() to copy comp_Prebuf.size only bytes without the trailing zero.  Actually the comp_Prebuf.data is never freed which leaks memory.   ```  [Comment 2](show_bug.cgi?id=831322#c2)  Petr Pisar    2012-07-04 14:07:56 UTC  ``` This issue has been already tracked by upstream <<http://sourceforge.net/tracker/?func=detail&aid=2949686&group_id=70352&atid=527487>>.   ```  [Comment 3](show_bug.cgi?id=831322#c3)  Petr Pisar    2012-07-04 14:40:26 UTC  ``` Reproducer:  (1) Obtain a tnef archive with binary document (e.g. the winmail.dat from <<http://sourceforge.net/tracker/?func=detail&aid=756215&group_id=70352&atid=533948>>).  (2) Explore the archive with ytnefprint tool (from ytnef package) that uses the libytnef library:  $ ytnefprint winmail.dat Attempting to parse winmail.dat... ---> In TNEF1.0 format Message Priority: normal Date Received: Tuesday June 17, 2003 10:23:00 am Message Class: IPM.Microsoft Mail.Note     MAPI Properties: 39    #0: Type: [ BOOLEAN ]  Code: [PR_ALTERNATE_RECIPIENT_ALLOWED]     Size: 4    Value: True    #1: Type: [ BOOLEAN ]  Code: [PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED]     Size: 4    Value: False    #2: Type: [  LONG   ]  Code: [PR_PRIORITY]     Size: 4    Value: 0    #3: Type: [ BOOLEAN ]  Code: [PR_READ_RECEIPT_REQUESTED]     Size: 4    Value: False    #4: Type: [  LONG   ]  Code: [PR_SENSITIVITY]     Size: 4    Value: 0    #5: Type: [ STRING8 ]  Code: [PR_CONVERSATION_TOPIC]     Size: 5    Value: [test]    #6: Type: [ BINARY  ]  Code: [PR_CONVERSATION_INDEX]     Size: 22    Value: [..4.p...s,j~O...I....L]    #7: Type: [ BINARY  ]  Code: [PR_SENDER_SEARCH_KEY]     Size: 26    Value: [SMTP:JGERLAND.]    #8: Type: [ BOOLEAN ]  Code: [PR_DELETE_AFTER_SUBMIT]     Size: 4    Value: False    #9: Type: [SYS TIME ]  Code: [PR_MESSAGE_DELIVERY_TIME]     Size: 8    Value: Tuesday June 17, 2003 3:23:00 pm    #10: Type: [ BINARY  ]  Code: [PR_SENTMAIL_ENTRYID]     Size: 24    Value: [......3.v#'N..I..G......]    #11: Type: [  LONG   ]  Code: [PR_SUBMIT_FLAGS]     Size: 4    Value: 0    #12: Type: [ BOOLEAN ]  Code: [PR_RTF_IN_SYNC]     Size: 4    Value: True    #13: Type: [ BINARY  ]  Code: [PR_RTF_COMPRESSED]     Size: 217    Detected Compressed RTF.Decompressed text follows -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- *** buffer overflow detected ***: ytnefprint terminated ======= Backtrace: ========= /lib64/libc.so.6(__fortify_fail+0x37)[0x3045708af7] /lib64/libc.so.6[0x3045706a70] /usr/lib64/libytnef.so.0(DecompressRTF+0x3a)[0x3045a0470a] /usr/lib64/libytnef.so.0(MAPIPrint+0x4c8)[0x3045a04e08] ytnefprint[0x4010e9] ytnefprint[0x400909] /lib64/libc.so.6(__libc_start_main+0xed)[0x304562169d] ytnefprint[0x40097d]   ```  [Comment 4](show_bug.cgi?id=831322#c4)  Petr Pisar    2012-07-04 14:53:35 UTC  ``` One need to configure with CFLAGS='-O2 -g -Wp,-D_FORTIFY_SOURCE=2' to provoke the abort.   ```  [Comment 5](show_bug.cgi?id=831322#c5)  Petr Pisar    2012-07-04 15:10:12 UTC  ``` Created [attachment 596239](attachment.cgi?id=596239&action=diff "Better fix for the heap overflow") [[details]](attachment.cgi?id=596239&action=edit "Better fix for the heap overflow") Better fix for the heap overflow  This fixes the bug by copying only needed bytes.   ```  [Comment 6](show_bug.cgi?id=831322#c6)  Fedora Update System    2012-07-04 17:12:50 UTC  ``` libytnef-1.5-8.fc17 has been submitted as an update for Fedora 17. <https://admin.fedoraproject.org/updates/libytnef-1.5-8.fc17>   ```  [Comment 7](show_bug.cgi?id=831322#c7)  Fedora Update System    2012-07-04 17:12:59 UTC  ``` libytnef-1.5-8.fc16 has been submitted as an update for Fedora 16. <https://admin.fedoraproject.org/updates/libytnef-1.5-8.fc16>   ```  [Comment 8](show_bug.cgi?id=831322#c8)  Fedora Update System    2012-07-05 23:30:55 UTC  ``` Package libytnef-1.5-8.fc17: * should fix your issue, * was pushed to the Fedora 17 testing repository, * should be available at your local mirror within two days. Update it with: # su -c 'yum update --enablerepo=updates-testing libytnef-1.5-8.fc17' as soon as you are able to. Please go to the following url: <https://admin.fedoraproject.org/updates/FEDORA-2012-10250/libytnef-1.5-8.fc17> then log in and leave karma (feedback).   ```  [Comment 9](show_bug.cgi?id=831322#c9)  Fedora Update System    2012-07-14 21:53:07 UTC  ``` libytnef-1.5-8.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 10](show_bug.cgi?id=831322#c10)  Fedora Update System    2012-07-14 22:02:55 UTC  ``` libytnef-1.5-8.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 11](show_bug.cgi?id=831322#c11)  Kurt Seifried    2013-04-11 02:21:16 UTC  ``` Added CVE as per <http://openwall.com/lists/oss-security/2013/04/11/1>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=831322&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


