=== Content from blog.mozilla.com_07520ab6_20250124_225130.html ===

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav "Visit mozilla.org")
Menu

* [About Mozilla](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)
* [Products](https://www.mozilla.org/firefox/products/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)
* [Give](https://donate.mozilla.org/?presets=50,30,20,10&amount=30&currency=usd&utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)
* [Discover Firefox](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)

[#### Mozilla Security Blog](https://blog.mozilla.org/security/ "Go to the front page")

* Search this site

  Search

**Categories:**
[Announcements](https://blog.mozilla.org/security/category/announcements/) [Privacy](https://blog.mozilla.org/security/category/privacy/)
# Plugging the CSS History Leak

mozilla
March 31, 2010

[67 responses](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comments)

### Privacy isnâ€™t always easy.

Weâ€™re close to landing some changes in the Firefox development tree that will fix a privacy leak that browsers have been struggling with for some time. Weâ€™re really excited about this fix, we hope other browsers will follow suit. Itâ€™s a tough problem to fix, though, so Iâ€™d like to describe how we ended up with this approach.

#### History Sniffing

![Visited and Unvisited Links](//blog.mozilla.org/security/files/2010/03/visitedunvisited.png "visitedunvisited")Links can look different on web sites based on whether or not youâ€™ve visited the page they reference. Youâ€™ve probably seen this before: in some cases, visited links are purple instead of blue. This is just one of the many features web designers use to make the web the best it can be, and for the most part thatâ€™s a good thing.

The problem is that appearance can be detected by the page showing you links, cluing the page into which of the presented pages youâ€™ve been to. The result: not only can you see where youâ€™ve been, but so can the web site!

Originally specified as a useful feature for the Web, visited link styling has been part of the web forâ€¦ well, forever. So this is a pretty old problem, and resurfaces every once in a while to generate [more](http://startpanic.com/) [paranoid](http://www.haveyourfriendsbeenthere.com/) [netizens](http://caughtyouwatching.com/).

The most obvious fix is to disable different styles for visited versus unvisted links, but this would be employed at the expense of utility: while sites can no longer figure out which links youâ€™ve clicked, neither can you. David Baron has implemented [a way to help keep usersâ€™ data private while minimizing the effect on the web](http://dbaron.org/mozilla/visited-privacy), and we are deploying it to protect our users. We think this represents the best solution to the problem, and weâ€™ll be delighted if other browsers approach this the same way.

### Technical Details.

The biggest threats here are the high-bandwidth techniques, or those that extract lots of information from usersâ€™ browsers quickly. These are particularly worrisome since they enable not only very focused attacks, but also the widespread brute-force attacks that are, in general, more useful to a variety of attackers (potentially including [fingerprinting](http://panopticlick.eff.org)).

The JavaScript function getComputedStyle() and its related functions are *fast* and can be used to guess visitedness at [hundreds of thousands of links per minute](http://cssfingerprint.com/results). To make it harder for web sites to figure out where youâ€™ve been without radically changing the web, weâ€™re approaching the way we style links in three fairly subtle ways:

**Change 1: Layout-Based Attacks**

First of all, weâ€™re limiting what types of styling can be done to visited links to differentiate them from unvisited links. Visited links can only be different in color: foreground, background, outline, border, SVG stroke and fill colors. All other style changes either leak the visitedness of the link by loading a resource or changing position or size of the styled content in the document, which can be detected and used to identify visited links.

While we are changing what is allowed in CSS, the CSS 2.1 specification takes into consideration how visited links can be abused:

> â€œUAs may therefore treat all links as unvisited links, or implement other measures to preserve the userâ€™s privacy while rendering visited and unvisited links differently.â€ [[CSS 2 Specification](http://www.w3.org/TR/CSS2/)]

**Change 2: Some Timing Attacks**

Next, we are changing some of the guts of our layout engine to provide a fairly uniform flow of execution to minimize differences in layout time for visited and unvisited links. The changes cause all styles to be resolved on all links for both visited and unvisited states, and it is stored; then, when the link is styled, the appropriate set of styles is chosen making the code paths for visited and unvisited links essentially the same length. This should eliminate some of the easy-to-mount timing attacks.

**Change 3: Computed Style Attacks**

JavaScript is not going to have access to the same style data it used to. When a web page tries to get the computed style of a link (or any of its sub-elements), Firefox will give it unvisited style values.

### What does this mean for users?

For the most part, users shouldnâ€™t notice a change in how the web works. A few web sites may look a little different, but visited links will still show up differently colored. A few sites that use more than color to differentiate visited links may look slightly broken at first while they adjust to these changes, but we think itâ€™s the right trade-off to be sure we protect our usersâ€™ privacy. This is a troubling and well-understood attack; as much as we hate to break any portion of the web, we need to shut the attack down to the extent we can.

We have to be realistic, though: there are many ways all browsers leak information about you, and fixing CSS history sniffing [will not block all of these leaks](http://dbaron.org/mozilla/visited-privacy#limits). But we believe itâ€™s important to stop the scariest, most effective history attacks any way we can since it will be a big win for usersâ€™ privacy.

If the remaining attacks worry you, or you canâ€™t wait for us to ship this fix, version 3.5 and newer versions of Firefox already allow you to disable all visited styling (immediately stops this attack) by setting the [layout.css.visited\_links\_enabled option in about:config to false](http://support.mozilla.com/tiki-view_forum_thread.php?locale=hu&comments_parentId=438422&forumId=1#threadId438464). While this will plug the history leak, youâ€™ll no longer see any visited styling anywhere.

### Enhancing Privacy on the Web.

We want to bridge the gap between our usersâ€™ expectations of privacy and what actually happens on the web. Sometimes users have an expectation that we preserve their privacy a certain way, and if we can, we want to live up to it. Privacy isnâ€™t a feature that can simply be added to a browser, though; it often comes at the expense of utility. We think weâ€™ve found a fix that will balance flexibility for web developers while providing a safer experience for our users on the web.

Sid Stamm, Mozilla Security

**Tags:** [CSS](https://blog.mozilla.org/security/tag/css/), [Firefox](https://blog.mozilla.org/security/tag/firefox/), [history](https://blog.mozilla.org/security/tag/history/), [Privacy](https://blog.mozilla.org/security/tag/privacy/)

#### Browse fast. Browse free.

[Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=firefox_frontier&utm_medium=referral)

[Previous article
**Firefox 3.6.2 Released**
March 22, 2010](https://blog.mozilla.org/security/2010/03/22/firefox-3-6-2-released/)

[Next article
**Removing the RSA Security 1024 V3 Root**
April 6, 2010](https://blog.mozilla.org/security/2010/04/06/removing-the-rsa-security-1024-v3-root/)

#### More articles in â€œAnnouncementsâ€

* ##### [Firefox will upgrade more Mixed Content in Version 127](https://blog.mozilla.org/security/2024/06/05/firefox-will-upgrade-more-mixed-content-in-version-127/)

  June 5, 2024
* ##### [Mozilla VPN Security Audit 2023](https://blog.mozilla.org/security/2023/12/06/mozilla-vpn-security-audit-2023/)

  December 6, 2023
* ##### [Firefox 90 supports Fetch Metadata Request Headers](https://blog.mozilla.org/security/2021/07/12/firefox-90-supports-fetch-metadata-request-headers/)

  July 12, 2021
* ##### [Updating GPG key for signing Firefox Releases](https://blog.mozilla.org/security/2021/06/02/updating-gpg-key-for-signing-firefox-releases/)

  June 2, 2021
* ##### [Introducing Site Isolation in Firefox](https://blog.mozilla.org/security/2021/05/18/introducing-site-isolation-in-firefox/)

  May 18, 2021

#### Recent articles

* ##### [Behind the Scenes: Fixing an In-the-Wild Firefox Exploit](https://blog.mozilla.org/security/2024/10/11/behind-the-scenes-fixing-an-in-the-wild-firefox-exploit/)

  October 11, 2024
* ##### [Firefox will upgrade more Mixed Content in Version 127](https://blog.mozilla.org/security/2024/06/05/firefox-will-upgrade-more-mixed-content-in-version-127/)

  June 5, 2024
* ##### [Rapidly Leveling up Firefox Security](https://blog.mozilla.org/security/2024/04/04/rapidly-leveling-up-firefox-security/)

  April 4, 2024
* ##### [Mozilla VPN Security Audit 2023](https://blog.mozilla.org/security/2023/12/06/mozilla-vpn-security-audit-2023/)

  December 6, 2023
* ##### [Version 2.9 of the Mozilla Root Store Policy](https://blog.mozilla.org/security/2023/09/13/version-2-9-of-the-mozilla-root-store-policy/)

  September 13, 2023

### Keep up with all things Firefox.

Your e-mail address

Country
- select -
Afghanistan
Akrotiri
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Ashmore and Cartier Islands
Australia
Austria
Azerbaijan
Bahamas, The
Bahrain
Baker Island
Bangladesh
Barbados
Bassas da India
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia
Bonaire, Sint Eustatius, and Saba
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei
Bulgaria
Burkina Faso
Burma
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Clipperton Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo (Brazzaville)
Congo (Kinshasa)
Cook Islands
Coral Sea Islands
Costa Rica
Croatia
Cuba
CuraÃ§ao
Cyprus
Czech Republic
CÃ´te dâ€™Ivoire
Denmark
Dhekelia
Diego Garcia
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Ethiopia
Europa Island
Falkland Islands (Islas Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern and Antarctic Lands
Gabon
Gambia, The
Gaza Strip
Georgia
Germany
Ghana
Gibraltar
Glorioso Islands
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and McDonald Islands
Honduras
Hong Kong
Howland Island
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Jan Mayen
Japan
Jarvis Island
Jersey
Johnston Atoll
Jordan
Juan de Nova Island
Kazakhstan
Kenya
Kingman Reef
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Laos
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macau
Macedonia
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia, Federated States of
Midway Islands
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Namibia
Nauru
Navassa Island
Nepal
Netherlands
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palmyra Atoll
Panama
Papua New Guinea
Paracel Islands
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russia
Rwanda
Saint Barthelemy
Saint Helena, Ascension, and Tristan da Cunha
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and South Sandwich Islands
South Sudan
Spain
Spratly Islands
Sri Lanka
Sudan
Suriname
Svalbard
Swaziland
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tromelin Island
Tunisia
Turkey
Turkmenistan
Turks and Caicos Islands
Tuvalu
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S.
Wake Island
Wallis and Futuna
West Bank
Western Sahara
Yemen
Zambia
Zimbabwe

Language
Bahasa Indonesia
Deutsch
English
EspaÃ±ol
FranÃ§ais
Polski
PortuguÃªs
Ð ÑƒÑÑÐºÐ¸Ð¹
æ­£é«”ä¸­æ–‡

 HTML
 Text

Iâ€™m okay with Mozilla handling my info as explained in this [Privacy Policy](https://www.mozilla.org/privacy/).

Sign up now

We will only send you Mozilla-related information.

## Thanks!

If you havenâ€™t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an e-mail from us.

### 67 comments on â€œPlugging the CSS History Leakâ€

1. #### Colin Dean wrote on [March 31, 2010 at 7:44 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108727 "Permanent link to this comment by Colin Dean")

   > Using a checkmark image after/before a visited link is a popular thing. I understand the security precaution, though. Will data: URLs still be allowed in order to preserve this great usability enhancement?
   >
   > Case in point: profyle.at uses a small blue checkmark after visited links. Our user testing has found that people like this.
3. #### Alex Stapleton wrote on [March 31, 2010 at 8:17 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108728 "Permanent link to this comment by Alex Stapleton")

   > How will these changes effect sibling selectors? You mention sub-elements of links but you can restyle siblings of visited links tooâ€¦
5. #### Giorgio Maone wrote on [March 31, 2010 at 8:40 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108730 "Permanent link to this comment by Giorgio Maone")

   > Congratulations to David Baron and the others involved.
7. #### Matthew wrote on [March 31, 2010 at 8:42 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108731 "Permanent link to this comment by Matthew")

   > It would be helpful to know what other alternatives you considered and threw out. This article, presenting only your final choice, makes me worry that Mozilla is just picking this approach because itâ€™s easier for you to make peopleâ€™s websites look worse than to find a better solution.
   >
   > Please provide users an option in their browser to disable this and revert to the original behavior of allowing visited links to have all the styles they wanted.
   >
   > For me, Iâ€™m going to have to retest all my sites for yet another Mozilla-specific CSS style issue and JS behaviior that will retroactively go bad. I have to worry about silly things like where the designer wanted to make his links a point smaller or a new font when theyâ€™re clicked.

   1. #### Sid Stamm wrote on [March 31, 2010 at 9:52 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108740 "Permanent link to this comment by Sid Stamm")

      > @Matthew: Much of the history of this bug is available on bugzilla ([Bug 147777](https://bugzilla.mozilla.org/show_bug.cgi?id=147777)). Most of the options considered are debated in the comments of that bug. We did consider many different approaches, but most of what we looked at either made the userâ€™s experience *much* worse than this fix, or they turned off too many features that developers rely on (outside of just :visited styles).
9. #### Wladimir Palant wrote on [March 31, 2010 at 8:46 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108732 "Permanent link to this comment by Wladimir Palant")

   > What I am missing out here are the implications for canvas â€“ it can be used to make a â€œscreenshotâ€ of your webpage and read out pixel data, there must be some mechanism preventing visited links from showing up there.
11. #### Adam wrote on [March 31, 2010 at 8:55 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108733 "Permanent link to this comment by Adam")

    > Iâ€™m curious what the scale of high bandwidth and quickly are in places like: â€œThe biggest threats here are the high-bandwidth techniques, or those that extract lots of information from usersâ€™ browsers quickly.â€
    >
    > Thereâ€™s obviously room for disagreement when researchers find things, and I think clarity about the goals would be really helpful.
    >
    > Is 10ms per link high-bandwidth? 10 seconds? Iâ€™m guessing itâ€™s somewhere in between.

    1. #### Sid Stamm wrote on [March 31, 2010 at 9:48 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108739 "Permanent link to this comment by Sid Stamm")

       > @Adam: I consider [hundreds of thousands of links per minute](http://saizai.livejournal.com/960791.html) to be high-bandwidth. Many of the timing attacks tend to take a while to obtain a statistically significant result. Those are low-bandwidth, and finish in the order of tens of links per minute.
13. #### helenrae wrote on [March 31, 2010 at 9:21 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108734 "Permanent link to this comment by helenrae")

    > You mention positioning the content itself, but what about a background image?
    >
    > Will it still be possible to position an already loaded and applied background image via CSS (i.e. an image sprite containing multiple states) ?
15. #### thornmaker wrote on [March 31, 2010 at 9:36 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108736 "Permanent link to this comment by thornmaker")

    > Will this fix address non-js based history leakingâ€¦ e.g. <http://ha.ckers.org/weird/CSS-history.cgi> ?

    1. #### Sid Stamm wrote on [March 31, 2010 at 9:45 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108738 "Permanent link to this comment by Sid Stamm")

       > @thornmaker: yes, change #1 takes care of that.
17. #### Ulrich wrote on [March 31, 2010 at 9:38 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108737 "Permanent link to this comment by Ulrich")

    > A solution for Colin Deanâ€™s problem would be to allow custom background images if the visited links point to the same domain.
19. #### Tony Mechelynck wrote on [March 31, 2010 at 9:56 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108741 "Permanent link to this comment by Tony Mechelynck")

    > Does â€œChange 2â€ mean that links wonâ€™t change colour anymore if I click â€œOpen in new tabâ€ in the context menu of an unvisited link, then come back?
    >
    > @Colin: â€œChange 1â€ above seems to imply that adding some â€œafterâ€ element only on visited links (which would change the size of the space occupied by the link) would be forbidden. But maybe displaying a child element of the link as âˆš with â€œinvisibleâ€ colours (fg=bg) if unvisited and â€œvisibleâ€ (fgâ‰ bg) if visited would be permitted?
21. #### Roger wrote on [March 31, 2010 at 10:01 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108742 "Permanent link to this comment by Roger")

    > I canâ€™t remember the details now, but I remember seeing reference to some API (maybe related to SVG?) that allowed JS to query the color of individual pixels. It is very easy to position links at absolute positions, so the history leak could be exploited through thatâ€¦ or have you guys also fixed it so it returns the color of unvisited links?
23. #### David Baron wrote on [March 31, 2010 at 10:06 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108743 "Permanent link to this comment by David Baron")

    > Allowing data: URLs still allows cases where some images would be slower to paint than others, leading to detectable performance differences.
    >
    > One possible way (a bit hacky) to make such images still show up is to have a checkmark image that has the same background color as the page, on a transparent background. Then rules like (supposing the page background is white):
    >
    > :link:after { content: url(checkmark); background: white }
    >
    > :visited:after { content: url(checkmark); background: blue }
    >
    > would still work.
    >
    > Depending on how much feedback we get about this, we might try to figure out a way to make this possible more easily. (It might be easier to support changing background-image than content.)
25. #### David Baron wrote on [March 31, 2010 at 10:09 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108744 "Permanent link to this comment by David Baron")

    > (My previous comment was a response to Colin Dean in comment #1; seems thereâ€™s a good bit of caching delaying the comments showing up, so the ordering might be more confusing than I expected.)
27. #### Alex wrote on [March 31, 2010 at 10:52 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108746 "Permanent link to this comment by Alex")

    > I could still use color to steal history data, just less of it.
29. #### Damian wrote on [March 31, 2010 at 10:53 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108747 "Permanent link to this comment by Damian")

    > Colin: Alas this will no longer be allowed as itâ€™s very easy to use that same method to then extract the userâ€™s history.
    >
    > However, I donâ€™t see why there canâ€™t be an exception for visited sites of the same website, surely the website can see what the user clicks on anyway within their own site.
31. #### Remco wrote on [March 31, 2010 at 11:16 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108749 "Permanent link to this comment by Remco")

    > I think it would be possible to keep the feature of an image for a style. Basically it goes like this:
    >
    > \* always load any graphics that are used in visited and unvisited achors.
    >
    > \* use the same content box for visited, as for unvisited anchors. Then, clip the visited image if itâ€™s too big for the unvisited content box. Pad the content box if itâ€™s too small. This would mean that sites need to make the image a child of the anchor (so not style it with :after, like on profyle.at), or use a background image. So some sites would break. But it would at least keep the possibility.
    >
    > \* give javascript functions the â€˜unvisited versionâ€™ of the page.
33. #### Steve Krenzel wrote on [March 31, 2010 at 11:44 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108750 "Permanent link to this comment by Steve Krenzel")

    > While I like the approach taken here, the usability changes and impact on web developers can be significantly minimized with a minor change to the implementation:
    >
    > Only apply these rules to URLs not on the current domain.
    >
    > Most pages that legitimately use visited styling do so for links on their own domain. You shouldnâ€™t need to restrict the styling on these links in any way.
35. #### David Baron wrote on [March 31, 2010 at 11:46 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108751 "Permanent link to this comment by David Baron")

    > @Wladimir Palant (comment #5): the ability to make a screenshot using canvas is available only to chrome and extensions, not to Web pages; it would have other significant security and privacy implications other than this.
37. #### Apphacker wrote on [March 31, 2010 at 12:05 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108753 "Permanent link to this comment by Apphacker")

    > Maybe allow for same domain policy so that web developers can still add fancy styling for links within their own domain.
39. #### Michael wrote on [March 31, 2010 at 12:17 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108755 "Permanent link to this comment by Michael")

    > As a person with a color vision deficiency Change 1 will make Firefox completey useless for me. I hope the Chrome people are a bit wiser and donâ€™t follow this nonsense.
41. #### Michael wrote on [March 31, 2010 at 12:27 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108756 "Permanent link to this comment by Michael")

    > Sorry, Iâ€™m really angry about that. I think Change 2 and Change 3 are very useful, but Iâ€™m completely against Change 1.
    >
    > Please be aware that this will affect a significant portion of your user base, see <http://en.wikipedia.org/wiki/Color_blindness#Prevalence>
43. #### Matt wrote on [March 31, 2010 at 1:15 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108757 "Permanent link to this comment by Matt")

    > â€œHowever, I donâ€™t see why there canâ€™t be an exception for visited sites of the same website, surely the website can see what the user clicks on anyway within their own site.â€
    >
    > Iâ€™d like to second this comment. Please provide an exception to sites within the same base domain. This way javascript can do handy things with those links.
45. #### Jaanus wrote on [March 31, 2010 at 1:38 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108758 "Permanent link to this comment by Jaanus")

    > My question is: what is the point of visited links feature nowadays? Would anyone be worse off (or notice) if this â€œvisited linksâ€ feature were simply eliminated from the browser? These days, with rich content and URL shorteners and whatnot, it has lost its usefulness in my eyes. Does anyone have any evidence (scientific, anecdotal, whatever) that people know or care about this feature? (Especially the kind of people featured in â€œwhat is a browserâ€ video.)
    >
    > How this relates to security: simply eliminating a feature would save everyone the trouble of trying to plug perceived or real security holes related to that feature.
47. #### Colby Russell wrote on [March 31, 2010 at 2:00 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108759 "Permanent link to this comment by Colby Russell")

    > Michael: â€œcompletely uselessâ€ is surely an exaggeration. Having said that, the Web is certainly just as useless in its current state, no? Web designers have been putting personal taste for aesthetics before the usability for others for a long time, so in truth, youâ€™re already running into problems with low contrast or otherwise indistinguishable color palettes in the wild, right? And even amongst designers who do not fit in those categories, the number of designers who put icons or even non-color types of text decoration in their style sheet to distinguish visited links is by far outnumbered by those who only specify color.
    >
    > Using an add-on to help with your color vision deficiency would probably have the highest benefits for you across the board.
    >
    > David Baron: Is/will there now an API in place (`getTrueComputedStyle`?) available to chrome? It seems like it would be a shame if add-ons didnâ€™t have an easy way to get at that information; I know the DOM Inspector uses the DOM 2 Style API in question for the computed style viewer. (Certainly no problem if youâ€™re only interested in seeing exactly what is going to be seen by script, but if thatâ€™s not your use case, then a problem does arise.) And it would probably be most beneficial to have a separate method rather than a whitelisting effect for chrome, in case your add-on *is* interested in seeing exactly what script will see.
49. #### Mike Samuel wrote on [March 31, 2010 at 2:03 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108761 "Permanent link to this comment by Mike Samuel")

    > JavaScript sandboxing schemes can prevent sandboxed code from doing history sniffing, port sniffing, etc.
    >
    > Caja ( <http://code.google.com/p/google-caja/> ) addresses history mining by exposing only the non-visited version of styles for links to untrusted code.
51. #### Colby Russell wrote on [March 31, 2010 at 2:09 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108762 "Permanent link to this comment by Colby Russell")

    > Sid, itâ€™s also interesting that you say you â€œhope other browsers will follow suitâ€, since the approach makes it seem more like a (belated) temporary stopgap than a permanent solution, and will potentially be subject to future progress which could retain more of the current functionality to be exposed to authorsâ€”contingent upon some untangling in /layout that would make such things possible.

    1. #### Sid Stamm wrote on [March 31, 2010 at 2:33 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108765 "Permanent link to this comment by Sid Stamm")

       > @Colby: I wouldnâ€™t call this fix a temporary stopgap, unless you are hoping this it a stepping stone towards removing browser history entirely, which I doubt would be welcomed with open arms. With the text you quoted, I was saying how Iâ€™d like to see more adoption of the fundamental approach: blocking history from arbitrary web sites, but still letting users themselves see it. The point is to match up what the browser does with what users think it does. Browser history is widely perceived as something thatâ€™s just part of the browserâ€“not transmitted to sitesâ€“and this patch is intended to make it that way.
53. #### Anna wrote on [March 31, 2010 at 2:15 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108763 "Permanent link to this comment by Anna")

    > Please provide an exception to sites within the same base domain or explain why itâ€™s not a good idea.
55. #### Frank Yan wrote on [March 31, 2010 at 2:20 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108764 "Permanent link to this comment by Frank Yan")

    > I donâ€™t think text-decoration (at least underline) affects page layout. If I am correct, why isnâ€™t this supported for :visited?
57. #### Ben Curtis wrote on [March 31, 2010 at 2:52 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108766 "Permanent link to this comment by Ben Curtis")

    > Please consider only applying these changes to links that specify a domain.
    >
    > These changes look like they will break the (very useful) types of :visited links with checkmarks (e.g., a symbol saying â€œcheck â€” youâ€™ve followed this linkâ€), or otherwise calling deliberate and unmistakable attention to links you have not gone to yet and those you have. For example, a list of PDFs that must be viewed/downloaded could be marked with a.pdf-list:visited { text-decoration:line-through; }; such a notation is not just a design aesthetic, but a significant usability aid that would otherwise require convoluted server-side code to implement.
    >
    > So I suggest that these new changes only apply when the link starts with a protocol or double slash, and therefore specifies the domain. I donâ€™t even think it would be necessary to compare the domain to the pageâ€™s domain; ANY specified domain will trigger these privacy protections on that link.
    >
    > If it doesnâ€™t specify the domain, then the link must point within the domain. For the majority of sites which fully control all pages on their domain, your suggested changes do not provide any additional privacy protection since all of that history can be tracked on the server. But the changes would prevent creative and useful applications of CSS. (Sites where untrusted third parties are hosted under the same domain, e.g., apps.facebook.com, would be the exception â€” but Facebook controls what JS can run and can easily protect against this themselves.)
    >
    > Hope you consider this modification.
59. #### James wrote on [March 31, 2010 at 3:34 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108768 "Permanent link to this comment by James")

    > From Webkitâ€™s bugzilla, it looks like Dave Hyatt is going to implement the same fix. (The great thing about a competitive browser market.)
61. #### Jesse Ruderman wrote on [March 31, 2010 at 3:54 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108769 "Permanent link to this comment by Jesse Ruderman")

    > Will user stylesheets be affected?
63. #### Eris wrote on [March 31, 2010 at 6:28 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108771 "Permanent link to this comment by Eris")

    > Hang on, wait a tick. Why not treat link styles using the same-origin policy that affects XMLHttpRequest and Javascript interaction with frames? Visited links that fall under same-origin are styled freely and those that donâ€™t are styled as unvisited.
    >
    > Actually, Iâ€™d like to see this made part of the CSS spec and add a pseudoclass for all links that point to a resource that belongs to another domain. Donâ€™t suppose it will ever happen, though.
65. #### Daniel Veditz wrote on [March 31, 2010 at 6:55 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108772 "Permanent link to this comment by Daniel Veditz")

    > @Jesse: yes, user sheets and even chrome sheets are affected. The engine simply doesnâ€™t support :visited styling except for a limited number of properties.
    >
    > @Frank Yan: text decoration isnâ€™t supported out of concerns about timing attacks. <https://bugzilla.mozilla.org/show_bug.cgi?id=147777#c160>
    >
    > See also â€œTest #3â€ in that bug which only uses the underline property.
67. #### Colby Russell wrote on [March 31, 2010 at 8:00 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108775 "Permanent link to this comment by Colby Russell")

    > @Sid (emphasis is mine):
    >
    > > Iâ€™d like to see more *adoption of the fundamental approach*: blocking history from arbitrary web sites, but still letting users themselves see it.
    >
    > Certainly. And you probably do know that I wasnâ€™t suggesting removing history entirely.
    >
    > But your call to follow suit seemed a bit stronger than the adoption of fundamentals; it seemed like one for an adoption of the *specific process* used in Geckoâ€”the rules it applies to determine the restrictions on `:visited` and how it will be accessible to content script. Given that many people are seeing this as a loss in functionality, David Baronâ€™s past expressions that indicated he envisioned at least a little more flexibility would remain with regard to what web authors would be allowed to do with the selector, and that the bug is still marked ASSIGNED, as well as my own thoughts that it *seems* like more options could be preserved, albeit with some more work, it appears to me to be a temporary stopgap set to be improved upon.
    >
    > For what itâ€™s worth, this affects me in absolutely no way with regard to Web authoring, and Iâ€™m not sore over it. (Did my disdain for designers who put an overemphasis on their personal taste for aesthetics shine through before?) The aspects Iâ€™m far more concerned about are ones I share with Jesse: how is this attempt to thwart evildoers on the Web going to affect already-privileged chrome?
69. #### Watches wrote on [March 31, 2010 at 9:47 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108777 "Permanent link to this comment by Watches")

    > I hope users stylesheets arenâ€™t hit by this.
71. #### AJ wrote on [March 31, 2010 at 10:02 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108778 "Permanent link to this comment by AJ")

    > Sid,
    >
    > Haha, thatâ€™s a good one! I almost fell for it because Iâ€™m in a different timezone, but when I got to the end I realized itâ€™s an April Fools prank, and a classic one at that! But I donâ€™t think that more experienced Web developers will be fooled â€” Bug 147777 has been around long enough that any proposal to do something about it is about as like to happen as having Duke Nukem Forever implemented as a Firefox plug-in. Good try though ðŸ™‚
73. #### Philip wrote on [March 31, 2010 at 11:37 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108780 "Permanent link to this comment by Philip")

    > I donâ€™t thing that you should disable the background-image property for visited links totally. It should be allowed for links that point to the same domain. I know some sites that use background-image for visited links and it would be pity if they wonâ€™t work as they usually do.
75. #### Tom wrote on [April 1, 2010 at 3:04 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108781 "Permanent link to this comment by Tom")

    > Really a good one. While my first thought was: MUST be an aprilâ€™s fool, I stumbled across the fact that the date just wasnâ€™t right. But as AJ already mentioned: timezones. Damn globalization! You really got me with this one!
    >
    > Good job!
77. #### Davin wrote on [April 1, 2010 at 4:31 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108782 "Permanent link to this comment by Davin")

    > No you canâ€™t. You have to have a list of canidate links in the first place and there are far too many profiles in Facebook.
    >
    > Someone (I canâ€™t find the link now) put together a proof of concept using popular Facebook groups. They had a pretty good hit rate on identifying users from their unique combination of groups, I believe it was above 50%.
79. #### ant wrote on [April 1, 2010 at 6:44 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108783 "Permanent link to this comment by ant")

    > Will this also be used to cripple pages that run no JS code whatsoever?

    1. #### Sid Stamm wrote on [April 1, 2010 at 9:08 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108784 "Permanent link to this comment by Sid Stamm")

       > History can be sniffed without JavaScript too, just using CSS. See [this demo](http://browser-recon.info) for an example and explanation of how it works.
81. #### Dood wrote on [April 1, 2010 at 9:13 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108785 "Permanent link to this comment by Dood")

    > This sounds to me like a hard-to-implement, hard-to-maintain and quite unreliable solutions, I am quite confident though it wonâ€™t break anything importantâ€¦
    >
    > Still, can somebody please summarise for me the arguments against the SafeHistory approach?
    >
    > (I guess you discussed this not only in the Bugzilla entry but also on IRC and etc.)
83. #### mogya wrote on [April 2, 2010 at 6:10 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108789 "Permanent link to this comment by mogya")

    > Why donâ€™t you handle such site as â€œbad siteâ€ on the Malware Protection?
    >
    > The sites using â€œthe CSS History Leakâ€ are malicious site, arenâ€™t they?
85. #### Kulmegil wrote on [April 2, 2010 at 7:21 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108791 "Permanent link to this comment by Kulmegil")

    > Sooâ€¦ will the new hack block completely the possibility to determine visited links? â€“ not only by getting node and itâ€™s children â€œcomputedstyleâ€ but also by getting it indirectly from PARENT node (by checking itâ€™s computed height for example)?
87. #### Sai Emrys wrote on [April 2, 2010 at 2:03 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108792 "Permanent link to this comment by Sai Emrys")

    > Could you please fix the link for my results page from my blog repost to <http://cssfingerprint.com/results> (the original page)?
    >
    > Thanks.

    1. #### Sid Stamm wrote on [April 2, 2010 at 2:46 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108793 "Permanent link to this comment by Sid Stamm")

       > @Sai Emrys: Of course! Thanks for the link.
89. #### Sai Emrys wrote on [April 2, 2010 at 3:18 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108794 "Permanent link to this comment by Sai Emrys")

    > @Adam My attack (which Sid kindly linked to) is AFAIK the fastest one currently out there. My current throughput using reliable methods is (local to the browser):
    >
    > Chrome: .04 ms/URL, 1,500,000 URL/min
    >
    > Explorer: .26 ms/URL, 227,000 URL/min
    >
    > Firefox: .10 ms/URL, 553,000 URL/min
    >
    > Opera: .09 ms/URL, 640,000 URL/min
    >
    > Safari: .02 ms/URL, 3,690,000 URL/min
    >
    > IOW, itâ€™s quite a lot faster than the fastest you thought.
    >
    > There are some other issues that are preventing me from actually doing that much throughput end-to-end; a typical scraping tests ~80-100kURLs 4x each (on my dev box Iâ€™ve gotten up to ~250\*4k). But thatâ€™s just a temporary hurdle. The severity of this hole is quite significant.
    >
    > My code is entirely open source, so if you want to know how the scraping part works, just look at <http://github.com/saizai/cssfingerprint/blob/master/public/javascripts/history_scrape.js>
    >
    > Feel free to visit <http://cssfingerprint.com> if youâ€™d like to see the effects.
    >
    > FWIW, I think that DBaronâ€™s approach is fairly solid. I donâ€™t think that there is anything that can be done short of what heâ€™s doing in terms of breaking expectations of usage, while still fixing the bug. As the post says, itâ€™s an unavoidable trade-off.
    >
    > Of course, Iâ€™ll also be one of the first to try to break his code, just in case Iâ€™m wrong about that. ðŸ˜‰
91. #### OtÃ¡vio wrote on [April 3, 2010 at 7:26 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108799 "Permanent link to this comment by OtÃ¡vio")

    > I agree with â€œ36 â€“ Erisâ€, and thinks even better, why you just hidde the src attr in the A tag, if itâ€™s from other domain, show an about:blank or anything like that.
93. #### Dhouwn wrote on [April 3, 2010 at 10:18 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108802 "Permanent link to this comment by Dhouwn")

    > BTW: What about subpixel positioning, is there a chance that a different link colour might interact with this?
95. #### Ferenc Veres wrote on [April 3, 2010 at 3:58 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108804 "Permanent link to this comment by Ferenc Veres")

    > What about background-position?
    >
    > Canâ€™t we keep that, so using â€œCSS Spritesâ€ for checkmarks and other visual â€“ also color blind friendly â€“ styles would be possible? One could use that to stroke visited PDF links I think, as requested in a comment above. Does it change anything detectable?
    >
    > Now that we know, COLOR will stay, could you set a better visible link color for this blog and another (different) color for visited links? Thanks.
97. #### Edward Jones wrote on [April 5, 2010 at 6:01 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108816 "Permanent link to this comment by Edward Jones")

    > I donâ€™t understand how Michael (comment 23) can say that minus the coloring of links a browser becomes completely useless. While I do sympathize with his condition which Iâ€™m sure presents many challenges in life, a web page does not suddenly stop working if you canâ€™t differentiate between visited and non-visited links. I am confident that he would still be able to use any browser even if no difference in the styling of visited vs. non-visited links was presented. I am the first person to stand up for accessibility and design my websites to be usable by those with screen readers for example. I think the absolutism of his comment does a disservice to the accessibility movement.
99. #### Adam Messinger wrote on [April 6, 2010 at 12:27 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108817 "Permanent link to this comment by Adam Messinger")

    > For all of those asking about allowing broader :visited link styles for links within the same domain â€” this will still have privacy implications on sites like LiveJournal and WordPress.com. Many users share the same domain on those sites, and it would be possible for one LJ user (for example) to determine all the other LJs a visitor had viewed.
    >
    > Though I understand the need to fix this privacy problem, Iâ€™m among those who are less than thrilled at the constraints being imposed on front-end designers and developers. Hopefully a less limiting solution will be found at some point in the future.
101. #### Chris wrote on [April 6, 2010 at 2:12 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108818 "Permanent link to this comment by Chris")

     > Why is this even a privacy issue? Itâ€™s not like someone is going to have some gossip site that tells the sites that certain ip addresses visit.
     >
     > The only people I can think of that would maybe have a rational reason to be concerned about the web surfing privacy of their ip address is people who are doing something illegal online such as going to websites to get child pornography or something. But why would we want to protect them anyways?
     >
     > This is just as stupid as people thinking their privacy is being violated when their DNA is on file after an arrest when theyâ€™re found not guilty.
     >
     > In both cases there would be no harm done for people that deserve no harm.
103. #### Justen wrote on [April 6, 2010 at 10:42 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108819 "Permanent link to this comment by Justen")

     > I have mixed feelings about this. Privacy is a personal responsibility; giving people the tools to enhance their privacy is one thing, but using hamhanded techniques like this is unlikely to help very much and may cause headaches for designers and developers who legitimately use the features youâ€™re about to axe. If you really want people to have better privacy, just give them better user interface tools to protect it. You could do things like provide a button in the main UI to block the presently visited site from appearing in history, another to block the present site from accessing history information, and another to clear all history. Give them more granular control of what kinds of things get saved to history and for how long via an intuitive control panel.
105. #### Daniel Veditz wrote on [April 6, 2010 at 12:12 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108820 "Permanent link to this comment by Daniel Veditz")

     > @Chris
     >
     > The main demo sites know nothing about â€œyouâ€, so maybe the fact that they know where â€œyouâ€ visit is merely interesting. But sites that already know more specific things about you (because you have an account with them, for instance) can now correlate all sorts of things with a more specific notion of â€œyouâ€.
     >
     > This does far more than catch people doing illegal things, criminals are not the only ones with â€œsomething to hideâ€. Examples:
     >
     > A hacker can use this to figure out which online bank you actually use and present a more believable phishing attack.
     >
     > Online stores could show you higher prices if they notice you visit high-end online stores and cheaper prices if you visit walmart.com (Amazon, among others, has at least experimented with showing different prices to different users, though their technique is unknown and probably isnâ€™t using CSS history).
     >
     > A military site (where youâ€™re required to authenticate) might find out youâ€™re gay and ruin your career even though youâ€™ve been careful not to â€œtellâ€.
     >
     > A blog might show only the sharing icons (digg, reddit, facebook, etc) for the services you use rather than a dozen or two confusing little icons (this one might actually be positive).
     >
     > Web ads could be better targeted at your demographic (possibly good or creepy)
     >
     > criminal groups with websites/discussion groups could use this to â€œoutâ€ undercover cops or informants.
107. #### Chris wrote on [April 6, 2010 at 4:33 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108821 "Permanent link to this comment by Chris")

     > @ Daniel Veditz
     >
     > Good points. I feel stupid not thinking about sites that you signed up for.
     >
     > The hacker scenario would be a security problem, caused by a privacy issue. A good point.
     >
     > The online stores showing higher prices to certain people and the undercover cop issues are also very good points.
     >
     > I can think of other negative situations that could arise from this privacy issue now as well.
     >
     > I should have thought on it longer. Thanks for setting me straight ðŸ™‚
109. #### Bruce wrote on [April 6, 2010 at 4:45 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108822 "Permanent link to this comment by Bruce")

     > Like everyone else, I really hope that Mozilla developers and other browser developers will only limit styling on visited external links.
111. #### Mitchell Evan wrote on [April 7, 2010 at 10:04 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108823 "Permanent link to this comment by Mitchell Evan")

     > Ditto @Matthew. Make the security improvement the default, but allow users to override it by browser configuration. This will go a long way to addressing the accessibility issue.
     >
     > Ditto the many requests to make the changes apply only to links to external sites. But we probably want to define external as â€œuntrustedâ€ instead of â€œother domainâ€, in order to support a browserâ€™s list of trusted sites e.g. corporate configuration of trusted intranet sites.
113. #### bpjonsson wrote on [April 10, 2010 at 11:03 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108838 "Permanent link to this comment by bpjonsson")

     > I just want to point out that if color is the only means available to differentiate visited links from unvisited ones then the best still possible way to be nice to people with color vision problems is the one which always was most effective:
     >
     > Use high text/background contrast an let :visited be inverse video relative :link.
     >
     > This is not much used even now in spite of being most effective; no doubt because inverse video is dead ugly and jumps out of the page/screen, and probably not only because weâ€™re unused to it.
     >
     > Since Iâ€™ve got (non color) vision problems myself Iâ€™ve thought a lot about the issue of differentiating (un)visited links from each other clearly without depending on color, and without having to sacrifice the traditional uses of font properties for emphasis. Whatever preferences I had are out now!
     >
     > If color is the only remaining way of differentiating links from non-links at all weâ€™re really in troubleâ€¦
115. #### izdelava strani wrote on [April 15, 2010 at 10:41 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108851 "Permanent link to this comment by izdelava strani")

     > I really hope that youâ€™ll do the job and even most that the rest will follow. Cos as a website developer iâ€™m feed up with all the browsers that need to be satisfied so that the web site looks good in all of them.
117. #### Pat wrote on [April 15, 2010 at 6:15 pm:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108852 "Permanent link to this comment by Pat")

     > Pat from AddToAny. Weâ€™ve deployed this technique on our sharing widget for years (search for â€œaddtoany smart menuâ€) so this does indeed affect us and over 100,000 publishers. Personally, Iâ€™m okay with plugging this hole to a certain degree, but the aforementioned seems like a silver-bullet approach with too many developer implications.
     >
     > AddToAnyâ€™s script, for instance, queries against URLs from 200 sharing/bookmarking services to place visited services at the top of the sharing menu. Itâ€™s a marvelous use-case, I might add. ðŸ˜‰ 200 queries is not â€œhigh-bandwidthâ€ as defined above, but itâ€™s noteworthy. Just FYI the results are used on runtime, client-side only.
     >
     > My thoughts:
     >
     > Have we discussed defining a ceiling for high-bandwidth queries? A maximum number of queries doesnâ€™t cover all privacy implications of this hack, but it would plug the more infamous and nefarious attacks. AddToAny would certainly favor this approach.
     >
     > Adopting a same-origin policy on this issue definitely makes sense to me. @Adam Messinger re: your wordpress.com example: Thatâ€™s why wordpress.com does not (and probably never will) allow arbitrary JavaScript from publishers. Not sure about LiveJournal, but most sites of this nature donâ€™t permit arbitrary JavaScript due to a slew of issues extending beyond this one.
     >
     > Regardless of outcome, this surely is an exciting development and weâ€™ll be monitoring the conversation here and at bugzilla. Please ping me if I miss anything or if youâ€™d like to chat directly. Twitter @micropat or pat at addtoany. Cheers!
119. #### Bruce wrote on [April 20, 2010 at 7:41 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108867 "Permanent link to this comment by Bruce")

     > Canâ€™t Mozilla simply disable the ability of javascript to determine all the styles on visited links instead of disallowing those styles?

     1. #### Sid Stamm wrote on [April 20, 2010 at 10:09 am:](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/#comment-108868 "Permanent link to this comment by Sid Stamm")

        > @Bruce: if we just disabled access via JS, that wouldnâ€™t solve any of the timing attacks or the non-JS CSS-based attacks (those that rearrange the DOM, resize things, or create requests for images). For example, take a look at <http://browser-recon.info>. The fact that there are so many ways to access the history, with and without JS, makes it necessary to address the capabilities and not just the information presented to JS.

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### [Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

* [About](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Contact Us](https://www.mozilla.org/contact/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Donate](https://donate.mozilla.org/?presets=50,30,20,10&amount=30&currency=usd&utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* + [Twitter (@mozilla)](https://twitter.com/mozilla)
  + [Instagram (@mozillagram)](https://www.instagram.com/mozillagram/)

##### [Firefox](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

* [Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Desktop](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Mobile](https://www.mozilla.org/firefox/mobile/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Features](https://www.mozilla.org/firefox/features/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Beta, Nightly, Developer Edition](https://www.mozilla.org/firefox/channel/desktop/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* + [Twitter (@firefox)](https://twitter.com/firefox)
  + [YouTube (firefoxchannel)](https://www.youtube.com/firefoxchannel)

* [Website Privacy Notice](https://www.mozilla.org/privacy/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)

Visit Mozilla Corporationâ€™s not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org).

Portions of this content are Â©1998-2025 by individual contributors. Content available under a [Creative Commons license](https://www.mozilla.org/foundation/licensing/website-content/).


