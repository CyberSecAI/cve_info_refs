```
{
  "vulnerability": {
    "CVE": "CVE-2010-5328",
    "description": "A process that is in the same process group as the init process (group id zero) can crash the Linux kernel with several system calls by passing in a process ID or process group ID of zero. The value zero is a special value that indicates the current process ID or process group. However, in this case it is also the process group ID of the process.",
    "root_cause": "The vulnerability stems from the improper handling of process groups and the visibility of the swapper process to signals. Specifically:\n\n1.  The `INIT_TASK()` macro did not properly initialize the `->thread_group` list, leading to a crash when signals were sent to the swapper process, as the swapper process was part of the init process group which has a group ID of zero.\n\n2. The `init_struct_pid.tasks` list should not include the swapper process, but due to improper initialization of the `init_struct_pid`, the swapper process was included. This list is used in signal handling and should not include idle threads.\n\n3. Idle threads, when created through `copy_process`, inherited incorrect `pids` from the calling process, which could result in the .pid pointing to an invalid memory location especially after a series of cpu_up/cpu_down operations.",
    "weaknesses": [
      "Incorrect initialization of the `thread_group` list in `INIT_TASK()`.",
      "Inclusion of the swapper process in `init_struct_pid.tasks` list.",
       "Incorrect `pids` inheritance by idle threads during `copy_process`"
    ],
    "impact": "A non-root user could trigger a kernel crash by sending signals to a process that belongs to the init process group, which includes the swapper process. This could lead to a denial-of-service.",
    "attack_vectors": "A local attacker can exploit the vulnerability by crafting a program that makes system calls using a process ID or process group ID of zero, while being a part of the init group (group ID zero). This condition triggers the faulty signal delivery mechanism in the kernel.",
    "attacker_capabilities": "The attacker requires the ability to execute code on the target system and have a process that shares the same process group as the init process (group id zero). This can be achieved by modifying or replacing the init daemon or by another means of controlling the process groups.",
    "additional_details": [
        "The initial issue was triggered because `__kill_pgrp_info(init_struct_pid)` was sending `SIGKILL` to the swapper process that had an uninitialized `->thread_group`.",
        "The fix involves initializing the `->thread_group` correctly using `LIST_HEAD_INIT(tsk.thread_group)` in `INIT_TASK()`.",
        "The swapper process must not be visible to signals, as it's an idle thread.",
        "The `INIT_STRUCT_PID` and `INIT_PID_LINK` macros were modified to prevent the inclusion of idle threads in the `init_struct_pid.tasks`.",
        "The `fork_idle()` function was updated to properly initialize idle threads' `pids` by calling `init_idle_pids()`."
      ]
  }
}
```