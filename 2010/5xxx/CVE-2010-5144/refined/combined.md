=== Content from mrhinkydink.blogspot.com_ec93e42d_20250125_150027.html ===


# [Mr.HinkyDink's UT Blog](http://mrhinkydink.blogspot.com/)

UT99, IT Security, Miscellaneous Crap

* [About PoTTY](http://mrhinkydink.blogspot.com/p/about-potty.html)

## Saturday, May 29, 2010

### Websense 6.3.3 "Via:" Bypass

discovered by mrhinkydink

PRODUCT: Websense Enterprise v6.3.3

EXPOSURE: Trivial Web Policy Bypass

SYNOPSIS
========

By adding a "Via:" header to an HTTP request it is possible for a user to completely bypass filtering and monitoring in a Websense Enterprise 6.3.3/Microsoft ISA Server (2004 or 2006) proxy integration environment.

PROOF OF CONCEPT
================

The following works in a Websense 6.3.3 Enterprise system using the ISA Server integration product and transparent authentication. It is assumed it will work with other proxy integration products, but this has not been tested.

I. Install Firefox >= 3.5

II. Obtain and install the [Modify Headers plug-in by Gareth Hunt](https://addons.mozilla.org/en-US/firefox/addon/967/)

III. Configure the plug-in to add a valid "Via:" header to every request

    Example: "Via: 1.1 VIAPROXY"

IV. Browse to a filtered Web site

V. All content is allowed without monitoring

VIDEO PoC!
==========

PoC RESTRICTIONS
================

The Modify Header plug-in does not work with SSL. However, in practice a user could browse to a so-called (by Websense) "Proxy Avoidance" Web site and use the SSL capabilities of the remote proxy.

OTHER USES
==========

Properly configured, a downstream SQUID proxy can send requests to the upstream ISA server and all requests will pass through without blocking or monitoring. No evidence of activity will be logged by Websense. This was in fact how this vulnerability was originally discovered. Considering the simplicity of the attack, the author suspects this bypass technique is already well-known in certain circles.

Also, it is trivial to modify proxy-enabled Linux utilities to leverage this bypass. The author has recompiled (that is, HACKED) OpenVPN, connect-proxy, PuTTY, stunnel, and others to take advantage of this policy bypass.

Obviously, the risk of undetected (by Websense, at least) covert tunnels is high in a vulnerable installation of this product.

Linux platforms using this method in this specific environment will also enjoy bypassing Websense's transparent authentication.

WORK-AROUNDS
============

For this specific installation scenario (Websense 6.3.3 + ISA 2004/6 + transparent authentication), none are known. The following may work:

  \* Use Windows Integrated Authentication on the ISA Server

  \* Upgrade to Websense 7.x

  \* Do not use a proxy integration product

HISTORY
=======

10/09/2009 - vendor notified

05/29/2010 - PoC published

c. MMX mrhinkydink

Posted by

[Hinky Dink](https://draft.blogger.com/profile/06062843268103990027 "author profile")

at

[4:50 PM](http://mrhinkydink.blogspot.com/2010/05/websense-633-via-bypass.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://draft.blogger.com/post-edit.g?blogID=30009138&postID=3122687425951070916&from=pencil "Edit Post")

Labels:
[FAIL](http://mrhinkydink.blogspot.com/search/label/FAIL),
[hack](http://mrhinkydink.blogspot.com/search/label/hack),
[proxies](http://mrhinkydink.blogspot.com/search/label/proxies),
[websense bypass](http://mrhinkydink.blogspot.com/search/label/websense%20bypass)

#### 1 comment:

1. ![](//resources.blogblog.com/img/blank.gif)Anonymous[3:10 AM](http://mrhinkydink.blogspot.com/2010/05/websense-633-via-bypass.html?showComment=1411715453883#c2120772335199639863)

   How about websense 7

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=30009138&postID=2120772335199639863)Replies
   Reply

Add commentLoad more...

[Newer Post](http://mrhinkydink.blogspot.com/2010/06/happy-horseshit-june-2010.html "Newer Post")

[Older Post](http://mrhinkydink.blogspot.com/2010/05/newlaptopboi.html "Older Post")

[Home](http://mrhinkydink.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://mrhinkydink.blogspot.com/feeds/3122687425951070916/comments/default)

## Хинки Динк

[Hinky Dink](https://draft.blogger.com/profile/06062843268103990027)

RETIRED Corporate IT Security Dude & UT99 Server Operator

[View my complete profile](https://draft.blogger.com/profile/06062843268103990027)

## Twitter

[Follow @mrhinkydink](https://twitter.com/mrhinkydink)

## Blog Archive

* ►
  [2025](http://mrhinkydink.blogspot.com/2025/)
  (1)
  + ►
    [January](http://mrhinkydink.blogspot.com/2025/01/)
    (1)

* ►
  [2024](http://mrhinkydink.blogspot.com/2024/)
  (2)
  + ►
    [December](http://mrhinkydink.blogspot.com/2024/12/)
    (1)
  + ►
    [January](http://mrhinkydink.blogspot.com/2024/01/)
    (1)

* ►
  [2023](http://mrhinkydink.blogspot.com/2023/)
  (2)
  + ►
    [August](http://mrhinkydink.blogspot.com/2023/08/)
    (2)

* ►
  [2020](http://mrhinkydink.blogspot.com/2020/)
  (1)
  + ►
    [September](http://mrhinkydink.blogspot.com/2020/09/)
    (1)

* ►
  [2016](http://mrhinkydink.blogspot.com/2016/)
  (1)
  + ►
    [May](http://mrhinkydink.blogspot.com/2016/05/)
    (1)

* ►
  [2014](http://mrhinkydink.blogspot.com/2014/)
  (2)
  + ►
    [October](http://mrhinkydink.blogspot.com/2014/10/)
    (1)
  + ►
    [January](http://mrhinkydink.blogspot.com/2014/01/)
    (1)

* ►
  [2013](http://mrhinkydink.blogspot.com/2013/)
  (6)
  + ►
    [December](http://mrhinkydink.blogspot.com/2013/12/)
    (1)
  + ►
    [August](http://mrhinkydink.blogspot.com/2013/08/)
    (1)
  + ►
    [July](http://mrhinkydink.blogspot.com/2013/07/)
    (1)
  + ►
    [March](http://mrhinkydink.blogspot.com/2013/03/)
    (1)
  + ►
    [February](http://mrhinkydink.blogspot.com/2013/02/)
    (2)

* ►
  [2012](http://mrhinkydink.blogspot.com/2012/)
  (6)
  + ►
    [November](http://mrhinkydink.blogspot.com/2012/11/)
    (1)
  + ►
    [May](http://mrhinkydink.blogspot.com/2012/05/)
    (1)
  + ►
    [April](http://mrhinkydink.blogspot.com/2012/04/)
    (1)
  + ►
    [March](http://mrhinkydink.blogspot.com/2012/03/)
    (1)
  + ►
    [January](http://mrhinkydink.blogspot.com/2012/01/)
    (2)

* ►
  [2011](http://mrhinkydink.blogspot.com/2011/)
  (75)
  + ►
    [December](http://mrhinkydink.blogspot.com/2011/12/)
    (3)
  + ►
    [November](http://mrhinkydink.blogspot.com/2011/11/)
    (2)
  + ►
    [October](http://mrhinkydink.blogspot.com/2011/10/)
    (2)
  + ►
    [September](http://mrhinkydink.blogspot.com/2011/09/)
    (8)
  + ►
    [August](http://mrhinkydink.blogspot.com/2011/08/)
    (17)
  + ►
    [July](http://mrhinkydink.blogspot.com/2011/07/)
    (7)
  + ►
    [June](http://mrhinkydink.blogspot.com/2011/06/)
    (9)
  + ►
    [May](http://mrhinkydink.blogspot.com/2011/05/)
    (12)
  + ►
    [April](http://mrhinkydink.blogspot.com/2011/04/)
    (7)
  + ►
    [March](http://mrhinkydink.blogspot.com/2011/03/)
    (2)
  + ►
    [February](http://mrhinkydink.blogspot.com/2011/02/)
    (1)
  + ►
    [January](http://mrhinkydink.blogspot.com/2011/01/)
    (5)

* ▼
  [2010](http://mrhinkydink.blogspot.com/2010/)
  (53)
  + ►
    [December](http://mrhinkydink.blogspot.com/2010/12/)
    (2)
  + ►
    [November](http://mrhinkydink.blogspot.com/2010/11/)
    (2)
  + ►
    [October](http://mrhinkydink.blogspot.com/2010/10/)
    (3)
  + ►
    [September](http://mrhinkydink.blogspot.com/2010/09/)
    (12)
  + ►
    [August](http://mrhinkydink.blogspot.com/2010/08/)
    (12)
  + ►
    [July](http://mrhinkydink.blogspot.com/2010/07/)
    (5)
  + ►
    [June](http://mrhinkydink.blogspot.com/2010/06/)
    (1)
  + ▼
    [May](http://mrhinkydink.blogspot.com/2010/05/)
    (2)
    - [Websense 6.3.3 "Via:" Bypass](http://mrhinkydink.blogspot.com/2010/05/websense-633-via-bypass.html)
    - [New\_Laptop\_Boi](http://mrhinkydink.blogspot.com/2010/05/newlaptopboi.html)
  + ►
    [April](http://mrhinkydink.blogspot.com/2010/04/)
    (2)
  + ►
    [March](http://mrhinkydink.blogspot.com/2010/03/)
    (3)
  + ►
    [February](http://mrhinkydink.blogspot.com/2010/02/)
    (5)
  + ►
    [January](http://mrhinkydink.blogspot.com/2010/01/)
    (4)

* ►
  [2009](http://mrhinkydink.blogspot.com/2009/)
  (65)
  + ►
    [December](http://mrhinkydink.blogspot.com/2009/12/)
    (16)
  + ►
    [November](http://mrhinkydink.blogspot.com/2009/11/)
    (3)
  + ►
    [October](http://mrhinkydink.blogspot.com/2009/10/)
    (1)
  + ►
    [September](http://mrhinkydink.blogspot.com/2009/09/)
    (7)
  + ►
    [August](http://mrhinkydink.blogspot.com/2009/08/)
    (3)
  + ►
    [July](http://mrhinkydink.blogspot.com/2009/07/)
    (2)
  + ►
    [June](http://mrhinkydink.blogspot.com/2009/06/)
    (2)
  + ►
    [May](http://mrhinkydink.blogspot.com/2009/05/)
    (5)
  + ►
    [April](http://mrhinkydink.blogspot.com/2009/04/)
    (6)
  + ►
    [March](http://mrhinkydink.blogspot.com/2009/03/)
    (3)
  + ►
    [February](http://mrhinkydink.blogspot.com/2009/02/)
    (13)
  + ►
    [January](http://mrhinkydink.blogspot.com/2009/01/)
    (4)

* ►
  [2008](http://mrhinkydink.blogspot.com/2008/)
  (63)
  + ►
    [December](http://mrhinkydink.blogspot.com/2008/12/)
    (5)
  + ►
    [November](http://mrhinkydink.blogspot.com/2008/11/)
    (8)
  + ►
    [October](http://mrhinkydink.blogspot.com/2008/10/)
    (1)
  + ►
    [September](http://mrhinkydink.blogspot.com/2008/09/)
    (4)
  + ►
    [August](http://mrhinkydink.blogspot.com/2008/08/)
    (10)
  + ►
    [July](http://mrhinkydink.blogspot.com/2008/07/)
    (8)
  + ►
    [June](http://mrhinkydink.blogspot.com/2008/06/)
    (12)
  + ►
    [May](http://mrhinkydink.blogspot.com/2008/05/)
    (5)
  + ►
    [April](http://mrhinkydink.blogspot.com/2008/04/)
    (2)
  + ►
    [March](http://mrhinkydink.blogspot.com/2008/03/)
    (6)
  + ►
    [February](http://mrhinkydink.blogspot.com/2008/02/)
    (2)

* ►
  [2007](http://mrhinkydink.blogspot.com/2007/)
  (27)
  + ►
    [December](http://mrhinkydink.blogspot.com/2007/12/)
    (3)
  + ►
    [November](http://mrhinkydink.blogspot.com/2007/11/)
    (4)
  + ►
    [October](http://mrhinkydink.blogspot.com/2007/10/)
    (3)
  + ►
    [September](http://mrhinkydink.blogspot.com/2007/09/)
    (6)
  + ►
    [August](http://mrhinkydink.blogspot.com/2007/08/)
    (3)
  + ►
    [July](http://mrhinkydink.blogspot.com/2007/07/)
    (3)
  + ►
    [June](http://mrhinkydink.blogspot.com/2007/06/)
    (3)
  + ►
    [January](http://mrhinkydink.blogspot.com/2007/01/)
    (2)

* ►
  [2006](http://mrhinkydink.blogspot.com/2006/)
  (4)
  + ►
    [December](http://mrhinkydink.blogspot.com/2006/12/)
    (2)
  + ►
    [November](http://mrhinkydink.blogspot.com/2006/11/)
    (1)
  + ►
    [June](http://mrhinkydink.blogspot.com/2006/06/)
    (1)

## Hinky Links

* [PoTTY Download Page](http://www.mrhinkydink.com/potty.htm)
* [Proxy List](http://www.mrhinkydink.com/proxies.htm)
* [Public GPG Key](http://www.mrhinkydink.com/hinky.asc)
* [Murder/Suicide Blog](http://murder-suicide.blogspot.com/)
* [NOTE: I am NOT this guy](http://www.dailykos.com/user/MrHinkyDink)
* [Or this guy!](http://www.time.com/time/magazine/article/0%2C9171%2C884522%2C00.html)

## Search This Blog

|  |  |
| --- | --- |

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Awesome Inc. theme. Powered by [Blogger](https://draft.blogger.com).


