```
RELATED: CVE-2010-5040
```

**Root cause of vulnerability**: The Nucleus Plugin Gallery plugin for Nucleus CMS has vulnerabilities, specifically in `NP_gallery.php` and how it handles the `DIR_NUCLEUS` parameter, as well as SQL injection flaws in `index.php` with the `type` parameters `album` and `item`.

**Weaknesses/vulnerabilities present**:
- Remote File Inclusion (RFI): Vulnerability in `NP_gallery.php` allowing an attacker to include a remote file by manipulating the `DIR_NUCLEUS` parameter.
- SQL Injection (SQLi): Vulnerabilities in `index.php` using the `gallery` plugin with `type=album` and `type=item`, allowing SQL queries to be injected through the `id` parameter.

**Impact of exploitation**:
- RFI: An attacker can execute arbitrary code by including a malicious remote file, potentially gaining control of the server or manipulating data.
- SQLi: An attacker can potentially retrieve sensitive information, such as user credentials, from the database or potentially modify or delete data.

**Attack vectors**:
- RFI: By sending a crafted HTTP request to `NP_gallery.php` with a malicious URL in the `DIR_NUCLEUS` parameter.
- SQLi: By sending crafted HTTP requests to `index.php` with manipulated SQL queries within the `id` parameter when `type` is either `album` or `item`.

**Required attacker capabilities/position**:
- The attacker needs to be able to send HTTP requests to the vulnerable Nucleus CMS installation. They do not need to be authenticated.
- The attacker needs to know the path to the vulnerable files within the Nucleus CMS installation.