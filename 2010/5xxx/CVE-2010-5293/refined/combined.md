=== Content from core.trac.wordpress.org_96a5e851_20250125_141008.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fchangeset%2F16637)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ← [Previous Changeset](/changeset/16636 "Changeset 16636")
* [Next Changeset](/changeset/16638 "Changeset 16638") →

---

# Changeset 16637

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/30/2010 10:46:35 PM
([14 years](/timeline?from=2010-11-30T22%3A46%3A35Z&precision=second "See timeline at 11/30/2010 10:46:35 PM") ago)

Author:
markjaquith
Message:

Drop pingback/trackback blogroll whitelisting feature. Too many ways to abuse it. props avereha. props vladimir\_kolesnikov. fixes [#13887](/ticket/13887 "#13887: defect (bug): comment_whitelist checking in check_comment (closed: fixed)") for trunk

File:

1 edited

* [trunk/wp-includes/comment.php](/browser/trunk/wp-includes/comment.php?rev=16637 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [trunk/wp-includes/comment.php](/changeset/16637/trunk/wp-includes/comment.php "Show the changeset 16637 restricted to trunk/wp-includes/comment.php")

  | [r16624](/browser/trunk/wp-includes/comment.php?rev=16624#L19 "Show revision 16624 of this file in browser") | [r16637](/browser/trunk/wp-includes/comment.php?rev=16637#L19 "Show revision 16637 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | \* then the check fails. |
  | 20 | 20 | \* |
  | 21 |  | \* If the comment is a trackback and part of the blogroll, then the trackback is |
  | 22 |  | \* automatically whitelisted. If the comment author was approved before, then |
  | 23 |  | \* the comment is automatically whitelisted. |
  |  | 21 | \* If the comment author was approved before, then the comment is |
  |  | 22 | \* automatically whitelisted. |
  | 24 | 23 | \* |
  | 25 | 24 | \* If none of the checks fail, then the failback is to set the check to pass |
  | […](/browser/trunk/wp-includes/comment.php?rev=16624#L83) | […](/browser/trunk/wp-includes/comment.php?rev=16637#L82) |  |
  | 83 | 82 | // Comment whitelisting: |
  | 84 | 83 | if ( 1 == get\_option('comment\_whitelist')) { |
  | 85 |  | if ( 'trackback' == $comment\_type || 'pingback' == $comment\_type ) { // check if domain is in blogroll |
  | 86 |  | $uri = parse\_url($url); |
  | 87 |  | $domain = $uri['host']; |
  | 88 |  | $uri = parse\_url( home\_url() ); |
  | 89 |  | $home\_domain = $uri['host']; |
  | 90 |  | if ( $wpdb->get\_var($wpdb->prepare("SELECT link\_id FROM $wpdb->links WHERE link\_url LIKE (%s) LIMIT 1", '%'.$domain.'%')) || $domain == $home\_domain ) |
  | 91 |  | return true; |
  | 92 |  | else |
  | 93 |  | return false; |
  | 94 |  | } elseif ( $author != '' && $email != '' ) { |
  |  | 84 | if ( 'trackback' != $comment\_type && 'pingback' != $comment\_type && $author != '' && $email != '' ) { |
  | 95 | 85 | // expected\_slashed ($author, $email) |
  | 96 | 86 | $ok\_to\_comment = $wpdb->get\_var("SELECT comment\_approved FROM $wpdb->comments WHERE comment\_author = '$author' AND comment\_author\_email = '$email' and comment\_approved = '1' LIMIT 1"); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=16637)
* [Zip Archive](?format=zip&new=16637)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from core.trac.wordpress.org_cb605c59_20250125_141009.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fticket%2F13887)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ← [Previous Ticket](/ticket/13886 "Ticket #13886")
* [Next Ticket](/ticket/13888 "Ticket #13888") →

---

Opened [15 years ago](/timeline?from=2010-06-14T12%3A21%3A56Z&precision=second "See timeline at 06/14/2010 12:21:56 PM")

Closed [14 years ago](/timeline?from=2010-11-30T22%3A49%3A59Z&precision=second "See timeline at 11/30/2010 10:49:59 PM")

## [#13887](/ticket/13887) [closed](/query?status=closed) [defect (bug)](/query?status=!closed&type=defect+(bug)) ([fixed](/query?status=closed&resolution=fixed))

# comment\_whitelist checking in check\_comment

| Reported by: | [avereha's profile](https://profiles.wordpress.org/avereha) [avereha](/query?status=!closed&reporter=avereha) | Owned by: |  |
| --- | --- | --- | --- |
| Milestone: | [3.0.2](/milestone/3.0.2 "Completed 14 years ago (11/30/2010 11:20:00 PM)") | Priority: | [high](/query?status=!closed&priority=high) |
| Severity: | [normal](/query?status=!closed&severity=normal) | Version: | [2.9.2](/query?status=!closed&version=2.9.2) |
| Component: | [Comments](/query?status=!closed&component=Comments) | Keywords: | [has-patch](/query?status=!closed&keywords=~has-patch) |
| Focuses: |  | Cc: |  |

### Description

If you have the "comment\_whitelist"(Comment author must have a previously approved comment) option activated in Wordpress 2.9.2, and someone post a trackback or pingback comment with Comment Author's domain "%", the comment is automaticaly approved.

I think the bug is in the wp-includes/comment.php file, check\_comment function, this condition:

if ( $wpdb->get\_var($wpdb->prepare("SELECT link\_id FROM $wpdb->links WHERE link\_url LIKE (%s) LIMIT 1", '%'.$domain.'%'))...

if $domain == "%", the first condition is true, and the comment approved.

The URL is like this one: [​http://%/something.ru](http://%/something.ru)

### Attachments (1)

[13887.diff](/attachment/ticket/13887/13887.diff "View attachment")[​](/raw-attachment/ticket/13887/13887.diff "Download") (909 bytes) - added by dd32 [15 years ago](/timeline?from=2010-06-18T13%3A28%3A55Z&precision=second "See timeline at 06/18/2010 01:28:55 PM").

Download all attachments as: [.zip](/zip-attachment/ticket/13887/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (11)

### [#1](#comment:1) [@GautamGupta](https://profiles.wordpress.org/gautamgupta) [15 years](/timeline?from=2010-06-18T04%3A29%3A25Z&precision=second "See timeline at 06/18/2010 04:29:25 AM") ago

* **Milestone**
  changed from *Unassigned* to *3.0.1*
* **Priority**
  changed from *normal* to *high*

### [#2](#comment:2) [@nacin](https://profiles.wordpress.org/nacin) [15 years](/timeline?from=2010-06-18T05%3A42%3A09Z&precision=second "See timeline at 06/18/2010 05:42:09 AM") ago

That code is to check to see whether the domain is in the blogroll, in which case we whitelist the ping. The % are MySQL placeholders for LIKE.

### [#3](#comment:3) [@nacin](https://profiles.wordpress.org/nacin) [15 years](/timeline?from=2010-06-18T06%3A31%3A03Z&precision=second "See timeline at 06/18/2010 06:31:03 AM") ago

like\_escape(), I suppose...

### [#4](#comment:4) [@avereha](https://profiles.wordpress.org/avereha) [15 years](/timeline?from=2010-06-18T11%3A59%3A22Z&precision=second "See timeline at 06/18/2010 11:59:22 AM") ago

I don't think escaping the '\_' and '%' characters will solve the problem.

Supose you receive the "[​http://a/anything](http://a/anything)" url. If you have any link in blogroll containing the letter "a", the comment will be approved again.

### [#5](#comment:5) [@dd32](https://profiles.wordpress.org/dd32) [15 years](/timeline?from=2010-06-18T13%3A28%3A12Z&precision=second "See timeline at 06/18/2010 01:28:12 PM") ago

The result here is that any url's submitted must have a domain name which exists within your blogroll to exploit this loophole. It virtually results in the worst case being that pingbacks/trackbacks will bypass the checks IF their domain exists within a link, somewhere.

Currently, a url of '[​http://something.com/](http://something.com/)' will pass as whitelisted if you have a site of '[​http://google.com/results/something.com/page/2/](http://google.com/results/something.com/page/2/)'

With attached patch: (default blogroll, so wordpress.org exists within it.)

Before:

```
string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('%localhost%') LIMIT 1' (length=72)
boolean true

string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('%%%') LIMIT 1' (length=64)
boolean true

string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('%abc%') LIMIT 1' (length=66)
boolean false

string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('%wordpress.org%') LIMIT 1' (length=76)
boolean true

```

After:

```
string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('http://localhost%') LIMIT 1' (length=78)
boolean true

string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('http://\\%%') LIMIT 1' (length=72)
boolean false

string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('http://abc%') LIMIT 1' (length=72)
boolean false

string 'SELECT link_id FROM wp_links WHERE link_url LIKE ('http://wordpress.org%') LIMIT 1' (length=82)
boolean true

```

Seems like a better idea to check the scheme/domain, not only will it prevent the domain existing -somewhere- in a link, but it'll also allow the DB to perform the search better i'd assume (thanks to the anchoring start, rather than an open-ender)

### [@dd32](https://profiles.wordpress.org/dd32) [15 years](/timeline?from=2010-06-18T13%3A28%3A55Z&precision=second "See timeline at 06/18/2010 01:28:55 PM") ago

* **Attachment**
  [*13887.diff*](/attachment/ticket/13887/13887.diff)[​](/raw-attachment/ticket/13887/13887.diff "Download")
  added

### [#6](#comment:6) [@nacin](https://profiles.wordpress.org/nacin) [15 years](/timeline?from=2010-07-06T21%3A11%3A50Z&precision=second "See timeline at 07/06/2010 09:11:50 PM") ago

* **Keywords**
  *has-patch* added
* **Milestone**
  changed from *3.0.1* to *3.1*

Patch looks good. Moving to 3.1 though since this isn't a regression.

### [#7](#comment:7) [@markjaquith](https://profiles.wordpress.org/markjaquith) [14 years](/timeline?from=2010-11-30T22%3A41%3A50Z&precision=second "See timeline at 11/30/2010 10:41:50 PM") ago

We received some more information on this one. This can be used to sneak spam past moderation. And none of the solutions we looked at could solve the issue of someone using a Trackback URL of "[​http://wordpress.org/foobar123](http://wordpress.org/foobar123)", and then putting spam (or just hateful/undesired content) into the body. We're just going to drop this feature entirely.

### [#8](#comment:8) [@markjaquith](https://profiles.wordpress.org/markjaquith) [14 years](/timeline?from=2010-11-30T22%3A46%3A38Z&precision=second "See timeline at 11/30/2010 10:46:38 PM") ago

* **Resolution**
  set to *fixed*
* **Status**
  changed from *new* to *closed*

(In [[16637]](/changeset/16637 "Drop pingback/trackback blogroll whitelisting feature. Too many ways ...")) Drop pingback/trackback blogroll whitelisting feature. Too many ways to abuse it. props avereha. props vladimir\_kolesnikov. fixes [#13887](/ticket/13887 "#13887: defect (bug): comment_whitelist checking in check_comment (closed: fixed)") for trunk

### [#9](#comment:9) [@markjaquith](https://profiles.wordpress.org/markjaquith) [14 years](/timeline?from=2010-11-30T22%3A49%3A29Z&precision=second "See timeline at 11/30/2010 10:49:29 PM") ago

* **Milestone**
  changed from *3.1* to *3.0.2*
* **Resolution**
  *fixed* deleted
* **Status**
  changed from *closed* to *reopened*

Re-open for 3.0.2

### [#10](#comment:10) [@markjaquith](https://profiles.wordpress.org/markjaquith) [14 years](/timeline?from=2010-11-30T22%3A49%3A59Z&precision=second "See timeline at 11/30/2010 10:49:59 PM") ago

* **Resolution**
  set to *fixed*
* **Status**
  changed from *reopened* to *closed*

(In [[16638]](/changeset/16638 "Drop pingback/trackback blogroll whitelisting feature. Too many ways ...")) Drop pingback/trackback blogroll whitelisting feature. Too many ways to abuse it. props avereha. props vladimir\_kolesnikov. fixes [#13887](/ticket/13887 "#13887: defect (bug): comment_whitelist checking in check_comment (closed: fixed)") for 3.0.x

**Note:** See
[TracTickets](/wiki/TracTickets) for help on using
tickets.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Comma-delimited Text](/ticket/13887?format=csv)
* [Tab-delimited Text](/ticket/13887?format=tab)
* [RSS Feed](/ticket/13887?format=rss)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from codex.wordpress.org_ce734b76_20250125_141006.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Documentation](https://wordpress.org/documentation)

Version 3.0.2

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

[Home](https://wordpress.org/documentation)Version 3.0.2

Search documentation

# Version 3.0.2

## In this article

Table of Contents

* [Installation/Update Information](#installation-update-information)
* [Summary](#summary)
* [List of Files Revised](#list-of-files-revised)

[↑ Back to top](#wp--skip-link--target)

On November 30, 2010, WordPress 3.0.2 was released to the public. This was a mandatory security update for all previous WordPress versions.

For version 3.0.2, the database version (**db\_version** in **wp\_options**) remained at 15477.

## [Installation/Update Information](#installation-update-information)

To download WordPress 3.0.2, update automatically from the Dashboard > Updates menu in your site’s admin area or visit <https://wordpress.org/download/release-archive/>.

For step-by-step instructions on installing and updating WordPress:

* [Updating WordPress](https://wordpress.org/documentation/article/updating-wordpress/)

If you are new to WordPress, we recommend that you begin with the following:

* [New To WordPress – Where to Start](https://wordpress.org/documentation/article/new_to_wordpress_-_where_to_start/)
* [First Steps With WordPress](https://wordpress.org/documentation/article/first-steps-with-wordpress/) or [Upgrading WordPress Extended](https://wordpress.org/documentation/article/upgrading-wordpress-extended-instructions/)
* [WordPress Lessons](https://wordpress.org/documentation/article/wordpress-lessons/)

## [Summary](#summary)

* Fix moderate security issue where a malicious Author-level user could gain further access to the site. ([r16625](https://core.trac.wordpress.org/changeset/16625))

Other bugs and security hardening:

* Remove pingback/trackback blogroll whitelisting feature as it can easily be abused. ([#13887](https://core.trac.wordpress.org/ticket/13887))
* Fix canonical redirection for permalinks containing %category% with nested categories and paging. ([#13471](https://core.trac.wordpress.org/ticket/13471))
* Fix occasional irrelevant error messages on plugin activation. ([#15062](https://core.trac.wordpress.org/ticket/15062))
* Minor XSS fixes in request\_filesystem\_credentials() and when deleting a plugin. ([r16367](https://core.trac.wordpress.org/changeset/16367), [r16373](https://core.trac.wordpress.org/changeset/16373))
* Clarify the license in the readme ([r15534](https://core.trac.wordpress.org/changeset/15534))
* Multisite: Fix the delete\_user meta capability ([r15562](https://core.trac.wordpress.org/changeset/15562))
* Multisite: Force current\_user\_can\_for\_blog() to run map\_meta\_cap() even for super admins ([#15122](https://core.trac.wordpress.org/ticket/15122))
* Multisite: Fix ms-files.php content type headers when requesting a URL with a query string ([#14450](https://core.trac.wordpress.org/ticket/14450))
* Multisite: Fix the usage of the SUBDOMAIN\_INSTALL constant for upgraded WordPress MU installs ([#14536](https://core.trac.wordpress.org/ticket/14536))

## [List of Files Revised](#list-of-files-revised)

```
wp-includes/ms-files.php
wp-includes/version.php
wp-includes/comment.php
wp-includes/functions.php
wp-includes/load.php
wp-includes/canonical.php
wp-includes/capabilities.php
readme.html
wp-admin/includes/plugin.php
wp-admin/includes/file.php
wp-admin/includes/update-core.php
wp-admin/plugins.php
```

First published

May 19, 2019

Last updated

## Get more help

[Support forums](https://wordpress.org/support/forums/)

Ask questions in the support forums.

[Developers](https://developer.wordpress.org/)

Check out the developer documentation.

[Content suggestions](https://github.com/WordPress/Documentation-Issue-Tracker/issues)

Report an error or change in the documentation issue tracker.

[Get involved](https://make.wordpress.org/docs/)

Learn about the Documentation Team and how to contribute.

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


