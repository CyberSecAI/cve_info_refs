This document describes multiple vulnerabilities in VWar 1.6.1 R2.

**1. SQL Injection**

*   **Root Cause:** Unsanitized input in `vwar/article.php` within the article rating system. The `ratearticleselect` parameter is directly concatenated into an SQL query without proper sanitization.
*   **Vulnerability:** SQL Injection
*   **Impact:** An attacker can manipulate the SQL query to deface articles, cause denial of service (DoS), or perform other SQL-related attacks.
*   **Attack Vector:** Sending a crafted POST request to `vwar/article.php` with a malicious `ratearticleselect` parameter.
*   **Attacker Capabilities:** The attacker can send HTTP requests to the vulnerable application.

**2. Stored Cross Site Scripting (XSS)**

*   **Root Cause:** Inadequate input sanitization in several forms, specifically within the `challenge.php`, `joinus.php`, `admin/admin.php`, and `profile.php` pages. The application filters `<script>` tags but allows `<img>` tags with event handlers like `onload` and `onerror`.
*  **Vulnerability:** Stored XSS
*   **Impact:** An attacker can inject malicious JavaScript code that will execute in the browsers of other users, including administrators. This can lead to session hijacking and complete compromise of accounts.
*   **Attack Vector:** Inputting malicious HTML containing `<img>` tags with JavaScript event handlers in the vulnerable forms.
*   **Attacker Capabilities:** The attacker needs to be able to submit data to the vulnerable forms, typically through a web browser.

**3. Broken Access Controls**

*   **Root Cause:** Lack of access control in `popup.php` which allows access to restricted articles via the `printnews` action.
*   **Vulnerability:** Broken Access Control
*   **Impact:** Unauthorized access to restricted news articles by non-logged in users.
*   **Attack Vector:** Directly accessing `popup.php` with the `printnews` action and the `newsid` parameter.
*   **Attacker Capabilities:** The attacker needs to be able to send HTTP requests to the vulnerable application.

**4. Weak Password Generation**

*  **Root Cause:** The random password generation function in `vwar/includes/functions_common.php` uses `mt_srand` seeded with the current second of system time. This results in very limited number of possible passwords. There is no account lockout mechanism in place.
*   **Vulnerability:** Weak password generation.
*   **Impact:** An attacker can easily brute-force user passwords.
*   **Attack Vector:** By using the password reset functionality or the user enumeration available, an attacker can brute force the weak passwords in a few seconds.
*  **Attacker Capabilities:** The attacker can access the password reset functionality and can enumerate users.

**5. Static Session Cookies**

*   **Root Cause:** Session cookies are generated by hashing the user's password, leading to static session cookies which do not change even after logout or session timeout.
*   **Vulnerability:** Static session cookies
*   **Impact:** An attacker who obtains a user's session cookie can impersonate that user indefinitely, regardless of logout or session timeouts.
*   **Attack Vector:** An attacker can obtain the user's cookie (e.g. through XSS) and use it to gain access to the account.
*   **Attacker Capabilities:** The attacker must obtain a user's session cookie.

This content provides detailed information about multiple vulnerabilities affecting VWar 1.6.1 R2, which is more extensive than a standard CVE description. It includes code snippets, proof-of-concept attack vectors, and potential mitigations.