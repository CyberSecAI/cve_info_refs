- **Root cause of vulnerability:** The FTP proxy in Apple Airport products does not properly validate the address and port provided in the FTP PORT command against the client's IP address or against the use of privileged ports.
- **Weaknesses/vulnerabilities present:**
    - Lack of input validation on the FTP PORT command.
    - The FTP proxy does not verify if the requested address and port for the data connection matches the connecting client or whether privileged ports are being used.
    - The FTP proxy rewrites addresses in the command channel for FTP servers behind a NAT, but without proper validation.
- **Impact of exploitation:**
    - An attacker can induce an FTP server behind a NAT to send data to arbitrary addresses and ports by manipulating the PORT command.
    - This can be used for port scans, anonymous attacks, spam, news floods, and other malicious activities.
    - The NAT's security is compromised as the PORT command can specify private addresses inside the NAT.
    - The gateway does not log FTP connections run through the proxy, hindering detection.
- **Attack vectors:**
    - The attacker needs access to the FTP port forwarded on the external side of the Apple Airport product that offers NAT.
    - The attacker sends a crafted FTP PORT command to the FTP server behind the NAT, through the vulnerable FTP proxy, specifying a target IP and port.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to send FTP commands to a server behind an Apple Airport product's NAT.
    - The attacker must be able to initiate a connection with the FTP port forwarded by the Apple Airport product.