- **Root cause of vulnerability:** The AirPort Extreme Base Station and Time Capsule's Application-Level Gateway (ALG) incorrectly rewrites incoming FTP traffic, specifically PORT commands.
- **Weaknesses/vulnerabilities present:** The ALG rewrites the source of the traffic, including PORT commands, to appear as if it is the source. This allows attackers to manipulate the PORT command and make the ALG send data to an IP and port behind the NAT.
- **Impact of exploitation:** An attacker with write access to an FTP server behind the NAT can issue a malicious PORT command. This will cause the ALG to send attacker-supplied data to an arbitrary IP and port behind the NAT. Since the data originates from the Base Station, it could bypass any IP-based restrictions for the service. This allows an attacker to potentially query services behind the NAT.
- **Attack vectors:** An attacker with write access to an FTP server located behind the NAT of the AirPort Base Station can exploit the vulnerability. The attacker sends a crafted PORT command through this FTP server.
- **Required attacker capabilities/position:** The attacker needs write access to an FTP server behind the vulnerable AirPort Base Station or Time Capsule's NAT.