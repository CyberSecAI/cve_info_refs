=== Content from www.mandriva.com_85326bd9_20250125_172736.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from secure.grepular.com_e1a1fda1_20250125_172737.html ===

# [Grepular](./ "Take me Home Mike")

[Log in](./login?redirect=%2FDNS_Prefetch_Exposure_on_Thunderbird_and_Webmail)[Home](./)[Projects](./projects/)[Blog](./blog/)
## DNS Pre-fetch Exposure on Thunderbird and Webmail

*Written 15 years ago by Mike Cardwell*

When you view an email in [Mozilla Thunderbird](http://getthunderbird.com/), it looks at each of the URLs in the body, and does a DNS lookup on each of the domains. It does this so the page loads faster if you click on the link. It doesn’t just happen on HTML emails, it also happens for plain text emails. Viewing the body in “Plain Text” mode rather than the “Original HTML” or “Simple HTML” modes doesn’t prevent it either. This also happens when using webmail clients like GMail and Hotmail and I will discuss that further down the article.

Email clients tend to have a configuration option to prevent remote images from being loaded, and on sane clients this is set by default. If a remote image is fetched to be displayed inside an email, the sender can determine that the email has been read, when it was read, and the IP address it was read from. Even if remote images are disabled in Thunderbird, the DNS prefetching **still** takes place.

A spammer with the domain “example.com,” could send out a mail-shot to all of their addresses, with each email containing a URL with a unique domain. Eg:

```
http://emailaddressX.mailshotY.example.com/

```

They could configure the DNS server on example.com to log all DNS queries. This is simple to do using the [Bind DNS server](https://www.isc.org/software/bind):

```
logging {
    channel query_logging {
        file "/var/log/bind/query" versions 3 size 100M;
        print-time yes;
    };
    category queries {
        query_logging;
    };
};

```

They would then write a simple script for tailing the log file at /var/log/bind/query looking for DNS lookups containing “mailshotY.example.com”.

I tested this on the very latest version of Thunderbird (3.0.1), on both OSX (Snow Leopard) and Windows XP; both were affected. I also tested on Apple Mail and Outlook 2007, neither of which were affected. I didn’t bother testing Mutt or Pine.

This issue seems to have been [discussed](https://bugzilla.mozilla.org/show_bug.cgi?id=492196) back in May, but they don’t seem to have done anything about it.

Worryingly, this issue also affects viewing email in webmail clients. I tested it using hotmail and gmail and both did DNS prefetching on the URLs in the email body. Using HTTPS rather than HTTP disables DNS prefetching. Luckily for GMail users, they recently made all requests HTTPS by default. This would be easily fixed in webmail clients by using X-DNS-Prefetch-Control. In the HTML just before the email is displayed, you would put the following tag to disable prefetching:

```
<meta http-equiv="x-dns-prefetch-control" content="off">

```

In the HTML immediately after the email you would turn DNS prefetching back on with:

```
<meta http-equiv="x-dns-prefetch-control" content="on">

```

**Update:**

Patches for the Webmail clients [IMP](http://www.horde.org/imp/) ([ref](http://bugs.horde.org/ticket/8836)) and [RoundCube](http://www.roundcube.net/) ([ref](http://trac.roundcube.net/ticket/1486449)) have been produced. If you’re serving Webmail with Apache, you can patch this problem in the web server it’s self by adding some mod\_headers config like this:

```
Header set X-DNS-Prefetch-Control "off"

```

If you’re using Thunderbird, you can fix the problem locally by going into the advanced config editor and adding a preference named “network.dns.disablePrefetch” with a boolean value of “true”

Want to leave a tip?![Bitcoin](./images/bitcoin.png)![Monero](./images/monero.svg)![Zcash](./images/zcash.png)[![Paypal](./images/paypal.png)](//www.paypal.me/grepular "Donate via Paypal")You can follow this Blog using [RSS](./rss) or [Mastodon](//mastodon.social/%40grepular). To read more, visit my [blog index](./blog).

Website design, production and hosting by Mike Cardwell

[![Digital Ocean](./images/digitalocean-badge-white.png)](//www.digitalocean.com/?refcode=2529a7adf896 "This Blog, hosted on Digital Ocean - Fast, Cheap, Reliable VPS hosting (affiliate link)")![Bitcoin](./images/bitcoin.png)![Monero](./images/monero.svg)![Zcash](./images/zcash.png)[![Paypal](./images/paypal.png)](//www.paypal.me/grepular "Leave a Paypal tip")[![RSS Feed](./images/icon/rss-26x26.png)](./rss "RSS Feed")
