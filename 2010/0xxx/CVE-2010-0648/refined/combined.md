=== Content from code.google.com_6180a82a_20250126_003113.html ===



=== Content from nomoreroot.blogspot.com_517b9ac6_20250126_003120.html ===


# [No More Root](http://nomoreroot.blogspot.com/)

Information security, exploits, database security, web application security, windows security, hacking, 0day, whatever, etc.

## Jan 9, 2010

### Little bug in Safari and Google Chrome

I guess a bug in Safari it's not a surprise at all but Google Chrome seems to be a more secure product. Anyways this little bug is not big deal but maybe combined with other bug it could be more dangerous.

<link rel="stylesheet" type="text/css" href="http://www.yahoo.com">
Hola
<script language="javascript">
setTimeout("alert(document.styleSheets[0].href)", 10000);
//setTimeout is used just to wait for page loading
</script>

The code above should display the same href value as in the LINK tag but it displays the final URL if there is a redirection, here in my country when you browse to <http://www.yahoo.com/> you get redirected to <http://ar.yahoo.com/?p=us> so the above code displays this last URL.

Why this is an issue?
-There are some websites that put user session ids on the URL querystrings the same for tokens used for CSRF protection, if an attacker can get a user browsing his website then he can use the above code to reference a URL of a website the user is logged on that will be redirected to another URL that could have a session id or token in the querystring and then use this information for more dangerous attacks. Some websites could also have in the querystring some other useful information that could be used for further attacks. Websites putting session ids, tokens, etc. in querystings are already not secure but this issue helps in exploiting them.

-An attacker can also use this issue to determine if a user is logged in or not by comparing if the original URL is the same as the final one when trying to access a feature thar requires to be logged in.

-Maybe there are other possible ways of abusing this issue that I'm not aware right now.

Microsoft Internet Explorer and Mozilla Firefox are not vulnerable to this.

Enjoy.

Publicado por

[Cesar Cerrudo](https://www.blogger.com/profile/06168334482904759553 "author profile")

en

[5:46 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=3055250018425068623&postID=2346038544460598360&from=pencil "Edit Post")

Etiquetas:
[0day](http://nomoreroot.blogspot.com/search/label/0day),
[Google Chrome](http://nomoreroot.blogspot.com/search/label/Google%20Chrome),
[Safari](http://nomoreroot.blogspot.com/search/label/Safari),
[vulnerability](http://nomoreroot.blogspot.com/search/label/vulnerability),
[Web hacking](http://nomoreroot.blogspot.com/search/label/Web%20hacking),
[XSRF](http://nomoreroot.blogspot.com/search/label/XSRF)

#### 8 comments:

[![](//www.blogger.com/img/blogger_logo_round_35.png "Unknown")](https://www.blogger.com/profile/12601594427575096471)
[Unknown](https://www.blogger.com/profile/12601594427575096471)
said...

firefox has a similar issue.. and IE.. as well.. haha

thanks! now there's a way to follow redirects on all browsers with js!

[January 11, 2010 at 2:35 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1263206110254#c7501800953951358583 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=7501800953951358583 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Cesar Cerrudo")](https://www.blogger.com/profile/06168334482904759553)
[Cesar Cerrudo](https://www.blogger.com/profile/06168334482904759553)
said...

@sdc as far as I know Firefox and IE don't have this problem, they always display the original URL.

[January 11, 2010 at 11:32 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1263238329839#c8676823920546454121 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=8676823920546454121 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "kuza55")](https://www.blogger.com/profile/03932544559060480887)
[kuza55](https://www.blogger.com/profile/03932544559060480887)
said...

Firefox actually patched this bug in early 2008 - I know since I reported it to them (though it seems someone got to them before me, so no credit).

At the time it was really useful, since Google's SSO system sent session ids in redirect URLs, even for apps that were a .google.com subdomain, in particular Gmail. These days it only happens for off-domain sites such as Blogger.

There are still similar redirect leak bugs floating around other browsers though.

[January 11, 2010 at 10:15 PM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1263276910128#c3213589993403411472 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=3213589993403411472 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "Marco Ramilli")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifhfY2OZmD6qXCcjfHxNCddet4CMKvGK6gr1Zg7cfaIsYwkdzjr6A4bmLzxwPyaQIBT1PiCV0ALZAjbyYSdjuSZ4UZI0NRyy5u5DARtH8VnXxdeLWZ_rblbF0R84zgvw/s45-c/image.jpeg)](https://www.blogger.com/profile/05480238030319998871)
[Marco Ramilli](https://www.blogger.com/profile/05480238030319998871)
said...

Yes, thank you for sharing it.I never though Chrome was vulnerable to this, but it is ! Awesome.

[January 25, 2010 at 9:48 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1264441701473#c4042604122108346234 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=4042604122108346234 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif ":-Derek")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgM33Zirl8udKzxn5L062PWD0L2FSWnfw9z2cylowLoVeNwA_WyNQlj-aUwSGqAvdp9tesvDcsiD9Bg90jRXbYQCiCg5bpXMkpSbMwB6BJhSzrbR-n9aFTpoyQvQX-2VA/s45-c/deeds_on_white__340_x_340_pixels+SOURCE.jpg)](https://www.blogger.com/profile/01192230834913012760)
[:-Derek](https://www.blogger.com/profile/01192230834913012760)
said...

Just a note that beta software has rarely had stringent security testing in the field. Therefore, have no expectations at this point of Google Chrome being any more or less secure than any other browser. Unfortunately, the big problem any browser has these days is the insecure nature of the code languages being used on the Internet. Example: JavaScript in general is now a major hazard; Active X, even worse.

[January 28, 2010 at 8:41 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1264696866448#c1844191867169946233 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=1844191867169946233 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "David Rosen")](https://www.blogger.com/profile/17326235840845709338)
[David Rosen](https://www.blogger.com/profile/17326235840845709338)
said...

Derek, why are you talking about beta software -- the release version of Chrome isn't beta.

[February 17, 2010 at 8:12 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1266423121419#c1166308316720533704 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=1166308316720533704 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "blakesteel")](https://www.blogger.com/profile/17876532778648205245)
[blakesteel](https://www.blogger.com/profile/17876532778648205245)
said...

I have tested this exploit in Google Chrome 4.0.249.89 and it has no effect. I tested with microsoft.com, yahoo.com, planetquake.com and other websites. They all resolved to the original LINK tag and not the final URL. This problem seems to have been corrected.

[February 26, 2010 at 7:09 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1267196945907#c226247382220308602 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=226247382220308602 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Cesar Cerrudo")](https://www.blogger.com/profile/06168334482904759553)
[Cesar Cerrudo](https://www.blogger.com/profile/06168334482904759553)
said...

@palisade yes it was fixed a couple of weeks ago

[February 27, 2010 at 11:31 AM](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html?showComment=1267299077608#c3646239565850689359 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3055250018425068623&postID=3646239565850689359 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/3055250018425068623/2346038544460598360)

[Newer Post](http://nomoreroot.blogspot.com/2010/01/blogger-allows-to-run-arbitrary.html "Newer Post")

[Older Post](http://nomoreroot.blogspot.com/2009/12/8-years-hacking-microsoft-stuff-50.html "Older Post")

[Home](http://nomoreroot.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://nomoreroot.blogspot.com/feeds/2346038544460598360/comments/default)

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhOfAgRwoYXDnBV-vuP-O8FIPK2Us3u_MT86e2xTE-pbsLlkM_HBqTl8RQEdgKmINqhS0w49WG34s0vIvKQ2wQszZaI8JjQOI6rbf-QrFtusRkV1bEcDXh-NtSq0ZM3I9SCX3iU2lD8PkBy/s220/foto.jpg)

| Blog Archive  * ►   [2011](http://nomoreroot.blogspot.com/2011/)   (1)   + ►     [January](http://nomoreroot.blogspot.com/2011/01/)     (1)  * ▼   [2010](http://nomoreroot.blogspot.com/2010/)   (3)   + ▼     [January](http://nomoreroot.blogspot.com/2010/01/)     (3)     - [Google Chrome Drag and Drop fun](http://nomoreroot.blogspot.com/2010/01/google-chrome-drag-and-drop-fun.html)     - [Blogger allows to run arbitrary Javascript](http://nomoreroot.blogspot.com/2010/01/blogger-allows-to-run-arbitrary.html)     - [Little bug in Safari and Google Chrome](http://nomoreroot.blogspot.com/2010/01/little-bug-in-safari-and-google-chrome.html)  * ►   [2009](http://nomoreroot.blogspot.com/2009/)   (4)   + ►     [December](http://nomoreroot.blogspot.com/2009/12/)     (1)   + ►     [October](http://nomoreroot.blogspot.com/2009/10/)     (1)   + ►     [April](http://nomoreroot.blogspot.com/2009/04/)     (1)   + ►     [March](http://nomoreroot.blogspot.com/2009/03/)     (1)  * ►   [2008](http://nomoreroot.blogspot.com/2008/)   (6)   + ►     [December](http://nomoreroot.blogspot.com/2008/12/)     (1)   + ►     [October](http://nomoreroot.blogspot.com/2008/10/)     (2)   + ►     [September](http://nomoreroot.blogspot.com/2008/09/)     (2)   + ►     [August](http://nomoreroot.blogspot.com/2008/08/)     (1) | Followers |
| --- | --- |

## About Me

[Cesar Cerrudo](https://www.blogger.com/profile/06168334482904759553)

Cesar is the founder and CEO of Argeniss, a security research and consultancy firm based in Argentina. He is specialized in application security. Regarded as a leading application security researcher, Cesar is credited with discovering and helping fix dozens of vulnerabilities in applications including Microsoft SQL Server, Oracle database server, IBM DB2, Microsoft BizTalk Server, Microsoft Commerce Server, Microsoft Windows, Yahoo! Messenger, etc. Cesar has authored several white papers on database, application security, attacks and exploitation techniques and he has been invited to present at a variety of companies and conferences including Microsoft, Black Hat, Bellua, CanSecWest, EuSecWest, WebSec. HITB, Microsoft BlueHat, etc.
Cesar collaborates and he is regulary quoted on online publications such as eWeek, ComputerWorld, etc.

[View my complete profile](https://www.blogger.com/profile/06168334482904759553)

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).


