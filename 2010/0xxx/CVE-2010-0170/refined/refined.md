Based on the provided information, here's an analysis of CVE-2010-0170:

**Root Cause of Vulnerability:**
- The vulnerability stemmed from the removal of code that protected the `window.location` object in Firefox 3.6 (Gecko 1.9.2). This change was made because new mechanisms were introduced to enforce the same-origin policy between windows and frames, making the previous protection seem unnecessary for web content and extensions. However, this removal inadvertently affected plugins that rely on `location.href` to determine the page origin for access restrictions.

**Weaknesses/Vulnerabilities Present:**
-  **Unprotected `window.location` object:** By making the `window.location` object a normal, overridable JavaScript object, malicious web pages gained the ability to modify it.
- **Plugin Reliance on `location.href`**:  Plugins were using `location.href` to determine the page origin.
- **Cross-Site Scripting (XSS):** This allowed a malicious page to override the `window.location` object and potentially trick a plugin into granting access to data on another site or the local file system, thus enabling XSS.

**Impact of Exploitation:**
- **Cross-Site Data Access:** A malicious page could manipulate the `window.location` object to make a plugin believe it was on a different site.
- **Local File System Access:**  Plugins could be tricked into accessing data on the local file system.
- **Privilege Escalation:** By gaining unauthorized access to resources, attackers could achieve a form of privilege escalation within the browser context.

**Attack Vectors:**
- A malicious web page is crafted to override the `window.location` object using JavaScript.
- A plugin, embedded in the same page, uses `location.href` to determine the origin of the page.
- Due to the overridden `window.location` object, the plugin is fooled into believing it's on a different or more privileged origin and grants access to sensitive resources it wouldn't normally allow.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to host a malicious web page.
- The user must visit this malicious page using a vulnerable version of Firefox (specifically Firefox 3.6).
- The user's browser must have a vulnerable plugin installed that relies on `location.href`.

**Additional Notes:**
- The vulnerability is a regression introduced by changes in Firefox 3.6.
- The fix involved re-implementing the protection of the `window.location` object to restore the behavior of older Firefox versions.
- The real fix was deemed to provide an API in NPAPI to allow plugins to figure out where they are, but in the meantime, the workaround was re-overprotecting the location object.
- The bug report mentions that this is "maybe critical if plugins can write to disk when loaded locally" which further amplifies the severity of the vulnerability.