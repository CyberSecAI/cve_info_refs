```
{
  "vulnerability_details": {
    "root_cause": "The fix for a previous XSS vulnerability (bug 380474) did not account for security wrappers, allowing an attacker to bypass the fix.",
    "weaknesses": [
      "Improper handling of security wrappers when attaching event listeners.",
       "The vulnerability exists in the nsXPCComponents_Utils::LookupMethod and nsEventReceiverSH::AddEventListenerHelper functions",
       "Failure to properly 'innerize' a window object when dealing with security wrappers."
    ],
    "impact": "Cross-site scripting (XSS) attacks against arbitrary sites (prior to Firefox 3.6). In Firefox 3.6 and later, the impact is limited to capturing keystroke events from cross-origin frames or windows.",
    "attack_vectors": [
      "Attacker loads a target site in a frame or window.",
      "Attacker uses Javascript to attach event listeners to the wrapped object bypassing the security mechanism",
      "setTimeout is used to trigger the event after the wrapper has been created."
    ],
    "attacker_capabilities": "The attacker needs to be able to execute JavaScript code within the context of a page that loads a target site in a frame or window.",
    "additional_details": "The vulnerability was addressed by ensuring that window objects are unwrapped earlier in the process using GetJSObjectOfWrapper which also performs security checks. The fix was applied to multiple versions of Firefox, SeaMonkey, and Thunderbird."
  }
}
```