=== Content from www.squid-cache.org_0556f31b_20250125_143906.html ===
---------------------
PatchSet 12597
Date: 2010/01/15 11:40:30
Author: amosjeffries
Branch: HEAD
Tag: (none)
Log:
Handle DNS header-only packets as invalid.
Members:
lib/rfc1035.c:1.30->1.31
Index: squid/lib/rfc1035.c
===================================================================
RCS file: /cvsroot/squid/squid/lib/rfc1035.c,v
retrieving revision 1.30
retrieving revision 1.31
diff -u -r1.30 -r1.31
--- squid/lib/rfc1035.c 15 Jun 2008 03:49:55 -0000 1.30
+++ squid/lib/rfc1035.c 15 Jan 2010 11:40:30 -0000 1.31
@@ -1,6 +1,6 @@
/\*
- \* $Id: rfc1035.c,v 1.30 2008/06/15 03:49:55 hno Exp $
+ \* $Id: rfc1035.c,v 1.31 2010/01/15 11:40:30 amosjeffries Exp $
\*
\* Low level DNS protocol routines
\* AUTHOR: Duane Wessels
@@ -286,7 +286,9 @@
size\_t len;
assert(ns > 0);
do {
- assert((\*off) < sz);
+ if ((\*off) >= sz) {
+ return 1;
+ }
c = \*(buf + (\*off));
if (c > 191) {
/\* blasted compression \*/


=== Content from www.squid-cache.org_8b83053d_20250125_143907.html ===
------------------------------------------------------------
revno: 9163
revision-id: squid3@treenet.co.nz-20100202090412-afvv2p4oy0x1emf0
parent: squid3@treenet.co.nz-20100202085731-fazi5652unowyjsz
committer: Amos Jeffries
branch nick: SQUID\_3\_0
timestamp: Tue 2010-02-02 22:04:12 +1300
message:
Handle DNS header-only packets as invalid.
------------------------------------------------------------
# Bazaar merge directive format 2 (Bazaar 0.90)
# revision\_id: squid3@treenet.co.nz-20100202090412-afvv2p4oy0x1emf0
# target\_branch: http://www.squid-cache.org/bzr/squid3/branches\
# /SQUID\_3\_0/
# testament\_sha1: 82183c6f9f07ad9edbb6676a29371159d093fb93
# timestamp: 2010-02-02 09:46:50 +0000
# source\_branch: http://www.squid-cache.org/bzr/squid3/branches\
# /SQUID\_3\_0
# base\_revision\_id: squid3@treenet.co.nz-20100202085731-\
# fazi5652unowyjsz
#
# Begin patch
=== modified file 'lib/rfc1035.c'
--- lib/rfc1035.c 2010-02-02 08:57:31 +0000
+++ lib/rfc1035.c 2010-02-02 09:04:12 +0000
@@ -287,7 +287,10 @@
size\_t len;
assert(ns > 0);
do {
- assert((\*off) < sz);
+ if ((\*off) >= sz) {
+ RFC1035\_UNPACK\_DEBUG;
+ return 1;
+ }
c = \*(buf + (\*off));
if (c > 191) {
/\* blasted compression \*/


=== Content from www.squid-cache.org_e89af5ed_20250125_143907.html ===
------------------------------------------------------------
revno: 9853
revision-id: squid3@treenet.co.nz-20100116031924-i1qtjbe9smed75b6
parent: squid3@treenet.co.nz-20100116030854-7e6ptnwwhnbydqi3
committer: Amos Jeffries
branch nick: SQUID\_3\_1
timestamp: Sat 2010-01-16 16:19:24 +1300
message:
Handle DNS header-only packets as invalid.
------------------------------------------------------------
# Bazaar merge directive format 2 (Bazaar 0.90)
# revision\_id: squid3@treenet.co.nz-20100116031924-i1qtjbe9smed75b6
# target\_branch: http://www.squid-cache.org/bzr/squid3/trunk/
# testament\_sha1: 04f06b7b5b6ad70e8be88957f01d0901b1d9f018
# timestamp: 2010-01-16 03:51:42 +0000
# source\_branch: http://www.squid-cache.org/bzr/squid3/branches\
# /SQUID\_3\_1
# base\_revision\_id: squid3@treenet.co.nz-20100116030854-\
# 7e6ptnwwhnbydqi3
#
# Begin patch
=== modified file 'lib/rfc1035.c'
--- lib/rfc1035.c 2009-04-10 06:29:22 +0000
+++ lib/rfc1035.c 2010-01-16 03:19:24 +0000
@@ -287,7 +287,10 @@
size\_t len;
assert(ns > 0);
do {
- assert((\*off) < sz);
+ if ((\*off) >= sz) {
+ RFC1035\_UNPACK\_DEBUG;
+ return 1;
+ }
c = \*(buf + (\*off));
if (c > 191) {
/\* blasted compression \*/
=== modified file 'lib/tests/testRFC1035.cc'
--- lib/tests/testRFC1035.cc 2009-06-05 23:28:19 +0000
+++ lib/tests/testRFC1035.cc 2010-01-16 03:19:24 +0000
@@ -110,3 +110,28 @@
CPPUNIT\_ASSERT(msg != NULL);
rfc1035MessageDestroy(&msg);
}
+
+void testRFC1035::testBugPacketHeadersOnly()
+{
+ /\* Setup a buffer with the known-to-fail headers-only packet \*/
+ const char \*buf = "\xab\xcd\x81\x80\x00\x01\x00\x05\x00\x04\x00\x04";
+ size\_t len = 12;
+ rfc1035\_message \*msg = NULL;
+ int res = 0;
+ unsigned int off = 0;
+
+ /\* Test the HeaderUnpack function results \*/
+ msg = new rfc1035\_message;
+ res = rfc1035HeaderUnpack(buf, len, &off, msg);
+ CPPUNIT\_ASSERT(0 == res);
+ /\* cleanup \*/
+ delete msg;
+ msg = NULL;
+
+ /\* Test the MessageUnpack function itself \*/
+ res = rfc1035MessageUnpack(buf, len, &msg);
+
+ CPPUNIT\_ASSERT\_EQUAL((const char \*)"The DNS reply message is corrupt or could not be safely parsed.", rfc1035\_error\_message);
+ CPPUNIT\_ASSERT(res < 0);
+ CPPUNIT\_ASSERT(msg == NULL);
+}
=== modified file 'lib/tests/testRFC1035.h'
--- lib/tests/testRFC1035.h 2007-12-15 06:11:41 +0000
+++ lib/tests/testRFC1035.h 2010-01-16 03:19:24 +0000
@@ -13,6 +13,7 @@
CPPUNIT\_TEST( testHeaderUnpack );
CPPUNIT\_TEST( testParseAPacket );
+ CPPUNIT\_TEST( testBugPacketHeadersOnly );
CPPUNIT\_TEST( testBugPacketEndingOnCompressionPtr );
CPPUNIT\_TEST\_SUITE\_END();
@@ -24,6 +25,7 @@
// bugs.
void testBugPacketEndingOnCompressionPtr();
+ void testBugPacketHeadersOnly();
};
#endif /\* SQUID\_SRC\_TEST\_IPADDRESS\_H \*/


=== Content from www.squid-cache.org_b9c4fdd6_20250125_143906.html ===
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Squid Proxy Cache Security Update Advisory SQUID-2010:1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Advisory ID: SQUID-2010:1
Date: January 28, 2010
Summary: Denial of Service issue in DNS handling
Affected versions: Squid 2.x -> 2.6.STABLE24,
Squid 2.7 -> 2.7.STABLE8,
Squid 3.0 -> 3.0.STABLE22,
Squid 3.1 -> 3.1.0.15
Fixed in version: Squid 2.6.STABLE24, 2.7.STABLE8
Squid 3.0.STABLE23, 3.1.0.16
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
http://www.squid-cache.org/Advisories/SQUID-2010\_1.txt
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0308
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Problem Description:
Due to incorrect data validation Squid is vulnerable to a denial
of service attack when processing specially crafted DNS packets.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Severity:
This problem allows any trusted client or external server who can
determine the squid receiving port to perform a short-term denial
of service attack on the Squid service.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Updated Packages:
This bug is fixed by Squid versions 2.6.STABLE24, 2.7.STABLE8,
3.0.STABLE23 and 3.1.0.16.
In addition, patches addressing these problems can be found In
our patch archives.
Squid 2.x:
http://www.squid-cache.org/Versions/v2/HEAD/changesets/12597.patch
Squid 3.0:
http://www.squid-cache.org/Versions/v3/3.0/changesets/squid-3.0-9163.patch
Squid 3.1:
http://www.squid-cache.org/Versions/v3/3.1/changesets/squid-3.1-9853.patch
If you are using a prepackaged version of Squid then please refer
to the package vendor for availability information on updated
packages.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Determining if your version is vulnerable:
Squid still using the obsolete dnsserver are not vulnerable.
The ignore\_unknown\_nameservers option affects the severity of
this vulnerability. When set to "on" (the default) risk is low.
When set to "off" the vulnerability risk is increased.
All unpatched Squid-3.0 versions up to and including 3.0.STABLE22
are vulnerable.
All unpatched Squid-3.1 versions up to and including 3.1.0.15 are
vulnerable.
All unpatched Squid-2.7 versions up to and including 2.7.STABLE8
are vulnerable.
All unpatched Squid-2.x versions up to and including 2.6.STABLE24
are vulnerable.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Workarounds:
Using all of the following steps are required to protect a
vulnerable Squid from this and other forms of DNS attack.
\* Ensuring the ignore\_unknown\_nameservers is turned on.
\* Ensuring that DNS packets cannot be sent to Squid from
untrusted nameservers or other machines.
The most secure implementation of these requirements is to use
a nameserver running on the localhost IP dedicated for secure use
by Squid and any other services on the Squid machine.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Contact details for the Squid project:
For installation / upgrade support on binary packaged versions
of Squid: Your first point of contact should be your binary
package vendor.
If your install and build Squid from the original Squid sources
then the squid-users@squid-cache.org mailing list is your primary
support point. For subscription details see
.
For reporting of non-security bugs in the latest STABLE release
the squid bugzilla database should be used
.
For reporting of security sensitive bugs send an email to the
squid-bugs@squid-cache.org mailing list. It's a closed list
(though anyone can post) and security related bug reports are
treated in confidence until the impact has been established.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Credits:
Zero-Day attributed to work by Fabian Yamaguchi.
The vulnerability was reported by Tomas Hoger of RedHat.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Revision history:
2010-01-14 18:05 GMT Initial Report
2010-01-16 03:51 GMT Patches released.
2010-02-01 04:49 GMT Squid-3 bundled fixes and advisory released.
2010-02-02 07:42 GMT Updated 3.0 patch and bundle
2010-02-06 02:35 GMT CVE-2010-0308 reference added.
2010-09-16 07:05 GMT Reference link updates
2011-04-12 02:05 GMT Updated info on 2.6 and 2.7 being patched
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
END


=== Content from www.vupen.com_0c5a4ce6_20250125_143907.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


