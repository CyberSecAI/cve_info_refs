The provided content relates to CVE-2010-10004.

**Root cause of vulnerability:**
The InfoCard module in simplesamlphp was vulnerable to cross-site scripting (XSS) attacks due to improper sanitization of user-controlled input. Specifically, the `AuthState` parameter, as well as the `username` and `password` parameters within the form, were not properly escaped when rendered in HTML templates.

**Weaknesses/vulnerabilities present:**
- Cross-site scripting (XSS) vulnerability
- Improper sanitization of user-controlled input

**Impact of exploitation:**
- An attacker could inject malicious JavaScript code into the web pages rendered by the InfoCard module.
- This could potentially lead to session hijacking, cookie theft, defacement of the website, or other malicious actions within the context of the user's browser.

**Attack vectors:**
- By crafting a malicious URL with a manipulated `AuthState` parameter.
- By crafting a malicious username or password value.

**Required attacker capabilities/position:**
- The attacker would need to be able to manipulate the `AuthState` parameter, as well as the `username` and `password` parameters used within the application when creating a new card.
- The attacker would need to be able to induce a user to visit a malicious link or interact with a compromised form.