=== Content from plugins.trac.wordpress.org_cddf306b_20250124_194317.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew_path%3D%252Fbad-behavior%26old%3D543807%26new%3D543807%26old_path%3D%252Fbad-behavior)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/539647/bad-behavior "Changeset 539647 for bad-behavior")
* [Next Change](/changeset/544943/bad-behavior "Changeset 544943 for bad-behavior") →

---

# Changeset [543807](/changeset/543807 "Show full changeset") for [bad-behavior](/browser/bad-behavior?rev=543807 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/13/2012 04:36:13 PM
([13 years](/timeline?from=2012-05-13T16%3A36%3A13Z&precision=second "See timeline at 05/13/2012 04:36:13 PM") ago)

Author:
error
Message:

Bad Behavior 2.2.5 and 2.0.47: Fix several XSS vulnerabilities; add

input validation for several option fields

Location:
[bad-behavior](/browser/bad-behavior?rev=543807)
Files:

1 deleted
12 edited
50 copied

* [branches/2.0/README.txt](/browser/bad-behavior/branches/2.0/README.txt?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [branches/2.0/bad-behavior-wordpress-admin.php](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=543807 "Show entry in browser")
  (modified)
  ([6 diffs](#file1 "Show differences"))
* [branches/2.0/bad-behavior-wordpress.php](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress.php?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [branches/2.0/bad-behavior/version.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/version.inc.php?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [branches/2.2/README.txt](/browser/bad-behavior/branches/2.2/README.txt?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [branches/2.2/bad-behavior-wordpress-admin.php](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807 "Show entry in browser")
  (modified)
  ([10 diffs](#file5 "Show differences"))
* [branches/2.2/bad-behavior-wordpress.php](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress.php?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [branches/2.2/bad-behavior/core.inc.php](/browser/bad-behavior/branches/2.2/bad-behavior/core.inc.php?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [tags/2.0.47](/browser/bad-behavior/tags/2.0.47?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0](/browser/bad-behavior/branches/2.0?rev=337108 "Show original file (revision 337135)"))*
* [tags/2.0.47/README.txt](/browser/bad-behavior/tags/2.0.47/README.txt?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/README.txt](/browser/bad-behavior/branches/2.0/README.txt?rev=539645 "Show original file (revision 539645)"))*
  ([1 diff](#file9 "Show differences"))
* [tags/2.0.47/bad-behavior-generic.php](/browser/bad-behavior/tags/2.0.47/bad-behavior-generic.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior-generic.php](/browser/bad-behavior/branches/2.0/bad-behavior-generic.php?rev=539645 "Show original file (revision 539645)"))*
* [tags/2.0.47/bad-behavior-lifetype.php](/browser/bad-behavior/tags/2.0.47/bad-behavior-lifetype.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior-lifetype.php](/browser/bad-behavior/branches/2.0/bad-behavior-lifetype.php?rev=337108 "Show original file (revision 337108)"))*
* [tags/2.0.47/bad-behavior-mediawiki.php](/browser/bad-behavior/tags/2.0.47/bad-behavior-mediawiki.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior-mediawiki.php](/browser/bad-behavior/branches/2.0/bad-behavior-mediawiki.php?rev=539645 "Show original file (revision 539645)"))*
* [tags/2.0.47/bad-behavior-wordpress-admin.php](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647 "Show original file (revision 539647)"))*
  ([6 diffs](#file13 "Show differences"))
* [tags/2.0.47/bad-behavior-wordpress.php](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior-wordpress.php](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress.php?rev=539645 "Show original file (revision 539645)"))*
  ([1 diff](#file14 "Show differences"))
* [tags/2.0.47/bad-behavior/banned.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/banned.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/banned.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/banned.inc.php?rev=261833 "Show original file (revision 261833)"))*
* [tags/2.0.47/bad-behavior/blackhole.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/blackhole.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/blackhole.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/blackhole.inc.php?rev=337973 "Show original file (revision 337973)"))*
* [tags/2.0.47/bad-behavior/blacklist.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/blacklist.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/blacklist.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/blacklist.inc.php?rev=328472 "Show original file (revision 328472)"))*
* [tags/2.0.47/bad-behavior/common\_tests.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/common_tests.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/common\_tests.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/common_tests.inc.php?rev=383266 "Show original file (revision 383266)"))*
* [tags/2.0.47/bad-behavior/core.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/core.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/core.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/core.inc.php?rev=423138 "Show original file (revision 423138)"))*
* [tags/2.0.47/bad-behavior/functions.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/functions.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/functions.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/functions.inc.php?rev=328927 "Show original file (revision 328927)"))*
* [tags/2.0.47/bad-behavior/google.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/google.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/google.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/google.inc.php?rev=449343 "Show original file (revision 449343)"))*
* [tags/2.0.47/bad-behavior/housekeeping.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/housekeeping.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/housekeeping.inc.php](/browser/bad-behavior/trunk/bad-behavior/housekeeping.inc.php?rev=26217 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/index.html](/browser/bad-behavior/tags/2.0.47/bad-behavior/index.html?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/index.html](/browser/bad-behavior/trunk/bad-behavior/index.html?rev=161009 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/konqueror.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/konqueror.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/konqueror.inc.php](/browser/bad-behavior/trunk/bad-behavior/konqueror.inc.php?rev=26217 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/lynx.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/lynx.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/lynx.inc.php](/browser/bad-behavior/trunk/bad-behavior/lynx.inc.php?rev=26217 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/movabletype.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/movabletype.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/movabletype.inc.php](/browser/bad-behavior/trunk/bad-behavior/movabletype.inc.php?rev=26217 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/mozilla.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/mozilla.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/mozilla.inc.php](/browser/bad-behavior/trunk/bad-behavior/mozilla.inc.php?rev=39048 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/msie.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/msie.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/msie.inc.php](/browser/bad-behavior/trunk/bad-behavior/msie.inc.php?rev=90936 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/msnbot.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/msnbot.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/msnbot.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/msnbot.inc.php?rev=328473 "Show original file (revision 328473)"))*
* [tags/2.0.47/bad-behavior/opera.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/opera.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/opera.inc.php](/browser/bad-behavior/trunk/bad-behavior/opera.inc.php?rev=26217 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/post.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/post.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/post.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/post.inc.php?rev=336857 "Show original file (revision 336857)"))*
* [tags/2.0.47/bad-behavior/responses.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/responses.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/responses.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/responses.inc.php?rev=369318 "Show original file (revision 369318)"))*
* [tags/2.0.47/bad-behavior/safari.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/safari.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/safari.inc.php](/browser/bad-behavior/trunk/bad-behavior/safari.inc.php?rev=26217 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/screener.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/screener.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/screener.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/screener.inc.php?rev=539645 "Show original file (revision 539645)"))*
* [tags/2.0.47/bad-behavior/trackback.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/trackback.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/trackback.inc.php](/browser/bad-behavior/tags/2.0.32/bad-behavior/trackback.inc.php?rev=169479 "Show original file (revision 169484)"))*
* [tags/2.0.47/bad-behavior/version.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/version.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/version.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/version.inc.php?rev=539645 "Show original file (revision 539645)"))*
  ([1 diff](#file36 "Show differences"))
* [tags/2.0.47/bad-behavior/whitelist.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/whitelist.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/whitelist.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/whitelist.inc.php?rev=425500 "Show original file (revision 425500)"))*
* [tags/2.0.47/bad-behavior/yahoo.inc.php](/browser/bad-behavior/tags/2.0.47/bad-behavior/yahoo.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/bad-behavior/yahoo.inc.php](/browser/bad-behavior/branches/2.0/bad-behavior/yahoo.inc.php?rev=449348 "Show original file (revision 449348)"))*
* [tags/2.0.47/gpl-2.0.txt](/browser/bad-behavior/tags/2.0.47/gpl-2.0.txt?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/gpl-2.0.txt](/browser/bad-behavior/branches/2.0/gpl-2.0.txt?rev=337975 "Show original file (revision 337975)"))*
* [tags/2.0.47/gpl-3.0.txt](/browser/bad-behavior/branches/2.0/gpl-3.0.txt?rev=328871 "Show what was removed (content at revision 337135)")
  (deleted)
* [tags/2.0.47/index.html](/browser/bad-behavior/tags/2.0.47/index.html?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/index.html](/browser/bad-behavior/trunk/index.html?rev=161009 "Show original file (revision 169484)"))*
* [tags/2.0.47/screenshot-1.png](/browser/bad-behavior/tags/2.0.47/screenshot-1.png?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/screenshot-1.png](/browser/bad-behavior/branches/2.0/screenshot-1.png?rev=332619 "Show original file (revision 332619)"))*
* [tags/2.0.47/screenshot-2.png](/browser/bad-behavior/tags/2.0.47/screenshot-2.png?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.0/screenshot-2.png](/browser/bad-behavior/branches/2.0/screenshot-2.png?rev=337975 "Show original file (revision 337975)"))*
* [tags/2.2.5](/browser/bad-behavior/tags/2.2.5?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2](/browser/bad-behavior/branches/2.2?rev=423146 "Show original file (revision 423146)"))*
* [tags/2.2.5/README.txt](/browser/bad-behavior/tags/2.2.5/README.txt?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/README.txt](/browser/bad-behavior/branches/2.2/README.txt?rev=539629 "Show original file (revision 539629)"))*
  ([1 diff](#file45 "Show differences"))
* [tags/2.2.5/bad-behavior-generic.php](/browser/bad-behavior/tags/2.2.5/bad-behavior-generic.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior-generic.php](/browser/bad-behavior/branches/2.2/bad-behavior-generic.php?rev=539629 "Show original file (revision 539629)"))*
* [tags/2.2.5/bad-behavior-mediawiki.php](/browser/bad-behavior/tags/2.2.5/bad-behavior-mediawiki.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior-mediawiki.php](/browser/bad-behavior/branches/2.2/bad-behavior-mediawiki.php?rev=539629 "Show original file (revision 539629)"))*
* [tags/2.2.5/bad-behavior-mysql.php](/browser/bad-behavior/tags/2.2.5/bad-behavior-mysql.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior-mysql.php](/browser/bad-behavior/branches/2.2/bad-behavior-mysql.php?rev=498455 "Show original file (revision 498455)"))*
* [tags/2.2.5/bad-behavior-wordpress-admin.php](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647 "Show original file (revision 539647)"))*
  ([10 diffs](#file49 "Show differences"))
* [tags/2.2.5/bad-behavior-wordpress.php](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior-wordpress.php](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress.php?rev=539629 "Show original file (revision 539629)"))*
  ([1 diff](#file50 "Show differences"))
* [tags/2.2.5/bad-behavior/core.inc.php](/browser/bad-behavior/tags/2.2.5/bad-behavior/core.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior/core.inc.php](/browser/bad-behavior/branches/2.2/bad-behavior/core.inc.php?rev=539629 "Show original file (revision 539629)"))*
  ([1 diff](#file51 "Show differences"))
* [tags/2.2.5/bad-behavior/functions.inc.php](/browser/bad-behavior/tags/2.2.5/bad-behavior/functions.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior/functions.inc.php](/browser/bad-behavior/branches/2.2/bad-behavior/functions.inc.php?rev=508631 "Show original file (revision 508631)"))*
* [tags/2.2.5/bad-behavior/post.inc.php](/browser/bad-behavior/tags/2.2.5/bad-behavior/post.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior/post.inc.php](/browser/bad-behavior/branches/2.2/bad-behavior/post.inc.php?rev=514039 "Show original file (revision 514039)"))*
* [tags/2.2.5/bad-behavior/screener.inc.php](/browser/bad-behavior/tags/2.2.5/bad-behavior/screener.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior/screener.inc.php](/browser/bad-behavior/branches/2.2/bad-behavior/screener.inc.php?rev=539629 "Show original file (revision 539629)"))*
* [tags/2.2.5/bad-behavior/searchengine.inc.php](/browser/bad-behavior/tags/2.2.5/bad-behavior/searchengine.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior/searchengine.inc.php](/browser/bad-behavior/branches/2.2/bad-behavior/searchengine.inc.php?rev=495040 "Show original file (revision 495040)"))*
* [tags/2.2.5/bad-behavior/whitelist.inc.php](/browser/bad-behavior/tags/2.2.5/bad-behavior/whitelist.inc.php?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/bad-behavior/whitelist.inc.php](/browser/bad-behavior/branches/2.2/bad-behavior/whitelist.inc.php?rev=526369 "Show original file (revision 526369)"))*
* [tags/2.2.5/settings-sample.ini](/browser/bad-behavior/tags/2.2.5/settings-sample.ini?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/settings-sample.ini](/browser/bad-behavior/branches/2.2/settings-sample.ini?rev=539629 "Show original file (revision 539629)"))*
* [tags/2.2.5/whitelist-sample.ini](/browser/bad-behavior/tags/2.2.5/whitelist-sample.ini?rev=543807 "Show entry in browser")
  (copied)
  *(copied from [bad-behavior/branches/2.2/whitelist-sample.ini](/browser/bad-behavior/branches/2.2/whitelist-sample.ini?rev=495040 "Show original file (revision 495040)"))*
* [trunk/README.txt](/browser/bad-behavior/trunk/README.txt?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file59 "Show differences"))
* [trunk/bad-behavior-wordpress-admin.php](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807 "Show entry in browser")
  (modified)
  ([10 diffs](#file60 "Show differences"))
* [trunk/bad-behavior-wordpress.php](/browser/bad-behavior/trunk/bad-behavior-wordpress.php?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file61 "Show differences"))
* [trunk/bad-behavior/core.inc.php](/browser/bad-behavior/trunk/bad-behavior/core.inc.php?rev=543807 "Show entry in browser")
  (modified)
  ([1 diff](#file62 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [bad-behavior/branches/2.0/README.txt](/changeset/543807/bad-behavior/branches/2.0/README.txt "Show the changeset 543807 restricted to bad-behavior/branches/2.0/README.txt")

  | [r539645](/browser/bad-behavior/branches/2.0/README.txt?rev=539645#L3 "Show revision 539645 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.0/README.txt?rev=543807#L3 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Contributors: error, markjaquith, skeltoac |
  | 4 | 4 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20%28From%20WordPress%20Page%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8 |
  | 5 |  | Requires at least: ~~2.7~~ |
  |  | 5 | Requires at least: 3.1 |
  | 6 | 6 | Tested up to: 3.3.2 |
  | 7 |  | Stable tag: 2.2.~~4~~ |
  |  | 7 | Stable tag: 2.2.5 |
  | 8 | 8 |  |
  | 9 | 9 | Bad Behavior prevents spammers from ever delivering their junk, and in many |
* ## [bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php](/changeset/543807/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php "Show the changeset 543807 restricted to bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php")

  | [r539647](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L127 "Show revision 539647 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=543807#L127 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 127 | 127 | <div class="wrap"> |
  | 128 | 128 | <h2><?php \_e("Bad Behavior"); ?></h2> |
  | 129 |  | <form method="post" action="<?php echo ~~$request\_uri~~; ?>"> |
  |  | 129 | <form method="post" action="<?php echo admin\_url("tools.php?page=bb2\_manage"); ?>"> |
  | 130 | 130 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 131 | 131 | <p>If you find Bad Behavior valuable, please consider <a href="https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20<?php echo BB2\_VERSION; ?>%20%28From%20Admin%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8">donating</a> to help further development of Bad Behavior.</p> |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L139) | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=543807#L139) |  |
  | 139 | 139 | <?php if ($count < $totalcount): ?> |
  | 140 | 140 | Displaying <strong><?php echo $count; ?></strong> of <strong><?php echo $totalcount; ?></strong> records filtered by:<br/> |
  | 141 |  | <?php if ($\_GET['key']) echo "Status [<a href=\"" . ~~remove\_query\_arg(array("paged", "key"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 142 |  | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 143 |  | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . ~~remove\_query\_arg(array("paged", "ip"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 144 |  | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . ~~remove\_query\_arg(array("paged", "user\_agent"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 145 |  | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . ~~remove\_query\_arg(array("paged", "request\_method"), $request\_uri~~) . "\">X</a>] "; ?> |
  |  | 141 | <?php if ($\_GET['key']) echo "Status [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "key"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 142 | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "blocked"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 143 | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "ip"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 144 | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "user\_agent"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 145 | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "request\_method"), $request\_uri)) . "\">X</a>] "; ?> |
  | 146 | 146 | <?php else: ?> |
  | 147 | 147 | Displaying all <strong><?php echo $totalcount; ?></strong> records<br/> |
  | 148 | 148 | <?php endif; ?> |
  | 149 |  | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo ~~add\_query\_arg(array("blocked" => "true", "paged" => false), $request\_uri~~); ?>">Show Blocked</a><?php } ?> |
  |  | 149 | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo esc\_url(add\_query\_arg(array("blocked" => "true", "paged" => false), $request\_uri)); ?>">Show Blocked</a><?php } ?> |
  | 150 | 150 | </div> |
  | 151 | 151 | </div> |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L179) | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=543807#L179) |  |
  | 179 | 179 | $host .= "<br/>\n"; |
  | 180 | 180 | } |
  | 181 |  | echo "<td><a href=\"" . ~~add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked"), $request\_uri~~)) . "\">" . $key["log"] . "</a>\n"; |
  |  | 181 | echo "<td><a href=\"" . esc\_url(add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri))) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . esc\_url(add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked"), $request\_uri))) . "\">" . $key["log"] . "</a>\n"; |
  | 182 | 182 | if ($httpbl) echo "<br/><br/>http:BL:<br/>$httpbl\n"; |
  | 183 | 183 | echo "</td>\n"; |
  | 184 | 184 | $headers = str\_replace("\n", "<br/>\n", htmlspecialchars($result['http\_headers'])); |
  | 185 |  | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri~~)) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  | 186 |  | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri~~)) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  |  | 185 | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url(add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri))) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  |  | 186 | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url(add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri))) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  | 187 | 187 | echo "<td>$headers</td>\n"; |
  | 188 | 188 | echo "<td>" . str\_replace("\n", "<br/>\n", htmlspecialchars($result["request\_entity"])) . "</td>\n"; |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L244) | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=543807#L244) |  |
  | 244 | 244 | } |
  | 245 | 245 | if ($\_POST['httpbl\_key']) { |
  | 246 |  | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 246 | if (preg\_match("/^[:alpha:]{12}$/", $\_POST['httpbl\_key'])) { |
  |  | 247 | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 248 | } else { |
  |  | 249 | $settings['httpbl\_key'] = ''; |
  |  | 250 | } |
  | 247 | 251 | } else { |
  | 248 | 252 | $settings['httpbl\_key'] = ''; |
  | 249 | 253 | } |
  | 250 | 254 | if ($\_POST['httpbl\_threat']) { |
  | 251 |  | $settings['httpbl\_threat'] = ~~$\_POST['httpbl\_threat']~~; |
  |  | 255 | $settings['httpbl\_threat'] = intval($\_POST['httpbl\_threat']); |
  | 252 | 256 | } else { |
  | 253 | 257 | $settings['httpbl\_threat'] = '25'; |
  | 254 | 258 | } |
  | 255 | 259 | if ($\_POST['httpbl\_maxage']) { |
  | 256 |  | $settings['httpbl\_maxage'] = ~~$\_POST['httpbl\_maxage']~~; |
  |  | 260 | $settings['httpbl\_maxage'] = intval($\_POST['httpbl\_maxage']); |
  | 257 | 261 | } else { |
  | 258 | 262 | $settings['httpbl\_maxage'] = '30'; |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L276) | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=543807#L280) |  |
  | 276 | 280 | <div class="wrap"> |
  | 277 | 281 | <h2><?php \_e("Bad Behavior"); ?></h2> |
  | 278 |  | <form method="post" action="<?php echo ~~$request\_uri~~; ?>"> |
  |  | 282 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_options"); ?>"> |
  | 279 | 283 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 280 | 284 | <p>If you find Bad Behavior valuable, please consider making a <a href="https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20<?php echo BB2\_VERSION; ?>%20%28From%20Admin%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8">financial contribution</a> to further development of Bad Behavior.</p> |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L302) | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=543807#L306) |  |
  | 302 | 306 | <p>To use Bad Behavior's http:BL features you must have an <a href="http://www.projecthoneypot.org/httpbl\_configure.php?rf=24694">http:BL Access Key</a>.</p> |
  | 303 | 307 | <table class="form-table"> |
  | 304 |  | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo ~~$settings['httpbl\_key']~~; ?>" /> http:BL Access Key</label></td></tr> |
  | 305 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo ~~$settings['httpbl\_threat']~~; ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  | 306 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo ~~$settings['httpbl\_maxage']~~; ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  |  | 308 | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo sanitize\_text\_field($settings['httpbl\_key']); ?>" /> http:BL Access Key</label></td></tr> |
  |  | 309 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo intval($settings['httpbl\_threat']); ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  |  | 310 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo intval($settings['httpbl\_maxage']); ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  | 307 | 311 | </table> |
  | 308 | 312 |  |
* ## [bad-behavior/branches/2.0/bad-behavior-wordpress.php](/changeset/543807/bad-behavior/branches/2.0/bad-behavior-wordpress.php "Show the changeset 543807 restricted to bad-behavior/branches/2.0/bad-behavior-wordpress.php")

  | [r539645](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress.php?rev=539645#L2 "Show revision 539645 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress.php?rev=543807#L2 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: Bad Behavior |
  | 4 |  | Version: 2.0.4~~6~~ |
  |  | 4 | Version: 2.0.47 |
  | 5 | 5 | Description: Deny automated spambots access to your PHP-based Web site. |
  | 6 | 6 | Plugin URI: http://www.bad-behavior.ioerror.us/ |
* ## [bad-behavior/branches/2.0/bad-behavior/version.inc.php](/changeset/543807/bad-behavior/branches/2.0/bad-behavior/version.inc.php "Show the changeset 543807 restricted to bad-behavior/branches/2.0/bad-behavior/version.inc.php")

  | [r539645](/browser/bad-behavior/branches/2.0/bad-behavior/version.inc.php?rev=539645#L1 "Show revision 539645 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.0/bad-behavior/version.inc.php?rev=543807#L1 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php if (!defined('BB2\_CWD')) die("I said no cheating!"); |
  | 2 |  | define('BB2\_VERSION', "2.0.4~~6~~"); |
  |  | 2 | define('BB2\_VERSION', "2.0.47"); |
  | 3 | 3 | ?> |
* ## [bad-behavior/branches/2.2/README.txt](/changeset/543807/bad-behavior/branches/2.2/README.txt "Show the changeset 543807 restricted to bad-behavior/branches/2.2/README.txt")

  | [r539629](/browser/bad-behavior/branches/2.2/README.txt?rev=539629#L3 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.2/README.txt?rev=543807#L3 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Contributors: error, markjaquith, skeltoac |
  | 4 | 4 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20%28From%20WordPress%20Page%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8 |
  | 5 |  | Requires at least: ~~2.7~~ |
  |  | 5 | Requires at least: 3.1 |
  | 6 | 6 | Tested up to: 3.3.2 |
  | 7 |  | Stable tag: 2.2.~~4~~ |
  |  | 7 | Stable tag: 2.2.5 |
  | 8 | 8 |  |
  | 9 | 9 | Bad Behavior prevents spammers from ever delivering their junk, and in many |
* ## [bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php](/changeset/543807/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php "Show the changeset 543807 restricted to bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php")

  | [r539647](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L150 "Show revision 539647 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L150 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 150 | 150 | ?> |
  | 151 | 151 | <h2><?php \_e("Bad Behavior Log"); ?></h2> |
  | 152 |  | <form method="post" action="<?php echo ~~$request\_uri;~~ ?>"> |
  |  | 152 | <form method="post" action="<?php echo admin\_url("tools.php?page=bb2\_manage") ?>"> |
  | 153 | 153 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 154 | 154 | <p>See also: <a href="<?php echo admin\_url("options-general.php?page=bb2\_options") ?>">Settings</a> | <a href="<?php echo admin\_url("options-general.php?page=bb2\_whitelist") ?>">Whitelist</a></p> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L161) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L161) |  |
  | 161 | 161 | <?php if ($count < $totalcount): ?> |
  | 162 | 162 | Displaying <strong><?php echo $count; ?></strong> of <strong><?php echo $totalcount; ?></strong> records filtered by:<br/> |
  | 163 |  | <?php if ($\_GET['key']) echo "Status [<a href=\"" . ~~remove\_query\_arg(array("paged", "key"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 164 |  | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 165 |  | <?php if ($\_GET['permitted']) echo "Permitted [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 166 |  | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . ~~remove\_query\_arg(array("paged", "ip"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 167 |  | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . ~~remove\_query\_arg(array("paged", "user\_agent"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 168 |  | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . ~~remove\_query\_arg(array("paged", "request\_method"), $request\_uri~~) . "\">X</a>] "; ?> |
  |  | 163 | <?php if ($\_GET['key']) echo "Status [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "key"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 164 | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 165 | <?php if ($\_GET['permitted']) echo "Permitted [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 166 | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "ip"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 167 | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "user\_agent"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 168 | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "request\_method"), $request\_uri) ) . "\">X</a>] "; ?> |
  | 169 | 169 | <?php else: ?> |
  | 170 | 170 | Displaying all <strong><?php echo $totalcount; ?></strong> records<br/> |
  | 171 | 171 | <?php endif; ?> |
  | 172 |  | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo ~~add\_query\_arg(array("blocked" => "1", "permitted" => "0", "paged" => false), $request\_uri~~); ?>">Show Blocked</a> <?php } ?> |
  | 173 |  | <?php if (!$\_GET['key'] && !$\_GET['permitted']) { ?><a href="<?php echo ~~add\_query\_arg(array("permitted" => "1", "blocked" => "0", "paged" => false), $request\_uri~~); ?>">Show Permitted</a> <?php } ?> |
  |  | 172 | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo esc\_url( add\_query\_arg(array("blocked" => "1", "permitted" => "0", "paged" => false), $request\_uri) ); ?>">Show Blocked</a> <?php } ?> |
  |  | 173 | <?php if (!$\_GET['key'] && !$\_GET['permitted']) { ?><a href="<?php echo esc\_url( add\_query\_arg(array("permitted" => "1", "blocked" => "0", "paged" => false), $request\_uri) ); ?>">Show Permitted</a> <?php } ?> |
  | 174 | 174 | </div> |
  | 175 | 175 | </div> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L203) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L203) |  |
  | 203 | 203 | $host .= "<br/>\n"; |
  | 204 | 204 | } |
  | 205 |  | echo "<td><a href=\"" . ~~add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri)~~) . "\">" . $key["log"] . "</a>\n"; |
  |  | 205 | echo "<td><a href=\"" . esc\_url( add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . esc\_url( add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri)) ) . "\">" . $key["log"] . "</a>\n"; |
  | 206 | 206 | if ($httpbl) echo "<br/><br/><a href=\"http://www.projecthoneypot.org/ip\_{$result['ip']}\">http:BL</a>:<br/>$httpbl\n"; |
  | 207 | 207 | echo "</td>\n"; |
  | 208 | 208 | $headers = str\_replace("\n", "<br/>\n", htmlspecialchars($result['http\_headers'])); |
  | 209 |  | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri)~~) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  | 210 |  | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri)~~) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  |  | 209 | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url( add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  |  | 210 | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url( add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  | 211 | 211 | echo "<td>$headers</td>\n"; |
  | 212 | 212 | echo "<td>" . str\_replace("\n", "<br/>\n", htmlspecialchars($result["request\_entity"])) . "</td>\n"; |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L271) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L271) |  |
  | 271 | 271 | ?> |
  | 272 | 272 | <h2><?php \_e("Bad Behavior Whitelist"); ?></h2> |
  | 273 |  | <form method="post" action="<?php echo ~~$request\_uri~~; ?>"> |
  |  | 273 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_whitelist"); ?>"> |
  | 274 | 274 | <p>Inappropriate whitelisting WILL expose you to spam, or cause Bad Behavior to stop functioning entirely! DO NOT WHITELIST unless you are 100% CERTAIN that you should.</p> |
  | 275 | 275 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L337) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L337) |  |
  | 337 | 337 | } |
  | 338 | 338 | if ($\_POST['httpbl\_key']) { |
  | 339 |  | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 339 | if (preg\_match("/^[:alpha:]{12}$/", $\_POST['httpbl\_key'])) { |
  |  | 340 | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 341 | } else { |
  |  | 342 | $settings['httpbl\_key'] = ''; |
  |  | 343 | } |
  | 340 | 344 | } else { |
  | 341 | 345 | $settings['httpbl\_key'] = ''; |
  | 342 | 346 | } |
  | 343 | 347 | if ($\_POST['httpbl\_threat']) { |
  | 344 |  | $settings['httpbl\_threat'] = ~~$\_POST['httpbl\_threat']~~; |
  |  | 348 | $settings['httpbl\_threat'] = intval($\_POST['httpbl\_threat']); |
  | 345 | 349 | } else { |
  | 346 | 350 | $settings['httpbl\_threat'] = '25'; |
  | 347 | 351 | } |
  | 348 | 352 | if ($\_POST['httpbl\_maxage']) { |
  | 349 |  | $settings['httpbl\_maxage'] = ~~$\_POST['httpbl\_maxage']~~; |
  |  | 353 | $settings['httpbl\_maxage'] = intval($\_POST['httpbl\_maxage']); |
  | 350 | 354 | } else { |
  | 351 | 355 | $settings['httpbl\_maxage'] = '30'; |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L367) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L371) |  |
  | 367 | 371 | } |
  | 368 | 372 | if ($\_POST['reverse\_proxy\_header']) { |
  | 369 |  | $settings['reverse\_proxy\_header'] = ~~uc\_all($\_POST['reverse\_proxy\_header']~~); |
  |  | 373 | $settings['reverse\_proxy\_header'] = sanitize\_text\_field(uc\_all($\_POST['reverse\_proxy\_header'])); |
  | 370 | 374 | } else { |
  | 371 | 375 | $settings['reverse\_proxy\_header'] = 'X-Forwarded-For'; |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L373) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L377) |  |
  | 373 | 377 | if ($\_POST['reverse\_proxy\_addresses']) { |
  | 374 | 378 | $settings['reverse\_proxy\_addresses'] = preg\_split("/[\s,]+/m", $\_POST['reverse\_proxy\_addresses']); |
  |  | 379 | $settings['reverse\_proxy\_addresses'] = array\_map('sanitize\_text\_field', $settings['reverse\_proxy\_addresses']); |
  | 375 | 380 | } else { |
  | 376 | 381 | $settings['reverse\_proxy\_addresses'] = array(); |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L387) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L392) |  |
  | 387 | 392 | ?> |
  | 388 | 393 | <h2><?php \_e("Bad Behavior"); ?></h2> |
  | 389 |  | <form method="post" action="<?php echo ~~$\_SERVER['REQUEST\_URI']~~; ?>"> |
  |  | 394 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_options"); ?>"> |
  | 390 | 395 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 391 | 396 | <p>See also: <a href="<?php echo admin\_url("tools.php?page=bb2\_manage"); ?>">Log</a> | <a href="<?php echo admin\_url("options-general.php?page=bb2\_whitelist") ?>">Whitelist</a></p> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L413) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L418) |  |
  | 413 | 418 | <p>To use Bad Behavior's http:BL features you must have an <a href="http://www.projecthoneypot.org/httpbl\_configure.php?rf=24694">http:BL Access Key</a>.</p> |
  | 414 | 419 | <table class="form-table"> |
  | 415 |  | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo ~~$settings['httpbl\_key']~~; ?>" /> http:BL Access Key</label></td></tr> |
  | 416 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo ~~$settings['httpbl\_threat']~~; ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  | 417 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo ~~$settings['httpbl\_maxage']~~; ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  |  | 420 | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo sanitize\_text\_field($settings['httpbl\_key']); ?>" /> http:BL Access Key</label></td></tr> |
  |  | 421 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo intval($settings['httpbl\_threat']); ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  |  | 422 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo intval($settings['httpbl\_maxage']); ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  | 418 | 423 | </table> |
  | 419 | 424 |  |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L430) | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=543807#L435) |  |
  | 430 | 435 | <table class="form-table"> |
  | 431 | 436 | <tr><td><label><input type="checkbox" name="reverse\_proxy" value="true" <?php if ($settings['reverse\_proxy']) { ?>checked="checked" <?php } ?>/> <?php \_e('Enable Reverse Proxy'); ?></label></td></tr> |
  | 432 |  | <tr><td><label><input type="text" size="32" name="reverse\_proxy\_header" value="<?php echo ~~$settings['reverse\_proxy\_header']~~; ?>" /> Header containing Internet clients' IP address</label></td></tr> |
  | 433 |  | <tr><td><label>IP address or CIDR format address ranges for your proxy servers (one per line)<br/><textarea cols="24" rows="6" name="reverse\_proxy\_addresses"><?php echo ~~implode("\n", $settings['reverse\_proxy\_addresses']~~); ?></textarea></td></tr> |
  |  | 437 | <tr><td><label><input type="text" size="32" name="reverse\_proxy\_header" value="<?php echo sanitize\_text\_field($settings['reverse\_proxy\_header']); ?>" /> Header containing Internet clients' IP address</label></td></tr> |
  |  | 438 | <tr><td><label>IP address or CIDR format address ranges for your proxy servers (one per line)<br/><textarea cols="24" rows="6" name="reverse\_proxy\_addresses"><?php echo esc\_textarea(implode("\n", $settings['reverse\_proxy\_addresses'])); ?></textarea></td></tr> |
  | 434 | 439 | </table> |
  | 435 | 440 |  |
* ## [bad-behavior/branches/2.2/bad-behavior-wordpress.php](/changeset/543807/bad-behavior/branches/2.2/bad-behavior-wordpress.php "Show the changeset 543807 restricted to bad-behavior/branches/2.2/bad-behavior-wordpress.php")

  | [r539629](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress.php?rev=539629#L2 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress.php?rev=543807#L2 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: Bad Behavior |
  | 4 |  | Version: 2.2.~~4~~ |
  |  | 4 | Version: 2.2.5 |
  | 5 | 5 | Description: Deny automated spambots access to your PHP-based Web site. |
  | 6 | 6 | Plugin URI: http://bad-behavior.ioerror.us/ |
* ## [bad-behavior/branches/2.2/bad-behavior/core.inc.php](/changeset/543807/bad-behavior/branches/2.2/bad-behavior/core.inc.php "Show the changeset 543807 restricted to bad-behavior/branches/2.2/bad-behavior/core.inc.php")

  | [r539629](/browser/bad-behavior/branches/2.2/bad-behavior/core.inc.php?rev=539629#L1 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/branches/2.2/bad-behavior/core.inc.php?rev=543807#L1 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php if (!defined('BB2\_CWD')) die("I said no cheating!"); |
  | 2 |  | define('BB2\_VERSION', "2.2.~~4~~"); |
  |  | 2 | define('BB2\_VERSION', "2.2.5"); |
  | 3 | 3 |  |
  | 4 | 4 | // Bad Behavior entry point is bb2\_start() |
* ## [bad-behavior/tags/2.0.47/README.txt](/changeset/543807/bad-behavior/tags/2.0.47/README.txt "Show the changeset 543807 restricted to bad-behavior/tags/2.0.47/README.txt")

  | [r539645](/browser/bad-behavior/branches/2.0/README.txt?rev=539645#L3 "Show revision 539645 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.0.47/README.txt?rev=543807#L3 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Contributors: error, markjaquith, skeltoac |
  | 4 | 4 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20%28From%20WordPress%20Page%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8 |
  | 5 |  | Requires at least: ~~2.7~~ |
  |  | 5 | Requires at least: 3.1 |
  | 6 | 6 | Tested up to: 3.3.2 |
  | 7 |  | Stable tag: 2.2.~~4~~ |
  |  | 7 | Stable tag: 2.2.5 |
  | 8 | 8 |  |
  | 9 | 9 | Bad Behavior prevents spammers from ever delivering their junk, and in many |
* ## [bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php](/changeset/543807/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php "Show the changeset 543807 restricted to bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php")

  | [r539647](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L127 "Show revision 539647 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php?rev=543807#L127 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 127 | 127 | <div class="wrap"> |
  | 128 | 128 | <h2><?php \_e("Bad Behavior"); ?></h2> |
  | 129 |  | <form method="post" action="<?php echo ~~$request\_uri~~; ?>"> |
  |  | 129 | <form method="post" action="<?php echo admin\_url("tools.php?page=bb2\_manage"); ?>"> |
  | 130 | 130 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 131 | 131 | <p>If you find Bad Behavior valuable, please consider <a href="https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20<?php echo BB2\_VERSION; ?>%20%28From%20Admin%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8">donating</a> to help further development of Bad Behavior.</p> |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L139) | […](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php?rev=543807#L139) |  |
  | 139 | 139 | <?php if ($count < $totalcount): ?> |
  | 140 | 140 | Displaying <strong><?php echo $count; ?></strong> of <strong><?php echo $totalcount; ?></strong> records filtered by:<br/> |
  | 141 |  | <?php if ($\_GET['key']) echo "Status [<a href=\"" . ~~remove\_query\_arg(array("paged", "key"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 142 |  | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 143 |  | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . ~~remove\_query\_arg(array("paged", "ip"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 144 |  | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . ~~remove\_query\_arg(array("paged", "user\_agent"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 145 |  | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . ~~remove\_query\_arg(array("paged", "request\_method"), $request\_uri~~) . "\">X</a>] "; ?> |
  |  | 141 | <?php if ($\_GET['key']) echo "Status [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "key"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 142 | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "blocked"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 143 | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "ip"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 144 | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "user\_agent"), $request\_uri)) . "\">X</a>] "; ?> |
  |  | 145 | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . esc\_url(remove\_query\_arg(array("paged", "request\_method"), $request\_uri)) . "\">X</a>] "; ?> |
  | 146 | 146 | <?php else: ?> |
  | 147 | 147 | Displaying all <strong><?php echo $totalcount; ?></strong> records<br/> |
  | 148 | 148 | <?php endif; ?> |
  | 149 |  | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo ~~add\_query\_arg(array("blocked" => "true", "paged" => false), $request\_uri~~); ?>">Show Blocked</a><?php } ?> |
  |  | 149 | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo esc\_url(add\_query\_arg(array("blocked" => "true", "paged" => false), $request\_uri)); ?>">Show Blocked</a><?php } ?> |
  | 150 | 150 | </div> |
  | 151 | 151 | </div> |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L179) | […](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php?rev=543807#L179) |  |
  | 179 | 179 | $host .= "<br/>\n"; |
  | 180 | 180 | } |
  | 181 |  | echo "<td><a href=\"" . ~~add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked"), $request\_uri~~)) . "\">" . $key["log"] . "</a>\n"; |
  |  | 181 | echo "<td><a href=\"" . esc\_url(add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri))) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . esc\_url(add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked"), $request\_uri))) . "\">" . $key["log"] . "</a>\n"; |
  | 182 | 182 | if ($httpbl) echo "<br/><br/>http:BL:<br/>$httpbl\n"; |
  | 183 | 183 | echo "</td>\n"; |
  | 184 | 184 | $headers = str\_replace("\n", "<br/>\n", htmlspecialchars($result['http\_headers'])); |
  | 185 |  | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri~~)) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  | 186 |  | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri~~)) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  |  | 185 | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url(add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri))) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  |  | 186 | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url(add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri))) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  | 187 | 187 | echo "<td>$headers</td>\n"; |
  | 188 | 188 | echo "<td>" . str\_replace("\n", "<br/>\n", htmlspecialchars($result["request\_entity"])) . "</td>\n"; |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L244) | […](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php?rev=543807#L244) |  |
  | 244 | 244 | } |
  | 245 | 245 | if ($\_POST['httpbl\_key']) { |
  | 246 |  | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 246 | if (preg\_match("/^[:alpha:]{12}$/", $\_POST['httpbl\_key'])) { |
  |  | 247 | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 248 | } else { |
  |  | 249 | $settings['httpbl\_key'] = ''; |
  |  | 250 | } |
  | 247 | 251 | } else { |
  | 248 | 252 | $settings['httpbl\_key'] = ''; |
  | 249 | 253 | } |
  | 250 | 254 | if ($\_POST['httpbl\_threat']) { |
  | 251 |  | $settings['httpbl\_threat'] = ~~$\_POST['httpbl\_threat']~~; |
  |  | 255 | $settings['httpbl\_threat'] = intval($\_POST['httpbl\_threat']); |
  | 252 | 256 | } else { |
  | 253 | 257 | $settings['httpbl\_threat'] = '25'; |
  | 254 | 258 | } |
  | 255 | 259 | if ($\_POST['httpbl\_maxage']) { |
  | 256 |  | $settings['httpbl\_maxage'] = ~~$\_POST['httpbl\_maxage']~~; |
  |  | 260 | $settings['httpbl\_maxage'] = intval($\_POST['httpbl\_maxage']); |
  | 257 | 261 | } else { |
  | 258 | 262 | $settings['httpbl\_maxage'] = '30'; |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L276) | […](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php?rev=543807#L280) |  |
  | 276 | 280 | <div class="wrap"> |
  | 277 | 281 | <h2><?php \_e("Bad Behavior"); ?></h2> |
  | 278 |  | <form method="post" action="<?php echo ~~$request\_uri~~; ?>"> |
  |  | 282 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_options"); ?>"> |
  | 279 | 283 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 280 | 284 | <p>If you find Bad Behavior valuable, please consider making a <a href="https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20<?php echo BB2\_VERSION; ?>%20%28From%20Admin%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8">financial contribution</a> to further development of Bad Behavior.</p> |
  | […](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress-admin.php?rev=539647#L302) | […](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress-admin.php?rev=543807#L306) |  |
  | 302 | 306 | <p>To use Bad Behavior's http:BL features you must have an <a href="http://www.projecthoneypot.org/httpbl\_configure.php?rf=24694">http:BL Access Key</a>.</p> |
  | 303 | 307 | <table class="form-table"> |
  | 304 |  | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo ~~$settings['httpbl\_key']~~; ?>" /> http:BL Access Key</label></td></tr> |
  | 305 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo ~~$settings['httpbl\_threat']~~; ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  | 306 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo ~~$settings['httpbl\_maxage']~~; ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  |  | 308 | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo sanitize\_text\_field($settings['httpbl\_key']); ?>" /> http:BL Access Key</label></td></tr> |
  |  | 309 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo intval($settings['httpbl\_threat']); ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  |  | 310 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo intval($settings['httpbl\_maxage']); ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  | 307 | 311 | </table> |
  | 308 | 312 |  |
* ## [bad-behavior/tags/2.0.47/bad-behavior-wordpress.php](/changeset/543807/bad-behavior/tags/2.0.47/bad-behavior-wordpress.php "Show the changeset 543807 restricted to bad-behavior/tags/2.0.47/bad-behavior-wordpress.php")

  | [r539645](/browser/bad-behavior/branches/2.0/bad-behavior-wordpress.php?rev=539645#L2 "Show revision 539645 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.0.47/bad-behavior-wordpress.php?rev=543807#L2 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: Bad Behavior |
  | 4 |  | Version: 2.0.4~~6~~ |
  |  | 4 | Version: 2.0.47 |
  | 5 | 5 | Description: Deny automated spambots access to your PHP-based Web site. |
  | 6 | 6 | Plugin URI: http://www.bad-behavior.ioerror.us/ |
* ## [bad-behavior/tags/2.0.47/bad-behavior/version.inc.php](/changeset/543807/bad-behavior/tags/2.0.47/bad-behavior/version.inc.php "Show the changeset 543807 restricted to bad-behavior/tags/2.0.47/bad-behavior/version.inc.php")

  | [r539645](/browser/bad-behavior/branches/2.0/bad-behavior/version.inc.php?rev=539645#L1 "Show revision 539645 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.0.47/bad-behavior/version.inc.php?rev=543807#L1 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php if (!defined('BB2\_CWD')) die("I said no cheating!"); |
  | 2 |  | define('BB2\_VERSION', "2.0.4~~6~~"); |
  |  | 2 | define('BB2\_VERSION', "2.0.47"); |
  | 3 | 3 | ?> |
* ## [bad-behavior/tags/2.2.5/README.txt](/changeset/543807/bad-behavior/tags/2.2.5/README.txt "Show the changeset 543807 restricted to bad-behavior/tags/2.2.5/README.txt")

  | [r539629](/browser/bad-behavior/branches/2.2/README.txt?rev=539629#L3 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.2.5/README.txt?rev=543807#L3 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Contributors: error, markjaquith, skeltoac |
  | 4 | 4 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20%28From%20WordPress%20Page%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8 |
  | 5 |  | Requires at least: ~~2.7~~ |
  |  | 5 | Requires at least: 3.1 |
  | 6 | 6 | Tested up to: 3.3.2 |
  | 7 |  | Stable tag: 2.2.~~4~~ |
  |  | 7 | Stable tag: 2.2.5 |
  | 8 | 8 |  |
  | 9 | 9 | Bad Behavior prevents spammers from ever delivering their junk, and in many |
* ## [bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php](/changeset/543807/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php "Show the changeset 543807 restricted to bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php")

  | [r539647](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L150 "Show revision 539647 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L150 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 150 | 150 | ?> |
  | 151 | 151 | <h2><?php \_e("Bad Behavior Log"); ?></h2> |
  | 152 |  | <form method="post" action="<?php echo ~~$request\_uri;~~ ?>"> |
  |  | 152 | <form method="post" action="<?php echo admin\_url("tools.php?page=bb2\_manage") ?>"> |
  | 153 | 153 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 154 | 154 | <p>See also: <a href="<?php echo admin\_url("options-general.php?page=bb2\_options") ?>">Settings</a> | <a href="<?php echo admin\_url("options-general.php?page=bb2\_whitelist") ?>">Whitelist</a></p> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L161) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L161) |  |
  | 161 | 161 | <?php if ($count < $totalcount): ?> |
  | 162 | 162 | Displaying <strong><?php echo $count; ?></strong> of <strong><?php echo $totalcount; ?></strong> records filtered by:<br/> |
  | 163 |  | <?php if ($\_GET['key']) echo "Status [<a href=\"" . ~~remove\_query\_arg(array("paged", "key"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 164 |  | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 165 |  | <?php if ($\_GET['permitted']) echo "Permitted [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 166 |  | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . ~~remove\_query\_arg(array("paged", "ip"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 167 |  | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . ~~remove\_query\_arg(array("paged", "user\_agent"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 168 |  | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . ~~remove\_query\_arg(array("paged", "request\_method"), $request\_uri~~) . "\">X</a>] "; ?> |
  |  | 163 | <?php if ($\_GET['key']) echo "Status [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "key"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 164 | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 165 | <?php if ($\_GET['permitted']) echo "Permitted [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 166 | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "ip"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 167 | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "user\_agent"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 168 | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "request\_method"), $request\_uri) ) . "\">X</a>] "; ?> |
  | 169 | 169 | <?php else: ?> |
  | 170 | 170 | Displaying all <strong><?php echo $totalcount; ?></strong> records<br/> |
  | 171 | 171 | <?php endif; ?> |
  | 172 |  | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo ~~add\_query\_arg(array("blocked" => "1", "permitted" => "0", "paged" => false), $request\_uri~~); ?>">Show Blocked</a> <?php } ?> |
  | 173 |  | <?php if (!$\_GET['key'] && !$\_GET['permitted']) { ?><a href="<?php echo ~~add\_query\_arg(array("permitted" => "1", "blocked" => "0", "paged" => false), $request\_uri~~); ?>">Show Permitted</a> <?php } ?> |
  |  | 172 | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo esc\_url( add\_query\_arg(array("blocked" => "1", "permitted" => "0", "paged" => false), $request\_uri) ); ?>">Show Blocked</a> <?php } ?> |
  |  | 173 | <?php if (!$\_GET['key'] && !$\_GET['permitted']) { ?><a href="<?php echo esc\_url( add\_query\_arg(array("permitted" => "1", "blocked" => "0", "paged" => false), $request\_uri) ); ?>">Show Permitted</a> <?php } ?> |
  | 174 | 174 | </div> |
  | 175 | 175 | </div> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L203) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L203) |  |
  | 203 | 203 | $host .= "<br/>\n"; |
  | 204 | 204 | } |
  | 205 |  | echo "<td><a href=\"" . ~~add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri)~~) . "\">" . $key["log"] . "</a>\n"; |
  |  | 205 | echo "<td><a href=\"" . esc\_url( add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . esc\_url( add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri)) ) . "\">" . $key["log"] . "</a>\n"; |
  | 206 | 206 | if ($httpbl) echo "<br/><br/><a href=\"http://www.projecthoneypot.org/ip\_{$result['ip']}\">http:BL</a>:<br/>$httpbl\n"; |
  | 207 | 207 | echo "</td>\n"; |
  | 208 | 208 | $headers = str\_replace("\n", "<br/>\n", htmlspecialchars($result['http\_headers'])); |
  | 209 |  | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri)~~) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  | 210 |  | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri)~~) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  |  | 209 | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url( add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  |  | 210 | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url( add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  | 211 | 211 | echo "<td>$headers</td>\n"; |
  | 212 | 212 | echo "<td>" . str\_replace("\n", "<br/>\n", htmlspecialchars($result["request\_entity"])) . "</td>\n"; |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L271) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L271) |  |
  | 271 | 271 | ?> |
  | 272 | 272 | <h2><?php \_e("Bad Behavior Whitelist"); ?></h2> |
  | 273 |  | <form method="post" action="<?php echo ~~$request\_uri~~; ?>"> |
  |  | 273 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_whitelist"); ?>"> |
  | 274 | 274 | <p>Inappropriate whitelisting WILL expose you to spam, or cause Bad Behavior to stop functioning entirely! DO NOT WHITELIST unless you are 100% CERTAIN that you should.</p> |
  | 275 | 275 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L337) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L337) |  |
  | 337 | 337 | } |
  | 338 | 338 | if ($\_POST['httpbl\_key']) { |
  | 339 |  | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 339 | if (preg\_match("/^[:alpha:]{12}$/", $\_POST['httpbl\_key'])) { |
  |  | 340 | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 341 | } else { |
  |  | 342 | $settings['httpbl\_key'] = ''; |
  |  | 343 | } |
  | 340 | 344 | } else { |
  | 341 | 345 | $settings['httpbl\_key'] = ''; |
  | 342 | 346 | } |
  | 343 | 347 | if ($\_POST['httpbl\_threat']) { |
  | 344 |  | $settings['httpbl\_threat'] = ~~$\_POST['httpbl\_threat']~~; |
  |  | 348 | $settings['httpbl\_threat'] = intval($\_POST['httpbl\_threat']); |
  | 345 | 349 | } else { |
  | 346 | 350 | $settings['httpbl\_threat'] = '25'; |
  | 347 | 351 | } |
  | 348 | 352 | if ($\_POST['httpbl\_maxage']) { |
  | 349 |  | $settings['httpbl\_maxage'] = ~~$\_POST['httpbl\_maxage']~~; |
  |  | 353 | $settings['httpbl\_maxage'] = intval($\_POST['httpbl\_maxage']); |
  | 350 | 354 | } else { |
  | 351 | 355 | $settings['httpbl\_maxage'] = '30'; |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L367) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L371) |  |
  | 367 | 371 | } |
  | 368 | 372 | if ($\_POST['reverse\_proxy\_header']) { |
  | 369 |  | $settings['reverse\_proxy\_header'] = ~~uc\_all($\_POST['reverse\_proxy\_header']~~); |
  |  | 373 | $settings['reverse\_proxy\_header'] = sanitize\_text\_field(uc\_all($\_POST['reverse\_proxy\_header'])); |
  | 370 | 374 | } else { |
  | 371 | 375 | $settings['reverse\_proxy\_header'] = 'X-Forwarded-For'; |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L373) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L377) |  |
  | 373 | 377 | if ($\_POST['reverse\_proxy\_addresses']) { |
  | 374 | 378 | $settings['reverse\_proxy\_addresses'] = preg\_split("/[\s,]+/m", $\_POST['reverse\_proxy\_addresses']); |
  |  | 379 | $settings['reverse\_proxy\_addresses'] = array\_map('sanitize\_text\_field', $settings['reverse\_proxy\_addresses']); |
  | 375 | 380 | } else { |
  | 376 | 381 | $settings['reverse\_proxy\_addresses'] = array(); |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L387) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L392) |  |
  | 387 | 392 | ?> |
  | 388 | 393 | <h2><?php \_e("Bad Behavior"); ?></h2> |
  | 389 |  | <form method="post" action="<?php echo ~~$\_SERVER['REQUEST\_URI']~~; ?>"> |
  |  | 394 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_options"); ?>"> |
  | 390 | 395 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 391 | 396 | <p>See also: <a href="<?php echo admin\_url("tools.php?page=bb2\_manage"); ?>">Log</a> | <a href="<?php echo admin\_url("options-general.php?page=bb2\_whitelist") ?>">Whitelist</a></p> |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L413) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L418) |  |
  | 413 | 418 | <p>To use Bad Behavior's http:BL features you must have an <a href="http://www.projecthoneypot.org/httpbl\_configure.php?rf=24694">http:BL Access Key</a>.</p> |
  | 414 | 419 | <table class="form-table"> |
  | 415 |  | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo ~~$settings['httpbl\_key']~~; ?>" /> http:BL Access Key</label></td></tr> |
  | 416 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo ~~$settings['httpbl\_threat']~~; ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  | 417 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo ~~$settings['httpbl\_maxage']~~; ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  |  | 420 | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo sanitize\_text\_field($settings['httpbl\_key']); ?>" /> http:BL Access Key</label></td></tr> |
  |  | 421 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo intval($settings['httpbl\_threat']); ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  |  | 422 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo intval($settings['httpbl\_maxage']); ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  | 418 | 423 | </table> |
  | 419 | 424 |  |
  | […](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress-admin.php?rev=539647#L430) | […](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress-admin.php?rev=543807#L435) |  |
  | 430 | 435 | <table class="form-table"> |
  | 431 | 436 | <tr><td><label><input type="checkbox" name="reverse\_proxy" value="true" <?php if ($settings['reverse\_proxy']) { ?>checked="checked" <?php } ?>/> <?php \_e('Enable Reverse Proxy'); ?></label></td></tr> |
  | 432 |  | <tr><td><label><input type="text" size="32" name="reverse\_proxy\_header" value="<?php echo ~~$settings['reverse\_proxy\_header']~~; ?>" /> Header containing Internet clients' IP address</label></td></tr> |
  | 433 |  | <tr><td><label>IP address or CIDR format address ranges for your proxy servers (one per line)<br/><textarea cols="24" rows="6" name="reverse\_proxy\_addresses"><?php echo ~~implode("\n", $settings['reverse\_proxy\_addresses']~~); ?></textarea></td></tr> |
  |  | 437 | <tr><td><label><input type="text" size="32" name="reverse\_proxy\_header" value="<?php echo sanitize\_text\_field($settings['reverse\_proxy\_header']); ?>" /> Header containing Internet clients' IP address</label></td></tr> |
  |  | 438 | <tr><td><label>IP address or CIDR format address ranges for your proxy servers (one per line)<br/><textarea cols="24" rows="6" name="reverse\_proxy\_addresses"><?php echo esc\_textarea(implode("\n", $settings['reverse\_proxy\_addresses'])); ?></textarea></td></tr> |
  | 434 | 439 | </table> |
  | 435 | 440 |  |
* ## [bad-behavior/tags/2.2.5/bad-behavior-wordpress.php](/changeset/543807/bad-behavior/tags/2.2.5/bad-behavior-wordpress.php "Show the changeset 543807 restricted to bad-behavior/tags/2.2.5/bad-behavior-wordpress.php")

  | [r539629](/browser/bad-behavior/branches/2.2/bad-behavior-wordpress.php?rev=539629#L2 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.2.5/bad-behavior-wordpress.php?rev=543807#L2 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: Bad Behavior |
  | 4 |  | Version: 2.2.~~4~~ |
  |  | 4 | Version: 2.2.5 |
  | 5 | 5 | Description: Deny automated spambots access to your PHP-based Web site. |
  | 6 | 6 | Plugin URI: http://bad-behavior.ioerror.us/ |
* ## [bad-behavior/tags/2.2.5/bad-behavior/core.inc.php](/changeset/543807/bad-behavior/tags/2.2.5/bad-behavior/core.inc.php "Show the changeset 543807 restricted to bad-behavior/tags/2.2.5/bad-behavior/core.inc.php")

  | [r539629](/browser/bad-behavior/branches/2.2/bad-behavior/core.inc.php?rev=539629#L1 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/tags/2.2.5/bad-behavior/core.inc.php?rev=543807#L1 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php if (!defined('BB2\_CWD')) die("I said no cheating!"); |
  | 2 |  | define('BB2\_VERSION', "2.2.~~4~~"); |
  |  | 2 | define('BB2\_VERSION', "2.2.5"); |
  | 3 | 3 |  |
  | 4 | 4 | // Bad Behavior entry point is bb2\_start() |
* ## [bad-behavior/trunk/README.txt](/changeset/543807/bad-behavior/trunk/README.txt "Show the changeset 543807 restricted to bad-behavior/trunk/README.txt")

  | [r539629](/browser/bad-behavior/trunk/README.txt?rev=539629#L3 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/trunk/README.txt?rev=543807#L3 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Contributors: error, markjaquith, skeltoac |
  | 4 | 4 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_xclick&business=error%40ioerror%2eus&item\_name=Bad%20Behavior%20%28From%20WordPress%20Page%29&no\_shipping=1&cn=Comments%20about%20Bad%20Behavior&tax=0&currency\_code=USD&bn=PP%2dDonationsBF&charset=UTF%2d8 |
  | 5 |  | Requires at least: ~~2.7~~ |
  |  | 5 | Requires at least: 3.1 |
  | 6 | 6 | Tested up to: 3.3.2 |
  | 7 |  | Stable tag: 2.2.~~4~~ |
  |  | 7 | Stable tag: 2.2.5 |
  | 8 | 8 |  |
  | 9 | 9 | Bad Behavior prevents spammers from ever delivering their junk, and in many |
* ## [bad-behavior/trunk/bad-behavior-wordpress-admin.php](/changeset/543807/bad-behavior/trunk/bad-behavior-wordpress-admin.php "Show the changeset 543807 restricted to bad-behavior/trunk/bad-behavior-wordpress-admin.php")

  | [r539647](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L150 "Show revision 539647 of this file in browser") | [r543807](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L150 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 150 | 150 | ?> |
  | 151 | 151 | <h2><?php \_e("Bad Behavior Log"); ?></h2> |
  | 152 |  | <form method="post" action="<?php echo ~~$request\_uri;~~ ?>"> |
  |  | 152 | <form method="post" action="<?php echo admin\_url("tools.php?page=bb2\_manage") ?>"> |
  | 153 | 153 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 154 | 154 | <p>See also: <a href="<?php echo admin\_url("options-general.php?page=bb2\_options") ?>">Settings</a> | <a href="<?php echo admin\_url("options-general.php?page=bb2\_whitelist") ?>">Whitelist</a></p> |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L161) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L161) |  |
  | 161 | 161 | <?php if ($count < $totalcount): ?> |
  | 162 | 162 | Displaying <strong><?php echo $count; ?></strong> of <strong><?php echo $totalcount; ?></strong> records filtered by:<br/> |
  | 163 |  | <?php if ($\_GET['key']) echo "Status [<a href=\"" . ~~remove\_query\_arg(array("paged", "key"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 164 |  | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 165 |  | <?php if ($\_GET['permitted']) echo "Permitted [<a href=\"" . ~~remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 166 |  | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . ~~remove\_query\_arg(array("paged", "ip"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 167 |  | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . ~~remove\_query\_arg(array("paged", "user\_agent"), $request\_uri~~) . "\">X</a>] "; ?> |
  | 168 |  | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . ~~remove\_query\_arg(array("paged", "request\_method"), $request\_uri~~) . "\">X</a>] "; ?> |
  |  | 163 | <?php if ($\_GET['key']) echo "Status [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "key"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 164 | <?php if ($\_GET['blocked']) echo "Blocked [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 165 | <?php if ($\_GET['permitted']) echo "Permitted [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 166 | <?php if ($\_GET['ip']) echo "IP [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "ip"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 167 | <?php if ($\_GET['user\_agent']) echo "User Agent [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "user\_agent"), $request\_uri) ) . "\">X</a>] "; ?> |
  |  | 168 | <?php if ($\_GET['request\_method']) echo "GET/POST [<a href=\"" . esc\_url( remove\_query\_arg(array("paged", "request\_method"), $request\_uri) ) . "\">X</a>] "; ?> |
  | 169 | 169 | <?php else: ?> |
  | 170 | 170 | Displaying all <strong><?php echo $totalcount; ?></strong> records<br/> |
  | 171 | 171 | <?php endif; ?> |
  | 172 |  | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo ~~add\_query\_arg(array("blocked" => "1", "permitted" => "0", "paged" => false), $request\_uri~~); ?>">Show Blocked</a> <?php } ?> |
  | 173 |  | <?php if (!$\_GET['key'] && !$\_GET['permitted']) { ?><a href="<?php echo ~~add\_query\_arg(array("permitted" => "1", "blocked" => "0", "paged" => false), $request\_uri~~); ?>">Show Permitted</a> <?php } ?> |
  |  | 172 | <?php if (!$\_GET['key'] && !$\_GET['blocked']) { ?><a href="<?php echo esc\_url( add\_query\_arg(array("blocked" => "1", "permitted" => "0", "paged" => false), $request\_uri) ); ?>">Show Blocked</a> <?php } ?> |
  |  | 173 | <?php if (!$\_GET['key'] && !$\_GET['permitted']) { ?><a href="<?php echo esc\_url( add\_query\_arg(array("permitted" => "1", "blocked" => "0", "paged" => false), $request\_uri) ); ?>">Show Permitted</a> <?php } ?> |
  | 174 | 174 | </div> |
  | 175 | 175 | </div> |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L203) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L203) |  |
  | 203 | 203 | $host .= "<br/>\n"; |
  | 204 | 204 | } |
  | 205 |  | echo "<td><a href=\"" . ~~add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri)~~) . "\">" . $key["log"] . "</a>\n"; |
  |  | 205 | echo "<td><a href=\"" . esc\_url( add\_query\_arg("ip", $result["ip"], remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result["ip"] . "</a><br/>$host<br/>\n" . $result["date"] . "<br/><br/><a href=\"" . esc\_url( add\_query\_arg("key", $result["key"], remove\_query\_arg(array("paged", "blocked", "permitted"), $request\_uri)) ) . "\">" . $key["log"] . "</a>\n"; |
  | 206 | 206 | if ($httpbl) echo "<br/><br/><a href=\"http://www.projecthoneypot.org/ip\_{$result['ip']}\">http:BL</a>:<br/>$httpbl\n"; |
  | 207 | 207 | echo "</td>\n"; |
  | 208 | 208 | $headers = str\_replace("\n", "<br/>\n", htmlspecialchars($result['http\_headers'])); |
  | 209 |  | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri)~~) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  | 210 |  | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . ~~add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri)~~) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  |  | 209 | if (@strpos($headers, $result['user\_agent']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url( add\_query\_arg("user\_agent", rawurlencode($result["user\_agent"]), remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result['user\_agent'] . "</a>", strpos($headers, $result['user\_agent']), strlen($result['user\_agent'])); |
  |  | 210 | if (@strpos($headers, $result['request\_method']) !== FALSE) $headers = substr\_replace($headers, "<a href=\"" . esc\_url( add\_query\_arg("request\_method", rawurlencode($result["request\_method"]), remove\_query\_arg("paged", $request\_uri)) ) . "\">" . $result['request\_method'] . "</a>", strpos($headers, $result['request\_method']), strlen($result['request\_method'])); |
  | 211 | 211 | echo "<td>$headers</td>\n"; |
  | 212 | 212 | echo "<td>" . str\_replace("\n", "<br/>\n", htmlspecialchars($result["request\_entity"])) . "</td>\n"; |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L271) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L271) |  |
  | 271 | 271 | ?> |
  | 272 | 272 | <h2><?php \_e("Bad Behavior Whitelist"); ?></h2> |
  | 273 |  | <form method="post" action="<?php echo ~~$request\_uri~~; ?>"> |
  |  | 273 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_whitelist"); ?>"> |
  | 274 | 274 | <p>Inappropriate whitelisting WILL expose you to spam, or cause Bad Behavior to stop functioning entirely! DO NOT WHITELIST unless you are 100% CERTAIN that you should.</p> |
  | 275 | 275 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L337) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L337) |  |
  | 337 | 337 | } |
  | 338 | 338 | if ($\_POST['httpbl\_key']) { |
  | 339 |  | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 339 | if (preg\_match("/^[:alpha:]{12}$/", $\_POST['httpbl\_key'])) { |
  |  | 340 | $settings['httpbl\_key'] = $\_POST['httpbl\_key']; |
  |  | 341 | } else { |
  |  | 342 | $settings['httpbl\_key'] = ''; |
  |  | 343 | } |
  | 340 | 344 | } else { |
  | 341 | 345 | $settings['httpbl\_key'] = ''; |
  | 342 | 346 | } |
  | 343 | 347 | if ($\_POST['httpbl\_threat']) { |
  | 344 |  | $settings['httpbl\_threat'] = ~~$\_POST['httpbl\_threat']~~; |
  |  | 348 | $settings['httpbl\_threat'] = intval($\_POST['httpbl\_threat']); |
  | 345 | 349 | } else { |
  | 346 | 350 | $settings['httpbl\_threat'] = '25'; |
  | 347 | 351 | } |
  | 348 | 352 | if ($\_POST['httpbl\_maxage']) { |
  | 349 |  | $settings['httpbl\_maxage'] = ~~$\_POST['httpbl\_maxage']~~; |
  |  | 353 | $settings['httpbl\_maxage'] = intval($\_POST['httpbl\_maxage']); |
  | 350 | 354 | } else { |
  | 351 | 355 | $settings['httpbl\_maxage'] = '30'; |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L367) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L371) |  |
  | 367 | 371 | } |
  | 368 | 372 | if ($\_POST['reverse\_proxy\_header']) { |
  | 369 |  | $settings['reverse\_proxy\_header'] = ~~uc\_all($\_POST['reverse\_proxy\_header']~~); |
  |  | 373 | $settings['reverse\_proxy\_header'] = sanitize\_text\_field(uc\_all($\_POST['reverse\_proxy\_header'])); |
  | 370 | 374 | } else { |
  | 371 | 375 | $settings['reverse\_proxy\_header'] = 'X-Forwarded-For'; |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L373) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L377) |  |
  | 373 | 377 | if ($\_POST['reverse\_proxy\_addresses']) { |
  | 374 | 378 | $settings['reverse\_proxy\_addresses'] = preg\_split("/[\s,]+/m", $\_POST['reverse\_proxy\_addresses']); |
  |  | 379 | $settings['reverse\_proxy\_addresses'] = array\_map('sanitize\_text\_field', $settings['reverse\_proxy\_addresses']); |
  | 375 | 380 | } else { |
  | 376 | 381 | $settings['reverse\_proxy\_addresses'] = array(); |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L387) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L392) |  |
  | 387 | 392 | ?> |
  | 388 | 393 | <h2><?php \_e("Bad Behavior"); ?></h2> |
  | 389 |  | <form method="post" action="<?php echo ~~$\_SERVER['REQUEST\_URI']~~; ?>"> |
  |  | 394 | <form method="post" action="<?php echo admin\_url("options-general.php?page=bb2\_options"); ?>"> |
  | 390 | 395 | <p>For more information please visit the <a href="http://www.bad-behavior.ioerror.us/">Bad Behavior</a> homepage.</p> |
  | 391 | 396 | <p>See also: <a href="<?php echo admin\_url("tools.php?page=bb2\_manage"); ?>">Log</a> | <a href="<?php echo admin\_url("options-general.php?page=bb2\_whitelist") ?>">Whitelist</a></p> |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L413) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L418) |  |
  | 413 | 418 | <p>To use Bad Behavior's http:BL features you must have an <a href="http://www.projecthoneypot.org/httpbl\_configure.php?rf=24694">http:BL Access Key</a>.</p> |
  | 414 | 419 | <table class="form-table"> |
  | 415 |  | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo ~~$settings['httpbl\_key']~~; ?>" /> http:BL Access Key</label></td></tr> |
  | 416 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo ~~$settings['httpbl\_threat']~~; ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  | 417 |  | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo ~~$settings['httpbl\_maxage']~~; ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  |  | 420 | <tr><td><label><input type="text" size="12" maxlength="12" name="httpbl\_key" value="<?php echo sanitize\_text\_field($settings['httpbl\_key']); ?>" /> http:BL Access Key</label></td></tr> |
  |  | 421 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_threat" value="<?php echo intval($settings['httpbl\_threat']); ?>" /> Minimum Threat Level (25 is recommended)</label></td></tr> |
  |  | 422 | <tr><td><label><input type="text" size="3" maxlength="3" name="httpbl\_maxage" value="<?php echo intval($settings['httpbl\_maxage']); ?>" /> Maximum Age of Data (30 is recommended)</label></td></tr> |
  | 418 | 423 | </table> |
  | 419 | 424 |  |
  | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=539647#L430) | […](/browser/bad-behavior/trunk/bad-behavior-wordpress-admin.php?rev=543807#L435) |  |
  | 430 | 435 | <table class="form-table"> |
  | 431 | 436 | <tr><td><label><input type="checkbox" name="reverse\_proxy" value="true" <?php if ($settings['reverse\_proxy']) { ?>checked="checked" <?php } ?>/> <?php \_e('Enable Reverse Proxy'); ?></label></td></tr> |
  | 432 |  | <tr><td><label><input type="text" size="32" name="reverse\_proxy\_header" value="<?php echo ~~$settings['reverse\_proxy\_header']~~; ?>" /> Header containing Internet clients' IP address</label></td></tr> |
  | 433 |  | <tr><td><label>IP address or CIDR format address ranges for your proxy servers (one per line)<br/><textarea cols="24" rows="6" name="reverse\_proxy\_addresses"><?php echo ~~implode("\n", $settings['reverse\_proxy\_addresses']~~); ?></textarea></td></tr> |
  |  | 437 | <tr><td><label><input type="text" size="32" name="reverse\_proxy\_header" value="<?php echo sanitize\_text\_field($settings['reverse\_proxy\_header']); ?>" /> Header containing Internet clients' IP address</label></td></tr> |
  |  | 438 | <tr><td><label>IP address or CIDR format address ranges for your proxy servers (one per line)<br/><textarea cols="24" rows="6" name="reverse\_proxy\_addresses"><?php echo esc\_textarea(implode("\n", $settings['reverse\_proxy\_addresses'])); ?></textarea></td></tr> |
  | 434 | 439 | </table> |
  | 435 | 440 |  |
* ## [bad-behavior/trunk/bad-behavior-wordpress.php](/changeset/543807/bad-behavior/trunk/bad-behavior-wordpress.php "Show the changeset 543807 restricted to bad-behavior/trunk/bad-behavior-wordpress.php")

  | [r539629](/browser/bad-behavior/trunk/bad-behavior-wordpress.php?rev=539629#L2 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/trunk/bad-behavior-wordpress.php?rev=543807#L2 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: Bad Behavior |
  | 4 |  | Version: 2.2.~~4~~ |
  |  | 4 | Version: 2.2.5 |
  | 5 | 5 | Description: Deny automated spambots access to your PHP-based Web site. |
  | 6 | 6 | Plugin URI: http://bad-behavior.ioerror.us/ |
* ## [bad-behavior/trunk/bad-behavior/core.inc.php](/changeset/543807/bad-behavior/trunk/bad-behavior/core.inc.php "Show the changeset 543807 restricted to bad-behavior/trunk/bad-behavior/core.inc.php")

  | [r539629](/browser/bad-behavior/trunk/bad-behavior/core.inc.php?rev=539629#L1 "Show revision 539629 of this file in browser") | [r543807](/browser/bad-behavior/trunk/bad-behavior/core.inc.php?rev=543807#L1 "Show revision 543807 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php if (!defined('BB2\_CWD')) die("I said no cheating!"); |
  | 2 |  | define('BB2\_VERSION', "2.2.~~4~~"); |
  |  | 2 | define('BB2\_VERSION', "2.2.5"); |
  | 3 | 3 |  |
  | 4 | 4 | // Bad Behavior entry point is bb2\_start() |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=543807)
* [Zip Archive](?format=zip&new=543807)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


