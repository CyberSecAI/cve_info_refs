```
{
  "vulnerability_details": {
    "root_cause": "Unsanitized user input passed to shell command execution.",
    "weaknesses": [
      "Command Injection",
      "Insufficient Input Sanitization"
    ],
    "impact": "Arbitrary command execution on the server.",
      "attack_vectors": [
      "The vulnerability is in the web_node_register function, which is accessible through the web interface of the PacketFence application.",
      "An attacker can inject shell commands through the user-controlled data (mac, pid, info parameters) during node registration."
    ],
    "attacker_capabilities": "An attacker must be able to access the web interface and submit crafted node registration requests.",
    "additional_information": "The vulnerability is not only in the `web_node_register` function, but also in `web_node_record_user_agent`, which passes the user agent directly to the shell with only single quote escaping."
  }
}
```