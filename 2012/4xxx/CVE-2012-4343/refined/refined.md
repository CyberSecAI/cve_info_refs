The provided content discusses the release of Gallery 3.0.4 as a security update, which addresses 22 distinct vulnerabilities.

**Root cause of vulnerability:**
The vulnerabilities stem from issues discovered during internal and external security audits.

**Weaknesses/vulnerabilities present:**
- XSS (Cross-Site Scripting) vulnerabilities
- Arbitrary PHP code execution vulnerabilities

**Impact of exploitation:**
- XSS vulnerabilities could allow an attacker to execute malicious scripts in the context of a user's browser.
- Arbitrary PHP code execution could allow an attacker to gain control of the server.

**Attack vectors:**
- Exploiting the vulnerabilities requires a malicious user to either:
    - Have an account with edit permissions.
    - Trick a user with edit permissions into clicking a malicious link.

**Required attacker capabilities/position:**
- Attacker needs to have a user account with edit permissions or be able to trick a user with edit permissions.