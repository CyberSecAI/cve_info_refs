```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": [
    {
      "content": "=== Content from www.deependresearch.org_5d38dd05_20250125_134726.html ===\n\n\n[![DeepEnd Research](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg-1cf_3jRAagTMTdkutYn8TiSGpqcFfB7iZ4PlKKZIhr7E4n8hME2KeEw5fpPt_kD74MR5Az9R4zbrCua7byBZCo3z8_TvHnfgx-LmUzGV5PMT0NWkuh9JsUz7DRD3YVre7IRJhPpvOxmy/s1600/tranheadersub4.gif)](http://www.deependresearch.org/)\n\n## Monday, August 27, 2012\n\n### CVE-2012-4681 Java 7 0-Day vulnerability analysis\n\n**Update Aug.30, 2012**\n\n[Oracle issued update 7 (7u7), which \u00a0fixed the vulnerability](http://www.oracle.com/technetwork/java/javase/7u7-relnotes-1835816.html).\n\n**Update: Aug. 28, 2012**. \u00a0Rapid 7 / Metasploit [released their module](http://dev.metasploit.com/redmine/projects/framework/repository/entry/modules/exploits/multi/browser/java_jre17_exec.rb)\u00a0 and \u00a0we get a lot of \u00a0questions related to it from people who wish to compare. \u00a0See below the original exploit source, to be run from the command line with a security manager enabled, and it will print the contents of the C:\\ root directory.\n\n|  |\n| --- |\n| ladyilonwick.wordpress.com |\n\nConsidering that Rapid 7 posted a working exploit and addition to the exploit packs is imminent ([Attackers Pounce on Zero-Day Java Exploit by Brian Krebs](http://krebsonsecurity.com/2012/08/attackers-pounce-on-zero-day-java-exploit/)), plus other analysis articles are being published such as [New Java 0day exploited in the wild \u00a0-by Alienvault](http://labs.alienvault.com/labs/index.php/2012/new-java-0day-exploited-in-the-wild/), we decided that witholding details of the exploit will not offer additional protection but only hinder development of protection and signatures.\n\nAs we mentioned earlier, we contacted [Michael Schierl,](http://schierlm.users.sourceforge.net/)\u00a0the Java expert who discovered a number of Java vulnerabilities and asked him to have a look. He sent back his detailed analysis, exploit source, the interim patch with the source code of the patched class.\n\n**Update: Aug. 28, 2012.**\n\n**[CVE-2012-4681](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2012-4681)**\n\nOracle Java 7 Update 6, and possibly other versions, allows remote attackers to execute arbitrary code via a crafted applet, as exploited in the wild in August 2012 using Gondzz.class and Gondvv.class.\n\n> **Patch request:**\n\n*At this point the patch is by request is not to preserve the code but limit it to IT administrators and developers who can test and decide if they want to deploy. We do not want to push/offer it to 3 billion end java users, it wasn't tested in all the possible scenarios and systems.*\n> * Interim patch with the\u00a0source code of the patched class. See the Readme of the patch in the previous post\u00a0(thanks to Michael Schierl).\n>\n> *Email from your company email address to\u00a0**admin <at> deependresearch.org***\n\n> **Additionally, you can request:**\n>\n> * Commented and stripped-down version of the exploit source, to be run from the command line with a security\u00a0manager enabled, and it will print the contents of the C:\\ root directory (thanks to Michael Schierl)\n>\n> * Original 0-day attack HTML page with javascript, Java applet, downloaded Poison Ivy RAT, and pcap.\n>\n> *Email from your company email address to***admin <at> deependresearch.org***and explain the planned use, please.*\n\n**Analysis**\n> The Gondvv class decompiles cleanly, and that contained all the\n>\n> interesting parts.\n>\n> The real vulnerability seems to be inside the new Java7 class\n>\n> com.sun.beans.finder.ClassFinder,\n\n> <http://www.docjar.com/docs/api/com/sun/beans/finder/ClassFinder.html>\n\n> which seems to make it possible for untrusted code to get access to\n>\n> classes in restricted packages (i. e. packages that are part of the\n>\n> security implementation itself and where usually untrusted code cannot\n>\n> get either access or call it).\n>\n> At the beginning, the exploit uses that ClassFinder class to get a\n>\n> reference to the sun.awt.SunToolkit class (sun.\\* is a restricted package).\n\n> <http://www.docjar.com/docs/api/sun/awt/SunToolkit.html>\n\n> The rest of the exploit is \"only\" using that reference to call the\n>\n> GetField method, which can be used to get access to private fields\n>\n> (which should not be a problem as the class is in a restricted package),\n>\n> to get access to a field that stores the permissions for running a\n>\n> java.beans.Statement.\n\n> <http://www.docjar.com/html/api/sun/awt/SunToolkit.java.html#301>\n\n> A Statement is created that disables the security manager (by default\n>\n> with permissions of the untrusted code). But before calling the\n>\n> statement, the permissions stored in that field we just got access to\n>\n> are overwritten with permissions that allow running all code, and the\n>\n> statement can be called now and disable the security manager for us. At\n>\n> this point, no security manager is left, and the applet can do anything\n>\n> Java can.\n\n> This method of abusing restricted package permissions is new to me (it\n>\n> does not work in Java 6 either as GetField was private there); but it is\n>\n> not unique - there are several ways you can use to get out of the\n>\n> sandbox if you have access to restricted packages - usually they need a\n>\n> bit more code though.\n\n> What makes the code a bit more complex is the fact, that the bytecode\n>\n> verifier also tries to verify if you are accessing restricted packages,\n>\n> therefore all access to restricted packages has to be done indirectly\n>\n> (that is also good for obfuscation, but here needed to make the exploit\n>\n> work, too). \u00a0~ Michael Schierl\n\nUpdate: Aug 28, 2012\n\n[Download it](http://www.mediafire.com/file/77f649zqu902xw6/Java7ZeroDay.zip)\n\nby\u00a0Michael Schierl\n\n[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQU3ATrL8b7pafGPuE27w4-URGanCPKadMjmIsqm-GsTRfFoLUwKLwEViJr0dEpCbBlCh4d2Nudtjsq-VZW78TRdx8r35DBpUQgcPLFre1ti6itct247oyc_Lq2DFleGbXXpDqvXZX8C1S/s640/jj.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQU3ATrL8b7pafGPuE27w4-URGanCPKadMjmIsqm-GsTRfFoLUwKLwEViJr0dEpCbBlCh4d2Nudtjsq-VZW78TRdx8r35DBpUQgcPLFre1ti6itct247oyc_Lq2DFleGbXXpDqvXZX8C1S/s1600/jj.png)\n\n**Read Part I \u00a0[Java 7 0-Day vulnerability information and mitigation.](http://www.deependresearch.org/2012/08/java-7-0-day-vulnerability-information.html)**\n\n**More details :**\n\n[Aug. 28 More detailed analysis > \"Immunity. Java 0day analysis (CVE-2012-4681) by Esteban\"](http://immunityproducts.blogspot.com/2012/08/java-0day-analysis-cve-2012-4681.html)\n\n[Aug. 28](http://www.kahusecurity.com/2012/java-0-day-using-latest-dadongs-js-obfuscator/)[Java 0-Day Using Latest Dadongâ€™s JS Obfuscator by Kahu Security](http://www.kahusecurity.com/2012/java-0-day-using-latest-dadongs-js-obfuscator/)\n\n[Aug. 28 US CERT: We are currently unaware of a practical solution to this problem. Disable Java in your browser](http://www.kb.cert.org/vuls/id/636312)\n\n**[CLICK HERE TO SEE IF YOU ARE VULNERABLE](http://zulu.zscaler.com/research/java_version.html)\u00a0(Zscaler)**\n\nThe Zscaler tool checks the version of Java used by your browser. If it is below 1.7\_7, you need to update it from Java.com. If it is 1.7\_ 7 already, you are safe (for now). As of Aug 31, 2012, the Zscaler checker prints \"vulnerable for 0-day\" for a ALL versions above 1.6, they just need to update the tool. In reality, if you have the latest version of Java, you are not vulnerable to this exploit.\n\nIn general, you don't need Java plug-ins in browser, best to keep it turned off. You can still use Java desktop apps.\n\n**[Andre' M. DiMino](http://sempersecurus.blogspot.com/)\u00a0and\u00a0[Mila Parkour](http://contagiodump.blogspot.com/)**\n\nPosted by\nMila Parkour\n\nat\n[12:14\u202fPM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html \"permanent link\")\n\n[![](http://img1.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/74827929652568895/6090221824778783255 \"Email Post\")\n\n[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=74827929652568895&postID=6090221824778783255&from=pencil \"Edit Post\")\n\n[Email This](https://www.blogger.com/share-post.g?blogID=74827929652568895&postID=6090221824778783255&target=email \"Email This\")[BlogThis!](https://www.blogger.com/share-post.g?blogID=74827929652568895&postID=6090221824778783255&target=blog \"BlogThis!\")[Share to X](https://www.blogger.com/share-post.g?blogID=74827929652568895&postID=6090221824778783255&target=twitter \"Share to X\")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=74827929652568895&postID=6090221824778783255&target=facebook \"Share to Facebook\")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=74827929652568895&postID=6090221824778783255&target=pinterest \"Share to Pinterest\")\n\nLabels:\n[Java](http://www.deependresearch.org/search/label/Java)\n\n#### 12 comments:\n\n1.  ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 28, 2012 at 5:33\u202fPM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346189585649#c6343169802682399047)\n\n   The original 'index.html', applet.jar, and exe files are still on the server.\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=6343169802682399047)Replies\n   Reply\n2.  ![](//www.blogger.com/img/blogger_logo_round_35.png)[Knevah](https://www.blogger.com/profile/12822397683113682698)[August 29, 2012 at 4:32\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346229135773#c5244830816270255757)\n\n   Is this exploit effective against Icedtea, and other Linux platforms?\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=5244830816270255757)Replies\n   Reply\n3.  ![](//www.blogger.com/img/blogger_logo_round_35.png)[kjjaeger](https://www.blogger.com/profile/02419270894670907183)[August 29, 2012 at 7:30\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346239815695#c1022488822358445332)\n\n   error: package com.sun.beans.finder does not exist\n   import com.sun.beans.finder.ClassFinder;\n    ^\n   Java7ZeroDay.java:16: error: cannot find symbol\n   Class sun\_awt\_SunToolkit = ClassFinder.findClass(\"sun.awt.SunToolkit\");\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=1022488822358445332)Replies\n   - ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 29, 2012 at 11:08\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346252921795#c2858742026989388378)\n\n     Use this code instead: http://pastie.org/4594319\n\n     [Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=2858742026989388378)Replies\n     Reply\n   Reply\n4.  ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 29, 2012 at 10:20\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346250051496#c1871362604323865950)\n\n   Demo video exploiting the vulnerability using Chrome on Windows 7: http://youtu.be/HO4yO7\_5sEc?hd=1\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=1871362604323865950)Replies\n   Reply\n5.  ![](//www.blogger.com/img/blogger_logo_round_35.png)[gabor.AUTH](https://www.blogger.com/profile/17875291824833901437)[August 29, 2012 at 1:20\u202fPM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346260855897#c2223911314580957913)\n\n   I think, the OpenJDK6 (update 25) is vulnerable too, because it contains the ClassFinder (backported from JDK7)...\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=2223911314580957913)Replies\n   Reply\n6.  ![](//resources.blogblog.com/img/blank.gif)Antti[August 30, 2012 at 12:03\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346299435327#c3471627886460740819)\n\n   There's no info anywhere whether this works with limited user accounts (not UAC but LUA). If the exploit can not get elevated access, it can not drop anything to system folders. I would have but could not test this, because my employers firewall blocked metasploit. I'll dl it at home and give it a go...\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=3471627886460740819)Replies\n   Reply\n7.  ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 30, 2012 at 7:55\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346327700865#c5983596418254167566)\n\n   IcedTea version 2.3.1 has been released. The changelog claims CVE-2012-4681 to be patched!\n   See http://mail.openjdk.java.net/pipermail/distro-pkg-dev/2012-August/020083.html\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=5983596418254167566)Replies\n   Reply\n8.  ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 31, 2012 at 2:30\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346394654493#c7781462815232919572)\n\n   According to the tester, version 1.7\_07 is also affected.\n   Installed it on a test client i got, and ran the test, and got that it's still affected, just a little typo in the tester, or is the 07 also vulnerable?\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=7781462815232919572)Replies\n   Reply\n9.  ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 31, 2012 at 9:12\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1346418744035#c1900682846343346998)\n\n   How do we use these tests?\n   How do we compile them?\n\n   I keep getting\n   Error: Main method not found in class cve2012xxxx.Gondvv\n   when I try to run it with java.exe\n\n   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=1900682846343346998)Replies\n   Reply\n10.  ![](//resources.blogblog.com/img/blank.gif)Sylvia Else[September 18, 2012 at 8:12\u202fAM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1347970363530#c1942832984356953683)\n\n    The problem wasn't really that there was a way of getting a reference to sun.awt.SunToolkit.class. After all, you can get a reference anyway, just by doing\n\n    Toolkit.getDefaultToolkit().getClass().getSuperclass();\n\n    The real problem was the existence of a public static method getField that creates privileged Field accessor objects and releases them into the wild. Whoever perpetrated that was being incredibly naive. It appears that the method no longer exists.\n\n    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=1942832984356953683)Replies\n    Reply\n11.  ![](//resources.blogblog.com/img/blank.gif)Anonymous[October 23, 2012 at 4:19\u202fPM](http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html?showComment=1351023552674#c4367303490608496480)\n\n    Really trustworthy blog entry I have ever found.. Its also informative information. I will definitely bookmark this site for future reference. keep up the good work!\n    <http://www.surveytool.com/business-market-research/>\n\n    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=74827929652568895&postID=4367303490608496480)Replies\n    Reply\n\nAdd commentLoad more...\n\n[Newer Post](http://www.deependresearch.org/2012/10/blackhole-cridex-season-2-episode-1.html \"Newer Post\")\n\n[Older Post](http://www.deependresearch.org/2012/08/java-7-0-day-vulnerability-information.html \"Older Post\")\n\n[Home](http://www.deependresearch.org/)\n\nSubscribe to:\n[Post Comments (Atom)](http://www.deependresearch.org/feeds/6090221824778783255/comments/default)\n\n## Blog Archive\n\n*   [March](http://www.deependresearch.org/2021/03/) (1)\n*   [September](http://www.deependresearch.org/2018/09/) (1)\n*   [July](http://www.deependresearch.org/2018/07/) (1)\n*   [June](http://www.deependresearch.org/2018/06/) (1)\n*   [February](http://www.deependresearch.org/2018/02/) (1)\n*   [March](http://www.deependresearch.org/2017/03/) (1)\n*   [January](http://www.deependresearch.org/2017/01/) (1)\n*   [April](http://www.deependresearch.org/2016/04/) (1)\n*   [February](http://www.deependresearch.org/2015/02/) (2)\n*   [July](http://www.deependresearch.org/2014/07/) (1)\n*   [December](http://www.deependresearch.org/2013/12/) (1)\n*   [May](http://www.deependresearch.org/2013/05/) (1)\n*   [February](http://www.deependresearch.org/2013/02/) (2)\n*   [November](http://www.deependresearch.org/2012/11/) (1)\n*   [October](http://www.deependresearch.org/2012/10/) (1)\n*   [August](http://www.deependresearch.org/2012/08/) (3)\n*   [October](http://www.deependresearch.org/2011/10/) (2)\n\n## Categories\n\n*   [Alfa bank](http://www.deependresearch.org/search/label/Alfa%20bank)\n  (1)\n*   [Apple](http://www.deependresearch.org/search/label/Apple)\n  (2)\n*   [APT](http://www.deependresearch.org/search/label/APT)\n  (1)\n*   [BMarket](http://www.deependresearch.org/search/label/BMarket)\n  (1)\n*   [Botnet](http://www.deependresearch.org/search/label/Botnet)\n  (1)\n*   [Cyber Espionage](http://www.deependresearch.org/search/label/Cyber%20Espionage)\n  (1)\n*   [DDoS](http://www.deependresearch.org/search/label/DDoS)\n  (1)\n*   [Dirt Jumper](http://www.deependresearch.org/search/label/Dirt%20Jumper)\n  (1)\n*   [DNS](http://www.deependresearch.org/search/label/DNS)\n  (1)\n*   [exploits](http://www.deependresearch.org/search/label/exploits)\n  (1)\n*   [Fake Invoice](http://www.deependresearch.org/search/label/Fake%20Invoice)\n  (1)\n*   [HistoryIsOurFuture](http://www.deependresearch.org/search/label/HistoryIsOurFuture)\n  (1)\n*   [Hlux](http://www.deependresearch.org/search/label/Hlux)\n  (1)\n*   [HOARD](http://www.deependresearch.org/search/label/HOARD)\n  (1)\n*   [Indonesia](http://www.deependresearch.org/search/label/Indonesia)\n  (1)\n*   [Java](http://www.deependresearch.org/search/label/Java)\n  (2)\n*   [JBoss](http://www.deependresearch.org/search/label/JBoss)\n  (1)\n*   [Kelihos](http://www.deependresearch.org/search/label/Kelihos)\n  (1)\n*   [Nap](http://www.deependresearch.org/search/label/Nap)\n  (1)\n*   [Nepal](http://www.deependresearch.org/search/label/Nepal)\n  (1)\n*   [OpenSource](http://www.deependresearch.org/search/label/OpenSource)\n  (1)\n*   [PayPal](http://www.deependresearch.org/search/label/PayPal)\n  (2)\n*   [Phishing](http://www.deependresearch.org/search/label/Phishing)\n  (3)\n*   [ransomware](http://www.deependresearch.org/search/label/ransomware)\n  (2)\n*   [SideWinder](http://www.deependresearch.org/search/label/SideWinder)\n  (1)\n*   [SIEM](http://www.deependresearch.org/search/label/SIEM)\n  (1)\n*   [SlackerC0de](http://www.deependresearch.org/search/label/SlackerC0de)\n  (2)\n*   [Spam Community](http://www.deependresearch.org/search/label/Spam%20Community)\n  (1)\n*   [Spyware](http://www.deependresearch.org/search/label/Spyware)\n  (1)\n*   [Threat Feed](http://www.deependresearch.org/search/label/Threat%20Feed)\n  (1)\n*   [Threat Intelligence](http://www.deependresearch.org/search/label/Threat%20Intelligence)\n  (2)\n*   [ThreatIntelligence](http://www.deependresearch.org/search/label/ThreatIntelligence)\n  (1)\n*   [Trump](http://www.deependresearch.org/search/label/Trump)\n  (1)\n\n|  |  |\n| --- | --- |\n\n|  |  |\n| --- | --- |\n\nDeepEnd Research, Ltd. 2011. Powered by [Blogger](https://www.blogger.com).\n\n![Clicky](//in.getclicky.com/100816203ns.gif)\n",
      "relevance": "Relevant",
      "root_cause": "The vulnerability lies in the `com.sun.beans.finder.ClassFinder` class, which allows untrusted