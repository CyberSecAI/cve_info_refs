=== Content from www.kb.cert.org_7aacf3a2_20250124_183019.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#788478

## Webmin contains input validation vulnerabilities

#### Vulnerability Note VU#788478

Original Release Date: 2012-09-06 | Last Revised: 2014-08-15

---

### Overview

Webmin 1.580, and possibly earlier versions, has been reported to contain input validation vulnerabilities.

### Description

| The advisories from American Information Security Group report the following vulnerabilities.  [**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation - CVE-2012-2981***"An input validation flaw allows for authenticated users to execute arbitrary Perl statements, commands, or libraries by parsing any file provided."*[**CWE-77**](http://cwe.mitre.org/data/definitions/77.html)**:** **Improper Neutralization of Special Elements used in a Command** **- CVE-2012-2982***"An input validation flaw within /file/show.cgi allows for authenticated users to execute arbitrary system commands as a privileged user. Additionally, anyone with a previously established session can be made to execute arbitrary commands on the server by embedding the attack in HTML code–such as IMG SRC tags within HTML emails."*[**CWE-22**](http://cwe.mitre.org/data/definitions/22.html)**:** **Improper Limitation of a Pathname to a Restricted Directory** **- CVE-2012-2983***"A directory traversal flaw within edit\_html.cgi allows an attacker to view any file as user root."*Full details of each vulnerability are available in the American Information Security Group advisories linked in the References section. |
| --- |

### Impact

| An authenticated attacker may be able to execute arbitrary commands. |
| --- |

### Solution

| We are currently unaware of a practical solution to this problem. The vendor is aware of the vulnerabilities and has patches available in the development branch but an official version including the patches was not available at the time of publication. *Patch for CVE-2012-2981*<https://github.com/webmin/webmin/commit/ed7365064c189b8f136a9f952062249167d1bd9e>*Patch for CVE-2012-2982*<https://github.com/webmin/webmin/commit/1f1411fe7404ec3ac03e803cfa7e01515e71a213>*Patch for CVE-2012-2983*<https://github.com/webmin/webmin/commit/4cd7bad70e23e4e19be8ccf7b9f245445b2b3b80>Please consider the following workarounds. |
| --- |

| **Restrict access**As a general good security practice, only allow connections from trusted hosts and networks. Restricting access would prevent an attacker from accessing Webmin using stolen credentials from a blocked network location. |
| --- |

### Vendor Information

788478
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23788478/) to view vendors.**
### [Webmin](#JALR-8XUFZY) Affected

Notified:  July 10, 2012  Updated: September 05, 2012

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 8.5 | AV:N/AC:M/Au:S/C:C/I:C/A:C |
| Temporal | 6.9 | E:POC/RL:TF/RC:C |
| Environmental | 5.2 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.webmin.com/>
* <https://github.com/webmin/webmin/commit/ed7365064c189b8f136a9f952062249167d1bd9e>
* <https://github.com/webmin/webmin/commit/1f1411fe7404ec3ac03e803cfa7e01515e71a213>
* <https://github.com/webmin/webmin/commit/4cd7bad70e23e4e19be8ccf7b9f245445b2b3b80>
* <http://americaninfosec.com/research/index.html>
* <http://www.americaninfosec.com/research/dossiers/AISG-12-000.pdf>
* <http://www.americaninfosec.com/research/dossiers/AISG-12-001.pdf>
* <http://www.americaninfosec.com/research/dossiers/AISG-12-002.pdf>
### Acknowledgements

Thanks to the American Information Security Group for reporting this vulnerability.

This document was written by Jared Allar.

### Other Information

| **CVE IDs:** | [CVE-2012-2981](http://web.nvd.nist.gov/vuln/detail/CVE-2012-2981), [CVE-2012-2982](http://web.nvd.nist.gov/vuln/detail/CVE-2012-2982), [CVE-2012-2983](http://web.nvd.nist.gov/vuln/detail/CVE-2012-2983) |
| --- | --- |
| **Date Public:** | 2012-09-06 |
| **Date First Published:** | 2012-09-06 |
| **Date Last Updated:** | 2014-08-15 03:03 UTC |
| **Document Revision:** | 27 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.americaninfosec.com_bce27961_20250124_183018.html ===
AISG Vulnerability
Dossier

AISG-12-001

September 5, 2012

<dtrammell@americaninfosec.com>
http://www.americaninfosec.com/

CONFIDENTIAL

AISG Vulnerability Dossier: AISG-12-001

AISG-12-001 Webmin Privileged Remote and Client-Side Command Ex-

ecution

Vulnerability Class
Aﬀected Versions Tested
Aﬀected Versions Assumed
Unaﬀected Versions
Aﬀected Platforms Tested

Aﬀected Platforms Assumed

Vulnerability Information

Input Validation
1.580

1: x86-32 Ubuntu Linux 11.10
2: x86-32 Solaris 11.11
3: x86-64 Solaris 11.11
4: x86-32 FreeBSD 9.0
All Vendor-supported Linux
All Vendor-supported Solaris
All Vendor-supported BSD

Unaﬀected Platforms
Reliability Rating

Completely (100%)

Vulnerability Test Matrix

1.580

3
2
1
V V V

4
V

Exploit / Proof-of-Concept Information

1.580 on x86-32 Linux
1.580 on x86-32 Solaris 11.11
1.580 on x86-64 Solaris 11.11
1.580 on x86-32 FreeBSD 9.0
Remote
Client-Side via CSRF
Command Execution
root
Log entries*
Successful Authentication
Completely (100%)
Complete
Metasploit Exploit
Metasploit Exploit
HTTP request attack vector
Cross-site Request Forgery (CSRF) capable
Trigger and payload is embeddable within HTML

Supported Targets

Attack Vector

Exploitation Impact
Exploitation Context
Exploitation Indicators
Prerequisites
Reliability Rating
Development Status
Development Phase
Development Goal
Exploit Features

* Log entries in some cases based on attack vector.

September 5, 2012

Page 1 of 3

AISG Vulnerability Dossier: AISG-12-001

1 Overview

An input validation ﬂaw within /ﬁle/show.cgi allows for authenticated users to execute arbitrary system
commands as a privileged user. Additionally, anyone with a previously established session can be made
to execute arbitrary commands on the server by embedding the attack in HTML code–such as IMG SRC
tags within HTML emails.

2

Impact

Privileged arbitrary code execution as the root user is achievable by leveraging this vulnerability.

3 Technical Explanation

The CGI /ﬁle/show.cgi
statement.

is lacking validation for user generated input prior to its use in a Perl open()

show.cgi obtains the environment for PATH INFO from the URI passed by the user. This path info is
then assigned to variable “$p”, as shown in Code Excerpt 1.

Code Excerpt 1 show.cgi “$p” Variable
$p = $ENV{’PATH_INFO’};

For example, if a user attempts to browse to ://webminserver.dom.com/ﬁle/show.cgi/etc/passwd} the
environment for PATH INFO and variable “$p” becomes “/etc/passwd”. $p is then used without any
validation to open ﬁles for reading using the “two argument” method (ﬁlehandle + ﬁlename) to open
ﬁles. In this case, the code is as shown in Code Excerpt 2.

Code Excerpt 2 “$p” Variable Example
if (!open(FILE, $p)) {

Because Perl considers special characters to generally be valid characters, it is possible to pass characters
into show.cgi’s URI that cause arbitary commands to be executed.

For example, if a session with a valid sessionid requests the URL
“https://webminserver.dom.com/ﬁle/show.cgi/bin/echo|ls%20–la|”
the backend Webmin webserver would execute both “/bin/echo” and “ls -la”.

Additionally, because the code for show.cgi has the variable “$trust unknown refers” set to the value
of “1” (or true), as shown in Code Excerpt 3 the normal anti-CSRF techniques have been disabled for
this page. This allows an attacker to pass a specially crafted URL to a victim and if the victim has a
previously established session they would then execute the arbitrary commands within the context of their
session.

September 5, 2012

Page 2 of 3

AISG Vulnerability Dossier: AISG-12-001

Code Excerpt 3 “$trust unknown refers” Variable
$trust_unknown_referers = 1;

September 5, 2012

Page 3 of 3


