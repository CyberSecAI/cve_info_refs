=== Content from adamcaudill.com_7de2f4b9_20250125_010735.html ===

# [Adam Caudill](https://adamcaudill.com/)

*Security Leader, Researcher, Developer, Writer, & Photographer*

* [Home](https://adamcaudill.com/)
* [Blog](https://adamcaudill.com/blog/)
* [Research](https://adamcaudill.com/research/)
* [Speaking](https://adamcaudill.com/speaking/)
* [Photography](https://adamcaudill.com/photography/)
* [Writing](https://adamcaudill.com/writing/)
* [About](https://adamcaudill.com/about/)
# NeoInvoice Blind SQL Injection (CVE-2012-3477)

August 12, 2012
|
2 minute read
|
[Security Research](https://adamcaudill.com/categories/security-research)

[NeoInvoice](https://github.com/tlhunter/neoinvoice) is a multi-tenant open source invoicing system, that currently contains an unauthenticated blind SQL injection condition in `signup_check.php`. The input for the `value` field isn’t being properly sanitized, and is used in string concatenation to create the SQL query:

```
require_once("config.php");
if (isset($_GET['field']) && ($_GET['field'] == 'username' || $_GET['field'] == 'email')) {
    $field = $_GET['field'];
    $table = 'user';
    $taken = '0';
    $not_taken = '1';
} else if (isset($_GET['field']) && $_GET['field'] == 'coupon') {
    $field = 'name';
    $table = 'coupon';
    $taken = '1';
    $not_taken = '0';
} else {
    die("&lt;div class=\"error\"&gt;Invalid Field&lt;/div&gt;");
}
if (!isset($_GET['value'])) {
    die("&lt;div class=\"error\"&gt;Invalid Value&lt;/div&gt;");
}
$value = preg_replace("[^a-zA-Z0-9_.\-\*\/\+\, @]", "", $_GET['value']);
if ($value != $_GET['value']) {
    die("&lt;div class=\"error\"&gt;Invalid Value&lt;/div&gt;");
}
$connect = mysql_connect(MYSQL_HOSTNAME, MYSQL_USERNAME, MYSQL_PASSWORD);
if (!$connect) {
    die("&lt;div class=\"error\"&gt;" . mysql_error() . "&lt;/div&gt;");
}
$query = "SELECT $field FROM $table WHERE $field = '$value' LIMIT 1";
mysql_select_db(MYSQL_DATABASE, $connect);
$result = mysql_query($query, $connect);
if (mysql_num_rows($result)) {
    echo $taken;
} else {
    echo $not_taken;
}

```

Line #29 there is the key, by concatenating untrusted data into the SQL query, it has made SQL injection trivial. This vulnerability can be demonstrated with the following request:

`signup_check.php?field=username&value='+OR+SLEEP(5)+OR+'`

This results in the following query being executed:

`SELECT username FROM user WHERE username = '' OR SLEEP(5) OR '' LIMIT 1`

The author has been notified, but has yet to respond. Based on the one open [ticket](https://github.com/tlhunter/neoinvoice/issues/2) for the project, there’s likely other possible attack vectors.

Adam Caudill

* [Decrypting Spark Saved Passwords](https://adamcaudill.com/2012/07/27/decrypting-spark-saved-passwords/)
* [WordPress: Don’t trust that update](https://adamcaudill.com/2012/09/06/wordpress-dont-trust-that-update/)
#### About Me

![](https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=500)

Security researcher, engineer and software developer with more than 20 years of experience.

*Work:* I primarily focus on application security, usable security, secure communications, and cryptography. I build and lead strong and dynamic teams, who cover all facets of security and privacy.

*Writing:* I write about my research, security in general, development and software design, and leadership through my [blog](https://adamcaudill.com/blog/), [essays](https://adamcaudill.com/essays/), and various publications.
I also engage in some [creating writing](https://adamcaudill.com/writing/) when I can.

*Photography:* I am a purist fine art photographer, working primarily in black & white, and focused on sharing [new perspectives](https://photo.adamcaudill.com/perspective) of the world.
Limited edition prints of my work are available on my [online gallery](https://adamcaudill.pictorem.com/).
I also have a background in photojournalism, and volunteer in this field when I can.

[Contact](https://adamcaudill.com/contact/)

##### Disclaimer

Opinions expressed here are solely those of Adam Caudill, and do not represent the views of his employer, or any other person or entity.

##### Contact & Media

If you have any questions, please feel free to [contact me](https://adamcaudill.com/pgp/), I will try to respond as quickly as possible.

##### Copyright

Copyright © 2003 - 2024 Adam Caudill.



=== Content from github.com_53a8743a_20250125_010736.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftlhunter%2Fneoinvoice%2Fissues%2F2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftlhunter%2Fneoinvoice%2Fissues%2F2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=tlhunter%2Fneoinvoice)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jul 31, 2019. It is now read-only.

[tlhunter](/tlhunter)
/
**[neoinvoice](/tlhunter/neoinvoice)**
Public archive

* [Notifications](/login?return_to=%2Ftlhunter%2Fneoinvoice) You must be signed in to change notification settings
* [Fork
  104](/login?return_to=%2Ftlhunter%2Fneoinvoice)
* [Star
   385](/login?return_to=%2Ftlhunter%2Fneoinvoice)

* [Code](/tlhunter/neoinvoice)
* [Issues
  2](/tlhunter/neoinvoice/issues)
* [Pull requests
  0](/tlhunter/neoinvoice/pulls)
* [Actions](/tlhunter/neoinvoice/actions)
* [Projects
  0](/tlhunter/neoinvoice/projects)
* [Wiki](/tlhunter/neoinvoice/wiki)
* [Security](/tlhunter/neoinvoice/security)
* [Insights](/tlhunter/neoinvoice/pulse)

Additional navigation options

* [Code](/tlhunter/neoinvoice)
* [Issues](/tlhunter/neoinvoice/issues)
* [Pull requests](/tlhunter/neoinvoice/pulls)
* [Actions](/tlhunter/neoinvoice/actions)
* [Projects](/tlhunter/neoinvoice/projects)
* [Wiki](/tlhunter/neoinvoice/wiki)
* [Security](/tlhunter/neoinvoice/security)
* [Insights](/tlhunter/neoinvoice/pulse)

This repository has been archived by the owner on Jul 31, 2019. It is now read-only.

# SQL injection #2

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkOpen[#3](https://github.com/tlhunter/neoinvoice/pull/3)Open[SQL injection](#top)#2[#3](https://github.com/tlhunter/neoinvoice/pull/3)Copy linkLabels[bug](https://github.com/tlhunter/neoinvoice/issues?q=state%3Aopen%20label%3A%22bug%22)[![@tlhunter](https://avatars.githubusercontent.com/u/551402?u=d842f570fd6f31b539c83fe967827fae712913bb&v=4&size=80)](/tlhunter)
## Description

[![@tlhunter](https://avatars.githubusercontent.com/u/551402?u=d842f570fd6f31b539c83fe967827fae712913bb&v=4&size=48)](/tlhunter)[tlhunter](https://github.com/tlhunter)opened [on Jun 19, 2012](https://github.com/tlhunter/neoinvoice/issues/2#issue-5138751)

Column sorting variables should use a switch statement to make sure they're valid.

Just skimming, and e.g.

in: controllers/invoice.php

$data['invoices'] = $this->invoice\_model->select\_multiple($this->session->userdata('company\_id'), $page, $this->pref\_user['per\_page'], TRUE, $sort\_col);

$sort\_col appears to be just uri\_segment 2 of list\_items.

select\_multiple() then calls:

$sql = "SELECT id, name, DATEDIFF(NOW(), duedate) AS past\_due FROM invoice WHERE company\_id = " . $this->db->escape($company\_id) . " ORDER BY $sort\_col";

$sort\_col is left as-is. It is certainly more difficult, since '()' aren't permitted in the uri, and we're already in the ORDER BY clause, but I think it may still be doable to get some blindsql into there.

--mmmooo

## Metadata

### Assignees

No one assigned

### Labels

[bug](https://github.com/tlhunter/neoinvoice/issues?q=state%3Aopen%20label%3A%22bug%22)
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


