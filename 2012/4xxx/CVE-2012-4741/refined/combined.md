=== Content from www.packetfence.org_0c91c3a9_20250125_162735.html ===

![PacketFence](/img/packetfence-logo.png)Bug Tracking System

| Anonymous | [Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D1390) | 2025-01-25 11:27 EST | [RSS](https://www.packetfence.org/bugs/issues_rss.php) |
| --- | --- | --- |

| [Main](/bugs/main_page.php) | [My View](/bugs/my_view_page.php) | [View Issues](/bugs/view_all_bug_page.php) | [Change Log](/bugs/changelog_page.php) | [Roadmap](/bugs/roadmap_page.php) |  |
| --- | --- |

| View Issue Details [ [Jump to Notes](#bugnotes) ] | | | | [ [Issue History](view.php?id=1390&history=1#history) ] [ [Print](print_bug_page.php?bug_id=1390) ] | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| 0001390 | PacketFence | security | public | 2012-03-02 10:28 | 2012-04-18 10:00 |
|  | | | | | |
| Reporter | obilodeau |  | | | |
| Assigned To | fgaudreault |  | | | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Platform |  | OS |  | OS Version |  |
| Product Version |  |  | | | |
| Target Version | 3.3.0 | Fixed in Version | 3.3.0 |  | |
|  | | | | | |
| Summary | 0001390: RADIUS Identity misuse | | | | |
| Description | The User-Name RADIUS attribute forwarded in PacketFence's core is not the same as the one used for authentication. This could lead in stealing higher network access privileges through identity spoofing.  This is not exploitable by default as we do not rely on the User-Name for anything by default.  Only users with custom VLAN assignment extension (pf::vlan::custom) and using the $user\_name parameter to assign network privileges are affected.  Details:  Our RADIUS extension runs in RADIUS' outer-tunnel after successful authentication. Outer-tunnel identity is client-side controllable and can be different than the Inner-tunnel identity. The inner-tunnel identity is the one used to perform the authentication and only a success or failure is sent to our RADIUS extension.  This possible mismatch between what is sent in the inner vs the outer is the vulnerability: I can successfully authenticate as a low-privileged user but set a high privileged user as my outer identity. The PacketFence RADIUS module is told that authentication passed and applies network access enforcement based on the outer identity (which was spoofed to the highly privileged user).  Reported by Rich Graves from Carleton College. | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
| fixed in git revision |  | | | | |
| fixed in mtn revision | 3bf62dc6d344cd057285a2741f3cd9804aeaaadc | | | | |
|  | | | | | |
| Attached Files |  | | | | |
| |  |  |  | | --- | --- | --- | | | | | | |

| - Relationships | |
| --- | --- |
|  | |

| + Relationships |
| --- |

| -  Notes | |
| --- | --- |
| ([0002597)](view.php?id=1390#c2597 "Direct link to note") [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) (reporter)  2012-03-02 10:28 | We discussed this internally and we have a fix on the way. |
|  | |
| ([0002598)](view.php?id=1390#c2598 "Direct link to note") fgaudreault (viewer)  2012-03-05 10:10 | packetfence site post-auth should look like : post-auth {         exec         if (!EAP-Message) {             packetfence         }         Post-Auth-Type REJECT {                 attr\_filter.access\_reject         } }  This permits non-EAP to exec the perl module while in post-auth, but it won't be exec if doing EAP.  In the packetfence-tunnel, post-auth should look like : post-auth {         exec     packetfence         Post-Auth-Type REJECT {                 attr\_filter.access\_reject         } } |
|  | |
| ([0002599)](view.php?id=1390#c2599 "Direct link to note") fgaudreault (viewer)  2012-03-05 10:14 | Crap, my last answer poses potential problems for devices that are doing EAP mac authentication (Juniper) :S I don't want to check the user-name since using identity privacy, you could spoof a mac address as the username.  Will continue working on it. |
|  | |
| ([0002603)](view.php?id=1390#c2603 "Direct link to note") fgaudreault (viewer)  2012-03-06 17:47 | We should do in : - packetfence site: if (!EAP-Type || (EAP-Type != 21 && EAP-Type != 25)) {             packetfence         }  - packetfence-tunnel: post-auth {         exec     packetfence         Post-Auth-Type REJECT {                 attr\_filter.access\_reject         } } |
|  | |
| ([0002613)](view.php?id=1390#c2613 "Direct link to note") fgaudreault (viewer)  2012-03-12 13:53 | Fixed in devel. |
|  | |
| ([0002658)](view.php?id=1390#c2658 "Direct link to note") [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) (reporter)  2012-04-18 09:59 | fix released in 3.3.0 last friday |
|  | |

| +  Notes | |
| --- | --- |

| - Issue History | | | |
| --- | --- | --- | --- |
| Date Modified | Username | Field | Change |
| 2012-03-02 10:28 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | New Issue |  |
| 2012-03-02 10:28 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Status | new => assigned |
| 2012-03-02 10:28 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Assigned To | => fgaudreault |
| 2012-03-02 10:28 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Note Added: 0002597 |  |
| 2012-03-02 10:49 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Description Updated |  |
| 2012-03-02 13:09 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Description Updated |  |
| 2012-03-05 10:10 | fgaudreault | Note Added: 0002598 |  |
| 2012-03-05 10:14 | fgaudreault | Note Added: 0002599 |  |
| 2012-03-06 17:47 | fgaudreault | Note Added: 0002603 |  |
| 2012-03-12 13:53 | fgaudreault | mtn revision | => 3bf62dc6d344cd057285a2741f3cd9804aeaaadc |
| 2012-03-12 13:53 | fgaudreault | Note Added: 0002613 |  |
| 2012-03-12 13:53 | fgaudreault | Status | assigned => resolved |
| 2012-03-12 13:53 | fgaudreault | Fixed in Version | => trunk |
| 2012-03-12 13:53 | fgaudreault | Resolution | open => fixed |
| 2012-04-18 09:49 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Target Version | +1 => 3.3.0 |
| 2012-04-18 09:50 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | View Status | private => public |
| 2012-04-18 09:50 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Fixed in Version | trunk => 3.3.0 |
| 2012-04-18 09:59 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Note Added: 0002658 |  |
| 2012-04-18 10:00 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Status | resolved => closed |

| + Issue History | | | |
| --- | --- | --- | --- |

---

| Copyright © 2000 - 2012 MantisBT Group | [Powered by Mantis Bugtracker](http://www.mantisbt.org "Free Web Based Bug Tracker") |
| --- | --- |


