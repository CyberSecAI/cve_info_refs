=== Content from www-01.ibm.com_077b0b32_20250125_013153.html ===


[IBM Support](https://www.ibm.com/mysupport/)

##

No results were found for your search query.

---

##### **Tips**

To return expected results, you can:

* **Reduce the number of search terms.** Each term you use focuses the search further.
* **Check your spelling.** A single misspelled or incorrectly typed term can change your result.
* **Try substituting synonyms for your original terms.** For example, instead of searching for "java classes", try "java training"
* **Did you search for an IBM acquired or sold product ?** If so, follow the appropriate link below to find the content you need.

Our apologies

Search results are not available at this time. Please try again later or use one of the other support options on this page.

# Security Bulletin: Two unauthorized access vulnerabilities in IBM TSM for Space Management (CVE-2012-4859 and CVE-2012-5954).

### Flashes (Alerts)

## Abstract

Unauthorized access vulnerabilities exist in IBM Tivoli Storage Manager (TSM) for Space Management (HSM)

## Content

**VULNERABILITY DETAILS:**

**CVE ID: CVE-2012-4859**

**Description:** A local unauthorized malicious user can access and manipulate all file system objects on affected systems. Internal APAR [IC87006](http://www.ibm.com/support/docview.wss?uid=swg1IC87006) was opened for this vulnerability.

Using the Common Vulnerability Scoring System (CVSS) v2, the security rating for this issue is:

CVSS Base Score: 7.2

CVSS Temporal Score: See <https://exchange.xforce.ibmcloud.com/vulnerabilities/79843> for the current score

CVSS Environmental Score\*: Undefined

CVSS Vector: (AV:L/AC:L/Au:N/C:C/I:C/A:C)

**CVE ID: CVE-2012-5954**

**Description:** A remote unauthorized malicious user can access and manipulate all file system objects managed by TSM HSM on affected systems. Other file system objects cannot be accessed by the user on those systems. Internal APAR [IC86724](http://www.ibm.com/support/docview.wss?uid=swg1IC86724) was opened for this vulnerability.

Using the Common Vulnerability Scoring System (CVSS) v2, the security rating for this issue is:

CVSS Base Score: 6.4

CVSS Temporal Score: See <https://exchange.xforce.ibmcloud.com/vulnerabilities/80668> for the current score

CVSS Environmental Score\*: Undefined

CVSS Vector: (AV:N/AC:L/Au:N/C:P/I:P/A:N)

**AFFECTED PRODUCTS AND VERSIONS:**

IBM Tivoli Storage Manager for Space Management supported versions 5.5 through 6.3, and unsupported versions prior to 5.5. HSM 6.4 is unaffected.

**REMEDIATION:**

Apply the fixing versions of HSM when available (see table below), and use the Mitigation until the fixes can be applied. Customers using HSM versions prior to 6.2 must upgrade to the newer fixed versions of HSM, or use the mitigation below.

With the fixes or mitigation, execution of the following HSM commands by non-root users will no longer be possible:

* dsmdf
* dsmdu
* dsmls
* dsmmigfs
* dsmmigrate
* dsmrecall

| **HSM Release** | **HSM Vulnerable Levels** | **Fixing HSM Level** |
| --- | --- | --- |
| 6.3 | 6.3.0.0 through 6.3.0.17 | [6.3.1.0](http://www.ibm.com/support/docview.wss?uid=swg24034114) |
| 6.2 | 6.2.0.0 through 6.2.4.4 | [6.2.5.0](http://www.ibm.com/support/docview.wss?uid=swg24034630) |
| 6.1 | all | Upgrade to fixing 6.3 client, or 6.4, or use Mitigation |
| 5.5 | all | Upgrade to fixing 6.3 client, or 6.4, or use Mitigation |
| prior unsupported releases | all | Upgrade to fixing 6.3 client, or 6.4, or use Mitigation |

Note: HSM 6.4 is unaffected, and does not allow the execution of HSM commands by non-root users.

**MITIGATION:**

The non-root support provided by the dsmrootd binary must be disabled in order to mitigate these vulnerabilities. As a result, execution of the HSM commands listed under the Remediation section by non-root users will no longer be possible with this mitigation.

The following procedures must be executed as *root* user.

**AIX and Linux platforms with HSM managed GPFS**

On machines where HSM is installed to manage GPFS, the dsmrootd must be replaced.

1. Disable failover

Invoke the command

dsmmigfs disablefailover

2. Stop the dsmrootd process

Invoke the command

kill -SIGTERM <dsmrootd\_pid>

Replace <dsmrootd\_pid> with the *process id* of the *dsmrootd*

3. Delete the dsmrootd file

On AIX this file is located in /usr/tivoli/tsm/client/hsm/bin on Linux this file is located in /opt/tivoli/tsm/client/hsm/bin.

4. Replace the dsmrootd file with a shell script named dsmrootd.

The script has the following content:

#!/bin/sh

exit\_with\_grace()

{

 exit 0

}

if [ "x$1" != "x--" ]; then

 $0 -- 1> /dev/null 2> /dev/null &

 exit 0

fi

trap "exit\_with\_grace" USR1 TERM QUIT

while true; do

 sleep 5;

done

The script must be owned by the root user and the execution permission must be set for the root user. To achieve this invoke the following commands:

chmod u+x /<path>/tivoli/tsm/client/hsm/bin/dsmrootd

chown root /<path>/tivoli/tsm/client/hsm/bin/dsmrootd

replace here <path> with either *opt* or *usr*.

On AIX for example execute

chmod u+x/usr/tivoli/tsm/client/hsm/bin/dsmrootd

chown root /usr/tivoli/tsm/client/hsm/bin/dsmrootd

5. Enable failover

Invoke the command

dsmmigfs enablefailover

**Other platforms**

On machines where JFS2 or VxFS file systems are HSM managed the dsmrootd binary must be removed.

1. Stop the dsmrootd process

Invoke the command

kill -SIGTERM <dsmrootd\_pid>

Replace <dsmrootd\_pid> with the *process id* of the *dsmrootd*

2. Remove the dsmrootd file.

On AIX JFS2 this file is located in /usr/tivoli/tsm/client/hsm/bin, on HP-UX and Solaris Sparc this file is located in /opt/tivoli/tsm/client/hsm/bin.

**OPTIONAL ACTIONS:**

**All platforms**

In order to prevent the commands listed in the Remediation section from hanging when non-root users try to execute them, remove the execution permission bit for others (o) from the corresponding files located in /usr/tivoli/tsm/client/hsm/bin in case of AIX or in /opt/tivoli/tsm/client/hsm/bin for other platforms.

The execution permission is removed with the following command:

chmod o-x /<path>/tivoli/tsm/client/hsm/bin/<file\_name>

replace here <path> with the appropriate path and <file\_name> with either one commands listed above or simply specify asterisk "\*" for all files.

For example on Linux execute either

chmod o-x/opt/tivoli/tsm/client/hsm/bin/dsmdf

or

chmod o-x/opt/tivoli/tsm/client/hsm/bin/\*

These vulnerabilities were found internally by IBM.

**REFERENCES:**

* [Complete CVSS Guide](https://www.first.org/cvss/v2/guide)
* [*On-line Calculator V2*](http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2)
* CVE-2012-4859
* CVE-2012-5954
* X-Force Vulnerability Database: <https://exchange.xforce.ibmcloud.com/vulnerabilities/79843>
* X-Force Vulnerability Database: <https://exchange.xforce.ibmcloud.com/vulnerabilities/80668>

**CHANGE HISTORY:**

18 December 2012: Original Copy Published

*\*The CVSS Environment Score is customer environment specific and will ultimately impact the Overall CVSS Score. Customers can evaluate the impact of this vulnerability in their environments by accessing the links in the Reference section of this Flash.*

***Note:*** *According to the Forum of Incident Response and Security Teams (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry open standard designed to convey vulnerability severity and help to determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY VULNERABILITY.*

[{"Product":{"code":"SSSR2R","label":"Tivoli Storage Manager for Space Management"},"Business Unit":{"code":"BU058","label":"IBM Infrastructure w\/TPS"},"Component":"--","Platform":[{"code":"PF002","label":"AIX"},{"code":"PF010","label":"HP-UX"},{"code":"PF027","label":"Solaris"},{"code":"PF016","label":"Linux"}],"Version":"5.4;5.5;6.1;6.2;6.3","Edition":"","Line of Business":{"code":"LOB26","label":"Storage"}}]

## Was this topic helpful?

### Document Information

**Modified date:**

26 September 2022

## UID

swg21615292

Page Feedback

## Share your feedback

### Need support?

* Submit feedback to IBM Support
* 1-800-IBM-7378 (**USA**)
* [Directory of worldwide contacts](//www.ibm.com/planetwide/index.html#region)



=== Content from www-01.ibm.com_3164f2bf_20250125_013137.html ===


[IBM Support](https://www.ibm.com/mysupport/)

##

No results were found for your search query.

---

##### **Tips**

To return expected results, you can:

* **Reduce the number of search terms.** Each term you use focuses the search further.
* **Check your spelling.** A single misspelled or incorrectly typed term can change your result.
* **Try substituting synonyms for your original terms.** For example, instead of searching for "java classes", try "java training"
* **Did you search for an IBM acquired or sold product ?** If so, follow the appropriate link below to find the content you need.

Our apologies

Search results are not available at this time. Please try again later or use one of the other support options on this page.

# IC87006: TSM FOR SPACE MANAGEMENT UNAUTHORIZED ACCESS BY NON-ROOT USER

## A fix is available

[IBM Tivoli Storage Manager (TSM) Client 6.2.5 Downloads and READMEs](https://www.ibm.com/support/pages/node/313369)

## Subscribe

You can track all active APARs for this component.

##

## APAR status

* ### Closed as program error.

## Error description

* ```
  An unauthorized access vulnerability in TSM for Space Management
  (HSM) enables local attackers to read, modify or even delete all
  files in all mounted file systems.
  .
  All HSM platforms are affected:
  AIX with GPFS or JFS2, Linux, Solaris Sparc and HP-UX.
  .
  The following HSM versions are affected:
  6.3, 6.2, 6.1, 5.5 and 5.4
  .
  The affected binary is the dsmrootd on AIX located in
  /usr/tivoli/tsm/client/hsm/bin or
  /opt/tivoli/tsm/client/hsm/bin in case of Linux, Solaris or
  HP-UX.
  .
  IBM's assessment of the base Common Vulnerability Scoring System
  (CVSS) score for this vulnerability is 7.2.

  ```

## Local fix

* ```
  When GPFS is spacemanaged the dsmrootd binary must be replaced
  by a script which runs as a background process upon start.
  When JFS2 or VxFS is spacemanaged the dsmrootd binary must be
  deleted. A script which replaces the dsmrootd is not required in
  the latter case.
  .
  For detailed instructions how to solve this security problem
  read the flash document available here
  <http://www.ibm.com/support/docview.wss?uid=swg21615292>

  ```

## Problem summary

* ```
  ****************************************************************
  * USERS AFFECTED: HSM versions 6.3, 6.2, 6.1, 5.5 and 5.4 on   *
  * AIX and Linux platforms. HSM versions 6.1, 5.5 and 5.4 on    *
  * Solaris and HP-UX.                                           *
  ****************************************************************
  * PROBLEM DESCRIPTION: See ERROR DESCRIPTION.                  *
  ****************************************************************
  * RECOMMENDATION: Follow the instructions described here       *
  * http://www.ibm.com/support/docview.wss?uid=swg21615292 until *
  * fixing levels are available. The problem is currently        *
  * projected to be fixed in levels 6.3.1 and 6.2.5.             *
  * Note that until these levels are available, this             *
  * information is subject to change at the discretion of IBM.   *
  ****************************************************************

  ```

## Problem conclusion

* ```
  The problem has been fixed so that it no longer occurs. The
  dsmrootd has been removed. HSM command execution by non-root
  users has been disabled. HSM 6.4.0 is not affected. The
  dsmrootd will be removed later with 6.4.1.

  ```

## Temporary fix

## Comments

## APAR Information

* ### APAR number

  IC87006
* ### Reported component name

  TSM SPACE MGMT
* ### Reported component ID

  5698HSMCL
* ### Reported release

  63L
* ### Status

  CLOSED PER
* ### PE

  NoPE
* ### HIPER

  NoHIPER
* ### Special Attention

  NoSpecatt
* ### Submitted date

  2012-10-04
* ### Closed date

  2012-12-14
* ### Last modified date

  2012-12-19

* ### APAR is sysrouted FROM one or more of the following:
* ### APAR is sysrouted TO one or more of the following:

## Fix information

* ### Fixed component name

  TSM SPACE MGMT
* ### Fixed component ID

  5698HSMCL

## Applicable component levels

* ### R63A PSY

  UP
* ### R63L PSY

  UP
* ### R64A PSY

  UP
* ### R64L PSY

  UP

[{"Line of Business":{"code":"LOB26","label":"Storage"},"Business Unit":{"code":"BU058","label":"IBM Infrastructure w\/TPS"},"Product":{"code":"SSSR2R","label":"Tivoli Storage Manager for Space Management"},"Platform":[{"code":"PF025","label":"Platform Independent"}],"Version":"6.3"}]

### Document Information

**Modified date:**

19 September 2021

Page Feedback

## Share your feedback

### Need support?

* Submit feedback to IBM Support
* 1-800-IBM-7378 (**USA**)
* [Directory of worldwide contacts](//www.ibm.com/planetwide/index.html#region)


