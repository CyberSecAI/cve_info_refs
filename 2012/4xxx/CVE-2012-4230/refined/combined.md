=== Content from packetstormsecurity.com_d8113d1c_20250124_131621.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_74f02ef6_20250124_131621.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](113)
[By Date](date.html#114)
[![Next](/images/right-icon-16x16.png)](115)

[![Previous](/images/left-icon-16x16.png)](113)
[By Thread](index.html#114)
[![Next](/images/right-icon-16x16.png)](115)

![](/shared/images/nst-icons.svg#search)

# XSS Vulnerability in TinyMCE

---

*From*: "Justin C. Klein Keane" <justin () madirish net>

*Date*: Mon, 11 Mar 2013 08:50:13 -0400

---

```
Vulnerability Report

Author: Justin C. Klein Keane <justin () madirish net>
Date: 5 March, 2013

CVE-2012-4230

Description of Vulnerability:
-----------------------------
"TinyMCE in itself can not be insecure"
(<http://www.tinymce.com/wiki.php/Security>)

"TinyMCE is a platform independent web based Javascript HTML WYSIWYG
editor control released as Open Source under LGPL by Moxiecode Systems
AB.  TinyMCE has the ability to convert HTML TEXTAREA fields or other
HTML elements to editor instances. TinyMCE is very easy to integrate
into other Content Management Systems." (<http://www.tinymce.com/>)
TinyMCE is widely utilized in a number of web application systems.

A cross site scripting (XSS), or arbitrary script injection,
vulnerability exists in TinyMCE due to the fact that the bbcode plugin
violates the explicit security policy of TinyMCE.  If the bbcode plugin
is enabled, but encoding is enabled using the "encoding" directive, or
sanitizing is enabled using the "valid_elements" attribute, these
mechanisms fail to function as expected.  According to the "encoding"
documentation:  "Posted content will be converted to an XML string
escaping characters such as <, >, ", and & to &lt;, &gt;, &quot;, and
&amp;." ([http://www.tinymce.com/wiki.php/Configuration:encoding](http://www.tinymce.com/wiki.php/Configuration%3Aencoding))
According to the "valid_elements" attribute documentation:
"valid_elements option defines which elements will remain in the edited
text when the editor saves. You can use this to limit the returned HTML
to a subset."
([http://www.tinymce.com/wiki.php/Configuration:valid_elements](http://www.tinymce.com/wiki.php/Configuration%3Avalid_elements))  However,
if the bbcode plugin is enabled these stated functions do not affect
content.

Systems affected:
-----------------
TinyMCE 3.5.8 was tested and found vulnerable using Chrome Version
25.0.1364.97.

Impact:
------
Systems using TinyMCE could erroneously assume a level of protection
against arbitrary script execution within the client side context of
TinyMCE.  This could allow attackers to misuse TinyMCE enabled
applications to carry out arbitrary script injection (XSS) attacks.
Victims could be subject to credential theft, client side attack, or
other dangerous condition.

Mitigating factors:
-------------------
The TinyMCE system must be configured to use the bbcode plugin (included
in TinyMCE).

Proof of Concept Exploit:
---------------------------------
Configuring a TinyMCE textarea using:

tinyMCE.init({
  mode : "textareas",
  encoding : "xml",
  plugins : "preview",
  theme_advanced_buttons1 : "preview,code",
  valid_elements : "br,strong",
});

will create the expected text area.  If a user types HTML tags directly
into the textarea then presses the 'Preview' button the HTML characters
are properly encoded and show up in the display.  Similarly, if the
'Code' button is pressed the pop up will show encoded HTML entities.

However, if the bbcode plugin is utilized then this behavior changes,
and HTML elements are not encoded, causing HTML tags to be rendered.

The explicit security policy of TinyMCE indicates that if the "encoding"
option is set then HTML entities will be encoded and if the
"valid_elements" option is set HTML elements will be removed, however,
the use of the bbcode plugin overrides this behavior, which could lead
to vulnerabilities in situations where a developer improperly assumed
that HTML would be encoded by the TinyMCE editor.

Steps to Reproduce:
-------------------
Install TinyMCE and create a textarea with the following init:

tinyMCE.init({
  mode : "textareas",
  encoding : "xml",
  plugins : "preview",
  theme_advanced_buttons1 : "preview,code",
  valid_elements : "br,strong",
});

Load the page containing the textarea in a browser and enter the text
"<b>test</b>" then click the HTML Source Editor button and note that the
HTML entities are encoded showing "&lt;b&gt;test&lt;/b&gt;".  Next
change the init to the following:

tinyMCE.init({
  mode : "textareas",
  encoding : "xml",
  plugins : "bbcode,preview",
  theme_advanced_buttons1 : "preview,code",
  valid_elements : "br,strong",
});

Type "<b>test</b>" into the textarea and again, click the HTML Source
Editor button.  Note that the HTML entities have not been encoded.  This
test can be run using the text "<script>alert('xss');</script>" for a
more dramatic demonstration of the issue.

Credits:
--------
This issue was originally discovered by Zach Alexander

Vendor Response:
----------------
Vendor has been alerted to this vulnerability but does not consider it a
critical security issue and will look into mitigation at some future time.

--
Justin C. Klein Keane
<http://www.MadIrish.net>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

```

---

[![Previous](/images/left-icon-16x16.png)](113)
[By Date](date.html#114)
[![Next](/images/right-icon-16x16.png)](115)

[![Previous](/images/left-icon-16x16.png)](113)
[By Thread](index.html#114)
[![Next](/images/right-icon-16x16.png)](115)

### Current thread:

* **XSS Vulnerability in TinyMCE** *Justin C. Klein Keane (Mar 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.madirish.net_b45910a4_20250124_131622.html ===


# [Mad Irish . net](https://www.madirish.net)

* [about](https://www.madirish.net/about "About me")
* contact
* [rss](https://www.madirish.net/rss.php "RSS feed")
* [github](https://github.com/madirish "Work")
* [LAMPSecurity](https://sourceforge.net/projects/lampsecurity/ "CTF")

# XSS Vulnerability in TinyMCE

[disclosure](/tag/disclosure) [javascript](/tag/javascript) [xss](/tag/xss)
11 March 2013

Vulnerability Report

5 March, 2013

Author: Justin C. Klein Keane

CVE-2012-4230

#### Description of Vulnerability:

"TinyMCE in itself can not be insecure" ([http://www.tinymce.com/wiki.php/Security](http://www.tinymce.com/wiki.php/Security "Hubris?"))

"TinyMCE is a platform independent web based Javascript HTML WYSIWYG editor control released as Open Source under LGPL by Moxiecode Systems AB. TinyMCE has the ability to convert HTML TEXTAREA fields or other HTML elements to editor instances. TinyMCE is very easy to integrate into other Content Management Systems." (<http://www.tinymce.com/>) TinyMCE is widely utilized in a number of web application systems.

A cross site scripting (XSS), or arbitrary script injection, vulnerability exists in TinyMCE due to the fact that the bbcode plugin violates the explicit security policy of TinyMCE. If the bbcode plugin is enabled, but encoding is enabled using the "encoding" directive, or sanitizing is enabled using the "valid\_elements" attribute, these mechanisms fail to function as expected. According to the "encoding" documentation: "Posted content will be converted to an XML string escaping characters such as <, >, ", and & to <, >, ", and &." (http://www.tinymce.com/wiki.php/Configuration:encoding) According to the "valid\_elements" attribute documentation: "valid\_elements option defines which elements will remain in the edited text when the editor saves. You can use this to limit the returned HTML to a subset." (http://www.tinymce.com/wiki.php/Configuration:valid\_elements) However, if the bbcode plugin is enabled these stated functions do not affect content.

#### Systems affected:

TinyMCE 3.5.8 was tested and found vulnerable using Chrome Version 25.0.1364.97.

Impact:

Systems using TinyMCE could erroneously assume a level of protection against arbitrary script execution within the client side context of TinyMCE. This could allow attackers to misuse TinyMCE enabled applications to carry out arbitrary script injection (XSS) attacks. Victims could be subject to credential theft, client side attack, or other dangerous condition.

#### Mitigating factors:

The TinyMCE system must be configured to use the bbcode plugin (included in TinyMCE).

#### Proof of Concept Exploit:

Configuring a TinyMCE textarea using:

```

tinyMCE.init({
  mode : "textareas",
  encoding : "xml",
  plugins : "preview",
  theme_advanced_buttons1 : "preview,code",
  valid_elements : "br,strong",
});

```

will create the expected text area. If a user types HTML tags directly into the textarea then presses the 'Preview' button the HTML characters are properly encoded and show up in the display. Similarly, if the 'Code' button is pressed the pop up will show encoded HTML entities.

However, if the bbcode plugin is utilized then this behavior changes, and HTML elements are not encoded, causing HTML tags to be rendered.

The explicit security policy of TinyMCE indicates that if the "encoding" option is set then HTML entities will be encoded and if the "valid\_elements" option is set HTML elements will be removed, however, the use of the bbcode plugin overrides this behavior, which could lead to vulnerabilities in situations where a developer improperly assumed that HTML would be encoded by the TinyMCE editor.

#### Steps to Reproduce:

Install TinyMCE and create a textarea with the following init:

```

tinyMCE.init({
  mode : "textareas",
  encoding : "xml",
  plugins : "preview",
  theme_advanced_buttons1 : "preview,code",
  valid_elements : "br,strong",
});

```

Load the page containing the textarea in a browser and enter the text "<b>test</b>" then click the HTML Source Editor button and note that the HTML entities are encoded showing "<b>test</b>". Next change the init to the following:

```

tinyMCE.init({
  mode : "textareas",
  encoding : "xml",
  plugins : "bbcode,preview",
  theme_advanced_buttons1 : "preview,code",
  valid_elements : "br,strong",
});

```

Type "<b>test</b>" into the textarea and again, click the HTML Source Editor button. Note that the HTML entities have not been encoded. This test can be run using the text "<script>alert('xss');</script>" for a more dramatic demonstration of the issue.

#### Credits:

This issue was originally discovered by Zach Alexander.

### Tags

* [apple](/tag/apple)
* [arbitrary\_code\_execution](/tag/arbitrary_code_execution)
* [blue\_team](/tag/blue_team)
* [disclosure](/tag/disclosure)
* [drupal](/tag/drupal)
* [editorial](/tag/editorial)
* [encryption](/tag/encryption)
* [exploit](/tag/exploit)
* [feature](/tag/feature)
* [how\_to](/tag/how_to)
* [html5](/tag/html5)
* [ios](/tag/ios)
* [iot](/tag/iot)
* [javascript](/tag/javascript)
* [linux](/tag/linux)
* [malware](/tag/malware)
* [mysql](/tag/mysql)
* [network](/tag/network)
* [osx](/tag/osx)
* [pen\_test](/tag/pen_test)
* [php](/tag/php)
* [privacy](/tag/privacy)
* [purple\_team](/tag/purple_team)
* [random](/tag/random)
* [raspberry\_pi](/tag/raspberry_pi)
* [research](/tag/research)
* [review](/tag/review)
* [sql](/tag/sql)
* [sql\_injection](/tag/sql_injection)
* [threat\_intel](/tag/threat_intel)
* [tools](/tag/tools)
* [tutorial](/tag/tutorial)
* [vuln](/tag/vuln)
* [web\_application](/tag/web_application)
* [windows](/tag/windows)
* [xss](/tag/xss)

[Copyright](http://www.madirish.net/copyright "My copyright statement") © Justin C. Klein Keane. Unauthorized reproduction is a violation of US and international law.


