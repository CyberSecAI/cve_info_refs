```
{
  "vulnerability_details": {
    "root_cause": "A buffer overflow vulnerability exists in the `url::get_pac()` function of libproxy when downloading proxy.pac files. The function uses a fixed-size buffer to store the content of the downloaded file. However, when handling non-chunked encoding, it relies on the server-provided content length, rather than the buffer size, as the limit for data copied into the buffer. This leads to a stack-based buffer overflow if a malicious server provides a larger file than the buffer can hold.",
    "weaknesses": [
      "Buffer Overflow",
      "Insufficient Input Validation"
    ],
    "impact": "A remote attacker can trigger a stack-based buffer overflow. This can lead to application crashes or potentially the execution of arbitrary code on the affected system.",
    "attack_vectors": "A malicious host or a man-in-the-middle attacker can exploit this vulnerability by providing a specially crafted proxy.pac file with a larger size than the fixed buffer in libproxy.",
    "required_capabilities": "The attacker needs to be able to serve a proxy.pac file to a system using libproxy and have the system attempt to download it via HTTP. This can be done by controlling the host serving the proxy.pac file or by performing a man-in-the-middle attack."
  },
  "affected_products": [
    "openSUSE 12.2",
    "openSUSE 12.1",
    "openSUSE 11.4",
    "Ubuntu 12.04",
    "Ubuntu 11.10",
    "Ubuntu 10.04",
    "Red Hat Enterprise Linux 6",
    "Fedora 17"
  ],
    "references": [
        "http://support.novell.com/security/cve/CVE-2012-4504.html",
        "https://bugzilla.novell.com/784523",
        "https://access.redhat.com/security/cve/CVE-2012-4504",
        "https://code.google.com/p/libproxy/source/detail?r=853",
        "https://groups.google.com/forum/?fromgroups=#!topic/libproxy/VxZ8No7mT0E",
        "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-4504",
         "https://www.ubuntu.com/security/notices/USN-1629-1",
        "https://code.google.com/p/libproxy/source/browse/trunk/libproxy/url.cpp?r=846#462",
         "https://code.google.com/p/libproxy/source/detail?r=489",
        "https://code.google.com/p/libproxy/issues/detail?id=77"

    ]
}
```