=== Content from www.openwall.com_0019d053_20250125_134120.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120920033355.GA30232@cipherdyne.org>
Date: Wed, 19 Sep 2012 23:33:55 -0400
From: Michael Rash <mbr@...herdyne.org>
To: Kurt Seifried <kseifried@...hat.com>
Cc: oss-security@...ts.openwall.com, Jan Lieskovsky <jlieskov@...hat.com>,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Damien Stuart <dstuart@...uart.org>
Subject: Re: CVE Request -- fwknop 2.0.3: Multiple security
 issues

On Sep 19, 2012, Kurt Seifried wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> On 09/19/2012 12:10 PM, Jan Lieskovsky wrote:
> > Hello Kurt, Steve, vendors,
> >
> > multiple securit issues have been corrected in 2.0.3 upstream
> > version of fwknop
> > (<http://www.cipherdyne.org/blog/categories/software-releases.html>):
> >
> >
> -
> ---------------------------------------------------------------------------
> > 1) multiple DoS / code execution flaws: Upstream patch: [1]
> > <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=d46ba1c027a11e45821ba897a4928819bccc8f22>
>
> Ok
> >
> yeah this seems to be mostly changes related to char buf[32] to
> char buf[ACCESS_BUF_LEN], plus some logic cleanups (like making sure
> the port specified is larger than 0 and less than MAX_PORT). So I'll
> lump them all together rather than separate them.
>
> Please use CVE-2012-4434 for this issue.

Understood, thanks.

> > 2) server did not properly validate allow IP addresses from
> > malicious authenticated clients Upstream patch: [2]
> > <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=f4c16bc47fc24a96b63105556b62d61c1ba7d799>
>
> Stupid
> >
> question possibly (didn't look at the code apart from the fix).
> I see:
>
> if(char_ctr >= MAX_IPV4_STR_LEN)
>
> but nothing for IPv6 (does fwknopd even support ipv6?)... someone may
> want to check that.

fwknop does not yet support ipv6, but this is planned and will update
the check above to allow v6 addresses.

In terms of raw ipv4 validation, there was one additional commit to
leverage inet_aton():

<http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=263fa01f2af1d336961df320f1c7a9ea84ddac9a>

This code made it into the 2.0.3 release.

> Please use CVE-2012-4435for this issue.

Will do.

> > 3) strict filesystem permissions for various fwknop files are not
> > verified
>
> This seems more like security hardening. Generally speaking network
> daemons are not responsible for ensuring the safety of their own files
> (the system should have a sane configuration). Also if I assign a CVE
> for this then every single daemon that creates a config file and fails
> to check the permissions qualifies for a CVE that's a few hundred
> thousand CVEs =). For example: OpenSSH, it has a number of checks on
> file permissions, no CVE's for that.

Understood.

> > 4) local buffer overflow in --last processing with a maliciously
> > constructed ~/.fwknop.run file Upstream patch: [3]
> > <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=a60f05ad44e824f6230b22f8976399340cb535dc>
>
> This
> >
> is the MAX_CMDLINE_ARGS stuff specifically I assume?

Yes, that's it.

> Please use CVE-2012-4436 for this issue.

Will do, thanks.

--
Michael Rash
<http://www.cipherdyne.org/>
Key fingerprint: E2EF 0C8A 5AA9 654C 4763  B50F 37AC E946 7F51 8271

>
> > For the remaining ones: ======================= 5) several
> > conditions in which the server did not properly throw out
> > maliciously constructed variables in the access.conf file Upstream
> > patch: [4]
> > <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=e2c0ac4821773eb335e36ad6cd35830b8d97c75a>
> >
> >  Note: This doesn't look like a security flaw (previously possible
> > to provide malicious values to access.conf file, but I assume it
> > would required administrator privileges).
> >
> > 6) [test suite] Added a new fuzzing capability to ensure proper
> > server-side input validation. Note: Test-suite add-on, no CVE
> > needed.
> >
> > 7) Fixed RPM builds by including the $(DESTDIR) prefix for
> > uninstall-local and install-exec-hook stages in Makefile.am.
> > Upstream patch: [5]
> > <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=c5b229c5c87657197b0c814ff22127d870b55753>
> >
> >  Note: Also doesn't look like a fix for a security flaw.
> >
> > Could you allocate CVE ids for issues 1), 2), 3), and 4) ?
> >
> > [Cc-ed Damien and Michael from fwknop upstream to confirm they {the
> > first four} should receive a CVE identifier].
> >
> > Thank you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat
> > Security Response Team
> >
>
>
> - --
> Kurt Seifried Red Hat Security Response Team (SRT)
> PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.12 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - <http://www.enigmail.net/>
>
> iQIcBAEBAgAGBQJQWn+eAAoJEBYNRVNeJnmTJTwQALuiFHMtB+AOYoP3PQoPlW07
> ktfHS3t64Lv9to160PDabHMoGJg/MJyz+liA/mHRESXe6PhnPMdZKYquPtBsA7O9
> 97NVUQolV5BpfUJTIZtLnIcIH5Sul+mmMj4QbglK5ZV50DGpN8gH9WX6irOn+gFI
> RNj5W6BnLnCPRJX4CXF+kjKB5BpZGv4TmdRzW9CvR7/j2S+QqbiYS6HCAaQXuqLS
> OF7W3l9JKY7I9yZP8LuaZ8duRImizhaueSBV9EqDLva8gtl+snI43ho+/eX64+vp
> HmlnkoChNwUpnAjHFsWqYwjQ2ztCMONlZh7jrptKltdWhVha5zlqv50NlEK2NscC
> IENCTcb/yWn/GYNYUs5sMn3LJZsuEgzaaTru3/CvSyFs6SbyYhOB3MAaU4AtBWR2
> T3Y8WNuUz6bf1ZkltIpJb9Nn9Qy57ZMH4BuDJCSDsrIhowwSiKKFAW9RWClLDzOz
> 24reeMbm/aGXmCNwpzinEoexsWAv5GmvqtaOtyKNgCY2Yjl5Dot+0l6vkcb221hM
> 9NELus8L20+NhMmAty+XYTnRs4YaezuwOyNroDce7DA2whml9hLEGcb5fv5dY4IE
> 7Dcx+QttaOQn8Ixdoc3Wqx/dGrto67sajF3OWXz58YqLCj6XAP7kZZ6JxsIxi6Ki
> NChFqIKY+pLaEXTi0ewn
> =o1N7
> -----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_974aec99_20250125_134119.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1695043470.1858431.1348078239757.JavaMail.root@redhat.com>
Date: Wed, 19 Sep 2012 14:10:39 -0400 (EDT)
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
Cc: oss-security@...ts.openwall.com, Damien Stuart <dstuart@...uart.org>,
        Michael Rash <mbr@...herdyne.org>
Subject: CVE Request -- fwknop 2.0.3: Multiple security issues

Hello Kurt, Steve, vendors,

  multiple securit issues have been corrected in 2.0.3 upstream version of
fwknop (<http://www.cipherdyne.org/blog/categories/software-releases.html>):
---------------------------------------------------------------------------
1) multiple DoS / code execution flaws:
   Upstream patch:
   [1] <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=d46ba1c027a11e45821ba897a4928819bccc8f22>

2) server did not properly validate allow IP addresses from malicious
   authenticated clients
   Upstream patch:
   [2] <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=f4c16bc47fc24a96b63105556b62d61c1ba7d799>

3) strict filesystem permissions for various fwknop files are not verified
4) local buffer overflow in --last processing with a maliciously constructed ~/.fwknop.run file
   Upstream patch:
   [3] <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=a60f05ad44e824f6230b22f8976399340cb535dc>

For the remaining ones:
=======================
5) several conditions in which the server did not properly throw out maliciously constructed variables in the access.conf file
   Upstream patch:
   [4] <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=e2c0ac4821773eb335e36ad6cd35830b8d97c75a>

   Note: This doesn't look like a security flaw (previously possible to provide malicious values
   to access.conf file, but I assume it would required administrator privileges).

6) [test suite] Added a new fuzzing capability to ensure proper server-side input validation.
   Note: Test-suite add-on, no CVE needed.

7) Fixed RPM builds by including the $(DESTDIR) prefix for uninstall-local and
   install-exec-hook stages in Makefile.am.
   Upstream patch:
   [5] <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=c5b229c5c87657197b0c814ff22127d870b55753>

   Note: Also doesn't look like a fix for a security flaw.

Could you allocate CVE ids for issues 1), 2), 3), and 4) ?

[Cc-ed Damien and Michael from fwknop upstream to confirm
they {the first four} should receive a CVE identifier].

Thank you && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.cipherdyne.org_4790a9ac_20250125_134118.html ===


# [cipherdyne.org](http://www.cipherdyne.org/)

Michael Rash, Security Researcher

* [Home](/)
* [Blog](/blog/ "Blog")
* [Software](/about.html "Cipherdyne Software Projects")
* [Author](/author.html "Author: Michael Rash")
* [Contact](/contact.html "Contact Information")

## Software Release - fwknop-2.0.3

04 September, 2012

[![fwknop-2.0.3 released](/images/release.png "fwknop-2.0.3")](/fwknop/download/)
The fwknop-2.0.3 release of [**fwknop**](/fwknop) is
available for [**download**](/fwknop/download/). This
is an important release that tightens up the code in several areas based on
excellent research performed by Fernando Arnaboldi of [IOActive](http://www.ioactive.com/).
I wish to thank Fernando for this work, and also Erik Gomez of IOActive as well
for making this research possible. Fernando's research turned up potential DoS and/or
code execution vulnerabilities in the fwknopd server for malicious authenticated
clients, insecure filesystem permissions handling, and more. All of these issues
have been fixed in the 2.0.3 release.

Here is the complete fwknop-2.0.3 ChangeLog:

* [server] Fernando Arnaboldi from IOActive found several DoS/code
  execution vulnerabilities for malicious fwknop clients that manage to
  get past the authentication stage (so a such a client must be in
  possession of a valid access.conf encryption key). These vulnerabilities
  manifested themselves in the handling of malformed access requests, and
  both the fwknopd server code along with libfko now perform stronger input
  validation of access request data. These vulnerabilities affect
  pre-2.0.3 fwknop releases.
* [server] Fernando Arnaboldi from IOActive found a condition in which
  the server did not properly validate allow IP addresses from malicious
  authenticated clients. This has been fixed with stronger allow IP
  validation.
* [client+server] Fernando Arnaboldi from IOActive found that strict
  filesystem permissions for various fwknop files are not verified. Added
  warnings whenever permissions are not strict enough, and ensured that
  files created by the fwknop client and server are only set to user
  read/write.
* [client] Fernando Arnaboldi from IOActive found a local buffer overflow
  in --last processing with a maliciously constructed ~/.fwknop.run file.
  This has been fixed with proper validation of .fwknop.run arguments.
* [server] Fernando Arnaboldi from IOActive found several conditions in
  which the server did not properly throw out maliciously constructed
  variables in the access.conf file. This has been fixed along with new
  fuzzing tests in the test suite.
* [test suite] Added a new fuzzing capability to ensure proper server-side
  input validation. Fuzzing data is constructed with modified fwknop
  client code that is designed to emulate malicious behavior.
* Fixed RPM builds by including the $(DESTDIR) prefix for uninstall-local
  and install-exec-hook stages in Makefile.am.

The fwknop-2.0.3 ChangeLog can also be found
[here](/cgi-bin/gitweb.cgi?p=fwknop.git;a=blob;f=ChangeLog;h=f321a59ac7e86ce19f65d5a8fc7cd5f5893402d2;hb=refs/tags/fwknop-2.0.3)
via the fwknop [gitweb](/cgi-bin/gitweb.cgi?p=fwknop.git;a=summary) interface.

04 September, 2012
| [Software Releases](/blog/categories/software-releases.html)
| [fwknop](/blog/categories/fwknop.html)
| By: Michael Rash

« [On GnuPG Encrypted SPA Cross-Packet Entropy](/blog/2012/08/on-gnupg-encrypted-spa-cross-packet-entropy.html)
[Single Packet Authorization: The fwknop Approach](/blog/2012/09/single-packet-authorization-the-fwknop-approach.html) »

## Software

* [fwknop](/fwknop/ "Single Packet Authorization for iptables, pf, and ipfw")
* [afl-cov](/afl-cov/ "Code coverage results for the AFL fuzzer")
* [psad](/psad/ "Intrusion detection for iptables")
* [fwsnort](/fwsnort/ "Translate Snort rules into iptables rules")
* [gpgdir](/gpgdir/ "Recursive directory encryption with GnuPG")
* [IPTables::Parse](/modules/IPTables-Parse.html "CPAN perl module for parsing iptables/ip6tables policies")
* [IPTables::ChainMgr](/modules/IPTables-ChainMgr.html "CPAN perl module for manipulating iptables/ip6tables policies")

| [@michaelrash](https://twitter.com/michaelrash) [Google+](https://www.google.com/%2BMichaelRash) [Atom feed](/atom.xml) [LinkedIn](https://www.linkedin.com/pub/michael-rash/0/81/209) |
| --- |

## Linux Firewalls Book

[![Linux Firewalls: Attack Detection and Response with iptables, psad, and fwsnort](/images/LF_cover.jpg "Linux Firewalls: Attack Detection and Response with iptables, psad, and fwsnort")](/LinuxFirewalls "Linux Firewalls: Attack Detection and Response with iptables, psad, and fwsnort")
[Tweets by michaelrash](https://twitter.com/michaelrash?ref_src=twsrc%5Etfw)

## Recent Blog Posts

* [Software Release: fwknop-2.6.11](/blog/2024/02/software-release-fwknop-2.6.11.html)
* [Wireguard, macOS, and Linux Virtual Machines](/blog/2018/10/wireguard-macos-and-linux-virtual-machines.html)
* [Software Release: fwknop-2.6.10](/blog/2018/08/software-release-fwknop-2.6.10.html)
* [Software Release: psad-2.4.6 and fwsnort-1.6.8](/blog/2018/07/software-release-psad-2.4.6-and-fwsnort-1.6.8.html)
* [Software Release: fwknop-2.6.9](/blog/2016/06/software-release-fwknop-2.6.9.html)
* [Single Packet Authorization and Third Party Devices](/blog/2015/12/single-packet-authorization-and-third-party-devices.html)
* [Software Release: fwknop-2.6.7](/blog/2015/08/software-release-fwknop-2.6.7.html)
* [Android Fwknop2 Client and OpenWRT](/blog/2015/06/android-fwknop2-client-and-openwrt.html)
* [**Archives...**](/blog/archives.html)

## Categories

* [Port Knocking and SPA (49)](/blog/categories/port-knocking-and-spa.html)
* [IDS and iptables (25)](/blog/categories/intrusion-detection-and-iptables.html)
* [Network Security (3)](/blog/categories/network-security.html)
* [Publications (20)](/blog/categories/publications.html)
* [Programming (10)](/blog/categories/programming.html)
* [DNS (3)](/blog/categories/dns.html)
* [git (3)](/blog/categories/git.html)
* [System Administration (4)](/blog/categories/system-administration.html)
* [Conference Talks (22)](/blog/categories/conference-talks.html)
* [Software Releases (130)](/blog/categories/software-releases.html)
* [In The News (27)](/blog/categories/in-the-news.html)
* [Trac (4)](/blog/categories/trac.html)
* [**More...**](/blog/archives.html)

[Terms of Use](/Cipherdyne_Terms_of_Use.doc)

Copyright © 2001-2012 [Michael Rash](/author.html).

Design by [Andreas Viklund](http://andreasviklund.com/).



=== Content from www.openwall.com_1fed397e_20250125_134120.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](1) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <505A7F9E.4000203@redhat.com>
Date: Wed, 19 Sep 2012 20:29:50 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Jan Lieskovsky <jlieskov@...hat.com>,
        "Steven M. Christey" <coley@...us.mitre.org>,
        Damien Stuart <dstuart@...uart.org>, Michael Rash <mbr@...herdyne.org>
Subject: Re: CVE Request -- fwknop 2.0.3: Multiple security
 issues

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 09/19/2012 12:10 PM, Jan Lieskovsky wrote:
> Hello Kurt, Steve, vendors,
>
> multiple securit issues have been corrected in 2.0.3 upstream
> version of fwknop
> (<http://www.cipherdyne.org/blog/categories/software-releases.html>):
>
>
-
---------------------------------------------------------------------------
> 1) multiple DoS / code execution flaws: Upstream patch: [1]
> <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=d46ba1c027a11e45821ba897a4928819bccc8f22>

Ok
>
yeah this seems to be mostly changes related to char buf[32] to
char buf[ACCESS_BUF_LEN], plus some logic cleanups (like making sure
the port specified is larger than 0 and less than MAX_PORT). So I'll
lump them all together rather than separate them.

Please use CVE-2012-4434 for this issue.

> 2) server did not properly validate allow IP addresses from
> malicious authenticated clients Upstream patch: [2]
> <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=f4c16bc47fc24a96b63105556b62d61c1ba7d799>

Stupid
>
question possibly (didn't look at the code apart from the fix).
I see:

if(char_ctr >= MAX_IPV4_STR_LEN)

but nothing for IPv6 (does fwknopd even support ipv6?)... someone may
want to check that.

Please use CVE-2012-4435for this issue.

> 3) strict filesystem permissions for various fwknop files are not
> verified

This seems more like security hardening. Generally speaking network
daemons are not responsible for ensuring the safety of their own files
(the system should have a sane configuration). Also if I assign a CVE
for this then every single daemon that creates a config file and fails
to check the permissions qualifies for a CVE that's a few hundred
thousand CVEs =). For example: OpenSSH, it has a number of checks on
file permissions, no CVE's for that.

> 4) local buffer overflow in --last processing with a maliciously
> constructed ~/.fwknop.run file Upstream patch: [3]
> <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=a60f05ad44e824f6230b22f8976399340cb535dc>

This
>
is the MAX_CMDLINE_ARGS stuff specifically I assume?

Please use CVE-2012-4436 for this issue.

> For the remaining ones: ======================= 5) several
> conditions in which the server did not properly throw out
> maliciously constructed variables in the access.conf file Upstream
> patch: [4]
> <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=e2c0ac4821773eb335e36ad6cd35830b8d97c75a>
>
>  Note: This doesn't look like a security flaw (previously possible
> to provide malicious values to access.conf file, but I assume it
> would required administrator privileges).
>
> 6) [test suite] Added a new fuzzing capability to ensure proper
> server-side input validation. Note: Test-suite add-on, no CVE
> needed.
>
> 7) Fixed RPM builds by including the $(DESTDIR) prefix for
> uninstall-local and install-exec-hook stages in Makefile.am.
> Upstream patch: [5]
> <http://www.cipherdyne.org/cgi-bin/gitweb.cgi?p=fwknop.git;a=commitdiff;h=c5b229c5c87657197b0c814ff22127d870b55753>
>
>  Note: Also doesn't look like a fix for a security flaw.
>
> Could you allocate CVE ids for issues 1), 2), 3), and 4) ?
>
> [Cc-ed Damien and Michael from fwknop upstream to confirm they {the
> first four} should receive a CVE identifier].
>
> Thank you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat
> Security Response Team
>

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://www.enigmail.net/>

iQIcBAEBAgAGBQJQWn+eAAoJEBYNRVNeJnmTJTwQALuiFHMtB+AOYoP3PQoPlW07
ktfHS3t64Lv9to160PDabHMoGJg/MJyz+liA/mHRESXe6PhnPMdZKYquPtBsA7O9
97NVUQolV5BpfUJTIZtLnIcIH5Sul+mmMj4QbglK5ZV50DGpN8gH9WX6irOn+gFI
RNj5W6BnLnCPRJX4CXF+kjKB5BpZGv4TmdRzW9CvR7/j2S+QqbiYS6HCAaQXuqLS
OF7W3l9JKY7I9yZP8LuaZ8duRImizhaueSBV9EqDLva8gtl+snI43ho+/eX64+vp
HmlnkoChNwUpnAjHFsWqYwjQ2ztCMONlZh7jrptKltdWhVha5zlqv50NlEK2NscC
IENCTcb/yWn/GYNYUs5sMn3LJZsuEgzaaTru3/CvSyFs6SbyYhOB3MAaU4AtBWR2
T3Y8WNuUz6bf1ZkltIpJb9Nn9Qy57ZMH4BuDJCSDsrIhowwSiKKFAW9RWClLDzOz
24reeMbm/aGXmCNwpzinEoexsWAv5GmvqtaOtyKNgCY2Yjl5Dot+0l6vkcb221hM
9NELus8L20+NhMmAty+XYTnRs4YaezuwOyNroDce7DA2whml9hLEGcb5fv5dY4IE
7Dcx+QttaOQn8Ixdoc3Wqx/dGrto67sajF3OWXz58YqLCj6XAP7kZZ6JxsIxi6Ki
NChFqIKY+pLaEXTi0ewn
=o1N7
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


