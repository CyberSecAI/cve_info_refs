```
{
  "vulnerability_details": {
    "root_cause": "Insecure handling of lock files in the /tmp directory by opencryptoki when compiled with -DSPINXPL, which are used for locking purposes.",
    "weaknesses": [
      "Creation of lock files in /tmp that are vulnerable to symlink attacks.",
      "The files are opened RDWR, and a chmod is performed, allowing an attacker to change permissions or create new files at arbitrary locations."
    ],
    "impact": "An attacker can create new files at arbitrary locations (e.g., /etc/nologin) or make arbitrary files world-writable (e.g., /etc/shadow) with the privileges of the user running pkcsslotd or an application using the opencryptoki library.",
    "attack_vectors": [
      "Symlink attacks, where an attacker replaces the lock files with symlinks before the application creates them.",
       "The files can be opened, and their permissions altered."
    ],
   "required_attacker_capabilities": [
       "Ability to create symlinks in the /tmp directory before the vulnerable application creates the lock files.",
       "No need to be a member of the pkcs11 group for initial exploitation."
    ],
    "additional_notes": "The vulnerability affects opencryptoki versions 2.4.0 and earlier. Fixes were attempted in later versions by moving the lock files to /var/lock, which is also vulnerable if world-writable, and eventually to a pkcs11 group writable directory, where it can be exploited by pkcs11 group members."
  }
}
```