=== Content from www.openwall.com_b48b63c2_20250124_125313.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[thread-next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1848832289.24879971.1346423678094.JavaMail.root@redhat.com>
Date: Fri, 31 Aug 2012 10:34:38 -0400 (EDT)
From: Jan Lieskovsky <jlieskov@...hat.com>
To: oss-security@...ts.openwall.com
Cc: oss-security@...ts.openwall.com,
        Mitre CVE assign department <cve-assign@...re.org>
Subject: CVE Request -- MediaWiki 1.19.2 and 1.18.5 multiple security flaws

Hello Kurt, Steve, vendors,

  multiple security flaws were corrected in recent (1.19.2,
and 1.18.5) versions of MediaWiki, a wiki engine:

1) Stored XSS via a File::link to a non-existing image
   Upstream bug:
   [1] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39700>

   Upstream patch against the 1.19 version:
   [2] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39700#c11>

   Upstream patch against the 1.18 version:
   [3] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39700#c12>

   References:
   [4] <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>
   [5] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330>
   [6] <https://bugzilla.redhat.com/show_bug.cgi?id=853409>

2) Multiple DOM-based XSS flaws due improper filtering of uselang parameter
   in combination with JS gadgets
   Upstream bug:
   [7] <https://bugzilla.wikimedia.org/show_bug.cgi?id=37587>

   Relevant upstream patch:
   [8] <https://gerrit.wikimedia.org/r/#/c/13336/>

   References:
   [9]  <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>
   [10] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330>
   [11] <https://bugzilla.redhat.com/show_bug.cgi?id=853417>

3) CSRF tokens, available via API, not protected when X-Frame-Options headers used
   Upstream bug:
   [12] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39180>

   Relevant upstream patch:
   [13] <https://gerrit.wikimedia.org/r/#/c/20472/>

   References:
   [14] <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>
   [15] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330>
   [16] <https://bugzilla.redhat.com/show_bug.cgi?id=853426>

4) Did not prevent account creation for IP addresses blocked with GlobalBlocking
   Upstream bug:
   [17] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39824>

   Upstream patch against the 1.18 version:
   [18] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39824#c0>

   References:
   [19] <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>
   [20] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330>
   [21] <https://bugzilla.redhat.com/show_bug.cgi?id=853440>

5) Password saved always to the local MediaWiki database and
   possibility to use old passwords for non-existing accounts
   in the external auth system
   Upstream bug:
   [22] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39184>

   Upstream patch:
   [23] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39184#c1>

   References:
   [24] <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>
   [25] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330>
   [26] <https://bugzilla.redhat.com/show_bug.cgi?id=853442>

6) Metadata about blocks, hidden by a user with suppression rights,
   was visible to administrators
   Upstream bug:
   [27] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39823>

   Patch for 1.18 branch:
   [28] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39823#c1>

   References:
   [29] <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>
   [30] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330>
   [31] No Red Hat bugzilla entry, since this did not affect
        MediaWiki versions, as shipped across various Red Hat products.

Could you allocate CVE ids for these?

Thank you && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_601bbb67_20250124_125314.html ===

# Debian Bug report logs - #686330 mediawiki: Multiple security issues CVE-2012-4377,CVE-2012-4378,CVE-2012-4379,CVE-2012-4380,CVE-2012-4381,CVE-2012-4382

[![version graph](version.cgi?height=2;collapse=1;fixed=mediawiki%2F1%3A1.19.2-1;width=2;package=mediawiki;absolute=0)](version.cgi?fixed=mediawiki%2F1%3A1.19.2-1;collapse=1;info=1;absolute=0;package=mediawiki)

Package:
[mediawiki](pkgreport.cgi?package=mediawiki);
Maintainer for [mediawiki](pkgreport.cgi?package=mediawiki) is [MediaWiki packaging team <mediawiki-debian@lists.wikimedia.org>](pkgreport.cgi?maint=mediawiki-debian%40lists.wikimedia.org); Source for [mediawiki](pkgreport.cgi?package=mediawiki) is [src:mediawiki](pkgreport.cgi?src=mediawiki) ([PTS](https://tracker.debian.org/pkg/mediawiki), [buildd](https://buildd.debian.org/mediawiki), [popcon](https://qa.debian.org/popcon.php?package=mediawiki)).

Reported by: [Moritz Muehlenhoff <jmm@inutil.org>](pkgreport.cgi?submitter=jmm%40inutil.org)

Date: Fri, 31 Aug 2012 08:30:01 UTC

Severity: *grave*

Tags: security

Fixed in version mediawiki/1:1.19.2-1

**Done:** Thorsten Glaser <tg@mirbsd.de>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=686330;mbox=yes), [status mbox](bugreport.cgi?bug=686330;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=686330;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`:

`Bug#686330`; Package `mediawiki`.
(Fri, 31 Aug 2012 08:30:04 GMT) ([full text](bugreport.cgi?bug=686330;msg=2), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`.
(Fri, 31 Aug 2012 08:30:04 GMT) ([full text](bugreport.cgi?bug=686330;msg=4), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=686330;msg=5), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: mediawiki: Multiple security issues
Date: Fri, 31 Aug 2012 10:23:43 +0200
```
Package: mediawiki
Severity: grave
Tags: security
Justification: user security hole

Please see here for more info:
<http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>

No CVE IDs available yet.

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`:

`Bug#686330`; Package `mediawiki`.
(Fri, 31 Aug 2012 08:39:07 GMT) ([full text](bugreport.cgi?bug=686330;msg=7), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Thorsten Glaser <t.glaser@tarent.de>`:

Extra info received and forwarded to list. Copy sent to `Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`.
(Fri, 31 Aug 2012 08:39:07 GMT) ([full text](bugreport.cgi?bug=686330;msg=9), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 686330@bugs.debian.org ([full text](bugreport.cgi?bug=686330;msg=10), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=t.glaser%40tarent.de)
From: Thorsten Glaser <t.glaser@tarent.de>
To: 686330@bugs.debian.org,
Maintenance team for the mediawiki package <pkg-mediawiki-devel@lists.alioth.debian.org>,
debian-release@lists.debian.org
Subject: Re: Bug#686330: mediawiki: Multiple security issues
Date: Fri, 31 Aug 2012 10:37:25 +0200 (CEST)
```
On Fri, 31 Aug 2012, Moritz Muehlenhoff wrote:

> Please see here for more info:
> <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767>

Thanks.

The Release Notes say that 1.19.2 is a security-fix release,
and does not list any unrelated changes. Question is, (to the
more seasoned MW packagers) can we trust that, and (to the
Release Team) would it be acceptable to bump the upstream
version on that?

Thanks,
//mirabilos
--
tarent solutions GmbH
Rochusstraße 2-4, D-53123 Bonn • <http://www.tarent.de/>
Tel: +49 228 54881-393 • Fax: +49 228 54881-314
HRB 5168 (AG Bonn) • USt-ID (VAT): DE122264941
Geschäftsführer: Boris Esser, Sebastian Mancke

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`:

`Bug#686330`; Package `mediawiki`.
(Fri, 31 Aug 2012 16:39:03 GMT) ([full text](bugreport.cgi?bug=686330;msg=12), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Julien Cristau <jcristau@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`.
(Fri, 31 Aug 2012 16:39:03 GMT) ([full text](bugreport.cgi?bug=686330;msg=14), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 686330@bugs.debian.org ([full text](bugreport.cgi?bug=686330;msg=15), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=jcristau%40debian.org)
From: Julien Cristau <jcristau@debian.org>
To: Thorsten Glaser <t.glaser@tarent.de>
Cc: 686330@bugs.debian.org,
Maintenance team for the mediawiki package <pkg-mediawiki-devel@lists.alioth.debian.org>,
debian-release@lists.debian.org
Subject: Re: Bug#686330: mediawiki: Multiple security issues
Date: Fri, 31 Aug 2012 18:34:38 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=686330;msg=15) (text/plain, inline)]
```
```
On Fri, Aug 31, 2012 at 10:37:25 +0200, Thorsten Glaser wrote:

> The Release Notes say that 1.19.2 is a security-fix release,
> and does not list any unrelated changes. Question is, (to the
> more seasoned MW packagers) can we trust that, and (to the
> Release Team) would it be acceptable to bump the upstream
> version on that?
>
Can't answer without a diff.

Cheers,
Julien

```
```
[[signature.asc](bugreport.cgi?att=1;bug=686330;filename=signature.asc;msg=15) (application/pgp-signature, inline)]
```

---

**Changed Bug title to 'mediawiki: Multiple security issues CVE-2012-4377,CVE-2012-4378,CVE-2012-4379,CVE-2012-4380,CVE-2012-4381,CVE-2012-4382' from 'mediawiki: Multiple security issues'**
Request was from `Henri Salo <henri@nerv.fi>`
to `control@bugs.debian.org`.
(Sun, 02 Sep 2012 17:00:08 GMT) ([full text](bugreport.cgi?bug=686330;msg=17), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=17), [link](#16)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`:

`Bug#686330`; Package `mediawiki`.
(Thu, 13 Sep 2012 16:06:03 GMT) ([full text](bugreport.cgi?bug=686330;msg=19), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`.
(Thu, 13 Sep 2012 16:06:03 GMT) ([full text](bugreport.cgi?bug=686330;msg=21), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 686330@bugs.debian.org ([full text](bugreport.cgi?bug=686330;msg=22), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Julien Cristau <jcristau@debian.org>
Cc: Thorsten Glaser <t.glaser@tarent.de>, 686330@bugs.debian.org,
Maintenance team for the mediawiki package <pkg-mediawiki-devel@lists.alioth.debian.org>,
debian-release@lists.debian.org
Subject: Re: Bug#686330: mediawiki: Multiple security issues
Date: Thu, 13 Sep 2012 18:01:40 +0200
```
On Fri, Aug 31, 2012 at 06:34:38PM +0200, Julien Cristau wrote:
> On Fri, Aug 31, 2012 at 10:37:25 +0200, Thorsten Glaser wrote:
>
> > The Release Notes say that 1.19.2 is a security-fix release,
> > and does not list any unrelated changes. Question is, (to the
> > more seasoned MW packagers) can we trust that, and (to the
> > Release Team) would it be acceptable to bump the upstream
> > version on that?
> >
> Can't answer without a diff.

Mediawiki maintainers, what's the status?

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`:

`Bug#686330`; Package `mediawiki`.
(Thu, 13 Sep 2012 21:36:03 GMT) ([full text](bugreport.cgi?bug=686330;msg=24), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent**
to `Platonides <platonides@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`.
(Thu, 13 Sep 2012 21:36:03 GMT) ([full text](bugreport.cgi?bug=686330;msg=26), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 686330@bugs.debian.org ([full text](bugreport.cgi?bug=686330;msg=27), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=platonides%40gmail.com)
From: Platonides <platonides@gmail.com>
To: Moritz Muehlenhoff <jmm@inutil.org>, 686330@bugs.debian.org,
Maintenance team for the mediawiki package <pkg-mediawiki-devel@lists.alioth.debian.org>
Subject: Re: [Pkg-mediawiki-devel] Bug#686330: mediawiki: Multiple security
issues
Date: Thu, 13 Sep 2012 23:31:35 +0200
```
On 13/09/12 18:01, Moritz Muehlenhoff wrote:
> On Fri, Aug 31, 2012 at 06:34:38PM +0200, Julien Cristau wrote:
>> On Fri, Aug 31, 2012 at 10:37:25 +0200, Thorsten Glaser wrote:
>>
>>> The Release Notes say that 1.19.2 is a security-fix release,
>>> and does not list any unrelated changes. Question is, (to the
>>> more seasoned MW packagers) can we trust that, and (to the
>>> Release Team) would it be acceptable to bump the upstream
>>> version on that?
>>>
>> Can't answer without a diff.
>
> Mediawiki maintainers, what's the status?
>
> Cheers,
>         Moritz

All MediaWiki changes from x.y.z to x.y.z+1 are safe to do (to the best
of our knowledge), and should be always applied since they are motivated
by security fixes.
In 1.19.2 they were more serious than other times.

We do bundle the latest translations [for that branch] with the new
release. Those are obviously not part of the security fixes (unless it
added a new error message, which wasn't the case in 1.19.2) but they
don't touch the code.

An easy way to view the differences is to do:
 git diff d0c0aabb3c5d40688d2435c0963927da479a47e0
f25ee7006ff73f1cdf22cdd11401af31ef691b12

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`:

`Bug#686330`; Package `mediawiki`.
(Fri, 14 Sep 2012 12:33:05 GMT) ([full text](bugreport.cgi?bug=686330;msg=29), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=29), [link](#28)).

---

**Acknowledgement sent**
to `Thorsten Glaser <t.glaser@tarent.de>`:

Extra info received and forwarded to list. Copy sent to `Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>`.
(Fri, 14 Sep 2012 12:33:05 GMT) ([full text](bugreport.cgi?bug=686330;msg=31), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 686330@bugs.debian.org ([full text](bugreport.cgi?bug=686330;msg=32), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=t.glaser%40tarent.de)
From: Thorsten Glaser <t.glaser@tarent.de>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: Julien Cristau <jcristau@debian.org>, 686330@bugs.debian.org,
Maintenance team for the mediawiki package <pkg-mediawiki-devel@lists.alioth.debian.org>,
debian-release@lists.debian.org
Subject: Re: Bug#686330: mediawiki: Multiple security issues
Date: Fri, 14 Sep 2012 14:30:05 +0200 (CEST)
```
[[Message part 1](bugreport.cgi?att=0;bug=686330;msg=32) (text/plain, inline)]
```
```
On Thu, 13 Sep 2012, Moritz Muehlenhoff wrote:

> On Fri, Aug 31, 2012 at 06:34:38PM +0200, Julien Cristau wrote:

> > Can't answer without a diff.
>
> Mediawiki maintainers, what's the status?

Oh, sorry. Other stuff made me forget this for too long.

The diff between the two tarballs is over 10 MiB, although
with .gitignore files removed, using -w and removing all
Messages* files (in the hope these are really only trans‐
lation changes/fixes), it gets down to ~21K (attached).

On a quick skim, I couldn’t find anything wrong with it,
but I’m not qualified to say whether these are bugfixes
only without detailed analysis (I’m not normally doing
development on MW core code itself, more integration
work).

bye,
//mirabilos
--
tarent solutions GmbH
Rochusstraße 2-4, D-53123 Bonn • <http://www.tarent.de/>
Tel: +49 228 54881-393 • Fax: +49 228 54881-314
HRB 5168 (AG Bonn) • USt-ID (VAT): DE122264941
Geschäftsführer: Boris Esser, Sebastian Mancke
```
```
[[mnl.diff](bugreport.cgi?att=1;bug=686330;filename=mnl.diff;msg=32) (text/x-diff, attachment)]
```

---

**Reply sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

You have taken responsibility.
(Thu, 20 Sep 2012 12:21:15 GMT) ([full text](bugreport.cgi?bug=686330;msg=34), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=34), [link](#33)).

---

**Notification sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Bug acknowledged by developer.
(Thu, 20 Sep 2012 12:21:15 GMT) ([full text](bugreport.cgi?bug=686330;msg=36), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 686330-close@bugs.debian.org ([full text](bugreport.cgi?bug=686330;msg=37), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: 686330-close@bugs.debian.org
Subject: Bug#686330: fixed in mediawiki 1:1.19.2-1
Date: Thu, 20 Sep 2012 12:19:37 +0000
```
Source: mediawiki
Source-Version: 1:1.19.2-1

We believe that the bug you reported is fixed in the latest version of
mediawiki, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 686330@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Thorsten Glaser <tg@mirbsd.de> (supplier of updated mediawiki package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA384

Format: 1.8
Date: Thu, 20 Sep 2012 13:40:12 +0200
Source: mediawiki
Binary: mediawiki
Architecture: source all
Version: 1:1.19.2-1
Distribution: unstable
Urgency: low
Maintainer: Mediawiki Maintenance Team <pkg-mediawiki-devel@lists.alioth.debian.org>
Changed-By: Thorsten Glaser <tg@mirbsd.de>
Description:
 mediawiki  - website engine for collaborative work
Closes: [686330](bugreport.cgi?bug=686330) [687519](bugreport.cgi?bug=687519)
Changes:
 mediawiki (1:1.19.2-1) unstable; urgency=low
 .
   [ Thorsten Glaser ]
   * New upstream: security fixes for [CVE-2012-4377](https://security-tracker.debian.org/tracker/CVE-2012-4377), [CVE-2012-4378](https://security-tracker.debian.org/tracker/CVE-2012-4378),
     [CVE-2012-4379](https://security-tracker.debian.org/tracker/CVE-2012-4379), [CVE-2012-4380](https://security-tracker.debian.org/tracker/CVE-2012-4380), [CVE-2012-4381](https://security-tracker.debian.org/tracker/CVE-2012-4381), [CVE-2012-4382](https://security-tracker.debian.org/tracker/CVE-2012-4382)
     (Closes: #[686330](bugreport.cgi?bug=686330))
   * Prevent <table></table> without any <tr /> inside, globally
   * Fix more cases of not checking $wgHtml5
   * MW’s ID (XML) sanitiser is there for a reason, use it!
   * Prevent <ul></ul> without any <li /> inside in MonoBook
   * Fix invalid XHTML caused by code not honouring $wgHtml5
   * Quell some PHP warnings from sloppy code
   * Do the wfSuppressWarnings patch used with FusionForge right
   * Add myself to Uploaders and quieten lintian a bit
   * Do not replace patched jquery-tablesorter with unpatched one;
     unbreaks sortable tables (Closes: #[687519](bugreport.cgi?bug=687519))
   * Update versioned Breaks against fusionforge and mw-extensions
 .
   [ Jonathan Wiltshire ]
   * Add Recommends on mediawiki-extensions-base and php-wikidiff2
Checksums-Sha1:
 c0282c4dd0b1dbda901eff5a448bca54170db811 2094 mediawiki_1.19.2-1.dsc
 0e95a4c376bbcf77450adb1dca0180ac16da1b67 18266096 mediawiki_1.19.2.orig.tar.gz
 5f62e4d9453031697cc82d7a89503aee1d72f61b 35216 mediawiki_1.19.2-1.debian.tar.gz
 eea6e35fd26a1845ad9d0d83b286f041aff3a0f7 17464904 mediawiki_1.19.2-1_all.deb
Checksums-Sha256:
 30457167ebf5c4f51709d5c9d5118139ae4d97f26efdaa95d49ded8cad2bf6bd 2094 mediawiki_1.19.2-1.dsc
 fe5b8de52e546767aee018bb3f2d50b64ffd6c914e145de46de6001ec6691a7e 18266096 mediawiki_1.19.2.orig.tar.gz
 f1d49ec385f8c5e0ed05bffc27e8a243b3270f03cc0f64ccb204818327a2b500 35216 mediawiki_1.19.2-1.debian.tar.gz
 fd7b3c10203c00abfef7a273670591ed53f1b0118eee87d97dc663480e5f7f32 17464904 mediawiki_1.19.2-1_all.deb
Files:
 a215cb250daf2b119ebce3d77e8efcba 2094 web optional mediawiki_1.19.2-1.dsc
 8b2546ab0b3991083fd49b1d0d96b26e 18266096 web optional mediawiki_1.19.2.orig.tar.gz
 46741db6b5662dcccda2007e10988287 35216 web optional mediawiki_1.19.2-1.debian.tar.gz
 8a1e2f838bdff9e026dd30951e241321 17464904 web optional mediawiki_1.19.2-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MirBSD)

iQIcBAEBCQAGBQJQWwZJAAoJEHa1NLLpkAfg0RsQANDxd+8URM1AbmrFnVjxteru
62E45+JmirMuVZw3MLB0EcP7PbCbKAN7UQUt28p1PSrF6wKF4ny1oB6Hlt/Nu+K6
GVY9nSprAYd0eUNUjbmEDV5+6kDxdCtSqXLQbTrtpddSRJ6Mj++iOoMQXBBKyI7g
EnyRhVh1gfWRsHqQq940Be+AuhhhxTBJp0oe1MvrWs3FkPU9eI8bmWNuxpB7iWL8
dJ2VvEMujPIi5nH8wS+bQgRJbVLh/JakG/vEQSgd6lyi/EW/c/rAX0/Kzayt6+Ml
9VndFwhItyls7GbtJmvEeZv3aS97H2rvCaf78ngqbtujPV0BRy4y1fmVwJSC4mIM
nI7waw8VwXPndcIaR5W7rHohpJwPbuhkkXusBWp5Eza5lqR7uylqa3h2OEUyxCk/
y8AtbhLbn9p/WOL69Ow3bWffWpM5PJNzQ9SEYb1en/aX0fb25usGPj2p/oH03pS6
avODNOqJiGVxXzvVcn8Sl/J2vG6fWb40ylTO9dY8xzL5+XtcV2C+Pgy3YOal2fSR
Z3jpeWTUi0D9KQwEVMZXf8+jUf80oNfYY91Dyitk8/abgfHtsw6/T+Ihw/fJ8tUy
2AIcS3jyNB/IdbGj5Sa98w7OVQBizUMLnse5n9gAYmpSzwx5WyOjparuXEPSyuxh
6yBRjFgHYZqJEyM15IwY
=qKrJ
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 19 Oct 2012 07:26:13 GMT) ([full text](bugreport.cgi?bug=686330;msg=39), [mbox](bugreport.cgi?bug=686330;mbox=yes;msg=39), [link](#38)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=686330).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 12:53:14 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_4161e85e_20250124_125313.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[<thread-prev]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5040F9B7.8040903@redhat.com>
Date: Fri, 31 Aug 2012 11:51:51 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Jan Lieskovsky <jlieskov@...hat.com>,
        Mitre CVE assign department <cve-assign@...re.org>
Subject: Re: CVE Request -- MediaWiki 1.19.2 and 1.18.5 multiple
 security flaws

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 08/31/2012 08:34 AM, Jan Lieskovsky wrote:
> Hello Kurt, Steve, vendors,
>
> multiple security flaws were corrected in recent (1.19.2, and
> 1.18.5) versions of MediaWiki, a wiki engine:

Top posting and in line:

CVE-2012-4377 Stored XSS via a File::link to a non-existing image

CVE-2012-4378 Multiple DOM-based XSS flaws due improper filtering of
uselang parameter

CVE-2012-4379 CSRF tokens, available via API, not protected when
X-Frame-Options headers used

CVE-2012-4380 Did not prevent account creation for IP addresses
blocked with GlobalBlocking

CVE-2012-4381 Password saved always to the local MediaWiki database

CVE-2012-4382 Metadata about blocks

> 1) Stored XSS via a File::link to a non-existing image Upstream
> bug: [1] <https://bugzilla.wikimedia.org/show_bug.cgi?id=39700>
>
> Upstream patch against the 1.19 version: [2]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39700#c11>
>
> Upstream patch against the 1.18 version: [3]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39700#c12>
>
> References: [4]
> <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767> [5]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330> [6]
> <https://bugzilla.redhat.com/show_bug.cgi?id=853409>

Please use CVE-2012-4377 for this issue.

> 2) Multiple DOM-based XSS flaws due improper filtering of uselang
> parameter in combination with JS gadgets Upstream bug: [7]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=37587>
>
> Relevant upstream patch: [8]
> <https://gerrit.wikimedia.org/r/#/c/13336/>
>
> References: [9]
> <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767> [10]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330> [11]
> <https://bugzilla.redhat.com/show_bug.cgi?id=853417>

Please use CVE-2012-4378 for this issue.

> 3) CSRF tokens, available via API, not protected when
> X-Frame-Options headers used Upstream bug: [12]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39180>
>
> Relevant upstream patch: [13]
> <https://gerrit.wikimedia.org/r/#/c/20472/>
>
> References: [14]
> <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767> [15]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330> [16]
> <https://bugzilla.redhat.com/show_bug.cgi?id=853426>

Please use CVE-2012-4379 for this issue.

> 4) Did not prevent account creation for IP addresses blocked with
> GlobalBlocking Upstream bug: [17]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39824>
>
> Upstream patch against the 1.18 version: [18]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39824#c0>
>
> References: [19]
> <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767> [20]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330> [21]
> <https://bugzilla.redhat.com/show_bug.cgi?id=853440>

Please use CVE-2012-4380 for this issue.

> 5) Password saved always to the local MediaWiki database and
> possibility to use old passwords for non-existing accounts in the
> external auth system Upstream bug: [22]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39184>
>
> Upstream patch: [23]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39184#c1>
>
> References: [24]
> <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767> [25]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330> [26]
> <https://bugzilla.redhat.com/show_bug.cgi?id=853442>

Please use CVE-2012-4381 for this issue.

> 6) Metadata about blocks, hidden by a user with suppression
> rights, was visible to administrators Upstream bug: [27]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39823>
>
> Patch for 1.18 branch: [28]
> <https://bugzilla.wikimedia.org/show_bug.cgi?id=39823#c1>
>
> References: [29]
> <http://www.gossamer-threads.com/lists/wiki/mediawiki/295767> [30]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330> [31] No Red
> Hat bugzilla entry, since this did not affect MediaWiki versions,
> as shipped across various Red Hat products.

Please use CVE-2012-4382 for this issue.

> Could you allocate CVE ids for these?
>
> Thank you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat
> Security Response Team
>

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://www.enigmail.net/>

iQIcBAEBAgAGBQJQQPm3AAoJEBYNRVNeJnmTQ/kP/RcvMqfAx+L+PD78RPypQYnd
zZdoe5InbG+taAScuCn8hK1E5CSUJwD2tW6hCHIL20w7iIeoJGYQX9VjdMf27nK5
dXhYODptEX/StCXkzXo79/KThEn7gneaolO0wNdhC7Nl+Jp2+0bFtVxbqOCcBVPn
z3GKzQ4dvxJbFSMH7Id+agXVuPEaQHuz2+0cg20xfUow7YfWAcmdlm+ARuLN1abh
MGlSOoY7QGRxTX/PqXeduaPWAu+Fsz+lPPC13kCXtNAhRysQeFdIcAodnRZ7SRuR
mnj2YfzS+XjzjIF596G6a9n/YyAtWebkJedg6k9q3BuUbSGe/9nHxn3F0EDID+wT
SoeCvRCDs6WfvJ5OP0ZYeE+z2boVpzA2L12JfR1iW22zYy/Y779yeS3dsjAtB7NE
EZ5RXch/WEuHSeIa0CFFFEPL6Y76TpM5oZXp/R+MNiIzwwCcfUMI47P9sUsklsaM
7lMjguJoT5xVGiTc8SnyY5k2MFt3iDU5+zpaG8k1qYq7Vj1pq3byeLhDsmI3I3+w
ZCcuCH8/Mh7a9hGviLYB5AVZoCkB9qSYoSmHbfudq05rGsru+tk/NOa1oUC9LNUn
AkYTlfssO8rBSeZ2Lg7MlHAmzmMz8QTf3OGA/E8RPkTv1qXqJvcAf+SyMe9a16Ob
XtXUaz1oZxoBqRc1W/x+
=CMss
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security-tracker.debian.org_f0deab4f_20250126_011059.html ===

# CVE-2012-4380

| **Name** | CVE-2012-4380 |
| --- | --- |
| **Description** | MediaWiki before 1.18.5, and 1.19.x before 1.19.2 allows remote attackers to bypass GlobalBlocking extension IP address blocking and create an account via unspecified vectors. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2012-4380) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-4380); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2012-4380), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2012-4380), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2012-4380), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2012-4380), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-4380), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2012-4380), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2012-4380), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2012-4380)/[CVE](https://www.suse.com/security/cve/CVE-2012-4380/), GitHub [advisories](https://github.com/advisories?query=CVE-2012-4380)/[code](https://github.com/search?type=Code&q=%22CVE-2012-4380%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2012-4380%22), [web search](https://duckduckgo.com/html?q=%22CVE-2012-4380%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [686330](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [mediawiki](/tracker/source-package/mediawiki) ([PTS](https://tracker.debian.org/pkg/mediawiki)) | bullseye | 1:1.35.13-1+deb11u2 | fixed |
|  | bullseye (security) | 1:1.35.13-1+deb11u3 | fixed |
|  | bookworm, bookworm (security) | 1:1.39.10-1~deb12u1 | fixed |
|  | sid | 1:1.39.10-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [mediawiki](/tracker/source-package/mediawiki) | source | squeeze | (unfixed) | end-of-life |  |  |
| [mediawiki](/tracker/source-package/mediawiki) | source | (unstable) | 1:1.19.2-1 |  |  | [686330](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330) |

## Notes

```
<https://bugzilla.wikimedia.org/show_bug.cgi?id=39824>
<https://www.openwall.com/lists/oss-security/2012/08/31/6>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugzilla.wikimedia.org_7ce59c31_20250126_011102.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT41700)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T41700
# A File: link to a non-existing image can inject htmlClosed, Resolved[Public](/policy/explain/PHID-TASK-4bm3i3iqa3dixufrng4h/view/)Actions

* [Edit Task](/maniphest/task/edit/41700/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/41700/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* [Protect as security issue](/wmf/escalate-task/41700/)
* [Award Token](/token/give/PHID-TASK-4bm3i3iqa3dixufrng4h/)
* [Flag For Later](/flag/edit/PHID-TASK-4bm3i3iqa3dixufrng4h/)

Assigned ToNoneAuthored By

|  | [• csteipp](/p/csteipp/) |
| --- | --- |
| Aug 27 2012, 8:54 PM2012-08-27 20:54:00 (UTC+0) |

Tags

* [MW-1.19-release](/tag/mw-1.19-release/) [(Backlog)](/project/board/537/)
* [MediaWiki-Parser](/tag/mediawiki-parser/) [(Backlog)](/project/board/136/)
* [Security](/tag/security/)
Referenced Files

|  | [F9570: encLink-1.18.patch](/F9570) |
| --- | --- |
| Nov 22 2014, 12:45 AM2014-11-22 00:45:01 (UTC+0) |

|  | [F9569: encLink-1.19.patch](/F9569) |
| --- | --- |
| Nov 22 2014, 12:45 AM2014-11-22 00:45:00 (UTC+0) |

|  | [F9568: bug39700-v3.patch](/F9568) |
| --- | --- |
| Nov 22 2014, 12:44 AM2014-11-22 00:44:59 (UTC+0) |

Subscribers

|  | [Catrope](/p/Catrope/) |
| --- | --- |

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [Nikerabbit](/p/Nikerabbit/) |
| --- | --- |

|  | [Platonides](/p/Platonides/) |
| --- | --- |

|  | [Reedy](/p/Reedy/) |
| --- | --- |

|  | [• RobLa-WMF](/p/RobLa-WMF/) |
| --- | --- |

|  | [tstarling](/p/tstarling/) |
| --- | --- |

|  | [• wikibugs-l-list](/p/wikibugs-l-list/) |
| --- | --- |

# Description

When a [[File:]] tag to an non-existent image is rendered, the comment is written into the dom without html escaping.

Reported by Writ Keeper:

Hi all,

I'm not sure if this is the right place to report this, but I figured

better safe than sorry. I marked a page for deletion today, called '

Atelje "Meander" ', that had an embedded Youtube video in it (not

through File Upload or Commons), and I didn't think that this was

supposed to be possible. It did this by putting an iframe tag in the

argument to a nonexistent file (File:Nikola Novaković na kontrabasu

Miše Blama), so that it read [[File:Nikola Novaković na kontrabasu

Miše Blama|<iframe src=(url) ...</iframe>]]. The page has been

deleted, but I reproduced the behavior (using an <img> tag instead of

an iframe) on my test account's sandbox, located here:

[http://en.wikipedia.org/wiki/User:WK-test/sandbox](http://en.wikipedia.org/wiki/User%3AWK-test/sandbox) .

Thanks,

Writ Keeper

---

**Version**: 1.19.1

**Severity**: major

# Details

Reference bz39700
# Related Objects

* Mentions

Mentioned In [T266149: Run another round of visual diff testing after tweaking core patches that change media output to <figure>, etc.](/T266149)
### Event Timeline

[• bzimport](/p/bzimport/) raised the priority of this task from  to Needs Triage.[Nov 22 2014, 12:44 AM2014-11-22 00:44:56 (UTC+0)](#425188)[• bzimport](/p/bzimport/) added projects: [MW-1.19-release](/tag/mw-1.19-release/), [MediaWiki-Parser](/tag/mediawiki-parser/).[• bzimport](/p/bzimport/) set Reference to bz39700.[• bzimport](/p/bzimport/) added a subscriber: Unknown Object (MLST).[• csteipp](/p/csteipp/) created this task.[Aug 27 2012, 8:54 PM2012-08-27 20:54:00 (UTC+0)](#425198)[tstarling](/p/tstarling/) added a comment.[Aug 27 2012, 10:30 PM2012-08-27 22:30:30 (UTC+0)](#425207)Comment Actions

I've confirmed that the bug is present at least as far back as 1.17. Sanitizer::stripAllTags() is documented as returning unsafe HTML since MW 1.10, due to calling self::decodeCharReferences(). It is called by Parser::stripAltText(), and the result is passed through to Linker::makeBrokenImageLinkObj() without further processing. Before r82843, the main case would not have been vulnerable, but the linkKnown() case and the <!--ERROR--> case would have been vulnerable before that time.

[• csteipp](/p/csteipp/) added a comment.[Aug 28 2012, 1:27 AM2012-08-28 01:27:55 (UTC+0)](#425213)Comment Actions

So looking at the best fix for this, the comments for Linker::makeBrokenImageLinkObj say that they expect the $html string to be htmlescaped. That's the closest place to the output where that expectation seems to be documented, so probably should escape $fp['title'] just before passing it in makeImageLink?

The comments in Parser::stripAltText seems (to me) to indicate the author thought Sanitizer::stripAllTags would strip out html tags, so it would be good to find some way of making that more obvious.

[• brooke](/p/brooke/) added a comment.[Aug 28 2012, 3:28 AM2012-08-28 03:28:34 (UTC+0)](#425228)Comment Actions

Sanitizer::stripAllTags does strip out HTML tags -- but it returns \*PLAINTEXT\* which may include the characters "<" and ">", which might be around things like "script" or "iframe".

Every time you treat plaintext as HTML, you create an HTML injection vector... Escape your output, kids. :)

[tstarling](/p/tstarling/) added a comment.[Aug 28 2012, 7:03 AM2012-08-28 07:03:13 (UTC+0)](#425241)Comment Actions

(In reply to comment #2)

> So looking at the best fix for this, the comments for
>
> Linker::makeBrokenImageLinkObj say that they expect the $html string to be
>
> htmlescaped. That's the closest place to the output where that expectation
>
> seems to be documented, so probably should escape $fp['title'] just before
>
> passing it in makeImageLink?

Something like that. My main concern is to avoid reopening bug 27679 and to avoid breaking the test cases fixed in r68491. Most link texts are wikitext, and in fact we have a parser test enforcing that interpretation:

[[File:Denys Savchenko ''Pentecoste''.jpg]]

Goes to:

<p><a href="/index.php?title=Special:Upload&amp;wpDestFile=Denys\_Savchenko\_%27%27Pentecoste%27%27.jpg" class="new" title="File:Denys Savchenko &#39;&#39;Pentecoste&#39;&#39;.jpg">File:Denys Savchenko <i>Pentecoste</i>.jpg</a>

Note the actual italics in the link text. So it may not be as simple as just adding more escaping.

(In reply to comment #3)

> Every time you treat plaintext as HTML, you create an HTML injection vector...
>
> Escape your output, kids. :)

Thanks for those words of wisdom, old man.

[• csteipp](/p/csteipp/) added a comment.[Aug 28 2012, 10:37 PM2012-08-28 22:37:45 (UTC+0)](#425256)Comment Actions

As Tim mentioned, it looks like r82843 (which closed bug 27679) may have contributed to the problem. It prevented running htmlspecialchars twice when $html == '' (Line 884), but doesn't run htmlspecialchars on the $html variable if it is passed into the function (and htmlspecialchars wasn't run in 2 other cases as well). I made one patch to run htmlspecialchars exactly once on $html for each of the code paths.

I also tried running tooltext in Parser::stripAltText through Sanitizer::removeHTMLtags, since the comment for makeBrokenImageLinkObj says that $html should already be escaped, and I'm not entirely sure if there was a reason for it. Both fixes produced the same output for all of my test input.

Both fixes also now allows a link like [[File:AB2.gif | A<B ]] to render as <a href="/wiki/index.php?title=Special:Upload&amp;wpDestFile=AB2.gif" class="new" title="File:AB2.gif">A&lt;B</a> instead of <a href="/wiki/Wikipedia:Upload?wpDestFile=AB2.gif" class="new" title="File:AB2.gif">A</a>, which seemed to me like a bug.

Is there a preference for running htmlspecialchars vs. removeHTMLtags?

[• csteipp](/p/csteipp/) added a comment.[Aug 28 2012, 10:38 PM2012-08-28 22:38:54 (UTC+0)](#425269)Comment Actions

Created attachment 11025

run htmlspecialchars exactly once on $html in makeBrokenImageLinkObj

*attachment htmlspecialchars.patch ignored as obsolete*

[tstarling](/p/tstarling/) added a comment.[Aug 29 2012, 12:44 AM2012-08-29 00:44:55 (UTC+0)](#425275)Comment Actions

(In reply to comment #5)

> As Tim mentioned, it looks like r82843 (which closed bug 27679) may have
>
> contributed to the problem. It prevented running htmlspecialchars twice when
>
> $html == '' (Line 884), but doesn't run htmlspecialchars on the $html variable
>
> if it is passed into the function (and htmlspecialchars wasn't run in 2 other
>
> cases as well). I made one patch to run htmlspecialchars exactly once on $html
>
> for each of the code paths.

Thanks for that. It appears to work, but I still want to look at it more closely.

> I also tried running tooltext in Parser::stripAltText through
>
> Sanitizer::removeHTMLtags, since the comment for makeBrokenImageLinkObj says
>
> that $html should already be escaped, and I'm not entirely sure if there was a
>
> reason for it. Both fixes produced the same output for all of my test input.

The comment on makeBrokenImageLinkObj() was added by someone who didn't understand the code. The only reason for that comment is that escaping happened to be missing at the time the comment was added, since the escaping was removed shortly before by another author to fix a double-escaping bug. It doesn't say anything about what callers expect or whether escaping is a good idea.

> Is there a preference for running htmlspecialchars vs. removeHTMLtags?

Sanitizer::removeHTMLtags() is a parser helper that removes certain HTML tags and leaves others for further processing by subsequent parts of the parser. It's not usually called for other purposes.

Sanitizer::stripAllTags() converts HTML (or HTML-like half-transformed wikitext) to plain text for use in an attribute. It's assumed that whatever constructs the HTML will escape the attribute correctly. Linker::makeBrokenLinkObj() is an unusual case since text which was originally intended for the alt attribute is redirected into non-attribute HTML.

There's no point in running Sanitizer::removeHTMLtags() on the input to Parser::stripAltText(), since it has already been run. And it would be incorrect to run it on the output of Parser::stripAltText(), since that would prevent users from including special characters in alt tags, regardless of what escaping method they attempted to use:

> print Sanitizer::stripAllTags('&#60;script/&#62;');

<script/>

[tstarling](/p/tstarling/) added a comment.[Aug 29 2012, 4:01 AM2012-08-29 04:01:10 (UTC+0)](#425287)Comment Actions

Created attachment 11032

Chris's patch plus some cleanup and tests

Chris's patch looked fine. I fixed the documentation regarding $html and the variable name. I also removed $prefix and $trail, since all callers have set them to empty strings since the Age of Legends, and leaving them in was unnecessarily confusing. I also added a parser test.

In case anyone cares: link trails were originally implemented in the link functions. Now we have link trail handling in LinkHolderArray::makeHolder() and link prefix handling in Parser::replaceInternalLinks2(), but Linker::splitTrail() was left where it was, and many Linker functions still take prefix/trail arguments.

**Attached**: bug39700-v3.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/5ka3mvoxdo4z5yhdaw6h/PHID-FILE-26rm2qmwvtustok3g7tr/bug39700-v3.patch)

[tstarling](/p/tstarling/) added a comment.[Aug 29 2012, 9:27 AM2012-08-29 09:27:08 (UTC+0)](#425297)Comment Actions

* Bug 39762 has been marked as a duplicate of this bug. \*\*\*
[tstarling](/p/tstarling/) added a comment.[Aug 29 2012, 10:28 AM2012-08-29 10:28:34 (UTC+0)](#425306)Comment Actions

Niklas blamed r61816 (MW 1.16), which seems plausible. At the time, only the linkKnown() case would have been vulnerable, so it would have only affected wikis with $wgEnableUploads = $wgUploadNavigationUrl = false. I've confirmed the vulnerability in 1.16 with those conditions.

r82843 (MW 1.18) would have extended the vulnerability to wikis with upload enabled. The commit message indicates that the author was misled by the vulnerability from r61816 into thinking that there was no need to escape $text, and his test cases didn't fully explore that assumption.

The error case was probably never reachable.

MW 1.18 is still within our 12 month support window, so we will need releases of both 1.18 and 1.19.

[• csteipp](/p/csteipp/) added a comment.[Aug 29 2012, 9:57 PM2012-08-29 21:57:40 (UTC+0)](#425321)Comment Actions

Created attachment 11038

Backport to 1.19, which didn't call wfCgiToArray

**Attached**: encLink-1.19.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/i5igwgvgg6o3g7nearpt/PHID-FILE-4wmndczb3sf4btgp2gfm/encLink-1.19.patch)

[• csteipp](/p/csteipp/) added a comment.[Aug 29 2012, 10:13 PM2012-08-29 22:13:13 (UTC+0)](#425335)Comment Actions

Created attachment 11039

Backport to 1.18

**Attached**: encLink-1.18.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/vr326s2rz3c3nar2hso5/PHID-FILE-wnjjc3toe3rqt4bp7agx/encLink-1.18.patch)

[Platonides](/p/Platonides/) added a comment.[Sep 1 2012, 4:29 PM2012-09-01 16:29:38 (UTC+0)](#425352)Comment Actions

master <https://gerrit.wikimedia.org/r/22272>

1.20wmf10 <https://gerrit.wikimedia.org/r/22171>

1.19 <https://gerrit.wikimedia.org/r/22188>

1.18 <https://gerrit.wikimedia.org/r/22194>

[• csteipp](/p/csteipp/) added a project: [acl\*security](/tag/acl_security/).[Mar 26 2015, 8:39 PM2015-03-26 20:39:25 (UTC+0)](#1154639)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:53 PM2020-02-10 22:53:44 (UTC+0)](#5868124) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:14 PM2020-02-20 20:14:31 (UTC+0)](#5903842) · [Arlolra](/p/Arlolra/) mentioned this in [T266149: Run another round of visual diff testing after tweaking core patches that change media output to <figure>, etc.](/T266149).[Jan 15 2021, 10:19 PM2021-01-15 22:19:57 (UTC+0)](#6752492)[Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from security-tracker.debian.org_c3664195_20250126_011100.html ===

# CVE-2012-4381

| **Name** | CVE-2012-4381 |
| --- | --- |
| **Description** | MediaWiki before 1.18.5, and 1.19.x before 1.19.2 saves passwords in the local database, (1) which could make it easier for context-dependent attackers to obtain cleartext passwords via a brute-force attack or, (2) when an authentication plugin returns a false in the strict function, could allow remote attackers to use old passwords for non-existing accounts in an external authentication system via unspecified vectors. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2012-4381) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-4381); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2012-4381), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2012-4381), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2012-4381), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2012-4381), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-4381), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2012-4381), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2012-4381), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2012-4381)/[CVE](https://www.suse.com/security/cve/CVE-2012-4381/), GitHub [advisories](https://github.com/advisories?query=CVE-2012-4381)/[code](https://github.com/search?type=Code&q=%22CVE-2012-4381%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2012-4381%22), [web search](https://duckduckgo.com/html?q=%22CVE-2012-4381%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [686330](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [mediawiki](/tracker/source-package/mediawiki) ([PTS](https://tracker.debian.org/pkg/mediawiki)) | bullseye | 1:1.35.13-1+deb11u2 | fixed |
|  | bullseye (security) | 1:1.35.13-1+deb11u3 | fixed |
|  | bookworm, bookworm (security) | 1:1.39.10-1~deb12u1 | fixed |
|  | sid | 1:1.39.10-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [mediawiki](/tracker/source-package/mediawiki) | source | squeeze | (unfixed) | end-of-life |  |  |
| [mediawiki](/tracker/source-package/mediawiki) | source | (unstable) | 1:1.19.2-1 |  |  | [686330](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330) |

## Notes

```
<https://bugzilla.wikimedia.org/show_bug.cgi?id=39184>
<https://www.openwall.com/lists/oss-security/2012/08/31/6>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from lists.wikimedia.org_59937db0_20250124_125315.html ===


[lists.wikimedia.org](/hyperkitty/)

[Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/TOEKKCYLGLB75GYS7CGGGZDETON7JV2A/)
[Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/TOEKKCYLGLB75GYS7CGGGZDETON7JV2A/)

* [Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/TOEKKCYLGLB75GYS7CGGGZDETON7JV2A/)
* [Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/TOEKKCYLGLB75GYS7CGGGZDETON7JV2A/)

* [Manage this list](/postorius/lists/mediawiki-announce.lists.wikimedia.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2025/1/)

### 2024

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/1/)

### 2023

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/1/)

### 2022

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/1/)

### 2021

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/1/)

### 2020

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/1/)

### 2019

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/1/)

### 2018

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/1/)

### 2017

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/1/)

### 2016

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/1/)

### 2015

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/1/)

### 2014

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/1/)

### 2013

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/1/)

### 2012

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/1/)

### 2011

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/1/)

### 2010

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/1/)

### 2009

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/1/)

### 2008

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/1/)

### 2007

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/1/)

### 2006

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/1/)

### 2005

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/1/)

### 2004

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2004/12/)

[List overview](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

[Download](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/export/mediawiki-announce%40lists.wikimedia.org-TOEKKCYLGLB75GYS7CGGGZDETON7JV2A.mbox.gz?message=TOEKKCYLGLB75GYS7CGGGZDETON7JV2A "This message in gzipped mbox format")

[thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/TOEKKCYLGLB75GYS7CGGGZDETON7JV2A/#TOEKKCYLGLB75GYS7CGGGZDETON7JV2A)

# [MediaWiki-announce] MediaWiki security release: 1.19.2 and 1.18.5

[Chris Steipp](/hyperkitty/users/dd272b532a8d4667a37daa128483ef95/ "See the profile for Chris Steipp")

31 Aug
2012

31 Aug
'12

5:26 a.m.

I would like to announce the release of MediaWiki 1.19.2 and 1.18.5.
These releases fix 6 security related bugs that could affect users of
MediaWiki. Download links are given at the end of this email.

\* Wikipedia administrator Writ Keeper discovered a stored XSS (HTML
injection) vulnerability. This was possible due to the handling of
link text on File: links for nonexistent files. MediaWiki 1.16 and
later is affected. For more details, see
<https://bugzilla.wikimedia.org/show_bug.cgi?id=39700>

\* User Fomafix reported several DOM-based XSS vulnerabilities, made
possible by a combination of loose filtering of the uselang parameter,
and JavaScript gadgets on various language Wikipedias. For more
details, see <https://bugzilla.wikimedia.org/show_bug.cgi?id=37587>

\* During internal review, it was discovered that CSRF tokens,
available via the api, were not protected with X-Frame-Options
headers. This could lead to a CSRF vulnerability if the API response
is embedded in an external website using an iframe. For more details,
see <https://bugzilla.wikimedia.org/show_bug.cgi?id=39180>

\* During internal review, it was discovered extensions were not always
allowed to prevent the account creation action. This allowed users
blocked by the GlobalBlocking extension to create accounts. For more
details, see <https://bugzilla.wikimedia.org/show_bug.cgi?id=39824>

\* During internal review, it was discovered that password data was
always saved to the local MediaWiki database, even if authentication
was handled by an extension, such as LDAP. This could allow a
compromised MediaWiki installation to leak information about user's
LDAP passwords. Additionally, in situations when an authentication
plugin returned false in its strict function, this would allow old
passwords to be used for accounts that did not exist in the external
system, indefinitely. For details on how to clean up the data leakage,
see: <https://bugzilla.wikimedia.org/show_bug.cgi?id=39184>

\* During internal review, it was discovered that metadata about
blocks, hidden by a user with suppression rights, was visible to
administrators. For more details, see
<https://bugzilla.wikimedia.org/show_bug.cgi?id=39823>

Full release notes for 1.19.2:
<https://www.mediawiki.org/wiki/Release_notes/1.19>

Full release notes for 1.18.5:
<https://www.mediawiki.org/wiki/Release_notes/1.18>

For information about how to upgrade, see
[https://www.mediawiki.org/wiki/Manual:Upgrading](https://www.mediawiki.org/wiki/Manual%3AUpgrading)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.19.2
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.2.tar.gz>

Patch to previous version (1.19.1):
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.2.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.2.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.2.patch.gz.sig>

Public keys:
<https://secure.wikimedia.org/keys.html>

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.18.5
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<http://download.wikimedia.org/mediawiki/1.18/mediawiki-1.18.5.tar.gz>

Patch to previous version (1.18.4), without interface text:
<http://download.wikimedia.org/mediawiki/1.18/mediawiki-1.18.5.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.18/mediawiki-i18n-1.18.5.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.18/mediawiki-1.18.5.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.18/mediawiki-1.18.5.patch.gz.sig>
[http://download.wikimedia.org/mediawiki/1.18/mediawiki-i18n-1.18.5.patch.gz....](http://download.wikimedia.org/mediawiki/1.18/mediawiki-i18n-1.18.5.patch.gz.sig)

Public keys:
<https://secure.wikimedia.org/keys.html>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/TOEKKCYLGLB75GYS7CGGGZDETON7JV2A/#TOEKKCYLGLB75GYS7CGGGZDETON7JV2A)

[Back to the list](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from phabricator.wikimedia.org_2ced730c_20250124_125316.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT41823)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T41823
# If a block log reason was rev-deleted, it is still visible for all admins in [[Special:Block]]Closed, Resolved[Public](/policy/explain/PHID-TASK-c4snvnvqfejklh7d7a5i/view/)Actions

* [Edit Task](/maniphest/task/edit/41823/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/41823/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* [Protect as security issue](/wmf/escalate-task/41823/)
* [Award Token](/token/give/PHID-TASK-c4snvnvqfejklh7d7a5i/)
* [Flag For Later](/flag/edit/PHID-TASK-c4snvnvqfejklh7d7a5i/)

Assigned ToNoneAuthored By

|  | [tstarling](/p/tstarling/) |
| --- | --- |
| Aug 31 2012, 1:55 AM2012-08-31 01:55:00 (UTC+0) |

Tags

* [MW-1.19-release](/tag/mw-1.19-release/) [(Backlog)](/project/board/537/)
* [MediaWiki-User-management](/tag/mediawiki-user-management/) [(Backlog)](/project/board/198/)
* [Security](/tag/security/)
Referenced Files

|  | [F9768: blockreason-1.18.patch](/F9768) |
| --- | --- |
| Nov 22 2014, 12:52 AM2014-11-22 00:52:15 (UTC+0) |

Subscribers

|  | [Catrope](/p/Catrope/) |
| --- | --- |

|  | [MarkAHershberger](/p/MarkAHershberger/) |
| --- | --- |

|  | [Reedy](/p/Reedy/) |
| --- | --- |

|  | [• RobLa-WMF](/p/RobLa-WMF/) |
| --- | --- |

|  | [tstarling](/p/tstarling/) |
| --- | --- |

|  | [• wikibugs-l-list](/p/wikibugs-l-list/) |
| --- | --- |

# Description

If a user is blocked with the "Hide username from edits and lists" option selected, and another administrator attempted to reblock the same user, then the block reason was shown to the second administrator even if they lacked the hideuser right.

This was fixed in the attached patch, to be included with the release of MediaWiki 1.19.2 and 1.18.5.

Administrators are advised to avoid placing private data in block reasons. If a block reason does contain private data, the user should be reblocked with a non-private block reason and the original log entry suppressed.

---

**Version**: 1.19.1

**Severity**: normal

# Details

Reference bz39823
### Event Timeline

[• bzimport](/p/bzimport/) raised the priority of this task from  to Needs Triage.[Nov 22 2014, 12:52 AM2014-11-22 00:52:15 (UTC+0)](#439179)[• bzimport](/p/bzimport/) added projects: [MW-1.19-release](/tag/mw-1.19-release/), [MediaWiki-User-management](/tag/mediawiki-user-management/).[• bzimport](/p/bzimport/) set Reference to bz39823.[• bzimport](/p/bzimport/) added a subscriber: Unknown Object (MLST).[tstarling](/p/tstarling/) created this task.[Aug 31 2012, 1:55 AM2012-08-31 01:55:00 (UTC+0)](#439207)[tstarling](/p/tstarling/) added a comment.[Aug 31 2012, 1:56 AM2012-08-31 01:56:03 (UTC+0)](#439213)Comment Actions

Created attachment 11042

Patch for 1.18 branch

**Attached**: blockreason-1.18.patch903 B[Download](https://phab.wmfusercontent.org/file/download/sul7bpag66xiwirux5zp/PHID-FILE-x3cl4pobel4sh36gfdrv/blockreason-1.18.patch)

[tstarling](/p/tstarling/) added a comment.[Aug 31 2012, 1:56 AM2012-08-31 01:56:57 (UTC+0)](#439220)Comment Actions

* Bug 35839 has been marked as a duplicate of this bug. \*\*\*
[• csteipp](/p/csteipp/) added a project: [acl\*security](/tag/acl_security/).[Mar 26 2015, 8:39 PM2015-03-26 20:39:26 (UTC+0)](#1154642)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:53 PM2020-02-10 22:53:44 (UTC+0)](#5868122) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:14 PM2020-02-20 20:14:31 (UTC+0)](#5903840) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from security-tracker.debian.org_9a4b7a24_20250126_011059.html ===

# CVE-2012-4382

| **Name** | CVE-2012-4382 |
| --- | --- |
| **Description** | MediaWiki before 1.18.5, and 1.19.x before 1.19.2 does not properly protect user block metadata, which allows remote administrators to read a user block reason via a reblock attempt. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2012-4382) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-4382); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2012-4382), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2012-4382), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2012-4382), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2012-4382), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-4382), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2012-4382), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2012-4382), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2012-4382)/[CVE](https://www.suse.com/security/cve/CVE-2012-4382/), GitHub [advisories](https://github.com/advisories?query=CVE-2012-4382)/[code](https://github.com/search?type=Code&q=%22CVE-2012-4382%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2012-4382%22), [web search](https://duckduckgo.com/html?q=%22CVE-2012-4382%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [686330](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [mediawiki](/tracker/source-package/mediawiki) ([PTS](https://tracker.debian.org/pkg/mediawiki)) | bullseye | 1:1.35.13-1+deb11u2 | fixed |
|  | bullseye (security) | 1:1.35.13-1+deb11u3 | fixed |
|  | bookworm, bookworm (security) | 1:1.39.10-1~deb12u1 | fixed |
|  | sid | 1:1.39.10-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [mediawiki](/tracker/source-package/mediawiki) | source | squeeze | (unfixed) | end-of-life |  |  |
| [mediawiki](/tracker/source-package/mediawiki) | source | (unstable) | 1:1.19.2-1 |  |  | [686330](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686330) |

## Notes

```
<https://bugzilla.wikimedia.org/show_bug.cgi?id=39823>
<https://www.openwall.com/lists/oss-security/2012/08/31/6>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


