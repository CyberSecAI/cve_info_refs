=== Content from bugzilla.mozilla.org_628a99ae_20250126_071940.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/798045)
* [XML](/show_bug.cgi?ctype=xml&id=798045)

Closed
[Bug 798045](/show_bug.cgi?id=798045)
(CVE-2012-4191)

Opened 12 years ago
Closed 12 years ago

# crash in mozilla::net::FailDelayManager::Lookup

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

crash in mozilla::net::FailDelayManager::Lookup

## Categories

### (Core :: Networking: WebSockets, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20WebSockets#Networking%3A%20WebSockets)

Networking: WebSockets
▾

Core :: Networking: WebSockets
Bugs related to the performance/correctness of the
on-the-wire WebSocket networking protocol: file other WebSockets bugs under
DOM:WebSockets
interface may be better classified as Core::DOM.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20WebSockets&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20WebSockets&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20WebSockets)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

16 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Windows 7

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla19

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=fixed) |
| firefox17 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) |
| firefox19 | --- | [verified](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=verified) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | + | fixed |
| firefox17 |  | fixed |
| firefox18 |  | fixed |
| firefox19 |  | verified |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: scoobidiver, Assigned: jduell.mcbugs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=40)  [jduell.mcbugs](/user_profile?user_id=334931)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/43a258096978fdc5ca10d5b423b0c178?d=mm&size=40)  [scoobidiver](/user_profile?user_id=386758)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [blocking bug 711793, but see comment 8][qa-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2012-4191

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[steps-wanted](/buglist.cgi?keywords=steps-wanted&resolution=---),
[topcrash](/buglist.cgi?keywords=topcrash&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[blocking bug 711793, but see comment 8][qa-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ arena\_dalloc\_small | je\_free | nsACString\_internal::`scalar deleting destructor''(unsigned int) ]](https://crash-stats.mozilla.org/signature/?signature=arena_dalloc_small%20%7C%20je_free%20%7C%20nsACString_internal%3A%3A%60scalar%20deleting%20destructor%27%27%28unsigned%20int%29)

[[@ nsAString\_internal::Finalize() ]](https://crash-stats.mozilla.org/signature/?signature=nsAString_internal%3A%3AFinalize%28%29)

[[@ arena\_dalloc\_small | je\_free | nsAutoString::`scalar deleting destructor''(unsigned int) ]](https://crash-stats.mozilla.org/signature/?signature=arena_dalloc_small%20%7C%20je_free%20%7C%20nsAutoString%3A%3A%60scalar%20deleting%20destructor%27%27%28unsigned%20int%29)

[[@ memmove | nsTArray\_base<nsTArrayDefaultAllocator>::ShiftData(unsigned int, unsigned int, unsigned int, unsigned int, unsigned int) | nsTArray<nsIDOMWindow\*, nsTArrayDefaultAllocator>::RemoveElementsAt(unsigned int, unsigned int) | mozilla::net::FailDel... ]](https://crash-stats.mozilla.org/signature/?signature=memmove%20%7C%20nsTArray_base%3CnsTArrayDefaultAllocator%3E%3A%3AShiftData%28unsigned%20int%2C%20unsigned%20int%2C%20unsigned%20int%2C%20unsigned%20int%2C%20unsigned%20int%29%20%7C%20nsTArray%3CnsIDOMWindow%2A%2C%20nsTArrayDefaultAllocator%3E%3A%3ARemoveElementsAt%28unsigned%20int%2C%20unsigned%20int%29%20%7C%20mozilla%3A%3Anet%3A%3AFailDel...)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [v1](/attachment.cgi?id=669347)  [12 years ago](#c9)  [Jason Duell](/user_profile?user_id=334931)   1.11 KB, patch | briansmith : [review+](#a358235_14661 "12 years ago")  akeybl : [approval-mozilla-aurora+](#c16 "12 years ago")  akeybl : [approval-mozilla-beta+](#c16 "12 years ago")  akeybl : [approval-mozilla-release+](#c18 "12 years ago")  akeybl : [sec-approval+](#c18 "12 years ago") | [Details](/attachment.cgi?id=669347&action=edit) | [Diff](/attachment.cgi?id=669347&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798045&attachment=669347) |
| --- | --- | --- |
| [web page that demonstrates issue](/attachment.cgi?id=670198)  [12 years ago](#c24)  [Jason Duell](/user_profile?user_id=334931)   1.32 KB, text/html |  | [Details](/attachment.cgi?id=670198&action=edit) |
| [test v2](/attachment.cgi?id=670454)  [12 years ago](#c29)  [Jason Duell](/user_profile?user_id=334931)   1.37 KB, text/html |  | [Details](/attachment.cgi?id=670454&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Scoobidiver (away)](/user_profile?user_id=386758)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=798045#c0)• 12 years ago |
|  | |

It's #114 top browser crasher in 16.0b5 and seems to happen only in Beta versions with this signature: 15.0 or 16.0.
Signature arena\_dalloc\_small | je\_free | nsACString\_internal::`scalar deleting destructor''(unsigned int) More Reports Search
UUID c977c9fe-233d-4d8a-a1be-19ea42121004
Date Processed 2012-10-04 19:56:15
Uptime 82347
Last Crash 22.9 hours before submission
Install Age 4.4 days since version was first installed.
Install Time 2012-06-28 10:56:11
Product Firefox
Version 16.0
Build ID 20120925201946
Release Channel beta
OS Windows NT
OS Version 6.1.7600
Build Architecture x86
Build Architecture Info GenuineIntel family 6 model 42 stepping 7
Crash Reason EXCEPTION\_BREAKPOINT
Crash Address 0x6e8f01f1
App Notes
AdapterVendorID: 0x8086, AdapterDeviceID: 0x0116, AdapterSubsysID: 15ea10cf, AdapterDriverVersion: 8.15.10.2287
D2D? D2D+ DWrite? DWrite+ D3D10 Layers? D3D10 Layers+
EMCheckCompatibility True
Adapter Vendor ID 0x8086
Adapter Device ID 0x0116
Total Virtual Memory 2147352576
Available Virtual Memory 1357484032
System Memory Use Percentage 54
Available Page File 5218824192
Available Physical Memory 1687126016
Frame Module Signature Source
0 mozglue.dll arena\_dalloc\_small memory/mozjemalloc/jemalloc.c:4510
1 mozglue.dll je\_free memory/mozjemalloc/jemalloc.c:6565
2 xul.dll nsACString\_internal::`scalar deleting destructor'
3 xul.dll mozilla::net::FailDelayManager::Lookup netwerk/protocol/websocket/WebSocketChannel.cpp:218
4 xul.dll mozilla::net::FailDelayManager::DelayOrBegin netwerk/protocol/websocket/WebSocketChannel.cpp:229
5 xul.dll mozilla::net::nsWSAdmissionManager::ConditionallyConnect netwerk/protocol/websocket/WebSocketChannel.cpp:339
6 xul.dll mozilla::net::WebSocketChannel::OnLookupComplete netwerk/protocol/websocket/WebSocketChannel.cpp:2217
7 xul.dll `anonymous namespace'::DNSListenerProxy::OnLookupCompleteRunnable::Run netwerk/dns/nsDNSService2.cpp:552
8 xul.dll nsThread::ProcessNextEvent xpcom/threads/nsThread.cpp:624
9 xul.dll mozilla::ipc::MessagePump::Run ipc/glue/MessagePump.cpp:82
10 xul.dll MessageLoop::RunHandler ipc/chromium/src/base/message\_loop.cc:201
11 xul.dll MessageLoop::Run ipc/chromium/src/base/message\_loop.cc:175
12 xul.dll nsBaseAppShell::Run widget/xpwidgets/nsBaseAppShell.cpp:163
13 xul.dll nsAppShell::Run widget/windows/nsAppShell.cpp:232
14 xul.dll nsAppStartup::Run toolkit/components/startup/nsAppStartup.cpp:257
15 xul.dll XREMain::XRE\_mainRun toolkit/xre/nsAppRunner.cpp:3794
16 xul.dll XREMain::XRE\_main toolkit/xre/nsAppRunner.cpp:3871
17 xul.dll XRE\_main toolkit/xre/nsAppRunner.cpp:3947
18 firefox.exe wmain toolkit/xre/nsWindowsWMain.cpp:100
19 firefox.exe \_\_tmainCRTStartup crtexe.c:552
20 kernel32.dll BaseThreadInitThunk
21 ntdll.dll \_\_RtlUserThreadStart
22 ntdll.dll \_RtlUserThreadStart
More reports at:
<https://crash-stats.mozilla.com/report/list?signature=arena_dalloc_small+|+je_free+|+nsACString_internal%3A%3A%60scalar+deleting+destructor%27%27%28unsigned+int%29>

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=798045#c1)• 12 years ago |
|  | |

> 2 xul.dll nsACString\_internal::`scalar deleting destructor'
Do we know how this gets generated (instead of the normal foo.cpp:line# stack trace)?
Assuming this is indeed happening in a CString, that would be FailDelay.mAddress. But I don't see any obvious errors in how it's allocated/freed. Do we know of any jemalloc bugs that might be the cause of this?

|  | [Scoobidiver (away)](/user_profile?user_id=386758)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=798045#c2)• 12 years ago |
|  | |

With combined signatures, it's #15 top browser crasher in 16.0b6.
There are no interesting correlations.Crash Signature: [@ arena\_dalloc\_small | je\_free | nsACString\_internal::`scalar deleting destructor''(unsigned int)] → [@ arena\_dalloc\_small | je\_free | nsACString\_internal::`scalar deleting destructor''(unsigned int)]
[@ nsAString\_internal::Finalize()]
[@ arena\_dalloc\_small | je\_free | nsAutoString::`scalar deleting destructor''(unsigned int)]
[@ memmove | nsTArray\_ba…
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%3F)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---),
[topcrash](/buglist.cgi?keywords=topcrash&resolution=---)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a349491_425645)• 12 years ago |

[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=798045#c3)• 12 years ago |
|  | |

Assigning to you for investigation Jason, since this is in WebSockets. Also including Brian, since he landed the two networking changes in FF16b6.Assignee: nobody → jduell.mcbugs

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a350516_425645)• 12 years ago |

Group: core-security

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=798045#c4)• 12 years ago |
|  | |

bsmith suggests this may be sec-critical

|  | [Brian Smith (:briansmith, :bsmith, use NEEDINFO?)](/user_profile?user_id=14661) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=798045#c5)• 12 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-beta/annotate/c32d775d1039/netwerk/protocol/websocket/WebSocketChannel.cpp#l2215>
sWebSocketAdmissions->ConditionallyConnect(this);
Don't we need kung-fu death grip?

|  | [Brian Smith (:briansmith, :bsmith, use NEEDINFO?)](/user_profile?user_id=14661) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=798045#c6)• 12 years ago |
|  | |

<bsmith> I don't think it is that race.
<bsmith> Seems like it gets deleted during static destruction of nsWSAdmissionManager
<bsmith> I did notice this:
<bsmith> if (fail->mAddress.Equals(address) && fail->mPort == port) {
<bsmith> if (outIndex)
<bsmith> \*outIndex = i;
<bsmith> result = fail;
<bsmith> } else if (fail->IsExpired(rightNow)) {
<bsmith> seems like there shoul be a "break;" after result = fail;
<bsmith> Oh, I got it, I think
<bsmith> I'm pretty sure that's it
<bsmith> We set \*outIndex = i;
<bsmith> then, later, because we don't break, we delete some entries between 0 and i
<bsmith> but, we don't decrease i

|  | [Brian Smith (:briansmith, :bsmith, use NEEDINFO?)](/user_profile?user_id=14661) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=798045#c7)• 12 years ago |
|  | |

I would expect this to crash in line 252/253, not line 218. But, I think the compiler might be inlining this code so that a crash at line 253 is reported as a crash in line 218. See:
<https://mxr.mozilla.org/mozilla-beta/source/netwerk/protocol/websocket/WebSocketChannel.cpp?rev=6cd5f16a8c3c#216>
216 } else if (fail->IsExpired(rightNow)) {
217 mEntries.RemoveElementAt(i);
218 delete fail;
219 }
...
<https://mxr.mozilla.org/mozilla-beta/source/netwerk/protocol/websocket/WebSocketChannel.cpp?rev=6cd5f16a8c3c#251>
251 } else if (fail->IsExpired(rightNow)) {
252 mEntries.RemoveElementAt(failIndex);
253 delete fail;
254 }
See also:
<https://crash-stats.mozilla.com/query/query?product=Firefox&version=ALL%3AALL&range_value=1&range_unit=weeks&date=10%2F08%2F2012+23%3A27%3A41&query_search=signature&query_type=contains&query=DelayOrBegin&reason=&build_id=&process_type=any&hang_type=any&do_query=1>
Or, it could be a different problem.

|  | [Brian Smith (:briansmith, :bsmith, use NEEDINFO?)](/user_profile?user_id=14661) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=798045#c8)• 12 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #4](/show_bug.cgi?id=798045#c4 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup"))
> bsmith suggests this may be sec-critical
This seems likely to have been caused by the patch for [bug 711793](/show_bug.cgi?id=711793 "RESOLVED FIXED - Delay websocket reconnection after abnormal termination"), which also caused use-after-free [bug 771318](/show_bug.cgi?id=771318 "RESOLVED FIXED - Heap-use-after-free in nsWSAdmissionManager::OnStopSession"), which we're planning to release an advisory for. So, if this is exploitable, it is likely as close to (if not) a zero-day, especially if we release that advisory.
To avoid drawing even more attention to this code, I avoided adding it as blocking [bug 711793](/show_bug.cgi?id=711793 "RESOLVED FIXED - Delay websocket reconnection after abnormal termination") and I avoided mentioning this bug (and adding this comment) in [bug 771318](/show_bug.cgi?id=771318 "RESOLVED FIXED - Heap-use-after-free in nsWSAdmissionManager::OnStopSession"), just in case [bug 771318](/show_bug.cgi?id=771318 "RESOLVED FIXED - Heap-use-after-free in nsWSAdmissionManager::OnStopSession") gets opened up.Whiteboard: [blocking bug 711793, but see comment]

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=798045#c9)• 12 years ago |
|  | |

Attached patch

[v1](attachment.cgi?id=669347&action=diff)
— [Details](attachment.cgi?id=669347&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798045&attachment=669347)

Actually crash @ line 218 makes perfect sense here: when Lookup() returns an index for an item that is no longer valid, and it now happens to be off the end of the nsTArray, we only have MOZ\_ASSERT checks in RemoveElementAt() so it passes through in release builds and we then try to delete some garbage. Solution as bsmith suggested is to break once Lookup() finds a match. We'll get rid of any expired entries the next time it's called and nothing is found (which is the most common case), so stale entries are not an issue.
thanks to bsmith for tracking this down.
> Don't we need kung-fu death grip?
Good question, but not the bug at hand IMO. I've emailed bsmedberg about whether our sWebsocketAdmissions usage is safe, and will file a bug if not.
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: review?(bsmith)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=798045#c10)• 12 years ago |
|  | |

(In reply to Brian Smith (:bsmith) from [comment #8](/show_bug.cgi?id=798045#c8 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup"))
> (In reply to Alex Keybl [:akeybl] from [comment #4](/show_bug.cgi?id=798045#c4 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup"))
> > bsmith suggests this may be sec-critical
>
> This seems likely to have been caused by the patch for [bug 711793](/show_bug.cgi?id=711793 "RESOLVED FIXED - Delay websocket reconnection after abnormal termination"), which
> also caused use-after-free [bug 771318](/show_bug.cgi?id=771318 "RESOLVED FIXED - Heap-use-after-free in nsWSAdmissionManager::OnStopSession"), which we're planning to release an
> advisory for. So, if this is exploitable, it is likely as close to (if not)
> a zero-day, especially if we release that advisory.
[bug 771318](/show_bug.cgi?id=771318 "RESOLVED FIXED - Heap-use-after-free in nsWSAdmissionManager::OnStopSession") is in a roll-up advisory for Abhishek's ASAN bugs. We don't list it or a similar bug by number in the advisory because the issues never shipped in a release, being found and fixed before becoming public.

|  | [Brian Smith (:briansmith, :bsmith, use NEEDINFO?)](/user_profile?user_id=14661) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a358235_14661)• 12 years ago |

[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: review?(bsmith)
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: review+
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-release?
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-beta?
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-aurora?

|  | [Brian Smith (:briansmith, :bsmith, use NEEDINFO?)](/user_profile?user_id=14661) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=798045#c11)• 12 years ago |
|  | |

Comment on [attachment 669347](/attachment.cgi?id=669347 "v1") [[details]](/attachment.cgi?id=669347&action=edit "v1") [[diff]](/attachment.cgi?id=669347&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798045&attachment=669347)
v1
[Security approval request comment]
> How easily can the security issue be deduced from the patch?
I found the potential out-of-bounds memory access / double-free within 30 minutes, and I am not particularly good at this stuff.
> Do comments in the patch, the check-in comment, or tests
> included in the patch paint a bulls-eye on the security problem?
Review the comment in the patch.
> Which older supported branches are affected by this flaw?
> If not all supported branches, which bug introduced the flaw?
[Bug 711793](/show_bug.cgi?id=711793 "RESOLVED FIXED - Delay websocket reconnection after abnormal termination").
> Do you have backports for the affected branches?
> If not, how different, hard to create, and risky will they be?
Should apply easily.
> How likely is this patch to cause regressions; how much testing does it need?
Very unlikely / not much.
> Is there anything we could do to make this sec-approval form better?
Yes, please have it automatically formatted like I have done here.
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: sec-approval?

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=798045#c12)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/f9469bf48ff6>
re: exploitability. It's possible to cause this crash by creating several websockets to different host:ports and then delaying the TCP connect process differently per socket at reconnect time. I'm not sure how easy it is to then deterministically exploit the crash.

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=798045#c13)• 12 years ago |
|  | |

meh--sorry, still getting used to the sec-approval process.

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=798045#c14)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/f9469bf48ff6>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla19

|  | [Scoobidiver (away)](/user_profile?user_id=386758)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=798045#c15)• 12 years ago |
|  | |

a nit in the comment: "will be be deleted"

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=798045#c16)• 12 years ago |
|  | |

Comment on [attachment 669347](/attachment.cgi?id=669347 "v1") [[details]](/attachment.cgi?id=669347&action=edit "v1") [[diff]](/attachment.cgi?id=669347&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798045&attachment=669347)
v1
[Triage Comment]
Since this landed on m-i/m-c already, let's also get this on Aurora/Beta in preparation for possible 16.0.1 inclusion.
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-beta?
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-beta+
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-aurora?
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-aurora+

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=798045#c17)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/5764e33f79d6>
<https://hg.mozilla.org/releases/mozilla-aurora/rev/aff619c66f1e>
typo from [comment 15](/show_bug.cgi?id=798045#c15 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup") fixed there and in inbound.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=798045#c18)• 12 years ago |
|  | |

Comment on [attachment 669347](/attachment.cgi?id=669347 "v1") [[details]](/attachment.cgi?id=669347&action=edit "v1") [[diff]](/attachment.cgi?id=669347&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798045&attachment=669347)
v1
[Triage Comment]
To help prevent the possibility of a 16.0.2, let's land this fix in 16.0.1. Please land on mozilla-release asap.
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: sec-approval?
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: sec-approval+
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-release?
[Attachment #669347](/attachment.cgi?id=669347&action=edit "v1") -
Flags: approval-mozilla-release+

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=798045#c19)• 12 years ago |
|  | |

Is there a testcase or steps to reproduce this crash? Given this is being uplifted to release, QA would like to be able to verify it is fixed.Keywords: [steps-wanted](/buglist.cgi?keywords=steps-wanted&resolution=---),
[testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=798045#c20)• 12 years ago |
|  | |

alex asked me on irc to land this on release
<https://hg.mozilla.org/releases/mozilla-release/rev/f24140f9a4d4>

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a504744_32546)• 12 years ago |

[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=fixed)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=798045#c21)• 12 years ago |
|  | |

Marking as ESR10 unaffected based upon [comment 11](/show_bug.cgi?id=798045#c11 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup").
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)

|  | [juan becerra [:juanb]](/user_profile?user_id=241759) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=798045#c22)• 12 years ago |
|  | |

If you have any suggestions on how to test this, please let us know. We'll have Fx16.0.1 builds ready sometime this evening, and any instructions would be helpful.

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=798045#c23)• 12 years ago |
|  | |

I'm writing a test for this right now... stay tuned.

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=798045#c24)• 12 years ago |
|  | |

Attached file
[web page that demonstrates issue](attachment.cgi?id=670198) (obsolete)
— [Details](attachment.cgi?id=670198&action=edit)

So this webpage (you can either open it as a file or serve it off a webserver) crashes without the patch and is OK with it. Crashes in opt-builds (such as the release) are harder to cause deterministically (in debug mode we hit an assert: in release mode we try to delete off the end of an array and that doesn't always crash), but I'm confident this is catching the cause of the crash.
Note that this test takes 70 seconds to run, so I don't think we want to make a mochitest out of it. We're not likely to regress this codepath in this way again, so I think that's ok.

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a530302_334931)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a537176_1689)• 12 years ago |

Alias: CVE-2012-4191Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)Whiteboard: [blocking bug 711793, but see comment] → [blocking bug 711793, but see comment 8]

|  | [juan becerra [:juanb]](/user_profile?user_id=241759) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=798045#c25)• 12 years ago |
|  | |

I tried Fx16 and Fx16.0.1 builds but neither of them crashed on Windows 7. I tried a Mac nightly debug build where an older version crashed but the latest one didn't. I'm changing the status-firefox16 flag based on this and [comment #24](/show_bug.cgi?id=798045#c24 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup").
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=verified)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=798045#c26)• 12 years ago |
|  | |

I was unable to reproduce a crash with the attached testcase using Firefox 17.0b1#1, 17.0b1#2, 2012-10-10 mozilla-beta debug, 2012-10-09 mozilla-beta debug, and 2012-10-07 mozilla-beta debug builds on Windows 7.
Given these results, I don't think we can mark this verified for Firefox 17. If someone else is able to reproduce this more easily, please help by verifying this for Firefox 17.0b1#2, Firefox 18.0a2, and Firefox 19.0a1 builds.
That said, I'm not going to block Firefox 17b1's release if this goes unverified. I'm basing this decision on [comment 24](/show_bug.cgi?id=798045#c24 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup") and 25.

|  | [Scoobidiver (away)](/user_profile?user_id=386758)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=798045#c27)• 12 years ago |
|  | |

(In reply to juan becerra [:juanb] from [comment #25](/show_bug.cgi?id=798045#c25 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup"))
> I tried Fx16 and Fx16.0.1 builds but neither of them crashed on Windows 7.
So it's not verified.
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[verified](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=verified) → [fixed](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=fixed)

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=798045#c28)• 12 years ago |
|  | |

Typo fix:
<https://hg.mozilla.org/mozilla-central/rev/b310e265f26c>

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=798045#c29)• 12 years ago |
|  | |

Attached file
[test v2](attachment.cgi?id=670454)
— [Details](attachment.cgi?id=670454&action=edit)

This version has just crashed FF 16 for me on linux 3 out of 6 times. I consider that good enough, given that we have crash reports that point us right at the line number that's failing, a very exact understanding of the bug, and deterministic failure in debug mode.
[Attachment #670198](/attachment.cgi?id=670198&action=edit "web page that demonstrates issue") -
Attachment is obsolete: true

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=798045#c30)• 12 years ago |
|  | |

Unfortunately, I'm still not able to trigger a crash using test v2. I tried Firefox 17.0b1 build 1 on Linux 64-bit and 2012-10-09 mozilla-beta debug (Firefox 17) on Windows 7 32-bit. I tried 7 times on each waiting 2 minutes before reloading the test. Still no crash.
I think we are going to have to ship without explicit verification here, trusting Jason's assessment and crash reports as pointed out in [comment 29](/show_bug.cgi?id=798045#c29 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup").

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a1039409_279076)• 12 years ago |

Whiteboard: [blocking bug 711793, but see comment 8] → [blocking bug 711793, but see comment 8][qa-]

|  | [Jason Duell](/user_profile?user_id=334931)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=798045#c31)• 12 years ago |
|  | |

Followup on [comment 5](/show_bug.cgi?id=798045#c5 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup") (which we were wondering might need a separate bug):
> Don't we need kung-fu death grip [on sWebSocketAdmissions]?
After talking to bsmedberg about this: No, we're guaranteed that since we don't destroy sWebSocketAdmissions until XPCOM shutdown, we can rely on it existing during any XPCOM events that we dispatch. We won't handle any events after shutdown is called.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a8495565_1689)• 12 years ago |

Group: core-security

|  | [Virgil Dicu [:virgil] [QA]](/user_profile?user_id=421602) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=798045#c32)• 12 years ago |
|  | |

I tried to reproduce a crash with attachment from [comment 29](/show_bug.cgi?id=798045#c29 "VERIFIED FIXED - crash in mozilla::net::FailDelayManager::Lookup") on Firefox 16.0 beta 5 with no luck.
No crashes also for Firefox 19.0 beta 5
Mozilla/5.0 (Windows NT 6.1; rv:19.0) Gecko/20100101 Firefox/19.0
Build ID: 20130206083616
Crash reports are not showing any crashes with these signatures.
Moving this to verified.
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798045#a95634856_75935)• 9 years ago |

Keywords: [testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)
You need to [log in](/show_bug.cgi?id=798045&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jason Duell](/user_profile?user_id=334931)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_5479b0ee_20250125_074124.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2012-88

## Miscellaneous memory safety hazards (rv:16.0.1)

Announced
October 11, 2012
Reporter
Mozilla Developers
Impact
Critical
Products
Firefox, SeaMonkey, Thunderbird
Fixed in

* Firefox 16.0.1
* SeaMonkey 2.13.1
* Thunderbird 16.0.1

### Description

Mozilla developers identified and fixed two top crashing bugs in the
browser engine used in Firefox and other Mozilla-based products. These bugs showed evidence of memory corruption under certain circumstances, and we
presume that with enough effort at least some of these could be exploited to run
arbitrary code.

The first of these bugs, a FreeType issue, is a mobile only issue which happens on custom kernels like Cyanogenmod, not on standard Android installations. The second bug is a websockets crash affecting Firefox 16 but not Firefox ESR.

### References

* [crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10](https://bugzilla.mozilla.org/show_bug.cgi?id=790139)
* [CVE-2012-4190](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4190)

* [crash in mozilla::net::FailDelayManager::Lookup](https://bugzilla.mozilla.org/show_bug.cgi?id=798045)
* [CVE-2012-4191](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4191)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_071944.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_3659d679_20250126_071944.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_1140f604_20250126_071942.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/790139)
* [XML](/show_bug.cgi?ctype=xml&id=790139)

Closed
[Bug 790139](/show_bug.cgi?id=790139)
(CVE-2012-4190)

Opened 12 years ago
Closed 12 years ago

# crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10

## Categories

### (Core :: Graphics, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics#Graphics)

Graphics
▾

Core :: Graphics
Mapping of cross platform rendering interfaces to various 2D graphics APIs
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

ARM

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=verified) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | + | verified |
| firefox17 | + | verified |
| firefox18 | + | verified |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: MarcoZ, Assigned: blassey)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2e65c829d6f9d9ccf3e84753a00fb8aa?d=mm&size=40)  [blassey](/user_profile?user_id=181004)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/3be472321f8ced3986562b808499a0a4?d=mm&size=40)  [kbrosnan](/user_profile?user_id=406670)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/f1e1a6449f9eae9775fc16880beea9ab?d=mm&size=40)  [MarcoZ](/user_profile?user_id=285656)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/17436ade8da1b23d42b3df05b9c4fc77?d=mm&size=40)  [bhood](/user_profile?user_id=697075)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

30 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[756140](/show_bug.cgi?id=756140 "RESOLVED DUPLICATE - Crash when quitting fennec native on Custom kernels"), [790528](/show_bug.cgi?id=790528 "VERIFIED DUPLICATE - Crashes when loading a second web page"), [791781](/show_bug.cgi?id=791781 "RESOLVED DUPLICATE - Crash on startup with CM10 & TF201"), [792260](/show_bug.cgi?id=792260 "RESOLVED DUPLICATE - crash in libxul"), [795570](/show_bug.cgi?id=795570 "RESOLVED DUPLICATE - crash in ft_mem_free | Destroy_Module"), [795710](/show_bug.cgi?id=795710 "RESOLVED DUPLICATE - Any Firefox version constantly crashes on CM10 nightlies")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[756140](/show_bug.cgi?id=756140 "RESOLVED DUPLICATE - Crash when quitting fennec native on Custom kernels")

## Details

### (5 keywords, Whiteboard: [native-crash][startupcrash])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2012-4190

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[reproducible](/buglist.cgi?keywords=reproducible&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---),
[topcrash](/buglist.cgi?keywords=topcrash&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[native-crash][startupcrash]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

2

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsTArray\_base<nsTArrayFallibleAllocator>::ShiftData | FT2FontEntry::CreateFontEntry ]](https://crash-stats.mozilla.org/signature/?signature=nsTArray_base%3CnsTArrayFallibleAllocator%3E%3A%3AShiftData%20%7C%20FT2FontEntry%3A%3ACreateFontEntry)

[[@ libxul.so@0xf81fe8 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf81fe8)

[[@ libxul.so@0xf79178 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf79178)

[[@ libxul.so@0xf819e8 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf819e8)

[[@ libxul.so@0xf79da8 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf79da8)

[[@ libxul.so@0xf7e4f0 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf7e4f0)

[[@ libxul.so@0xf8bf20 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf8bf20)

[[@ libxul.so@0xf7d7f8 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf7d7f8)

[[@ libxul.so@0xf88f68 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf88f68)

[[@ libxul.so@0xf82c40 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf82c40)

[[@ libxul.so@0xf769c8 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf769c8)

[[@ libxul.so@0xf76be8 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf76be8)

[[@ libxul.so@0xf74050 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf74050)

[[@ libxul.so@0xf7ce76 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf7ce76)

[[@ libxul.so@0xf76528 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf76528)

[[@ libxul.so@0xf8c4b0 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf8c4b0)

[[@ libxul.so@0xf866e0 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400xf866e0)

[[@ libxul.so@0x1023c28 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400x1023c28)

[[@ libxul.so@0x10241c0 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400x10241c0)

[[@ libxul.so@0x1024e28 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400x1024e28)

[[@ libxul.so@0x1034620 ]](https://crash-stats.mozilla.org/signature/?signature=libxul.so%400x1034620)

[[@ ft\_module\_get\_service ]](https://crash-stats.mozilla.org/signature/?signature=ft_module_get_service)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 2 obsolete files)

| [logcat log file when crashing Firefox](/attachment.cgi?id=660724)  [12 years ago](#c5)  [Daniel Lombraña González](/user_profile?user_id=374143)   779 bytes, text/plain |  | [Details](/attachment.cgi?id=660724&action=edit) |
| --- | --- | --- |
| [logcat file when crashing Firefox in reader mode CM10](/attachment.cgi?id=661312)  [12 years ago](#c13)  [Daniel Lombraña González](/user_profile?user_id=374143)   394.02 KB, text/plain |  | [Details](/attachment.cgi?id=661312&action=edit) |
| [stack](/attachment.cgi?id=662983)  [12 years ago](#c26)  [(not currently active) Ted Mielczarek](/user_profile?user_id=39022)   4.04 KB, text/plain |  | [Details](/attachment.cgi?id=662983&action=edit) |
| [patch](/attachment.cgi?id=665635)  [12 years ago](#c40)  [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)   717 bytes, patch | blassey : [review-](#a2137344_181004 "12 years ago") | [Details](/attachment.cgi?id=665635&action=edit) | [Diff](/attachment.cgi?id=665635&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=665635) |
| [logging patch](/attachment.cgi?id=666574)  [12 years ago](#c46)  [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)   4.24 KB, patch |  | [Details](/attachment.cgi?id=666574&action=edit) | [Diff](/attachment.cgi?id=666574&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=666574) |
| [Valgrind trace -- invalid writes](/attachment.cgi?id=667044)  [12 years ago](#c59)  [Julian Seward [:jseward]](/user_profile?user_id=346453)   32.09 KB, text/plain |  | [Details](/attachment.cgi?id=667044&action=edit) |
| [patch to force us to use in tree setlcdfilter](/attachment.cgi?id=668513)  [12 years ago](#c80)  [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)   1.37 KB, text/plain |  | [Details](/attachment.cgi?id=668513&action=edit) |
| [patch to force us to use in tree setlcdfilter](/attachment.cgi?id=668517)  [12 years ago](#c81)  [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)   2.84 KB, patch | jfkthame : [review+](#c83 "12 years ago")  akeybl : [approval-mozilla-aurora+](#c86 "12 years ago")  akeybl : [approval-mozilla-beta-](#c86 "12 years ago")  akeybl : [approval-mozilla-release+](#c95 "12 years ago") | [Details](/attachment.cgi?id=668517&action=edit) | [Diff](/attachment.cgi?id=668517&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=668517) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Marco Zehe (:MarcoZ)](/user_profile?user_id=285656)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=790139#c0)• 12 years ago |
|  | |

This bug was filed from the Socorro interface and is
report [bp-07fb607e-9105-4fad-9ecc-1534e2120911](https://crash-stats.mozilla.org/report/index/07fb607e-9105-4fad-9ecc-1534e2120911) .
=============================================================
According to community member Peter Vagner, this happens on <http://nightly.mozilla.org>, or often when he turns on Reader Mode. An installation of AdBlock doesn't seem to have any bearing. Have been unsuccessful in reproducing so far, but will keep trying.

|  | [Peter Vágner](/user_profile?user_id=323127) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=790139#c1)• 12 years ago |
|  | |

Hello,
I have got some more details:
I am using Samsung galaxy S II GTI9100 with CM-10 20120908 as of now but am updating the rom quite frequently.
Originally I have assumed the crashes might be related because of the accessibility support. After I got the fact Marco is unable to reproduce it I started to believe this might have something to do with my device / software combination. So I have attempted to load this bug url in the nightly running on the device so I will try to comment on the issue directly from the device. First the page loaded fine, I was able to read the content. Then I have tried to login but I was unsuccessfull. So I have used my PC to reset the password. Then I have again returned to the mobile to open this bug url and ooops, the crash occured as well.
I am not going to uninstall and then install nightly back in case someone knowledgeable enough recommends doing something what might help.
I have tried to dump a adb logcat into a file, however I have got 2 MB file. And I am not sure this is helpfull.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=790139#c2)• 12 years ago |
|  | |

It's our #1 top crasher.
Can you narrow down the logcat at the crash time and attach it to this bug?Summary: crash in libxul → crash in libxul.so@0xf... with custom ROMWhiteboard: [native-crash]

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=790139#c4)• 12 years ago |
|  | |

Hi,
I can confirm this bug right now:
<http://crash-stats.mozilla.com/report/index/bp-5af1177d-740d-4892-beba-681f42120913>
It seems like browsing has been fixed without problems, because yesterday I barely could load any page with nightly and today it seems to be working more or less fine. The only problem is that as soon as I enable the reader mode in any page it crashes automatically. I've reproduced this behavior with and without Ad-Block plus so I guess it doesn't matter.
I've started within the phone the logcat command and adjoining you should see it. I do not find too much related info, but in any case if I'm doing something wrong, let me know it, ok?
I'm also using CM10.

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=790139#c5)• 12 years ago |
|  | |

Attached file
[logcat log file when crashing Firefox](attachment.cgi?id=660724) (obsolete)
— [Details](attachment.cgi?id=660724&action=edit)

|  | [Peter Vágner](/user_profile?user_id=323127) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=790139#c6)• 12 years ago |
|  | |

While trying to capture the logcat I did the following.
- connected the USB cable with debugging turned on
- typed an nightly.mozilla.org into the avesome bar.
- typed adb logcat > logcat.log on the terminal running on a PC
- Tapped search button, waited a few second to see the crash reporter dialog,
- submitted the crash closing nightly,
- ended up on the android desktop,
- exited adb window by pressing ctrl+c.
I dont know how to make less verbose log with relevant info. Mine is about 2 MB in size.
If you can recommend me some reading material I would be happy to cooperate if it may help to identify and fix the issue.

|  | [Peter Vágner](/user_profile?user_id=323127) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=790139#c7)• 12 years ago |
|  | |

some more things I have noticed.
On my device auto updates are not working. When I am going to menu -> settings -> about firefox and tapping check for updates, I am getting a prompt "no update available".
I have updated manually to sep 12 nightly build but crashes still persist. I can always reproduce it by going to <http://nightly.mozilla.org/>
Might the updater issue be related somehow?

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=790139#c8)• 12 years ago |
|  | |

Hi,
As Peter I experienced the problem of the updates also in my previous CM9, now after reinstalling everything, CM10, the updates are coming back. However, the reader mode stills failing each time I enable it in the browser (it doesn't matter the page).
Cheers,
Daniel

|  | [Peter Vágner](/user_profile?user_id=323127) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=790139#c9)• 12 years ago |
|  | |

I have installed CM-10 at the end of the jully and was occassionally updating it. Since 6 sep update of CM-10 updates no longer work for me.
I am not sure if this is because of CM-10 20120906 and newer or firefox 5 sep or newer.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=790139#c10)• 12 years ago |
|  | |

(In reply to Peter Vágner from [comment #6](/show_bug.cgi?id=790139#c6 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> I dont know how to make less verbose log with relevant info. Mine is about 2
> MB in size.
Try to note the exact time of the crash based on your phone clock and select in the log everything that happen two seconds before and after.
(In reply to Peter Vágner from [comment #7](/show_bug.cgi?id=790139#c7 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> Might the updater issue be related somehow?
It's [bug 789791](/show_bug.cgi?id=789791 "VERIFIED FIXED - Firefox for Android Nightly 20120905 fails to update (\"No updates found\") if system language is not en-US") and not related because this bug happens in en-US builds and before September 5.Crash Signature: [@ libxul.so@0xf81fe8] → [@ libxul.so@0xf81fe8]
[@ libxul.so@0xf79178]
[@ libxul.so@0xf819e8]
[@ libxul.so@0xf79da8]
[@ libxul.so@0xf7e4f0]
[@ libxul.so@0xf8bf20]
[@ libxul.so@0xf7d7f8]
[@ libxul.so@0xf88f68]
[@ libxul.so@0xf82c40]
[@ libxul.so@0xf769c8]
[@ libxul.so@0x…
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%3F)Keywords: [topcrash](/buglist.cgi?keywords=topcrash&resolution=---)Summary: crash in libxul.so@0xf... with custom ROM → crash in libxul.so@0xf... while enabling Reader Mode on custom kernelsVersion: Firefox 18 → Trunk

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a295998_386758)• 12 years ago |

Crash Signature: libxul.so@0xf76be8]
[@ libxul.so@0xf74050]
[@ libxul.so@0xf7ce76]
[@ libxul.so@0xf76528] → libxul.so@0xf76be8]
[@ libxul.so@0xf74050]
[@ libxul.so@0xf7ce76]
[@ libxul.so@0xf76528]
[@ libxul.so@0xf8c4b0]
[@ libxul.so@0xf866e0]

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=790139#c11)• 12 years ago |
|  | |

Updated today to the latest version (by the way, is the browser downloading in the background the updates automatically? because right now I only get a notification saying: apply downloaded version) and the same problem, when enabling reader mode crashes.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=790139#c12)• 12 years ago |
|  | |

(In reply to Daniel Lombraña González from [comment #11](/show_bug.cgi?id=790139#c11 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> Updated today to the latest version [...] and the same problem
It's normal, nobody is assigned to fix it because we are waiting the logcat.
Note that custom kernels are not officially supported.See Also: → [756140](/show_bug.cgi?id=756140 "RESOLVED DUPLICATE - Crash when quitting fennec native on Custom kernels")

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=790139#c13)• 12 years ago |
|  | |

Attached file
[logcat file when crashing Firefox in reader mode CM10](attachment.cgi?id=661312)
— [Details](attachment.cgi?id=661312&action=edit)

build.board: aries
build.bootloader: unknown
build.brand: samsung
build.cpu\_abi: armeabi-v7a
build.cpu\_abi2: armeabi
build.device: GT-I9000
build.display: cm\_galaxysmtd-userdebug 4.1.1 JRO03L eng..20120909.192301 test-keys
build.fingerprint: samsung/GT-I9000/GT-I9000:2.3.5/GINGERBREAD/XXJVT:user/release-keys
build.hardware: aries
build.host: cyanogenmod
build.id: JRO03L
build.manufacturer: samsung
build.model: GT-I9000
build.product: GT-I9000
build.radio: unknown
build.serial: 39307058339800EC
build.tags: test-keys
build.time: 1347243800000
build.type: userdebug
build.user: unknown
version.codename: REL
version.incremental: eng..20120909.192301
version.release: 4.1.1
version.sdk\_int: 16

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=790139#c14)• 12 years ago |
|  | |

Scoobiediver, do you need something else?

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a348540_386758)• 12 years ago |

[Attachment #660724](/attachment.cgi?id=660724&action=edit "logcat log file when crashing Firefox") -
Attachment is obsolete: true

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=790139#c15)• 12 years ago |
|  | |

Daniel, with today's build do you hit this bug or [bug 791462](/show_bug.cgi?id=791462 "RESOLVED FIXED - IonMonkey: SIGILL in js::ion::Cannon on Snapdragon CPUs")?

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a491785_386758)• 12 years ago |

Crash Signature: libxul.so@0xf76be8]
[@ libxul.so@0xf74050]
[@ libxul.so@0xf7ce76]
[@ libxul.so@0xf76528]
[@ libxul.so@0xf8c4b0]
[@ libxul.so@0xf866e0] → libxul.so@0xf76be8]
[@ libxul.so@0xf74050]
[@ libxul.so@0xf7ce76]
[@ libxul.so@0xf76528]
[@ libxul.so@0xf8c4b0]
[@ libxul.so@0xf866e0]
[@ libxul.so@0x1023c28]
[@ libxul.so@0x10241c0]

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=790139#c16)• 12 years ago |
|  | |

Hi,
I keep getting the same crash. Do you want another logcat file?
Daniel

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=790139#c17)• 12 years ago |
|  | |

(In reply to Daniel Lombraña González from [comment #16](/show_bug.cgi?id=790139#c16 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> I keep getting the same crash. Do you want another logcat file?
No. I though the crash signature morphed into a better one but it's a new one.

|  | [Peter Vágner](/user_profile?user_id=323127) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=790139#c18)• 12 years ago |
|  | |

Hello,
I have skipped a few builds however now with build 2012-09-16 I am no longer getting crashes while browsing e.g. nightly.mozilla.org. I am still getting crashes when enabling reader mode.
Anyway it is now verry usable for me again.
thanks for what you all are doing.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a703529_386758)• 12 years ago |

Crash Signature: libxul.so@0xf76be8]
[@ libxul.so@0xf74050]
[@ libxul.so@0xf7ce76]
[@ libxul.so@0xf76528]
[@ libxul.so@0xf8c4b0]
[@ libxul.so@0xf866e0]
[@ libxul.so@0x1023c28]
[@ libxul.so@0x10241c0] → libxul.so@0xf76be8]
[@ libxul.so@0xf74050]
[@ libxul.so@0xf7ce76]
[@ libxul.so@0xf76528]
[@ libxul.so@0xf8c4b0]
[@ libxul.so@0xf866e0]
[@ libxul.so@0x1023c28]
[@ libxul.so@0x10241c0]
[@ libxul.so@0x1024e28]
[@ libxul.so@0x1034620]

|  | [Russell Haley](/user_profile?user_id=450836) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=790139#c20)• 12 years ago |
|  | |

This crash can be triggered on Nightly and Aurora on CM10 M1 and CM10 Nightly 20120919 by going to about:firefox and clicking the "Release Notes" link. The issue also occurs with some other pagees on the internet, with enough frequency that I am tmemporarily using the native browser and dealing with the ads. Reader Mode is not necessary.
Here is a logcat:
<http://pastebin.com/iq7hhhRf>

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a752715_448925)• 12 years ago |

[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=790139#c21)• 12 years ago |
|  | |

Based on crash stats, it seems there's a better stack trace in today's build.
For those who crash when entering Reader Mode, can you provide the crash ID with the latest Nightly to confirm?

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=790139#c22)• 12 years ago |
|  | |

Hi Scoobidiver,
I've a problem, because with the latest version, the crashes are worst. Now each time I try to access, about:crashes, firefox crashes as soon as I try to zoom in or I touch the screen. How can I send you the ID of the crash?

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=790139#c23)• 12 years ago |
|  | |

Do you crash when you zoom in or touch the screen only in about:crashes or on any web pages?
Do you still crash while entering Reader Mode?

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=790139#c24)• 12 years ago |
|  | |

It crashes more often again on loading pages, but there is no a pattern for this yet. However, in the about:crashes web page as soon as I touch the screen it crashes. The same if I try to zoom, which obviously involves touching the screen :-) Reader mode stills failing :(

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=790139#c25)• 12 years ago |
|  | |

More reports at:
<https://crash-stats.mozilla.com/report/list?signature=js%3A%3Agc%3A%3AMarkObjectRange>Assignee: nobody → generalCrash Signature: [@ libxul.so@0xf81fe8]
[@ libxul.so@0xf79178]
[@ libxul.so@0xf819e8]
[@ libxul.so@0xf79da8]
[@ libxul.so@0xf7e4f0]
[@ libxul.so@0xf8bf20]
[@ libxul.so@0xf7d7f8]
[@ libxul.so@0xf88f68]
[@ libxul.so@0xf82c40]
[@ libxul.so@0xf769c8]
[@ libxul.so@0x… → [@ js::gc::MarkObjectRange ]
[@ libxul.so@0xf81fe8]
[@ libxul.so@0xf79178]
[@ libxul.so@0xf819e8]
[@ libxul.so@0xf79da8]
[@ libxul.so@0xf7e4f0]
[@ libxul.so@0xf8bf20]
[@ libxul.so@0xf7d7f8]
[@ libxul.so@0xf88f68]
[@ libxul.so@0xf82c40]
[@ libxu…Component: General → JavaScript EngineProduct: Firefox for Android → CoreWhiteboard: [native-crash] → [native-crash][startupcrash]

|  | [(not currently active) Ted Mielczarek](/user_profile?user_id=39022) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=790139#c26)• 12 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=662983)
— [Details](attachment.cgi?id=662983&action=edit)

Here's a more reasonable stack from 07fb607e-9105-4fad-9ecc-1534e2120911. I got this using my dump-lookup tool: <http://hg.mozilla.org/users/tmielczarek_mozilla.com/dump-lookup/>

|  | [Guillermo López :willyaranda (probably SLOW response)](/user_profile?user_id=200980) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=790139#c27)• 12 years ago |
|  | |

My problem is totally unrelated with the Reader mode, as this happens with any page, as [comment #24](/show_bug.cgi?id=790139#c24 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10") says.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a806599_386758)• 12 years ago |

Assignee: general → nobodyCrash Signature: [@ js::gc::MarkObjectRange ]
[@ libxul.so@0xf81fe8]
[@ libxul.so@0xf79178]
[@ libxul.so@0xf819e8]
[@ libxul.so@0xf79da8]
[@ libxul.so@0xf7e4f0]
[@ libxul.so@0xf8bf20]
[@ libxul.so@0xf7d7f8]
[@ libxul.so@0xf88f68]
[@ libxul.so@0xf82c40]
[@ libxu… → [@ nsTArray\_base<nsTArrayFallibleAllocator>::ShiftData | FT2FontEntry::CreateFontEntry]
[@ js::gc::MarkObjectRange ]
[@ libxul.so@0xf81fe8]
[@ libxul.so@0xf79178]
[@ libxul.so@0xf819e8]
[@ libxul.so@0xf79da8]
[@ libxul.so@0xf7e4f0]
[@ libxul.so@0x…Component: JavaScript Engine → GraphicsSummary: crash in libxul.so@0xf... while enabling Reader Mode on custom kernels → crash in FT2FontEntry::CreateFontEntry while enabling Reader Mode on custom kernels

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=790139#c28)• 12 years ago |
|  | |

(In reply to Guillermo López (:willyaranda) from [comment #27](/show_bug.cgi?id=790139#c27 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> My problem is totally unrelated with the Reader mode, as this happens with
> any page, as [comment #24](/show_bug.cgi?id=790139#c24 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10") says.
Different steps to reproduce can generate the same crash signature.

|  | [Robert Kaiser](/user_profile?user_id=5189) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=790139#c29)• 12 years ago |
|  | |

Hmm, FT2FontEntry::CreateFontEntry is freetype and that reminds me heavily of what [bug 756140 comment #13](/show_bug.cgi?id=756140#c13 "RESOLVED DUPLICATE - Crash when quitting fennec native on Custom kernels") also is talking about - "Unlike Android, Cyanogenmod builds freetype with subpixel rendering enabled".
Maybe there's some connection of all those libxul.so@foo crashes there.

|  | [Kartikaya Gupta (email:kats@mozilla.staktrace.com)](/user_profile?user_id=426788) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=790139#c30)• 12 years ago |
|  | |

I attached gdb and reproduced the crash that AaronMT was seeing on his TF201 with CyanogenMod 10. This was the backtrace I got (definitely looks font-related):
0x643c83d8 in ft\_module\_get\_service () from /Users/kats/zspace/mozilla-git/obj-android-debug/dist/bin/libxul.so
Loading symbols... Done
(gdb) bt
#0 0x643c83d8 in ft\_module\_get\_service () from /Users/kats/zspace/mozilla-git/obj-android-debug/dist/bin/libxul.so
#1 0x64400058 in sfnt\_init\_face () from /Users/kats/zspace/mozilla-git/obj-android-debug/dist/bin/libxul.so
#2 0x643d15b0 in tt\_face\_init () from /Users/kats/zspace/mozilla-git/obj-android-debug/dist/bin/libxul.so
#3 0x643c4ef4 in open\_face () from /Users/kats/zspace/mozilla-git/obj-android-debug/dist/bin/libxul.so
#4 0x643c5f8a in FT\_Open\_Face () from /Users/kats/zspace/mozilla-git/obj-android-debug/dist/bin/libxul.so
#5 0x643c5002 in FT\_New\_Memory\_Face () from /Users/kats/zspace/mozilla-git/obj-android-debug/dist/bin/libxul.so
#6 0x63dc6206 in FT2FontEntry::CreateFontEntry (aProxyEntry=..., aFontData=0x67840000 "", aLength=106400) at /Users/kats/zspace/mozilla-git/gfx/thebes/gfxFT2FontList.cpp:170
#7 0x63dc3f98 in gfxAndroidPlatform::MakePlatformFont (this=<optimized out>, aProxyEntry=<optimized out>, aFontData=<optimized out>, aLength=<optimized out>)
at /Users/kats/zspace/mozilla-git/gfx/thebes/gfxAndroidPlatform.cpp:164
#8 0x63dbdd40 in gfxUserFontSet::LoadFont (this=0x65c66880, aProxy=0x677ebf00, aFontData=0x67830000 "wOFF", aLength=@0x5df28654: 63712)
at /Users/kats/zspace/mozilla-git/gfx/thebes/gfxUserFontSet.cpp:690
#9 0x63dbe316 in gfxUserFontSet::OnLoadComplete (this=0x65c66880, aProxy=0x677ebf00, aFontData=0x67830000 "wOFF", aLength=63712, aDownloadStatus=0)
at /Users/kats/zspace/mozilla-git/gfx/thebes/gfxUserFontSet.cpp:472
#10 0x633bb6f2 in nsFontFaceLoader::OnStreamComplete (this=0x6a1ee3d0, aLoader=0x6a1ee400, aContext=<optimized out>, aStatus=0, aStringLen=63712, aString=0x67830000 "wOFF")
at /Users/kats/zspace/mozilla-git/layout/style/nsFontFaceLoader.cpp:211
#11 0x6317de16 in nsStreamLoader::OnStopRequest (this=0x6a1ee400, request=<optimized out>, ctxt=<optimized out>, aStatus=0) at /Users/kats/zspace/mozilla-git/netwerk/base/src/nsStreamLoader.cpp:95
#12 0x634645ac in nsCORSListenerProxy::OnStopRequest (this=0x679d70b0, aRequest=0x679b9834, aContext=0x0, aStatusCode=0)
at /Users/kats/zspace/mozilla-git/content/base/src/nsCrossSiteListenerProxy.cpp:604
#13 0x631921ae in nsHTTPCompressConv::OnStopRequest (this=<optimized out>, request=<optimized out>, aContext=<optimized out>, aStatus=<optimized out>)
at /Users/kats/zspace/mozilla-git/netwerk/streamconv/converters/nsHTTPCompressConv.cpp:94
#14 0x6317d5c2 in nsStreamListenerTee::OnStopRequest (this=0x650294e0, request=0x679b9834, context=0x0, status=0) at /Users/kats/zspace/mozilla-git/netwerk/base/src/nsStreamListenerTee.cpp:49
#15 0x631ea93a in mozilla::net::nsHttpChannel::OnStopRequest (this=0x679b9800, request=<optimized out>, ctxt=<optimized out>, status=0)
at /Users/kats/zspace/mozilla-git/netwerk/protocol/http/nsHttpChannel.cpp:4974
#16 0x63164162 in nsInputStreamPump::OnStateStop (this=0x679dc8e0) at /Users/kats/zspace/mozilla-git/netwerk/base/src/nsInputStreamPump.cpp:552
#17 0x63164238 in nsInputStreamPump::OnInputStreamReady (this=0x679dc8e0, stream=<optimized out>) at /Users/kats/zspace/mozilla-git/netwerk/base/src/nsInputStreamPump.cpp:374
#18 0x63d3cfd2 in nsInputStreamReadyEvent::Run (this=0x677fe540) at /Users/kats/zspace/mozilla-git/xpcom/io/nsStreamUtils.cpp:82
#19 0x63d4c57e in nsThread::ProcessNextEvent (this=0x5e1510f0, mayWait=<optimized out>, result=0x5df288b7) at /Users/kats/zspace/mozilla-git/xpcom/threads/nsThread.cpp:624
#20 0x63d17f86 in NS\_ProcessNextEvent\_P (thread=0x5e1510f0, mayWait=<optimized out>) at /Users/kats/zspace/mozilla-git/obj-android-debug/xpcom/build/nsThreadUtils.cpp:220
#21 0x63bf23b6 in mozilla::ipc::MessagePump::Run (this=0x5e1532e0, aDelegate=0x5e17f0e0) at /Users/kats/zspace/mozilla-git/ipc/glue/MessagePump.cpp:82
#22 0x63d7ad1a in MessageLoop::RunInternal (this=0x5e17f0e0) at /Users/kats/zspace/mozilla-git/ipc/chromium/src/base/message\_loop.cc:208
#23 0x63d7ad78 in RunHandler (this=0x5e17f0e0) at /Users/kats/zspace/mozilla-git/ipc/chromium/src/base/message\_loop.cc:201
#24 MessageLoop::Run (this=0x5e17f0e0) at /Users/kats/zspace/mozilla-git/ipc/chromium/src/base/message\_loop.cc:175
#25 0x63b4581a in nsBaseAppShell::Run (this=0x5e1625c0) at /Users/kats/zspace/mozilla-git/widget/xpwidgets/nsBaseAppShell.cpp:163
#26 0x63a107a0 in nsAppStartup::Run (this=0x600d0880) at /Users/kats/zspace/mozilla-git/toolkit/components/startup/nsAppStartup.cpp:296
#27 0x6314b59a in XREMain::XRE\_mainRun (this=0x5df28ae4) at /Users/kats/zspace/mozilla-git/toolkit/xre/nsAppRunner.cpp:3834
#28 0x6314ccb6 in XREMain::XRE\_main (this=0x5df28ae4, argc=<optimized out>, argv=0x5e16b048, aAppData=<optimized out>) at /Users/kats/zspace/mozilla-git/toolkit/xre/nsAppRunner.cpp:3911
#29 0x6314ce12 in XRE\_main (argc=7, argv=0x5e16b048, aAppData=0x57094c34, aFlags=<optimized out>) at /Users/kats/zspace/mozilla-git/toolkit/xre/nsAppRunner.cpp:3987
#30 0x63152890 in GeckoStart (data=0x5cb43af0, appData=0x57094c34) at /Users/kats/zspace/mozilla-git/toolkit/xre/nsAndroidStartup.cpp:73
#31 0x5707afec in Java\_org\_mozilla\_gecko\_GeckoAppShell\_nativeRun (jenv=0x56f34ec0, jc=<optimized out>, jargs=0x21000005) at /Users/kats/zspace/mozilla-git/mozglue/android/APKOpen.cpp:983
#32 0x40770ff4 in ?? ()
#33 0x40770ff4 in ?? ()

|  | [Mark Finkle (:mfinkle) (use needinfo?)](/user_profile?user_id=252194) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=790139#c31)• 12 years ago |
|  | |

Just wanted to confirm that this is only happening on CM10? Not happening on CM9?

|  | [Aaron Train [:aaronmt]](/user_profile?user_id=299942) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=790139#c32)• 12 years ago |
|  | |

CM9 reported here <https://support.mozilla.org/en-US/questions/937636#answer-369758> - his issue sounds like exactly what I saw on my TF201 which got this stack from Kats

|  | [Aaron Train [:aaronmt]](/user_profile?user_id=299942) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a901602_299942)• 12 years ago |

Keywords: [reproducible](/buglist.cgi?keywords=reproducible&resolution=---)

|  | [Craig](/user_profile?user_id=426190) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=790139#c33)• 12 years ago |
|  | |

That post from Aaron was from me. I wasn't using Reader Mode, so I can't confirm that the crash I was experiencing is related to Reader Mode. However, the crashes on CM10 are ridiculous and happen all of the time. The crashes on CM9 are far fewer in my experience, but still happen enough to cause concern. Let me know if I can help in any way.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=790139#c34)• 12 years ago |
|  | |

Removing the js::gc::MarkObjectRange signature as it seems unrelated although a top crasher.Crash Signature: [@ nsTArray\_base<nsTArrayFallibleAllocator>::ShiftData | FT2FontEntry::CreateFontEntry]
[@ js::gc::MarkObjectRange ]
[@ libxul.so@0xf81fe8]
[@ libxul.so@0xf79178]
[@ libxul.so@0xf819e8]
[@ libxul.so@0xf79da8]
[@ libxul.so@0xf7e4f0]
[@ libxul.so@0x… → [@ nsTArray\_base<nsTArrayFallibleAllocator>::ShiftData | FT2FontEntry::CreateFontEntry]
[@ libxul.so@0xf81fe8]
[@ libxul.so@0xf79178]
[@ libxul.so@0xf819e8]
[@ libxul.so@0xf79da8]
[@ libxul.so@0xf7e4f0]
[@ libxul.so@0xf8bf20]
[@ libxul.so@0xf7d7f8]…

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=790139#c35)• 12 years ago |
|  | |

Based on crash stats, it only happens with Android API Version 16 (CM10).Summary: crash in FT2FontEntry::CreateFontEntry while enabling Reader Mode on custom kernels → crash in FT2FontEntry::CreateFontEntry while enabling Reader Mode on CM10

|  | [Aaron Train [:aaronmt]](/user_profile?user_id=299942) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=790139#c36)• 12 years ago |
|  | |

Might be helpful, but I noticed two changes to CM10 in Freetype from Sept 1st, a new renderer and a new version of Freetype
<http://review.cyanogenmod.com/#/q/freetype,n,z>

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=790139#c37)• 12 years ago |
|  | |

Dear all,
I've just updated to the latest nightly from CM10, version 24092012, and the bug stills there: Firefox crashes as soon as I load a page or I touch the screen in the about:crashes page.
Do you need something to help you debug this issue?

|  | [Aaron Train [:aaronmt]](/user_profile?user_id=299942) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a1241769_299942)• 12 years ago |

Summary: crash in FT2FontEntry::CreateFontEntry while enabling Reader Mode on CM10 → crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10

|  | [Mark Finkle (:mfinkle) (use needinfo?)](/user_profile?user_id=252194) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=790139#c38)• 12 years ago |
|  | |

(In reply to Daniel Lombraña González from [comment #37](/show_bug.cgi?id=790139#c37 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> Dear all,
>
> I've just updated to the latest nightly from CM10, version 24092012, and the
> bug stills there: Firefox crashes as soon as I load a page or I touch the
> screen in the about:crashes page.
>
> Do you need something to help you debug this issue?
Unless you have a stack that points to Ft2FontEntry::CreateFontEntry, we can't be sure it's the same crash. We have at least two other bugs where Fennec crashes on CM10. See [bug 756140](/show_bug.cgi?id=756140 "RESOLVED DUPLICATE - Crash when quitting fennec native on Custom kernels") and [bug 792342](/show_bug.cgi?id=792342 "RESOLVED INCOMPLETE - Nightly crashed when trying to display site using custom kernel").

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=790139#c39)• 12 years ago |
|  | |

I'll wait! After reading those bug reports I think that all of them share the same user experience problem: as soon as you load a page, the browser crashes :-( Good luck with the bug hunting!!

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a1438873_181004)• 12 years ago |

Crash Signature: libxul.so@0x1023c28]
[@ libxul.so@0x10241c0]
[@ libxul.so@0x1024e28]
[@ libxul.so@0x1034620] → libxul.so@0x1023c28]
[@ libxul.so@0x10241c0]
[@ libxul.so@0x1024e28]
[@ libxul.so@0x1034620]
[@ ft\_module\_get\_service ]

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=790139#c40)• 12 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=665635&action=diff)
— [Details](attachment.cgi?id=665635&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=665635)

speculative fix based on <https://crash-stats.mozilla.com/report/index/d0c34bd6-ff3c-4481-87fc-5fc512120927> and other reports with the same signatureAssignee: nobody → blassey.bugs
[Attachment #665635](/attachment.cgi?id=665635&action=edit "patch") -
Flags: review?(jfkthame)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=790139#c41)• 12 years ago |
|  | |

Comment on [attachment 665635](/attachment.cgi?id=665635 "patch") [[details]](/attachment.cgi?id=665635&action=edit "patch") [[diff]](/attachment.cgi?id=665635&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=665635)
patch
Review of [attachment 665635](/attachment.cgi?id=665635 "patch") [[details]](/attachment.cgi?id=665635&action=edit "patch") [[diff]](/attachment.cgi?id=665635&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=665635):
-----------------------------------------------------------------
This looks like a band-aid for an issue we don't actually understand. I think I'd be happier about taking a complete FreeType update to the current release (2.4.10) than speculatively patching a line like this if we can't explain the root of the problem.
::: modules/freetype2/src/base/ftobjs.c
@@ +4325,4 @@
> {
> FT\_ASSERT( cur[0]->clazz );
>
> + if ( cur[0] && cur[0]->clazz && cur[0]->clazz->get\_interface )
If either cur[0] or cur[0]->clazz is NULL here, that seems to imply some pretty serious breakage within FreeType - it's loaded a NULL module? Surely that shouldn't happen; but if it does, wallpapering it here is likely to just defer the crash to some other place where the module is used.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=790139#c42)• 12 years ago |
|  | |

I've been able to confirm that this patch avoids the crash

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=790139#c43)• 12 years ago |
|  | |

Could you check (in gdb) whether the FT library's module list at the end of FT\_Init\_FreeType (after FT\_Add\_Default\_Modules has returned) contains any NULL module records, or records with NULL clazz pointer? Assuming the pointers are all valid at that time, the question we need to answer is how the module list can be getting changed/corrupted subsequently.

|  | [ricardohenrylee](/user_profile?user_id=443206) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=790139#c45)• 12 years ago |
|  | |

(In reply to Brad Lassey [:blassey] from [comment #42](/show_bug.cgi?id=790139#c42 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> I've been able to confirm that this patch avoids the crash
@blassey or @jfkthame would it be possible for you to upload the builds somewhere for us to test?

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=790139#c46)• 12 years ago |
|  | |

Attached patch

[logging patch](attachment.cgi?id=666574&action=diff)
— [Details](attachment.cgi?id=666574&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=666574)

with this logging patch, I see this:
I/GeckoFT ( 4097): checking 18 modules, starting at 0x60c8ecd4 for library: 0x60c8ecc0
I/GeckoFT ( 4097): checking 18 modules, starting at 0x60c8ef14 for library: 0x60c8ef00
I/GeckoFT ( 4097): cur[0]->clazz is null for 0x60c8ecfc while searching 18 modules, starting at 0x60c8ecd4 for library: 0x60c8ecc0
I/GeckoFT ( 4097): cur[0]->clazz is null for 0x60c8ecfc while searching 18 modules, starting at 0x60c8ecd4 for library: 0x60c8ecc0
^C

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=790139#c47)• 12 years ago |
|  | |

OK, so the modules list was intact when first created. Subsequently, \*something\* set one of those clazz pointers to NULL. I don't think there's anything within FreeType that should do this (AFAIK), so my worry is that we have a bug elsewhere that's stomping on a location that it shouldn't (writing via a wild/uninitialized pointer, maybe?).
Alternatively, it could be a bug within FreeType, leading to damaging its own library record, but I'm inclined to think that's less likely. Unless maybe CM10 includes a bad font that causes FT to stumbles, leading to internal corruption.
Running this under valgrind to see if it can detect any use of an uninitialized pointer would be awesome...

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=790139#c48)• 12 years ago |
|  | |

Alternatively, provided the problem is consistent (the rogue NULL is always at the same position, relative to the FT library), you might be able to catch it by setting a gdb data watchpoint on the address after the library has been initialized, to detect when it changes.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=790139#c49)• 12 years ago |
|  | |

Comment on [attachment 666574](/attachment.cgi?id=666574 "logging patch") [[details]](/attachment.cgi?id=666574&action=edit "logging patch") [[diff]](/attachment.cgi?id=666574&action=diff "logging patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=666574)
logging patch
Review of [attachment 666574](/attachment.cgi?id=666574 "logging patch") [[details]](/attachment.cgi?id=666574&action=edit "logging patch") [[diff]](/attachment.cgi?id=666574&action=diff "logging patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=666574):
-----------------------------------------------------------------
::: modules/freetype2/src/base/ftobjs.c
@@ +4328,5 @@
> FT\_ASSERT( cur[0]->clazz );
> +
> +
> + if (!cur[0])
> + \_\_android\_log\_print(ANDROID\_LOG\_INFO, "GeckoFT", "cur[0] is null for %p while searching %d modules, starting at %p for library: %p", library->num\_modules, library->modules, library);
BTW, you're missing "cur" as a parameter here, before library->num\_modules. Though it doesn't matter right now as this isn't the log message that's actually being hit.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=790139#c50)• 12 years ago |
|  | |

strangely, when I went to set the watch point, I got this:
Breakpoint 2, FT\_Add\_Default\_Modules (library=0x61982b40) at /Volumes/source/mozilla-central/modules/freetype2/src/base/ftinit.c:229
229 \_\_android\_log\_print(ANDROID\_LOG\_INFO, "GeckoFT", "checking %d modules, starting at %p for library: %p", library->num\_modules, library->modules, library);
(gdb) p cur[0]->clazz
$1 = (FT\_Module\_Class \*) 0x60844f00
(gdb) p cur[1]->clazz
$2 = (FT\_Module\_Class \*) 0x5e446340
(gdb) p cur[2]->clazz
Cannot access memory at address 0x0
which implies my logging is incorrect and clazz is null from the get go

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=790139#c51)• 12 years ago |
|  | |

please ignore that last comment, I was printing cur from the wrong scope

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=790139#c52)• 12 years ago |
|  | |

however, it looks like android's gdb doesn't support watchpoints:
(gdb) c
Continuing.
Warning:
Could not insert hardware watchpoint 3.
Could not insert hardware breakpoints:
You may have requested too many hardware breakpoints/watchpoints.
(gdb) info breakpoints
Num Type Disp Enb Address What
3 hw watchpoint keep y library->modules[2]->clazz
(gdb)

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=790139#c53)• 12 years ago |
|  | |

Johnathan, is it expected that FT\_Init\_FreeType gets called twice?
Also, FWIW, the module that gets gummed up is "autofitter"

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=790139#c54)• 12 years ago |
|  | |

(In reply to Brad Lassey [:blassey] from [comment #53](/show_bug.cgi?id=790139#c53 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> Johnathan, is it expected that FT\_Init\_FreeType gets called twice?
Hmm. I don't know if it's \*necessarily\* a problem - it should be valid to create multiple freetype library objects, I think. But it does seem surprising, as I'd expect us to create a single FT\_Library and use it throughout. So where are the two calls coming from? Presumably one comes from gfxAndroidPlatform::gfxAndroidPlatform(); is the other call coming from somewhere in cairo's or skia's font code? Maybe we should be sharing that FT\_Library rather than creating a separate one.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=790139#c55)• 12 years ago |
|  | |

(In reply to Brad Lassey [:blassey] from [comment #52](/show_bug.cgi?id=790139#c52 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> however, it looks like android's gdb doesn't support watchpoints:
>
> (gdb) c
> Continuing.
> Warning:
> Could not insert hardware watchpoint 3.
> Could not insert hardware breakpoints:
> You may have requested too many hardware breakpoints/watchpoints.
>
> (gdb) info breakpoints
> Num Type Disp Enb Address What
> 3 hw watchpoint keep y library->modules[2]->clazz
> (gdb)
From the message there, it sounds like maybe it can only watch one or two locations. If you know which of the pointers is going to be damaged, maybe you can set a watch on \*only\* that one, not on every entry in the array.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=790139#c56)• 12 years ago |
|  | |

(In reply to Jonathan Kew (:jfkthame) from [comment #54](/show_bug.cgi?id=790139#c54 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> (In reply to Brad Lassey [:blassey] from [comment #53](/show_bug.cgi?id=790139#c53 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> > Johnathan, is it expected that FT\_Init\_FreeType gets called twice?
>
> Hmm. I don't know if it's \*necessarily\* a problem - it should be valid to
> create multiple freetype library objects, I think. But it does seem
> surprising, as I'd expect us to create a single FT\_Library and use it
> throughout. So where are the two calls coming from? Presumably one comes
> from gfxAndroidPlatform::gfxAndroidPlatform(); is the other call coming from
> somewhere in cairo's or skia's font code? Maybe we should be sharing that
> FT\_Library rather than creating a separate one.
It is being called from here <http://mxr.mozilla.org/mozilla-central/source/gfx/thebes/gfxAndroidPlatform.cpp#32> and here <http://mxr.mozilla.org/mozilla-central/source/gfx/cairo/cairo/src/cairo-ft-font.c#273>
Also, sorry for typo'ing your name. Johnath has me ruined.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=790139#c57)• 12 years ago |
|  | |

(In reply to Jonathan Kew (:jfkthame) from [comment #55](/show_bug.cgi?id=790139#c55 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> (In reply to Brad Lassey [:blassey] from [comment #52](/show_bug.cgi?id=790139#c52 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> > however, it looks like android's gdb doesn't support watchpoints:
> >
> > (gdb) c
> > Continuing.
> > Warning:
> > Could not insert hardware watchpoint 3.
> > Could not insert hardware breakpoints:
> > You may have requested too many hardware breakpoints/watchpoints.
> >
> > (gdb) info breakpoints
> > Num Type Disp Enb Address What
> > 3 hw watchpoint keep y library->modules[2]->clazz
> > (gdb)
>
> From the message there, it sounds like maybe it can only watch one or two
> locations. If you know which of the pointers is going to be damaged, maybe
> you can set a watch on \*only\* that one, not on every entry in the array.
There was only one watch point and no break points set. Previously I had set 2 breakpoints, but had since cleared them. I've also tried only setting the one watch point with the same result.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=790139#c58)• 12 years ago |
|  | |

Julian Seward is seeing write after free from Valgrind, so I'm making this private so he can comment (apparently he doesn't have permission to mark as private, we should fix that)

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a1856664_181004)• 12 years ago |

Group: core-security

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a1856691_181004)• 12 years ago |

[Comment 58](#c58) is private:
false

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=790139#c59)• 12 years ago |
|  | |

Attached file
[Valgrind trace -- invalid writes](attachment.cgi?id=667044)
— [Details](attachment.cgi?id=667044&action=edit)

Here's a bunch of invalid writes observed when loading
<http://edition.cnn.com/2012/10/01/travel/american-airlines-customers-complaining/index.html?hpt=us_t3>
These were preceded by the complaints listed in [bug 795310](/show_bug.cgi?id=795310 "RESOLVED FIXED - Uninitialised value use in mozilla::layers::BasicTiledThebesLayer::PaintThebes") and those
listed in [bug 797002](/show_bug.cgi?id=797002 "RESOLVED WORKSFORME - Uninitialised value use in nsLayoutUtils::InflationMinFontSizeFor"). I wonder if they might be related, especially
797002.
Anyway, w.r.t. the invalid writes: after the page finished loading,
there were a bunch of invalid writes ending in segfault, due to
trashing the heap. What's interesting about these is that they are to
blocks that have no relationship at all to the stack doing the
writing. Eg we have some part of gfx/cairo/libpixman writing in the
middle of blocks freed by the JS jit.
My best-guess interpretation of this is that there is some wildly
out-of-range writing going on and trashing arbitrary bits of heap.

|  | [Joe Drew (not getting mail)](/user_profile?user_id=94) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=790139#c60)• 12 years ago |
|  | |

If we're scribbling on the heap, that could definitely cause those invalid writes. There's 0 excuse for layers to be looking at stuff allocated by the jit, though.

|  | [Robert Kaiser](/user_profile?user_id=5189) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=790139#c61)• 12 years ago |
|  | |

Somehow sounds to me like this could be an explanation for [bug 792825](/show_bug.cgi?id=792825 "RESOLVED FIXED - Crash in js::gc::MarkObjectRange on CyanogenMod 10") as well, then, as there we crash during GC. Interestingly, we seem to have a specific JS change triggering that issue one over there. In any case, I guess it's worth monitoring if there could be a connection.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=790139#c62)• 12 years ago |
|  | |

(In reply to Brad Lassey [:blassey] from [comment #56](/show_bug.cgi?id=790139#c56 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> (In reply to Jonathan Kew (:jfkthame) from [comment #54](/show_bug.cgi?id=790139#c54 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> > (In reply to Brad Lassey [:blassey] from [comment #53](/show_bug.cgi?id=790139#c53 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> > > Johnathan, is it expected that FT\_Init\_FreeType gets called twice?
> >
> > Hmm. I don't know if it's \*necessarily\* a problem - it should be valid to
> > create multiple freetype library objects, I think. But it does seem
> > surprising, as I'd expect us to create a single FT\_Library and use it
> > throughout. So where are the two calls coming from? Presumably one comes
> > from gfxAndroidPlatform::gfxAndroidPlatform(); is the other call coming from
> > somewhere in cairo's or skia's font code? Maybe we should be sharing that
> > FT\_Library rather than creating a separate one.
>
> It is being called from here
> <http://mxr.mozilla.org/mozilla-central/source/gfx/thebes/gfxAndroidPlatform>.
> cpp#32 and here
> <http://mxr.mozilla.org/mozilla-central/source/gfx/cairo/cairo/src/cairo-ft>-
> font.c#273
To confirm, the one from gfxAndroidPlatform is first, I guess? What's the full callstack of the second one (from cairo), then? Could this mean we're doing something font-related with cairo but haven't created and passed it the proper freetype face, so it's trying to make its own?

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=790139#c63)• 12 years ago |
|  | |

Stack for second call to FT\_Init\_FreeType:
#0 FT\_Init\_FreeType (alibrary=0x61ceb804) at /Volumes/source/mozilla-central/modules/freetype2/src/base/ftinit.c:250
#1 0x636873a0 in \_cairo\_ft\_unscaled\_font\_map\_create () at /Volumes/source/mozilla-central/gfx/cairo/cairo/src/cairo-ft-font.c:273
#2 \_cairo\_ft\_unscaled\_font\_map\_lock () at /Volumes/source/mozilla-central/gfx/cairo/cairo/src/cairo-ft-font.c:336
#3 0x6368927c in \_cairo\_ft\_unscaled\_font\_create\_internal (out=<optimized out>, font\_face=<optimized out>, id=<optimized out>,
filename=<optimized out>, from\_face=<optimized out>) at /Volumes/source/mozilla-central/gfx/cairo/cairo/src/cairo-ft-font.c:491
#4 \_cairo\_ft\_unscaled\_font\_create\_from\_face (out=<optimized out>, face=<optimized out>)
at /Volumes/source/mozilla-central/gfx/cairo/cairo/src/cairo-ft-font.c:580
#5 \_moz\_cairo\_ft\_font\_face\_create\_for\_ft\_face (face=0x61ceb804, load\_flags=1577246784)
at /Volumes/source/mozilla-central/gfx/cairo/cairo/src/cairo-ft-font.c:3098
#6 0x635d8354 in FT2FontEntry::CairoFontFace (this=0x6148de00) at /Volumes/source/mozilla-central/gfx/thebes/gfxFT2FontList.cpp:325
#7 0x635d85d2 in FT2FontEntry::CreateScaledFont (this=0x6148de00, aStyle=<optimized out>)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFT2FontList.cpp:130
#8 0x635d8602 in FT2FontEntry::CreateFontInstance (this=0x6148de00, aFontStyle=0x61ce1400, aNeedsBold=172)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFT2FontList.cpp:155
#9 0x635c556e in gfxFontEntry::FindOrMakeFont (this=0x6148de00, aStyle=0x61cac8e8, aNeedsBold=false)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:191
#10 0x635c566c in gfxFontGroup::FindPlatformFont (aName=..., aGenericName=<optimized out>, aUseFontSet=<optimized out>, aClosure=<optimized out>)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:3210
#11 0x635bf08a in gfxFontGroup::FontResolverProc (aName=..., aClosure=<optimized out>)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:3456
#12 0x635d5f1e in gfxAndroidPlatform::ResolveFontName (this=<optimized out>, aFontName=<optimized out>,
aCallback=0x635bf07d <gfxFontGroup::FontResolverProc(nsAString\_internal const&, void\*)>, aClosure=0x5f017c74, aAborted=@0x5f017cb7)
at /Volumes/source/mozilla-central/gfx/thebes/gfxAndroidPlatform.cpp:99
#13 0x635c2fcc in gfxFontGroup::ForEachFontInternal (this=0x61cac8d0, aFamilies=<optimized out>, aLanguage=<optimized out>,
aResolveGeneric=<optimized out>, aResolveFontName=true, aUseFontSet=false,
fc=0x635c55f1 <gfxFontGroup::FindPlatformFont(nsAString\_internal const&, nsACString\_internal const&, bool, void\*)>, closure=0x61cac8d0)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:3420
#14 0x635c3076 in gfxFontGroup::ForEachFontInternal (this=0x61cac8d0, aFamilies=<optimized out>, aLanguage=<optimized out>,
aResolveGeneric=<optimized out>, aResolveFontName=true, aUseFontSet=true,
fc=0x635c55f1 <gfxFontGroup::FindPlatformFont(nsAString\_internal const&, nsACString\_internal const&, bool, void\*)>, closure=0x61cac8d0)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:3441
#15 0x635c3130 in gfxFontGroup::ForEachFont (this=<optimized out>,
fc=0x635c55f1 <gfxFontGroup::FindPlatformFont(nsAString\_internal const&, nsACString\_internal const&, bool, void\*)>, closure=<optimized out>)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:3268
#16 0x635c56a4 in gfxFontGroup::BuildFontList (this=0x1) at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:3106
#17 0x635c58f2 in gfxFontGroup::gfxFontGroup (this=0x61cac8d0, aFamilies=<optimized out>, aStyle=0x5f018580, aUserFontSet=0x0)
at /Volumes/source/mozilla-central/gfx/thebes/gfxFont.cpp:3097
#18 0x635d5e8c in gfxAndroidPlatform::CreateFontGroup (this=<optimized out>, aFamilies=..., aStyle=0x5f018580, aUserFontSet=0x0)
at /Volumes/source/mozilla-central/gfx/thebes/gfxAndroidPlatform.cpp:149
#19 0x62ddab50 in nsFontMetrics::Init (this=0x61c9a970, aFont=..., aLanguage=<optimized out>, aContext=<optimized out>, aUserFontSet=0x0)
at /Volumes/source/mozilla-central/gfx/src/nsFontMetrics.cpp:109
#20 0x62dd8ffa in nsFontCache::GetMetricsFor (this=0x61cecd20, aFont=..., aLanguage=0x61ca5880, aUserFontSet=0x0, aMetrics=@0x5f01868c)
#21 0x62dd92f6 in nsDeviceContext::GetMetricsFor (this=0x61cfc680, aFont=..., aLanguage=0x61ca5880, aUserFontSet=0x0, aMetrics=@0x5f01868c)
at /Volumes/source/mozilla-central/gfx/src/nsDeviceContext.cpp:254
#22 0x62e0c9ee in nsLayoutUtils::GetFontMetricsForStyleContext (aStyleContext=<optimized out>, aFontMetrics=0x5f01868c, aInflation=1)
at /Volumes/source/mozilla-central/layout/base/nsLayoutUtils.cpp:2050
#23 0x62e5122e in ComputeLineHeight (aFontSizeInflation=<optimized out>, aBlockHeight=<optimized out>, aStyleContext=<optimized out>)
at /Volumes/source/mozilla-central/layout/generic/nsHTMLReflowState.cpp:2344
#24 nsHTMLReflowState::CalcLineHeight (aStyleContext=0x61f6e908, aBlockHeight=<optimized out>, aFontSizeInflation=1)
at /Volumes/source/mozilla-central/layout/generic/nsHTMLReflowState.cpp:2367
#25 0x62e51320 in nsHTMLReflowState::CalcLineHeight (this=<optimized out>)
at /Volumes/source/mozilla-central/layout/generic/nsHTMLReflowState.cpp:2356
#26 0x62e378a6 in nsBlockReflowState::nsBlockReflowState (this=0x5f018754, aReflowState=..., aPresContext=0x61f61400, aFrame=<optimized out>,
aMetrics=..., aTopMarginRoot=true, aBottomMarginRoot=true, aBlockNeedsFloatManager=true)
at /Volumes/source/mozilla-central/layout/generic/nsBlockReflowState.cpp:113
#27 0x62e36238 in nsBlockFrame::Reflow (this=0x61f6ec58, aPresContext=0x61f61400, aMetrics=..., aReflowState=..., aStatus=@0x5f018c6c)
at /Volumes/source/mozilla-central/layout/generic/nsBlockFrame.cpp:1023
#28 0x62e3b092 in nsContainerFrame::ReflowChild (this=<optimized out>, aKidFrame=0x61f6ec58, aPresContext=0x61f61400, aDesiredSize=...,
aReflowState=..., aX=0, aY=0, aFlags=0, aStatus=@0x5f018c6c, aTracker=0x0)
at /Volumes/source/mozilla-central/layout/generic/nsContainerFrame.cpp:947
#29 0x62e501f0 in nsCanvasFrame::Reflow (this=0x61f6ddd0, aPresContext=0x61f61400, aDesiredSize=..., aReflowState=..., aStatus=@0x5f018c6c)
at /Volumes/source/mozilla-central/layout/generic/nsCanvasFrame.cpp:473
#30 0x62e3b092 in nsContainerFrame::ReflowChild (this=<optimized out>, aKidFrame=0x61f6ddd0, aPresContext=0x61f61400, aDesiredSize=...,
aReflowState=..., aX=0, aY=0, aFlags=3, aStatus=@0x5f018c6c, aTracker=0x0)
at /Volumes/source/mozilla-central/layout/generic/nsContainerFrame.cpp:947
#31 0x62e4cbd4 in nsHTMLScrollFrame::ReflowScrolledFrame (this=0x61f6dfa0, aState=0x5f018d54, aAssumeHScroll=<optimized out>,
aAssumeVScroll=<optimized out>, aMetrics=0x5f018ca8, aFirstPass=true)
at /Volumes/source/mozilla-central/layout/generic/nsGfxScrollFrame.cpp:526
#32 0x62e4ce8c in nsHTMLScrollFrame::ReflowContents (this=0x61f6dfa0, aState=0x5f018d54, aDesiredSize=<optimized out>)
at /Volumes/source/mozilla-central/layout/generic/nsGfxScrollFrame.cpp:624
#33 0x62e4d1c2 in nsHTMLScrollFrame::Reflow (this=0x61f6dfa0, aPresContext=<optimized out>, aDesiredSize=..., aReflowState=...,
aStatus=@0x5f0192dc) at /Volumes/source/mozilla-central/layout/generic/nsGfxScrollFrame.cpp:865
#34 0x62e3b092 in nsContainerFrame::ReflowChild (this=<optimized out>, aKidFrame=0x61f6dfa0, aPresContext=0x61f61400, aDesiredSize=...,
aReflowState=..., aX=0, aY=0, aFlags=0, aStatus=@0x5f0192dc, aTracker=0x0)
at /Volumes/source/mozilla-central/layout/generic/nsContainerFrame.cpp:947
#35 0x62e7462a in ViewportFrame::Reflow (this=0x61f6d7e8, aPresContext=0x61f61400, aDesiredSize=..., aReflowState=..., aStatus=@0x5f0192dc)
at /Volumes/source/mozilla-central/layout/generic/nsViewportFrame.cpp:201
#36 0x62e15784 in PresShell::DoReflow (this=0x5e241e00, target=Cannot access memory at address 0x0
) at /Volumes/source/mozilla-central/layout/base/nsPresShell.cpp:7372
#37 0x62e1cdcc in PresShell::ProcessReflowCommands (this=0x5e241e00, aInterruptible=false)
at /Volumes/source/mozilla-central/layout/base/nsPresShell.cpp:7518
#38 0x62e1d08c in PresShell::FlushPendingNotifications (this=0x5e241e00, aType=Flush\_Layout)
at /Volumes/source/mozilla-central/layout/base/nsPresShell.cpp:3848
#39 0x62e0670e in DocumentViewerImpl::LoadComplete (this=0x61ce74f0, aStatus=NS\_OK)
at /Volumes/source/mozilla-central/layout/base/nsDocumentViewer.cpp:975
#40 0x632e492e in nsDocShell::EndPageLoad (this=0x61794c00, aProgress=<optimized out>, aChannel=0x5e281cc0, aStatus=NS\_OK)
at /Volumes/source/mozilla-central/docshell/base/nsDocShell.cpp:6409
#41 0x632e1e24 in nsDocShell::OnStateChange (this=0x61794c00, aProgress=0x61794c14, aRequest=<optimized out>, aStateFlags=<optimized out>,
aStatus=NS\_OK) at /Volumes/source/mozilla-central/docshell/base/nsDocShell.cpp:6240
#42 0x632ea2e4 in nsDocLoader::DoFireOnStateChange (this=0x61794c00, aProgress=0x61794c14, aRequest=<optimized out>, aStateFlags=@0x5f019784,
aStatus=NS\_OK) at /Volumes/source/mozilla-central/uriloader/base/nsDocLoader.cpp:1351
#43 0x632ea972 in nsDocLoader::doStopDocumentLoad (this=<optimized out>, request=0x5e281cc0, aStatus=NS\_OK)
at /Volumes/source/mozilla-central/uriloader/base/nsDocLoader.cpp:931
#44 0x632eae00 in nsDocLoader::DocLoaderIsEmpty (this=0x61794c00, aFlushLayout=<optimized out>)
at /Volumes/source/mozilla-central/uriloader/base/nsDocLoader.cpp:820
#45 0x632eaf72 in nsDocLoader::OnStopRequest (this=0x61794c00, aRequest=0x61bfd748, aCtxt=<optimized out>, aStatus=NS\_OK)
at /Volumes/source/mozilla-central/uriloader/base/nsDocLoader.cpp:704
#46 0x62d0ad0e in nsLoadGroup::RemoveRequest (this=0x6178f100, request=0x61bfd748, ctxt=0x0, aStatus=NS\_OK)
at /Volumes/source/mozilla-central/netwerk/base/src/nsLoadGroup.cpp:698
#47 0x62f25ac4 in nsDocument::DoUnblockOnload (this=0x61ce4400) at /Volumes/source/mozilla-central/content/base/src/nsDocument.cpp:7362
#48 0x62f25b16 in nsDocument::UnblockOnload (this=0x61ce4400, aFireSync=false)
at /Volumes/source/mozilla-central/content/base/src/nsDocument.cpp:7304
#49 0x62f2bca6 in nsDocument::DispatchContentLoadedEvents (this=0x61ce4400) at /Volumes/source/mozilla-central/content/base/src/nsDocument.cpp:4380
#50 0x62f236e0 in nsRunnableMethodImpl<void (nsDocument::\*)(), true>::Run (this=<optimized out>) at ../../../dist/include/nsThreadUtils.h:349
#51 0x63573782 in nsThread::ProcessNextEvent (this=0x5e2564c0, mayWait=<optimized out>, result=0x5f01994f)
at /Volumes/source/mozilla-central/xpcom/threads/nsThread.cpp:612
#52 0x635518f2 in NS\_ProcessNextEvent\_P (thread=0x61ce4400, mayWait=false)
at /Volumes/source/mozilla-central/objdir-droid/xpcom/build/nsThreadUtils.cpp:220
#53 0x634728ea in mozilla::ipc::MessagePump::Run (this=0x5e2532b0, aDelegate=0x5e27f0e0)
at /Volumes/source/mozilla-central/ipc/glue/MessagePump.cpp:82
#54 0x63596280 in MessageLoop::RunInternal (this=0x63b372c4) at /Volumes/source/mozilla-central/ipc/chromium/src/base/message\_loop.cc:208
#55 0x63596356 in RunHandler (this=<optimized out>) at /Volumes/source/mozilla-central/ipc/chromium/src/base/message\_loop.cc:201
#56 MessageLoop::Run (this=0x5e27f0e0) at /Volumes/source/mozilla-central/ipc/chromium/src/base/message\_loop.cc:175
#57 0x633f3160 in nsBaseAppShell::Run (this=0x5e2546b0) at /Volumes/source/mozilla-central/widget/xpwidgets/nsBaseAppShell.cpp:163
#58 0x63320a08 in nsAppStartup::Run (this=0x608c8820) at /Volumes/source/mozilla-central/toolkit/components/startup/nsAppStartup.cpp:290
#59 0x62cf80b6 in XREMain::XRE\_mainRun (this=0x5f019af4) at /Volumes/source/mozilla-central/toolkit/xre/nsAppRunner.cpp:3782
#60 0x62cfa1bc in XREMain::XRE\_main (this=0x5f019af4, argc=<optimized out>, argv=0x5e26b048, aAppData=<optimized out>)
at /Volumes/source/mozilla-central/toolkit/xre/nsAppRunner.cpp:3848
#61 0x62cfa2f0 in XRE\_main (argc=7, argv=0x5e26b048, aAppData=0x582df66c, aFlags=<optimized out>)
at /Volumes/source/mozilla-central/toolkit/xre/nsAppRunner.cpp:3923
#62 0x62cfd63a in GeckoStart (data=0x5c679820, appData=0x582df66c) at /Volumes/source/mozilla-central/toolkit/xre/nsAndroidStartup.cpp:73
#63 0x582c7362 in Java\_org\_mozilla\_gecko\_GeckoAppShell\_nativeRun (jenv=0x5c385358, jc=<optimized out>, jargs=0x20200005)
at /Volumes/source/mozilla-central/mozglue/android/APKOpen.cpp:981
#64 0x4077b0b4 in dvmPlatformInvoke () from /Volumes/source/jimdb/moz-gdb/lib/HT24WW301665/system/lib/libdvm.so
#65 0x407aa266 in dvmCallJNIMethod(unsigned int const\*, JValue\*, Method const\*, Thread\*) ()
from /Volumes/source/jimdb/moz-gdb/lib/HT24WW301665/system/lib/libdvm.so

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=790139#c64)• 12 years ago |
|  | |

This is our #1 unpatched crasher. Can we take the patch we have as a bandaid and leave this open to investigate the core issue?

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=790139#c65)• 12 years ago |
|  | |

Are people seeing this crash with earlier Firefox releases on CM10 devices, or does it only start appearing with Aurora or Nightly builds? (If so, can we get some kind of regression range?)
I'm a bit reluctant to take a band-aid that just avoids the crash here but doesn't address the root cause, given that the evidence seems to be suggesting heap corruption of some kind. If rogue code is writing wildly to the heap, then crashing quickly is arguably the best outcome; if something besides the FT\_Library modules list is being trashed, we could easily have an exploitable situation.

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=790139#c66)• 12 years ago |
|  | |

Hi everyone,
First of all thanks to all of you for the efforts that you are putting into this issue. When I installed CM10 the Nightly version worked more or less well, you could open a web page, but when you opened a second one it crashed. Then, new commits were introduced and since then I cannot browse the web at all with the Nightly because as soon as I open a web page it crashes (I cannot event paste here crash reports, as even that page crashes the browser).
I've also installed in my CM10 Firefox Beta from the Google Play store, but it crashes too from time to time (sometime in this browser I can even enable the reader mode). In any case, if you need a new logcat or something else, let me know it. I'll be happy to help.
Best regards,
Daniel

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=790139#c67)• 12 years ago |
|  | |

If you're willing to spend some time testing, it might be helpful if you re-install older Nightly versions (mozilla-central-android builds) available from <http://ftp.mozilla.org/pub/mozilla.org/mobile/nightly/> (they're in directories named according to date) to identify the specific build where the immediate-crash issue started happening. By going back a month or two (or however long it takes) to confirm when there was a working build, and then repeatedly bisecting the range since then, it shouldn't take more than a half-dozen or so tests to narrow down the date of the regression.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=790139#c68)• 12 years ago |
|  | |

Just to note, the STR for this bug is to enter reader mode. An immediate crash could be [bug 792825](/show_bug.cgi?id=792825 "RESOLVED FIXED - Crash in js::gc::MarkObjectRange on CyanogenMod 10"), which was a regression from [bug 788378](/show_bug.cgi?id=788378 "RESOLVED INACTIVE - Add guards to the AddonManager/AddonManagerInternal getters and setters, to ensure they're not used before startup/after shutdown"), which was introduced on 9/18.

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=790139#c69)• 12 years ago |
|  | |

To clarify, then, the invalid writes I saw in [comment #59](/show_bug.cgi?id=790139#c59 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10") happen after
the page has finished loading, but before entering reader mode --
before I even pressed on the book-y icon to enter reader mode.
Brad, just to be unambiguous about this, can you nominate a specific
URL that causes the crash when entering reader mode? So that we can
all be clear that we're talking about the same failure.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=790139#c70)• 12 years ago |
|  | |

At least some of the invalid writes here were [bug 795234](/show_bug.cgi?id=795234 "RESOLVED FIXED - crash in _pixman_implementation_fill"), Julian is going to re-run valgrind with a build that has that fix

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=790139#c72)• 12 years ago |
|  | |

I verified that the fix for [bug 795234](/show_bug.cgi?id=795234 "RESOLVED FIXED - crash in _pixman_implementation_fill") gets rid of the invalid writes
noted in [comment #59](/show_bug.cgi?id=790139#c59 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"). And with that fix in place, I can't get it to
crash, nor can I observe any memory corruption, when entering reader
mode in a cnn.com article, on ICS. So maybe this is CM10 specific.

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=790139#c73)• 12 years ago |
|  | |

Hi,
Is it available the fix in the latest nightly? I would test it right away :-)
Daniel

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=790139#c74)• 12 years ago |
|  | |

The fix for [bug 795234](/show_bug.cgi?id=795234 "RESOLVED FIXED - crash in _pixman_implementation_fill") is in the latest nightly, but not the bandaid fix for this bug

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=790139#c75)• 12 years ago |
|  | |

This prevents the crash as well:
diff --git a/modules/freetype2/include/freetype/internal/ftobjs.h b/modules/free
--- a/modules/freetype2/include/freetype/internal/ftobjs.h
+++ b/modules/freetype2/include/freetype/internal/ftobjs.h
@@ -436,10 +436,11 @@ FT\_BEGIN\_HEADER
/\* \*/
/\* memory :: A handle to the memory manager. \*/
/\* \*/
typedef struct FT\_ModuleRec\_
{
+ char buffer[1024];
FT\_Module\_Class\* clazz;
FT\_Library library;
FT\_Memory memory;
} FT\_ModuleRec;

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=790139#c76)• 12 years ago |
|  | |

So at this point, we know that the FT\_Library created by gfxAndroidPlatform has non-NULL module pointers when it is initially created, but at some later time when we try to use it, one of those pointers has become NULL. What we don't know is who changed it to NULL, or why.
In the absence of data watchpoints, which would be the obvious tool, maybe you could put the module-pointer-validation code (with an abort as soon as the NULL is found) into a global function in gfxAndroidPlatform and then call it from strategic places - e.g. each time around the browser's event loop, for a start - to try and narrow down when the change is happening.

|  | [Tyler Downer [He/Him]](/user_profile?user_id=310130) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=790139#c77)• 12 years ago |
|  | |

As discussed in the Mobile QA meeting today, this CM10 crash is still popping up in Firefox Beta 16, so this looks like it will be on the release channel next week.
<https://input.mozilla.org/opinion/3242204>
<https://input.mozilla.org/opinion/3241521>

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=790139#c78)• 12 years ago |
|  | |

(In reply to Tyler Downer [:Tyler] from [comment #77](/show_bug.cgi?id=790139#c77 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> As discussed in the Mobile QA meeting today, this CM10 crash is still
> popping up in Firefox Beta 16, so this looks like it will be on the release
> channel next week.
> <https://input.mozilla.org/opinion/3242204>
> <https://input.mozilla.org/opinion/3241521>
This bug is not marked as FF15/16 tracking/affected by those involved with stability. I believe the crashes you're seeing here are [bug 756140](/show_bug.cgi?id=756140 "RESOLVED DUPLICATE - Crash when quitting fennec native on Custom kernels") and were already present in FF15.
Does that match other people's expectations? Kevin - can you see if you can reproduce on FF15/16 with CM10?
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%3F)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%3F)QA Contact: kbrosnan

|  | [James Willcox (:snorp) (jwillcox@mozilla.com) (he/him)](/user_profile?user_id=227322) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=790139#c79)• 12 years ago |
|  | |

I was able to get valgrind going, here is the log from the run: <http://people.mozilla.org/~jwillcox/valgrind-logcat-2.txt>
libz seems to be overrunning. If I replace the libz on the system with the stock libz from jellybean the crash goes away. I'm doing a valgrind run with that right now to see what it looks like.

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=790139#c80)• 12 years ago |
|  | |

Attached file
[patch to force us to use in tree setlcdfilter](attachment.cgi?id=668513) (obsolete)
— [Details](attachment.cgi?id=668513&action=edit)

it looks like cairo is picking up the system setlcdfilter function and that's what's stomping on our memory.
[Attachment #668513](/attachment.cgi?id=668513&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: review?(jfkthame)

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=790139#c81)• 12 years ago |
|  | |

Attached patch

[patch to force us to use in tree setlcdfilter](attachment.cgi?id=668517&action=diff)
— [Details](attachment.cgi?id=668517&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=668517)

updated to include the patch and a comment in the README
[Attachment #668513](/attachment.cgi?id=668513&action=edit "patch to force us to use in tree setlcdfilter") -
Attachment is obsolete: true
[Attachment #668513](/attachment.cgi?id=668513&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: review?(jfkthame)

|  | [Tyler Downer [He/Him]](/user_profile?user_id=310130) |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=790139#c82)• 12 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #78](/show_bug.cgi?id=790139#c78 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
Those input reports don't indicate closing however (which is a different set up input we are seeing). So, not sure

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=790139#c83)• 12 years ago |
|  | |

Comment on [attachment 668517](/attachment.cgi?id=668517 "patch to force us to use in tree setlcdfilter") [[details]](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") [[diff]](/attachment.cgi?id=668517&action=diff "patch to force us to use in tree setlcdfilter") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=668517)
patch to force us to use in tree setlcdfilter
Review of [attachment 668517](/attachment.cgi?id=668517 "patch to force us to use in tree setlcdfilter") [[details]](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") [[diff]](/attachment.cgi?id=668517&action=diff "patch to force us to use in tree setlcdfilter") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=668517):
-----------------------------------------------------------------
This looks correct to me - running with in-tree freetype but calling this function from system freetype sure sounds like a recipe for trouble!
(It also explains why the problem is system-dependent, as we might get away with the error if the system and in-tree versions happen to be compatible.)
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: review+

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=790139#c84)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/acd25563db2f>Status: NEW → RESOLVEDClosed: 12 years agoResolution: --- → FIXED

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a2137344_181004)• 12 years ago |

[Attachment #665635](/attachment.cgi?id=665635&action=edit "patch") -
Flags: review?(jfkthame) → review-

|  | [Brad Lassey [:blassey] (use needinfo?)](/user_profile?user_id=181004)  Assignee |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=790139#c85)• 12 years ago |
|  | |

Comment on [attachment 668517](/attachment.cgi?id=668517 "patch to force us to use in tree setlcdfilter") [[details]](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") [[diff]](/attachment.cgi?id=668517&action=diff "patch to force us to use in tree setlcdfilter") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=668517)
patch to force us to use in tree setlcdfilter
[Approval Request Comment]
Bug caused by (feature/regressing bug #):
User impact if declined:
Testing completed (on m-c, etc.):
Risk to taking this patch (and alternatives if risky):
String or UUID changes made by this patch:
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: approval-mozilla-beta?
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: approval-mozilla-aurora?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a2142709_425645)• 12 years ago |

[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=790139#c86)• 12 years ago |
|  | |

Comment on [attachment 668517](/attachment.cgi?id=668517 "patch to force us to use in tree setlcdfilter") [[details]](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") [[diff]](/attachment.cgi?id=668517&action=diff "patch to force us to use in tree setlcdfilter") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=668517)
patch to force us to use in tree setlcdfilter
[Triage Comment]
We'll want to see crash volume drop significantly after this lands on FF17, before considering taking in a 16.0.1.
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: approval-mozilla-beta?
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: approval-mozilla-beta-
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: approval-mozilla-aurora?
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: approval-mozilla-aurora+

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=790139#c87)• 12 years ago |
|  | |

(please land asap to make Monday's merge)

|  | [Mark Finkle (:mfinkle) (use needinfo?)](/user_profile?user_id=252194) |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=790139#c88)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/bf4ea2d4dd97>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=790139#c89)• 12 years ago |
|  | |

(In reply to Daniel Lombraña González from [comment #73](/show_bug.cgi?id=790139#c73 "VERIFIED FIXED - crash in FT2FontEntry::CreateFontEntry when visiting any site in CM10"))
> Is it available the fix in the latest nightly? I would test it right away :-)
Please, can you verify it's fixed for you?

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=790139#c90)• 12 years ago |
|  | |

The ft\_module\_get\_service crashes in Trunk and XUL crashes in Aurora has stopped after builds from October 5.

|  | [Daniel Lombraña González](/user_profile?user_id=374143) |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=790139#c92)• 12 years ago |
|  | |

Hi everyone,
THANKS!!!!! It seems to be working right now, even the reader mode!!!! I'll be in the #mozfestival so if someone is around I would love to say thanks in person :-D
Cheers,
Daniel

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a2273368_386758)• 12 years ago |

Status: RESOLVED → VERIFIED
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a2467966_1689)• 12 years ago |

Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=790139#c95)• 12 years ago |
|  | |

Comment on [attachment 668517](/attachment.cgi?id=668517 "patch to force us to use in tree setlcdfilter") [[details]](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") [[diff]](/attachment.cgi?id=668517&action=diff "patch to force us to use in tree setlcdfilter") [[review]](/page.cgi?id=splinter.html&ignore=&bug=790139&attachment=668517)
patch to force us to use in tree setlcdfilter
[Triage Comment]
Approving for inclusion in 16.0.1. This patch introduces almost zero risk, since affected users are already crashing constantly.
[Attachment #668517](/attachment.cgi?id=668517&action=edit "patch to force us to use in tree setlcdfilter") -
Flags: approval-mozilla-release+

|  | [Aaron Train [:aaronmt]](/user_profile?user_id=299942) |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=790139#c96)• 12 years ago |
|  | |

This landed as <https://hg.mozilla.org/releases/mozilla-release/rev/10eed4e3cfd2>
Verified fixed on mozilla-release (16.0.1) via my TF201/CM10 Nightly
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a2578485_1689)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a2583423_1689)• 12 years ago |

Alias: CVE-2012-4190

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=790139#a10510788_1689)• 12 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=790139&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Daniel Lombraña González](/user_profile?user_id=374143)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


