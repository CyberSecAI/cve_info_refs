=== Content from www.bugzilla.org_6700bb49_20250125_233206.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 4.3.2, 4.2.2, 4.0.7, and 3.6.10 Security Advisory

# 4.3.2, 4.2.2, 4.0.7, and 3.6.10 Security Advisory

Thursday, Aug 30th, 2012
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* When the user logs in using LDAP, the username is not escaped
  before being passed to LDAP which could potentially lead to LDAP
  injection.

* Extensions are not protected against directory browsing by default
  and users can view the source code of templates used by the
  extensions. These templates may contain sensitive data.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       LDAP Injection
Affected:    2.12 to 3.6.10, 3.7.1 to 4.0.7, 4.1.1 to 4.2.2, 4.3.1 to 4.3.2
Fixed In:    3.6.11, 4.0.8, 4.2.3, 4.3.3
Description: When the user logs in using LDAP, the username is not
             escaped when building the uid=$username filter which is
             used to query the LDAP directory. This could potentially
             lead to LDAP injection.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=785470
CVE Number:  CVE-2012-3981

Class:       Directory Browsing
Affected:    2.23.2 to 3.6.10, 3.7.1 to 4.0.7, 4.1.1 to 4.2.2, 4.3.1 to 4.3.2
Fixed In:    4.0.8, 4.2.3, 4.3.3
Description: Extensions are not protected against directory browsing
             and users can access the source code of the templates
             which may contain sensitive data.
             Directory browsing is blocked in Bugzilla 4.3.3 only,
             because it requires a configuration change in the Apache
             httpd.conf file to allow local .htaccess files to use
             Options -Indexes. To not break existing installations,
             this fix has not been backported to stable branches.
             The access to templates is blocked for all supported
             branches except the old 3.6 branch, because this branch
             doesn't have .htaccess in the bzr repository and cannot
             be fixed easily for existing installations without
             potentially conflicting with custom changes.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=785522
             https://bugzilla.mozilla.org/show_bug.cgi?id=785511
CVE Number:  none

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: Frédéric Buclin
Issue 1 Fixed by: Frédéric Buclin, Reed Loden

Issue 2 Reporter: Frédéric Buclin
Issue 2 Fixed by: Frédéric Buclin, Byron Jones, Lockheed Martin

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright © 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)



=== Content from bugzilla.mozilla.org_af94f8ce_20250125_233206.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/785511)
* [XML](/show_bug.cgi?ctype=xml&id=785511)

Closed
[Bug 785511](/show_bug.cgi?id=785511)

Opened 12 years ago
Closed 12 years ago

# Prevent directory browsing in docs/, extensions/ and all other subdirectories of Bugzilla

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Prevent directory browsing in docs/, extensions/ and all other subdirectories of Bugzilla

## Categories

### (Bugzilla :: Bugzilla-General, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Bugzilla-General#Bugzilla-General)

Bugzilla-General
▾

Bugzilla :: Bugzilla-General
Anything that doesn't fit in the other components, or spans multiple components.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Bugzilla-General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

4.3.2

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

minor

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 4.4

## People

### (Reporter: LpSolit, Assigned: LpSolit)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

3 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[787688](/show_bug.cgi?id=787688 "RESOLVED FIXED - AllowOverride Options missing when running under mod_perl")

Dependency [tree](/showdependencytree.cgi?id=785511&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=785511)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [LpSolit](/user_profile?user_id=120380) | [approval](#a347811_120380 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.4](#a66687_120380 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.4 | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [patch, v1](/attachment.cgi?id=655158)  [12 years ago](#c0)  [Frédéric Buclin](/user_profile?user_id=120380)   788 bytes, patch |  | [Details](/attachment.cgi?id=655158&action=edit) | [Diff](/attachment.cgi?id=655158&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=655158) |
| --- | --- | --- |
| [patch, v2](/attachment.cgi?id=656040)  [12 years ago](#c6)  [Frédéric Buclin](/user_profile?user_id=120380)   1.90 KB, patch | dkl : [review+](#c8 "12 years ago") | [Details](/attachment.cgi?id=656040&action=edit) | [Diff](/attachment.cgi?id=656040&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=656040) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=785511#c0)• 12 years ago |
|  | |

Attached patch

[patch, v1](attachment.cgi?id=655158&action=diff) (obsolete)
— [Details](attachment.cgi?id=655158&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=655158)

There is no reason to let all files in the doc/ tree to be browsable from the web, especially those being in xsl/ or lib/. Only files which are supposed to be viewable should be whitelisted.
I create docs/.htaccess and configure it so that localizers do not need to create their own .htaccess file. Besides .txt, .pdf and .html files, we also have to whitelist .css, .png and .gif files to be loaded from HTML files.
[Attachment #655158](/attachment.cgi?id=655158&action=edit "patch, v1") -
Flags: review?(dkl)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785511#a66687_120380)• 12 years ago |

Flags: blocking4.4+Flags: blocking4.2.3+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=785511#c1)• 12 years ago |
|  | |

Comment on [attachment 655158](/attachment.cgi?id=655158 "patch, v1") [[details]](/attachment.cgi?id=655158&action=edit "patch, v1") [[diff]](/attachment.cgi?id=655158&action=diff "patch, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=655158)
patch, v1
Review of [attachment 655158](/attachment.cgi?id=655158 "patch, v1") [[details]](/attachment.cgi?id=655158&action=edit "patch, v1") [[diff]](/attachment.cgi?id=655158&action=diff "patch, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=655158):
-----------------------------------------------------------------
This breaks allowing people to automatically see index.html in docs/en/html and docs/en/html/api which we reference in a few places in the templates.
Before patch I can do:
<https://localhost/bugzilla/docs/en/html>
<https://localhost/bugzilla/docs/en/html/api>
With patch I have to explicitly add index.html or else I get the forbidden error.
dkl
[Attachment #655158](/attachment.cgi?id=655158&action=edit "patch, v1") -
Flags: review?(dkl) → review-

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=785511#c2)• 12 years ago |
|  | |

Comment on [attachment 655158](/attachment.cgi?id=655158 "patch, v1") [[details]](/attachment.cgi?id=655158&action=edit "patch, v1") [[diff]](/attachment.cgi?id=655158&action=diff "patch, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=655158)
patch, v1
>This breaks allowing people to automatically see index.html in docs/en/html and
>docs/en/html/api which we reference in a few places in the templates.
If we are omitting index.html from the URL, then we have to fix that. That's not the problem.
[Attachment #655158](/attachment.cgi?id=655158&action=edit "patch, v1") -
Flags: review- → review?(dkl)

|  | [:glob ✱](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=785511#c3)• 12 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #2](/show_bug.cgi?id=785511#c2 "RESOLVED FIXED - Prevent directory browsing in docs/, extensions/ and all other subdirectories of Bugzilla"))
> Comment on [attachment 655158](/attachment.cgi?id=655158 "patch, v1") [[details]](/attachment.cgi?id=655158&action=edit "patch, v1") [[diff]](/attachment.cgi?id=655158&action=diff "patch, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=655158)
> patch, v1
>
> >This breaks allowing people to automatically see index.html in docs/en/html and
> >docs/en/html/api which we reference in a few places in the templates.
>
> If we are omitting index.html from the URL, then we have to fix that. That's
> not the problem.
i disagree -- the right way to block directory browsing is with -Indexes, not with a .htaccess hack.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=785511#c4)• 12 years ago |
|  | |

(In reply to Byron Jones ‹:glob› from [comment #3](/show_bug.cgi?id=785511#c3 "RESOLVED FIXED - Prevent directory browsing in docs/, extensions/ and all other subdirectories of Bugzilla"))
> i disagree -- the right way to block directory browsing is with -Indexes,
> not with a .htaccess hack.
If you consider this a hack, then all first-level directories have a hack in them (Bugzilla/, templates/, graphs/, etc...)

|  | [:glob ✱](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=785511#c5)• 12 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #4](/show_bug.cgi?id=785511#c4 "RESOLVED FIXED - Prevent directory browsing in docs/, extensions/ and all other subdirectories of Bugzilla"))
> If you consider this a hack, then all first-level directories have a hack in
> them (Bugzilla/, templates/, graphs/, etc...)
oh, sorry, i was confusing the changes here with another very similar htaccess patch.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=785511#c6)• 12 years ago |
|  | |

Attached patch

[patch, v2](attachment.cgi?id=656040&action=diff)
— [Details](attachment.cgi?id=656040&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=656040)

Options -Indexes requires a change in httpd.conf which we cannot request for branches. So this patch will be for trunk only (4.4).
I also updated the doc to not suggest to use +Indexes, and also add index.html so that we can access the documentation more easily.
[Attachment #655158](/attachment.cgi?id=655158&action=edit "patch, v1") -
Attachment is obsolete: true
[Attachment #655158](/attachment.cgi?id=655158&action=edit "patch, v1") -
Flags: review?(dkl)
[Attachment #656040](/attachment.cgi?id=656040&action=edit "patch, v2") -
Flags: review?(dkl)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785511#a328298_120380)• 12 years ago |

Target Milestone: Bugzilla 4.2 → Bugzilla 4.4

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785511#a330559_120380)• 12 years ago |

Flags: blocking4.2.3+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=785511#c7)• 12 years ago |
|  | |

The change in httpd.conf needs to be relnoted in bold, else Apache won't be able to load Bugzilla anymore due to |Options -Indexes| in .htaccess.Keywords: [relnote](/buglist.cgi?keywords=relnote&resolution=---)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=785511#c8)• 12 years ago |
|  | |

Comment on [attachment 656040](/attachment.cgi?id=656040 "patch, v2") [[details]](/attachment.cgi?id=656040&action=edit "patch, v2") [[diff]](/attachment.cgi?id=656040&action=diff "patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=656040)
patch, v2
Review of [attachment 656040](/attachment.cgi?id=656040 "patch, v2") [[details]](/attachment.cgi?id=656040&action=edit "patch, v2") [[diff]](/attachment.cgi?id=656040&action=diff "patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785511&attachment=656040):
-----------------------------------------------------------------
r=dkl
[Attachment #656040](/attachment.cgi?id=656040&action=edit "patch, v2") -
Flags: review?(dkl) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785511#a347811_120380)• 12 years ago |

Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=785511#c9)• 12 years ago |
|  | |

Committing to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/trunk/
modified .htaccess
modified docs/en/xml/installation.xml
Committed revision 8360.Status: ASSIGNED → RESOLVEDClosed: 12 years agoResolution: --- → FIXED

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785511#a348643_120380)• 12 years ago |

Summary: Prevent directory browsing in docs/ → Prevent directory browsing in docs/, extensions/ and all other subdirectories of Bugzilla

|  | [Teemu Mannermaa (:wicked)](/user_profile?user_id=1064) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785511#a675019_1064)• 12 years ago |

Blocks: [787688](/show_bug.cgi?id=787688 "RESOLVED FIXED - AllowOverride Options missing when running under mod_perl")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=785511#c10)• 12 years ago |
|  | |

Added to relnotes for 4.4.Keywords: [relnote](/buglist.cgi?keywords=relnote&resolution=---)
You need to [log in](/show_bug.cgi?id=785511&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frédéric Buclin](/user_profile?user_id=120380)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_67282d73_20250125_233207.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/785522)
* [XML](/show_bug.cgi?ctype=xml&id=785522)

Closed
[Bug 785522](/show_bug.cgi?id=785522)

Opened 12 years ago
Closed 12 years ago

# [SECURITY] Block access to templates in extensions/

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] Block access to templates in extensions/

## Categories

### (Bugzilla :: Extensions, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Extensions#Extensions)

Extensions
▾

Bugzilla :: Extensions
Issues related to the Bugzilla extensions system. This is for bugs about the extensions system or extensions that ship with Bugzilla (such as BmpConvert or the Example extension). Bugs about third-party extensions should not be filed here--
usually third-party extensions have their own bug tracker.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Extensions&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Extensions&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Extensions)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.23.2

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 4.0

## People

### (Reporter: LpSolit, Assigned: LpSolit)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

3 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[786364](/show_bug.cgi?id=786364 "RESOLVED FIXED - Security advisory for Bugzilla 4.3.3, 4.2.3, 4.0.8 and 3.6.11")

Dependency [tree](/showdependencytree.cgi?id=785522&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=785522)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [LpSolit](/user_profile?user_id=120380) | [approval](#a504839_120380 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.4](#c0 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.4 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [approval4.2](#a504839_120380 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval4.2 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.2.3](#c0 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.2.3 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [approval4.0](#a504839_120380 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval4.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.0.8](#c0 "12 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.0.8 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking3.6.11](#c8 "12 years ago") | - |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking3.6.11 | - |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [patch, v1](/attachment.cgi?id=655215)  [12 years ago](#c2)  [Frédéric Buclin](/user_profile?user_id=120380)   987 bytes, patch | glob : [review-](#c3 "12 years ago") | [Details](/attachment.cgi?id=655215&action=edit) | [Diff](/attachment.cgi?id=655215&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785522&attachment=655215) |
| --- | --- | --- |
| [patch, v2](/attachment.cgi?id=656043)  [12 years ago](#c6)  [Frédéric Buclin](/user_profile?user_id=120380)   504 bytes, patch | glob : [review+](#c7 "12 years ago") | [Details](/attachment.cgi?id=656043&action=edit) | [Diff](/attachment.cgi?id=656043&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785522&attachment=656043) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=785522#c0)• 12 years ago |
|  | |

It's currently possible to browse all extensions from the web, though .pm modules are hidden thanks to bugzilla/.htaccess. But all templates remain visible, including their source code:
<https://landfill.bugzilla.org/bugzilla-tip/extensions/Voting/template/en/default/pages/voting/user.html.tmpl>
Some custom extensions may contain sensitive data or should simply be outside user's view.
It looks like this code is not doing its job correctly, despite what the comment says:
<http://bonsai.mozilla.org/cvsblame.cgi?file=mozilla/webtools/bugzilla/Bugzilla/Install/Filesystem.pm#209>
It looks like that 3.2 and newer are all vulnerable. I will have to check with older versions.Flags: blocking4.4+Flags: blocking4.2.3+Flags: blocking4.0.8+Flags: blocking3.6.11+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=785522#c1)• 12 years ago |
|  | |

Extensions exist since 2.23.2, see [bug 298341](/show_bug.cgi?id=298341 "RESOLVED FIXED - Implement code hook mechanism").Version: 3.2 → 2.23.2

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=785522#c2)• 12 years ago |
|  | |

Attached patch

[patch, v1](attachment.cgi?id=655215&action=diff) (obsolete)
— [Details](attachment.cgi?id=655215&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785522&attachment=655215)

I explicitly forbird directory browsing as well as viewing .pm, .pl and .tmpl files. I allow all other file formats to be viewable as we cannot guess which file formats the extensions wants to pass to the browser (.css, .js, .html, .png, etc.. come to mind, but there may be more).Assignee: extensions → LpSolitStatus: NEW → ASSIGNED
[Attachment #655215](/attachment.cgi?id=655215&action=edit "patch, v1") -
Flags: review?(dkl)

|  | [:glob ✱](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=785522#c3)• 12 years ago |
|  | |

Comment on [attachment 655215](/attachment.cgi?id=655215 "patch, v1") [[details]](/attachment.cgi?id=655215&action=edit "patch, v1") [[diff]](/attachment.cgi?id=655215&action=diff "patch, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785522&attachment=655215)
patch, v1
the extensions directory is already be protected by the deny in the root's .htaccess:
# Don't allow people to retrieve non-cgi executable files or our private data
<FilesMatch ^(.\*\.pm|.\*\.pl|.\*localconfig.\*)$>
deny from all
</FilesMatch>
a better fix would be to add .tmpl to that list, and add |Options -Indexes| to prevent directory browsing.
[Attachment #655215](/attachment.cgi?id=655215&action=edit "patch, v1") -
Flags: review?(dkl) → review-

|  | [:glob ✱](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=785522#c4)• 12 years ago |
|  | |

(In reply to Byron Jones ‹:glob› from [comment #3](/show_bug.cgi?id=785522#c3 "RESOLVED FIXED - [SECURITY] Block access to templates in extensions/"))
> a better fix would be to add .tmpl to that list, and add |Options -Indexes|
> to prevent directory browsing.
this will also fix [bug 785511](/show_bug.cgi?id=785511 "RESOLVED FIXED - Prevent directory browsing in docs/, extensions/ and all other subdirectories of Bugzilla")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=785522#c5)• 12 years ago |
|  | |

(In reply to Byron Jones ‹:glob› from [comment #3](/show_bug.cgi?id=785522#c3 "RESOLVED FIXED - [SECURITY] Block access to templates in extensions/"))
> a better fix would be to add .tmpl to that list, and add |Options -Indexes|
> to prevent directory browsing.
I'm fine to add .tmpl to the root .htaccess file, but the problem with Options in .htaccess is that we don't allow it by default, see <http://www.bugzilla.org/docs/tip/en/html/configuration.html#http>:
<Directory /var/www/html/bugzilla>
AddHandler cgi-script .cgi
Options +Indexes +ExecCGI
DirectoryIndex index.cgi
AllowOverride Limit FileInfo Indexes
</Directory>
Without AllowOverride Options, you cannot use Options in .htaccess. And for some unknown reasons, we suggest to write Options +Indexes in httpd.conf, which is part of the problem.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=785522#c6)• 12 years ago |
|  | |

Attached patch

[patch, v2](attachment.cgi?id=656043&action=diff)
— [Details](attachment.cgi?id=656043&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=785522&attachment=656043)

Simply blacklist .tmpl templates as we cannot do more on branches.
[Attachment #655215](/attachment.cgi?id=655215&action=edit "patch, v1") -
Attachment is obsolete: true
[Attachment #656043](/attachment.cgi?id=656043&action=edit "patch, v2") -
Flags: review?(glob)

|  | [:glob ✱](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=785522#c7)• 12 years ago |
|  | |

Comment on [attachment 656043](/attachment.cgi?id=656043 "patch, v2") [[details]](/attachment.cgi?id=656043&action=edit "patch, v2") [[diff]](/attachment.cgi?id=656043&action=diff "patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=785522&attachment=656043)
patch, v2
r=glob
[Attachment #656043](/attachment.cgi?id=656043&action=edit "patch, v2") -
Flags: review?(glob) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=785522#c8)• 12 years ago |
|  | |

Bugzilla 3.6 is affected too, but unfortunately .htaccess is not in the bzr/CVS repo and so cannot be edited easily. I could fix the default .htaccess generated by Bugzilla/Install/Filesystem.pm, but this wouldn't fix existing .htaccess files. So we are skipping 3.6 entirely. Admins still running 3.6 can fix their .htaccess file manually if they are concerned by this issue.Flags: blocking3.6.11-Flags: blocking3.6.11+Flags: approval?Flags: approval4.2?Flags: approval4.0?Target Milestone: Bugzilla 3.6 → Bugzilla 4.0

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785522#a330904_120380)• 12 years ago |

Blocks: [786364](/show_bug.cgi?id=786364 "RESOLVED FIXED - Security advisory for Bugzilla 4.3.3, 4.2.3, 4.0.8 and 3.6.11")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785522#a502354_120380)• 12 years ago |

Summary: [SECURITY] Prevent directory browsing in extensions/ → [SECURITY] Block access to templates in extensions/

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785522#a504839_120380)• 12 years ago |

Flags: approval?Flags: approval4.2?Flags: approval4.2+Flags: approval4.0?Flags: approval4.0+Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=785522#c9)• 12 years ago |
|  | |

Committing to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/trunk/
modified .htaccess
Committed revision 8369.
Committing to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/4.2/
modified .htaccess
Committed revision 8131.
Committing to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/4.0/
modified .htaccess
Committed revision 7720.Status: ASSIGNED → RESOLVEDClosed: 12 years agoResolution: --- → FIXED

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=785522#a514383_5898)• 12 years ago |

Group: bugzilla-security
You need to [log in](/show_bug.cgi?id=785522&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frédéric Buclin](/user_profile?user_id=120380)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


