=== Content from issues.apache.org_7573281a_20250126_104045.html ===


[Log in](/jira/login.jsp?os_destination=%2Fbrowse%2FWW-3858)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![ASF JIRA](/jira/s/xd97tr/820010/13pdxe5/_/jira-logo-scaled.png)](https://issues.apache.org/jira/secure/MyJiraHome.jspa)

* [Dashboards](/jira/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/jira/browse/WW "View recent projects and browse a list of projects")
* [Issues](/jira/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/jira/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/jira/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/jira/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FWW-3858)

Public signup for this instance is **disabled**. Go to our [Self serve sign up page](https://selfserve.apache.org/jira-account.html) to request an account. Report potential security issues [privately](https://apache.org/security/#reporting-a-vulnerability)

![Uploaded image for project: 'Struts 2'](https://issues.apache.org/jira/secure/projectavatar?pid=12311041&avatarId=22177)

1. [Struts 2](/jira/browse/WW)
2. [WW-3858](/jira/browse/WW-3858)

# Decouple token names from their respective session attribute names

[Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FWW-3858 "Log In")Export

XMLWordPrintableJSON
#### Details

* **Type:**
  ![](/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.") Improvement
* **Status:**
  Closed
* **Priority:**
  ![](/jira/images/icons/priorities/major.svg "Major - Major loss of function.") Major
* **Resolution:**
  Fixed
* **Affects Version/s:**
  2.3.4
* **Fix Version/s:**
  [2.3.4.1](/jira/issues/?jql=project+%3D+WW+AND+fixVersion+%3D+2.3.4.1 "2.3.4.1 Fast track release to solve security vulnerabilities")
* **Component/s:**
  [Core Interceptors](/jira/issues/?jql=project+%3D+WW+AND+component+%3D+%22Core+Interceptors%22 "Core Interceptors ")
* **Labels:**
  None
#### Description

Currently token names are used as is to store session attributes for later token check. By namespacing session attributes security can be improved.

#### Attachments

#### Activity

#### People

Assignee:

![rgielen](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
René Gielen

Reporter:

![rgielen](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
René Gielen

Votes:
0
Vote for this issue

Watchers:
3
Start watching this issue

#### Dates

Created:

03/Aug/12 06:02

Updated:

28/Oct/12 22:08

Resolved:

03/Aug/12 10:41

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/jira/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/jira/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Apache Software Foundation. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from www.openwall.com_c4dcd307_20250125_173842.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2012/09/02/1) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <504296AE.5080005@redhat.com>
Date: Sat, 01 Sep 2012 17:13:50 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Raphael Geissert <geissert@...ian.org>, security@...uts.apache.org
Subject: Re: CVE request: Apache Struts S2-010 and S2-011

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 09/01/2012 11:35 AM, Raphael Geissert wrote:
> Hi,
>
> Apache Struts 2.3.4.1 fixes the vulnerabilities described in S2-010
> (CSRF) and S2-011 (DoS).
>
> Could CVE ids be assigned please?

Yes, confirmed struts 2.3.4.1 was released August 11, 2012.

====

> [1] <http://struts.apache.org/2.x/docs/s2-010.html>

When using Struts 2 token mechanism for CSRF protection, token check
may be bypassed by misusing known session attributes

Please use CVE-2012-4386 for this issue.

====

> [2] <http://struts.apache.org/2.x/docs/s2-011.html>

Long request parameter names might significantly promote the
effectiveness of DOS attacks

Please use CVE-2012-4387 for this issue.

These don't appear to affect struts 1.2.x/1.3.x.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://www.enigmail.net/>

iQIcBAEBAgAGBQJQQpauAAoJEBYNRVNeJnmTShsQAKIZvJnzfCPE8TZBy3hj265v
vwDUwHUynvom4pEvXfORIY3ni2QmwGOD9mzUKr9WI3Qw+AGNsEjB7AeYYczxWbK/
fmuqG5StLrZBMMZju/MseMcbgZcExom+xaas8S9/qU5aTbyx7QvAnnSO/W3xdOzy
srEQlW4sSUrPQ3JqXJIYKMOPFoVWXKT4kpq3UF+2zQGunPRbn2FyCKzM7iWhKtKb
XPdFYxbjKycnDlv8uKlSDeQiQVnDHfdT1jHnLVY9hao1EpF2lfOLT2OPapa5p7Td
uRKgBNsGyIhZPKBRvSQKIs+WKD+SAFrkJ+fy01NnxGNpGUMXA/+vwMjOh+Jktbgr
h30rJQNUtBIS83M0oL6zxj9oXKJ/rYFtCSc/XcQb3X7jdZ7vV9kKHVZlQ6yP/qCH
mn6E0G9xzzs4FNat0rKlvSa13NQM736g9GH4stZOnzqMken7c24HizLLf3KUcXhE
Mo/jiPUOTNufpzgdUdi+somDFKq4BPU9X4Vkiftid6BYDLruCmh+HODlUwRu6LVF
UnGIGp1gdZAmTIS+O00TQb9Rne7PWyT+BRHHl454+k6cdIrQmyacYgKLxwBzcHCq
jgWaDbTjS0cDsmjWMLFRGE3AIJ4wWod1vPMIQv5Tw6X25fGSRpUZqh0AVK/e8l5H
3wFKAPZVfXNaLS74lNoW
=bRtv
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_01ccbc37_20250125_173841.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201209011235.35043.geissert@debian.org>
Date: Sat, 1 Sep 2012 12:35:33 -0500
From: Raphael Geissert <geissert@...ian.org>
To: oss-security@...ts.openwall.com
Cc: security@...uts.apache.org
Subject: CVE request: Apache Struts S2-010 and S2-011

Hi,

Apache Struts 2.3.4.1 fixes the vulnerabilities described in S2-010 (CSRF)
and S2-011 (DoS).

Could CVE ids be assigned please?

[1] <http://struts.apache.org/2.x/docs/s2-010.html>
[2] <http://struts.apache.org/2.x/docs/s2-011.html>

Sincerely,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from struts.apache.org_cb74ccff_20250125_173840.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-010)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-010)

[![Apache Struts 2 Wiki](/confluence/images/logo/default-space-logo.svg)](/confluence/display/WW/Home "Apache Struts 2 Wiki")[Apache Struts 2 Wiki](/confluence/display/WW/Home "Apache Struts 2 Wiki")
##### Child pages

* [Security Bulletins](/confluence/display/WW/Security%2BBulletins "Security Bulletins")

* S2-010
Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=30146792 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=30146792)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=30146792)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=WW&openId=30146792#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=30146792)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=30146792)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=30146792)
  + [Export to Word](/confluence/exportword?pageId=30146792)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=30146792)

1. [Pages](/confluence/collector/pages.action?key=WW)- [Home](/confluence/display/WW/Home)- [Security Bulletins](/confluence/display/WW/Security%2BBulletins)

* Jira links
# [S2-010](/confluence/display/WW/S2-010)

* Created by  [René Gielen](/confluence/display/~rgielen), last modified on [Oct 09, 2012](/confluence/pages/diffpagesbyversion.action?pageId=30146792&selectedPageVersions=7&selectedPageVersions=8 "Show changes")

## Summary

When using Struts 2 token mechanism for CSRF protection, token check may be bypassed by misusing known session attributes

| Who should read this | All Struts 2 developers |
| --- | --- |
| Impact of vulnerability | CSRF protection weakening |
| Maximum security rating | Moderate |
| Recommendation | Developers should upgrade to [Struts 2.3.4.1](http://struts.apache.org/download.cgi#struts2341) |
| Affected Software | Struts 2.0.0 - Struts 2.3.4 |
| Original JIRA Tickets | [WW-3858](https://issues.apache.org/jira/browse/WW-3858) |
| Reporter | James K. Williams |
| CVE Identifier | CVE-2012-4386 |

## Problem

The Struts 2 token mechanism (token tag and token interceptors) was originally targeted at providing double submit check for forms.

In addition the mechanism basically qualifies for CSRF protection by implementing the Synchronizer Token Pattern, as described in the [OWASP CSRF Prevention Cheat Sheet](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet).

When used for that purpose, a possible attacker might manipulate a request by changing the token name configuration parameter to match a String typed session attribute known to him by name and value, along with changing the token value parameter to the value of the said session attribute. The token check mechanism is then bypassed by the existent session attribute matching the request's token configuration.

## Solution

As of Struts 2.3.4.1, token session attribute names are decoupled from token parameter names by namespace prefixing.

Please upgrade to [Struts 2.3.4.1](http://struts.apache.org/download.cgi#struts2341).

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 74, "requestCorrelationId": "a537bd435781a6e4"}

