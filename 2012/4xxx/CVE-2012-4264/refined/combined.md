=== Content from plugins.trac.wordpress.org_f537e5cf_20250124_121447.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew_path%3D%252Fbetter-wp-security%26old%3D542852%26new%3D542852%26old_path%3D%252Fbetter-wp-security)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/542080/better-wp-security "Changeset 542080 for better-wp-security")
* [Next Change](/changeset/542862/better-wp-security "Changeset 542862 for better-wp-security") →

---

# Changeset [542852](/changeset/542852 "Show full changeset") for [better-wp-security](/browser/better-wp-security?rev=542852 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/11/2012 01:18:02 PM
([13 years](/timeline?from=2012-05-11T13%3A18%3A02Z&precision=second "See timeline at 05/11/2012 01:18:02 PM") ago)

Author:
Bit51
Message:

Better Sanitization to eliminate possible XSS attack

Location:
[better-wp-security/trunk/inc](/browser/better-wp-security/trunk/inc?rev=542852)
Files:

4 edited

* [admin/common.php](/browser/better-wp-security/trunk/inc/admin/common.php?rev=542852 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [admin/content.php](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852 "Show entry in browser")
  (modified)
  ([21 diffs](#file1 "Show differences"))
* [admin/process.php](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542852 "Show entry in browser")
  (modified)
  ([5 diffs](#file2 "Show differences"))
* [setup.php](/browser/better-wp-security/trunk/inc/setup.php?rev=542852 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [better-wp-security/trunk/inc/admin/common.php](/changeset/542852/better-wp-security/trunk/inc/admin/common.php "Show the changeset 542852 restricted to better-wp-security/trunk/inc/admin/common.php")

  | [r541843](/browser/better-wp-security/trunk/inc/admin/common.php?rev=541843#L186 "Show revision 541843 of this file in browser") | [r542852](/browser/better-wp-security/trunk/inc/admin/common.php?rev=542852#L186 "Show revision 542852 of this file in browser") |  |
  | --- | --- | --- |
  | 186 | 186 |  |
  | 187 | 187 | //figure out what server they're using |
  | 188 |  | if ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE']~~ ), 'apache' ) ) { |
  |  | 188 | if ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) ) { |
  | 189 | 189 |  |
  | 190 | 190 | $bwpsserver = 'apache'; |
  | 191 | 191 |  |
  | 192 |  | } else if ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE']~~ ), 'nginx' ) ) { |
  |  | 192 | } else if ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'nginx' ) ) { |
  | 193 | 193 |  |
  | 194 | 194 | $bwpsserver = 'nginx'; |
  | 195 | 195 |  |
  | 196 |  | } else if ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) { |
  |  | 196 | } else if ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) { |
  | 197 | 197 |  |
  | 198 | 198 | $bwpsserver = 'litespeed'; |
* ## [better-wp-security/trunk/inc/admin/content.php](/changeset/542852/better-wp-security/trunk/inc/admin/content.php "Show the changeset 542852 restricted to better-wp-security/trunk/inc/admin/content.php")

  | [r542066](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L175 "Show revision 542066 of this file in browser") | [r542852](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L175 "Show revision 542852 of this file in browser") |  |
  | --- | --- | --- |
  | 175 | 175 | if ( $bwpsoptions['initial\_backup'] == 1 && $bwpsoptions['initial\_filewrite'] == 1 ) { //they've backed up their database or ignored the warning |
  | 176 | 176 |  |
  | 177 |  | if ( ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) || strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { |
  |  | 177 | if ( ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) || strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { |
  | 178 | 178 |  |
  | 179 | 179 | $this->admin\_page( $this->pluginname . ' - ' . \_\_( 'System Status', $this->hook ), |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L770) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L770) |  |
  | 770 | 770 | <ul> |
  | 771 | 771 | <li><?php \_e( 'Public IP Address', $this->hook ); ?>: <strong><a target="\_blank" title="<?php \_e( 'Get more information on this address', $this->hook ); ?>" href="http://whois.domaintools.com/<?php echo $\_SERVER['REMOTE\_ADDR']; ?>"><?php echo $\_SERVER['REMOTE\_ADDR']; ?></a></strong></li> |
  | 772 |  | <li><?php \_e( 'User Agent', $this->hook ); ?>: <strong><?php echo ~~$\_SERVER['HTTP\_USER\_AGENT']~~; ?></strong></li> |
  |  | 772 | <li><?php \_e( 'User Agent', $this->hook ); ?>: <strong><?php echo filter\_var( $\_SERVER['HTTP\_USER\_AGENT'], FILTER\_SANITIZE\_STRING ); ?></strong></li> |
  | 773 | 773 | </ul> |
  | 774 | 774 | </li> |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L778) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L778) |  |
  | 778 | 778 | <ul> |
  | 779 | 779 | <li><?php \_e( 'Website Root Folder', $this->hook ); ?>: <strong><?php echo get\_site\_url(); ?></strong></li> |
  | 780 |  | <li><?php \_e( 'Document Root Path', $this->hook ); ?>: <strong><?php echo ~~$\_SERVER['DOCUMENT\_ROOT']~~; ?></strong></li> |
  |  | 780 | <li><?php \_e( 'Document Root Path', $this->hook ); ?>: <strong><?php echo filter\_var( $\_SERVER['DOCUMENT\_ROOT'], FILTER\_SANITIZE\_STRING ); ?></strong></li> |
  | 781 | 781 | <?php |
  | 782 | 782 | $htaccess = ABSPATH . '.htaccess'; |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L849) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L849) |  |
  | 849 | 849 | <ul> |
  | 850 | 850 | <li><?php \_e( 'Server / Website IP Address', $this->hook ); ?>: <strong><a target="\_blank" title="<?php \_e( 'Get more information on this address', $this->hook ); ?>" href="http://whois.domaintools.com/<?php echo $\_SERVER['SERVER\_ADDR']; ?>"><?php echo $\_SERVER['SERVER\_ADDR']; ?></a></strong></li> |
  | 851 |  | <li><?php \_e( 'Server Type', $this->hook ); ?>: <strong><?php echo ~~$\_SERVER['SERVER\_SOFTWARE']~~; ?></strong></li> |
  |  | 851 | <li><?php \_e( 'Server Type', $this->hook ); ?>: <strong><?php echo filter\_var( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ), FILTER\_SANITIZE\_STRING ); ?></strong></li> |
  | 852 | 852 | <li><?php \_e( 'Operating System', $this->hook ); ?>: <strong><?php echo PHP\_OS; ?></strong></li> |
  | 853 |  | <li><?php \_e( 'Browser Compression Supported', $this->hook ); ?>: <strong><?php echo ~~$\_SERVER['HTTP\_ACCEPT\_ENCODING']~~; ?></strong></li> |
  |  | 853 | <li><?php \_e( 'Browser Compression Supported', $this->hook ); ?>: <strong><?php echo filter\_var( $\_SERVER['HTTP\_ACCEPT\_ENCODING'], FILTER\_SANITIZE\_STRING ); ?></strong></li> |
  | 854 | 854 | </ul> |
  | 855 | 855 | </li> |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L862) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L862) |  |
  | 862 | 862 | <?php |
  | 863 | 863 | if ( ini\_get( 'memory\_limit' ) ) { |
  | 864 |  | $memory\_limit = ~~ini\_get( 'memory\_limit'~~ ); |
  |  | 864 | $memory\_limit = filter\_var( ini\_get( 'memory\_limit' ), FILTER\_SANITIZE\_STRING ); |
  | 865 | 865 | } else { |
  | 866 | 866 | $memory\_limit = \_\_( 'N/A', $this->hook ); |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L870) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L870) |  |
  | 870 | 870 | <?php |
  | 871 | 871 | if ( ini\_get( 'upload\_max\_filesize' ) ) { |
  | 872 |  | $upload\_max = ~~ini\_get( 'upload\_max\_filesize'~~ ); |
  |  | 872 | $upload\_max = filter\_var( ini\_get( 'upload\_max\_filesize' ), FILTER\_SANITIZE\_STRING ); |
  | 873 | 873 | } else  { |
  | 874 | 874 | $upload\_max = \_\_( 'N/A', $this->hook ); |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L878) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L878) |  |
  | 878 | 878 | <?php |
  | 879 | 879 | if ( ini\_get( 'post\_max\_size' ) ) { |
  | 880 |  | $post\_max = ~~ini\_get( 'post\_max\_size'~~ ); |
  |  | 880 | $post\_max = filter\_var( ini\_get( 'post\_max\_size' ), FILTER\_SANITIZE\_STRING ); |
  | 881 | 881 | } else { |
  | 882 | 882 | $post\_max = \_\_( 'N/A', $this->hook ); |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L893) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L893) |  |
  | 893 | 893 | <li><?php \_e( 'PHP Safe Mode', $this->hook ); ?>: <strong><?php echo $safe\_mode; ?></strong></li> |
  | 894 | 894 | <?php |
  | 895 |  | if (ini\_get( 'allow\_url\_fopen' ) ) { |
  |  | 895 | if ( ini\_get( 'allow\_url\_fopen' ) ) { |
  | 896 | 896 | $allow\_url\_fopen = \_\_( 'On', $this->hook ); |
  | 897 | 897 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L901) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L901) |  |
  | 901 | 901 | <li><?php \_e( 'PHP Allow URL fopen', $this->hook ); ?>: <strong><?php echo $allow\_url\_fopen; ?></strong></li> |
  | 902 | 902 | <?php |
  | 903 |  | if (ini\_get( 'allow\_url\_include' ) ) { |
  |  | 903 | if ( ini\_get( 'allow\_url\_include' ) ) { |
  | 904 | 904 | $allow\_url\_include = \_\_( 'On', $this->hook ); |
  | 905 | 905 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L909) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L909) |  |
  | 909 | 909 | <li><?php \_e( 'PHP Allow URL Include' ); ?>: <strong><?php echo $allow\_url\_include; ?></strong></li> |
  | 910 | 910 | <?php |
  | 911 |  | if (ini\_get( 'display\_errors' ) ) { |
  |  | 911 | if ( ini\_get( 'display\_errors' ) ) { |
  | 912 | 912 | $display\_errors = \_\_( 'On', $this->hook ); |
  | 913 | 913 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L917) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L917) |  |
  | 917 | 917 | <li><?php \_e( 'PHP Display Errors', $this->hook ); ?>: <strong><?php echo $display\_errors; ?></strong></li> |
  | 918 | 918 | <?php |
  | 919 |  | if (ini\_get( 'display\_startup\_errors' ) ) { |
  |  | 919 | if ( ini\_get( 'display\_startup\_errors' ) ) { |
  | 920 | 920 | $display\_startup\_errors = \_\_( 'On', $this->hook ); |
  | 921 | 921 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L925) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L925) |  |
  | 925 | 925 | <li><?php \_e( 'PHP Display Startup Errors', $this->hook ); ?>: <strong><?php echo $display\_startup\_errors; ?></strong></li> |
  | 926 | 926 | <?php |
  | 927 |  | if (ini\_get( 'expose\_php' ) ) { |
  |  | 927 | if ( ini\_get( 'expose\_php' ) ) { |
  | 928 | 928 | $expose\_php = \_\_( 'On', $this->hook ); |
  | 929 | 929 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L933) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L933) |  |
  | 933 | 933 | <li><?php \_e( 'PHP Expose PHP', $this->hook ); ?>: <strong><?php echo $expose\_php; ?></strong></li> |
  | 934 | 934 | <?php |
  | 935 |  | if (ini\_get( 'register\_globals' ) ) { |
  |  | 935 | if ( ini\_get( 'register\_globals' ) ) { |
  | 936 | 936 | $register\_globals = \_\_( 'On', $this->hook ); |
  | 937 | 937 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L941) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L941) |  |
  | 941 | 941 | <li><?php \_e( 'PHP Register Globals', $this->hook ); ?>: <strong><?php echo $register\_globals; ?></strong></li> |
  | 942 | 942 | <?php |
  | 943 |  | if (ini\_get( 'max\_execution\_time' ) ) { |
  |  | 943 | if ( ini\_get( 'max\_execution\_time' ) ) { |
  | 944 | 944 | $max\_execute = ini\_get( 'max\_execution\_time' ); |
  | 945 | 945 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L949) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L949) |  |
  | 949 | 949 | <li><?php \_e( 'PHP Max Script Execution Time' ); ?>: <strong><?php echo $max\_execute; ?> <?php \_e( 'Seconds' ); ?></strong></li> |
  | 950 | 950 | <?php |
  | 951 |  | if (ini\_get( 'magic\_quotes\_gpc' ) ) { |
  |  | 951 | if ( ini\_get( 'magic\_quotes\_gpc' ) ) { |
  | 952 | 952 | $magic\_quotes\_gpc = \_\_( 'On', $this->hook ); |
  | 953 | 953 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L957) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L957) |  |
  | 957 | 957 | <li><?php \_e( 'PHP Magic Quotes GPC', $this->hook ); ?>: <strong><?php echo $magic\_quotes\_gpc; ?></strong></li> |
  | 958 | 958 | <?php |
  | 959 |  | if (ini\_get( 'open\_basedir' ) ) { |
  |  | 959 | if ( ini\_get( 'open\_basedir' ) ) { |
  | 960 | 960 | $open\_basedir = \_\_( 'On', $this->hook ); |
  | 961 | 961 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L965) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L965) |  |
  | 965 | 965 | <li><?php \_e( 'PHP open\_basedir', $this->hook ); ?>: <strong><?php echo $open\_basedir; ?></strong></li> |
  | 966 | 966 | <?php |
  | 967 |  | if (is\_callable( 'xml\_parser\_create' ) ) { |
  |  | 967 | if ( is\_callable( 'xml\_parser\_create' ) ) { |
  | 968 | 968 | $xml = \_\_( 'Yes', $this->hook ); |
  | 969 | 969 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L973) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L973) |  |
  | 973 | 973 | <li><?php \_e( 'PHP XML Support', $this->hook ); ?>: <strong><?php echo $xml; ?></strong></li> |
  | 974 | 974 | <?php |
  | 975 |  | if (is\_callable( 'iptcparse' ) ) { |
  |  | 975 | if ( is\_callable( 'iptcparse' ) ) { |
  | 976 | 976 | $iptc = \_\_( 'Yes', $this->hook ); |
  | 977 | 977 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L981) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L981) |  |
  | 981 | 981 | <li><?php \_e( 'PHP IPTC Support', $this->hook ); ?>: <strong><?php echo $iptc; ?></strong></li> |
  | 982 | 982 | <?php |
  | 983 |  | if (is\_callable( 'exif\_read\_data' ) ) { |
  |  | 983 | if ( is\_callable( 'exif\_read\_data' ) ) { |
  | 984 | 984 | $exif = \_\_( 'Yes', $this->hook ). " ( V" . substr(phpversion( 'exif' ),0,4) . ")" ; |
  | 985 | 985 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L2293) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L2293) |  |
  | 2293 | 2293 | global $bwpsoptions; |
  | 2294 | 2294 | ?> |
  | 2295 |  | <?php if ( ! strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) &&  ! strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE'] ), 'litespeed' ) && ! strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'nginx' ) ) { //don't diplay options for unsupported server ?> |
  |  | 2295 | <?php if ( ! strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) &&  ! strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) && ! strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'nginx' ) ) { //don't diplay options for unsupported server ?> |
  | 2296 | 2296 | <p><?php \_e( 'Your webserver is unsupported. You must use Apache, LiteSpeed or NGINX to make use of these rules.', $this->hook ); ?></p> |
  | 2297 | 2297 | <?php } else { ?> |
  | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542066#L2315) | […](/browser/better-wp-security/trunk/inc/admin/content.php?rev=542852#L2315) |  |
  | 2315 | 2315 | </td> |
  | 2316 | 2316 | </tr> |
  | 2317 |  | <?php if ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) || strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) { ?> |
  |  | 2317 | <?php if ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) || strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) { ?> |
  | 2318 | 2318 | <tr valign="top" style="border: 1px solid #ffcc00;"> |
  | 2319 | 2319 | <th scope="row"> |
* ## [better-wp-security/trunk/inc/admin/process.php](/changeset/542852/better-wp-security/trunk/inc/admin/process.php "Show the changeset 542852 restricted to better-wp-security/trunk/inc/admin/process.php")

  | [r542056](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542056#L488 "Show revision 542056 of this file in browser") | [r542852](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542852#L488 "Show revision 542852 of this file in browser") |  |
  | --- | --- | --- |
  | 488 | 488 | update\_option( $this->primarysettings, $bwpsoptions ); |
  | 489 | 489 |  |
  | 490 |  | if ( ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) || strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  |  | 490 | if ( ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) || strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  | 491 | 491 |  |
  | 492 | 492 | $this->writehtaccess(); |
  | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542056#L910) | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542852#L910) |  |
  | 910 | 910 | update\_option( $this->primarysettings, $bwpsoptions ); |
  | 911 | 911 |  |
  | 912 |  | if ( ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) || strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  |  | 912 | if ( ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) || strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  | 913 | 913 |  |
  | 914 | 914 | $this->writehtaccess(); |
  | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542056#L1351) | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542852#L1351) |  |
  | 1351 | 1351 | } |
  | 1352 | 1352 |  |
  | 1353 |  | if ( ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) || strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  |  | 1353 | if ( ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) || strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  | 1354 | 1354 |  |
  | 1355 | 1355 | $this->writehtaccess(); |
  | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542056#L1400) | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542852#L1400) |  |
  | 1400 | 1400 |  |
  | 1401 | 1401 | //always set directory browsing to 1 on nginx to prevent nag |
  | 1402 |  | if ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE']~~ ), 'apache' ) ) { |
  |  | 1402 | if ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) ) { |
  | 1403 | 1403 | $bwpsoptions['st\_ht\_browsing'] = ( isset( $\_POST['st\_ht\_browsing'] ) && $\_POST['st\_ht\_browsing'] == 1  ? 1 : 0 ); |
  | 1404 | 1404 | } else { |
  | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542056#L1442) | […](/browser/better-wp-security/trunk/inc/admin/process.php?rev=542852#L1442) |  |
  | 1442 | 1442 | } |
  | 1443 | 1443 |  |
  | 1444 |  | if ( ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) || strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  |  | 1444 | if ( ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) || strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  | 1445 | 1445 |  |
  | 1446 | 1446 | $this->writehtaccess(); |
* ## [better-wp-security/trunk/inc/setup.php](/changeset/542852/better-wp-security/trunk/inc/setup.php "Show the changeset 542852 restricted to better-wp-security/trunk/inc/setup.php")

  | [r542069](/browser/better-wp-security/trunk/inc/setup.php?rev=542069#L184 "Show revision 542069 of this file in browser") | [r542852](/browser/better-wp-security/trunk/inc/setup.php?rev=542852#L184 "Show revision 542852 of this file in browser") |  |
  | --- | --- | --- |
  | 184 | 184 | } |
  | 185 | 185 |  |
  | 186 |  | if ( ( strstr( strtolower( ~~$\_SERVER['SERVER\_SOFTWARE'] ), 'apache' ) || strstr( strtolower( $\_SERVER['SERVER\_SOFTWARE']~~ ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  |  | 186 | if ( ( strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'apache' ) || strstr( strtolower( filter\_var( $\_SERVER['SERVER\_SOFTWARE'], FILTER\_SANITIZE\_STRING ) ), 'litespeed' ) ) && $bwpsoptions['st\_writefiles'] == 1 ) { //if they're using apache write to .htaccess |
  | 187 | 187 |  |
  | 188 | 188 | $this->writehtaccess(); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=542852)
* [Zip Archive](?format=zip&new=542852)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


