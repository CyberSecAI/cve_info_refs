Based on the provided information, here's a breakdown of the vulnerability described by CVE-2012-4402:

**Root Cause of Vulnerability:**

*   The vulnerability lies in how Moodle handles web service access tokens. Specifically, users with access to multiple web services could use a token from one service to access functions in *other* services, for which the token wasn't intended. This indicates a lack of proper token scoping and permission checks.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure Token Handling:** Web service tokens were not properly restricted to the specific service they were meant for.
*   **Insufficient Access Control:** The system failed to enforce the intended service-specific authorization, allowing users to bypass intended limitations.

**Impact of Exploitation:**

*   **Unauthorized Access:** Attackers could potentially access functions across different web services using a single compromised token.
*   **Potential Data Exposure/Manipulation:** Depending on the functions available through the other services, attackers could potentially gain access to sensitive information or modify data without authorization.

**Attack Vectors:**

*   **Web Service Token Theft:** An attacker could obtain a valid web service token. This could be achieved in various ways, for example:
    *  Compromising a user's account that has access to the web service
    *  Eavesdropping on network traffic

*   **Token Replay:** With a valid token, an attacker could then use it in requests to different web services.

**Required Attacker Capabilities/Position:**

*   **User Account:** The attacker must have an account on a Moodle instance with access to at least one web service.
*   **Token Acquisition:** The attacker needs to obtain a valid web service token.
*   **Network Access:**  The attacker needs to be able to make requests to the Moodle instance.

**Additional Details:**

*   The vulnerability affects Moodle versions 2.3 to 2.3.1+, 2.2 to 2.2.4+, and 2.1 to 2.1.7+.
*   The vulnerability was reported by Nathan Mares and assigned the Moodle tracker issue ID MDL-34368.
*   The fix involves changes to the Moodle code in the master branch at [http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-34368](http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-34368). The provided Git commit diffs further clarify changes made to address the broken query and validuntil condition.