Based on the provided information, here's a breakdown of the vulnerability described in CVE-2012-3504:

**Root Cause of Vulnerability:**

The `genkey` Perl script, part of the `crypto-utils` package, uses insecure temporary file handling. Specifically, it writes to a file named "list" in the current working directory without checking if the file already exists, and it does this in several other places as well using hardcoded filenames.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure Temporary File Creation:** The script creates temporary files with predictable names ("list", "dbdirectory", "nssnickname", "dbprefix") in the current working directory instead of using secure temporary file creation mechanisms.
*   **File Overwriting:** The script overwrites existing files with these predictable names without proper checks.

**Impact of Exploitation:**

*   **Arbitrary File Overwrite:** A malicious actor can create a symbolic link with one of the above mentioned hardcoded names, and then trick the root user into running the `genkey` script from a directory where the symbolic link exists, leading to arbitrary file overwriting. This means an attacker could potentially overwrite critical system files if they could coerce a root user to execute the vulnerable code in a controlled manner.
*  **Privilege Escalation (Potential):** While not explicitly stated in the provided text, the ability to overwrite arbitrary files as root can be a stepping stone to privilege escalation, depending on the overwritten file.

**Attack Vectors:**

*   **Coercing Root User:** The attacker needs to trick a root user into running the vulnerable `genkey` script from a directory containing a carefully crafted symbolic link.

**Required Attacker Capabilities/Position:**

*   **Ability to create symbolic links:** The attacker needs to be able to create symbolic links within the filesystem.
*   **Social Engineering/Exploitation:** The attacker needs to trick the root user into executing the `genkey` script from a specific directory.
*   **User context:** The attacker needs to be able to cause the root user to execute the script.

**Additional Details:**

*   The vulnerability exists in the `nssconfigFound()` function of the `genkey.pl` script, and other places where shell commands are used with hardcoded filenames.
*   The fix involves using the `File::Temp` module in Perl to create temporary files with unique names, avoiding file overwriting.
*   The vulnerable code was introduced in Red Hat Enterprise Linux 6 and Fedora.

The provided content gives more detail on the vulnerable code and the suggested fix by using File::Temp, as well as the attack vector, which is not as clear in the CVE description.