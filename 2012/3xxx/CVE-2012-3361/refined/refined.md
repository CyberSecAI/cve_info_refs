Based on the provided documents, here's a breakdown of the vulnerability information related to CVE-2012-3361:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a directory traversal issue in the `nova/virt/disk/api.py` file of OpenStack Compute (Nova). This file handles the injection of files into disk images.
*   Specifically, the code failed to properly validate paths specified for injected files, allowing an attacker to use `..` sequences to navigate outside the intended file system.

**Weaknesses/Vulnerabilities Present:**

*   **Directory Traversal:** The primary weakness is the lack of proper sanitization and validation of file paths during file injection.  An attacker could use ".." sequences within the file path to traverse directories and potentially access or modify files outside the mounted guest file system.
*   **Insecure File Handling:**  The vulnerability exists because the file injection mechanism in `nova/virt/disk/api.py` does not check if a requested "path" for a file being injected is still within the image's mount directory. This means an attacker could write files to arbitrary locations on the host file system.
*   **Symlink Vulnerability:** An attacker could also upload an image with symlinks in locations such as `/root/.ssh`, `/etc/network` or metadata files. If symlinks point outside of the image's file system the attacker can inject keys to host `/root/.ssh/authorized_keys`, overwrite arbitrary files on the host.

**Impact of Exploitation:**

*   **Arbitrary File Injection/Corruption:**  An attacker could inject files into arbitrary locations on the host file system, potentially leading to full compromise of the compute node.
*   **Denial of Service (DoS):** An attacker could corrupt files on the host file system, leading to a denial of service.
*   **Privilege Escalation:** Through overwriting specific files (e.g., `/etc/passwd`), an attacker could potentially gain root privileges on the compute node.
*   **Host Compromise:**  By injecting malicious files, the entire compute node could be compromised.

**Attack Vectors:**

*   **Remote Authenticated User:** The attack can be performed by a remote user with valid authentication credentials for the OpenStack API.
*   **Malicious File Injection:** Attackers inject malicious file paths using the `personality` metadata or crafted images.

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** The attacker needs to have valid credentials to interact with the OpenStack API.
*   **Ability to Create Instances:** The attacker needs to be able to request the creation of new instances, as this is how file injection is triggered.

**Additional Notes:**

*   The vulnerability affects multiple versions of OpenStack Nova: Essex, Folsom, and Diablo are all vulnerable, although the exploit vector varies slightly.
*   Diablo is vulnerable through a symlink attack, whereas Essex and Folsom are vulnerable by providing a crafted path via the <personality> tag.
*   The issue was resolved by introducing path validation checks in `nova/virt/disk/api.py`.
*   The fix ensures that any injected file path is within the mounted guest filesystem by using `os.path.realpath()` and `startswith()`
*   Two CVEs (CVE-2012-3360 and CVE-2012-3361) were assigned to the vulnerability because of slightly different ways to exploit the vulnerability.

**Patches**
Patches were released to address this vulnerability:
* [https://github.com/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7](https://github.com/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7) - Fix for Folsom
*   [https://github.com/openstack/nova/commit/b0feaffdb2b1c51182b8dce41b367f3449af5dd9](https://github.com/openstack/nova/commit/b0feaffdb2b1c51182b8dce41b367f3449af5dd9) - Fix for Essex
* [https://review.openstack.org/#/c/9268/](https://review.openstack.org/#/c/9268/) - Fix for Diablo

This detailed breakdown provides a comprehensive understanding of the security vulnerability associated with CVE-2012-3361.