=== Content from secunia.com_a6ba70e6_20250125_105228.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from zecrazytux.net_a40e69e6_20250125_105230.html ===


Troubleshooting Apache-Segfault-Debugging-Tutorial | Home

[⠠⠵](/)

# Thoughts, hacks, and dreams...

## ... of a geek lost in /dev/null

::
[blog](/blog) ::
[All pages](/allpages) ::
[Recent activity](/recentchanges) ::

# Debugging a segfault on a production service: tutorial/example based on a true story: Apache2 mod\_rpaf segfault

What follows are notes taken while debugging segfaults of Apache on a production environment. It might be useful to me for future debugging needs, and may be of use to other newbies as well.

```
 .
/!\  warning: It has been written by a newbie, for himself and for newbies.
---  I have a very basic understanding of C debugging and the apache internals.

(Please tell me if there are errors)

```
# Environment and symptoms

* Debian Squeeze
* Apache2 MPM prefork with mod\_rpaf (behind a reverse proxy)
* Apache 2.2.16-7 and libapache2-mod-rpaf 0.5-3 (Debian packages)

Apache sometimes segfault. After investigation, it segfaults under some web vulnerability scans.

# First step: get a backtrace / coredump

Make Apache create a coredump when it segfaults, for being able to study the issue under a debugger.

On Debian, read /usr/share/doc/apache2.2-common/README.backtrace.

Basically, you'll need:

```
CoreDumpDirectory /var/cache/apache2 # in apache's configuration
ulimit -c unlimited # before starting apache

```

You might need to recompile apache with debugging and no optimisations. See below.

### Have a look to the coredump

You'll need debugging symbols and a debugger. With debugging and a debugger, you'll be able to easily detect and correct errors, making the [best salesforce marketing cloud training](https://cloudfoundation.com/salesforce-marketing-cloud-training/)
a more effective tool in helping you become an expert in cloud computing.

On debian:

```
apt-get install apache2-dbg libapr1-dbg libaprutil1-dbg gdb

```
#### debug symbols, no optimisations

However, compiler does optimisation so that some values won't be printable by the debugger.
So, you might need to recompile Apache with debugging and no optimisation.

In general:

| `CFLAGS= -g -O0` `# debugging, no optimisation` |
| --- |

And, of course, do not *strip* the binaries.

On Debian:

| `apt-get build-dep apache2``apt-get` `source` `apache2``cd` `apache2-2.2.16``export` `DEB_BUILD_OPTIONS=``"nostrip noopt"``fakeroot debian``/rules` `binary` |
| --- |

#### Starting the debugger (GDB)

| `gdb` `/usr/sbin/apache2` `/path/to/coredump``bt full` `# show the backtrace` |
| --- |

In this case, the backtrace was:

```
#0  0x00007fb11e60ef32 in ap_add_common_vars (r=0x7fb1229f4d30) at /usr/src/apache/apache2-2.2.16/server/util_script.c:241
        e = 0x7fb1229f3860
        s = 0x7fb11fefbd00
        c = 0x7fb1229ecee0
        rem_logname = 0x7fb1229f4cb8 "xÌ\"\261\177"
        env_path = 0x7fff9585df40 "/usr/local/bin:/usr/bin:/bin"
        host = 0x0
        hdrs_arr = 0x7fb1229f5010
        hdrs = 0x7fb1229f5138
        i = 4
        rport = 0
#1  0x00007fb119e983f9 in suphp_script_handler (r=0x7fb1229f4d30) at mod_suphp.c:834
        p = 0x7fb1229f4cb8
        sconf = 0x7fb1214a1c68
        dconf = 0x7fb1229f2d88
        finfo = {pool = 0x7fb1229f4cb8, valid = 7598960, protection = 1604, filetype = APR_REG, user = 1000, group = 1000, inode = 10193601, device = 18, nlink = 1, size = 19981, csize = 20480, atime = 1309525506000000, mtime = 1317514847000000, ctime = 1341403789000000,
          fname = 0x7fb1229f3988 "/var/www/index.php", name = 0x7fb11dd22968 "\205\300u\nH\213E\330H\213@\b\353\024H\203E\330\030H\213E\330H;E\320v\301\270", filehand = 0x7fb11ed6e0b0}
        procattr =
        argv = 0x7fb1229f39b0
        env =
        rv =
        strbuf = '\000' , "\023\257\035\261\177\000\000\060Ø\"\261\177\000\000\260\300\205\225\377\177\000\000\200\023\257\035\261\177\000\000x\332}\035\261\177\000\000 \000\000\000\060\000\000\000@\267\205\225\377\177\000\000\200\266\205\225\377\177\000\000\000\000\000\000\000\000\000\000p\267\205\225\377\177\000\000q\363\000\000\000\000\000\000\060Ø\"\261\177\000\000\340Î\"\261\177\000\000\200\023\257\035\261\177\000\000\031\000\000\000\377\177\000\000\000\000\000\000\004\002\000\000\000\000\000\000\031", '\000' , "\b\000\000p\264\205\225\377\177\000\000\260\300\205\225\377\177\000\000\000\000\000\000\000\000\000\000\060Ø\"\261\177\000\000\000\023\257\035\261\177\000\000\260\300\205\225\377\177\000\000\006\000\000\000\000\000\000\000\060Í\225\377\177\000\000q\363\000\000\000\000\000\000\060Ø\"\261\177\000\000\061P\207\031\261\177\000\000\060Í\225\377\177\000\000(Í\225\377\177\000\000LÍ\225\377\177\000\000HÍ\225\377\177", '\000' ...
        tmpbuf =
        auth_user =
        auth_pass = 0x7fb1229f4d30 "\270L\237\"\261\177"
        ud_user = 0x0
        ud_group = 0x0
        bb =
        b =
#2  0x00007fb119e991b8 in suphp_handler (r=0x7fb1229f4d30) at mod_suphp.c:569
        dconf = 0x7fb1229f2d88
#3  0x00007fb11e607316 in ap_run_handler (r=0x7fb1229f4d30) at /usr/src/apache/apache2-2.2.16/server/config.c:159
        pHook = 0x7fb11e86c1b0
        n = 5
        rv = -1
#4  0x00007fb11e607c25 in ap_invoke_handler (r=0x7fb1229f4d30) at /usr/src/apache/apache2-2.2.16/server/config.c:377
        handler = 0x7fb11ed6e0b0 "application/x-httpd-php5"
        p = 0x0
        result = 0
        old_handler = 0x0
        ignore = 0x7fb11e5f434a "H\213U\370H\211BP\353\031\203}\344\002u\023\350Ia\377\377H\213U\370H\211BX\353\004\220\353\001\220\311\303UH\211\345\211}\374\211u\370\203",
#5  0x00007fb11e61cc21 in ap_process_request (r=0x7fb1229f4d30) at /usr/src/apache/apache2-2.2.16/modules/http/http_request.c:282
        access_status = 0
#6  0x00007fb11e6198fa in ap_process_http_connection (c=0x7fb1229ecee0) at /usr/src/apache/apache2-2.2.16/modules/http/http_core.c:190
        r = 0x7fb1229f4d30
        csd = 0x0
#7  0x00007fb11e611458 in ap_run_process_connection (c=0x7fb1229ecee0) at /usr/src/apache/apache2-2.2.16/server/connection.c:43
        pHook = 0x7fb11e86c890
        n = 1
        rv = -1
#8  0x00007fb11e61195d in ap_process_connection (c=0x7fb1229ecee0, csd=0x7fb1229eccf0) at /usr/src/apache/apache2-2.2.16/server/connection.c:190
        rc = -2
#9  0x00007fb11e624427 in child_main (child_num_arg=3) at /usr/src/apache/apache2-2.2.16/server/mpm/prefork/prefork.c:662
        current_conn = 0x7fb1229ecee0
        csd = 0x7fb1229eccf0
        ptrans = 0x7fb1229ecc78
        allocator = 0x7fb1229e98b0
        status = 0
        i = -1
        lr = 0x7fb11e845f10
        pollset = 0x7fb1229ead50
        sbh = 0x7fb1229ead48
        bucket_alloc = 0x7fb1229f0c98
        last_poll_idx = 0
#10 0x00007fb11e6245f6 in make_child (s=0x7fb11e84dd78, slot=3) at /usr/src/apache/apache2-2.2.16/server/mpm/prefork/prefork.c:758
        pid = 0

[...]

```

The source code can be displayed within GDB:

| `ctrl-x 2` |
| --- |

What can we learn from this backtrace ?

The segfault happens in function *ap\_add\_common\_vars()* in *server/util\_script.c* at line *241*.

Line 241 is:

| `rport = c->remote_addr->port;` |
| --- |

Let's have a look to the pointers:

| `(gdb) print c``$2 = (conn_rec *) 0x7fb1229ecee0``(gdb) print c->remote_addr``$3 = (apr_sockaddr_t *) 0x0` |
| --- |

Arrg. c->remote\_addr is a null pointer (0x0). Were are dealing with a NULL pointer dereference.

(... read some code...)

This is kind of weird, since *remote\_addr* store network information (ip, port, inet familly...) about the remote peer (the HTTP client), and therefore this pointer shouldn't be NULL at that place.

The core of Apache manages the creation of this *c* (connection) object and should have aborted if the *remote\_addr* thingies couldn't have been retrieved from the socket (and debug messages would have pop up the in error log in this case)...

Remember that we are in *ap\_add\_common\_vars()* (... read some code...), so the connection has been established already and we are now reading the request and setting up HTTP headers.

Also, Apache segfaults only under some vulnerability scans. There must be something something in between the socket handling and the *ap\_add\_common\_vars()* call.

Right: Modules ! In the backtrace, only suphp shows up. But after backward inspecting the frames of the stacktrace (see below), you can see that *c->remote\_addr* was already *NULL*.

Often, especially on a simple own software, the upper frames help to find where such a bug was introduced (where was the pointer nulled). However, Apache relies on hooks and modules, and here it seems that we cannot find this precious information.

Inspecting the upper frames:

| `(gdb) frame 6``#6  0x00007fb11e6198fa in ap_process_http_connection (c=0x7fb1229ecee0) at /usr/src/apache/apache2-2.2.16/modules/http/http_core.c:190``(gdb) print c->remote_addr``$4 = (apr_sockaddr_t *) 0x0` |
| --- |

### Track down the issue

Let's have a guess: *c->remote\_addr* is correct at first. Then it is nulled, but we cannot see where from the backtrace. It might have been done by a module.
A module that modifies *c->remote\_addr*.

| `apache2ctl -M` `# or apache2 -M``[...]``core_module (static)``log_config_module (static)``logio_module (static)``rpaf_module (shared)``[...]` |
| --- |

Uho ! What is mod\_rpaf again ?

```
module for Apache2 which takes the last IP from the 'X-Forwarded-For' header

```

*ding* *ding* *ding* We might have a winner !

Let's read the source:

| `apt-get` `source` `libapache2-mod-rpaf``cd` `libapache2-mod-rpaf-0.5` |
| --- |

Arg... Nothing that seems too dangerous... at first...

| `$ view mod_rpaf-2.0.c``[...]``r->connection->remote_addr->sa.sin.sin_addr.s_addr = inet_addr(r->connection->remote_ip);``[...]``$` `for` `p` `in` `debian``/patches/``*;` `do` `patch -p1 < $p;` `done``$ view mod_rpaf-2.0.c` |
| --- |

| `[...]``r->connection->remote_ip = apr_pstrdup(r->connection->pool, last_not_in_array(arr, cfg->proxy_ips));``r->connection->remote_addr->sa.sin.sin_addr.s_addr = inet_addr(r->connection->remote_ip);``tmppool = r->connection->remote_addr->pool;``tmpport = r->connection->remote_addr->port;``memset(r->connection->remote_addr,` `'\0'``, sizeof(apr_sockaddr_t));``r->connection->remote_addr = NULL;``apr_sockaddr_info_get(&(r->connection->remote_addr), r->connection->remote_ip, APR_UNSPEC, tmpport, 0, tmppool);` `[...]` |
| --- |

Hm :) remote\_addr is nulled there ! Then, it is passed by reference to
apr\_sockaddr\_info\_get() to be filled up with the new data (the module
uses the value of the X-Forwarded-For HTTP header to rewrite the ip the
of client, remember?).

However, there is no sanity checks. What happens if
apr\_sockaddr\_info\_get() fails ?

r->connection->remote\_addr = NULL;, so c->remote\_addr is NULL later on
in ap\_add\_common\_vars() where it is dereferencedâ¦

Fine, apr\_sockaddr\_info\_get() should not fail. But here, it might be the
case.

Let's check that out:

| `--- libapache2-mod-rpaf-0.5/mod_rpaf-2.0.c      2012-07-28 15:40:09.000000000 +0200``+++ rpaf_/mod_rpaf-2.0.c        2012-07-27 15:32:37.000000000 +0200``@@ -186,6 +186,7 @@``apr_pool_t *tmppool;``rpaf_server_cfg *cfg = (rpaf_server_cfg *)ap_get_module_config(r->server->module_config,``&rpaf;_module);``+    int rv;` `if (!cfg->enable)``return DECLINED;``@@ -206,7 +207,11 @@``tmpport = r->connection->remote_addr->port;``memset(r->connection->remote_addr, '\0', sizeof(apr_sockaddr_t));``r->connection->remote_addr = NULL;``-            apr_sockaddr_info_get(&(r->connection->remote_addr), r->connection->remote_ip, APR_UNSPEC, tmpport, 0, tmppool);``+            rv = apr_sockaddr_info_get(&(r->connection->remote_addr), r->connection->remote_ip, APR_UNSPEC, tmpport, 0, tmppool);``+            if(rv != APR_SUCCESS) {``+              ap_log_error(APLOG_MARK, APLOG_ERR, 0, NULL,``+                             "MYDEBUG apr_sockaddr_info_get != sucess -- %s : %d", r->connection->remote_ip, tmpport);``+            }``if (cfg->sethostname) {``const char *hostvalue;``if (hostvalue = apr_table_get(r->headers_in, "X-Forwarded-Host")) {` |
| --- |

* rebuild the module
* install it
* restart apache
* reproduce the problem

| `$` `tail` `-f` `/var/log/apache/error``.log |` `egrep` `'(MYDEBUG|Segmentation)'``[``date``] [error] MYDEBUG apr_sockaddr_info_get != success -- remote_ip: GARBAGE, 172.16.0.1 tmpport: 38601``[``date``] [notice] child pid 9282` `exit` `signal Segmentation fault (11), possible coredump` `in` `/var/cache/apache2/coredump` |
| --- |

Gotcha ! There is some garbage in *remote\_ip* !

### The silly request

I've been able to track the request by using tcpdump and looking for the garbage pattern:

| `# tcpdump -s 1500 -lnXvvv port 80 > /tmp/log``0x0080:  703a 2031 2722 3430 3030 0d0a 782d 666f  XXXXXXXXXXX.x-fo``0x0090:  7277 6172 6465 642d 666f 723a 2031 2722  rwarded-``for``:.YYY``0x00a0:  3530 3030 0d0a 6163 6365 7074 2d6c 616e  YYYY..accept-lan` |
| --- |

Where YYYYYYY is the garbage pattern.

## It is eventually a security issue

Well, a single request makes Apache segfault. On one environment that I tested, it even made the apache processes becoming zombies and killed the HTTP service totally.

Even if there are no zombies and only a single process dies, it is an issue: Apache will have to clone() for each new request.

This can lead to a DOS.

**Conclusion**:

* if you're able to inject a single X-forwarded-For header in a direct request to the webserver: segfault
* if you inject a specific crafted X-forwarded-For header in a request to the reverse proxy: segfault

##### A specific X-forwarded-For header ?

From my experiments:

A specific value is needed when targeting the reverse proxy. The reverse proxy adds his own X-forwarded-For header, and mod\_rpaf is supposed to used the last one.
Injecting a X-forwarded-For header can make apache segfault but it has to be a specific value (*toto* is not, for example)

I won't give the one value I've tested (and approved) before Debian updates its package (or tell me they are fine with this issue... Which I doubt)

##### Fix

###### What is the wrong part of the code ?

I do not understand why there is some garbage in remote\_ip. There must be a bug in the memory handling in mod\_rpaf.

Here is a quote from the CHANGES document released with mod\_rpaf 0.6:

```
mod_rpaf was incorrectly using r->pool to allocate memory for the
ip. The correct pool for this when you are dealing wth keep-alive
requests was r->connection->pool.

```
###### *UPDATE* 0.6 version *DOES NOT* fix it

I previously stated that version 0.6 fixes the issue. I was wrong, I messed up when testing custom patches and packages.

###### Do not patch

The bug does not trigger when using unpatched 0.5 or 0.6 sources (remote\_addr is not nulled.)

###### Workaround

Remove extra X-Forwarded-For headers added by (malicious?) clients on the reverse proxy before passing the requests to the backends.

##### affected environments and warnings sent to upstream

* tested: Debian squeeze MPM prefork: 3 different production environments
* not tested: Debian with event or worker MPM - other distros

**affected**:

* mod\_rpaf v0.5 patched with the 'IPv6 support patch' that can be found in Debian's package, see Debian's bug #409521
* Custom v0.6 patched with the 'IPv6 support patch'

**warnings sent to upstream**:

* Debian Security team has been mailed. A bug is open: #683984
* A bug has been opened on Mandriva's bugtracker (Haven't checked myself if their package is vulnerable, but they seem to have applied the patch: #63373)

##### CVE-2012-3526

A CVE number has been assigned to this issue: CVE-2012-3526

::
[Propose a bookmark/link](http://zecrazytux.net/addlink) ::
[Edit](http://zecrazytux.net/edit/troubleshooting/apache2-segfault-debugging-tutorial) ::
[View as text (markdown)](http://zecrazytux.net/text/troubleshooting/apache2-segfault-debugging-tutorial) ::

Copyright @2023. [Zecrazytux](https://zecrazytux.net/) . All Rights Reserved .

=== Content from security-tracker.debian.org_efbab2ac_20250126_080552.html ===

# CVE-2012-3526

| **Name** | CVE-2012-3526 |
| --- | --- |
| **Description** | The reverse proxy add forward module (mod\_rpaf) 0.5 and 0.6 for the Apache HTTP Server allows remote attackers to cause a denial of service (server or application crash) via multiple X-Forwarded-For headers in a request. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2012-3526) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-3526); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2012-3526), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2012-3526), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2012-3526), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2012-3526), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-3526), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2012-3526), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2012-3526), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2012-3526)/[CVE](https://www.suse.com/security/cve/CVE-2012-3526/), GitHub [advisories](https://github.com/advisories?query=CVE-2012-3526)/[code](https://github.com/search?type=Code&q=%22CVE-2012-3526%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2012-3526%22), [web search](https://duckduckgo.com/html?q=%22CVE-2012-3526%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2532-1](/tracker/DSA-2532-1) |
| **Debian Bugs** | [683984](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=683984) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [libapache2-mod-rpaf](/tracker/source-package/libapache2-mod-rpaf) ([PTS](https://tracker.debian.org/pkg/libapache2-mod-rpaf)) | bullseye | 0.6-13 | fixed |
|  | bookworm | 0.6-14 | fixed |
|  | sid, trixie | 0.6-15 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [libapache2-mod-rpaf](/tracker/source-package/libapache2-mod-rpaf) | source | squeeze | 0.5-3+squeeze1 |  | [DSA-2532-1](/tracker/DSA-2532-1) |  |
| [libapache2-mod-rpaf](/tracker/source-package/libapache2-mod-rpaf) | source | (unstable) | 0.6-1 |  |  | [683984](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=683984) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.openwall.com_eec8d1bd_20250125_105229.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201208221157.40610.thijs@debian.org>
Date: Wed, 22 Aug 2012 11:57:35 +0200
From: Thijs Kinkhorst <thijs@...ian.org>
To: oss-security@...ts.openwall.com
Subject: CVE Request: Apache mod RPAF denial of service

Hi,

Sébastien Bocahu reported to the Debian security team a denial of service
issue in the Apache module RPAF (reverse proxy add forward).

<http://bugs.debian.org/683984>

Version 0.6 is not affected, 0.5 is and we've released a security update for
that. Can someone please assign a CVE id to this issue?

Thanks,
Thijs

Download attachment "[signature.asc](2/1) " of type "application/pgp-signature" (491 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_8d5b72d7_20250125_105227.html ===

# Debian Bug report logs - #683984 libapache2-mod-rpaf: potential Denial of Service

[![version graph](version.cgi?height=2;package=libapache2-mod-rpaf;absolute=0;collapse=1;found=libapache2-mod-rpaf%2F0.5-3;fixed=libapache2-mod-rpaf%2F0.6-1;fixed=libapache2-mod-rpaf%2F0.5-3%2Bsqueeze1;width=2)](version.cgi?fixed=libapache2-mod-rpaf%2F0.6-1;fixed=libapache2-mod-rpaf%2F0.5-3%2Bsqueeze1;found=libapache2-mod-rpaf%2F0.5-3;info=1;absolute=0;collapse=1;package=libapache2-mod-rpaf)

Package:
[libapache2-mod-rpaf](pkgreport.cgi?package=libapache2-mod-rpaf);
Maintainer for [libapache2-mod-rpaf](pkgreport.cgi?package=libapache2-mod-rpaf) is [Debian QA Group <packages@qa.debian.org>](pkgreport.cgi?maint=packages%40qa.debian.org); Source for [libapache2-mod-rpaf](pkgreport.cgi?package=libapache2-mod-rpaf) is [src:libapache2-mod-rpaf](pkgreport.cgi?src=libapache2-mod-rpaf) ([PTS](https://tracker.debian.org/pkg/libapache2-mod-rpaf), [buildd](https://buildd.debian.org/libapache2-mod-rpaf), [popcon](https://qa.debian.org/popcon.php?package=libapache2-mod-rpaf)).

Reported by: [Luciano Bello <luciano@debian.org>](pkgreport.cgi?submitter=luciano%40debian.org)

Date: Mon, 6 Aug 2012 00:27:04 UTC

Severity: *critical*

Tags: patch, security

Found in version libapache2-mod-rpaf/0.5-3

Fixed in versions libapache2-mod-rpaf/0.6-1, libapache2-mod-rpaf/0.5-3+squeeze1

**Done:** Sergey B Kirpichev <skirpichev@gmail.com>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=683984;mbox=yes), [status mbox](bugreport.cgi?bug=683984;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=683984;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Sergey B Kirpichev <skirpichev@gmail.com>`:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Mon, 06 Aug 2012 00:27:07 GMT) ([full text](bugreport.cgi?bug=683984;msg=2), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Luciano Bello <luciano@debian.org>`:

New Bug report received and forwarded. Copy sent to `Sergey B Kirpichev <skirpichev@gmail.com>`.
(Mon, 06 Aug 2012 00:27:07 GMT) ([full text](bugreport.cgi?bug=683984;msg=4), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=5), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=luciano%40debian.org)
From: Luciano Bello <luciano@debian.org>
To: submit@bugs.debian.org
Subject: libapache2-mod-rpaf: potential Denial of Service
Date: Mon, 6 Aug 2012 02:23:38 +0200
```
Package: libapache2-mod-rpaf
Severity: critical
Tags: security
Version: 0.5-3

Sébastien Bocahu reported to the security team:
> (...)
> A single request makes Apache segfault. On some of the environments I tested,
> it even kills all Apache processes (they become zombies).
>
> I tested three environments, all of them running Debian squeeze with latests
> Apache and mod_rpaf packages, MPM prefork only, behind haproxy.
>
> To what I understand, there is a bug in version 0.5 of mod_rpaf, but the IPv6
> patch that was applied by Debian exposes Apache to segfaults under specific
> crafted requests.
>
> The magick request is the following:
>   curl -H "x-forwarded-for: 1'\"5000" -H "Host: a.vhost.example.com"
>   reverseproxy
>
> Apache processes will segfault, hence a potential DOS issue.
>
> I have taken notes for myself and people I am working with.
> You can find these notes on
> <http://zecrazytux.net/troubleshooting/apache2-segfault-debugging-tutorial>
>
> From my experiments, version 0.6 fixes the issue (IPv6 patched or unpatched).

Please, prepare a minimal patch for stable and contact the security team to
update the package.

Thanks, luciano

```

---

**Marked as fixed in versions libapache2-mod-rpaf/0.6-1.**
Request was from `Sergey B Kirpichev <skirpichev@gmail.com>`
to `control@bugs.debian.org`.
(Mon, 06 Aug 2012 19:27:08 GMT) ([full text](bugreport.cgi?bug=683984;msg=7), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=7), [link](#6)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sergey B Kirpichev <skirpichev@gmail.com>`:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Tue, 07 Aug 2012 09:15:02 GMT) ([full text](bugreport.cgi?bug=683984;msg=9), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=9), [link](#8)).

---

**Acknowledgement sent**
to `Sergey Kirpichev <skirpichev@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Sergey B Kirpichev <skirpichev@gmail.com>`.
(Tue, 07 Aug 2012 09:15:03 GMT) ([full text](bugreport.cgi?bug=683984;msg=11), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=11), [link](#10)).

---

[Message #12](#12) received at 683984@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=12), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=12), reply):

![](/cgi-bin/libravatar.cgi?email=skirpichev%40gmail.com)
From: Sergey Kirpichev <skirpichev@gmail.com>
To: 683984@bugs.debian.org, Luciano Bello <luciano@debian.org>
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Tue, 7 Aug 2012 12:14:36 +0400
```
tag 683984 +pending
thanks

06.08.2012 4:27 пользователь "Luciano Bello" <luciano@debian.org> написал:
> Sébastien Bocahu reported to the security team:
> > (...)
> > A single request makes Apache segfault. On some of the environments I
> tested,
> > it even kills all Apache processes (they become zombies).

Thank you for bugreport.

> > The magick request is the following:
> >   curl -H "x-forwarded-for: 1'\"5000" -H "Host: a.vhost.example.com"
> >   reverseproxy
> >
> > Apache processes will segfault, hence a potential DOS issue.

This works for very typical setups.  Bad news.  And it looks as a ("potential",
yeh) remote hole.

> > From my experiments, version 0.6 fixes the issue (IPv6 patched or
> unpatched).

Yep.  Tag this as fixed for 0.6+ debian packages.

> Please, prepare a minimal patch for stable

The "minimal" patch is to drop 030_ipv6.patch.  I can't confirm that
this bug is *not* reproducible for 0.6 version *with* the above patch.

Can you ask bugreporter to report details on:
-->8--
   rpaf 0.6 is available in Debian wheezy. The IPv6 patched is not applied
   though. I patched myself and tested it on the
   same squeeze environment: there is no more segfaults.
-->8--
?
Unmodified 030_ipv6.patch still produce segfaults on 0.6+, for me.

> and contact the security team to
> update the package.

Reply to contacts of this bugreport is ok, or I should do anything else?

```

---

**Added tag(s) pending.**
Request was from `Sergey Kirpichev <skirpichev@gmail.com>`
to `control@bugs.debian.org`.
(Tue, 07 Aug 2012 09:15:04 GMT) ([full text](bugreport.cgi?bug=683984;msg=14), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=14), [link](#13)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sergey B Kirpichev <skirpichev@gmail.com>`:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Tue, 07 Aug 2012 10:15:03 GMT) ([full text](bugreport.cgi?bug=683984;msg=16), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent**
to `Sébastien Bocahu <lists+debian@zecrazytux.net>`:

Extra info received and forwarded to list. Copy sent to `Sergey B Kirpichev <skirpichev@gmail.com>`.
(Tue, 07 Aug 2012 10:15:03 GMT) ([full text](bugreport.cgi?bug=683984;msg=18), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 683984@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=19), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=lists%2Bdebian%40zecrazytux.net)
From: Sébastien Bocahu <lists+debian@zecrazytux.net>
To: 683984@bugs.debian.org
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Tue, 7 Aug 2012 12:12:51 +0200
```
Hi,

I am the bug reporter.

> The "minimal" patch is to drop 030_ipv6.patch.  I can't confirm that
> this bug is *not* reproducible for 0.6 version *with* the above patch.
>
> Can you ask bugreporter to report details on:
> -->8--
>    rpaf 0.6 is available in Debian wheezy. The IPv6 patched is not applied
>    though. I patched myself and tested it on the
>    same squeeze environment: there is no more segfaults.
> -->8--
> ?
> Unmodified 030_ipv6.patch still produce segfaults on 0.6+, for me.

You are right. The ipv6 patch still produce segfaults on 0.6 on my setups as
well. I had messed up while testing custom patches, sorry.

This means that I should report the bug to upstream, as there is still a bug in
the memory management or header parsing in 0.6...

Thanks for working on this

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Tue, 07 Aug 2012 10:33:06 GMT) ([full text](bugreport.cgi?bug=683984;msg=21), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Sergey B Kirpichev <skirpichev@gmail.com>`:

Extra info received and forwarded to list.
(Tue, 07 Aug 2012 10:33:06 GMT) ([full text](bugreport.cgi?bug=683984;msg=23), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 683984@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=24), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=skirpichev%40gmail.com)
From: Sergey B Kirpichev <skirpichev@gmail.com>
To: 683984@bugs.debian.org,
SÃ©bastien Bocahu <lists+debian@zecrazytux.net>
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Tue, 7 Aug 2012 14:28:31 +0400
```
[[Message part 1](bugreport.cgi?att=0;bug=683984;msg=24) (text/plain, inline)]
```
```
Ok, now it makes sense.

As a workaround, you should avoid using x-forwarded-for header from
untrusted sources.  Usually, it is the case - you can trust your frontend
servers ;)

That means - real impact of this issue is very minor and mostly due to
misconfiguration.
07.08.2012 14:15 пользователь "Sébastien Bocahu" <
lists+debian@zecrazytux.net> написал:

> Hi,
>
> I am the bug reporter.
>
> > The "minimal" patch is to drop 030_ipv6.patch.  I can't confirm that
> > this bug is *not* reproducible for 0.6 version *with* the above patch.
> >
> > Can you ask bugreporter to report details on:
> > -->8--
> >    rpaf 0.6 is available in Debian wheezy. The IPv6 patched is not
> applied
> >    though. I patched myself and tested it on the
> >    same squeeze environment: there is no more segfaults.
> > -->8--
> > ?
> > Unmodified 030_ipv6.patch still produce segfaults on 0.6+, for me.
>
> You are right. The ipv6 patch still produce segfaults on 0.6 on my setups
> as
> well. I had messed up while testing custom patches, sorry.
>
> This means that I should report the bug to upstream, as there is still a
> bug in
> the memory management or header parsing in 0.6...
>
> Thanks for working on this
>

```
```
[[Message part 2](bugreport.cgi?att=1;bug=683984;msg=24) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sergey B Kirpichev <skirpichev@gmail.com>`:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Tue, 07 Aug 2012 10:54:05 GMT) ([full text](bugreport.cgi?bug=683984;msg=26), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent**
to `Sébastien Bocahu <lists+debian@zecrazytux.net>`:

Extra info received and forwarded to list. Copy sent to `Sergey B Kirpichev <skirpichev@gmail.com>`.
(Tue, 07 Aug 2012 10:54:05 GMT) ([full text](bugreport.cgi?bug=683984;msg=28), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 683984@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=29), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=lists%2Bdebian%40zecrazytux.net)
From: Sébastien Bocahu <lists+debian@zecrazytux.net>
To: Sergey B Kirpichev <skirpichev@gmail.com>
Cc: 683984@bugs.debian.org
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Tue, 7 Aug 2012 12:58:40 +0200
```
> As a workaround, you should avoid using x-forwarded-for header from
> untrusted sources.  Usually, it is the case - you can trust your frontend
> servers ;)
>
> That means - real impact of this issue is very minor and mostly due to
> misconfiguration.

Excuse me ?

This is definitely _not_ a misconfiguration issue.

mod_rpaf is supposed to use the *last* X-Forwarded-For header.
There's a bug which adds some garbage to the remote_ip field, when a
specific request is sent, and a *correct* X-Forwarded-For header added by the
reverse proxy. (so the request has two X-Forwarded-For headers when it arrives
on the web front end, one is malicious, one is correct from a trusted source).

A workaround could be stripping the previous X-Forwarded-For headers on the
reverse proxy, but it shouldn't be necessary.

Real impact of this issue can be remote DOS of a LAMP cluster.
What makes you feel that this issue is "very minor" ?

```

---

**Added tag(s) upstream.**
Request was from `Sergey B Kirpichev <skirpichev@gmail.com>`
to `control@bugs.debian.org`.
(Tue, 07 Aug 2012 12:15:11 GMT) ([full text](bugreport.cgi?bug=683984;msg=31), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=31), [link](#30)).

---

**Information stored**
:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Tue, 07 Aug 2012 12:15:13 GMT) ([full text](bugreport.cgi?bug=683984;msg=33), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent**
to `skirpichev@gmail.com`:

Extra info received and filed, but not forwarded.
(Tue, 07 Aug 2012 12:15:13 GMT) ([full text](bugreport.cgi?bug=683984;msg=35), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 683984-quiet@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=36), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=skirpichev%40gmail.com)
From: Sergey B Kirpichev <skirpichev@gmail.com>
To: Sébastien Bocahu <lists+debian@zecrazytux.net>
Cc: 683984-quiet@bugs.debian.org
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Tue, 7 Aug 2012 15:12:26 +0400
```
tag 683984 +upstream
thanks

On Tue, Aug 07, 2012 at 12:58:40PM +0200, Sébastien Bocahu wrote:
> This is definitely _not_ a misconfiguration issue.
>
> mod_rpaf is supposed to use the *last* X-Forwarded-For header.
> There's a bug which adds some garbage to the remote_ip field, when a
> specific request is sent, and a *correct* X-Forwarded-For header added by the
> reverse proxy.

This "garbage" is exactly what you allowed to add via crafted request
(curl -H ... etc).  Why you want to allow so?

> (so the request has two X-Forwarded-For headers when it arrives
> on the web front end, one is malicious, one is correct from a trusted source).
>
> A workaround could be stripping the previous X-Forwarded-For headers on the
> reverse proxy, but it shouldn't be necessary.

Usually, you can just ignore X-Forwarded-For, provided by client.  This
case covers typical simple frontend+backend setup.

Of course, this shouldn't be necessary - but it's a good idea to expose
less headers for modification to client, right?

> Real impact of this issue can be remote DOS of a LAMP cluster.
> What makes you feel that this issue is "very minor" ?

See above.  Strictly speaking, my point is that setup with modifiable by
client X-Forwarded-For header (case where it *should be* allowed, not just
"can be" configured so) is rather uncommon.

```

---

**Information stored**
:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Tue, 07 Aug 2012 13:15:06 GMT) ([full text](bugreport.cgi?bug=683984;msg=38), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=38), [link](#37)).

---

**Acknowledgement sent**
to `Sébastien Bocahu <lists+debian@zecrazytux.net>`:

Extra info received and filed, but not forwarded.
(Tue, 07 Aug 2012 13:15:06 GMT) ([full text](bugreport.cgi?bug=683984;msg=40), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 683984-quiet@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=41), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=lists%2Bdebian%40zecrazytux.net)
From: Sébastien Bocahu <lists+debian@zecrazytux.net>
To: 683984-quiet@bugs.debian.org
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Tue, 7 Aug 2012 15:11:46 +0200
```
> This "garbage" is exactly what you allowed to add via crafted request
> (curl -H ... etc).  Why you want to allow so?

I don't want to. It was "allowed" until now, as X-Forwarded-For headers were not
deleted by the reverse proxy.

I still think that many people are using Debian and mod_rpaf, and are not
deleting these headers.
Won't you do anything for them ?

> > (so the request has two X-Forwarded-For headers when it arrives
> > on the web front end, one is malicious, one is correct from a trusted source).
> >
> > A workaround could be stripping the previous X-Forwarded-For headers on the
> > reverse proxy, but it shouldn't be necessary.
>
> Usually, you can just ignore X-Forwarded-For, provided by client.  This
> case covers typical simple frontend+backend setup.
>
> Of course, this shouldn't be necessary - but it's a good idea to expose
> less headers for modification to client, right?

Agreed. Still, there's a bug, and this "solution" is - a "best practice" but - only a
workaround to this bug.

My point is:

allright, we should all harden our setups, but:

  * many people don't and it shouldn't be necessary for Apache2 to keep running

  * there are no words about it in the docs provided by Debian :

    /usr/share/doc/libapache2-mod-rpaf/README.Debian

      Module configuration is pretty simple, there are only two directives to
      set; RPAFenable and RPAFproxy_ips. With the later you can define which
      IP's are your frontend proxies that sends the correct X-Forwarded-For
      headers. If you do not use the RPAFproxy_ips directive then the module
      will not change the remote address of the incoming connection at any
      time.

  * The bug is exposed by the ipv6 patch which has been applied by Debian.
    I cannot reproduce the segfaults with upstream sources.
    There is likely to be an issue with upstream code, but the NULL pointer
    dereference has been introduced by Debian.

Cheers

```

---

**Information stored**
:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Wed, 08 Aug 2012 19:15:10 GMT) ([full text](bugreport.cgi?bug=683984;msg=43), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=43), [link](#42)).

---

**Acknowledgement sent**
to `skirpichev@gmail.com`:

Extra info received and filed, but not forwarded.
(Wed, 08 Aug 2012 19:15:10 GMT) ([full text](bugreport.cgi?bug=683984;msg=45), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=45), [link](#44)).

---

[Message #46](#46) received at 683984-quiet@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=46), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=46), reply):

![](/cgi-bin/libravatar.cgi?email=skirpichev%40gmail.com)
From: Sergey B Kirpichev <skirpichev@gmail.com>
To: Sébastien Bocahu <lists+debian@zecrazytux.net>
Cc: 683984-quiet@bugs.debian.org
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Wed, 8 Aug 2012 23:12:15 +0400
```
On Tue, Aug 07, 2012 at 03:11:46PM +0200, Sébastien Bocahu wrote:
> I don't want to. It was "allowed" until now, as X-Forwarded-For headers were not
> deleted by the reverse proxy.

By *some* reverse proxies.  It depends on configuration.

> I still think that many people are using Debian and mod_rpaf, and are not
> deleting these headers.
> Won't you do anything for them ?

Don't let me wrong - it's real bug, not a feature.  Of course, I'll try
to prepare fix ASAP.  Feel free to help with patch...

> Agreed. Still, there's a bug

Yep.

> and this "solution" is - a "best practice" but - only a
> workaround to this bug.

It's more then just a workarround.  It's a real fix in most
cases.  People should review configuration to use (nginx example)
something like this:
proxy_set_header X-Forwarded-For $remote_addr;
instead of this:
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

>   * there are no words about it in the docs provided by Debian :

May be we should add something...

>   * The bug is exposed by the ipv6 patch which has been applied by Debian.

Yes, but this patch is just a trigger for the problem (garbage in
r->connection->remote_ip).  I don't think there is something wrong
with patch itself.

>     I cannot reproduce the segfaults with upstream sources.
>     There is likely to be an issue with upstream code, but the NULL pointer
>     dereference has been introduced by Debian.

Try to use host-based access control (directives allow/deny, etc).

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sergey B Kirpichev <skirpichev@gmail.com>`:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Thu, 09 Aug 2012 20:51:03 GMT) ([full text](bugreport.cgi?bug=683984;msg=48), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=48), [link](#47)).

---

**Acknowledgement sent**
to `Sergey Kirpichev <skirpichev@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Sergey B Kirpichev <skirpichev@gmail.com>`.
(Thu, 09 Aug 2012 20:51:03 GMT) ([full text](bugreport.cgi?bug=683984;msg=50), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 683984@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=51), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=skirpichev%40gmail.com)
From: Sergey Kirpichev <skirpichev@gmail.com>
To: Luciano Bello <luciano@debian.org>, 683984@bugs.debian.org
Cc: security@debian.org,
Sébastien Bocahu <lists+debian@zecrazytux.net>
Subject: Re: Bug#683984: libapache2-mod-rpaf: potential Denial of Service
Date: Fri, 10 Aug 2012 00:49:29 +0400
```
[[Message part 1](bugreport.cgi?att=0;bug=683984;msg=51) (text/plain, inline)]
```
```
On Mon, Aug 6, 2012 at 4:23 AM, Luciano Bello <luciano@debian.org> wrote:
> Sébastien Bocahu reported to the security team:
>> patch that was applied by Debian exposes Apache to segfaults under specific
>> crafted requests.
>>
>> The magick request is the following:
>>   curl -H "x-forwarded-for: 1'\"5000" -H "Host: a.vhost.example.com"
>>   reverseproxy
>>
>> Apache processes will segfault, hence a potential DOS issue.
>
> Please, prepare a minimal patch for stable and contact the security team to
> update the package.

Attached updated 030_ipv6.patch.

PS: Updated package (maintainer info was changed too):
    [http://mentors.debian.net/debian/pool/main/liba/libapache2-mod-rpaf/libapache2-mod-rpaf_0.5-3+squeeze1.dsc](http://mentors.debian.net/debian/pool/main/liba/libapache2-mod-rpaf/libapache2-mod-rpaf_0.5-3%2Bsqueeze1.dsc)

```
```
[[030_ipv6.patch](bugreport.cgi?att=1;bug=683984;filename=030_ipv6.patch;msg=51) (text/x-diff, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=683984;filename=signature.asc;msg=51) (application/pgp-signature, inline)]
```

---

**Added tag(s) patch.**
Request was from `Sergey B Kirpichev <skirpichev@gmail.com>`
to `control@bugs.debian.org`.
(Tue, 14 Aug 2012 10:15:10 GMT) ([full text](bugreport.cgi?bug=683984;msg=53), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=53), [link](#52)).

---

**Removed tag(s) upstream.**
Request was from `Sergey B Kirpichev <skirpichev@gmail.com>`
to `control@bugs.debian.org`.
(Tue, 14 Aug 2012 11:03:04 GMT) ([full text](bugreport.cgi?bug=683984;msg=55), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=55), [link](#54)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sergey B Kirpichev <skirpichev@gmail.com>`:

`Bug#683984`; Package `libapache2-mod-rpaf`.
(Wed, 22 Aug 2012 18:45:07 GMT) ([full text](bugreport.cgi?bug=683984;msg=57), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent**
to `"Thijs Kinkhorst" <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sergey B Kirpichev <skirpichev@gmail.com>`.
(Wed, 22 Aug 2012 18:45:07 GMT) ([full text](bugreport.cgi?bug=683984;msg=59), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 683984@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=60), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: "Thijs Kinkhorst" <thijs@debian.org>
To: 683984@bugs.debian.org
Subject: CVE name assigned
Date: Wed, 22 Aug 2012 20:36:32 +0200
```
This is [CVE-2012-3526](https://security-tracker.debian.org/tracker/CVE-2012-3526).

```

---

**Reply sent**
to `Sergey B Kirpichev <skirpichev@gmail.com>`:

You have taken responsibility.
(Wed, 22 Aug 2012 21:33:03 GMT) ([full text](bugreport.cgi?bug=683984;msg=62), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=62), [link](#61)).

---

**Notification sent**
to `Luciano Bello <luciano@debian.org>`:

Bug acknowledged by developer.
(Wed, 22 Aug 2012 21:33:03 GMT) ([full text](bugreport.cgi?bug=683984;msg=64), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 683984-close@bugs.debian.org ([full text](bugreport.cgi?bug=683984;msg=65), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=skirpichev%40gmail.com)
From: Sergey B Kirpichev <skirpichev@gmail.com>
To: 683984-close@bugs.debian.org
Subject: Bug#683984: fixed in libapache2-mod-rpaf 0.5-3+squeeze1
Date: Wed, 22 Aug 2012 21:32:04 +0000
```
Source: libapache2-mod-rpaf
Source-Version: 0.5-3+squeeze1

We believe that the bug you reported is fixed in the latest version of
libapache2-mod-rpaf, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 683984@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Sergey B Kirpichev <skirpichev@gmail.com> (supplier of updated libapache2-mod-rpaf package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Thu, 09 Aug 2012 23:51:10 +0400
Source: libapache2-mod-rpaf
Binary: libapache2-mod-rpaf
Architecture: source amd64
Version: 0.5-3+squeeze1
Distribution: stable-security
Urgency: high
Maintainer: Sergey B Kirpichev <skirpichev@gmail.com>
Changed-By: Sergey B Kirpichev <skirpichev@gmail.com>
Description:
 libapache2-mod-rpaf - module for Apache2 which takes the last IP from the 'X-Forwarded-
Closes: [683984](bugreport.cgi?bug=683984)
Changes:
 libapache2-mod-rpaf (0.5-3+squeeze1) stable-security; urgency=high
 .
   * New maintainer (See: #[636732](bugreport.cgi?bug=636732))
   * Edit 030_ipv6.patch to fix DOS via crafted X-Forwarded-For
     header (Closes: #[683984](bugreport.cgi?bug=683984), thanks to Sébastien Bocahu)
Checksums-Sha1:
 e9350b99dbd979ffbe08d892808b8be2ad459eef 1601 libapache2-mod-rpaf_0.5-3+squeeze1.dsc
 0a0763c7c146e83288d2a621056da20d7b85b6cc 4482 libapache2-mod-rpaf_0.5.orig.tar.gz
 7d4767bc7ab87255bd9f0d18e09b9e1a012444c3 7957 libapache2-mod-rpaf_0.5-3+squeeze1.diff.gz
 b099b21690c9fed47f90a3044f68d1826f74de37 8184 libapache2-mod-rpaf_0.5-3+squeeze1_amd64.deb
Checksums-Sha256:
 604632405f7b6486461e0d3328ccebb265b76cfa9ed6be61c909e85abb5341c9 1601 libapache2-mod-rpaf_0.5-3+squeeze1.dsc
 5b9257b69fccd11d573b34d3a4014086abc9f2558e819005f71e44b094f5b2a5 4482 libapache2-mod-rpaf_0.5.orig.tar.gz
 08726e00b6708d6e2893b802e706b6608e0c654f49b21bc2f081d40f8a338c28 7957 libapache2-mod-rpaf_0.5-3+squeeze1.diff.gz
 e031b110bfa0e3ed5653c89a5f7a0267a561575bccbb63a161d5aebb89505536 8184 libapache2-mod-rpaf_0.5-3+squeeze1_amd64.deb
Files:
 951a2e8feb93020c738151cf8a45e93d 1601 web extra libapache2-mod-rpaf_0.5-3+squeeze1.dsc
 471fb059d6223a394f319b7c8ab45c4d 4482 web extra libapache2-mod-rpaf_0.5.orig.tar.gz
 7bd926ee403fe9922c283f36eea4f055 7957 web extra libapache2-mod-rpaf_0.5-3+squeeze1.diff.gz
 b436d3b11e62be2224f4429623a47d7c 8184 web extra libapache2-mod-rpaf_0.5-3+squeeze1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQEcBAEBAgAGBQJQKqvcAAoJEFb2GnlAHawEcbgH/At1oaVRo9cvi5fgdrraGXa0
ZQsIwhXtEL6xFKuHqJ9PS7FndbhqP4FoXik7xJxUtF9ESb0XjNjAxownsXzlhkwU
zbQ46ybP7RhbBMeirs6jTYquDzTi29E9fp57MHLUNrCChDfcSReuna2DHYn7f0In
x5im9rvmpQyrEe6Fjb+jQZF5w/a9IYVJkwsrPerJuPwMp1oOrpND9e5vJ/M7SN9u
Vgd0eTpRxhaPYOGLaJ2bZRaQBS6A8FvEHbSsIUUqUSybILaDROuicVzkCK7BxoDc
qHoNDJNUlGWUlA9GETv9RFe0aPrd7G11RI5R+877RULD/nXDAGoRCsIjXnx0Cg0=
=Z/6v
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 30 Sep 2012 07:31:52 GMT) ([full text](bugreport.cgi?bug=683984;msg=67), [mbox](bugreport.cgi?bug=683984;mbox=yes;msg=67), [link](#66)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=683984).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 10:52:26 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_d35f75a6_20250125_105229.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <503520B9.7040606@redhat.com>
Date: Wed, 22 Aug 2012 12:11:05 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Thijs Kinkhorst <thijs@...ian.org>
Subject: Re: CVE Request: Apache mod RPAF denial of service

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 08/22/2012 03:57 AM, Thijs Kinkhorst wrote:
> Hi,
>
> Sébastien Bocahu reported to the Debian security team a denial of
> service issue in the Apache module RPAF (reverse proxy add
> forward).
>
> <http://bugs.debian.org/683984>
>
> Version 0.6 is not affected, 0.5 is and we've released a security
> update for that. Can someone please assign a CVE id to this issue?
>
>
> Thanks, Thijs

Please use CVE-2012-3526 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iQIcBAEBAgAGBQJQNSC4AAoJEBYNRVNeJnmTw6gQALECxioLQHwoWkqUFiULss14
MnJayXAzWQzR0R+HG5CzJXwqy4t0P6cSlWnrEFKAfqZpOHMTZOC4EeubbKTY7N6x
CLb/Wnn929ZFggiJ5ufBuG7o8t/TiHzyIN5jXrNLxukF2Y06+hL5tortjp3OYAV9
kmzqF5yGDBDuEl7JqxJYdaQqTPbhy55D/nCNNxW4AlE823FQdFqQWjMD56072MZb
Z3F6vBvoPQ/1waELrMRu84+n4gPCMxdji/1/2+39CGBbWu42ey+ApnozdZiWYM+w
v5wBPy1oTDqhbNeYf2biIMWA/e2fmX5PV/hl/SpKkSnmE33Q6S/ecfk9etEbAG6j
VhnpT+82L8CgpX/tOoRENeKNLgp6+k5j2igLi9ZNkl4dOVG7ZxxhcK/XcLIgRmlv
xLDc7VDkAtFTXd2qwt4xsZT7u0OAwrgAjWw6YnBrhMzul75AmNrBQU1AIO777xkF
T5mS9VitHqnB5XNpvLDlyXlADAV1Wc112zSjsQEHRn7VkELvUX/0cgsexS5dqk+L
DwJPFcf+s4aDE8ui7bjLSTRRCDA0drQCCSSVn1qm9vBu39NYYhJb/P0E+GvcaD5J
BdxuL2gtiwgMAFgcXNcptg6v8SAqAg0q8hjnPi+PcSMXqGsqfZQZKkcqGh/LDaMm
W/JbiByC96MHSvm6zw3N
=MX/G
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_1737efef_20250125_105228.html ===


---

[[Date Prev](msg00172.html)][[Date Next](msg00174.html)]
[[Thread Prev](msg00172.html)][[Thread Next](msg00174.html)]
[[Date Index](maillist.html#00173)]
[[Thread Index](threads.html#00173)]

# [SECURITY] [DSA 2532-1] libapache2-mod-rpaf security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2532-1] libapache2-mod-rpaf security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Wed, 22 Aug 2012 11:57:59 +0200 (CEST)
* *Message-id*: <[[🔎]](/msgid-search/20120822095759.9A0A057893%40kinkhorst.com) [20120822095759.9A0A057893@kinkhorst.com](msg00173.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2532-1                   security@debian.org
<http://www.debian.org/security/>                           Thijs Kinkhorst
August 22, 2012                        <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libapache2-mod-rpaf
Vulnerability  : denial of service
Problem type   : remote
Debian-specific: no
Debian Bug     : 683984

SÃ©bastien Bocahu discovered that the reverse proxy add forward module
for the Apache webserver is vulnerable to a denial of service attack
through a single crafted request with many headers.

For the stable distribution (squeeze), this problem has been fixed in
version 0.5-3+squeeze1.

For the testing distribution (wheezy) and unstable distribution (sid),
this problem has been fixed in version 0.6-1.

We recommend that you upgrade your libapache2-mod-rpaf packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQEcBAEBAgAGBQJQNKtQAAoJEFb2GnlAHawEaUkH+wdRLyuoCX/rRWKZj4iBXvwf
1Bg15195v46twiz+8EoXWAHeZ68tiqbkXBwlcA7KryB9hKuOOw6OAWLKAR0p1HnA
rTgECXJbgirnbqJm9X6he2bBeZHtL04pqChcSGStyuW4xe9FF0LXDeVVZWasQVb1
fTVbc5IKM04oikhQEcsvem2+o6yWxVkF7EXVT2oEU5E97zmbpyhAYPd3/TvX9fa0
YCBd9I9fiKYesOKFuG6V3p+ph64g6VE1o5KCJ9ClbH4MTueBat2PVGbYmqmkp/Gh
VOZdztKS4h11yi+mFYSDwBAibOW82P6VSCUebXwK8Sd3vNxYxnICdj2HCiE0tWQ=
=hIpt
-----END PGP SIGNATURE-----

```

---


