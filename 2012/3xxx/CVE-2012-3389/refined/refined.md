Based on the provided content, here's an analysis of CVE-2012-3389:

**Root cause of vulnerability:**
- The LTI (External tool) module in Moodle was not properly sanitizing or cleaning parameters used in `mod/lti/typessettings.php`, specifically the `lti_typename` and `lti_toolurl` POST parameters.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS) vulnerability.

**Impact of exploitation:**
- An attacker could inject malicious scripts into the affected parameters, leading to the execution of arbitrary JavaScript code within the context of a user's browser when they interact with the LTI tool settings page. This can result in:
    - Stealing user session cookies.
    - Redirecting users to malicious websites.
    - Defacing the web page.
    - Other malicious actions within the application.

**Attack vectors:**
- The attack vector is through the HTTP POST request to `/mod/lti/typessettings.php`.
- The attacker would need to inject malicious JavaScript code into the `lti_typename` or `lti_toolurl` parameters.

**Required attacker capabilities/position:**
- The attacker must be able to create or modify LTI tool settings, which typically requires administrative or instructor privileges within Moodle.
- The attacker does not need direct access to the server, as the vulnerability is client-side (XSS).

**Additional Information:**
- The vulnerability was reported by Dan Poltawski.
- The Moodle issue tracker number for this vulnerability is MDL-31692.
- The vulnerability affects Moodle versions 2.3, and 2.2 to 2.2.3+.
- The fix for this vulnerability is available at the following git commit: `<http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-31692>`
- The severity of this issue was classified as "Serious" by Moodle.