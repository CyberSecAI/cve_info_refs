=== Content from github.com_9919d4a1_20250126_054719.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-m454-cm7h-rqhh)

**CVE-2012-3360**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-m454-cm7h-rqhh)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2012-3360](/advisories/GHSA-m454-cm7h-rqhh)

## OpenStack Nova Directory traversal vulnerability

Moderate severity

GitHub Reviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Nov 22, 2024

[Vulnerability details](/advisories/GHSA-m454-cm7h-rqhh)
[Dependabot alerts
0](/advisories/GHSA-m454-cm7h-rqhh/dependabot)

## Package

pip

nova
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 12.0.0a0

## Patched versions

12.0.0a0

## Description

Directory traversal vulnerability in `virt/disk/api.py` in OpenStack Compute (Nova) Folsom (2012.2) and Essex (2012.1), when used over libvirt-based hypervisors, allows remote authenticated users to write arbitrary files to the disk image via a .. (dot dot) in the path attribute of a file element.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2012-3360>
* [openstack/nova@2427d4a](https://github.com/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7)
* [openstack/nova@b0feaff](https://github.com/openstack/nova/commit/b0feaffdb2b1c51182b8dce41b367f3449af5dd9)
* [https://bugs.launchpad.net/nova/+bug/1015531](https://bugs.launchpad.net/nova/%2Bbug/1015531)
* <https://lists.launchpad.net/openstack/msg14089.html>
* <http://www.ubuntu.com/usn/USN-1497-1>
* <https://github.com/pypa/advisory-database/tree/main/vulns/nova/PYSEC-2012-38.yaml>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2012-3360)
Jul 22, 2012

Published to the GitHub Advisory Database
May 17, 2022

Reviewed
May 14, 2024

Last updated
Nov 22, 2024

### Severity

Moderate

### EPSS score

0.419%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (74th percentile)

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### CVE ID

CVE-2012-3360

### GHSA ID

GHSA-m454-cm7h-rqhh

### Source code

[openstack/nova](https://github.com/openstack/nova)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-m454-cm7h-rqhh/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from secunia.com_3dff2c12_20250125_034807.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from launchpad.net_8e309b4f_20250126_054715.html ===

[Log in / Register](https://launchpad.net/~openstack/%2Blogin)

[![](https://launchpadlibrarian.net/52313053/os64.png)](https://launchpad.net/~openstack)

## [“OpenStack Team” team](https://launchpad.net/~openstack)

* Overview
* [Code](https://code.launchpad.net/~openstack)
* [Bugs](https://bugs.launchpad.net/~openstack)
* [Blueprints](https://blueprints.launchpad.net/~openstack)
* [Translations](https://translations.launchpad.net/~openstack)
* [Answers](https://answers.launchpad.net/~openstack)

------------------------------------------------

OLD TEAM - NOT USED ANYMORE

------------------------------------------------

INTERESTED IN OPENSTACK PLEASE GO TO <http://openstack.org/start>

MAILING LIST: <http://lists.openstack.org/cgi-bin/mailman/listinfo/openstack>

- searchable archives for the mailing list are on <http://openstack.markmail.org/>

* [Related packages](https://launchpad.net/~openstack/%2Brelated-packages)
* [Related projects](https://launchpad.net/~openstack/%2Brelated-projects)

## Team details

Email:
[Log in](%2Blogin) for email information.

Owner:
[OpenStack Administrators](/~openstack-admins)

Created on:
2010-07-22

Languages:
English

Membership policy:
Delegated Team

## [All members](https://launchpad.net/~openstack/%2Bmembers)

**7582**
[active
members](/~openstack/%2Bmembers#active),
**1**
[invited
member](/~openstack/%2Bmembers#invited),
**344**
[proposed
members](/~openstack/%2Bmembers#proposed)

You must [log in](%2Blogin)
to join or leave this team.

* [Show member photos](https://launchpad.net/~openstack/%2Bmugshots)

| Latest members  * [Augustina Ragwitz](/~auggy) * [chengsheng](/~chengsheng) * [Liang Wang](/~hiliang) * [GM](/~mazmanoglu) * [Ta Ba Tuan](/~tuantaba) | Pending approval  * [Johnfrandes s](/~johnfrandes12) * [Shanjiayi](/~odeshen520) * [HelaBasa Group (shared)](/~nawala) * [Yukti Sharma](/~s-yukti) * [Mark Rosenbaum](/~markrosenbaum) |
| --- | --- |

### Latest invited

* [healthnmon-core](/~healthnmon-core)

* [View snap packages](https://launchpad.net/~openstack/%2Bsnaps)

## Mailing list

![mail](/@@/mail)
openstack@lists.launchpad.net

**Policy:**
You must be a team member to subscribe to the team mailing list.

![email](/@@/mail)
[View public archive](https://lists.launchpad.net/openstack)

![team](/@@/team) [View subscribers](/~openstack/%2Bmailing-list-subscribers)

## [Show related projects](%2Bprojects) Related projects

Public team

* [Join the team](https://launchpad.net/~openstack/%2Bjoin)
* [Add one of my teams](https://launchpad.net/~openstack/%2Badd-my-teams)

## Polls

No current polls.

[Show polls](https://launchpad.net/~openstack/%2Bpolls)

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_0e738329_20250126_054719.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cm54-3vvf-f5p8)

**CVE-2012-3361**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cm54-3vvf-f5p8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2012-3361](/advisories/GHSA-cm54-3vvf-f5p8)

## OpenStack Nova Arbitrary file injection/corruption through directory traversal issues

Moderate severity

GitHub Reviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Nov 22, 2024

[Vulnerability details](/advisories/GHSA-cm54-3vvf-f5p8)
[Dependabot alerts
0](/advisories/GHSA-cm54-3vvf-f5p8/dependabot)

## Package

pip

nova
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 12.0.0a0

## Patched versions

12.0.0a0

## Description

`virt/disk/api.py` in OpenStack Compute (Nova) Folsom (2012.2), Essex (2012.1), and Diablo (2011.3) allows remote authenticated users to overwrite arbitrary files via a symlink attack on a file in an image.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2012-3361>
* [openstack/nova@2427d4a](https://github.com/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7)
* [openstack/nova@b0feaff](https://github.com/openstack/nova/commit/b0feaffdb2b1c51182b8dce41b367f3449af5dd9)
* [https://bugs.launchpad.net/nova/+bug/1015531](https://bugs.launchpad.net/nova/%2Bbug/1015531)
* <https://lists.launchpad.net/openstack/msg14089.html>
* <http://www.ubuntu.com/usn/USN-1497-1>
* <https://review.openstack.org/#/c/9268>
* <https://github.com/pypa/advisory-database/tree/main/vulns/nova/PYSEC-2012-39.yaml>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2012-3361)
Jul 22, 2012

Published to the GitHub Advisory Database
May 17, 2022

Reviewed
May 14, 2024

Last updated
Nov 22, 2024

### Severity

Moderate

### EPSS score

0.25%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (64th percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2012-3361

### GHSA ID

GHSA-cm54-3vvf-f5p8

### Source code

[openstack/nova](https://github.com/openstack/nova)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-cm54-3vvf-f5p8/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from launchpad.net_1d0b4763_20250126_054709.html ===

[Log in / Register](https://launchpad.net/~ttx/%2Blogin)

[![](https://launchpadlibrarian.net/116816327/ttx64.jpg)](https://launchpad.net/~ttx)

## [Thierry Carrez](https://launchpad.net/~ttx)

* Overview
* [Code](https://code.launchpad.net/~ttx)
* [Bugs](https://bugs.launchpad.net/~ttx)
* [Blueprints](https://blueprints.launchpad.net/~ttx)
* [Translations](https://translations.launchpad.net/~ttx)
* [Answers](https://answers.launchpad.net/~ttx)

Chair of the Technical Committee and Release Manager for OpenStack.

Python Software Foundation member.

Ubuntu core developer.

* [Related packages](https://launchpad.net/~ttx/%2Brelated-packages)
* [Related projects](https://launchpad.net/~ttx/%2Brelated-projects)

## User information

Launchpad Id:
ttx

Email:
[Log in](%2Blogin) for email information.

Member since:
2008-05-12

[![Icon of Cassandra Ubuntu Packaging](https://launchpadlibrarian.net/59580596/cassandra-ubuntu-icon.png "Member of Cassandra Ubuntu Packaging")](/~cassandra-ubuntu)
[![Icon of (deprecated) OpenStack PPA maintainers](https://launchpadlibrarian.net/87891894/ppa.gif "Member of (deprecated) OpenStack PPA maintainers")](/~openstack-ppa)
[![Icon of Designate Drivers](https://launchpadlibrarian.net/360468067/designate_14.jpg "Member of Designate Drivers")](/~designate-drivers)
[![Icon of Launchpad Beta Testers](https://launchpadlibrarian.net/600856498/Canonical_Launchpad_icon_14px.png "Member of Launchpad Beta Testers")](/~launchpad-beta-testers)
[![Icon of Martin Pitt's fan](https://launchpadlibrarian.net/16410730/immaginexz0.png "Member of Martin Pitt's fan")](/~we-love-pitti)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack release team](https://launchpadlibrarian.net/73211233/openstack-release.png "Member of OpenStack release team")](/~openstack-release)
[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of Python OpenStack Client Drivers](https://launchpadlibrarian.net/697274978/osc-icon.png "Member of Python OpenStack Client Drivers")](/~python-openstackclient-drivers)
[![Icon of Python OpenStack Client](https://launchpadlibrarian.net/697274843/osc-icon.png "Member of Python OpenStack Client")](/~python-openstackclient)
[![Icon of Soren's Target Audience](https://launchpadlibrarian.net/20548684/golf.png "Member of Soren's Target Audience")](/~sorens-target-audience)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Server papercutters](https://launchpadlibrarian.net/38078797/14.png "Member of Ubuntu Server papercutters")](/~server-papercutters)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, French

OpenPGP keys:

22A7943050DB1E67EC2B641A507AF89025B10423

SSH keys:

[ttx@stardust](%2Bsshkeys)

[ttx@mercury](%2Bsshkeys)

Time zone:

Europe/Paris
(UTC+0100)

Karma:
[0](https://launchpad.net/~ttx/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**ttx**
 on
**FreeNode**

## [All bugs in progress](https://launchpad.net/~ttx/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1473369 [new mock release broke a bunch of unit tests](https://bugs.launchpad.net/python-muranoclient/kilo/%2Bbug/1473369) |  |
| --- | --- | --- |
| in [python-muranoclient](/python-muranoclient), [Glance](/glance), [glance\_store](/glance-store), [Murano](/murano), [neutron](/neutron), [OpenStack Object Storage (swift)](/swift) | | |

| --- | --- | --- | --- | --- | --- |

## Personal package archives

| [Test Openstack 2011.3](/~ttx/%2Barchive/ubuntu/2011.3) |
| --- |
| [Extra packages](/~ttx/%2Barchive/ubuntu/extras) |
| [Bexar update candidates](/~ttx/%2Barchive/ubuntu/nova-bexar-updates) |
| [Junk PPA](/~ttx/%2Barchive/ubuntu/ppa) |
| [Terracotta stack](/~ttx/%2Barchive/ubuntu/terracotta) |

## [All memberships](https://launchpad.net/~ttx/%2Bparticipation) Latest memberships

| [kata-containers](/~kata-containers)  Joined on 2018-10-09 | |
| --- | --- |
| [OpenStack Folsom Stable Maintainers](/~openstack-folsom-maint)  Joined on 2013-04-11 | |
| [OpenStack Python3 Migration Team](/~openstack-py3-team)  Joined on 2013-03-20 | |
| [OpenStack Security SIG](/~openstack-ossg)  Joined on 2012-05-25 | |
| [Swift Drivers](/~swift-drivers)  Joined on 2012-04-06 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from lists.launchpad.net_9d64a8be_20250125_034812.html ===

[←
Back to team overview](https://launchpad.net/~openstack)
# openstack team mailing list archive

* [Thread](maillist.html)
* [Date](date.html)

1. ![](https://launchpad.net/@@/team)
   [openstack team](https://launchpad.net/~openstack)
2. [Mailing list archive](maillist.html)
3. Message #14089

## [OSSA 2012-008] Arbitrary file injection/corruption through directory traversal issues (CVE-2012-3360, CVE-2012-3361)

|  | [Thread Previous](msg14074.html) • [Date Previous](msg14088.html) • [Date Next](msg14090.html) • [Thread Next](msg14091.html) |
| --- | --- |

* ****To****:
  "openstack@xxxxxxxxxxxxxxxxxxx" <openstack@xxxxxxxxxxxxxxxxxxx>, oss-security@xxxxxxxxxxxxxxxxxx
* ****From****:
  Thierry Carrez <thierry@xxxxxxxxxxxxx>
* ****Date****:
  Tue, 03 Jul 2012 18:05:39 +0200
* ****Organization****:
  OpenStack
* ****User-agent****:
  Mozilla/5.0 (X11; Linux x86\_64; rv:13.0) Gecko/20120615 Thunderbird/13.0.1

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

OpenStack Security Advisory: 2012-008
CVE: 2012-3360, 2012-3361
Date: July 3, 2012
Title: Arbitrary file injection/corruption through directory traversal
issues
Impact: Critical
Reporter: Matthias Weckbecker (SUSE Security team), Pádraig Brady (Red
Hat)
Products: Nova
Affects: All versions

Description:
Matthias Weckbecker from SUSE Security team reported a vulnerability
in Nova compute nodes handling of file injection in disk images. By
requesting files to be injected in malicious paths, a remote
authenticated user could inject files in arbitrary locations on the
host file system, potentially resulting in full compromise of the
compute node. Only Essex and later setups running the OpenStack API
over libvirt-based hypervisors are affected.

Upon further inspection of the code, Pádraig Brady from Red Hat found
an additional vulnerability. By crafting a malicious image and
requesting an instance based on it, a remote authenticated user may
corrupt arbitrary files on the host filesystem, potentially resulting
in a denial of service. This affects all setups.

Fixes:
Folsom:
<https://github.com/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7>
Essex:
<https://github.com/openstack/nova/commit/b0feaffdb2b1c51182b8dce41b367f3449af5dd9>
Diablo: see patch at <https://review.openstack.org/9268>

References:
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3360>
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3361>
[https://bugs.launchpad.net/nova/+bug/1015531](https://bugs.launchpad.net/nova/%2Bbug/1015531)

Notes:
This fix will be included in the folsom-2 development milestone
(published this week) and in future Essex and Diablo releases.

- --
Thierry Carrez (ttx)
OpenStack Vulnerability Management Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iQIcBAEBCAAGBQJP8xhQAAoJEFB6+JAlsQQjxrwP/0riLbaI8tCRfKeR6I2ATXIU
1QTOjn6TzQOhUNKwP63OzeUmu1xg7gI/XscWYLgxPYetsysao7YUgsy7PcVSznQh
Ii7LM7WnrxpanP3SOOM4qJQ4d3MZvP8qP0R9hQ1XAtdE9T4yB3aDvzf+XVXFFLad
nnF9meI5xPe+Ws70BH0rTo2XNcTTukpnNxOwYC4Sayx0cHvMCjLMr6RWOoPCftDd
WFDOeJNuSEh1NcDwt6qgPCQMLBS/+WavnQFf6EuBdjkASAtONDYblkxyYPRSsf8y
xYDVjrYUcJ5YeDwI2vbqKCP9EMuwb0JSfep767OIbupgIMm7rTjW+vEsns4e2d1m
2WovMHlV9ar7zpTIeqjAYE/BzUlRaOa7+JRJwy8F2awbu5oQUeOLq8XeAyo5Ag8C
zjYMut/OuHEdqMQY+eLqtPVcaNg801wXEfgdn8zuE41qXkk6yyAFJJUPlkBeMqiE
8cHEeJJwBDP5deHJIESzraeOUTFBXXoABhxdehAa708y4BWGt0/EG5SeHg38HoZs
gODHzZ5D+rgRYZsMV3JanAoB27QH4LQfPc1WLCM20wJSppZXq4KjngNA9trV68Na
+LKR+/EAZvOmpJMsymhuTgc9uRNRTlhC85NGquBzK2TZtlfJzI/qADV7fQPnWVQZ
JJcGXBOJw/J7rCmBIDuQ
=/7QJ
-----END PGP SIGNATURE-----

```

---

|  | [Thread Previous](msg14074.html) • [Date Previous](msg14088.html) • [Date Next](msg14090.html) • [Thread Next](msg14091.html) |
| --- | --- |

[![Launchpad](https://launchpad.net/@@/launchpad-logo-and-name-hierarchy.png)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)
 •
[Help for mailing lists](https://help.launchpad.net/Teams/MailingLists)

© 2004-2012
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Contact Launchpad Support](/support)
 •
[System status](http://identi.ca/launchpadstatus)



=== Content from review.openstack.org_65bdc42e_20250126_054712.html ===




=== Content from lists.ubuntu.com_be8ed54b_20250126_054720.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from bugs.launchpad.net_435ab2bf_20250126_054714.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# Remote arbitrary file corruption / creation flaw via injected files

Bug #1015531 reported by
[Thierry Carrez](https://launchpad.net/~ttx)
on 2012-06-20

[278](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | Critical | [Pádraig Brady](https://launchpad.net/~p-draigbrady) | [OpenStack Compute (nova) 2012.2 "folsom"](https://launchpad.net/nova/%2Bmilestone/2012.2) |
|  | [Essex](https://bugs.launchpad.net/nova/essex) | Fix Released | Critical | [Pádraig Brady](https://launchpad.net/~p-draigbrady) | [OpenStack Compute (nova) 2012.1.2](https://launchpad.net/nova/%2Bmilestone/2012.1.2) |
|  | [nova (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/nova "Latest release: 3:30.0.0+git2025011510.77e9ec0a65-0ubuntu2, uploaded to main on 2025-01-23 09:46:10.681778+00:00 by James Page (james-page), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [Precise](https://bugs.launchpad.net/ubuntu/precise/%2Bsource/nova) | Fix Released | Undecided | Unassigned |  |

### Bug Description

Matthias Weckbecker from SUSE Security Team reported the following:

------------------

During our internal security audit efforts at SUSE for openstack, I have found

an issue in openstack-nova (compute).

Quoting from [1] (comment #1):

Vulnerable code (quoted), /usr/lib64/python2.6/site-packages/nova/utils.py:

[... snipped copy of utils.execute code ...]

It's already doing lots of things correctly, like e.g. calling Popen with

the first parameter being a list, still it is affected by traversal flaws.

Testcase (also from [1], comment #0):

mweckbecker@s3gfault:~$ cat newserver.xml

<?xml version="1.0" encoding="UTF-8"?>

<server xmlns="<http://docs.openstack.org/compute/api/v1.1>"

imageRef="<http://anonymi.arch.suse.de:8774/985b88ae99474d6d90501870499a063f/images/2d583dfb-000a-4332-9264-ed57ce186f1d>"

        flavorRef="6"

        name="new-server-test">

  <metadata>

    <meta key="My Server Name">foobar</meta>

  </metadata>

  <personality>

    <file path="../../../../../../../../../../../../../etc/hosts">

        ICAgICAgDQoiQSBjbG91ZCBkb2VzIG5vdCBrbm93IHdoeSBp

        dCBtb3ZlcyBpbiBqdXN0IHN1Y2ggYSBkaXJlY3Rpb24gYW5k

        IGF0IHN1Y2ggYSBzcGVlZC4uLkl0IGZlZWxzIGFuIGltcHVs

        c2lvbi4uLnRoaXMgaXMgdGhlIHBsYWNlIHRvIGdvIG5vdy4g

        QnV0IHRoZSBza3kga25vd3MgdGhlIHJlYXNvbnMgYW5kIHRo

        ZSBwYXR0ZXJucyBiZWhpbmQgYWxsIGNsb3VkcywgYW5kIHlv

        dSB3aWxsIGtub3csIHRvbywgd2hlbiB5b3UgbGlmdCB5b3Vy

        c2VsZiBoaWdoIGVub3VnaCB0byBzZWUgYmV5b25kIGhvcml6

        b25zLiINCg0KLVJpY2hhcmQgQmFjaA==

    </file>

  </personality>

</server>

mweckbecker@s3gfault:~$ curl -v

"<http://anonymi.arch.suse.de:8774/v2/985b88ae99474d6d90501870499a063f/servers>"

-H"X-Auth-Token:ef7d5faf9d864c048afce0cf6a3a3c15"

-H"Content-type:application/xml" -H"Accept:application/xml" -d @newserver.xml

Additional note: This beast is calling tee with sudo, potentially allowing

attackers to even alter files such as /etc/passwd.

[1] <https://bugzilla.novell.com/show_bug.cgi?id=767687>

Thanks, Matthias

See [original description](comments/0)

Tags:

[verification-done](/nova/%2Bbugs?field.tag=verification-done)

## Related branches

[lp:~openstack-ubuntu-testing/nova/precise-essex-proposed](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed)
![](/@@/merge-proposal-icon)
[Merged](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916)
into
[lp:~ubuntu-server-dev/nova/essex](https://code.launchpad.net/~ubuntu-server-dev/nova/essex)
at
[revision 344](https://bazaar.launchpad.net/~ubuntu-server-dev/nova/essex/revision/344)

[Chuck Short](https://launchpad.net/~zulcss):
Pending
requested
2012-03-22

Diff: [56 lines (+14/-4)](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916/%2Bpreview-diff/226338/%2Bfiles/preview.diff)3 files modifieddebian/changelog (+8/-0)
debian/control (+6/-3)
debian/nova-console.install (+0/-1)
[api](/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916/%2Bpreview-diff/226338)

[lp:ubuntu/precise-proposed/nova](https://code.launchpad.net/~ubuntu-branches/ubuntu/precise/nova/precise-proposed)

## CVE References

* [2012-3360](/bugs/cve/2012-3360 "Directory traversal vulnerability in ...")
* [2012-3361](/bugs/cve/2012-3361 "virt/disk/api.py in OpenStack Compute...")
* [2012-3371](/bugs/cve/2012-3371 "The Nova scheduler in OpenStack Compu...")
* [2012-3447](/bugs/cve/2012-3447 "virt/disk/api.py in OpenStack Compute...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-20: |  |  | [#1](/nova/%2Bbug/1015531/comments/1) |
| --- | --- | --- | --- |

Ouch :)

I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.

The flaw is actually in nova/virt/disk/api.py which does not check that "path" is still within the image mount\_dir in inject\_files() or \_inject\_file\_into\_fs().

Ouch :)
I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.
The flaw is actually in nova/virt/disk/api.py which does not check that "path" is still within the image mount\_dir in inject\_files() or \_inject\_file\_into\_fs().

| **description**: | updated |
| --- | --- |
| Changed in nova: | |
| **importance**: | Undecided → Critical |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-20: |  |  | [#2](/nova/%2Bbug/1015531/comments/2) |
| --- | --- | --- | --- |

Added PTL to share the fun.

Added PTL to share the fun.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthias Weckbecker (mweckbecker)](https://launchpad.net/~mweckbecker) wrote on 2012-06-20: |  |  | [#3](/nova/%2Bbug/1015531/comments/3) |
| --- | --- | --- | --- |

> I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.

Well, there are probably multiple ways to address this and all of them come with their own pros and cons. Fixing it

directly at low-level means that all subsequent calls that will in turn boil down to utils.execute() code will be safe.

Otherwise we might find us ending up fixing "hundreds" of high-level occurrences.

> I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.
Well, there are probably multiple ways to address this and all of them come with their own pros and cons. Fixing it
directly at low-level means that all subsequent calls that will in turn boil down to utils.execute() code will be safe.
Otherwise we might find us ending up fixing "hundreds" of high-level occurrences.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-20: |  |  | [#4](/nova/%2Bbug/1015531/comments/4) |
| --- | --- | --- | --- |

The trick is that you can't decide at utils.execute() level what generic argument is or is not safe. In some cases passing "../.." is perfectly accepted use !

I see your point though... and as a strengthening low-level measure the rootwrap filter that allows to run mkdir/tee as root should also do a deeper inspection on arguments to check that it only affects nova stuff.

The trick is that you can't decide at utils.execute() level what generic argument is or is not safe. In some cases passing "../.." is perfectly accepted use !
I see your point though... and as a strengthening low-level measure the rootwrap filter that allows to run mkdir/tee as root should also do a deeper inspection on arguments to check that it only affects nova stuff.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthias Weckbecker (mweckbecker)](https://launchpad.net/~mweckbecker) wrote on 2012-06-20: |  |  | [#5](/nova/%2Bbug/1015531/comments/5) |
| --- | --- | --- | --- |

> The trick is that you can't decide at utils.execute() level what

> generic argument is or is not safe. In some cases passing "../.."

> is perfectly accepted use !

Just off the top of my head:

Doesn't Python offer something like Perl's caller() as well? Then you could

possibly perform whitelisting for functions that are allowed to pass "../../".

> The trick is that you can't decide at utils.execute() level what
> generic argument is or is not safe. In some cases passing "../.."
> is perfectly accepted use !
Just off the top of my head:
Doesn't Python offer something like Perl's caller() as well? Then you could
possibly perform whitelisting for functions that are allowed to pass "../../".

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#6](/nova/%2Bbug/1015531/comments/6) |
| --- | --- | --- | --- |

I'm assigning this to myself. I should have a patch up shortly for review/testing.

I'm assigning this to myself. I should have a patch up shortly for review/testing.

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Russell Bryant (russellb) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#7](/nova/%2Bbug/1015531/comments/7) |
| --- | --- | --- | --- |

Here is a patch that address the issue directly in the file injection code. There is some unit test coverage, but I haven't tested this fully yet to ensure that the failure is clean when trying to start an instance.

I'm also going to add Pádraig Brady to this bug. In addition to working on OpenStack, he's also a GNU coreutils maintainer. He helped me refine this patch and can provide valuable input here if we need to explore any additional changes.

Here is a patch that address the issue directly in the file injection code. There is some unit test coverage, but I haven't tested this fully yet to ensure that the failure is clean when trying to start an instance.
I'm also going to add Pádraig Brady to this bug. In addition to working on OpenStack, he's also a GNU coreutils maintainer. He helped me refine this patch and can provide valuable input here if we need to explore any additional changes.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#9](/nova/%2Bbug/1015531/comments/9) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197663/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197663)
  (3.3 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#10](/nova/%2Bbug/1015531/comments/10) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197686/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197686)
  (3.4 KiB,
  text/plain)

Here is the same patch for stable/essex.

I checked stable/diablo and the code is very different there. It looks like there is some xen specific support for file injection. I don't think it's vulnerable, but it would be nice for someone familiar with the xen code to check that.

Here is the same patch for stable/essex.
I checked stable/diablo and the code is very different there. It looks like there is some xen specific support for file injection. I don't think it's vulnerable, but it would be nice for someone familiar with the xen code to check that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#11](/nova/%2Bbug/1015531/comments/11) |
| --- | --- | --- | --- |

Added markmc so he can help review the patches.

Added markmc so he can help review the patches.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vish Ishaya (vishvananda)](https://launchpad.net/~vishvananda) wrote on 2012-06-20: |  |  | [#12](/nova/%2Bbug/1015531/comments/12) |
| --- | --- | --- | --- |

minor issue in the patch: can you replace the two hardcoded '/' with os.sep or os.path.sep ?

Otherwise looks good.

minor issue in the patch: can you replace the two hardcoded '/' with os.sep or os.path.sep ?
Otherwise looks good.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-20: |  |  | [#13](/nova/%2Bbug/1015531/comments/13) |
| --- | --- | --- | --- |

Hmm, I think the \_path\_within\_fs() check needs to be called for all injected files, as one could upload an image with symlinks in various places to get back to the host.

For example if /root/.ssh in the image was a symlink to ../../../../../root/.ssh then you'd be injecting keys to the host authorized\_keys file

Hmm, I think the \_path\_within\_fs() check needs to be called for all injected files, as one could upload an image with symlinks in various places to get back to the host.
For example if /root/.ssh in the image was a symlink to ../../../../../root/.ssh then you'd be injecting keys to the host authorized\_keys file

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#14](/nova/%2Bbug/1015531/comments/14) |
| --- | --- | --- | --- |

Nice find Matthias

Russell: the way we're using commonprefix here, we may as well just use startswith() i.e.

os.path.commonprefix([fs, absolute\_path]) == fs

is equivalent to:

absolute\_path.startswith(fs)

FWIW, the xenapi driver handles injected\_files via the guest agent and isn't vulnerable.

Pádraig is right:

def \_inject\_key\_into\_fs(key, fs, execute=None):

        sshdir = os.path.join(fs, 'root', '.ssh')

        ...

        keyfile = os.path.join(sshdir, 'authorized\_keys')

need to apply realpath() here too. Easiest is to add an 'append' arg to \_inject\_file\_into\_fs() and re-use that.

def \_inject\_metadata\_into\_fs(metadata, fs, execute=None):

        metadata\_path = os.path.join(fs, "meta.js")

meta.js could be a symlink ... again, we should just use \_inject\_file\_into\_fs() here

Nice find Matthias
Russell: the way we're using commonprefix here, we may as well just use startswith() i.e.
os.path.commonprefix([fs, absolute\_path]) == fs
is equivalent to:
absolute\_path.startswith(fs)
FWIW, the xenapi driver handles injected\_files via the guest agent and isn't vulnerable.
Pádraig is right:
def \_inject\_key\_into\_fs(key, fs, execute=None):
sshdir = os.path.join(fs, 'root', '.ssh')
...
keyfile = os.path.join(sshdir, 'authorized\_keys')
need to apply realpath() here too. Easiest is to add an 'append' arg to \_inject\_file\_into\_fs() and re-use that.
def \_inject\_metadata\_into\_fs(metadata, fs, execute=None):
metadata\_path = os.path.join(fs, "meta.js")
meta.js could be a symlink ... again, we should just use \_inject\_file\_into\_fs() here

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#15](/nova/%2Bbug/1015531/comments/15) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198461/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198461)
  (6.9 KiB,
  text/plain)

Ok, here's what I've come up with

Ok, here's what I've come up with

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-21: |  |  | [#16](/nova/%2Bbug/1015531/comments/16) |
| --- | --- | --- | --- |

Last patch looks good to me, especially with all tee calls now going through a single code path.

The remark from Vish about using os.sep instead of '/' still holds.

Last patch looks good to me, especially with all tee calls now going through a single code path.
The remark from Vish about using os.sep instead of '/' still holds.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-21: |  |  | [#17](/nova/%2Bbug/1015531/comments/17) |
| --- | --- | --- | --- |

Looked into stable/diablo and although it doesn't support file injection (so it's not vulnerable to this precise issue), it's still vulnerable to Padraig's variation (upload an image with symlinks in meta.js, /etc/network or /root/.ssh). The impact is slightly lower in the second case, since it's harder to inject arbitrary data, but it affects more setups.

I think we should treat those as two separate issues, two separate CVEs, though probably in the same patch:

\* Matthias's is about arbitrary file injection through <personality>, affects Essex/Folsom in libvirt-based setups

\* Padraig's is about file corruption through net/ssh/metadata injection, affects Diablo/Essex/Folsom, libvirt & xen setups

Thoughts ?

Looked into stable/diablo and although it doesn't support file injection (so it's not vulnerable to this precise issue), it's still vulnerable to Padraig's variation (upload an image with symlinks in meta.js, /etc/network or /root/.ssh). The impact is slightly lower in the second case, since it's harder to inject arbitrary data, but it affects more setups.
I think we should treat those as two separate issues, two separate CVEs, though probably in the same patch:
\* Matthias's is about arbitrary file injection through <personality>, affects Essex/Folsom in libvirt-based setups
\* Padraig's is about file corruption through net/ssh/metadata injection, affects Diablo/Essex/Folsom, libvirt & xen setups
Thoughts ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#18](/nova/%2Bbug/1015531/comments/18) |
| --- | --- | --- | --- |

Meant to comment on the os.sep thing - since the existing code already uses '/':

absolute\_path = os.path.join(fs, path.lstrip('/'))

and we don't support compute nodes on any platforms where '/' isn't the path separator, I don't think it's an issue.

No problem with a later general "switch to os.sep" cleanup in Nova, though.

Meant to comment on the os.sep thing - since the existing code already uses '/':
absolute\_path = os.path.join(fs, path.lstrip('/'))
and we don't support compute nodes on any platforms where '/' isn't the path separator, I don't think it's an issue.
No problem with a later general "switch to os.sep" cleanup in Nova, though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#19](/nova/%2Bbug/1015531/comments/19) |
| --- | --- | --- | --- |

Splitting it into two separate CVEs makes sense to me since Diablo didn't have libvirt-file-injection

FYI, the blueprint for that was: [https://blueprints.launchpad.net/nova/+spec/libvirt-file-injection](https://blueprints.launchpad.net/nova/%2Bspec/libvirt-file-injection)

Splitting it into two separate CVEs makes sense to me since Diablo didn't have libvirt-file-injection
FYI, the blueprint for that was: https://blueprints.launchpad.net/nova/+spec/libvirt-file-injection

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-21: |  |  | [#20](/nova/%2Bbug/1015531/comments/20) |
| --- | --- | --- | --- |

Good point Thierry on the separate CVEs.

Mark nice refactoring in the patch. It's needs this fixup though:

diff --git a/nova/virt/disk/api.py b/nova/virt/disk/api.py

index 8744dcc..730008b 100644

--- a/nova/virt/disk/api.py

+++ b/nova/virt/disk/api.py

@@ -380,7 +380,7 @@ def \_inject\_net\_into\_fs(net, fs, execute=None):

     utils.execute('chown', 'root:root', netdir, run\_as\_root=True)

     utils.execute('chmod', 755, netdir, run\_as\_root=True)

- netfile = os.path.join('etc', 'interfaces')

+ netfile = os.path.join('etc', 'network', 'interfaces')

     \_inject\_file\_into\_fs(fs, netfile, net)

Good point Thierry on the separate CVEs.
Mark nice refactoring in the patch. It's needs this fixup though:
diff --git a/nova/virt/disk/api.py b/nova/virt/disk/api.py
index 8744dcc..730008b 100644
--- a/nova/virt/disk/api.py
+++ b/nova/virt/disk/api.py
@@ -380,7 +380,7 @@ def \_inject\_net\_into\_fs(net, fs, execute=None):
utils.execute('chown', 'root:root', netdir, run\_as\_root=True)
utils.execute('chmod', 755, netdir, run\_as\_root=True)
- netfile = os.path.join('etc', 'interfaces')
+ netfile = os.path.join('etc', 'network', 'interfaces')
\_inject\_file\_into\_fs(fs, netfile, net)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-21: |  |  | [#21](/nova/%2Bbug/1015531/comments/21) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198817/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198817)
  (7.2 KiB,
  text/plain)

Nice work on the patch, Mark. I have attached an updated version that includes the fix from pbrady. I also added Signed-off-by lines to show who all was involved in writing the patch.

Nice work on the patch, Mark. I have attached an updated version that includes the fix from pbrady. I also added Signed-off-by lines to show who all was involved in writing the patch.

| Changed in nova: | |
| --- | --- |
| **assignee**: | Russell Bryant (russellb) → nobody |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-22: |  |  | [#22](/nova/%2Bbug/1015531/comments/22) |
| --- | --- | --- | --- |

Proposed Impact description:

Title: Arbitrary file injection/corruption through directory traversal issues

Impact: Critical

Reporter: Matthias Weckbecker (SUSE Security team), Pádraig Brady (RedHat)

Products: Nova

Affects: All versions

Description:

Matthias Weckbecker from SUSE Security team reported a vulnerability in Nova compute nodes handling of file injection in disk images. By requesting files to be injected in malicious paths, a remote authenticated user could inject files in arbitrary locations on the host file system, potentially resulting in full compromise of the compute node. Only Essex and later setups running the OpenStack API over libvirt-based hypervisors are affected.

Upon further inspection of the code, Pádraig Brady from RedHat found an additional vulnerability. By crafting a malicious image and requesting an instance based on it, a remote authenticated user may corrupt arbitrary files on the host filesystem, potentially resulting in a denial of service. This affects all setups.

Proposed Impact description:
Title: Arbitrary file injection/corruption through directory traversal issues
Impact: Critical
Reporter: Matthias Weckbecker (SUSE Security team), Pádraig Brady (RedHat)
Products: Nova
Affects: All versions
Description:
Matthias Weckbecker from SUSE Security team reported a vulnerability in Nova compute nodes handling of file injection in disk images. By requesting files to be injected in malicious paths, a remote authenticated user could inject files in arbitrary locations on the host file system, potentially resulting in full compromise of the compute node. Only Essex and later setups running the OpenStack API over libvirt-based hypervisors are affected.
Upon further inspection of the code, Pádraig Brady from RedHat found an additional vulnerability. By crafting a malicious image and requesting an instance based on it, a remote authenticated user may corrupt arbitrary files on the host filesystem, potentially resulting in a denial of service. This affects all setups.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#23](/nova/%2Bbug/1015531/comments/23) |
| --- | --- | --- | --- |

Next steps here:

\* Master patch: needs formal pre-approval from nova core (Vish/Markmc ?)

\* Essex patch: needs to be proposed

\* Diablo patch: needs to be proposed

\* Impact description: VMT members please ack

Once we've all this we can push the pre-announce to downstream stakeholders, to get CVEs and propose CRD.

Next steps here:
\* Master patch: needs formal pre-approval from nova core (Vish/Markmc ?)
\* Essex patch: needs to be proposed
\* Diablo patch: needs to be proposed
\* Impact description: VMT members please ack
Once we've all this we can push the pre-announce to downstream stakeholders, to get CVEs and propose CRD.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#24](/nova/%2Bbug/1015531/comments/24) |
| --- | --- | --- | --- |

* [Essex patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203400/%2Bfiles/essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203400)
  (6.2 KiB,
  text/plain)

Essex patch.

Same as Russell's latest version, except Essex uses json instead of jsonutils.

Essex patch.
Same as Russell's latest version, except Essex uses json instead of jsonutils.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-25: |  |  | [#25](/nova/%2Bbug/1015531/comments/25) |
| --- | --- | --- | --- |

Folsom and Essex patches look good to me

Folsom and Essex patches look good to me

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-25: |  |  | [#26](/nova/%2Bbug/1015531/comments/26) |
| --- | --- | --- | --- |

+1for folsom/essex from me.

Thierry, do you want me to do the Diablo patch?

+1for folsom/essex from me.
Thierry, do you want me to do the Diablo patch?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#27](/nova/%2Bbug/1015531/comments/27) |
| --- | --- | --- | --- |

* [Diablo patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203516/%2Bfiles/diablo.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203516)
  (3.0 KiB,
  text/plain)

Diablo patch.

Diablo patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#28](/nova/%2Bbug/1015531/comments/28) |
| --- | --- | --- | --- |

* [diablo2.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203587/%2Bfiles/diablo2.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203587)
  (4.5 KiB,
  text/plain)

New version of the Diablo patch, with tests backported and correct paths used (thanks Padraig).

Please run through run\_tests.sh if you've a run\_tests.sh setup that works with stable/diablo :)

New version of the Diablo patch, with tests backported and correct paths used (thanks Padraig).
Please run through run\_tests.sh if you've a run\_tests.sh setup that works with stable/diablo :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-25: |  |  | [#29](/nova/%2Bbug/1015531/comments/29) |
| --- | --- | --- | --- |

Diablo patch looks good too. cheers

Diablo patch looks good too. cheers

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vish Ishaya (vishvananda)](https://launchpad.net/~vishvananda) wrote on 2012-06-25: |  |  | [#30](/nova/%2Bbug/1015531/comments/30) |
| --- | --- | --- | --- |

all looks good to me. I'm happy with the .sep change going in later since its broken in a lot of other places :)

all looks good to me. I'm happy with the .sep change going in later since its broken in a lot of other places :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-26: |  |  | [#31](/nova/%2Bbug/1015531/comments/31) |
| --- | --- | --- | --- |

OK, will send notice to downstream stakeholders later today, based on the attached patches and impact description (comment 22). Please check that everything looks good before I do :)

Proposed CRD: July 3rd, 1500 UTC

OK, will send notice to downstream stakeholders later today, based on the attached patches and impact description (comment 22). Please check that everything looks good before I do :)
Proposed CRD: July 3rd, 1500 UTC

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-26: |  |  | [#32](/nova/%2Bbug/1015531/comments/32) |
| --- | --- | --- | --- |

I've only a small remark re comment 22.

It's not just corrupting arbitrary files on the host.

You could inject arbitrary keys into /root/.ssh/authorized\_keys on the host.

Now that's probably not an issue as the attacker probably wouldn't have remote access to the host.

If that assumption is always valid, then comment 22 is fine as is.

I've only a small remark re comment 22.
It's not just corrupting arbitrary files on the host.
You could inject arbitrary keys into /root/.ssh/authorized\_keys on the host.
Now that's probably not an issue as the attacker probably wouldn't have remote access to the host.
If that assumption is always valid, then comment 22 is fine as is.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthias Weckbecker (mweckbecker)](https://launchpad.net/~mweckbecker) wrote on 2012-06-26: |  |  | [#33](/nova/%2Bbug/1015531/comments/33) |
| --- | --- | --- | --- |

#22 looks fine for me too. Thanks.

#22 looks fine for me too. Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-26: |  |  | [#34](/nova/%2Bbug/1015531/comments/34) |
| --- | --- | --- | --- |

@Padraig: I think it's fair to assume you wouldn't run ssh on remotely-accessible compute nodes IPs. Anyway, the report is rated "critical" already, and I can't come up with a good wording that adequately covers that corner case :) Feel free to suggest if you care.

@Padraig: I think it's fair to assume you wouldn't run ssh on remotely-accessible compute nodes IPs. Anyway, the report is rated "critical" already, and I can't come up with a good wording that adequately covers that corner case :) Feel free to suggest if you care.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-26: |  |  | [#35](/nova/%2Bbug/1015531/comments/35) |
| --- | --- | --- | --- |

The vulnerability description and latest patches look good. One nit pick on the description is that "RedHat" should be "Red Hat" (with a space).

The vulnerability description and latest patches look good. One nit pick on the description is that "RedHat" should be "Red Hat" (with a space).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-26: |  |  | [#36](/nova/%2Bbug/1015531/comments/36) |
| --- | --- | --- | --- |

Downstream stakeholders email sent, CRD: July 3rd, 1500 UTC

Downstream stakeholders email sent, CRD: July 3rd, 1500 UTC

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-06-26

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Thierry Carrez (ttx) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-27: |  |  | [#37](/nova/%2Bbug/1015531/comments/37) |
| --- | --- | --- | --- |

CVE assignment:

Mathias's is CVE-2012-3360

Padraig's is CVE-2012-3361

CVE assignment:
Mathias's is CVE-2012-3360
Padraig's is CVE-2012-3361

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-06-28

| Changed in nova: | |
| --- | --- |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-03: |  |  | [#38](/nova/%2Bbug/1015531/comments/38) |
| --- | --- | --- | --- |

Adding Dave Walker to coordinate stable/\* releases, should have done that earlier.

Adding Dave Walker to coordinate stable/\* releases, should have done that earlier.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-03: |  |  | [#39](/nova/%2Bbug/1015531/comments/39) |
| --- | --- | --- | --- |

Folsom: <https://review.openstack.org/#/c/9266/>

Essex: <https://review.openstack.org/#/c/9267/>

Diablo: <https://review.openstack.org/#/c/9268/>

Folsom: https://review.openstack.org/#/c/9266/
Essex: https://review.openstack.org/#/c/9267/
Diablo: https://review.openstack.org/#/c/9268/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-03: |  |  | [#40](/nova/%2Bbug/1015531/comments/40) |
| --- | --- | --- | --- |

Folsom/essex in, OSSA 2012-008

Diablo patch at <https://review.openstack.org/#/c/9268/> still needs to be merged on stable/diablo

Folsom/essex in, OSSA 2012-008
Diablo patch at https://review.openstack.org/#/c/9268/ still needs to be merged on stable/diablo

| **visibility**: | private → public |
| --- | --- |
| Changed in nova: | |
| **status**: | Triaged → Fix Committed |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-07-04

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → folsom-2 |
| **status**: | Fix Committed → Fix Released |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2012-08-07

| Changed in nova: | |
| --- | --- |
| **assignee**: | Thierry Carrez (ttx) → Pádraig Brady (p-draigbrady) |
| **status**: | Fix Released → In Progress |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-08-07

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2012-08-08:  [**Fix merged to nova (stable/diablo)**](/nova/%2Bbug/1015531/comments/41) |  |  | [#41](/nova/%2Bbug/1015531/comments/41) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/9268>

Committed: <http://github.com/openstack/nova/commit/1e218105b08b1afdf944fc77af91c2cadf90b6e2>

Submitter: Jenkins

Branch: stable/diablo

commit 1e218105b08b1afdf944fc77af91c2cadf90b6e2

Author: Thierry Carrez <email address hidden>

Date: Tue Jul 3 16:34:58 2012 +0200

Prevent key/net/md injection writing to host fs

Fix [bug 1015531](/bugs/1015531), CVE-2012-3361

Checks that the final normalized path that is about to be written

    to is always within the mounted guest filesystem.

This is a Diablo backport of the part of Russell Bryant, Pádraig Brady

    and Mark McLoughlin's Folsom patch that applies to stable/diablo.

Change-Id: I134c40258ff2c9c225bd6092decd9c10e4e22273

Reviewed: https://review.openstack.org/9268
Committed: http://github.com/openstack/nova/commit/1e218105b08b1afdf944fc77af91c2cadf90b6e2
Submitter: Jenkins
Branch: stable/diablo
commit 1e218105b08b1afdf944fc77af91c2cadf90b6e2
Author: Thierry Carrez <thierry@openstack.org>
Date: Tue Jul 3 16:34:58 2012 +0200
Prevent key/net/md injection writing to host fs
Fix bug 1015531, CVE-2012-3361
Checks that the final normalized path that is about to be written
to is always within the mounted guest filesystem.
This is a Diablo backport of the part of Russell Bryant, Pádraig Brady
and Mark McLoughlin's Folsom patch that applies to stable/diablo.
Change-Id: I134c40258ff2c9c225bd6092decd9c10e4e22273

[Dave Walker (davewalker)](https://launchpad.net/~davewalker)
on 2012-08-24

| Changed in nova (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |
| Changed in nova (Ubuntu Precise): | |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand) wrote on 2012-08-24: |  |  | [#42](/nova/%2Bbug/1015531/comments/42) |
| --- | --- | --- | --- |

So, Ubuntu 12.04 LTS should be fixed between:

<http://www.ubuntu.com/usn/usn-1497-1/> (CVE-2012-3361)

<http://www.ubuntu.com/usn/usn-1545-1/> (CVE-2012-3447)

So, Ubuntu 12.04 LTS should be fixed between:
http://www.ubuntu.com/usn/usn-1497-1/ (CVE-2012-3361)
http://www.ubuntu.com/usn/usn-1545-1/ (CVE-2012-3447)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Adam Gandelman (gandelman-a)](https://launchpad.net/~gandelman-a) wrote on 2012-08-30:  [**Verification report.**](/nova/%2Bbug/1015531/comments/43) |  |  | [#43](/nova/%2Bbug/1015531/comments/43) |
| --- | --- | --- | --- |

Please find the attached test log from the Ubuntu Server Team's CI infrastructure. As part of the verification process for this bug, Nova has been deployed and configured across multiple nodes using precise-proposed as an installation source. After successful bring-up and configuration of the cluster, a number of exercises and smoke tests have be invoked to ensure the updated package did not introduce any regressions. A number of test iterations were carried out to catch any possible transient errors.

Please Note the list of installed packages at the top and bottom of the report.

As per the provisional Micro Release Exception granted to this package by the Technical Board, we hope this contributes toward verification of this update.

Please find the attached test log from the Ubuntu Server Team's CI infrastructure. As part of the verification process for this bug, Nova has been deployed and configured across multiple nodes using precise-proposed as an installation source. After successful bring-up and configuration of the cluster, a number of exercises and smoke tests have be invoked to ensure the updated package did not introduce any regressions. A number of test iterations were carried out to catch any possible transient errors.
Please Note the list of installed packages at the top and bottom of the report.
As per the provisional Micro Release Exception granted to this package by the Technical Board, we hope this contributes toward verification of this update.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Adam Gandelman (gandelman-a)](https://launchpad.net/~gandelman-a) wrote on 2012-08-30: |  |  | [#44](/nova/%2Bbug/1015531/comments/44) |
| --- | --- | --- | --- |

* [2012.1.3+stable-20120827-4d2a4afe-0ubuntu1.log](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3283238/%2Bfiles/2012.1.3%2Bstable-20120827-4d2a4afe-0ubuntu1.log)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3283238)
  (82.0 KiB,
  text/plain)

Test coverage log.

Test coverage log.

| **tags**: | added: verification-done |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2012-09-03: |  |  | [#45](/nova/%2Bbug/1015531/comments/45) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/nova/%2Bbug/1015531/comments/45/%2Bdownload) (5.4 KiB)

This bug was fixed in the package nova - 2012.1.3+stable-20120827-4d2a4afe-0ubuntu1

---------------

nova (2012.1.3+stable-20120827-4d2a4afe-0ubuntu1) precise-proposed; urgency=low

\* New upstream snapshot, fixes FTBFS in -proposed. (LP: [#1041120](/bugs/1041120))

  \* Resynchronize with stable/essex (4d2a4afe):

    - [5d63601] Inappropriate exception handling on kvm live/block migration

      (LP: [#917615](/bugs/917615))

    - [ae280ca] Deleted floating ips can cause instance delete to fail

      (LP: [#1038266](/bugs/1038266))

nova (2012.1.3+stable-20120824-86fb7362-0ubuntu1) precise-proposed; urgency=low

\* New upstream snapshot. (LP: [#1041120](/bugs/1041120))

  \* Dropped, superseded by new snapshot:

    - debian/patches/CVE-2012-3447.patch: [d9577ce]

    - debian/patches/CVE-2012-3371.patch: [25f5bd3]

    - debian/patches/CVE-2012-3360+3361.patch: [b0feaff]

  \* Resynchronize with stable/essex (86fb7362):

    - [86fb736] Libvirt driver reports incorrect error when volume-detach fails

      (LP: [#1029463](/bugs/1029463))

    - [272b98d] nova delete lxc-instance umounts the wrong rootfs (LP: [#971621](/bugs/971621))

    - [09217ab] Block storage connections are NOT restored on system reboot

      (LP: [#1036902](/bugs/1036902))

    - [d9577ce] CVE-2012-3361 not fully addressed (LP: [#1031311](/bugs/1031311))

    - [e8ef050] pycrypto is unused and the existing code is potentially insecure

      to use (LP: [#1033178](/bugs/1033178))

    - [3b4ac31] cannot umount guestfs (LP: [#1013689](/bugs/1013689))

    - [f8255f3] qpid\_heartbeat setting in ineffective (LP: [#1030430](/bugs/1030430))

    - [413c641] Deallocation of fixed IP occurs before security group refresh

      leading to potential security issue in error / race conditions

      (LP: [#1021352](/bugs/1021352))

    - [219c5ca] Race condition in network/deallocate\_for\_instance() leads to

      security issue (LP: [#1021340](/bugs/1021340))

    - [f2bc403] cleanup\_file\_locks does not remove stale sentinel files

      (LP: [#1018586](/bugs/1018586))

    - [4c7d671] Deleting Flavor currently in use by instance creates error

      (LP: [#994935](/bugs/994935))

    - [7e88e39] nova testsuite errors on newer versions of python-boto (e.g.

      2.5.2) (LP: [#1027984](/bugs/1027984))

    - [80d3026] NoMoreFloatingIps: Zero floating ips available after repeatedly

      creating and destroying instances over time (LP: [#1017418](/bugs/1017418))

    - [4d74631] Launching with source groups under load produces lazy load error

      (LP: [#1018721](/bugs/1018721))

    - [08e5128] API 'v1.1/{tenant\_id}/os-hosts' does not return a list of hosts

      (LP: [#1014925](/bugs/1014925))

    - [801b94a] Restarting nova-compute removes ip packet filters (LP: [#1027105](/bugs/1027105))

    - [f6d1f55] instance live migration should create virtual\_size disk image

      (LP: [#977007](/bugs/977007))

    - [4b89b4f] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips

      quotas returns general uninformative HTTP 500 error (LP: [#1021373](/bugs/1021373))

    - [6e873bc] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips

      quotas returns general uninformative HTTP 500 error (LP: [#1021373](/bugs/1021373))

    - [7b215ed] Use default qemu-img cluster size in libvirt connection driver

    - [d3a87a2] Listing flavors with marker set returns 400 (LP: [#956096](/bugs/956096))

    - [cf6a85a] nova-rootwrap hardcodes paths instead of using

      /sbin:/usr/sbin:/usr/bin:/bin (LP: [#1013147](/bugs/1013147))

    - [2efc87c] affinity filters don't work if scheduler\_hints is None

      (LP: [#1007573](/bugs/1007573))

  ...

[Read more...](/nova/%2Bbug/1015531/comments/45)

This bug was fixed in the package nova - 2012.1.3+stable-20120827-4d2a4afe-0ubuntu1
---------------
nova (2012.1.3+stable-20120827-4d2a4afe-0ubuntu1) precise-proposed; urgency=low
\* New upstream snapshot, fixes FTBFS in -proposed. (LP: #1041120)
\* Resynchronize with stable/essex (4d2a4afe):
- [5d63601] Inappropriate exception handling on kvm live/block migration
(LP: #917615)
- [ae280ca] Deleted floating ips can cause instance delete to fail
(LP: #1038266)
nova (2012.1.3+stable-20120824-86fb7362-0ubuntu1) precise-proposed; urgency=low
\* New upstream snapshot. (LP: #1041120)
\* Dropped, superseded by new snapshot:
- debian/patches/CVE-2012-3447.patch: [d9577ce]
- debian/patches/CVE-2012-3371.patch: [25f5bd3]
- debian/patches/CVE-2012-3360+3361.patch: [b0feaff]
\* Resynchronize with stable/essex (86fb7362):
- [86fb736] Libvirt driver reports incorrect error when volume-detach fails
(LP: #1029463)
- [272b98d] nova delete lxc-instance umounts the wrong rootfs (LP: #971621)
- [09217ab] Block storage connections are NOT restored on system reboot
(LP: #1036902)
- [d9577ce] CVE-2012-3361 not fully addressed (LP: #1031311)
- [e8ef050] pycrypto is unused and the existing code is potentially insecure
to use (LP: #1033178)
- [3b4ac31] cannot umount guestfs (LP: #1013689)
- [f8255f3] qpid\_heartbeat setting in ineffective (LP: #1030430)
- [413c641] Deallocation of fixed IP occurs before security group refresh
leading to potential security issue in error / race conditions
(LP: #1021352)
- [219c5ca] Race condition in network/deallocate\_for\_instance() leads to
security issue (LP: #1021340)
- [f2bc403] cleanup\_file\_locks does not remove stale sentinel files
(LP: #1018586)
- [4c7d671] Deleting Flavor currently in use by instance creates error
(LP: #994935)
- [7e88e39] nova testsuite errors on newer versions of python-boto (e.g.
2.5.2) (LP: #1027984)
- [80d3026] NoMoreFloatingIps: Zero floating ips available after repeatedly
creating and destroying instances over time (LP: #1017418)
- [4d74631] Launching with source groups under load produces lazy load error
(LP: #1018721)
- [08e5128] API 'v1.1/{tenant\_id}/os-hosts' does not return a list of hosts
(LP: #1014925)
- [801b94a] Restarting nova-compute removes ip packet filters (LP: #1027105)
- [f6d1f55] instance live migration should create virtual\_size disk image
(LP: #977007)
- [4b89b4f] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips
quotas returns general uninformative HTTP 500 error (LP: #1021373)
- [6e873bc] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips
quotas returns general uninformative HTTP 500 error (LP: #1021373)
- [7b215ed] Use default qemu-img cluster size in libvirt connection driver
- [d3a87a2] Listing flavors with marker set returns 400 (LP: #956096)
- [cf6a85a] nova-rootwrap hardcodes paths instead of using
/sbin:/usr/sbin:/usr/bin:/bin (LP: #1013147)
- [2efc87c] affinity filters don't work if scheduler\_hints is None
(LP: #1007573)
- [48e5f46] metadata injection is broken in xen (LP: #1022036)
- [25f5bd3] scheduler hang (DOS) possible with
DifferentHostFilter/SameHostFilter (LP: #1017795)
- [1c1b858] cannot umount guestfs (LP: #1013689)
- [835ba4f] not able to get host total memory in xen with libvirt
(LP: #1004298)
- [00e5104] Call to network\_get\_all\_by\_uuids missing 'db' (LP: #986922)
- [4c49df7] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips
quotas returns general uninformative HTTP 500 error (LP: #1021373)
- [19631f3] [nova][volumes] Exceeding volumes quotas logs
"VolumeSizeTooLarge" instead of "VolumeLimitExceeded" (LP: #1020634)
- [b0feaff] Remote arbitrary file corruption / creation flaw via injected
files (LP: #1015531)
- [3cb6e57] NoMoreFixedIps: Zero fixed ips available. Nova seems leaking
them. (LP: #1014769)
- [5d8431b] ram\_allocation\_ratio does not work (LP: #1016273)
- [410060f] test\_get\_console\_output\_file requires sudo NOPASSWD
(LP: #992805)
- [33c2575] Stop/start a KVM instance with volumes attached produces an
error state (LP: #1013782)
- [6c01c01] Backport tox settings to unbreak jenkins jobs.
- [344125f] Set defaultbranch in .gitreview to stable/essex
- [9b789be] floating ips are not disassociated from instances on deletion
(LP: #997763)
- [d89c2f3] qpid timeout causing compute service to crash (LP: #999698)
- [caae0e9] floating ips do not display in 'nova list' after association to
instance (LP: #939122)
- [1dc9f19] impl\_qpid doesn't ACK messages (LP: #1012374)
- [bc621bc] Restarting nova-network removes ip packet filters
(LP: #1000853)
- [7870157] Add caching to openstack.common.cfg
- [27133ee] Firewall rules from nova-compute are not refreshed after host
reboot (LP: #985162)
- [3ee026e] Source group based security group rule without protocol and port
causes failures (LP: #1010514)
- [f0a9f47] [SRU] dns\_domains table mysql charset is 'latin1'. Should be
'utf8' (LP: #993663)
- [cc8fd97] euca-describe-keypair NonExistent returns 200 (LP: #1006664)
- [9f9e9da] Security groups fail to be set correctly if incorrect case is
used for protocol specification (LP: #985184)
-- Adam Gandelman <adamg@canonical.com> Mon, 27 Aug 2012 14:50:40 -0700

| Changed in nova (Ubuntu Precise): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Clint Byrum (clint-fewbar)](https://launchpad.net/~clint-fewbar) wrote on 2012-09-03:  [**Update Released**](/nova/%2Bbug/1015531/comments/46) |  |  | [#46](/nova/%2Bbug/1015531/comments/46) |
| --- | --- | --- | --- |

The verification of this Stable Release Update has completed successfully and the package has now been released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regresssions.

The verification of this Stable Release Update has completed successfully and the package has now been released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regresssions.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-09-27

| Changed in nova: | |
| --- | --- |
| **milestone**: | folsom-2 → 2012.2 |

[Sean Dague (sdague)](https://launchpad.net/~sdague)
on 2014-09-15

| **no longer affects**: | nova/diablo |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1015531/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197663/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197663 "Change patch details")
* [0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197686/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197686 "Change patch details")
* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198461/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198461 "Change patch details")
* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198817/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198817 "Change patch details")
* [Essex patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203400/%2Bfiles/essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203400 "Change patch details")
* [Diablo patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203516/%2Bfiles/diablo.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203516 "Change patch details")
* [diablo2.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203587/%2Bfiles/diablo2.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203587 "Change patch details")

* [Add patch](/nova/%2Bbug/1015531/%2Baddcomment?field.patch=on)

## Bug attachments

* [2012.1.3+stable-20120827-4d2a4afe-0ubuntu1.log](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3283238/%2Bfiles/2012.1.3%2Bstable-20120827-4d2a4afe-0ubuntu1.log)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3283238 "Change attachment details")

* [Add attachment](/nova/%2Bbug/1015531/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_5f69b925_20250125_034811.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2F2427d4a99bed35baefd8f17ba422cb7aae8dcca7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2F2427d4a99bed35baefd8f17ba422cb7aae8dcca7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openstack%2Fnova)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openstack](/openstack)
/
**[nova](/openstack/nova)**
Public

* [Notifications](/login?return_to=%2Fopenstack%2Fnova) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fopenstack%2Fnova)
* [Star
   3.1k](/login?return_to=%2Fopenstack%2Fnova)

* [Code](/openstack/nova)
* [Pull requests
  0](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

Additional navigation options

* [Code](/openstack/nova)
* [Pull requests](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

## Commit

[Permalink](/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Prevent file injection writing to host filesystem.

[Browse files](/openstack/nova/tree/2427d4a99bed35baefd8f17ba422cb7aae8dcca7)
Browse the repository at this point in the history

```
Fix bug 1015531, [CVE-2012-3360](https://github.com/advisories/GHSA-m454-cm7h-rqhh "CVE-2012-3360"), [CVE-2012-3361](https://github.com/advisories/GHSA-cm54-3vvf-f5p8 "CVE-2012-3361")

This patch prevents the file injection code from writing into the host
filesystem if a user specifies a path for the injected file that
contains '..'.  The check is to make sure that the final normalized path
that is about to be written to is within the mounted guest filesystem.

Signed-off-by: Russell Bryant <rbryant@redhat.com>
Signed-off-by: Pádraig Brady <pbrady@redhat.com>
Signed-off-by: Mark McLoughlin <markmc@redhat.com>

Change-Id: I658cd12fd319cee91eb9544cdf53c862c5d2c560
```

* Loading branch information

[![@russellb](https://avatars.githubusercontent.com/u/309258?s=40&v=4)](/russellb) [![@ttx](https://avatars.githubusercontent.com/u/712511?s=40&v=4)](/ttx)

[russellb](/openstack/nova/commits?author=russellb "View all commits by russellb")
authored and
[ttx](/openstack/nova/commits?author=ttx "View all commits by ttx")
committed
Jul 3, 2012

1 parent
[d335457](/openstack/nova/commit/d335457f48d09c3d780c92413fe777030c1335e2)

commit 2427d4a

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**66 additions**
and
**25 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* nova

  + tests

    - nova/tests/test\_virt.py
      [test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004)
  + virt/disk

    - nova/virt/disk/api.py
      [api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5)

## There are no files selected for viewing

20 changes: 20 additions & 0 deletions

20
[nova/tests/test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004 "nova/tests/test_virt.py")

Show comments

[View file](/openstack/nova/blob/2427d4a99bed35baefd8f17ba422cb7aae8dcca7/nova/tests/test_virt.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,8 +15,10 @@ |
|  |  | # License for the specific language governing permissions and limitations |
|  |  | # under the License. |
|  |  |  |
|  |  | from nova import exception |
|  |  | from nova import flags |
|  |  | from nova import test |
|  |  | from nova.virt.disk import api as disk\_api |
|  |  | from nova.virt import driver |
|  |  |  |
|  |  | FLAGS = flags.FLAGS |
| Expand Down  Expand Up | | @@ -81,3 +83,21 @@ def test\_swap\_is\_usable(self): |
|  |  | 'swap\_size': 0})) |
|  |  | self.assertTrue(driver.swap\_is\_usable({'device\_name': '/dev/sdb', |
|  |  | 'swap\_size': 1})) |
|  |  |  |
|  |  |  |
|  |  | class TestVirtDisk(test.TestCase): |
|  |  | def test\_check\_safe\_path(self): |
|  |  | ret = disk\_api.\_join\_and\_check\_path\_within\_fs('/foo', 'etc', |
|  |  | 'something.conf') |
|  |  | self.assertEquals(ret, '/foo/etc/something.conf') |
|  |  |  |
|  |  | def test\_check\_unsafe\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_join\_and\_check\_path\_within\_fs, |
|  |  | '/foo', 'etc/../../../something.conf') |
|  |  |  |
|  |  | def test\_inject\_files\_with\_bad\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_inject\_file\_into\_fs, |
|  |  | '/tmp', '/etc/../../../../etc/passwd', |
|  |  | 'hax') |

71 changes: 46 additions & 25 deletions

71
[nova/virt/disk/api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5 "nova/virt/disk/api.py")

Show comments

[View file](/openstack/nova/blob/2427d4a99bed35baefd8f17ba422cb7aae8dcca7/nova/virt/disk/api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -311,20 +311,39 @@ def inject\_data\_into\_fs(fs, key, net, metadata, admin\_password, execute): |
|  |  | \_inject\_admin\_password\_into\_fs(admin\_password, fs, execute=execute) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_file\_into\_fs(fs, path, contents): |
|  |  | absolute\_path = os.path.join(fs, path.lstrip('/')) |
|  |  | def \_join\_and\_check\_path\_within\_fs(fs, \*args): |
|  |  | '''os.path.join() with safety check for injected file paths. |
|  |  |  |
|  |  | Join the supplied path components and make sure that the |
|  |  | resulting path we are injecting into is within the |
|  |  | mounted guest fs. Trying to be clever and specifying a |
|  |  | path with '..' in it will hit this safeguard. |
|  |  | ''' |
|  |  | absolute\_path = os.path.realpath(os.path.join(fs, \*args)) |
|  |  | if not absolute\_path.startswith(os.path.realpath(fs) + '/'): |
|  |  | raise exception.Invalid(\_('injected file path not valid')) |
|  |  | return absolute\_path |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_file\_into\_fs(fs, path, contents, append=False): |
|  |  | absolute\_path = \_join\_and\_check\_path\_within\_fs(fs, path.lstrip('/')) |
|  |  |  |
|  |  | parent\_dir = os.path.dirname(absolute\_path) |
|  |  | utils.execute('mkdir', '-p', parent\_dir, run\_as\_root=True) |
|  |  | utils.execute('tee', absolute\_path, process\_input=contents, |
|  |  | run\_as\_root=True) |
|  |  |  |
|  |  | args = [] |
|  |  | if append: |
|  |  | args.append('-a') |
|  |  | args.append(absolute\_path) |
|  |  |  |
|  |  | kwargs = dict(process\_input=contents, run\_as\_root=True) |
|  |  |  |
|  |  | utils.execute('tee', \*args, \*\*kwargs) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_metadata\_into\_fs(metadata, fs, execute=None): |
|  |  | metadata\_path = os.path.join(fs, "meta.js") |
|  |  | metadata = dict([(m.key, m.value) for m in metadata]) |
|  |  |  |
|  |  | utils.execute('tee', metadata\_path, |
|  |  | process\_input=jsonutils.dumps(metadata), run\_as\_root=True) |
|  |  | \_inject\_file\_into\_fs(fs, 'meta.js', jsonutils.dumps(metadata)) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_key\_into\_fs(key, fs, execute=None): |
| Expand All | | @@ -333,33 +352,36 @@ def \_inject\_key\_into\_fs(key, fs, execute=None): |
|  |  | key is an ssh key string. |
|  |  | fs is the path to the base of the filesystem into which to inject the key. |
|  |  | """ |
|  |  | sshdir = os.path.join(fs, 'root', '.ssh') |
|  |  | sshdir = \_join\_and\_check\_path\_within\_fs(fs, 'root', '.ssh') |
|  |  | utils.execute('mkdir', '-p', sshdir, run\_as\_root=True) |
|  |  | utils.execute('chown', 'root', sshdir, run\_as\_root=True) |
|  |  | utils.execute('chmod', '700', sshdir, run\_as\_root=True) |
|  |  | keyfile = os.path.join(sshdir, 'authorized\_keys') |
|  |  | key\_data = [ |
|  |  |  |
|  |  | keyfile = os.path.join('root', '.ssh', 'authorized\_keys') |
|  |  |  |
|  |  | key\_data = ''.join([ |
|  |  | '\n', |
|  |  | '# The following ssh key was injected by Nova', |
|  |  | '\n', |
|  |  | key.strip(), |
|  |  | '\n', |
|  |  | ] |
|  |  | utils.execute('tee', '-a', keyfile, |
|  |  | process\_input=''.join(key\_data), run\_as\_root=True) |
|  |  | ]) |
|  |  |  |
|  |  | \_inject\_file\_into\_fs(fs, keyfile, key\_data, append=True) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_net\_into\_fs(net, fs, execute=None): |
|  |  | """Inject /etc/network/interfaces into the filesystem rooted at fs. |
|  |  |  |
|  |  | net is the contents of /etc/network/interfaces. |
|  |  | """ |
|  |  | netdir = os.path.join(os.path.join(fs, 'etc'), 'network') |
|  |  | netdir = \_join\_and\_check\_path\_within\_fs(fs, 'etc', 'network') |
|  |  | utils.execute('mkdir', '-p', netdir, run\_as\_root=True) |
|  |  | utils.execute('chown', 'root:root', netdir, run\_as\_root=True) |
|  |  | utils.execute('chmod', 755, netdir, run\_as\_root=True) |
|  |  | netfile = os.path.join(netdir, 'interfaces') |
|  |  | utils.execute('tee', netfile, process\_input=net, run\_as\_root=True) |
|  |  |  |
|  |  | netfile = os.path.join('etc', 'network', 'interfaces') |
|  |  | \_inject\_file\_into\_fs(fs, netfile, net) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_admin\_password\_into\_fs(admin\_passwd, fs, execute=None): |
| Expand All | | @@ -384,16 +406,15 @@ def \_inject\_admin\_password\_into\_fs(admin\_passwd, fs, execute=None): |
|  |  | fd, tmp\_shadow = tempfile.mkstemp() |
|  |  | os.close(fd) |
|  |  |  |
|  |  | utils.execute('cp', os.path.join(fs, 'etc', 'passwd'), tmp\_passwd, |
|  |  | run\_as\_root=True) |
|  |  | utils.execute('cp', os.path.join(fs, 'etc', 'shadow'), tmp\_shadow, |
|  |  | run\_as\_root=True) |
|  |  | passwd\_path = \_join\_and\_check\_path\_within\_fs(fs, 'etc', 'passwd') |
|  |  | shadow\_path = \_join\_and\_check\_path\_within\_fs(fs, 'etc', 'shadow') |
|  |  |  |
|  |  | utils.execute('cp', passwd\_path, tmp\_passwd, run\_as\_root=True) |
|  |  | utils.execute('cp', shadow\_path, tmp\_shadow, run\_as\_root=True) |
|  |  | \_set\_passwd(admin\_user, admin\_passwd, tmp\_passwd, tmp\_shadow) |
|  |  | utils.execute('cp', tmp\_passwd, os.path.join(fs, 'etc', 'passwd'), |
|  |  | run\_as\_root=True) |
|  |  | utils.execute('cp', tmp\_passwd, passwd\_path, run\_as\_root=True) |
|  |  | os.unlink(tmp\_passwd) |
|  |  | utils.execute('cp', tmp\_shadow, os.path.join(fs, 'etc', 'shadow'), |
|  |  | run\_as\_root=True) |
|  |  | utils.execute('cp', tmp\_shadow, shadow\_path, run\_as\_root=True) |
|  |  | os.unlink(tmp\_shadow) |
|  |  |  |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2427d4a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2F2427d4a99bed35baefd8f17ba422cb7aae8dcca7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from launchpad.net_86b285ec_20250126_054719.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/nova/2011.3-0ubuntu6.9/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[nova package](https://launchpad.net/ubuntu/%2Bsource/nova)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/nova)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/nova)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/nova)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/nova)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/nova)

# nova 2011.3-0ubuntu6.9 source package in Ubuntu

## Changelog

```
nova (2011.3-0ubuntu6.9) oneiric-security; urgency=low

  * SECURITY UPDATE: arbitrary file injection/corruption
    - debian/patches/CVE-2012-3361.patch: ensure that files cannot
      be injected in arbitrary locations
    - CVE-2012-3361
 -- Steve Beattie <email address hidden>   Mon, 02 Jul 2012 12:26:31 -0700
```

## Upload details

Uploaded by:
[Steve Beattie](/~sbeattie)
on 2012-07-02

Uploaded to:
[Oneiric](/ubuntu/oneiric)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
all

Section:
net

Urgency:
Low Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Oneiric](/ubuntu/oneiric):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/3624774)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [nova\_2011.3.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/nova/2011.3-0ubuntu6.9/nova_2011.3.orig.tar.gz) | 3.7 MiB | 3eeb9a1ee9bdcd52ca0c937bd4f83dd8b52e8f71b82753ba3f2f98f7859ef321 |
| [nova\_2011.3-0ubuntu6.9.debian.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/nova/2011.3-0ubuntu6.9/nova_2011.3-0ubuntu6.9.debian.tar.gz) | 53.7 KiB | eafb0da816470a6e3579544b918daa36ab369b5c2e4588de938b16d2ea56507d |
| [nova\_2011.3-0ubuntu6.9.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/nova/2011.3-0ubuntu6.9/nova_2011.3-0ubuntu6.9.dsc) | 2.8 KiB | 461ed8cae84a305af0e210f779e27966857c83c59e34654eb9e4c854420ebb03 |

### Available diffs

* [diff from 2011.3-0ubuntu6.8 to 2011.3-0ubuntu6.9](http://launchpadlibrarian.net/109243046/nova_2011.3-0ubuntu6.8_2011.3-0ubuntu6.9.diff.gz) (2.4 KiB)

[View changes file](http://launchpadlibrarian.net/109243048/nova_2011.3-0ubuntu6.9_source.changes)

## Binary packages built by this source

[nova-ajax-console-proxy](/ubuntu/oneiric/%2Bpackage/nova-ajax-console-proxy):
No summary available for nova-ajax-console-proxy in ubuntu oneiric.

No description available for nova-ajax-console-proxy in ubuntu oneiric.

[nova-api](/ubuntu/oneiric/%2Bpackage/nova-api):
No summary available for nova-api in ubuntu oneiric.

No description available for nova-api in ubuntu oneiric.

[nova-common](/ubuntu/oneiric/%2Bpackage/nova-common):
No summary available for nova-common in ubuntu oneiric.

No description available for nova-common in ubuntu oneiric.

[nova-compute](/ubuntu/oneiric/%2Bpackage/nova-compute):
No summary available for nova-compute in ubuntu oneiric.

No description available for nova-compute in ubuntu oneiric.

[nova-compute-kvm](/ubuntu/oneiric/%2Bpackage/nova-compute-kvm):
No summary available for nova-compute-kvm in ubuntu oneiric.

No description available for nova-compute-kvm in ubuntu oneiric.

[nova-compute-lxc](/ubuntu/oneiric/%2Bpackage/nova-compute-lxc):
No summary available for nova-compute-lxc in ubuntu oneiric.

No description available for nova-compute-lxc in ubuntu oneiric.

[nova-compute-uml](/ubuntu/oneiric/%2Bpackage/nova-compute-uml):
No summary available for nova-compute-uml in ubuntu oneiric.

No description available for nova-compute-uml in ubuntu oneiric.

[nova-compute-xen](/ubuntu/oneiric/%2Bpackage/nova-compute-xen):
No summary available for nova-compute-xen in ubuntu oneiric.

No description available for nova-compute-xen in ubuntu oneiric.

[nova-doc](/ubuntu/oneiric/%2Bpackage/nova-doc):
No summary available for nova-doc in ubuntu oneiric.

No description available for nova-doc in ubuntu oneiric.

[nova-network](/ubuntu/oneiric/%2Bpackage/nova-network):
No summary available for nova-network in ubuntu oneiric.

No description available for nova-network in ubuntu oneiric.

[nova-objectstore](/ubuntu/oneiric/%2Bpackage/nova-objectstore):
No summary available for nova-objectstore in ubuntu oneiric.

No description available for nova-objectstore in ubuntu oneiric.

[nova-scheduler](/ubuntu/oneiric/%2Bpackage/nova-scheduler):
No summary available for nova-scheduler in ubuntu oneiric.

No description available for nova-scheduler in ubuntu oneiric.

[nova-vncproxy](/ubuntu/oneiric/%2Bpackage/nova-vncproxy):
No summary available for nova-vncproxy in ubuntu oneiric.

No description available for nova-vncproxy in ubuntu oneiric.

[nova-volume](/ubuntu/oneiric/%2Bpackage/nova-volume):
No summary available for nova-volume in ubuntu oneiric.

No description available for nova-volume in ubuntu oneiric.

[python-nova](/ubuntu/oneiric/%2Bpackage/python-nova):
No summary available for python-nova in ubuntu oneiric.

No description available for python-nova in ubuntu oneiric.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_873935e2_20250126_054718.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# Remote arbitrary file corruption / creation flaw via injected files

Bug #1015531 reported by
[Thierry Carrez](https://launchpad.net/~ttx)
on 2012-06-20

[278](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | Critical | [Pádraig Brady](https://launchpad.net/~p-draigbrady) | [OpenStack Compute (nova) 2012.2 "folsom"](https://launchpad.net/nova/%2Bmilestone/2012.2) |
|  | [Essex](https://bugs.launchpad.net/nova/essex) | Fix Released | Critical | [Pádraig Brady](https://launchpad.net/~p-draigbrady) | [OpenStack Compute (nova) 2012.1.2](https://launchpad.net/nova/%2Bmilestone/2012.1.2) |
|  | [nova (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/nova "Latest release: 3:30.0.0+git2025011510.77e9ec0a65-0ubuntu2, uploaded to main on 2025-01-23 09:46:10.681778+00:00 by James Page (james-page), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [Precise](https://bugs.launchpad.net/ubuntu/precise/%2Bsource/nova) | Fix Released | Undecided | Unassigned |  |

### Bug Description

Matthias Weckbecker from SUSE Security Team reported the following:

------------------

During our internal security audit efforts at SUSE for openstack, I have found

an issue in openstack-nova (compute).

Quoting from [1] (comment #1):

Vulnerable code (quoted), /usr/lib64/python2.6/site-packages/nova/utils.py:

[... snipped copy of utils.execute code ...]

It's already doing lots of things correctly, like e.g. calling Popen with

the first parameter being a list, still it is affected by traversal flaws.

Testcase (also from [1], comment #0):

mweckbecker@s3gfault:~$ cat newserver.xml

<?xml version="1.0" encoding="UTF-8"?>

<server xmlns="<http://docs.openstack.org/compute/api/v1.1>"

imageRef="<http://anonymi.arch.suse.de:8774/985b88ae99474d6d90501870499a063f/images/2d583dfb-000a-4332-9264-ed57ce186f1d>"

        flavorRef="6"

        name="new-server-test">

  <metadata>

    <meta key="My Server Name">foobar</meta>

  </metadata>

  <personality>

    <file path="../../../../../../../../../../../../../etc/hosts">

        ICAgICAgDQoiQSBjbG91ZCBkb2VzIG5vdCBrbm93IHdoeSBp

        dCBtb3ZlcyBpbiBqdXN0IHN1Y2ggYSBkaXJlY3Rpb24gYW5k

        IGF0IHN1Y2ggYSBzcGVlZC4uLkl0IGZlZWxzIGFuIGltcHVs

        c2lvbi4uLnRoaXMgaXMgdGhlIHBsYWNlIHRvIGdvIG5vdy4g

        QnV0IHRoZSBza3kga25vd3MgdGhlIHJlYXNvbnMgYW5kIHRo

        ZSBwYXR0ZXJucyBiZWhpbmQgYWxsIGNsb3VkcywgYW5kIHlv

        dSB3aWxsIGtub3csIHRvbywgd2hlbiB5b3UgbGlmdCB5b3Vy

        c2VsZiBoaWdoIGVub3VnaCB0byBzZWUgYmV5b25kIGhvcml6

        b25zLiINCg0KLVJpY2hhcmQgQmFjaA==

    </file>

  </personality>

</server>

mweckbecker@s3gfault:~$ curl -v

"<http://anonymi.arch.suse.de:8774/v2/985b88ae99474d6d90501870499a063f/servers>"

-H"X-Auth-Token:ef7d5faf9d864c048afce0cf6a3a3c15"

-H"Content-type:application/xml" -H"Accept:application/xml" -d @newserver.xml

Additional note: This beast is calling tee with sudo, potentially allowing

attackers to even alter files such as /etc/passwd.

[1] <https://bugzilla.novell.com/show_bug.cgi?id=767687>

Thanks, Matthias

See [original description](comments/0)

Tags:

[verification-done](/nova/%2Bbugs?field.tag=verification-done)

## Related branches

[lp:~openstack-ubuntu-testing/nova/precise-essex-proposed](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed)
![](/@@/merge-proposal-icon)
[Merged](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916)
into
[lp:~ubuntu-server-dev/nova/essex](https://code.launchpad.net/~ubuntu-server-dev/nova/essex)
at
[revision 344](https://bazaar.launchpad.net/~ubuntu-server-dev/nova/essex/revision/344)

[Chuck Short](https://launchpad.net/~zulcss):
Pending
requested
2012-03-22

Diff: [56 lines (+14/-4)](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916/%2Bpreview-diff/226338/%2Bfiles/preview.diff)3 files modifieddebian/changelog (+8/-0)
debian/control (+6/-3)
debian/nova-console.install (+0/-1)
[api](/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916/%2Bpreview-diff/226338)

[lp:ubuntu/precise-proposed/nova](https://code.launchpad.net/~ubuntu-branches/ubuntu/precise/nova/precise-proposed)

## CVE References

* [2012-3360](/bugs/cve/2012-3360 "Directory traversal vulnerability in ...")
* [2012-3361](/bugs/cve/2012-3361 "virt/disk/api.py in OpenStack Compute...")
* [2012-3371](/bugs/cve/2012-3371 "The Nova scheduler in OpenStack Compu...")
* [2012-3447](/bugs/cve/2012-3447 "virt/disk/api.py in OpenStack Compute...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-20: |  |  | [#1](/nova/%2Bbug/1015531/comments/1) |
| --- | --- | --- | --- |

Ouch :)

I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.

The flaw is actually in nova/virt/disk/api.py which does not check that "path" is still within the image mount\_dir in inject\_files() or \_inject\_file\_into\_fs().

Ouch :)
I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.
The flaw is actually in nova/virt/disk/api.py which does not check that "path" is still within the image mount\_dir in inject\_files() or \_inject\_file\_into\_fs().

| **description**: | updated |
| --- | --- |
| Changed in nova: | |
| **importance**: | Undecided → Critical |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-20: |  |  | [#2](/nova/%2Bbug/1015531/comments/2) |
| --- | --- | --- | --- |

Added PTL to share the fun.

Added PTL to share the fun.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthias Weckbecker (mweckbecker)](https://launchpad.net/~mweckbecker) wrote on 2012-06-20: |  |  | [#3](/nova/%2Bbug/1015531/comments/3) |
| --- | --- | --- | --- |

> I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.

Well, there are probably multiple ways to address this and all of them come with their own pros and cons. Fixing it

directly at low-level means that all subsequent calls that will in turn boil down to utils.execute() code will be safe.

Otherwise we might find us ending up fixing "hundreds" of high-level occurrences.

> I would not blame the utils.execute() code though, it's a low-level primitive that just does what it's told to do.
Well, there are probably multiple ways to address this and all of them come with their own pros and cons. Fixing it
directly at low-level means that all subsequent calls that will in turn boil down to utils.execute() code will be safe.
Otherwise we might find us ending up fixing "hundreds" of high-level occurrences.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-20: |  |  | [#4](/nova/%2Bbug/1015531/comments/4) |
| --- | --- | --- | --- |

The trick is that you can't decide at utils.execute() level what generic argument is or is not safe. In some cases passing "../.." is perfectly accepted use !

I see your point though... and as a strengthening low-level measure the rootwrap filter that allows to run mkdir/tee as root should also do a deeper inspection on arguments to check that it only affects nova stuff.

The trick is that you can't decide at utils.execute() level what generic argument is or is not safe. In some cases passing "../.." is perfectly accepted use !
I see your point though... and as a strengthening low-level measure the rootwrap filter that allows to run mkdir/tee as root should also do a deeper inspection on arguments to check that it only affects nova stuff.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthias Weckbecker (mweckbecker)](https://launchpad.net/~mweckbecker) wrote on 2012-06-20: |  |  | [#5](/nova/%2Bbug/1015531/comments/5) |
| --- | --- | --- | --- |

> The trick is that you can't decide at utils.execute() level what

> generic argument is or is not safe. In some cases passing "../.."

> is perfectly accepted use !

Just off the top of my head:

Doesn't Python offer something like Perl's caller() as well? Then you could

possibly perform whitelisting for functions that are allowed to pass "../../".

> The trick is that you can't decide at utils.execute() level what
> generic argument is or is not safe. In some cases passing "../.."
> is perfectly accepted use !
Just off the top of my head:
Doesn't Python offer something like Perl's caller() as well? Then you could
possibly perform whitelisting for functions that are allowed to pass "../../".

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#6](/nova/%2Bbug/1015531/comments/6) |
| --- | --- | --- | --- |

I'm assigning this to myself. I should have a patch up shortly for review/testing.

I'm assigning this to myself. I should have a patch up shortly for review/testing.

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Russell Bryant (russellb) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#7](/nova/%2Bbug/1015531/comments/7) |
| --- | --- | --- | --- |

Here is a patch that address the issue directly in the file injection code. There is some unit test coverage, but I haven't tested this fully yet to ensure that the failure is clean when trying to start an instance.

I'm also going to add Pádraig Brady to this bug. In addition to working on OpenStack, he's also a GNU coreutils maintainer. He helped me refine this patch and can provide valuable input here if we need to explore any additional changes.

Here is a patch that address the issue directly in the file injection code. There is some unit test coverage, but I haven't tested this fully yet to ensure that the failure is clean when trying to start an instance.
I'm also going to add Pádraig Brady to this bug. In addition to working on OpenStack, he's also a GNU coreutils maintainer. He helped me refine this patch and can provide valuable input here if we need to explore any additional changes.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#9](/nova/%2Bbug/1015531/comments/9) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197663/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197663)
  (3.3 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#10](/nova/%2Bbug/1015531/comments/10) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197686/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197686)
  (3.4 KiB,
  text/plain)

Here is the same patch for stable/essex.

I checked stable/diablo and the code is very different there. It looks like there is some xen specific support for file injection. I don't think it's vulnerable, but it would be nice for someone familiar with the xen code to check that.

Here is the same patch for stable/essex.
I checked stable/diablo and the code is very different there. It looks like there is some xen specific support for file injection. I don't think it's vulnerable, but it would be nice for someone familiar with the xen code to check that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-20: |  |  | [#11](/nova/%2Bbug/1015531/comments/11) |
| --- | --- | --- | --- |

Added markmc so he can help review the patches.

Added markmc so he can help review the patches.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vish Ishaya (vishvananda)](https://launchpad.net/~vishvananda) wrote on 2012-06-20: |  |  | [#12](/nova/%2Bbug/1015531/comments/12) |
| --- | --- | --- | --- |

minor issue in the patch: can you replace the two hardcoded '/' with os.sep or os.path.sep ?

Otherwise looks good.

minor issue in the patch: can you replace the two hardcoded '/' with os.sep or os.path.sep ?
Otherwise looks good.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-20: |  |  | [#13](/nova/%2Bbug/1015531/comments/13) |
| --- | --- | --- | --- |

Hmm, I think the \_path\_within\_fs() check needs to be called for all injected files, as one could upload an image with symlinks in various places to get back to the host.

For example if /root/.ssh in the image was a symlink to ../../../../../root/.ssh then you'd be injecting keys to the host authorized\_keys file

Hmm, I think the \_path\_within\_fs() check needs to be called for all injected files, as one could upload an image with symlinks in various places to get back to the host.
For example if /root/.ssh in the image was a symlink to ../../../../../root/.ssh then you'd be injecting keys to the host authorized\_keys file

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#14](/nova/%2Bbug/1015531/comments/14) |
| --- | --- | --- | --- |

Nice find Matthias

Russell: the way we're using commonprefix here, we may as well just use startswith() i.e.

os.path.commonprefix([fs, absolute\_path]) == fs

is equivalent to:

absolute\_path.startswith(fs)

FWIW, the xenapi driver handles injected\_files via the guest agent and isn't vulnerable.

Pádraig is right:

def \_inject\_key\_into\_fs(key, fs, execute=None):

        sshdir = os.path.join(fs, 'root', '.ssh')

        ...

        keyfile = os.path.join(sshdir, 'authorized\_keys')

need to apply realpath() here too. Easiest is to add an 'append' arg to \_inject\_file\_into\_fs() and re-use that.

def \_inject\_metadata\_into\_fs(metadata, fs, execute=None):

        metadata\_path = os.path.join(fs, "meta.js")

meta.js could be a symlink ... again, we should just use \_inject\_file\_into\_fs() here

Nice find Matthias
Russell: the way we're using commonprefix here, we may as well just use startswith() i.e.
os.path.commonprefix([fs, absolute\_path]) == fs
is equivalent to:
absolute\_path.startswith(fs)
FWIW, the xenapi driver handles injected\_files via the guest agent and isn't vulnerable.
Pádraig is right:
def \_inject\_key\_into\_fs(key, fs, execute=None):
sshdir = os.path.join(fs, 'root', '.ssh')
...
keyfile = os.path.join(sshdir, 'authorized\_keys')
need to apply realpath() here too. Easiest is to add an 'append' arg to \_inject\_file\_into\_fs() and re-use that.
def \_inject\_metadata\_into\_fs(metadata, fs, execute=None):
metadata\_path = os.path.join(fs, "meta.js")
meta.js could be a symlink ... again, we should just use \_inject\_file\_into\_fs() here

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#15](/nova/%2Bbug/1015531/comments/15) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198461/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198461)
  (6.9 KiB,
  text/plain)

Ok, here's what I've come up with

Ok, here's what I've come up with

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-21: |  |  | [#16](/nova/%2Bbug/1015531/comments/16) |
| --- | --- | --- | --- |

Last patch looks good to me, especially with all tee calls now going through a single code path.

The remark from Vish about using os.sep instead of '/' still holds.

Last patch looks good to me, especially with all tee calls now going through a single code path.
The remark from Vish about using os.sep instead of '/' still holds.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-21: |  |  | [#17](/nova/%2Bbug/1015531/comments/17) |
| --- | --- | --- | --- |

Looked into stable/diablo and although it doesn't support file injection (so it's not vulnerable to this precise issue), it's still vulnerable to Padraig's variation (upload an image with symlinks in meta.js, /etc/network or /root/.ssh). The impact is slightly lower in the second case, since it's harder to inject arbitrary data, but it affects more setups.

I think we should treat those as two separate issues, two separate CVEs, though probably in the same patch:

\* Matthias's is about arbitrary file injection through <personality>, affects Essex/Folsom in libvirt-based setups

\* Padraig's is about file corruption through net/ssh/metadata injection, affects Diablo/Essex/Folsom, libvirt & xen setups

Thoughts ?

Looked into stable/diablo and although it doesn't support file injection (so it's not vulnerable to this precise issue), it's still vulnerable to Padraig's variation (upload an image with symlinks in meta.js, /etc/network or /root/.ssh). The impact is slightly lower in the second case, since it's harder to inject arbitrary data, but it affects more setups.
I think we should treat those as two separate issues, two separate CVEs, though probably in the same patch:
\* Matthias's is about arbitrary file injection through <personality>, affects Essex/Folsom in libvirt-based setups
\* Padraig's is about file corruption through net/ssh/metadata injection, affects Diablo/Essex/Folsom, libvirt & xen setups
Thoughts ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#18](/nova/%2Bbug/1015531/comments/18) |
| --- | --- | --- | --- |

Meant to comment on the os.sep thing - since the existing code already uses '/':

absolute\_path = os.path.join(fs, path.lstrip('/'))

and we don't support compute nodes on any platforms where '/' isn't the path separator, I don't think it's an issue.

No problem with a later general "switch to os.sep" cleanup in Nova, though.

Meant to comment on the os.sep thing - since the existing code already uses '/':
absolute\_path = os.path.join(fs, path.lstrip('/'))
and we don't support compute nodes on any platforms where '/' isn't the path separator, I don't think it's an issue.
No problem with a later general "switch to os.sep" cleanup in Nova, though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-21: |  |  | [#19](/nova/%2Bbug/1015531/comments/19) |
| --- | --- | --- | --- |

Splitting it into two separate CVEs makes sense to me since Diablo didn't have libvirt-file-injection

FYI, the blueprint for that was: [https://blueprints.launchpad.net/nova/+spec/libvirt-file-injection](https://blueprints.launchpad.net/nova/%2Bspec/libvirt-file-injection)

Splitting it into two separate CVEs makes sense to me since Diablo didn't have libvirt-file-injection
FYI, the blueprint for that was: https://blueprints.launchpad.net/nova/+spec/libvirt-file-injection

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-21: |  |  | [#20](/nova/%2Bbug/1015531/comments/20) |
| --- | --- | --- | --- |

Good point Thierry on the separate CVEs.

Mark nice refactoring in the patch. It's needs this fixup though:

diff --git a/nova/virt/disk/api.py b/nova/virt/disk/api.py

index 8744dcc..730008b 100644

--- a/nova/virt/disk/api.py

+++ b/nova/virt/disk/api.py

@@ -380,7 +380,7 @@ def \_inject\_net\_into\_fs(net, fs, execute=None):

     utils.execute('chown', 'root:root', netdir, run\_as\_root=True)

     utils.execute('chmod', 755, netdir, run\_as\_root=True)

- netfile = os.path.join('etc', 'interfaces')

+ netfile = os.path.join('etc', 'network', 'interfaces')

     \_inject\_file\_into\_fs(fs, netfile, net)

Good point Thierry on the separate CVEs.
Mark nice refactoring in the patch. It's needs this fixup though:
diff --git a/nova/virt/disk/api.py b/nova/virt/disk/api.py
index 8744dcc..730008b 100644
--- a/nova/virt/disk/api.py
+++ b/nova/virt/disk/api.py
@@ -380,7 +380,7 @@ def \_inject\_net\_into\_fs(net, fs, execute=None):
utils.execute('chown', 'root:root', netdir, run\_as\_root=True)
utils.execute('chmod', 755, netdir, run\_as\_root=True)
- netfile = os.path.join('etc', 'interfaces')
+ netfile = os.path.join('etc', 'network', 'interfaces')
\_inject\_file\_into\_fs(fs, netfile, net)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-21: |  |  | [#21](/nova/%2Bbug/1015531/comments/21) |
| --- | --- | --- | --- |

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198817/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198817)
  (7.2 KiB,
  text/plain)

Nice work on the patch, Mark. I have attached an updated version that includes the fix from pbrady. I also added Signed-off-by lines to show who all was involved in writing the patch.

Nice work on the patch, Mark. I have attached an updated version that includes the fix from pbrady. I also added Signed-off-by lines to show who all was involved in writing the patch.

| Changed in nova: | |
| --- | --- |
| **assignee**: | Russell Bryant (russellb) → nobody |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-22: |  |  | [#22](/nova/%2Bbug/1015531/comments/22) |
| --- | --- | --- | --- |

Proposed Impact description:

Title: Arbitrary file injection/corruption through directory traversal issues

Impact: Critical

Reporter: Matthias Weckbecker (SUSE Security team), Pádraig Brady (RedHat)

Products: Nova

Affects: All versions

Description:

Matthias Weckbecker from SUSE Security team reported a vulnerability in Nova compute nodes handling of file injection in disk images. By requesting files to be injected in malicious paths, a remote authenticated user could inject files in arbitrary locations on the host file system, potentially resulting in full compromise of the compute node. Only Essex and later setups running the OpenStack API over libvirt-based hypervisors are affected.

Upon further inspection of the code, Pádraig Brady from RedHat found an additional vulnerability. By crafting a malicious image and requesting an instance based on it, a remote authenticated user may corrupt arbitrary files on the host filesystem, potentially resulting in a denial of service. This affects all setups.

Proposed Impact description:
Title: Arbitrary file injection/corruption through directory traversal issues
Impact: Critical
Reporter: Matthias Weckbecker (SUSE Security team), Pádraig Brady (RedHat)
Products: Nova
Affects: All versions
Description:
Matthias Weckbecker from SUSE Security team reported a vulnerability in Nova compute nodes handling of file injection in disk images. By requesting files to be injected in malicious paths, a remote authenticated user could inject files in arbitrary locations on the host file system, potentially resulting in full compromise of the compute node. Only Essex and later setups running the OpenStack API over libvirt-based hypervisors are affected.
Upon further inspection of the code, Pádraig Brady from RedHat found an additional vulnerability. By crafting a malicious image and requesting an instance based on it, a remote authenticated user may corrupt arbitrary files on the host filesystem, potentially resulting in a denial of service. This affects all setups.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#23](/nova/%2Bbug/1015531/comments/23) |
| --- | --- | --- | --- |

Next steps here:

\* Master patch: needs formal pre-approval from nova core (Vish/Markmc ?)

\* Essex patch: needs to be proposed

\* Diablo patch: needs to be proposed

\* Impact description: VMT members please ack

Once we've all this we can push the pre-announce to downstream stakeholders, to get CVEs and propose CRD.

Next steps here:
\* Master patch: needs formal pre-approval from nova core (Vish/Markmc ?)
\* Essex patch: needs to be proposed
\* Diablo patch: needs to be proposed
\* Impact description: VMT members please ack
Once we've all this we can push the pre-announce to downstream stakeholders, to get CVEs and propose CRD.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#24](/nova/%2Bbug/1015531/comments/24) |
| --- | --- | --- | --- |

* [Essex patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203400/%2Bfiles/essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203400)
  (6.2 KiB,
  text/plain)

Essex patch.

Same as Russell's latest version, except Essex uses json instead of jsonutils.

Essex patch.
Same as Russell's latest version, except Essex uses json instead of jsonutils.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-06-25: |  |  | [#25](/nova/%2Bbug/1015531/comments/25) |
| --- | --- | --- | --- |

Folsom and Essex patches look good to me

Folsom and Essex patches look good to me

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-25: |  |  | [#26](/nova/%2Bbug/1015531/comments/26) |
| --- | --- | --- | --- |

+1for folsom/essex from me.

Thierry, do you want me to do the Diablo patch?

+1for folsom/essex from me.
Thierry, do you want me to do the Diablo patch?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#27](/nova/%2Bbug/1015531/comments/27) |
| --- | --- | --- | --- |

* [Diablo patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203516/%2Bfiles/diablo.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203516)
  (3.0 KiB,
  text/plain)

Diablo patch.

Diablo patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-25: |  |  | [#28](/nova/%2Bbug/1015531/comments/28) |
| --- | --- | --- | --- |

* [diablo2.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203587/%2Bfiles/diablo2.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203587)
  (4.5 KiB,
  text/plain)

New version of the Diablo patch, with tests backported and correct paths used (thanks Padraig).

Please run through run\_tests.sh if you've a run\_tests.sh setup that works with stable/diablo :)

New version of the Diablo patch, with tests backported and correct paths used (thanks Padraig).
Please run through run\_tests.sh if you've a run\_tests.sh setup that works with stable/diablo :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-25: |  |  | [#29](/nova/%2Bbug/1015531/comments/29) |
| --- | --- | --- | --- |

Diablo patch looks good too. cheers

Diablo patch looks good too. cheers

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vish Ishaya (vishvananda)](https://launchpad.net/~vishvananda) wrote on 2012-06-25: |  |  | [#30](/nova/%2Bbug/1015531/comments/30) |
| --- | --- | --- | --- |

all looks good to me. I'm happy with the .sep change going in later since its broken in a lot of other places :)

all looks good to me. I'm happy with the .sep change going in later since its broken in a lot of other places :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-26: |  |  | [#31](/nova/%2Bbug/1015531/comments/31) |
| --- | --- | --- | --- |

OK, will send notice to downstream stakeholders later today, based on the attached patches and impact description (comment 22). Please check that everything looks good before I do :)

Proposed CRD: July 3rd, 1500 UTC

OK, will send notice to downstream stakeholders later today, based on the attached patches and impact description (comment 22). Please check that everything looks good before I do :)
Proposed CRD: July 3rd, 1500 UTC

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-06-26: |  |  | [#32](/nova/%2Bbug/1015531/comments/32) |
| --- | --- | --- | --- |

I've only a small remark re comment 22.

It's not just corrupting arbitrary files on the host.

You could inject arbitrary keys into /root/.ssh/authorized\_keys on the host.

Now that's probably not an issue as the attacker probably wouldn't have remote access to the host.

If that assumption is always valid, then comment 22 is fine as is.

I've only a small remark re comment 22.
It's not just corrupting arbitrary files on the host.
You could inject arbitrary keys into /root/.ssh/authorized\_keys on the host.
Now that's probably not an issue as the attacker probably wouldn't have remote access to the host.
If that assumption is always valid, then comment 22 is fine as is.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthias Weckbecker (mweckbecker)](https://launchpad.net/~mweckbecker) wrote on 2012-06-26: |  |  | [#33](/nova/%2Bbug/1015531/comments/33) |
| --- | --- | --- | --- |

#22 looks fine for me too. Thanks.

#22 looks fine for me too. Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-26: |  |  | [#34](/nova/%2Bbug/1015531/comments/34) |
| --- | --- | --- | --- |

@Padraig: I think it's fair to assume you wouldn't run ssh on remotely-accessible compute nodes IPs. Anyway, the report is rated "critical" already, and I can't come up with a good wording that adequately covers that corner case :) Feel free to suggest if you care.

@Padraig: I think it's fair to assume you wouldn't run ssh on remotely-accessible compute nodes IPs. Anyway, the report is rated "critical" already, and I can't come up with a good wording that adequately covers that corner case :) Feel free to suggest if you care.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-06-26: |  |  | [#35](/nova/%2Bbug/1015531/comments/35) |
| --- | --- | --- | --- |

The vulnerability description and latest patches look good. One nit pick on the description is that "RedHat" should be "Red Hat" (with a space).

The vulnerability description and latest patches look good. One nit pick on the description is that "RedHat" should be "Red Hat" (with a space).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-26: |  |  | [#36](/nova/%2Bbug/1015531/comments/36) |
| --- | --- | --- | --- |

Downstream stakeholders email sent, CRD: July 3rd, 1500 UTC

Downstream stakeholders email sent, CRD: July 3rd, 1500 UTC

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-06-26

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Thierry Carrez (ttx) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-06-27: |  |  | [#37](/nova/%2Bbug/1015531/comments/37) |
| --- | --- | --- | --- |

CVE assignment:

Mathias's is CVE-2012-3360

Padraig's is CVE-2012-3361

CVE assignment:
Mathias's is CVE-2012-3360
Padraig's is CVE-2012-3361

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-06-28

| Changed in nova: | |
| --- | --- |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-03: |  |  | [#38](/nova/%2Bbug/1015531/comments/38) |
| --- | --- | --- | --- |

Adding Dave Walker to coordinate stable/\* releases, should have done that earlier.

Adding Dave Walker to coordinate stable/\* releases, should have done that earlier.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-03: |  |  | [#39](/nova/%2Bbug/1015531/comments/39) |
| --- | --- | --- | --- |

Folsom: <https://review.openstack.org/#/c/9266/>

Essex: <https://review.openstack.org/#/c/9267/>

Diablo: <https://review.openstack.org/#/c/9268/>

Folsom: https://review.openstack.org/#/c/9266/
Essex: https://review.openstack.org/#/c/9267/
Diablo: https://review.openstack.org/#/c/9268/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-03: |  |  | [#40](/nova/%2Bbug/1015531/comments/40) |
| --- | --- | --- | --- |

Folsom/essex in, OSSA 2012-008

Diablo patch at <https://review.openstack.org/#/c/9268/> still needs to be merged on stable/diablo

Folsom/essex in, OSSA 2012-008
Diablo patch at https://review.openstack.org/#/c/9268/ still needs to be merged on stable/diablo

| **visibility**: | private → public |
| --- | --- |
| Changed in nova: | |
| **status**: | Triaged → Fix Committed |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-07-04

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → folsom-2 |
| **status**: | Fix Committed → Fix Released |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2012-08-07

| Changed in nova: | |
| --- | --- |
| **assignee**: | Thierry Carrez (ttx) → Pádraig Brady (p-draigbrady) |
| **status**: | Fix Released → In Progress |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-08-07

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2012-08-08:  [**Fix merged to nova (stable/diablo)**](/nova/%2Bbug/1015531/comments/41) |  |  | [#41](/nova/%2Bbug/1015531/comments/41) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/9268>

Committed: <http://github.com/openstack/nova/commit/1e218105b08b1afdf944fc77af91c2cadf90b6e2>

Submitter: Jenkins

Branch: stable/diablo

commit 1e218105b08b1afdf944fc77af91c2cadf90b6e2

Author: Thierry Carrez <email address hidden>

Date: Tue Jul 3 16:34:58 2012 +0200

Prevent key/net/md injection writing to host fs

Fix [bug 1015531](/bugs/1015531), CVE-2012-3361

Checks that the final normalized path that is about to be written

    to is always within the mounted guest filesystem.

This is a Diablo backport of the part of Russell Bryant, Pádraig Brady

    and Mark McLoughlin's Folsom patch that applies to stable/diablo.

Change-Id: I134c40258ff2c9c225bd6092decd9c10e4e22273

Reviewed: https://review.openstack.org/9268
Committed: http://github.com/openstack/nova/commit/1e218105b08b1afdf944fc77af91c2cadf90b6e2
Submitter: Jenkins
Branch: stable/diablo
commit 1e218105b08b1afdf944fc77af91c2cadf90b6e2
Author: Thierry Carrez <thierry@openstack.org>
Date: Tue Jul 3 16:34:58 2012 +0200
Prevent key/net/md injection writing to host fs
Fix bug 1015531, CVE-2012-3361
Checks that the final normalized path that is about to be written
to is always within the mounted guest filesystem.
This is a Diablo backport of the part of Russell Bryant, Pádraig Brady
and Mark McLoughlin's Folsom patch that applies to stable/diablo.
Change-Id: I134c40258ff2c9c225bd6092decd9c10e4e22273

[Dave Walker (davewalker)](https://launchpad.net/~davewalker)
on 2012-08-24

| Changed in nova (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |
| Changed in nova (Ubuntu Precise): | |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand) wrote on 2012-08-24: |  |  | [#42](/nova/%2Bbug/1015531/comments/42) |
| --- | --- | --- | --- |

So, Ubuntu 12.04 LTS should be fixed between:

<http://www.ubuntu.com/usn/usn-1497-1/> (CVE-2012-3361)

<http://www.ubuntu.com/usn/usn-1545-1/> (CVE-2012-3447)

So, Ubuntu 12.04 LTS should be fixed between:
http://www.ubuntu.com/usn/usn-1497-1/ (CVE-2012-3361)
http://www.ubuntu.com/usn/usn-1545-1/ (CVE-2012-3447)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Adam Gandelman (gandelman-a)](https://launchpad.net/~gandelman-a) wrote on 2012-08-30:  [**Verification report.**](/nova/%2Bbug/1015531/comments/43) |  |  | [#43](/nova/%2Bbug/1015531/comments/43) |
| --- | --- | --- | --- |

Please find the attached test log from the Ubuntu Server Team's CI infrastructure. As part of the verification process for this bug, Nova has been deployed and configured across multiple nodes using precise-proposed as an installation source. After successful bring-up and configuration of the cluster, a number of exercises and smoke tests have be invoked to ensure the updated package did not introduce any regressions. A number of test iterations were carried out to catch any possible transient errors.

Please Note the list of installed packages at the top and bottom of the report.

As per the provisional Micro Release Exception granted to this package by the Technical Board, we hope this contributes toward verification of this update.

Please find the attached test log from the Ubuntu Server Team's CI infrastructure. As part of the verification process for this bug, Nova has been deployed and configured across multiple nodes using precise-proposed as an installation source. After successful bring-up and configuration of the cluster, a number of exercises and smoke tests have be invoked to ensure the updated package did not introduce any regressions. A number of test iterations were carried out to catch any possible transient errors.
Please Note the list of installed packages at the top and bottom of the report.
As per the provisional Micro Release Exception granted to this package by the Technical Board, we hope this contributes toward verification of this update.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Adam Gandelman (gandelman-a)](https://launchpad.net/~gandelman-a) wrote on 2012-08-30: |  |  | [#44](/nova/%2Bbug/1015531/comments/44) |
| --- | --- | --- | --- |

* [2012.1.3+stable-20120827-4d2a4afe-0ubuntu1.log](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3283238/%2Bfiles/2012.1.3%2Bstable-20120827-4d2a4afe-0ubuntu1.log)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3283238)
  (82.0 KiB,
  text/plain)

Test coverage log.

Test coverage log.

| **tags**: | added: verification-done |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2012-09-03: |  |  | [#45](/nova/%2Bbug/1015531/comments/45) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/nova/%2Bbug/1015531/comments/45/%2Bdownload) (5.4 KiB)

This bug was fixed in the package nova - 2012.1.3+stable-20120827-4d2a4afe-0ubuntu1

---------------

nova (2012.1.3+stable-20120827-4d2a4afe-0ubuntu1) precise-proposed; urgency=low

\* New upstream snapshot, fixes FTBFS in -proposed. (LP: [#1041120](/bugs/1041120))

  \* Resynchronize with stable/essex (4d2a4afe):

    - [5d63601] Inappropriate exception handling on kvm live/block migration

      (LP: [#917615](/bugs/917615))

    - [ae280ca] Deleted floating ips can cause instance delete to fail

      (LP: [#1038266](/bugs/1038266))

nova (2012.1.3+stable-20120824-86fb7362-0ubuntu1) precise-proposed; urgency=low

\* New upstream snapshot. (LP: [#1041120](/bugs/1041120))

  \* Dropped, superseded by new snapshot:

    - debian/patches/CVE-2012-3447.patch: [d9577ce]

    - debian/patches/CVE-2012-3371.patch: [25f5bd3]

    - debian/patches/CVE-2012-3360+3361.patch: [b0feaff]

  \* Resynchronize with stable/essex (86fb7362):

    - [86fb736] Libvirt driver reports incorrect error when volume-detach fails

      (LP: [#1029463](/bugs/1029463))

    - [272b98d] nova delete lxc-instance umounts the wrong rootfs (LP: [#971621](/bugs/971621))

    - [09217ab] Block storage connections are NOT restored on system reboot

      (LP: [#1036902](/bugs/1036902))

    - [d9577ce] CVE-2012-3361 not fully addressed (LP: [#1031311](/bugs/1031311))

    - [e8ef050] pycrypto is unused and the existing code is potentially insecure

      to use (LP: [#1033178](/bugs/1033178))

    - [3b4ac31] cannot umount guestfs (LP: [#1013689](/bugs/1013689))

    - [f8255f3] qpid\_heartbeat setting in ineffective (LP: [#1030430](/bugs/1030430))

    - [413c641] Deallocation of fixed IP occurs before security group refresh

      leading to potential security issue in error / race conditions

      (LP: [#1021352](/bugs/1021352))

    - [219c5ca] Race condition in network/deallocate\_for\_instance() leads to

      security issue (LP: [#1021340](/bugs/1021340))

    - [f2bc403] cleanup\_file\_locks does not remove stale sentinel files

      (LP: [#1018586](/bugs/1018586))

    - [4c7d671] Deleting Flavor currently in use by instance creates error

      (LP: [#994935](/bugs/994935))

    - [7e88e39] nova testsuite errors on newer versions of python-boto (e.g.

      2.5.2) (LP: [#1027984](/bugs/1027984))

    - [80d3026] NoMoreFloatingIps: Zero floating ips available after repeatedly

      creating and destroying instances over time (LP: [#1017418](/bugs/1017418))

    - [4d74631] Launching with source groups under load produces lazy load error

      (LP: [#1018721](/bugs/1018721))

    - [08e5128] API 'v1.1/{tenant\_id}/os-hosts' does not return a list of hosts

      (LP: [#1014925](/bugs/1014925))

    - [801b94a] Restarting nova-compute removes ip packet filters (LP: [#1027105](/bugs/1027105))

    - [f6d1f55] instance live migration should create virtual\_size disk image

      (LP: [#977007](/bugs/977007))

    - [4b89b4f] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips

      quotas returns general uninformative HTTP 500 error (LP: [#1021373](/bugs/1021373))

    - [6e873bc] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips

      quotas returns general uninformative HTTP 500 error (LP: [#1021373](/bugs/1021373))

    - [7b215ed] Use default qemu-img cluster size in libvirt connection driver

    - [d3a87a2] Listing flavors with marker set returns 400 (LP: [#956096](/bugs/956096))

    - [cf6a85a] nova-rootwrap hardcodes paths instead of using

      /sbin:/usr/sbin:/usr/bin:/bin (LP: [#1013147](/bugs/1013147))

    - [2efc87c] affinity filters don't work if scheduler\_hints is None

      (LP: [#1007573](/bugs/1007573))

  ...

[Read more...](/nova/%2Bbug/1015531/comments/45)

This bug was fixed in the package nova - 2012.1.3+stable-20120827-4d2a4afe-0ubuntu1
---------------
nova (2012.1.3+stable-20120827-4d2a4afe-0ubuntu1) precise-proposed; urgency=low
\* New upstream snapshot, fixes FTBFS in -proposed. (LP: #1041120)
\* Resynchronize with stable/essex (4d2a4afe):
- [5d63601] Inappropriate exception handling on kvm live/block migration
(LP: #917615)
- [ae280ca] Deleted floating ips can cause instance delete to fail
(LP: #1038266)
nova (2012.1.3+stable-20120824-86fb7362-0ubuntu1) precise-proposed; urgency=low
\* New upstream snapshot. (LP: #1041120)
\* Dropped, superseded by new snapshot:
- debian/patches/CVE-2012-3447.patch: [d9577ce]
- debian/patches/CVE-2012-3371.patch: [25f5bd3]
- debian/patches/CVE-2012-3360+3361.patch: [b0feaff]
\* Resynchronize with stable/essex (86fb7362):
- [86fb736] Libvirt driver reports incorrect error when volume-detach fails
(LP: #1029463)
- [272b98d] nova delete lxc-instance umounts the wrong rootfs (LP: #971621)
- [09217ab] Block storage connections are NOT restored on system reboot
(LP: #1036902)
- [d9577ce] CVE-2012-3361 not fully addressed (LP: #1031311)
- [e8ef050] pycrypto is unused and the existing code is potentially insecure
to use (LP: #1033178)
- [3b4ac31] cannot umount guestfs (LP: #1013689)
- [f8255f3] qpid\_heartbeat setting in ineffective (LP: #1030430)
- [413c641] Deallocation of fixed IP occurs before security group refresh
leading to potential security issue in error / race conditions
(LP: #1021352)
- [219c5ca] Race condition in network/deallocate\_for\_instance() leads to
security issue (LP: #1021340)
- [f2bc403] cleanup\_file\_locks does not remove stale sentinel files
(LP: #1018586)
- [4c7d671] Deleting Flavor currently in use by instance creates error
(LP: #994935)
- [7e88e39] nova testsuite errors on newer versions of python-boto (e.g.
2.5.2) (LP: #1027984)
- [80d3026] NoMoreFloatingIps: Zero floating ips available after repeatedly
creating and destroying instances over time (LP: #1017418)
- [4d74631] Launching with source groups under load produces lazy load error
(LP: #1018721)
- [08e5128] API 'v1.1/{tenant\_id}/os-hosts' does not return a list of hosts
(LP: #1014925)
- [801b94a] Restarting nova-compute removes ip packet filters (LP: #1027105)
- [f6d1f55] instance live migration should create virtual\_size disk image
(LP: #977007)
- [4b89b4f] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips
quotas returns general uninformative HTTP 500 error (LP: #1021373)
- [6e873bc] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips
quotas returns general uninformative HTTP 500 error (LP: #1021373)
- [7b215ed] Use default qemu-img cluster size in libvirt connection driver
- [d3a87a2] Listing flavors with marker set returns 400 (LP: #956096)
- [cf6a85a] nova-rootwrap hardcodes paths instead of using
/sbin:/usr/sbin:/usr/bin:/bin (LP: #1013147)
- [2efc87c] affinity filters don't work if scheduler\_hints is None
(LP: #1007573)
- [48e5f46] metadata injection is broken in xen (LP: #1022036)
- [25f5bd3] scheduler hang (DOS) possible with
DifferentHostFilter/SameHostFilter (LP: #1017795)
- [1c1b858] cannot umount guestfs (LP: #1013689)
- [835ba4f] not able to get host total memory in xen with libvirt
(LP: #1004298)
- [00e5104] Call to network\_get\_all\_by\_uuids missing 'db' (LP: #986922)
- [4c49df7] [nova][volumes] Exceeding volumes, gigabytes and floating\_ips
quotas returns general uninformative HTTP 500 error (LP: #1021373)
- [19631f3] [nova][volumes] Exceeding volumes quotas logs
"VolumeSizeTooLarge" instead of "VolumeLimitExceeded" (LP: #1020634)
- [b0feaff] Remote arbitrary file corruption / creation flaw via injected
files (LP: #1015531)
- [3cb6e57] NoMoreFixedIps: Zero fixed ips available. Nova seems leaking
them. (LP: #1014769)
- [5d8431b] ram\_allocation\_ratio does not work (LP: #1016273)
- [410060f] test\_get\_console\_output\_file requires sudo NOPASSWD
(LP: #992805)
- [33c2575] Stop/start a KVM instance with volumes attached produces an
error state (LP: #1013782)
- [6c01c01] Backport tox settings to unbreak jenkins jobs.
- [344125f] Set defaultbranch in .gitreview to stable/essex
- [9b789be] floating ips are not disassociated from instances on deletion
(LP: #997763)
- [d89c2f3] qpid timeout causing compute service to crash (LP: #999698)
- [caae0e9] floating ips do not display in 'nova list' after association to
instance (LP: #939122)
- [1dc9f19] impl\_qpid doesn't ACK messages (LP: #1012374)
- [bc621bc] Restarting nova-network removes ip packet filters
(LP: #1000853)
- [7870157] Add caching to openstack.common.cfg
- [27133ee] Firewall rules from nova-compute are not refreshed after host
reboot (LP: #985162)
- [3ee026e] Source group based security group rule without protocol and port
causes failures (LP: #1010514)
- [f0a9f47] [SRU] dns\_domains table mysql charset is 'latin1'. Should be
'utf8' (LP: #993663)
- [cc8fd97] euca-describe-keypair NonExistent returns 200 (LP: #1006664)
- [9f9e9da] Security groups fail to be set correctly if incorrect case is
used for protocol specification (LP: #985184)
-- Adam Gandelman <adamg@canonical.com> Mon, 27 Aug 2012 14:50:40 -0700

| Changed in nova (Ubuntu Precise): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Clint Byrum (clint-fewbar)](https://launchpad.net/~clint-fewbar) wrote on 2012-09-03:  [**Update Released**](/nova/%2Bbug/1015531/comments/46) |  |  | [#46](/nova/%2Bbug/1015531/comments/46) |
| --- | --- | --- | --- |

The verification of this Stable Release Update has completed successfully and the package has now been released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regresssions.

The verification of this Stable Release Update has completed successfully and the package has now been released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regresssions.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-09-27

| Changed in nova: | |
| --- | --- |
| **milestone**: | folsom-2 → 2012.2 |

[Sean Dague (sdague)](https://launchpad.net/~sdague)
on 2014-09-15

| **no longer affects**: | nova/diablo |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1015531/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197663/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197663 "Change patch details")
* [0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3197686/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem-essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3197686 "Change patch details")
* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198461/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198461 "Change patch details")
* [0001-Prevent-file-injection-writing-to-host-filesystem.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3198817/%2Bfiles/0001-Prevent-file-injection-writing-to-host-filesystem.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3198817 "Change patch details")
* [Essex patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203400/%2Bfiles/essex.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203400 "Change patch details")
* [Diablo patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203516/%2Bfiles/diablo.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203516 "Change patch details")
* [diablo2.patch](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3203587/%2Bfiles/diablo2.patch)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3203587 "Change patch details")

* [Add patch](/nova/%2Bbug/1015531/%2Baddcomment?field.patch=on)

## Bug attachments

* [2012.1.3+stable-20120827-4d2a4afe-0ubuntu1.log](https://bugs.launchpad.net/nova/%2Bbug/1015531/%2Battachment/3283238/%2Bfiles/2012.1.3%2Bstable-20120827-4d2a4afe-0ubuntu1.log)
  [Edit](/nova/%2Bbug/1015531/%2Battachment/3283238 "Change attachment details")

* [Add attachment](/nova/%2Bbug/1015531/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.ubuntu.com_dca38090_20250125_034808.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1497-1: Nova vulnerabilities

3 July 2012

Nova could be made to overwrite or corrupt arbitrary files in the
compute host file system.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 11.10](/security/notices?release=oneiric)

## Packages

* [nova](/security/cves?package=nova) - OpenStack Compute cloud infrastructure

## Details

Matthias Weckbecker discovered that, when using the OpenStack API to

setup libvirt-based hypervisors, an authenticated user could inject

files in arbitrary locations on the file system of the host running

Nova. A remote attacker could use this to gain root privileges. This

issue only affects Ubuntu 12.04 LTS. ([CVE-2012-3360](/security/CVE-2012-3360))

Pádraig Brady discovered that an authenticated user could corrupt

arbitrary files of the host running Nova. A remote attacker could

use this to cause a denial of service or possibly gain privileges.

([CVE-2012-3361](/security/CVE-2012-3361))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.04

* [python-nova](https://launchpad.net/ubuntu/%2Bsource/nova)
  -
  [2012.1+stable~20120612-3ee026e-0ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/nova/2012.1%2Bstable~20120612-3ee026e-0ubuntu1.1)

##### Ubuntu 11.10

* [python-nova](https://launchpad.net/ubuntu/%2Bsource/nova)
  -
  [2011.3-0ubuntu6.9](https://launchpad.net/ubuntu/%2Bsource/nova/2011.3-0ubuntu6.9)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2012-3360](/security/CVE-2012-3360)
* [CVE-2012-3361](/security/CVE-2012-3361)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from github.com_a739151f_20250126_054716.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fb0feaffdb2b1c51182b8dce41b367f3449af5dd9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fb0feaffdb2b1c51182b8dce41b367f3449af5dd9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openstack%2Fnova)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openstack](/openstack)
/
**[nova](/openstack/nova)**
Public

* [Notifications](/login?return_to=%2Fopenstack%2Fnova) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fopenstack%2Fnova)
* [Star
   3.1k](/login?return_to=%2Fopenstack%2Fnova)

* [Code](/openstack/nova)
* [Pull requests
  0](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

Additional navigation options

* [Code](/openstack/nova)
* [Pull requests](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

## Commit

[Permalink](/openstack/nova/commit/b0feaffdb2b1c51182b8dce41b367f3449af5dd9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Prevent file injection writing to host filesystem.

[Browse files](/openstack/nova/tree/b0feaffdb2b1c51182b8dce41b367f3449af5dd9)
Browse the repository at this point in the history

```
Fix bug 1015531, [CVE-2012-3360](https://github.com/advisories/GHSA-m454-cm7h-rqhh "CVE-2012-3360"), [CVE-2012-3361](https://github.com/advisories/GHSA-cm54-3vvf-f5p8 "CVE-2012-3361")

This patch prevents the file injection code from writing into the host
filesystem if a user specifies a path for the injected file that
contains '..'. The check is to make sure that the final normalized path
that is about to be written to is within the mounted guest filesystem.

This is a backport of Russell Bryant, Pádraig Brady and Mark
McLoughlin's Folsom patch.

Change-Id: Id8bd6ffb4d878467ba2086d341fce23f2ff5aa0a
```

* Loading branch information

[![@ttx](https://avatars.githubusercontent.com/u/712511?s=40&v=4)](/ttx)

[ttx](/openstack/nova/commits?author=ttx "View all commits by ttx")
committed
Jul 3, 2012

1 parent
[33c2575](/openstack/nova/commit/33c2575ebf9c8022521d36f51b9b31cd41f7f74f)

commit b0feaff

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**66 additions**
and
**25 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* nova

  + tests

    - nova/tests/test\_virt.py
      [test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004)
  + virt/disk

    - nova/virt/disk/api.py
      [api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5)

## There are no files selected for viewing

20 changes: 20 additions & 0 deletions

20
[nova/tests/test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004 "nova/tests/test_virt.py")

Show comments

[View file](/openstack/nova/blob/b0feaffdb2b1c51182b8dce41b367f3449af5dd9/nova/tests/test_virt.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,8 +15,10 @@ |
|  |  | # License for the specific language governing permissions and limitations |
|  |  | # under the License. |
|  |  |  |
|  |  | from nova import exception |
|  |  | from nova import flags |
|  |  | from nova import test |
|  |  | from nova.virt.disk import api as disk\_api |
|  |  | from nova.virt import driver |
|  |  |  |
|  |  | FLAGS = flags.FLAGS |
| Expand Down  Expand Up | | @@ -81,3 +83,21 @@ def test\_swap\_is\_usable(self): |
|  |  | 'swap\_size': 0})) |
|  |  | self.assertTrue(driver.swap\_is\_usable({'device\_name': '/dev/sdb', |
|  |  | 'swap\_size': 1})) |
|  |  |  |
|  |  |  |
|  |  | class TestVirtDisk(test.TestCase): |
|  |  | def test\_check\_safe\_path(self): |
|  |  | ret = disk\_api.\_join\_and\_check\_path\_within\_fs('/foo', 'etc', |
|  |  | 'something.conf') |
|  |  | self.assertEquals(ret, '/foo/etc/something.conf') |
|  |  |  |
|  |  | def test\_check\_unsafe\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_join\_and\_check\_path\_within\_fs, |
|  |  | '/foo', 'etc/../../../something.conf') |
|  |  |  |
|  |  | def test\_inject\_files\_with\_bad\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_inject\_file\_into\_fs, |
|  |  | '/tmp', '/etc/../../../../etc/passwd', |
|  |  | 'hax') |

71 changes: 46 additions & 25 deletions

71
[nova/virt/disk/api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5 "nova/virt/disk/api.py")

Show comments

[View file](/openstack/nova/blob/b0feaffdb2b1c51182b8dce41b367f3449af5dd9/nova/virt/disk/api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -306,20 +306,39 @@ def inject\_data\_into\_fs(fs, key, net, metadata, admin\_password, execute): |
|  |  | \_inject\_admin\_password\_into\_fs(admin\_password, fs, execute=execute) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_file\_into\_fs(fs, path, contents): |
|  |  | absolute\_path = os.path.join(fs, path.lstrip('/')) |
|  |  | def \_join\_and\_check\_path\_within\_fs(fs, \*args): |
|  |  | '''os.path.join() with safety check for injected file paths. |
|  |  |  |
|  |  | Join the supplied path components and make sure that the |
|  |  | resulting path we are injecting into is within the |
|  |  | mounted guest fs. Trying to be clever and specifying a |
|  |  | path with '..' in it will hit this safeguard. |
|  |  | ''' |
|  |  | absolute\_path = os.path.realpath(os.path.join(fs, \*args)) |
|  |  | if not absolute\_path.startswith(os.path.realpath(fs) + '/'): |
|  |  | raise exception.Invalid(\_('injected file path not valid')) |
|  |  | return absolute\_path |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_file\_into\_fs(fs, path, contents, append=False): |
|  |  | absolute\_path = \_join\_and\_check\_path\_within\_fs(fs, path.lstrip('/')) |
|  |  |  |
|  |  | parent\_dir = os.path.dirname(absolute\_path) |
|  |  | utils.execute('mkdir', '-p', parent\_dir, run\_as\_root=True) |
|  |  | utils.execute('tee', absolute\_path, process\_input=contents, |
|  |  | run\_as\_root=True) |
|  |  |  |
|  |  | args = [] |
|  |  | if append: |
|  |  | args.append('-a') |
|  |  | args.append(absolute\_path) |
|  |  |  |
|  |  | kwargs = dict(process\_input=contents, run\_as\_root=True) |
|  |  |  |
|  |  | utils.execute('tee', \*args, \*\*kwargs) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_metadata\_into\_fs(metadata, fs, execute=None): |
|  |  | metadata\_path = os.path.join(fs, "meta.js") |
|  |  | metadata = dict([(m.key, m.value) for m in metadata]) |
|  |  |  |
|  |  | utils.execute('tee', metadata\_path, |
|  |  | process\_input=json.dumps(metadata), run\_as\_root=True) |
|  |  | \_inject\_file\_into\_fs(fs, 'meta.js', json.dumps(metadata)) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_key\_into\_fs(key, fs, execute=None): |
| Expand All | | @@ -328,33 +347,36 @@ def \_inject\_key\_into\_fs(key, fs, execute=None): |
|  |  | key is an ssh key string. |
|  |  | fs is the path to the base of the filesystem into which to inject the key. |
|  |  | """ |
|  |  | sshdir = os.path.join(fs, 'root', '.ssh') |
|  |  | sshdir = \_join\_and\_check\_path\_within\_fs(fs, 'root', '.ssh') |
|  |  | utils.execute('mkdir', '-p', sshdir, run\_as\_root=True) |
|  |  | utils.execute('chown', 'root', sshdir, run\_as\_root=True) |
|  |  | utils.execute('chmod', '700', sshdir, run\_as\_root=True) |
|  |  | keyfile = os.path.join(sshdir, 'authorized\_keys') |
|  |  | key\_data = [ |
|  |  |  |
|  |  | keyfile = os.path.join('root', '.ssh', 'authorized\_keys') |
|  |  |  |
|  |  | key\_data = ''.join([ |
|  |  | '\n', |
|  |  | '# The following ssh key was injected by Nova', |
|  |  | '\n', |
|  |  | key.strip(), |
|  |  | '\n', |
|  |  | ] |
|  |  | utils.execute('tee', '-a', keyfile, |
|  |  | process\_input=''.join(key\_data), run\_as\_root=True) |
|  |  | ]) |
|  |  |  |
|  |  | \_inject\_file\_into\_fs(fs, keyfile, key\_data, append=True) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_net\_into\_fs(net, fs, execute=None): |
|  |  | """Inject /etc/network/interfaces into the filesystem rooted at fs. |
|  |  |  |
|  |  | net is the contents of /etc/network/interfaces. |
|  |  | """ |
|  |  | netdir = os.path.join(os.path.join(fs, 'etc'), 'network') |
|  |  | netdir = \_join\_and\_check\_path\_within\_fs(fs, 'etc', 'network') |
|  |  | utils.execute('mkdir', '-p', netdir, run\_as\_root=True) |
|  |  | utils.execute('chown', 'root:root', netdir, run\_as\_root=True) |
|  |  | utils.execute('chmod', 755, netdir, run\_as\_root=True) |
|  |  | netfile = os.path.join(netdir, 'interfaces') |
|  |  | utils.execute('tee', netfile, process\_input=net, run\_as\_root=True) |
|  |  |  |
|  |  | netfile = os.path.join('etc', 'network', 'interfaces') |
|  |  | \_inject\_file\_into\_fs(fs, netfile, net) |
|  |  |  |
|  |  |  |
|  |  | def \_inject\_admin\_password\_into\_fs(admin\_passwd, fs, execute=None): |
| Expand All | | @@ -379,16 +401,15 @@ def \_inject\_admin\_password\_into\_fs(admin\_passwd, fs, execute=None): |
|  |  | fd, tmp\_shadow = tempfile.mkstemp() |
|  |  | os.close(fd) |
|  |  |  |
|  |  | utils.execute('cp', os.path.join(fs, 'etc', 'passwd'), tmp\_passwd, |
|  |  | run\_as\_root=True) |
|  |  | utils.execute('cp', os.path.join(fs, 'etc', 'shadow'), tmp\_shadow, |
|  |  | run\_as\_root=True) |
|  |  | passwd\_path = \_join\_and\_check\_path\_within\_fs(fs, 'etc', 'passwd') |
|  |  | shadow\_path = \_join\_and\_check\_path\_within\_fs(fs, 'etc', 'shadow') |
|  |  |  |
|  |  | utils.execute('cp', passwd\_path, tmp\_passwd, run\_as\_root=True) |
|  |  | utils.execute('cp', shadow\_path, tmp\_shadow, run\_as\_root=True) |
|  |  | \_set\_passwd(admin\_user, admin\_passwd, tmp\_passwd, tmp\_shadow) |
|  |  | utils.execute('cp', tmp\_passwd, os.path.join(fs, 'etc', 'passwd'), |
|  |  | run\_as\_root=True) |
|  |  | utils.execute('cp', tmp\_passwd, passwd\_path, run\_as\_root=True) |
|  |  | os.unlink(tmp\_passwd) |
|  |  | utils.execute('cp', tmp\_shadow, os.path.join(fs, 'etc', 'shadow'), |
|  |  | run\_as\_root=True) |
|  |  | utils.execute('cp', tmp\_shadow, shadow\_path, run\_as\_root=True) |
|  |  | os.unlink(tmp\_shadow) |
|  |  |  |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b0feaff`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fb0feaffdb2b1c51182b8dce41b367f3449af5dd9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from secunia.com_df7828fd_20250125_034808.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...


