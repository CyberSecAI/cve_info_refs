=== Content from sadgeeksinsnow.blogspot.dk_0a4b50c7_20250125_125033.html ===


# [Sad Geeks In Snow](http://sadgeeksinsnow.blogspot.com/)

Nom Nom Nom Nom; Technology! Nom Nom Nom Nom

## Tuesday, September 11, 2012

### My First Experiences Bug Hunting, Part 1

/\*

*Responsible Disclosure(info): in the following post and future posts I will cover the specifics of my first bug hunt. This has led to six assigned CVEs. One of which is discussed below and it's ID is CVE-2012-3819. I will discuss the other five, and the affected software, once the vendor(s) has had time to assess and determine remediation for the remaining vulnerabilities. CVE-2012-3819 was originally reported to an affected vendor in October of 2011, it was reported (by the author) to the responsible vendor August 2nd of 2012, the responsible vendor has replied stating:*
> "Thank you for the additional
> information. The technical team was able to reproduce the issue and log it as
> issue #5654. I know there are not immediate plans to resolve the issue, however
> it will be reviewed when  the product is again up for renewal." [formatting by me]

*Enough of the boring stuff, let's get to the fun!*

\*/

A couple of years ago I had never even heard the term Bug Hunt. Had never really done any real exploitation what so ever. Technique was something of myths, reverse engineering was something I did to watch bits floating around in memory and that's about it. Maybe I could get a lucky (well 'lucky' after trying 20 different locations) patch in a video game to gain an edge or something. But really, understanding a bug and developing an exploit, was (is?) beyond my caliber.

Then I heard about this so called "Bug Hunting," and figured - what the hell, I have access to software and I like playing with debuggers. Let's see if we can't break some code. And this is where my understanding of the steps involved come in, to my knowledge they involved the following:

1. Install Software
2. ????
3. Win/Exploit

And to me it really does feel like magic, like only a Techno-God could look over some executable and discover a bug and how to exploit it. But I knew there must be a way to find my own bug and make a custom exploit. So I looked toward a few resources. I bought eight books on various forms of information security, from web, to database. And it seems like the favorite type of exploit, the bug hunter's creme of the crop exploit, is the [Stack or Buffer Overflow](https://www.owasp.org/index.php/Buffer_overflow). Armed with a plethora of information, I picked an application with some familiar technology to me. I chose a Web Server/Web App which we use at work, I downloaded the trial and installed it. Then it was time to see where it'd go.

The application has a stand alone web server, the same one found here: [Dart Communications](http://dart.com/web-server-activex-api-library.aspx). The version I was utilizing was version 1.8.0.10 (current as of writing is 1.9.0.0). I loaded the app up and the software began spinning it's wheels. Simple, right?

It does whatever stuff it needs to start up, and then bind()s to an address followed by a listen() for incoming connections. So now what? Step #2 above is a black box to me - I don't really know where to go, or what the hell I'm doing. So I decide to start with the normal use case scenario. I connect to the server and make a valid request by printing the following to a connected socket:
> GET / HTTP/1.1\n\n

Simple enough to do, it's just a quick perl + netcat combo [nifty trick from [Hacking By Erickson, Jon (Google Affiliate Ad)](http://gan.doubleclick.net/gan_click?lid=41000000028007181&pid=UBM9781593271442&adurl=http%3A%2F%2Fwww.cdsbooksdvds.com%2Fproduct.jhtm%3Fsku%3DUBM9781593271442&usg=AFHzDLt497h6l20_KZm4KPoMzSoUMe-uIg&pubid=575985), plus a shameless plug for ad-sense, it is a fantastic book though I swear].
> perl -e 'print "GET / HTTP/1.1\n\n"' | nc server 80

I get a typical "200 OK" response and I think quietly to myself... Then I think about the different pieces of this request. They take the form of '[method] [requested-uri] HTTP/[version]\n\n' which means I can control the method (e.g. GET or POST), the Requested-URI (e.g. / or /index.html), and the HTTP version reported (e.g. 1.1 or 1.0).

So I think to myself, "If I were writing a web app I'd need the file name... would I check the size of the URI in the GET/POST request?"
> perl -e 'print "GET " . "A" x 9999 . " HTTP/1.1\n\n"' | nc server 80

The server responds with a 401/403/404 or whatever. An expected and normal result having fed in garbage data. So I figure what the hell, let's go really huge and see if it survives.
> perl -e 'print "GET " . "A" x 520000 . " HTTP/1.1\n\n"' | nc server 80

Presto! The server crashes and I get a feeling like I might be onto something good. The number I'm showing here was chosen experimentally, I really just kept multiplying by ten. I e-mail the vendor to inform them of the bug and I begin an investigation to see how far down the rabbit hole it goes. The hope is remote arbitrary code exploitation.

***/\*Spoiler Alert\* more CVE-2012-3819 specifics***

*It's denial of service only. Simply put, the Requested URI is copied around in memory, some copies are stored on the stack. After several large copies, they exhaust the available stack space for the process. This yields a Stack Overflow Exception, not to be confused with a buffer overflow. The exception is passed to the controlling process where no handler exists, so the application exits immediately. Additionally the request does not have to be well formed, e.g. a continuous string of repeating 'A's will have the same effect as long as it does not receive the "\n\n" and try to process the request.*
> *perl -e 'print "A" x 520000 . "\n\n"' | nc server 80*

***\*End Alert\*/***

So I load [Ollydbg](http://www.ollydbg.de/) to and take a closer look at the vulnerability, which I'll cover that in a future post, and how it led me to find better and more mature bugs which have real security impacts beyond the utilitarian annoyance of a [Denial of Service](https://www.owasp.org/index.php/Denial_of_Service) condition.

Until then, Hack Safe, Hack Legal, but most of all Hack Fun!

Posted by
Catatonic

at
[5:10 PM](http://sadgeeksinsnow.blogspot.com/2012/09/my-first-experiences-bug-hunting-part-1.html "permanent link")

/\*

*Responsible Disclosure(info): in the following post and future posts I will cover the specifics of my first bug hunt. This has led to six assigned CVEs. One of which is discussed below and it's ID is CVE-2012-3819. I will discuss the other five, and the affected software, once the vendor(s) has had time to assess and determine remediation for the remaining vulnerabilities. CVE-2012-3819 was originally reported to an affected vendor in October of 2011, it was reported (by the author) to the responsible vendor August 2nd of 2012, the responsible vendor has replied stating:*
> "Thank you for the additional
> information. The technical team was able to reproduce the issue and log it as
> issue #5654. I know there are not immediate plans to resolve the issue, however
> it will be reviewed when  the product is again up for renewal." [formatting by me]

*Enough of the boring stuff, let's get to the fun!*

\*/

A couple of years ago I had never even heard the term Bug Hunt. Had never really done any real exploitation what so ever. Technique was something of myths, reverse engineering was something I did to watch bits floating around in memory and that's about it. Maybe I could get a lucky (well 'lucky' after trying 20 different locations) patch in a video game to gain an edge or something. But really, understanding a bug and developing an exploit, was (is?) beyond my caliber.

Then I heard about this so called "Bug Hunting," and figured - what the hell, I have access to software and I like playing with debuggers. Let's see if we can't break some code. And this is where my understanding of the steps involved come in, to my knowledge they involved the following:

1. Install Software
2. ????
3. Win/Exploit

And to me it really does feel like magic, like only a Techno-God could look over some executable and discover a bug and how to exploit it. But I knew there must be a way to find my own bug and make a custom exploit. So I looked toward a few resources. I bought eight books on various forms of information security, from web, to database. And it seems like the favorite type of exploit, the bug hunter's creme of the crop exploit, is the [Stack or Buffer Overflow](https://www.owasp.org/index.php/Buffer_overflow). Armed with a plethora of information, I picked an application with some familiar technology to me. I chose a Web Server/Web App which we use at work, I downloaded the trial and installed it. Then it was time to see where it'd go.

The application has a stand alone web server, the same one found here: [Dart Communications](http://dart.com/web-server-activex-api-library.aspx). The version I was utilizing was version 1.8.0.10 (current as of writing is 1.9.0.0). I loaded the app up and the software began spinning it's wheels. Simple, right?

It does whatever stuff it needs to start up, and then bind()s to an address followed by a listen() for incoming connections. So now what? Step #2 above is a black box to me - I don't really know where to go, or what the hell I'm doing. So I decide to start with the normal use case scenario. I connect to the server and make a valid request by printing the following to a connected socket:
> GET / HTTP/1.1\n\n

Simple enough to do, it's just a quick perl + netcat combo [nifty trick from [Hacking By Erickson, Jon (Google Affiliate Ad)](http://gan.doubleclick.net/gan_click?lid=41000000028007181&pid=UBM9781593271442&adurl=http%3A%2F%2Fwww.cdsbooksdvds.com%2Fproduct.jhtm%3Fsku%3DUBM9781593271442&usg=AFHzDLt497h6l20_KZm4KPoMzSoUMe-uIg&pubid=575985), plus a shameless plug for ad-sense, it is a fantastic book though I swear].
> perl -e 'print "GET / HTTP/1.1\n\n"' | nc server 80

I get a typical "200 OK" response and I think quietly to myself... Then I think about the different pieces of this request. They take the form of '[method] [requested-uri] HTTP/[version]\n\n' which means I can control the method (e.g. GET or POST), the Requested-URI (e.g. / or /index.html), and the HTTP version reported (e.g. 1.1 or 1.0).

So I think to myself, "If I were writing a web app I'd need the file name... would I check the size of the URI in the GET/POST request?"
> perl -e 'print "GET " . "A" x 9999 . " HTTP/1.1\n\n"' | nc server 80

The server responds with a 401/403/404 or whatever. An expected and normal result having fed in garbage data. So I figure what the hell, let's go really huge and see if it survives.
> perl -e 'print "GET " . "A" x 520000 . " HTTP/1.1\n\n"' | nc server 80

Presto! The server crashes and I get a feeling like I might be onto something good. The number I'm showing here was chosen experimentally, I really just kept multiplying by ten. I e-mail the vendor to inform them of the bug and I begin an investigation to see how far down the rabbit hole it goes. The hope is remote arbitrary code exploitation.

***/\*Spoiler Alert\* more CVE-2012-3819 specifics***

*It's denial of service only. Simply put, the Requested URI is copied around in memory, some copies are stored on the stack. After several large copies, they exhaust the available stack space for the process. This yields a Stack Overflow Exception, not to be confused with a buffer overflow. The exception is passed to the controlling process where no handler exists, so the application exits immediately. Additionally the request does not have to be well formed, e.g. a continuous string of repeating 'A's will have the same effect as long as it does not receive the "\n\n" and try to process the request.*
> *perl -e 'print "A" x 520000 . "\n\n"' | nc server 80*

***\*End Alert\*/***

So I load [Ollydbg](http://www.ollydbg.de/) to and take a closer look at the vulnerability, which I'll cover that in a future post, and how it led me to find better and more mature bugs which have real security impacts beyond the utilitarian annoyance of a [Denial of Service](https://www.owasp.org/index.php/Denial_of_Service) condition.

Until then, Hack Safe, Hack Legal, but most of all Hack Fun!

My First Experiences Bug Hunting, Part 1

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=595472175096221442&postID=6570822947709094633&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=595472175096221442&postID=6570822947709094633&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=595472175096221442&postID=6570822947709094633&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=595472175096221442&postID=6570822947709094633&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=595472175096221442&postID=6570822947709094633&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=595472175096221442&postID=6570822947709094633&target=pinterest "Share to Pinterest")

Labels:
[CVE](http://sadgeeksinsnow.blogspot.com/search/label/CVE),
[Exploit](http://sadgeeksinsnow.blogspot.com/search/label/Exploit),
[Hacking](http://sadgeeksinsnow.blogspot.com/search/label/Hacking),
[Overflow](http://sadgeeksinsnow.blogspot.com/search/label/Overflow),
[research](http://sadgeeksinsnow.blogspot.com/search/label/research),
[Security](http://sadgeeksinsnow.blogspot.com/search/label/Security),
[Vulnerabiliy](http://sadgeeksinsnow.blogspot.com/search/label/Vulnerabiliy)

[Newer Post](http://sadgeeksinsnow.blogspot.com/2012/09/communicating-with-basys2-using-adept.html "Newer Post")

[Older Post](http://sadgeeksinsnow.blogspot.com/2012/08/writing-my-first-computer-virus.html "Older Post")

[Home](http://sadgeeksinsnow.blogspot.com/)

## Blog Archive

* ►
  [2023](http://sadgeeksinsnow.blogspot.com/2023/)
  (1)
  + ►
    [March](http://sadgeeksinsnow.blogspot.com/2023/03/)
    (1)

* ►
  [2013](http://sadgeeksinsnow.blogspot.com/2013/)
  (3)
  + ►
    [October](http://sadgeeksinsnow.blogspot.com/2013/10/)
    (1)
  + ►
    [August](http://sadgeeksinsnow.blogspot.com/2013/08/)
    (1)
  + ►
    [February](http://sadgeeksinsnow.blogspot.com/2013/02/)
    (1)

* ▼
  [2012](http://sadgeeksinsnow.blogspot.com/2012/)
  (13)
  + ►
    [December](http://sadgeeksinsnow.blogspot.com/2012/12/)
    (1)
  + ►
    [October](http://sadgeeksinsnow.blogspot.com/2012/10/)
    (1)
  + ▼
    [September](http://sadgeeksinsnow.blogspot.com/2012/09/)
    (7)
    - [Pandora Jacking](http://sadgeeksinsnow.blogspot.com/2012/09/preempting-pandora-to-play-pandemonium.html)
    - [SQL and finding a Floating Point Error](http://sadgeeksinsnow.blogspot.com/2012/09/sql-and-finding-floating-point-error.html)
    - [Writing My First Metasploit Module](http://sadgeeksinsnow.blogspot.com/2012/09/writing-my-first-metasploit-module.html)
    - [Implementing a DEPP interface on a Basys2, part 2](http://sadgeeksinsnow.blogspot.com/2012/09/implementing-depp-interface-on-basys2_12.html)
    - [Implementing a DEPP interface on a Basys2, part 1](http://sadgeeksinsnow.blogspot.com/2012/09/implementing-depp-interface-on-basys2.html)
    - [Communicating with the Basys2 using the Adept SDK](http://sadgeeksinsnow.blogspot.com/2012/09/communicating-with-basys2-using-adept.html)
    - [My First Experiences Bug Hunting, Part 1](http://sadgeeksinsnow.blogspot.com/2012/09/my-first-experiences-bug-hunting-part-1.html)
  + ►
    [August](http://sadgeeksinsnow.blogspot.com/2012/08/)
    (1)
  + ►
    [January](http://sadgeeksinsnow.blogspot.com/2012/01/)
    (3)

* ►
  [2011](http://sadgeeksinsnow.blogspot.com/2011/)
  (3)
  + ►
    [February](http://sadgeeksinsnow.blogspot.com/2011/02/)
    (1)
  + ►
    [January](http://sadgeeksinsnow.blogspot.com/2011/01/)
    (2)

* ►
  [2010](http://sadgeeksinsnow.blogspot.com/2010/)
  (8)
  + ►
    [December](http://sadgeeksinsnow.blogspot.com/2010/12/)
    (2)
  + ►
    [November](http://sadgeeksinsnow.blogspot.com/2010/11/)
    (1)
  + ►
    [October](http://sadgeeksinsnow.blogspot.com/2010/10/)
    (2)
  + ►
    [September](http://sadgeeksinsnow.blogspot.com/2010/09/)
    (3)

## Followers

## Translate

|  |  |
| --- | --- |

Powered by [Blogger](https://www.blogger.com).


