```
{
  "CVE-2012-3479": {
    "related_content": true,
    "summary": "A security flaw exists in GNU Emacs where it incorrectly handles eval forms in local-variable sections when the user option `enable-local-variables` is set to `:safe`, allowing arbitrary code execution.",
    "details": [
      {
        "type": "Mailing List Message",
        "source": "www.openwall.com_475676f7_20250125_181518.html",
        "content": "Paul Ling discovered a security flaw in GNU Emacs's file-local variables code. When the `enable-local-variables` option is set to `:safe`, Emacs should refuse to evaluate `eval` forms. However, due to a bug, it automatically evaluates them. This allows a malicious file to execute arbitrary Emacs Lisp code with the user's permissions. This affects Emacs versions 23.2, 23.3, 23.4, and 24.1. Patches are available for 23.4 and 24.1.",
        "vulnerability_details": {
          "root_cause": "Incorrect handling of eval forms in file-local variable sections when `enable-local-variables` is set to `:safe`.",
          "weaknesses": [
            "Improper restriction of operations within the file-local variables feature.",
            "Failure to refuse evaluation of `eval` forms when set to `:safe`."
          ],
          "impact": "Arbitrary Emacs Lisp code execution with the privileges of the user.",
          "attack_vectors": [
            "Visiting a malicious file with Emacs."
           ],
           "attacker_capabilities": "Requires the victim to open a malicious file with Emacs. Remote or local attacker can create the malicious file."
        }
      },
       {
        "type": "Ubuntu Security Notice",
        "source": "www.ubuntu.com_43fdd513_20250125_181521.html",
        "content": "Ubuntu Security Notice USN-1586-1 addresses vulnerabilities in Emacs. Specifically, it notes that a specially crafted file could allow Emacs to run programs as the user. This includes a flaw discovered by Paul Ling, who found that Emacs incorrectly handles certain eval forms in local-variable sections. This could allow a remote attacker to execute arbitrary Lisp code if a user opens a malicious file. This issue is identified as CVE-2012-3479, and affects Ubuntu 12.04 and 11.10. Updates are provided for the `emacs23-common` and `emacs23` packages.",
        "vulnerability_details": {
          "root_cause": "Incorrect handling of eval forms in local-variable sections.",
          "weaknesses": [
            "Improper handling of eval forms leading to arbitrary code execution."
          ],
          "impact": "Remote attacker can execute arbitrary Lisp code.",
          "attack_vectors": [
            "Opening a specially crafted file with Emacs."
          ],
          "attacker_capabilities": "Requires the victim to open a malicious file with Emacs. The attacker needs to craft this file."
        }
      },
      {
        "type": "Debian Security Advisory",
        "source": "www.debian.org_79c630ff_20250125_181515.html",
        "content": "Debian Security Advisory DSA-2603-1 addresses a programming error in emacs23. Paul Ling discovered that Emacs did not sufficiently restrict the evaluation of Lisp code when enable-local-variables was set to 'safe'. The fix is available in version 23.2+1-7+squeeze1 for stable (squeeze), 23.4+1-4 for testing (wheezy), and unstable (sid). This is identified as CVE-2012-3479.",
         "vulnerability_details": {
          "root_cause": "Insufficient restriction on the evaluation of Lisp code when `enable-local-variables` is set to 'safe'.",
           "weaknesses": [
            "Incorrectly evaluated lisp code when `enable-local-variables` is set to `safe`."
          ],
          "impact": "Arbitrary code execution.",
          "attack_vectors": [
            "Opening a malicious file with Emacs."
          ],
           "attacker_capabilities": "Requires the victim to open a malicious file with Emacs. The attacker needs to craft this file."
        }
      },
      {
        "type": "Slackware Security Advisory",
        "source": "www.slackware.com_e8dae397_20250125_181519.html",
         "content": "Slackware Security Advisory SSA:2012-228-02 announces new emacs packages for Slackware 13.1, 13.37, and -current to fix a security issue. A security flaw exists in the file-local variables code of Emacs. When the `enable-local-variables` option is set to `:safe`, Emacs should not evaluate `eval` forms; however, it does, allowing for arbitrary Emacs Lisp code execution by visiting a malicious file. The bug was discovered by Paul Ling and is identified by CVE-2012-3479. Updated packages are available.",
         "vulnerability_details": {
          "root_cause": "Emacs incorrectly evaluating `eval` forms when `enable-local-variables` is set to `:safe`.",
          "weaknesses": [
            "Failure to properly restrict eval forms within file-local variables.",
            "Improper handling of the `:safe` option."
          ],
          "impact": "Arbitrary Emacs Lisp code execution.",
          "attack_vectors": [
            "Visiting a malicious file with Emacs."
          ],
          "attacker_capabilities": "Requires the victim to open a malicious file with Emacs. The attacker needs to craft this file."
        }
      },
      {
        "type": "openSUSE Security Update",
        "source": "lists.opensuse.org_51f7cedf_20250125_181512.html",
        "content": "openSUSE-SU-2012:1348-1 provides an update for emacs and other packages, addressing a vulnerability that allows arbitrary lisp code execution when 'enable-local-variables' is set to ':safe' (CVE-2012-3479). This also upgrades emacs to version 24.1, with other related bug fixes. This update also impacts gnuplot and ddskk.",
         "vulnerability_details": {
          "root_cause": "Arbitrary Lisp code execution when 'enable-local-variables' is set to ':safe'.",
          "weaknesses": [
            "Inadequate restriction on evaluating Lisp code."
           ],
          "impact": "Arbitrary Lisp code execution.",
           "attack_vectors": [
            "Opening a specially crafted file with Emacs."
          ],
         "attacker_capabilities": "Requires the victim to open a malicious file with Emacs. The attacker needs to craft this file."
        }
      },
      {
       "type": "GNU Bug Report",
        "source": "debbugs.gnu.org_5c84aac8_20250125_181511.html",
        "content": "GNU bug report #12155 details a potential security flaw in Emacs versions 24.1, 23.2, 23.3, and 23.4 related to `enable-local-eval` and `enable-local-variables`.  When `enable-local-variables` is set to `:safe` and `enable-local-eval` is set to `maybe`, the `eval:` forms in local variables are evaluated without querying the user. This permits arbitrary code execution via a specially crafted file. The issue was reported by Paul Ling and fixed in version 24.2.",
         "vulnerability_details": {
          "root_cause": "Incorrect handling of `eval:` forms when `enable-local-variables` is set to `:safe` and `enable-local-eval` is set to `maybe`.",
          "weaknesses": [
            "Failure to properly enforce restrictions on evaluation of `eval:` forms when the `:safe` setting is enabled."
          ],
          "impact": "Automatic execution of arbitrary Emacs Lisp code with the user's privileges.",
          "attack_vectors": [
            "Opening a file with a malicious local-variables section."
          ],
          "attacker_capabilities": "Requires the victim to open a malicious file with Emacs. The attacker needs to craft this file."
        }
      }
    ]
  }
}
```