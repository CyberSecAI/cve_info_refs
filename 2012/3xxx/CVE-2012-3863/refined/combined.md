=== Content from www.debian.org_1e852c06_20250125_064258.html ===


---

[[Date Prev](msg00192.html)][[Date Next](msg00194.html)]
[[Thread Prev](msg00192.html)][[Thread Next](msg00194.html)]
[[Date Index](maillist.html#00193)]
[[Thread Index](threads.html#00193)]

# [SECURITY] [DSA 2550-1] asterisk security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2550-1] asterisk security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 18 Sep 2012 19:18:45 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20120918171845.GA22120%40pisco.westfalen.local)Â [20120918171845.GA22120@pisco.westfalen.local](msg00193.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2550-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
September 18, 2012                     <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : asterisk
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-2186 CVE-2012-3812 CVE-2012-3863 CVE-2012-4737

Several vulnerabilities were discovered in Asterisk, a PBX and telephony
toolkit, allowing privilege escalation in the Asterisk Manager, denial of
service or privilege escalation.

More detailed information can be found in the Asterisk advisories:
<http://downloads.asterisk.org/pub/security/AST-2012-010.html>
<http://downloads.asterisk.org/pub/security/AST-2012-011.html>
<http://downloads.asterisk.org/pub/security/AST-2012-012.html>
<http://downloads.asterisk.org/pub/security/AST-2012-013.html>

For the stable distribution (squeeze), these problems have been fixed in
version 1:1.6.2.9-2+squeeze7.

For the testing distribution (wheezy) and the unstable distribution (sid),
these problems have been fixed in version 1:1.8.13.1~dfsg-1.

We recommend that you upgrade your asterisk packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlBYrLoACgkQXm3vHE4uylqDBgCfTQnp2Z1XZSgJkg1L84SDPnjK
muwAoOINdMCYMfcEc8spGQ7wrCWPKGaR
=FRM+
-----END PGP SIGNATURE-----

```

---



=== Content from secunia.com_ddf1c12f_20250125_064249.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from secunia.com_a02c122e_20250125_064256.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from issues.asterisk.org_9a1f939b_20250125_064300.html ===

[[Home](/)]

| Summary: | ASTERISK-19992: SIP re-INVITEs have no transaction timeout | | |
| --- | --- | --- | --- |
| Reporter: | Steve Davies (one47) | Labels: |  |
| Date Opened: | 2012-06-13 10:51:42 | Date Closed: | 2012-07-03 05:56:20 |
| Priority: | Major | Regression? | No |
| Status: | Closed/Complete | Components: | Channels/chan\_sip/General |
| Versions: | 1.8.11.1 | Frequency ofOccurrence | Occasional |
| RelatedIssues: | | must be completed before resolving | [ASTERISK-20018](/ASTERISK-20018) Asterisk 1.8.14.0 Blockers | | --- | --- | | must be completed before resolving | [ASTERISK-20019](/ASTERISK-20019) Asterisk 10.6.0 Blockers | | | |
| Environment: | SIP with a mis-behaving UA | Attachments: | ( 0) [reinvite\_mk2\_optional.diff](../attachments/19/ASTERISK-19992/00-reinvite_mk2_optional.diff)( 1) [reinvite\_mk2.diff](../attachments/19/ASTERISK-19992/01-reinvite_mk2.diff)( 2) [reinvite\_tweak.diff](../attachments/19/ASTERISK-19992/02-reinvite_tweak.diff)( 3) [trace.txt](../attachments/19/ASTERISK-19992/03-trace.txt)( 4) [uac.xml](../attachments/19/ASTERISK-19992/04-uac.xml)( 5) [uas.xml](../attachments/19/ASTERISK-19992/05-uas.xml) |
| Description: | I believe that this issue exists through all Asterisk versions as it appears to be an omission in the SIP RFCs (I am happy to be corrected if that is not true).  In a "normal" INVITE, we have a global timeout that is specified by the Dial command's ring duration, such that if all else fails, app\_dial or equivalent will stop the channel from existing beyond its natural lifespan. With a Re-INVITE, this is not the case, and I have a scenario where Asterisk leaks RTP ports:  - Inbound call (any channel tech) to SIP endpoint A. - Original call on-hold by SIP A - SIP A calls SIP B, and direct-media call is set up. - SIP A 'REFER's the call to bridge the inbound call to SIP B. - In response to the REFER, Asterisk Re-INVITEs the SIP A and SIP B RTP audio back to Asterisk - SIP A has a bug that means it responds "100 Trying" to the Re-INVITE, but then nothing more.  The 100 Trying clears SIP Timer B, and no other SIP events will occur to progress the Re-INVITE. At this point, Asterisk has a channel that will never timeout, and SIP A considers the channel finished with. This results in us leaking any RTP ports opened for that channel as they are never cleaned up.  This leaves a potential DoS where the original SIP A RTP ports are leaked, and over a period of time can prevent Asterisk and/or the host from working. | | |
| Comments: | By: Steve Davies (one47) 2012-06-13 10:55:42.882-0500Thoughts:   If the SIP A channel sends a 1xx or 18x response to a Re-INVITE packet (A media update, COLP update INVITE, or any other non-initial INVITE), then perhaps we should reset the PVT destroy timer rather than clearing it in handle\_response\_invite() ? A non-initial INVITE ought to be completed in sub-1 second, so I think allowing the default Timer-B 32 seconds would be plenty?   Could this change be applied to any SIP channel that is in AST\_STATE\_UP ? Or is that not a safe way to identify a Re-INVITE rather than an initial INVITE?  ---   By: David Woolley (davidw) 2012-06-14 05:31:43.774-0500We have found that Philips IS3000 can take several seconds to respond to some re-invites.  ---   By: Terry Wilson (twilson) 2012-06-21 17:43:12.403-0500Can't set the private destroy timer because a failed reinvite, per the RFC, should not result in termination of the call.   EDIT: For reference it is in 4 Overview of Operaion. Search for re-invite.  ---   By: David Woolley (davidw) 2012-06-22 04:32:50.177-0500I think failing to send a response to a re-invite constitutes a protocol violation, not a failure of the re-invite. Â I would consider an explicit rejection to be a failure.  ---   By: Terry Wilson (twilson) 2012-06-27 16:41:11.058-0500To my knowledge, it is perfectly allowable to have an arbitrarily long amount of time between an INVITE (re-INVITE or otherwise) and a final response. I think the biggest issue (though we need to handle this situation due to possible attack) is that endpoints shouldn't even bother sending a provisional response on a re-INVITE. It isn't like there is user interaction required. I have applied a patch that cleans up after a failed re-invite. It does not tear down the call, as I still believe that that would be an error.  ---   By: Steve Davies (one47) 2012-06-28 08:44:53.020-0500I just grabbed r369436 from svn - Does this change risk making Asterisk do the wrong thing more often than not?   If during a REFER, Asterisk does a Re-INVITE to grab the media stream, and assuming it is also going to send a BYE on that channel once the media is restored, then with this patch, Asterisk is not going to wait for the Re-INVITE to complete before sending the BYE, which I would assume is "illegal".   What if that new behaviour causes Asterisk to break the UA? I plan to set this test up and if I can prove or deny this theory, will feed it back, but sending a BYE mid INVITE feels wrong.  ---   By: Mark Michelson (mmichelson) 2012-06-28 11:01:21.076-0500I'm having a difficult time parsing the situation you're describing.   "If during a REFER, Asterisk does a Re-INVITE to grab the media stream"   Does "If during a REFER" mean a transfer?   During a transfer, Asterisk does not typically send any BYEs. When a phone sends a REFER in order to transfer a call, an implicit subscription is started, and Asterisk will send NOTIFYs to the transferer to indicate the progress of the transfer. Typically, once the transferer has received a NOTIFY indicating that the call to the transfer target is progressing or that the call to the transfer target has been answered, then the transferer will send a BYE to Asterisk. Asterisk will only send a BYE to the transferer if, within a certain period of time (32 seconds by default), the transferer does not send a BYE to Asterisk.   So basically, your concern should not happen because Asterisk won't send a BYE until 32 seconds have passed without Asterisk receiving a BYE. If the reinvite transaction has not completed in that amount of time, I feel it is safe to send a BYE to the phone without worry of it being premature.   With regards to your concerns of sending a BYE before a reinvite completes as being illegal, it's hard to say for sure because RFC 3261 doesn't always do a good job of clarifying whether certain rules apply only to dialog-creating INVITEs or to mid-dialog INVITEs as well. This sip-implementors mailing list post (thanks Matt Jordan for pointing me to it) argues that sending a BYE while a reinvite transaction is pending should be acceptable: https://lists.cs.columbia.edu/pipermail/sip-implementors/2007-March/015994.html  ---   By: Terry Wilson (twilson) 2012-06-28 11:11:27.885-0500chan\_sip doesn't really have a transaction layer, so I doubt any solution will be perfect. I would be interested in seeing if you can come up with some way to break things with this patch.   We have to send a BYE at some point because we have a dialog established with an INVITE.   Although there is this:  {noformat}  Â  If a UA receives a non-2xx final response to a re-INVITE, the session  Â parameters MUST remain unchanged, as if no re-INVITE had been issued.  Â Note that, as stated in Section 12.2.1.2, if the non-2xx final  Â response is a 481 (Call/Transaction Does Not Exist), or a 408  Â (Request Timeout), or no response at all is received for the re-  Â INVITE (that is, a timeout is returned by the INVITE client  Â transaction), the UAC will terminate the dialog.  {noformat}   which makes it sound like it might be Ok to just hang up the call on a timeout. Of course there \*is\* no timeout specified for an INVITE that has gotten a provisional response. And since we have sent a re-INVITE, and only gotten a provisional response (which could come from a proxy and not the UA) the endpoint is still very possibly going to be expecting a BYE.   In fact, in 15 Terminating a session:  {noformat}  Â  Â  The notion of "hanging up" is not well defined within SIP. Â It is  Â  Â  specific to a particular, albeit common, user interface.  Â  Â  Typically, when the user hangs up, it indicates a desire to  Â  Â  terminate the attempt to establish a session, and to terminate any  Â  Â  sessions already created. Â For the caller's UA, this would imply a  Â  Â  CANCEL request if the initial INVITE has not generated a final  Â  Â  response, and a BYE to all confirmed dialogs after a final  Â  Â  response.  {noformat}   Since we already have a confirmed dialog, a BYE seems appropriate.  ---   By: Steve Davies (one47) 2012-06-29 09:07:36.898-0500bq. Does "If during a REFER" mean a transfer?  Yes, but specifically an attended transfer initiated by a SIP REFER   bq. During a transfer, Asterisk does not typically send any BYEs  Half right. With an attended transfer, Asterisk waits for a BYE on the REFERing channel, but only Asterisk can safely send BYE on the "target" channel, as the UA does not want to destroy the channel before the transfer/masquerade is complete.   On this 2nd channel, Asterisk will (with the r369436 patch applied) send a re-INVITE, and then an immediate BYE. I have traced this on a couple of handsets, and it is messy, causing one UA to send 487 messages to Asterisk until it times out! Calls do appear to be cleared down correctly, but it now makes Asterisk look like it is the "bad actor" IMHO.   I agree that the RFCs are not clear, so I would prefer to be cautious, as Asterisk always has been.   bq. We have to send a BYE at some point because we have a dialog established with an INVITE  I 100% agree, but as per above would prefer to give the UA a chance to close-off the outstanding re-INVITE.    Regarding r369436, the "p->ongoing\_reinvite = 0" code (below) is probably never called:   {noformat}  Â  Â  Â  Â /\* Final response, clear out pending invite \*/  Â  Â  Â  Â if ((resp == 200 || resp >= 300) && p->pendinginvite && seqno == p->pendinginvite) {  Â  Â  Â  Â  Â  Â  Â  Â p->pendinginvite = 0;  Â  Â  Â  Â  Â  Â  Â  Â if (reinvite) {  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â p->ongoing\_reinvite = 0;  Â  Â  Â  Â  Â  Â  Â  Â }  Â  Â  Â  Â }  {noformat}   this is because I believe that in the scenarios we are describing, either the REFER call is flagged for a delayed-bye, so "p->owner" can be null so "reinvite" is false, or \_\_sip\_ack() can be called by handle\_response(), so p->pendinginvite is already 0 before this code is reached.   I fully expect you to be able to punch holes through them, but I am attaching 2 patches. One to update your work with an alternative approach, and a 2nd optional piece which I think might be useful but might not.  ---   By: Terry Wilson (twilson) 2012-07-02 12:59:58.052-0500Steve, when I tried your patch I seemed to get some spurious retransmissions of some INVITEs. Can I get you to look at/try reinvite\_take\_2.diff? It is basically the original patch, but instead of treating a call with an ongoing reinvite as one that doesn't have one, it instead uses the PENDING\_BYE stuff and schedules a call to check\_pendings after 4 seconds to process the BYE later. I picked 4 seconds as a time since if 1) one side of the call is already hung up and 2) it has been 4 seconds and we still haven't gotten a re-invite it seems like that should be plenty of time to delay. We could always bump it up or make it configurable if we had to.  ---   By: Terry Wilson (twilson) 2012-07-02 13:18:54.156-0500Actually, the reinvite\_timeout shouldn't be cancelled on a final response because it is only scheduled from sip\_hangup. If it is scheduled, it \*has\* to run to tear down the call properly.  ---   By: Terry Wilson (twilson) 2012-07-02 17:22:19.369-0500Steve, I changed things around once again. Could you just check out the patch on reviewboard? https://reviewboard.asterisk.org/r/2009/ We need to get a security release out, so if you get a chance please take a look.   The most recent change addresses the issue you warned me about and I just completely missed (the ongoing\_reinvite=0 not getting called) and cleans up immediately after getting a final response to a reinvite after we've already called sip\_hangup so we don't have to rely on the timeout occurring.  ---   By: Steve Davies (one47) 2012-07-03 04:37:14.163-0500I will test this properly today - Sorry about the delay, being on UK time does not help me :) I had one point about the clearing of ongoing\_reinvite, but looking at the reviewboard patch, I think you've addressed that already.   I want to follow the teardown process through to my satisfaction for all of the different cases. Broken UA and working UA.   ---   By: Steve Davies (one47) 2012-07-03 05:53:23.674-0500This looks good to me... My personal preference (that is all it is) would be to re-use sip\_scheddestroy(), rather than creating the new reinvite\_timeout() and reinviteid couplet.   Call it paranoia, but my reasoning is that long-lasting chan\_sip code ensures that any left-over autokillid references are cleaned up, and I would not want to leak a scheduler entry...   Let me see if I can invent a scenario:   - In sip\_hangup(), line 6432, autokillid is cleared and then reinviteid is set.  - check\_pendings() is called by an interim response (183 perhaps?) from the UA. This sets autokillid.  - UA stops sending after this, so we have 2 timers scheduled   Neither sched stops the other. pvt ref counts will prevent this causing a crash-and-burn, so I guess even this paranoid case is safe.   I still plan to backport this for our older 1.6 systems, and will test it again there - I assume 1.6.2 is sufficiently dead that this will not be done by Digium?  ---   By: Terry Wilson (twilson) 2012-07-03 08:46:35.797-0500Correct. As per https://wiki.asterisk.org/wiki/display/AST/Asterisk+Versions 1.6.2 is EOL since April.  ---   By: Steve Davies (one47) 2012-07-03 09:56:36.843-0500No problem on 1.6.2 - That is as expected, but I just spotted a double-BYE on the latest version of the patch for 1.8.   It should be fixed by removing check\_pendings(p) from chan\_sip.c line:30895 (see block below)   {noformat}  Â  Â  Â  Â if ((resp >= 200 && reinvite)) {  Â  Â  Â  Â  Â  Â  Â  Â p->ongoing\_reinvite = 0;  Â  Â  Â  Â  Â  Â  Â  Â if (p->reinviteid > -1) {  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â AST\_SCHED\_DEL\_UNREF(sched, p->reinviteid, dialog\_unref(p, "unref dialog for reinvite timeout because of a final response"));  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â /\* Since we got a final response to the reinvite, but were relying on the reinvite\_timeout  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  \* function to clean up after the reinvite, we need to make sure and call check\_pendings \*/  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â check\_pendings(p);  Â  Â  Â  Â  Â  Â  Â  Â }  Â  Â  Â  Â }  {noformat}   The reason for this... If we receive a "200 OK" for the reINVITE, then SIP\_PENDINGBYE will have been set, and when we call check\_pendings(p) as above a BYE is sent and the flag cleared. The execution then continues, to line 20367, where SIP\_PENDINGBYE is set, then on line 20406, check\_pendings(p) is called again, causing a duplicate BYE.   Sorry I missed that earlier.  ---   By: Terry Wilson (twilson) 2012-07-03 10:10:21.804-0500Hmm, can't just remove the check\_pendings() or the call won't get torn down if we don't get a response. I didn't see a duplicate BYE in my testing, so I'll re-check.  ---   By: Terry Wilson (twilson) 2012-07-03 10:12:07.874-0500It looks like check\_pendings should clear the PENDING\_BYE so we shouldn't get two BYEs?  ---   By: Steve Davies (one47) 2012-07-03 10:16:06.716-0500Let me re-check my line numbers. I think I might have them a bit mixed up in that previous comment.   The check\_pending that I was suggesting that we delete is the new one in the codepath where the reINVITE is being naturally cleared down.   ---   By: Terry Wilson (twilson) 2012-07-03 10:21:47.328-0500Did you actually see an extra BYE in a capture, or did you deduce that that was what was going to happen from looking at the code?  ---   By: Steve Davies (one47) 2012-07-03 10:22:37.047-0500Sorry, there was indeed a typo in my previous post.   I meant to remove the call to check\_pendings() on line 20126 - This is a call that is added as part of this patch, and it is within handle\_response\_invite(). handle\_response\_invite() will call check\_pendings() already, after it sends the final ACK, so the sequence of calls I get is:   chan\_sip.c(20126): check\_pendings() Â  <-- Send BYE, clear flag  chan\_sip.c(20367): If we have no owner, set SIP\_PENDINGBYE  chan\_sip.c(20406): check\_pendings() Â  <-- Send BYE, clear flag   The test on line 20367 is "true" in my test case of a SIP REFER attended transfer, so I get the duplicate BYE.  ---   By: Steve Davies (one47) 2012-07-03 10:25:01.577-0500I saw the double-BYE on a "sip debug ip x.x.x.x"  ---   By: Terry Wilson (twilson) 2012-07-03 10:49:16.243-0500If I remove the new check\_pendings(), but leave the rest of the patch alone I don't even get a BYE at all with a normal directmedia+atxfer call. Does removing the line actually work for you when you test it?  ---   By: Terry Wilson (twilson) 2012-07-03 10:50:38.071-0500My situation SIP/1003 calls SIP/1001. SIP/1001 atxfers SIP/1003 to SIP/1002. Later, SIP/1003 hangs up.  ---   By: Steve Davies (one47) 2012-07-03 10:58:03.297-0500Perhaps my patch is not clean. I'll checkout 1.8 branch and re-patch it.  ---   By: Terry Wilson (twilson) 2012-07-03 11:29:28.369-0500In fact, even without either patch applied, waiting a minute after hanging up an attended transfer w/ directmedia and running sip show channels shows a dialog that never gets destroyed:   {noformat}  \*CLI> sip show channels  Peer Â  Â  Â  Â  Â  Â  User/ANR Â  Â  Â  Â  Call ID Â  Â  Â  Â  Â Format Â  Â  Â  Â  Â  Hold Â  Â  Last Message Â  Â Expiry Â  Â  Peer Â  Â  Â   172.16.61.1 Â  Â  Â 1001 Â  Â  Â  Â  Â  Â  3ab934f2309e359 Â 0x0 (nothing) Â  Â Yes Â  Â  Â Tx: ACK Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 1001  {noformat}   It looks like Eyebeam, which I'm using as my tranferer, ends up sending back a 488 to the re-INVITE that Asterisk sends right before hang up. So my testing platform may be weird. With the patch, things get torn down but Eyebeam still acts a little weird. I'll try doing the transfer with something else.  ---   By: Steve Davies (one47) 2012-07-03 11:54:20.025-0500I have experienced Eyebeam weirdness previously. It does attended transfers "backwards" for want of a better description.   Attached is a SIP DEBUG output using a freshly patched/rebuilt tree (the version number in the packets is faked, this IS branch/1.8)  ---   By: Terry Wilson (twilson) 2012-07-03 11:54:43.205-0500Ok, switching from Eyebeam seems to give me the results that you show. Eyebeam is just behaving badly on the re-INVITE in general which was totally screwing up my results. Removing the check\_pendings() does seem to be the appropriate action. I shall do so. Thanks!  ---   By: Terry Wilson (twilson) 2012-07-03 12:07:58.141-0500I have committed yet again, removing the check\_pendings(). Please, oh please let this be the last issue with this issue. :)  ---   By: Terry Wilson (twilson) 2012-07-03 12:35:05.109-0500I would also like to point out how humorous it is that the only thing standing between me and taking off early for the US Independence Day holiday is a person from the UK. :)  ---   By: Steve Davies (one47) 2012-07-04 10:43:54.741-0500Guess what! See the attached patch. I have included explanations in the patch for these tweaks.   On 3rd July, I was concentrating on the working UA, and we managed to leave the actual fix for a broken UA behind as a result.   I have tested this latest patch with both a broken and working UA... so far so good!  ---   By: Terry Wilson (twilson) 2012-07-05 08:32:15.348-0500It currently works for the broken case that my tests cover. I have sipp scenarios which I will attach showing what I am testing. Basically a UAC that does INVITE, get 180/200, send ACK, receive reINVITE, send 100, pause send BYE recv 200. On the UAS send 180/200, recv ACK, recv reINVITE, send 100. After 32-seconds one side is torn down. After another few seconds the other side is torn down.   What is the case that doesn't work for you?  ---   By: Terry Wilson (twilson) 2012-07-05 09:27:33.876-0500I've also tried where the UAS sends the BYE after a pause. Both dialogs still get torn down in my test. One, a few seconds after the other.  ---   By: Steve Davies (one47) 2012-07-05 10:09:17.396-0500The currently checked-in patch had 2 issues in my testing. I hope the following makes sense. Basically I added about 20 extra warning messages into the timer code to see what was happening.   1) For the Okay UA case where no 1xx packet sent (INVITE/OK/ACK):   This works 100% fine. My trace shows:   {noformat}  > reINVITE  < 200 OK (invite)  > ACK  > BYE  < 200 OK (bye)  {noformat}   2) For the Okay UA case, 1xx packet sent (INVITE/Trying/OK/ACK):   If a "100 Trying" is sent in response to the reINVITE, then check\_pendings() is called when it arrives, and because we are an "ongoing\_reinvite" we allow the BYE to be sent mid-transaction. This BYE is sent even though the UA is about to send a "200 OK". This "early BYE" is one of the symptoms we are trying to avoid, or I was anyway :) This early-BYE does upset our UA, which does send a "100 Trying".   The reINVITE 200 OK and ACK do happen, so the pvt is cleared down fine.   The trace I got was:   {noformat}  > reINVITE  < 100 Trying (invite)  > BYE Â  Â  Â  Â  Â  Â  Â  Â  Â <--- too soon, UA gets confused.  < 200 OK (invite)  > ACK  < 487 Cancel (invite) Â <--- Perhaps UA sees "BYE" instead of "ACK" ?  < 487 Cancel (invite)  < 487 Cancel (invite)  < 487 Cancel (invite)  etc.  {noformat}   3) For the Broken UA case (INVITE/Trying... Dead air):   It starts as per 2) above,... Asterisk receives the "100 Trying", and immediately sends "BYE" but because the 200 OK and ACK never happen, when \_\_sip\_autodestroy() is eventually called for final cleanup pvt->packets is non-empty, and the last method is stuck on INVITE, so \_\_sip\_autodestroy just retries forever.   At least that is what happened here.   {noformat}  > reINVITE  < 100 Trying (invite)  > BYE Â  Â  Â  Â  Â  <---- THIS is the difference!  < 200 OK (bye)  {noformat}   "sip show channels" showed a stuck channel still. Debug showed \_\_sip\_autodestroy being called every 10 seconds on this pvt.   NOTE: I just added the "THIS is the difference!" comment. If the UA still responds to the BYE, then the pvt lastmsg is changed from BYE back to the outstanding INVITE, and \_\_sip\_autodestroy gets stuck.    With my PROPOSED patch I get:   1) Same result.   {noformat}  > reINVITE  < 200 OK (invite)  > ACK  > BYE  < 200 OK (bye)  {noformat}   2) BYE waits until after reINVITE   {noformat}  > reINVITE  < 100 Trying (invite)  < 200 OK (invite) Â  Â  Â <--- Clears reinvite timer  > ACK  > BYE Â  Â  Â  Â  Â  Â  Â  Â  Â <--- Happens here naturally.  < 200 OK (bye)  {noformat}   3) reINVITE timer expires, BYE is sent, all cleans up.   {noformat}  > reINVITE  < 100 Trying (invite)  Â (pause for new reinvite timer here)  > BYE  < 200 OK (bye)  Â (pause for \_\_sip\_autodestroy here)  {noformat}   "sip show channels" shows clean.    As always I fully expect you to be able to find a flaw in all this ;)  ---   By: Terry Wilson (twilson) 2012-07-05 10:23:01.405-0500I'll try to find time sometime to look at this, but mmichelson may have to take. I'm not really working today or tomorrow and am about to hop on a motorcycle and ride about 250 miles to get home. So this is still a re-INVITE in the context of an attended transfer that you are seeing issues?  ---   By: Steve Davies (one47) 2012-07-05 10:39:42.668-0500Yes, the context is the same as originally, so there are 2 legs. 1st leg handles the "REFER/Accept/NOTIFY/BYE/OK" normally, then the second leg gets the reINVITE sequence above, and proceeds well or badly depending on nastyness of the UA.   FYI for the purposes of reproducing the issue, I am testing this with:   Bad UA = Aastra 55i, 2.6.0 firmware  Good UA = Aastra 55i, 3.2.2 firmware   So I am not just making this stuff up :)  ---   By: Mark Michelson (mmichelson) 2012-07-05 11:11:34.122-0500I think the reason why Terry wasn't seeing the bad behavior is that the SIPp scenarios he is using are not testing transfers so much as the general reinvite case. In Steve's case, the SIP\_PENDINGBYE flag is being set and in Terry's, it's not. This means that when the 100 Trying is received, Steve sees Asterisk behave badly by sending a BYE out immediately whereas Terry does not. I'm going to have a look at Steve's patch in more detail to see if it's the right way to move forward. I suspect it is though.  ---   By: Mark Michelson (mmichelson) 2012-07-05 11:38:45.370-0500I think Steve's latest patch has it right.   If the reinvite times out with no pending BYE, things just move on. If the reinvite times out with a BYE pending, though, then Asterisk will send a BYE.  --- | | |



=== Content from downloads.asterisk.org_c49c1531_20250125_064245.html ===


Asterisk
Project Security Advisory - AST-2012-010

| **Product** | Asterisk |
| **Summary** | Possible resource leak on uncompleted re-invite transactions |
| **Nature of Advisory** | Denial of Service |
| **Susceptibility** | Remote authenticated sessions |
| **Severity** | Minor |
| **Exploits Known** | No |
| **Reported On** | June 13, 2012 |
| **Reported By** | Steve Davies |
| **Posted On** | July 5, 2012 |
| **Last Updated On** | July 6, 2012 |
| **Advisory Contact** | Terry Wilson <twilson@digium.com> |
| **CVE Name** | CVE-2012-3863 |

| **Description** | If Asterisk sends a re-invite and an endpoint responds to the re-invite with a provisional response but never sends a final response, then the SIP dialog structure is never freed and the RTP ports for the call are never released. If an attacker has the ability to place a call, they could create a denial of service by using all available RTP ports. |

| **Resolution** | A re-invite that receives a provisional response without a final response is detected and properly cleaned up at hangup. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 1.8.x | All versions |
| Asterisk Open Source | 10.x | All versions |
| Asterisk Business Edition | C.3.x | All versions |
| Certified Asterisk | 1.8.11-certx | All versions |
| Asterisk Digiumphones | 10.x.x-digiumphones | All versions |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 1.8.13.1, 10.5.2 |
| Asterisk Business Edition | C.3.7.5 |
| Certified Asterisk | 1.8.11-cert4 |
| Asterisk Digiumphones | 10.5.2-digiumphones |

| **Patches** | |
| **URL** | **Revision** |
| [http://downloads.asterisk.org/pub/security/AST-2012-010-1.8.diff](http://downloads.asterisk.org/pub/security/AST-2012-009-10.diff) | Asterisk 1.8 |
| [http://downloads.asterisk.org/pub/security/AST-2012-010-10.diff](http://downloads.asterisk.org/pub/security/AST-2012-009-10.diff) | Asterisk 10 |

| **Links** | https://issues.asterisk.org/jira/browse/ASTERISK-19992 |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2012-010.pdf and http://downloads.digium.com/pub/security/AST-2012-010.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| 06/27/2012 | Terry Wilson | Initial Release |
| 07/06/2012 | Matt Jordan | Added CVE |

Asterisk
Project Security Advisory - AST-2012-010
Copyright
Ã‚Â© 2012
Digium, Inc. All Rights Reserved.
Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.


