=== Content from bugzilla.redhat.com_a1813e38_20250126_100342.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2012-3419)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2012-3419)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2012-3419)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841702

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841702**](show_bug.cgi?id=841702)
(CVE-2012-3419)
- [CVE-2012-3419](https://access.redhat.com/security/cve/CVE-2012-3419) pcp: privileged information diclosure flaw

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-3419 pcp: privileged information diclosure flaw

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-3419 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [840905](show_bug.cgi?id=840905 "CLOSED ERRATA - pmcd /proc information disclosure") [848451](show_bug.cgi?id=848451) [848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]") [848630](show_bug.cgi?id=848630) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [841708](show_bug.cgi?id=841708) | | TreeView+ | [depends on](buglist.cgi?bug_id=841702&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841702&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-19 22:32 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:54 UTC ([History](show_activity.cgi?id=841702)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  fche fweimer kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp 3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-01-22 16:57:23 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841702#c0)  Vincent Danen    2012-07-19 22:32:54 UTC  ``` Florian Weimer of the Red Hat Product Security Team discovered that pmcd (the PCP (Performance Co-Pilot) performance metrics collector daemon) exports part of the /proc file system, including privileged information that could be used to aid in bypassing ASLR, as well as full commandline information on running programs.   ```  [Comment 2](show_bug.cgi?id=841702#c2)  Huzaifa S. Sidhpurwala    2012-08-16 04:27:56 UTC  ``` Upstream patches:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=c20319d064af66dc5902661a3f05dccb24d7d177>  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=279950ec0f5bb70967b2d5260ac7f075b8187ca1>  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=8ff4984fee93bab09ea5c68b7ee18d1ab715bea1>  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=372b1b0d34ae2a0e1df5b6f4a6d2b1a54c90bef3>  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=b28bb3bd72ef9d6bd538d991efec34f65374b7df>  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=f15378821b2d53ad00a8083653ea3ab4f8e63070>  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=228d75bc7131251977df5ab33551e666920cfca9>  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=d9c696f1e999ef22828d7b1485634b0998573d9f>  This issue has been addressed in pcp-3.6.5   ```  [Comment 4](show_bug.cgi?id=841702#c4)  Huzaifa S. Sidhpurwala    2012-08-16 04:45:41 UTC  ``` Created pcp tracking bugs for this issue  Affects: epel-all [[bug 848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]")]   ```  [Comment 5](show_bug.cgi?id=841702#c5)  Huzaifa S. Sidhpurwala    2012-08-17 04:52:05 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ```  [Comment 6](show_bug.cgi?id=841702#c6)  Fedora Update System    2012-08-20 10:54:39 UTC  ``` pcp-3.6.5-1.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 7](show_bug.cgi?id=841702#c7)  Fedora Update System    2012-08-20 10:57:10 UTC  ``` pcp-3.6.5-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 8](show_bug.cgi?id=841702#c8)  Fedora Update System    2012-08-21 18:34:20 UTC  ``` pcp-3.6.5-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=841702#c9)  Fedora Update System    2012-08-21 18:38:08 UTC  ``` pcp-3.6.5-1.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 10](show_bug.cgi?id=841702#c10)  Fedora Update System    2012-09-18 00:00:58 UTC  ``` pcp-3.6.5-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841702&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.debian.org_546a152f_20250125_155103.html ===


---

[[Date Prev](msg00173.html)][[Date Next](msg00175.html)]
[[Thread Prev](msg00173.html)][[Thread Next](msg00175.html)]
[[Date Index](maillist.html#00174)]
[[Thread Index](threads.html#00174)]

# [SECURITY] [DSA 2533-1] pcp security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2533-1] pcp security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Thu, 23 Aug 2012 21:39:13 +0200
* *Message-id*: <[[🔎]](/msgid-search/876289gzz2.fsf%40mid.deneb.enyo.de) [876289gzz2.fsf@mid.deneb.enyo.de](msg00174.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2533-1                   security@debian.org
<http://www.debian.org/security/>                            Florian Weimer
August 23, 2012                        <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : pcp
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421

It was discovered that Performance Co-Pilot (pcp), a framework for
performance monitoring, contains several vulnerabilites.

CVE-2012-3418
	Multiple buffer overflows in the PCP protocol decoders can
	cause PCP clients and servers to crash or, potentially,
	execute arbitrary code while processing crafted PDUs.

CVE-2012-3419
	The "linux" PMDA used by the pmcd daemon discloses sensitive
	information from the /proc file system to unauthenticated
	clients.

CVE-2012-3420
	Multiple memory leaks processing crafted requests can cause
	pmcd to consume large amounts of memory and eventually crash.

CVE-2012-3421
	Incorrect event-driven programming allows malicious clients to
	prevent other clients from accessing the pmcd daemon.

To address the information disclosure vulnerability, CVE-2012-3419, a
new "proc" PMDA was introduced, which is disabled by default.  If you
need access to this information, you need to enable the "proc" PMDA.

For the stable distribution (squeeze), this problem has been fixed in
version 3.3.3-squeeze2.

For the unstable distribution (sid), this problem has been fixed in
version 3.6.5.

We recommend that you upgrade your pcp packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJQNoiAAAoJEL97/wQC1SS+RZkH/jWSrAvDXic16J897CzMaNQf
EseDAqXTG9ew01Pw6PHgmNa+XWqHgS7e5dOS/cyJ/QCkNr5OzIcnw6HN4FDOSQQe
gW3n4cAxhcKIynhXPhBK7Ja/RyFG5Y4+8XEnM14wNXk+8cXd4y2x7DtJDUm3eFuw
pI2+vlP670N7yy0xKNSD/YxbHCYms2tcKlSX8E2XokXM3gYlg1dSg6xA3AIvLPPm
4vMvRZE9wWrdMAFh6HocNIE/BR70lhBzmd4pTMMVIULdPwRFk/jovBzM3YpwkYeF
zub0g+77hmp2lc+PhzauAL5sAJ2/Ms6AG37bIlSkiFy0yPb+9g3V0Zcn8h4uum4=
=4hVC
-----END PGP SIGNATURE-----

```

---



=== Content from lists.opensuse.org_d84fdf10_20250125_155057.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZMGVGWSRI2WVF33NGJGK46METMYWUBMB/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZMGVGWSRI2WVF33NGJGK46METMYWUBMB/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZMGVGWSRI2WVF33NGJGK46METMYWUBMB/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZMGVGWSRI2WVF33NGJGK46METMYWUBMB/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/ZMGVGWSRI2WVF33NGJGK46METMYWUBMB/#ZMGVGWSRI2WVF33NGJGK46METMYWUBMB)

# [security-announce] SUSE-SU-2013:0190-1: important: Security update for pcp

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

23 Jan
2013

23 Jan
'13

19:04

SUSE Security Update: Security update for pcp
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2013:0190-1
Rating: important
References: #732763 #775009 #775010 #775011 #775013 #782967
Cross-References: CVE-2012-3418 CVE-2012-3419 CVE-2012-3420
CVE-2012-3421
Affected Products:
SUSE Linux Enterprise Software Development Kit 11 SP2
SUSE Linux Enterprise Server 11 SP2 for VMware
SUSE Linux Enterprise Server 11 SP2
SUSE Linux Enterprise Server 10 SP4
SUSE Linux Enterprise Desktop 11 SP2
SUSE Linux Enterprise Desktop 10 SP4
SLE SDK 10 SP4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that solves four vulnerabilities and has two
fixes is now available. It includes two new package
versions.
Description:
pcp was updated to version 3.6.10 which fixes security
issues and also brings a lot of new features.
\*
Update to pcp-3.6.10.
o Transition daemons to run under an unprivileged
account. o Fixes for security advisory CVE-2012-5530:
tmpfile flaws; (bnc#782967). o Fix pcp(1) command
short-form pmlogger reporting. o Fix pmdalogger error
handling for directory files. o Fix pmstat handling of odd
corner case in CPU metrics. o Correct the python ctype used
for pmAtomValue 32bit ints. o Add missing RPM spec
dependency for python-ctypes. o Corrections to pmdamysql
metrics units. o Add pmdamysql slave status metrics. o
Improve pmcollectl error messages. o Parameterize
pmcollectl CPU counts in interrupt subsys. o Fix generic
RPM packaging for powerpc builds. o Fix python API use of
reentrant libpcp string routines. o Python code backporting
for RHEL5 in qa and pmcollectl. o Fix edge cases in
capturing interrupt error counts.
\*
Update to pcp-3.6.9.
o Python wrapper for the pmimport API o Make
sar2pcp work with the sysstat versions from RHEL5, RHEL6,
and all recent Fedora versions (which is almost all current
versions of sysstat verified). o Added a number of
additional metrics into the importer for people starting to
use it to analyse sar data from real customer incidents. o
Rework use of C99 "restrict" keyword in pmdalogger (Debian
bug: 689552) o Alot of work on the PCP QA suite, special
thanks to Tomas Dohnalek for all his efforts there. o Win32
build updates o Add "raw" disk active metrics so that
existing tools like iostat can be emulated o Allow sar2pcp
to accept XML input directly (.xml suffix), allowing it to
not have to run on the same platform as the sadc/sadf that
originally generated it. o Add PMI error codes into the
PCP::LogImport perl module. o Fix a typo in pmiUnits man
page synopsis section o Resolve pmdalinux ordering issue in
NUMA/CPU indom setup (Redhat bug: 858384) o Remove unused
pmcollectl imports (Redhat bug: 863210) o Allow event
traces to be used in libpcp interpolate mode
\*
Update to pcp-3.6.8.
o Corrects the disk/partition identification for
the MMC driver, which makes disk indom handling correct on
the Raspberry Pi (<http://www.raspberrypi.org/>) o Several
minor/basic fixes for pmdaoracle. o Improve pmcollectl
compatibility. o Make a few clarifications to pmcollectl.1.
o Improve python API test coverage. o Numerous updates to
the test suite in general. o Allow pmda Install scripts to
specify own dso name again. o Reconcile spec file
differences between PCP flavours. o Fix handling of
multiple contexts with a remote namespace. o Core socket
interface abstractions to support NSS (later). o Fix man
page SYNOPSIS section for pmUnpackEventRecords. o Add
--disable-shared build option for static builds.
\*
Update to pcp-3.6.6.
o Added the python PMAPI bindings and an initial
python client in pmcollectl. Separate, new package exists
for python libs for those platforms that split out packages
(rpm, deb). o Added a pcp-testsuite package for those
platforms that might want this (rpm, deb again, mainly) o
Re-introduced the pcp/qa subdirectory in pcp and deprecated
the external pcpqa git tree. o Fix potential buffer
overflow in pmlogger host name handling. o Reworked the
configure --prefix handling to be more like the rest of the
open source world. o Ensure the \_\_pmDecodeText ident
parameter is always set Resolves Red Hat bugzilla bug
#841306.
Security Issue references:
\* CVE-2012-3418
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3418>

...

\* CVE-2012-3419
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3419>

...

\* CVE-2012-3420
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3420>

...

\* CVE-2012-3421
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3421>

...

Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Software Development Kit 11 SP2:
zypper in -t patch sdksp2-libpcp3-7221
- SUSE Linux Enterprise Server 11 SP2 for VMware:
zypper in -t patch slessp2-libpcp3-7221
- SUSE Linux Enterprise Server 11 SP2:
zypper in -t patch slessp2-libpcp3-7221
- SUSE Linux Enterprise Desktop 11 SP2:
zypper in -t patch sledsp2-libpcp3-7221
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Software Development Kit 11 SP2 (i586 ia64 ppc64 s390x x86\_64) [New Version: 3.6.10]:
libpcp3-3.6.10-0.3.1
pcp-3.6.10-0.3.1
pcp-devel-3.6.10-0.3.1
pcp-import-iostat2pcp-3.6.10-0.3.1
pcp-import-mrtg2pcp-3.6.10-0.3.1
pcp-import-sar2pcp-3.6.10-0.3.1
pcp-import-sheet2pcp-3.6.10-0.3.1
perl-PCP-LogImport-3.6.10-0.3.1
perl-PCP-LogSummary-3.6.10-0.3.1
perl-PCP-MMV-3.6.10-0.3.1
perl-PCP-PMDA-3.6.10-0.3.1
- SUSE Linux Enterprise Server 11 SP2 for VMware (i586 x86\_64) [New Version: 2013.1.7]:
permissions-2013.1.7-0.3.1
- SUSE Linux Enterprise Server 11 SP2 (i586 ia64 ppc64 s390x x86\_64) [New Version: 2013.1.7]:
permissions-2013.1.7-0.3.1
- SUSE Linux Enterprise Server 10 SP4 (i586 ia64 ppc s390x x86\_64) [New Version: 2013.1.7 and 3.6.10]:
libpcp3-3.6.10-0.5.1
pcp-3.6.10-0.5.1
pcp-import-iostat2pcp-3.6.10-0.5.1
pcp-import-mrtg2pcp-3.6.10-0.5.1
pcp-import-sar2pcp-3.6.10-0.5.1
pcp-import-sheet2pcp-3.6.10-0.5.1
perl-PCP-LogImport-3.6.10-0.5.1
perl-PCP-LogSummary-3.6.10-0.5.1
perl-PCP-MMV-3.6.10-0.5.1
perl-PCP-PMDA-3.6.10-0.5.1
permissions-2013.1.7-0.5.1
- SUSE Linux Enterprise Desktop 11 SP2 (i586 x86\_64) [New Version: 2013.1.7]:
permissions-2013.1.7-0.3.1
- SUSE Linux Enterprise Desktop 10 SP4 (i586 x86\_64) [New Version: 2013.1.7]:
permissions-2013.1.7-0.5.1
- SLE SDK 10 SP4 (i586 ia64 ppc s390x x86\_64) [New Version: 3.6.10]:
libpcp3-3.6.10-0.5.1
pcp-3.6.10-0.5.1
pcp-devel-3.6.10-0.5.1
pcp-import-iostat2pcp-3.6.10-0.5.1
pcp-import-mrtg2pcp-3.6.10-0.5.1
pcp-import-sar2pcp-3.6.10-0.5.1
pcp-import-sheet2pcp-3.6.10-0.5.1
perl-PCP-LogImport-3.6.10-0.5.1
perl-PCP-LogSummary-3.6.10-0.5.1
perl-PCP-MMV-3.6.10-0.5.1
perl-PCP-PMDA-3.6.10-0.5.1
References:
<http://support.novell.com/security/cve/CVE-2012-3418.html>
<http://support.novell.com/security/cve/CVE-2012-3419.html>
<http://support.novell.com/security/cve/CVE-2012-3420.html>
<http://support.novell.com/security/cve/CVE-2012-3421.html>
<https://bugzilla.novell.com/732763>
<https://bugzilla.novell.com/775009>
<https://bugzilla.novell.com/775010>
<https://bugzilla.novell.com/775011>
<https://bugzilla.novell.com/775013>
<https://bugzilla.novell.com/782967>
[http://download.novell.com/patch/finder/?keywords=51012200090dff3a8a3a0cbcae...](http://download.novell.com/patch/finder/?keywords=51012200090dff3a8a3a0cbcae5a4be2)
[http://download.novell.com/patch/finder/?keywords=86d59a2714828a99a56a3fdba3...](http://download.novell.com/patch/finder/?keywords=86d59a2714828a99a56a3fdba3660c73)
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZMGVGWSRI2WVF33NGJGK46METMYWUBMB/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/ZMGVGWSRI2WVF33NGJGK46METMYWUBMB/#ZMGVGWSRI2WVF33NGJGK46METMYWUBMB)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.openwall.com_62b8b138_20250125_155104.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2012/08/14/1) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <502C7E3A.6090405@redhat.com>
Date: Thu, 16 Aug 2012 10:29:38 +0530
From: Huzaifa Sidhpurwala <huzaifas@...hat.com>
To: oss-security@...ts.openwall.com
Subject: pcp: Multiple security flaws

Hi All,

Multiple security flaws in pcp were discovered by Florian Weimer of the
Red Hat Product Security Team. These issues have been addressed in
pcp-3.6.5.

Details about the flaws and upstream patches are available in the
following Red Hat bugs.

<https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-3418>
<https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-3419>
<https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-3420>
<https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-3421>

--
Huzaifa Sidhpurwala / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_25fba6ed_20250125_155105.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D840822)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D840822)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D840822)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 840822

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 840822**](show_bug.cgi?id=840822)
- Crash in \_\_pmDecodeCreds decoding crafted PDUs

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Crash in \_\_pmDecodeCreds decoding crafted PDUs

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nathan Scott | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=840822&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=840822&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-17 09:59 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 03:52 UTC ([History](show_activity.cgi?id=840822)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  fche kenj mgoodwin nathans security-response-team vdanen | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 03:52:18 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**preliminary patch to \_\_pmDecodeCreds to fix this**](attachment.cgi?id=598767 "View the content of the attachment") (854 bytes, patch)  [2012-07-18 00:30 UTC](#attach_598767 "Go to the comment associated with the attachment"), Mark Goodwin | *no flags* | [Details](attachment.cgi?id=598767&action=edit) | [Diff](attachment.cgi?id=598767&action=diff) | | [**Updated patch to address pcp credentials pdu buffer overflow exploit**](attachment.cgi?id=599108 "View the content of the attachment") (1.45 KB, patch)  [2012-07-19 10:18 UTC](#attach_599108 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=599108&action=edit) | [Diff](attachment.cgi?id=599108&action=diff) | | [View All](attachment.cgi?bugid=840822&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=840822#c0)  Florian Weimer    2012-07-17 09:59:48 UTC  ``` pmcd (and probably others) in pcp-3.6.3 crash when decoding crafted PDUs where the numcreds field exceeds the number of elements actually contained in the PDU.  On 32-bit architectures, the size passed to malloc can be too small, leading to a heap-based buffer overflow.  On 64-bit architectures, the multiplication is performed with 64 bits, so no overflow occurs, and the crash happens because __pmDecodeCreds reads beyond the end of an allocated buffer.  pmcd runs with root privileges and starts automatically when the pcp package is installed.  It listens on 0.0.0.0 and does not require authentication.   ```  [Comment 8](show_bug.cgi?id=840822#c8)  Mark Goodwin    2012-07-18 00:30:25 UTC  ``` Created [attachment 598767](attachment.cgi?id=598767&action=diff "preliminary patch to __pmDecodeCreds to fix this") [[details]](attachment.cgi?id=598767&action=edit "preliminary patch to __pmDecodeCreds to fix this") preliminary patch to __pmDecodeCreds to fix this   Attached preliminary patch from Nathan Scott (upstream). Has been tested against the reproducer script.   ```  [Comment 9](show_bug.cgi?id=840822#c9)  Florian Weimer    2012-07-18 06:54:43 UTC  ``` (In reply to [comment #8](show_bug.cgi?id=840822#c8)) > Created [attachment 598767](attachment.cgi?id=598767&action=diff "preliminary patch to __pmDecodeCreds to fix this") [[details]](attachment.cgi?id=598767&action=edit "preliminary patch to __pmDecodeCreds to fix this") > preliminary patch to __pmDecodeCreds to fix this >  >  > Attached preliminary patch from Nathan Scott (upstream). Has been tested > against the reproducer script.  This calculation can overflow:    need = sizeof(creds_t) + ((numcred-1) * sizeof(__pmCred));  There should be a check *before* the calculation that this cannot happen, something like numcred < (INT_MAX - sizeof(creds_t))/sizeof(__pmCred).   ```  [Comment 10](show_bug.cgi?id=840822#c10)  Nathan Scott    2012-07-19 10:18:37 UTC  ``` Created [attachment 599108](attachment.cgi?id=599108&action=diff "Updated patch to address pcp credentials pdu buffer overflow exploit") [[details]](attachment.cgi?id=599108&action=edit "Updated patch to address pcp credentials pdu buffer overflow exploit") Updated patch to address pcp credentials pdu buffer overflow exploit  Incorporates an additional check to guard against malloc size overflow.  Uses a tighter restriction than the MAXINT-based suggestion, based on current uses and likely future uses of this PDU.   ```  [Comment 11](show_bug.cgi?id=840822#c11)  Mark Goodwin    2012-07-19 10:23:23 UTC  ``` Ressign to Nathan since he is following thru and this seems to be the way to go for these bugs.   ```  [Comment 12](show_bug.cgi?id=840822#c12)  Nathan Scott    2012-07-19 10:25:03 UTC  ``` I have a pcpqa test (513) which uses Florian's initial test case to exercise this change.  I'll hang onto it privately until we get a/ confirmation on permission to make use of this, and b/ public knowledge of the issue.  thanks!   ```  [Comment 13](show_bug.cgi?id=840822#c13)  Florian Weimer    2012-07-19 11:33:00 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=840822#c10)) > Created [attachment 599108](attachment.cgi?id=599108&action=diff "Updated patch to address pcp credentials pdu buffer overflow exploit") [[details]](attachment.cgi?id=599108&action=edit "Updated patch to address pcp credentials pdu buffer overflow exploit") > Updated patch to address pcp credentials pdu buffer overflow exploit >  > Incorporates an additional check to guard against malloc size overflow.  > Uses a tighter restriction than the MAXINT-based suggestion, based on > current uses and likely future uses of this PDU.  This looks good, thanks.   ```  [Comment 14](show_bug.cgi?id=840822#c14)  Huzaifa S. Sidhpurwala    2012-08-16 03:41:32 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=cced6012b4b93bfb640a9678589ced5416743910>  This issue has been addressed in pcp-3.6.5   ```  [Comment 15](show_bug.cgi?id=840822#c15)  Huzaifa S. Sidhpurwala    2012-08-20 03:52:18 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=840822&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_7b66e3f1_20250125_155109.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841126)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841126)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841126)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug Access Denied

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

## Related documentation

* [Creating an account](docs/en/html/administering/users.html#creating-new-users)

You are not authorized to access bug #841126.
To see this bug, you must
first [log
in to an account](show_bug.cgi?id=841126&GoAheadAndLogIn=1) with the appropriate permissions.

Please press **Back** and try again.

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_326be9a8_20250125_155115.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841240)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841240)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841240)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841240

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841240**](show_bug.cgi?id=841240)
- \_\_pmDecodeInstanceReq heap buffer overflow

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
\_\_pmDecodeInstanceReq heap buffer overflow

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Ken McDonell | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=841240&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841240&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-18 13:44 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 03:54 UTC ([History](show_activity.cgi?id=841240)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 03:54:18 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Resolve issues in decoding PCP instreq PDUs**](attachment.cgi?id=600703 "View the content of the attachment") (1.48 KB, patch)  [2012-07-27 06:33 UTC](#attach_600703 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600703&action=edit) | [Diff](attachment.cgi?id=600703&action=diff) | | [**Revised PCP instance request PDU decoding patch**](attachment.cgi?id=603365 "View the content of the attachment") (2.64 KB, patch)  [2012-08-09 23:00 UTC](#attach_603365 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=603365&action=edit) | [Diff](attachment.cgi?id=603365&action=diff) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=841240&action=viewall&hide_obsolete=1) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841240#c0)  Florian Weimer    2012-07-18 13:44:32 UTC  ``` __pmDecodeInstanceReq does not check the namelen field against the PDU length, leading to a read overflow.  Furthermore, if namelen is 0xFFFFFFFF, malloc(0) is called, followed by a strncpy() call to that pointer.  The copied string is controlled by the attacker.  This is exposed through pmcd without authentication.   ```  [Comment 2](show_bug.cgi?id=841240#c2)  Mark Goodwin    2012-07-20 23:31:13 UTC  ``` Ken requested assignment, thanks.   ```  [Comment 3](show_bug.cgi?id=841240#c3)  Nathan Scott    2012-07-27 06:33:34 UTC  ``` Created [attachment 600703](attachment.cgi?id=600703&action=diff "Resolve issues in decoding PCP instreq PDUs") [[details]](attachment.cgi?id=600703&action=edit "Resolve issues in decoding PCP instreq PDUs") Resolve issues in decoding PCP instreq PDUs   ```  [Comment 4](show_bug.cgi?id=841240#c4)  Florian Weimer    2012-07-27 14:50:35 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=841240#c3)) > Created [attachment 600703](attachment.cgi?id=600703&action=diff "Resolve issues in decoding PCP instreq PDUs") [[details]](attachment.cgi?id=600703&action=edit "Resolve issues in decoding PCP instreq PDUs") > Resolve issues in decoding PCP instreq PDUs  I think this is okay.  The expression    sizeof(instance_req_t) - sizeof(pp->name) + namelen  looks a bit suspecious with regards to wraparound, but the namelen > pp->hdr.len before should cover that.   ```  [Comment 5](show_bug.cgi?id=841240#c5)  Florian Weimer    2012-08-09 14:12:25 UTC  ``` Integration testing revealed that src/pmcd/src/dopdus.c:DoInstance() does not check for the error return from __pmDecodeInstanceReq:  int DoInstance(ClientInfo *cp, __pmPDU* pb) {     int			sts = 0, s;     __pmTimeval		when;     pmInDom		indom;     int			inst;     char		*name;     __pmInResult		*inresult = NULL;     AgentInfo		*ap;     int			fdfail = -1;      __pmDecodeInstanceReq(pb, &when, &indom, &inst, &name);     if (when.tv_sec != 0 || when.tv_usec != 0) {  This can lead to crashes further down.   ```  [Comment 6](show_bug.cgi?id=841240#c6)  Nathan Scott    2012-08-09 23:00:02 UTC  ``` Created [attachment 603365](attachment.cgi?id=603365&action=diff "Revised PCP instance request PDU decoding patch") [[details]](attachment.cgi?id=603365&action=edit "Revised PCP instance request PDU decoding patch") Revised PCP instance request PDU decoding patch  Excellent catch, thanks!  I've also audited all of the other __pmDecode* call sites, to ensure they check their return codes.  There are a few __pmDecodeError calls which are currently safe, and the remainder do check.  cheers.   ```  [Comment 7](show_bug.cgi?id=841240#c7)  Huzaifa S. Sidhpurwala    2012-08-16 03:55:07 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=f190942b552aa80d59bbe718866aa00b8e3fd5cc>  This issue has been addressed in pcp-3.6.5   ```  [Comment 8](show_bug.cgi?id=841240#c8)  Huzaifa S. Sidhpurwala    2012-08-20 03:54:18 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841240&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_2d52d817_20250126_100339.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2012-3418)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2012-3418)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2012-3418)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841698

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841698**](show_bug.cgi?id=841698)
(CVE-2012-3418)
- [CVE-2012-3418](https://access.redhat.com/security/cve/CVE-2012-3418) pcp: multiple integer and heap-based buffer overflow flaws

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-3418 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [840822](show_bug.cgi?id=840822 "CLOSED ERRATA - Crash in __pmDecodeCreds decoding crafted PDUs") [840920](show_bug.cgi?id=840920 "CLOSED ERRATA - pmcd (and others) heap-based buffer overflow in __pmDecodeNameList") [841112](show_bug.cgi?id=841112 "CLOSED ERRATA - __pmDecodeIDList lacks check against PDU size") [841126](show_bug.cgi?id=841126) [841159](show_bug.cgi?id=841159 "CLOSED ERRATA - __pmDecodeResult multiple vulnerabilities") [841180](show_bug.cgi?id=841180 "CLOSED ERRATA - DecodeNameReq buffer overflow") [841183](show_bug.cgi?id=841183 "CLOSED ERRATA - Missing namelen check in __pmDecodeFetch") [841240](show_bug.cgi?id=841240 "CLOSED ERRATA - __pmDecodeInstanceReq heap buffer overflow") [841249](show_bug.cgi?id=841249 "CLOSED ERRATA - __pmDecodeText heap overflow") [841284](show_bug.cgi?id=841284 "CLOSED ERRATA - __pmDecodeInstance vulnerabilities") [841290](show_bug.cgi?id=841290 "CLOSED ERRATA - pcp: __pmDecodeLogControl vulnerabilities") [848451](show_bug.cgi?id=848451) [848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]") [848630](show_bug.cgi?id=848630) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [841708](show_bug.cgi?id=841708) | | TreeView+ | [depends on](buglist.cgi?bug_id=841698&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841698&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-19 22:03 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:54 UTC ([History](show_activity.cgi?id=841698)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  fche fweimer kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp 3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-01-22 16:57:30 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841698#c0)  Vincent Danen    2012-07-19 22:03:51 UTC  ``` Florian Weimer of the Red Hat Product Security Team discovered multiple integer and heap-based buffer overflow flaws in PCP (Performance Co-Pilot) libpcp protocol decoding functions.  These flaws could lead to daemon crashes or the execution of arbitrary code with root privileges.  Many of these flaws can be exploited without requiring the attacker to be authenticated.   ```  [Comment 1](show_bug.cgi?id=841698#c1)  Vincent Danen    2012-07-19 22:06:45 UTC  ``` The individual bugs that make up these flaws:  [bug #840822](show_bug.cgi?id=840822 "CLOSED ERRATA - Crash in __pmDecodeCreds decoding crafted PDUs") Crash in __pmDecodeCreds decoding crafted PDUs [bug #840920](show_bug.cgi?id=840920 "CLOSED ERRATA - pmcd (and others) heap-based buffer overflow in __pmDecodeNameList") pmcd heap-based buffer overflow in __pmDecodeNameList [bug #841112](show_bug.cgi?id=841112 "CLOSED ERRATA - __pmDecodeIDList lacks check against PDU size") __pmDecodeIDList lacks check against PDU size [bug #841126](show_bug.cgi?id=841126) Missing PDU length checks in __pmDecodeProfile [bug #841159](show_bug.cgi?id=841159 "CLOSED ERRATA - __pmDecodeResult multiple vulnerabilities") __pmDecodeResult multiple vulnerabilities [bug #841180](show_bug.cgi?id=841180 "CLOSED ERRATA - DecodeNameReq buffer overflow") DecodeNameReq buffer overflow [bug #841183](show_bug.cgi?id=841183 "CLOSED ERRATA - Missing namelen check in __pmDecodeFetch") Missing namelen check in __pmDecodeFetch [bug #841240](show_bug.cgi?id=841240 "CLOSED ERRATA - __pmDecodeInstanceReq heap buffer overflow") __pmDecodeInstanceReq heap buffer overflow [bug #841249](show_bug.cgi?id=841249 "CLOSED ERRATA - __pmDecodeText heap overflow") __pmDecodeText heap overflow [bug #841284](show_bug.cgi?id=841284 "CLOSED ERRATA - __pmDecodeInstance vulnerabilities") __pmDecodeInstance vulnerabilities [bug #841290](show_bug.cgi?id=841290 "CLOSED ERRATA - pcp: __pmDecodeLogControl vulnerabilities") pcp: __pmDecodeLogControl vulnerabilities [bug #841306](show_bug.cgi?id=841306 "CLOSED ERRATA - libpcp additional decoder hardening") libpcp additional decoder hardening  Respective upstream patches which fix the flaws are included in the individual bugs.   ```  [Comment 5](show_bug.cgi?id=841698#c5)  Huzaifa S. Sidhpurwala    2012-08-16 04:44:53 UTC  ``` Created pcp tracking bugs for this issue  Affects: epel-all [[bug 848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]")]   ```  [Comment 6](show_bug.cgi?id=841698#c6)  Huzaifa S. Sidhpurwala    2012-08-17 04:51:40 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ```  [Comment 7](show_bug.cgi?id=841698#c7)  Huzaifa S. Sidhpurwala    2012-08-20 08:39:52 UTC  ``` (In reply to [comment #1](show_bug.cgi?id=841698#c1)) > [bug #841306](show_bug.cgi?id=841306 "CLOSED ERRATA - libpcp additional decoder hardening") libpcp additional decoder hardening  We have excluded this bug from [CVE-2012-3418](https://access.redhat.com/security/cve/CVE-2012-3418). It is not fixed in pcp-3.6.5. A CVE is not assigned to [bug #841306](show_bug.cgi?id=841306 "CLOSED ERRATA - libpcp additional decoder hardening") however, since its not really a flaw, but more of a hardening issue.   ```  [Comment 8](show_bug.cgi?id=841698#c8)  Fedora Update System    2012-08-20 10:54:31 UTC  ``` pcp-3.6.5-1.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=841698#c9)  Fedora Update System    2012-08-20 10:57:03 UTC  ``` pcp-3.6.5-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 10](show_bug.cgi?id=841698#c10)  Fedora Update System    2012-08-21 18:34:13 UTC  ``` pcp-3.6.5-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 11](show_bug.cgi?id=841698#c11)  Fedora Update System    2012-08-21 18:38:02 UTC  ``` pcp-3.6.5-1.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 12](show_bug.cgi?id=841698#c12)  Fedora Update System    2012-09-18 00:00:48 UTC  ``` pcp-3.6.5-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841698&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_4d2901d2_20250125_155108.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841112)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841112)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841112)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841112

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841112**](show_bug.cgi?id=841112)
- \_\_pmDecodeIDList lacks check against PDU size

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
\_\_pmDecodeIDList lacks check against PDU size

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nathan Scott | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=841112&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841112&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-18 08:10 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 03:52 UTC ([History](show_activity.cgi?id=841112)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 03:52:42 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Resolve issues in decoding PCP namespace idlist PDUs**](attachment.cgi?id=600699 "View the content of the attachment") (1.14 KB, patch)  [2012-07-27 06:27 UTC](#attach_600699 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600699&action=edit) | [Diff](attachment.cgi?id=600699&action=diff) | | [View All](attachment.cgi?bugid=841112&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841112#c0)  Florian Weimer    2012-07-18 08:10:46 UTC  ``` __pmDecodeIDList does not check that the incoming PDU actually contains room for numids elements.  This looks like it could result in a client crash (read buffer overflow, not exploitable for code execution) when a server sends too few IDs.   ```  [Comment 1](show_bug.cgi?id=841112#c1)  Mark Goodwin    2012-07-22 23:44:09 UTC  ``` Nathan requested assignment, thanks Nathan   ```  [Comment 2](show_bug.cgi?id=841112#c2)  Nathan Scott    2012-07-27 06:27:26 UTC  ``` Created [attachment 600699](attachment.cgi?id=600699&action=diff "Resolve issues in decoding PCP namespace idlist PDUs") [[details]](attachment.cgi?id=600699&action=edit "Resolve issues in decoding PCP namespace idlist PDUs") Resolve issues in decoding PCP namespace idlist PDUs   ```  [Comment 3](show_bug.cgi?id=841112#c3)  Florian Weimer    2012-07-27 13:22:53 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=841112#c2)) > Created [attachment 600699](attachment.cgi?id=600699&action=diff "Resolve issues in decoding PCP namespace idlist PDUs") [[details]](attachment.cgi?id=600699&action=edit "Resolve issues in decoding PCP namespace idlist PDUs") > Resolve issues in decoding PCP namespace idlist PDUs  Looks good to me.   ```  [Comment 4](show_bug.cgi?id=841112#c4)  Huzaifa S. Sidhpurwala    2012-08-16 03:45:53 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=b441980d53be1835b25f0cd6bcc0062da82032dd>  This issue has been addressed in pcp-3.6.5   ```  [Comment 5](show_bug.cgi?id=841112#c5)  Huzaifa S. Sidhpurwala    2012-08-20 03:52:42 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841112&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_799e02b3_20250125_155111.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841159)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841159)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841159)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841159

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841159**](show_bug.cgi?id=841159)
- \_\_pmDecodeResult multiple vulnerabilities

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
\_\_pmDecodeResult multiple vulnerabilities

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Mark Goodwin | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=841159&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841159&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-18 10:01 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 03:53 UTC ([History](show_activity.cgi?id=841159)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 03:53:42 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Proposed patch to resolve issues in PCP result PDU handling**](attachment.cgi?id=600963 "View the content of the attachment") (8.50 KB, patch)  [2012-07-29 01:24 UTC](#attach_600963 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600963&action=edit) | [Diff](attachment.cgi?id=600963&action=diff) | | [**Revised PCP result PDU decoding patch**](attachment.cgi?id=601673 "View the content of the attachment") (11.42 KB, patch)  [2012-08-01 07:14 UTC](#attach_601673 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=601673&action=edit) | [Diff](attachment.cgi?id=601673&action=diff) | | [**Revised PCP result PDU decoding patch**](attachment.cgi?id=602218 "View the content of the attachment") (11.42 KB, patch)  [2012-08-04 04:49 UTC](#attach_602218 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=602218&action=edit) | [Diff](attachment.cgi?id=602218&action=diff) | | [**Fix regression in PCP archive reading**](attachment.cgi?id=602222 "View the content of the attachment") (1.80 KB, patch)  [2012-08-04 04:58 UTC](#attach_602222 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=602222&action=edit) | [Diff](attachment.cgi?id=602222&action=diff) | | [**Revised PCP result PDU decoding patch**](attachment.cgi?id=602400 "View the content of the attachment") (11.41 KB, patch)  [2012-08-06 02:13 UTC](#attach_602400 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=602400&action=edit) | [Diff](attachment.cgi?id=602400&action=diff) | | [Show Obsolete](#a0) (3) [View All](attachment.cgi?bugid=841159&action=viewall&hide_obsolete=1) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841159#c0)  Florian Weimer    2012-07-18 10:01:47 UTC  ``` The __pmDecodeResult function contains multiple security vulnerabilities.  The description below is based on the 64-bit variant of the code.  Parts of this also apply to the 32-bit variant, but it is probably best to remove the code duplication and use the 64 bit variant everywhere.  The value of numpid is not validated against the overall PDU size.  Processing a crafted PDU could read past the end of the PDU, crashing the process or disclosing information.  The embedded numval counts are not checked, either, with similar results.  In the valfmt != PM_VAL_INSITU case, the extracted pointer may point outside the area which holds such values.  This can result in crashes or information disclosure.  The length field inside the value is not validated against the PDU size.  Values can overlap with each other or with other parts of the PDU, but this might not be a problem.  The nvsize/vbsize calculations can overflow.  This will be fixed implicitly when the contributing values are checked against the PDU size.  On 32-bit architectures, the malloc size calculation overflow leads to a heap-based buffer overflow.  The nvsize/vbsize overflows look as if they could lead to a heap-based buffer overflow on all architectures.  pmcd uses __pmDecodeResult, but apparently only after store authorization, so the function is only exposed to localhost in the default configuration.   ```  [Comment 2](show_bug.cgi?id=841159#c2)  Nathan Scott    2012-07-29 01:24:53 UTC  ``` Created [attachment 600963](attachment.cgi?id=600963&action=diff "Proposed patch to resolve issues in PCP result PDU handling") [[details]](attachment.cgi?id=600963&action=edit "Proposed patch to resolve issues in PCP result PDU handling") Proposed patch to resolve issues in PCP result PDU handling  This one is obviously the most complex of all the decoding routines.  I went with the approach of not collapsing the 32bit variant into the 64bit variant, mainly to not make additional functional change without first discussing with the original author.  The 32bit case is much, much simpler anyway.  I think I covered everything else listed, review would be much appreciated.  Thanks!   ```  [Comment 3](show_bug.cgi?id=841159#c3)  Florian Weimer    2012-07-30 12:05:27 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=841159#c2)) > Created [attachment 600963](attachment.cgi?id=600963&action=diff "Proposed patch to resolve issues in PCP result PDU handling") [[details]](attachment.cgi?id=600963&action=edit "Proposed patch to resolve issues in PCP result PDU handling") > Proposed patch to resolve issues in PCP result PDU handling >  > This one is obviously the most complex of all the decoding routines.  Indeed, this one is a bit of a challenge.  		    pduvp = &vlp->vlist[j]; 		    if (sizeof(__pmValue_PDU) > (size_t)(pduend - (char *)pduvp)) 			goto corrupt; 		    index = ntohl(vlp->vlist[j].value.pval); 		    pduvbp = (pmValueBlock *)&pdubuf[index];  I think you need to check here that index isn't negative and that it points into the pmValueBlocks area, and not the earlier parts in the PDU.  &pdubuf[index] contains a multiplication that an overflow, so you also need an upper limit for the index (perhaps the overall PDU length).  		    if (pduvbp->vlen < 0 || pduvbp->vlen > pp->hdr.len) 			goto corrupt; 		    vbsize += PM_PDU_SIZE_BYTES(pduvbp->vlen);      need = nvsize + vbsize;  pduvb->vlen should be checked accurately against the PDU end, otherwise you can trigger an overread by up to 64 KB (the PDU size limit), quite likely triggering a crash.  Can multiple values share the same external data?  The code does not guard against that.  Aggressive sharing leads to quadratic memory use here, so it would be better to impose a limit.  vbsize can also overflow if the PDU size limit is ever increased from 64K.  	/* pmValueBlocks (if any) are copied across "as is" */ 	index = vsize / sizeof(__pmPDU); 	memcpy((void *)&newbuf[nvsize], (void *)&pp->data[index], vbsize);  Okay, this pretty strongly assumes that there is no sharing, otherwise this copy operation can go way beyond the original PDU size.  Is it really necessary to compute vbsize from scratch?  It seems to me that you could just copy the entire original PDU unchanged, or at least the pmValueBlocks part.  Its length is determined by the final vsize value and the overall PDU length.  		    /* 		     * in the input PDU buffer, pval is an index to the 		     * start of the pmValueBlock, in units of __pmPDU 		     */ 		    index = sizeof(__pmPDU) * ntohl(vp->value.pval) + offset; 		    nvp->value.pval = (pmValueBlock *)&newbuf[index];  This is currently problematic because index could point somewhere into the expanded vlists area, so the values stored there could be invalid while they were previously correct.  In the 32 bit case, there is:  		    /* salvage pmValueBlocks from end of PDU */ 		    index = ntohl(pduvp->value.lval); 		    pduvbp = (pmValueBlock *)&pdubuf[index];  index should be guarded check for negative values, and compared to the PDU size (so that the multiplication hidden in &pdubuf[index] does not overflow).  		    if (sizeof(pmValueBlock) > (size_t)(pduend - (char *)pduvbp)) 			goto corrupt; 		    if (pduvbp->vlen < 0 || pduvbp->vlen > pp->hdr.len) 			goto corrupt; 		    pduvp->value.pval = pduvbp; 		    __ntohpmValueBlock(pduvbp);  Is pduvb->vlen valid before calling __ntohpmValueBlock(pduvbp)?   ```  [Comment 4](show_bug.cgi?id=841159#c4)  Nathan Scott    2012-08-01 07:14:05 UTC  ``` Created [attachment 601673](attachment.cgi?id=601673&action=diff "Revised PCP result PDU decoding patch") [[details]](attachment.cgi?id=601673&action=edit "Revised PCP result PDU decoding patch") Revised PCP result PDU decoding patch  (In reply to [comment #3](show_bug.cgi?id=841159#c3)) > (In reply to [comment #2](show_bug.cgi?id=841159#c2)) > 		    pduvp = &vlp->vlist[j]; > 		    if (sizeof(__pmValue_PDU) > (size_t)(pduend - (char *)pduvp)) > 			goto corrupt; > 		    index = ntohl(vlp->vlist[j].value.pval); > 		    pduvbp = (pmValueBlock *)&pdubuf[index]; >  > I think you need to check here that index isn't negative  *nod*, done, thanks.  > and that it points > into the pmValueBlocks area, and not the earlier parts in the PDU.   This proved tricky (we don't know where the start of the value blocks area will be until end of the first pass over the pdubuf).  In the revised patch I've added a pointer to track where the earliest valueblock start is.  Then after the first pass we can compare this to the calculated vsize (just making a note here, as its not immediately obvious).  > triggering a crash.  Can multiple values share the same external data?  The  As I think you found later, no they don't.  > It seems to me that you could > just copy the entire original PDU unchanged, > or at least the pmValueBlocks part.  That part is copied as-is (after swabbing) into the new buffer via a single memcpy.  The vlist part cannot be copied directly though, as the pointer size on 64 bit platforms is too large to place directly in-line in the original buffer (this is the fundamental reason why a separate 64 bit code path had to be added at some point in the now distant past).  > Is pduvb->vlen valid before calling __ntohpmValueBlock(pduvbp)?  Nope, good catch.  This patch should address all of the issues, with the check to ensure valueblock indices don't point into the vlists being the most subtle (and hence possibly wrong!).  Testing suggests its OK, but again I'm appreciating any/all feedback on this - thanks!   ```  [Comment 5](show_bug.cgi?id=841159#c5)  Florian Weimer    2012-08-01 11:03:10 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=841159#c4)) > In the revised patch I've added a pointer to track where the earliest > valueblock start is.  Then after the first pass we can compare this to > the calculated vsize (just making a note here, as its not immediately > obvious).  This should work in principle, yes.  > > It seems to me that you could > > just copy the entire original PDU unchanged, > > or at least the pmValueBlocks part. >  > That part is copied as-is (after swabbing) into the new buffer via a > single memcpy.  What I meant was: Could you copy the remaining PDU after only determining the vlist length?  Then you don't have to determine the size of the pmValueBlocks part explicitly, and could do the bulk of the checking in the second path (which fills in the pointers).  I'm still happy about the current code.  This PDU type is very difficult to parse, particularly using the pointer-based approach.  However, I could not spot any remaining bugs.  From the patch description (which is based on my earlier comment):    Values can overlap with each other or   with other parts of the PDU, but this might not be a problem.  You should remove that because overlaps are most definitely a problem in the old code.   ```  [Comment 6](show_bug.cgi?id=841159#c6)  Nathan Scott    2012-08-04 04:49:56 UTC  ``` Created [attachment 602218](attachment.cgi?id=602218&action=diff "Revised PCP result PDU decoding patch") [[details]](attachment.cgi?id=602218&action=edit "Revised PCP result PDU decoding patch") Revised PCP result PDU decoding patch  Update the patch header to reflect the point Florian made in the previous comment.   ```  [Comment 7](show_bug.cgi?id=841159#c7)  Nathan Scott    2012-08-04 04:58:45 UTC  ``` Created [attachment 602222](attachment.cgi?id=602222&action=diff "Fix regression in PCP archive reading") [[details]](attachment.cgi?id=602222&action=edit "Fix regression in PCP archive reading") Fix regression in PCP archive reading  This patch fixes a regression introduced by the other patch for this bug, which results in PCP archives no longer being able to be replayed.   ```  [Comment 8](show_bug.cgi?id=841159#c8)  Nathan Scott    2012-08-06 02:13:07 UTC  ``` Created [attachment 602400](attachment.cgi?id=602400&action=diff "Revised PCP result PDU decoding patch") [[details]](attachment.cgi?id=602400&action=edit "Revised PCP result PDU decoding patch") Revised PCP result PDU decoding patch  This update resolves two additional bugs in the earlier patches, which were exposed by pcpqa tests 003 and 202 (and a number of others, for the latter problem) respectively.  Test 003 exposes a problem decoding a corner case of zero-length aggregate value, such as the sample.aggregate.null metric from pmdasample.  Test 202 exposes a problem decoding mark records (from PCP archives), which have a zero-length initial __pmPDU component in the result_t structure.   ```  [Comment 9](show_bug.cgi?id=841159#c9)  Huzaifa S. Sidhpurwala    2012-08-16 03:57:43 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=49c679c44425915a8d6aa4af5f90b35384843c12> <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=d08105f0f36c24e3f6d1e28e6d2289001e03f589>  This issue has been addressed in pcp-3.6.5   ```  [Comment 10](show_bug.cgi?id=841159#c10)  Huzaifa S. Sidhpurwala    2012-08-20 03:53:42 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841159&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_467c5851_20250125_155116.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841249)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841249)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841249)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841249

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841249**](show_bug.cgi?id=841249)
- \_\_pmDecodeText heap overflow

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
\_\_pmDecodeText heap overflow

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Ken McDonell | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=841249&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841249&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-18 13:54 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 04:00 UTC ([History](show_activity.cgi?id=841249)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 04:00:20 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Resolve issues in decoding PCP text PDUs**](attachment.cgi?id=600704 "View the content of the attachment") (1.11 KB, patch)  [2012-07-27 06:38 UTC](#attach_600704 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600704&action=edit) | [Diff](attachment.cgi?id=600704&action=diff) | | [View All](attachment.cgi?bugid=841249&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841249#c0)  Florian Weimer    2012-07-18 13:54:14 UTC  ``` This is very similar to the __pmDecodeInstanceReq overflow ([bug 841240](show_bug.cgi?id=841240 "CLOSED ERRATA - __pmDecodeInstanceReq heap buffer overflow")).  buflen needs to be checked against the PDU size, and negative values need to be rejected.  This is not directly exposed through pmcd.   ```  [Comment 1](show_bug.cgi?id=841249#c1)  Mark Goodwin    2012-07-20 23:30:29 UTC  ```  Ken requested assignment, thanks.   ```  [Comment 2](show_bug.cgi?id=841249#c2)  Nathan Scott    2012-07-27 06:38:22 UTC  ``` Created [attachment 600704](attachment.cgi?id=600704&action=diff "Resolve issues in decoding PCP text PDUs") [[details]](attachment.cgi?id=600704&action=edit "Resolve issues in decoding PCP text PDUs") Resolve issues in decoding PCP text PDUs   ```  [Comment 3](show_bug.cgi?id=841249#c3)  Florian Weimer    2012-07-27 14:56:28 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=841249#c2)) > Created [attachment 600704](attachment.cgi?id=600704&action=diff "Resolve issues in decoding PCP text PDUs") [[details]](attachment.cgi?id=600704&action=edit "Resolve issues in decoding PCP text PDUs") > Resolve issues in decoding PCP text PDUs  This looks okay, with the same caveat as in [bug 841240](show_bug.cgi?id=841240 "CLOSED ERRATA - __pmDecodeInstanceReq heap buffer overflow").   ```  [Comment 4](show_bug.cgi?id=841249#c4)  Huzaifa S. Sidhpurwala    2012-08-16 03:56:21 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=9f4e392c97ce42744ec73f82268ce6c815fdca0e>  This issue has been addressed in pcp-3.6.5   ```  [Comment 5](show_bug.cgi?id=841249#c5)  Huzaifa S. Sidhpurwala    2012-08-20 04:00:20 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841249&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_4b81f133_20250125_155112.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841180)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841180)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841180)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841180

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841180**](show_bug.cgi?id=841180)
- DecodeNameReq buffer overflow

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
DecodeNameReq buffer overflow

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nathan Scott | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=841180&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841180&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-18 11:00 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 03:53 UTC ([History](show_activity.cgi?id=841180)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 03:53:54 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Resolve issues in decoding PCP namereq PDUs**](attachment.cgi?id=600700 "View the content of the attachment") (1.06 KB, patch)  [2012-07-27 06:29 UTC](#attach_600700 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600700&action=edit) | [Diff](attachment.cgi?id=600700&action=diff) | | [**Updated patch to address PCP namereq PDU decoding issues**](attachment.cgi?id=600961 "View the content of the attachment") (1.02 KB, patch)  [2012-07-29 01:10 UTC](#attach_600961 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600961&action=edit) | [Diff](attachment.cgi?id=600961&action=diff) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=841180&action=viewall&hide_obsolete=1) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841180#c0)  Florian Weimer    2012-07-18 11:00:21 UTC  ``` DecodeNameReq does not check the namelen field against the PDU size.  This can lead to a crash.  DecodeNameReq is exposed by pmcd through PDU_PMNS_CHILD and PDU_PMNS_TRAVERSE processing.  No authentication is required.   ```  [Comment 2](show_bug.cgi?id=841180#c2)  Mark Goodwin    2012-07-22 23:44:49 UTC  ```  Nathan requested assignment, thanks Nathan.   ```  [Comment 3](show_bug.cgi?id=841180#c3)  Nathan Scott    2012-07-27 06:29:04 UTC  ``` Created [attachment 600700](attachment.cgi?id=600700&action=diff "Resolve issues in decoding PCP namereq PDUs") [[details]](attachment.cgi?id=600700&action=edit "Resolve issues in decoding PCP namereq PDUs") Resolve issues in decoding PCP namereq PDUs   ```  [Comment 4](show_bug.cgi?id=841180#c4)  Florian Weimer    2012-07-27 13:47:46 UTC  ``` namelen+1 >= INT_MAX is always false.  But the comparison appears to be unnecessary in this case.   ```  [Comment 5](show_bug.cgi?id=841180#c5)  Nathan Scott    2012-07-29 01:10:12 UTC  ``` Created [attachment 600961](attachment.cgi?id=600961&action=diff "Updated patch to address PCP namereq PDU decoding issues") [[details]](attachment.cgi?id=600961&action=edit "Updated patch to address PCP namereq PDU decoding issues") Updated patch to address PCP namereq PDU decoding issues  Incorporate Florian's review comments.   ```  [Comment 6](show_bug.cgi?id=841180#c6)  Florian Weimer    2012-07-30 12:24:47 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=841180#c5)) > Created [attachment 600961](attachment.cgi?id=600961&action=diff "Updated patch to address PCP namereq PDU decoding issues") [[details]](attachment.cgi?id=600961&action=edit "Updated patch to address PCP namereq PDU decoding issues") > Updated patch to address PCP namereq PDU decoding issues >  > Incorporate Florian's review comments.  Looks good to me.   ```  [Comment 7](show_bug.cgi?id=841180#c7)  Huzaifa S. Sidhpurwala    2012-08-16 03:52:33 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=bfb3ab8c6b3d75b1a6580feee76a7d0925a3633c>  This issue has been addressed in pcp-3.6.5   ```  [Comment 8](show_bug.cgi?id=841180#c8)  Huzaifa S. Sidhpurwala    2012-08-20 03:53:54 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841180&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_95e5938e_20250125_155117.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841284)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841284)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841284)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841284

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841284**](show_bug.cgi?id=841284)
- \_\_pmDecodeInstance vulnerabilities

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
\_\_pmDecodeInstance vulnerabilities

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Mark Goodwin | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=841284&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841284&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-18 14:57 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 04:00 UTC ([History](show_activity.cgi?id=841284)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 04:00:35 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Resolve issues in decoding PCP instance PDUs**](attachment.cgi?id=600701 "View the content of the attachment") (2.22 KB, patch)  [2012-07-27 06:30 UTC](#attach_600701 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600701&action=edit) | [Diff](attachment.cgi?id=600701&action=diff) | | [**Updated patch to address PCP instance PDU decoding issues**](attachment.cgi?id=600962 "View the content of the attachment") (2.03 KB, patch)  [2012-07-29 01:14 UTC](#attach_600962 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=600962&action=edit) | [Diff](attachment.cgi?id=600962&action=diff) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=841284&action=viewall&hide_obsolete=1) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841284#c0)  Florian Weimer    2012-07-18 14:57:06 UTC  ``` __pmDecodeInstance does not check the numinst and namelen values against the length of the PDU.  As a result, an application which decodes crafted PDU_INSTANCE packets can crash.  namelen values of 0xFFFFFFFF result in the allocation of a heap object which is too small, but this is probably not exploitable for code execution (this assessment is subject to the usual caveats)   ```  [Comment 2](show_bug.cgi?id=841284#c2)  Nathan Scott    2012-07-27 06:30:53 UTC  ``` Created [attachment 600701](attachment.cgi?id=600701&action=diff "Resolve issues in decoding PCP instance PDUs") [[details]](attachment.cgi?id=600701&action=edit "Resolve issues in decoding PCP instance PDUs") Resolve issues in decoding PCP instance PDUs   ```  [Comment 3](show_bug.cgi?id=841284#c3)  Florian Weimer    2012-07-27 14:34:48 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=841284#c2)) > Created [attachment 600701](attachment.cgi?id=600701&action=diff "Resolve issues in decoding PCP instance PDUs") [[details]](attachment.cgi?id=600701&action=edit "Resolve issues in decoding PCP instance PDUs")  	if (sizeof(instlist_t) - sizeof(sizeof(ip->name)) > (size_t)(pdu_end - (char *)ip)) {  There's a duplicated sizeof.  	if (ip->namelen < 0 || ip->namelen >= rp->hdr.len || ip->namelen + 1 >= INT_MAX) {  ip->namelen + 1 >= INT_MAX is always false.   If you move the next check before the malloc, you only need the ip->namelen < 0 part.  The ip->namelen >= rp->hdr.len check is implicit in the check against the remaining PDU length.   ```  [Comment 4](show_bug.cgi?id=841284#c4)  Nathan Scott    2012-07-29 01:14:45 UTC  ``` Created [attachment 600962](attachment.cgi?id=600962&action=diff "Updated patch to address PCP instance PDU decoding issues") [[details]](attachment.cgi?id=600962&action=edit "Updated patch to address PCP instance PDU decoding issues") Updated patch to address PCP instance PDU decoding issues  Incorporate Florian's review comments. Thanks Florian!   ```  [Comment 5](show_bug.cgi?id=841284#c5)  Florian Weimer    2012-07-30 12:16:47 UTC  ``` I think this is okay, thanks.   ```  [Comment 6](show_bug.cgi?id=841284#c6)  Huzaifa S. Sidhpurwala    2012-08-16 04:07:13 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=babd6c5c527f87ec838c13a1b4eba612af6ea27c>  This issue has been addressed in pcp-3.6.5   ```  [Comment 7](show_bug.cgi?id=841284#c7)  Huzaifa S. Sidhpurwala    2012-08-20 04:00:35 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841284&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_bcdb9dc3_20250125_155119.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841698)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841698)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841698)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841698

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841698**](show_bug.cgi?id=841698)
(CVE-2012-3418)
- [CVE-2012-3418](https://access.redhat.com/security/cve/CVE-2012-3418) pcp: multiple integer and heap-based buffer overflow flaws

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-3418 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [840822](show_bug.cgi?id=840822 "CLOSED ERRATA - Crash in __pmDecodeCreds decoding crafted PDUs") [840920](show_bug.cgi?id=840920 "CLOSED ERRATA - pmcd (and others) heap-based buffer overflow in __pmDecodeNameList") [841112](show_bug.cgi?id=841112 "CLOSED ERRATA - __pmDecodeIDList lacks check against PDU size") [841126](show_bug.cgi?id=841126) [841159](show_bug.cgi?id=841159 "CLOSED ERRATA - __pmDecodeResult multiple vulnerabilities") [841180](show_bug.cgi?id=841180 "CLOSED ERRATA - DecodeNameReq buffer overflow") [841183](show_bug.cgi?id=841183 "CLOSED ERRATA - Missing namelen check in __pmDecodeFetch") [841240](show_bug.cgi?id=841240 "CLOSED ERRATA - __pmDecodeInstanceReq heap buffer overflow") [841249](show_bug.cgi?id=841249 "CLOSED ERRATA - __pmDecodeText heap overflow") [841284](show_bug.cgi?id=841284 "CLOSED ERRATA - __pmDecodeInstance vulnerabilities") [841290](show_bug.cgi?id=841290 "CLOSED ERRATA - pcp: __pmDecodeLogControl vulnerabilities") [848451](show_bug.cgi?id=848451) [848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]") [848630](show_bug.cgi?id=848630) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [841708](show_bug.cgi?id=841708) | | TreeView+ | [depends on](buglist.cgi?bug_id=841698&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841698&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-19 22:03 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:54 UTC ([History](show_activity.cgi?id=841698)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  fche fweimer kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp 3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-01-22 16:57:30 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841698#c0)  Vincent Danen    2012-07-19 22:03:51 UTC  ``` Florian Weimer of the Red Hat Product Security Team discovered multiple integer and heap-based buffer overflow flaws in PCP (Performance Co-Pilot) libpcp protocol decoding functions.  These flaws could lead to daemon crashes or the execution of arbitrary code with root privileges.  Many of these flaws can be exploited without requiring the attacker to be authenticated.   ```  [Comment 1](show_bug.cgi?id=841698#c1)  Vincent Danen    2012-07-19 22:06:45 UTC  ``` The individual bugs that make up these flaws:  [bug #840822](show_bug.cgi?id=840822 "CLOSED ERRATA - Crash in __pmDecodeCreds decoding crafted PDUs") Crash in __pmDecodeCreds decoding crafted PDUs [bug #840920](show_bug.cgi?id=840920 "CLOSED ERRATA - pmcd (and others) heap-based buffer overflow in __pmDecodeNameList") pmcd heap-based buffer overflow in __pmDecodeNameList [bug #841112](show_bug.cgi?id=841112 "CLOSED ERRATA - __pmDecodeIDList lacks check against PDU size") __pmDecodeIDList lacks check against PDU size [bug #841126](show_bug.cgi?id=841126) Missing PDU length checks in __pmDecodeProfile [bug #841159](show_bug.cgi?id=841159 "CLOSED ERRATA - __pmDecodeResult multiple vulnerabilities") __pmDecodeResult multiple vulnerabilities [bug #841180](show_bug.cgi?id=841180 "CLOSED ERRATA - DecodeNameReq buffer overflow") DecodeNameReq buffer overflow [bug #841183](show_bug.cgi?id=841183 "CLOSED ERRATA - Missing namelen check in __pmDecodeFetch") Missing namelen check in __pmDecodeFetch [bug #841240](show_bug.cgi?id=841240 "CLOSED ERRATA - __pmDecodeInstanceReq heap buffer overflow") __pmDecodeInstanceReq heap buffer overflow [bug #841249](show_bug.cgi?id=841249 "CLOSED ERRATA - __pmDecodeText heap overflow") __pmDecodeText heap overflow [bug #841284](show_bug.cgi?id=841284 "CLOSED ERRATA - __pmDecodeInstance vulnerabilities") __pmDecodeInstance vulnerabilities [bug #841290](show_bug.cgi?id=841290 "CLOSED ERRATA - pcp: __pmDecodeLogControl vulnerabilities") pcp: __pmDecodeLogControl vulnerabilities [bug #841306](show_bug.cgi?id=841306 "CLOSED ERRATA - libpcp additional decoder hardening") libpcp additional decoder hardening  Respective upstream patches which fix the flaws are included in the individual bugs.   ```  [Comment 5](show_bug.cgi?id=841698#c5)  Huzaifa S. Sidhpurwala    2012-08-16 04:44:53 UTC  ``` Created pcp tracking bugs for this issue  Affects: epel-all [[bug 848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]")]   ```  [Comment 6](show_bug.cgi?id=841698#c6)  Huzaifa S. Sidhpurwala    2012-08-17 04:51:40 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ```  [Comment 7](show_bug.cgi?id=841698#c7)  Huzaifa S. Sidhpurwala    2012-08-20 08:39:52 UTC  ``` (In reply to [comment #1](show_bug.cgi?id=841698#c1)) > [bug #841306](show_bug.cgi?id=841306 "CLOSED ERRATA - libpcp additional decoder hardening") libpcp additional decoder hardening  We have excluded this bug from [CVE-2012-3418](https://access.redhat.com/security/cve/CVE-2012-3418). It is not fixed in pcp-3.6.5. A CVE is not assigned to [bug #841306](show_bug.cgi?id=841306 "CLOSED ERRATA - libpcp additional decoder hardening") however, since its not really a flaw, but more of a hardening issue.   ```  [Comment 8](show_bug.cgi?id=841698#c8)  Fedora Update System    2012-08-20 10:54:31 UTC  ``` pcp-3.6.5-1.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=841698#c9)  Fedora Update System    2012-08-20 10:57:03 UTC  ``` pcp-3.6.5-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 10](show_bug.cgi?id=841698#c10)  Fedora Update System    2012-08-21 18:34:13 UTC  ``` pcp-3.6.5-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 11](show_bug.cgi?id=841698#c11)  Fedora Update System    2012-08-21 18:38:02 UTC  ``` pcp-3.6.5-1.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 12](show_bug.cgi?id=841698#c12)  Fedora Update System    2012-09-18 00:00:48 UTC  ``` pcp-3.6.5-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841698&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_43e5c26a_20250125_155107.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D840920)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D840920)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D840920)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 840920

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 840920**](show_bug.cgi?id=840920)
- pmcd (and others) heap-based buffer overflow in \_\_pmDecodeNameList

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
pmcd (and others) heap-based buffer overflow in \_\_pmDecodeNameList

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nathan Scott | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=840920&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=840920&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-17 15:23 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 03:52 UTC ([History](show_activity.cgi?id=840920)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  fche kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 03:52:33 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Proposed patch to resolve issues in pcp namelist pdu handling**](attachment.cgi?id=599485 "View the content of the attachment") (4.44 KB, patch)  [2012-07-21 04:06 UTC](#attach_599485 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=599485&action=edit) | [Diff](attachment.cgi?id=599485&action=diff) | | [**Revised PCP namelist PDU decoding patch**](attachment.cgi?id=599886 "View the content of the attachment") (4.92 KB, patch)  [2012-07-24 01:37 UTC](#attach_599886 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=599886&action=edit) | [Diff](attachment.cgi?id=599886&action=diff) | | [**Proof-of-concept patch avoiding structs for decoding**](attachment.cgi?id=600251 "View the content of the attachment") (5.30 KB, patch)  [2012-07-25 09:48 UTC](#attach_600251 "Go to the comment associated with the attachment"), Florian Weimer | *no flags* | [Details](attachment.cgi?id=600251&action=edit) | [Diff](attachment.cgi?id=600251&action=diff) | | [**Updated version of Florian alternative approach**](attachment.cgi?id=601724 "View the content of the attachment") (5.38 KB, patch)  [2012-08-01 12:07 UTC](#attach_601724 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=601724&action=edit) | [Diff](attachment.cgi?id=601724&action=diff) | | [View All](attachment.cgi?bugid=840920&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=840920#c0)  Florian Weimer    2012-07-17 15:23:24 UTC  ``` __pmDecodeNameList fetches the number of bytes to allocate for storing the incoming name strings from the PDU.  The function does not check if the strings provided later actually fit into the buffer:      /* need space for name ptrs and the name characters */     need = *numnames * ((int)sizeof(char*)) + ntohl(namelist_pdu->nstrbytes);     if ((names = (char**)malloc(need)) == NULL) 	return -oserror();     ... 	char	*dest = (char*)&names[*numnames];         ... 	    memcpy(dest, np->name, namelen); 	    *(dest + namelen) = '\0'; 	    dest += namelen + 1;   This leads to a heap-based buffer overflow.  Exploitation is aided by the /rpoc information leak ([bug 840765](show_bug.cgi?id=840765)).  In addition, __pmDecodeNameList does not properly check the length of the status and names arrays against the PDU length, and does not guard against integer overflow when calculating the malloc argument.  This leads to another heap-based buffer overflow (probably on all architectures because the intermediate value is stored in an int).  This is similar to [bug 840422](show_bug.cgi?id=840422 "CLOSED RAWHIDE - Review Request: rubygem-uglifier - Ruby wrapper for UglifyJS JavaScript compressor").   ```  [Comment 5](show_bug.cgi?id=840920#c5)  Nathan Scott    2012-07-21 04:06:28 UTC  ``` Created [attachment 599485](attachment.cgi?id=599485&action=diff "Proposed patch to resolve issues in pcp namelist pdu handling") [[details]](attachment.cgi?id=599485&action=edit "Proposed patch to resolve issues in pcp namelist pdu handling") Proposed patch to resolve issues in pcp namelist pdu handling  I believe this patch addresses each of the issues listed in the bug.  A code review would be much appreciated!  I've single-stepped through the handling of the test case provided (thanks!) with a debug build of pmcd, and that particular case is verified as fixed.   ```  [Comment 6](show_bug.cgi?id=840920#c6)  Mark Goodwin    2012-07-22 23:43:24 UTC  ```  Nathan reqested assignment, thanks Nathan.   ```  [Comment 7](show_bug.cgi?id=840920#c7)  Florian Weimer    2012-07-23 10:14:22 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=840920#c5)) > Created [attachment 599485](attachment.cgi?id=599485&action=diff "Proposed patch to resolve issues in pcp namelist pdu handling") [[details]](attachment.cgi?id=599485&action=edit "Proposed patch to resolve issues in pcp namelist pdu handling") > Proposed patch to resolve issues in pcp namelist pdu handling >  > I believe this patch addresses each of the issues listed in the bug.  A code > review would be much appreciated! >  > I've single-stepped through the handling of the test case provided (thanks!) > with a debug build of pmcd, and that particular case is verified as fixed.  The patch no longer updates *numnamesp with zero if there are no names.  This could be a real bug.      /* validity checks - none of these conditions should happen */     if (numnames < 0 || numstatus < 0 || nstrbytes < 0) 	return PM_ERR_IPC;  You should check that nstrbytes is less than the PDU size before trying to allocate that much memory.  (This is an anti-DoS measure.)  No need to be very precise about this, the limit can be too large.  Same for numnames and numstatus.  	    if ((char *)np + sizeof(name_t) > pdu_end)  // (1)  The comparison should be instead:  	    if (sizeof(name_t) > (size_t)(pdu_end - (char *)np))  (char *)np + sizeof(name_t) is undefined if you run past the end of the buffer.  The size_t cast is necessary to silence a compiler warning: the RHS always positive, so it's a false positive.  	    namelen = ntohl(np->namelen);  namelen needs to be checked against 0, the packet is corrupt if it's negative.  	    if ((char *)np + sizeof(np->namelen) + namelen > pdu_end)  Same problem as (1) above.  	    if ((namelen + 1) > (dest_end - dest))  Technically, this needs two separate checks to prevent overflow of namelen + 1.  But the check directly above should cover that, so perhaps just add a comment.  Due to the code duplication, the comments above apply to both branches of the if statement.   	    if (status != NULL)  		status[i] = ntohl(np->status);  Can status be NULL at this point?  I don't think so.  In any case, this needs a check against numstatus, or numstatus needs to be compared to numnames at some point.      if (status != NULL) 	free(status);  Nowadays, it's safe to pass NULL to free, so the check is redundant.   ```  [Comment 8](show_bug.cgi?id=840920#c8)  Nathan Scott    2012-07-24 01:35:37 UTC  ``` (In reply to [comment #7](show_bug.cgi?id=840920#c7)) > (In reply to [comment #5](show_bug.cgi?id=840920#c5)) > ...  Thanks.  New patch shortly - couple of minor clarifications though, on things the next patch doesn't address (if no comments, expect it to be addressed):  >  	    if (status != NULL) >  		status[i] = ntohl(np->status); >  > Can status be NULL at this point?  I don't think so.   Yes, it will be NULL if the PDU contained status info but the caller did not pass a pointer in to copy that to.  Next patch adds explicit checking that numstatus in the PDU must be zero or equal to numnames - nothing else makes sense - but the above check is needed, AIUI.  > Nowadays, it's safe to pass NULL to free, so the check is redundant.  I'm not sure thats true for all of the platforms PCP has been ported to (in particular, Win32 and Solaris), and its a coding pattern used consistently throughout, so I've left this.  Thanks again Florian.   ```  [Comment 9](show_bug.cgi?id=840920#c9)  Nathan Scott    2012-07-24 01:37:26 UTC  ``` Created [attachment 599886](attachment.cgi?id=599886&action=diff "Revised PCP namelist PDU decoding patch") [[details]](attachment.cgi?id=599886&action=edit "Revised PCP namelist PDU decoding patch") Revised PCP namelist PDU decoding patch  Updated to include Florians review comments, except for the two discussed.   ```  [Comment 10](show_bug.cgi?id=840920#c10)  Florian Weimer    2012-07-25 09:46:04 UTC  ``` (In reply to [comment #9](show_bug.cgi?id=840920#c9)) > Created [attachment 599886](attachment.cgi?id=599886&action=diff "Revised PCP namelist PDU decoding patch") [[details]](attachment.cgi?id=599886&action=edit "Revised PCP namelist PDU decoding patch") > Revised PCP namelist PDU decoding patch >  > Updated to include Florians review comments, except for the two discussed.  I think this  	    np = (name_t*)&namelist_pdu->names[j/sizeof(__pmPDU)];  can cause np to point past pdu_end because this check  	    if (sizeof(np->namelen) + namelen > (size_t)(pdu_end - (char *)np))  does not take into account the padding added here:  	    j += sizeof(namelen) + PM_PDU_SIZE_BYTES(namelen);  The net effect is that (size_t)(pdu_end - (char *)np) ends up being a large positive value, causing checks to succeed incorrectly.  I'm beginning to wonder if having those wire-format structs (name_t, name_status_t, namelist_t) is beneficial.   ```  [Comment 11](show_bug.cgi?id=840920#c11)  Florian Weimer    2012-07-25 09:48:08 UTC  ``` Created [attachment 600251](attachment.cgi?id=600251&action=diff "Proof-of-concept patch avoiding structs for decoding") [[details]](attachment.cgi?id=600251&action=edit "Proof-of-concept patch avoiding structs for decoding") Proof-of-concept patch avoiding structs for decoding  This is just a proof of concept, a real patch would have to get rid of the nested functions.   ```  [Comment 12](show_bug.cgi?id=840920#c12)  Nathan Scott    2012-08-01 12:07:35 UTC  ``` Created [attachment 601724](attachment.cgi?id=601724&action=diff "Updated version of Florian alternative approach") [[details]](attachment.cgi?id=601724&action=edit "Updated version of Florian alternative approach") Updated version of Florian alternative approach  This patch fixes the first few issues I came across trying out that patch Florian.  I'm not sure about this approach - the structures do give an inherent ordering to fields which is easy to get wrong, and if we remove the here this will be the only PDU which doesn't decode using structures (bit funky for maintenance or future extension, perhaps).  Its also quite invasive, and I'm not overly comfortable about the risk level esp. given all the other changes we're making.  The attached patch also still doesn't quite work yet, some quick checks show several command commands quickly hitting PM_ERR_IPC where they have valid PDU contents.  Getting late here, I think tomorrow I might revisit the earlier patch and make that index use (j/sizeof(__pmPDU) approach) more robust if possible.  cheers.   ```  [Comment 13](show_bug.cgi?id=840920#c13)  Huzaifa S. Sidhpurwala    2012-08-16 03:44:44 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=f0eaefe046b1061797f45b0c20bb2ac371b504a5>  This issue has been addressed in pcp-3.6.5   ```  [Comment 14](show_bug.cgi?id=840920#c14)  Huzaifa S. Sidhpurwala    2012-08-20 03:52:33 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=840920&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_9b181838_20250126_100341.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2012-3421)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2012-3421)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2012-3421)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841706

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841706**](show_bug.cgi?id=841706)
(CVE-2012-3421)
- [CVE-2012-3421](https://access.redhat.com/security/cve/CVE-2012-3421) pcp: event-driven programming flaw blocks pmcd from responding to other legitimate requests

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-3421 pcp: event-driven programming flaw blocks pmcd from responding ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-3421 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [841314](show_bug.cgi?id=841314 "CLOSED ERRATA - pcp: malicious client can stop all pmcd server activity") [848451](show_bug.cgi?id=848451) [848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]") [848630](show_bug.cgi?id=848630) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [841708](show_bug.cgi?id=841708) | | TreeView+ | [depends on](buglist.cgi?bug_id=841706&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841706&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-19 22:49 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:54 UTC ([History](show_activity.cgi?id=841706)) | | [CC List:](page.cgi?id=fields.html#cclist) | 7 users (show)  fche fweimer kenj maurizio.antillon mgoodwin nathans security-response-team | | Fixed In Version: | pcp 3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-01-22 16:57:07 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Resolve an event-driven programming flaw in pmcd**](attachment.cgi?id=602308 "View the content of the attachment") (2.44 KB, patch)  [2012-08-05 01:37 UTC](#attach_602308 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=602308&action=edit) | [Diff](attachment.cgi?id=602308&action=diff) | | [View All](attachment.cgi?bugid=841706&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841706#c0)  Vincent Danen    2012-07-19 22:49:09 UTC  ``` Florian Weimer of the Red Hat Product Security Team discovered a denial of service flaw in pmcd (the PCP (Performance Co-Pilot) performance metrics collector daemon) due to incorrect event-driven programming.  Because the pduread() function in libpcp performs a select locally, waiting for more client data, an unauthenticated remote attacker could send individual bytes one by one, avoiding the timeout, and blocking pmcd in order to prevent it from responding to other legitimate requests.   ```  [Comment 2](show_bug.cgi?id=841706#c2)  Nathan Scott    2012-08-05 01:37:56 UTC  ``` Created [attachment 602308](attachment.cgi?id=602308&action=diff "Resolve an event-driven programming flaw in pmcd") [[details]](attachment.cgi?id=602308&action=edit "Resolve an event-driven programming flaw in pmcd") Resolve an event-driven programming flaw in pmcd  This is Ken's patch to address this bug.  Have had it in my quilt series for awhile, seems to be causing fewer regressions than most of my changes. :)  Wider review would be appreciated, thanks.   ```  [Comment 3](show_bug.cgi?id=841706#c3)  Huzaifa S. Sidhpurwala    2012-08-16 04:13:17 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=9ba85dca940de976176ce196fd5e3c4170936354>  This issue has been addressed in pcp-3.6.5   ```  [Comment 5](show_bug.cgi?id=841706#c5)  Huzaifa S. Sidhpurwala    2012-08-16 04:47:53 UTC  ``` Created pcp tracking bugs for this issue  Affects: epel-all [[bug 848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]")]   ```  [Comment 6](show_bug.cgi?id=841706#c6)  Huzaifa S. Sidhpurwala    2012-08-17 04:52:32 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ```  [Comment 7](show_bug.cgi?id=841706#c7)  Fedora Update System    2012-08-20 10:54:56 UTC  ``` pcp-3.6.5-1.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 8](show_bug.cgi?id=841706#c8)  Fedora Update System    2012-08-20 10:57:25 UTC  ``` pcp-3.6.5-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=841706#c9)  Fedora Update System    2012-08-21 18:34:36 UTC  ``` pcp-3.6.5-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 10](show_bug.cgi?id=841706#c10)  Fedora Update System    2012-08-21 18:38:22 UTC  ``` pcp-3.6.5-1.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 11](show_bug.cgi?id=841706#c11)  Fedora Update System    2012-09-18 00:01:17 UTC  ``` pcp-3.6.5-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841706&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_9399db25_20250126_100342.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_8188bd1b_20250126_100338.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2012-3420)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2012-3420)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2012-3420)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841704

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841704**](show_bug.cgi?id=841704)
(CVE-2012-3420)
- [CVE-2012-3420](https://access.redhat.com/security/cve/CVE-2012-3420) pcp: two memory leaks can lead to pcmd crash or trigger OOM killer

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-3420 pcp: two memory leaks can lead to pcmd crash or trigger OOM killer

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-3420 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [841298](show_bug.cgi?id=841298 "CLOSED ERRATA - pmcd leaks memory in DoFetch error path") [841319](show_bug.cgi?id=841319 "CLOSED ERRATA - In-band signalling in __pmGetPDU leads to pmcd memory leak") [848451](show_bug.cgi?id=848451) [848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]") [848630](show_bug.cgi?id=848630) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [841708](show_bug.cgi?id=841708) | | TreeView+ | [depends on](buglist.cgi?bug_id=841704&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841704&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-19 22:40 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:54 UTC ([History](show_activity.cgi?id=841704)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  fche fweimer kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp 3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-01-22 16:57:15 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841704#c0)  Vincent Danen    2012-07-19 22:40:11 UTC  ``` Florian Weimer of the Red Hat Product Security Team discovered two memory leaks in libpcp that can be abused by an unauthenticated remote attacker to crash pmcd (the PCP (Performance Co-Pilot) performance metrics collector daemon) or to consume enough memory to trigger the OOM killer, which may have impact on other processes.   ```  [Comment 1](show_bug.cgi?id=841704#c1)  Vincent Danen    2012-07-19 22:41:43 UTC  ``` This CVE comprises of two flaws:  [bug #841298](show_bug.cgi?id=841298 "CLOSED ERRATA - pmcd leaks memory in DoFetch error path")  pmcd leaks memory in DoFetch error path [bug #841319](show_bug.cgi?id=841319 "CLOSED ERRATA - In-band signalling in __pmGetPDU leads to pmcd memory leak")  In-band signaling in __pmGetPDU causes pmcd memory leak  Both bugs have respective upstream patches which addresses them.   ```  [Comment 3](show_bug.cgi?id=841704#c3)  Huzaifa S. Sidhpurwala    2012-08-16 04:46:46 UTC  ``` Created pcp tracking bugs for this issue  Affects: epel-all [[bug 848629](show_bug.cgi?id=848629 "CLOSED ERRATA - CVE-2012-3418 CVE-2012-3419 CVE-2012-3420 CVE-2012-3421 pcp various flaws [epel-all]")]   ```  [Comment 4](show_bug.cgi?id=841704#c4)  Huzaifa S. Sidhpurwala    2012-08-17 04:52:23 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ```  [Comment 5](show_bug.cgi?id=841704#c5)  Fedora Update System    2012-08-20 10:54:46 UTC  ``` pcp-3.6.5-1.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=841704#c6)  Fedora Update System    2012-08-20 10:57:17 UTC  ``` pcp-3.6.5-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 7](show_bug.cgi?id=841704#c7)  Fedora Update System    2012-08-21 18:34:28 UTC  ``` pcp-3.6.5-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 8](show_bug.cgi?id=841704#c8)  Fedora Update System    2012-08-21 18:38:15 UTC  ``` pcp-3.6.5-1.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=841704#c9)  Fedora Update System    2012-09-18 00:01:06 UTC  ``` pcp-3.6.5-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841704&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_6e58d7ca_20250125_155114.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D841183)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D841183)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D841183)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 841183

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 841183**](show_bug.cgi?id=841183)
- Missing namelen check in \_\_pmDecodeFetch

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Missing namelen check in \_\_pmDecodeFetch

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | pcp | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 16 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nathan Scott | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [840765](show_bug.cgi?id=840765) [CVE-2012-3418](show_bug.cgi?id=841698 "CLOSED ERRATA - CVE-2012-3418 pcp: multiple integer and heap-based buffer overflow flaws") | | TreeView+ | [depends on](buglist.cgi?bug_id=841183&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=841183&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-07-18 11:19 UTC by Florian Weimer | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2012-08-20 03:54 UTC ([History](show_activity.cgi?id=841183)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  kenj mgoodwin nathans security-response-team | | Fixed In Version: | pcp-3.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-08-20 03:54:06 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Resolve issues in decoding PCP fetch PDUs**](attachment.cgi?id=599665 "View the content of the attachment") (1.27 KB, patch)  [2012-07-23 01:01 UTC](#attach_599665 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=599665&action=edit) | [Diff](attachment.cgi?id=599665&action=diff) | | [**Updated patch to address PCP fetch PDU decoding issues**](attachment.cgi?id=599891 "View the content of the attachment") (1.36 KB, patch)  [2012-07-24 02:40 UTC](#attach_599891 "Go to the comment associated with the attachment"), Nathan Scott | *no flags* | [Details](attachment.cgi?id=599891&action=edit) | [Diff](attachment.cgi?id=599891&action=diff) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=841183&action=viewall&hide_obsolete=1) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=841183#c0)  Florian Weimer    2012-07-18 11:19:55 UTC  ``` pmcd crashes when processing a crafted PDU_FETCH request because of a missing length check in __pmDecodeFetch.  Code execution through this bug appears unlikely because the loop which runs past the end of the PDU only performs byte swapping (on little-endian architectures).   ```  [Comment 2](show_bug.cgi?id=841183#c2)  Mark Goodwin    2012-07-22 23:45:42 UTC  ``` Nathan requested assignment, thanks Nathan.   ```  [Comment 3](show_bug.cgi?id=841183#c3)  Nathan Scott    2012-07-23 01:01:47 UTC  ``` Created [attachment 599665](attachment.cgi?id=599665&action=diff "Resolve issues in decoding PCP fetch PDUs") [[details]](attachment.cgi?id=599665&action=edit "Resolve issues in decoding PCP fetch PDUs") Resolve issues in decoding PCP fetch PDUs  Proposed fix attached.  Please review, thanks.   ```  [Comment 4](show_bug.cgi?id=841183#c4)  Florian Weimer    2012-07-23 11:38:01 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=841183#c3)) > Created [attachment 599665](attachment.cgi?id=599665&action=diff "Resolve issues in decoding PCP fetch PDUs") [[details]](attachment.cgi?id=599665&action=edit "Resolve issues in decoding PCP fetch PDUs") > Resolve issues in decoding PCP fetch PDUs >  > Proposed fix attached.  Please review, thanks.      if ((pduend - (char*)pp) != sizeof(fetch_t) + ((sizeof(pmID)) * (numpmid-1)))  The expression (sizeof(pmID)) * (numpmid-1) can overflow (for instance, if numpmid is 0x40000001), so the check does not catch all cases where numpmid and the actual number of elements disagree.   ```  [Comment 5](show_bug.cgi?id=841183#c5)  Nathan Scott    2012-07-24 02:40:10 UTC  ``` Created [attachment 599891](attachment.cgi?id=599891&action=diff "Updated patch to address PCP fetch PDU decoding issues") [[details]](attachment.cgi?id=599891&action=edit "Updated patch to address PCP fetch PDU decoding issues") Updated patch to address PCP fetch PDU decoding issues   ```  [Comment 6](show_bug.cgi?id=841183#c6)  Huzaifa S. Sidhpurwala    2012-08-16 03:53:43 UTC  ``` Upstream patch:  <http://oss.sgi.com/cgi-bin/gitweb.cgi?p=pcp/pcp.git;a=commit;h=7eb479b91ef12bf89a15b078af2107c8c4746a4a>  This issue has been addressed in pcp-3.6.5   ```  [Comment 7](show_bug.cgi?id=841183#c7)  Huzaifa S. Sidhpurwala    2012-08-20 03:54:06 UTC  ``` This issue was addressed in Fedora and EPEL via the following security updates:  Fedora-16: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc16> Fedora-17: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc17> Rawhide:   <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.fc18>  EPEL-5: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el5> EPEL-6: <https://admin.fedoraproject.org/updates/pcp-3.6.5-1.el6>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=841183&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


