```
Message-ID: <5029EA26.8070801@redhat.com>
Date: Tue, 14 Aug 2012 00:03:18 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: "Jason A. Donenfeld" <Jason@...c4.com>
Subject: Re: Tunnel Blick: Multiple Vulnerabilities to Local
 Root and DoS (OS X)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 08/13/2012 06:34 AM, Jason A. Donenfeld wrote:
> Hi Kurt,
>
> Sure, I'll trace each one, and include line numbers with the code.
> This code comes from:
> <http://code.google.com/p/tunnelblick/source/browse/trunk/tunnelblick/openvpnstart.m?r=2095>

Thanks,
>
without the details this would have been impossible, as it is
I'm going to break one CVE editorial rule, but I think it's for a good
reason (but I could also be wrong). So in summary:

==================
6. Allowing OpenVPN to run with user given configurations can lead to
local root.

Please use CVE-2012-3486 for this issue
==================
>
> 6. Allowing OpenVPN to run with user given configurations can lead
> to local root. 939	        if (  [configFile hasSuffix: @"tblk"]  )
> { 940	            unsigned  cfgLocCode = atoi(cfgLoc); 941
> switch (cfgLocCode) { 942	                case 0: 943
> configPrefix = [NSHomeDirectory()
> stringByAppendingPathComponent:@"/Library/Application
> Support/Tunnelblick/Configurations"]; 944
> break; 945	                case 1: 946
> configPrefix = [NSString stringWithFormat:@"/Library/Application
> Support/Tunnelblick/Users/%@", NSUserName()]; 947
> break; 948	                case 2: 949
> configPrefix = [execPath stringByAppendingPathComponent:
> @"Deploy"]; 950	                    break; 951	                case
> 3: 952	                    configPrefix = [NSString
> stringWithString: @"/Library/Application
> Support/Tunnelblick/Shared"]; 953	                    break; 954
> default: 955	                    break; 956	            } 957
> } The purpose of this SUID helper is so that users can run OpenVPN
> with their own provided configuration files as root. OpenVPN
> configuration files can run scripts based on various OpenVPN
> events.
>

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iQIcBAEBAgAGBQJQKeomAAoJEBYNRVNeJnmTLMwQALPTVxjFKEb4qtnsB5h0GGV+
LkgubkWO5RuaedLvQsWNqqxDDgDWRDMP+PRwicTLq1bqHJ4ifa54eJnm8q/yyinX
tXCsQrDE0O6f5jXrdEsoOwdeWRn82zD4diFAWEeOI7U166TRTYyFIAmIa0MDgZaw
PHNsS8RccDXOc/Rraz3iV/7sWzU6e6KpmW1vhpbXjxUz6zuSGHATTdPPFAC/sTwf
HycD1wMP1FmSbeBfoliLpb+Ibj+AZUCqsn4efwr0LgsZCmoKvpnEsbfRaNEaeARo
1LzGhCBFWgCSePmebmqWsYP9oPfWlRCwRWrCzX7j/Y272MytkYXbLeUfVQvPc0TW
okyfwtHvNpSHU5AqSMt2DmE62U/275feJgfRTmP4xDGOFE9UTiVKjFz2Jy//KRnY
KvLvoIC7SqPIQvy9bb8QE8IqMyKGq/oF1SP28iOsCSFDes+CRwkr6xXSILiDCzd9
5J4qNi0vSdp1EabQEHtOqwE9kITbO/pSCswd9KQDp8KHV5GeLV76XpBNVY1vDjH6
WWDC0715JQa+TrArCeOIJBI684sdvPPQcWB+P45j/OC4DKHOn4koRa0+LYingq5a
ntpw+fkdhhaf+3StaBlROOEHHkbhdxg8gZgGrRH8r5pQ0A8+bZXuZsJC1ezpp4BM
zN+hCjbnDxxU+5/2jZUr
=amtN
-----END PGP SIGNATURE-----
```
### Summary of CVE-2012-3486
- **Root cause of vulnerability**: The vulnerability stems from allowing OpenVPN to run with user-provided configurations as root.
- **Weaknesses/vulnerabilities present**: The SUID helper in Tunnelblick allows users to run OpenVPN with their own configuration files as root. OpenVPN configuration files can execute scripts based on various OpenVPN events, creating a security risk.
- **Impact of exploitation**: An attacker could gain local root privileges by crafting a malicious OpenVPN configuration file that includes shell scripts, that are then executed with root privileges.
- **Attack vectors**: The attack vector is through the use of a malicious OpenVPN configuration file crafted by an attacker.
- **Required attacker capabilities/position**: The attacker needs to be able to provide a custom OpenVPN configuration file to be used by Tunnelblick.