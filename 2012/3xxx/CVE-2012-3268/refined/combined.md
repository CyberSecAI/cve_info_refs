=== Content from www.kb.cert.org_a60a9d36_20250125_163913.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#225404

## HP/H3C and Huawei networking equipment h3c-user snmp vulnerability

#### Vulnerability Note VU#225404

Original Release Date: 2012-10-24 | Last Revised: 2012-10-26

---

### Overview

HP/H3C and Huawei networking equipment contains a vulnerability which could allow an attacker to access administrative functions of the device using systems network management protocol (SNMP) requests.

### Description

| According to the researcher's [report](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html).:  *"HP/H3C and Huawei networking equipment suffers from a serious weakness in regards to their handling of Systems Network Management Protocol (SNMP) requests for protected h3c-user.mib and hh3c-user.mib objects.**DetailsHuawei/H3C have two OIDs, 'old' and 'new': old: 1.3.6.1.4.1.2011.10 new: 1.3.6.1.4.1.25506Most devices support both formats.The MIBs h3c-user.mib and hh3c-user.mib, for the purpose of this document, will be referred to as (h)h3c-user.mib. This MIB defines the internal table and objects to "Manage configuration and Monitor running state for userlog feature."This means there are some cool objects with data in this MIB penetration testers or malicious actors would want to get their dirty little hands on. Most objects are only accessible with the read/write community string.In the revision history of (h)h3c-user.mib, version 2.0 modified the MAX-ACCESS from read-only to read-create the following objects within the (h)h3cUserInfoEntry sequence: (h)h3cUserName (h)h3cUserPassword (h)h3cAuthMode (h)h3cUserLevelThe purpose of these objects are to provide the locally configured users to those with a valid SNMP community. After the change only those with the read-write community string should have access, however this was not the case and the code still retained the earlier access of read-only.So if you have the SNMP public community string then you have the ability to view these entries."*Additional information can be found in the researcher's [report](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html) |
| --- |

### Impact

| A remote unauthenticated attacker can access administrative functions of the device using systems network management protocol (SNMP) requests. |
| --- |

### Solution

| **Update**HP: Customers are advised to check HP's [SSRT100962](https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03515685&ac.admitted=1350939600802.876444892.492883150) support document for instructions. Huawei [Security Advisory](http://support.huawei.com/enterprise/NewsReadAction.action?newType=0301&contentId=NEWS1000001069&idAbsPath=0301_10001&nameAbsPath=Services%2520News) states: "*On Oct. 19, Huawei PSIRT noticed the media report titled “Demo of "serious" networking vulnerabilities cancelled at HP's request-Saturday's Toorcon talk was to discuss risks posed by gear from H3C and Huawei” . Huawei PSIRT responded immediately and proactively coordinate Kurt Grutzmacher, US-CERT, CERT/CC and CNCERT to handle the issue. On Oct. 24, Huawei PSIRT finally acquired the technical details of the vulnerabilities from the public channel of US-CERT and launched shortly the vulnerability analysis and investigation to develop the mitigation measures. The first version of “SNMP vulnerability on Huawei multiple products” SA was released on Oct. 25. The investigation is still ongoing. Huawei PSIRT will keep updating the SA. Please refer to the above link.*" |
| --- |

| According to the researcher's [report](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html):*"By itself this is already bad but most users who do any of the following may already be protected: Use complex SNMP community strings or disable SNMPv1 Have disabled the mib entries for (h)h3c-user Block SNMP using access controls or firewalls Do not define local users, use RADIUS or TACACS+More specific routines can be found in the vendor's release."* |
| --- |

### Vendor Information

225404
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23225404/) to view vendors.**
### [Hewlett-Packard Company](#MAPG-8WWJA9) Affected

Notified:  August 06, 2012  Updated: October 24, 2012

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03515685&ac.admitted=1351086123601.876444892.492883150>

### [Huawei Technologies](#MORO-8ZDJDP) Affected

Updated:  October 26, 2012

### Status

Affected

### Vendor Statement

On Oct. 19, Huawei PSIRT noticed the media report titled �mo of "serious" networking vulnerabilities cancelled at HP's request-Saturday's Toorcon talk was to discuss risks posed by gear from H3C and Huawei” . Huawei PSIRT responded immediately and proactively coordinate Kurt Grutzmacher, US-CERT, CERT/CC and CNCERT to handle the issue. On Oct. 24, Huawei PSIRT finally acquired the technical details of the vulnerabilities from the public channel of US-CERT and launched shortly the vulnerability analysis and investigation to develop the mitigation measures. The first version of “SNMP vulnerability on Huawei multiple products” SA was released on Oct. 25. The investigation is still ongoing. Huawei PSIRT will keep updating the SA. Please refer to the above link.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <http://support.huawei.com/enterprise/NewsReadAction.action?newType=0301&contentId=NEWS1000001069&idAbsPath=0301_10001&nameAbsPath=Services%2520News>

### [3com Inc](#MAPG-8WWJA6) Unknown

Notified:  August 06, 2012  Updated: August 06, 2012

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9.3 | AV:N/AC:M/Au:N/C:C/I:C/A:C |
| Temporal | 7.7 | E:F/RL:OF/RC:C |
| Environmental | 7.7 | CDP:MH/TD:H/CR:ND/IR:ND/AR:ND |

### References

* <http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html>
* <https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03515685&ac.admitted=1351086123601.876444892.492883150>
* <http://support.huawei.com/enterprise/NewsReadAction.action?newType=0301&contentId=NEWS1000001069&idAbsPath=0301_10001&nameAbsPath=Services%2520News>
### Acknowledgements

Thanks to Kurt Grutzmacher for reporting this vulnerability.

This document was written by Michael Orlando.

### Other Information

| **CVE IDs:** | [CVE-2012-3268](http://web.nvd.nist.gov/vuln/detail/CVE-2012-3268) |
| --- | --- |
| **Date Public:** | 2012-10-23 |
| **Date First Published:** | 2012-10-24 |
| **Date Last Updated:** | 2012-10-26 12:39 UTC |
| **Document Revision:** | 16 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from grutztopia.jingojango.net_2ae22d36_20250125_163909.html ===


# [Superimposing Nothing Nowhere](http://grutztopia.jingojango.net/)

The internet is littered with wastes of space. This one is no different except that it is my waste of space.

## Tuesday, October 23, 2012

### HP/H3C and Huawei SNMP Weak Access to Critical Data

## HP/H3C and Huawei SNMP Weak Access to Critical Data

### Overview

HP/H3C and Huawei networking equipment suffers from a serious weakness in regards to their handling of Systems Network Management Protocol (SNMP) requests for protected h3c-user.mib and hh3c-user.mib objects.

### Identifiers

* US-CERT [VU#225404](http://www.kb.cert.org/vuls/id/225404)
* [CVE-2012-3268](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3268)

### Vendor releases

#### HP/H3C:

#### * <https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03515685&ac.admitted=1350939600802.876444892.492883150>

#### Huawei EBG:

* SN: <http://support.huawei.com/enterprise/NewsReadAction.action?newType=0301&contentId=NEWS1000001069&idAbsPath=0301_10001&nameAbsPath=Services%2520News>

#### Huawei CBG:

* SN: <http://support.huawei.com/support/pages/news/NewsInfoAction.do?doc_id=IN0000054625&colID=ROOTENWEB|CO0000000170&actionFlag=view>

### Researcher

 Kurt Grutzmacher
 grutz <at> jingojango dot net
 <http://grutztopia.jingojango.net/>
 twitter: [@grutz](https://twitter.com/grutz)

### Details

Huawei/H3C have two OIDs, 'old' and 'new':

* old: 1.3.6.1.4.1.2011.10
* new: 1.3.6.1.4.1.25506

Most devices support both formats.

The MIBs h3c-user.mib and hh3c-user.mib, for the purpose of this document, will be referred to as (h)h3c-user.mib. This MIB defines the internal table and objects to "Manage configuration and Monitor running state for userlog feature."

This means there are some cool objects with data in this MIB penetration testers or malicious actors would want to get their dirty little hands on. Most objects are only accessible with the read/write community string.

In the revision history of (h)h3c-user.mib, version 2.0 modified the MAX-ACCESS from read-only to read-create the following objects within the (h)h3cUserInfoEntry sequence:

* (h)h3cUserName
* (h)h3cUserPassword
* (h)h3cAuthMode
* (h)h3cUserLevel

The purpose of these objects are to provide the locally configured users to those with a valid SNMP community. After the change only those with the read-write community string should have access, however this was not the case and the code still retained the earlier access of read-only.

So if you have the SNMP public community string then you have the ability to view these entries.

### Why this is impactful

The (h)h3cUserPassword is presented in one of three formats as defined in the (h)h3cAuthMode object and mirrors how passwords are stored in the device configuration:

* 0 -- password simple, meaning cleartext
* 7 -- password cipher, meaning ciphertext
* 9 -- password sha-256, meaning one-way sha-256 hash

SHA-256 is a recent addition and is not supported on all devices yet.

On top of this the (h)h3cUserLevel can be 0 to 3 where 0 is limited access and 3 is full access.

### Globbing some users

You must have an SNMP read-only or read-write string and access to the
SNMP port (udp/161) for this to work:
> $ snmpwalk –c public –v 1 $IP 1.3.6.1.4.1.2011.10.2.12.1.1.1

or
> $ snmpwalk –c public –v 1 $IP 1.3.6.1.4.1.25506.2.12.1.1.1

### Weaponizing

Files relevant to this disclosure:

* hh3c-localuser-enum.rb - Metasploit auxiliary scanner module
* snmp-h3c-login.nse - Nmap Scripting Engine module

These will soon be posted to <https://github.com/grutz/h3c-pt-tools> and requested to be added to each tool.

### Mitigation

By itself this is already bad but most users who do any of the following may already be protected:

* Use complex SNMP community strings or disable SNMPv1
* Have disabled the mib entries for (h)h3c-user
* Block SNMP using access controls or firewalls
* Do not define local users, use RADIUS or TACACS+

More specific routines can be found in the vendor's release.

### Why this is a bigger problem

People make poor choices. They like to think their equipment won't rat them out so they use cleartext passwords on networking equipment.

The cipher is an interesting one because it's basically an unknown... What, you think the only thing I had to share at Toorcon was SNMP and some cleartext credentials?

### Timeline

*June-ish 2012*: Research begins after seeing something cool on a penetration test

*August 6, 2012*: Contacted US-CERT to coordinate vendor disclosure, VU#225404

*September 5, 2012*: No response from H3C, contacted US-CERT again

*September 6, 2012*: H3C (through US-CERT) requests more time, I state intention to present findings at Toorcon (Oct 19/20, 2012) or disclose if talk not accepted.

*September 18, 2012*: Approved for Toorcon! Information goes up not long after on Toorcon website.

*September 18-October 16, 2012*: Build slides, work on tools, no contact with US-CERT or vendors.

*October 16, 2012*: HP contacts me directly asking that I not present  this information at Toorcon

*October 18, 2012*: Publicly state agreement to cancel the Toorcon talk

*October 22, 2012*: HP discloses! What what? Why bother putting any pressure not to give the talk if you're gonna give everything out 2 days later?

*October 23, 2012*: So I publish.

at

[10:19 AM](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/28687371/4267916520961621888 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=28687371&postID=4267916520961621888&from=pencil "Edit Post")

Labels:
[h3c](http://grutztopia.jingojango.net/search/label/h3c),
[huawei](http://grutztopia.jingojango.net/search/label/huawei),
[security](http://grutztopia.jingojango.net/search/label/security),
[toorcon](http://grutztopia.jingojango.net/search/label/toorcon)

#### 1 comment:

[![](//www.blogger.com/img/blogger_logo_round_35.png "Unknown")](https://www.blogger.com/profile/03977082338285751651)
[Unknown](https://www.blogger.com/profile/03977082338285751651)
said...

This is a really helpful way of putting it all together and explaining it in detail. Surely, [enterprise network management tools](http://netsas.com.au/enterprise-network-management/) are very much helpful in a speedy production for companies.

[12:10 AM](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html?showComment=1353399034927#c1669195268464777769 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=28687371&postID=1669195268464777769 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/28687371/4267916520961621888)

[Newer Post](http://grutztopia.jingojango.net/2012/10/crack-all-hashes.html "Newer Post")

[Older Post](http://grutztopia.jingojango.net/2012/10/on-hph3c-and-schrodingers-disclosure.html "Older Post")

[Home](http://grutztopia.jingojango.net/)

Subscribe to:
[Post Comments (Atom)](http://grutztopia.jingojango.net/feeds/4267916520961621888/comments/default)

## Subscribe To

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=http%3A%2F%2Fgrutztopia.jingojango.net%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=http%3A%2F%2Fgrutztopia.jingojango.net%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](http://grutztopia.jingojango.net/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=http%3A%2F%2Fgrutztopia.jingojango.net%2Ffeeds%2F4267916520961621888%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=http%3A%2F%2Fgrutztopia.jingojango.net%2Ffeeds%2F4267916520961621888%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](http://grutztopia.jingojango.net/feeds/4267916520961621888/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

## Contributors

* [Kurt Grutzmacher](https://www.blogger.com/profile/07238514087343942495)
* [Unknown](https://www.blogger.com/profile/04585230141295452096)

## Exploits and Codes

* [Exploits and Codes](http://grutz.jingojango.net/exploits/)
* [LinkedIn Profile](http://www.linkedin.com/in/grutz)

## Twitter Updates

[Tweets by @grutz](https://twitter.com/grutz)

| [Subscribe in a reader](http://feeds.feedburner.com/grutztopia "Subscribe to my feed") | Topics  * [security](http://grutztopia.jingojango.net/search/label/security)   (21) * [defcon](http://grutztopia.jingojango.net/search/label/defcon)   (11) * [web security](http://grutztopia.jingojango.net/search/label/web%20security)   (10) * [metasploit](http://grutztopia.jingojango.net/search/label/metasploit)   (7) * [crack me if you can](http://grutztopia.jingojango.net/search/label/crack%20me%20if%20you%20can)   (6) * [john the ripper](http://grutztopia.jingojango.net/search/label/john%20the%20ripper)   (5) * [karma](http://grutztopia.jingojango.net/search/label/karma)   (4) * [macworld](http://grutztopia.jingojango.net/search/label/macworld)   (4) * [madwifi](http://grutztopia.jingojango.net/search/label/madwifi)   (4) * [wireless security](http://grutztopia.jingojango.net/search/label/wireless%20security)   (4) * [huawei](http://grutztopia.jingojango.net/search/label/huawei)   (3) * [macintosh](http://grutztopia.jingojango.net/search/label/macintosh)   (3) * [pass the hash](http://grutztopia.jingojango.net/search/label/pass%20the%20hash)   (3) * [squirtle](http://grutztopia.jingojango.net/search/label/squirtle)   (3) * [toorcon](http://grutztopia.jingojango.net/search/label/toorcon)   (3) * [ISACA ISACA ISACA](http://grutztopia.jingojango.net/search/label/ISACA%20ISACA%20ISACA)   (2) * [OWASP](http://grutztopia.jingojango.net/search/label/OWASP)   (2) * [canvas](http://grutztopia.jingojango.net/search/label/canvas)   (2) * [ccc](http://grutztopia.jingojango.net/search/label/ccc)   (2) * [deepsec](http://grutztopia.jingojango.net/search/label/deepsec)   (2) * [h3c](http://grutztopia.jingojango.net/search/label/h3c)   (2) * [hacking](http://grutztopia.jingojango.net/search/label/hacking)   (2) * [macworld2007](http://grutztopia.jingojango.net/search/label/macworld2007)   (2) * [pass the dutchie](http://grutztopia.jingojango.net/search/label/pass%20the%20dutchie)   (2) * [securityopus](http://grutztopia.jingojango.net/search/label/securityopus)   (2) * [syscan](http://grutztopia.jingojango.net/search/label/syscan)   (2) * [trademark](http://grutztopia.jingojango.net/search/label/trademark)   (2) * [xss](http://grutztopia.jingojango.net/search/label/xss)   (2) * [NTLM](http://grutztopia.jingojango.net/search/label/NTLM)   (1) * [baysec](http://grutztopia.jingojango.net/search/label/baysec)   (1) * [berksec](http://grutztopia.jingojango.net/search/label/berksec)   (1) * [bindiffsuite](http://grutztopia.jingojango.net/search/label/bindiffsuite)   (1) * [cachedump](http://grutztopia.jingojango.net/search/label/cachedump)   (1) * [core impact](http://grutztopia.jingojango.net/search/label/core%20impact)   (1) * [halflmchall](http://grutztopia.jingojango.net/search/label/halflmchall)   (1) * [hashcat](http://grutztopia.jingojango.net/search/label/hashcat)   (1) * [hp](http://grutztopia.jingojango.net/search/label/hp)   (1) * [ida](http://grutztopia.jingojango.net/search/label/ida)   (1) * [internet domain bully](http://grutztopia.jingojango.net/search/label/internet%20domain%20bully)   (1) * [lanman](http://grutztopia.jingojango.net/search/label/lanman)   (1) * [ms cache passwords](http://grutztopia.jingojango.net/search/label/ms%20cache%20passwords)   (1) * [nmap](http://grutztopia.jingojango.net/search/label/nmap)   (1) * [osx](http://grutztopia.jingojango.net/search/label/osx)   (1) * [otiii](http://grutztopia.jingojango.net/search/label/otiii)   (1) * [rainbow tables](http://grutztopia.jingojango.net/search/label/rainbow%20tables)   (1) * [rainbowcrack](http://grutztopia.jingojango.net/search/label/rainbowcrack)   (1) * [reverse engineering](http://grutztopia.jingojango.net/search/label/reverse%20engineering)   (1) * [scientology](http://grutztopia.jingojango.net/search/label/scientology)   (1) * [superbowl](http://grutztopia.jingojango.net/search/label/superbowl)   (1) * [trolls](http://grutztopia.jingojango.net/search/label/trolls)   (1) * [virtualization](http://grutztopia.jingojango.net/search/label/virtualization)   (1) * [vmware fusion](http://grutztopia.jingojango.net/search/label/vmware%20fusion)   (1) * [xenu](http://grutztopia.jingojango.net/search/label/xenu)   (1) |
| --- | --- |

## Blog Archive

* ►
  [2013](http://grutztopia.jingojango.net/2013/)
  (2)
  + ►
    [August](http://grutztopia.jingojango.net/2013/08/)
    (2)

* ▼
  [2012](http://grutztopia.jingojango.net/2012/)
  (4)
  + ►
    [November](http://grutztopia.jingojango.net/2012/11/)
    (1)
  + ▼
    [October](http://grutztopia.jingojango.net/2012/10/)
    (3)
    - [Crack All The Hashes!](http://grutztopia.jingojango.net/2012/10/crack-all-hashes.html)
    - [HP/H3C and Huawei SNMP Weak Access to Critical Data](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html)
    - [On HP/H3C and Schrödinger's Disclosure](http://grutztopia.jingojango.net/2012/10/on-hph3c-and-schrodingers-disclosure.html)

* ►
  [2011](http://grutztopia.jingojango.net/2011/)
  (4)
  + ►
    [August](http://grutztopia.jingojango.net/2011/08/)
    (4)

* ►
  [2009](http://grutztopia.jingojango.net/2009/)
  (1)
  + ►
    [February](http://grutztopia.jingojango.net/2009/02/)
    (1)

* ►
  [2008](http://grutztopia.jingojango.net/2008/)
  (12)
  + ►
    [November](http://grutztopia.jingojango.net/2008/11/)
    (2)
  + ►
    [September](http://grutztopia.jingojango.net/2008/09/)
    (1)
  + ►
    [August](http://grutztopia.jingojango.net/2008/08/)
    (2)
  + ►
    [July](http://grutztopia.jingojango.net/2008/07/)
    (1)
  + ►
    [June](http://grutztopia.jingojango.net/2008/06/)
    (2)
  + ►
    [May](http://grutztopia.jingojango.net/2008/05/)
    (1)
  + ►
    [February](http://grutztopia.jingojango.net/2008/02/)
    (1)
  + ►
    [January](http://grutztopia.jingojango.net/2008/01/)
    (2)

* ►
  [2007](http://grutztopia.jingojango.net/2007/)
  (21)
  + ►
    [November](http://grutztopia.jingojango.net/2007/11/)
    (1)
  + ►
    [October](http://grutztopia.jingojango.net/2007/10/)
    (3)
  + ►
    [August](http://grutztopia.jingojango.net/2007/08/)
    (2)
  + ►
    [July](http://grutztopia.jingojango.net/2007/07/)
    (2)
  + ►
    [May](http://grutztopia.jingojango.net/2007/05/)
    (3)
  + ►
    [April](http://grutztopia.jingojango.net/2007/04/)
    (2)
  + ►
    [March](http://grutztopia.jingojango.net/2007/03/)
    (2)
  + ►
    [February](http://grutztopia.jingojango.net/2007/02/)
    (2)
  + ►
    [January](http://grutztopia.jingojango.net/2007/01/)
    (4)

* ►
  [2006](http://grutztopia.jingojango.net/2006/)
  (4)
  + ►
    [September](http://grutztopia.jingojango.net/2006/09/)
    (3)
  + ►
    [May](http://grutztopia.jingojango.net/2006/05/)
    (1)

|  |  |
| --- | --- |

Awesome Inc. theme. Powered by [Blogger](https://www.blogger.com).



=== Content from www.kb.cert.org_51835d37_20250125_163912.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#225404

## HP/H3C and Huawei networking equipment h3c-user snmp vulnerability

#### Vulnerability Note VU#225404

Original Release Date: 2012-10-24 | Last Revised: 2012-10-26

---

### Overview

HP/H3C and Huawei networking equipment contains a vulnerability which could allow an attacker to access administrative functions of the device using systems network management protocol (SNMP) requests.

### Description

| According to the researcher's [report](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html).:  *"HP/H3C and Huawei networking equipment suffers from a serious weakness in regards to their handling of Systems Network Management Protocol (SNMP) requests for protected h3c-user.mib and hh3c-user.mib objects.**DetailsHuawei/H3C have two OIDs, 'old' and 'new': old: 1.3.6.1.4.1.2011.10 new: 1.3.6.1.4.1.25506Most devices support both formats.The MIBs h3c-user.mib and hh3c-user.mib, for the purpose of this document, will be referred to as (h)h3c-user.mib. This MIB defines the internal table and objects to "Manage configuration and Monitor running state for userlog feature."This means there are some cool objects with data in this MIB penetration testers or malicious actors would want to get their dirty little hands on. Most objects are only accessible with the read/write community string.In the revision history of (h)h3c-user.mib, version 2.0 modified the MAX-ACCESS from read-only to read-create the following objects within the (h)h3cUserInfoEntry sequence: (h)h3cUserName (h)h3cUserPassword (h)h3cAuthMode (h)h3cUserLevelThe purpose of these objects are to provide the locally configured users to those with a valid SNMP community. After the change only those with the read-write community string should have access, however this was not the case and the code still retained the earlier access of read-only.So if you have the SNMP public community string then you have the ability to view these entries."*Additional information can be found in the researcher's [report](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html) |
| --- |

### Impact

| A remote unauthenticated attacker can access administrative functions of the device using systems network management protocol (SNMP) requests. |
| --- |

### Solution

| **Update**HP: Customers are advised to check HP's [SSRT100962](https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03515685&ac.admitted=1350939600802.876444892.492883150) support document for instructions. Huawei [Security Advisory](http://support.huawei.com/enterprise/NewsReadAction.action?newType=0301&contentId=NEWS1000001069&idAbsPath=0301_10001&nameAbsPath=Services%2520News) states: "*On Oct. 19, Huawei PSIRT noticed the media report titled “Demo of "serious" networking vulnerabilities cancelled at HP's request-Saturday's Toorcon talk was to discuss risks posed by gear from H3C and Huawei” . Huawei PSIRT responded immediately and proactively coordinate Kurt Grutzmacher, US-CERT, CERT/CC and CNCERT to handle the issue. On Oct. 24, Huawei PSIRT finally acquired the technical details of the vulnerabilities from the public channel of US-CERT and launched shortly the vulnerability analysis and investigation to develop the mitigation measures. The first version of “SNMP vulnerability on Huawei multiple products” SA was released on Oct. 25. The investigation is still ongoing. Huawei PSIRT will keep updating the SA. Please refer to the above link.*" |
| --- |

| According to the researcher's [report](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html):*"By itself this is already bad but most users who do any of the following may already be protected: Use complex SNMP community strings or disable SNMPv1 Have disabled the mib entries for (h)h3c-user Block SNMP using access controls or firewalls Do not define local users, use RADIUS or TACACS+More specific routines can be found in the vendor's release."* |
| --- |

### Vendor Information

225404
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23225404/) to view vendors.**
### [Hewlett-Packard Company](#MAPG-8WWJA9) Affected

Notified:  August 06, 2012  Updated: October 24, 2012

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03515685&ac.admitted=1351086123601.876444892.492883150>

### [Huawei Technologies](#MORO-8ZDJDP) Affected

Updated:  October 26, 2012

### Status

Affected

### Vendor Statement

On Oct. 19, Huawei PSIRT noticed the media report titled �mo of "serious" networking vulnerabilities cancelled at HP's request-Saturday's Toorcon talk was to discuss risks posed by gear from H3C and Huawei” . Huawei PSIRT responded immediately and proactively coordinate Kurt Grutzmacher, US-CERT, CERT/CC and CNCERT to handle the issue. On Oct. 24, Huawei PSIRT finally acquired the technical details of the vulnerabilities from the public channel of US-CERT and launched shortly the vulnerability analysis and investigation to develop the mitigation measures. The first version of “SNMP vulnerability on Huawei multiple products” SA was released on Oct. 25. The investigation is still ongoing. Huawei PSIRT will keep updating the SA. Please refer to the above link.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <http://support.huawei.com/enterprise/NewsReadAction.action?newType=0301&contentId=NEWS1000001069&idAbsPath=0301_10001&nameAbsPath=Services%2520News>

### [3com Inc](#MAPG-8WWJA6) Unknown

Notified:  August 06, 2012  Updated: August 06, 2012

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9.3 | AV:N/AC:M/Au:N/C:C/I:C/A:C |
| Temporal | 7.7 | E:F/RL:OF/RC:C |
| Environmental | 7.7 | CDP:MH/TD:H/CR:ND/IR:ND/AR:ND |

### References

* <http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html>
* <https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03515685&ac.admitted=1351086123601.876444892.492883150>
* <http://support.huawei.com/enterprise/NewsReadAction.action?newType=0301&contentId=NEWS1000001069&idAbsPath=0301_10001&nameAbsPath=Services%2520News>
### Acknowledgements

Thanks to Kurt Grutzmacher for reporting this vulnerability.

This document was written by Michael Orlando.

### Other Information

| **CVE IDs:** | [CVE-2012-3268](http://web.nvd.nist.gov/vuln/detail/CVE-2012-3268) |
| --- | --- |
| **Date Public:** | 2012-10-23 |
| **Date First Published:** | 2012-10-24 |
| **Date Last Updated:** | 2012-10-26 12:39 UTC |
| **Document Revision:** | 16 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


