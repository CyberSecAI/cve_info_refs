=== Content from knoxin.blogspot.co.uk_ff63d8e9_20250124_172504.html ===


# [The Litany of Knox in Box](http://knoxin.blogspot.com/)

## Wednesday, 6 June 2012

### Revelation password manager considered harmful (but now fixed)

**UPDATE:** It would appear that most of these issues have now been corrected in the latest version of Revelation, which is great. I leave the post below just for historical reference.

Personally, I have changed to using [keepassx](http://www.keepassx.org/), which has some really nice features (like password auto-type) and has an Android app to go with it.

---

I am writing this post to draw attention to long-standing security issues in the [revelation](http://revelation.olasagasti.info/) password manager.

I should start off by saying that I was not the first person to find these issues. Erik Grinaker, the original author, planned a [new revelation file format](http://oss.codepoet.no/revelation/wiki/FileFormatSpec) to address some of these issues in 2009. However, it seems he stopped maintaining the project around that time. Later, Jakob Westhoff noted these security problems in a [2010 blog post](http://westhoffswelt.de/blog/0046_from_revelation_security_to_android_password_managers.html) and wrote a fork which improved the security (though probably not by enough), but it was not merged into the revelation mainline. After sitting unmaintained for over a year, Mikel Olasagasti Uranga became the new maintainer.

This security issue went more-or-less unnoticed until February this year when someone posted this [issue](http://oss.codepoet.no/revelation/issue/61/file-format-magic-string-version-mismatch) on the revelation bug tracker. Despite being marked as a "critical" bug, it is still yet to be fixed, while plenty of less important things have been changed and new versions have been released.

As a user of revelation, I was first aware of Jakob's post last year, and while I found it quite concerning, I was busy and didn't do anything about it at the time. I also assumed that it was just a theoretical weakness and that I didn't have much to worry about. It wasn't really until now that I looked into it and saw just how serious this is. I [posted](http://oss.codepoet.no/revelation/issue/61/file-format-magic-string-version-mismatch#comment-1515082) on the revelation bug tracker today explaining the real-world implications for this.

To summarise, recent generations of desktop Intel processors can decrypt a 64 byte
buffer (enough to test a key) with AES256 in [under 384 cycles](http://software.intel.com/file/27067). Running 12
threads concurrently on a high-end desktop PC (6 cores, hyper-threaded,
3.9Ghz) could probably average 70 cycles per key tested, or about 55,714,285 keys/second. Checking to ensure we got the expected output would
take a bit more time, so let's conservatively estimate that we can test 25,000,000
keys/second.

While it would take on the order of 1061 years to crack on average by guessing arbitrary 256 bit keys, revelation's implementation is so insecure that **an alphanumeric (a-z A-Z 0-9) password with 8 characters can be cracked in a little over 7 weeks on average**. This is because it just takes the password (worth not much more than ~50 bits) and sticks about 200 bits of zeros on the end (effectively cutting the time to crack the key by a factor of 2200.)

If that can be done with a single machine, imagine how fast it would be with a custom hardware solution. Yes, you may be using a more complicated password than 8 alphanumeric
characters, but even still your plain text password is probably still
crackable in a reasonable time-frame given enough resources.

Essentially, relatively short plain text passwords don't have anywhere near 256 bits of entropy. ASCII password characters have around 6-7 bits of entropy each, so even 10 characters will give you no more than 70 bits of entropy. The way to get around this is to make it slower to compute the key from the password text. Specifically, if testing a key requires K cycles to compute the key and D cycles to test it, changing to a more complicated [key derivation function](http://en.wikipedia.org/wiki/Key_derivation_function) (KDF) K2 will effectively "add" *log*2(K2+D)-*log*2(K+D) bits of entropy.

While Erik's 2009 proposed file format mentions [PBKDF2](http://en.wikipedia.org/wiki/PBKDF2),
a secure key derivation function, his pseudocode just uses 10,000
iterations of SHA256 without combining the salt or password into the
hash function again. Jakob's fork was similar, and is probably not secure enough either.
Given that revelation only needs to compute the key once (when the file
is first opened), if it takes a second or two to open this would not be
much of a problem.

With the CPU above where a key can be tested in 384 cycles, extending the key derivation to take ~1 second would add about 23 bits of effective entropy (though you'd probably want to base the timing on older hardware). Using a cryptographically secure salt would also prevent a collection of different revelation password databases being cracked simultaneously. Slowing the key testing by using memory-intensive algorithms would also likely be several orders of magnitude better than simple hashing iterations, since they render CPU caches ineffective and custom hardware attacks impractical (see [scrypt](http://www.bsdcan.org/2009/schedule/events/147.en.html), for example).

So, what should be done about this?

1. As much as I love revelation, it is unacceptable to be using in its current form. **Anyone using or distributing it should consider it as effectively compromised until it is fixed.** As of today, I am going to look into other password managers to use until it is fixed (if you recommend any, please comment).
2. The authors need to make it a priority to fix this. Essentially, revelation needs to use a better [key derivation function](http://en.wikipedia.org/wiki/Key_derivation_function) (KDF). Furthermore, revelation should **show the user their password strength** for the database as it would when adding a password to the database. Since slowing down the key derivation can only add at most around 20 bits of entropy (about 3 characters worth), **it's still important for users to choose long and varied passwords** (between 15 and 20 characters) to give enough entropy for AES encryption. Furthermore, revelation could even time how long it takes to compute the key and decrypt the beginning of a file to guess, based on their password length/complexity, how many years it would take to crack if a machine with 1000x as much power were available. Anything that comes in at under 2000 years is much too weak (don't forget Moore's law.)
3. Old password databases should be **converted to the new format** and for disclosure of this issue **users should be notified that their old revelation password databases are potentially insecure** and that they should attempt to update or erase any of their older databases.
4. People need to **spread the word** in the Linux community about this.

UPDATE: Looking through the revelation code to see if any of the other formats revelation supports are more secure (many are, but not as much as I'd like; not many use salts that are long/varied enough or hashed properly), I discovered that the **fpm exporter doesn't encrypt the passwords at all**. Even though it asks the user for a password when exporting or importing, it actually only uses it to encrypt the version number, leaving everything else in plain text. Checking the source history, I found this has been **broken since 2004**.

I found that Martin Schwenke publicly posted a [comment regarding this some time ago](http://als.regnet.cz/fpm2/feedback/2), so I don't consider this to be an irresponsible disclosure.

Posted by
KMan

at

[10:11](http://knoxin.blogspot.com/2012/06/revelation-password-manager-considered.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=8747418046366160242&postID=4551320025928905462&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=8747418046366160242&postID=4551320025928905462&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=8747418046366160242&postID=4551320025928905462&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=8747418046366160242&postID=4551320025928905462&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=8747418046366160242&postID=4551320025928905462&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=8747418046366160242&postID=4551320025928905462&target=pinterest "Share to Pinterest")

Labels:
[cryptography](http://knoxin.blogspot.com/search/label/cryptography),
[encryption](http://knoxin.blogspot.com/search/label/encryption),
[gnome](http://knoxin.blogspot.com/search/label/gnome),
[linux](http://knoxin.blogspot.com/search/label/linux),
[passwords](http://knoxin.blogspot.com/search/label/passwords),
[revelation](http://knoxin.blogspot.com/search/label/revelation),
[security](http://knoxin.blogspot.com/search/label/security),
[software](http://knoxin.blogspot.com/search/label/software)

#### 2 comments:

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Zizzle](https://www.blogger.com/profile/09823352407494586608)[23 June 2012 at 11:34](http://knoxin.blogspot.com/2012/06/revelation-password-manager-considered.html?showComment=1340476441152#c6834665600104284015)

   Any recommendations on what to migrate to?

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=8747418046366160242&postID=6834665600104284015)Replies
   Reply
2. ![](//www.blogger.com/img/blogger_logo_round_35.png)[KMan](https://www.blogger.com/profile/09975220302155909625)[24 June 2012 at 06:52](http://knoxin.blogspot.com/2012/06/revelation-password-manager-considered.html?showComment=1340545943185#c5124050576760836260)

   Good question. I'm still looking for something suitable. At the moment I've restricted the options to just two or three, but even these I'm still hesitant about. If I'm going to switch to another program for better security, I may as well make sure it's \_really\_ secure.

   Essentially, what I am looking for is:
   1) A fully encrypted file. Having just passwords encrypted leaves too much information about what you have passwords for.
   2) A key derivation of genuine difficulty. I like the idea of using a lot of memory to do this. Even 10MB or something is cheap for the majority of machines now, but puts a big limit on how quickly you can crack it.
   3) Good data handling practices; automatic re-locking if idle, minimising the amount of sensitive data in memory at any given point, ensuring that the process can't be ptrace()'d by userspace applications a.

   So far I can't find much with all three of these properties, so it may be a matter of finding which one would need the least work to make it secure.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=8747418046366160242&postID=5124050576760836260)Replies
   Reply

Add commentLoad more...

[Older Post](http://knoxin.blogspot.com/2012/05/fine-line-between-reminding-and-nagging.html "Older Post")

[Home](http://knoxin.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://knoxin.blogspot.com/feeds/4551320025928905462/comments/default)

## Search

## Blog Archive

* ▼
  [2012](http://knoxin.blogspot.com/2012/)
  (2)
  + ▼
    [June](http://knoxin.blogspot.com/2012/06/)
    (1)
    - [Revelation password manager considered harmful (bu...](http://knoxin.blogspot.com/2012/06/revelation-password-manager-considered.html)
  + ►
    [May](http://knoxin.blogspot.com/2012/05/)
    (1)

|  |  |
| --- | --- |

Awesome Inc. theme. Powered by [Blogger](https://www.blogger.com).


