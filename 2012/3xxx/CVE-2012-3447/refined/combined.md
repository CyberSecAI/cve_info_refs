=== Content from access.redhat.com_a1087705_20250126_063959.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_6c18a7cf_20250126_064001.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-xc4g-7vw8-924h)

**CVE-2012-3447**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-xc4g-7vw8-924h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2012-3447](/advisories/GHSA-xc4g-7vw8-924h)

## Arbitrary file overwrite in OpenStack Nova

High severity

GitHub Reviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Oct 1, 2024

[Vulnerability details](/advisories/GHSA-xc4g-7vw8-924h)
[Dependabot alerts
0](/advisories/GHSA-xc4g-7vw8-924h/dependabot)

## Package

pip

nova
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 12.0.0

## Patched versions

12.0.0

## Description

`virt/disk/api.py` in OpenStack Compute (Nova) 2012.1.x before 2012.1.2 and Folsom before Folsom-3 allows remote authenticated users to overwrite arbitrary files via a symlink attack on a file in an image that uses a symlink that is only readable by root. NOTE: this vulnerability exists because of an incomplete fix for [CVE-2012-3361](https://github.com/advisories/GHSA-cm54-3vvf-f5p8 "CVE-2012-3361").

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2012-3447>
* [openstack/nova@ce4b2e2](https://github.com/openstack/nova/commit/ce4b2e27be45a85b310237615c47eb53f37bb5f3)
* [openstack/nova@d9577ce](https://github.com/openstack/nova/commit/d9577ce9f266166a297488445b5b0c93c1ddb368)
* [https://bugs.launchpad.net/nova/+bug/1031311](https://bugs.launchpad.net/nova/%2Bbug/1031311)
* <https://bugzilla.redhat.com/show_bug.cgi?id=845106>
* <https://exchange.xforce.ibmcloud.com/vulnerabilities/77539>
* <http://www.openwall.com/lists/oss-security/2012/08/07/1>
* <https://github.com/pypa/advisory-database/tree/main/vulns/nova/PYSEC-2012-21.yaml>
* [https://web.archive.org/web/20120824003029/http://www.securityfocus.com/bid/54869](https://web.archive.org/web/20120824003029/http%3A//www.securityfocus.com/bid/54869)
* <https://review.openstack.org/#/c/10953>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2012-3447)
Aug 20, 2012

Published to the GitHub Advisory Database
May 17, 2022

Reviewed
Feb 14, 2023

Last updated
Oct 1, 2024

### Severity

High

7.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Network

Attack Complexity
Low

Attack Requirements
None

Privileges Required
Low

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
None

Integrity
High

Availability
None
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N

### EPSS score

0.336%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (71st percentile)

### Weaknesses

[CWE-863](/advisories?query=cwe%3A863)

### CVE ID

CVE-2012-3447

### GHSA ID

GHSA-xc4g-7vw8-924h

### Source code

[openstack/nova](https://github.com/openstack/nova)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-xc4g-7vw8-924h/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from access.redhat.com_b743741b_20250126_063958.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from review.openstack.org_73b496c9_20250125_062136.html ===




=== Content from bugs.launchpad.net_ac9fa1c9_20250125_062132.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2012-011] CVE-2012-3361 not fully addressed

Bug #1031311 reported by
[Pádraig Brady](https://launchpad.net/~p-draigbrady)
on 2012-07-31

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | Critical | [Pádraig Brady](https://launchpad.net/~p-draigbrady) | [OpenStack Compute (nova) 2012.2 "folsom"](https://launchpad.net/nova/%2Bmilestone/2012.2) |
|  | [Essex](https://bugs.launchpad.net/nova/essex) | Fix Released | Critical | [Pádraig Brady](https://launchpad.net/~p-draigbrady) | [OpenStack Compute (nova) 2012.1.2](https://launchpad.net/nova/%2Bmilestone/2012.1.2) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | [Thierry Carrez](https://launchpad.net/~ttx) |  |
|  | [nova (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/nova "Latest release: 3:30.0.0+git2025011510.77e9ec0a65-0ubuntu2, uploaded to main on 2025-01-23 09:46:10.681778+00:00 by James Page (james-page), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [Precise](https://bugs.launchpad.net/ubuntu/precise/%2Bsource/nova) | Fix Released | Undecided | Unassigned |  |

### Bug Description

Unfortunately the patches released for [bug 1015531](/bugs/1015531), didn't consider permissions in the guest.

If there is a root only readable directory in the guest containing the dodgy symlinks, then they will not be detected by \_join\_and\_check\_path\_within\_fs() because it runs as the nova user.

Therefore the equivalent of this function needs to run as the root user.

Folsom patch attached.

Diablo & Essex versions would need readlink added to rootwrap

See [original description](comments/0)

Tags:

[verification-done](/nova/%2Bbugs?field.tag=verification-done)

## Related branches

[lp:~openstack-ubuntu-testing/nova/precise-essex-proposed](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed)
![](/@@/merge-proposal-icon)
[Merged](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916)
into
[lp:~ubuntu-server-dev/nova/essex](https://code.launchpad.net/~ubuntu-server-dev/nova/essex)
at
[revision 344](https://bazaar.launchpad.net/~ubuntu-server-dev/nova/essex/revision/344)

[Chuck Short](https://launchpad.net/~zulcss):
Pending
requested
2012-03-22

Diff: [56 lines (+14/-4)](https://code.launchpad.net/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916/%2Bpreview-diff/226338/%2Bfiles/preview.diff)3 files modifieddebian/changelog (+8/-0)
debian/control (+6/-3)
debian/nova-console.install (+0/-1)
[api](/~openstack-ubuntu-testing/nova/precise-essex-proposed/%2Bmerge/98916/%2Bpreview-diff/226338)

[lp:ubuntu/precise-proposed/nova](https://code.launchpad.net/~ubuntu-branches/ubuntu/precise/nova/precise-proposed)

## CVE References

* [2012-3447](/bugs/cve/2012-3447 "virt/disk/api.py in OpenStack Compute...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-07-31: |  |  | [#1](/nova/%2Bbug/1031311/comments/1) |
| --- | --- | --- | --- |

* [CVE-2012-3361-folsom.diff](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243517/%2Bfiles/CVE-2012-3361-folsom.diff)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243517)
  (838 bytes,
  text/plain)

[Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady)
on 2012-07-31

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-31: |  |  | [#2](/nova/%2Bbug/1031311/comments/2) |
| --- | --- | --- | --- |

Adding Vish and MarkMC since this /may/ delay 2012.1.2.

Adding Vish and MarkMC since this /may/ delay 2012.1.2.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-07-31: |  |  | [#3](/nova/%2Bbug/1031311/comments/3) |
| --- | --- | --- | --- |

Yes, since we do all file injection as root, we need to do the path canonicalization as root. Uggh.

I think it makes sense to delay 2012.1.2 - it seems wrong to do a release claiming it fixes CVE-2012-3361 while we know the fix is incomplete.

Patch looks good to me - though if you reverted the s/absolute\_path/abs\_path/ it make the straightforward nature of the change more obvious

Looks like 'readlink -m' has been around since 2004, so no concerns about its availability

Yes, since we do all file injection as root, we need to do the path canonicalization as root. Uggh.
I think it makes sense to delay 2012.1.2 - it seems wrong to do a release claiming it fixes CVE-2012-3361 while we know the fix is incomplete.
Patch looks good to me - though if you reverted the s/absolute\_path/abs\_path/ it make the straightforward nature of the change more obvious
Looks like 'readlink -m' has been around since 2004, so no concerns about its availability

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-07-31: |  |  | [#4](/nova/%2Bbug/1031311/comments/4) |
| --- | --- | --- | --- |

* [CVE-2012-3361-folsom.patch](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243696/%2Bfiles/CVE-2012-3361-folsom.patch)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243696)
  (1.4 KiB,
  text/plain)

folsom patch

folsom patch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-07-31: |  |  | [#5](/nova/%2Bbug/1031311/comments/5) |
| --- | --- | --- | --- |

* [CVE-2012-3361-essex.patch](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243699/%2Bfiles/CVE-2012-3361-essex.patch)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243699)
  (2.0 KiB,
  text/plain)

essex patch

essex patch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-07-31: |  |  | [#6](/nova/%2Bbug/1031311/comments/6) |
| --- | --- | --- | --- |

* [CVE-2012-3361-diablo.patch](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243700/%2Bfiles/CVE-2012-3361-diablo.patch)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243700)
  (1.4 KiB,
  text/plain)

diablo patch.

Note this must be applied after <https://review.openstack.org/#/c/9268/>

which has been abondoned due to gating issues.

Note also that this requires users to update their nova sudoers

file to include 'readlink'

diablo patch.
Note this must be applied after https://review.openstack.org/#/c/9268/
which has been abondoned due to gating issues.
Note also that this requires users to update their nova sudoers
file to include 'readlink'

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-07-31

| Changed in nova: | |
| --- | --- |
| **importance**: | High → Critical |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-31: |  |  | [#7](/nova/%2Bbug/1031311/comments/7) |
| --- | --- | --- | --- |

Please confirm patches and approve proposed impact description. Will be published as an ERRATA to OSSA-2012-008 if it gets the same CVE, and as a separate advisory if it gets a new CVE...

Title: OSSA-2012-008 ERRATA: Incomplete fix

Impact: Critical

Reporter: Pádraig Brady (Red Hat)

Products: Nova

Affects: All versions

Description:

Pádraig Brady from Red Hat discovered that the fix implemented for CVE-2012-3361 was not covering all attack scenarios. By crafting a malicious image with root-readable-only symlinks and requesting an instance based on it, an authenticated user could still corrupt arbitrary files (all setups affected) or inject arbitrary files (Essex and later setups with OpenStack API enabled and a libvirt-based hypervisor) on the host filesystem, potentially resulting in full compromise of that compute node.

Additional fixes needed:

...

Please confirm patches and approve proposed impact description. Will be published as an ERRATA to OSSA-2012-008 if it gets the same CVE, and as a separate advisory if it gets a new CVE...
Title: OSSA-2012-008 ERRATA: Incomplete fix
Impact: Critical
Reporter: Pádraig Brady (Red Hat)
Products: Nova
Affects: All versions
Description:
Pádraig Brady from Red Hat discovered that the fix implemented for CVE-2012-3361 was not covering all attack scenarios. By crafting a malicious image with root-readable-only symlinks and requesting an instance based on it, an authenticated user could still corrupt arbitrary files (all setups affected) or inject arbitrary files (Essex and later setups with OpenStack API enabled and a libvirt-based hypervisor) on the host filesystem, potentially resulting in full compromise of that compute node.
Additional fixes needed:
...

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pádraig Brady (p-draigbrady)](https://launchpad.net/~p-draigbrady) wrote on 2012-07-31: |  |  | [#8](/nova/%2Bbug/1031311/comments/8) |
| --- | --- | --- | --- |

Description in comment 7 looks good.

Thanks!

Description in comment 7 looks good.
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie) wrote on 2012-07-31: |  |  | [#9](/nova/%2Bbug/1031311/comments/9) |
| --- | --- | --- | --- |

As announcements went out for the incomplete fix (openstack OSSA-2012-008, Ubuntu USN 1501-1), MITRE will likely want a separate CVE issued for the complete fix, so that users can be assured that vendors have addressed both elements of the issue.

(As an example of how a similar issue was handled with php, see <http://www.openwall.com/lists/oss-security/2012/05/09/6> ; specifically the handling of CVE-2012-2311 and CVE-2012-NEW-2, which later in the email thread was assigned as CVE-2012-2336.)

As announcements went out for the incomplete fix (openstack OSSA-2012-008, Ubuntu USN 1501-1), MITRE will likely want a separate CVE issued for the complete fix, so that users can be assured that vendors have addressed both elements of the issue.
(As an example of how a similar issue was handled with php, see http://www.openwall.com/lists/oss-security/2012/05/09/6 ; specifically the handling of CVE-2012-2311 and CVE-2012-NEW-2, which later in the email thread was assigned as CVE-2012-2336.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-07-31: |  |  | [#10](/nova/%2Bbug/1031311/comments/10) |
| --- | --- | --- | --- |

Thanks Steve. Adjusted title/description to match:

Title: Compute node filesystem injection/corruption

Impact: Critical

Reporter: Pádraig Brady (Red Hat)

Products: Nova

Affects: All versions

Description:

Pádraig Brady from Red Hat discovered that the fix implemented for CVE-2012-3361 (OSSA-2012-008) was not covering all attack scenarios. By crafting a malicious image with root-readable-only symlinks and requesting a server based on it, an authenticated user could still corrupt arbitrary files (all setups affected) or inject arbitrary files (Essex and later setups with OpenStack API enabled and a libvirt-based hypervisor) on the host filesystem, potentially resulting in full compromise of that compute node.

Thanks Steve. Adjusted title/description to match:
Title: Compute node filesystem injection/corruption
Impact: Critical
Reporter: Pádraig Brady (Red Hat)
Products: Nova
Affects: All versions
Description:
Pádraig Brady from Red Hat discovered that the fix implemented for CVE-2012-3361 (OSSA-2012-008) was not covering all attack scenarios. By crafting a malicious image with root-readable-only symlinks and requesting a server based on it, an authenticated user could still corrupt arbitrary files (all setups affected) or inject arbitrary files (Essex and later setups with OpenStack API enabled and a libvirt-based hypervisor) on the host filesystem, potentially resulting in full compromise of that compute node.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark McLoughlin (markmc)](https://launchpad.net/~markmc) wrote on 2012-08-01: |  |  | [#11](/nova/%2Bbug/1031311/comments/11) |
| --- | --- | --- | --- |

Patches look good to me

I wondered why rootwrap didn't need updating in Folsom, but I see we have readlink in compute.filters already - might be good to add 'readlink -m' to the comment ... that'll help people realize that you didn't overlook rootwrap

Patches look good to me
I wondered why rootwrap didn't need updating in Folsom, but I see we have readlink in compute.filters already - might be good to add 'readlink -m' to the comment ... that'll help people realize that you didn't overlook rootwrap

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Prince (dan-prince)](https://launchpad.net/~dan-prince) wrote on 2012-08-01: |  |  | [#12](/nova/%2Bbug/1031311/comments/12) |
| --- | --- | --- | --- |

Looks good to me too. Nice one.

Looks good to me too. Nice one.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2012-08-01: |  |  | [#13](/nova/%2Bbug/1031311/comments/13) |
| --- | --- | --- | --- |

Patches and advisory look good to me, too.

Patches and advisory look good to me, too.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-08-01: |  |  | [#14](/nova/%2Bbug/1031311/comments/14) |
| --- | --- | --- | --- |

Sent to downstream stakeholders.

Proposed public disclosure date/time:

\*Tuesday August 7th, 1500UTC\*

Sent to downstream stakeholders.
Proposed public disclosure date/time:
\*Tuesday August 7th, 1500UTC\*

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-08-02: |  |  | [#15](/nova/%2Bbug/1031311/comments/15) |
| --- | --- | --- | --- |

issue was assigned CVE-2012-3447

issue was assigned CVE-2012-3447

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-08-07: |  |  | [#16](/nova/%2Bbug/1031311/comments/16) |
| --- | --- | --- | --- |

Prepared for 1500 UTC release:

Folsom: <https://review.openstack.org/#/c/10951/>

Essex: <https://review.openstack.org/#/c/10952/>

Diablo: <https://review.openstack.org/#/c/10953/>

Prepared for 1500 UTC release:
Folsom: https://review.openstack.org/#/c/10951/
Essex: https://review.openstack.org/#/c/10952/
Diablo: https://review.openstack.org/#/c/10953/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-08-07: |  |  | [#17](/nova/%2Bbug/1031311/comments/17) |
| --- | --- | --- | --- |

Adding a few more subscribers to help in coordinating disclosure.

Adding a few more subscribers to help in coordinating disclosure.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2012-08-07: |  |  | [#18](/nova/%2Bbug/1031311/comments/18) |
| --- | --- | --- | --- |

Published patches, opened bugs

Published patches, opened bugs

| **visibility**: | private → public |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-08-07

| Changed in nova: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2012-08-07

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Pádraig Brady (p-draigbrady) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2012-08-07:  [**Fix merged to nova (master)**](/nova/%2Bbug/1031311/comments/19) |  |  | [#19](/nova/%2Bbug/1031311/comments/19) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/10951>

Committed: <http://github.com/openstack/nova/commit/ce4b2e27be45a85b310237615c47eb53f37bb5f3>

Submitter: Jenkins

Branch: master

commit ce4b2e27be45a85b310237615c47eb53f37bb5f3

Author: Pádraig Brady <email address hidden>

Date: Tue Jul 31 14:05:35 2012 +0100

Prohibit file injection writing to host filesystem

This is a refinement of the previous fix in commit 2427d4a9,

    which does the file name canonicalization as the root user.

    This is required so that guest images could not for example,

    protect malicious symlinks in a directory only readable by root.

Fixes bug: 1031311, CVE-2012-3447

    Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c

Reviewed: https://review.openstack.org/10951
Committed: http://github.com/openstack/nova/commit/ce4b2e27be45a85b310237615c47eb53f37bb5f3
Submitter: Jenkins
Branch: master
commit ce4b2e27be45a85b310237615c47eb53f37bb5f3
Author: Pádraig Brady <pbrady@redhat.com>
Date: Tue Jul 31 14:05:35 2012 +0100
Prohibit file injection writing to host filesystem
This is a refinement of the previous fix in commit 2427d4a9,
which does the file name canonicalization as the root user.
This is required so that guest images could not for example,
protect malicious symlinks in a directory only readable by root.
Fixes bug: 1031311, CVE-2012-3447
Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2012-08-07:  [**Fix merged to nova (stable/essex)**](/nova/%2Bbug/1031311/comments/20) |  |  | [#20](/nova/%2Bbug/1031311/comments/20) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/10952>

Committed: <http://github.com/openstack/nova/commit/d9577ce9f266166a297488445b5b0c93c1ddb368>

Submitter: Jenkins

Branch: stable/essex

commit d9577ce9f266166a297488445b5b0c93c1ddb368

Author: Pádraig Brady <email address hidden>

Date: Tue Jul 31 14:05:35 2012 +0100

Prohibit file injection writing to host filesystem

This is a refinement of the previous fix in commit 2427d4a9,

    which does the file name canonicalization as the root user.

    This is required so that guest images could not for example,

    protect malicious symlinks in a directory only readable by root.

Fixes bug: 1031311, CVE-2012-3447

    Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c

Reviewed: https://review.openstack.org/10952
Committed: http://github.com/openstack/nova/commit/d9577ce9f266166a297488445b5b0c93c1ddb368
Submitter: Jenkins
Branch: stable/essex
commit d9577ce9f266166a297488445b5b0c93c1ddb368
Author: Pádraig Brady <pbrady@redhat.com>
Date: Tue Jul 31 14:05:35 2012 +0100
Prohibit file injection writing to host filesystem
This is a refinement of the previous fix in commit 2427d4a9,
which does the file name canonicalization as the root user.
This is required so that guest images could not for example,
protect malicious symlinks in a directory only readable by root.
Fixes bug: 1031311, CVE-2012-3447
Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2012-08-08:  [**Fix merged to nova (stable/diablo)**](/nova/%2Bbug/1031311/comments/21) |  |  | [#21](/nova/%2Bbug/1031311/comments/21) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/10953>

Committed: <http://github.com/openstack/nova/commit/ed89587d525e0214cb367aa4632df45903c6ac09>

Submitter: Jenkins

Branch: stable/diablo

commit ed89587d525e0214cb367aa4632df45903c6ac09

Author: Pádraig Brady <email address hidden>

Date: Tue Jul 31 14:34:19 2012 +0100

Prohibit file injection writing to host filesystem

This is a refinement of the previous fix in commit 2427d4a9,

    which does the file name canonicalization as the root user.

    This is required so that guest images could not for example,

    protect malicious symlinks in a directory only readable by root.

Note this requires adding the 'readlink' binary to the

    nova sudoers file.

Fixes bug: 1031311, CVE-2012-3447

    Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c

Reviewed: https://review.openstack.org/10953
Committed: http://github.com/openstack/nova/commit/ed89587d525e0214cb367aa4632df45903c6ac09
Submitter: Jenkins
Branch: stable/diablo
commit ed89587d525e0214cb367aa4632df45903c6ac09
Author: Pádraig Brady <pbrady@redhat.com>
Date: Tue Jul 31 14:34:19 2012 +0100
Prohibit file injection writing to host filesystem
This is a refinement of the previous fix in commit 2427d4a9,
which does the file name canonicalization as the root user.
This is required so that guest images could not for example,
protect malicious symlinks in a directory only readable by root.
Note this requires adding the 'readlink' binary to the
nova sudoers file.
Fixes bug: 1031311, CVE-2012-3447
Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-08-16

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → folsom-3 |
| **status**: | Fix Committed → Fix Released |

[Dave Walker (davewalker)](https://launchpad.net/~davewalker)
on 2012-08-24

| Changed in nova (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |
| Changed in nova (Ubuntu Precise): | |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand) wrote on 2012-08-24:  [**Re: CVE-2012-3361 not fully addressed**](/nova/%2Bbug/1031311/comments/22) |  |  | [#22](/nova/%2Bbug/1031311/comments/22) |
| --- | --- | --- | --- |

Ubuntu 12.04 LTS was fixed in <http://www.ubuntu.com/usn/usn-1545-1/>

Ubuntu 12.04 LTS was fixed in http://www.ubuntu.com/usn/usn-1545-1/

| Changed in nova (Ubuntu Precise): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Adam Gandelman (gandelman-a)](https://launchpad.net/~gandelman-a) wrote on 2012-08-30:  [**Verification report.**](/nova/%2Bbug/1031311/comments/23) |  |  | [#23](/nova/%2Bbug/1031311/comments/23) |
| --- | --- | --- | --- |

Please find the attached test log from the Ubuntu Server Team's CI infrastructure. As part of the verification process for this bug, Nova has been deployed and configured across multiple nodes using precise-proposed as an installation source. After successful bring-up and configuration of the cluster, a number of exercises and smoke tests have be invoked to ensure the updated package did not introduce any regressions. A number of test iterations were carried out to catch any possible transient errors.

Please Note the list of installed packages at the top and bottom of the report.

For records of upstream test coverage of this update, please see the Jenkins links in the comments of the relevant upstream code-review(s):

Trunk review: <https://review.openstack.org/10951>

Stable review: <https://review.openstack.org/10952>

As per the provisional Micro Release Exception granted to this package by the Technical Board, we hope this contributes toward verification of this update.

Please find the attached test log from the Ubuntu Server Team's CI infrastructure. As part of the verification process for this bug, Nova has been deployed and configured across multiple nodes using precise-proposed as an installation source. After successful bring-up and configuration of the cluster, a number of exercises and smoke tests have be invoked to ensure the updated package did not introduce any regressions. A number of test iterations were carried out to catch any possible transient errors.
Please Note the list of installed packages at the top and bottom of the report.
For records of upstream test coverage of this update, please see the Jenkins links in the comments of the relevant upstream code-review(s):
Trunk review: https://review.openstack.org/10951
Stable review: https://review.openstack.org/10952
As per the provisional Micro Release Exception granted to this package by the Technical Board, we hope this contributes toward verification of this update.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Adam Gandelman (gandelman-a)](https://launchpad.net/~gandelman-a) wrote on 2012-08-30:  [**Re: CVE-2012-3361 not fully addressed**](/nova/%2Bbug/1031311/comments/24) |  |  | [#24](/nova/%2Bbug/1031311/comments/24) |
| --- | --- | --- | --- |

* [2012.1.3+stable-20120827-4d2a4afe-0ubuntu1.log](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3283214/%2Bfiles/2012.1.3%2Bstable-20120827-4d2a4afe-0ubuntu1.log)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3283214)
  (82.0 KiB,
  text/plain)

Test coverage log.

Test coverage log.

| **tags**: | added: verification-done |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Clint Byrum (clint-fewbar)](https://launchpad.net/~clint-fewbar) wrote on 2012-09-03:  [**Update Released**](/nova/%2Bbug/1031311/comments/25) |  |  | [#25](/nova/%2Bbug/1031311/comments/25) |
| --- | --- | --- | --- |

The verification of this Stable Release Update has completed successfully and the package has now been released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regresssions.

The verification of this Stable Release Update has completed successfully and the package has now been released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regresssions.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2012-09-27

| Changed in nova: | |
| --- | --- |
| **milestone**: | folsom-3 → 2012.2 |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-06-07

| **summary**: | - CVE-2012-3361 not fully addressed+ [OSSA 2012-011] CVE-2012-3361 not fully addressed |
| --- | --- |
| Changed in ossa: | |
| **assignee**: | nobody → Thierry Carrez (ttx) |
| **status**: | New → Fix Released |

[Sean Dague (sdague)](https://launchpad.net/~sdague)
on 2014-09-15

| **no longer affects**: | nova/diablo |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1031311/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [CVE-2012-3361-folsom.patch](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243696/%2Bfiles/CVE-2012-3361-folsom.patch)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243696 "Change patch details")
* [CVE-2012-3361-essex.patch](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243699/%2Bfiles/CVE-2012-3361-essex.patch)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243699 "Change patch details")
* [CVE-2012-3361-diablo.patch](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243700/%2Bfiles/CVE-2012-3361-diablo.patch)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243700 "Change patch details")

* [Add patch](/nova/%2Bbug/1031311/%2Baddcomment?field.patch=on)

## Bug attachments

* [CVE-2012-3361-folsom.diff](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3243517/%2Bfiles/CVE-2012-3361-folsom.diff)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3243517 "Change attachment details")
* [2012.1.3+stable-20120827-4d2a4afe-0ubuntu1.log](https://bugs.launchpad.net/nova/%2Bbug/1031311/%2Battachment/3283214/%2Bfiles/2012.1.3%2Bstable-20120827-4d2a4afe-0ubuntu1.log)
  [Edit](/nova/%2Bbug/1031311/%2Battachment/3283214 "Change attachment details")

* [Add attachment](/nova/%2Bbug/1031311/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from access.redhat.com_f0161118_20250126_063959.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from review.openstack.org_101c5fc6_20250126_063947.html ===




=== Content from bugzilla.redhat.com_ceb69775_20250125_062133.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D845106)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D845106)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D845106)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 845106

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 845106**](show_bug.cgi?id=845106)
(CVE-2012-3447)
- [CVE-2012-3447](https://access.redhat.com/security/cve/CVE-2012-3447) OpenStack-Nova: compute nodes disk image file corruption, incomplete fix for [CVE-2012-3361](https://access.redhat.com/security/cve/CVE-2012-3361) (OSSA 2012-011)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-3447 OpenStack-Nova: compute nodes disk image file corruption, incom...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-3447 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [846624](show_bug.cgi?id=846624 "CLOSED ERRATA - CVE-2012-3447 OpenStack-Nova: compute nodes disk image file corruption (incomplete fix for CVE-2012-3361) [fedora-all]") [846625](show_bug.cgi?id=846625 "CLOSED ERRATA - CVE-2012-3447 OpenStack-Nova: compute nodes disk image file corruption (incomplete fix for CVE-2012-3361) [epel-6]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=845106&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=845106&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-08-01 19:13 UTC by Kurt Seifried | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:54 UTC ([History](show_activity.cgi?id=845106)) | | [CC List:](page.cgi?id=fields.html#cclist) | 3 users (show)  apevec jrusnack security-response-team | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-08-09 04:32:39 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Patch for CVE-2012-3447 for essex**](attachment.cgi?id=601803 "View the content of the attachment") (1.93 KB, patch)  [2012-08-01 19:17 UTC](#attach_601803 "Go to the comment associated with the attachment"), Kurt Seifried | *no flags* | [Details](attachment.cgi?id=601803&action=edit) | [Diff](attachment.cgi?id=601803&action=diff) | | [**Patch for CVE-2012-3447 for folsom**](attachment.cgi?id=601804 "View the content of the attachment") (1.35 KB, patch)  [2012-08-01 19:17 UTC](#attach_601804 "Go to the comment associated with the attachment"), Kurt Seifried | *no flags* | [Details](attachment.cgi?id=601804&action=edit) | [Diff](attachment.cgi?id=601804&action=diff) | | [View All](attachment.cgi?bugid=845106&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=845106#c0)  Kurt Seifried    2012-08-01 19:13:41 UTC  ```  Thierry Carrez <thierry> reports:  Pádraig Brady from Red Hat discovered that the fix implemented for [CVE-2012-3361](https://access.redhat.com/security/cve/CVE-2012-3361) (OSSA-2012-008) was not covering all attack scenarios. By crafting a malicious image with root-readable-only symlinks and requesting a server based on it, an authenticated user could still corrupt arbitrary files (all setups affected) or inject arbitrary files (Essex and later setups with OpenStack API enabled and a libvirt-based hypervisor) on the host filesystem, potentially resulting in full compromise of that compute node.   ```  [Comment 1](show_bug.cgi?id=845106#c1)  Kurt Seifried    2012-08-01 19:17:13 UTC  ``` Created [attachment 601803](attachment.cgi?id=601803&action=diff "Patch for CVE-2012-3447 for essex") [[details]](attachment.cgi?id=601803&action=edit "Patch for CVE-2012-3447 for essex") Patch for [CVE-2012-3447](https://access.redhat.com/security/cve/CVE-2012-3447) for essex   ```  [Comment 2](show_bug.cgi?id=845106#c2)  Kurt Seifried    2012-08-01 19:17:37 UTC  ``` Created [attachment 601804](attachment.cgi?id=601804&action=diff "Patch for CVE-2012-3447 for folsom") [[details]](attachment.cgi?id=601804&action=edit "Patch for CVE-2012-3447 for folsom") Patch for [CVE-2012-3447](https://access.redhat.com/security/cve/CVE-2012-3447) for folsom   ```  [Comment 3](show_bug.cgi?id=845106#c3)  Tomas Hoger    2012-08-08 09:33:16 UTC  ``` References:  <http://thread.gmane.org/gmane.comp.security.oss.general/8126> [https://bugs.launchpad.net/nova/+bug/1031311](https://bugs.launchpad.net/nova/%2Bbug/1031311)   ```  [Comment 4](show_bug.cgi?id=845106#c4)  Tomas Hoger    2012-08-08 09:34:36 UTC  ``` Created openstack-nova tracking bugs for this issue  Affects: fedora-all [[bug 846624](show_bug.cgi?id=846624 "CLOSED ERRATA - CVE-2012-3447 OpenStack-Nova: compute nodes disk image file corruption (incomplete fix for CVE-2012-3361) [fedora-all]")] Affects: epel-6 [[bug 846625](show_bug.cgi?id=846625 "CLOSED ERRATA - CVE-2012-3447 OpenStack-Nova: compute nodes disk image file corruption (incomplete fix for CVE-2012-3361) [epel-6]")]   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=845106&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from review.openstack.org_c21f6256_20250126_063946.html ===




=== Content from github.com_b4de0e1d_20250125_062134.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fce4b2e27be45a85b310237615c47eb53f37bb5f3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fce4b2e27be45a85b310237615c47eb53f37bb5f3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openstack%2Fnova)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openstack](/openstack)
/
**[nova](/openstack/nova)**
Public

* [Notifications](/login?return_to=%2Fopenstack%2Fnova) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fopenstack%2Fnova)
* [Star
   3.1k](/login?return_to=%2Fopenstack%2Fnova)

* [Code](/openstack/nova)
* [Pull requests
  0](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

Additional navigation options

* [Code](/openstack/nova)
* [Pull requests](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

## Commit

[Permalink](/openstack/nova/commit/ce4b2e27be45a85b310237615c47eb53f37bb5f3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Prohibit file injection writing to host filesystem

[Browse files](/openstack/nova/tree/ce4b2e27be45a85b310237615c47eb53f37bb5f3)
Browse the repository at this point in the history

```
This is a refinement of the previous fix in commit [2427d4a](https://github.com/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7),
which does the file name canonicalization as the root user.
This is required so that guest images could not for example,
protect malicious symlinks in a directory only readable by root.

Fixes bug: 1031311, [CVE-2012-3447](https://github.com/advisories/GHSA-xc4g-7vw8-924h "CVE-2012-3447")
Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c
```

* Loading branch information

Pádraig Brady
committed
Aug 7, 2012

1 parent
[9d753f1](/openstack/nova/commit/9d753f18e1c5e4eaa4021f64ac9fe14ef1103b71)

commit ce4b2e2

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**36 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* nova

  + tests

    - nova/tests/test\_virt.py
      [test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004)
    - nova/tests/test\_xenapi.py
      [test\_xenapi.py](#diff-c5ecacac56150f10a2f2430dee5f9b3e6c4e4b523c37682e47088a3e60de6b44)
  + virt/disk

    - nova/virt/disk/api.py
      [api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5)

## There are no files selected for viewing

45 changes: 29 additions & 16 deletions

45
[nova/tests/test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004 "nova/tests/test_virt.py")

Show comments

[View file](/openstack/nova/blob/ce4b2e27be45a85b310237615c47eb53f37bb5f3/nova/tests/test_virt.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -99,22 +99,6 @@ def fake\_execute(\*cmd, \*\*kwargs): |
|  |  |  |
|  |  | self.stubs.Set(utils, 'execute', fake\_execute) |
|  |  |  |
|  |  | def test\_check\_safe\_path(self): |
|  |  | ret = disk\_api.\_join\_and\_check\_path\_within\_fs('/foo', 'etc', |
|  |  | 'something.conf') |
|  |  | self.assertEquals(ret, '/foo/etc/something.conf') |
|  |  |  |
|  |  | def test\_check\_unsafe\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_join\_and\_check\_path\_within\_fs, |
|  |  | '/foo', 'etc/../../../something.conf') |
|  |  |  |
|  |  | def test\_inject\_files\_with\_bad\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_inject\_file\_into\_fs, |
|  |  | '/tmp', '/etc/../../../../etc/passwd', |
|  |  | 'hax') |
|  |  |  |
|  |  | def test\_lxc\_destroy\_container(self): |
|  |  |  |
|  |  | def proc\_mounts(self, mount\_point): |
| Expand Down  Expand Up | | @@ -165,3 +149,32 @@ def proc\_mounts(self, mount\_point): |
|  |  | self.executes.pop() |
|  |  |  |
|  |  | self.assertEqual(self.executes, expected\_commands) |
|  |  |  |
|  |  |  |
|  |  | class TestVirtDiskPaths(test.TestCase): |
|  |  | def setUp(self): |
|  |  | super(TestVirtDiskPaths, self).setUp() |
|  |  |  |
|  |  | real\_execute = utils.execute |
|  |  |  |
|  |  | def nonroot\_execute(\*cmd\_parts, \*\*kwargs): |
|  |  | kwargs.pop('run\_as\_root', None) |
|  |  | return real\_execute(\*cmd\_parts, \*\*kwargs) |
|  |  |  |
|  |  | self.stubs.Set(utils, 'execute', nonroot\_execute) |
|  |  |  |
|  |  | def test\_check\_safe\_path(self): |
|  |  | ret = disk\_api.\_join\_and\_check\_path\_within\_fs('/foo', 'etc', |
|  |  | 'something.conf') |
|  |  | self.assertEquals(ret, '/foo/etc/something.conf') |
|  |  |  |
|  |  | def test\_check\_unsafe\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_join\_and\_check\_path\_within\_fs, |
|  |  | '/foo', 'etc/../../../something.conf') |
|  |  |  |
|  |  | def test\_inject\_files\_with\_bad\_path(self): |
|  |  | self.assertRaises(exception.Invalid, |
|  |  | disk\_api.\_inject\_file\_into\_fs, |
|  |  | '/tmp', '/etc/../../../../etc/passwd', |
|  |  | 'hax') |

4 changes: 4 additions & 0 deletions

4
[nova/tests/test\_xenapi.py](#diff-c5ecacac56150f10a2f2430dee5f9b3e6c4e4b523c37682e47088a3e60de6b44 "nova/tests/test_xenapi.py")

Show comments

[View file](/openstack/nova/blob/ce4b2e27be45a85b310237615c47eb53f37bb5f3/nova/tests/test_xenapi.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -677,9 +677,13 @@ def \_tee\_handler(cmd, \*\*kwargs): |
|  |  | self.\_tee\_executed = True |
|  |  | return '', '' |
|  |  |  |
|  |  | def \_readlink\_handler(cmd\_parts, \*\*kwargs): |
|  |  | return os.path.realpath(cmd\_parts[2]), '' |
|  |  |  |
|  |  | fake\_utils.fake\_execute\_set\_repliers([ |
|  |  | # Capture the tee .../etc/network/interfaces command |
|  |  | (r'tee.\*interfaces', \_tee\_handler), |
|  |  | (r'readlink -nm.\*', \_readlink\_handler), |
|  |  | ]) |
|  |  | self.\_test\_spawn(IMAGE\_MACHINE, |
|  |  | IMAGE\_KERNEL, |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[nova/virt/disk/api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5 "nova/virt/disk/api.py")

Show comments

[View file](/openstack/nova/blob/ce4b2e27be45a85b310237615c47eb53f37bb5f3/nova/virt/disk/api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -363,7 +363,9 @@ def \_join\_and\_check\_path\_within\_fs(fs, \*args): |
|  |  | mounted guest fs. Trying to be clever and specifying a |
|  |  | path with '..' in it will hit this safeguard. |
|  |  | ''' |
|  |  | absolute\_path = os.path.realpath(os.path.join(fs, \*args)) |
|  |  | absolute\_path, \_err = utils.execute('readlink', '-nm', |
|  |  | os.path.join(fs, \*args), |
|  |  | run\_as\_root=True) |
|  |  | if not absolute\_path.startswith(os.path.realpath(fs) + '/'): |
|  |  | raise exception.Invalid(\_('injected file path not valid')) |
|  |  | return absolute\_path |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ce4b2e2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fce4b2e27be45a85b310237615c47eb53f37bb5f3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from launchpad.net_1d0b4763_20250126_063958.html ===

[Log in / Register](https://launchpad.net/~ttx/%2Blogin)

[![](https://launchpadlibrarian.net/116816327/ttx64.jpg)](https://launchpad.net/~ttx)

## [Thierry Carrez](https://launchpad.net/~ttx)

* Overview
* [Code](https://code.launchpad.net/~ttx)
* [Bugs](https://bugs.launchpad.net/~ttx)
* [Blueprints](https://blueprints.launchpad.net/~ttx)
* [Translations](https://translations.launchpad.net/~ttx)
* [Answers](https://answers.launchpad.net/~ttx)

Chair of the Technical Committee and Release Manager for OpenStack.

Python Software Foundation member.

Ubuntu core developer.

* [Related packages](https://launchpad.net/~ttx/%2Brelated-packages)
* [Related projects](https://launchpad.net/~ttx/%2Brelated-projects)

## User information

Launchpad Id:
ttx

Email:
[Log in](%2Blogin) for email information.

Member since:
2008-05-12

[![Icon of Cassandra Ubuntu Packaging](https://launchpadlibrarian.net/59580596/cassandra-ubuntu-icon.png "Member of Cassandra Ubuntu Packaging")](/~cassandra-ubuntu)
[![Icon of (deprecated) OpenStack PPA maintainers](https://launchpadlibrarian.net/87891894/ppa.gif "Member of (deprecated) OpenStack PPA maintainers")](/~openstack-ppa)
[![Icon of Designate Drivers](https://launchpadlibrarian.net/360468067/designate_14.jpg "Member of Designate Drivers")](/~designate-drivers)
[![Icon of Launchpad Beta Testers](https://launchpadlibrarian.net/600856498/Canonical_Launchpad_icon_14px.png "Member of Launchpad Beta Testers")](/~launchpad-beta-testers)
[![Icon of Martin Pitt's fan](https://launchpadlibrarian.net/16410730/immaginexz0.png "Member of Martin Pitt's fan")](/~we-love-pitti)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack release team](https://launchpadlibrarian.net/73211233/openstack-release.png "Member of OpenStack release team")](/~openstack-release)
[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of Python OpenStack Client Drivers](https://launchpadlibrarian.net/697274978/osc-icon.png "Member of Python OpenStack Client Drivers")](/~python-openstackclient-drivers)
[![Icon of Python OpenStack Client](https://launchpadlibrarian.net/697274843/osc-icon.png "Member of Python OpenStack Client")](/~python-openstackclient)
[![Icon of Soren's Target Audience](https://launchpadlibrarian.net/20548684/golf.png "Member of Soren's Target Audience")](/~sorens-target-audience)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Server papercutters](https://launchpadlibrarian.net/38078797/14.png "Member of Ubuntu Server papercutters")](/~server-papercutters)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, French

OpenPGP keys:

22A7943050DB1E67EC2B641A507AF89025B10423

SSH keys:

[ttx@stardust](%2Bsshkeys)

[ttx@mercury](%2Bsshkeys)

Time zone:

Europe/Paris
(UTC+0100)

Karma:
[0](https://launchpad.net/~ttx/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**ttx**
 on
**FreeNode**

## [All bugs in progress](https://launchpad.net/~ttx/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1473369 [new mock release broke a bunch of unit tests](https://bugs.launchpad.net/python-muranoclient/kilo/%2Bbug/1473369) |  |
| --- | --- | --- |
| in [python-muranoclient](/python-muranoclient), [Glance](/glance), [glance\_store](/glance-store), [Murano](/murano), [neutron](/neutron), [OpenStack Object Storage (swift)](/swift) | | |

| --- | --- | --- | --- | --- | --- |

## Personal package archives

| [Test Openstack 2011.3](/~ttx/%2Barchive/ubuntu/2011.3) |
| --- |
| [Extra packages](/~ttx/%2Barchive/ubuntu/extras) |
| [Bexar update candidates](/~ttx/%2Barchive/ubuntu/nova-bexar-updates) |
| [Junk PPA](/~ttx/%2Barchive/ubuntu/ppa) |
| [Terracotta stack](/~ttx/%2Barchive/ubuntu/terracotta) |

## [All memberships](https://launchpad.net/~ttx/%2Bparticipation) Latest memberships

| [kata-containers](/~kata-containers)  Joined on 2018-10-09 | |
| --- | --- |
| [OpenStack Folsom Stable Maintainers](/~openstack-folsom-maint)  Joined on 2013-04-11 | |
| [OpenStack Python3 Migration Team](/~openstack-py3-team)  Joined on 2013-03-20 | |
| [OpenStack Security SIG](/~openstack-ossg)  Joined on 2012-05-25 | |
| [Swift Drivers](/~swift-drivers)  Joined on 2012-04-06 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_864d632b_20250125_062135.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fd9577ce9f266166a297488445b5b0c93c1ddb368)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fd9577ce9f266166a297488445b5b0c93c1ddb368)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openstack%2Fnova)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openstack](/openstack)
/
**[nova](/openstack/nova)**
Public

* [Notifications](/login?return_to=%2Fopenstack%2Fnova) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fopenstack%2Fnova)
* [Star
   3.1k](/login?return_to=%2Fopenstack%2Fnova)

* [Code](/openstack/nova)
* [Pull requests
  0](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

Additional navigation options

* [Code](/openstack/nova)
* [Pull requests](/openstack/nova/pulls)
* [Actions](/openstack/nova/actions)
* [Security](/openstack/nova/security)
* [Insights](/openstack/nova/pulse)

## Commit

[Permalink](/openstack/nova/commit/d9577ce9f266166a297488445b5b0c93c1ddb368)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Prohibit file injection writing to host filesystem

[Browse files](/openstack/nova/tree/d9577ce9f266166a297488445b5b0c93c1ddb368)
Browse the repository at this point in the history

```
This is a refinement of the previous fix in commit [2427d4a](https://github.com/openstack/nova/commit/2427d4a99bed35baefd8f17ba422cb7aae8dcca7),
which does the file name canonicalization as the root user.
This is required so that guest images could not for example,
protect malicious symlinks in a directory only readable by root.

Fixes bug: 1031311, [CVE-2012-3447](https://github.com/advisories/GHSA-xc4g-7vw8-924h "CVE-2012-3447")
Change-Id: I7f7cdeeffadebae7451e1e13f73f1313a7df9c5c
```

* Loading branch information

Pádraig Brady
committed
Aug 7, 2012

1 parent
[6c05f43](/openstack/nova/commit/6c05f43140604827a1f3900f0389e86ef52f91b0)

commit d9577ce

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**23 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* nova

  + rootwrap

    - nova/rootwrap/compute.py
      [compute.py](#diff-24a3855791189d20bd7fee81a5f78159144d981fbebb096615bfe7eb509532e7)
  + tests

    - nova/tests/test\_virt.py
      [test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004)
    - nova/tests/test\_xenapi.py
      [test\_xenapi.py](#diff-c5ecacac56150f10a2f2430dee5f9b3e6c4e4b523c37682e47088a3e60de6b44)
  + virt/disk

    - nova/virt/disk/api.py
      [api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[nova/rootwrap/compute.py](#diff-24a3855791189d20bd7fee81a5f78159144d981fbebb096615bfe7eb509532e7 "nova/rootwrap/compute.py")

Show comments

[View file](/openstack/nova/blob/d9577ce9f266166a297488445b5b0c93c1ddb368/nova/rootwrap/compute.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -189,6 +189,10 @@ |
|  |  | # nova/virt/libvirt/utils.py: 'qemu-img' |
|  |  | filters.CommandFilter("/usr/bin/qemu-img", "root"), |
|  |  |  |
|  |  | # nova/virt/disk/api.py: 'readlink', '-e' |
|  |  | filters.CommandFilter("/usr/bin/readlink", "root"), |
|  |  | filters.CommandFilter("/bin/readlink", "root"), |
|  |  |  |
|  |  | # nova/virt/disk/api.py: 'touch', target |
|  |  | filters.CommandFilter("/usr/bin/touch", "root"), |
|  |  |  |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[nova/tests/test\_virt.py](#diff-26f62a549c1393cec87039157551d076e25376043753f200520c51eea88eb004 "nova/tests/test_virt.py")

Show comments

[View file](/openstack/nova/blob/d9577ce9f266166a297488445b5b0c93c1ddb368/nova/tests/test_virt.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,7 @@ |
|  |  | from nova import exception |
|  |  | from nova import flags |
|  |  | from nova import test |
|  |  | from nova import utils |
|  |  | from nova.virt.disk import api as disk\_api |
|  |  | from nova.virt import driver |
|  |  |  |
| Expand Down  Expand Up | | @@ -86,6 +87,17 @@ def test\_swap\_is\_usable(self): |
|  |  |  |
|  |  |  |
|  |  | class TestVirtDisk(test.TestCase): |
|  |  | def setUp(self): |
|  |  | super(TestVirtDisk, self).setUp() |
|  |  |  |
|  |  | real\_execute = utils.execute |
|  |  |  |
|  |  | def nonroot\_execute(\*cmd\_parts, \*\*kwargs): |
|  |  | kwargs.pop('run\_as\_root', None) |
|  |  | return real\_execute(\*cmd\_parts, \*\*kwargs) |
|  |  |  |
|  |  | self.stubs.Set(utils, 'execute', nonroot\_execute) |
|  |  |  |
|  |  | def test\_check\_safe\_path(self): |
|  |  | ret = disk\_api.\_join\_and\_check\_path\_within\_fs('/foo', 'etc', |
|  |  | 'something.conf') |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[nova/tests/test\_xenapi.py](#diff-c5ecacac56150f10a2f2430dee5f9b3e6c4e4b523c37682e47088a3e60de6b44 "nova/tests/test_xenapi.py")

Show comments

[View file](/openstack/nova/blob/d9577ce9f266166a297488445b5b0c93c1ddb368/nova/tests/test_xenapi.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -597,9 +597,13 @@ def \_tee\_handler(cmd, \*\*kwargs): |
|  |  | self.\_tee\_executed = True |
|  |  | return '', '' |
|  |  |  |
|  |  | def \_readlink\_handler(cmd\_parts, \*\*kwargs): |
|  |  | return os.path.realpath(cmd\_parts[2]), '' |
|  |  |  |
|  |  | fake\_utils.fake\_execute\_set\_repliers([ |
|  |  | # Capture the tee .../etc/network/interfaces command |
|  |  | (r'tee.\*interfaces', \_tee\_handler), |
|  |  | (r'readlink -nm.\*', \_readlink\_handler), |
|  |  | ]) |
|  |  | self.\_test\_spawn(glance\_stubs.FakeGlance.IMAGE\_MACHINE, |
|  |  | glance\_stubs.FakeGlance.IMAGE\_KERNEL, |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[nova/virt/disk/api.py](#diff-dcefa3b8d5529f4dd46141e5d5778db7fdd0b4264c0c3eeb9185f32ce20316f5 "nova/virt/disk/api.py")

Show comments

[View file](/openstack/nova/blob/d9577ce9f266166a297488445b5b0c93c1ddb368/nova/virt/disk/api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -314,7 +314,9 @@ def \_join\_and\_check\_path\_within\_fs(fs, \*args): |
|  |  | mounted guest fs. Trying to be clever and specifying a |
|  |  | path with '..' in it will hit this safeguard. |
|  |  | ''' |
|  |  | absolute\_path = os.path.realpath(os.path.join(fs, \*args)) |
|  |  | absolute\_path, \_err = utils.execute('readlink', '-nm', |
|  |  | os.path.join(fs, \*args), |
|  |  | run\_as\_root=True) |
|  |  | if not absolute\_path.startswith(os.path.realpath(fs) + '/'): |
|  |  | raise exception.Invalid(\_('injected file path not valid')) |
|  |  | return absolute\_path |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d9577ce`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fnova%2Fcommit%2Fd9577ce9f266166a297488445b5b0c93c1ddb368) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from review.openstack.org_7ff4cab2_20250126_063946.html ===




=== Content from www.openwall.com_353acaa6_20250125_062130.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2012/08/06/8) [[next>]](../../../2012/08/08/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <50217C02.2000906@openstack.org>
Date: Tue, 07 Aug 2012 22:35:14 +0200
From: Thierry Carrez <thierry@...nstack.org>
To: "openstack@...ts.launchpad.net" <openstack@...ts.launchpad.net>,
 oss-security@...ts.openwall.com, openstack-announce@...ts.openstack.org
Subject: [OSSA 2012-011] Compute node filesystem injection/corruption (CVE-2012-3447)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

OpenStack Security Advisory: 2012-011
CVE: CVE-2012-3447
Date: August 7, 2012
Title: Compute node filesystem injection/corruption
Impact: Critical
Reporter: Pádraig Brady (Red Hat)
Products: Nova
Affects: All versions

Description:
Pádraig Brady from Red Hat discovered that the fix implemented for
CVE-2012-3361 (OSSA-2012-008) was not covering all attack scenarios. By
crafting a malicious image with root-readable-only symlinks and
requesting a server based on it, an authenticated user could still
corrupt arbitrary files (all setups affected) or inject arbitrary files
(Essex and later setups with OpenStack API enabled and a libvirt-based
hypervisor) on the host filesystem, potentially resulting in full
compromise of that compute node.

Folsom fix:
<https://github.com/openstack/nova/commit/ce4b2e27be45a85b310237615c47eb53f37bb5f3>

Essex fix:
<https://github.com/openstack/nova/commit/d9577ce9f266166a297488445b5b0c93c1ddb368>

Diablo fix:
<https://review.openstack.org/#/c/10953/>

References:
[https://bugs.launchpad.net/nova/+bug/1031311](https://bugs.launchpad.net/nova/%2Bbug/1031311)
<http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2012-3447>

Notes:
This fix will be included in the upcoming Nova 2012.1.2 stable update
(due Thursday) and the Folsom-3 development milestone (due next week).

- --
Thierry Carrez (ttx)
OpenStack Vulnerability Management Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iQIcBAEBCAAGBQJQIXv+AAoJEFB6+JAlsQQjnJUQAI+Vp+GCMXAei/ktStVFrkXC
ilgIjBB5mcbrj/TGlnqhkS0MB0+kmo8Ucy4tI0O+gAqYaPNcEp6bbGr5pOby8Gdk
DehvQuTi4Rvvypnb7ORM+DjqPBtNGGMWKJzO84ls98Ev0z+6Soi4vmQal78wvwpX
3UbyqZG9P85QlDyyK+x/Af2D0YVCQffQ93/7UJi2OwB0hwHy+RS4WN7rYJGD2vh0
50jQYSgw/rrBSUPNupjEH+mXT/DM93z93qWmxHD6TYYUK9MmrfkfUPx8Ki8Fn5oQ
9znwXsIK5h3uexe2dHbABKaIm3AnMP3wCrKynEEjFV/no00r/Evm2zsdam31O3Bv
DV8ng6sdSnvltQK2s8F3blp3tNpsAp12QkC0BDI9FlYAACdaTBnDcVhKh4HoO84T
cRakJhfj23472GgmwwkIcPNEcfY1fWngUqN4rF2XUggtXzeEHyyqoiZIm4s4ns5+
DkSCmo5qBNbcos1C0BNeyPQ+wdF5U7wzQfggC6SRoKcPj/Mp8P5LCvgjPKwNtBuq
gzAVPSlx0Zehlqqey8zkUUGQ4btxiKP5+iwrKajY6QfqgtkqEsG46GR+tm+ygDNR
T8ltuixqMWpLPVUFZClaxV0MytSMdjhIgywkzyqHg9bzP4N3MztsGnIBPdQ0HC3a
P85xQ28EFbBC5tIZ4WRe
=C2MN
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


