The provided content includes a security advisory for Moodle, and it mentions CVE-2012-3390.

**Root cause of vulnerability:** Missing permissions check in the `pluginfile` function for blocks.

**Weaknesses/vulnerabilities present:** Files embedded within a block (e.g., an HTML block) were still accessible through `pluginfile`, even after the block was hidden. This occurs because the access checks were not properly implemented for files associated with hidden blocks.

**Impact of exploitation:** Unauthorized access to files embedded in hidden blocks. This could allow users to view sensitive documents meant to be restricted.

**Attack vectors:**
- A user needs the URL of the embedded file. This could be obtained through the HTML source of a block before it was hidden.
- Access is gained via the `pluginfile` function.

**Required attacker capabilities/position:**
- The attacker needs to have access to a Moodle course where an HTML block is used with embedded file.
- The attacker needs to have had access to the HTML source of the block before it was hidden to obtain the file's URL.