Based on the provided information, here's an analysis of CVE-2012-3387:

**Root Cause of Vulnerability:**

The root cause of this vulnerability lies in the `file_save_draft_area_files()` function in Moodle. This function was not performing server-side validation to ensure that file shortcuts/aliases were permitted, even when they were disallowed at the client-side.

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Server-Side Validation:** The primary weakness is the lack of proper server-side validation for file upload restrictions. While client-side checks might have been in place, the server did not verify if file shortcuts or aliases were allowed before processing them.
*   **Bypass of Client-Side Restrictions:** This lack of server-side validation allowed attackers to potentially bypass client-side restrictions related to file shortcuts/aliases.

**Impact of Exploitation:**

The impact of this vulnerability is considered "Minor". The specific consequences of successfully exploiting this vulnerability are not detailed in this document, but the implication is that an attacker could upload files in a manner not intended by the system, possibly creating file shortcuts/aliases when such functionality was meant to be disabled. This could lead to unintended file access or manipulation scenarios.

**Attack Vectors:**

The attack vector involves uploading files through the `file_save_draft_area_files()` function, specifically crafting file upload requests to include file shortcuts or aliases, and exploiting the lack of server-side validation on the file type.

**Required Attacker Capabilities/Position:**

The attacker needs to have the ability to upload files via the affected Moodle instance, and they must possess the knowledge of how to craft the file upload requests to include the restricted file types (i.e. shortcuts/aliases). This likely requires them to be an authenticated user with file upload privileges.

**Additional Notes:**
*   The vulnerability was reported by Petr Å koda, and the Moodle issue number is MDL-33948.
*   The fix is referenced in the provided link to Moodle's git repository: `<http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-33948>`.
*   The vulnerability affected Moodle version 2.3.