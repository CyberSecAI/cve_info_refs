Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2012-3476:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a lack of proper sanitization of user-controlled input when generating the page title. Specifically, HTML tags were not escaped when being inserted into the `<title>` tag of the webpage.

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):** The core vulnerability is a stored XSS flaw. Malicious HTML code could be injected into the page title and subsequently executed when other users viewed the affected page.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** Successful exploitation of this vulnerability would allow an attacker to inject and execute arbitrary JavaScript code within the context of the victim's browser.
*   **Session Hijacking:** Attackers could potentially steal cookies and session tokens, leading to session hijacking.
*   **Website Defacement:** Malicious scripts can modify the appearance of the website.
*   **Malware Distribution:** Attackers could redirect users to malicious websites or force the download of malware.

**Attack Vectors:**

*   **Member Profile Pages:** The vulnerability was present on member profile pages of the Ushahidi platform.
*   **User-Controlled Input:** The attacker would exploit the ability to insert arbitrary HTML code into the page title, which is later rendered in the `<title>` tag.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** An attacker likely needs to be a registered user to have a profile page where they can inject the malicious code in the title.
*   **Ability to Modify Profile:** The attacker would need to be able to edit their profile details to inject the malicious script into the relevant field.

**Technical Details:**

*   **Code Changes:** The provided commit ([https://github.com/ushahidi/Ushahidi_Web/commit/00eae4f](https://github.com/ushahidi/Ushahidi_Web/commit/00eae4f)) shows the fix was implemented by using `html::specialchars()` function. This function is used to convert HTML special characters to their corresponding HTML entities. Specifically, in the file `application/views/admin/layout.php`, the line `<title><?php echo $site_name ?></title>` was changed to `<title><?php echo html::specialchars($site_name) ?></title>`. Similarly, the line `<title><?php echo $page_title.$site_name; ?></title>` was changed to `<title><?php echo html::specialchars($page_title.$site_name); ?></title>` in `themes/default/views/header.php`.

**Additional Notes:**
* The vulnerability was reported by Amy K. Farrell.
* This vulnerability was discovered during FLOSSHack.
* The fix consists of escaping special HTML characters in the page title.