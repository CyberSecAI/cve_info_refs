=== Content from www.debian.org_222711e1_20250125_053841.html ===


---

[[Date Prev](msg00049.html)][[Date Next](msg00051.html)]
[[Thread Prev](msg00049.html)][[Thread Next](msg00051.html)]
[[Date Index](maillist.html#00050)]
[[Thread Index](threads.html#00050)]

# [SECURITY] [DSA 2422-1] file security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2422-1] file security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Wed, 29 Feb 2012 21:54:44 +0100
* *Message-id*: <[[🔎]](/msgid-search/87aa41e4x7.fsf%40mid.deneb.enyo.de) [87aa41e4x7.fsf@mid.deneb.enyo.de](msg00050.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2422-1                   security@debian.org
<http://www.debian.org/security/>                            Florian Weimer
February 29, 2012                      <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : file
Vulnerability  : missing bounds checks
Problem type   : remote
Debian-specific: no

The file type identification tool, file, and its associated library,
libmagic, do not properly process malformed files in the Composite
Document File (CDF) format, leading to crashes.

Note that after this update, file may return different detection
results for CDF files (well-formed or not).  The new detections are
believed to be more accurate.

For the stable distribution (squeeze), this problem has been fixed in
version 5.04-5+squeeze1.

We recommend that you upgrade your file packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJPTpUrAAoJEL97/wQC1SS+xjIH/RKCNTX9XDy9RmKnLubx5gME
e3MOWFZHk0ZOaNAuorRmyrxygbRkLPVMNECTKenv2eE1CORYIHBvzFDZXNn0Yl+9
+NS2KkmwpigU33Tu/8NfuG/xsoLl9fS1a3iJU+yVeEC14gdr0Nw5OtLzSP5C6HUS
KcXZRXQZoHs21SrdotBm0Lx86tmoluZ1QtWmlacJcFnGwMLi3sRBwkE57UufEgCj
dd8BD79tdVWm2YlPjnnfpG8Pe+ikq4tIxDHEKHfsFudUxgeSDAZaHjBvF/2xXrxn
nEjOjbCpaQT9hUaaBzAxFh10qPiKKV4oA3ueR1RZt/T8XMbTXJAM54NYutF2b7Q=
=kRH8
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_a6204c2c_20250125_053847.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffile%2Ffile%2Fcommit%2F1859fdb4e67c49c463c4e0078054335cd46ba295)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffile%2Ffile%2Fcommit%2F1859fdb4e67c49c463c4e0078054335cd46ba295)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=file%2Ffile)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[file](/file)
/
**[file](/file/file)**
Public

* [Notifications](/login?return_to=%2Ffile%2Ffile) You must be signed in to change notification settings
* [Fork
  382](/login?return_to=%2Ffile%2Ffile)
* [Star
   1.3k](/login?return_to=%2Ffile%2Ffile)

* [Code](/file/file)
* [Pull requests
  0](/file/file/pulls)
* [Actions](/file/file/actions)
* [Projects
  0](/file/file/projects)
* [Security](/file/file/security)
* [Insights](/file/file/pulse)

Additional navigation options

* [Code](/file/file)
* [Pull requests](/file/file/pulls)
* [Actions](/file/file/actions)
* [Projects](/file/file/projects)
* [Security](/file/file/security)
* [Insights](/file/file/pulse)

## Commit

[Permalink](/file/file/commit/1859fdb4e67c49c463c4e0078054335cd46ba295)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

add more check found by cert's fuzzer.

[Browse files](/file/file/tree/1859fdb4e67c49c463c4e0078054335cd46ba295)
Browse the repository at this point in the history

* Loading branch information

[![@zoulasc](https://avatars.githubusercontent.com/u/579573?s=40&v=4)](/zoulasc)

[zoulasc](/file/file/commits?author=zoulasc "View all commits by zoulasc")
committed
Feb 17, 2012

1 parent
[155ee1c](/file/file/commit/155ee1c3d035ef233f5b0af87d27fa1cf8dd384a)

commit 1859fdb

Showing
**1 changed file**
with
**15 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

21 changes: 15 additions & 6 deletions

21
[src/cdf.c](#diff-c265601de1ce544590f62a09ef925b79ef8ad0d67f2d35449f132f702647cd38 "src/cdf.c")

Show comments

[View file](/file/file/blob/1859fdb4e67c49c463c4e0078054335cd46ba295/src/cdf.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,7 +35,7 @@ |
|  |  | #include "file.h" |
|  |  |  |
|  |  | #ifndef lint |
|  |  | FILE\_RCSID("@(#)$File: cdf.c,v 1.45 2011/08/28 08:38:48 christos Exp $") |
|  |  | FILE\_RCSID("@(#)$File: cdf.c,v 1.46 2011/09/16 21:23:59 christos Exp $") |
|  |  | #endif |
|  |  |  |
|  |  | #include <assert.h> |
| Expand Down  Expand Up | | @@ -341,18 +341,25 @@ ssize\_t |
|  |  | cdf\_read\_sector(const cdf\_info\_t \*info, void \*buf, size\_t offs, size\_t len, |
|  |  | const cdf\_header\_t \*h, cdf\_secid\_t id) |
|  |  | { |
|  |  | assert((size\_t)CDF\_SEC\_SIZE(h) == len); |
|  |  | return cdf\_read(info, (off\_t)CDF\_SEC\_POS(h, id), |
|  |  | ((char \*)buf) + offs, len); |
|  |  | size\_t ss = CDF\_SEC\_SIZE(h); |
|  |  | size\_t pos = CDF\_SEC\_POS(h, id); |
|  |  | assert(ss == len); |
|  |  | return cdf\_read(info, (off\_t)pos, ((char \*)buf) + offs, len); |
|  |  | } |
|  |  |  |
|  |  | ssize\_t |
|  |  | cdf\_read\_short\_sector(const cdf\_stream\_t \*sst, void \*buf, size\_t offs, |
|  |  | size\_t len, const cdf\_header\_t \*h, cdf\_secid\_t id) |
|  |  | { |
|  |  | assert((size\_t)CDF\_SHORT\_SEC\_SIZE(h) == len); |
|  |  | size\_t ss = CDF\_SHORT\_SEC\_SIZE(h); |
|  |  | size\_t pos = CDF\_SHORT\_SEC\_POS(h, id); |
|  |  | assert(ss == len); |
|  |  | if (sst->sst\_len < (size\_t)id) { |
|  |  | DPRINTF(("bad sector id %d > %d\n", id, sst->sst\_len)); |
|  |  | return -1; |
|  |  | } |
|  |  | (void)memcpy(((char \*)buf) + offs, |
|  |  | ((const char \*)sst->sst\_tab) + CDF\_SHORT\_SEC\_POS(h, id), len); |
|  |  | ((const char \*)sst->sst\_tab) + pos, len); |
|  |  | return len; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -868,6 +875,8 @@ cdf\_read\_property\_info(const cdf\_stream\_t \*sst, const cdf\_header\_t \*h, |
|  |  | inp[i].pi\_str.s\_buf)); |
|  |  | l = 4 + (uint32\_t)CDF\_ROUND(l, sizeof(l)); |
|  |  | o += l >> 2; |
|  |  | if (q + o >= e) |
|  |  | goto out; |
|  |  | o4 = o \* sizeof(uint32\_t); |
|  |  | } |
|  |  | i--; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1859fdb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffile%2Ffile%2Fcommit%2F1859fdb4e67c49c463c4e0078054335cd46ba295) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2f6ff2b4_20250125_053849.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffile%2Ffile%2Fcommit%2F1aec04dbf8a24b8a6ba64c4f74efa0628e36db0b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffile%2Ffile%2Fcommit%2F1aec04dbf8a24b8a6ba64c4f74efa0628e36db0b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=file%2Ffile)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[file](/file)
/
**[file](/file/file)**
Public

* [Notifications](/login?return_to=%2Ffile%2Ffile) You must be signed in to change notification settings
* [Fork
  382](/login?return_to=%2Ffile%2Ffile)
* [Star
   1.3k](/login?return_to=%2Ffile%2Ffile)

* [Code](/file/file)
* [Pull requests
  0](/file/file/pulls)
* [Actions](/file/file/actions)
* [Projects
  0](/file/file/projects)
* [Security](/file/file/security)
* [Insights](/file/file/pulse)

Additional navigation options

* [Code](/file/file)
* [Pull requests](/file/file/pulls)
* [Actions](/file/file/actions)
* [Projects](/file/file/projects)
* [Security](/file/file/security)
* [Insights](/file/file/pulse)

## Commit

[Permalink](/file/file/commit/1aec04dbf8a24b8a6ba64c4f74efa0628e36db0b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bounds checks again.

[Browse files](/file/file/tree/1aec04dbf8a24b8a6ba64c4f74efa0628e36db0b)
Browse the repository at this point in the history

* Loading branch information

[![@zoulasc](https://avatars.githubusercontent.com/u/579573?s=40&v=4)](/zoulasc)

[zoulasc](/file/file/commits?author=zoulasc "View all commits by zoulasc")
committed
Feb 20, 2012

1 parent
[67d1521](/file/file/commit/67d15218f057440c187d7ff671d0c135a5bf4ece)

commit 1aec04d

Showing
**1 changed file**
with
**11 additions**
and
**10 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

21 changes: 11 additions & 10 deletions

21
[src/cdf.c](#diff-c265601de1ce544590f62a09ef925b79ef8ad0d67f2d35449f132f702647cd38 "src/cdf.c")

Show comments

[View file](/file/file/blob/1aec04dbf8a24b8a6ba64c4f74efa0628e36db0b/src/cdf.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,7 +35,7 @@ |
|  |  | #include "file.h" |
|  |  |  |
|  |  | #ifndef lint |
|  |  | FILE\_RCSID("@(#)$File: cdf.c,v 1.48 2012/02/17 05:27:45 christos Exp $") |
|  |  | FILE\_RCSID("@(#)$File: cdf.c,v 1.49 2012/02/20 20:04:37 christos Exp $") |
|  |  | #endif |
|  |  |  |
|  |  | #include <assert.h> |
| Expand Down  Expand Up | | @@ -75,6 +75,7 @@ static union { |
|  |  | #define CDF\_TOLE2(x) ((uint16\_t)(NEED\_SWAP ? \_cdf\_tole2(x) : (uint16\_t)(x))) |
|  |  | #define CDF\_GETUINT32(x, y) cdf\_getuint32(x, y) |
|  |  |  |
|  |  |  |
|  |  | /\* |
|  |  | \* swap a short |
|  |  | \*/ |
| Expand Down  Expand Up | | @@ -351,13 +352,13 @@ ssize\_t |
|  |  | cdf\_read\_short\_sector(const cdf\_stream\_t \*sst, void \*buf, size\_t offs, |
|  |  | size\_t len, const cdf\_header\_t \*h, cdf\_secid\_t id) |
|  |  | { |
|  |  | size\_t ss = CDF\_SEC\_SIZE(h); |
|  |  | size\_t ss = CDF\_SHORT\_SEC\_SIZE(h); |
|  |  | size\_t pos = CDF\_SHORT\_SEC\_POS(h, id); |
|  |  | assert(ss == len); |
|  |  | if (pos > ss \* sst->sst\_len) { |
|  |  | if (pos > CDF\_SEC\_SIZE(h) \* sst->sst\_len) { |
|  |  | DPRINTF(("Out of bounds read %" SIZE\_T\_FORMAT "u > %" |
|  |  | SIZE\_T\_FORMAT "u\n", |
|  |  | pos, ss \* sst->sst\_len)); |
|  |  | pos, CDF\_SEC\_SIZE(h) \* sst->sst\_len)); |
|  |  | return -1; |
|  |  | } |
|  |  | (void)memcpy(((char \*)buf) + offs, |
| Expand Down  Expand Up | | @@ -529,7 +530,7 @@ cdf\_read\_short\_sector\_chain(const cdf\_header\_t \*h, |
|  |  | const cdf\_sat\_t \*ssat, const cdf\_stream\_t \*sst, |
|  |  | cdf\_secid\_t sid, size\_t len, cdf\_stream\_t \*scn) |
|  |  | { |
|  |  | size\_t ss = CDF\_SEC\_SIZE(h), i, j; |
|  |  | size\_t ss = CDF\_SHORT\_SEC\_SIZE(h), i, j; |
|  |  | scn->sst\_len = cdf\_count\_chain(ssat, sid, CDF\_SEC\_SIZE(h)); |
|  |  | scn->sst\_dirlen = len; |
|  |  |  |
| Expand Down  Expand Up | | @@ -798,18 +799,18 @@ cdf\_read\_property\_info(const cdf\_stream\_t \*sst, const cdf\_header\_t \*h, |
|  |  | if (cdf\_check\_stream\_offset(sst, h, e, 0, \_\_LINE\_\_) == -1) |
|  |  | goto out; |
|  |  | for (i = 0; i < sh.sh\_properties; i++) { |
|  |  | size\_t ofs = CDF\_GETUINT32(p, (i << 1) + 1); |
|  |  | q = (const uint8\_t \*)(const void \*) |
|  |  | ((const char \*)(const void \*)p + |
|  |  | CDF\_GETUINT32(p, (i << 1) + 1)) - 2 \* sizeof(uint32\_t); |
|  |  | ((const char \*)(const void \*)p + ofs |
|  |  | - 2 \* sizeof(uint32\_t)); |
|  |  | if (q > e) { |
|  |  | DPRINTF(("Ran of the end %p > %p\n", q, e)); |
|  |  | goto out; |
|  |  | } |
|  |  | inp[i].pi\_id = CDF\_GETUINT32(p, i << 1); |
|  |  | inp[i].pi\_type = CDF\_GETUINT32(q, 0); |
|  |  | DPRINTF(("%" SIZE\_T\_FORMAT "u) id=%x type=%x offs=0x%tx,0x%x\n", i, |
|  |  | inp[i].pi\_id, inp[i].pi\_type, q - p, |
|  |  | CDF\_GETUINT32(p, (i << 1) + 1))); |
|  |  | DPRINTF(("%" SIZE\_T\_FORMAT "u) id=%x type=%x offs=0x%tx,0x%x\n", |
|  |  | i, inp[i].pi\_id, inp[i].pi\_type, q - p, offs)); |
|  |  | if (inp[i].pi\_type & CDF\_VECTOR) { |
|  |  | nelements = CDF\_GETUINT32(q, 1); |
|  |  | o = 2; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1aec04d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffile%2Ffile%2Fcommit%2F1aec04dbf8a24b8a6ba64c4f74efa0628e36db0b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.mandriva.com_87e6b745_20250125_053844.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from launchpad.net_702892f0_20250126_062252.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/file/5.03-5ubuntu1.1/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[file package](https://launchpad.net/ubuntu/%2Bsource/file)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/file)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/file)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/file)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/file)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/file)

# file 5.03-5ubuntu1.1 source package in Ubuntu

## Changelog

```
file (5.03-5ubuntu1.1) lucid-security; urgency=medium

  * SECURITY UPDATE: denial of service via crafted CDF file
    - debian/patches/CVE-2012-1571.patch:
    - CVE-2012-1571
  * SECURITY UPDATE: denial of service via crafted indirect offset value
    - debian/patches/CVE-2013-1943.patch: properly handle recursion in
      src/ascmagic.c, src/file.h, src/funcs.c, src/softmagic.c.
    - CVE-2013-1943
 -- Marc Deslauriers <email address hidden>   Mon, 24 Feb 2014 13:33:26 -0500
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2014-02-24

Uploaded to:
[Lucid](/ubuntu/lucid)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any

Section:
utils

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Lucid](/ubuntu/lucid):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5634226)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armel](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5634227)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5634228)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[ia64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5634229)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5634230)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[sparc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5634231)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [file\_5.03.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/file/5.03-5ubuntu1.1/file_5.03.orig.tar.gz) | 601.8 KiB | 1edab47f9ef2ec5c021204f07566b11e5c2b3ae207af98137a021ac6e9bd95bb |
| [file\_5.03-5ubuntu1.1.diff.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/file/5.03-5ubuntu1.1/file_5.03-5ubuntu1.1.diff.gz) | 65.6 KiB | 3eb399c989e0cb38db0daeb96b14f4183ad264f294367fee436bd3cc11ecdb2a |
| [file\_5.03-5ubuntu1.1.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/file/5.03-5ubuntu1.1/file_5.03-5ubuntu1.1.dsc) | 2.0 KiB | ded827ed39c14d16c8925ebb8aa85fe202a944bbd5b72672b17d9d1d63d29f21 |

### Available diffs

* [diff from 5.03-5ubuntu1 (in Ubuntu) to 5.03-5ubuntu1.1](http://launchpadlibrarian.net/167477656/file_5.03-5ubuntu1_5.03-5ubuntu1.1.diff.gz) (12.7 KiB)

[View changes file](http://launchpadlibrarian.net/167477601/file_5.03-5ubuntu1.1_source.changes)

## Binary packages built by this source

[file](/ubuntu/lucid/%2Bpackage/file):
No summary available for file in ubuntu lucid.

No description available for file in ubuntu lucid.

[libmagic-dev](/ubuntu/lucid/%2Bpackage/libmagic-dev):
No summary available for libmagic-dev in ubuntu lucid.

No description available for libmagic-dev in ubuntu lucid.

[libmagic1](/ubuntu/lucid/%2Bpackage/libmagic1):
No summary available for libmagic1 in ubuntu lucid.

No description available for libmagic1 in ubuntu lucid.

[python-magic](/ubuntu/lucid/%2Bpackage/python-magic):
No summary available for python-magic in ubuntu lucid.

No description available for python-magic in ubuntu lucid.

[python-magic-dbg](/ubuntu/lucid/%2Bpackage/python-magic-dbg):
No summary available for python-magic-dbg in ubuntu lucid.

No description available for python-magic-dbg in ubuntu lucid.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.ubuntu.com_d1156fe0_20250125_053846.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2123-1: file vulnerabilities

26 February 2014

File could be made to crash if it processed a specially crafted file.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 13.10](/security/notices?release=saucy)
* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [file](/security/cves?package=file) - Tool to determine file types

## Details

It was discovered that file incorrectly handled Composite Document files.

An attacker could use this issue to cause file to crash, resulting in a

denial of service. This issue only affected Ubuntu 10.04 LTS and Ubuntu

12.04 LTS. ([CVE-2012-1571](/security/CVE-2012-1571))

Bernd Melchers discovered that file incorrectly handled indirect offset

values. An attacker could use this issue to cause file to consume resources

or crash, resulting in a denial of service. ([CVE-2014-1943](/security/CVE-2014-1943))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 13.10

* [libmagic1](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.11-2ubuntu4.1](https://launchpad.net/ubuntu/%2Bsource/file/5.11-2ubuntu4.1)
* [file](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.11-2ubuntu4.1](https://launchpad.net/ubuntu/%2Bsource/file/5.11-2ubuntu4.1)

##### Ubuntu 12.10

* [libmagic1](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.11-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/file/5.11-2ubuntu0.1)
* [file](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.11-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/file/5.11-2ubuntu0.1)

##### Ubuntu 12.04

* [libmagic1](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.09-2ubuntu0.2](https://launchpad.net/ubuntu/%2Bsource/file/5.09-2ubuntu0.2)
* [file](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.09-2ubuntu0.2](https://launchpad.net/ubuntu/%2Bsource/file/5.09-2ubuntu0.2)

##### Ubuntu 10.04

* [libmagic1](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.03-5ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/file/5.03-5ubuntu1.1)
* [file](https://launchpad.net/ubuntu/%2Bsource/file)
  -
  [5.03-5ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/file/5.03-5ubuntu1.1)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2012-1571](/security/CVE-2012-1571)
* [CVE-2014-1943](/security/CVE-2014-1943)

## Related notices

* [USN-2126-1](/security/notices/USN-2126-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


