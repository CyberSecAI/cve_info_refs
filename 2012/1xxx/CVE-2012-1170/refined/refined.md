```
{
  "vulnerability": {
    "root_cause": "The external enrolment plugin in Moodle versions 2.2 to 2.2.1+ had insufficient capability checks when retrieving enrolled users.",
    "weaknesses": [
      "Inadequate capability checks",
      "Use of undefined context and course contexts"
    ],
    "impact": "An attacker could potentially bypass intended access controls, leading to unauthorized information access or other unintended consequences.",
    "attack_vectors": [
      "Network access"
    ],
    "required_capabilities": "The attacker needs to access the vulnerable system via the network.",
    "details": "Moodle versions 2.2 to 2.2.1+ are vulnerable due to the external enrolment plugin's inadequate capability checks. This allows an attacker to potentially bypass security checks during retrieval of enrolled users. The vulnerability arises in the 'core_enrol_external.get_enrolled_users()' method, which uses undefined '$context' and '$coursecontext' in its 'has_capability()' calls. This could lead to unauthorized access or other unintended consequences."
  }
}
```