- **Root cause of vulnerability:** The vulnerability is due to a missing session check in the `/lib/logout.php` script. Unlike other PHP scripts in the application, this script does not verify the user's session or authentication status before logging them out.
- **Weaknesses/vulnerabilities present:**
    - **CSRF (Cross-Site Request Forgery):** The lack of session validation in `/lib/logout.php` allows an attacker to craft a malicious request that forces a logged-in administrator or investigator to log out.
    - **Lack of HTTPS redirection:** The default installation of PTK does not enforce HTTPS, leaving authentication credentials vulnerable to sniffing via Man-in-the-Middle (MitM) attacks.
- **Impact of exploitation:**
    - An attacker can force an administrator/investigator to log out of the PTK web management interface via CSRF.
    - If combined with a MitM attack, the forced logout can expose authentication credentials transmitted over the insecure HTTP connection.
- **Attack vectors:**
    - An attacker can embed a malicious HTML/JavaScript code within a webpage. When a logged-in PTK user browses this page, the embedded code submits a GET request to the logout script, effectively forcing a logout.
    - The lack of HTTPS redirection allows an attacker to perform a MitM attack using tools such as Dsniff and Ettercap, intercepting authentication data when a user logs back in.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to induce a logged-in user to visit a webpage containing the CSRF exploit.
    - For successful credentials theft, the attacker requires a network position allowing for a MitM attack on the user's connection to the PTK server (e.g., internal network access).