=== Content from bugzilla.novell.com_1cdd2965_20250125_153923.html ===




=== Content from www.openwall.com_05c19eff_20250125_153913.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](../../../2012/04/05/1) [[<thread-prev]](9) [[thread-next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5620.1333568872@sss.pgh.pa.us>
Date: Wed, 04 Apr 2012 15:47:52 -0400
From: Tom Lane <tgl@...hat.com>
To: Kurt Seifried <kseifried@...hat.com>
cc: oss-security@...ts.openwall.com, Jan Lieskovsky <jlieskov@...hat.com>,
        "Steven M. Christey" <coley@...us.mitre.org>,
        pgsql-jdbc@...tgresql.org, Steffen Dettmer <steffen@...t.de>
Subject: Re: CVE DISPUTE notification: postgresql-jdbc: SQL injection due improper escaping of JDBC statement parameters

Kurt Seifried <kseifried@...hat.com> writes:
> So I think it's safe to say that we can (and should) assign CVE's
> based on the unintended interactions of products (assigning a CVE
> helps ensure that people are more likely to find out, security
> scanners all love to pick up on CVE's, etc.). I'm going to assign a
> CVE for this and suggest a description of (stolen directly from the
> first bug report
> (<http://lists.opensuse.org/opensuse-security/2012-03/msg00024.html>):

> "When using PostgreSQL JDBC driver version 8.1 to connect to a
> PostgreSQL version 9.1 database, escaping of JDBC statement parameters
> does not work and SQL injection attacks are possible. It should be
> noted that the PostgreSQL JDBC driver version 8.1 is officially
> obsolete and should not be used."

> Please use CVE-2012-1618 for this issue.

Well, if you want to have a CVE for this, you should use a more
complete description.  The actual scenario is that pre-8.2 versions
of the JDBC driver do not know about the "standard_conforming_strings"
option of more recent Postgres servers, and are insecure with *any*
Postgres server in which that option is turned on, which has been
possible since server version 8.2.  What changed in the 9.1 server
is that that option is now on by default.  It's still possible
(and will remain so for the foreseeable future) to turn the option off
in the server configuration, making this and other ancient clients
secure again.  But that isn't the default anymore.

			regards, tom lane

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.opensuse.org_a475f8ca_20250125_153910.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security%40lists.opensuse.org/message/R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F/)
[Sign Up](/accounts/signup/?next=/archives/list/security%40lists.opensuse.org/message/R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F/)

[Manage this list](/manage/lists/security.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security%40lists.opensuse.org/message/R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F/)
[Sign Up](/accounts/signup/?next=/archives/list/security%40lists.opensuse.org/message/R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security%40lists.opensuse.org/thread/R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F/#R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F)

# [opensuse-security] SQL injection attack possible when connecting to PostgreSQL 9.1 with version 8.1 JDBC driver

![](https://seccdn.libravatar.org/avatar/360c89473e19c7f8c9fe5ca60e12f8ce.jpg?s=120&d=mm&r=g)
## [Steffen Dettmer](/archives/users/729a226ca3644da398155b63cbb04e0b/ "See the profile for Steffen Dettmer")

25 Mar
2012

25 Mar
'12

12:37

Hi,
when using PostgreSQL JDBC driver version 8.1 to connect to a PostgreSQL
version 9.1 database, escaping of JDBC statement parameters does
not work and SQL injection attacks are possible.
The problem can be reproduced for example with version 8.1-415
(released 2010-05-11), which still can be downloaded from the
official download location (although in `Archived Section'),
however this version is included in Linux distributions that are
still supported (for example SuSE Linux Enterprise Edition with
long-term support).
Connecting Java applications from such a server to a recent
PostgreSQL database, SQL injection attacks are possible.
Java Web Applications using JDBC running on such Linux versions
could allow to exploit this remotely, for example through a web app.
Vendor reponse (from <security@postgresql.org>):

...
> Anything not identified there as current or supported is, by
> reasonable inference, neither. Reporting a security bug
> against anything that's not current or supported is pointless.

However, such unsupported driver versions are included in
supported Linux distributions.
Since I think it is possible to accidentally use older (but still
supported) Linux application servers against recent databases, I
think a public information could be of interest.
Possible fix or workaround:
Do not use PostgreSQL JDBC driver version 8.1 but upgrade to most
recent version. If the distribution offers no suited package
(RPM), driver should be downloaded from jdbc.postgresql.org and
installed manually. This breaks package management consitency but
seems to be the smaller issue.
How to reproduce:
When the small code Postgres.java (attached) is compiled and
runned with Java 1.7 and the Postgres 8.1 JDBC3 driver against a
Postgres 9.1 database:
$ java -cp postgresql-8.1-415.jdbc3.jar:. Postgres
the following Exception occures:
Exception in thread "main" org.postgresql.util.PSQLException:
ERROR: syntax error at or near "(" at character 134
The driver can be downloaded under
<http://jdbc.postgresql.org/download/postgresql-8.1-415.jdbc3.jar>
In the "Archived Versions"-section of <http://jdbc.postgresql.org/download.html>.
(They are supported anymore, but there is no hint that
downloading and using them in our point of view opens a security
treat, so we think this is not good)
When the application is run with the Postgres 9.1 JDBC3 driver,
it behaves correctly.
We think it is likely that JDBC drivers with 8.1-x are still used
productively, for example SuSE Linux Enterprise Edition with
long-term support and we are not aware of some security bulletin
telling that an upgrade is recommended for security reasons,
since there might be not much interest in changing running
systems without need.
Regards,
Steffen Dettmer
------------------------------------------------------------------->8=======
\* Steffen Dettmer wrote on Mon, Feb 27, 2012 at 17:36 +0100:

...
> Hi,
>
> we think we have found an escaping problem in JDBC driver 8.1 allowing
> SQL injection attacks when connecting to PostgreSQL 9.1 . According to
> <http://jdbc.postgresql.org/changes.html#version_8.1-415>, this
> issue is not known (not fixed).
> [...]
> Our software relys on correct parameter escaping when using a
> java.sql.PreparedStatement for "SELECT stored\_procedure(?, ?) AS
> result" used with "statement.setString()" etc., which according to our
> understanding should be the usual and safe way to call stored
> procedures on PostgreSQL.
>
> We found that it fails with at least postgresql-8.1-407.jdbc3.jar
> from <http://jdbc.postgresql.org/download.html> and Postgres 9.1
> database.
>
> The exact case where it occured in production was the query:
>
> SELECT appendJobEvent(?, ?, ?, ?) AS result
>
> with parameters set via "setString(pos, value)". Parameter
> number 4 contained single quote characters, but they should be
> escaped and end up in the database literally.
>
> Instead, we get:
>
> ERROR: syntax error at or near "(" at character 163 (ERROR:
> syntax error at or near "(" at character 163)'
>
> we tested and got exactly the same error message when using the string
> directly (i.e. not via "?" and setString), which is expected.
>
> Connecting to an older database version (7.1) or updating the driver
> to postgresql-9.1-901.jdbc3.jar from
> <http://jdbc.postgresql.org/download.html> both make the same query
> with the same parameters work.
>
> Since our development environment unit tests check for a similar
> issue, it seems that when using the same version of JDBC driver and
> database (the normal configuration when having a test database on
> localhost), escaping probably works well in a probably wide range of
> versions, but not in at least this combination (8.1-407 JDBC driver to
> 9.1 DBMS).

--[ Postgres.java ]------------------------------------------------>8=======
// "Sascha BAER" <Sascha.BAER@ingenico.com> -- SFR-1315206
// SQL injection when connecting to PostgreSQL 9.1 with version 8.1 JDBC driver
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Properties;
public class Postgres
{
public static void main(String[] args)
throws Exception
{
Properties connectionProps = new Properties();
// Load postgres Driver: this is needed for 8.1 Drivers.
Class jdbcDriver = Class.forName("org.postgresql.Driver");
connectionProps.put("user", "sfr1315206");
connectionProps.put("password", "secret");
// protocolVersion 2 is needed to trigger the problem.
connectionProps.put("protocolVersion", "2");
Connection conn = DriverManager.getConnection(
"jdbc:postgresql://pg9-test/test1315206",
connectionProps);
String hint = new String("com.ingenico.de.data.DataException: "
+ "(Bitmap 2: ( (Data exceeds format length!); "
+ "Producer f = `PropLLXPVar(19): null') (F1F2672191104016...)): "
+ "class com.ingenico.de.data.DataException (5): "
+ "[thrown in `consume()' at BitmapConsumer.java, line 84]");
PreparedStatement ps = conn.prepareStatement(
"SELECT foo(?) AS result");
ps.setString(1, hint);
ResultSet result = ps.executeQuery();
result.next();
System.out.println(result.getString(1));
}
}
// Configuration stuff for the emacs editor. Please don't remove
// Local Variables:
// tab-width: 4
// End:
// Modeline for VIM. Please don't remove.
// (Help: autoindent, expandtab, shiftwidth=4, tabstop=4, textwidth=75)
// vi: set ai et sw=4 ts=4 tw=75:
--
To unsubscribe, e-mail: opensuse-security+unsubscribe@opensuse.org
To contact the owner, e-mail: opensuse-security+owner@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security%40lists.opensuse.org/message/R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F/)
Use email software

[Back to the thread](/archives/list/security%40lists.opensuse.org/thread/R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F/#R6XUSIEOCVQQVIZWWZ5IIBBGJH72IU4F)

[Back to the list](/archives/list/security%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.openwall.com_48f06003_20250125_153912.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2012/03/30/8) [[thread-next>]](../../../2012/04/04/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <4F798A9C0200002500046A8D@gw.wicourts.gov>
Date: Mon, 02 Apr 2012 11:16:44 -0500
From: "Kevin Grittner" <Kevin.Grittner@...ourts.gov>
To: "Steven M. Christey" <coley@...us.mitre.org>
Cc: "Steffen Dettmer" <steffen@...t.de>,
 <oss-security@...ts.openwall.com>,<pgsql-jdbc@...tgresql.org>,
 "Tom Lane" <tgl@...hat.com>
Subject: Re: [JDBC] CVE DISPUTE notification: postgresql-jdbc: SQL
 injection due improper escaping of JDBC statement parameters

What follows is just one perspective from a DBA at a production
shop.

Jan Lieskovsky <jlieskov@...hat.com> wrote:

> This is NOT an official JDBC driver for PostgreSQL database
> development team statement yet (in the sense it would reference
> some upstream document / web page).
> Anyway, we have got preliminary notification there is a upstream
> intention to provide such page (document which postgresql-jdbc
> versions are expected to work correctly with which versions of
> PostgreSQL database server).

Presumably you are aware of this section on the download page:

<http://jdbc.postgresql.org/download.html#current>

Which says:

| This is the current version of the driver. Unless you have unusual
| requirements (running old applications or JVMs), this is the
| driver you should be using. It supports Postgresql 7.2 or newer
| and requires a 1.4 or newer JVM. It contains support for SSL and
| the javax.sql package. It comes in two flavors, JDBC3 and JDBC4.
| If you are using the 1.6 or 1.7 JVM, then you should use the JDBC4
| version.
|
| JDBC3 Postgresql Driver, Version 9.1-901
|
| JDBC4 Postgresql Driver, Version 9.1-901

And the section on supported versions of PostgreSQL:

<http://www.postgresql.org/support/versioning/>

... which shows version 8.1 as having reached end-of-life and gone
out of support five years after release, in November, 2010.  As far
as I could tell from a quick skim of the referenced links, this
problem only exists when using this out-of-support version of the
JDBC driver.

While I certainly can't speak for the PostgreSQL community, I can
say that the shop at which I work (the Consolidated Courts
Automation Program of the Wisconsin Supreme Court), we pay attention
to these pages and never consider it safe to use an unsupported
version.  We upgrade our JDBC drivers as soon as practicable
whenever the recommended version on the JDBC download page changes.
Of course, this is assigned to be done with some application
software release and the JDBC version rolls out through development,
testing, and staging servers before it is deployed to production, as
we do with the server product itself.

It is frequently mentioned on the PostgreSQL support lists that it
is not a good idea to use older drivers and client libraries with
newer servers, although the opposite is supported.  We respect this
advice, and it seems reasonable to us.  If that's not mentioned
explicitly on an official web page, I agree that it should be.

-Kevin

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_e38e2a20_20250125_153913.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2012/04/02/4) [[thread-next>]](9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAOBoUnMMpTB8n4tGJXzooEbie56JbA=_NvQ=a8Z41oQfFX2-wA@mail.gmail.com>
Date: Wed, 4 Apr 2012 11:07:05 +0200
From: Steffen Dettmer <steffen.dettmer@...glemail.com>
To: oss-security@...ts.openwall.com
Subject: Re: Re: [JDBC] CVE DISPUTE notification:
 postgresql-jdbc: SQL injection due improper escaping of JDBC statement parameters

On Mon, Apr 2, 2012 at 6:16 PM, Kevin Grittner
<Kevin.Grittner@...ourts.gov> wrote:
> ... which shows version 8.1 as having reached end-of-life and gone
> out of support five years after release, in November, 2010.

Thank you for sharing your view. Let's me take this opportunity
to tell my arguments why I think an advisory with this
information could be suited.

Yes, all this is true. However, not everyone knows all that and
can "apply usual expectations".

So you don't have old clients running anywhere? Others may follow
the idea not to change a running system (at least as supported by
vendor) but for some reason upgraded one of their databases to a
newer version.

Is this such an unlikely situation that some few old applications
connect to a database which later is updated because some newer
applications benefit from newer database features? Or because the
database server hard- and software is upgraded to keep increasing
performance requirements?

Of course for an expert focusing PostgreSQL / JDBC all this is
known, clear and obvious, but for the less experienced people,
for example application developers, it might not be the case.

Java developers may follow "run everywhere" as long as the test
suites pass (which might not include security penetration testing
and even if so may fail to detect the problem).

Who is in charge to know that such a combination is insecure? The
application vendors might not know which JDBC / DBMS combination
a customer might use. At the customer site IT professionals may
choose supported distributions and may not know details of
PostgreSQL version requirements, especially if not stated in the
manuals.

The last 8.1 version (build) is from 2010, so someone could
assume it would still be supported. I think this shouldn't be
mentioned only somewhere on a web page, but in the appropriate
users manuals.

Often so many things are used by projects that it could be very
hard trying to read all related mailing lists.

When using a linux distribution that is still supported by the
vendor, I think it is reasonable to assume the included packages
are still supported at least by the same vendor.

I talked with a (very) few people, no one had assumed that; the
assumption was "install all vendor patches and be safe for known
issues" and that different versions either work securely or not
at all.

IMHO also misleading seems to be the term "protocol version 3". I
think this really suggests that any protocol version 3 client
could connect to any protocol version 3 server.
But this is not true. There are many different protocol
version 3 versions, but I don't think that this is commonly
understood by end users. I know that it is nowhere told that it
would be interoperable, but I think a common assumption would be
that protocol v3 is interoperable with protocol v3.

The current situation seems to be "you cannot use older versions
of your enterprise long term support distribution to connect newer
versions of your enterprise long term support one", which in my
point of view had been worth an advisory, but maintainers seem to
conclude that what is not supported from the project does not
need to be supported by the distribution.

Maybe maintainers could decide to provide an advisory anyway, be
it only summarizing the issue. I understand that creating a patch
would be much effort, is not supported and disliked, but
spreading the information could be suited nevertheless.
Distributors could decide to pack newer versions. Even if not,
Distribution customers then at least could decide to upgrade
their systems and/or manually install a suited driver version.

Knowing the issue is needed in any case, I think.

oki,

Steffen

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_a99f9935_20250125_153914.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[<thread-prev]](5) [[thread-next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4F7CA1E8.7090606@redhat.com>
Date: Wed, 04 Apr 2012 13:32:56 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Jan Lieskovsky <jlieskov@...hat.com>,
        "Steven M. Christey" <coley@...us.mitre.org>,
        Tom Lane <tgl@...hat.com>, pgsql-jdbc@...tgresql.org,
        Steffen Dettmer <steffen@...t.de>
Subject: Re: CVE DISPUTE notification: postgresql-jdbc: SQL
 injection due improper escaping of JDBC statement parameters

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 03/30/2012 06:28 AM, Jan Lieskovsky wrote:
> Hello Kurt, Steve, vendors,
>
> originally, the following deficiency has been reported by Steffen
> Dettmer: [1] <http://seclists.org/bugtraq/2012/Mar/125>
>
> A SQL injection flaw was found in the way postgresql-jdbc, a JDBC
> driver for PostgreSQL database, performed escaping of certain JDBC
> statement parameters. A remote attacker could provide a JDBC
> statement with specially-crafted parameters, which once processed
> by the postgresql-jdbc driver would lead to SQL injection.
>
> References: [2]
> <http://lists.opensuse.org/opensuse-security/2012-03/msg00024.html>
> [3] <https://bugzilla.novell.com/show_bug.cgi?id=754273> [4]
> <https://bugzilla.redhat.com/show_bug.cgi?id=807394>
>
> Upon further issue investigation and discussion with Tom Lane of
> PostgreSQL upstream and JDBC driver upstream the following
> conclusion has been provided:
>
> The upstream development team of the JDBC driver for the
> PostgreSQL database does not consider improper escaping of certain
> JDBC statement / query parameters, when the JDBC driver of version
> older than the version of underlying PostgresSQL server is being
> used, to be a security defect. In general, the JDBC driver for the
> PostgreSQL database does not promise to work with server releases
> newer than the driver release.

Apologies for the delay, at first I agreed with the above, but then I
checked and I think it's a bit more nuanced than that.

First off: I agree this is not an issue in PostgreSQL upstream. This
issue only occurs with an ancient unsupported and obsolete version of
the JDBC driver when being used with a newer version of PostgreSQL.

However having stated that there is a security boundary violation
going on. Just because a software component is out of date or not
supported doesn't mean security bugs shouldn't at least be
acknowledged (software tends to live past its designed lifetime). Add
to this the fact that someone actually reported it we can state with
some certainty that it affected at least one person, ergo there is a
reasonable chance it may affect others.

So I checked the CVE database, we have 64 instances of "when used
with", some reasonable examples:

CVE-2009-4040,Candidate,"Cross-site scripting (XSS) vulnerability in
phpMyFAQ before 2.0.17 and 2.5.x before 2.5.2, when used with Internet
Explorer 6 or 7, allows remote attackers to inject arbitrary web
script or HTML via unspecified parameters to the search
page.","CONFIRM:<http://www.phpmyfaq.de/advisory_2009-09-01.php>

CVE-2008-2705,Candidate,"Unspecified vulnerability in Sun Java System
Access Manager (AM) 7.1, when used with certain versions and
configurations of Sun Directory Server Enterprise Edition (DSEE),
allows remote attackers to bypass authentication via unspecified
vectors.","SUNALERT:238416

So I think it's safe to say that we can (and should) assign CVE's
based on the unintended interactions of products (assigning a CVE
helps ensure that people are more likely to find out, security
scanners all love to pick up on CVE's, etc.). I'm going to assign a
CVE for this and suggest a description of (stolen directly from the
first bug report
(<http://lists.opensuse.org/opensuse-security/2012-03/msg00024.html>):

"When using PostgreSQL JDBC driver version 8.1 to connect to a
PostgreSQL version 9.1 database, escaping of JDBC statement parameters
does not work and SQL injection attacks are possible. It should be
noted that the PostgreSQL JDBC driver version 8.1 is officially
obsolete and should not be used."

Please use CVE-2012-1618 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iQIcBAEBAgAGBQJPfKHoAAoJEBYNRVNeJnmT/u4QAI03PTYXs1ceSoMIZ1ORjj7x
vFTKfdOaXercFFonIrVzf4e54gCObUJgse3rdz6ONh59FkqDSDW1WISYhLi+pMAj
fLCng+vaB3ctiI6KurenKpy1fIWg9CsNTsx+9N2UG0JorMYp9hhih/9KRcwcvbLV
TXl7psu7OhOKc6J2re1bjQO+gbyVPZxvkYfs1CvXvIh27FWWzoNFYLL34rRdZIwo
fcfy5z7AWEehxpPRRBijllYVQambqdXu2m8PBRLn7pgy/dRPuDbn/yiKcC39+1EK
jcaiFH7P1XtXXQouy13Ta3yhHsZiVDZmNyR+YKnRYQIY9ICjFNxR+rdBbSM0f2Eu
JO1Sa9eewe7bsylIchIRoVtGuzvOlxv18Dujp6iD7pvIaLNJ9uuuabz9lX/9rm3p
WX++VxYk+k+cGOGjttnlSfiS+TYnFjLgS6fM4AAp6oBPg13ndrKJL4m7qYNoJzjd
S4JhOxn8VcgRFAo8otLzIRxWrsYYG8/xybr5/NESmC8hcr0mhYUIGyLx5qu0/QAR
ri1QT3BPs7SoqGGaJHUZtqOK/vAkDHn1SdA/VopWcpk2XmP2rd0h0Mh+jkA3Pd6C
SaL2HvwRq9a9T9rJozESHnPd8HqvDgaUdKADcYEV9xS+axZMHRPpHSppvt93GKao
ClES06wUx2zOrWyNijbF
=jlUp
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_9506279d_20250125_153911.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[thread-next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4F75AC42.7070904@suse.de>
Date: Fri, 30 Mar 2012 14:51:14 +0200
From: Ludwig Nussel <ludwig.nussel@...e.de>
To: oss-security@...ts.openwall.com, security@...tgresql.org
Subject: postgresql-jdbc 8.1 SQL injection with postgresql server 9.1

Hi,

Postgresql 9.1 turned "standard conforming strings" on by default[1][2].
postgresql-jdbc before version 8.2-504 however did not know about that
kind of string and escaped single quotes with a backslash always. When
such an old version of postgresql-jdbc is used with a newer postgresql
server it not only breaks when strings contain single quotes, it also
allows for SQL injections[3].
The bug is neither in postgresql-jdbc as it was working correctly at the
time it was released, nor is it really postgresql 9.1's fault which I
guess doesn't expect and can't detect such an old jdbc adapter. The
security issue arises when mixing the old adapter and the new server.
One might be inclined to say this is not a security issue as it's likely
to break during normal operation as soon as some string contains a
single quote. But then isn't that the case for SQL injections in
general?

[1] <http://www.depesz.com/2010/07/21/waiting-for-9-1-standard_conforming_strings-on/>
[2] <http://archives.postgresql.org/pgsql-committers/2010-07/msg00210.php>
[3] <http://lists.opensuse.org/opensuse-security/2012-03/msg00024.html>

cu
Ludwig

--
 (o_   Ludwig Nussel
 //\
 V_/_  <http://www.suse.de/>
SUSE LINUX Products GmbH, GF: Jeff Hawn, Jennifer Guild, Felix Imendörffer, HRB 16746 (AG Nürnberg)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_25293ca4_20250125_153913.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2012/03/30/20) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4F7C05BA.6040905@suse.de>
Date: Wed, 04 Apr 2012 10:26:34 +0200
From: Ludwig Nussel <ludwig.nussel@...e.de>
To: oss-security@...ts.openwall.com, security@...tgresql.org
Subject: Re: Re: [pgsql-security] postgresql-jdbc 8.1 SQL injection
 with postgresql server 9.1

Robert Haas wrote:
> On Fri, Mar 30, 2012 at 8:51 AM, Ludwig Nussel <ludwig.nussel@...e.de> wrote:
>> Postgresql 9.1 turned "standard conforming strings" on by default[1][2].
>> postgresql-jdbc before version 8.2-504 however did not know about that
>> kind of string and escaped single quotes with a backslash always. When
>> such an old version of postgresql-jdbc is used with a newer postgresql
>> server it not only breaks when strings contain single quotes, it also
>> allows for SQL injections[3].
>> The bug is neither in postgresql-jdbc as it was working correctly at the
>> time it was released, nor is it really postgresql 9.1's fault which I
>> guess doesn't expect and can't detect such an old jdbc adapter. The
>> security issue arises when mixing the old adapter and the new server.
>
> Right.  This issue has been previously reported to pgsql-security.
> The position of the pgsql-jdbc project is that a client version should
> be used with a matching server version; therefore, the project views
> the proposed combination as an unsupported configuration.

Sure, no doubt about that. The postgresql-jdbc package should have been
updated a long time ago but obviously was forgotten. If we had updated
it a year ago we'd have created a normal version update due to EOL of
the old package with no security context at all. Now that it's known
that the unsupported combination of versions allows for SQL injection
however the update suddenly becomes security relevant.

cu
Ludwig

--
 (o_   Ludwig Nussel
 //\
 V_/_  <http://www.suse.de/>
SUSE LINUX Products GmbH, GF: Jeff Hawn, Jennifer Guild, Felix Imendörffer, HRB 16746 (AG Nürnberg)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_7d59ab7f_20250125_153911.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2012/03/30/20) [[next>]](2) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120331162023.GB5147@link.net.de>
Date: Sat, 31 Mar 2012 18:20:23 +0200
From: Steffen Dettmer <steffen@...t.de>
To: oss-security@...ts.openwall.com
Subject: SQL injection attack possible when connecting to PostgreSQL 9.1 with version 8.1 JDBC driver

Hi,

when using PostgreSQL JDBC driver version 8.1 to connect to a PostgreSQL
version 9.1 database, escaping of JDBC statement parameters does
not work and SQL injection attacks are possible.

The problem can be reproduced for example with version 8.1-415
(released 2010-05-11), which still can be downloaded from the
official download location (although in `Archived Section'),
however this version is included in Linux distributions that are
still supported (for example SuSE Linux Enterprise Edition with
long-term support).

Connecting Java applications from such a server to a recent
PostgreSQL database, SQL injection attacks are possible.

Java Web Applications using JDBC running on such Linux versions
could allow to exploit this remotely, for example through a web app.

Vendor reponse (from <security@...tgresql.org>):

> Anything not identified there as current or supported is, by
> reasonable inference, neither. Reporting a security bug
> against anything that's not current or supported is pointless.

However, such unsupported driver versions are included in
supported Linux distributions.

Since I think it is possible to accidentally use older (but still
supported) Linux application servers against recent databases, I
think a public information could be of interest.

Possible fix or workaround:

Do not use PostgreSQL JDBC driver version 8.1 but upgrade to most
recent version. If the distribution offers no suited package
(RPM), driver should be downloaded from jdbc.postgresql.org and
installed manually. This breaks package management consitency but
seems to be the smaller issue.

How to reproduce:

When the small code Postgres.java (attached) is compiled and
runned with Java 1.7 and the Postgres 8.1 JDBC3 driver against a
Postgres 9.1 database:

  $ java -cp postgresql-8.1-415.jdbc3.jar:. Postgres

the following Exception occures:

  Exception in thread "main" org.postgresql.util.PSQLException:
    ERROR:  syntax error at or near "(" at character 134

The driver can be downloaded under

  <http://jdbc.postgresql.org/download/postgresql-8.1-415.jdbc3.jar>

In the "Archived Versions"-section of <http://jdbc.postgresql.org/download.html>.

(They are supported anymore, but there is no hint that
downloading and using them in our point of view opens a security
treat, so we think this is not good)

When the application is run with the Postgres 9.1 JDBC3 driver,
it behaves correctly.

We think it is likely that JDBC drivers with 8.1-x are still used
productively, for example SuSE Linux Enterprise Edition with
long-term support and we are not aware of some security bulletin
telling that an upgrade is recommended for security reasons,
since there might be not much interest in changing running
systems without need.

Regards,
Steffen Dettmer

------------------------------------------------------------------->8=======
* Steffen Dettmer wrote on Mon, Feb 27, 2012 at 17:36 +0100:
> Hi,
>
> we think we have found an escaping problem in JDBC driver 8.1 allowing
> SQL injection attacks when connecting to PostgreSQL 9.1 . According to
> <http://jdbc.postgresql.org/changes.html#version_8.1-415>, this
> issue is not known (not fixed).
 [...]
> Our software relys on correct parameter escaping when using a
> java.sql.PreparedStatement for "SELECT stored_procedure(?, ?) AS
> result" used with "statement.setString()" etc., which according to our
> understanding should be the usual and safe way to call stored
> procedures on PostgreSQL.
>
> We found that it fails with at least postgresql-8.1-407.jdbc3.jar
> from <http://jdbc.postgresql.org/download.html> and Postgres 9.1
> database.
>
> The exact case where it occured in production was the query:
>
> SELECT appendJobEvent(?, ?, ?, ?) AS result
>
> with parameters set via "setString(pos, value)". Parameter
> number 4 contained single quote characters, but they should be
> escaped and end up in the database literally.
>
> Instead, we get:
>
>   ERROR:  syntax error at or near "(" at character 163 (ERROR:
>   syntax error at or near "(" at character 163)'
>
> we tested and got exactly the same error message when using the string
> directly (i.e. not via "?" and setString), which is expected.
>
> Connecting to an older database version (7.1) or updating the driver
> to postgresql-9.1-901.jdbc3.jar from
> <http://jdbc.postgresql.org/download.html> both make the same query
> with the same parameters work.
>
> Since our development environment unit tests check for a similar
> issue, it seems that when using the same version of JDBC driver and
> database (the normal configuration when having a test database on
> localhost), escaping probably works well in a probably wide range of
> versions, but not in at least this combination (8.1-407 JDBC driver to
> 9.1 DBMS).

--[ Postgres.java ]------------------------------------------------>8=======

// "Sascha BAER" <Sascha.BAER@...enico.com> -- SFR-1315206
// SQL injection when connecting to PostgreSQL 9.1 with version 8.1 JDBC driver
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import java.util.Properties;

public class Postgres
{
    public static void main(String[] args)
        throws Exception
    {
        Properties connectionProps = new Properties();
        // Load postgres Driver: this is needed for 8.1 Drivers.
        Class jdbcDriver = Class.forName("org.postgresql.Driver");

        connectionProps.put("user",     "sfr1315206");
        connectionProps.put("password", "secret");

        // protocolVersion 2 is needed to trigger the problem.
        connectionProps.put("protocolVersion", "2");

        Connection conn = DriverManager.getConnection(
            "jdbc:postgresql://pg9-test/test1315206",
            connectionProps);

        String hint = new String("com.ingenico.de.data.DataException:  "
            + "(Bitmap 2:  ( (Data exceeds format length!); "
            + "Producer f = `PropLLXPVar(19): null') (F1F2672191104016...)): "
            + "class com.ingenico.de.data.DataException (5):  "
            + "[thrown in `consume()' at BitmapConsumer.java, line 84]");

        PreparedStatement ps = conn.prepareStatement(
                "SELECT foo(?) AS result");
        ps.setString(1, hint);
        ResultSet result = ps.executeQuery();

        result.next();
        System.out.println(result.getString(1));
    }
}

// Configuration stuff for the emacs editor. Please don't remove
// Local Variables:
// tab-width: 4
// End:

// Modeline for VIM. Please don't remove.
// (Help: autoindent, expandtab, shiftwidth=4, tabstop=4, textwidth=75)
// vi: set ai et sw=4 ts=4 tw=75:

----- End forwarded message -----
oki,

Steffen

--
Dieses Schreiben wurde maschinell erstellt,
es trägt daher weder Unterschrift noch Siegel.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_69d3a123_20250125_153911.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[thread-next>]](../../../2012/04/02/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4F75A6D2.4040801@redhat.com>
Date: Fri, 30 Mar 2012 14:28:02 +0200
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
CC: oss-security@...ts.openwall.com, Tom Lane <tgl@...hat.com>,
        pgsql-jdbc@...tgresql.org, Steffen Dettmer <steffen@...t.de>
Subject: CVE DISPUTE notification: postgresql-jdbc: SQL injection due improper
 escaping of JDBC statement parameters

Hello Kurt, Steve, vendors,

   originally, the following deficiency has been reported by Steffen Dettmer:
   [1] <http://seclists.org/bugtraq/2012/Mar/125>

A SQL injection flaw was found in the way postgresql-jdbc, a JDBC driver for
PostgreSQL database, performed escaping of certain JDBC statement parameters. A
remote attacker could provide a JDBC statement with specially-crafted
parameters, which once processed by the postgresql-jdbc driver would lead to
SQL injection.

References:
[2] <http://lists.opensuse.org/opensuse-security/2012-03/msg00024.html>
[3] <https://bugzilla.novell.com/show_bug.cgi?id=754273>
[4] <https://bugzilla.redhat.com/show_bug.cgi?id=807394>

Upon further issue investigation and discussion with Tom Lane of PostgreSQL
upstream and JDBC driver upstream the following conclusion has been provided:

The upstream development team of the JDBC driver for the PostgreSQL database
does not consider improper escaping of certain JDBC statement / query
parameters, when the JDBC driver of version older than the version of
underlying PostgresSQL server is being used, to be a security defect. In
general, the JDBC driver for the PostgreSQL database does not promise to work
with server releases newer than the driver release.

This is NOT an official JDBC driver for PostgreSQL database development team
statement yet (in the sense it would reference some upstream document / web page).
Anyway, we have got preliminary notification there is a upstream intention to
provide such page (document which postgresql-jdbc versions are expected to work
correctly with which versions of PostgreSQL database server).

Till this is done, please take this post as a clarification of postgresql-jdbc's
upstream intentions to dispute the possibly later allocated CVE identifier to this
issue (posting this sooner yet one can be allocated to this though some vendors
might still be interested in allocation).

For now Red Hat Security Response Team decided to agree with the above upstream
assessment / pursue the way to upstream conclusion. Though in the future if some
further details would appear, forcing us to change this conclusion, we might
revisit our decision.

Thank you && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


