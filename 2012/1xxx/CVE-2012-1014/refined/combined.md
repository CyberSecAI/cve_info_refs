=== Content from bugzilla.novell.com_481ce8e7_20250126_031019.html ===




=== Content from web.mit.edu_409af098_20250124_194320.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2012-001
MIT krb5 Security Advisory 2012-001
Original release: 2012-07-31
Topic: KDC heap corruption and crash vulnerabilities
CVE-2012-1015: KDC frees uninitialized pointer
CVSSv2 Vector: AV:N/AC:M/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9.3
Access Vector: Network
Access Complexity: Medium
Authentication: None
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 7.3
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
CVE-2012-1014: KDC dereferences uninitialized pointer
CVSSv2 Vector: AV:N/AC:L/Au:N/C:P/I:P/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9
CVSSv2 Temporal Score: 7
SUMMARY
=======
CVE-2012-1015: The MIT krb5 KDC (Key Distribution Center) daemon can
free an uninitialized pointer while processing an unusual AS-REQ,
corrupting the process heap and possibly causing the daemon to
abnormally terminate. An attacker could use this vulnerability to
execute malicious code, but exploiting frees of uninitialized pointers
to execute code is believed to be difficult. It is possible that a
legitimate client that is misconfigured in an unusual way could
trigger this vulnerability.
CVE-2012-1014: The MIT krb5 KDC daemon can dereference an
uninitialized pointer while processing a malformed AS-REQ, causing the
daemon to abnormally terminate. This vulnerability could
theoretically lead to the execution of malicious code, but that is
believed to be very difficult.
No known exploit exists that is capable of executing malicious code
for either vulnerability, but it is also not difficult to trigger a
denial of service with either vulnerability.
IMPACT
======
CVE-2012-1015: By sending a specially crafted AS-REQ, an
unauthenticated remote attacker can cause the KDC to abnormally
terminate or to execute malicious code.
CVE-2012-1014: By sending a malformed AS-REQ, an unauthenticated
remote attacker can cause the KDC to abnormally terminate. It is
theoretically possible, but unlikely, for this vulnerability to lead
to the execution of malicious code.
AFFECTED SOFTWARE
=================
\* The KDC in releases krb5-1.8 and later is vulnerable to
CVE-2012-1015.
\* The KDC in releases krb5-1.10 and later is vulnerable to
CVE-2012-1014.
\* Some platforms detect attempts to free invalid pointers and
protectively terminate the process, preventing arbitrary code
execution on those platforms.
FIXES
=====
\* The upcoming krb5-1.10.3 release will contain a fix for
CVE-2012-1014 and CVE-2012-1015.
\* The upcoming krb5-1.9.5 release will contain a fix for
CVE-2012-1015.
\* Apply the following patch:
diff --git a/src/kdc/do\_as\_req.c b/src/kdc/do\_as\_req.c
index 23623fe..8ada9d0 100644
- --- a/src/kdc/do\_as\_req.c
+++ b/src/kdc/do\_as\_req.c
@@ -463,7 +463,7 @@ process\_as\_req(krb5\_kdc\_req \*request, krb5\_data \*req\_pkt,
krb5\_enctype useenctype;
struct as\_req\_state \*state;
- - state = malloc(sizeof(\*state));
+ state = calloc(sizeof(\*state), 1);
if (!state) {
(\*respond)(arg, ENOMEM, NULL);
return;
@@ -486,6 +486,7 @@ process\_as\_req(krb5\_kdc\_req \*request, krb5\_data \*req\_pkt,
state->authtime = 0;
state->c\_flags = 0;
state->req\_pkt = req\_pkt;
+ state->inner\_body = NULL;
state->rstate = NULL;
state->sname = 0;
state->cname = 0;
diff --git a/src/kdc/kdc\_preauth.c b/src/kdc/kdc\_preauth.c
index 9d8cb34..d4ece3f 100644
- --- a/src/kdc/kdc\_preauth.c
+++ b/src/kdc/kdc\_preauth.c
@@ -1438,7 +1438,8 @@ etype\_info\_helper(krb5\_context context, krb5\_kdc\_req \*request,
continue;
}
- - if (request\_contains\_enctype(context, request, db\_etype)) {
+ if (krb5\_is\_permitted\_enctype(context, db\_etype) &&
+ request\_contains\_enctype(context, request, db\_etype)) {
retval = \_make\_etype\_info\_entry(context, client->princ,
client\_key, db\_etype,
&entry[i], etype\_info2);
diff --git a/src/kdc/kdc\_util.c b/src/kdc/kdc\_util.c
index a43b291..94dad3a 100644
- --- a/src/kdc/kdc\_util.c
+++ b/src/kdc/kdc\_util.c
@@ -2461,6 +2461,7 @@ kdc\_handle\_protected\_negotiation(krb5\_data \*req\_pkt, krb5\_kdc\_req \*request,
return 0;
pa.magic = KV5M\_PA\_DATA;
pa.pa\_type = KRB5\_ENCPADATA\_REQ\_ENC\_PA\_REP;
+ memset(&checksum, 0, sizeof(checksum));
retval = krb5\_c\_make\_checksum(kdc\_context,0, reply\_key,
KRB5\_KEYUSAGE\_AS\_REQ, req\_pkt, &checksum);
if (retval != 0)
diff --git a/src/lib/kdb/kdb\_default.c b/src/lib/kdb/kdb\_default.c
index c4bf92e..367c894 100644
- --- a/src/lib/kdb/kdb\_default.c
+++ b/src/lib/kdb/kdb\_default.c
@@ -61,6 +61,9 @@ krb5\_dbe\_def\_search\_enctype(kcontext, dbentp, start, ktype, stype, kvno, kdatap)
krb5\_boolean saw\_non\_permitted = FALSE;
ret = 0;
+ if (ktype != -1 && !krb5\_is\_permitted\_enctype(kcontext, ktype))
+ return KRB5\_KDB\_NO\_PERMITTED\_KEY;
+
if (kvno == -1 && stype == -1 && ktype == -1)
kvno = 0;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2012-001-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2012-001-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2012-001.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2012-1014
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1014
CVE: CVE-2012-1015
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1015
ACKNOWLEDGMENTS
===============
We thank Emmanuel Bouillon (NCI Agency) for discovering and reporting
these vulnerabilities.
CONTACT
=======
The MIT Kerberos Team security contact address is
. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/07566CE5 2012-01-27 [expires: 2013-02-01]
uid MIT Kerberos Team Security Contact
DETAILS
=======
CVE-2012-1015: KDC frees uninitialized pointer
The KDC function kdc\_handle\_protected\_negotiation(), which handles the
protected negotiation feature of the FAST Kerberos protocol extension,
can attempt to create a checksum using a key type that is invalid for
producing checksums. This causes its call to krb5\_c\_make\_checksum()
to fail, which leads to the cleanup code in
kdc\_handle\_protected\_negotiation() freeing an uninitialized pointer.
It is possible, but unlikely, for a legitimate client to be
misconfigured in a way that causes the KDC to attempt to use such an
invalid key type in this code.
CVE-2012-1014: KDC dereferences uninitialized pointer
CVSSv2 Vector: AV:N/AC:L/Au:N/C:P/I:P/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: Partial
Integrity Impact: Partial
Availability Impact: Complete
CVSSv2 Temporal Score: 7
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
The KDC function process\_as\_req(), which handles incoming AS-REQ
messages, allocates a state object using malloc() and initializes many
fields within it. It fails to initialize state->inner\_body, which is
a pointer to a krb5\_data object. If the uninitialized value
state->inner\_body is not null, a failure in process\_as\_req() that
precedes the call to kdc\_find\_fast() could cause error handling code
in finish\_process\_as\_req() to pass the uninitialized state->inner\_body
pointer to krb5\_free\_data(), which would proceed to dereference the
uninitialized pointer. The typical outcome is KDC process termination
due to a segmentation fault or similar memory fault.
It is theoretically possible for an attacker to manipulate the
contents of the heap so that the uninitialized pointer
state->inner\_body would point to valid memory where
state->inner\_body->data contains an attacker-chosen invalid pointer
value. The krb5\_free\_data() function would then pass this invalid
pointer to free(). This could allow the attacker to overwrite memory
or execute malicious code on some platforms, depending on the details
of the malloc() implementation. This indirect attack method seems
much less likely to succeed than one where the attacker could directly
control the invalid pointer value that the program passes to free().
REVISION HISTORY
================
2012-07-31 original release
Copyright (C) 2012 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAlAYHFcACgkQSO8fWy4vZo6GswCgi1sNmgLekPTxnHgOaiEmKeVF
1TMAn2EoBKvxZBWhNTISWjM1jcV7sHrU
=8oTe
-----END PGP SIGNATURE-----


=== Content from www.debian.org_1a2004ed_20250124_194321.html ===


---

[[Date Prev](msg00157.html)][[Date Next](msg00159.html)]
[[Thread Prev](msg00157.html)][[Thread Next](msg00159.html)]
[[Date Index](maillist.html#00158)]
[[Thread Index](threads.html#00158)]

# [SECURITY] [DSA 2518-1] krb5 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2518-1] krb5 security update
* *From*: Yves-Alexis Perez <corsac@debian.org>
* *Date*: Tue, 31 Jul 2012 21:56:05 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20120731195612.4D07118AB%40scapa.corsac.net)Â [20120731195612.4D07118AB@scapa.corsac.net](msg00158.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2518-1                   security@debian.org
<http://www.debian.org/security/>                         Yves-Alexis Perez
July 31, 2012                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : krb5
Vulnerability  : denial of service and remote code execution
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-1014 CVE-2012-1015
Debian Bug     : 683429

Emmanuel Bouillon from NCI Agency discovered multiple vulnerabilities in MIT
Kerberos, a daemon implementing the network authentication protocol.

CVE-2012-1014

	By sending specially crafted AS-REQ (Authentication Service Request) to a KDC
	(Key Distribution Center), an attacker could make it free an uninitialized
	pointer, corrupting the heap.  This can lead to process crash or even arbitrary
	code execution.
	.
	This CVE only affects testing (wheezy) and unstable (sid) distributions.

CVE-2012-1015

	By sending specially crafted AS-REQ to a KDC, an attacker could make it
	dereference an uninitialized pointer, leading to process crash or even
	arbitrary code execution

In both cases, arbitrary code execution is believed to be difficult to achieve,
but might not be impossible.

For the stable distribution (squeeze), this problem has been fixed in
version 1.8.3+dfsg-4squeeze6.

For the testing distribution (wheezy), this problem has been fixed in
version 1.10.1+dfsg-2.

For the unstable distribution (sid), this problem has been fixed in
version 1.10.1+dfsg-2.

We recommend that you upgrade your krb5 packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBCgAGBQJQGDhVAAoJEDBVD3hx7wuohhAQAMvfn2GpJ183+cRUkU2BU0nb
pNwX+RyE9PzxmROfnWQK+B5e4d/p85WVI+JIsqxRTdSU9exQW7Ix0KecFUOIDpih
UapoKsfyAsq1MuHP+zzhzITrjn/N0nLAWVLmhEiGYAXsSqhF9ANtHqEAVl4LMBFs
yM8mIOT1t2oBbWrdqDEObqzCHuXcF6zxOiO9V55yBima8qgKJaMfdwhexVCNgy2H
s07Z/Bip1X0MOQVt39OQ8gjpxLVKjCkLIzXKnGahFcthMxbT7JUFlgkqOUEhb8hz
C4aMWQ7VmaVyHRMoNQ36nbEeFOa1lbtFAUG1NtIAK4xc3yuUgzUAuiABtrlzOEE+
isTWYIFX6pAxxjmjDLXs+WzbsdbUg2WNpAT7yMlYpr8X1Fbspc4Q4cotXvOkxMDy
ZiztFrxLIwRzPKqz3mAR2aMMv+C15jAAkfI8TWY44uT7Nao8r7SkghhhW9XTHq/u
kjamNAqkdbeUN6Uv6LjKqtWcFHNDp/ybopx4eEAs9g49iYHjhIxeYSuZi9ezt69m
3aHE1+wRyQkYRXGTgQCSsEsQTmKG/GYsxbXz7AHTHeBKysXhozgXaVUP7mC4PhP6
IQl3TNPS7+ICDR/WmNecmDXnJSjiLr2Cxu05s6kdZufk2YuUmLKsDOwqdUK9zs5L
akNPAoiNvi30U+3tc07c
=lkou
-----END PGP SIGNATURE-----

```

---



=== Content from lists.opensuse.org_09208a23_20250124_194320.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X/#ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X)

# openSUSE-SU-2012:0967-1: moderate: krb5: fixed several potential code execution flaws

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-securityï¼ opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-securityï¼ opensuse.org")

8 Aug
2012

8 Aug
'12

12:08

openSUSE Security Update: krb5: fixed several potential code execution flaws
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2012:0967-1
Rating: moderate
References: #770172
Cross-References: CVE-2012-1014 CVE-2012-1015
Affected Products:
openSUSE 12.1
openSUSE 11.4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
Several potential codeexecution flaws were fixed in krb5.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.1:
zypper in -t patch openSUSE-2012-497
- openSUSE 11.4:
zypper in -t patch openSUSE-2012-497
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.1 (i586 x86\_64):
krb5-1.9.1-24.9.1
krb5-client-1.9.1-24.9.1
krb5-client-debuginfo-1.9.1-24.9.1
krb5-debuginfo-1.9.1-24.9.1
krb5-debugsource-1.9.1-24.9.1
krb5-devel-1.9.1-24.9.1
krb5-plugin-kdb-ldap-1.9.1-24.9.1
krb5-plugin-kdb-ldap-debuginfo-1.9.1-24.9.1
krb5-plugin-preauth-pkinit-1.9.1-24.9.1
krb5-plugin-preauth-pkinit-debuginfo-1.9.1-24.9.1
krb5-server-1.9.1-24.9.1
krb5-server-debuginfo-1.9.1-24.9.1
- openSUSE 12.1 (x86\_64):
krb5-32bit-1.9.1-24.9.1
krb5-debuginfo-32bit-1.9.1-24.9.1
krb5-devel-32bit-1.9.1-24.9.1
- openSUSE 12.1 (ia64):
krb5-debuginfo-x86-1.9.1-24.9.1
krb5-x86-1.9.1-24.9.1
- openSUSE 11.4 (i586 x86\_64):
krb5-1.8.3-52.1
krb5-client-1.8.3-52.1
krb5-client-debuginfo-1.8.3-52.1
krb5-debuginfo-1.8.3-52.1
krb5-debugsource-1.8.3-52.1
krb5-devel-1.8.3-52.1
krb5-plugin-kdb-ldap-1.8.3-52.1
krb5-plugin-kdb-ldap-debuginfo-1.8.3-52.1
krb5-plugin-preauth-pkinit-1.8.3-52.1
krb5-plugin-preauth-pkinit-debuginfo-1.8.3-52.1
krb5-server-1.8.3-52.1
krb5-server-debuginfo-1.8.3-52.1
- openSUSE 11.4 (x86\_64):
krb5-32bit-1.8.3-52.1
krb5-debuginfo-32bit-1.8.3-52.1
krb5-devel-32bit-1.8.3-52.1
- openSUSE 11.4 (ia64):
krb5-debuginfo-x86-1.8.3-52.1
krb5-x86-1.8.3-52.1
References:
<http://support.novell.com/security/cve/CVE-2012-1014.html>
<http://support.novell.com/security/cve/CVE-2012-1015.html>
<https://bugzilla.novell.com/770172>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X/#ZD6T6IS7COD7YIQGBN5JHTPB3JLF7J5X)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.


