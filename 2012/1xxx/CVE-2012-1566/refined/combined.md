=== Content from www.openwall.com_24d4565f_20250125_010927.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](13) [[next>]](../../../2012/03/20/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4F678A44.5090808@redhat.com>
Date: Mon, 19 Mar 2012 13:34:28 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>,
        root@...uxmint.com
Subject: LinuxMint - temp file creation vulns in mintNanny and mintUpdate

>mscherer@...hat.com reported these to me:
>
>Two issues in LinuxMint:
>
>First a temporary file creation flaw in mintNanny:
>
><https://github.com/linuxmint/mintnanny/blob/master/usr/lib/linuxmint/mintNanny/mintNanny.py#L70>

Please use CVE-2012-1566 for this issue

>Secondly a temporary file creation flaw in mintUpdate:
>
><https://github.com/linuxmint/mintupdate/blob/master/usr/lib/linuxmint/mintUpdate/mintUpdate.py#L1444>

Please use CVE-2012-1567 for this issue.

Also a note on fixing these issues:

Python

Simply use “mkstemp” from the “tempfile” module:

<http://docs.python.org/library/tempfile.html#tempfile.mkstemp>

I tried to find a LinuxMint security contact, nothing on the website
(e.g. <http://www.linuxmint.com/teams.php>), someone suggested
root@...uxmint.com, here's hoping they see it.

--
Kurt Seifried Red Hat Security Response Team (SRT)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_9e9c8e61_20250126_045854.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fmintupdate%2Fblob%2Fmaster%2Fusr%2Flib%2Flinuxmint%2FmintUpdate%2FmintUpdate.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fmintupdate%2Fblob%2Fmaster%2Fusr%2Flib%2Flinuxmint%2FmintUpdate%2FmintUpdate.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=linuxmint%2Fmintupdate)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linuxmint](/linuxmint)
/
**[mintupdate](/linuxmint/mintupdate)**
Public

* [Notifications](/login?return_to=%2Flinuxmint%2Fmintupdate) You must be signed in to change notification settings
* [Fork
  161](/login?return_to=%2Flinuxmint%2Fmintupdate)
* [Star
   339](/login?return_to=%2Flinuxmint%2Fmintupdate)

* [Code](/linuxmint/mintupdate)
* [Issues
  188](/linuxmint/mintupdate/issues)
* [Pull requests
  5](/linuxmint/mintupdate/pulls)
* [Actions](/linuxmint/mintupdate/actions)
* [Security](/linuxmint/mintupdate/security)
* [Insights](/linuxmint/mintupdate/pulse)

Additional navigation options

* [Code](/linuxmint/mintupdate)
* [Issues](/linuxmint/mintupdate/issues)
* [Pull requests](/linuxmint/mintupdate/pulls)
* [Actions](/linuxmint/mintupdate/actions)
* [Security](/linuxmint/mintupdate/security)
* [Insights](/linuxmint/mintupdate/pulse)

## Files

 master
## Breadcrumbs

1. [mintupdate](/linuxmint/mintupdate/tree/master)
2. /[usr](/linuxmint/mintupdate/tree/master/usr)
3. /[lib](/linuxmint/mintupdate/tree/master/usr/lib)
4. /[linuxmint](/linuxmint/mintupdate/tree/master/usr/lib/linuxmint)
5. /[mintUpdate](/linuxmint/mintupdate/tree/master/usr/lib/linuxmint/mintUpdate)
/
# mintUpdate.py

Copy path Blame  Blame
## Latest commit

## History

[History](/linuxmint/mintupdate/commits/master/usr/lib/linuxmint/mintUpdate/mintUpdate.py)executable file·2586 lines (2229 loc) · 116 KB master
## Breadcrumbs

1. [mintupdate](/linuxmint/mintupdate/tree/master)
2. /[usr](/linuxmint/mintupdate/tree/master/usr)
3. /[lib](/linuxmint/mintupdate/tree/master/usr/lib)
4. /[linuxmint](/linuxmint/mintupdate/tree/master/usr/lib/linuxmint)
5. /[mintUpdate](/linuxmint/mintupdate/tree/master/usr/lib/linuxmint/mintUpdate)
/
# mintUpdate.py

Top
## File metadata and controls

* Code
* Blame

executable file·2586 lines (2229 loc) · 116 KB[Raw](https://github.com/linuxmint/mintupdate/raw/refs/heads/master/usr/lib/linuxmint/mintUpdate/mintUpdate.py)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000#!/usr/bin/python3# -\*- coding: utf-8 -\*-
# system importsimport osimport sysimport giimport tempfileimport timeimport gettextimport ioimport jsonimport localeimport tarfileimport urllib.requestimport proxygsettingsimport subprocessimport pycurlimport datetimeimport configparserimport tracebackimport setproctitleimport platformimport reimport aptkit.simpleclientimport checkAPTfrom multiprocess import Process, Queue
gi.require\_version('Gtk', '3.0')gi.require\_version('Notify', '0.7')from gi.repository import Gtk, Gdk, Gio, GLib, GObject, Notify, Pangofrom xapp.GSettingsWidgets import \*
# local importsimport loggerfrom kernelwindow import KernelWindowfrom Classes import Update, PRIORITY\_UPDATES, CONFIG\_PATH, UpdateTracker, \_idle, \_async
settings = Gio.Settings(schema\_id="com.linuxmint.updates")cinnamon\_support = Falsetry: if settings.get\_boolean("show-cinnamon-updates"): import cinnamon cinnamon\_support = Trueexcept Exception as e: if os.getenv("DEBUG"): print("No cinnamon update support:\n%s" % traceback.format\_exc())
flatpak\_support = Falsetry: if settings.get\_boolean("show-flatpak-updates"): import flatpakUpdater flatpak\_support = Trueexcept Exception as e: if os.getenv("DEBUG"): print("No flatpak update support:\n%s" % traceback.format\_exc())
CINNAMON\_SUPPORT = cinnamon\_supportFLATPAK\_SUPPORT = flatpak\_support
# import AUTOMATIONS dictwith open("/usr/share/linuxmint/mintupdate/automation/index.json") as f: AUTOMATIONS = json.load(f)
try: os.system("killall -q mintUpdate")except Exception as e: print (e) print(sys.exc\_info()[0])
setproctitle.setproctitle("mintUpdate")
# i18nAPP = 'mintupdate'LOCALE\_DIR = "/usr/share/locale"locale.bindtextdomain(APP, LOCALE\_DIR)gettext.bindtextdomain(APP, LOCALE\_DIR)gettext.textdomain(APP)\_ = gettext.gettext
Notify.init(\_("Update Manager"))
(TAB\_DESC, TAB\_PACKAGES, TAB\_CHANGELOG) = range(3)
(UPDATE\_CHECKED, UPDATE\_DISPLAY\_NAME, UPDATE\_OLD\_VERSION, UPDATE\_NEW\_VERSION, UPDATE\_SOURCE, UPDATE\_SIZE, UPDATE\_SIZE\_STR, UPDATE\_TYPE\_PIX, UPDATE\_TYPE, UPDATE\_TOOLTIP, UPDATE\_SORT\_STR, UPDATE\_OBJ) = range(12)
BLACKLIST\_PKG\_NAME = 0
GIGABYTE = 1000 \*\* 3MEGABYTE = 1000 \*\* 2KILOBYTE = 1000
def size\_to\_string(size): if (size >= GIGABYTE): return "%d %s" % (size // GIGABYTE, \_("GB")) if (size >= (MEGABYTE)): return "%d %s" % (size // MEGABYTE, \_("MB")) if (size >= KILOBYTE): return "%d %s" % (size // KILOBYTE, \_("KB")) return "%d %s" % (size, \_("B"))
def name\_search\_func(model, column, key, iter): name = model.get\_value(iter, column) return key.lower() not in name.lower() # False is a match
class APTCacheMonitor(): """ Monitors package cache and dpkg status and runs the refresh thread() on change """
 def \_\_init\_\_(self, application): self.application = application self.cachetime = 0 self.statustime = 0 self.paused = False self.pkgcache = "/var/cache/apt/pkgcache.bin" self.dpkgstatus = "/var/lib/dpkg/status"
 @\_async def start(self): self.application.refresh(False) self.update\_cachetime() if os.path.isfile(self.pkgcache) and os.path.isfile(self.dpkgstatus): while True: if not self.paused and self.application.hidden: try: cachetime = os.path.getmtime(self.pkgcache) statustime = os.path.getmtime(self.dpkgstatus) if (cachetime != self.cachetime or statustime != self.statustime) and \ not self.application.dpkg\_locked(): self.cachetime = cachetime self.statustime = statustime self.application.logger.write("Changes to the package cache detected; triggering refresh") self.application.refresh(False) except: pass time.sleep(90) else: self.application.logger.write("Package cache location not found, disabling cache monitoring")
 def resume(self, update\_cachetime=True): if self.paused: if update\_cachetime: self.update\_cachetime() self.paused = False
 def pause(self): self.paused = True
 def update\_cachetime(self): if os.path.isfile(self.pkgcache) and os.path.isfile(self.dpkgstatus): self.cachetime = os.path.getmtime(self.pkgcache) self.statustime = os.path.getmtime(self.dpkgstatus)
class XAppStatusIcon():
 def \_\_init\_\_(self, menu): self.icon = XApp.StatusIcon() self.icon.set\_secondary\_menu(menu)
 def set\_from\_icon\_name(self, name): self.icon.set\_icon\_name(name)
 def set\_tooltip\_text(self, text): self.icon.set\_tooltip\_text(text)
 def set\_visible(self, visible): self.icon.set\_visible(visible)
class MintUpdate():
 def \_\_init\_\_(self): self.information\_window\_showing = False self.history\_window\_showing = False self.preferences\_window\_showing = False self.updates\_inhibited = False self.reboot\_required = False self.refreshing = False self.refreshing\_apt = False self.refreshing\_flatpak = False self.refreshing\_cinnamon = False self.auto\_refresh\_is\_alive = False self.hidden = False # whether the window is hidden or not self.packages = [] # packages selected for update self.flatpaks = [] # flatpaks selected for update self.spices = [] # spices selected for update self.inhibit\_cookie = 0 self.logger = logger.Logger() self.cache\_monitor = None self.logger.write("Launching Update Manager") self.test\_mode = os.getenv("MINTUPDATE\_TEST") self.settings = Gio.Settings(schema\_id="com.linuxmint.updates")
 self.is\_lmde = False self.app\_restart\_required = False self.show\_cinnamon\_enabled = False self.settings.connect("changed", self.\_on\_settings\_changed) self.\_on\_settings\_changed(self.settings, None)
 #Set the Glade file gladefile = "/usr/share/linuxmint/mintupdate/main.ui" self.builder = Gtk.Builder() self.builder.set\_translation\_domain("mintupdate") self.builder.add\_from\_file(gladefile)
 #self.builder.connect\_signals(self) for widget in self.builder.get\_objects(): if issubclass(type(widget), Gtk.Buildable): name = "ui\_%s" % Gtk.Buildable.get\_name(widget) if not "\_\_" in name: setattr(self, name, widget)
 self.context\_id = self.ui\_statusbar.get\_context\_id("mintUpdate") self.ui\_window.connect("key-press-event",self.on\_key\_press\_event) self.treeview = self.builder.get\_object("treeview\_update")
 try: self.ui\_window.set\_title(\_("Update Manager"))
 self.ui\_window.set\_icon\_name("mintupdate")
 # Add mintupdate style class for easier theming self.ui\_window.get\_style\_context().add\_class('mintupdate')
 accel\_group = Gtk.AccelGroup() self.ui\_window.add\_accel\_group(accel\_group)
 self.textview\_packages = self.ui\_textview\_packages.get\_buffer() self.textview\_description = self.ui\_textview\_description.get\_buffer() self.textview\_changes = self.ui\_textview\_changes.get\_buffer()
 # Welcome page self.ui\_button\_welcome\_finish.connect("clicked", self.on\_welcome\_page\_finished) self.ui\_button\_welcome\_help.connect("clicked", self.open\_help)
 # the treeview cr = Gtk.CellRendererToggle() cr.connect("toggled", self.toggled) cr.set\_property("activatable", True)
 column\_upgrade = Gtk.TreeViewColumn(\_("Upgrade"), cr) column\_upgrade.add\_attribute(cr, "active", UPDATE\_CHECKED) column\_upgrade.set\_sort\_column\_id(UPDATE\_CHECKED) column\_upgrade.set\_resizable(True)
 column\_name = Gtk.TreeViewColumn(\_("Name"), Gtk.CellRendererText(), markup=UPDATE\_DISPLAY\_NAME) column\_name.set\_sort\_column\_id(UPDATE\_DISPLAY\_NAME) column\_name.set\_resizable(True)
 column\_old\_version = Gtk.TreeViewColumn(\_("Old Version"), Gtk.CellRendererText(), text=UPDATE\_OLD\_VERSION) column\_old\_version.set\_sort\_column\_id(UPDATE\_OLD\_VERSION) column\_old\_version.set\_resizable(True)
 column\_new\_version = Gtk.TreeViewColumn(\_("New Version"), Gtk.CellRendererText(), text=UPDATE\_NEW\_VERSION) column\_new\_version.set\_sort\_column\_id(UPDATE\_NEW\_VERSION) column\_new\_version.set\_resizable(True)
 column\_size = Gtk.TreeViewColumn(\_("Size"), Gtk.CellRendererText(), text=UPDATE\_SIZE\_STR) column\_size.set\_sort\_column\_id(UPDATE\_SIZE) column\_size.set\_resizable(True)
 column\_type = Gtk.TreeViewColumn(\_("Type"), Gtk.CellRendererPixbuf(), icon\_name=UPDATE\_TYPE\_PIX) column\_type.set\_sort\_column\_id(UPDATE\_TYPE) column\_type.set\_resizable(True)
 column\_origin = Gtk.TreeViewColumn(\_("Origin"), Gtk.CellRendererText(), text=UPDATE\_SOURCE) column\_origin.set\_sort\_column\_id(UPDATE\_SOURCE) column\_origin.set\_resizable(True)
 self.treeview.set\_tooltip\_column(UPDATE\_TOOLTIP)
 self.treeview.set\_search\_equal\_func(name\_search\_func) self.treeview.append\_column(column\_type) self.treeview.append\_column(column\_upgrade) self.treeview.append\_column(column\_name) self.treeview.append\_column(column\_old\_version) self.treeview.append\_column(column\_new\_version) self.treeview.append\_column(column\_origin) self.treeview.append\_column(column\_size)
 self.treeview.set\_headers\_clickable(True) self.treeview.set\_reorderable(False) self.treeview.show()
 self.treeview.connect("button-release-event", self.treeview\_right\_clicked) self.treeview.connect("row-activated", self.treeview\_row\_activated)
 selection = self.treeview.get\_selection() selection.connect("changed", self.display\_selected\_update) self.ui\_notebook\_details.connect("switch-page", self.switch\_page) self.ui\_window.connect("delete\_event", self.close\_window)
 # Install Updates button self.ui\_install\_button.connect("clicked", self.install) key, mod = Gtk.accelerator\_parse("<Control>I") self.ui\_install\_button.add\_accelerator("clicked", accel\_group, key, mod, Gtk.AccelFlags.VISIBLE)
 # Clear button self.ui\_clear\_button.connect("clicked", self.clear) key, mod = Gtk.accelerator\_parse("<Control><Shift>A") self.ui\_clear\_button.add\_accelerator("clicked", accel\_group, key, mod, Gtk.AccelFlags.VISIBLE)
 # Select All button self.ui\_select\_all\_button.connect("clicked", self.select\_all) key, mod = Gtk.accelerator\_parse("<Control>A") self.ui\_select\_all\_button.add\_accelerator("clicked", accel\_group, key, mod, Gtk.AccelFlags.VISIBLE)
 # Refresh button self.ui\_refresh\_button.connect("clicked", self.manual\_refresh) key, mod = Gtk.accelerator\_parse("<Control>R") self.ui\_refresh\_button.add\_accelerator("clicked", accel\_group, key, mod, Gtk.AccelFlags.VISIBLE)
 # Self-update page: self.ui\_self\_update\_button.connect("clicked", self.self\_update)
 # Tray icon menu menu = Gtk.Menu() image = Gtk.Image.new\_from\_icon\_name("view-refresh-symbolic", Gtk.IconSize.MENU) menuItem3 = Gtk.ImageMenuItem(label=\_("Refresh"), image=image) menuItem3.connect('activate', self.manual\_refresh) menu.append(menuItem3) image = Gtk.Image.new\_from\_icon\_name("dialog-information-symbolic", Gtk.IconSize.MENU) menuItem2 = Gtk.ImageMenuItem(label=\_("Information"), image=image) menuItem2.connect('activate', self.open\_information) menu.append(menuItem2) image = Gtk.Image.new\_from\_icon\_name("preferences-other-symbolic", Gtk.IconSize.MENU) menuItem4 = Gtk.ImageMenuItem(label=\_("Preferences"), image=image) menuItem4.connect('activate', self.open\_preferences) menu.append(menuItem4) image = Gtk.Image.new\_from\_icon\_name("application-exit-symbolic", Gtk.IconSize.MENU) menuItem = Gtk.ImageMenuItem(label=\_("Quit"), image=image) menuItem.connect('activate', self.quit) menu.append(menuItem) menu.show\_all()
 self.statusIcon = XAppStatusIcon(menu) self.statusIcon.icon.connect('activate', self.on\_statusicon\_activated)
 # Main window menu fileMenu = Gtk.MenuItem.new\_with\_mnemonic(\_("\_File")) fileSubmenu = Gtk.Menu() fileMenu.set\_submenu(fileSubmenu) image = Gtk.Image.new\_from\_icon\_name("window-close-symbolic", Gtk.IconSize.MENU) closeMenuItem = Gtk.ImageMenuItem(label=\_("Close window"), image=image) closeMenuItem.connect("activate", self.hide\_window) key, mod = Gtk.accelerator\_parse("<Control>W") closeMenuItem.add\_accelerator("activate", accel\_group, key, mod, Gtk.AccelFlags.VISIBLE) fileSubmenu.append(closeMenuItem) fileSubmenu.append(Gtk.SeparatorMenuItem()) image = Gtk.Image.new\_from\_icon\_name("application-exit-symbolic", Gtk.IconSize.MENU) quitMenuItem = Gtk.ImageMenuItem(label=\_("Quit"), image=image) quitMenuItem.connect('activate', self.quit) key, mod = Gtk.accelerator\_parse("<Control>Q") quitMenuItem.add\_accelerator("activate", accel\_group, key, mod, Gtk.AccelFlags.VISIBLE) fileSubmenu.append(quitMenuItem)
 editMenu = Gtk.MenuItem.new\_with\_mnemonic(\_("\_Edit")) editSubmenu = Gtk.Menu() editMenu.set\_submenu(editSubmenu) image = Gtk.Image.new\_from\_icon\_name("preferences-other-symbolic", Gtk.IconSize.MENU) prefsMenuItem = Gtk.ImageMenuItem(label=\_("Preferences"), image=image) prefsMenuItem.connect("activate", self.open\_preferences) editSubmenu.append(prefsMenuItem) if os.path.exists("/usr/bin/timeshift-gtk"): image = Gtk.Image.new\_from\_icon\_name("document-open-recent-symbolic", Gtk.IconSize.MENU) sourcesMenuItem = Gtk.ImageMenuItem(label=\_("System Snapshots"), image=image) sourcesMenuItem.connect("activate", self.open\_timeshift) editSubmenu.append(sourcesMenuItem) if os.path.exists("/usr/bin/mintsources"): image = Gtk.Image.new\_from\_icon\_name("system-software-install-symbolic", Gtk.IconSize.MENU) sourcesMenuItem = Gtk.ImageMenuItem(label=\_("Software Sources"), image=image) sourcesMenuItem.connect("activate", self.open\_repositories) editSubmenu.append(sourcesMenuItem)
 rel\_edition = 'unknown' rel\_codename = 'unknown' if os.path.exists("/etc/linuxmint/info"): with open("/etc/linuxmint/info", encoding="utf-8") as info: for line in info: line = line.strip() if "EDITION=" in line: rel\_edition = line.split('=')[1].replace('"', '').split()[0] if "CODENAME=" in line: rel\_codename = line.split('=')[1].replace('"', '').split()[0]
 rel\_path = "/usr/share/mint-upgrade-info/%s/info" % rel\_codename if os.path.exists(rel\_path): config = configparser.ConfigParser() config.read(rel\_path) if rel\_edition.lower() in config['general']['editions']: rel\_target = config['general']['target\_name'] image = Gtk.Image.new\_from\_icon\_name("mintupdate-type-package-symbolic", Gtk.IconSize.MENU) relUpgradeMenuItem = Gtk.ImageMenuItem(label=\_("Upgrade to %s") % rel\_target, image=image) relUpgradeMenuItem.connect("activate", self.open\_rel\_upgrade) editSubmenu.append(relUpgradeMenuItem)
 viewMenu = Gtk.MenuItem.new\_with\_mnemonic(\_("\_View")) viewSubmenu = Gtk.Menu() viewMenu.set\_submenu(viewSubmenu) image = Gtk.Image.new\_from\_icon\_name("document-open-recent-symbolic", Gtk.IconSize.MENU) historyMenuItem = Gtk.ImageMenuItem(label=\_("History of Updates"), image=image ) historyMenuItem.connect("activate", self.open\_history) image = Gtk.Image.new\_from\_icon\_name("system-run-symbolic", Gtk.IconSize.MENU) kernelMenuItem = Gtk.ImageMenuItem(label=\_("Linux Kernels"), image=image) kernelMenuItem.connect("activate", self.on\_kernel\_menu\_activated) image = Gtk.Image.new\_from\_icon\_name("dialog-information-symbolic", Gtk.IconSize.MENU) infoMenuItem = Gtk.ImageMenuItem(label=\_("Information"), image=image) infoMenuItem.connect("activate", self.open\_information) image = Gtk.Image.new\_from\_icon\_name("dialog-information-symbolic", Gtk.IconSize.MENU) visibleColumnsMenuItem = Gtk.ImageMenuItem(label=\_("Visible Columns"), image=image) visibleColumnsMenu = Gtk.Menu() visibleColumnsMenuItem.set\_submenu(visibleColumnsMenu)
 typeColumnMenuItem = Gtk.CheckMenuItem(label=\_("Type")) typeColumnMenuItem.set\_active(self.settings.get\_boolean("show-type-column")) column\_type.set\_visible(self.settings.get\_boolean("show-type-column")) typeColumnMenuItem.connect("toggled", self.setVisibleColumn, column\_type, "show-type-column") visibleColumnsMenu.append(typeColumnMenuItem)
 packageColumnMenuItem = Gtk.CheckMenuItem(label=\_("Package")) packageColumnMenuItem.set\_active(self.settings.get\_boolean("show-package-column")) column\_name.set\_visible(self.settings.get\_boolean("show-package-column")) packageColumnMenuItem.connect("toggled", self.setVisibleColumn, column\_name, "show-package-column") visibleColumnsMenu.append(packageColumnMenuItem)
 oldVersionColumnMenuItem = Gtk.CheckMenuItem(label=\_("Old Version")) oldVersionColumnMenuItem.set\_active(self.settings.get\_boolean("show-old-version-column")) column\_old\_version.set\_visible(self.settings.get\_boolean("show-old-version-column")) oldVersionColumnMenuItem.connect("toggled", self.setVisibleColumn, column\_old\_version, "show-old-version-column") visibleColumnsMenu.append(oldVersionColumnMenuItem)
 newVersionColumnMenuItem = Gtk.CheckMenuItem(label=\_("New Version")) newVersionColumnMenuItem.set\_active(self.settings.get\_boolean("show-new-version-column")) column\_new\_version.set\_visible(self.settings.get\_boolean("show-new-version-column")) newVersionColumnMenuItem.connect("toggled", self.setVisibleColumn, column\_new\_version, "show-new-version-column") visibleColumnsMenu.append(newVersionColumnMenuItem)
 sizeColumnMenuItem = Gtk.CheckMenuItem(label=\_("Origin")) sizeColumnMenuItem.set\_active(self.settings.get\_boolean("show-origin-column")) column\_origin.set\_visible(self.settings.get\_boolean("show-origin-column")) sizeColumnMenuItem.connect("toggled", self.setVisibleColumn, column\_origin, "show-origin-column") visibleColumnsMenu.append(sizeColumnMenuItem)
 sizeColumnMenuItem = Gtk.CheckMenuItem(label=\_("Size")) sizeColumnMenuItem.set\_active(self.settings.get\_boolean("show-size-column")) column\_size.set\_visible(self.settings.get\_boolean("show-size-column")) sizeColumnMenuItem.connect("toggled", self.setVisibleColumn, column\_size, "show-size-column") visibleColumnsMenu.append(sizeColumnMenuItem)
 viewSubmenu.append(visibleColumnsMenuItem)
 descriptionsMenuItem = Gtk.CheckMenuItem(label=\_("Show Descriptions")) descriptionsMenuItem.set\_active(self.settings.get\_boolean("show-descriptions")) descriptionsMenuItem.connect("toggled", self.setVisibleDescriptions) viewSubmenu.append(descriptionsMenuItem)
 viewSubmenu.append(historyMenuItem)
 try: # Only support kernel selection in Linux Mint (not LMDE) if not os.path.exists("/usr/share/doc/debian-system-adjustments/copyright"): viewSubmenu.append(kernelMenuItem) else: self.is\_lmde = True except Exception as e: print (e) print(sys.exc\_info()[0]) viewSubmenu.append(infoMenuItem) helpMenu = Gtk.MenuItem.new\_with\_mnemonic(\_("\_Help")) helpSubmenu = Gtk.Menu() helpMenu.set\_submenu(helpSubmenu)
 image = Gtk.Image.new\_from\_icon\_name("security-high-symbolic", Gtk.IconSize.MENU) helpMenuItem = Gtk.ImageMenuItem(label=\_("Welcome Screen"), image=image) helpMenuItem.connect("activate", self.show\_welcome\_page) helpSubmenu.append(helpMenuItem) if (Gtk.check\_version(3,20,0) is None): image = Gtk.Image.new\_from\_icon\_name("preferences-desktop-keyboard-shortcuts-symbolic", Gtk.IconSize.MENU) shortcutsMenuItem = Gtk.ImageMenuItem(label=\_("Keyboard Shortcuts"), image=image) shortcutsMenuItem.connect("activate", self.open\_shortcuts) helpSubmenu.append(shortcutsMenuItem) image = Gtk.Image.new\_from\_icon\_name("help-contents-symbolic", Gtk.IconSize.MENU) helpMenuItem = Gtk.ImageMenuItem(label=\_("Contents"), image=image) helpMenuItem.connect("activate", self.open\_help) key, mod = Gtk.accelerator\_parse("F1") helpMenuItem.add\_accelerator("activate", accel\_group, key, mod, Gtk.AccelFlags.VISIBLE) helpSubmenu.append(helpMenuItem) image = Gtk.Image.new\_from\_icon\_name("help-about-symbolic", Gtk.IconSize.MENU) aboutMenuItem = Gtk.ImageMenuItem(label=\_("About"), image=image) aboutMenuItem.connect("activate", self.open\_about) helpSubmenu.append(aboutMenuItem)
 self.ui\_menubar.append(fileMenu) self.ui\_menubar.append(editMenu) self.ui\_menubar.append(viewMenu) self.ui\_menubar.append(helpMenu)
 self.ui\_stack.set\_visible\_child\_name("refresh\_page")
 self.ui\_window.resize(self.settings.get\_int('window-width'), self.settings.get\_int('window-height')) self.ui\_paned.set\_position(self.settings.get\_int('window-pane-position'))
 self.ui\_vbox.show\_all()
 if len(sys.argv) > 1: showWindow = sys.argv[1] if showWindow == "show": self.ui\_window.present\_with\_time(Gtk.get\_current\_event\_time())
 if CINNAMON\_SUPPORT: self.cinnamon\_updater = cinnamon.UpdateManager() else: self.cinnamon\_updater = None
 global FLATPAK\_SUPPORT if FLATPAK\_SUPPORT: try: self.flatpak\_updater = flatpakUpdater.FlatpakUpdater() except Exception as e: print("Error creating FlatpakUpdater:", str(e)) self.flatpak\_updater = None FLATPAK\_SUPPORT = False
 if self.settings.get\_boolean("show-welcome-page"): self.show\_welcome\_page() else: self.cache\_monitor = APTCacheMonitor(self) self.cache\_monitor.start()
 self.ui\_notebook\_details.set\_current\_page(0)
 self.refresh\_schedule\_enabled = self.settings.get\_boolean("refresh-schedule-enabled") self.start\_auto\_refresh()
 Gtk.main()
 except Exception as e: print (e) print(sys.exc\_info()[0]) self.logger.write\_error("Exception occurred in main thread: " + str(sys.exc\_info()[0])) self.logger.close()
 def \_on\_settings\_changed(self, settings, key, data=None): if key is None: self.show\_flatpak\_enabled = settings.get\_boolean("show-flatpak-updates") self.show\_cinnamon\_enabled = settings.get\_boolean("show-cinnamon-updates") return
 self.app\_restart\_required = settings.get\_boolean("show-cinnamon-updates") != self.show\_cinnamon\_enabled or \ settings.get\_boolean("show-flatpak-updates") != self.show\_flatpak\_enabled
######### EVENT HANDLERS #########
 def on\_key\_press\_event(self, widget, event): ctrl = (event.state & Gdk.ModifierType.CONTROL\_MASK) if ctrl: if event.keyval == Gdk.KEY\_s: self.select\_updates(security=True) elif event.keyval == Gdk.KEY\_k: self.select\_updates(kernel=True)
######### UTILITY FUNCTIONS #########
 @\_idle def set\_status\_message(self, message): self.ui\_statusbar.push(self.context\_id, message)
 @\_idle def set\_status(self, message, tooltip, icon, visible): self.set\_status\_message(message) self.statusIcon.set\_from\_icon\_name(icon) self.statusIcon.set\_tooltip\_text(tooltip) self.statusIcon.set\_visible(visible)
 @staticmethod def dpkg\_locked(): """ Returns True if a process has a handle on /var/lib/dpkg/lock (no check for write lock) """ try: subprocess.run(["sudo", "/usr/lib/linuxmint/mintUpdate/dpkg\_lock\_check.sh"], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, check=True) return True except subprocess.CalledProcessError: return False
 @staticmethod def show\_dpkg\_lock\_msg(parent): dialog = Gtk.MessageDialog(parent, Gtk.DialogFlags.MODAL | Gtk.DialogFlags.DESTROY\_WITH\_PARENT, Gtk.MessageType.ERROR, Gtk.ButtonsType.OK, \_("Cannot Proceed")) dialog.format\_secondary\_markup(\_("Another process is currently using the package management system. Please wait for it to finish and then try again.")) dialog.set\_title(\_("Update Manager")) dialog.run() dialog.destroy()
 @\_idle def show\_infobar(self, title, msg, msg\_type, icon, callback): infobar = Gtk.InfoBar() infobar.set\_margin\_bottom(2) infobar.set\_message\_type(msg\_type) if not icon: if msg\_type == Gtk.MessageType.WARNING: icon = "dialog-warning-symbolic" elif msg\_type == Gtk.MessageType.ERROR: icon = "dialog-error-symbolic" elif msg\_type == Gtk.MessageType.QUESTION: icon = "dialog-information-symbolic" if icon: img = Gtk.Image.new\_from\_icon\_name(icon, Gtk.IconSize.LARGE\_TOOLBAR) else: img = Gtk.Image.new\_from\_icon\_name("dialog-warning-symbolic", Gtk.IconSize.LARGE\_TOOLBAR) infobar.get\_content\_area().pack\_start(img, False, False, 0)
 info\_label = Gtk.Label() info\_label.set\_line\_wrap(True) info\_label.set\_markup("<b>%s</b>\n%s" % (title, msg)) infobar.get\_content\_area().pack\_start(info\_label, False, False, 0) if callback: if msg\_type == Gtk.MessageType.QUESTION: infobar.add\_button(\_("Yes"), Gtk.ResponseType.YES) infobar.add\_button(\_("No"), Gtk.ResponseType.NO) else: infobar.add\_button(\_("OK"), Gtk.ResponseType.OK) infobar.connect("response", callback) infobar.show\_all() for child in self.ui\_infobar.get\_children(): child.destroy() self.ui\_infobar.pack\_start(infobar, True, True, 0)
 @\_idle def show\_error(self, error\_msg): self.ui\_stack.set\_visible\_child\_name("error\_page") self.ui\_label\_error\_details.set\_text(error\_msg)
 @\_idle def show\_updates\_in\_UI(self, num\_visible, num\_software, num\_security, download\_size, is\_self\_update, model\_items): if num\_visible > 0: self.logger.write("Found %d software updates" % num\_visible) if is\_self\_update: self.ui\_stack.set\_visible\_child\_name("self\_update\_page") self.ui\_statusbar.set\_visible(False) status\_string = "" details = []
 for item in model\_items: details.append(f"{item[0].source\_name} {item[0].new\_version}") details = ", ".join(details) self.ui\_label\_self\_update\_details.set\_text(details) else: status\_string = gettext.ngettext("%(selected)d update selected (%(size)s)", "%(selected)d updates selected (%(size)s)", num\_visible) % \ {'selected':num\_visible, 'size':size\_to\_string(download\_size)} self.ui\_clear\_button.set\_sensitive(True) self.ui\_select\_all\_button.set\_sensitive(True) self.ui\_install\_button.set\_sensitive(True) self.ui\_window.set\_sensitive(True) systray\_tooltip = gettext.ngettext("%d update available", "%d updates available", num\_visible) % num\_visible self.set\_status(status\_string, systray\_tooltip, "mintupdate-updates-available-symbolic", True) else: self.logger.write("System is up to date") self.ui\_stack.set\_visible\_child\_name("success\_page") self.set\_status("", \_("Your system is up to date"), "mintupdate-up-to-date-symbolic", not self.settings.get\_boolean("hide-systray"))
 self.ui\_notebook\_details.set\_current\_page(0)
 tracker = UpdateTracker(self.settings, self.logger) model = Gtk.TreeStore(bool, str, str, str, str, GObject.TYPE\_LONG, str, str, str, str, str, object) # UPDATE\_CHECKED, UPDATE\_DISPLAY\_NAME, UPDATE\_OLD\_VERSION, UPDATE\_NEW\_VERSION, UPDATE\_SOURCE, # UPDATE\_SIZE, UPDATE\_SIZE\_STR, UPDATE\_TYPE\_PIX, UPDATE\_TYPE, UPDATE\_TOOLTIP, UPDATE\_SORT\_STR, UPDATE\_OBJ
 model.set\_sort\_column\_id(UPDATE\_SORT\_STR, Gtk.SortType.ASCENDING) for item in model\_items: self.add\_update\_to\_model(model, tracker, item)
 if tracker.active: if tracker.notify(): self.show\_tracker\_notification(num\_software, num\_security) tracker.record()
 self.treeview.set\_model(model) self.treeview.set\_search\_column(UPDATE\_DISPLAY\_NAME)
 def show\_tracker\_notification(self, num\_software, num\_security): security\_msg = gettext.ngettext("%d security update", "%d security updates", num\_security) % num\_security software\_msg = gettext.ngettext("%d software update", "%d software updates", num\_software) % num\_software msg = "" if num\_security > 0: msg = "%s\n" % security\_msg if num\_software > 0: msg = "%s%s\n" % (msg, software\_msg) msg = "%s\n%s" % (msg, \_("Apply them to keep your operating system safe and up to date."))
 # We use self.notification (instead of just a variable) to keep a memory pointer # on the notification. Without doing this, the callbacks are never executed by Gtk/Notify. self.notification = Notify.Notification.new(\_("Updates are available"), msg, "mintupdate-updates-available-symbolic") self.notification.set\_urgency(2) self.notification.set\_timeout(Notify.EXPIRES\_NEVER) self.notification.add\_action("show\_updates", \_("View updates"), self.on\_notification\_action, None) self.notification.add\_action("enable\_automatic\_updates", \_("Enable automatic updates"), self.on\_notification\_action, None) self.notification.show()
 def on\_notification\_action(self, notification, action\_name, data): if action\_name == "show\_updates": os.system("/usr/lib/linuxmint/mintUpdate/mintUpdate.py show &") elif action\_name == "enable\_automatic\_updates": self.open\_preferences(None, show\_automation=True)
######### WINDOW/STATUSICON ##########
 def close\_window(self, window, event): self.save\_window\_size() self.hide\_window(window) return True
 @\_idle def hide\_window(self, widget=None): self.ui\_window.hide() self.hidden = True
 @\_idle def show\_window(self, time=Gtk.get\_current\_event\_time()): self.ui\_window.show() self.ui\_window.present\_with\_time(time) self.hidden = False
 @\_idle def set\_window\_busy(self, busy): if self.ui\_window.get\_window() is None: return
 if busy and not self.hidden: self.ui\_window.get\_window().set\_cursor(Gdk.Cursor(Gdk.CursorType.WATCH)) self.ui\_window.set\_sensitive(False) else: self.ui\_window.get\_window().set\_cursor(None) self.ui\_window.set\_sensitive(True)
 @\_idle def set\_refresh\_mode(self, enabled): if enabled: self.ui\_refresh\_spinner.start() self.ui\_stack.set\_visible\_child\_name("refresh\_page") self.ui\_toolbar.set\_sensitive(False) self.ui\_menubar.set\_sensitive(False) self.ui\_clear\_button.set\_sensitive(False) self.ui\_select\_all\_button.set\_sensitive(False) self.ui\_install\_button.set\_sensitive(False) else: self.ui\_refresh\_spinner.stop() # Make sure we're never stuck on the status\_refreshing page: if self.ui\_stack.get\_visible\_child\_name() == "refresh\_page": self.ui\_stack.set\_visible\_child\_name("updates\_page") #self.ui\_paned.set\_position(self.ui\_paned.get\_position()) self.ui\_toolbar.set\_sensitive(True) self.ui\_menubar.set\_sensitive(True) self.set\_window\_busy(enabled)
 def save\_window\_size(self): self.settings.set\_int('window-width', self.ui\_window.get\_size()[0]) self.settings.set\_int('window-height', self.ui\_window.get\_size()[1]) self.settings.set\_int('window-pane-position', self.ui\_paned.get\_position())
######### MENU/TOOLBAR FUNCTIONS #########
 def update\_installable\_state(self): model = self.treeview.get\_model()
 iter = model.get\_iter\_first() download\_size = 0 num\_selected = 0 while iter is not None: checked = model.get\_value(iter, UPDATE\_CHECKED) if checked: size = model.get\_value(iter, UPDATE\_SIZE) download\_size = download\_size + size num\_selected = num\_selected + 1 iter = model.iter\_next(iter) if num\_selected == 0: self.ui\_install\_button.set\_sensitive(False) self.set\_status\_message(\_("No updates selected")) else: self.ui\_install\_button.set\_sensitive(True) self.set\_status\_message(gettext.ngettext("%(selected)d update selected (%(size)s)", "%(selected)d updates selected (%(size)s)", num\_selected) % {'selected':num\_selected, 'size':size\_to\_string(download\_size)})
 def setVisibleColumn(self, checkmenuitem, column, key): state = checkmenuitem.get\_active() self.settings.set\_boolean(key, state) column.set\_visible(state)
 def setVisibleDescriptions(self, checkmenuitem): self.settings.set\_boolean("show-descriptions", checkmenuitem.get\_active()) self.refresh(False)
 def clear(self, widget): model = self.treeview.get\_model() if len(model): iter = model.get\_iter\_first() while iter is not None: model.set\_value(iter, 0, False) iter = model.iter\_next(iter)
 self.update\_installable\_state()
 def select\_all(self, widget): self.select\_updates()
 def select\_updates(self, security=False, kernel=False): model = self.treeview.get\_model() iter = model.get\_iter\_first() while iter is not None: update = model.get\_value(iter, UPDATE\_OBJ) if security: if update.type == "security": model.set\_value(iter, UPDATE\_CHECKED, True) elif kernel: if update.type == "kernel": model.set\_value(iter, UPDATE\_CHECKED, True) else: model.set\_value(iter, UPDATE\_CHECKED, True) iter = model.iter\_next(iter)
 self.update\_installable\_state()
 def manual\_refresh(self, widget): if self.dpkg\_locked(): self.show\_dpkg\_lock\_msg(self.ui\_window) else: self.refresh(True)
 def self\_update(self, widget): self.select\_all(widget) self.install(widget)
######### WELCOME PAGE FUNCTIONS #######
 def on\_welcome\_page\_finished(self, button): self.settings.set\_boolean("show-welcome-page", False) self.ui\_toolbar.set\_sensitive(True) self.ui\_menubar.set\_sensitive(True) self.updates\_inhibited = False if self.cache\_monitor is None: self.cache\_monitor = APTCacheMonitor(self) self.cache\_monitor.start() else: self.ui\_stack.set\_visible\_child\_name("updates\_page")
 def show\_welcome\_page(self, widget=None): self.updates\_inhibited = True self.ui\_stack.set\_visible\_child\_name("welcome\_page") self.set\_status("", \_("Welcome to the Update Manager"), "mintupdate-updates-available-symbolic", True) self.ui\_toolbar.set\_sensitive(False) self.ui\_menubar.set\_sensitive(False)
######### TREEVIEW/SELECTION FUNCTIONS #######
 def treeview\_row\_activated(self, treeview, path, view\_column): self.toggled(None, path)
 def toggled(self, renderer, path): model = self.treeview.get\_model() iter = model.get\_iter(path) if iter is not None: model.set\_value(iter, UPDATE\_CHECKED, (not model.get\_value(iter, UPDATE\_CHECKED)))
 self.update\_installable\_state()
 @\_idle def set\_textview\_changes\_text(self, text): self.textview\_changes.set\_text(text)
 def display\_selected\_update(self, selection): try: self.textview\_packages.set\_text("") self.textview\_description.set\_text("") self.textview\_changes.set\_text("") (model, iter) = selection.get\_selected() if iter is not None: update = model.get\_value(iter, UPDATE\_OBJ) description = update.description.replace("\\n", "\n") desc\_tab = self.ui\_notebook\_details.get\_nth\_page(TAB\_DESC)
 if update.type == "cinnamon": latest\_change\_str = \_("Most recent change") desc = "%s\n\n%s: %s" % (description, latest\_change\_str, update.commit\_msg)
 self.textview\_description.set\_text(desc) self.ui\_notebook\_details.get\_nth\_page(TAB\_PACKAGES).hide() self.ui\_notebook\_details.get\_nth\_page(TAB\_CHANGELOG).hide() self.ui\_notebook\_details.set\_current\_page(TAB\_DESC) elif update.type == "flatpak": if update.link is not None and update.link != "": website\_label\_str = \_("Website: %s") % update.link description = "%s\n\n%s" % (update.description, website\_label\_str) else: description = "%s" % update.description
 self.textview\_description.set\_text(description) self.ui\_notebook\_details.get\_nth\_page(TAB\_PACKAGES).show() self.ui\_notebook\_details.get\_nth\_page(TAB\_CHANGELOG).hide() self.ui\_notebook\_details.set\_current\_page(TAB\_DESC) self.display\_package\_list(update, is\_flatpak=True) else: self.textview\_description.set\_text(description) self.ui\_notebook\_details.get\_nth\_page(TAB\_PACKAGES).show() self.ui\_notebook\_details.get\_nth\_page(TAB\_CHANGELOG).show() self.display\_package\_list(update)
 if self.ui\_notebook\_details.get\_current\_page() == 2: # Changelog tab self.retrieve\_changelog(update) self.changelog\_retriever\_started = True else: self.changelog\_retriever\_started = False
 except Exception as e: print (e) print(sys.exc\_info()[0])
 def get\_ppa\_info(self, origin): ppa\_sources\_file = "/etc/apt/sources.list" ppa\_sources\_dir = "/etc/apt/sources.list.d/" ppa\_words = origin.lstrip("LP-PPA-").split("-")
 source = ppa\_sources\_file if os.path.exists(ppa\_sources\_dir): for filename in os.listdir(ppa\_sources\_dir): if filename.startswith(origin.lstrip("LP-PPA-")): source = os.path.join(ppa\_sources\_dir, filename) break if not os.path.exists(source): return None, None try: with open(source) as f: for line in f: if (not line.startswith("#") and all(word in line for word in ppa\_words)): ppa\_info = line.split("://")[1] break else: return None, None except EnvironmentError as e: print ("Error encountered while trying to get PPA owner and name: %s" % e) return None, None ppa\_url, ppa\_owner, ppa\_name, ppa\_x = ppa\_info.split("/", 3) return ppa\_owner, ppa\_name
 def get\_ppa\_changelog(self, ppa\_owner, ppa\_name, source\_package, version): max\_tarball\_size = 1000000 print ("\nFetching changelog for PPA package %s/%s/%s ..." % (ppa\_owner, ppa\_name, source\_package)) if source\_package.startswith("lib"): ppa\_abbr = source\_package[:4] else: ppa\_abbr = source\_package[0] deb\_dsc\_uri = "https://ppa.launchpadcontent.net/%s/%s/ubuntu/pool/main/%s/%s/%s\_%s.dsc" % (ppa\_owner, ppa\_name, ppa\_abbr, source\_package, source\_package, version) try: deb\_dsc = urllib.request.urlopen(deb\_dsc\_uri, None, 10).read().decode("utf-8") except Exception as e: print ("Could not open Launchpad URL %s - %s" % (deb\_dsc\_uri, e)) return for line in deb\_dsc.split("\n"): if "debian.tar" not in line: continue tarball\_line = line.strip().split(" ", 2) if len(tarball\_line) == 3: deb\_checksum, deb\_size, deb\_filename = tarball\_line break else: deb\_filename = None if not deb\_filename or not deb\_size or not deb\_size.isdigit(): print ("Unsupported debian .dsc file format. Skipping this package.") return if (int(deb\_size) > max\_tarball\_size): print ("Tarball size %s B exceeds maximum download size %d B. Skipping download." % (deb\_size, max\_tarball\_size)) return deb\_file\_uri = "https://ppa.launchpadcontent.net/%s/%s/ubuntu/pool/main/%s/%s/%s" % (ppa\_owner, ppa\_name, ppa\_abbr, source\_package, deb\_filename) try: deb\_file = urllib.request.urlopen(deb\_file\_uri, None, 10).read().decode("utf-8") except Exception as e: print ("Could not download tarball from %s - %s" % (deb\_file\_uri, e)) return if deb\_filename.endswith(".xz"): cmd = ["xz", "--decompress"] try: xz = subprocess.Popen(cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE) xz.stdin.write(deb\_file) xz.stdin.close() deb\_file = xz.stdout.read() xz.stdout.close() except EnvironmentError as e: print ("Error encountered while decompressing xz file: %s" % e) return deb\_file = io.BytesIO(deb\_file) try: with tarfile.open(fileobj = deb\_file) as f: deb\_changelog = f.extractfile("debian/changelog").read()[View remainder of file in raw view](https://github.com/linuxmint/mintupdate/raw/refs/heads/master/usr/lib/linuxmint/mintUpdate/mintUpdate.py)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


