Based on the provided information, here's an analysis of CVE-2012-5666:

**Root cause of vulnerability:**
- The vulnerability is due to a lack of proper encoding/escaping of user-controlled input within the `bookmarks` application of ownCloud. Specifically, the `window.location` variable which contains user-provided data is not properly sanitized before being used to generate HTML links.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS): The application is vulnerable to XSS due to the injection of unsanitized data into the HTML context.

**Impact of exploitation:**
- A successful XSS attack could allow an attacker to execute arbitrary JavaScript code within the context of a victim's browser when they view a crafted bookmark.
- This could lead to a variety of malicious activities, including:
    - Stealing session cookies.
    - Redirecting users to malicious websites.
    - Defacing the website.
    - Performing actions on behalf of the user.

**Attack vectors:**
- The attacker would need to create a malicious bookmark that contains JavaScript code within its URL or title.
- When another user views this bookmark, the malicious code would be executed.

**Required attacker capabilities/position:**
- The attacker would need the ability to add or modify bookmarks within the ownCloud application.
- The attacker could be an authenticated user.

**Technical Details:**
- The vulnerability exists in the `apps/bookmarks/js/bookmarks.js` file.
- The vulnerable code generates a link using  `window.location` which can contain user-controlled data in the URL parameters.
- The fix involves escaping the `window.location` using the `escapeHTML()` function before using it to construct the HTML link.

```diff
--- a/bookmarks/js/bookmarks.js
+++ b/bookmarks/js/bookmarks.js
@@ -141,7 +141,7 @@
 			var taglist = '';
 			for ( var i=0, len=tags.length; i<len; ++i ){
 				if(tags[i] != '')
-					taglist = taglist + '<a class="bookmark_tag" href="'+replaceQueryString( String(window.location), 'tag', encodeURIComponent(tags[i])) + '">' + tags[i] + '</a> ';
+					taglist = taglist + '<a class="bookmark_tag" href="'+replaceQueryString(escapeHTML(String(window.location)), 'tag', encodeURIComponent(tags[i])) + '">' + tags[i] + '</a> ';
 			}
 			if(!hasProtocol(bookmark.url)) {
 				bookmark.url = 'http://' + bookmark.url;

```