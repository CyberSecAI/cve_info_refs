=== Content from www.ocert.org_4025a2b7_20250125_082305.html ===


**oCERT-2012-001 multiple implementations denial-of-service via MurmurHash algorithm collision**

**Description**:

A variety of programming languages suffer from a denial-of-service (DoS)
condition against storage functions of key/value pairs in hash data structures,
the condition can be leveraged by exploiting predictable collisions in the
underlying hashing algorithms.

The issue is similar to the one reported in [oCERT-2011-003](ocert-2011-003.html)
and concerns the MurmurHash algorithm family. The condition for predictable collisions in the hashing functions has
been reported for the following language implementations:
[JRuby](http://jruby.org/) (MurmurHash2),
[Ruby](http://www.ruby-lang.org/) (MurmurHash2),
[Rubinius](http://rubini.us/) (MurmurHash3),
[Oracle JDK](http://www.oracle.com/technetwork/java/javase) (MurmurHash),
[OpenJDK](http://openjdk.java.net) (MurmurHash).
In the case of Java OpenJDK the hash function affected by the reported
issue is not enabled by default, the default function is however reported vulnerable to
[oCERT-2011-003](ocert-2011-003.html).

**Affected version**:

[Ruby](http://www.ruby-lang.org/) < 1.9.3-p327

[JRuby](http://jruby.org/) < 1.7.1

[Rubinius](http://rubini.us/), all versions

[Oracle JDK](http://www.oracle.com/technetwork/java/javase) <= 7

[OpenJDK](http://openjdk.java.net) <= 7

**Fixed version**:

[Ruby](http://www.ruby-lang.org/) >= 1.9.3-p327

[JRuby](http://jruby.org/) >= 1.7.1

[Rubinius](http://rubini.us/), N/A (see References for patch commited to development branch)

[Oracle JDK](http://www.oracle.com/technetwork/java/javase), N/A

[OpenJDK](http://openjdk.java.net), N/A

**Credit**: vulnerability report received from Jean-Philippe Aumasson <jeanphilippe.aumasson AT gmail.com>,
PoC code and SipHash implementation used to patch the issue developed by Martin Bosslet <martin.bosslet AT gmail.com>.

**CVE**: [CVE-2012-5370](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5370) (JRuby),
[CVE-2012-5371](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5371) (Ruby),
[CVE-2012-5372](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5372) (Rubinius),
[CVE-2012-5373](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5373) (Oracle JDK, OpenJDK)

**Timeline**:

2012-08-30: vulnerability report sent to Ruby, JRuby and Rubinius security contacts

2012-09-03: vulnerability report forwarded to oCERT by Hiroshi Nakamura (Ruby security contact)

2012-09-06: oCERT contacted reporters to investigate additional affected projects

2012-09-06: reporters indicate OpenJDK as vulnerable and that Java security team has been contacted on 2012-07-31

2012-09-10: oCERT requested CVE assignment for Ruby, JRuby and Rubinius

2012-09-12: Oracle JDK and OpenJDK confirmed vulnerable by reporters

2012-09-12: oCERT requested CVE assignment for Oracle JDK and OpenJDK

2012-10-10: reporters indicate public PoC release on 2012-11-07 at [ASFWS](http://2012.appsec-forum.ch)

2012-11-08: assigned CVEs

2012-11-09: Ruby 1.9.3-p327 released

2012-11-23: advisory release

2012-11-27: corrected typos in CVE assignment

2012-12-03: JRuby 1.7.1 released

2012-12-12: added reference to JRuby release and Rubinius development branch patch

**References**:

<https://www.131002.net/siphash>

<https://github.com/rubinius/rubinius/commit/a9a40fc6a1256bcf6382631b710430105c5dd868>



=== Content from www.131002.net_ec8d875a_20250125_082305.html ===


## JP Aumasson

[Home](index.html)
[Research](papers.html)
[Talks](talks.html)
[Events](conferences.html)
[Favorites](favorites.html)

Cryptographer, co-founder & chief security officer at [Taurus SA](https://taurushq.com).

### Books

[![Serious Cryptography 2nd Edition](data/covs/sc2.jpg)](https://nostarch.com/serious-cryptography-2nd-edition)
[![Serious Cryptography](data/covs/sc.jpg)](https://nostarch.com/seriouscrypto)
[![Crypto Dictionary](data/covs/cd.jpg)](https://www.crypto-dictionary.com)
[![The Hash Function BLAKE](data/covs/bl.jpg)](blake/book/index.html)
[![Petit Pingouin](data/covs/ppp.png)](http://petitpingou.in)

* [Serious Cryptography, 2nd edition](https://nostarch.com/serious-cryptography-2nd-edition) (No Starch Press, 2024)
  + [La
    Cryptographie Déchiffrée](https://www.dunod.com/sciences-techniques/cryptographie-dechiffree-une-introduction-pratique-au-chiffrement-moderne) (Dunod, 2024)
* [Petit Pingouin](http://petitpingou.in) (self-published, 2021)
* [Crypto Dictionary](https://www.crypto-dictionary.com) (No Starch Press, 2020)
* [Serious Cryptography](https://nostarch.com/seriouscrypto) (No Starch Press, 2017)
  + [translations](serious.html)
* [The Hash Function BLAKE](blake/book/index.html) (Springer, 2014)

### Crypto Projects

* Hash functions [BLAKE](https://en.wikipedia.org/wiki/BLAKE_%28hash_function%29), [BLAKE2](https://blake2.net) (RFC [7693](https://datatracker.ietf.org/doc/rfc7693/)), and [BLAKE3](https://github.com/BLAKE3-team/BLAKE3)
* Pseudorandom function [SipHash](https://en.wikipedia.org/wiki/SipHash)
* Post-quantum signatures [PRUNE-HORST](https://github.com/gravity-postquantum/prune-horst), [Gravity-SPHINCS](https://github.com/gravity-postquantum/gravity-sphincs), [SPHINCS+](https://sphincs.org/) (FIPS 205, [SLH-DSA](https://csrc.nist.gov/pubs/fips/205/ipd))
* [Password Hashing Competition](https://www.password-hashing.net/) & winner [Argon2](https://github.com/P-H-C/phc-winner-argon2) (RFC [9106](https://datatracker.ietf.org/doc/rfc9106/))
* [Cryptography trainings](https://cryptotraining.ch/)

### Misc

* [SLF](https://slf.fish/) member
* [awesome-post-quantum](https://github.com/veorq/awesome-post-quantum) maintainer
* [Murphy's laws of cryptography](murphy.html)

### Socials

* Signal: jpa.01
* Email: [[email protected]](/cdn-cgi/l/email-protection)
* [GitHub](https://github.com/veorq)
* [LinkedIn](https://www.linkedin.com/in/aumasson/)


