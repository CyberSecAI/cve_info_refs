=== Content from lists.opensuse.org_e9548342_20250124_140947.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW/#DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW)

# [security-announce] SUSE-SU-2012:1592-1: important: Security update for Mozilla Firefox

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

29 Nov
2012

29 Nov
'12

00:08

SUSE Security Update: Security update for Mozilla Firefox
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2012:1592-1
Rating: important
References: #790140
Affected Products:
SUSE Linux Enterprise Software Development Kit 11 SP2
SUSE Linux Enterprise Server 11 SP2 for VMware
SUSE Linux Enterprise Server 11 SP2
SUSE Linux Enterprise Server 10 SP4
SUSE Linux Enterprise Desktop 11 SP2
SUSE Linux Enterprise Desktop 10 SP4
SLE SDK 10 SP4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that contains security fixes can now be
installed. It includes two new package versions.
Description:
Mozilla Firefox has been updated to the 10.0.11 ESR
security release, which fixes various bugs and security
issues.
\*
MFSA 2012-106: Security researcher miaubiz used the
Address Sanitizer tool to discover a series critically
rated of use-after-free, buffer overflow, and memory
corruption issues in shipped software. These issues are
potentially exploitable, allowing for remote code
execution. We would also like to thank miaubiz for
reporting two additional use-after-free and memory
corruption issues introduced during Firefox development
that have been fixed before general release.
In general these flaws cannot be exploited through
email in the Thunderbird and SeaMonkey products because
scripting is disabled, but are potentially a risk in
browser or browser-like contexts in those products.
References
The following issues have been fixed in Firefox 17
and ESR 10.0.11:
o use-after-free when loading html file on osx
(CVE-2012-5830) o Mesa crashes on certain texImage2D calls
involving level>0 (CVE-2012-5833) o integer overflow,
invalid write w/webgl bufferdata (CVE-2012-5835)
The following issues have been fixed in Firefox 17:
o crash in copyTexImage2D with image dimensions
too large for given level (CVE-2012-5838)
\*
MFSA 2012-105: Security researcher Abhishek Arya
(Inferno) of the Google Chrome Security Team discovered a
series critically rated of use-after-free and buffer
overflow issues using the Address Sanitizer tool in shipped
software. These issues are potentially exploitable,
allowing for remote code execution. We would also like to
thank Abhishek for reporting five additional
use-after-free, out of bounds read, and buffer overflow
flaws introduced during Firefox development that have been
fixed before general release.
In general these flaws cannot be exploited through
email in the Thunderbird and SeaMonkey products because
scripting is disabled, but are potentially a risk in
browser or browser-like contexts in those products.
References
The following issues have been fixed in Firefox 17
and ESR 10.0.11:
o Heap-use-after-free in
nsTextEditorState::PrepareEditor (CVE-2012-4214) o
Heap-use-after-free in
nsPlaintextEditor::FireClipboardEvent (CVE-2012-4215) o
Heap-use-after-free in gfxFont::GetFontEntry
(CVE-2012-4216) o Heap-buffer-overflow in
nsWindow::OnExposeEvent (CVE-2012-5829) o
heap-buffer-overflow in
gfxShapedWord::CompressedGlyph::IsClusterStart o
CVE-2012-5839 o Heap-use-after-free in
nsTextEditorState::PrepareEditor (CVE-2012-5840)
The following issues have been fixed in Firefox 17:
o Heap-use-after-free in XPCWrappedNative::Mark
(CVE-2012-4212) o Heap-use-after-free in
nsEditor::FindNextLeafNode (CVE-2012-4213) o
Heap-use-after-free in nsViewManager::ProcessPendingUpdates
(CVE-2012-4217) o Heap-use-after-free
BuildTextRunsScanner::BreakSink::SetBreaks (CVE-2012-4218)
\*
MFSA 2012-104 / CVE-2012-4210: Security researcher
Mariusz Mlynski reported that when a maliciously crafted
stylesheet is inspected in the Style Inspector, HTML and
CSS can run in a chrome privileged context without being
properly sanitized first. This can lead to arbitrary code
execution.
\*
MFSA 2012-103 / CVE-2012-4209: Security researcher
Mariusz Mlynski reported that the location property can be
accessed by binary plugins through top.location with a
frame whose name attribute's value is set to "top". This
can allow for possible cross-site scripting (XSS) attacks
through plugins.
In general these flaws cannot be exploited through
email in the Thunderbird and SeaMonkey products because
scripting is disabled, but are potentially a risk in
browser or browser-like contexts in those products.
\*
MFSA 2012-102 / CVE-2012-5837: Security researcher
Masato Kinugawa reported that when script is entered into
the Developer Toolbar, it runs in a chrome privileged
context. This allows for arbitrary code execution or
cross-site scripting (XSS) if a user can be convinced to
paste malicious code into the Developer Toolbar.
\*
MFSA 2012-101 / CVE-2012-4207: Security researcher
Masato Kinugawa found when HZ-GB-2312 charset encoding is
used for text, the "~" character will destroy another
character near the chunk delimiter. This can lead to a
cross-site scripting (XSS) attack in pages encoded in
HZ-GB-2312.
\*
MFSA 2012-100 / CVE-2012-5841: Mozilla developer
Bobby Holley reported that security wrappers filter at the
time of property access, but once a function is returned,
the caller can use this function without further security
checks. This affects cross-origin wrappers, allowing for
write actions on objects when only read actions should be
properly allowed. This can lead to cross-site scripting
(XSS) attacks.
In general these flaws cannot be exploited through
email in the Thunderbird and SeaMonkey products because
scripting is disabled, but are potentially a risk in
browser or browser-like contexts in those products.
\*
MFSA 2012-99 / CVE-2012-4208: Mozilla developer Peter
Van der Beken discovered that same-origin XrayWrappers
expose chrome-only properties even when not in a chrome
compartment. This can allow web content to get properties
of DOM objects that are intended to be chrome-only.
In general these flaws cannot be exploited through
email in the Thunderbird and SeaMonkey products because
scripting is disabled, but are potentially a risk in
browser or browser-like contexts in those products.
\*
MFSA 2012-98 / CVE-2012-4206: Security researcher
Robert Kugler reported that when a specifically named DLL
file on a Windows computer is placed in the default
downloads directory with the Firefox installer, the Firefox
installer will load this DLL when it is launched. In
circumstances where the installer is run by an
administrator privileged account, this allows for the
downloaded DLL file to be run with administrator
privileges. This can lead to arbitrary code execution from
a privileged account.
\*
MFSA 2012-97 / CVE-2012-4205: Mozilla developer Gabor
Krizsanits discovered that XMLHttpRequest objects created
within sandboxes have the system principal instead of the
sandbox principal. This can lead to cross-site request
forgery (CSRF) or information theft via an add-on running
untrusted code in a sandbox.
\*
MFSA 2012-96 / CVE-2012-4204: Security researcher
Scott Bell of Security-Assessment.com used the Address
Sanitizer tool to discover a memory corruption in
str\_unescape in the Javascript engine. This could
potentially lead to arbitrary code execution.
In general these flaws cannot be exploited through
email in the Thunderbird and SeaMonkey products because
scripting is disabled, but are potentially a risk in
browser or browser-like contexts in those products.
\*
MFSA 2012-95 / CVE-2012-4203: Security researcher
kakzz.ng@gmail.com reported that if a javascript: URL is
selected from the list of Firefox "new tab" page, the
script will inherit the privileges of the privileged "new
tab" page. This allows for the execution of locally
installed programs if a user can be convinced to save a
bookmark of a malicious javascript: URL.
\*
MFSA 2012-94 / CVE-2012-5836: Security researcher
Jonathan Stephens discovered that combining SVG text on a
path with the setting of CSS properties could lead to a
potentially exploitable crash.
\*
MFSA 2012-93 / CVE-2012-4201: Mozilla security
researcher moz\_bug\_r\_a4 reported that if code executed by
the evalInSandbox function sets location.href, it can get
the wrong subject principal for the URL check, ignoring the
sandbox's Javascript context and gaining the context of
evalInSandbox object. This can lead to malicious web
content being able to perform a cross-site scripting (XSS)
attack or stealing a copy of a local file if the user has
installed an add-on vulnerable to this attack.
\*
MFSA 2012-92 / CVE-2012-4202: Security researcher
Atte Kettunen from OUSPG used the Address Sanitizer tool to
discover a buffer overflow while rendering GIF format
images. This issue is potentially exploitable and could
lead to arbitrary code execution.
\*
MFSA 2012-91: Mozilla developers identified and fixed
several memory safety bugs in the browser engine used in
Firefox and other Mozilla-based products. Some of these
bugs showed evidence of memory corruption under certain
circumstances, and we presume that with enough effort at
least some of these could be exploited to run arbitrary
code.
In general these flaws cannot be exploited through
email in the Thunderbird and SeaMonkey products because
scripting is disabled, but are potentially a risk in
browser or browser-like contexts in those products.
References
Gary Kwong, Jesse Ruderman, Christian Holler, Bob
Clary, Kyle Huey, Ed Morley, Chris Lord, Boris Zbarsky,
Julian Seward, and Bill McCloskey reported memory safety
problems and crashes that affect Firefox 16. (CVE-2012-5843)
Jesse Ruderman, Andrew McCreight, Bob Clary, and Kyle
Huey reported memory safety problems and crashes that
affect Firefox ESR 10 and Firefox 16. (CVE-2012-5842)
Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Software Development Kit 11 SP2:
zypper in -t patch sdksp2-firefox-20121121-7093
- SUSE Linux Enterprise Server 11 SP2 for VMware:
zypper in -t patch slessp2-firefox-20121121-7093
- SUSE Linux Enterprise Server 11 SP2:
zypper in -t patch slessp2-firefox-20121121-7093
- SUSE Linux Enterprise Desktop 11 SP2:
zypper in -t patch sledsp2-firefox-20121121-7093
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Software Development Kit 11 SP2 (i586 ia64 ppc64 s390x x86\_64) [New Version: 3.14]:
mozilla-nss-devel-3.14-0.3.1
- SUSE Linux Enterprise Server 11 SP2 for VMware (i586 x86\_64) [New Version: 10.0.11 and 3.14]:
MozillaFirefox-10.0.11-0.3.1
MozillaFirefox-translations-10.0.11-0.3.1
libfreebl3-3.14-0.3.1
mozilla-nss-3.14-0.3.1
mozilla-nss-tools-3.14-0.3.1
- SUSE Linux Enterprise Server 11 SP2 for VMware (x86\_64) [New Version: 3.14]:
libfreebl3-32bit-3.14-0.3.1
mozilla-nss-32bit-3.14-0.3.1
- SUSE Linux Enterprise Server 11 SP2 (i586 ia64 ppc64 s390x x86\_64) [New Version: 10.0.11 and 3.14]:
MozillaFirefox-10.0.11-0.3.1
MozillaFirefox-translations-10.0.11-0.3.1
libfreebl3-3.14-0.3.1
mozilla-nss-3.14-0.3.1
mozilla-nss-tools-3.14-0.3.1
- SUSE Linux Enterprise Server 11 SP2 (ppc64 s390x x86\_64) [New Version: 3.14]:
libfreebl3-32bit-3.14-0.3.1
mozilla-nss-32bit-3.14-0.3.1
- SUSE Linux Enterprise Server 11 SP2 (ia64) [New Version: 3.14]:
libfreebl3-x86-3.14-0.3.1
mozilla-nss-x86-3.14-0.3.1
- SUSE Linux Enterprise Server 10 SP4 (i586 ia64 ppc s390x x86\_64) [New Version: 3.14]:
mozilla-nss-3.14-0.6.1
mozilla-nss-devel-3.14-0.6.1
mozilla-nss-tools-3.14-0.6.1
- SUSE Linux Enterprise Server 10 SP4 (i586 ia64 ppc s390x):
MozillaFirefox-10.0.11-0.5.1
MozillaFirefox-translations-10.0.11-0.5.1
- SUSE Linux Enterprise Server 10 SP4 (s390x x86\_64) [New Version: 3.14]:
mozilla-nss-32bit-3.14-0.6.1
- SUSE Linux Enterprise Server 10 SP4 (ia64) [New Version: 3.14]:
mozilla-nss-x86-3.14-0.6.1
- SUSE Linux Enterprise Server 10 SP4 (ppc) [New Version: 3.14]:
mozilla-nss-64bit-3.14-0.6.1
- SUSE Linux Enterprise Desktop 11 SP2 (i586 x86\_64) [New Version: 10.0.11 and 3.14]:
MozillaFirefox-10.0.11-0.3.1
MozillaFirefox-translations-10.0.11-0.3.1
libfreebl3-3.14-0.3.1
mozilla-nss-3.14-0.3.1
mozilla-nss-tools-3.14-0.3.1
- SUSE Linux Enterprise Desktop 11 SP2 (x86\_64) [New Version: 3.14]:
libfreebl3-32bit-3.14-0.3.1
mozilla-nss-32bit-3.14-0.3.1
- SUSE Linux Enterprise Desktop 10 SP4 (i586 x86\_64) [New Version: 3.14]:
mozilla-nss-3.14-0.6.1
mozilla-nss-devel-3.14-0.6.1
mozilla-nss-tools-3.14-0.6.1
- SUSE Linux Enterprise Desktop 10 SP4 (x86\_64) [New Version: 3.14]:
mozilla-nss-32bit-3.14-0.6.1
- SUSE Linux Enterprise Desktop 10 SP4 (i586):
MozillaFirefox-10.0.11-0.5.1
MozillaFirefox-translations-10.0.11-0.5.1
- SLE SDK 10 SP4 (i586 ia64 ppc s390x x86\_64) [New Version: 3.14]:
mozilla-nss-tools-3.14-0.6.1
- SLE SDK 10 SP4 (i586 ia64 ppc s390x):
MozillaFirefox-branding-upstream-10.0.11-0.5.1
References:
<https://bugzilla.novell.com/790140>
[http://download.novell.com/patch/finder/?keywords=8f4e08deca5960ae494ddceeb6...](http://download.novell.com/patch/finder/?keywords=8f4e08deca5960ae494ddceeb6c10708)
[http://download.novell.com/patch/finder/?keywords=be7a175297dfe6897d72c7cf8c...](http://download.novell.com/patch/finder/?keywords=be7a175297dfe6897d72c7cf8ca67245)
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW/#DVB7YODZY4MKVHTKG54PKVNYCDDXIYYW)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from secunia.com_2025ee70_20250124_140950.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from secunia.com_a5646067_20250124_140950.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from bugzilla.mozilla.org_be9f1dcf_20250124_141009.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/789075)
* [XML](/show_bug.cgi?ctype=xml&id=789075)

Closed
[Bug 789075](/show_bug.cgi?id=789075)

Opened 12 years ago
Closed 12 years ago

# Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool

## Categories

### (Core :: Audio/Video, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Audio%2FVideo#Audio%2FVideo)

Audio/Video
▾

Core :: Audio/Video
For problems related to media (video/audio) -- especially when the reporter is not sure which area of the media stack the problem is in. This category will mostly be for untriaged video/audio issues. Bugs in this category will typically be moved to another media category during the triage process.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Audio%2FVideo)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

15 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla19

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 | [-](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=-) | [affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected) |
| firefox16 | [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified) |
| firefox19 | --- | [verified](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=verified) |
| firefox-esr10 | [-](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=-) | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 | - | affected |
| firefox16 | - | wontfix |
| firefox17 | + | fixed |
| firefox18 | + | verified |
| firefox19 |  | verified |
| firefox-esr10 | - | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: cwiiis, Assigned: kinetik)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/aeea283b2f56b75a7c959ccfb660a619?d=mm&size=40)  [kinetik](/user_profile?user_id=274575)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/8679e1c6004dffb8ffd44e6419ac9474?d=mm&size=40)  [jbecerra](/user_profile?user_id=241759)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1c509df09fc0b1c63500acc279c093dc?d=mm&size=40)  [cwiiis](/user_profile?user_id=194366)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

### ( [URL](http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps-profile-1346944481.42.zip&videoCapture=videos/video-1346944481.42.webm "http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps-profile-1346944481.42.zip&videoCapture=videos/video-1346944481.42.webm") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)")

[1370838](/show_bug.cgi?id=1370838 "RESOLVED FIXED - Update dom/media/test/crashtests/789075-1.html crashtest")

Dependency [tree](/showdependencytree.cgi?id=789075&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=789075)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[people.mozilla.com/~bgirard/cleopatra...](http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps-profile-1346944481.42.zip&videoCapture=videos/video-1346944481.42.webm "http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps-profile-1346944481.42.zip&videoCapture=videos/video-1346944481.42.webm")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, regression, reproducible, Whiteboard: [adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reproducible](/buglist.cgi?keywords=reproducible&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ FastConvertYUVToRGB32Row\_SSE ]](https://crash-stats.mozilla.org/signature/?signature=FastConvertYUVToRGB32Row_SSE)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [patch v0](/attachment.cgi?id=669013)  [12 years ago](#c41)  [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)   1.91 KB, patch | derf : [review+](#c42 "12 years ago") | [Details](/attachment.cgi?id=669013&action=edit) | [Diff](/attachment.cgi?id=669013&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=669013) |
| --- | --- | --- |
| [patch v1](/attachment.cgi?id=672098)  [12 years ago](#c47)  [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)   4.74 KB, patch | lsblakk : [approval-mozilla-aurora+](#c49 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c49 "12 years ago") | [Details](/attachment.cgi?id=672098&action=edit) | [Diff](/attachment.cgi?id=672098&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=672098) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Chris Lord [:cwiiis]](/user_profile?user_id=194366)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=789075#c0)• 12 years ago |
|  | |

Visiting <http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps-profile-1346944481.42.zip&videoCapture=videos/video-1346944481.42.webm> in Firefox Nightly in Windows causes the browser to crash, usually, or sometimes become very unresponsive and use lots of memory (possibly the lack of responsiveness is down to paging?)
I've not been able to profile this as I can't get it running reliably enough to do anything with it, hopefully a Windows developer/someone more familiar with Windows can look at this.
Works fine in Firefox 15 on Linux.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=789075#c1)• 12 years ago |
|  | |

Here is the crash report: [bp-429c44b5-4a93-439e-9dd2-c7d452120906](https://crash-stats.mozilla.org/report/index/429c44b5-4a93-439e-9dd2-c7d452120906).
Frame Module Signature Source
0 xul.dll FastConvertYUVToRGB32Row\_SSE gfx/ycbcr/yuv\_row\_win.cpp:32
1 xul.dll mozilla::gfx::ConvertYCbCrToRGB32 gfx/ycbcr/yuv\_convert.cpp:96
2 xul.dll mozilla::layers::PlanarYCbCrImage::GetAsSurface gfx/layers/ImageContainer.cpp:495
It's similar to [bug 672870](/show_bug.cgi?id=672870 "RESOLVED WORKSFORME - Firefox Crash [@ FastConvertYUVToRGB32Row_SSE ]") and [bug 750190](/show_bug.cgi?id=750190 "RESOLVED DUPLICATE - crash in FastConvertYUVToRGB32Row_SSE").URL: [http://people.mozilla.com/~bgirard/cl...](http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps-profile-1346944481.42.zip&videoCapture=videos/video-1346944481.42.webm)Severity: normal → criticalCrash Signature: [@ FastConvertYUVToRGB32Row\_SSE]Component: General → Graphics: LayersKeywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[reproducible](/buglist.cgi?keywords=reproducible&resolution=---)Product: Firefox → Core

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=789075#c2)• 12 years ago |
|  | |

[bp-cebbaab8-6bf6-42e0-9e3a-a63372120907](https://crash-stats.mozilla.org/report/index/cebbaab8-6bf6-42e0-9e3a-a63372120907) : Firefox15.0.1
[bp-d152db83-b687-426a-89eb-a45c62120907](https://crash-stats.mozilla.org/report/index/d152db83-b687-426a-89eb-a45c62120907) : Firefox16beta
[bp-fa4ee1ec-38f5-4c86-882d-d45a32120907](https://crash-stats.mozilla.org/report/index/fa4ee1ec-38f5-4c86-882d-d45a32120907) : Aurora17.0a2
[bp-4c086efa-376a-4ad4-9a51-68c1a2120907](https://crash-stats.mozilla.org/report/index/4c086efa-376a-4ad4-9a51-68c1a2120907) : Nightly18.0a1
Regression window(m-c)
Good:
<http://hg.mozilla.org/mozilla-central/rev/305cd10b57d2>
Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/15.0 Firefox/15.0a1 ID:20120601055003
Crash:
<http://hg.mozilla.org/mozilla-central/rev/12ab69851e05>
Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/15.0 Firefox/15.0a1 ID:20120601073103
Pushlog:
<http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=305cd10b57d2&tochange=12ab69851e05>
Regression window(m-i)
Good:
<http://hg.mozilla.org/integration/mozilla-inbound/rev/202d63933120>
Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/15.0 Firefox/15.0a1 ID:20120531112503
Crash:
<http://hg.mozilla.org/integration/mozilla-inbound/rev/07cec35eee23>
Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/15.0 Firefox/15.0a1 ID:20120531202501
Pushlog:
<http://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=202d63933120&tochange=07cec35eee23>
In local build:
Last good: d9ac6a5b9aea
First Bad: 85a3f4b90adc
Triggered by:
85a3f4b90adc Andreas Gal — [Bug 714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)") Part 2 - Media plugin support for libstagefright - r=doublec

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=789075#c3)• 12 years ago |
|  | |

Thanks alice thats a big help!Blocks: [714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)")

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a62313_386758)• 12 years ago |

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Version: Trunk → 15 Branch

|  | [(mostly gone) XtC4UaLL [:xtc4uall]](/user_profile?user_id=104905) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=789075#c4)• 12 years ago |
|  | |

FWIW, in a provided recent Debug Nightly you get following Assertion at Crashtime:
###!!! ASSERTION: must have binding parent when in native anonymous subtree with a parent node: '!IsInNativeAnonymousSubtree() ||GetBindingParent() || !GetParent()', file e:\builds\moz2\_slave\m-cen-w32-dbg\build\obj-firefox\dist\include\nsIContent.h, line 230

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=789075#c5)• 12 years ago |
|  | |

Gal this regression was introduced by [Bug 714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)"). Any though on this?
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[tracking-firefox15](/buglist.cgi?f1=cf_tracking_firefox15&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%3F)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a1579085_425645)• 12 years ago |

[tracking-firefox15](/buglist.cgi?f1=cf_tracking_firefox15&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=-)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=789075#c6)• 12 years ago |
|  | |

(In reply to Chris Lord [:cwiiis] from [comment #0](/show_bug.cgi?id=789075#c0 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> Visiting
> <http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps>-
> profile-1346944481.42.zip&videoCapture=videos/video-1346944481.42.webm in
> Firefox Nightly in Windows causes the browser to crash, usually, or
> sometimes become very unresponsive and use lots of memory (possibly the lack
> of responsiveness is down to paging?)
Chris/Benoit - is this critical for your testing or do you think this may have significant user impact? We tracked this based upon the assumption that this was critical for testing, but want to double check.

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=789075#c7)• 12 years ago |
|  | |

This is a user facing bug. It just happens to reproduce on our testing site because it's a complex page. We don't know the trigger so it could happen anywhere on the web with a <video> tag.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=789075#c8)• 12 years ago |
|  | |

(In reply to Benoit Girard (:BenWa) from [comment #7](/show_bug.cgi?id=789075#c7 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> This is a user facing bug. It just happens to reproduce on our testing site
> because it's a complex page. We don't know the trigger so it could happen
> anywhere on the web with a <video> tag.
Please re-nominate if this starts becoming troublesome for internal testing. No need to track given the fact that this crash signature has a very low volume externally.
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=-)

|  | [William Lachance (:wlach)](/user_profile?user_id=420096) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=789075#c9)• 12 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #8](/show_bug.cgi?id=789075#c8 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Benoit Girard (:BenWa) from [comment #7](/show_bug.cgi?id=789075#c7 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > This is a user facing bug. It just happens to reproduce on our testing site
> > because it's a complex page. We don't know the trigger so it could happen
> > anywhere on the web with a <video> tag.
>
> Please re-nominate if this starts becoming troublesome for internal testing.
> No need to track given the fact that this crash signature has a very low
> volume externally.
Most of the time when this bug occurs the only symptom is that the browser becomes super unresponsive (to the point that usually my only resort is to kill it manually) -- I don't think we even have a crash signature for this bug. This could be happening all the time and we wouldn't even notice it... :/

|  | [William Lachance (:wlach)](/user_profile?user_id=420096) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=789075#c10)• 12 years ago |
|  | |

Should also have mentioned at some point that this is 100% reproducible for me on Ubuntu 12.04 using the Aurora builds of Firefox (17)

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=789075#c11)• 12 years ago |
|  | |

This doesn't reproduce on mac. How bad is the 'stop responding' vs. crash? If we're not blocking on this because the crash stats are low it's not including the impact of the jank caused. This is a regression and can happen to our users on any site using video :(

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=789075#c12)• 12 years ago |
|  | |

This is a serious regression in web content. I'm pretty disappointed that we let this slide for so long. It might be already too late for 16 Beta, but we should definitely get this fixed in 17 at least.
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-) → [?](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%3F)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=-) → [?](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%3F)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%3F)Component: Graphics: Layers → Video/Audio

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a2169932_251051)• 12 years ago |

Assignee: nobody → gal

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=789075#c13)• 12 years ago |
|  | |

Renaming title to be more accurate. It's not a bug with our testing tool but with the browser support. This crash doesn't happen in webkit.Summary: Eideticker video profiling tool causes browser to stop responding (mostly) or crash → Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=789075#c14)• 12 years ago |
|  | |

(In reply to Ehsan Akhgari [:ehsan] from [comment #12](/show_bug.cgi?id=789075#c12 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> This is a serious regression in web content. I'm pretty disappointed that
> we let this slide for so long. It might be already too late for 16 Beta,
> but we should definitely get this fixed in 17 at least.
FF15 is marked as affected, but we haven't heard about this in the wild. Why are you concerned about this issue specifically?
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=789075#c15)• 12 years ago |
|  | |

(In reply to [comment #14](/show_bug.cgi?id=789075#c14 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Ehsan Akhgari [:ehsan] from [comment #12](/show_bug.cgi?id=789075#c12 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > This is a serious regression in web content. I'm pretty disappointed that
> > we let this slide for so long. It might be already too late for 16 Beta,
> > but we should definitely get this fixed in 17 at least.
>
> FF15 is marked as affected, but we haven't heard about this in the wild. Why
> are you concerned about this issue specifically?
Because it's a regression in web content, and a pretty serious one.

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=789075#c16)• 12 years ago |
|  | |

Firefox 15 doesn't appear to be affected. Firefox beta is affected.
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=unaffected)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=789075#c17)• 12 years ago |
|  | |

(In reply to Benoit Girard (:BenWa) from [comment #16](/show_bug.cgi?id=789075#c16 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> Firefox 15 doesn't appear to be affected. Firefox beta is affected.
This changes things. Can anybody speak to the prevalence of this issue? I'm hearing we can't go by crash stats since this is a hang, so we need a way to reason about the severity at this point.
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=789075#c18)• 12 years ago |
|  | |

With STR of [comment 0](/show_bug.cgi?id=789075#c0 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"), Firefox no longer crashes whatever the version.
With STR of [bug 795892](/show_bug.cgi?id=795892 "RESOLVED FIXED - Playing video causes reproducible crash in nsCOMPtr_base::assign_with_AddRef"), Firefox crashes in 15.0.1 and above.

|  | [juan becerra [:juanb]](/user_profile?user_id=241759) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a2253295_241759)• 12 years ago |

QA Contact: jbecerra

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=789075#c19)• 12 years ago |
|  | |

(In reply to Scoobidiver from [comment #18](/show_bug.cgi?id=789075#c18 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> With STR of [comment 0](/show_bug.cgi?id=789075#c0 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"), Firefox no longer crashes whatever the version.
> With STR of [bug 795892](/show_bug.cgi?id=795892 "RESOLVED FIXED - Playing video causes reproducible crash in nsCOMPtr_base::assign_with_AddRef"), Firefox crashes in 15.0.1 and above.
Confirming this with Windows 7 SP1 32-bit using Firefox 15.0.1 and 17.0a2 2012-10-02. Note that to reproduce the crash all I have to do is load the following URL;
<http://people.mozilla.com/~bgirard/cleopatra/?zippedProfile=profiles/sps-profile-1348512228.12.zip&videoCapture=videos/video-1348512228.11.webm>

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=789075#c20)• 12 years ago |
|  | |

I've been playing around with several YouTube WebM videos and have not experienced a crash yet with Firefox 17.0a2 2012-10-02. I'm not sure of any other websites which utilize WebM video and YouTube is probably the most common use case. It's possible this crash is tied to the specific usecase provided by Cleopatra, but I'm not sure what else to test to prove that claim.
That said, I'm not inclined to call this a Firefox 16 blocker (at least not yet). Besides, if it was a critical issue in Firefox 15.0.1, we would have heard about it earlier through our usual feedback channels.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=789075#c21)• 12 years ago |
|  | |

Not sure why I thought Andreas owned [bug 714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)")!Assignee: gal → chris.double

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=789075#c22)• 12 years ago |
|  | |

Well cleopatra does more advanced usage of the video element. We use CORS and paint it a canvas. The crash report could be explained by trying to paint the video to a canvas. Someone would have to try this and I don't have a windows environment I can ramp it without stopping my current work (dual boot).

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=789075#c23)• 12 years ago |
|  | |

(In reply to Ehsan Akhgari [:ehsan] from [comment #21](/show_bug.cgi?id=789075#c21 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> Not sure why I thought Andreas owned [bug 714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)")!
Because part 2 was committed with Gal as the owner.

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=789075#c24)• 12 years ago |
|  | |

(In reply to Benoit Girard (:BenWa) from [comment #22](/show_bug.cgi?id=789075#c22 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> The crash report could be explained by trying to paint the video to a canvas.
Is this a common usecase? Is there any known live sites which do this?
I believe Alex's ask was figuring out how prevalent this crash is in the wild (ie. how easily a common set of users might hit it in Firefox 16's release and the likelihood that we'd need to chemspill a 16.0.1 for it). QA's exploratory testing is supposed to address this immediate concern and it's not clear to me how or where we can exercise "paint video to canvas".
Any advice on this front?

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=789075#c25)• 12 years ago |
|  | |

(In reply to [comment #24](/show_bug.cgi?id=789075#c24 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Benoit Girard (:BenWa) from [comment #22](/show_bug.cgi?id=789075#c22 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > The crash report could be explained by trying to paint the video to a canvas.
>
> Is this a common usecase? Is there any known live sites which do this?
>
> I believe Alex's ask was figuring out how prevalent this crash is in the wild
> (ie. how easily a common set of users might hit it in Firefox 16's release and
> the likelihood that we'd need to chemspill a 16.0.1 for it). QA's exploratory
> testing is supposed to address this immediate concern and it's not clear to me
> how or where we can exercise "paint video to canvas".
>
> Any advice on this front?
As I've mentioned in a private email thread, I think it's best for a developer who knows this code to look into the bug as the regressing patch was not supposed to change behavior on Windows. We don't need to guess here, really.

|  | [William Lachance (:wlach)](/user_profile?user_id=420096) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=789075#c26)• 12 years ago |
|  | |

(In reply to Benoit Girard (:BenWa) from [comment #22](/show_bug.cgi?id=789075#c22 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> Well cleopatra does more advanced usage of the video element. We use CORS
> and paint it a canvas. The crash report could be explained by trying to
> paint the video to a canvas. Someone would have to try this and I don't have
> a windows environment I can ramp it without stopping my current work (dual
> boot).
I can reproduce this semi-reliably just by clicking on points on the graph on the eideticker dashboard (e.g. <http://eideticker.wrla.ch/#/lg-g2x/taskjs-scrolling/checkerboard>) and playing back the videos that appear. I don't think this is specific to CORS or the canvas, although maybe something about that triggers whatever's wrong here reliably.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=789075#c27)• 12 years ago |
|  | |

(In reply to [comment #26](/show_bug.cgi?id=789075#c26 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Benoit Girard (:BenWa) from [comment #22](/show_bug.cgi?id=789075#c22 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > Well cleopatra does more advanced usage of the video element. We use CORS
> > and paint it a canvas. The crash report could be explained by trying to
> > paint the video to a canvas. Someone would have to try this and I don't have
> > a windows environment I can ramp it without stopping my current work (dual
> > boot).
>
> I can reproduce this semi-reliably just by clicking on points on the graph on
> the eideticker dashboard (e.g.
> <http://eideticker.wrla.ch/#/lg-g2x/taskjs-scrolling/checkerboard>) and playing
> back the videos that appear. I don't think this is specific to CORS or the
> canvas, although maybe something about that triggers whatever's wrong here
> reliably.
Hmm, so maybe this is a better test case for whoever wants to investigate this bug.

|  | [Benoit Girard (:BenWa)](/user_profile?user_id=368375) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=789075#c28)• 12 years ago |
|  | |

(In reply to Ehsan Akhgari [:ehsan] from [comment #25](/show_bug.cgi?id=789075#c25 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> >
> > Any advice on this front?
>
> As I've mentioned in a private email thread, I think it's best for a
> developer who knows this code to look into the bug as the regressing patch
> was not supposed to change behavior on Windows. We don't need to guess
> here, really.
I agree here that this is the best thing to do.
Equally useful is to reduce the test case. The eideticker page is probably easier to reduce then cleopatra. If we can find the simplest HTML page that reproduces the issues then we can find the trigger and discuss how common it might be.

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=789075#c29)• 12 years ago |
|  | |

The eideticker page does not work for me, probably because the videos display "Video format or MIME type is not supported".

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=789075#c30)• 12 years ago |
|  | |

Nightly crashes for me on Win7 Nightly playing this video:
<http://eideticker.wrla.ch/videos/video-1348512228.11.webm>

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=789075#c31)• 12 years ago |
|  | |

(In reply to Chris Pearce (:cpearce) from [comment #30](/show_bug.cgi?id=789075#c30 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> Nightly crashes for me on Win7 Nightly playing this video:
> <http://eideticker.wrla.ch/videos/video-1348512228.11.webm>
Same here on Windows 7 32-bit with Firefox 17.0a2 2012-10-02.

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=789075#c32)• 12 years ago |
|  | |

(In reply to Anthony Hughes, Mozilla QA (:ashughes) from [comment #31](/show_bug.cgi?id=789075#c31 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Chris Pearce (:cpearce) from [comment #30](/show_bug.cgi?id=789075#c30 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > Nightly crashes for me on Win7 Nightly playing this video:
> > <http://eideticker.wrla.ch/videos/video-1348512228.11.webm>
>
> Same here on Windows 7 32-bit with Firefox 17.0a2 2012-10-02.
And also Firefox 15.0.1.

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=789075#c33)• 12 years ago |
|  | |

This looks like a stack smashing bug, marking security sensitive for now.Group: core-security

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=789075#c34)• 12 years ago |
|  | |

(In reply to Anthony Hughes, Mozilla QA (:ashughes) from [comment #32](/show_bug.cgi?id=789075#c32 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Anthony Hughes, Mozilla QA (:ashughes) from [comment #31](/show_bug.cgi?id=789075#c31 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > (In reply to Chris Pearce (:cpearce) from [comment #30](/show_bug.cgi?id=789075#c30 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > > Nightly crashes for me on Win7 Nightly playing this video:
> > > <http://eideticker.wrla.ch/videos/video-1348512228.11.webm>
> >
> > Same here on Windows 7 32-bit with Firefox 17.0a2 2012-10-02.
>
> And also Firefox 15.0.1.
Sounds like we're back to FF15 being affected? If so, this is not a recent regression (and obviously less critical given the lack of user outcry post-release).
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected)

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=789075#c35)• 12 years ago |
|  | |

(In reply to Anthony Hughes, Mozilla QA (:ashughes) from [comment #32](/show_bug.cgi?id=789075#c32 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Anthony Hughes, Mozilla QA (:ashughes) from [comment #31](/show_bug.cgi?id=789075#c31 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > (In reply to Chris Pearce (:cpearce) from [comment #30](/show_bug.cgi?id=789075#c30 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > > Nightly crashes for me on Win7 Nightly playing this video:
> > > <http://eideticker.wrla.ch/videos/video-1348512228.11.webm>
> >
> > Same here on Windows 7 32-bit with Firefox 17.0a2 2012-10-02.
>
> And also Firefox 15.0.1.
On this testcase I crash in nightly 2012-05-31-03-05-17 but not in 2012-05-30-13-20-0, which matches the regression range reported above.
I'll build Gal's changeset (85a3f4b90adc) to get a stack to confirm it's the same crash, and not one of the other YCbCr->RGB bugs we've fixed recently.

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=789075#c36)• 12 years ago |
|  | |

I've gotten better call stacks, right before we crash.
We crash when the decoder state machine thread releases a video frame:
xul.dll!mozilla::layers::Image::Release() Line 66 + 0x4f bytes C++
xul.dll!VideoData::~VideoData() Line 137 + 0x10 bytes C++
xul.dll!nsAutoPtr<VideoData>::assign(VideoData \* newPtr) Line 38 + 0xb bytes C++
xul.dll!nsBuiltinDecoderStateMachine::AdvanceFrame() Line 2230 C++
xul.dll!nsBuiltinDecoderStateMachine::RunStateMachine() Line 2027 C++
xul.dll!nsBuiltinDecoderStateMachine::CallRunStateMachine() Line 2487 C++
xul.dll!nsBuiltinDecoderStateMachine::TimeoutExpired() Line 2518 C++
xul.dll!nsTimerImpl::Fire() Line 473 + 0x6 bytes C++
xul.dll!nsTimerEvent::Run() Line 558 C++
xul.dll!nsThread::ProcessNextEvent(bool mayWait, bool \* result) Line 612 + 0xe bytes C++
xul.dll!NS\_ProcessNextEvent\_P(nsIThread \* thread, bool mayWait) Line 220 + 0xd bytes C++
...while the main thread is still trying to use that image:
xul.dll!mozilla::layers::ImageContainer::LockCurrentAsSurface(nsIntSize \* aSize, mozilla::layers::Image \* \* aCurrentImage) Line 287 + 0x12 bytes C++
xul.dll!mozilla::layers::AutoLockImage::AutoLockImage(mozilla::layers::ImageContainer \* aContainer, gfxASurface \* \* aSurface) Line 560 + 0x1b bytes C++
xul.dll!mozilla::layers::BasicImageLayer::GetAndPaintCurrentImage(gfxContext \* aContext, float aOpacity, mozilla::layers::Layer \* aMaskLayer) Line 88 C++
xul.dll!mozilla::layers::BasicImageLayer::Paint(gfxContext \* aContext, mozilla::layers::Layer \* aMaskLayer) Line 73 + 0x22 bytes C++
xul.dll!mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext & aPaintContext, gfxContext \* aGroupTarget) Line 829 C++
xul.dll!mozilla::layers::BasicLayerManager::PaintLayer(gfxContext \* aTarget, mozilla::layers::Layer \* aLayer, void (mozilla::layers::ThebesLayer \*, gfxContext \*, const nsIntRegion &, const nsIntRegion &, void \*)\* aCallback, void \* aCallbackData, mozilla::layers::ReadbackProcessor \* aReadback) Line 946 C++
xul.dll!mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext & aPaintContext, gfxContext \* aGroupTarget) Line 841 C++
xul.dll!mozilla::layers::BasicLayerManager::PaintLayer(gfxContext \* aTarget, mozilla::layers::Layer \* aLayer, void (mozilla::layers::ThebesLayer \*, gfxContext \*, const nsIntRegion &, const nsIntRegion &, void \*)\* aCallback, void \* aCallbackData, mozilla::layers::ReadbackProcessor \* aReadback) Line 946 C++
xul.dll!mozilla::layers::BasicLayerManager::EndTransactionInternal(void (mozilla::layers::ThebesLayer \*, gfxContext \*, const nsIntRegion &, const nsIntRegion &, void \*)\* aCallback, void \* aCallbackData, mozilla::layers::LayerManager::EndTransactionFlags aFlags) Line 589 C++
xul.dll!nsDisplayList::PaintForFrame(nsDisplayListBuilder \* aBuilder, nsRenderingContext \* aCtx, nsIFrame \* aForFrame, unsigned int aFlags) Line 1069 C++
xul.dll!nsDisplayList::PaintRoot(nsDisplayListBuilder \* aBuilder, nsRenderingContext \* aCtx, unsigned int aFlags) Line 957 C++
xul.dll!nsLayoutUtils::PaintFrame(nsRenderingContext \* aRenderingContext, nsIFrame \* aFrame, const nsRegion & aDirtyRegion, unsigned int aBackstop, unsigned int aFlags) Line 1749 C++
xul.dll!PresShell::RenderDocument(const nsRect & aRect, unsigned int aFlags, unsigned int aBackgroundColor, gfxContext \* aThebesContext) Line 4361 + 0x20 bytes C++
xul.dll!nsCanvasRenderingContext2DAzure::DrawWindow(nsIDOMWindow \* window, double x, double y, double w, double h, const nsAString\_internal & bgColor, unsigned int flags, mozilla::ErrorResult & error) Line 3980 C++
xul.dll!mozilla::dom::CanvasRenderingContext2DBinding::drawWindow(JSContext \* cx, JS::Handle<JSObject \*> obj, nsCanvasRenderingContext2DAzure \* self, unsigned int argc, JS::Value \* vp) Line 1876 C++
xul.dll!mozilla::dom::CanvasRenderingContext2DBinding::genericMethod(JSContext \* cx, unsigned int argc, JS::Value \* vp) Line 2577 + 0x14 bytes C++
mozjs.dll!js::CallJSNative(JSContext \* cx, int (JSContext \*, unsigned int, JS::Value \*)\* native, const JS::CallArgs & args) Line 370 + 0xf bytes C++
mozjs.dll!js::InvokeKernel(JSContext \* cx, JS::CallArgs args, js::MaybeConstruct construct) Line 367 + 0x15 bytes C++
mozjs.dll!js::Interpret(JSContext \* cx, js::StackFrame \* entryFrame, js::InterpMode interpMode) Line 2458 + 0x27 bytes C++
mozjs.dll!js::RunScript(JSContext \* cx, JS::Handle<JSScript \*> script, js::StackFrame \* fp) Line 324 + 0x7 bytes C++
mozjs.dll!js::InvokeKernel(JSContext \* cx, JS::CallArgs args, js::MaybeConstruct construct) Line 381 C++
mozjs.dll!js::Invoke(JSContext \* cx, const JS::Value & thisv, const JS::Value & fval, unsigned int argc, JS::Value \* argv, JS::Value \* rval) Line 411 + 0x21 bytes C++
mozjs.dll!js::IndirectProxyHandler::call(JSContext \* cx, JSObject \* proxy, unsigned int argc, JS::Value \* vp) Line 450 + 0x3b bytes C++
mozjs.dll!js::CrossCompartmentWrapper::call(JSContext \* cx, JSObject \* wrapper\_, unsigned int argc, JS::Value \* vp) Line 722 + 0x12 bytes C++
mozjs.dll!proxy\_Call(JSContext \* cx, unsigned int argc, JS::Value \* vp) Line 2999 + 0x23 bytes C++
mozjs.dll!js::CallJSNative(JSContext \* cx, int (JSContext \*, unsigned int, JS::Value \*)\* native, const JS::CallArgs & args) Line 370 + 0xf bytes C++
mozjs.dll!js::InvokeKernel(JSContext \* cx, JS::CallArgs args, js::MaybeConstruct construct) Line 360 + 0xb bytes C++
mozjs.dll!js::Interpret(JSContext \* cx, js::StackFrame \* entryFrame, js::InterpMode interpMode) Line 2458 + 0x27 bytes C++
mozjs.dll!js::RunScript(JSContext \* cx, JS::Handle<JSScript \*> script, js::StackFrame \* fp) Line 324 + 0x7 bytes C++
mozjs.dll!js::InvokeKernel(JSContext \* cx, JS::CallArgs args, js::MaybeConstruct construct) Line 381 C++
mozjs.dll!js::CallOrConstructBoundFunction(JSContext \* cx, unsigned int argc, JS::Value \* vp) Line 1086 + 0x25 bytes C++
mozjs.dll!js::CallJSNative(JSContext \* cx, int (JSContext \*, unsigned int, JS::Value \*)\* native, const JS::CallArgs & args) Line 370 + 0xf bytes C++
mozjs.dll!js::InvokeKernel(JSContext \* cx, JS::CallArgs args, js::MaybeConstruct construct) Line 367 + 0x15 bytes C++
mozjs.dll!js::Invoke(JSContext \* cx, const JS::Value & thisv, const JS::Value & fval, unsigned int argc, JS::Value \* argv, JS::Value \* rval) Line 411 + 0x21 bytes C++
mozjs.dll!JS\_CallFunctionValue(JSContext \* cx, JSObject \* objArg, JS::Value fval, unsigned int argc, JS::Value \* argv, JS::Value \* rval) Line 5860 + 0x24 bytes C++
xul.dll!nsJSContext::CallEventHandler(nsISupports \* aTarget, JSObject \* aScope, JSObject \* aHandler, nsIArray \* aargv, nsIVariant \* \* arv) Line 1908 + 0x2e bytes C++
xul.dll!nsGlobalWindow::RunTimeoutHandler(nsTimeout \* aTimeout, nsIScriptContext \* aScx) Line 9630 + 0x49 bytes C++
xul.dll!nsGlobalWindow::RunTimeout(nsTimeout \* aTimeout) Line 9881 C++
xul.dll!nsGlobalWindow::TimerCallback(nsITimer \* aTimer, void \* aClosure) Line 10147 C++
xul.dll!nsTimerImpl::Fire() Line 473 + 0x6 bytes C++
xul.dll!nsTimerEvent::Run() Line 558 C++
xul.dll!nsThread::ProcessNextEvent(bool mayWait, bool \* result) Line 612 + 0xe bytes C++
xul.dll!NS\_ProcessNextEvent\_P(nsIThread \* thread, bool mayWait) Line 220 + 0xd bytes C++

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=789075#c37)• 12 years ago |
|  | |

Back to wontfix for FF16, since this bug is not a regression from FF15 and wasn't a critical issue for our users over the last cycle.
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=789075#c38)• 12 years ago |
|  | |

I think this has been broken for longer than the regression range suggests, and the changes in the suspected patch changed the allocation patterns/memory layout enough to resurface the crash. That would explain the much earlier crashes in this code we've seen in [bug 672870](/show_bug.cgi?id=672870 "RESOLVED WORKSFORME - Firefox Crash [@ FastConvertYUVToRGB32Row_SSE ]") and [bug 750190](/show_bug.cgi?id=750190 "RESOLVED DUPLICATE - crash in FastConvertYUVToRGB32Row_SSE").
In the row processing loop in ConvertYCbCrToRGB32, when y == 588, v\_ptr points at the end of the fused buffer allocation containing the Y, U, and V planes. Depending on memory layout, we get either a silent failure or a read fault when FastConvertYUVToRGB32Row\_SSE accesses v\_ptr.
u\_ptr and v\_ptr are calculated by halving y, so when y is 588, the u/v index is 294 for a buffer with valid indices in the range 0..293.

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=789075#c39)• 12 years ago |
|  | |

reproducible on WinXP, Windows 7 and OSX with <http://eideticker.wrla.ch/videos/video-1348512228.11.webm>OS: Windows 7 → AllHardware: x86 → All

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=789075#c40)• 12 years ago |
|  | |

Reassigning.Assignee: chris.double → kinetik

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a2440197_274575)• 12 years ago |

Status: NEW → ASSIGNED

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=789075#c41)• 12 years ago |
|  | |

Attached patch

[patch v0](attachment.cgi?id=669013&action=diff) (obsolete)
— [Details](attachment.cgi?id=669013&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=669013)

It looks like we've been handling odd sized WebM videos incorrectly since inception (see [bug 566245 comment 8](/show_bug.cgi?id=566245#c8 "RESOLVED FIXED - Merge nsWebM decoder to mozilla-central")). The current decoder examples show the correct way to do this (round up, not down), but they were only updated in late 2011: <http://git.chromium.org/gitweb/?p=webm/libvpx.git;a=commitdiff;h=6aea309a93d31d775642c6d2b66bc51db6adcbea>
Attached patch is Valgrind-clean (except for [bug 798989](/show_bug.cgi?id=798989 "NEW - Uninitialised value use in gfxUtils::GetYCbCrToRGBDestFormatAndSize (aSuggestedFormat)")) on x86\_64 playing <http://eideticker.wrla.ch/videos/video-1348512228.11.webm> and a single white 9x5 frame video I'll add a crashtest for. Try push: <https://tbpl.mozilla.org/?tree=Try&rev=02e39ed967db>
This \*should\* explain the bulk of the crashes in this code going back to Firefox 13 or so--if I understand correctly, we started copying the frames into our own buffer rather than converting them directly out of the libvpx frame buffer in [bug 715785](/show_bug.cgi?id=715785 "RESOLVED FIXED - Make ImageContainers independent of LayerManagers"). Prior to that, we used the incorrectly calculated Cb/Cr dimensions but read memory that libvpx had intended us to read anyway.
Disappointingly, this doesn't explain [bug 672870](/show_bug.cgi?id=672870 "RESOLVED WORKSFORME - Firefox Crash [@ FastConvertYUVToRGB32Row_SSE ]") nor [bug 750190](/show_bug.cgi?id=750190 "RESOLVED DUPLICATE - crash in FastConvertYUVToRGB32Row_SSE"), neither of which I can reproduce in a current nightly.
[Attachment #669013](/attachment.cgi?id=669013&action=edit "patch v0") -
Flags: review?

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a2728753_274575)• 12 years ago |

[Attachment #669013](/attachment.cgi?id=669013&action=edit "patch v0") -
Flags: review? → review?(tterribe)

|  | [Timothy B. Terriberry (:derf)](/user_profile?user_id=12273) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=789075#c42)• 12 years ago |
|  | |

Comment on [attachment 669013](/attachment.cgi?id=669013 "patch v0") [[details]](/attachment.cgi?id=669013&action=edit "patch v0") [[diff]](/attachment.cgi?id=669013&action=diff "patch v0") [[review]](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=669013)
patch v0
Review of [attachment 669013](/attachment.cgi?id=669013 "patch v0") [[details]](/attachment.cgi?id=669013&action=edit "patch v0") [[diff]](/attachment.cgi?id=669013&action=diff "patch v0") [[review]](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=669013):
-----------------------------------------------------------------
Should we add some ASSERTs to the code that does the copying to guarantee things like this aren't happening elsewhere?
[Attachment #669013](/attachment.cgi?id=669013&action=edit "patch v0") -
Flags: review?(tterribe) → review+

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=789075#c43)• 12 years ago |
|  | |

I added an assert and a crashtest. The crashtest only fails 1/10 times on Linux (despite trying to engineer a file that would cause this as often as possible), but it'll fail every time on Windows. With the assert in place, it fails on that, and with the fix in place the test passes.
<https://hg.mozilla.org/integration/mozilla-inbound/rev/9fd563bfcf50>

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=789075#c44)• 12 years ago |
|  | |

It's not clear if this bug needs to be core-security, but there is some exposure: some of the heap following the video frame allocation may leak into the decoded (RGB) video frame via the Cr channel. Whether it'd still be useful after colour conversion and quantization, I'm not sure.Target Milestone: --- → mozilla19

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=789075#c45)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/9fd563bfcf50>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=789075#c46)• 12 years ago |
|  | |

Please nominate for uplift with a risk assessment to help determine if we can take this on branches.

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=789075#c47)• 12 years ago |
|  | |

Attached patch

[patch v1](attachment.cgi?id=672098&action=diff)
— [Details](attachment.cgi?id=672098&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=672098)

This is what I checked in, which is patch v0 plus the crashtest and assertion.
[Attachment #669013](/attachment.cgi?id=669013&action=edit "patch v0") -
Attachment is obsolete: true

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=789075#c48)• 12 years ago |
|  | |

Comment on [attachment 672098](/attachment.cgi?id=672098 "patch v1") [[details]](/attachment.cgi?id=672098&action=edit "patch v1") [[diff]](/attachment.cgi?id=672098&action=diff "patch v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=672098)
patch v1
[Approval Request Comment]
Bug caused by (feature/regressing bug #): bug has existed since the feature was added in [bug 566245](/show_bug.cgi?id=566245 "RESOLVED FIXED - Merge nsWebM decoder to mozilla-central"), but I believe the out-of-bounds reads only started when the buffer copy was changed in [bug 715785](/show_bug.cgi?id=715785 "RESOLVED FIXED - Make ImageContainers independent of LayerManagers")
User impact if declined: playing odd-sized WebM videos may crash browser, possible heap info/security leak
Testing completed (on m-c, etc.): tested locally, landed on m-c, crashtest and assertion include
Risk to taking this patch (and alternatives if risky): low, highest risk is that assertion results in additional crashes (but, if so, it has converted the potential info/security leak into a safe crash)
String or UUID changes made by this patch: none
[Attachment #672098](/attachment.cgi?id=672098&action=edit "patch v1") -
Flags: approval-mozilla-beta?
[Attachment #672098](/attachment.cgi?id=672098&action=edit "patch v1") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=789075#c49)• 12 years ago |
|  | |

Comment on [attachment 672098](/attachment.cgi?id=672098 "patch v1") [[details]](/attachment.cgi?id=672098&action=edit "patch v1") [[diff]](/attachment.cgi?id=672098&action=diff "patch v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=789075&attachment=672098)
patch v1
Thank you, please go ahead with uplift.
[Attachment #672098](/attachment.cgi?id=672098&action=edit "patch v1") -
Flags: approval-mozilla-beta?
[Attachment #672098](/attachment.cgi?id=672098&action=edit "patch v1") -
Flags: approval-mozilla-beta+
[Attachment #672098](/attachment.cgi?id=672098&action=edit "patch v1") -
Flags: approval-mozilla-aurora?
[Attachment #672098](/attachment.cgi?id=672098&action=edit "patch v1") -
Flags: approval-mozilla-aurora+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=789075#c50)• 12 years ago |
|  | |

Adding Qawanted: once this lands on Beta we should get some testing on differently sized WebM videos to see if any crashes can be reproduced and to confirm whether they are indeed now safe.Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---),
[verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=789075#c51)• 12 years ago |
|  | |

When testing, please make sure you test with HW acceleration disabled so that this code is used for all playback, otherwise you'll hit the HWA path mostly and this code will only run when the tab thumbnails are generated once a second or so.
<https://hg.mozilla.org/releases/mozilla-aurora/rev/d6dae702f67e>
<https://hg.mozilla.org/releases/mozilla-beta/rev/fe7f775dc2d7>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=789075#c52)• 12 years ago |
|  | |

Juan, can you please do some testing with this tomorrow in the 17.0b2 candidate builds?Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)

|  | [William Lachance (:wlach)](/user_profile?user_id=420096) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=789075#c53)• 12 years ago |
|  | |

I'm seeing hangs on my copy of firefox aurora with the videos chris lord posted today on his blog:
<http://chrislord.net/blog/Software/Mozilla/progressive-tile-rendering.enlighten>
Might make a good alternate test case.

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=789075#c54)• 12 years ago |
|  | |

Hangs without a crash could be [bug 791344](/show_bug.cgi?id=791344 "RESOLVED FIXED - Browser freeze, allocates all memory when viewing a particular type of video with a particular build."); the testcases in this bug tended to trigger that bug as well. I'll nominate the patch in that bug for uplift too.

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=789075#c55)• 12 years ago |
|  | |

Actually, [bug 791344](/show_bug.cgi?id=791344 "RESOLVED FIXED - Browser freeze, allocates all memory when viewing a particular type of video with a particular build.") is on aurora already, so ignore my previous comment. You could hit that issue on beta, so I've nominated the patch for uplift to beta to aid QA.

|  | [Chris Lord [:cwiiis]](/user_profile?user_id=194366)  Reporter |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=789075#c56)• 12 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #14](/show_bug.cgi?id=789075#c14 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> (In reply to Ehsan Akhgari [:ehsan] from [comment #12](/show_bug.cgi?id=789075#c12 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"))
> > This is a serious regression in web content. I'm pretty disappointed that
> > we let this slide for so long. It might be already too late for 16 Beta,
> > but we should definitely get this fixed in 17 at least.
>
> FF15 is marked as affected, but we haven't heard about this in the wild. Why
> are you concerned about this issue specifically?
Is my blog in-the-wild enough to consider fixing this in 16? (I accidentally came across this, I exclusively use Nightly and so didn't notice)

|  | [juan becerra [:juanb]](/user_profile?user_id=241759) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=789075#c57)• 12 years ago |
|  | |

Verified on Nightly and Aurora. The fix on Beta didn't make it before the 17b2 was cut, so beta 2 is still crashing using the examples in [comment #19](/show_bug.cgi?id=789075#c19 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool") and [comment #39](/show_bug.cgi?id=789075#c39 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool") taking into account [comment #51](/show_bug.cgi?id=789075#c51 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool"). We'll verify on Beta 3 candidates next week.
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=verified)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=789075#c58)• 12 years ago |
|  | |

Is [bug 714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)") the regressing bug, or merely tickling the security issue? Want to find out if we can/should take a fix for the ESR10 branch.
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=%3F)

|  | [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)  Assignee |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=789075#c59)• 12 years ago |
|  | |

I'm reasonably sure this can only be hit since [bug 714408](/show_bug.cgi?id=714408 "RESOLVED FIXED - support for hardware-accelerated audio/video decoding (part 1: libstagefright/OMX support for Gonk)").

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a4260106_425645)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=-)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a4866498_280903)• 12 years ago |

Whiteboard: [adv-track-main17+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a16690939_1689)• 12 years ago |

Group: core-security

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=789075#c60)• 11 years ago |
|  | |

mass remove verifyme requests greater than 4 months oldKeywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Jerry Shih[:jerry] (UTC+8) (inactive)](/user_profile?user_id=473405) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=789075#a149883616_473405)• 8 years ago |

Blocks: [1370838](/show_bug.cgi?id=1370838 "RESOLVED FIXED - Update dom/media/test/crashtests/789075-1.html crashtest")
You need to [log in](/show_bug.cgi?id=789075&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Matthew Gregan [:kinetik]](/user_profile?user_id=274575)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.opensuse.org_f03c6df3_20250124_140948.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU/#ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU)

# openSUSE-SU-2012:1583-1: moderate: update for MozillaFirefox

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

28 Nov
2012

28 Nov
'12

16:08

openSUSE Security Update: update for MozillaFirefox
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2012:1583-1
Rating: moderate
References: #790140
Cross-References: CVE-2012-4201 CVE-2012-4202 CVE-2012-4203
CVE-2012-4204 CVE-2012-4205 CVE-2012-4207
CVE-2012-4208 CVE-2012-4209 CVE-2012-4210
CVE-2012-4212 CVE-2012-4213 CVE-2012-4214
CVE-2012-4215 CVE-2012-4216 CVE-2012-4217
CVE-2012-4218 CVE-2012-5829 CVE-2012-5830
CVE-2012-5833 CVE-2012-5835 CVE-2012-5836
CVE-2012-5837 CVE-2012-5838 CVE-2012-5839
CVE-2012-5840 CVE-2012-5841 CVE-2012-5842
CVE-2012-5843
Affected Products:
openSUSE 12.2
openSUSE 12.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 28 vulnerabilities is now available.
Description:
Changes in MozillaFirefox:
- update to Firefox 17.0 (bnc#790140)
\* MFSA 2012-91/CVE-2012-5842/CVE-2012-5843 Miscellaneous
memory safety hazards
\* MFSA 2012-92/CVE-2012-4202 (bmo#758200) Buffer overflow
while rendering GIF images
\* MFSA 2012-93/CVE-2012-4201 (bmo#747607) evalInSanbox
location context incorrectly applied
\* MFSA 2012-94/CVE-2012-5836 (bmo#792857) Crash when
combining SVG text on path with CSS
\* MFSA 2012-95/CVE-2012-4203 (bmo#765628) Javascript:
URLs run in privileged context on New Tab page
\* MFSA 2012-96/CVE-2012-4204 (bmo#778603) Memory
corruption in str\_unescape
\* MFSA 2012-97/CVE-2012-4205 (bmo#779821) XMLHttpRequest
inherits incorrect principal within sandbox
\* MFSA 2012-99/CVE-2012-4208 (bmo#798264) XrayWrappers
exposes chrome-only properties when not in chrome
compartment
\* MFSA 2012-100/CVE-2012-5841 (bmo#805807) Improper
security filtering for cross-origin wrappers
\* MFSA 2012-101/CVE-2012-4207 (bmo#801681) Improper
character decoding in HZ-GB-2312 charset
\* MFSA 2012-102/CVE-2012-5837 (bmo#800363) Script entered
into Developer Toolbar runs with chrome privileges
\* MFSA 2012-103/CVE-2012-4209 (bmo#792405) Frames can
shadow top.location
\* MFSA 2012-104/CVE-2012-4210 (bmo#796866) CSS and HTML
injection through Style Inspector
\* MFSA
2012-105/CVE-2012-4214/CVE-2012-4215/CVE-2012-4216/
CVE-2012-5829/CVE-2012-5839/CVE-2012-5840/CVE-2012-4212/ CVE
-2012-4213/CVE-2012-4217/CVE-2012-4218 Use-after-free
and buffer overflow issues found using Address Sanitizer
\* MFSA
2012-106/CVE-2012-5830/CVE-2012-5833/CVE-2012-5835/CVE-2012-
5838 Use-after-free, buffer overflow, and memory
corruption issues found using Address Sanitizer
- rebased patches
- disabled WebRTC since build is broken (bmo#776877)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.2:
zypper in -t patch openSUSE-2012-817
- openSUSE 12.1:
zypper in -t patch openSUSE-2012-817
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.2 (i586 x86\_64):
MozillaFirefox-17.0-2.25.1
MozillaFirefox-branding-upstream-17.0-2.25.1
MozillaFirefox-buildsymbols-17.0-2.25.1
MozillaFirefox-debuginfo-17.0-2.25.1
MozillaFirefox-debugsource-17.0-2.25.1
MozillaFirefox-devel-17.0-2.25.1
MozillaFirefox-translations-common-17.0-2.25.1
MozillaFirefox-translations-other-17.0-2.25.1
- openSUSE 12.1 (i586 x86\_64):
MozillaFirefox-17.0-2.54.1
MozillaFirefox-branding-upstream-17.0-2.54.1
MozillaFirefox-buildsymbols-17.0-2.54.1
MozillaFirefox-debuginfo-17.0-2.54.1
MozillaFirefox-debugsource-17.0-2.54.1
MozillaFirefox-devel-17.0-2.54.1
MozillaFirefox-translations-common-17.0-2.54.1
MozillaFirefox-translations-other-17.0-2.54.1
References:
<http://support.novell.com/security/cve/CVE-2012-4201.html>
<http://support.novell.com/security/cve/CVE-2012-4202.html>
<http://support.novell.com/security/cve/CVE-2012-4203.html>
<http://support.novell.com/security/cve/CVE-2012-4204.html>
<http://support.novell.com/security/cve/CVE-2012-4205.html>
<http://support.novell.com/security/cve/CVE-2012-4207.html>
<http://support.novell.com/security/cve/CVE-2012-4208.html>
<http://support.novell.com/security/cve/CVE-2012-4209.html>
<http://support.novell.com/security/cve/CVE-2012-4210.html>
<http://support.novell.com/security/cve/CVE-2012-4212.html>
<http://support.novell.com/security/cve/CVE-2012-4213.html>
<http://support.novell.com/security/cve/CVE-2012-4214.html>
<http://support.novell.com/security/cve/CVE-2012-4215.html>
<http://support.novell.com/security/cve/CVE-2012-4216.html>
<http://support.novell.com/security/cve/CVE-2012-4217.html>
<http://support.novell.com/security/cve/CVE-2012-4218.html>
<http://support.novell.com/security/cve/CVE-2012-5829.html>
<http://support.novell.com/security/cve/CVE-2012-5830.html>
<http://support.novell.com/security/cve/CVE-2012-5833.html>
<http://support.novell.com/security/cve/CVE-2012-5835.html>
<http://support.novell.com/security/cve/CVE-2012-5836.html>
<http://support.novell.com/security/cve/CVE-2012-5837.html>
<http://support.novell.com/security/cve/CVE-2012-5838.html>
<http://support.novell.com/security/cve/CVE-2012-5839.html>
<http://support.novell.com/security/cve/CVE-2012-5840.html>
<http://support.novell.com/security/cve/CVE-2012-5841.html>
<http://support.novell.com/security/cve/CVE-2012-5842.html>
<http://support.novell.com/security/cve/CVE-2012-5843.html>
<https://bugzilla.novell.com/790140>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU/#ZGTA7E4E26F2D2LFVISKZ2LCZLWDRYPU)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.ubuntu.com_0de38da6_20250124_140954.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1636-1: Thunderbird vulnerabilities

21 November 2012

Multiple security issues were fixed in Thunderbird.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 11.10](/security/notices?release=oneiric)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [thunderbird](/security/cves?package=thunderbird) - Mozilla Open Source mail and newsgroup client

## Details

Gary Kwong, Jesse Ruderman, Christian Holler, Bob Clary, Kyle Huey, Ed

Morley, Chris Lord, Boris Zbarsky, Julian Seward, Bill McCloskey, and

Andrew McCreight discovered several memory corruption flaws in Thunderbird.

If a user were tricked into opening a malicious website and had JavaScript

enabled, an attacker could exploit these to execute arbitrary JavaScript

code within the context of another website or arbitrary code as the user

invoking the program. ([CVE-2012-5842](/security/CVE-2012-5842), [CVE-2012-5843](/security/CVE-2012-5843))

Atte Kettunen discovered a buffer overflow while rendering GIF format

images. An attacker could exploit this to possibly execute arbitrary code

as the user invoking Thunderbird. ([CVE-2012-4202](/security/CVE-2012-4202))

It was discovered that the evalInSandbox function's JavaScript sandbox

context could be circumvented. An attacker could exploit this to perform a

cross-site scripting (XSS) attack or steal a copy of a local file if the

user has installed an add-on vulnerable to this attack. With cross-site

scripting vulnerabilities, if a user were tricked into viewing a specially

crafted page and had JavaScript enabled, a remote attacker could exploit

this to modify the contents, or steal confidential data, within the same

domain. ([CVE-2012-4201](/security/CVE-2012-4201))

Jonathan Stephens discovered that combining vectors involving the setting

of Cascading Style Sheets (CSS) properties in conjunction with SVG text

could cause Thunderbird to crash. If a user were tricked into opening a

malicious E-Mail, an attacker could cause a denial of service via

application crash or execute arbitrary code with the privliges of the user

invoking the program. ([CVE-2012-5836](/security/CVE-2012-5836))

Scott Bell discovered a memory corruption issue in the JavaScript engine.

If a user were tricked into opening a malicious website and had JavaScript

enabled, an attacker could exploit this to execute arbitrary JavaScript

code within the context of another website or arbitrary code as the user

invoking the program. ([CVE-2012-4204](/security/CVE-2012-4204))

Gabor Krizsanits discovered that XMLHttpRequest objects created within

sandboxes have the system principal instead of the sandbox principal. This

can lead to cross-site request forgery (CSRF) or information theft via an

add-on running untrusted code in a sandbox. ([CVE-2012-4205](/security/CVE-2012-4205))

Peter Van der Beken discovered XrayWrapper implementation in Firefox does

not consider the compartment during property filtering. If JavaScript were

enabled, an attacker could use this to bypass intended chrome-only

restrictions on reading DOM object properties via a crafted web site.

([CVE-2012-4208](/security/CVE-2012-4208))

Bobby Holley discovered that cross-origin wrappers were allowing write

actions on objects when only read actions should have been properly

allowed. This can lead to cross-site scripting (XSS) attacks. With

cross-site scripting vulnerabilities, if a user were tricked into viewing a

specially crafted page and had JavaScript enabled, a remote attacker could

exploit this to modify the contents, or steal confidential data, within

the same domain. ([CVE-2012-5841](/security/CVE-2012-5841))

Masato Kinugawa discovered that when HZ-GB-2312 charset encoding is used

for text, the "~" character will destroy another character near the chunk

delimiter. This can lead to a cross-site scripting (XSS) attack in pages

encoded in HZ-GB-2312. With cross-site scripting vulnerabilities, if a user

were tricked into viewing a specially crafted page and had JavaScript

enabled, a remote attacker could exploit these to modify the contents, or

steal confidential data, within the same domain. ([CVE-2012-4207](/security/CVE-2012-4207))

Mariusz Mlynski discovered that the location property can be accessed by

binary plugins through top.location with a frame whose name attribute's

value is set to "top". This can allow for possible cross-site scripting

(XSS) attacks through plugins. With cross-site scripting vulnerabilities,

if a user were tricked into viewing a specially crafted page and had

JavaScript enabled, a remote attacker could exploit this to modify the

contents, or steal confidential data, within the same domain.

([CVE-2012-4209](/security/CVE-2012-4209))

Abhishek Arya discovered multiple use-after-free and buffer overflow issues

in Thunderbird. If a user were tricked into opening a malicious website and

had JavaScript enabled, an attacker could exploit these to execute

arbitrary JavaScript code within the context of another website or

arbitrary code as the user invoking the program. ([CVE-2012-4214](/security/CVE-2012-4214),

[CVE-2012-4215](/security/CVE-2012-4215), [CVE-2012-4216](/security/CVE-2012-4216), [CVE-2012-5829](/security/CVE-2012-5829), [CVE-2012-5839](/security/CVE-2012-5839), [CVE-2012-5840](/security/CVE-2012-5840),

[CVE-2012-4212](/security/CVE-2012-4212), [CVE-2012-4213](/security/CVE-2012-4213), [CVE-2012-4217](/security/CVE-2012-4217), [CVE-2012-4218](/security/CVE-2012-4218))

Several memory corruption flaws were discovered in Thunderbird. If a user

were tricked into opening a malicious website and had JavaScript enabled,

an attacker could exploit these to execute arbitrary JavaScript code within

the context of another website or arbitrary code as the user invoking the

program. ([CVE-2012-5830](/security/CVE-2012-5830), [CVE-2012-5833](/security/CVE-2012-5833), [CVE-2012-5835](/security/CVE-2012-5835), [CVE-2012-5838](/security/CVE-2012-5838))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.10

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [17.0+build2-0ubuntu0.12.10.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/17.0%2Bbuild2-0ubuntu0.12.10.1)

##### Ubuntu 12.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [17.0+build2-0ubuntu0.12.04.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/17.0%2Bbuild2-0ubuntu0.12.04.1)

##### Ubuntu 11.10

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [17.0+build2-0ubuntu0.11.10.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/17.0%2Bbuild2-0ubuntu0.11.10.1)

##### Ubuntu 10.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [17.0+build2-0ubuntu0.10.04.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/17.0%2Bbuild2-0ubuntu0.10.04.1)

After a standard system update you need to restart Thunderbird to make all

the necessary changes.

## References

* [CVE-2012-5842](/security/CVE-2012-5842)
* [CVE-2012-5843](/security/CVE-2012-5843)
* [CVE-2012-4202](/security/CVE-2012-4202)
* [CVE-2012-4201](/security/CVE-2012-4201)
* [CVE-2012-5836](/security/CVE-2012-5836)
* [CVE-2012-4204](/security/CVE-2012-4204)
* [CVE-2012-4205](/security/CVE-2012-4205)
* [CVE-2012-4208](/security/CVE-2012-4208)
* [CVE-2012-5841](/security/CVE-2012-5841)
* [CVE-2012-4207](/security/CVE-2012-4207)
* [CVE-2012-4209](/security/CVE-2012-4209)
* [CVE-2012-4214](/security/CVE-2012-4214)
* [CVE-2012-4215](/security/CVE-2012-4215)
* [CVE-2012-4216](/security/CVE-2012-4216)
* [CVE-2012-5829](/security/CVE-2012-5829)
* [CVE-2012-5839](/security/CVE-2012-5839)
* [CVE-2012-5840](/security/CVE-2012-5840)
* [CVE-2012-4212](/security/CVE-2012-4212)
* [CVE-2012-4213](/security/CVE-2012-4213)
* [CVE-2012-4217](/security/CVE-2012-4217)
* [CVE-2012-4218](/security/CVE-2012-4218)
* [CVE-2012-5830](/security/CVE-2012-5830)
* [CVE-2012-5833](/security/CVE-2012-5833)
* [CVE-2012-5835](/security/CVE-2012-5835)
* [CVE-2012-5838](/security/CVE-2012-5838)
* <https://launchpad.net/bugs/1080212>

## Related notices

* [USN-1638-1](/security/notices/USN-1638-1)
* [USN-1681-2](/security/notices/USN-1681-2)
* [USN-1681-1](/security/notices/USN-1681-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugzilla.mozilla.org_cd7236e9_20250124_141013.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/795281)
* [XML](/show_bug.cgi?ctype=xml&id=795281)

Closed
[Bug 795281](/show_bug.cgi?id=795281)

Opened 12 years ago
Closed 12 years ago

# Read after free in nsXPCWrappedJS::Release()

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Read after free in nsXPCWrappedJS::Release()

## Categories

### (Toolkit :: Safe Browsing, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Safe%20Browsing#Safe%20Browsing)

Safe Browsing
▾

Toolkit :: Safe Browsing
Safe Browsing UI and service (includes phishing protection).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Safe%20Browsing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

ARM

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 19

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) |
| firefox19 | [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | + | fixed |
| firefox18 | + | fixed |
| firefox19 | + | fixed |
| firefox-esr10 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jseward, Assigned: gcp)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/6ad7e6f8a605ca81446ea4c83d819fb2?d=mm&size=40)  [gcp](/user_profile?user_id=151147)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5edb95922c89f29d92b7febcba5669de?d=mm&size=40)  [jseward](/user_profile?user_id=346453)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/bd10912fd8637cc64f00edd465ca8b0d?d=mm&size=40)  [dimi](/user_profile?user_id=468232)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[808146](/show_bug.cgi?id=808146 "RESOLVED FIXED - nsProxyRelease.h:156:356: warning: deleting object of polymorphic class type ‘nsMainThreadPtrHolder<nsIUrlClassifierLookupCallback>’ which has non-virtual destructor might cause undefined behaviour [-Wdelete-non-virtual-dtor]")

Dependency [tree](/showdependencytree.cgi?id=795281&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=795281)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[727947](/show_bug.cgi?id=727947 "RESOLVED DUPLICATE - Use-after-free after browser freeze"), [750988](/show_bug.cgi?id=750988 "RESOLVED DUPLICATE - ASAN: Several xpcshell tests in url-classifier triggers error")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, sec-moderate, valgrind, Whiteboard: [adv-track-main17-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[valgrind](/buglist.cgi?keywords=valgrind&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [Patch 1. Make sure AddRef happens on the main thread.](/attachment.cgi?id=671785)  [12 years ago](#c21)  [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)   7.18 KB, patch |  | [Details](/attachment.cgi?id=671785&action=edit) | [Diff](/attachment.cgi?id=671785&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=795281&attachment=671785) |
| --- | --- | --- |
| [Patch 1. v2 Make sure AddRef happens on the main thread.](/attachment.cgi?id=671812)  [12 years ago](#c22)  [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)   7.18 KB, patch | bholley : [review+](#a1717410_313730 "12 years ago")  decoder : [feedback+](#c37 "12 years ago")  jseward : [feedback+](#a1631021_346453 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a2098757_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a2098757_272375 "12 years ago") | [Details](/attachment.cgi?id=671812&action=edit) | [Diff](/attachment.cgi?id=671812&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=795281&attachment=671812) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=795281#c0)• 12 years ago |
|  | |

I've seen this twice now, on m-c startups on Android (4.0). Sorry for no
line numbers. I will try to get a line-numberised version.
I couldn't figure out what Component to select.
Thread 33:
Invalid read of size 4
at 0x256A5922: nsXPCWrappedJS::Release() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A6AF8F: nsXPTCStubBase::Release() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x2579531D: UrlClassifierUpdateObserverProxy::Release() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25159D15: nsRefPtr<nsCaret>::assign\_with\_AddRef(nsCaret\*) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x2578F613: nsUrlClassifierDBServiceWorker::FinishUpdate() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x2500DDB9: nsRunnableMethodImpl<void (nsPACMan::\*)(), true>::Run() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A5CB97: nsThread::ProcessNextEvent(bool, bool\*) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A32F75: NS\_ProcessNextEvent\_P(nsIThread\*, bool) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A5C98F: nsThread::ThreadFunc(void\*) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x24D00C47: \_pt\_root (ptthread.c:156)
by 0x482418F: \_\_thread\_entry (pthread.c:217)
by 0x4823CC7: pthread\_create (pthread.c:357)
by 0xFFFFFFFF: ???
Address 0x20a7b600 is 32 bytes inside a block of size 60 free'd
at 0x4806184: free (vg\_replace\_malloc.c:446)
by 0x24C10673: moz\_free (mozalloc.cpp:51)
by 0x256A6573: nsXPCWrappedJS::~nsXPCWrappedJS() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x256A593D: nsXPCWrappedJS::Release() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x2554D95F: nsProxyReleaseEvent::Run() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A5CB97: nsThread::ProcessNextEvent(bool, bool\*) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A32F75: NS\_ProcessNextEvent\_P(nsIThread\*, bool) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x2592B369: mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A87B2D: MessageLoop::RunInternal() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A87B3B: MessageLoop::RunHandler() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x25A87C3B: MessageLoop::Run() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x2588CC69: nsBaseAppShell::Run() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x2577A4C9: nsAppStartup::Run() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x24FAE369: XREMain::XRE\_mainRun() (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x24FB0821: XREMain::XRE\_main(int, char\*\*, nsXREAppData const\*) (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)
by 0x24FB0A39: XRE\_main (in /data/data/org.mozilla.fennec\_sewardj/cache/libxul.so)

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=795281#c1)• 12 years ago |
|  | |

And now with line numbers:
Thread 33:
Invalid read of size 4
at 0x30083922: nsXPCWrappedJS::Release() (ff-opt/js/xpconnect/src/../../../dist/include/nsISupportsImpl.h:268)
by 0x30448F8F: nsXPTCStubBase::Release() (xpcom/reflect/xptcall/src/xptcall.cpp:33)
by 0x3017331D: UrlClassifierUpdateObserverProxy::Release() (ff-opt/toolkit/components/url-classifier/../../../dist/include/nsCOMPtr.h:408)
by 0x2FB37D15: nsRefPtr<nsCaret>::assign\_with\_AddRef(nsCaret\*) (xpcom/base/nsAutoPtr.h:862)
by 0x3016D613: nsUrlClassifierDBServiceWorker::FinishUpdate() (ff-opt/toolkit/components/url-classifier/../../../dist/include/nsCOMPtr.h:622)
by 0x2F9EBDB9: nsRunnableMethodImpl<void (nsPACMan::\*)(), true>::Run() (ff-opt/xpcom/threads/../../dist/include/nsThreadUtils.h:349)
by 0x3043AB97: nsThread::ProcessNextEvent(bool, bool\*) (xpcom/threads/nsThread.cpp:612)
by 0x30410F75: NS\_ProcessNextEvent\_P(nsIThread\*, bool) (ff-opt/xpcom/build/nsThreadUtils.cpp:220)
by 0x3043A98F: nsThread::ThreadFunc(void\*) (xpcom/threads/nsThread.cpp:256)
by 0x2F1A5C47: \_pt\_root (nsprpub/pr/src/pthreads/ptthread.c:156)
by 0x482418F: \_\_thread\_entry (/home/sewardj/AND4-xxray/bionic/libc/bionic/pthread.c:217)
by 0x4823CC7: pthread\_create (/home/sewardj/AND4-xxray/bionic/libc/bionic/pthread.c:357)
by 0xFFFFFFFF: ???
Address 0x21000b20 is 32 bytes inside a block of size 60 free'd
at 0x4806184: free (coregrind/m\_replacemalloc/vg\_replace\_malloc.c:446)
by 0x226BE673: moz\_free (memory/mozalloc/mozalloc.cpp:51)
by 0x30084573: nsXPCWrappedJS::~nsXPCWrappedJS() (ff-opt/js/xpconnect/src/../../../dist/include/mozilla/mozalloc.h:224)
by 0x3008393D: nsXPCWrappedJS::Release() (js/xpconnect/src/XPCWrappedJS.cpp:197)
by 0x2FF2B95F: nsProxyReleaseEvent::Run() (ff-opt/xpcom/build/nsProxyRelease.cpp:19)
by 0x3043AB97: nsThread::ProcessNextEvent(bool, bool\*) (xpcom/threads/nsThread.cpp:612)
by 0x30410F75: NS\_ProcessNextEvent\_P(nsIThread\*, bool) (ff-opt/xpcom/build/nsThreadUtils.cpp:220)
by 0x30309307: mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) (ipc/glue/MessagePump.cpp:82)
by 0x30465B2D: MessageLoop::RunInternal() (ipc/chromium/src/base/message\_loop.cc:208)
by 0x30465B3B: MessageLoop::RunHandler() (ipc/chromium/src/base/message\_loop.cc:201)
by 0x30465C3B: MessageLoop::Run() (ipc/chromium/src/base/message\_loop.cc:175)
by 0x3026AC69: nsBaseAppShell::Run() (widget/xpwidgets/nsBaseAppShell.cpp:163)
by 0x301584C9: nsAppStartup::Run() (toolkit/components/startup/nsAppStartup.cpp:290)
by 0x2F98C369: XREMain::XRE\_mainRun() (toolkit/xre/nsAppRunner.cpp:3782)
by 0x2F98E821: XREMain::XRE\_main(int, char\*\*, nsXREAppData const\*) (toolkit/xre/nsAppRunner.cpp:3848)
by 0x2F98EA39: XRE\_main (toolkit/xre/nsAppRunner.cpp:3923)
by 0x2F992BF7: GeckoStart (toolkit/xre/nsAndroidStartup.cpp:73)
by 0x223C6C5D: Java\_org\_mozilla\_gecko\_GeckoAppShell\_nativeRun (mozglue/android/APKOpen.cpp:981)
by 0x540EBF3: dvmPlatformInvoke (/home/sewardj/AND4-xxray/dalvik/vm/arch/arm/CallEABI.S:258)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=795281#c2)• 12 years ago |
|  | |

Guessing xpconnect.Component: General → XPConnect

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a451801_152868)• 12 years ago |

Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=795281#c3)• 12 years ago |
|  | |

(In reply to Gary Kwong [:gkw, :nth10sd] from [comment #2](/show_bug.cgi?id=795281#c2 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
> Guessing xpconnect.
Only as much as a null deref of an nsCOMPtr is an XPCOM bug. I'm pretty sure this is a bug in the url classifier.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a467829_132034)• 12 years ago |

Component: XPConnect → Phishing ProtectionProduct: Core → Firefox

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=795281#c4)• 12 years ago |
|  | |

Guessing url classifier as being part of Firefox -> Phishing Protection then.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=795281#c5)• 12 years ago |
|  | |

lowering to sec-moderate on the theory that users can't directly control when the URLClassifier does it's thing.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) → [csec-uaf](/buglist.cgi?keywords=csec-uaf&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=795281#c6)• 12 years ago |
|  | |

I am a bit concerned about this, not because it is exploitable necessarily,
but because I suspect that Valgrind is complaining about the "--mRefCnt;"
and I suspect also that V's duplicate-error-removal machinery causes it to
detect but not report the write to the freed block caused by the --mRefCnt.
Hence I am concerned that this is modifying the block and could be a potential
crasher.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a1058067_132034)• 12 years ago |

[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F)

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=795281#c7)• 12 years ago |
|  | |

Speaking from a position of complete ignorance about this part of the
FX code base .. one reason I have a bad feeling about this is that it
looks like there's more than one thread involved. That is, it looks
like the block was freed by the main thread, but is later read by the
URL classifier thread? Hence perhaps there is a threading issue as
well / instead of a memory management issue.
Just guessing here, you understand.

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=795281#c8)• 12 years ago |
|  | |

I wonder if it's related to [bug 798778](/show_bug.cgi?id=798778 "RESOLVED DUPLICATE - crash in mozilla::safebrowsing::Classifier::MarkSpoiled").
mClassifier->MarkSpoiled(mUpdateTables);
}
mUpdateObserver = nullptr;
The last line is the suspect one in this bug, and the one above is crashing in that bug (rather mysteriously so).

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=795281#c9)• 12 years ago |
|  | |

nsProxyReleaseEvent::Run is in the trace. That's interesting, because it's only used here:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/nsUrlClassifierDBService.cpp#840>
which doesn't have anything to do with UrlClassifierUpdateObserverProxy::Release
They're consecutive in memory:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/nsUrlClassifierDBService.cpp#175>
Is something else entirely just scribbling over them?

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=795281#c10)• 12 years ago |
|  | |

(In reply to Gian-Carlo Pascutto (:gcp) from [comment #9](/show_bug.cgi?id=795281#c9 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
If I had to guess (with an emphasis on the word guess, btw), I'd say
this is some kind of refcounting snafu that has lead to the same
object being Release()d one too many times. The reason I say that is
that nsXPCWrappedJS::Release() appears in both stacks. It makes more
sense if you understand that the second stack happened first.
So we have some object at address 0x21000b20-32 being freed ..
at 0x4806184: free (coregrind/m\_replacemalloc/vg\_replace\_malloc.c:446)
by 0x226BE673: moz\_free (memory/mozalloc/mozalloc.cpp:51)
by 0x30084573: nsXPCWrappedJS::~nsXPCWrappedJS()
(ff-opt/js/xpconnect/src/../../../dist/include/mozilla/mozalloc.h:224)
by 0x3008393D: nsXPCWrappedJS::Release() (js/xpconnect/src/XPCWrappedJS.cpp:197)
by 0x2FF2B95F: nsProxyReleaseEvent::Run() (ff-opt/xpcom/build/nsProxyRelease.cpp:19)
by 0x3043AB97: nsThread::ProcessNextEvent(bool, bool\*) (xpcom/threads/nsThread.cpp:612)
and later we're back poking at it again, in nsXPCWrappedJS::Release().
This time we don't run the destructor nsXPCWrappedJS::~nsXPCWrappedJS(),
which might be because the refcount has gone to -1 and the destructor
only gets run on a 1->0 refcount transition:
Invalid read of size 4 (at 0x21000b20)
at 0x30083922: nsXPCWrappedJS::Release()
(ff-opt/js/xpconnect/src/../../../dist/include/nsISupportsImpl.h:268)
by 0x30448F8F: nsXPTCStubBase::Release()
(xpcom/reflect/xptcall/src/xptcall.cpp:33)
by 0x3017331D: UrlClassifierUpdateObserverProxy::Release()
(ff-opt/toolkit/components/url-classifier/../../../dist/include/nsCOMPtr.h:408)
by 0x2FB37D15: nsRefPtr<nsCaret>::assign\_with\_AddRef(nsCaret\*) (xpcom/base/nsAutoPtr.h:862)
by 0x3016D613: nsUrlClassifierDBServiceWorker::FinishUpdate()
(ff-opt/toolkit/components/url-classifier/../../../dist/include/nsCOMPtr.h:622)

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=795281#c11)• 12 years ago |
|  | |

(In reply to Gian-Carlo Pascutto (:gcp) from [comment #8](/show_bug.cgi?id=795281#c8 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
> I wonder if it's related to [bug 798778](/show_bug.cgi?id=798778 "RESOLVED DUPLICATE - crash in mozilla::safebrowsing::Classifier::MarkSpoiled").
>
> mClassifier->MarkSpoiled(mUpdateTables);
> }
> mUpdateObserver = nullptr;
>
> The last line is the suspect one in this bug, and the one above is crashing
> in that bug (rather mysteriously so).
I think that's consistent with the analysis above. The first stack
(viz, the later-occurring one) contains assign\_with\_AddRef, which
might be
> mUpdateObserver = nullptr;
and V is saying this causes a call to Release, but the object has
already been Release-to-zero'd before. Implication is that
mUpdateObserver has already been freed at this point. It follows that
its use in the conditional above ..
if (NS\_SUCCEEDED(mUpdateStatus)) {
LOG(("Notifying success: %d", mUpdateWait));
mUpdateObserver->UpdateSuccess(mUpdateWait);
} else {
LOG(("Notifying error: %d", mUpdateStatus));
mUpdateObserver->UpdateError(mUpdateStatus);
/\*
\* mark the tables as spoiled, we don't want to block hosts
\* longer than normal because our update failed
\*/
mClassifier->MarkSpoiled(mUpdateTables);
}
.. is dangerous because it is free.
Could it be that instead of crashing at
mClassifier->MarkSpoiled(mUpdateTables);
it is actually crashing at the line before, viz
mUpdateObserver->UpdateError(mUpdateStatus);
?

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=795281#c12)• 12 years ago |
|  | |

(Speculating wildly now ..) my impression is that an event to
delete the object (by some other thread) was added to the event
queue, and that got processed ...
nsThread::ProcessNextEvent(bool, bool\*)
--> nsProxyReleaseEvent::Run()
--> nsXPCWrappedJS::Release()
but the thread that added that event used the object after it
added the event.

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=795281#c13)• 12 years ago |
|  | |

I understand something now; I couldn't understand how that nsProxyReleaseEvent got into the stack without NS\_ProxyRelease being called on any relevant object, but indeed it's nsXPCWrappedJS that's calling that, to make sure the release happens in the main thread.
This is being passed down from nsUrlClassifierStreamUpdater::DownloadUpdates, which is passing "this" there. So probably this nsUrlClasssifierStreamUpdater gets deleted before it's time. That would be consistent with the crash being near the UpdateError/MarkSpoiled path.

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=795281#c14)• 12 years ago |
|  | |

So, an nsUrlClassifierStreamUpdater gets created as a locally scoped JavaScript variable here:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/content/listmanager.js#417>
gets passed to nsUrlClassifierDBService here:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/nsUrlClassifierStreamUpdater.cpp#199>
Turned into a proxy to the main thread here:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/nsUrlClassifierDBService.cpp#1360>
and back to an nsCOMPtr here in the worker thread:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/nsUrlClassifierDBService.cpp#458>
Could it be that the call to
nsUrlClassifierDBService::BeginUpdate(nsIUrlClassifierUpdateObserver \*observer,
which takes a simple pointer, fails to properly get a reference added to nsUrlClassifierStreamUpdater when the latter is passing itself down like this?
rv = mDBService->BeginUpdate(this, aRequestTables, aClientKey);
This could cause the reference going out of scope in listmanger.js to allow GC to collect the nsUrlClassifierStreamUpdater object, which in turn would cause a failure when mUpdateObserver = nsnull is called.
What I can't jive with this reasoning is that in [comment 10](/show_bug.cgi?id=795281#c10 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"), the second trace should correspond to the = nsnull assignment, which means the first trace would be the GC. But the trace contains nsProxyReleaseEvent, which from reading nsXPCWrappedJS::Release, can only be on the stack if the request to Release() the object happened NOT on the main thread.
Is this something the GC can do?
Both frees in the stack trace look to me like they originate from elsewhere than the main thread, which confuses me as it somehow suggests that both are happening in nsUrlClassifierDBServiceWorker.

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=795281#c15)• 12 years ago |
|  | |

Actually nope, that nsIUrlClassifierUpdateObserver\* gets used to construct the Proxy, still in the main thread, and that Proxy immediately puts a reference in an nsCOMPtr:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/nsUrlClassifierProxies.h#226>

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=795281#c16)• 12 years ago |
|  | |

Note that I have patches in [bug 773610](/show_bug.cgi?id=773610 "RESOLVED WORKSFORME - Fix consumers that AddRef XPCWrappedJS off-main-thread") that might be relevant here. See in particular:
<https://github.com/bholley/mozilla-central/commit/a816a1a3fe235f33060787ab43df93a82014f72c>

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=795281#c17)• 12 years ago |
|  | |

Very interesting. The description in the patch for [bug 771074](/show_bug.cgi?id=771074 "RESOLVED FIXED - Add API to allow off-main-thread consumers to hold strong references to main-thread-only objects") says:
>Classes like XPCWrappedJS are main-thread-only, which means that it is
>forbidden to call methods on instances of these classes off the main thread.
>For various reasons (see [bug 771074](/show_bug.cgi?id=771074 "RESOLVED FIXED - Add API to allow off-main-thread consumers to hold strong references to main-thread-only objects")), this restriction recently began to
>apply to AddRef/Release as well.
And:
[https://bugzilla.mozilla.org/show\_bug.cgi?id=771074#c0](/show_bug.cgi?id=771074#c0 "RESOLVED FIXED - Add API to allow off-main-thread consumers to hold strong references to main-thread-only objects")
>Off-main-thread Release is easy to handle, because we can just detect it and convert it into a proxied
>release. But AddRef has to be synchronous, so our only option in the status quo is to acquire a lock. This,
>in turn, requires \_all\_ the XPConnect cycle collector machinery to be lock-protected, which is undesirable.
However, your other patches seem to be about removing this lock. So this implies that the lock is still there and the code should work?
The AddRef off the main thread is happening here:
<http://mxr.mozilla.org/mozilla-central/source/toolkit/components/url-classifier/nsUrlClassifierDBService.cpp#458>
If this, for some reason, doesn't take effect, then it would explain this bug.

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=795281#c18)• 12 years ago |
|  | |

Also, when you say "this restriction recently began to apply to AddRef/Release as well", what patch (in what release?) did this?

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=795281#c19)• 12 years ago |
|  | |

(In reply to Gian-Carlo Pascutto (:gcp) from [comment #18](/show_bug.cgi?id=795281#c18 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
> Also, when you say "this restriction recently began to apply to
> AddRef/Release as well", what patch (in what release?) did this?
It hasn't happened yet. Ideally things should still work with the lock. But the vestigial threading code in XPConnect is pretty arcane, so I wouldn't really be surprised if it were broken...

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=795281#c20)• 12 years ago |
|  | |

I made some progress here. :decoder confirmed that bholley's patch removes his crash in 750988, but he crashes elsewhere. I investigated that and the problem is that one of the Proxies is using NS\_NewRunnableMethod which surely isn't using bholley's new main-thread-addref.
I'm going to prepare a combination of bholley's patch + fix for this, and then hopefully sewardj can check if this still reproduces.

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=795281#c21)• 12 years ago |
|  | |

Attached patch

[Patch 1. Make sure AddRef happens on the main thread.](attachment.cgi?id=671785&action=diff) (obsolete)
— [Details](attachment.cgi?id=671785&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=795281&attachment=671785)

Christian and Julian, can you try this patch in your testcases and see if the problems are gone?
[Attachment #671785](/attachment.cgi?id=671785&action=edit "Patch 1. Make sure AddRef happens on the main thread.") -
Flags: feedback?

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=795281#c22)• 12 years ago |
|  | |

Attached patch

[Patch 1. v2 Make sure AddRef happens on the main thread.](attachment.cgi?id=671812&action=diff)
— [Details](attachment.cgi?id=671812&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=795281&attachment=671812)

[Attachment #671785](/attachment.cgi?id=671785&action=edit "Patch 1. Make sure AddRef happens on the main thread.") -
Attachment is obsolete: true
[Attachment #671785](/attachment.cgi?id=671785&action=edit "Patch 1. Make sure AddRef happens on the main thread.") -
Flags: feedback?
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: feedback?(jseward)
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: feedback?(choller)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=795281#c23)• 12 years ago |
|  | |

This is a sec-moderate bug, and we're not sure it's exploitable. Does this really need to be tracked for release?

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=795281#c24)• 12 years ago |
|  | |

(In reply to Gian-Carlo Pascutto (:gcp) from [comment #22](/show_bug.cgi?id=795281#c22 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
> Patch 1. v2 Make sure AddRef happens on the main thread.
It appears to fix it for me, yes, on two V test runs.
This is hardly a good test for the presence/non-presence of threading
bugs, since the visibility or otherwise of the use-after-free depends
entirely on the relative rates of progress for the two threads
involved. But it's better than nothing, I guess.

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a1631021_346453)• 12 years ago |

[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: feedback?(jseward) → feedback+

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=795281#c25)• 12 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #23](/show_bug.cgi?id=795281#c23 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
> This is a sec-moderate bug, and we're not sure it's exploitable. Does this
> really need to be tracked for release?
Per [comment 6](/show_bug.cgi?id=795281#c6 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()") last para and [comment 8](/show_bug.cgi?id=795281#c8 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()") first line, I am not particularly
concerned about exploitability here, but I am concerned that this could be a
cause of unreproducible (timing-related) crashes.

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=795281#c26)• 12 years ago |
|  | |

I suspect this may be the root cause for 3 other bugs:
[https://bugzilla.mozilla.org/show\_bug.cgi?id=750988](/show_bug.cgi?id=750988 "RESOLVED DUPLICATE - ASAN: Several xpcshell tests in url-classifier triggers error")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=727947](/show_bug.cgi?id=727947 "RESOLVED DUPLICATE - Use-after-free after browser freeze")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=798778](/show_bug.cgi?id=798778 "RESOLVED DUPLICATE - crash in mozilla::safebrowsing::Classifier::MarkSpoiled")
The last one is a topcrasher.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=795281#c27)• 12 years ago |
|  | |

(In reply to Gian-Carlo Pascutto (:gcp) from [comment #26](/show_bug.cgi?id=795281#c26 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
> I suspect this may be the root cause for 3 other bugs:
>
> [https://bugzilla.mozilla.org/show\_bug.cgi?id=750988](/show_bug.cgi?id=750988 "RESOLVED DUPLICATE - ASAN: Several xpcshell tests in url-classifier triggers error")
> [https://bugzilla.mozilla.org/show\_bug.cgi?id=727947](/show_bug.cgi?id=727947 "RESOLVED DUPLICATE - Use-after-free after browser freeze")
> [https://bugzilla.mozilla.org/show\_bug.cgi?id=798778](/show_bug.cgi?id=798778 "RESOLVED DUPLICATE - crash in mozilla::safebrowsing::Classifier::MarkSpoiled")
>
> The last one is a topcrasher.
Thanks gcp. After fixing, please nominate for uplift asap.Assignee: nobody → gpascutto
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)Whiteboard: [fixes top crash 798778?]

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=795281#c28)• 12 years ago |
|  | |

Comment on [attachment 671812](/attachment.cgi?id=671812 "Patch 1. v2 Make sure AddRef happens on the main thread.") [[details]](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") [[diff]](/attachment.cgi?id=671812&action=diff "Patch 1. v2 Make sure AddRef happens on the main thread.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=795281&attachment=671812)
Patch 1. v2 Make sure AddRef happens on the main thread.
Julian reported good results. If I understood Christian correctly, he got good results too.
From Bob Holley's comments, this code is actually still supposed to work correctly, but it's complicated enough he's got bad feelings about it ([comment 19](/show_bug.cgi?id=795281#c19 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()")), and is working to change it so it certainly works correctly.
Myself, after applying Bob's original patch, get a reproducible crash (in code that should "in theory" work) that goes away when I extend Bob's fix to the remaining parts of this code.
Based on this, I think we want to take this patch.
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: review?(bobbyholley+bmo)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a1717410_313730)• 12 years ago |

[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: review?(bobbyholley+bmo) → review+

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=795281#c29)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/b4d95f422871>
Let's see what this does to the crash stats and aggressively uplift if they're looking good.

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=795281#c30)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b4d95f422871>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 19

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a1769141_425645)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B)

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=795281#c31)• 12 years ago |
|  | |

[Bug 798778](/show_bug.cgi?id=798778 "RESOLVED DUPLICATE - crash in mozilla::safebrowsing::Classifier::MarkSpoiled") is likely caused by [bug 797302](/show_bug.cgi?id=797302 "RESOLVED FIXED - crash in mozilla::safebrowsing::Classifier::Check"), not this one.Whiteboard: [fixes top crash 798778?]

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=795281#c32)• 12 years ago |
|  | |

(In reply to Gian-Carlo Pascutto (:gcp) from [comment #31](/show_bug.cgi?id=795281#c31 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()"))
> [Bug 798778](/show_bug.cgi?id=798778 "RESOLVED DUPLICATE - crash in mozilla::safebrowsing::Classifier::MarkSpoiled") is likely caused by [bug 797302](/show_bug.cgi?id=797302 "RESOLVED FIXED - crash in mozilla::safebrowsing::Classifier::Check"), not this one.
Great - let's get some uplift noms and land this to branches before EOD PT tomorrow (Monday) so this is in 17.0 beta 3

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=795281#c33)• 12 years ago |
|  | |

Comment on [attachment 671812](/attachment.cgi?id=671812 "Patch 1. v2 Make sure AddRef happens on the main thread.") [[details]](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") [[diff]](/attachment.cgi?id=671812&action=diff "Patch 1. v2 Make sure AddRef happens on the main thread.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=795281&attachment=671812)
Patch 1. v2 Make sure AddRef happens on the main thread.
[Approval Request Comment]
Bug caused by (feature/regressing bug #): Probably has been there since Firefox 4 or the removal of Proxy Objects way before Firefox 10.
User impact if declined: Use-after-free in rare race conditions, potentially leading to memory corruption.
Testing completed (on m-c, etc.): Landed on m-c a few days ago.
Risk to taking this patch (and alternatives if risky): Similar as with leaving the bug in place, but without the potential security issue.
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: approval-mozilla-beta?
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a2098757_272375)• 12 years ago |

[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: approval-mozilla-beta?
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: approval-mozilla-beta+
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: approval-mozilla-aurora?
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: approval-mozilla-aurora+

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=795281#c34)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/45ac7cb40b47>
<https://hg.mozilla.org/releases/mozilla-beta/rev/053399d34cf8>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a2980597_280903)• 12 years ago |

Whiteboard: [adv-track-main17-]

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a3052409_278074)• 12 years ago |

Blocks: [808146](/show_bug.cgi?id=808146 "RESOLVED FIXED - nsProxyRelease.h:156:356: warning: deleting object of polymorphic class type ‘nsMainThreadPtrHolder<nsIUrlClassifierLookupCallback>’ which has non-virtual destructor might cause undefined behaviour [-Wdelete-non-virtual-dtor]")

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=795281#c37)• 12 years ago |
|  | |

Comment on [attachment 671812](/attachment.cgi?id=671812 "Patch 1. v2 Make sure AddRef happens on the main thread.") [[details]](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") [[diff]](/attachment.cgi?id=671812&action=diff "Patch 1. v2 Make sure AddRef happens on the main thread.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=795281&attachment=671812)
Patch 1. v2 Make sure AddRef happens on the main thread.
Clearing feedback, bug is long gone now in ASan :)
[Attachment #671812](/attachment.cgi?id=671812&action=edit "Patch 1. v2 Make sure AddRef happens on the main thread.") -
Flags: feedback?(choller) → feedback+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a14804180_1689)• 12 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=795281#a52385395_1)• 11 years ago |

Product: Firefox → Toolkit
You need to [log in](/show_bug.cgi?id=795281&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from secunia.com_ccb233c0_20250124_140951.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from bugzilla.mozilla.org_4971d6b9_20250124_141018.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/798678)
* [XML](/show_bug.cgi?ctype=xml&id=798678)

Closed
[Bug 798678](/show_bug.cgi?id=798678)

Opened 12 years ago
Closed 12 years ago

# WeakMaps with keys from another compartment are possible and incorrect

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

WeakMaps with keys from another compartment are possible and incorrect

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla19

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix) |
| firefox16 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) |
| firefox19 | [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |
| firefox-esr17 | [20+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=20%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 |  | wontfix |
| firefox16 |  | wontfix |
| firefox17 | + | fixed |
| firefox18 | + | fixed |
| firefox19 | + | fixed |
| firefox-esr10 |  | unaffected |
| firefox-esr17 | 20+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: billm, Assigned: billm)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/81db2831554209472ec9b0d5485ca1c9?d=mm&size=40)  [billm](/user_profile?user_id=389993)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/81db2831554209472ec9b0d5485ca1c9?d=mm&size=40)  [billm](/user_profile?user_id=389993)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[812380](/show_bug.cgi?id=812380 "RESOLVED FIXED - Possible use-after-CC-Unlink due to incorrect cycle collector WeakMap optimizations"), [819131](/show_bug.cgi?id=819131 "RESOLVED FIXED - Cross-compartment DOM element references disappear from WeakMaps")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[WeakMap](/show_bug.cgi?id=547941 "RESOLVED FIXED - Implement Harmony Weak Maps [ES6?]"), [801516](/show_bug.cgi?id=801516 "RESOLVED WORKSFORME - crash in js::gc::IsObjectMarked with AdBlock Plus")

[790338](/show_bug.cgi?id=790338 "RESOLVED FIXED - GC: Sweep compartments in groups")

Dependency [tree](/showdependencytree.cgi?id=798678&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=798678)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, sec-critical, Whiteboard: [adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [billm](/user_profile?user_id=389993) | [in-testsuite](#c50 "12 years ago") | + |
| --- | --- | --- |
| [billm](/user_profile?user_id=389993) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 6 obsolete files)

| [add assertion to catch this in the future](/attachment.cgi?id=669354)  [12 years ago](#c2)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   3.34 KB, patch |  | [Details](/attachment.cgi?id=669354&action=edit) | [Diff](/attachment.cgi?id=669354&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669354) |
| --- | --- | --- |
| [bugfix patch](/attachment.cgi?id=669364)  [12 years ago](#c3)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   14.57 KB, patch |  | [Details](/attachment.cgi?id=669364&action=edit) | [Diff](/attachment.cgi?id=669364&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669364) |
| [bugfix patch, v2](/attachment.cgi?id=669365)  [12 years ago](#c4)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   15.32 KB, patch | mccr8 : [review-](#c8 "12 years ago")  bholley : [feedback+](#c6 "12 years ago") | [Details](/attachment.cgi?id=669365&action=edit) | [Diff](/attachment.cgi?id=669365&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669365) |
| [assertion, v2](/attachment.cgi?id=670616)  [12 years ago](#c9)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   4.02 KB, patch |  | [Details](/attachment.cgi?id=670616&action=edit) | [Diff](/attachment.cgi?id=670616&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670616) |
| [bugfix patch, v3](/attachment.cgi?id=670643)  [12 years ago](#c10)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   17.20 KB, patch | jonco : [review+](#c11 "12 years ago")  mccr8 : [review+](#c13 "12 years ago")  abillings : [sec-approval+](#c16 "12 years ago") | [Details](/attachment.cgi?id=670643&action=edit) | [Diff](/attachment.cgi?id=670643&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643) |
| [test for this bug](/attachment.cgi?id=670892)  [12 years ago](#c17)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   4.29 KB, patch | billm : [review+](#c17 "12 years ago") | [Details](/attachment.cgi?id=670892&action=edit) | [Diff](/attachment.cgi?id=670892&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670892) |
| [bugfix patch, v4](/attachment.cgi?id=671624)  [12 years ago](#c26)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   18.90 KB, patch | mccr8 : [review+](#c29 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#c42 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c42 "12 years ago") | [Details](/attachment.cgi?id=671624&action=edit) | [Diff](/attachment.cgi?id=671624&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671624) |
| [bugfix for CC, v1](/attachment.cgi?id=671625)  [12 years ago](#c27)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   11.01 KB, patch | mccr8 : [review+](#c30 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#c39 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c39 "12 years ago") | [Details](/attachment.cgi?id=671625&action=edit) | [Diff](/attachment.cgi?id=671625&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671625) |
| [test for CC patch](/attachment.cgi?id=671626)  [12 years ago](#c28)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   5.22 KB, patch | mccr8 : [review+](#c31 "12 years ago") | [Details](/attachment.cgi?id=671626&action=edit) | [Diff](/attachment.cgi?id=671626&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671626) |
| [test for this bug, v2](/attachment.cgi?id=672628)  [12 years ago](#c33)  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)   4.34 KB, patch | billm : [review+](#c33 "12 years ago") | [Details](/attachment.cgi?id=672628&action=edit) | [Diff](/attachment.cgi?id=672628&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=672628) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=798678#c0)• 12 years ago |
|  | |

This is a regression from [bug 673468](/show_bug.cgi?id=673468 "RESOLVED FIXED - Wrapped JS objects used as keys can disappear from WeakMaps"). Somehow I convinced myself this was okay, but I'm now pretty sure that we can have problems from this. I'll try to get a testcase on Monday.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a3304_406194)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=798678#c1)• 12 years ago |
|  | |

I figured out how to make this crash. The cross-compartment key needs to be in its own chunk, which is then deallocated. That way we crash when trying to check the mark bit when sweeping the weakmap.
var w = new WeakMap();
var g = newGlobal();
var k = g.eval('for (var i=0;i<100000;i++) new Object(); var q = new Object(); dumpObject(q); q');
dumpObject(k);
w.set(k, {});
k = null;
print('first gc...');
gc();
gc();
g.eval('q = null');
print('comp gc');
gc(g);
gc(g);
gc(g);
gc(g);
gc(g);
gc(g);
print('last gc');
gc();

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=798678#c2)• 12 years ago |
|  | |

Attached patch

[add assertion to catch this in the future](attachment.cgi?id=669354&action=diff) (obsolete)
— [Details](attachment.cgi?id=669354&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669354)

Here's what's going on. Let's say we have a weakmap M in compartment CM. Then we have an object K in compartment CK. We have a wrapper for K in compartment CM called KW. Now we use KW as a key in M.
Currently, we will unwrap KW to get K before adding it to the weakmap. Now let's say we lose the reference we had to KW and do a GC. That will cause KW to be finalized, so its entry in the cross-compartment map will go away. Then let's say we do a compartment GC of compartment CK. It's possible that K will be collected by this GC because the weakmap has no way to keep it alive. However, K will still be an entry in the weakmap and it won't be swept, since CM is not being collected.
Now we have a weakmap with a ptr to K even though K has been finalized. The test I posted earlier makes this crash by ensuring that K gets allocated in its own chunk and then ensuring that that chunk is freed. Later, if we GC compartment CM, we'll crash when sweeping M because we need to check the mark bit of K, and its chunk has been freed. I'm guessing that the difficulty of generating this crash is why we never found this before.
This patch doesn't fix anything. It just makes it easier to find such crashes by adding an assertion that we never check the mark bit of an object that's in an arena that's been released. The tricky part here is that we \*do\* check the mark bits of shapes after their arena has been finalized, and it's safe to do so. So I added an isMarkedUnchecked version to use in such cases.
[Attachment #669354](/attachment.cgi?id=669354&action=edit "add assertion to catch this in the future") -
Flags: review?(jcoppeard)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=798678#c3)• 12 years ago |
|  | |

Attached patch

[bugfix patch](attachment.cgi?id=669364&action=diff) (obsolete)
— [Details](attachment.cgi?id=669364&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669364)

This fixes the problem by avoiding the unwrapping and changing how weakmap marking works. I still need to do the CC work, but that will be a separate patch.
Bobby, I'm asking for your feedback because I added a new ProxyHandler hook. The context for this bug is in [bug 673468](/show_bug.cgi?id=673468 "RESOLVED FIXED - Wrapped JS objects used as keys can disappear from WeakMaps"). I'm just fixing it in a different way.
I'm a little worried how things will work when people start using the new DOM proxies as keys. They're not IndirectProxyHandlers and I don't know whether they support the preserve wrapper mechanism. I guess we'll have to figure that out later.
[Attachment #669364](/attachment.cgi?id=669364&action=edit "bugfix patch") -
Flags: review?(continuation)
[Attachment #669364](/attachment.cgi?id=669364&action=edit "bugfix patch") -
Flags: feedback?(bobbyholley+bmo)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=798678#c4)• 12 years ago |
|  | |

Attached patch

[bugfix patch, v2](attachment.cgi?id=669365&action=diff) (obsolete)
— [Details](attachment.cgi?id=669365&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669365)

Sorry, I forgot to qref.
[Attachment #669364](/attachment.cgi?id=669364&action=edit "bugfix patch") -
Attachment is obsolete: true
[Attachment #669364](/attachment.cgi?id=669364&action=edit "bugfix patch") -
Flags: review?(continuation)
[Attachment #669364](/attachment.cgi?id=669364&action=edit "bugfix patch") -
Flags: feedback?(bobbyholley+bmo)
[Attachment #669365](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") -
Flags: review?(continuation)
[Attachment #669365](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") -
Flags: feedback?(bobbyholley+bmo)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a258122_406194)• 12 years ago |

Keywords: [csec-uaf](/buglist.cgi?keywords=csec-uaf&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=798678#c5)• 12 years ago |
|  | |

The new DOM binding stuff, if that's what you are referring to, involves nsWrapperCache stuff, so it should support wrapper preservation.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=798678#c6)• 12 years ago |
|  | |

Comment on [attachment 669365](/attachment.cgi?id=669365 "bugfix patch, v2") [[details]](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") [[diff]](/attachment.cgi?id=669365&action=diff "bugfix patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669365)
bugfix patch, v2
>+JSObject \*
>+BaseProxyHandler::weakmapKeyDelegate(JSTracer \*trc, JSObject \*proxy)
Please add a nice big fat comment somewhere explaining what this trap is all about.
>+static JSObject \*
>+proxy\_WeakmapKeyDelegate(JSTracer \*trc, RawObject obj)
>+{
>+ JS\_ASSERT(obj->isProxy());
>+ if (!obj->getSlot(JSSLOT\_PROXY\_HANDLER).isUndefined())
>+ return GetProxyHandler(obj)->weakmapKeyDelegate(trc, obj);
When can a proxy ever have an undefined handler?
f=bholley with those changes
[Attachment #669365](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") -
Flags: feedback?(bobbyholley+bmo) → feedback+

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=798678#c7)• 12 years ago |
|  | |

Comment on [attachment 669354](/attachment.cgi?id=669354 "add assertion to catch this in the future") [[details]](/attachment.cgi?id=669354&action=edit "add assertion to catch this in the future") [[diff]](/attachment.cgi?id=669354&action=diff "add assertion to catch this in the future") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669354)
add assertion to catch this in the future
Review of [attachment 669354](/attachment.cgi?id=669354 "add assertion to catch this in the future") [[details]](/attachment.cgi?id=669354&action=edit "add assertion to catch this in the future") [[diff]](/attachment.cgi?id=669354&action=diff "add assertion to catch this in the future") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669354):
-----------------------------------------------------------------
The current Cell::isMarked, and the new isMarkedUnchecked, call AssertValidColor, which winds up calling ArenaHeader::allocated() for non-black colours only.
So for gray marking only, isMarked is currently checked and isMarkedUnchecked would actually check too. Kind of messy, although I can't immediately see a way to fix it.
Maybe AssertValidColor could be different - in practice, are there any objects that don't support gray marking?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a390918_406194)• 12 years ago |

Blocks: [WeakMap](/show_bug.cgi?id=547941 "RESOLVED FIXED - Implement Harmony Weak Maps [ES6?]")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=798678#c8)• 12 years ago |
|  | |

Comment on [attachment 669365](/attachment.cgi?id=669365 "bugfix patch, v2") [[details]](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") [[diff]](/attachment.cgi?id=669365&action=diff "bugfix patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669365)
bugfix patch, v2
Review of [attachment 669365](/attachment.cgi?id=669365 "bugfix patch, v2") [[details]](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") [[diff]](/attachment.cgi?id=669365&action=diff "bugfix patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=669365):
-----------------------------------------------------------------
This is sort of amusing because you are essentially implementing wrapper preservation for JS proxies. I wonder if this is more generally useful or not.
Are there other places that need their Class updated? js::NormalArgumentsObjectClass, js::StrictArgumentsObjectClass, js::ArrayClass, js::SlowArrayClass, IMPL\_TYPED\_ARRAY\_FAST\_CLASS don't use JS\_NULL\_CLASS\_EXT, though maybe they should. XPC\_WN\_NoHelper\_JSClass also looks like it might need updating.
Maybe there are some others. You can use this search to find them:
<http://mxr.mozilla.org/mozilla-central/search?string=isWrappedNative&filter=[Ii]sWrappedNative>
r- mainly because of the Class stuff. I'm not exactly sure how that should work...
Nice patch, though. Did you come across crashes like this, or did you have an epiphany?
::: js/src/jsclass.h
@@ +255,5 @@
> \* WeakMaps use this to override the wrapper disposal optimization.
> \*/
> bool isWrappedNative;
> +
> + JSWeakmayKeyDelegateOp weakmapKeyDelegateOp;
Like bholley said, this really needs a comment, as it isn't really obvious what this is for just from its name.
::: js/src/jsproxy.cpp
@@ +353,5 @@
> {
> }
>
> +JSObject \*
> +BaseProxyHandler::weakmapKeyDelegate(JSTracer \*trc, JSObject \*proxy)
Why is it okay to just return nothing here? Does the base proxy not wrap anything?
@@ +355,5 @@
>
> +JSObject \*
> +BaseProxyHandler::weakmapKeyDelegate(JSTracer \*trc, JSObject \*proxy)
> +{
> + return false;
null, not false
@@ +556,5 @@
>
> +JSObject \*
> +IndirectProxyHandler::weakmapKeyDelegate(JSTracer \*trc, JSObject \*proxy)
> +{
> + return GetProxyTargetObject(proxy);
Do you not have to worry about the target being another proxy?
@@ +2869,5 @@
> +{
> + JS\_ASSERT(obj->isProxy());
> + if (!obj->getSlot(JSSLOT\_PROXY\_HANDLER).isUndefined())
> + return GetProxyHandler(obj)->weakmapKeyDelegate(trc, obj);
> + return NULL;
maybe reverse these branches? eg if isUndefined(), early return with NULL. Just to remove a negation. If this is just the way it is done, then that's okay.
::: js/src/jsproxy.h
@@ +120,5 @@
> virtual bool regexp\_toShared(JSContext \*cx, JSObject \*proxy, RegExpGuard \*g);
> virtual bool defaultValue(JSContext \*cx, JSObject \*obj, JSType hint, Value \*vp);
> virtual bool iteratorNext(JSContext \*cx, JSObject \*proxy, Value \*vp);
> virtual void finalize(JSFreeOp \*fop, JSObject \*proxy);
> + virtual JSObject \*weakmapKeyDelegate(JSTracer \*trc, JSObject \*proxy);
Should all of these delegate functions use JSRawObject as args and returns to match the type in JSWeakmayKeyDelegateOp?
::: js/src/jsweakmap.h
@@ +169,5 @@
> for (Range r = Base::all(); !r.empty(); r.popFront())
> markValue(trc, &r.front().value);
> }
>
> + bool keyNeedsMark(JSTracer \*trc, JSObject \*key) {
Should trc have type GCMarker\*? You should at least assert IS\_GC\_MARKER(trc) somewhere.
@@ +172,5 @@
>
> + bool keyNeedsMark(JSTracer \*trc, JSObject \*key) {
> + if (JSWeakmayKeyDelegateOp op = key->getClass()->ext.weakmapKeyDelegateOp) {
> + JSObject \*delegate = op(trc, key);
> + if (!delegate)
I don't know if early return is better here or not. It is a shame we don't have a better way to code this particular pattern for these various callbacks.
@@ +195,5 @@
> markedAny = true;
> if (prior != e.front().key)
> e.rekeyFront(e.front().key);
> + } else if (IS\_GC\_MARKING\_TRACER(trc) && keyNeedsMark(trc, e.front().key)) {
> + gc::Mark(trc, const\_cast<Key \*>(&e.front().key), "WeakMap key");
a more specific description than "WeakMap key" would be nice. Maybe something like "proxy-preserved WeakMap key"?
[Attachment #669365](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") -
Flags: review?(continuation) → review-

|  | [Naveed Ihsanullah [:naveed]](/user_profile?user_id=441971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a499437_441971)• 12 years ago |

[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a499538_1689)• 12 years ago |

[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=798678#c9)• 12 years ago |
|  | |

Attached patch

[assertion, v2](attachment.cgi?id=670616&action=diff) (obsolete)
— [Details](attachment.cgi?id=670616&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670616)

This moves around some of the assertions to avoid duplication.
The reason AssertValidColor was conditional was because of the shape issue mentioned earlier. However, now that we have isMarkedUnchecked for the shape case, AssertValidColor can check the color unconditionally.
As an aside, the reason we have AssertValidColor is because we only have room in the mark bitmap for two colors. There's one bit in the bitmap for every 8 bytes of GC thing. On 32-bit machines, the smallest object is 16 bytes, so there are only two bits available for it. AssertValidColor is just checking that we never use 2 or above as colors.
[Attachment #669354](/attachment.cgi?id=669354&action=edit "add assertion to catch this in the future") -
Attachment is obsolete: true
[Attachment #669354](/attachment.cgi?id=669354&action=edit "add assertion to catch this in the future") -
Flags: review?(jcoppeard)
[Attachment #670616](/attachment.cgi?id=670616&action=edit "assertion, v2") -
Flags: review?(jcoppeard)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=798678#c10)• 12 years ago |
|  | |

Attached patch

[bugfix patch, v3](attachment.cgi?id=670643&action=diff) (obsolete)
— [Details](attachment.cgi?id=670643&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)

> When can a proxy ever have an undefined handler?
You're right, it can't. I cargo-culted that from the finalize hook. I've removed the possibility in both cases. I imagine it was to deal with a partially-created proxy object, but that can't happen.
> Are there other places that need their Class updated?
> js::NormalArgumentsObjectClass, js::StrictArgumentsObjectClass, js::ArrayClass,
> js::SlowArrayClass, IMPL\_TYPED\_ARRAY\_FAST\_CLASS don't use JS\_NULL\_CLASS\_EXT, though
> maybe they should. XPC\_WN\_NoHelper\_JSClass also looks like it might need updating.
In C, if you leave out a field of a global struct definition, it will be filled in with NULL. And when we dynamically allocate classes, we always memset them to zero. So in don't think there's anything to worry about here.
> Why is it okay to just return nothing here? Does the base proxy not wrap anything?
Yeah, base proxies don't wrap anything as far as I know. The only proxies we have that aren't IndirectProxyHandlers are from the new DOM bindings. We'll need to come up with a way to handle those, but it sounds like wrapper preservation will work. (Note that even before my patch, I don't think we handle the new DOM bindings.)
> Do you not have to worry about the target being another proxy?
Good point. I switched it to an UnwrapObject call.
[Attachment #669365](/attachment.cgi?id=669365&action=edit "bugfix patch, v2") -
Attachment is obsolete: true
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: review?(continuation)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=798678#c11)• 12 years ago |
|  | |

Comment on [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)
bugfix patch, v3
Review of [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643):
-----------------------------------------------------------------
Looks good!
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: review?(continuation) → review+

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a571127_443194)• 12 years ago |

Blocks: [790338](/show_bug.cgi?id=790338 "RESOLVED FIXED - GC: Sweep compartments in groups")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=798678#c12)• 12 years ago |
|  | |

Comment on [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)
bugfix patch, v3
Did you r+ the wrong patch by mistake, Jon?
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: review?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=798678#c13)• 12 years ago |
|  | |

Comment on [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)
bugfix patch, v3
Review of [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643):
-----------------------------------------------------------------
> In C, if you leave out a field of a global struct definition, it will be filled in with NULL.
Thanks, good to know. I would have thought initializing things without your explicit declaration would be a little too hand-holdey for C. I mean, think of all the cycles you could potentially be wasting if there are fields you know don't need to be initialized!
Thanks for the tests.
::: js/xpconnect/tests/chrome/test\_weakmap\_keys\_preserved.xul
@@ +28,5 @@
> + let map = sandbox.WeakMap();
> + let obj = {};
> + map.set(obj, {});
> +
> + window.QueryInterface(Ci.nsIInterfaceRequestor)
I think you can just do Cu.forceGC() here instead of this QIing fun.
@@ +32,5 @@
> + window.QueryInterface(Ci.nsIInterfaceRequestor)
> + .getInterface(Ci.nsIDOMWindowUtils)
> + .garbageCollect();
> +
> + is(map.has(obj), true, "Weakmap still contains our wrapper!");
You can do ok(..., "foo") instead of is(..., true, "foo")
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: review?(continuation) → review+

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=798678#c14)• 12 years ago |
|  | |

Comment on [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)
bugfix patch, v3
[Security approval request comment]
How easily can the security issue be deduced from the patch?
The test makes it fairly clear, but I could land without that. Otherwise it looks like a refactoring.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
See above.
Which older supported branches are affected by this flaw?
It goes back to FF 13.
If not all supported branches, which bug introduced the flaw?
[Bug 673468](/show_bug.cgi?id=673468 "RESOLVED FIXED - Wrapped JS objects used as keys can disappear from WeakMaps")
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Backporting should be easy.
How likely is this patch to cause regressions; how much testing does it need?
There is a small possibility of regressions if the patch is incorrect. Most likely, it would manifest itself in a way where things were unexpectedly dropped from weakmaps.
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: sec-approval?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=798678#c15)• 12 years ago |
|  | |

Comment on [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)
bugfix patch, v3
[Approval Request Comment]
Bug caused by (feature/regressing bug #): [bug 673468](/show_bug.cgi?id=673468 "RESOLVED FIXED - Wrapped JS objects used as keys can disappear from WeakMaps")
User impact if declined: Crashes are unlikely from the issue, but it could be exploited.
Testing completed (on m-c, etc.): Tryserver
Risk to taking this patch (and alternatives if risky): See previous comment.
String or UUID changes made by this patch: None.
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: approval-mozilla-beta?
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: approval-mozilla-aurora?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=798678#c16)• 12 years ago |
|  | |

Comment on [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)
bugfix patch, v3
Sec-approval+ for landing without the test. We should have a separate patch for that and land the test once we release with the fix.
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: sec-approval? → sec-approval+

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=798678#c17)• 12 years ago |
|  | |

Attached patch

[test for this bug](attachment.cgi?id=670892&action=diff) (obsolete)
— [Details](attachment.cgi?id=670892&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670892)

I folded the tests in with the assertion patch. We can land them both later. I'm going to assume that Jon meant to r+ this patch rather than the other one.
[Attachment #670616](/attachment.cgi?id=670616&action=edit "assertion, v2") -
Attachment is obsolete: true
[Attachment #670616](/attachment.cgi?id=670616&action=edit "assertion, v2") -
Flags: review?(jcoppeard)
[Attachment #670892](/attachment.cgi?id=670892&action=edit "test for this bug") -
Flags: review+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=798678#c18)• 12 years ago |
|  | |

You aren't going to land this until you fix the CC stuff, right?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=798678#c19)• 12 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #18](/show_bug.cgi?id=798678#c18 "RESOLVED FIXED - WeakMaps with keys from another compartment are possible and incorrect"))
> You aren't going to land this until you fix the CC stuff, right?
Waiting on this before approving for branches (don't know how critical that change is).

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=798678#c20)• 12 years ago |
|  | |

Yeah, it isn't actually ready to land anywhere yet.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=798678#c21)• 12 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #20](/show_bug.cgi?id=798678#c20 "RESOLVED FIXED - WeakMaps with keys from another compartment are possible and incorrect"))
> Yeah, it isn't actually ready to land anywhere yet.
Where should we be tracking progress on that so we know when to expect this bug to be ready to go?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=798678#c22)• 12 years ago |
|  | |

I expect the rest will be done in a day or two.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=798678#c23)• 12 years ago |
|  | |

(In reply to Bill McCloskey (:billm) from [comment #22](/show_bug.cgi?id=798678#c22 "RESOLVED FIXED - WeakMaps with keys from another compartment are possible and incorrect"))
> I expect the rest will be done in a day or two.
Sorry, I should have been more specific - are there bugs tracking what needs to be resolved before this can land? Or we are we just waiting for a comment in this bug saying "all clear"?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=798678#c24)• 12 years ago |
|  | |

I'm planning to post another patch in this bug, get it reviewed, ask for approval for that as well, and then everything can land I guess.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=798678#c25)• 12 years ago |
|  | |

Comment on [attachment 670643](/attachment.cgi?id=670643 "bugfix patch, v3") [[details]](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") [[diff]](/attachment.cgi?id=670643&action=diff "bugfix patch, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=670643)
bugfix patch, v3
The approval flags can probably be cleared for now to avoid coming up in queries...
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: approval-mozilla-beta?
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Flags: approval-mozilla-aurora?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=798678#c26)• 12 years ago |
|  | |

Attached patch

[bugfix patch, v4](attachment.cgi?id=671624&action=diff)
— [Details](attachment.cgi?id=671624&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671624)

While debugging the CC patch, I ended up making some changes to this one, so asking for another review. The changes are as follows:
1. Remove the JSTracer\* param from the weakmap key delegate hook, since the tracer is unable to supply one and I wasn't using it anyway.
2. Previously, when doing weakmap marking, if we found a delegate for a key, we would check delegate->isMarked(gcmarker->getMarkColor()). If that was true, we would mark the key and the value. However, this caused problems if the weakmap was gray and the delegate was black. In that case, we wouldn't call markIteratively on the weakmap until the mark color was gray. And then delegate->isMarked(GRAY) would be false, so we wouldn't do anything. This is wrong. I fixed it by changing it to IsMarked, which just checks if it's black. I think this is correct.
3. I removed some comments about weakmaps that no longer apply.
[Attachment #670643](/attachment.cgi?id=670643&action=edit "bugfix patch, v3") -
Attachment is obsolete: true
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: review?(continuation)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=798678#c27)• 12 years ago |
|  | |

Attached patch

[bugfix for CC, v1](attachment.cgi?id=671625&action=diff)
— [Details](attachment.cgi?id=671625&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671625)

This adds support to the cycle collector for these delegates. It's pretty straightforward.
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: review?(continuation)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=798678#c28)• 12 years ago |
|  | |

Attached patch

[test for CC patch](attachment.cgi?id=671626&action=diff)
— [Details](attachment.cgi?id=671626&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671626)

Here's the gross test for the previous patch. I had to add support to Cu.nondeterministicGetWeakMapKeys for weakmaps in other compartments.
[Attachment #671626](/attachment.cgi?id=671626&action=edit "test for CC patch") -
Flags: review?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a994199_406194)• 12 years ago |

Blocks: [801516](/show_bug.cgi?id=801516 "RESOLVED WORKSFORME - crash in js::gc::IsObjectMarked with AdBlock Plus")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=798678#c29)• 12 years ago |
|  | |

Comment on [attachment 671624](/attachment.cgi?id=671624 "bugfix patch, v4") [[details]](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") [[diff]](/attachment.cgi?id=671624&action=diff "bugfix patch, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671624)
bugfix patch, v4
Review of [attachment 671624](/attachment.cgi?id=671624 "bugfix patch, v4") [[details]](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") [[diff]](/attachment.cgi?id=671624&action=diff "bugfix patch, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671624):
-----------------------------------------------------------------
> And then delegate->isMarked(GRAY) would be false, so we wouldn't do anything.
Wow, nice catch! I didn't think about that at all, but your fix sounds right to me. This stuff is so tricky. Could you please throw a brief comment into keyNeedsMark about this? Something along the lines of "Check if the delegate is marked with any color to properly handle gray marking when the key's delegate is black and the map is gray". This is subtle enough that I could see people looking at the code later and thinking IsObjectMarked is a mistake, or maybe just not being able to figure out why it is what it is.
::: js/src/jsweakmap.h
@@ +142,5 @@
> + if (JSWeakmapKeyDelegateOp op = key->getClass()->ext.weakmapKeyDelegateOp) {
> + JSObject \*delegate = op(key);
> + if (!delegate)
> + return false;
> + return gc::IsObjectMarked(&delegate);
You could change this to |return delegate && gc::IsObjectMarked(...)|
@@ +147,5 @@
> + }
> + return false;
> + }
> +
> + bool keyNeedsMark(JSTracer \*trc, gc::Cell \*cell) {
This function appears to be unused.
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: review?(continuation) → review+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=798678#c30)• 12 years ago |
|  | |

Comment on [attachment 671625](/attachment.cgi?id=671625 "bugfix for CC, v1") [[details]](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") [[diff]](/attachment.cgi?id=671625&action=diff "bugfix for CC, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671625)
bugfix for CC, v1
Review of [attachment 671625](/attachment.cgi?id=671625 "bugfix for CC, v1") [[details]](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") [[diff]](/attachment.cgi?id=671625&action=diff "bugfix for CC, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671625):
-----------------------------------------------------------------
Looks good!
::: content/base/src/nsContentUtils.cpp
@@ +6373,5 @@
> NS\_IMETHOD\_(void) NoteNextEdgeName(const char\* name)
> {
> }
>
> + NS\_IMETHOD\_(void) NoteWeakMapping(void\* map, void\* key, void\* kdelegate, void\* val)
Ugh, sorry about this. I finally filed [bug 802604](/show_bug.cgi?id=802604 "RESOLVED WONTFIX - Consider making nsCycleCollectionTraversalCallback not abstract") for making the base traverse class empty so we don't need to keep patching these empty methods.
::: xpcom/base/nsCycleCollector.cpp
@@ +1907,5 @@
>
> WeakMapping \*mapping = mWeakMaps.AppendElement();
> mapping->mMap = map ? AddWeakMapNode(map) : nullptr;
> mapping->mKey = key ? AddWeakMapNode(key) : nullptr;
> + mapping->mKeyDelegate = kdelegate ? AddWeakMapNode(kdelegate) : mapping->mKey;
Ah, nice. I was thinking offhand the else case here would be nullptr, but you are right this has to be handled like this.
@@ +2143,5 @@
> // All non-null weak mapping maps, keys and values are
> // roots (in the sense of WalkFromRoots) in the cycle
> // collector graph, and thus should have been colored
> // either black or white in ScanRoots().
> + MOZ\_ASSERT(mColor != grey, "Uncolored weak map");
Thanks for changing these to MOZ\_ASSERT!
@@ +2145,5 @@
> // collector graph, and thus should have been colored
> // either black or white in ScanRoots().
> + MOZ\_ASSERT(mColor != grey, "Uncolored weak map");
> + MOZ\_ASSERT(kColor != grey, "Uncolored weak map key");
> + MOZ\_ASSERT(kdColor != grey, "Uncolored weak map key");
nit: "key delegate" in here instead of "key".
@@ +2148,5 @@
> + MOZ\_ASSERT(kColor != grey, "Uncolored weak map key");
> + MOZ\_ASSERT(kdColor != grey, "Uncolored weak map key");
> + MOZ\_ASSERT(v->mColor != grey, "Uncolored weak map value");
> +
> + if (mColor == black && kColor != black && kdColor == black) {
Oh, this is tricky. I was thinking the |mColor == black| part was wrong, but then I realized that in the GC we never run the special weak map key code unless the map is alive, so you are right.
A test case would be something hideous like:
(1) the key delegate is gray and alive
(2) the key somehow reaches the map without passing through its delegate, and nothing refers to it
(3) the map is gray, and part of a garbage cycle passing through DOM.
I'm not sure (2) is actually possible right now, as I have the vague impression that anything with a delegate only has its wrappee as an outgoing edge. So we don't really need to try to construct a test case for this.
But anyways, if you could set that up, then the GC would trace from a gray root to the map, triggering the weak map key marking code, which would end up marking the key gray.
During cycle collection, the key delegate would get marked black. Then, in my erroneous version of this code, during weak map marking we'd end up marking the key black, which would cause the map to get marked black. The GC and CC would agree that the map is alive, so I don't think we would have anything dangerous, but we would end up leaking the weak map, and anything it held alive.
Oh, maybe I thought of a way to construct condition (2). Can a proxy be the delegate of another proxy? I guess not, because you fully unwrap to compute the delegate. Never mind then.
Anyways, in summary, I'm glad you wrote this part and not me.
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: review?(continuation) → review+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=798678#c31)• 12 years ago |
|  | |

Comment on [attachment 671626](/attachment.cgi?id=671626 "test for CC patch") [[details]](/attachment.cgi?id=671626&action=edit "test for CC patch") [[diff]](/attachment.cgi?id=671626&action=diff "test for CC patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671626)
test for CC patch
Review of [attachment 671626](/attachment.cgi?id=671626 "test for CC patch") [[details]](/attachment.cgi?id=671626&action=edit "test for CC patch") [[diff]](/attachment.cgi?id=671626&action=diff "test for CC patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671626):
-----------------------------------------------------------------
::: js/src/jsweakmap.cpp
@@ +282,5 @@
> ObjectValueMap \*map = GetObjectMap(obj);
> if (map) {
> for (ObjectValueMap::Base::Range r = map->all(); !r.empty(); r.popFront()) {
> + RootedObject key(cx, r.front().key);
> + if (!JS\_WrapObject(cx, key.address()))
I assume wrap is smart enough to not wrap if it is same compartment?
::: js/xpconnect/tests/chrome/test\_weakmap\_keys\_preserved2.xul
@@ +23,5 @@
> + let Cu = Components.utils;
> + let Ci = Components.interfaces;
> +
> + window.QueryInterface(Ci.nsIInterfaceRequestor)
> + .getInterface(Ci.nsIDOMWindowUtils)
nit: I think you can do SpecialPowers.DOMWindowUtils.garbageCollect().
@@ +31,5 @@
> + return document.getElementById("testelem");
> + };
> +
> + let wrappers\_as\_keys\_test = function () {
> + let e = document.createEvent("MessageEvent");
Please add a comment here that you are creating an unoptimizable edge from DOM to JS, to create a live gray JS object.
@@ +57,5 @@
> + live\_dom.xyzabc = {wrappee: wrappee, m: map, sb: sandbox};
> +
> + let key = Cu.nondeterministicGetWeakMapKeys(map)[0];
> + let value = map.get(key);
> + is(value.children.length, 1, "children have wrong lengthA");
nit: "lengthA"
@@ +67,5 @@
> + let live\_dom = window.eeeevent.data.dummy;
> + let live\_map = live\_dom.xyzabc.m;
> + let sandbox = live\_dom.xyzabc.sb;
> + is(Cu.nondeterministicGetWeakMapKeys(live\_map).length, 1,
> + "Map should not be empty.");
nit: trailing whitespace
@@ +73,5 @@
> + let value = live\_map.get(key);
> + is(value.children.length, 1, "children have wrong length");
> + }
> +
> + dump('collecting...\n');
nit: Do you mean for these two |dump|s to be here?
@@ +85,5 @@
> + .getInterface(Ci.nsIDOMWindowUtils)
> + .garbageCollect();
> + dump('cc done...\n');
> +
> + check\_wrappers\_as\_keys();
So this fails without your CC patch and passes with it? It is interesting that you don't need precise GC stuff. I wonder if Luke's scoping work has made stuff hang around less.
@@ +87,5 @@
> + dump('cc done...\n');
> +
> + check\_wrappers\_as\_keys();
> +
> + ok(true, "");
nit: Does this |ok| do anything?
[Attachment #671626](/attachment.cgi?id=671626&action=edit "test for CC patch") -
Flags: review?(continuation) → review+

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=798678#c32)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/4ca5990b24d5>
<https://hg.mozilla.org/integration/mozilla-inbound/rev/1e5bf398fc88>
<https://hg.mozilla.org/integration/mozilla-inbound/rev/2f193f44cb99>
I did not push the crashing test.

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=798678#c33)• 12 years ago |
|  | |

Attached patch

[test for this bug, v2](attachment.cgi?id=672628&action=diff)
— [Details](attachment.cgi?id=672628&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=672628)

Updated test, which needs to be landed when this bug opens.
[Attachment #670892](/attachment.cgi?id=670892&action=edit "test for this bug") -
Attachment is obsolete: true
[Attachment #672628](/attachment.cgi?id=672628&action=edit "test for this bug, v2") -
Flags: review+

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a1035649_389993)• 12 years ago |

Flags: in-testsuite?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=798678#c34)• 12 years ago |
|  | |

Comment on [attachment 671625](/attachment.cgi?id=671625 "bugfix for CC, v1") [[details]](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") [[diff]](/attachment.cgi?id=671625&action=diff "bugfix for CC, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671625)
bugfix for CC, v1
[Approval Request Comment]
Bug caused by (feature/regressing bug #): [bug 673468](/show_bug.cgi?id=673468 "RESOLVED FIXED - Wrapped JS objects used as keys can disappear from WeakMaps")
User impact if declined: Crashes are unlikely from the issue, but it could be exploited.
Testing completed (on m-c, etc.): Tryserver
Risk to taking this patch (and alternatives if risky): See previous comment.
String or UUID changes made by this patch: None.
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: approval-mozilla-beta?
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: approval-mozilla-aurora?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=798678#c35)• 12 years ago |
|  | |

Comment on [attachment 672628](/attachment.cgi?id=672628 "test for this bug, v2") [[details]](/attachment.cgi?id=672628&action=edit "test for this bug, v2") [[diff]](/attachment.cgi?id=672628&action=diff "test for this bug, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=672628)
test for this bug, v2
[Approval Request Comment]
Bug caused by (feature/regressing bug #): [bug 673468](/show_bug.cgi?id=673468 "RESOLVED FIXED - Wrapped JS objects used as keys can disappear from WeakMaps")
User impact if declined: Crashes are unlikely from the issue, but it could be exploited.
Testing completed (on m-c, etc.): Tryserver
Risk to taking this patch (and alternatives if risky): See [comment 14](/show_bug.cgi?id=798678#c14 "RESOLVED FIXED - WeakMaps with keys from another compartment are possible and incorrect").
String or UUID changes made by this patch: None.
[Attachment #672628](/attachment.cgi?id=672628&action=edit "test for this bug, v2") -
Flags: approval-mozilla-beta?
[Attachment #672628](/attachment.cgi?id=672628&action=edit "test for this bug, v2") -
Flags: approval-mozilla-aurora?

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=798678#c36)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/4ca5990b24d5>
<https://hg.mozilla.org/mozilla-central/rev/1e5bf398fc88>
<https://hg.mozilla.org/mozilla-central/rev/2f193f44cb99>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla19

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=798678#c37)• 12 years ago |
|  | |

Please flag the patch for sec-approval? and fill out the comment form so that we can make sure we're aligned with the security group in timing the landing here.

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=798678#c38)• 12 years ago |
|  | |

(In reply to Lukas Blakk [:lsblakk] from [comment #37](/show_bug.cgi?id=798678#c37 "RESOLVED FIXED - WeakMaps with keys from another compartment are possible and incorrect"))
> Please flag the patch for sec-approval? and fill out the comment form so
> that we can make sure we're aligned with the security group in timing the
> landing here.
I did that in comments 14 and 16. I revised the patch after that, but it seems like nothing materially changed that would affect the approval. Should I have done something differently? What are these approvals based on, anyway?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=798678#c39)• 12 years ago |
|  | |

Comment on [attachment 671625](/attachment.cgi?id=671625 "bugfix for CC, v1") [[details]](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") [[diff]](/attachment.cgi?id=671625&action=diff "bugfix for CC, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671625)
bugfix for CC, v1
No, you did it right - thanks for pointing out that you already got the + (it wasn't visible to me as it was on obsolete patch). That approval means we're OK to land to branches, so it's good enough for me - approving uplift.
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: approval-mozilla-beta?
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: approval-mozilla-beta+
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: approval-mozilla-aurora?
[Attachment #671625](/attachment.cgi?id=671625&action=edit "bugfix for CC, v1") -
Flags: approval-mozilla-aurora+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=798678#c40)• 12 years ago |
|  | |

That said - did the patch you got sec-approval+ on include the test? I know we sometimes hold back on checking in tests - can someone confirm if it's ok to land this bug's test so early?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a1186532_389993)• 12 years ago |

[Attachment #672628](/attachment.cgi?id=672628&action=edit "test for this bug, v2") -
Flags: approval-mozilla-beta?
[Attachment #672628](/attachment.cgi?id=672628&action=edit "test for this bug, v2") -
Flags: approval-mozilla-aurora?

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=798678#c41)• 12 years ago |
|  | |

Comment on [attachment 671624](/attachment.cgi?id=671624 "bugfix patch, v4") [[details]](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") [[diff]](/attachment.cgi?id=671624&action=diff "bugfix patch, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671624)
bugfix patch, v4
Sorry, I asked for approval on the wrong patch. This is the one that needs to go to branches.
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: approval-mozilla-beta?
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=798678#c42)• 12 years ago |
|  | |

Comment on [attachment 671624](/attachment.cgi?id=671624 "bugfix patch, v4") [[details]](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") [[diff]](/attachment.cgi?id=671624&action=diff "bugfix patch, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=798678&attachment=671624)
bugfix patch, v4
Approved. Also, disregard my statements about sec-approval - I was misunderstanding the process, it's for timing landings of sec fixes on trunk, not on branches.
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: approval-mozilla-beta?
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: approval-mozilla-beta+
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: approval-mozilla-aurora?
[Attachment #671624](/attachment.cgi?id=671624&action=edit "bugfix patch, v4") -
Flags: approval-mozilla-aurora+

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=798678#c43)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/03d9d6422563>
<https://hg.mozilla.org/releases/mozilla-aurora/rev/a771f271cf89>

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=798678#c44)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/1a0dda83a95c>
<https://hg.mozilla.org/releases/mozilla-beta/rev/106c005654e5>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a1203295_75935)• 12 years ago |

[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a2327204_280903)• 12 years ago |

Whiteboard: [adv-track-main17+]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a3538853_406194)• 12 years ago |

Depends on: [812380](/show_bug.cgi?id=812380 "RESOLVED FIXED - Possible use-after-CC-Unlink due to incorrect cycle collector WeakMap optimizations")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a9464437_406194)• 12 years ago |

Depends on: [819131](/show_bug.cgi?id=819131 "RESOLVED FIXED - Cross-compartment DOM element references disappear from WeakMaps")

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=798678#c45)• 12 years ago |
|  | |

This doesn't appear to have made it into ESR17 yet. Is B2G also affected?
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- → [20+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=20%2B)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=798678#c46)• 12 years ago |
|  | |

It was apparently fixed on 18, so it should be fixed on b2g18, too.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=798678#c47)• 12 years ago |
|  | |

Thanks Andrew. ni? on billm for to get an uplift request to mozilla-esr17.Flags: needinfo?(wmccloskey)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=798678#c48)• 12 years ago |
|  | |

It was fixed on 17, so it's in esr17. I verified that it's in the esr17 repo.Flags: needinfo?(wmccloskey)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a13822142_406194)• 12 years ago |

[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=798678#a14149644_1689)• 12 years ago |

Group: core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=798678#c49)• 11 years ago |
|  | |

Bill, could you look into landing the tests for this bug? I just noticed they hadn't landed.Flags: needinfo?(wmccloskey)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=798678#c50)• 11 years ago |
|  | |

Tests for this bug:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/bdf89c928543>Flags: needinfo?(wmccloskey)Flags: in-testsuite?Flags: in-testsuite+

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=798678#c51)• 11 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/bdf89c928543>
You need to [log in](/show_bug.cgi?id=798678&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_062f09d3_20250124_141015.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/797163)
* [XML](/show_bug.cgi?ctype=xml&id=797163)

Closed
[Bug 797163](/show_bug.cgi?id=797163)

Opened 12 years ago
Closed 12 years ago

# "Assertion failure: lifetime->entry == uint32\_t(entryTarget - outerScript->code),"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"Assertion failure: lifetime->entry == uint32\_t(entryTarget - outerScript->code),"

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix) |
| firefox16 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified) |
| firefox19 | [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=verified) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 |  | wontfix |
| firefox16 |  | wontfix |
| firefox17 | + | verified |
| firefox18 | + | verified |
| firefox19 | + | verified |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: jandem)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/709c5feed942bf99f098bb24aa1cc86f?d=mm&size=40)  [jandem](/user_profile?user_id=375297)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=40)  [mwobensmith](/user_profile?user_id=452604)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=797163&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=797163)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, sec-critical, testcase, Whiteboard: Fixed by patch in bug 781859 [jsbugmon:update,ignore][adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

Fixed by patch in bug 781859 [jsbugmon:update,ignore][adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [decoder](/user_profile?user_id=395101) | [in-testsuite](#c7 "12 years ago") | - |
| --- | --- | --- |
| [decoder](/user_profile?user_id=395101) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [stack](/attachment.cgi?id=667198)  [12 years ago](#c0)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   7.20 KB, text/plain |  | [Details](/attachment.cgi?id=667198&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=797163#c0)• 12 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=667198)
— [Details](attachment.cgi?id=667198&action=edit)

function f() {
switch (2) {
default:
y = newGlobal()
}
return function(code) {
try {
evalcx(code, y)
} catch (e) {}
}
}
function h(code) {
g(code)
}
g = f()
mjitChunkLimit(1)
h("let x=s")
h("switch(x){\
case 2:break;\
b;\
default:while(this){}\
}")
asserts js debug shell on m-c changeset 640a57ebab48 without any CLI arguments at Assertion failure: lifetime->entry == uint32\_t(entryTarget - outerScript->code),
s-s because [bug 781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80") is s-s, also adapting flags from that bug.
This is likely fixed by the upcoming patch in [bug 781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80"), filing to (hopefully) get this testcase in the tree.Flags: in-testsuite?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a166800_1689)• 12 years ago |

Depends on: [781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80")Whiteboard: [jsbugmon:update] → [jsbugmon:update] possibly will be fixed by patch in bug 781859

|  | [Naveed Ihsanullah [:naveed]](/user_profile?user_id=441971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a770537_441971)• 12 years ago |

Assignee: general → jdemooij

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a771719_152868)• 12 years ago |

Assignee: jdemooij → general
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a771734_1689)• 12 years ago |

Assignee: general → jdemooij
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a1832079_395101)• 12 years ago |

Whiteboard: [jsbugmon:update] possibly will be fixed by patch in bug 781859 → possibly will be fixed by patch in bug 781859 [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=797163#c1)• 12 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 93cc1ee94291).

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a1833810_132034)• 12 years ago |

Whiteboard: possibly will be fixed by patch in bug 781859 [jsbugmon:update,ignore] → possibly will be fixed by patch in bug 781859 [jsbugmon:update,bisectfix]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a1837720_395101)• 12 years ago |

Whiteboard: possibly will be fixed by patch in bug 781859 [jsbugmon:update,bisectfix] → possibly will be fixed by patch in bug 781859 [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=797163#c2)• 12 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 93cc1ee94291).
JSBugMon: Fix Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first good revision is:
changeset: 111150:0d60a2c574f4
user: Brian Hackett
date: Tue Oct 23 07:45:34 2012 -0700
summary: Don't get confused by unreachable opcodes before loop headers when picking chunk boundaries, [bug 781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80"). r=jandem
This iteration took 204.724 seconds to run.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=797163#c3)• 12 years ago |
|  | |

Highly likely fixed by [bug 781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80").
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed)Whiteboard: possibly will be fixed by patch in bug 781859 [jsbugmon:update,ignore] → Fixed by patch in bug 781859 [jsbugmon:update,ignore]

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a1902840_132034)• 12 years ago |

Status: NEW → RESOLVEDClosed: 12 years agoResolution: --- → FIXED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a1906674_395101)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=797163#c4)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=797163#c5)• 12 years ago |
|  | |

Matt - can you verify this is fixed in FF17/18 as well? Thanks!Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)QA Contact: general → mwobensmith

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a3007235_279076)• 12 years ago |

Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---) → [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=797163#c6)• 12 years ago |
|  | |

Confirmed assertion on build 2012-10-2, nightly
Verified fixed on build 2012-11-6, nightly
Verified fixed on build 2012-11-6, Aurora 18
Verified fixed on build 2012-11-6, Beta 17

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a3025856_452604)• 12 years ago |

[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=verified)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a3025977_452604)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a3118084_280903)• 12 years ago |

Whiteboard: Fixed by patch in bug 781859 [jsbugmon:update,ignore] → Fixed by patch in bug 781859 [jsbugmon:update,ignore][adv-track-main17+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=797163#a14421969_1689)• 12 years ago |

Group: core-security

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=797163#c7)• 12 years ago |
|  | |

[Bug 781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80") already has a test, not taking this one.Flags: in-testsuite? → in-testsuite-
You need to [log in](/show_bug.cgi?id=797163&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.opensuse.org_8ff49ee4_20250124_140948.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG/#MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG)

# openSUSE-SU-2012:1585-1: moderate: update for MozillaThunderbird

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

28 Nov
2012

28 Nov
'12

16:09

openSUSE Security Update: update for MozillaThunderbird
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2012:1585-1
Rating: moderate
References: #790140
Cross-References: CVE-2012-4201 CVE-2012-4202 CVE-2012-4204
CVE-2012-4205 CVE-2012-4207 CVE-2012-4208
CVE-2012-4209 CVE-2012-4212 CVE-2012-4213
CVE-2012-4214 CVE-2012-4215 CVE-2012-4216
CVE-2012-4217 CVE-2012-4218 CVE-2012-5829
CVE-2012-5830 CVE-2012-5833 CVE-2012-5835
CVE-2012-5836 CVE-2012-5837 CVE-2012-5838
CVE-2012-5839 CVE-2012-5840 CVE-2012-5841
CVE-2012-5842 CVE-2012-5843
Affected Products:
openSUSE 12.2
openSUSE 12.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 26 vulnerabilities is now available.
Description:
Changes in MozillaThunderbird:
- update to Thunderbird 17.0 (bnc#790140)
\* MFSA 2012-91/CVE-2012-5842/CVE-2012-5843 Miscellaneous
memory safety hazards
\* MFSA 2012-92/CVE-2012-4202 (bmo#758200) Buffer overflow
while rendering GIF images
\* MFSA 2012-93/CVE-2012-4201 (bmo#747607) evalInSanbox
location context incorrectly applied
\* MFSA 2012-94/CVE-2012-5836 (bmo#792857) Crash when
combining SVG text on path with CSS
\* MFSA 2012-96/CVE-2012-4204 (bmo#778603) Memory
corruption in str\_unescape
\* MFSA 2012-97/CVE-2012-4205 (bmo#779821) XMLHttpRequest
inherits incorrect principal within sandbox
\* MFSA 2012-99/CVE-2012-4208 (bmo#798264) XrayWrappers
exposes chrome-only properties when not in chrome
compartment
\* MFSA 2012-100/CVE-2012-5841 (bmo#805807) Improper
security filtering for cross-origin wrappers
\* MFSA 2012-101/CVE-2012-4207 (bmo#801681) Improper
character decoding in HZ-GB-2312 charset
\* MFSA 2012-102/CVE-2012-5837 (bmo#800363) Script entered
into Developer Toolbar runs with chrome privileges
\* MFSA 2012-103/CVE-2012-4209 (bmo#792405) Frames can
shadow top.location
\* MFSA
2012-105/CVE-2012-4214/CVE-2012-4215/CVE-2012-4216/
CVE-2012-5829/CVE-2012-5839/CVE-2012-5840/CVE-2012-4212/ CVE
-2012-4213/CVE-2012-4217/CVE-2012-4218 Use-after-free
and buffer overflow issues found using Address Sanitizer
\* MFSA
2012-106/CVE-2012-5830/CVE-2012-5833/CVE-2012-5835/CVE-2012-
5838 Use-after-free, buffer overflow, and memory
corruption issues found using Address Sanitizer
- rebased patches
- disabled WebRTC since build is broken (bmo#776877)
- update Enigmail to 1.4.6
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.2:
zypper in -t patch openSUSE-2012-818
- openSUSE 12.1:
zypper in -t patch openSUSE-2012-818
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.2 (i586 x86\_64):
MozillaThunderbird-17.0-49.23.1
MozillaThunderbird-buildsymbols-17.0-49.23.1
MozillaThunderbird-debuginfo-17.0-49.23.1
MozillaThunderbird-debugsource-17.0-49.23.1
MozillaThunderbird-devel-17.0-49.23.1
MozillaThunderbird-devel-debuginfo-17.0-49.23.1
MozillaThunderbird-translations-common-17.0-49.23.1
MozillaThunderbird-translations-other-17.0-49.23.1
enigmail-1.4.6+17.0-49.23.1
enigmail-debuginfo-1.4.6+17.0-49.23.1
- openSUSE 12.1 (i586 x86\_64):
MozillaThunderbird-17.0-33.43.1
MozillaThunderbird-buildsymbols-17.0-33.43.1
MozillaThunderbird-debuginfo-17.0-33.43.1
MozillaThunderbird-debugsource-17.0-33.43.1
MozillaThunderbird-devel-17.0-33.43.1
MozillaThunderbird-devel-debuginfo-17.0-33.43.1
MozillaThunderbird-translations-common-17.0-33.43.1
MozillaThunderbird-translations-other-17.0-33.43.1
enigmail-1.4.6+17.0-33.43.1
enigmail-debuginfo-1.4.6+17.0-33.43.1
References:
<http://support.novell.com/security/cve/CVE-2012-4201.html>
<http://support.novell.com/security/cve/CVE-2012-4202.html>
<http://support.novell.com/security/cve/CVE-2012-4204.html>
<http://support.novell.com/security/cve/CVE-2012-4205.html>
<http://support.novell.com/security/cve/CVE-2012-4207.html>
<http://support.novell.com/security/cve/CVE-2012-4208.html>
<http://support.novell.com/security/cve/CVE-2012-4209.html>
<http://support.novell.com/security/cve/CVE-2012-4212.html>
<http://support.novell.com/security/cve/CVE-2012-4213.html>
<http://support.novell.com/security/cve/CVE-2012-4214.html>
<http://support.novell.com/security/cve/CVE-2012-4215.html>
<http://support.novell.com/security/cve/CVE-2012-4216.html>
<http://support.novell.com/security/cve/CVE-2012-4217.html>
<http://support.novell.com/security/cve/CVE-2012-4218.html>
<http://support.novell.com/security/cve/CVE-2012-5829.html>
<http://support.novell.com/security/cve/CVE-2012-5830.html>
<http://support.novell.com/security/cve/CVE-2012-5833.html>
<http://support.novell.com/security/cve/CVE-2012-5835.html>
<http://support.novell.com/security/cve/CVE-2012-5836.html>
<http://support.novell.com/security/cve/CVE-2012-5837.html>
<http://support.novell.com/security/cve/CVE-2012-5838.html>
<http://support.novell.com/security/cve/CVE-2012-5839.html>
<http://support.novell.com/security/cve/CVE-2012-5840.html>
<http://support.novell.com/security/cve/CVE-2012-5841.html>
<http://support.novell.com/security/cve/CVE-2012-5842.html>
<http://support.novell.com/security/cve/CVE-2012-5843.html>
<https://bugzilla.novell.com/790140>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG/#MY2D2TUUOWA46VJCDZMJWS4GCJMHJMGG)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.mozilla.org_7ac9d540_20250124_141000.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/774953)
* [XML](/show_bug.cgi?ctype=xml&id=774953)

Closed
[Bug 774953](/show_bug.cgi?id=774953)

Opened 13 years ago
Closed 12 years ago

# "Assertion failure: [infer failure] Missing type pushed 0" with iframes, adoptNode

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"Assertion failure: [infer failure] Missing type pushed 0" with iframes, adoptNode

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla17

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | --- | [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) |
| firefox17 | --- | [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 |  | affected |
| firefox17 |  | verified |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: bhackett1024)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/764aa0af2fda6f02fb17dc9771bb18d9?d=mm&size=40)  [bhackett1024](/user_profile?user_id=346231)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[766447](/show_bug.cgi?id=766447 "RESOLVED FIXED - TI: Allow tracking of DOM instances in TypeObjects")

Dependency [tree](/showdependencytree.cgi?id=774953&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=774953)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[779020](/show_bug.cgi?id=779020 "RESOLVED DUPLICATE - IonMonkey: TypeFailure on tests/content/base/test/test_bug682592.html"), [780850](/show_bug.cgi?id=780850 "RESOLVED DUPLICATE - Fix \"Assertion failure: [infer failure] Missing type pushed 0\" in content/base/test/test_bug682592.html")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, sec-critical, testcase, Whiteboard: [js:p1:fx17][adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[js:p1:fx17][adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [testcase](/attachment.cgi?id=643204)  [13 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   382 bytes, text/html |  | [Details](/attachment.cgi?id=643204&action=edit) |
| --- | --- | --- |
| [TI spew & stack trace](/attachment.cgi?id=643205)  [13 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   18.10 KB, text/plain |  | [Details](/attachment.cgi?id=643205&action=edit) |
| [patch](/attachment.cgi?id=651062)  [12 years ago](#c7)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   1.88 KB, patch | dvander : [review+](#c8 "12 years ago") | [Details](/attachment.cgi?id=651062&action=edit) | [Diff](/attachment.cgi?id=651062&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=774953&attachment=651062) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=774953#c0)• 13 years ago |
|  | |

Attached file
[testcase](attachment.cgi?id=643204)
— [Details](attachment.cgi?id=643204&action=edit)

With
user\_pref("javascript.options.methodjit\_always", true);
the testcase triggers:
Assertion failure: [infer failure] Missing type pushed 0: [0x10a0398e0], at js/src/jsinfer.cpp:325
Based on js/xpconnect/crashtests/515726-1.html

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=774953#c1)• 13 years ago |
|  | |

Attached file
[TI spew & stack trace](attachment.cgi?id=643205)
— [Details](attachment.cgi?id=643205&action=edit)

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a91476_294323)• 13 years ago |

Whiteboard: [js:p1]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a666034_1689)• 13 years ago |

Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Naveed Ihsanullah [:naveed]](/user_profile?user_id=441971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a829523_441971)• 12 years ago |

Whiteboard: [js:p1] → [js:p1:fx17]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a1368223_1689)• 12 years ago |

[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=774953#c3)• 12 years ago |
|  | |

I'm in the process of bisecting this. It is a bug on mozilla-central but is only causing problems on the IonMonkey TBPL for some reason.Assignee: general → dvanderStatus: NEW → ASSIGNED

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=774953#c5)• 12 years ago |
|  | |

Bisected to [bug 766447](/show_bug.cgi?id=766447 "RESOLVED FIXED - TI: Allow tracking of DOM instances in TypeObjects").Blocks: [766447](/show_bug.cgi?id=766447 "RESOLVED FIXED - TI: Allow tracking of DOM instances in TypeObjects")

|  | [Eric Faust [:efaust]](/user_profile?user_id=442736) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=774953#c6)• 12 years ago |
|  | |

The problem has something to do with the proto->setNewTypeUnknown() call that was removed from JS\_NewObject(). The problem seems to be that if the objects are swap()ed, then the type information will be inaccurate.

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=774953#c7)• 12 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=651062&action=diff)
— [Details](attachment.cgi?id=651062&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=774953&attachment=651062)

This passes the testcases in this bug and [bug 779020](/show_bug.cgi?id=779020 "RESOLVED DUPLICATE - IonMonkey: TypeFailure on tests/content/base/test/test_bug682592.html") (got the crash without the patch in [bug 779020](/show_bug.cgi?id=779020 "RESOLVED DUPLICATE - IonMonkey: TypeFailure on tests/content/base/test/test_bug682592.html"), didn't test with this one). The problem is that JSObject::swap swaps the two types of the objects, which will break the correctness of type sets which either object appeared in if the objects have not had all sets they appear in marked as unknown. This fix keeps the type of an object stable across swaps, though it will get SetProto'ed to get the prototype of the other object which will mark its sets as unknown anyways.Assignee: dvander → bhackett1024
[Attachment #651062](/attachment.cgi?id=651062&action=edit "patch") -
Flags: review?(dvander)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=774953#c8)• 12 years ago |
|  | |

Comment on [attachment 651062](/attachment.cgi?id=651062 "patch") [[details]](/attachment.cgi?id=651062&action=edit "patch") [[diff]](/attachment.cgi?id=651062&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=774953&attachment=651062)
patch
Thanks!
[Attachment #651062](/attachment.cgi?id=651062&action=edit "patch") -
Flags: review?(dvander) → review+

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=774953#c9)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/d093de44e850>

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=774953#c10)• 12 years ago |
|  | |

Backed out in <http://hg.mozilla.org/integration/mozilla-inbound/rev/b753e1dce89f> - mochitest-chrome, "dom/tests/mochitest/whatwg/test\_postMessage\_chrome.html | Test timed out," so far looking like every OS and opt+debug.

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=774953#c11)• 12 years ago |
|  | |

ReserveForTradeGuts had a premature return that skipped the prototype swapping.
<https://hg.mozilla.org/integration/mozilla-inbound/rev/d29b79c37f86>

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=774953#c12)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/d29b79c37f86>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla17

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=774953#c13)• 12 years ago |
|  | |

Marking as unaffected since [bug 766447](/show_bug.cgi?id=766447 "RESOLVED FIXED - TI: Allow tracking of DOM instances in TypeObjects"), the regressing bug, landed in FF16.
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a5432596_279076)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=774953#c14)• 12 years ago |
|  | |

Verified.
Confirmed testcase crashes 2012-7-17 Firefox 17.0a1 Nightly Debug
Confirmed testcase crashes 2012-9-29 Firefox 16.0 Nightly Debug
Does not crash 2012-10-17 Firefox 17.0b2Status: RESOLVED → VERIFIED
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a9153710_280903)• 12 years ago |

Whiteboard: [js:p1:fx17] → [js:p1:fx17][adv-track-main17+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a21065257_1689)• 12 years ago |

Group: core-security

|  | [Marc Schifer [mschifer]](/user_profile?user_id=466789) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=774953#a50873143_466789)• 11 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)
You need to [log in](/show_bug.cgi?id=774953&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_38facce8_20250124_141003.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/781859)
* [XML](/show_bug.cgi?ctype=xml&id=781859)

Closed
[Bug 781859](/show_bug.cgi?id=781859)

Opened 12 years ago
Closed 12 years ago

# Assertion failure: lifetime && lifetime->head == uint32\_t(head - outerScript->code) && lifetime->entry == uint32\_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: lifetime && lifetime->head == uint32\_t(head - outerScript->code) && lifetime->entry == uint32\_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla19

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix) |
| firefox16 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) |
| firefox19 | [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 |  | wontfix |
| firefox16 |  | wontfix |
| firefox17 | + | fixed |
| firefox18 | + | fixed |
| firefox19 | + | fixed |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: bhackett1024)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/764aa0af2fda6f02fb17dc9771bb18d9?d=mm&size=40)  [bhackett1024](/user_profile?user_id=346231)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[720316](/show_bug.cgi?id=720316 "RESOLVED INVALID - Remove indexbase support")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[797163](/show_bug.cgi?id=797163 "VERIFIED FIXED - \"Assertion failure: lifetime->entry == uint32_t(entryTarget - outerScript->code),\"")

Dependency [tree](/showdependencytree.cgi?id=781859&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=781859)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[741110](/show_bug.cgi?id=741110 "RESOLVED DUPLICATE - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:111"), [770089](/show_bug.cgi?id=770089 "RESOLVED DUPLICATE - \"Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code),\"")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[741110](/show_bug.cgi?id=741110 "RESOLVED DUPLICATE - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:111"), [770089](/show_bug.cgi?id=770089 "RESOLVED DUPLICATE - \"Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code),\"")

## Details

### (4 keywords, Whiteboard: [js:p1:fx18] [jsbugmon:update,ignore][adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[js:p1:fx18] [jsbugmon:update,ignore][adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c32 "12 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 3 obsolete files)

| [Part 1: Add SRC\_DO](/attachment.cgi?id=667006)  [12 years ago](#c12)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   10.01 KB, patch |  | [Details](/attachment.cgi?id=667006&action=edit) | [Diff](/attachment.cgi?id=667006&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667006) |
| --- | --- | --- |
| [Part 2: Emit JSOP\_NOP at the top of while loops](/attachment.cgi?id=667010)  [12 years ago](#c13)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   10.40 KB, patch |  | [Details](/attachment.cgi?id=667010&action=edit) | [Diff](/attachment.cgi?id=667010&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667010) |
| [Part 3: Add shell function to test the decompiler](/attachment.cgi?id=667022)  [12 years ago](#c14)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   3.79 KB, patch |  | [Details](/attachment.cgi?id=667022&action=edit) | [Diff](/attachment.cgi?id=667022&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667022) |
| [Patch v2](/attachment.cgi?id=667095)  [12 years ago](#c17)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   5.88 KB, patch | dvander : [review+](#a4590263_309316 "12 years ago")  gkw : [feedback+](#c25 "12 years ago") | [Details](/attachment.cgi?id=667095&action=edit) | [Diff](/attachment.cgi?id=667095&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667095) |
| [patch](/attachment.cgi?id=674069)  [12 years ago](#c26)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   730 bytes, patch | jandem : [review+](#c27 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a6929667_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a6929667_272375 "12 years ago") | [Details](/attachment.cgi?id=674069&action=edit) | [Diff](/attachment.cgi?id=674069&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=674069) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=781859#c0)• 12 years ago |
|  | |

The following test asserts on mozilla-central revision b5ae446888f5 (options -m -n -a):
function e() {
try {} catch (e) {
return (actual = "FAIL");
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
a.x + a.x + a.x + a.x + a.x + a.x + a.x + a.x
}
while (t) continue;
}
e();
I believe this is something different than [bug 741110](/show_bug.cgi?id=741110 "RESOLVED DUPLICATE - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:111") and [bug 770089](/show_bug.cgi?id=770089 "RESOLVED DUPLICATE - \"Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code),\"") since the test looks entirely different and doesn't depend on mjitChunkLimit. S-s due to previous bugs with that assertion being security-relevant.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a931652_395101)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update,bisect]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a932584_395101)• 12 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=781859#c1)• 12 years ago |
|  | |

JSBugMon: Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 87695:f4e955f78de9
user: Jeff Walden
date: Fri Feb 03 18:53:29 2012 -0800
summary: [Bug 720316](/show_bug.cgi?id=720316 "RESOLVED INVALID - Remove indexbase support") - Use uint32\_t indexes for JOF\_ATOM opcodes. r=jorendorff

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=781859#c2)• 12 years ago |
|  | |

Waldo or Jason, mind taking a look at this?

|  | [Jason Orendorff [:jorendorff]](/user_profile?user_id=281791) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=781859#c3)• 12 years ago |
|  | |

sure.Assignee: general → jorendorff

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a1036509_152868)• 12 years ago |

Depends on: [720316](/show_bug.cgi?id=720316 "RESOLVED INVALID - Remove indexbase support")Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=781859#c4)• 12 years ago |
|  | |

Provisionally calling this sec-critical. Always welcome thoughts from those closer to the code.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Jason Orendorff [:jorendorff]](/user_profile?user_id=281791) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=781859#c5)• 12 years ago |
|  | |

Full assertion is:
JS\_ASSERT(lifetime &&
lifetime->head == uint32\_t(head - outerScript->code) &&
lifetime->entry == uint32\_t(entryTarget - outerScript->code));
lifetime->entry is 1507 (points to JSOP\_LOOPHEAD)
entryTarget - outerScript->code is 1506 (points to JSOP\_LOOPENTRY)

|  | [Jason Orendorff [:jorendorff]](/user_profile?user_id=281791) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a1049011_281791)• 12 years ago |

Assignee: jorendorff → bhackett1024

|  | [Naveed Ihsanullah [:naveed]](/user_profile?user_id=441971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a1132945_441971)• 12 years ago |

[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=781859#c6)• 12 years ago |
|  | |

[Bug 720316](/show_bug.cgi?id=720316 "RESOLVED INVALID - Remove indexbase support") is likely a bogus dependency, just as the original dependency in [bug 770089](/show_bug.cgi?id=770089 "RESOLVED DUPLICATE - \"Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code),\"") was, and this possibly goes back to chunked compilation notwithstanding the absence of mjitChunkLimit from the testcase. (In effect every script has an implicit |mjitChunkLimit(#)| call in it, actually, for some value of # that I don't know offhand. This just manages to crash with whatever that default limit is.) Therefore this might well be a dup of one of the other two bugs, although there's no actual evidence beyond the common assertion -- and, come to see it, this having a try-catch-then-loop structure in common with the testcase for [bug 741110](/show_bug.cgi?id=741110 "RESOLVED DUPLICATE - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:111"). If there's a dup relationship, and there may well not be one, I bet it's with that bug.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=781859#c7)• 12 years ago |
|  | |

Synchronizing flags with [bug 741110](/show_bug.cgi?id=741110 "RESOLVED DUPLICATE - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:111") and [bug 770089](/show_bug.cgi?id=770089 "RESOLVED DUPLICATE - \"Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code),\"").
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)See Also: → [741110](/show_bug.cgi?id=741110 "RESOLVED DUPLICATE - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:111"), [770089](/show_bug.cgi?id=770089 "RESOLVED DUPLICATE - \"Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code),\"")

|  | [Naveed Ihsanullah [:naveed]](/user_profile?user_id=441971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a2666005_441971)• 12 years ago |

Assignee: bhackett1024 → jwalden+bmoWhiteboard: [jsbugmon:update] → [jsbugmon:update][js:p1:fx18]

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a3552230_152868)• 12 years ago |

[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix)

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=781859#c8)• 12 years ago |
|  | |

I'm sure critsmash is going to be interested in this bug (and the other bugs with similar-looking assertions) today, so...
Right before he left bhackett said something about thinking the assertion was wrong, but he didn't give any explanation at the time, and I haven't been able to verify that one way or the other yet. So the short answer is that I don't know yet what's up here. (And obviously that doesn't apply to the one similar-looking bug where an out-and-out crash was reported.)

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=781859#c9)• 12 years ago |
|  | |

Thanks Jeff, it helps (really). Hopefully work on the other two bugs helps illuminate this one.

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=781859#c10)• 12 years ago |
|  | |

billm and I looked at this for half an hour or so on Thursday afternoon. Neither of us understands chunked compilation, so we're pretty much stumbling in the dark on this. And I have been told chunked compilation -- as done in JM, at least -- doesn't really have things like invariants. So there's apparently not really a good way to understand how chunked compilation works.
dvander says jandem is the person best positioned to understand JM chunked compilation -- maybe he'd be able to figure this out quickly? 'cause it's going to take me awhile to do this, if I'm to be the one to do it. :-\

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=781859#c11)• 12 years ago |
|  | |

Yeah this is a chunked compilation issue. While-loops have the following bytecode structure:
00000: goto 6 (+6)
00005: loophead
--- body ---
00006: loopentry
--- condition ---
00008: ifne 5 (-3)
00013: stop
When splitting the script in chunks, we try to ensure the initial GOTO is in the same chunk as the LOOPHEAD following it. The way this works is if we are at op X, we check if X + 2 is a LOOPHEAD and if so start a new chunk at X + 1 (the GOTO).
This works fine in most cases, except if the op at offset X, before the GOTO, is unreachable/dead. Unreachable ops are skipped so we don't run the check and hence it's possible to start a chunk at the LOOPHEAD, and the GOTO is in a different chunk.
I tried to fix this in MakeJITScript, but it's not easy. A much simpler fix I think is to emit a JSOP\_NOP right before the JSOP\_GOTO. This is nice anyway because it matches what we emit for other loops.Assignee: jwalden+bmo → jdemooijStatus: NEW → ASSIGNED

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=781859#c12)• 12 years ago |
|  | |

Attached patch

[Part 1: Add SRC\_DO](attachment.cgi?id=667006&action=diff) (obsolete)
— [Details](attachment.cgi?id=667006&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667006)

Once while loops also have a JSOP\_NOP, we need a way to distinguish while and do-while loops when we see a JSOP\_NOP with SRC\_WHILE source note.
This patch adds a separate SRC\_DO source note. It also slightly simplifies things since it can store two offsets, instead of using a second source note for the next op.
[Attachment #667006](/attachment.cgi?id=667006&action=edit "Part 1: Add SRC_DO") -
Flags: review?(jorendorff)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=781859#c13)• 12 years ago |
|  | |

Attached patch

[Part 2: Emit JSOP\_NOP at the top of while loops](attachment.cgi?id=667010&action=diff) (obsolete)
— [Details](attachment.cgi?id=667010&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667010)

Add JSOP\_NOP before the initial JSOP\_GOTO, and move the source note to it.
[Attachment #667010](/attachment.cgi?id=667010&action=edit "Part 2: Emit JSOP_NOP at the top of while loops") -
Flags: review?(jorendorff)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=781859#c14)• 12 years ago |
|  | |

Attached patch

[Part 3: Add shell function to test the decompiler](attachment.cgi?id=667022&action=diff) (obsolete)
— [Details](attachment.cgi?id=667022&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667022)

Adds decompileFunctionDeprecated to the shell, I used this to test the decompiler changes in the other patches.
[Attachment #667022](/attachment.cgi?id=667022&action=edit "Part 3: Add shell function to test the decompiler") -
Flags: review?(jorendorff)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=781859#c17)• 12 years ago |
|  | |

Attached patch

[Patch v2](attachment.cgi?id=667095&action=diff)
— [Details](attachment.cgi?id=667095&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667095)

Jason asked some good questions, which made me realize it's actually simpler to allow a chunk boundary between the GOTO and LOOPHEAD, and fix the few places in the compiler where it assumes otherwise.
[Attachment #667006](/attachment.cgi?id=667006&action=edit "Part 1: Add SRC_DO") -
Attachment is obsolete: true
[Attachment #667010](/attachment.cgi?id=667010&action=edit "Part 2: Emit JSOP_NOP at the top of while loops") -
Attachment is obsolete: true
[Attachment #667022](/attachment.cgi?id=667022&action=edit "Part 3: Add shell function to test the decompiler") -
Attachment is obsolete: true
[Attachment #667006](/attachment.cgi?id=667006&action=edit "Part 1: Add SRC_DO") -
Flags: review?(jorendorff)
[Attachment #667010](/attachment.cgi?id=667010&action=edit "Part 2: Emit JSOP_NOP at the top of while loops") -
Flags: review?(jorendorff)
[Attachment #667022](/attachment.cgi?id=667022&action=edit "Part 3: Add shell function to test the decompiler") -
Flags: review?(jorendorff)
[Attachment #667095](/attachment.cgi?id=667095&action=edit "Patch v2") -
Flags: review?(dvander)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a4590263_309316)• 12 years ago |

[Attachment #667095](/attachment.cgi?id=667095&action=edit "Patch v2") -
Flags: review?(dvander) → review+

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=781859#c18)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/6f31bcbcdbf4>

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=781859#c19)• 12 years ago |
|  | |

Backed out for an approx 50% failure rate of Android-no-ion mochitest 8, of the form:
<https://tbpl.mozilla.org/php/getParsedLog.php?id=15774715&tree=Mozilla-Inbound>
<https://tbpl.mozilla.org/php/getParsedLog.php?id=15774814&tree=Mozilla-Inbound>
Backout:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/65404c2b69c4>

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=781859#c20)• 12 years ago |
|  | |

jandem, do you mind adding the testcase from [bug 797163](/show_bug.cgi?id=797163 "VERIFIED FIXED - \"Assertion failure: lifetime->entry == uint32_t(entryTarget - outerScript->code),\"") as well, when you fix up and reland the patch?

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=781859#c21)• 12 years ago |
|  | |

(In reply to Gary Kwong [:gkw, :nth10sd] from [comment #20](/show_bug.cgi?id=781859#c20 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80"))
> jandem, do you mind adding the testcase from [bug 797163](/show_bug.cgi?id=797163 "VERIFIED FIXED - \"Assertion failure: lifetime->entry == uint32_t(entryTarget - outerScript->code),\"") as well, when you
> fix up and reland the patch?
Sure I will add it, thanks for the tests!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a4762965_1689)• 12 years ago |

Blocks: [797163](/show_bug.cgi?id=797163 "VERIFIED FIXED - \"Assertion failure: lifetime->entry == uint32_t(entryTarget - outerScript->code),\"")

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=781859#c22)• 12 years ago |
|  | |

Definitely too late for 16.
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=781859#c23)• 12 years ago |
|  | |

Comment on [attachment 667095](/attachment.cgi?id=667095 "Patch v2") [[details]](/attachment.cgi?id=667095&action=edit "Patch v2") [[diff]](/attachment.cgi?id=667095&action=diff "Patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667095)
Patch v2
gkw or decoder, could one of you fuzz this patch for a while with --no-ion? Reducing the M8 correctness bug will take a lot of time, so it would be very useful if the fuzzers could find a shell testcase in a few minutes. Thanks!
[Attachment #667095](/attachment.cgi?id=667095&action=edit "Patch v2") -
Flags: feedback?(gary)
[Attachment #667095](/attachment.cgi?id=667095&action=edit "Patch v2") -
Flags: feedback?(choller)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=781859#c24)• 12 years ago |
|  | |

> gkw or decoder, could one of you fuzz this patch for a while with --no-ion?
Don't hold your hopes too high from me, I've fuzzed for an hour or two but nothing has showed up yet.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=781859#c25)• 12 years ago |
|  | |

Comment on [attachment 667095](/attachment.cgi?id=667095 "Patch v2") [[details]](/attachment.cgi?id=667095&action=edit "Patch v2") [[diff]](/attachment.cgi?id=667095&action=diff "Patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=667095)
Patch v2
I didn't see anything here after a day of fuzzing with the patch.
[Attachment #667095](/attachment.cgi?id=667095&action=edit "Patch v2") -
Flags: feedback?(gary) → feedback+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a5367073_1689)• 12 years ago |

[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=781859#c26)• 12 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=674069&action=diff)
— [Details](attachment.cgi?id=674069&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=674069)

This patch seems to work ok, it doesn't skip unreachable opcodes while constructing chunks but just treats them as non-branching. Passes jit-tests -mna and the three testcases in the [comment 17](/show_bug.cgi?id=781859#c17 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80") patch (will include those testcases when pushing). I'm not sure what's wrong with the [comment 17](/show_bug.cgi?id=781859#c17 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80") patch but the code handling loop heads wrt OSR, LICM and loop-carried registers is pretty delicate (why the chunked compilation patch originally opted to not insert chunk boundaries in weird places).Assignee: jdemooij → bhackett1024
[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: review?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=781859#c27)• 12 years ago |
|  | |

Comment on [attachment 674069](/attachment.cgi?id=674069 "patch") [[details]](/attachment.cgi?id=674069&action=edit "patch") [[diff]](/attachment.cgi?id=674069&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=674069)
patch
Review of [attachment 674069](/attachment.cgi?id=674069 "patch") [[details]](/attachment.cgi?id=674069&action=edit "patch") [[diff]](/attachment.cgi?id=674069&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=674069):
-----------------------------------------------------------------
Nice minimal fix, thanks.
[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: review?(jdemooij) → review+

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a6338145_375297)• 12 years ago |

[Attachment #667095](/attachment.cgi?id=667095&action=edit "Patch v2") -
Flags: feedback?(choller)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=781859#c28)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/0d60a2c574f4>

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=781859#c29)• 12 years ago |
|  | |

This is a sec-high bug. It should have been nominated with the sec-approval flag on the patch and received explicit approval for landing. This is now the policy for all sec-high and sec-critical issues. See posts to dev.planning on this and <https://wiki.mozilla.org/Security/Bug_Approval_Process>.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=781859#c30)• 12 years ago |
|  | |

(In reply to Brian Hackett (:bhackett) [mostly gone until mid-November] from [comment #28](/show_bug.cgi?id=781859#c28 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80"))
> <https://hg.mozilla.org/integration/mozilla-inbound/rev/0d60a2c574f4>
If this is low risk enough for uplift to FF17, please nominate for uplift asap.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a6428255_395101)• 12 years ago |

Whiteboard: [jsbugmon:update][js:p1:fx18] → [js:p1:fx18] [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=781859#c31)• 12 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 93cc1ee94291).

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=781859#c32)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/0d60a2c574f4>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed)Flags: in-testsuite+Resolution: --- → FIXEDTarget Milestone: --- → mozilla19

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a6433922_395101)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=781859#c33)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=781859#c34)• 12 years ago |
|  | |

Comment on [attachment 674069](/attachment.cgi?id=674069 "patch") [[details]](/attachment.cgi?id=674069&action=edit "patch") [[diff]](/attachment.cgi?id=674069&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=781859&attachment=674069)
patch
[Approval Request Comment]
Bug caused by (feature/regressing bug #): chunked compilation (old)
User impact if declined: potential security bug
Testing completed (on m-c, etc.): yes
Risk to taking this patch (and alternatives if risky): This patch only changes how we ignore unreachable JavaScript code. Low-risk.
String or UUID changes made by this patch:
[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: approval-mozilla-beta?
[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a6929667_272375)• 12 years ago |

[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: approval-mozilla-beta?
[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: approval-mozilla-beta+
[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: approval-mozilla-aurora?
[Attachment #674069](/attachment.cgi?id=674069&action=edit "patch") -
Flags: approval-mozilla-aurora+

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=781859#c35)• 12 years ago |
|  | |

Needs landing for aurora/beta.Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=781859#c36)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/59c1b8fe4249>
<https://hg.mozilla.org/releases/mozilla-beta/rev/33a74acf43f9>Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a6933949_132034)• 12 years ago |

[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a7107187_280903)• 12 years ago |

Whiteboard: [js:p1:fx18] [jsbugmon:update,ignore] → [js:p1:fx18] [jsbugmon:update,ignore][adv-track-main17+]

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=781859#c37)• 12 years ago |
|  | |

Is there somewhere I can look at test results so I can mark this verified for Firefox 17, 18, and 19?

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=781859#c38)• 12 years ago |
|  | |

+1 to Anthony.
QA would love to regress this bug on affected branches. A link to test results OR a working test case that we can run would suffice. Thank you.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=781859#a19017774_1689)• 12 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=781859&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_9e16534a_20250124_141012.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/793253)
* [XML](/show_bug.cgi?ctype=xml&id=793253)

Closed
[Bug 793253](/show_bug.cgi?id=793253)

Opened 12 years ago
Closed 12 years ago

# Supposedly infallible TArray can fail to allocate a buffer

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Supposedly infallible TArray can fail to allocate a buffer

## Categories

### (Core :: XPCOM, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XPCOM#XPCOM)

XPCOM
▾

Core :: XPCOM
This is the basis of our component technology; this covers the mozilla/xpcom source directory and includes the "repository". Unlikely a tester would be able to tell there was an XPCOM problem specifically.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XPCOM)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla18

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix) |
| firefox-esr17 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | + | fixed |
| firefox18 | + | fixed |
| firefox-esr10 |  | wontfix |
| firefox-esr17 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bzbarsky, Assigned: bzbarsky)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [bzbarsky](/user_profile?user_id=20209)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [bzbarsky](/user_profile?user_id=20209)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [adv-track-main17+][qa?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+][qa?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [bzbarsky](/user_profile?user_id=20209) | [in-testsuite](#c3 "12 years ago") | - |
| --- | --- | --- |
| [bzbarsky](/user_profile?user_id=20209) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Infallible TArrays should really be infallible.](/attachment.cgi?id=663499)  [12 years ago](#c1)  [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)   2.73 KB, patch | justin.lebar+bug : [review+](#c2 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c9 "12 years ago") | [Details](/attachment.cgi?id=663499&action=edit) | [Diff](/attachment.cgi?id=663499&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=793253&attachment=663499) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=793253#c0)• 12 years ago |
|  | |

nsTArray\_base<Alloc>::EnsureCapacity has this bit:
if ((uint64\_t)capacity \* elemSize > size\_type(-1)/2) {
NS\_ERROR("Attempting to allocate excessively large array");
return false;
}
If Alloc is nsTArrayInfallibleAllocator, we should be aborting here, instead of returning false, I believe.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=793253#c1)• 12 years ago |
|  | |

Attached patch

[Infallible TArrays should really be infallible.](attachment.cgi?id=663499&action=diff)
— [Details](attachment.cgi?id=663499&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=793253&attachment=663499)

I'm not convinced about the checkin comment if we want to not make this obvious... suggestions?
[Attachment #663499](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") -
Flags: review?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=793253#a1091_20209)• 12 years ago |

Assignee: nobody → bzbarskyWhiteboard: [need review]

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=793253#a8955_3881)• 12 years ago |

[Attachment #663499](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") -
Flags: review? → review?(justin.lebar+bug)

|  | [Justin Lebar (not reading bugmail)](/user_profile?user_id=303454) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=793253#c2)• 12 years ago |
|  | |

Comment on [attachment 663499](/attachment.cgi?id=663499 "Infallible TArrays should really be infallible.") [[details]](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") [[diff]](/attachment.cgi?id=663499&action=diff "Infallible TArrays should really be infallible.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=793253&attachment=663499)
Infallible TArrays should really be infallible.
I'm not convinced anyone would have an easy time developing a testcase out of this, and anyway the patch speaks for itself, so I don't feel like we need to obfuscate the commit message, personally.
[Attachment #663499](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") -
Flags: review?(justin.lebar+bug) → review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=793253#c3)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/415f11a2bb1a>Flags: in-testsuite-Whiteboard: [need review]Target Milestone: --- → mozilla18

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=793253#c4)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/415f11a2bb1a>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=793253#c5)• 12 years ago |
|  | |

We should probably get this into Firefox 17, but unless we've found a specific case where this gets abused we don't need to over-worry about esr10 and rushing into Firefox 16 at the last minute.
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=793253#c6)• 12 years ago |
|  | |

Let's get this into 17 so it's in the first ESR17 and also nominate for esr10.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=793253#c7)• 12 years ago |
|  | |

sorry, cancel that esr10 request, i see now that we marked wontfix there.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=793253#c8)• 12 years ago |
|  | |

Comment on [attachment 663499](/attachment.cgi?id=663499 "Infallible TArrays should really be infallible.") [[details]](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") [[diff]](/attachment.cgi?id=663499&action=diff "Infallible TArrays should really be infallible.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=793253&attachment=663499)
Infallible TArrays should really be infallible.
OK, requesting approval for 17...
[Approval Request Comment]
Bug caused by (feature/regressing bug #): Long-standing bug
User impact if declined: Probably none, but if there is impact it would be a
security bug.
Testing completed (on m-c, etc.): On trunk for a while, and seems OK.
Risk to taking this patch (and alternatives if risky): Main risk is if a caller
was depending on this non-fatal behavior in an OOM situation. Then this
fix would introduce a DoS attack.
String or UUID changes made by this patch: None.
[Attachment #663499](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") -
Flags: approval-mozilla-beta?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=793253#c9)• 12 years ago |
|  | |

Comment on [attachment 663499](/attachment.cgi?id=663499 "Infallible TArrays should really be infallible.") [[details]](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") [[diff]](/attachment.cgi?id=663499&action=diff "Infallible TArrays should really be infallible.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=793253&attachment=663499)
Infallible TArrays should really be infallible.
Approving for uplift so we get this not only for Beta but for our first ESR17 builds.
[Attachment #663499](/attachment.cgi?id=663499&action=edit "Infallible TArrays should really be infallible.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=793253#c10)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/3d5ad9d84bf3>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=793253#a3561139_280903)• 12 years ago |

Whiteboard: [adv-track-main17+]

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=793253#c11)• 12 years ago |
|  | |

Is there something QA can do to verify this fix?Whiteboard: [adv-track-main17+] → [adv-track-main17+][qa?]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=793253#a15384932_1689)• 12 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=793253&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.ubuntu.com_dce72b3e_20250124_140955.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1638-3: Firefox regressions

3 December 2012

Regressions were introduced in the last Firefox update.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 11.10](/security/notices?release=oneiric)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [firefox](/security/cves?package=firefox) - Mozilla Open Source web browser

## Details

USN-1638-1 fixed vulnerabilities in Firefox. The new packages introduced

regressions in cookies handling and the User Agent string. This update fixes

the problem.

Original advisory details:

Gary Kwong, Jesse Ruderman, Christian Holler, Bob Clary, Kyle Huey, Ed

Morley, Chris Lord, Boris Zbarsky, Julian Seward, Bill McCloskey, and

Andrew McCreight discovered multiple memory safety issues affecting

Firefox. If the user were tricked into opening a specially crafted page, an

attacker could possibly exploit these to cause a denial of service via

application crash, or potentially execute code with the privileges of the

user invoking Firefox. ([CVE-2012-5842](/security/CVE-2012-5842), [CVE-2012-5843](/security/CVE-2012-5843))

Atte Kettunen discovered a buffer overflow while rendering GIF format

images. An attacker could exploit this to possibly execute arbitrary code

as the user invoking Firefox. ([CVE-2012-4202](/security/CVE-2012-4202))

It was discovered that the evalInSandbox function's JavaScript sandbox

context could be circumvented. An attacker could exploit this to perform a

cross-site scripting (XSS) attack or steal a copy of a local file if the

user has installed an add-on vulnerable to this attack. With cross-site

scripting vulnerabilities, if a user were tricked into viewing a specially

crafted page, a remote attacker could exploit this to modify the contents,

or steal confidential data, within the same domain. ([CVE-2012-4201](/security/CVE-2012-4201))

Jonathan Stephens discovered that combining vectors involving the setting

of Cascading Style Sheets (CSS) properties in conjunction with SVG text

could cause Firefox to crash. If a user were tricked into opening a

malicious web page, an attacker could cause a denial of service via

application crash or execute arbitrary code with the privliges of the user

invoking the program. ([CVE-2012-5836](/security/CVE-2012-5836))

It was discovered that if a javascript: URL is selected from the list of

Firefox "new tab" page, the script will inherit the privileges of the

privileged "new tab" page. This allows for the execution of locally

installed programs if a user can be convinced to save a bookmark of a

malicious javascript: URL. ([CVE-2012-4203](/security/CVE-2012-4203))

Scott Bell discovered a memory corruption issue in the JavaScript engine.

If a user were tricked into opening a malicious website, an attacker could

exploit this to execute arbitrary JavaScript code within the context of

another website or arbitrary code as the user invoking the program.

([CVE-2012-4204](/security/CVE-2012-4204))

Gabor Krizsanits discovered that XMLHttpRequest objects created within

sandboxes have the system principal instead of the sandbox principal. This

can lead to cross-site request forgery (CSRF) or information theft via an

add-on running untrusted code in a sandbox. ([CVE-2012-4205](/security/CVE-2012-4205))

Peter Van der Beken discovered XrayWrapper implementation in Firefox does

not consider the compartment during property filtering. An attacker could

use this to bypass intended chrome-only restrictions on reading DOM object

properties via a crafted web site. ([CVE-2012-4208](/security/CVE-2012-4208))

Bobby Holley discovered that cross-origin wrappers were allowing write

actions on objects when only read actions should have been properly

allowed. This can lead to cross-site scripting (XSS) attacks. With

cross-site scripting vulnerabilities, if a user were tricked into viewing a

specially crafted page, a remote attacker could exploit this to modify the

contents, or steal confidential data, within the same domain.

([CVE-2012-5841](/security/CVE-2012-5841))

Masato Kinugawa discovered that when HZ-GB-2312 charset encoding is used

for text, the "~" character will destroy another character near the chunk

delimiter. This can lead to a cross-site scripting (XSS) attack in pages

encoded in HZ-GB-2312. With cross-site scripting vulnerabilities, if a user

were tricked into viewing a specially crafted page, a remote attacker could

exploit this to modify the contents, or steal confidential data, within

the same domain. ([CVE-2012-4207](/security/CVE-2012-4207))

Masato Kinugawa discovered that scripts entered into the Developer Toolbar

could run in a chrome privileged context. An attacker could use this

vulnerability to conduct cross-site scripting (XSS) attacks or execute

arbitrary code as the user invoking Firefox. With cross-site scripting

vulnerabilities, if a user were tricked into viewing a specially crafted

page, a remote attacker could exploit this to modify the contents, or

steal confidential data, within the same domain. ([CVE-2012-5837](/security/CVE-2012-5837))

Mariusz Mlynski discovered that the location property can be accessed by

binary plugins through top.location with a frame whose name attribute's

value is set to "top". This can allow for possible cross-site scripting

(XSS) attacks through plugins. With cross-site scripting vulnerabilities,

if a user were tricked into viewing a specially crafted page, a remote

attacker could exploit this to modify the contents, or steal confidential

data, within the same domain. ([CVE-2012-4209](/security/CVE-2012-4209))

Mariusz Mlynski discovered that when a maliciously crafted stylesheet is

inspected in the Style Inspector, HTML and CSS can run in a chrome

privileged context without being properly sanitized first. If a user were

tricked into opening a malicious web page, an attacker could execute

arbitrary code with the privliges of the user invoking the program.

([CVE-2012-4210](/security/CVE-2012-4210))

Abhishek Arya discovered multiple use-after-free and buffer overflow issues

in Firefox. If a user were tricked into opening a malicious page, an

attacker could exploit these to execute arbitrary code as the user invoking

the program. ([CVE-2012-4214](/security/CVE-2012-4214), [CVE-2012-4215](/security/CVE-2012-4215), [CVE-2012-4216](/security/CVE-2012-4216), [CVE-2012-5829](/security/CVE-2012-5829),

[CVE-2012-5839](/security/CVE-2012-5839), [CVE-2012-5840](/security/CVE-2012-5840), [CVE-2012-4212](/security/CVE-2012-4212), [CVE-2012-4213](/security/CVE-2012-4213), [CVE-2012-4217](/security/CVE-2012-4217),

[CVE-2012-4218](/security/CVE-2012-4218))

Several memory corruption flaws were discovered in Firefox. If a user were

tricked into opening a malicious page, an attacker could exploit these to

execute arbitrary code as the user invoking the program. ([CVE-2012-5830](/security/CVE-2012-5830),

[CVE-2012-5833](/security/CVE-2012-5833), [CVE-2012-5835](/security/CVE-2012-5835), [CVE-2012-5838](/security/CVE-2012-5838))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.10

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0.1+build1-0ubuntu0.12.10.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0.1%2Bbuild1-0ubuntu0.12.10.1)

##### Ubuntu 12.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0.1+build1-0ubuntu0.12.04.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0.1%2Bbuild1-0ubuntu0.12.04.1)

##### Ubuntu 11.10

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0.1+build1-0ubuntu0.11.10.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0.1%2Bbuild1-0ubuntu0.11.10.1)

##### Ubuntu 10.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0.1+build1-0ubuntu0.10.04.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0.1%2Bbuild1-0ubuntu0.10.04.1)

After a standard system update you need to restart Firefox to make all

the necessary changes.

## References

* <https://launchpad.net/bugs/1084548>
* <https://launchpad.net/bugs/1082446>

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from lists.opensuse.org_564e6b54_20250124_140948.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2/#JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2)

# openSUSE-SU-2012:1586-1: moderate: update for xulrunner

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

28 Nov
2012

28 Nov
'12

16:09

openSUSE Security Update: update for xulrunner
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2012:1586-1
Rating: moderate
References: #790140
Cross-References: CVE-2012-4201 CVE-2012-4202 CVE-2012-4203
CVE-2012-4204 CVE-2012-4205 CVE-2012-4207
CVE-2012-4208 CVE-2012-4209 CVE-2012-4210
CVE-2012-4212 CVE-2012-4213 CVE-2012-4214
CVE-2012-4215 CVE-2012-4216 CVE-2012-4217
CVE-2012-4218 CVE-2012-5829 CVE-2012-5830
CVE-2012-5833 CVE-2012-5835 CVE-2012-5836
CVE-2012-5837 CVE-2012-5838 CVE-2012-5839
CVE-2012-5840 CVE-2012-5841 CVE-2012-5842
CVE-2012-5843
Affected Products:
openSUSE 12.2
openSUSE 12.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 28 vulnerabilities is now available.
Description:
Changes in xulrunner:
- update to 17.0 (bnc#790140)
\* MFSA 2012-91/CVE-2012-5842/CVE-2012-5843 Miscellaneous
memory safety hazards
\* MFSA 2012-92/CVE-2012-4202 (bmo#758200) Buffer overflow
while rendering GIF images
\* MFSA 2012-93/CVE-2012-4201 (bmo#747607) evalInSanbox
location context incorrectly applied
\* MFSA 2012-94/CVE-2012-5836 (bmo#792857) Crash when
combining SVG text on path with CSS
\* MFSA 2012-95/CVE-2012-4203 (bmo#765628) Javascript:
URLs run in privileged context on New Tab page
\* MFSA 2012-96/CVE-2012-4204 (bmo#778603) Memory
corruption in str\_unescape
\* MFSA 2012-97/CVE-2012-4205 (bmo#779821) XMLHttpRequest
inherits incorrect principal within sandbox
\* MFSA 2012-99/CVE-2012-4208 (bmo#798264) XrayWrappers
exposes chrome-only properties when not in chrome
compartment
\* MFSA 2012-100/CVE-2012-5841 (bmo#805807) Improper
security filtering for cross-origin wrappers
\* MFSA 2012-101/CVE-2012-4207 (bmo#801681) Improper
character decoding in HZ-GB-2312 charset
\* MFSA 2012-102/CVE-2012-5837 (bmo#800363) Script entered
into Developer Toolbar runs with chrome privileges
\* MFSA 2012-103/CVE-2012-4209 (bmo#792405) Frames can
shadow top.location
\* MFSA 2012-104/CVE-2012-4210 (bmo#796866) CSS and HTML
injection through Style Inspector
\* MFSA
2012-105/CVE-2012-4214/CVE-2012-4215/CVE-2012-4216/
CVE-2012-5829/CVE-2012-5839/CVE-2012-5840/CVE-2012-4212/ CVE
-2012-4213/CVE-2012-4217/CVE-2012-4218 Use-after-free
and buffer overflow issues found using Address Sanitizer
\* MFSA
2012-106/CVE-2012-5830/CVE-2012-5833/CVE-2012-5835/CVE-2012-
5838 Use-after-free, buffer overflow, and memory
corruption issues found using Address Sanitizer
- rebased patches
- disabled WebRTC since build is broken (bmo#776877)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.2:
zypper in -t patch openSUSE-2012-819
- openSUSE 12.1:
zypper in -t patch openSUSE-2012-819
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.2 (i586 x86\_64):
mozilla-js-17.0-2.22.1
mozilla-js-debuginfo-17.0-2.22.1
xulrunner-17.0-2.22.1
xulrunner-buildsymbols-17.0-2.22.1
xulrunner-debuginfo-17.0-2.22.1
xulrunner-debugsource-17.0-2.22.1
xulrunner-devel-17.0-2.22.1
xulrunner-devel-debuginfo-17.0-2.22.1
- openSUSE 12.2 (x86\_64):
mozilla-js-32bit-17.0-2.22.1
mozilla-js-debuginfo-32bit-17.0-2.22.1
xulrunner-32bit-17.0-2.22.1
xulrunner-debuginfo-32bit-17.0-2.22.1
- openSUSE 12.1 (i586 x86\_64):
mozilla-js-17.0-2.49.1
mozilla-js-debuginfo-17.0-2.49.1
xulrunner-17.0-2.49.1
xulrunner-buildsymbols-17.0-2.49.1
xulrunner-debuginfo-17.0-2.49.1
xulrunner-debugsource-17.0-2.49.1
xulrunner-devel-17.0-2.49.1
xulrunner-devel-debuginfo-17.0-2.49.1
- openSUSE 12.1 (x86\_64):
mozilla-js-32bit-17.0-2.49.1
mozilla-js-debuginfo-32bit-17.0-2.49.1
xulrunner-32bit-17.0-2.49.1
xulrunner-debuginfo-32bit-17.0-2.49.1
- openSUSE 12.1 (ia64):
mozilla-js-debuginfo-x86-17.0-2.49.1
mozilla-js-x86-17.0-2.49.1
xulrunner-debuginfo-x86-17.0-2.49.1
xulrunner-x86-17.0-2.49.1
References:
<http://support.novell.com/security/cve/CVE-2012-4201.html>
<http://support.novell.com/security/cve/CVE-2012-4202.html>
<http://support.novell.com/security/cve/CVE-2012-4203.html>
<http://support.novell.com/security/cve/CVE-2012-4204.html>
<http://support.novell.com/security/cve/CVE-2012-4205.html>
<http://support.novell.com/security/cve/CVE-2012-4207.html>
<http://support.novell.com/security/cve/CVE-2012-4208.html>
<http://support.novell.com/security/cve/CVE-2012-4209.html>
<http://support.novell.com/security/cve/CVE-2012-4210.html>
<http://support.novell.com/security/cve/CVE-2012-4212.html>
<http://support.novell.com/security/cve/CVE-2012-4213.html>
<http://support.novell.com/security/cve/CVE-2012-4214.html>
<http://support.novell.com/security/cve/CVE-2012-4215.html>
<http://support.novell.com/security/cve/CVE-2012-4216.html>
<http://support.novell.com/security/cve/CVE-2012-4217.html>
<http://support.novell.com/security/cve/CVE-2012-4218.html>
<http://support.novell.com/security/cve/CVE-2012-5829.html>
<http://support.novell.com/security/cve/CVE-2012-5830.html>
<http://support.novell.com/security/cve/CVE-2012-5833.html>
<http://support.novell.com/security/cve/CVE-2012-5835.html>
<http://support.novell.com/security/cve/CVE-2012-5836.html>
<http://support.novell.com/security/cve/CVE-2012-5837.html>
<http://support.novell.com/security/cve/CVE-2012-5838.html>
<http://support.novell.com/security/cve/CVE-2012-5839.html>
<http://support.novell.com/security/cve/CVE-2012-5840.html>
<http://support.novell.com/security/cve/CVE-2012-5841.html>
<http://support.novell.com/security/cve/CVE-2012-5842.html>
<http://support.novell.com/security/cve/CVE-2012-5843.html>
<https://bugzilla.novell.com/790140>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2/#JVJQP7YEAQCFHIRTJEHUUVEREXMQCXT2)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.ubuntu.com_becc4925_20250124_140954.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1638-1: Firefox vulnerabilities

21 November 2012

Several security issues were fixed in Firefox.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 11.10](/security/notices?release=oneiric)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [firefox](/security/cves?package=firefox) - Mozilla Open Source web browser

## Details

Gary Kwong, Jesse Ruderman, Christian Holler, Bob Clary, Kyle Huey, Ed

Morley, Chris Lord, Boris Zbarsky, Julian Seward, Bill McCloskey, and

Andrew McCreight discovered multiple memory safety issues affecting

Firefox. If the user were tricked into opening a specially crafted page, an

attacker could possibly exploit these to cause a denial of service via

application crash, or potentially execute code with the privileges of the

user invoking Firefox. ([CVE-2012-5842](/security/CVE-2012-5842), [CVE-2012-5843](/security/CVE-2012-5843))

Atte Kettunen discovered a buffer overflow while rendering GIF format

images. An attacker could exploit this to possibly execute arbitrary code

as the user invoking Firefox. ([CVE-2012-4202](/security/CVE-2012-4202))

It was discovered that the evalInSandbox function's JavaScript sandbox

context could be circumvented. An attacker could exploit this to perform a

cross-site scripting (XSS) attack or steal a copy of a local file if the

user has installed an add-on vulnerable to this attack. With cross-site

scripting vulnerabilities, if a user were tricked into viewing a specially

crafted page, a remote attacker could exploit this to modify the contents,

or steal confidential data, within the same domain. ([CVE-2012-4201](/security/CVE-2012-4201))

Jonathan Stephens discovered that combining vectors involving the setting

of Cascading Style Sheets (CSS) properties in conjunction with SVG text

could cause Firefox to crash. If a user were tricked into opening a

malicious web page, an attacker could cause a denial of service via

application crash or execute arbitrary code with the privliges of the user

invoking the program. ([CVE-2012-5836](/security/CVE-2012-5836))

It was discovered that if a javascript: URL is selected from the list of

Firefox "new tab" page, the script will inherit the privileges of the

privileged "new tab" page. This allows for the execution of locally

installed programs if a user can be convinced to save a bookmark of a

malicious javascript: URL. ([CVE-2012-4203](/security/CVE-2012-4203))

Scott Bell discovered a memory corruption issue in the JavaScript engine.

If a user were tricked into opening a malicious website, an attacker could

exploit this to execute arbitrary JavaScript code within the context of

another website or arbitrary code as the user invoking the program.

([CVE-2012-4204](/security/CVE-2012-4204))

Gabor Krizsanits discovered that XMLHttpRequest objects created within

sandboxes have the system principal instead of the sandbox principal. This

can lead to cross-site request forgery (CSRF) or information theft via an

add-on running untrusted code in a sandbox. ([CVE-2012-4205](/security/CVE-2012-4205))

Peter Van der Beken discovered XrayWrapper implementation in Firefox does

not consider the compartment during property filtering. An attacker could

use this to bypass intended chrome-only restrictions on reading DOM object

properties via a crafted web site. ([CVE-2012-4208](/security/CVE-2012-4208))

Bobby Holley discovered that cross-origin wrappers were allowing write

actions on objects when only read actions should have been properly

allowed. This can lead to cross-site scripting (XSS) attacks. With

cross-site scripting vulnerabilities, if a user were tricked into viewing a

specially crafted page, a remote attacker could exploit this to modify the

contents, or steal confidential data, within the same domain.

([CVE-2012-5841](/security/CVE-2012-5841))

Masato Kinugawa discovered that when HZ-GB-2312 charset encoding is used

for text, the "~" character will destroy another character near the chunk

delimiter. This can lead to a cross-site scripting (XSS) attack in pages

encoded in HZ-GB-2312. With cross-site scripting vulnerabilities, if a user

were tricked into viewing a specially crafted page, a remote attacker could

exploit this to modify the contents, or steal confidential data, within

the same domain. ([CVE-2012-4207](/security/CVE-2012-4207))

Masato Kinugawa discovered that scripts entered into the Developer Toolbar

could run in a chrome privileged context. An attacker could use this

vulnerability to conduct cross-site scripting (XSS) attacks or execute

arbitrary code as the user invoking Firefox. With cross-site scripting

vulnerabilities, if a user were tricked into viewing a specially crafted

page, a remote attacker could exploit this to modify the contents, or

steal confidential data, within the same domain. ([CVE-2012-5837](/security/CVE-2012-5837))

Mariusz Mlynski discovered that the location property can be accessed by

binary plugins through top.location with a frame whose name attribute's

value is set to "top". This can allow for possible cross-site scripting

(XSS) attacks through plugins. With cross-site scripting vulnerabilities,

if a user were tricked into viewing a specially crafted page, a remote

attacker could exploit this to modify the contents, or steal confidential

data, within the same domain. ([CVE-2012-4209](/security/CVE-2012-4209))

Mariusz Mlynski discovered that when a maliciously crafted stylesheet is

inspected in the Style Inspector, HTML and CSS can run in a chrome

privileged context without being properly sanitized first. If a user were

tricked into opening a malicious web page, an attacker could execute

arbitrary code with the privliges of the user invoking the program.

([CVE-2012-4210](/security/CVE-2012-4210))

Abhishek Arya discovered multiple use-after-free and buffer overflow issues

in Firefox. If a user were tricked into opening a malicious page, an

attacker could exploit these to execute arbitrary code as the user invoking

the program. ([CVE-2012-4214](/security/CVE-2012-4214), [CVE-2012-4215](/security/CVE-2012-4215), [CVE-2012-4216](/security/CVE-2012-4216), [CVE-2012-5829](/security/CVE-2012-5829),

[CVE-2012-5839](/security/CVE-2012-5839), [CVE-2012-5840](/security/CVE-2012-5840), [CVE-2012-4212](/security/CVE-2012-4212), [CVE-2012-4213](/security/CVE-2012-4213), [CVE-2012-4217](/security/CVE-2012-4217),

[CVE-2012-4218](/security/CVE-2012-4218))

Several memory corruption flaws were discovered in Firefox. If a user were

tricked into opening a malicious page, an attacker could exploit these to

execute arbitrary code as the user invoking the program. ([CVE-2012-5830](/security/CVE-2012-5830),

[CVE-2012-5833](/security/CVE-2012-5833), [CVE-2012-5835](/security/CVE-2012-5835), [CVE-2012-5838](/security/CVE-2012-5838))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.10

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0+build2-0ubuntu0.12.10.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0%2Bbuild2-0ubuntu0.12.10.1)

##### Ubuntu 12.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0+build2-0ubuntu0.12.04.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0%2Bbuild2-0ubuntu0.12.04.1)

##### Ubuntu 11.10

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0+build2-0ubuntu0.11.10.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0%2Bbuild2-0ubuntu0.11.10.1)

##### Ubuntu 10.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [17.0+build2-0ubuntu0.10.04.1](https://launchpad.net/ubuntu/%2Bsource/firefox/17.0%2Bbuild2-0ubuntu0.10.04.1)

After a standard system update you need to restart Firefox to make all

the necessary changes.

## References

* [CVE-2012-5842](/security/CVE-2012-5842)
* [CVE-2012-5843](/security/CVE-2012-5843)
* [CVE-2012-4202](/security/CVE-2012-4202)
* [CVE-2012-4201](/security/CVE-2012-4201)
* [CVE-2012-5836](/security/CVE-2012-5836)
* [CVE-2012-4204](/security/CVE-2012-4204)
* [CVE-2012-4205](/security/CVE-2012-4205)
* [CVE-2012-4208](/security/CVE-2012-4208)
* [CVE-2012-5841](/security/CVE-2012-5841)
* [CVE-2012-4207](/security/CVE-2012-4207)
* [CVE-2012-4209](/security/CVE-2012-4209)
* [CVE-2012-4214](/security/CVE-2012-4214)
* [CVE-2012-4215](/security/CVE-2012-4215)
* [CVE-2012-4216](/security/CVE-2012-4216)
* [CVE-2012-5829](/security/CVE-2012-5829)
* [CVE-2012-5839](/security/CVE-2012-5839)
* [CVE-2012-5840](/security/CVE-2012-5840)
* [CVE-2012-4212](/security/CVE-2012-4212)
* [CVE-2012-4213](/security/CVE-2012-4213)
* [CVE-2012-4217](/security/CVE-2012-4217)
* [CVE-2012-4218](/security/CVE-2012-4218)
* [CVE-2012-5830](/security/CVE-2012-5830)
* [CVE-2012-5833](/security/CVE-2012-5833)
* [CVE-2012-5835](/security/CVE-2012-5835)
* [CVE-2012-5838](/security/CVE-2012-5838)
* [CVE-2012-4203](/security/CVE-2012-4203)
* [CVE-2012-4210](/security/CVE-2012-4210)
* [CVE-2012-5837](/security/CVE-2012-5837)
* <https://launchpad.net/bugs/1080211>

## Related notices

* [USN-1636-1](/security/notices/USN-1636-1)
* [USN-1681-2](/security/notices/USN-1681-2)
* [USN-1681-1](/security/notices/USN-1681-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugzilla.mozilla.org_3ca07cf0_20250124_141001.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/780778)
* [XML](/show_bug.cgi?ctype=xml&id=780778)

Closed
[Bug 780778](/show_bug.cgi?id=780778)

Opened 12 years ago
Closed 12 years ago

# Make sure we always release stuff on the right thread.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Make sure we always release stuff on the right thread.

## Categories

### (Core :: Storage: IndexedDB, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Storage%3A%20IndexedDB#Storage%3A%20IndexedDB)

Storage: IndexedDB
▾

Core :: Storage: IndexedDB
[IndexedDB](https://w3c.github.io/IndexedDB/) implementation, exposed through self.indexedDB.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20IndexedDB&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20IndexedDB&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Storage%3A%20IndexedDB)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla18

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 |  | fixed |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: khuey, Assigned: khuey)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d8bebbee32670ee5755ce1bc535cd251?d=mm&size=40)  [khuey](/user_profile?user_id=336670)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d8bebbee32670ee5755ce1bc535cd251?d=mm&size=40)  [khuey](/user_profile?user_id=336670)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[661877](/show_bug.cgi?id=661877 "RESOLVED FIXED - Enable storing files in IndexedDB"), [793514](/show_bug.cgi?id=793514 "RESOLVED WORKSFORME - Intermittent failure in test_filehandle_store_snapshot.html from \"Assertion failure: _mOwningThread.GetThread() == PR_GetCurrentThread() (nsDOMFileCC not thread-safe)\" and \"(nsScriptCacheCleaner not thread-safe)\"")

Dependency [tree](/showdependencytree.cgi?id=780778&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=780778)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: regression, sec-moderate, Whiteboard: [adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c6 "12 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [Patch](/attachment.cgi?id=649478)  [12 years ago](#c0)  [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)   12.49 KB, patch | bent.mozilla : [review-](#a1288216_200444 "12 years ago") | [Details](/attachment.cgi?id=649478&action=edit) | [Diff](/attachment.cgi?id=649478&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=649478) |
| --- | --- | --- |
| [Patch](/attachment.cgi?id=666658)  [12 years ago](#c4)  [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)   13.68 KB, patch | bent.mozilla : [review+](#a4986398_200444 "12 years ago")  akeybl : [approval-mozilla-aurora+](#c10 "12 years ago") | [Details](/attachment.cgi?id=666658&action=edit) | [Diff](/attachment.cgi?id=666658&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=666658) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=780778#c0)• 12 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=649478&action=diff) (obsolete)
— [Details](attachment.cgi?id=649478&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=649478)

Since some of the StructuredClone\*Info structs can hold onto CCd objects, we need to be sure we always empty them on the main thread.
[Attachment #649478](/attachment.cgi?id=649478&action=edit "Patch") -
Flags: review?(bent.mozilla)

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=780778#c1)• 12 years ago |
|  | |

Comment on [attachment 649478](/attachment.cgi?id=649478 "Patch") [[details]](/attachment.cgi?id=649478&action=edit "Patch") [[diff]](/attachment.cgi?id=649478&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=649478)
Patch
Review of [attachment 649478](/attachment.cgi?id=649478 "Patch") [[details]](/attachment.cgi?id=649478&action=edit "Patch") [[diff]](/attachment.cgi?id=649478&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=649478):
-----------------------------------------------------------------
::: dom/indexedDB/IDBCursor.cpp
@@ -79,5 @@
> }
>
> ~ContinueHelper()
> {
> - IDBObjectStore::ClearStructuredCloneBuffer(mCloneReadInfo.mCloneBuffer);
We still need this here and in all the other destructors (if something fails and we don't actually dispatch to the threadpool then we still end up never calling ReleaseMainThreadObjects).

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=780778#c2)• 12 years ago |
|  | |

If that happens, the only safe thing to do is to leak all the StructuredCloneFiles ... perhaps we should just abort?

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=780778#c3)• 12 years ago |
|  | |

No, if that happens then we're already on the main thread and the destructors for those objects will release everything just fine.

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a1288216_200444)• 12 years ago |

[Attachment #649478](/attachment.cgi?id=649478&action=edit "Patch") -
Flags: review?(bent.mozilla) → review-

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a4130426_336670)• 12 years ago |

Blocks: [793514](/show_bug.cgi?id=793514 "RESOLVED WORKSFORME - Intermittent failure in test_filehandle_store_snapshot.html from \"Assertion failure: _mOwningThread.GetThread() == PR_GetCurrentThread() (nsDOMFileCC not thread-safe)\" and \"(nsScriptCacheCleaner not thread-safe)\"")

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=780778#c4)• 12 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=666658&action=diff)
— [Details](attachment.cgi?id=666658&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=666658)

[Attachment #649478](/attachment.cgi?id=649478&action=edit "Patch") -
Attachment is obsolete: true
[Attachment #666658](/attachment.cgi?id=666658&action=edit "Patch") -
Flags: review?(bent.mozilla)

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a4986398_200444)• 12 years ago |

[Attachment #666658](/attachment.cgi?id=666658&action=edit "Patch") -
Flags: review?(bent.mozilla) → review+

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=780778#c5)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/5c2b826588d3>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=780778#c6)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/5c2b826588d3>Status: ASSIGNED → RESOLVEDClosed: 12 years agoFlags: in-testsuite+Resolution: --- → FIXEDTarget Milestone: --- → mozilla18

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=780778#c7)• 12 years ago |
|  | |

Comment on [attachment 666658](/attachment.cgi?id=666658 "Patch") [[details]](/attachment.cgi?id=666658&action=edit "Patch") [[diff]](/attachment.cgi?id=666658&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=666658)
Patch
[Approval Request Comment]
Bug caused by (feature/regressing bug #): [Bug 661877](/show_bug.cgi?id=661877 "RESOLVED FIXED - Enable storing files in IndexedDB")
User impact if declined: Potential security problem
Testing completed (on m-c, etc.): On m-c, simple enough to understand easily.
Risk to taking this patch (and alternatives if risky): Low risk.
String or UUID changes made by this patch: None.
[Attachment #666658](/attachment.cgi?id=666658&action=edit "Patch") -
Flags: approval-mozilla-aurora?

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a5075030_336670)• 12 years ago |

Group: core-security

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=780778#c8)• 12 years ago |
|  | |

(In reply to Kyle Huey [:khuey] (khuey@mozilla.com) from [comment #7](/show_bug.cgi?id=780778#c7 "RESOLVED FIXED - Make sure we always release stuff on the right thread."))
> [Approval Request Comment]
> User impact if declined: Potential security problem
I'm assuming this isn't an sec-high or sec-critical since this landed on central without sec-approval. Sec-moderate?

|  | [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=780778#c9)• 12 years ago |
|  | |

That's probably reasonable. This would be really hard to exploit.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a5345796_425645)• 12 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=780778#c10)• 12 years ago |
|  | |

Comment on [attachment 666658](/attachment.cgi?id=666658 "Patch") [[details]](/attachment.cgi?id=666658&action=edit "Patch") [[diff]](/attachment.cgi?id=666658&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=780778&attachment=666658)
Patch
[Triage Comment]
Approving for Aurora 17 - please land early on Monday to make the merge.
[Attachment #666658](/attachment.cgi?id=666658&action=edit "Patch") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Justin Wood (:Callek)](/user_profile?user_id=129968) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=780778#c11)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/b1e06ca302c2>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a5699957_1689)• 12 years ago |

Blocks: [661877](/show_bug.cgi?id=661877 "RESOLVED FIXED - Enable storing files in IndexedDB")Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a5699979_1689)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a7428962_280903)• 12 years ago |

Whiteboard: [adv-track-main17+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=780778#a19339700_1689)• 12 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=780778&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kyle Huey (Exited; not receiving bugmail, old account, do not use)](/user_profile?user_id=336670)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_87e83206_20250124_140957.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/760887)
* [XML](/show_bug.cgi?ctype=xml&id=760887)

Closed
[Bug 760887](/show_bug.cgi?id=760887)

Opened 13 years ago
Closed 13 years ago

# "ASSERTION: function object has parent of unknown class!"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"ASSERTION: function object has parent of unknown class!"

## Categories

### (Core :: XPConnect, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XPConnect#XPConnect)

XPConnect
▾

Core :: XPConnect
Facilitates calling between JavaScript and XPCOM components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XPConnect&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XPConnect&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XPConnect)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox14 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=unaffected) |
| firefox15 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix) |
| firefox16 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox14 |  | unaffected |
| firefox15 |  | wontfix |
| firefox16 |  | wontfix |
| firefox17 |  | fixed |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: bholley)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ac57223c49d41049a4917e187b854377?d=mm&size=40)  [bholley](/user_profile?user_id=313730)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[774245](/show_bug.cgi?id=774245 "RESOLVED FIXED - Reimplement Components.*.lookupMethod in terms of Xray wrapper")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=760887&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=760887)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, sec-high, testcase, Whiteboard: [adv-track-main17+] fixed by bug 774245)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+] fixed by bug 774245

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [testcase](/attachment.cgi?id=629546)  [13 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   327 bytes, text/html |  | [Details](/attachment.cgi?id=629546&action=edit) |
| --- | --- | --- |
| [stack trace](/attachment.cgi?id=629547)  [13 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   2.21 KB, text/plain |  | [Details](/attachment.cgi?id=629547&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=760887#c0)• 13 years ago |
|  | |

Attached file
[testcase](attachment.cgi?id=629546)
— [Details](attachment.cgi?id=629546&action=edit)

###!!! ASSERTION: function object has parent of unknown class!: 'Error', file js/xpconnect/src/XPCWrappedNative.cpp, line 1779
Smells cpg-related.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=760887#c1)• 13 years ago |
|  | |

Attached file
[stack trace](attachment.cgi?id=629547)
— [Details](attachment.cgi?id=629547&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=760887#c2)• 13 years ago |
|  | |

bholley thinks this sounds a lot like [bug 752764](/show_bug.cgi?id=752764 "VERIFIED FIXED - document.write after page with <video> causes a CC crash [@ nsXPConnect::Traverse]"), and I agree, so I'll look at it to see what is going on.Assignee: nobody → continuation

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=760887#c3)• 13 years ago |
|  | |

WFM on a local build of Fx16 with [bug 751995](/show_bug.cgi?id=751995 "VERIFIED FIXED - Compartment mismatch with adoptNode, style") and [bug 758415](/show_bug.cgi?id=758415 "RESOLVED FIXED - Implement per-origin Xray expando sharing for Wrapped Natives") applied. So 16 is probably fixed. Hurray!
[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=unaffected)
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=760887#c4)• 13 years ago |
|  | |

Oops, never mind. I must have been doing something clever like running a 14 debug build my local 16 build directory or something awesome like that. Still affected.
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=760887#c5)• 13 years ago |
|  | |

This looks different than [bug 752764](/show_bug.cgi?id=752764 "VERIFIED FIXED - document.write after page with <video> causes a CC crash [@ nsXPConnect::Traverse]") to me. What is happening is that the parent of the function hasChildNodes is another function, btoa (well, the actual parent is a proxy, but the call and private slots of the proxy are the btoa function). The parent of btoa is XPC\_WN\_ModsAllowed\_NoCall\_Proto\_JSClass, which looks like it would be okay. Maybe the problem here is that GetWrappedNativeOfJSObject needs to chase further up the parent chain?

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=760887#c6)• 13 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #5](/show_bug.cgi?id=760887#c5 "RESOLVED FIXED - \"ASSERTION: function object has parent of unknown class!\""))
> This looks different than [bug 752764](/show_bug.cgi?id=752764 "VERIFIED FIXED - document.write after page with <video> causes a CC crash [@ nsXPConnect::Traverse]") to me. What is happening is that the
> parent of the function hasChildNodes is another function, btoa (well, the
> actual parent is a proxy, but the call and private slots of the proxy are
> the btoa function).
Hm, if the parent of the function is actually btoa, that's a bug. But it's not clear to me how that would happen. btoa appears in this testcase as a mutable proto for |document|, and there are very few uses of js::GetObjectProto in xpconnect. One of those uses is in XPCWrappedNative::GetWrappedNativeForJSObject, where it crawls the proto chain. Is the function actually parented to btoa, or did we just get there by crawling the proto chain?
The current bizarre implementation/behavior of GetWrappedNativeOfJSObject really needs to go away anyway. I already ripped it out for new dom bindings and quickstubs. Last I recall there was some reason why we still needed it. Something to do with [bug 658909](/show_bug.cgi?id=658909 "RESOLVED FIXED - Incorrect |this| binding when using call() with XRayWrappers")...

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=760887#c7)• 13 years ago |
|  | |

The actual parent of hasChildNodes is this object:
0x11871c220 W Proxy <no private>
> 0x118716790 W type
> 0x1280267e0 W shape
> 0x12801e1c0 W call
> 0x12801e1c0 W private
the call and shape fields point to btoa:
0x12801e1c0 W Function btoa
> 0x11870d5e0 W type
> 0x128010ee8 W shape
> 0x1185257a0 B atom
js::GetObjectParent of hasChildNodes is 0x11871c220.
js::UnwrapObject of 0x11871c220 is 0x12801e1c0 (btoa)
Then it computes JS\_ObjectToInnerObject of that, which is just the same thing, the btoa function.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=760887#c8)• 13 years ago |
|  | |

Notice that the object header thing says <no private> while the actual object says there is a private. ;) That could just be a bug in the printing code that decides what the header should show.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=760887#c9)• 13 years ago |
|  | |

Not fixed by my patch in [bug 752340](/show_bug.cgi?id=752340 "VERIFIED FIXED - js::FunctionProxyClass needs a finalizer").

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=760887#c10)• 13 years ago |
|  | |

Here's the sequence of events.
1. We grab btoa, then set its proto to the text node, which changes its shape and type.
2. Then, we pass a proxy into nsXPCComponents\_Utils::LookupMethod, which becomes obj. The private of the proxy is btoa. The parent of the proxy is the mJSProtoObject of a window.
3. The first thing LookupMethod does is go up the proto-chain, but js::IsWrapper(obj) is true, so obj remains unchanged.
4. Then we call GetJSObjectOfWrapper on obj, which returns the text node.
5. JS\_ObjectToInnerObject is called, but that doesn't change unwrappedObject.
6. Then there's some XPCCallContext stuff I don't really understand that digs around to get the method, which succeeds.
7. Then we call NewFunctionObject, which creates the new function object. The parent of this new function object is obj, which as I said above is a proxy for btoa.
8. Then later we're in GetWrappedNativeOfJSObject for some reason. We unwrap the parent of hasChildNodes, which gets us btoa. This isn't a proto, wrapper or tearoff, so we hit the assertion.
My guess would be that something is going weird in step 3, but I'm not really sure what that code (or most of this code, really) should be doing.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=760887#c11)• 13 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #10](/show_bug.cgi?id=760887#c10 "RESOLVED FIXED - \"ASSERTION: function object has parent of unknown class!\""))
> Here's the sequence of events.
>
> 1. We grab btoa, then set its proto to the text node, which changes its
> shape and type.
More specifically, we set its proto to a CCW to the text node, since it's in the outer document's compartment.
>
> 2. Then, we pass a proxy into nsXPCComponents\_Utils::LookupMethod, which
> becomes obj. The private of the proxy is btoa. The parent of the proxy is
> the mJSProtoObject of a window.
>
> 3. The first thing LookupMethod does is go up the proto-chain, but
> js::IsWrapper(obj) is true, so obj remains unchanged.
>
> 4. Then we call GetJSObjectOfWrapper on obj, which returns the text node.
Wow, nsXPConnect::GetJSObjectOfWrapper is some bizarre stuff. I didn't even know it existed. It seems to me like its primary purpose here is to bust through security wrappers. I'm sort of surprised we're not hitting cross-compartment assertions, here...
>
> 5. JS\_ObjectToInnerObject is called, but that doesn't change unwrappedObject.
>
> 6. Then there's some XPCCallContext stuff I don't really understand that
> digs around to get the method, which succeeds.
So this seems like the bug, IMO. I don't think we should be passing arbitrary js objects to XPCCallContext and expect to get something sane back. XrayWrapper does this, but it does it with very controlled objects that don't have anything funky like this going on.
Anyway, reading through the implementation of LookupMethod here gives me the creeps. I've never even looked through this codepath before, and it sure looks to me like there are lots of little dark corners to exploit.
The thing is, XrayWrapper does the same thing, in a saner way. So as long as this method is exposed to content JS (which isn't forever, but is the case for the immediate future), I think we should re-implement it in terms of XrayWrapper. Here are the steps, as far as I see:
When the object comes in, do a CheckedUnwrap (which does a PUNCTURE at every level of security wrappers, throwing if we're leave same-origin boundaries). Then enter the compartment of the underlying object.
Then, we check CanXray on the underlying object. If we can't, we throw. If we can, we construct an ephemeral same-compartment Xray wrapper around the object. We then call getPropertyDescriptor on the Xray wrapper. If it comes back as a callable value attribute, then we've found what we're looking for. We leave the object's compartment, wrap the method, and return.
What do you think, mccr8? Does this sound like a sane plan? I can take a crack at it next week if you'd prefer to skip it. ;-)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=760887#c12)• 13 years ago |
|  | |

I know very little about XrayWrappers, but it does sound like a good idea to use them implement a method that is supposed to imitate them. I'm fine with you taking this. I should try to learn about XrayWrappers at some point, but I'm okay with it if it isn't in the near future.
([Bug 693733](/show_bug.cgi?id=693733 "RESOLVED FIXED - Components.lookupMethod should not be accessible to page JS") talks about making lookupMethod not available to content.)Assignee: continuation → bobbyholley+bmo

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=760887#c13)• 13 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #12](/show_bug.cgi?id=760887#c12 "RESOLVED FIXED - \"ASSERTION: function object has parent of unknown class!\""))
> ([Bug 693733](/show_bug.cgi?id=693733 "RESOLVED FIXED - Components.lookupMethod should not be accessible to page JS") talks about making lookupMethod not available to content.)
Indeed, but we can't do that until we find another way to make it available to XBL, since Flashblock needs it. This will all be fixed proper when we make |Components| available only to XBL.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=760887#c14)• 13 years ago |
|  | |

I'm reimplementing lookupMethod over in [bug 774245](/show_bug.cgi?id=774245 "RESOLVED FIXED - Reimplement Components.*.lookupMethod in terms of Xray wrapper"). I'm conservatively not marking the dep to avoid indicating that that bug fixes a known security issue, though I think it'd probably be fine to mark it as well.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=760887#c15)• 13 years ago |
|  | |

> Indeed, but we can't do that until we find another way to make it available to XBL,
> since Flashblock needs it.
Or we could give Flashblock a more direct way to do what it wants to do.
> This will all be fixed proper when we make |Components| available only to XBL.
Will XBL scripts be shielded from page scripts if that happens?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=760887#a3785029_406194)• 13 years ago |

Whiteboard: to be fixed by bug 774245

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=760887#c16)• 13 years ago |
|  | |

(In reply to Jesse Ruderman from [comment #15](/show_bug.cgi?id=760887#c15 "RESOLVED FIXED - \"ASSERTION: function object has parent of unknown class!\""))
> Or we could give Flashblock a more direct way to do what it wants to do.
Do you have any suggestions?
> > This will all be fixed proper when we make |Components| available only to XBL.
> Will XBL scripts be shielded from page scripts if that happens?
Somewhat. The idea is that |Components| will live on a special enclosing scope for XBL code that isn't otherwise accessible to content. It's still totally possible for XBL to leak Components to content, though.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=760887#c17)• 13 years ago |
|  | |

We should ensure Flashblock can hook into Firefox's own plugin blocking and click-to-play mechanisms. That would be better than adding complexity to keep the XBL Flashblock alive.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=760887#c18)• 13 years ago |
|  | |

(In reply to Jesse Ruderman from [comment #17](/show_bug.cgi?id=760887#c17 "RESOLVED FIXED - \"ASSERTION: function object has parent of unknown class!\""))
> We should ensure Flashblock can hook into Firefox's own plugin blocking and
> click-to-play mechanisms. That would be better than adding complexity to
> keep the XBL Flashblock alive.
The Components-for-XBL hack is needed for more than just flashblock, so that's going to happen anyway.
As for LookupMethod, we could also just kill it, but that's a pretty high-risk move in response to a security bug. Specifically, if we find out that it breaks the web, the backout will put us in a bad place. So I'm going to land the reimplementation for now, which is a step in the right direction.
That being said, if flashblock can wean itself off lookupMethod, I'd like to try killing it for content and see what happens. If we kill it for content, we can probably kill it for chrome too, since chrome gets this behavior automatically.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=760887#c19)• 13 years ago |
|  | |

[Bug 693733](/show_bug.cgi?id=693733 "RESOLVED FIXED - Components.lookupMethod should not be accessible to page JS") is another (weird) reason to remove lookupMethod from the web. But sure, avoiding a backout while fixing this more severe bug makes sense.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=760887#c20)• 13 years ago |
|  | |

This test case now produces the following:
WARNING: Components.lookupMethod deprecated, use Components.utils.lookupMethod: file /Users/amccreight/mz/cent4/js/xpconnect/src/XPCComponents.cpp, line 4754
JavaScript error: file:///Users/amccreight/mz/tests/760887.html, line 18: NS\_ERROR\_XPC\_BAD\_CONVERT\_JS: Component returned failure code: 0x80570009 (NS\_ERROR\_XPC\_BAD\_CONVERT\_JS) [nsIXPCComponents.lookupMethod]

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=760887#c21)• 13 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #20](/show_bug.cgi?id=760887#c20 "RESOLVED FIXED - \"ASSERTION: function object has parent of unknown class!\""))
> This test case now produces the following:
>
> WARNING: Components.lookupMethod deprecated, use
> Components.utils.lookupMethod: file
> /Users/amccreight/mz/cent4/js/xpconnect/src/XPCComponents.cpp, line 4754
> JavaScript error: file:///Users/amccreight/mz/tests/760887.html, line 18:
> NS\_ERROR\_XPC\_BAD\_CONVERT\_JS: Component returned failure code: 0x80570009
> (NS\_ERROR\_XPC\_BAD\_CONVERT\_JS) [nsIXPCComponents.lookupMethod]
SGTM :-)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=760887#c22)• 13 years ago |
|  | |

I guess we can call this fixed in 17. I don't know how scary it is to backport [bug 774245](/show_bug.cgi?id=774245 "RESOLVED FIXED - Reimplement Components.*.lookupMethod in terms of Xray wrapper").Status: NEW → RESOLVEDClosed: 13 years ago
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)Resolution: --- → FIXEDWhiteboard: to be fixed by bug 774245 → fixed by bug 774245

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=760887#a9312118_279076)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=760887#c23)• 12 years ago |
|  | |

At this point, I imagine [bug 774245](/show_bug.cgi?id=774245 "RESOLVED FIXED - Reimplement Components.*.lookupMethod in terms of Xray wrapper") isn't going to be backported to beta, so I'm just going to mark this wontfix.
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=760887#a13029521_280903)• 12 years ago |

Whiteboard: fixed by bug 774245 → [adv-track-main17+] fixed by bug 774245

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=760887#c24)• 12 years ago |
|  | |

I don't know how to rate this from a security standpoint, and it may not be worth a lot of effort getting it right since we've fixed it now. Would the same errors crop up with more interesting objects than btoa? Going with sec-high just because wrapper bugs give me the willies.Depends on: [774245](/show_bug.cgi?id=774245 "RESOLVED FIXED - Reimplement Components.*.lookupMethod in terms of Xray wrapper")Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=760887#a24944651_1689)• 12 years ago |

Group: core-security

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=760887#c25)• 11 years ago |
|  | |

mass remove verifyme requests greater than 4 months oldKeywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)
You need to [log in](/show_bug.cgi?id=760887&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.novell.com_6b513999_20250126_012808.html ===




=== Content from bugzilla.mozilla.org_e2ca488f_20250126_012806.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sat Jan 25 2025 17:28:05 PST

* **Bug ID:**
  797163,
  760887,
  774953,
  791601,
  781859,
  788822,
  765409,
  780778,
  784404,
  789075,
  793253,
  795281,
  798678,
  787089

---

14 bugs found.

| [ID](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [760887](/show_bug.cgi?id=760887 "RESOLVED FIXED - \"ASSERTION: function object has parent of unknown class!\"") |  | ["ASSERTION: function object has parent of unknown class!"](/show_bug.cgi?id=760887) | Core | XPConnect | bholley | RESO | FIXE | 2014-01-10 |
| [798678](/show_bug.cgi?id=798678 "RESOLVED FIXED - WeakMaps with keys from another compartment are possible and incorrect") |  | [WeakMaps with keys from another compartment are possible and incorrect](/show_bug.cgi?id=798678) | Core | JavaScript Engine | bill.mccloskey | RESO | FIXE | 2014-04-22 |
| [793253](/show_bug.cgi?id=793253 "RESOLVED FIXED - Supposedly infallible TArray can fail to allocate a buffer") |  | [Supposedly infallible TArray can fail to allocate a buffer](/show_bug.cgi?id=793253) | Core | XPCOM | bzbarsky | RESO | FIXE | 2013-03-18 |
| [784404](/show_bug.cgi?id=784404 "RESOLVED FIXED - Intermittent assertion in dom/devicestorage/test/test_basic.html (\"Assertion failure: i < Length() (invalid array index), at e:\builds\moz2_slave\m-in-w32-dbg\build\obj-firefox\dist\include\nsTArray.h:526\")") |  | [Intermittent assertion in dom/devicestorage/test/test\_basic.html ("Assertion failure: i < Length() (invalid array index), at e:\builds\moz2\_slave\m-in-w32-dbg\build\obj-firefox\dist\include\nsTArray.h:526")](/show_bug.cgi?id=784404) | Core | DOM: Device Interfac | doug.turner | RESO | FIXE | 2013-03-18 |
| [795281](/show_bug.cgi?id=795281 "RESOLVED FIXED - Read after free in nsXPCWrappedJS::Release()") |  | [Read after free in nsXPCWrappedJS::Release()](/show_bug.cgi?id=795281) | Toolkit | Safe Browsing | gpascutto | RESO | FIXE | 2014-05-27 |
| [780778](/show_bug.cgi?id=780778 "RESOLVED FIXED - Make sure we always release stuff on the right thread.") |  | [Make sure we always release stuff on the right thread.](/show_bug.cgi?id=780778) | Core | Storage: IndexedDB | khuey | RESO | FIXE | 2013-03-18 |
| [789075](/show_bug.cgi?id=789075 "RESOLVED FIXED - Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool") |  | [Video playback causes browser to stop responding (mostly) or crash in Cleopatra tool](/show_bug.cgi?id=789075) | Core | Audio/Video | kinetik | RESO | FIXE | 2017-06-07 |
| [787089](/show_bug.cgi?id=787089 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this") |  | [Crash [@ nsStyleContext::GetRuleNode()] with deleted this](/show_bug.cgi?id=787089) | Core | Layout | roc | RESO | FIXE | 2014-01-10 |
| [774953](/show_bug.cgi?id=774953 "VERIFIED FIXED - \"Assertion failure: [infer failure] Missing type pushed 0\" with iframes, adoptNode") |  | ["Assertion failure: [infer failure] Missing type pushed 0" with iframes, adoptNode](/show_bug.cgi?id=774953) | Core | JavaScript Engine | bhackett1024 | VERI | FIXE | 2014-02-26 |
| [781859](/show_bug.cgi?id=781859 "VERIFIED FIXED - Assertion failure: lifetime && lifetime->head == uint32_t(head - outerScript->code) && lifetime->entry == uint32_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80") |  | [Assertion failure: lifetime && lifetime->head == uint32\_t(head - outerScript->code) && lifetime->entry == uint32\_t(entryTarget - outerScript->code), at methodjit/LoopState.cpp:80](/show_bug.cgi?id=781859) | Core | JavaScript Engine | bhackett1024 | VERI | FIXE | 2013-03-18 |
| [788822](/show_bug.cgi?id=788822 "VERIFIED FIXED - Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328") |  | [Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328](/show_bug.cgi?id=788822) | Core | JavaScript Engine | bhackett1024 | VERI | FIXE | 2013-03-18 |
| [797163](/show_bug.cgi?id=797163 "VERIFIED FIXED - \"Assertion failure: lifetime->entry == uint32_t(entryTarget - outerScript->code),\"") |  | ["Assertion failure: lifetime->entry == uint32\_t(entryTarget - outerScript->code),"](/show_bug.cgi?id=797163) | Core | JavaScript Engine | jdemooij | VERI | FIXE | 2013-03-19 |
| [765409](/show_bug.cgi?id=765409 "VERIFIED FIXED - Crash [@ nsLineLayout::ReflowFrame(nsIFrame *,unsigned int &,nsHTMLReflowMetrics *,bool &) ] | ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)' | ASSERTION: StealFrame: can't find aChild: 'removed' | ASSERTION: StealFrame failure: 'NS_SUCCE") |  | [Crash [@ nsLineLayout::ReflowFrame(nsIFrame \*,unsigned int &,nsHTMLReflowMetrics \*,bool &) ] | ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)' | ASSERTION: StealFrame: can't find aChild: 'removed' | ASSERTION: StealFrame failure: 'NS\_SUCCE](/show_bug.cgi?id=765409) | Core | Layout | MatsPalmgren\_bugz | VERI | FIXE | 2017-10-06 |
| [791601](/show_bug.cgi?id=791601 "VERIFIED FIXED - \"Assertion failure: checkmTextrun ? !mTextRun : !Properties().Get(UninflatedTextRunProperty())\" with font inflation, -moz-column") |  | ["Assertion failure: checkmTextrun ? !mTextRun : !Properties().Get(UninflatedTextRunProperty())" with font inflation, -moz-column](/show_bug.cgi?id=791601) | Core | Layout | MatsPalmgren\_bugz | VERI | FIXE | 2013-07-02 |

14 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=797163%2C760887%2C774953%2C791601%2C781859%2C788822%2C765409%2C780778%2C784404%2C789075%2C793253%2C795281%2C798678%2C787089&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |



=== Content from www.mozilla.org_d87ca799_20250124_140952.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2012-91

## Miscellaneous memory safety hazards (rv:17.0/ rv:10.0.11)

Announced
November 20, 2012
Reporter
Mozilla Developers
Impact
Critical
Products
Firefox, Firefox ESR, SeaMonkey, Thunderbird, Thunderbird ESR
Fixed in

* Firefox 17
* Firefox ESR 10.0.11
* SeaMonkey 2.14
* Thunderbird 17
* Thunderbird ESR 10.0.11

### Description

Mozilla developers identified and fixed several memory safety bugs in the
browser engine used in Firefox and other Mozilla-based products. Some of these
bugs showed evidence of memory corruption under certain circumstances, and we
presume that with enough effort at least some of these could be exploited to run
arbitrary code.

In general these flaws cannot be exploited through email in the Thunderbird and SeaMonkey products because scripting is disabled, but are potentially a risk in browser or browser-like contexts in those products.

### References

Gary Kwong, Jesse Ruderman, Christian Holler, Bob Clary, Kyle Huey, Ed Morley, Chris Lord, Boris Zbarsky, Julian Seward, and Bill McCloskey reported memory safety problems and crashes that affect Firefox 16.

* [Memory safety bugs fixed in Firefox 17](https://bugzilla.mozilla.org/buglist.cgi?bug_id=797163,760887,774953,791601,781859,788822,765409,780778,784404,789075,793253,795281,798678,787089)
* [CVE-2012-5843](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5843)

Jesse Ruderman, Andrew McCreight, Bob Clary, and Kyle Huey reported memory safety problems and crashes that affect Firefox ESR 10 and Firefox 16.

* [Memory safety bugs fixed in Firefox ESR 10.0.11 and Firefox 17](https://bugzilla.mozilla.org/buglist.cgi?bug_id=793848,805957,802168,736537,809674)
* [CVE-2012-5842](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5842)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_9a7558d2_20250124_140958.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/765409)
* [XML](/show_bug.cgi?ctype=xml&id=765409)

Closed
[Bug 765409](/show_bug.cgi?id=765409)

Opened 13 years ago
Closed 12 years ago

# Crash [@ nsLineLayout::ReflowFrame(nsIFrame \*,unsigned int &,nsHTMLReflowMetrics \*,bool &) ] | ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)' | ASSERTION: StealFrame: can't find aChild: 'removed' | ASSERTION: StealFrame failure: 'NS\_SUCCE

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ nsLineLayout::ReflowFrame(nsIFrame \*,unsigned int &,nsHTMLReflowMetrics \*,bool &) ] | ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)' | ASSERTION: StealFrame: can't find aChild: 'removed' | ASSERTION: StealFrame failure: 'NS\_SUCCE

## Categories

### (Core :: Layout, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout#Layout)

Layout
▾

Core :: Layout

Issues in Layout that do not fit into any other Layout component or which span multiple Layout components.

Bugs related to the top level presentation objects (pres shell, pres context, and document viewer), the frame constructor, and the base frame classes, as well as general issues with alignment and sizing, all belong here.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

14 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla18

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox14 | [-](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=wontfix) |
| firefox15 | [-](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix) |
| firefox16 | [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |
| firefox-esr17 | --- | [verified](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox14 | - | wontfix |
| firefox15 | - | wontfix |
| firefox16 | - | wontfix |
| firefox17 | + | verified |
| firefox18 | + | verified |
| firefox-esr10 |  | unaffected |
| firefox-esr17 |  | verified |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bc, Assigned: MatsPalmgren\_bugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ee4c7c6351b45c4655e16993a29979b0?d=mm&size=40)  [bc](/user_profile?user_id=23402)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=40)  [dholbert](/user_profile?user_id=278074)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

18 people

## References

### ( [URL](http://www2.emersonprocess.com/en-US/brands/EIM-Actuators/Products/Electric/Pages/M2CP_Electric_Actuator.aspx "http://www2.emersonprocess.com/en-US/brands/EIM-Actuators/Products/Electric/Pages/M2CP_Electric_Actuator.aspx") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[837007](/show_bug.cgi?id=837007 "RESOLVED FIXED - \"ASSERTION: Out of flow frame doesn't have the expected parent\" and crash with -moz-column, float")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[5588](/show_bug.cgi?id=5588 "VERIFIED FIXED - Very slow in viewing JAVA 2 API docs..."), [765711](/show_bug.cgi?id=765711 "RESOLVED DUPLICATE - Heap-use-after-free in nsFrameList::RemoveFirstChild")

Dependency [tree](/showdependencytree.cgi?id=765409&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=765409)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[760952](/show_bug.cgi?id=760952 "RESOLVED DUPLICATE - crash in nsLineLayout::ReflowFrame"), [765711](/show_bug.cgi?id=765711 "RESOLVED DUPLICATE - Heap-use-after-free in nsFrameList::RemoveFirstChild"), [802991](/show_bug.cgi?id=802991 "RESOLVED DUPLICATE - Use-after-free in nsLineLayout")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[www2.emersonprocess.com/en-US/brands/...](http://www2.emersonprocess.com/en-US/brands/EIM-Actuators/Products/Electric/Pages/M2CP_Electric_Actuator.aspx "http://www2.emersonprocess.com/en-US/brands/EIM-Actuators/Products/Electric/Pages/M2CP_Electric_Actuator.aspx")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (6 keywords, Whiteboard: [adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[highrisk](/buglist.cgi?keywords=highrisk&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [MatsPalmgren\_bugz](/user_profile?user_id=5168) | [in-testsuite](#c35 "12 years ago") | + |
| --- | --- | --- |
| [MatsPalmgren\_bugz](/user_profile?user_id=5168) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsLineLayout::ReflowFrame(nsIFrame\*, unsigned int&, nsHTMLReflowMetrics\*, bool&) ]](https://crash-stats.mozilla.org/signature/?signature=nsLineLayout%3A%3AReflowFrame%28nsIFrame%2A%2C%20unsigned%20int%26%2C%20nsHTMLReflowMetrics%2A%2C%20bool%26%29)

[[@ nsLineLayout::ReflowFrame ]](https://crash-stats.mozilla.org/signature/?signature=nsLineLayout%3A%3AReflowFrame)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 3 obsolete files)

| [crash report](/attachment.cgi?id=633722)  [13 years ago](#c0)  [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402)   75.45 KB, text/plain |  | [Details](/attachment.cgi?id=633722&action=edit) |
| --- | --- | --- |
| [frame dump](/attachment.cgi?id=633852)  [13 years ago](#c3)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   52.87 KB, text/html |  | [Details](/attachment.cgi?id=633852&action=edit) |
| [fix](/attachment.cgi?id=633853)  [13 years ago](#c4)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   3.74 KB, patch |  | [Details](/attachment.cgi?id=633853&action=edit) | [Diff](/attachment.cgi?id=633853&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=633853) |
| [testcase (crashes Firefox when loaded)](/attachment.cgi?id=633872)  [13 years ago](#c7)  [Jesse Ruderman](/user_profile?user_id=11608)   578 bytes, text/html |  | [Details](/attachment.cgi?id=633872&action=edit) |
| [fix v2](/attachment.cgi?id=654369)  [12 years ago](#c13)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   14.50 KB, patch | bzbarsky : [review+](#c16 "12 years ago") | [Details](/attachment.cgi?id=654369&action=edit) | [Diff](/attachment.cgi?id=654369&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=654369) |
| [fix v2, wdiff](/attachment.cgi?id=654370)  [12 years ago](#c14)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   13.35 KB, patch |  | [Details](/attachment.cgi?id=654370&action=edit) | [Diff](/attachment.cgi?id=654370&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=654370) |
| [frame tree for failed assertion](/attachment.cgi?id=658670)  [12 years ago](#c17)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   46.32 KB, text/html |  | [Details](/attachment.cgi?id=658670&action=edit) |
| [fix, v3](/attachment.cgi?id=659230)  [12 years ago](#c20)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   14.60 KB, patch | bzbarsky : [review+](#c21 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c29 "12 years ago") | [Details](/attachment.cgi?id=659230&action=edit) | [Diff](/attachment.cgi?id=659230&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=659230) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=765409#c0)• 13 years ago |
|  | |

Attached file
[crash report](attachment.cgi?id=633722)
— [Details](attachment.cgi?id=633722&action=edit)

1. <http://www2.emersonprocess.com/en-US/brands/EIM-Actuators/Products/Electric/Pages/M2CP_Electric_Actuator.aspx>
###!!! ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)', file c:/work/mozilla/builds/nightly/mozilla/layout/generic/nsInlineFrame.cpp, line 500
###!!! ASSERTION: StealFrame: can't find aChild: 'removed', file c:/work/mozilla/builds/nightly/mozilla/layout/generic/nsContainerFrame.cpp, line 1210
###!!! ASSERTION: StealFrame failure: 'NS\_SUCCEEDED(rv)', file c:/work/mozilla/builds/nightly/mozilla/layout/generic/nsContainerFrame.cpp, line 1339
Crash @ nsLineLayout::ReflowFrame(nsIFrame \*,unsigned int &,nsHTMLReflowMetrics \*,bool &)
This appears to be Beta/14, Aurora/15, and Nightly/16 though I am getting inconsistent results sometimes on different platforms.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a28683_386758)• 13 years ago |

Crash Signature: nsLineLayout::ReflowFrame(nsIFrame \*,unsigned int &,nsHTMLReflowMetrics \*,bool &)
nsLineLayout::ReflowFrame) → [@ nsLineLayout::ReflowFrame(nsIFrame \*,unsigned int &,nsHTMLReflowMetrics \*,bool &) ]
[@ nsLineLayout::ReflowFrame ]

|  | [Loic](/user_profile?user_id=337567) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=765409#c1)• 13 years ago |
|  | |

Mozregression range:
m-c
good=2012-03-20
bad=2012-03-21
<http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=b972b89518c3&tochange=4bdae514b9be>
m-i
good=2012-03-19
bad=2012-03-20
<http://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=6dd5b6014511&tochange=46c5015550af>

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=765409#c2)• 13 years ago |
|  | |

It might be a regression from [bug 537624](/show_bug.cgi?id=537624 "RESOLVED FIXED - \"ASSERTION: Already have an undisplayed context entry for aContent\" with {ib}").Version: Trunk → 14 Branch

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=765409#c3)• 13 years ago |
|  | |

Attached file
[frame dump](attachment.cgi?id=633852)
— [Details](attachment.cgi?id=633852&action=edit)

I think the assumption here
<http://hg.mozilla.org/mozilla-central/annotate/9602a9e99045/layout/generic/nsInlineFrame.cpp#l490>
that all our children's NIFs must be in our child list and should
be reparented is wrong.Assignee: nobody → matspal

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=765409#c4)• 13 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=633853&action=diff) (obsolete)
— [Details](attachment.cgi?id=633853&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=633853)

Only reparent a child's next-in-flows that has our prevInFlow as parent (we stole those from its OverflowList).
<https://tbpl.mozilla.org/?usebuildbot=1&tree=Try&rev=09c6f9338c13>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=765409#c5)• 13 years ago |
|  | |

The code here still looks a bit fragile. If we leave the loop that
reparent and reflow child frames early we leave a tail with the
wrong parent. It looks like we have something in Reflow to fix that
(assuming they got pushed to our OverflowList):
<http://hg.mozilla.org/mozilla-central/annotate/9602a9e99045/layout/generic/nsInlineFrame.cpp#l364>
but it only does a simple SetParent, not the ReparentFloatsForInlineChild
and ReparentStyleContext that we do in the loop.
I think it would be more robust to continue reparenting all the child
frames, but not reflow any after 'done' is set true of course.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=765409#c6)• 13 years ago |
|  | |

It's more complicated than that since ReflowInlineFrame also does
reparenting, and may have pushed the tail to our own OverflowList:
<http://hg.mozilla.org/mozilla-central/annotate/9602a9e99045/layout/generic/nsInlineFrame.cpp#l670>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a98844_5168)• 13 years ago |

Keywords: [testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=765409#c7)• 13 years ago |
|  | |

Attached file
[testcase (crashes Firefox when loaded)](attachment.cgi?id=633872)
— [Details](attachment.cgi?id=633872&action=edit)

The reduction was fairly straightforward. The less obvious bits:
\* A slow-loading image became a dynamic change to an inline-block element's size.
\* <div style="display: inline"> became <span style="unicode-bidi: -moz-isolate">
Suddenly the fuzz testcase in [bug 760957](/show_bug.cgi?id=760957 "RESOLVED WORKSFORME - \"ASSERTION: unexpected flow\" and more with bidi, generated content") doesn't seem so weird!

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a120657_11608)• 13 years ago |

Keywords: [testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---) → [testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a317135_152868)• 13 years ago |

Group: core-security

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a321826_11171)• 13 years ago |

Blocks: [765711](/show_bug.cgi?id=765711 "RESOLVED DUPLICATE - Heap-use-after-free in nsFrameList::RemoveFirstChild")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a408843_1689)• 13 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=765409#c9)• 13 years ago |
|  | |

Hi Mats, it looks like you aren't quite happy with your current fix?
[tracking-firefox14](/buglist.cgi?f1=cf_tracking_firefox14&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=%2B)
[tracking-firefox15](/buglist.cgi?f1=cf_tracking_firefox15&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%2B)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=765409#c10)• 13 years ago |
|  | |

Comment on [attachment 633853](/attachment.cgi?id=633853 "fix") [[details]](/attachment.cgi?id=633853&action=edit "fix") [[diff]](/attachment.cgi?id=633853&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=633853)
fix
Right.
[Attachment #633853](/attachment.cgi?id=633853&action=edit "fix") -
Attachment is obsolete: true

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=765409#c11)• 13 years ago |
|  | |

What should we do here?
[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=wontfix)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[tracking-firefox14](/buglist.cgi?f1=cf_tracking_firefox14&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=-)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=765409#c12)• 12 years ago |
|  | |

(In reply to David Bolter [:davidb] from [comment #11](/show_bug.cgi?id=765409#c11 "VERIFIED FIXED - Crash [@ nsLineLayout::ReflowFrame(nsIFrame *,unsigned int &,nsHTMLReflowMetrics *,bool &) ] | ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)' | ASSERTION: StealFrame: can't find aChild: 'removed' | ASSERTION: StealFrame failure: 'NS_SUCCE"))
> What should we do here?
We're still targeting this for FF15 if a low risk fix is found. What are the next steps here?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=765409#c13)• 12 years ago |
|  | |

Attached patch

[fix v2](attachment.cgi?id=654369&action=diff) (obsolete)
— [Details](attachment.cgi?id=654369&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=654369)

Comments roughly per hunk in the order they appear:
Return earlier in case of IsFrameTreeTooDeep (to avoid leaving frames
on the principal list that needs reparenting)
If we're not lazily reparenting, then reparent any frames we still
from the prev-in-flow overflow list full - i.e. SetParent +
ReparentFloatsForInlineChild + ReparentStyleContext (if :first-line).
Reparent the next-in-flows of a child we're lazily parenting, until
we find a sibling with our next-in-flow as the parent (this is the
correct condition to test for unlike the last patch).
When lazily reparenting, if we stop reflowing children for some
reason then continue reparenting the remaining children on the
principal list...
... thus no need to that in ReflowInlineFrame.
In PullOneFrame, we only need one frame so don't pull in all frames
from the nif's overflow list since then we would need to reparent
all of them. (thus leaving the nif's principal list empty when we
return - I don't see a problem with that).
Green on Try:
<https://tbpl.mozilla.org/?usebuildbot=1&tree=Try&rev=c6defdd9ee36>
[Attachment #654369](/attachment.cgi?id=654369&action=edit "fix v2") -
Flags: review?(bzbarsky)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=765409#c14)• 12 years ago |
|  | |

Attached patch

[fix v2, wdiff](attachment.cgi?id=654370&action=diff) (obsolete)
— [Details](attachment.cgi?id=654370&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=654370)

... well, the hunks I commented is the ones in this diff actually.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=765409#c15)• 12 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #12](/show_bug.cgi?id=765409#c12 "VERIFIED FIXED - Crash [@ nsLineLayout::ReflowFrame(nsIFrame *,unsigned int &,nsHTMLReflowMetrics *,bool &) ] | ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)' | ASSERTION: StealFrame: can't find aChild: 'removed' | ASSERTION: StealFrame failure: 'NS_SUCCE"))
> We're still targeting this for FF15 if a low risk fix is found. What are the
> next steps here?
I think this patch is too high risk for 15.Keywords: [highrisk](/buglist.cgi?keywords=highrisk&resolution=---)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=765409#c16)• 12 years ago |
|  | |

Comment on [attachment 654369](/attachment.cgi?id=654369 "fix v2") [[details]](/attachment.cgi?id=654369&action=edit "fix v2") [[diff]](/attachment.cgi?id=654369&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=654369)
fix v2
r=me
[Attachment #654369](/attachment.cgi?id=654369&action=edit "fix v2") -
Flags: review?(bzbarsky) → review+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=765409#c17)• 12 years ago |
|  | |

Attached file
[frame tree for failed assertion](attachment.cgi?id=658670)
— [Details](attachment.cgi?id=658670&action=edit)

Oops, I triggered this assertion while testing this again...
It seems our stop condition - that the child's nif's parent is
our nif, does not hold because it can be further away in the
nif chain.
In this case, we have an empty nif (lime 0x7fffddb49ae0) in
between us (blue 0x7fffd70793f0) and our child's nif (red).
[Attachment #654369](/attachment.cgi?id=654369&action=edit "fix v2") -
Attachment is obsolete: true
[Attachment #654370](/attachment.cgi?id=654370&action=edit "fix v2, wdiff") -
Attachment is obsolete: true

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=765409#c18)• 12 years ago |
|  | |

So to avoid doing O(n\*m) frame traversals we could put all
the (m) nifs in a temporary hashtable, but that seems a bit
expensive for the gain of lazy parenting.
Perhaps we should just not do lazy parenting in case there
are more than one nif?
Suggestions?

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=765409#c19)• 12 years ago |
|  | |

Find our first non-empty next-in-flow and use that for all n frames?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a7159145_1689)• 12 years ago |

[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[tracking-firefox15](/buglist.cgi?f1=cf_tracking_firefox15&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=-)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=765409#c20)• 12 years ago |
|  | |

Attached patch

[fix, v3](attachment.cgi?id=659230&action=diff)
— [Details](attachment.cgi?id=659230&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=659230)

Thanks roc, yes that would work, but I think I've found better way.
I collected some statistics on the frame tree when
"child->GetNextInFlow()" is non-null:
Running reftests+crashtests results in 10 hits (~0.5%), in all of them
the nif equals GetNextSibling().
Loading the Alexa top 100 sites results in zero hits (even when
resizing the window, reloading etc).
For the crash URL, the hit rate is ~3%, in 75% of those the nif
is the next-sibling. The remaining 25% are either in the inline's nif,
or in an empty nif's nif (and in these cases GetNextSibling() is null).
So, in 100% of the tests, the nif is either the next sibling (and
we should reparent it) or the next sibling is null (and we shouldn't).
I think it's rather unlikely that we will have any other cases.
====
This patch is the same as before but with the following inter-diff:
140a141
> + nsIFrame\* nextSibling = child->GetNextSibling();
142,145c143,149
< + if (child && child->GetParent() == GetNextContinuation() &&
< + GetNextContinuation()) {
< + MOZ\_ASSERT(!mFrames.ContainsFrame(child));
< + child = nullptr;
---
> + if (NS\_UNLIKELY(child)) {
> + while (child != nextSibling && nextSibling) {
> + nextSibling = nextSibling->GetNextSibling();
> + }
> + if (!nextSibling) {
> + child = nullptr;
> + }
So instead of testing the child's parent I'm simply iterating the
siblings to see of it can be found (for the test data above we will
never enter the loop). This is better because it's exactly what
we want to do - if it's in mFrames it should be reparented.
<https://tbpl.mozilla.org/?tree=Try&rev=7ced33ae2dd1>
[Attachment #659230](/attachment.cgi?id=659230&action=edit "fix, v3") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=765409#c21)• 12 years ago |
|  | |

Comment on [attachment 659230](/attachment.cgi?id=659230 "fix, v3") [[details]](/attachment.cgi?id=659230&action=edit "fix, v3") [[diff]](/attachment.cgi?id=659230&action=diff "fix, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=659230)
fix, v3
r=me
[Attachment #659230](/attachment.cgi?id=659230&action=edit "fix, v3") -
Flags: review?(bzbarsky) → review+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=765409#c22)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/e0c765e8be0f>Flags: in-testsuite?Target Milestone: --- → mozilla18

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=765409#c23)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/e0c765e8be0f>Status: NEW → RESOLVEDClosed: 12 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a7274281_75935)• 12 years ago |

[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)

|  | [Robert Kaiser](/user_profile?user_id=5189) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=765409#c24)• 12 years ago |
|  | |

This is sec-critical and tracking-firefox17+, are we planning on landing this on beta?Crash Signature: [@ nsLineLayout::ReflowFrame(nsIFrame \*,unsigned int &,nsHTMLReflowMetrics \*,bool &) ]
[@ nsLineLayout::ReflowFrame ] → [@ nsLineLayout::ReflowFrame(nsIFrame\*, unsigned int&, nsHTMLReflowMetrics\*, bool&) ]
[@ nsLineLayout::ReflowFrame ]

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=765409#c25)• 12 years ago |
|  | |

Comment on [attachment 659230](/attachment.cgi?id=659230 "fix, v3") [[details]](/attachment.cgi?id=659230&action=edit "fix, v3") [[diff]](/attachment.cgi?id=659230&action=diff "fix, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=659230)
fix, v3
[Approval Request Comment]
Bug caused by (feature/regressing bug #):
User impact if declined: sec-critical crash
Testing completed (on m-c, etc.): on trunk/aurora since 2012-09-07
Risk to taking this patch (and alternatives if risky): medium risk since the code is somewhat fragile. The final patch (v3) is much better than the earlier iterations though (which [comment 15](/show_bug.cgi?id=765409#c15 "VERIFIED FIXED - Crash [@ nsLineLayout::ReflowFrame(nsIFrame *,unsigned int &,nsHTMLReflowMetrics *,bool &) ] | ASSERTION: unexpected flow: 'mFrames.ContainsFrame(nextInFlow)' | ASSERTION: StealFrame: can't find aChild: 'removed' | ASSERTION: StealFrame failure: 'NS_SUCCE") refers to as high risk).
String or UUID changes made by this patch: none
[Attachment #659230](/attachment.cgi?id=659230&action=edit "fix, v3") -
Flags: approval-mozilla-beta?

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a10736358_386758)• 12 years ago |

No longer blocks: [760952](/show_bug.cgi?id=760952 "RESOLVED DUPLICATE - crash in nsLineLayout::ReflowFrame")

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=765409#c28)• 12 years ago |
|  | |

Please set sec-approval? on this patch as it fits the criteria, being sec-critical and looking for uplift.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=765409#c29)• 12 years ago |
|  | |

Comment on [attachment 659230](/attachment.cgi?id=659230 "fix, v3") [[details]](/attachment.cgi?id=659230&action=edit "fix, v3") [[diff]](/attachment.cgi?id=659230&action=diff "fix, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=765409&attachment=659230)
fix, v3
Sorry, my bad - this doesn't need sec-approval given that it's already on trunk & Aurora now.
[Attachment #659230](/attachment.cgi?id=659230&action=edit "fix, v3") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=765409#c30)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/f7d473f3a067>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a11160981_75935)• 12 years ago |

[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a11921171_280903)• 12 years ago |

Whiteboard: [adv-track-main17+]

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a12436948_279076)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=765409#c31)• 12 years ago |
|  | |

Confirmed crash on build 2012-6-15 nightly
Verified fixed on build 2012-11-13, 17.0b6
Win7 and Mac OS 10.8
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=765409#c32)• 12 years ago |
|  | |

Thanks Matt, can you also verify in the latest 17esr nightly? Aurora 18.0a2 too if you have time.

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=765409#c33)• 12 years ago |
|  | |

Verified fixed on build 2012-11-14, 17.0 ESR
Verified fixed on build 2012-11-14, 18.0a2 Aurora
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=verified)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a20045159_5168)• 12 years ago |

Depends on: [837007](/show_bug.cgi?id=837007 "RESOLVED FIXED - \"ASSERTION: Out of flow frame doesn't have the expected parent\" and crash with -moz-column, float")

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=765409#c34)• 12 years ago |
|  | |

Thanks Matt.
Changing status-firefox16:affected to wontfix since we won't be issuing patches for that version.Status: RESOLVED → VERIFIED
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a23833367_1689)• 12 years ago |

Group: core-security

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=765409#c35)• 12 years ago |
|  | |

Crash test:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/4c559cbeba13>Flags: in-testsuite? → in-testsuite+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=765409#c36)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/4c559cbeba13>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a89403950_5168)• 10 years ago |

Blocks: [5588](/show_bug.cgi?id=5588 "VERIFIED FIXED - Very slow in viewing JAVA 2 API docs...")

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a166772652_20209)• 7 years ago |

Depends on: [1382213](/show_bug.cgi?id=1382213 "RESOLVED FIXED - Use-after-poison in [@nsLayoutUtils::GetFloatContainingBlock(nsIFrame*)]")

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=765409#a167528194_5168)• 7 years ago |

No longer depends on: [1382213](/show_bug.cgi?id=1382213 "RESOLVED FIXED - Use-after-poison in [@nsLayoutUtils::GetFloatContainingBlock(nsIFrame*)]")
You need to [log in](/show_bug.cgi?id=765409&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.ubuntu.com_62525693_20250124_140955.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1638-2: ubufox update

21 November 2012

This update provides compatible ubufox packages for the latest Firefox.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 11.10](/security/notices?release=oneiric)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [ubufox](/security/cves?package=ubufox) - Ubuntu Firefox specific configuration defaults and apt support

## Details

USN-1638-1 fixed vulnerabilities in Firefox. This update provides an

updated ubufox package for use with the latest Firefox.

Original advisory details:

Gary Kwong, Jesse Ruderman, Christian Holler, Bob Clary, Kyle Huey, Ed

Morley, Chris Lord, Boris Zbarsky, Julian Seward, Bill McCloskey, and

Andrew McCreight discovered multiple memory safety issues affecting

Firefox. If the user were tricked into opening a specially crafted page, an

attacker could possibly exploit these to cause a denial of service via

application crash, or potentially execute code with the privileges of the

user invoking Firefox. ([CVE-2012-5842](/security/CVE-2012-5842), [CVE-2012-5843](/security/CVE-2012-5843))

Atte Kettunen discovered a buffer overflow while rendering GIF format

images. An attacker could exploit this to possibly execute arbitrary code

as the user invoking Firefox. ([CVE-2012-4202](/security/CVE-2012-4202))

It was discovered that the evalInSandbox function's JavaScript sandbox

context could be circumvented. An attacker could exploit this to perform a

cross-site scripting (XSS) attack or steal a copy of a local file if the

user has installed an add-on vulnerable to this attack. With cross-site

scripting vulnerabilities, if a user were tricked into viewing a specially

crafted page, a remote attacker could exploit this to modify the contents,

or steal confidential data, within the same domain. ([CVE-2012-4201](/security/CVE-2012-4201))

Jonathan Stephens discovered that combining vectors involving the setting

of Cascading Style Sheets (CSS) properties in conjunction with SVG text

could cause Firefox to crash. If a user were tricked into opening a

malicious web page, an attacker could cause a denial of service via

application crash or execute arbitrary code with the privliges of the user

invoking the program. ([CVE-2012-5836](/security/CVE-2012-5836))

It was discovered that if a javascript: URL is selected from the list of

Firefox "new tab" page, the script will inherit the privileges of the

privileged "new tab" page. This allows for the execution of locally

installed programs if a user can be convinced to save a bookmark of a

malicious javascript: URL. ([CVE-2012-4203](/security/CVE-2012-4203))

Scott Bell discovered a memory corruption issue in the JavaScript engine.

If a user were tricked into opening a malicious website, an attacker could

exploit this to execute arbitrary JavaScript code within the context of

another website or arbitrary code as the user invoking the program.

([CVE-2012-4204](/security/CVE-2012-4204))

Gabor Krizsanits discovered that XMLHttpRequest objects created within

sandboxes have the system principal instead of the sandbox principal. This

can lead to cross-site request forgery (CSRF) or information theft via an

add-on running untrusted code in a sandbox. ([CVE-2012-4205](/security/CVE-2012-4205))

Peter Van der Beken discovered XrayWrapper implementation in Firefox does

not consider the compartment during property filtering. An attacker could

use this to bypass intended chrome-only restrictions on reading DOM object

properties via a crafted web site. ([CVE-2012-4208](/security/CVE-2012-4208))

Bobby Holley discovered that cross-origin wrappers were allowing write

actions on objects when only read actions should have been properly

allowed. This can lead to cross-site scripting (XSS) attacks. With

cross-site scripting vulnerabilities, if a user were tricked into viewing a

specially crafted page, a remote attacker could exploit this to modify the

contents, or steal confidential data, within the same domain.

([CVE-2012-5841](/security/CVE-2012-5841))

Masato Kinugawa discovered that when HZ-GB-2312 charset encoding is used

for text, the "~" character will destroy another character near the chunk

delimiter. This can lead to a cross-site scripting (XSS) attack in pages

encoded in HZ-GB-2312. With cross-site scripting vulnerabilities, if a user

were tricked into viewing a specially crafted page, a remote attacker could

exploit these to modify the contents, or steal confidential data, within

the same domain. ([CVE-2012-4207](/security/CVE-2012-4207))

Mariusz Mlynski discovered that the location property can be accessed by

binary plugins through top.location with a frame whose name attribute's

value is set to "top". This can allow for possible cross-site scripting

(XSS) attacks through plugins. With cross-site scripting vulnerabilities,

if a user were tricked into viewing a specially crafted page, a remote

attacker could exploit this to modify the contents, or steal confidential

data, within the same domain. ([CVE-2012-4209](/security/CVE-2012-4209))

Mariusz Mlynski discovered that when a maliciously crafted stylesheet is

inspected in the Style Inspector, HTML and CSS can run in a chrome

privileged context without being properly sanitized first. If a user were

tricked into opening a malicious web page, an attacker could execute

arbitrary code with the privliges of the user invoking the program.

([CVE-2012-4210](/security/CVE-2012-4210))

Abhishek Arya discovered multiple use-after-free and buffer overflow issues

in Firefox. If a user were tricked into opening a malicious page, an

attacker could exploit these to execute arbitrary code as the user invoking

the program. ([CVE-2012-4214](/security/CVE-2012-4214), [CVE-2012-4215](/security/CVE-2012-4215), [CVE-2012-4216](/security/CVE-2012-4216), [CVE-2012-5829](/security/CVE-2012-5829),

[CVE-2012-5839](/security/CVE-2012-5839), [CVE-2012-5840](/security/CVE-2012-5840), [CVE-2012-4212](/security/CVE-2012-4212), [CVE-2012-4213](/security/CVE-2012-4213), [CVE-2012-4217](/security/CVE-2012-4217),

[CVE-2012-4218](/security/CVE-2012-4218))

Several memory corruption flaws were discovered in Firefox. If a user were

tricked into opening a malicious page, an attacker could exploit these to

execute arbitrary code as the user invoking the program. ([CVE-2012-5830](/security/CVE-2012-5830),

[CVE-2012-5833](/security/CVE-2012-5833), [CVE-2012-5835](/security/CVE-2012-5835), [CVE-2012-5838](/security/CVE-2012-5838))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.10

* [xul-ext-ubufox](https://launchpad.net/ubuntu/%2Bsource/ubufox)
  -
  [2.6-0ubuntu0.12.10.1](https://launchpad.net/ubuntu/%2Bsource/ubufox/2.6-0ubuntu0.12.10.1)

##### Ubuntu 12.04

* [xul-ext-ubufox](https://launchpad.net/ubuntu/%2Bsource/ubufox)
  -
  [2.6-0ubuntu0.12.04.1](https://launchpad.net/ubuntu/%2Bsource/ubufox/2.6-0ubuntu0.12.04.1)

##### Ubuntu 11.10

* [xul-ext-ubufox](https://launchpad.net/ubuntu/%2Bsource/ubufox)
  -
  [2.6-0ubuntu0.11.10.1](https://launchpad.net/ubuntu/%2Bsource/ubufox/2.6-0ubuntu0.11.10.1)

##### Ubuntu 10.04

* [xul-ext-ubufox](https://launchpad.net/ubuntu/%2Bsource/ubufox)
  -
  [2.6-0ubuntu0.10.04.1](https://launchpad.net/ubuntu/%2Bsource/ubufox/2.6-0ubuntu0.10.04.1)

After a standard system update you need to restart Firefox to make

all the necessary changes.

## References

* <https://launchpad.net/bugs/1080211>

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugzilla.mozilla.org_a28e0d3b_20250124_141011.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/791601)
* [XML](/show_bug.cgi?ctype=xml&id=791601)

Closed
[Bug 791601](/show_bug.cgi?id=791601)

Opened 12 years ago
Closed 12 years ago

# "Assertion failure: checkmTextrun ? !mTextRun : !Properties().Get(UninflatedTextRunProperty())" with font inflation, -moz-column

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"Assertion failure: checkmTextrun ? !mTextRun : !Properties().Get(UninflatedTextRunProperty())" with font inflation, -moz-column

## Categories

### (Core :: Layout, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout#Layout)

Layout
▾

Core :: Layout

Issues in Layout that do not fit into any other Layout component or which span multiple Layout components.

Bugs related to the top level presentation objects (pres shell, pres context, and document viewer), the frame constructor, and the base frame classes, as well as general issues with alignment and sizing, all belong here.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla18

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | --- | [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |
| firefox-esr17 | --- | [verified](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 |  | affected |
| firefox17 | + | verified |
| firefox18 | + | verified |
| firefox-esr10 |  | unaffected |
| firefox-esr17 |  | verified |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: MatsPalmgren\_bugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=40)  [dholbert](/user_profile?user_id=278074)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### (Depends on 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[885444](/show_bug.cgi?id=885444 "NEW - AJAX call on a Drupal site freezes in non-javascript area, high CPU usage.")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[stirdom](/show_bug.cgi?id=306663 "RESOLVED FIXED - [meta] Bugs found by \"Stir DOM\" module of DOMFuzz"), [randomstyles](/show_bug.cgi?id=306939 "RESOLVED INACTIVE - [meta] Bugs found by Random Styles (adding random style properties to DOM elements)"), [CVE-2012-3964](/show_bug.cgi?id=756241 "VERIFIED FIXED - Heap-use-after-free READ 8 in gfxTextRun::GetUserData")

Dependency [tree](/showdependencytree.cgi?id=791601&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=791601)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [MatsPalmgren\_bugz](/user_profile?user_id=5168) | [in-testsuite](#c22 "12 years ago") | + |
| --- | --- | --- |
| [MatsPalmgren\_bugz](/user_profile?user_id=5168) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [testcase (requires pref) (crashes Firefox)](/attachment.cgi?id=661662)  [12 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   293 bytes, application/xhtml+xml |  | [Details](/attachment.cgi?id=661662&action=edit) |
| --- | --- | --- |
| [stack](/attachment.cgi?id=661664)  [12 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   11.47 KB, text/plain |  | [Details](/attachment.cgi?id=661664&action=edit) |
| [stack + frame tree](/attachment.cgi?id=661859)  [12 years ago](#c2)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   10.16 KB, text/html |  | [Details](/attachment.cgi?id=661859&action=edit) |
| [fix](/attachment.cgi?id=661861)  [12 years ago](#c3)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   2.93 KB, patch | roc : [review+](#c7 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c13 "12 years ago") | [Details](/attachment.cgi?id=661861&action=edit) | [Diff](/attachment.cgi?id=661861&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661861) |
| [fix (wdiff)](/attachment.cgi?id=661862)  [12 years ago](#c4)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   2.08 KB, patch |  | [Details](/attachment.cgi?id=661862&action=edit) | [Diff](/attachment.cgi?id=661862&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661862) |
| [before/after frame trees with the fix](/attachment.cgi?id=661863)  [12 years ago](#c5)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   5.62 KB, text/plain |  | [Details](/attachment.cgi?id=661863&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=791601#c0)• 12 years ago |
|  | |

Attached file
[testcase (requires pref) (crashes Firefox)](attachment.cgi?id=661662)
— [Details](attachment.cgi?id=661662&action=edit)

With:
user\_pref("font.size.inflation.emPerLine", 15);
Loading the testcase triggers:
Assertion failure: checkmTextrun ? !mTextRun : !Properties().Get(UninflatedTextRunProperty()), at /Users/jruderman/trees/mozilla-central/layout/generic/nsTextFrameThebes.cpp:4373
Security-sensitive because the assertion was added in a security-sensitive bug.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=791601#c1)• 12 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=661664)
— [Details](attachment.cgi?id=661664&action=edit)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=791601#c2)• 12 years ago |
|  | |

Attached file
[stack + frame tree](attachment.cgi?id=661859)
— [Details](attachment.cgi?id=661859&action=edit)

RemoveInFlows is trying to destroy the text frame marked red.
<http://hg.mozilla.org/mozilla-central/annotate/3f0587ce1774/layout/generic/nsTextFrameThebes.cpp#l7273>
This is pretty much the same situation as in [bug 756241](/show_bug.cgi?id=756241 "VERIFIED FIXED - Heap-use-after-free READ 8 in gfxTextRun::GetUserData"),
but with a block parent. On line 7300, we explicitly excluded
this case... I don't recall why we did that - maybe we thought
that FRAMES\_ARE\_EMPTY would prevent the same crash in blocks?
roc, do you recall? do you see any reason why doing that block
unconditionally won't work? (it fixes the crash locally)Assignee: nobody → matspal

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=791601#c3)• 12 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=661861&action=diff)
— [Details](attachment.cgi?id=661861&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661861)

[Attachment #661861](/attachment.cgi?id=661861&action=edit "fix") -
Flags: review?(roc)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=791601#c4)• 12 years ago |
|  | |

Attached patch

[fix (wdiff)](attachment.cgi?id=661862&action=diff)
— [Details](attachment.cgi?id=661862&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661862)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=791601#c5)• 12 years ago |
|  | |

Attached file
[before/after frame trees with the fix](attachment.cgi?id=661863)
— [Details](attachment.cgi?id=661863&action=edit)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=791601#a60586_5168)• 12 years ago |

Flags: in-testsuite?Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)OS: Mac OS X → AllHardware: x86\_64 → All

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=791601#c6)• 12 years ago |
|  | |

<https://tbpl.mozilla.org/?tree=Try&rev=9f066ebad681>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=791601#a61531_5168)• 12 years ago |

Blocks: [CVE-2012-3964](/show_bug.cgi?id=756241 "VERIFIED FIXED - Heap-use-after-free READ 8 in gfxTextRun::GetUserData")

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=791601#c7)• 12 years ago |
|  | |

Comment on [attachment 661861](/attachment.cgi?id=661861 "fix") [[details]](/attachment.cgi?id=661861&action=edit "fix") [[diff]](/attachment.cgi?id=661861&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661861)
fix
Review of [attachment 661861](/attachment.cgi?id=661861 "fix") [[details]](/attachment.cgi?id=661861&action=edit "fix") [[diff]](/attachment.cgi?id=661861&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661861):
-----------------------------------------------------------------
I don't know why we excluded the parent block here.
Clearing text runs should be safe in any case.
[Attachment #661861](/attachment.cgi?id=661861&action=edit "fix") -
Flags: review?(roc) → review+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=791601#c8)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/1d8ff0faf0fa>

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=791601#c9)• 12 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/1d8ff0faf0fa>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla18

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=791601#a527656_1689)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)

|  | [Robert Kaiser](/user_profile?user_id=5189) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=791601#c10)• 12 years ago |
|  | |

This is marked sec-critical and tracking-firefox17+, are we planning to land this on beta?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=791601#c11)• 12 years ago |
|  | |

Comment on [attachment 661861](/attachment.cgi?id=661861 "fix") [[details]](/attachment.cgi?id=661861&action=edit "fix") [[diff]](/attachment.cgi?id=661861&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661861)
fix
[Approval Request Comment]
Bug caused by (feature/regressing bug #):
User impact if declined: sec-critical crash
Testing completed (on m-c, etc.): on trunk/aurora since 2012-09-18
Risk to taking this patch (and alternatives if risky): low risk
String or UUID changes made by this patch: none
[Attachment #661861](/attachment.cgi?id=661861&action=edit "fix") -
Flags: approval-mozilla-beta?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=791601#c12)• 12 years ago |
|  | |

Please also mark sec-approval? on this patch since it's sec-critical and looking for uplift we'll want to get that feedback as well to be able to time landing.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=791601#c13)• 12 years ago |
|  | |

Comment on [attachment 661861](/attachment.cgi?id=661861 "fix") [[details]](/attachment.cgi?id=661861&action=edit "fix") [[diff]](/attachment.cgi?id=661861&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=791601&attachment=661861)
fix
Again, my bad, this doesn't need sec-approval please go ahead with uplift.
[Attachment #661861](/attachment.cgi?id=661861&action=edit "fix") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=791601#c14)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/7f450abfd318>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=791601#a3965782_280903)• 12 years ago |

Whiteboard: [adv-track-main17+]

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=791601#a4394033_279076)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=791601#c15)• 12 years ago |
|  | |

Kamil, can you please make an attempt at verifying this is fixed? It should be fixed in Firefox 17, 17esr, and 18beta.

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=791601#c16)• 12 years ago |
|  | |

When going through the following issue using the test case HTML file attached above, I receive the following crash every single time:
###!!! ASSERTION: math on NS\_UNCONSTRAINEDSIZE: 'NS\_UNCONSTRAINEDSIZE != aState.mReflowState.mComputedBorderPadding.left && NS\_UNCONSTRAINEDSIZE != aState.mReflowState.ComputedWidth()', file e:/builds/moz2\_slave/m-rel-w32-dbg/build/layout/generic/nsBlockFrame.cpp, line 1629
The error doesn't match the one that has been posted above, but it's making it difficult to test as firefox crashes whenever the .HTML file is opened. Is this the same issue as above just a different error message? Or is there something I am doing incorrectly?
I also set the following user preference as mentioned above: ("font.size.inflation.emPerLine", 15)
Received the above assertion crash when going through the following builds:
Firefox 16: <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/10/2012-10-11-mozilla-release-debug/>
Firefox 17: <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/11/2012-11-20-mozilla-release-debug/>
Firefox 18: <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012-12-16-mozilla-beta-debug/>

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=791601#c17)• 12 years ago |
|  | |

(In reply to Kamil Jozwiak [:kjozwiak] from [comment #16](/show_bug.cgi?id=791601#c16 "VERIFIED FIXED - \"Assertion failure: checkmTextrun ? !mTextRun : !Properties().Get(UninflatedTextRunProperty())\" with font inflation, -moz-column"))
> ###!!! ASSERTION: math on NS\_UNCONSTRAINEDSIZE
That's a non-fatal assertion, so you shouldn't experience it as a crash. If you're on Windows, you might need to run with XPCOM\_DEBUG\_BREAK=warn.
(I tend to ignore any assertion that mentions NS\_UNCONSTRAINEDSIZE, due to [bug 575011](/show_bug.cgi?id=575011 "NEW - NSCoordSaturating* is unmaintainable and causes lots of assertions").)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=791601#c18)• 12 years ago |
|  | |

Kamil, can you please retest with XPCOM\_DEBUG\_BREAK=warn as Jesse suggests?
Jesse, is this an environment variable that needs to be set or does this need to be set elsewhere?

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=791601#c19)• 12 years ago |
|  | |

Yes, it's an environment variable.
<https://developer.mozilla.org/en-US/docs/XPCOM_DEBUG_BREAK>
<https://developer.mozilla.org/en-US/docs/Debugging_Mozilla_on_Windows_FAQ#Disabling_ASSERTIONS>

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=791601#c20)• 12 years ago |
|  | |

Following prerequisites used before testing builds:
- Environment Variable: XPCOM\_DEBUG\_BREAK=warn
- about:config: ("font.size.inflation.emPerLine", 15)
Firefox 16 (Issue Reproduced): <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/10/2012-10-11-mozilla-release-debug/>
Received Error: Assertion failure: checkmTextrun ? !mTextRun : !Properties().Get(UninflatedTextRunProperty()), at e:/builds/moz2\_slave/m-rel-w32-dbg/build/layout/generic/nsTextFrameThebes.cpp:4248
Once the issue was reproduced several times with Firefox 16, used the following builds to ensure that the issue has been resolved:
Firefox 17 (Resolved): <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/11/2012-11-20-mozilla-release-debug/>
- Ran through Firefox 17 and didn't receive the assertion crash that was reproduced with Firefox 16. Ensured that the above assertion failure didn't appear in the log file
Firefox 17esrpre BETA (Resolved): <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/11/2012-11-20-mozilla-esr17-debug/>
- Ran through Firefox 17esrpre BETA and didn't receive the assertion crash that was reproduced with Firefox 16. Ensured that the above assertion failure didn't appear in the log file
Firefox 18 BETA (Resolved): <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012-12-16-mozilla-beta-debug/>
- Ran through Firefox 18 BETA and didn't receive the assertion crash that was reproduced with Firefox 16. Ensured that the above assertion failure didn't appear in the log file

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=791601#c21)• 12 years ago |
|  | |

Thank you, Kamil. I think this is sufficient to call this verified fixed. Jesse (or anyone else) feel free to revert my flag changes if there's something else we can do.Status: RESOLVED → VERIFIED
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=verified)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=verified)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=verified)Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=791601#a15789665_1689)• 12 years ago |

Group: core-security

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=791601#c22)• 12 years ago |
|  | |

Crash test:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/cfaa2e423b1f>Flags: in-testsuite? → in-testsuite+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=791601#c23)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/cfaa2e423b1f>

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=791601#a24947599_293623)• 12 years ago |

Depends on: [885444](/show_bug.cgi?id=885444 "NEW - AJAX call on a Drupal site freezes in non-javascript area, high CPU usage.")
You need to [log in](/show_bug.cgi?id=791601&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_5cd30248_20250124_141005.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/787089)
* [XML](/show_bug.cgi?ctype=xml&id=787089)

Closed
[Bug 787089](/show_bug.cgi?id=787089)

Opened 12 years ago
Closed 12 years ago

# Crash [@ nsStyleContext::GetRuleNode()] with deleted this

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ nsStyleContext::GetRuleNode()] with deleted this

## Categories

### (Core :: Layout, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout#Layout)

Layout
▾

Core :: Layout

Issues in Layout that do not fit into any other Layout component or which span multiple Layout components.

Bugs related to the top level presentation objects (pres shell, pres context, and document viewer), the frame constructor, and the base frame classes, as well as general issues with alignment and sizing, all belong here.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla18

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-) | [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | - | affected |
| firefox17 | + | fixed |
| firefox18 | + | fixed |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bc, Assigned: roc)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e1cadeaaf04bd425d597a571ffe0f522?d=mm&size=40)  [roc](/user_profile?user_id=5038)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/8679e1c6004dffb8ffd44e6419ac9474?d=mm&size=40)  [jbecerra](/user_profile?user_id=241759)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ee4c7c6351b45c4655e16993a29979b0?d=mm&size=40)  [bc](/user_profile?user_id=23402)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=40)  [dholbert](/user_profile?user_id=278074)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

### ( [URL](http://altfoto.com/2012/08/el-sucio-sucio-secreto-de-las-grandes-marcas-y-sus-sensores-defectuosos "http://altfoto.com/2012/08/el-sucio-sucio-secreto-de-las-grandes-marcas-y-sus-sensores-defectuosos") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[785808](/show_bug.cgi?id=785808 "RESOLVED FIXED - crash in nsRootPresContext::RequestUpdatePluginGeometry")

Dependency [tree](/showdependencytree.cgi?id=787089&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=787089)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[altfoto.com/2012/08/el-sucio-sucio-se...](http://altfoto.com/2012/08/el-sucio-sucio-secreto-de-las-grandes-marcas-y-sus-sensores-defectuosos "http://altfoto.com/2012/08/el-sucio-sucio-secreto-de-las-grandes-marcas-y-sus-sensores-defectuosos")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, reproducible, sec-critical, Whiteboard: [adv-track-main17+][adv-track-esr17-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[reproducible](/buglist.cgi?keywords=reproducible&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+][adv-track-esr17-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c10 "12 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsStyleContext::GetRuleNode() ]](https://crash-stats.mozilla.org/signature/?signature=nsStyleContext%3A%3AGetRuleNode%28%29)

[[@ nsRootPresContext::RequestUpdatePluginGeometry ]](https://crash-stats.mozilla.org/signature/?signature=nsRootPresContext%3A%3ARequestUpdatePluginGeometry)

[[@ mozalloc\_abort(char const\* const) | NS\_DebugBreak\_P | nsIFrame::GetOffsetToCrossDoc(nsIFrame const\*, int) ]](https://crash-stats.mozilla.org/signature/?signature=mozalloc_abort%28char%20const%2A%20const%29%20%7C%20NS_DebugBreak_P%20%7C%20nsIFrame%3A%3AGetOffsetToCrossDoc%28nsIFrame%20const%2A%2C%20int%29)

[[@ mozalloc\_abort(char const\* const) | NS\_DebugBreak\_P | nsXPConnect::GetXPConnect() ]](https://crash-stats.mozilla.org/signature/?signature=mozalloc_abort%28char%20const%2A%20const%29%20%7C%20NS_DebugBreak_P%20%7C%20nsXPConnect%3A%3AGetXPConnect%28%29)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [rip out mUpdatePluginGeometryForFrame optimization](/attachment.cgi?id=657970)  [12 years ago](#c5)  [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)   15.59 KB, patch | MatsPalmgren\_bugz : [review+](#a389025_5168 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#c14 "12 years ago") | [Details](/attachment.cgi?id=657970&action=edit) | [Diff](/attachment.cgi?id=657970&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=787089&attachment=657970) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=787089#c0)• 12 years ago |
|  | |

1. <http://altfoto.com/2012/08/el-sucio-sucio-secreto-de-las-grandes-marcas-y-sus-sensores-defectuosos>
2. Crash nsStyleContext::GetRuleNode() nsIFrame::PresContext() nsRootPresContext::RequestUpdatePluginGeometry(nsIFrame\*) PresShell::DoReflow(nsIFrame\*, bool) PresShell::ProcessReflowCommands(bool)
Nightly Linux 32bit and Windows 7 64bit
See [bug 781279 comment 15](/show_bug.cgi?id=781279#c15 "RESOLVED FIXED - crash in nsRootPresContext::UpdatePluginGeometry")
crash address in Windows when you don't get a Flash related crash is 0xffffffffddddddf9 while in Linux it is 0xdadadaf6
On Linux I see nsStyleContext::GetRuleNode (this=0xdadadada) at ../../dist/include/nsStyleContext.h:190
[bp-e7968d4a-42bb-4df7-98ef-920df2120830](https://crash-stats.mozilla.org/report/index/e7968d4a-42bb-4df7-98ef-920df2120830)
Not very reproducible in opt build but pretty much so in debug.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=787089#c1)• 12 years ago |
|  | |

This looks like a crash in nsRootPresContext::RequestUpdatePluginGeometry
doing mUpdatePluginGeometryForFrame->PresContext() on a deleted frame.
If so, I think it's mitigated by frame-poisoning.
It could be the same underlying problem as top-crash [bug 785808](/show_bug.cgi?id=785808 "RESOLVED FIXED - crash in nsRootPresContext::RequestUpdatePluginGeometry").Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) → [crash](/buglist.cgi?keywords=crash&resolution=---),
[sec-other](/buglist.cgi?keywords=sec-other&resolution=---)Whiteboard: [mitigated by frame-poisoning]

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=787089#c2)• 12 years ago |
|  | |

On 32-bit Nightly: [bp-69bfff59-550b-46bc-82d6-0cae32120902](https://crash-stats.mozilla.org/report/index/69bfff59-550b-46bc-82d6-0cae32120902).
On 64-bit Nightly: [bp-0200cf0c-f76c-4e8f-b271-0e4d82120902](https://crash-stats.mozilla.org/report/index/0200cf0c-f76c-4e8f-b271-0e4d82120902).Blocks: [785808](/show_bug.cgi?id=785808 "RESOLVED FIXED - crash in nsRootPresContext::RequestUpdatePluginGeometry")Crash Signature: [@ nsStyleContext::GetRuleNode()]
[@ nsRootPresContext::RequestUpdatePluginGeometry] → [@ nsStyleContext::GetRuleNode()]
[@ nsRootPresContext::RequestUpdatePluginGeometry]
[@ mozalloc\_abort(char const\* const) | NS\_DebugBreak\_P | nsIFrame::GetOffsetToCrossDoc(nsIFrame const\* int)]
[@ mozalloc\_abort(char const\* const) | NS\_DebugBreak\_P | n…Keywords: [reproducible](/buglist.cgi?keywords=reproducible&resolution=---)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=787089#c3)• 12 years ago |
|  | |

I cannot reproduce this.

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=787089#c4)• 12 years ago |
|  | |

Nor I, on Linux x64 or Windows 7 x64, and not on WinXP in VirtualBox.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=787089#c5)• 12 years ago |
|  | |

Attached patch

[rip out mUpdatePluginGeometryForFrame optimization](attachment.cgi?id=657970&action=diff)
— [Details](attachment.cgi?id=657970&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=787089&attachment=657970)

I don't think this is worth having.Assignee: nobody → roc
[Attachment #657970](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") -
Flags: review?(matspal)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=787089#c6)• 12 years ago |
|  | |

bclary, if you can reproduce this, it would be helpful if you can determine whether the above patch fixes it. Thanks!

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=787089#c7)• 12 years ago |
|  | |

I can't reproduce in a debug or asan build. After a lot a stress testing --
opening the URL in 30 or so tabs, reload-all-tabs, closing/reloading tabs,
all while resizing the window, I finally got one crash in a Nightly Linux64:
[bp-e2ef7c12-29f6-44da-b6d9-e9d952120904](https://crash-stats.mozilla.org/report/index/e2ef7c12-29f6-44da-b6d9-e9d952120904)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=787089#a389025_5168)• 12 years ago |

[Attachment #657970](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") -
Flags: review?(matspal) → review+

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=787089#c8)• 12 years ago |
|  | |

(In reply to Robert O'Callahan (:roc) (Mozilla Corporation) from [comment #6](/show_bug.cgi?id=787089#c6 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> bclary, if you can reproduce this, it would be helpful if you can determine
> whether the above patch fixes it. Thanks!
I applied it to Linux Nightly and was no longer able to reproduce it there on any of the 182 urls where was originally detected. The unpatched Windows 7 builds on Nightly and Aurora and the unpatched builds on Linux Aurora were able to reproduce the original crash on a few of the urls. This crash has a very low reproducibility rate, but given the data I have I agree this patch fixes the issue at hand.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=787089#c9)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/df1a1a1cfaf4>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=787089#c10)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/df1a1a1cfaf4>Status: NEW → RESOLVEDClosed: 12 years agoFlags: in-testsuite?Resolution: --- → FIXEDTarget Milestone: --- → mozilla18

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=787089#c11)• 12 years ago |
|  | |

(In reply to Mats Palmgren [:mats] from [comment #1](/show_bug.cgi?id=787089#c1 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> If so, I think it's mitigated by frame-poisoning.
The addresses in [comment 0](/show_bug.cgi?id=787089#c0 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this") don't look very mitigated, those are deleted memory pointers. Frame-poisoned addresses are in a different range. changing to sec-critical unless I'm missing something.
If it is sec-critical we should fix on older branches, especially if live web-content is triggering this crash which might increase the odds of discovery.
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=affected)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
--- → [16+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=16%2B)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)Keywords: [sec-other](/buglist.cgi?keywords=sec-other&resolution=---) → [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)Whiteboard: [mitigated by frame-poisoning]

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=787089#c12)• 12 years ago |
|  | |

I think most of these crashes are regression from [bug 775965](/show_bug.cgi?id=775965 "RESOLVED FIXED - <iframe>s sometimes not painted after entering fullscreen in B2G"), which is only in FF17 and up. So I'll go for Aurora but not other branches at this time.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=787089#c13)• 12 years ago |
|  | |

Comment on [attachment 657970](/attachment.cgi?id=657970 "rip out mUpdatePluginGeometryForFrame optimization") [[details]](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") [[diff]](/attachment.cgi?id=657970&action=diff "rip out mUpdatePluginGeometryForFrame optimization") [[review]](/page.cgi?id=splinter.html&ignore=&bug=787089&attachment=657970)
rip out mUpdatePluginGeometryForFrame optimization
Review of [attachment 657970](/attachment.cgi?id=657970 "rip out mUpdatePluginGeometryForFrame optimization") [[details]](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") [[diff]](/attachment.cgi?id=657970&action=diff "rip out mUpdatePluginGeometryForFrame optimization") [[review]](/page.cgi?id=splinter.html&ignore=&bug=787089&attachment=657970):
-----------------------------------------------------------------
Removes fragile optimization, so should be safe.
[Attachment #657970](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=787089#c14)• 12 years ago |
|  | |

Comment on [attachment 657970](/attachment.cgi?id=657970 "rip out mUpdatePluginGeometryForFrame optimization") [[details]](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") [[diff]](/attachment.cgi?id=657970&action=diff "rip out mUpdatePluginGeometryForFrame optimization") [[review]](/page.cgi?id=splinter.html&ignore=&bug=787089&attachment=657970)
rip out mUpdatePluginGeometryForFrame optimization
Approving for Aurora - does this mean that we should untrack/mark unaffected for 16?
[Attachment #657970](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=787089#c15)• 12 years ago |
|  | |

(In reply to Lukas Blakk [:lsblakk] from [comment #14](/show_bug.cgi?id=787089#c14 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> Approving for Aurora - does this mean that we should untrack/mark unaffected
> for 16?
Probably, but you might want to confirm my guess that this bug doesn't happen (or happens at much lower rate) on 16.

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=787089#c16)• 12 years ago |
|  | |

(In reply to Robert O'Callahan (:roc) (Mozilla Corporation) from [comment #15](/show_bug.cgi?id=787089#c15 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> Probably, but you might want to confirm my guess that this bug doesn't
> happen (or happens at much lower rate) on 16.
This crash signature is #13 top browser crasher in 16.0b2 (partially tracked by [bug 754380](/show_bug.cgi?id=754380 "RESOLVED WORKSFORME - crash in PresShell::FlushPendingNotifications @ nsRootPresContext::UpdatePluginGeometry")) but I don't know if it's related to this bug.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=787089#c17)• 12 years ago |
|  | |

(In reply to Robert O'Callahan (:roc) (Mozilla Corporation) from [comment #13](/show_bug.cgi?id=787089#c13 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> Comment on [attachment 657970](/attachment.cgi?id=657970 "rip out mUpdatePluginGeometryForFrame optimization") [[details]](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") [[diff]](/attachment.cgi?id=657970&action=diff "rip out mUpdatePluginGeometryForFrame optimization") [[review]](/page.cgi?id=splinter.html&ignore=&bug=787089&attachment=657970)
> rip out mUpdatePluginGeometryForFrame optimization
>
> Review of [attachment 657970](/attachment.cgi?id=657970 "rip out mUpdatePluginGeometryForFrame optimization") [[details]](/attachment.cgi?id=657970&action=edit "rip out mUpdatePluginGeometryForFrame optimization") [[diff]](/attachment.cgi?id=657970&action=diff "rip out mUpdatePluginGeometryForFrame optimization") [[review]](/page.cgi?id=splinter.html&ignore=&bug=787089&attachment=657970):
> -----------------------------------------------------------------
>
> Removes fragile optimization, so should be safe.
Do we know what the regressing bug was here?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=787089#c18)• 12 years ago |
|  | |

I see [comment 12](/show_bug.cgi?id=787089#c12 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this") now. Sounds like this wouldn't help [bug 754380](/show_bug.cgi?id=754380 "RESOLVED WORKSFORME - crash in PresShell::FlushPendingNotifications @ nsRootPresContext::UpdatePluginGeometry") in that case, unless we find other related regressing bugs.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=787089#c19)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/2ac849fcd6b2>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=787089#a1234708_425645)• 12 years ago |

[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[16+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=16%2B) → [17+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=17%2B)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=787089#a1734011_279076)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=787089#c20)• 12 years ago |
|  | |

(In reply to Scoobidiver from [comment #16](/show_bug.cgi?id=787089#c16 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> (In reply to Robert O'Callahan (:roc) (Mozilla Corporation) from [comment #15](/show_bug.cgi?id=787089#c15 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> > Probably, but you might want to confirm my guess that this bug doesn't
> > happen (or happens at much lower rate) on 16.
> This crash signature is #13 top browser crasher in 16.0b2 (partially tracked
> by [bug 754380](/show_bug.cgi?id=754380 "RESOLVED WORKSFORME - crash in PresShell::FlushPendingNotifications @ nsRootPresContext::UpdatePluginGeometry")) but I don't know if it's related to this bug.
I'm not seeing the crash signatures here, or the one listed in [bug 754380](/show_bug.cgi?id=754380 "RESOLVED WORKSFORME - crash in PresShell::FlushPendingNotifications @ nsRootPresContext::UpdatePluginGeometry"), at high volume in b3. I don't believe we need to track for that version any longer. Please renominate if you disagree.
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-)QA Contact: jbecerra

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=787089#c21)• 12 years ago |
|  | |

Please prepare a patch for the mozilla-esr10 branch the next opportunity you get. Thanks!

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=787089#c22)• 12 years ago |
|  | |

Any update on an ESR patch for this? It has been weeks and this is a sec-critical.

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=787089#c23)• 12 years ago |
|  | |

Sorry, I lost track of the request in [comment #21](/show_bug.cgi?id=787089#c21 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this") for some reason.
I don't think this needs to be fixed on esr10 because the crashes were primarily caused by [bug 775965](/show_bug.cgi?id=775965 "RESOLVED FIXED - <iframe>s sometimes not painted after entering fullscreen in B2G") which never landed on esr10.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=787089#c24)• 12 years ago |
|  | |

(In reply to Robert O'Callahan (:roc) (Mozilla Corporation) from [comment #23](/show_bug.cgi?id=787089#c23 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this"))
> Sorry, I lost track of the request in [comment #21](/show_bug.cgi?id=787089#c21 "RESOLVED FIXED - Crash [@ nsStyleContext::GetRuleNode()] with deleted this") for some reason.
>
> I don't think this needs to be fixed on esr10 because the crashes were
> primarily caused by [bug 775965](/show_bug.cgi?id=775965 "RESOLVED FIXED - <iframe>s sometimes not painted after entering fullscreen in B2G") which never landed on esr10.
Thanks roc, marking as unaffected on ESR10 given that.
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=787089#a6586633_280903)• 12 years ago |

Whiteboard: [adv-track-main17+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=787089#a6587774_280903)• 12 years ago |

[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[17+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=17%2B) → ---Whiteboard: [adv-track-main17+] → [adv-track-main17+][adv-track-esr17-]

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=787089#a6967919_11608)• 12 years ago |

Summary: Crash [@ nsStyleContext::GetRuleNode()} with deleted this → Crash [@ nsStyleContext::GetRuleNode()] with deleted this

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=787089#a17295970_1689)• 12 years ago |

Group: core-security

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=787089#c25)• 11 years ago |
|  | |

mass remove verifyme requests greater than 4 months oldKeywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)
You need to [log in](/show_bug.cgi?id=787089&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_58b3f64e_20250124_141004.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/784404)
* [XML](/show_bug.cgi?ctype=xml&id=784404)

Closed
[Bug 784404](/show_bug.cgi?id=784404)

Opened 12 years ago
Closed 12 years ago

# Intermittent assertion in dom/devicestorage/test/test\_basic.html ("Assertion failure: i < Length() (invalid array index), at e:\builds\moz2\_slave\m-in-w32-dbg\build\obj-firefox\dist\include\nsTArray.h:526")

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Intermittent assertion in dom/devicestorage/test/test\_basic.html ("Assertion failure: i < Length() (invalid array index), at e:\builds\moz2\_slave\m-in-w32-dbg\build\obj-firefox\dist\include\nsTArray.h:526")

## Categories

### (Core :: DOM: Device Interfaces, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Device%20Interfaces#DOM%3A%20Device%20Interfaces)

DOM: Device Interfaces
▾

Core :: DOM: Device Interfaces
This component covers APIs exposing device interfaces for communication, networking, multimedia, etc.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Device%20Interfaces&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Device%20Interfaces&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Device%20Interfaces)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Windows 7

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla18

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 |  | fixed |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: emorley, Assigned: dougt)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c4f245bb4b1441900aba849213666b04?d=mm&size=40)  [dougt](/user_profile?user_id=302291)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/faa32581e9f2c69c1870a41227fd7990?d=mm&size=40)  [emorley](/user_profile?user_id=373476)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/449d5e4f615206171e7b9a8e77399571?d=mm&size=40)  [cmartin](/user_profile?user_id=625428)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[438871](/show_bug.cgi?id=438871 "RESOLVED INCOMPLETE - ***Do not use any more** some tests fail intermittently")

Dependency [tree](/showdependencytree.cgi?id=784404&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=784404)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, intermittent-failure, Whiteboard: [adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[intermittent-failure](/buglist.cgi?keywords=intermittent-failure&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c16 "12 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ mozilla::dom::devicestorage::DeviceStorageRequestParent::ActorDestroy(mozilla::ipc::IProtocolManager<mozilla::ipc::RPCChannel::RPCListener>::ActorDestroyReason) ]](https://crash-stats.mozilla.org/signature/?signature=mozilla%3A%3Adom%3A%3Adevicestorage%3A%3ADeviceStorageRequestParent%3A%3AActorDestroy%28mozilla%3A%3Aipc%3A%3AIProtocolManager%3Cmozilla%3A%3Aipc%3A%3ARPCChannel%3A%3ARPCListener%3E%3A%3AActorDestroyReason%29)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 4 obsolete files)

| [patch v.1](/attachment.cgi?id=653970)  [12 years ago](#c2)  [Doug Turner (:dougt)](/user_profile?user_id=302291)   2.23 KB, patch | dougt : [review-](#a16166_302291 "12 years ago") | [Details](/attachment.cgi?id=653970&action=edit) | [Diff](/attachment.cgi?id=653970&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=653970) |
| --- | --- | --- |
| [patch v.1](/attachment.cgi?id=653971)  [12 years ago](#c3)  [Doug Turner (:dougt)](/user_profile?user_id=302291)   2.27 KB, patch | dougt : [review-](#c11 "12 years ago") | [Details](/attachment.cgi?id=653971&action=edit) | [Diff](/attachment.cgi?id=653971&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=653971) |
| [patch v.1 - without damn locks](/attachment.cgi?id=654452)  [12 years ago](#c5)  [Doug Turner (:dougt)](/user_profile?user_id=302291)   1.65 KB, patch | bent.mozilla : [review+](#c8 "12 years ago") | [Details](/attachment.cgi?id=654452&action=edit) | [Diff](/attachment.cgi?id=654452&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=654452) |
| [patch v.2](/attachment.cgi?id=655693)  [12 years ago](#c13)  [Doug Turner (:dougt)](/user_profile?user_id=302291)   2.86 KB, patch |  | [Details](/attachment.cgi?id=655693&action=edit) | [Diff](/attachment.cgi?id=655693&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=655693) |
| [patch v.2](/attachment.cgi?id=655751)  [12 years ago](#c14)  [Doug Turner (:dougt)](/user_profile?user_id=302291)   2.89 KB, patch | bent.mozilla : [review+](#a597447_200444 "12 years ago") | [Details](/attachment.cgi?id=655751&action=edit) | [Diff](/attachment.cgi?id=655751&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=655751) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=784404#c0)• 12 years ago |
|  | |

A few of the other instances of this assertion have been marked as s-s, so doing so for this just in case.
Rev3 WINNT 6.1 mozilla-inbound debug test mochitests-2/5 on 2012-08-21 05:53:12 PDT for push 94f6e5a00d8b
slave: talos-r3-w7-068
<https://tbpl.mozilla.org/php/getParsedLog.php?id=14560638&tree=Mozilla-Inbound>
{
1 INFO TEST-START | /tests/dom/devicestorage/test/test\_basic.html
1889 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | Got second iframe load event.
++DOMWINDOW == 9 (0847EC48) [serial = 9] [outer = 08588378]
[Child 2600] WARNING: NS\_ENSURE\_TRUE(IsChromeProcess()) failed: file e:/builds/moz2\_slave/m-in-w32-dbg/build/content/base/src/nsFrameMessageManager.cpp, line 601
++DOMWINDOW == 10 (085C04E0) [serial = 10] [outer = 08588378]
1890 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | Should have getDeviceStorage
1891 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | Should have gotten a storage
1892 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | Should have a non-null request
1893 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | File name should match
1894 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | addSuccess was called
1895 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | Should have getDeviceStorage
1896 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | File name should match
1897 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | wrong arraybuffer byteLength - 69 should equal 69
1898 INFO TEST-PASS | /tests/dom/devicestorage/ipc/test\_ipc.html | /tests/dom/devicestorage/test/test\_basic.html | wrong values - My name is Doug Turner. My IRC nick is DougT. I like Maple cookies. should equal My name is Doug Turner. My IRC nick is DougT. I like Maple cookies.
Assertion failure: i < Length() (invalid array index), at e:\builds\moz2\_slave\m-in-w32-dbg\build\obj-firefox\dist\include\nsTArray.h:526
devicestorage/hi
[Child 2600] WARNING: shutting down early because of crash!: file e:/builds/moz2\_slave/m-in-w32-dbg/build/dom/ipc/ContentChild.cpp, line 701
[Child 2600] WARNING: content process \_exit()ing: file e:/builds/moz2\_slave/m-in-w32-dbg/build/dom/ipc/ContentChild.cpp, line 746
nsStringStats
=> mAllocCount: 8042
=> mReallocCount: 587
=> mFreeCount: 3728 -- LEAKED 4314 !!!
=> mShareCount: 16580
=> mAdoptCount: 933
=> mAdoptFreeCount: 931 -- LEAKED 2 !!!
TEST-UNEXPECTED-FAIL | /tests/dom/devicestorage/test/test\_basic.html | Exited with code -2147483645 during test run
INFO | automation.py | Application ran for: 0:04:34.412000
INFO | automation.py | Reading PID log: c:\users\cltbld\appdata\local\temp\tmpuclywqpidlog
==> process 3472 launched child process 2600
INFO | automation.py | Checking for orphan process with PID: 2600
Downloading symbols from: <http://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-inbound-win32-debug/1345545301/firefox-17.0a1.en-US.win32.crashreporter-symbols.zip>
PROCESS-CRASH | /tests/dom/devicestorage/test/test\_basic.html | application crashed (minidump found)
Crash dump filename: c:\users\cltbld\appdata\local\temp\tmpinfdxz\minidumps\504e12ce-a5a6-48c1-91e6-06f09751a7d2.dmp
Operating system: Windows NT
6.1.7600
CPU: x86
GenuineIntel family 6 model 23 stepping 10
2 CPUs
Crash reason: EXCEPTION\_BREAKPOINT
Crash address: 0x6ba98aee
Thread 0 (crashed)
0 xul.dll!nsTArray<nsRefPtr<mozilla::dom::devicestorage::DeviceStorageRequestParent::CancelableRunnable>,nsTArrayDefaultAllocator>::ElementAt(unsigned int) [nsTArray.h:94f6e5a00d8b : 526 + 0x21]
eip = 0x6ba98aee esp = 0x0024d50c ebp = 0x0024d514 ebx = 0x00000001
esi = 0x13127704 edi = 0x00000001 eax = 0x00000000 ecx = 0x631477d2
edx = 0x72a5e4d8 efl = 0x00000206
Found by: given as instruction pointer in context
1 xul.dll!mozilla::dom::devicestorage::DeviceStorageRequestParent::ActorDestroy(mozilla::ipc::IProtocolManager<mozilla::ipc::RPCChannel::RPCListener>::ActorDestroyReason) [DeviceStorageRequestParent.cpp:94f6e5a00d8b : 132 + 0x7]
eip = 0x6ba9918e esp = 0x0024d51c ebp = 0x0024d538
Found by: call frame info
2 xul.dll!mozilla::dom::devicestorage::PDeviceStorageRequestParent::DestroySubtree(mozilla::ipc::IProtocolManager<mozilla::ipc::RPCChannel::RPCListener>::ActorDestroyReason) [PDeviceStorageRequestParent.cpp:94f6e5a00d8b : 332 + 0x10]
eip = 0x6c2c8128 esp = 0x0024d530 ebp = 0x0024d538
Found by: stack scanning
3 xul.dll!mozilla::dom::devicestorage::PDeviceStorageRequestParent::Send\_\_delete\_\_(mozilla::dom::devicestorage::PDeviceStorageRequestParent \*,mozilla::dom::devicestorage::DeviceStorageResponseValue const &) [PDeviceStorageRequestParent.cpp:94f6e5a00d8b : 96 + 0xa]
eip = 0x6c2c8dd6 esp = 0x0024d540 ebp = 0x0024d574
Found by: call frame info
4 xul.dll!mozilla::dom::devicestorage::DeviceStorageRequestParent::PostPathResultEvent::CancelableRun() [DeviceStorageRequestParent.cpp:94f6e5a00d8b : 434 + 0x1f]
eip = 0x6ba98eee esp = 0x0024d57c ebp = 0x0024d5b4
Found by: call frame info
5 xul.dll!mozilla::dom::devicestorage::DeviceStorageRequestParent::CancelableRunnable::Run() [DeviceStorageRequestParent.h:94f6e5a00d8b : 51 + 0x6]
eip = 0x6ba9a88d esp = 0x0024d5bc ebp = 0x0024d5c4
Found by: call frame info
6 xul.dll!nsThread::ProcessNextEvent(bool,bool \*) [nsThread.cpp:94f6e5a00d8b : 624 + 0xd]
eip = 0x6c491e70 esp = 0x0024d5cc ebp = 0x0024d5f4
Found by: call frame info
7 xul.dll!NS\_ProcessNextEvent\_P(nsIThread \*,bool) [nsThreadUtils.cpp:94f6e5a00d8b : 220 + 0xc]
eip = 0x6c4434f7 esp = 0x0024d5fc ebp = 0x0024d608
Found by: call frame info
8 xul.dll!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate \*) [MessagePump.cpp:94f6e5a00d8b : 116 + 0x9]
eip = 0x6c2ba253 esp = 0x0024d610 ebp = 0x0024d634
}

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a144_302291)• 12 years ago |

Assignee: nobody → doug.turner

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=784404#c1)• 12 years ago |
|  | |

The CancelableRunnable objects access mRunnables from multiple threads. One CancelableRunnable event on the non-mail thread enumerating, the other is on an IO thread calling RemoveElements(). Yeah.

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=784404#c2)• 12 years ago |
|  | |

Attached patch

[patch v.1](attachment.cgi?id=653970&action=diff) (obsolete)
— [Details](attachment.cgi?id=653970&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=653970)

[Attachment #653970](/attachment.cgi?id=653970&action=edit "patch v.1") -
Flags: review?(bent.mozilla)

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a16166_302291)• 12 years ago |

[Attachment #653970](/attachment.cgi?id=653970&action=edit "patch v.1") -
Flags: review?(bent.mozilla) → review-

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=784404#c3)• 12 years ago |
|  | |

Attached patch

[patch v.1](attachment.cgi?id=653971&action=diff) (obsolete)
— [Details](attachment.cgi?id=653971&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=653971)

[Attachment #653970](/attachment.cgi?id=653970&action=edit "patch v.1") -
Attachment is obsolete: true
[Attachment #653971](/attachment.cgi?id=653971&action=edit "patch v.1") -
Flags: review?(bent.mozilla)

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=784404#c4)• 12 years ago |
|  | |

Can't we do the remove from the array when you run the main thread success/failed response? Then you wouldn't need the lock at all.

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=784404#c5)• 12 years ago |
|  | |

Attached patch

[patch v.1 - without damn locks](attachment.cgi?id=654452&action=diff) (obsolete)
— [Details](attachment.cgi?id=654452&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=654452)

[Attachment #653971](/attachment.cgi?id=653971&action=edit "patch v.1") -
Attachment is obsolete: true
[Attachment #653971](/attachment.cgi?id=653971&action=edit "patch v.1") -
Flags: review?(bent.mozilla)
[Attachment #654452](/attachment.cgi?id=654452&action=edit "patch v.1 - without damn locks") -
Flags: review?(bent.mozilla)

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=784404#c6)• 12 years ago |
|  | |

Comment on [attachment 654452](/attachment.cgi?id=654452 "patch v.1 - without damn locks") [[details]](/attachment.cgi?id=654452&action=edit "patch v.1 - without damn locks") [[diff]](/attachment.cgi?id=654452&action=diff "patch v.1 - without damn locks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=654452)
patch v.1 - without damn locks
Review of [attachment 654452](/attachment.cgi?id=654452 "patch v.1 - without damn locks") [[details]](/attachment.cgi?id=654452&action=edit "patch v.1 - without damn locks") [[diff]](/attachment.cgi?id=654452&action=diff "patch v.1 - without damn locks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=654452):
-----------------------------------------------------------------
::: dom/devicestorage/DeviceStorageRequestParent.h
@@ +50,5 @@
> if (!mCanceled) {
> rv = CancelableRun();
> +
> + nsCOMPtr<nsIRunnable> event = NS\_NewRunnableMethod(this, &CancelableRunnable::RemoveRunnable);
> + NS\_DispatchToMainThread(event);
You need to always do this, right? Even if you've been canceled. (Cancel doesn't currently remove from the array).

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=784404#c7)• 12 years ago |
|  | |

I don't see a reason to fire this event if we have already cancelled. We can just leave those in mRunnables and have them cleaned up when the parent goes away.

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=784404#c8)• 12 years ago |
|  | |

Comment on [attachment 654452](/attachment.cgi?id=654452 "patch v.1 - without damn locks") [[details]](/attachment.cgi?id=654452&action=edit "patch v.1 - without damn locks") [[diff]](/attachment.cgi?id=654452&action=diff "patch v.1 - without damn locks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=654452)
patch v.1 - without damn locks
Review of [attachment 654452](/attachment.cgi?id=654452 "patch v.1 - without damn locks") [[details]](/attachment.cgi?id=654452&action=edit "patch v.1 - without damn locks") [[diff]](/attachment.cgi?id=654452&action=diff "patch v.1 - without damn locks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=654452):
-----------------------------------------------------------------
Actually, if mCanceled is true you can't use mParent anyway (You'd crash). Sorry about that.
[Attachment #654452](/attachment.cgi?id=654452&action=edit "patch v.1 - without damn locks") -
Flags: review?(bent.mozilla) → review+

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=784404#c9)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/a5ffaa0753dd>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=784404#c10)• 12 years ago |
|  | |

Comment on [attachment 653971](/attachment.cgi?id=653971 "patch v.1") [[details]](/attachment.cgi?id=653971&action=edit "patch v.1") [[diff]](/attachment.cgi?id=653971&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=653971)
patch v.1
locks are better:
[Parent 24662] ###!!! ASSERTION: Wrong thread!: 'NS\_IsMainThread()', file /builds/mozilla-central/dom/devicestorage/DeviceStorageRequestParent.h, line 193
mozilla::dom::devicestorage::DeviceStorageRequestParent::AddRunnable(mozilla::dom::devicestorage::DeviceStorageRequestParent::CancelableRunnable\*) (/builds/mozilla-central/dom/devicestorage/DeviceStorageRequestParent.h:194)
CancelableRunnable (/builds/mozilla-central/dom/devicestorage/DeviceStorageRequestParent.h:43)
PostPathResultEvent (/builds/mozilla-central/dom/devicestorage/DeviceStorageRequestParent.cpp:418)
mozilla::dom::devicestorage::DeviceStorageRequestParent::WriteFileEvent::CancelableRun() (/builds/mozilla-central/dom/devicestorage/DeviceStorageRequestParent.cpp:253)
mozilla::dom::devicestorage::DeviceStorageRequestParent::CancelableRunnable::Run() (/builds/mozilla-central/dom/devicestorage/DeviceStorageRequestParent.h:51)
nsThreadPool::Run() (/builds/mozilla-central/xpcom/threads/nsThreadPool.cpp:188)
nsThread::ProcessNextEvent(bool, bool\*) (/builds/mozilla-central/xpcom/threads/nsThread.cpp:624)
NS\_ProcessNextEvent\_P(nsIThread\*, bool) (/builds/mozilla-central/objdir-ff-dbg/xpcom/build/nsThreadUtils.cpp:220)
nsThread::ThreadFunc(void\*) (/builds/mozilla-central/xpcom/threads/nsThread.cpp:256)
\_pt\_root (/builds/mozilla-central/nsprpub/pr/src/pthreads/ptthread.c:159)
start\_thread (/build/buildd/eglibc-2.15/nptl/pthread\_create.c:308)
clone (/build/buildd/eglibc-2.15/misc/../sysdeps/unix/sysv/linux/x86\_64/clone.S:114)
Lets back out that other patch and use this.
[Attachment #653971](/attachment.cgi?id=653971&action=edit "patch v.1") -
Flags: review?(bent.mozilla)

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a514446_302291)• 12 years ago |

Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a514842_302291)• 12 years ago |

[Attachment #653971](/attachment.cgi?id=653971&action=edit "patch v.1") -
Attachment is obsolete: false

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=784404#c11)• 12 years ago |
|  | |

Comment on [attachment 653971](/attachment.cgi?id=653971 "patch v.1") [[details]](/attachment.cgi?id=653971&action=edit "patch v.1") [[diff]](/attachment.cgi?id=653971&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=653971)
patch v.1
as bent pointed out, the parent could die and mMutex wouldn't be valid.
[Attachment #653971](/attachment.cgi?id=653971&action=edit "patch v.1") -
Flags: review?(bent.mozilla) → review-

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=784404#c12)• 12 years ago |
|  | |

more clarification - i can use a lock without any issue because the parent is refcounted. The problem bent pointed out was that there is a race on created response runnables.
10:48 <bent> you're on the main thread
10:48 <bent> you dispatch a runnable to io thread
10:48 <bent> your runnable starts to run on the io thread
10:48 <bent> checks mCanceled
10:48 <bent> it's false
10:48 <bent> so it does the real Run
10:48 <bent> does something
10:49 <bent> then the child crashes
10:49 <bent> now it's time to dispatch the response runnable
10:49 <bent> you lock, see that the actor has died, and can't add the runnable to the array
10:49 <bent> so you don't dispatch

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=784404#c13)• 12 years ago |
|  | |

Attached patch

[patch v.2](attachment.cgi?id=655693&action=diff) (obsolete)
— [Details](attachment.cgi?id=655693&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=655693)

[Attachment #653971](/attachment.cgi?id=653971&action=edit "patch v.1") -
Attachment is obsolete: true
[Attachment #654452](/attachment.cgi?id=654452&action=edit "patch v.1 - without damn locks") -
Attachment is obsolete: true
[Attachment #655693](/attachment.cgi?id=655693&action=edit "patch v.2") -
Flags: review?(bent.mozilla)

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a524535_302291)• 12 years ago |

[Attachment #655693](/attachment.cgi?id=655693&action=edit "patch v.2") -
Attachment is obsolete: true
[Attachment #655693](/attachment.cgi?id=655693&action=edit "patch v.2") -
Flags: review?(bent.mozilla)

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=784404#c14)• 12 years ago |
|  | |

Attached patch

[patch v.2](attachment.cgi?id=655751&action=diff)
— [Details](attachment.cgi?id=655751&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=784404&attachment=655751)

[Attachment #655751](/attachment.cgi?id=655751&action=edit "patch v.2") -
Flags: review?(bent.mozilla)

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a597447_200444)• 12 years ago |

[Attachment #655751](/attachment.cgi?id=655751&action=edit "patch v.2") -
Flags: review?(bent.mozilla) → review+

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=784404#c15)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/f50483a61327>
<https://hg.mozilla.org/integration/mozilla-inbound/rev/14968df0feee>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=784404#c16)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/14968df0feee>
<https://hg.mozilla.org/mozilla-central/rev/f50483a61327>Status: REOPENED → RESOLVEDClosed: 12 years ago → 12 years agoFlags: in-testsuite+Resolution: --- → FIXEDTarget Milestone: --- → mozilla18

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a799926_272375)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=784404#c17)• 12 years ago |
|  | |

Was Firefox 16 affected by this?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a6242789_280903)• 12 years ago |

Whiteboard: [orange] → [adv-track-main17+][orange]

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a7794833_1)• 12 years ago |

Keywords: [intermittent-failure](/buglist.cgi?keywords=intermittent-failure&resolution=---)

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a8330662_1)• 12 years ago |

Whiteboard: [adv-track-main17+][orange] → [adv-track-main17+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=784404#a18067168_1689)• 12 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=784404&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Doug Turner (:dougt)](/user_profile?user_id=302291)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_ac8e3c3c_20250124_141007.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/788822)
* [XML](/show_bug.cgi?ctype=xml&id=788822)

Closed
[Bug 788822](/show_bug.cgi?id=788822)

Opened 12 years ago
Closed 12 years ago

# Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla19

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=unaffected) |
| firefox16 | --- | [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) |
| firefox19 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox15 |  | unaffected |
| firefox16 |  | affected |
| firefox17 | + | fixed |
| firefox18 | + | fixed |
| firefox19 |  | fixed |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: bhackett1024)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/764aa0af2fda6f02fb17dc9771bb18d9?d=mm&size=40)  [bhackett1024](/user_profile?user_id=346231)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[IonFuzz](/show_bug.cgi?id=724444 "RESOLVED FIXED - [meta] IonMonkey fuzz bugs"), [778724](/show_bug.cgi?id=778724 "RESOLVED FIXED - Allow purging analysis-temporary while retaining jitcode")

Dependency [tree](/showdependencytree.cgi?id=788822&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=788822)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[792183](/show_bug.cgi?id=792183 "RESOLVED DUPLICATE - Assertion failure: [infer failure] Missing type pushed 0: <0xf6c09040>, at jsinfer.cpp:328")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [ion:p1:fx19] [jsbugmon:origRev=fdfaef738a00][adv-track-main17+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[ion:p1:fx19] [jsbugmon:origRev=fdfaef738a00][adv-track-main17+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c17 "12 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [patch](/attachment.cgi?id=674087)  [12 years ago](#c11)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   7.59 KB, patch | jandem : [review+](#c12 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a4670516_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a4670516_272375 "12 years ago") | [Details](/attachment.cgi?id=674087&action=edit) | [Diff](/attachment.cgi?id=674087&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=788822&attachment=674087) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=788822#c0)• 12 years ago |
|  | |

The following testcase asserts on ionmonkey revision 0b296feed34c (run with --ion -n -m --ion-eager -a):
function TestCase(n, d, e, a)
this.name = n;
function reportCompare (expected, actual, description) {
var testcase = new TestCase("unknown-test-name", description, expected, actual);
}
evaluate("reportCompare(true,true);", { noScriptRval: true });
evaluate("( 2 , TestCase ) ();", { noScriptRval: true });

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a42_395101)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update,bisect]

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a96919_309316)• 12 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update,bisect][ion:p1:fx18]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a126744_395101)• 12 years ago |

Whiteboard: [jsbugmon:update,bisect][ion:p1:fx18] → [ion:p1:fx18] [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=788822#c1)• 12 years ago |
|  | |

JSBugMon: Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 105607:6cd206b37176
parent: 104959:b63bb39ed1c0
parent: 105606:a0240c1043ee
user: David Anderson
date: Wed Aug 29 17:51:24 2012 -0700
summary: Merge from mozilla-central.
Oops! We didn't test rev b63bb39ed1c0, a parent of the blamed revision! Let's do that now.
Rev b63bb39ed1c0: Found cached shell... Testing... Exit status: NORMAL (0.194 seconds)
good (not interesting)
As expected, the parent's label is the opposite of the blamed rev's label.
Oops! We didn't test rev a0240c1043ee, a parent of the blamed revision! Let's do that now.
We did not test rev a0240c1043ee because it is not a descendant of either 4ceb3e9961e4 or 0b296feed34c.
Rev a0240c1043ee: Found cached shell... Testing... Exit status: ABNORMAL return code 1 (0.111 seconds)
good (not interesting)
As expected, the parent's label is the opposite of the blamed rev's label.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a650109_395101)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=unaffected)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=unaffected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=unaffected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)Whiteboard: [ion:p1:fx18] [jsbugmon:update] → [ion:p1:fx18] [jsbugmon:update,origRev=fdfaef738a00]Version: Other Branch → Trunk

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=788822#c2)• 12 years ago |
|  | |

Reduced to:
-----
function TestCase(n) {
this.name = n;
}
new TestCase(22);
evaluate("(2, TestCase)(2);", {noScriptRval: true});
-----
Interestingly, it also fails with JM (--no-ion -a):
Assertion failure: !fe->isConstant(), at FrameState-inl.h:552
Bus error: 10
Maybe related to [bug 763948](/show_bug.cgi?id=763948 "RESOLVED WONTFIX - Assertion failure: !fe->isConstant(), at methodjit/FrameState-inl.h:552"), not sure yet.Assignee: general → jdemooijStatus: NEW → ASSIGNED

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=788822#c3)• 12 years ago |
|  | |

TI problem. When we have a JSOP\_CALLGNAME op, we add a PropagateThis constraint:
if (op == JSOP\_CALLGNAME)
pushed[0].addPropagateThis(cx, script, pc, GetCalleeThisType(pc));
However, if we have for instance:
(1, TestCase)(2);
JSOP\_GETGNAME is emitted instead of JSOP\_CALLGNAME, so the constraint is not added and the callee |this| typeset does not contain the right value.
00000: one
00001: pop
00002: getgname "TestCase"
00007: undefined
00008: notearg
00009: int8 2
00011: notearg
00012: call 1
00015: pop

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=788822#c4)• 12 years ago |
|  | |

Bisecting JM+TI points to [bug 778724](/show_bug.cgi?id=778724 "RESOLVED FIXED - Allow purging analysis-temporary while retaining jitcode").Blocks: [778724](/show_bug.cgi?id=778724 "RESOLVED FIXED - Allow purging analysis-temporary while retaining jitcode")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a1185491_406194)• 12 years ago |

[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)Summary: IonMonkey: Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328 → Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=788822#c5)• 12 years ago |
|  | |

Below is another testcase based on [bug 763948](/show_bug.cgi?id=763948 "RESOLVED WONTFIX - Assertion failure: !fe->isConstant(), at methodjit/FrameState-inl.h:552"), here it's JSOP\_THIS instead of JSOP\_GETGNAME. [Bug 763948](/show_bug.cgi?id=763948 "RESOLVED WONTFIX - Assertion failure: !fe->isConstant(), at methodjit/FrameState-inl.h:552") was filed in June so the bug was there before [bug 778724](/show_bug.cgi?id=778724 "RESOLVED FIXED - Allow purging analysis-temporary while retaining jitcode") landed, but I think [bug 778724](/show_bug.cgi?id=778724 "RESOLVED FIXED - Allow purging analysis-temporary while retaining jitcode") made it more likely to fail.
function O() {
this.x = 10;
}
new O();
O.foo = function() {
this();
}
O.foo();

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a1896193_1689)• 12 years ago |

[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a1896261_1689)• 12 years ago |

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=788822#c7)• 12 years ago |
|  | |

The test case in [Comment 0](/show_bug.cgi?id=788822#c0 "VERIFIED FIXED - Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328") currently fails with a different error, not hitting the error originally found. The new error is:
Assertion failure: [infer failure] Missing type pushed 0: <0x7ffff1509060>, at /home/sstangl/dev/mozilla-inbound/js/src/jsinfer.cpp:311
Program received signal SIGSEGV, Segmentation fault.
It's likely that something else regressed this; I'm bisecting.

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=788822#c8)• 12 years ago |
|  | |

(In reply to Sean Stangl from [comment #7](/show_bug.cgi?id=788822#c7 "VERIFIED FIXED - Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328"))
> The test case in [Comment 0](/show_bug.cgi?id=788822#c0 "VERIFIED FIXED - Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328") currently fails with a different error, not
> hitting the error originally found. The new error is:
Disregard that -- I mixed up two bugs. All is well.

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a2849732_309316)• 12 years ago |

Whiteboard: [ion:p1:fx18] [jsbugmon:update,origRev=fdfaef738a00] → [ion:p1] [jsbugmon:update,origRev=fdfaef738a00]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a3083983_395101)• 12 years ago |

Whiteboard: [ion:p1] [jsbugmon:update,origRev=fdfaef738a00] → [ion:p1] [jsbugmon:update,origRev=fdfaef738a00,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=788822#c9)• 12 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 2fae8bd461da).

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a3085188_395101)• 12 years ago |

Whiteboard: [ion:p1] [jsbugmon:update,origRev=fdfaef738a00,ignore] → [ion:p1] [jsbugmon:origRev=fdfaef738a00,bisectfix]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a3088394_395101)• 12 years ago |

Whiteboard: [ion:p1] [jsbugmon:origRev=fdfaef738a00,bisectfix] → [ion:p1] [jsbugmon:origRev=fdfaef738a00]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=788822#c10)• 12 years ago |
|  | |

JSBugMon: Fix Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first good revision is:
changeset: 109825:44079242ee9b
user: Terrence Cole
date: Tue Oct 09 17:26:13 2012 -0700
summary: [Bug 799777](/show_bug.cgi?id=799777 "RESOLVED FIXED - Unravel the threaded interpreter") - Unravel the threaded interpreter; r=luke
This iteration took 138.373 seconds to run.

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a4050050_346231)• 12 years ago |

Assignee: jdemooij → bhackett1024

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=788822#c11)• 12 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=674087&action=diff)
— [Details](attachment.cgi?id=674087&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=788822&attachment=674087)

TI is mistaken here in assuming that each JSOP\_CALL/JSOP\_NEW/etc. has its callee pushed by a JSOP\_CALL\* opcode (did this change recently?). This behavior is more historical from when the JSOP\_CALL\* opcodes pushed two values, and isn't really necessary anymore. This patch changes things so that the callee's this type is determined from constraints pushed at the JSOP\_CALL, except for JSOP\_CALLPROP which needs to correlate different callees and 'this' types.
[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: review?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=788822#c12)• 12 years ago |
|  | |

Comment on [attachment 674087](/attachment.cgi?id=674087 "patch") [[details]](/attachment.cgi?id=674087&action=edit "patch") [[diff]](/attachment.cgi?id=674087&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=788822&attachment=674087)
patch
Review of [attachment 674087](/attachment.cgi?id=674087 "patch") [[details]](/attachment.cgi?id=674087&action=edit "patch") [[diff]](/attachment.cgi?id=674087&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=788822&attachment=674087):
-----------------------------------------------------------------
::: js/src/jsinfer.cpp
@@ +4119,5 @@
> + script->code[calleeValue.pushedOffset()] != JSOP\_CALLPROP))
> + {
> + HandleScript script\_ = script;
> + calleeTypes->add(cx, cx->analysisLifoAlloc().new\_<TypeConstraintPropagateThis>
> + (script\_, pc, Type::UndefinedType(), callsite->thisTypes));
You can pass "script" directly and use addPropagateThis:
calleeTypes->addPropagateThis(cx, script, pc, Type::UndefinedType(), callsite->thisTypes);
[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: review?(jdemooij) → review+

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=788822#c13)• 12 years ago |
|  | |

Btw, looking at the code I doubt Firefox 16 is indeed "unaffected". So the least we should do is land this on aurora and beta and add the test cases after beta moves to stable.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a4121205_406194)• 12 years ago |

[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a4121238_406194)• 12 years ago |

[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=788822#c14)• 12 years ago |
|  | |

Assuming this is sec-critical due to infer failure. Let me know if that isn't right.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=788822#c15)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/ca391c7bceb8>

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a4134419_309316)• 12 years ago |

Whiteboard: [ion:p1] [jsbugmon:origRev=fdfaef738a00] → [ion:p1:fx19] [jsbugmon:origRev=fdfaef738a00]

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=788822#c16)• 12 years ago |
|  | |

(In reply to Brian Hackett (:bhackett) [mostly gone until mid-November] from [comment #15](/show_bug.cgi?id=788822#c15 "VERIFIED FIXED - Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328"))
> <https://hg.mozilla.org/integration/mozilla-inbound/rev/ca391c7bceb8>
Now that this has landed on m-i, we'll want to get uplift nominations as soon as possible.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=788822#c17)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/ca391c7bceb8>
Should this have a test?Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=fixed)Flags: in-testsuite?Resolution: --- → FIXEDTarget Milestone: --- → mozilla19

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a4171725_395101)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=788822#c18)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=788822#c19)• 12 years ago |
|  | |

This appears to have fixed a regression on Nightly which still exists on Aurora.
<http://gojs.net/latest/samples/flowchart.html>
Assertion failure: false (could not find use), at c:/work/mozilla/builds/aurora/mozilla/js/src/ion/MIR.cpp:256
Found regression between 20120910183953-20120911183952
Pushlog: <http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=96287ad60bef&tochange=6e78c3efd115>
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/09/2012-09-11-mozilla-central-debug/firefox-18.0a1.en-US.debug-mac64.dmg>
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/09/2012-09-12-mozilla-central-debug/firefox-18.0a1.en-US.debug-mac64.dmg>
Found fix between 20121022184211-20121024022814
Pushlog: <http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=48502b61a63e&tochange=b06ee7ea6ba0>
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/10/2012-10-23-mozilla-central-debug/firefox-19.0a1.en-US.debug-mac64.dmg>
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/10/2012-10-24-mozilla-central-debug/firefox-19.0a1.en-US.debug-mac64.dmg>
Found regression between 20121008021134-20121008142135
Pushlog: <http://hg.mozilla.org/releases/mozilla-aurora/pushloghtml?fromchange=c7c6f2aa37b6&tochange=7588306df29e>
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/10/2012-10-08-mozilla-aurora-debug/firefox-17.0a2.en-US.debug-mac64.dmg>
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/10/2012-10-09-mozilla-aurora-debug/firefox-18.0a2.en-US.debug-mac64.dmg>
The first good revision is:
changeset: 111161:ca391c7bceb8
user: Brian Hackett <bhackett1024@gmail.com>
date: Tue Oct 23 09:05:27 2012 -0700
summary: Propagate callee 'this' types more often, [bug 788822](/show_bug.cgi?id=788822 "VERIFIED FIXED - Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328"). r=jandem

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=788822#c20)• 12 years ago |
|  | |

(In reply to Bob Clary [:bc:] from [comment #19](/show_bug.cgi?id=788822#c19 "VERIFIED FIXED - Assertion failure: [infer failure] Missing type pushed 0: <0x7f7d5aa09060>, at jsinfer.cpp:328"))
> This appears to have fixed a regression on Nightly which still exists on
> Aurora.
>
> <http://gojs.net/latest/samples/flowchart.html>
>
> Assertion failure: false (could not find use), at
> c:/work/mozilla/builds/aurora/mozilla/js/src/ion/MIR.cpp:256
The first bad revision is:
changeset: 106790:ca3fa3fbe62a
parent: 106789:01f6ddbb6542
parent: 104782:d042ad078f43
user: David Anderson <danderson@mozilla.com>
date: Tue Sep 11 10:25:14 2012 -0700
summary: Merge IonMonkey to mozilla-central. a=arewefastyet
My question is did <https://hg.mozilla.org/mozilla-central/rev/ca391c7bceb8> fix Assertion failure: false (could not find use) or did it just hide it?

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=788822#c21)• 12 years ago |
|  | |

Comment on [attachment 674087](/attachment.cgi?id=674087 "patch") [[details]](/attachment.cgi?id=674087&action=edit "patch") [[diff]](/attachment.cgi?id=674087&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=788822&attachment=674087)
patch
[Approval Request Comment]
Bug caused by (feature/regressing bug #): [bug 778724](/show_bug.cgi?id=778724 "RESOLVED FIXED - Allow purging analysis-temporary while retaining jitcode")
User impact if declined: potential security bug
Testing completed (on m-c, etc.): yes
Risk to taking this patch (and alternatives if risky): Low risk, this changes some details in TI constraints, designed only to affect very esoteric code. Typical risks apply otherwise (could introduce new bugs or not fully fix the existing bug).
String or UUID changes made by this patch:
[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: approval-mozilla-beta?
[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a4670516_272375)• 12 years ago |

[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: approval-mozilla-beta?
[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: approval-mozilla-beta+
[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: approval-mozilla-aurora?
[Attachment #674087](/attachment.cgi?id=674087&action=edit "patch") -
Flags: approval-mozilla-aurora+

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=788822#c22)• 12 years ago |
|  | |

Needs landing for aurora/beta.Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=788822#c23)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/fd0363381c3b>
Needed some syntactic changes to apply to mozilla-beta.
<https://hg.mozilla.org/releases/mozilla-beta/rev/2c15b22a9ed4>
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=fixed)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a4846178_280903)• 12 years ago |

Whiteboard: [ion:p1:fx19] [jsbugmon:origRev=fdfaef738a00] → [ion:p1:fx19] [jsbugmon:origRev=fdfaef738a00][adv-track-main17+]

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a5359845_279076)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a11485497_279076)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=788822#a16755691_1689)• 12 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=788822&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.opensuse.org_46845ded_20250124_140947.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D/#OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D)

# [security-announce] openSUSE-SU-2013:0175-1: important: security update to Firefox 17.0 and other Mozilla based packages

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

23 Jan
2013

23 Jan
'13

13:07

openSUSE Security Update: security update to Firefox 17.0 and other Mozilla based packages
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0175-1
Rating: important
References: #790140
Cross-References: CVE-2012-4201 CVE-2012-4202 CVE-2012-4204
CVE-2012-4205 CVE-2012-4207 CVE-2012-4208
CVE-2012-4209 CVE-2012-4212 CVE-2012-4213
CVE-2012-4214 CVE-2012-4215 CVE-2012-4216
CVE-2012-4217 CVE-2012-4218 CVE-2012-5829
CVE-2012-5830 CVE-2012-5833 CVE-2012-5835
CVE-2012-5836 CVE-2012-5838 CVE-2012-5839
CVE-2012-5840 CVE-2012-5841 CVE-2012-5842
CVE-2012-5843
Affected Products:
openSUSE 11.4/standard/i586/patchinfo.18
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 25 vulnerabilities is now available.
Description:
update to Firefox/Thunderbird 17.0 and Seamonkey 2.14
(bnc#790140)
\* MFSA 2012-91/CVE-2012-5842/CVE-2012-5843 Miscellaneous
memory safety hazards
\* MFSA 2012-92/CVE-2012-4202 (bmo#758200) Buffer overflow
while rendering GIF images
\* MFSA 2012-93/CVE-2012-4201 (bmo#747607) evalInSanbox
location context incorrectly applied
\* MFSA 2012-94/CVE-2012-5836 (bmo#792857) Crash when
combining SVG text on path with CSS
\* MFSA 2012-95/CVE-2012-4203 (bmo#765628) Javascript:
URLs run in privileged context on New Tab page
\* MFSA 2012-96/CVE-2012-4204 (bmo#778603) Memory
corruption in str\_unescape
\* MFSA 2012-97/CVE-2012-4205 (bmo#779821) XMLHttpRequest
inherits incorrect principal within sandbox
\* MFSA 2012-99/CVE-2012-4208 (bmo#798264) XrayWrappers
exposes chrome-only properties when not in chrome
compartment
\* MFSA 2012-100/CVE-2012-5841 (bmo#805807) Improper
security filtering for cross-origin wrappers
\* MFSA 2012-101/CVE-2012-4207 (bmo#801681) Improper
character decoding in HZ-GB-2312 charset
\* MFSA 2012-102/CVE-2012-5837 (bmo#800363) Script entered
into Developer Toolbar runs with chrome privileges
\* MFSA 2012-103/CVE-2012-4209 (bmo#792405) Frames can
shadow top.location
\* MFSA 2012-104/CVE-2012-4210 (bmo#796866) CSS and HTML
injection through Style Inspector
\* MFSA
2012-105/CVE-2012-4214/CVE-2012-4215/CVE-2012-4216/
CVE-2012-5829/CVE-2012-5839/CVE-2012-5840/CVE-2012-4212/
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 11.4/standard/i586/patchinfo.18:
zypper in -t patch 2012-6
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 11.4/standard/i586/patchinfo.18 (i586 x86\_64):
MozillaFirefox-17.0-49.1
MozillaFirefox-branding-upstream-17.0-49.1
MozillaFirefox-buildsymbols-17.0-49.1
MozillaFirefox-debuginfo-17.0-49.1
MozillaFirefox-debugsource-17.0-49.1
MozillaFirefox-devel-17.0-49.1
MozillaFirefox-translations-common-17.0-49.1
MozillaFirefox-translations-other-17.0-49.1
MozillaThunderbird-17.0-41.1
MozillaThunderbird-buildsymbols-17.0-41.1
MozillaThunderbird-debuginfo-17.0-41.1
MozillaThunderbird-debugsource-17.0-41.1
MozillaThunderbird-devel-17.0-41.1
MozillaThunderbird-devel-debuginfo-17.0-41.1
MozillaThunderbird-translations-common-17.0-41.1
MozillaThunderbird-translations-other-17.0-41.1
enigmail-1.4.6+17.0-41.1
enigmail-debuginfo-1.4.6+17.0-41.1
seamonkey-2.14-45.1
seamonkey-debuginfo-2.14-45.1
seamonkey-debugsource-2.14-45.1
seamonkey-dom-inspector-2.14-45.1
seamonkey-irc-2.14-45.1
seamonkey-translations-common-2.14-45.1
seamonkey-translations-other-2.14-45.1
seamonkey-venkman-2.14-45.1
References:
<http://support.novell.com/security/cve/CVE-2012-4201.html>
<http://support.novell.com/security/cve/CVE-2012-4202.html>
<http://support.novell.com/security/cve/CVE-2012-4204.html>
<http://support.novell.com/security/cve/CVE-2012-4205.html>
<http://support.novell.com/security/cve/CVE-2012-4207.html>
<http://support.novell.com/security/cve/CVE-2012-4208.html>
<http://support.novell.com/security/cve/CVE-2012-4209.html>
<http://support.novell.com/security/cve/CVE-2012-4212.html>
<http://support.novell.com/security/cve/CVE-2012-4213.html>
<http://support.novell.com/security/cve/CVE-2012-4214.html>
<http://support.novell.com/security/cve/CVE-2012-4215.html>
<http://support.novell.com/security/cve/CVE-2012-4216.html>
<http://support.novell.com/security/cve/CVE-2012-4217.html>
<http://support.novell.com/security/cve/CVE-2012-4218.html>
<http://support.novell.com/security/cve/CVE-2012-5829.html>
<http://support.novell.com/security/cve/CVE-2012-5830.html>
<http://support.novell.com/security/cve/CVE-2012-5833.html>
<http://support.novell.com/security/cve/CVE-2012-5835.html>
<http://support.novell.com/security/cve/CVE-2012-5836.html>
<http://support.novell.com/security/cve/CVE-2012-5838.html>
<http://support.novell.com/security/cve/CVE-2012-5839.html>
<http://support.novell.com/security/cve/CVE-2012-5840.html>
<http://support.novell.com/security/cve/CVE-2012-5841.html>
<http://support.novell.com/security/cve/CVE-2012-5842.html>
<http://support.novell.com/security/cve/CVE-2012-5843.html>
<https://bugzilla.novell.com/790140>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D/#OPJHS7SOAYSUT7RJN6QZPTY3KJHYL47D)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from secunia.com_3d7d31a9_20250124_140949.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...


