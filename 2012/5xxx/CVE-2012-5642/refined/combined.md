=== Content from www.openwall.com_d9ceb8e9_20250125_073921.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <50CF54D8.50003@redhat.com>
Date: Mon, 17 Dec 2012 10:22:32 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Vincent Danen <vdanen@...hat.com>
Subject: Re: CVE request: fail2ban 0.8.8 fixes an input variable
 quoting flaw on <matches> content

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 12/17/2012 08:41 AM, Vincent Danen wrote:
> Could a CVE be assigned to this issue please?
>
> The release notes for fail2ban 0.8.8 indicate:
>
> * [83109bc] IMPORTANT: escape the content of <matches> (if used in
> custom action files) since its value could contain arbitrary
> symbols.  Thanks for discovery go to the NBS System security team
>
> This could cause issues on the system running fail2ban as it scans
> log files, depending on what content is matched.  There isn't much
> more detail about this issue than what is described above, so I
> think it may largely depend on the type of regexp used (what it
> matches) and the contents of the log file being scanned (whether or
> not an attacher could insert something that could be used in a
> malicious way).
>
> References:
>
> <https://raw.github.com/fail2ban/fail2ban/master/ChangeLog>
> <http://sourceforge.net/mailarchive/message.php?msg_id=30193056>
> <https://github.com/fail2ban/fail2ban/commit/83109bc>
> <https://bugzilla.redhat.com/show_bug.cgi?id=887914>
> <https://bugs.gentoo.org/show_bug.cgi?id=447572>
>

Please use CVE-2012-5642 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJQz1TYAAoJEBYNRVNeJnmTQdgP/jRbo8ReeQJzUxAqsc0JiJ1a
fC6e4hnTeYw1y8007NZkxbmdnvsgZvtFvUiBe6ovuGidIKXSWqYH3LjoC/0Oim4T
NNTnL1wG8Ri93akY56/pyyHeZGamo1Ss1Kv4BgM0MXFfOOWTJmGPz1jn52E4VtBC
gnVHIZ/gNxVbIVj0QVaj3tDJOhweg9ACkunVwDasMTRi1MgQKmT3i8IVgWsVGaAo
xzxE1T1RXygjtbJNpMlBDmZP4+OjSeAzavAw81OP4j/Tse68PcBA2givh0SNG97T
neEDyWtL8IvMxYPelgUyWi0jWHv96ymuKwfzkST81+yjSYc2JqN0FnOSa2kCjCtb
tCG3K/Y2AKCbi8JozTjgDj1wTSh5I6z9DXiARan9m+JfZYChoESiQ960H1VGEd3t
qJL43vr2FnWTHpClwp4O/CQyQ4XeN8ttxTgZdvZbYUZraSFxpNZfdW1dGVwrR4Kg
opg06obA4B22o/JZmC7ZRFhFr/idY8IDXtRuuUJPnY9C6UazfP/Zv4EnylTMuYCY
CvvL58t3SnruoJHplr8d6uZWrPgSqdK7XRFGIm/L7ISuNMe67swXa3SF8+gshpXu
IIFa8qOK6QIejFMAT2BW5Xlp0Q/m3RB2cnVmEK000rLkuFlj2eYZr0aftD8uJ3Ub
vZg8/UeljGebpb7n+7w3
=mKR4
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.mandriva.com_7c78455b_20250125_073920.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugzilla.novell.com_822f3620_20250126_071922.html ===




=== Content from bugzilla.redhat.com_ddf3f5a5_20250126_071906.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D887914)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D887914)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D887914)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 887914

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 887914**](show_bug.cgi?id=887914)
(CVE-2012-5642)
- [CVE-2012-5642](https://access.redhat.com/security/cve/CVE-2012-5642) fail2ban: does not escape the content of <matches>

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-5642 fail2ban: does not escape the content of <matches>

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-5642 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [887915](show_bug.cgi?id=887915 "CLOSED CURRENTRELEASE - fail2ban: does not escape the content of <matches> [fedora-all]") [887916](show_bug.cgi?id=887916 "CLOSED CURRENTRELEASE - fail2ban: does not escape the content of <matches> [epel-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=887914&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=887914&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-12-17 15:38 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:58 UTC ([History](show_activity.cgi?id=887914)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  admiller axel.thimm jonathan.underwood orion | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-10 10:59:45 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=887914#c0)  Vincent Danen    2012-12-17 15:38:33 UTC  ``` The release notes for fail2ban 0.8.8 [1],[2] indicate:     * [83109bc] IMPORTANT: escape the content of <matches> (if used in      custom action files) since its value could contain arbitrary      symbols.  Thanks for discovery go to the NBS System security      team  This could cause issues on the system running fail2ban as it scans log files, depending on what content is matched.  There isn't much more detail about this issue than what is described above, so I think it may largely depend on the type of regexp used (what it matches) and the contents of the log file being scanned (whether or not an attacher could insert something that could be used in a malicious way).  The upstream git commit [3].  [1] <https://raw.github.com/fail2ban/fail2ban/master/ChangeLog> [2] <http://sourceforge.net/mailarchive/message.php?msg_id=30193056> [3] <https://github.com/fail2ban/fail2ban/commit/83109bc>   ```  [Comment 1](show_bug.cgi?id=887914#c1)  Vincent Danen    2012-12-17 15:42:34 UTC  ``` Created fail2ban tracking bugs for this issue  Affects: fedora-all [[bug 887915](show_bug.cgi?id=887915 "CLOSED CURRENTRELEASE - fail2ban: does not escape the content of <matches> [fedora-all]")] Affects: epel-all [[bug 887916](show_bug.cgi?id=887916 "CLOSED CURRENTRELEASE - fail2ban: does not escape the content of <matches> [epel-all]")]   ```  [Comment 2](show_bug.cgi?id=887914#c2)  Vincent Danen    2012-12-17 19:11:09 UTC  ``` This was assigned CVE-2012-5642:  <http://www.openwall.com/lists/oss-security/2012/12/17/2>   ```  [Comment 3](show_bug.cgi?id=887914#c3)  Fedora Update System    2012-12-28 03:50:50 UTC  ``` fail2ban-0.8.8-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 4](show_bug.cgi?id=887914#c4)  Fedora Update System    2013-01-02 19:09:36 UTC  ``` fail2ban-0.8.8-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 5](show_bug.cgi?id=887914#c5)  Fedora Update System    2013-01-12 00:24:50 UTC  ``` fail2ban-0.8.8-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=887914#c6)  Product Security DevOps Team    2019-06-10 10:59:45 UTC  ``` This CVE Bugzilla entry is for community support informational purposes only as it does not affect a package in a commercially supported Red Hat product. Refer to the dependent bugs for status of those individual community products.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=887914&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.novell.com_75fa925a_20250126_071925.html ===




=== Content from bugs.gentoo.org_8cf3bc9d_20250126_071907.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 447572
<net-analyzer/fail2ban-0.8.8: input variable quoting vulnerability (CVE-2012-5642)
Last modified: 2013-02-22 20:44:04 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=447572&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=447572&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 447572**](show_bug.cgi?id=447572)
(CVE-2012-5642)
- <net-analyzer/fail2ban-0.8.8: input variable quoting vulnerability (CVE-2012-5642)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<net-analyzer/fail2ban-0.8.8: input variable quoting vulnerability (CVE-2012-...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-5642 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://raw.github.com/fail2ban/fail2...](https://raw.github.com/fail2ban/fail2ban/master/ChangeLog) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B4 [noglsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [449966](show_bug.cgi?id=449966 "RESOLVED FIXED - net-analyzer/fail2ban-0.8.8 installs /var/run") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=447572&hide_resolved=1) | |  | | Reported: | 2012-12-17 10:25 UTC by Mario Kicherer | | --- | --- | | Modified: | 2013-02-22 20:44 UTC ([History](show_activity.cgi?id=447572)) | | CC List: | 1 user (show)  netmon | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=447572&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=447572&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Mario Kicherer    2012-12-17 10:25:40 UTC  ``` Version 0.8.8 came out 2012/12/06. I tested it with the fail2ban-0.8.7.1 ebuild and it works for me on AMD64.  Reproducible: Always ```  [Comment 1](#c1)  Jeroen Roovers (RETIRED)   gentoo-dev  2012-12-17 12:20:49 UTC  ```    * [83109bc] IMPORTANT: escape the content of <matches> (if used in      custom action files) since its value could contain arbitrary      symbols.  Thanks for discovery go to the NBS System security      team ```  [Comment 2](#c2)  Sean Amoss (RETIRED)   gentoo-dev Security  2012-12-26 16:47:29 UTC  ``` Thanks, Mario and Jeroen.  Arches, please test and mark stable =net-analyzer/fail2ban-0.8.8 ```  [Comment 3](#c3)  Jeff (JD) Horelick (RETIRED)   gentoo-dev  2012-12-26 17:00:44 UTC  ``` x86 stable ```  [Comment 4](#c4)  Agostino Sarubbo   gentoo-dev  2012-12-26 17:19:13 UTC  ``` amd64 stable ```  [Comment 5](#c5)  Jeroen Roovers (RETIRED)   gentoo-dev  2012-12-28 16:53:54 UTC  ``` Stable for HPPA. ```  [Comment 6](#c6)  Agostino Sarubbo   gentoo-dev  2012-12-31 23:30:54 UTC  ``` ppc stable ```  [Comment 7](#c7)  GLSAMaker/CVETool Bot   gentoo-dev  2013-01-03 11:42:44 UTC  ``` CVE-2012-5642 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-5642>):   server/action.py in Fail2ban before 0.8.8 does not properly handle the   content of the matches tag, which might allow remote attackers to trigger   unsafe behavior in a custom action file via unspecified symbols in this   content. ```  [Comment 8](#c8)  Agostino Sarubbo   gentoo-dev  2013-01-04 13:15:35 UTC  ``` ppc64 stable ```  [Comment 9](#c9)  Sean Amoss (RETIRED)   gentoo-dev Security  2013-01-06 17:21:01 UTC  ``` GLSA vote: no. ```  [Comment 10](#c10)  Mario Kicherer    2013-02-22 20:37:09 UTC  ``` Can we close this bug? I guess GLSA is not required anymore. :) ```  [Comment 11](#c11)  Tobias Heinlein (RETIRED)   gentoo-dev  2013-02-22 20:44:04 UTC  ``` NO too, closing. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=447572)
* - [XML](show_bug.cgi?ctype=xml&id=447572)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=447572)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=447572&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=447572&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=447572&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from wiki.gentoo.org_2dc1ed88_20250126_071910.html ===

Jump to: [content](#top)

 [**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites

* [gentoo.org](https://www.gentoo.org/ "Gentoo's main website")
* [Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
* [Bugs](https://bugs.gentoo.org/ "Discover and report issues with Gentoo")
* [Packages](https://packages.gentoo.org/ "Find software to install")
* [Forums](https://forums.gentoo.org/ "Discuss with the community")
* [Planet](https://planet.gentoo.org/ "Find out what's going on in the dev community")
* [Archives](https://archives.gentoo.org/ "Read up on past discussions")
* [Devmanual](https://devmanual.gentoo.org/ "Read the development guide")
* [Gitweb](https://gitweb.gentoo.org/ "Browse our source code in Gitweb")
* [Infra status](https://infra-status.gentoo.org/ "Get updates on the services provided by the Gentoo infra team")

[![Gentoo Linux Logo](https://assets.gentoo.org/tyrian/site-logo.png)](/ "Back to the homepage")
Wiki

Toggle navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Help](/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")
* [Contribute!](/wiki/Gentoo_Wiki%3AContributor%27s_guide)
* [Documentation](/wiki/Gentoo_Wiki%3AMenu-Documentation)
  + [Gentoo Handbook](/wiki/Handbook%3AMain_Page)
  + [Gentoo FAQ](/wiki/FAQ)
  + [Core system](/wiki/Category%3ACore_system)
  + [Hardware](/wiki/Category%3AHardware)
  + [Software](/wiki/Category%3ASoftware)
  + [Desktop](/wiki/Category%3ADesktop)
  + [Server & Security](/wiki/Category%3AServer_and_Security)
  + [Project & Community](/wiki/Category%3AProject_and_Community)
  + [Gentoo Projects](/wiki/Project%3AGentoo)

* Tools
  + [What links here](/wiki/Special%3AWhatLinksHere/Main_Page "A list of all wiki pages that link here [j]")
  + [Related changes](/wiki/Special%3ARecentChangesLinked/Main_Page "Recent changes in pages linked from this page [k]")
  + [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
  + Printable version
  + [Permanent link](/index.php?title=Main_Page&oldid=1328572 "Permanent link to this revision of the page")
  + [Page information](/index.php?title=Main_Page&action=info "More information about this page")
  + [Browse properties](/wiki/Special%3ABrowse/%3AMain-5FPage)
* User
  + English
  + [Create account](/index.php?title=Special:CreateAccount&returnto=Main+Page "You are encouraged to create an account and log in; however, it is not mandatory")
  + [Log in](/index.php?title=Special:UserLogin&returnto=Main+Page "You are encouraged to log in; however, it is not mandatory [o]")

Toggle navigation

* [Main page](/wiki/Main_Page "View the content page [c]")
* [Discussion](/wiki/Talk%3AMain_Page "Discussion about the content page [t]")

* [View source](/index.php?title=Main_Page&action=edit "This page is protected.
  You can view its source [e]")
* more
  + [History](/index.php?title=Main_Page&action=history "Past revisions of this page [h]")

# Main Page

From Gentoo Wiki

[Jump to:navigation](#mw-head)
[Jump to:search](#searchInput)

![moo](/images/thumb/8/83/Larry_festive_hat.png/150px-Larry_festive_hat.png "moo")
# Welcome to the Gentoo wiki!

Larry the Cow beckons you to explore the Gentoo wiki!

## Available documentation

To find information use the search box on the top right corner of the screen, or categorically browse the wiki using the [Documentation topic](#Documentation_topics) links provided below.

Both official Gentoo project documentation as well as community-contributed content can be found here. The vast majority of documentation is publicly editable. Official documents have a *Handbook:* or *Project:* prefix (only developers can edit them). Community members can leave comments/feedback for these pages via their respective *Discussion* pages.

Find something to add or edit? The [*Getting started*](#Getting_started) section (below) gives contributors a few pointers on how to start editing articles.

Most importantly, the **Gentoo Handbook** is among the best documents found on the wiki:

 [Gentoo Handbook (Official installation documentation)](/wiki/Handbook%3AMain_Page "Handbook:Main Page")

### Documentation topics

 [Core system](/wiki/Category%3ACore_system "Category:Core system")
 [Software](/wiki/Category%3ASoftware "Category:Software")
 [Hardware](/wiki/Category%3AHardware "Category:Hardware")
 [Desktop](/wiki/Category%3ADesktop "Category:Desktop")
 [Server and security](/wiki/Category%3AServer_and_Security "Category:Server and Security")
 [Project and community](/wiki/Category%3AProject_and_Community "Category:Project and Community")

### Contributing

 [Wiki guidelines](/wiki/Gentoo_Wiki%3AGuidelines "Gentoo Wiki:Guidelines")
 [Article blueprints](/wiki/Gentoo_Wiki%3AArticle_Blueprints "Gentoo Wiki:Article Blueprints")
 [Translator account requests](/wiki/Gentoo_Wiki%3ATranslator_account_requests "Gentoo Wiki:Translator account requests")

## News

 **Important**
Due to usability issues the [visual editor](https://en.wikipedia.org/wiki/Wikipedia%3AVisualEditor "wikipedia:Wikipedia:VisualEditor") has been temporarily disabled. See [bug #910279](https://bugs.gentoo.org/show_bug.cgi?id=910279) for more details.
#### January 1, 2025: Happy New Year!

Thanks for making 2024 great, and here's to an even *greater* New Year! 2025 should be a 'big' year for the wiki!

During Q1 2025, we have plans to update the software stack which supports the wiki. Before and during the update, we'll do our best to provide any additional details if and as they are needed by adding context details to [infra-status.g.o](https://infra-status.gentoo.org/). As with any infrastructure update, expect a lack of availability during the update window and possibly even after if things go awry. We'll at least be locking the wiki into a read-only state; but we plan also for the wiki to be offline for a certain amount of time during the update. Post successful update, we plan to do better at implementing scheduled maintenance routinely within planned windows which will hopefully enable a shorter down time between updates.

 To all in our amazing community, thank YOU for making the Gentoo wiki the best FOSS wiki on the web!

[Wiki news archive...](/wiki/Gentoo_Wiki%3ANews "Gentoo Wiki:News")

### Wiki development details

* **113** active and **147** retired developers
* **170** active official projects
* **98** active users on the wiki

[Wiki development changelog...](/wiki/Handbook%3AMain_Page/Changelog "Handbook:Main Page/Changelog")

## Getting started

Anyone is welcome to edit or create pages on this wiki.

Gentoo wiki contributors encourage beginners to consult the [Help page](/wiki/Help%3AContents "Help:Contents") before making edits. It also links to the [MediaWiki User's Guide](https://meta.wikimedia.org/wiki/Help%3AContents) which contains information on how to use wiki software.

If there is something we can improve please let us know on the [Feedback page](/wiki/Gentoo_Wiki%3AFeedback "Gentoo Wiki:Feedback").

For questions *related to using or editing the documentation on the wiki*, please join us in our #gentoo-wiki ([webchat](https://web.libera.chat/#gentoo-wiki)) IRC channel on Libera.chat or email us at wiki@gentoo.org.

**Please note**: For *general Gentoo support*, such as getting advice on a particular Handbook section or other generic support questions, please get in touch with our [support community](https://www.gentoo.org/support/) instead. General support is *not* provided by the wiki project.

## Recently added pages

* [23:33, 25 January 2025](/index.php?title=Safe_CFLAGS/hu&oldid=1335381 "Safe CFLAGS/hu") ‎[Safe CFLAGS/hu](/wiki/Safe_CFLAGS/hu "Safe CFLAGS/hu") ([hist](/index.php?title=Safe_CFLAGS/hu&action=history "Safe CFLAGS/hu") | [edit](/index.php?title=Safe_CFLAGS/hu&action=edit "Safe CFLAGS/hu")) ‎[37,012 bytes] ‎[Torontál-vármegye](/wiki/User%3AToront%C3%A1l-v%C3%A1rmegye "User:Torontál-vármegye") ([talk](/index.php?title=User_talk:Toront%C3%A1l-v%C3%A1rmegye&action=edit&redlink=1 "User talk:Torontál-vármegye (page does not exist)") | [contribs](/wiki/Special%3AContributions/Toront%C3%A1l-v%C3%A1rmegye "Special:Contributions/Torontál-vármegye")) (Created page with "Biztonságok CFLAGS")
* [19:33, 25 January 2025](/index.php?title=PKGDIR/hu&oldid=1335359 "PKGDIR/hu") ‎[PKGDIR/hu](/wiki/PKGDIR/hu "PKGDIR/hu") ([hist](/index.php?title=PKGDIR/hu&action=history "PKGDIR/hu") | [edit](/index.php?title=PKGDIR/hu&action=edit "PKGDIR/hu")) ‎[734 bytes] ‎[Torontál-vármegye](/wiki/User%3AToront%C3%A1l-v%C3%A1rmegye "User:Torontál-vármegye") ([talk](/index.php?title=User_talk:Toront%C3%A1l-v%C3%A1rmegye&action=edit&redlink=1 "User talk:Torontál-vármegye (page does not exist)") | [contribs](/wiki/Special%3AContributions/Toront%C3%A1l-v%C3%A1rmegye "Special:Contributions/Torontál-vármegye")) (Created page with "PKGDIR")
* [19:21, 25 January 2025](/index.php?title=Monit/hu&oldid=1335329 "Monit/hu") ‎[Monit/hu](/wiki/Monit/hu "Monit/hu") ([hist](/index.php?title=Monit/hu&action=history "Monit/hu") | [edit](/index.php?title=Monit/hu&action=edit "Monit/hu")) ‎[7,022 bytes] ‎[Torontál-vármegye](/wiki/User%3AToront%C3%A1l-v%C3%A1rmegye "User:Torontál-vármegye") ([talk](/index.php?title=User_talk:Toront%C3%A1l-v%C3%A1rmegye&action=edit&redlink=1 "User talk:Torontál-vármegye (page does not exist)") | [contribs](/wiki/Special%3AContributions/Toront%C3%A1l-v%C3%A1rmegye "Special:Contributions/Torontál-vármegye")) (Created page with "A '''monit''' [egy segédprogram a folyamatok, programok, fájlok, könyvtárak és fájlrendszerek kezelésére és figyelésére UNIX rendszeren.](/index.php?title=Egy_seg%C3%A9dprogram_a_folyamatok,_programok,_f%C3%A1jlok,_k%C3%B6nyvt%C3%A1rak_%C3%A9s_f%C3%A1jlrendszerek_kezel%C3%A9s%C3%A9re_%C3%A9s_figyel%C3%A9s%C3%A9re_UNIX_rendszeren.&action=edit&redlink=1 "Egy segédprogram a folyamatok, programok, fájlok, könyvtárak és fájlrendszerek kezelésére és figyelésére UNIX rendszeren. (page does not exist)")")
* [10:44, 25 January 2025](/index.php?title=Dm-crypt/hu&oldid=1335065 "Dm-crypt/hu") ‎[Dm-crypt/hu](/wiki/Dm-crypt/hu "Dm-crypt/hu") ([hist](/index.php?title=Dm-crypt/hu&action=history "Dm-crypt/hu") | [edit](/index.php?title=Dm-crypt/hu&action=edit "Dm-crypt/hu")) ‎[21,263 bytes] ‎[Torontál-vármegye](/wiki/User%3AToront%C3%A1l-v%C3%A1rmegye "User:Torontál-vármegye") ([talk](/index.php?title=User_talk:Toront%C3%A1l-v%C3%A1rmegye&action=edit&redlink=1 "User talk:Torontál-vármegye (page does not exist)") | [contribs](/wiki/Special%3AContributions/Toront%C3%A1l-v%C3%A1rmegye "Special:Contributions/Torontál-vármegye")) (Created page with "dm-crypt")
* [10:40, 25 January 2025](/index.php?title=DISTDIR/hu&oldid=1335062 "DISTDIR/hu") ‎[DISTDIR/hu](/wiki/DISTDIR/hu "DISTDIR/hu") ([hist](/index.php?title=DISTDIR/hu&action=history "DISTDIR/hu") | [edit](/index.php?title=DISTDIR/hu&action=edit "DISTDIR/hu")) ‎[4,725 bytes] ‎[Torontál-vármegye](/wiki/User%3AToront%C3%A1l-v%C3%A1rmegye "User:Torontál-vármegye") ([talk](/index.php?title=User_talk:Toront%C3%A1l-v%C3%A1rmegye&action=edit&redlink=1 "User talk:Torontál-vármegye (page does not exist)") | [contribs](/wiki/Special%3AContributions/Toront%C3%A1l-v%C3%A1rmegye "Special:Contributions/Torontál-vármegye")) (Created page with "DISTDIR")

Retrieved from "<https://wiki.gentoo.org/index.php?title=Main_Page&oldid=1328572>"
[Category](/wiki/Special%3ACategories "Special:Categories"):

* [Gentoo Wiki](/wiki/Category%3AGentoo_Wiki "Category:Gentoo Wiki")

* This page was last edited on 1 January 2025, at 22:01.
* [Privacy policy](/wiki/Gentoo_Wiki%3APrivacy_policy "Gentoo Wiki:Privacy policy")
* [About Gentoo Wiki](/wiki/Gentoo_Wiki%3AAbout "Gentoo Wiki:About")
* [Disclaimers](/wiki/Gentoo_Wiki%3AGeneral_disclaimer "Gentoo Wiki:General disclaimer")

**© 2001–2025 Gentoo Authors**

Gentoo is a trademark of the Gentoo Foundation, Inc. and of Förderverein Gentoo e.V.
The contents of this document, unless otherwise expressly stated, are licensed under the
[CC-BY-SA-4.0](https://creativecommons.org/licenses/by-sa/4.0/) license.
The [Gentoo Name and Logo Usage Guidelines](https://www.gentoo.org/inside-gentoo/foundation/name-logo-guidelines.html) apply.



=== Content from lists.opensuse.org_0cf94be2_20250125_073918.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ/#GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ)

# openSUSE-SU-2013:0567-1: fail2ban: fixed a startup and security issue

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

2 Apr
2013

2 Apr
'13

12:04

openSUSE Security Update: fail2ban: fixed a startup and security issue
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0567-1
Rating: low
References: #790557 #794953
Cross-References: CVE-2012-5642
Affected Products:
openSUSE 11.4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that solves one vulnerability and has one errata
is now available.
Description:
This update of fail2ban fixes a startup related
startup-problem and a security problem fixed upstream
(CVE-2012-5642).
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 11.4:
zypper in -t patch 2013-52
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 11.4 (noarch):
fail2ban-0.8.4-18.1
References:
<http://support.novell.com/security/cve/CVE-2012-5642.html>
<https://bugzilla.novell.com/790557>
<https://bugzilla.novell.com/794953>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ/#GC3JMBFMY4REWJHP6V2XAVCLYWTRMHCZ)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from access.redhat.com_5823bf9b_20250126_071912.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.opensuse.org_6eec1557_20250125_073917.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/3UDRNXWOPJKH3RJBIINB754DVRLKRZLS/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/3UDRNXWOPJKH3RJBIINB754DVRLKRZLS/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/3UDRNXWOPJKH3RJBIINB754DVRLKRZLS/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/3UDRNXWOPJKH3RJBIINB754DVRLKRZLS/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/3UDRNXWOPJKH3RJBIINB754DVRLKRZLS/#3UDRNXWOPJKH3RJBIINB754DVRLKRZLS)

# openSUSE-SU-2013:0566-1: fail2ban: fixed a startup and security issue

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

2 Apr
2013

2 Apr
'13

09:04

openSUSE Security Update: fail2ban: fixed a startup and security issue
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0566-1
Rating: low
References: #790557 #794953
Cross-References: CVE-2012-5642
Affected Products:
openSUSE 12.3
openSUSE 12.2
openSUSE 12.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that solves one vulnerability and has one errata
is now available.
Description:
This update of fail2ban fixes a startup related
startup-problem and a security problem fixed upstream
(CVE-2012-5642).
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-267
- openSUSE 12.2:
zypper in -t patch openSUSE-2013-267
- openSUSE 12.1:
zypper in -t patch openSUSE-2013-267
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (noarch):
fail2ban-0.8.8-2.4.1
- openSUSE 12.2 (noarch):
fail2ban-0.8.6-2.5.1
- openSUSE 12.1 (noarch):
fail2ban-0.8.4-16.6.1
References:
<http://support.novell.com/security/cve/CVE-2012-5642.html>
<https://bugzilla.novell.com/790557>
<https://bugzilla.novell.com/794953>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/3UDRNXWOPJKH3RJBIINB754DVRLKRZLS/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/3UDRNXWOPJKH3RJBIINB754DVRLKRZLS/#3UDRNXWOPJKH3RJBIINB754DVRLKRZLS)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from github.com_e9c870e6_20250126_071908.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2F83109bc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2F83109bc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fail2ban%2Ffail2ban)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fail2ban](/fail2ban)
/
**[fail2ban](/fail2ban/fail2ban)**
Public

* [Notifications](/login?return_to=%2Ffail2ban%2Ffail2ban) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Ffail2ban%2Ffail2ban)
* [Star
   13k](/login?return_to=%2Ffail2ban%2Ffail2ban)

* [Code](/fail2ban/fail2ban)
* [Issues
  145](/fail2ban/fail2ban/issues)
* [Pull requests
  99](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects
  0](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

Additional navigation options

* [Code](/fail2ban/fail2ban)
* [Issues](/fail2ban/fail2ban/issues)
* [Pull requests](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

## Commit

[Permalink](/fail2ban/fail2ban/commit/83109bce144f443a48ef31165a5389b7b83f4e0e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

BF: escape the content of <matches> since its value could contain arb…

[Browse files](/fail2ban/fail2ban/tree/83109bce144f443a48ef31165a5389b7b83f4e0e)
Browse the repository at this point in the history

```
…itrary symbols
```

* Loading branch information

[![@yarikoptic](https://avatars.githubusercontent.com/u/39889?s=40&v=4)](/yarikoptic)

[yarikoptic](/fail2ban/fail2ban/commits?author=yarikoptic "View all commits by yarikoptic")
committed
Oct 9, 2012

1 parent
[6ee2c0a](/fail2ban/fail2ban/commit/6ee2c0a01436daa2c95773b26852ba9d5dc52871)

commit 83109bc

Showing
**1 changed file**
with
**15 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

18 changes: 15 additions & 3 deletions

18
[server/action.py](#diff-d72a91a3dae74c8301d4830d46f377305cdfdbe1fc69eedcc4b85910c71e50b3 "server/action.py")

Show comments

[View file](/fail2ban/fail2ban/blob/83109bce144f443a48ef31165a5389b7b83f4e0e/server/action.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -230,7 +230,14 @@ def getActionStop(self): |
|  |  | def execActionStop(self): |
|  |  | stopCmd = Action.replaceTag(self.\_\_actionStop, self.\_\_cInfo) |
|  |  | return Action.executeCmd(stopCmd) |
|  |  |  |
|  |  |  |
|  |  | def escapeTag(tag): |
|  |  | for c in '\\#&;`|\*?~<>^()[]{}$\n': |
|  |  | if c in tag: |
|  |  | tag = tag.replace(c, '\\' + c) |
|  |  | return tag |
|  |  | escapeTag = staticmethod(escapeTag) |
|  |  |  |
|  |  | ## |
|  |  | # Replaces tags in query with property values in aInfo. |
|  |  | # |
| Expand All | | @@ -243,8 +250,13 @@ def replaceTag(query, aInfo): |
|  |  | """ Replace tags in query |
|  |  | """ |
|  |  | string = query |
|  |  | for tag in aInfo: |
|  |  | string = string.replace('<' + tag + '>', str(aInfo[tag])) |
|  |  | for tag, value in aInfo.iteritems(): |
|  |  | value = str(value) # assure string |
|  |  | if tag == 'matches': |
|  |  | # That one needs to be escaped since its content is |
|  |  | # out of our control |
|  |  | value = escapeTag(value) |
|  |  | string = string.replace('<' + tag + '>', value) |
|  |  | # New line |
|  |  | string = string.replace("<br>", '\n') |
|  |  | return string |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `83109bc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2F83109bc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.gentoo.org_fe345afe_20250126_071911.html ===

 [**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites

* [gentoo.org](https://www.gentoo.org/ "Gentoo's main website")
* [Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
* [Bugs](https://bugs.gentoo.org/ "Discover and report issues with Gentoo")
* [Packages](https://packages.gentoo.org/ "Find software to install")
* [Forums](https://forums.gentoo.org/ "Discuss with the community")
* [Planet](https://planet.gentoo.org/ "Find out what's going on in the dev community")
* [Archives](https://archives.gentoo.org/ "Read up on past discussions")
* [Devmanual](https://devmanual.gentoo.org/ "Read the development guide")
* [Gitweb](https://gitweb.gentoo.org/ "Browse our source code in Gitweb")
* [Infra status](https://infra-status.gentoo.org/ "Get updates on the services provided by the Gentoo infra team")

[![Gentoo Linux logo](https://assets.gentoo.org/tyrian/v1/site-logo.png)](/ "Back to the homepage")

Toggle navigation

* [Home](/)
* [Get started](/get-started/)
* [Downloads](/downloads/)
* [Inside Gentoo](/inside-gentoo/)
* [Support](/support/)
* [Get involved](/get-involved/)

* [Donate](/donate/)

Toggle secondary navigation

* [Mirrors](/downloads/mirrors/)
* [Signatures](/downloads/signatures/)

# Downloads

## [amd64 aka x86-64, x64, Intel 64](#amd64)

#### Boot media

[**Minimal Installation CD**
2025-01-19 601 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/install-amd64-minimal-20250119T170328Z.iso)
[**LiveGUI USB Image**
2025-01-19 3 GiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/livegui-amd64-20250119T170328Z.iso)
#### Stage archives

[**Stage 3** openrc
2025-01-19 225 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-openrc-20250119T170328Z.tar.xz)
[**Stage 3** systemd
2025-01-19 231 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-systemd-20250119T170328Z.tar.xz)
[**Stage 3** desktop profile | openrc
2025-01-19 761 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-desktop-openrc-20250119T170328Z.tar.xz)
[**Stage 3** desktop profile | systemd
2025-01-19 763 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-desktop-systemd-20250119T170328Z.tar.xz)
#### Details (contents, hashes, and signatures)

[Minimal Installation CD](https://distfiles.gentoo.org/releases/amd64/autobuilds/current-install-amd64-minimal/),
[Stage 3](https://distfiles.gentoo.org/releases/amd64/autobuilds/current-stage3-amd64-openrc/)

## [arm64 aka AArch64](#arm64)

#### Boot media

[**Minimal Installation CD** EFI
2025-01-19 589 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/install-arm64-minimal-20250119T234827Z.iso)

#### Stage archives

[**Stage 3** openrc
2025-01-19 206 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-openrc-20250119T234827Z.tar.xz)
[**Stage 3** systemd
2025-01-19 210 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-systemd-20250119T234827Z.tar.xz)
[**Stage 3** desktop profile | openrc
2025-01-19 553 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-desktop-openrc-20250119T234827Z.tar.xz)
[**Stage 3** desktop profile | systemd
2025-01-19 554 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-desktop-systemd-20250119T234827Z.tar.xz)
#### Details (contents, hashes, and signatures)

[Minimal Installation CD](https://distfiles.gentoo.org/releases/arm64/autobuilds/current-install-arm64-minimal/),
[Stage 3](https://distfiles.gentoo.org/releases/arm64/autobuilds/current-stage3-arm64-openrc/)

**What should I download? What do I do with these files?**

[Gentoo Handbook](https://wiki.gentoo.org/wiki/Handbook%3AMain_Page)

Please see the [Gentoo Handbook](https://wiki.gentoo.org/wiki/Handbook%3AMain_Page)
for the complete installation documentation.
It explains how you can find the right architecture for your machine and which files you need at what stage of the installation process.

In brief, a **stage 3** is a minimal set of Gentoo binaries that can upgrade and expand itself (but not much more, i.e., no kernel
or boot loader). The desktop version already contains additional programs needed in a typical desktop installation. The installation CD can be
used to boot and, well, install Gentoo.

## Advanced choices and other architectures

* [**amd64**](#amd64-advanced)
* [**alpha**](#alpha)
* [**arm**](#arm)
* [**arm64**](#arm64-advanced)
* [**hppa**](#hppa)
* [**loong**](#loong)
* [**mips**](#mips)
* [**m68k**](#m68k)
* [**ppc**](#ppc)
* [**riscv**](#riscv)
* [**s390**](#s390)
* [**sparc**](#sparc)
* [**x86**](#x86)

### [amd64 – Advanced choices](#amd64-advanced)

#### Processor compatibility

 **Processor compatibility**

The *amd64* architecture is intended for use on AMD 64-bit CPUs as well as 64-bit **Intel Pentium/Core/Xeon** processors.

#### Boot media

[**Minimal Installation CD** openrc
2025-01-19 601 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/install-amd64-minimal-20250119T170328Z.iso)
[**Admin CD** openrc
2025-01-19 787 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/admincd-amd64-20250119T170328Z.iso)
[**LiveGUI USB Image** openrc
2025-01-19 3 GiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/livegui-amd64-20250119T170328Z.iso)
[**QCOW2 disk (no root pw)** no multilib | systemd
2025-01-19 964 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/di-amd64-console-20250119T170328Z.qcow2)
[**QCOW2 disk (cloud-init)** no multilib | systemd
2025-01-19 980 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/di-amd64-cloudinit-20250119T170328Z.qcow2)

 **QCOW2 disk images**

The disk images are full bootable Gentoo installations in qemu's [QCOW2](https://www.qemu.org/docs/master/system/images.html) disk format.
They require UEFI support for booting. One variant comes with no network services and a password-less root account, the other
with access locked by default but [cloud-init](https://cloudinit.readthedocs.io/en/latest/) running on boot.

#### Stage archives

[**Stage 3** openrc
2025-01-19 225 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-openrc-20250119T170328Z.tar.xz)
[**Stage 3** desktop profile | openrc
2025-01-19 761 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-desktop-openrc-20250119T170328Z.tar.xz)
[**Stage 3** systemd
2025-01-19 231 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-systemd-20250119T170328Z.tar.xz)
[**Stage 3** desktop profile | systemd
2025-01-19 763 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-desktop-systemd-20250119T170328Z.tar.xz)
[**Stage 3** no multilib | openrc
2025-01-19 216 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-nomultilib-openrc-20250119T170328Z.tar.xz)
[**Stage 3** no multilib | systemd
2025-01-19 222 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-nomultilib-systemd-20250119T170328Z.tar.xz)
[**Stage 3** x32 | openrc
2025-01-19 243 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-x32-openrc-20250119T170328Z.tar.xz)
[**Stage 3** x32 | systemd
2025-01-19 252 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-x32-systemd-20250119T170328Z.tar.xz)

#### LLVM-based stage archives

[**Stage 3** llvm | openrc
2025-01-19 389 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-llvm-openrc-20250119T170328Z.tar.xz)
[**Stage 3** llvm | systemd
2025-01-19 395 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-llvm-systemd-20250119T170328Z.tar.xz)
#### Hardened stage archives

[**Hardened stage 3** openrc
2025-01-19 226 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-hardened-openrc-20250119T170328Z.tar.xz)
[**H/SELinux stage 3** openrc
2025-01-19 244 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-hardened-selinux-openrc-20250119T170328Z.tar.xz)
#### Musl stage archives

[**Stage 3** musl | openrc
2025-01-19 189 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-musl-20250119T170328Z.tar.xz)
[**Stage 3** musl | llvm | openrc
2025-01-19 218 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-musl-llvm-20250119T170328Z.tar.xz)
[**Hardened stage 3** musl | openrc
2025-01-19 189 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-musl-hardened-20250119T170328Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Split-usr stage archives

[**Stage 3** openrc | split-usr
2025-01-19 225 MiB](https://distfiles.gentoo.org/releases/amd64/autobuilds/20250119T170328Z/stage3-amd64-openrc-splitusr-20250119T170328Z.tar.xz)
#### Details (contents, hashes, and signatures)

* [Minimal Installation CD](https://distfiles.gentoo.org/releases/amd64/autobuilds/current-install-amd64-minimal/)
* [Stage 3](https://distfiles.gentoo.org/releases/amd64/autobuilds/current-stage3-amd64-openrc/)
* [All stages](https://distfiles.gentoo.org/releases/amd64/autobuilds/)

### [alpha](#alpha)

#### Boot media

[**Minimal Installation CD**
2025-01-23 224 MiB](https://distfiles.gentoo.org/releases/alpha/autobuilds/20250123T170332Z/install-alpha-minimal-20250123T170332Z.iso)
#### Stage archives

[**Stage 3** openrc
2025-01-23 222 MiB](https://distfiles.gentoo.org/releases/alpha/autobuilds/20250123T170332Z/stage3-alpha-openrc-20250123T170332Z.tar.xz)
[**Stage 3** systemd
2025-01-23 228 MiB](https://distfiles.gentoo.org/releases/alpha/autobuilds/20250123T170332Z/stage3-alpha-systemd-20250123T170332Z.tar.xz)

#### Details (contents, hashes, and signatures)

* [Minimal Installation CD](https://distfiles.gentoo.org/releases/alpha/autobuilds/current-install-alpha-minimal/)
* [All files](https://distfiles.gentoo.org/releases/alpha/autobuilds/)

### [arm](#arm)

#### Processor compatibility

 **Processor compatibility**

For details of the *arm* architecture, please see [the
corresponding wikipedia page](https://en.wikipedia.org/wiki/ARM_architecture_family). Note that in Gentoo *arm* refers to 32bit variants; the 64bit variants
can be found as *arm64*.

#### ARMv4tl stage archives

[**Stage 3** ARMv4tl | openrc
2025-01-22 191 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv4tl-openrc-20250122T235305Z.tar.xz)
[**Stage 3** ARMv4tl | systemd
2025-01-22 198 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv4tl-systemd-20250122T235305Z.tar.xz)
#### ARMv5tel stage archives

[**Stage 3** ARMv5tel | openrc
2025-01-22 191 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv5tel-openrc-20250122T235305Z.tar.xz)
[**Stage 3** ARMv5tel | systemd
2025-01-22 197 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv5tel-systemd-20250122T235305Z.tar.xz)
#### ARMv6j stage archives

[**Stage 3** ARMv6j | HardFP | openrc
2025-01-22 191 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv6j_hardfp-openrc-20250122T235305Z.tar.xz)
[**Stage 3** ARMv6j | HardFP | systemd
2025-01-22 196 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv6j_hardfp-systemd-20250122T235305Z.tar.xz)
[**Stage 3** ARMv6j | openrc
2025-01-22 191 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv6j-openrc-20250122T235305Z.tar.xz)
[**Stage 3** ARMv6j | systemd
2025-01-22 196 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv6j-systemd-20250122T235305Z.tar.xz)

#### ARMv7a stage archives

[**Stage 3** ARMv7a | HardFP | openrc
2025-01-22 191 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv7a_hardfp-openrc-20250122T235305Z.tar.xz)
[**Stage 3** ARMv7a | HardFP | systemd
2025-01-22 195 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv7a_hardfp-systemd-20250122T235305Z.tar.xz)
[**Stage 3** ARMv7a | openrc
2025-01-22 191 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv7a-openrc-20250122T235305Z.tar.xz)
[**Stage 3** ARMv7a | systemd
2025-01-22 196 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv7a-systemd-20250122T235305Z.tar.xz)
#### Musl stage archives

[**Stage 3** ARMv6j | HardFP | openrc | musl
2025-01-22 167 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv6j_hardfp_musl-openrc-20250122T235305Z.tar.xz)
[**Hardened Stage 3** ARMv6j | HardFP | openrc | musl
2025-01-22 167 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv6j_hardfp_musl-hardened-openrc-20250122T235305Z.tar.xz)
[**Stage 3** ARMv7a | HardFP | openrc | musl
2025-01-22 165 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv7a_hardfp_musl-openrc-20250122T235305Z.tar.xz)
[**Hardened Stage 3** ARMv7a | HardFP | openrc | musl
2025-01-22 166 MiB](https://distfiles.gentoo.org/releases/arm/autobuilds/20250122T235305Z/stage3-armv7a_hardfp_musl-hardened-openrc-20250122T235305Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Details (contents, hashes, and signatures)

* [All files](https://distfiles.gentoo.org/releases/arm/autobuilds/)

### [arm64](#arm64-advanced)

#### Boot media

[**Minimal Installation CD** EFI | openrc
2025-01-19 589 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/install-arm64-minimal-20250119T234827Z.iso)
[**QCOW2 disk (no root pw)** EFI | systemd
2025-01-19 908 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/di-arm64-console-20250119T234827Z.qcow2)
[**QCOW2 disk (cloud-init)** EFI | systemd
2025-01-19 924 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/di-arm64-cloudinit-20250119T234827Z.qcow2)
#### Stage archives

[**Stage 3** openrc
2025-01-19 206 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-openrc-20250119T234827Z.tar.xz)
[**Stage 3** desktop profile | openrc
2025-01-19 553 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-desktop-openrc-20250119T234827Z.tar.xz)
[**Stage 3** systemd
2025-01-19 210 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-systemd-20250119T234827Z.tar.xz)
[**Stage 3** desktop profile | systemd
2025-01-19 554 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-desktop-systemd-20250119T234827Z.tar.xz)
#### LLVM-based stage archives

[**Stage 3** llvm | openrc
2025-01-19 297 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-llvm-openrc-20250119T234827Z.tar.xz)
[**Stage 3** llvm | systemd
2025-01-19 303 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-llvm-systemd-20250119T234827Z.tar.xz)

#### Musl stage archives

[**Stage 3** musl | openrc
2025-01-19 178 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-musl-20250119T234827Z.tar.xz)
[**Stage 3** musl | llvm | openrc
2025-01-19 203 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-musl-llvm-20250119T234827Z.tar.xz)
[**Hardened Stage 3** musl | openrc
2025-01-19 179 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-musl-hardened-20250119T234827Z.tar.xz)
#### Big-Endian Stage archives

[**Stage 3** eb | openrc
2024-10-12 207 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20241012T164823Z/stage3-aarch64_be-openrc-20241012T164823Z.tar.xz)
[**Stage 3** eb | systemd
2024-10-12 213 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20241012T164823Z/stage3-aarch64_be-systemd-20241012T164823Z.tar.xz)
#### Split-usr stage archives

[**Stage 3** openrc | split-usr
2025-01-19 205 MiB](https://distfiles.gentoo.org/releases/arm64/autobuilds/20250119T234827Z/stage3-arm64-openrc-splitusr-20250119T234827Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Details (contents, hashes, and signatures)

* [All files](https://distfiles.gentoo.org/releases/arm64/autobuilds/)

### [hppa](#hppa)

#### Boot media

[**Minimal Installation CD**
2023-04-18 158 MiB](https://distfiles.gentoo.org/releases/hppa/autobuilds/20230418T174657Z/install-hppa-minimal-20230418T174657Z.iso)
[**Netboot** HPPA32
2023-04-18 20 MiB](https://distfiles.gentoo.org/releases/hppa/autobuilds/20230418T174657Z/netboot-hppa32-20230418T174657Z.lif)
[**Netboot** HPPA64
2019-11-01 21 MiB](https://distfiles.gentoo.org/releases/hppa/autobuilds/20191101T093009Z/netboot-hppa64-20191101T093009Z.lif)
#### HPPA 1.1 stage archives

[**Stage 3** HPPA 1.1 | openrc
2024-12-31 204 MiB](https://distfiles.gentoo.org/releases/hppa/autobuilds/20241231T084836Z/stage3-hppa1.1-openrc-20241231T084836Z.tar.xz)
[**Stage 3** HPPA 1.1 | systemd
2024-12-31 226 MiB](https://distfiles.gentoo.org/releases/hppa/autobuilds/20241231T084836Z/stage3-hppa1.1-systemd-20241231T084836Z.tar.xz)

#### HPPA 2.0 stage archives

[**Stage 3** HPPA 2.0 | openrc
2024-12-24 200 MiB](https://distfiles.gentoo.org/releases/hppa/autobuilds/20241224T074835Z/stage3-hppa2.0-openrc-20241224T074835Z.tar.xz)
[**Stage 3** HPPA 2.0 | systemd
2024-12-24 221 MiB](https://distfiles.gentoo.org/releases/hppa/autobuilds/20241224T074835Z/stage3-hppa2.0-systemd-20241224T074835Z.tar.xz)
#### Details (contents, hashes, and signatures)

* [All files](https://distfiles.gentoo.org/releases/hppa/autobuilds/)

### [loong](#loong)

#### Stage archives

[**Stage 3** openrc
2025-01-21 223 MiB](https://distfiles.gentoo.org/releases/loong/autobuilds/20250121T170408Z/stage3-loong-openrc-20250121T170408Z.tar.xz)
[**Stage 3** systemd
2025-01-21 229 MiB](https://distfiles.gentoo.org/releases/loong/autobuilds/20250121T170408Z/stage3-loong-systemd-20250121T170408Z.tar.xz)

#### Details (contents, hashes, and signatures)

* [All files](https://distfiles.gentoo.org/releases/loong/autobuilds/)

### [mips](#mips)

#### Processor compatibility

 **Processor compatibility**

For details of the *mips* architecture, please see [the
corresponding wikipedia page](https://en.wikipedia.org/wiki/MIPS_architecture).

#### Stage archives, little-endian O32

[**Stage 3** mips2 | o32 | sf | el | openrc
2025-01-18 216 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mipsel2_softfloat-openrc-20250118T031820Z.tar.xz)
[**Stage 3** mips2 | o32 | sf | el | systemd
2025-01-18 221 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mipsel2_softfloat-systemd-20250118T031820Z.tar.xz)
[**Stage 3** mips2 | o32 | el | openrc
2025-01-18 216 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mipsel2-openrc-20250118T031820Z.tar.xz)
[**Stage 3** mips2 | o32 | el | systemd
2025-01-18 220 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mipsel2-systemd-20250118T031820Z.tar.xz)
#### Stage archives, big-endian O32

[**Stage 3** mips2 | o32 | sf | eb | openrc
2025-01-18 214 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mips2_softfloat-openrc-20250118T031820Z.tar.xz)
[**Stage 3** mips2 | o32 | sf | eb | systemd
2025-01-18 219 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mips2_softfloat-systemd-20250118T031820Z.tar.xz)
[**Stage 3** mips2 | o32 | eb | openrc
2025-01-18 214 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mips2-openrc-20250118T031820Z.tar.xz)
[**Stage 3** mips2 | o32 | eb | systemd
2025-01-18 219 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mips2-systemd-20250118T031820Z.tar.xz)
#### Stage archives, little-endian N32

[**Stage 3** mips3 | n32 | el | openrc
2025-01-20 213 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250120T044844Z/stage3-mipsel3_n32-openrc-20250120T044844Z.tar.xz)
[**Stage 3** mips3 | n32 | el | systemd
2025-01-20 218 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250120T044844Z/stage3-mipsel3_n32-systemd-20250120T044844Z.tar.xz)
#### Stage archives, big-endian N32

[**Stage 3** mips3 | n32 | eb | openrc
2025-01-20 212 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250120T044844Z/stage3-mips3_n32-openrc-20250120T044844Z.tar.xz)
[**Stage 3** mips3 | n32 | eb | systemd
2025-01-20 217 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250120T044844Z/stage3-mips3_n32-systemd-20250120T044844Z.tar.xz)

#### Stage archives, little-endian N64

[**Stage 3** mips3 | n64 | el | openrc
2025-01-21 215 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250121T050347Z/stage3-mipsel3_n64-openrc-20250121T050347Z.tar.xz)
[**Stage 3** mips3 | n64 | el | systemd
2025-01-21 220 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250121T050347Z/stage3-mipsel3_n64-systemd-20250121T050347Z.tar.xz)
#### Stage archives, big-endian N64

[**Stage 3** mips3 | n64 | eb | openrc
2025-01-21 214 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250121T050347Z/stage3-mips3_n64-openrc-20250121T050347Z.tar.xz)
[**Stage 3** mips3 | n64 | eb | systemd
2025-01-21 219 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250121T050347Z/stage3-mips3_n64-systemd-20250121T050347Z.tar.xz)
#### Stage archives, little-endian multilib

[**Stage 3** mips3 | n32 | multilib | el | openrc
2025-01-23 222 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250123T041832Z/stage3-mipsel3_multilib-openrc-20250123T041832Z.tar.xz)
[**Stage 3** mips3 | n32 | multilib | el | systemd
2025-01-23 228 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250123T041832Z/stage3-mipsel3_multilib-systemd-20250123T041832Z.tar.xz)
#### Stage archives, big-endian multilib

[**Stage 3** mips3 | n32 | multilib | eb | openrc
2025-01-23 221 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250123T041832Z/stage3-mips3_multilib-openrc-20250123T041832Z.tar.xz)
[**Stage 3** mips3 | n32 | multilib | eb | systemd
2025-01-23 226 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250123T041832Z/stage3-mips3_multilib-systemd-20250123T041832Z.tar.xz)
#### Musl stage archives

[**Stage 3** mips2 | o32 | musl | el | openrc
2025-01-18 189 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mipsel2_musl-20250118T031820Z.tar.xz)
[**Stage 3** mips2 | o32 | musl | eb | openrc
2025-01-18 188 MiB](https://distfiles.gentoo.org/releases/mips/autobuilds/20250118T031820Z/stage3-mips2_musl-20250118T031820Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Details (contents, hashes, and signatures)

[All files](https://distfiles.gentoo.org/releases/mips/autobuilds/)

### [m68k](#m68k)

#### Stage archives

[**Stage 3** openrc
2025-01-22 193 MiB](https://distfiles.gentoo.org/releases/m68k/autobuilds/20250122T164834Z/stage3-m68k-openrc-20250122T164834Z.tar.xz)
[**Stage 3** systemd
2025-01-22 198 MiB](https://distfiles.gentoo.org/releases/m68k/autobuilds/20250122T164834Z/stage3-m68k-systemd-20250122T164834Z.tar.xz)
#### Musl stage archives

[**Stage 3** musl | openrc
2024-05-15 199 MiB](https://distfiles.gentoo.org/releases/m68k/autobuilds/20240515T165044Z/stage3-m68k_musl-20240515T165044Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Details (contents, hashes, and signatures)

* [All files](https://distfiles.gentoo.org/releases/m68k/autobuilds/)

### [ppc](#ppc)

#### Processor compatibility

 **Processor compatibility**

PowerPC CPUs can operate in two modes: *big-endian* and *little-endian*.

* The **ppc** and **ppc64** stages are *big-endian* stages and can be used with *any PowerPC* CPU, including some old Apple™ hardware.
* The **ppc64le** stages are *little-endian* stages and are created for running on *POWER8 and newer* CPUs.
* The **power9le** stages are *little-endian* stages optimized exclusively for *POWER9* CPUs.

#### Boot media

[**PPC/PPC64 Minimal Installation CD**
2025-01-23 346 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250123T030332Z/install-powerpc-minimal-20250123T030332Z.iso)
[**PPC64LE Minimal Installation CD**
2025-01-22 761 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/install-ppc64le-minimal-20250122T013331Z.iso)
#### Stage archives, big-endian ppc and ppc64

[**PPC stage 3** openrc
2025-01-23 204 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250123T030332Z/stage3-ppc-openrc-20250123T030332Z.tar.xz)
[**PPC stage 3** systemd
2025-01-23 210 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250123T030332Z/stage3-ppc-systemd-20250123T030332Z.tar.xz)
[**PPC64 stage 3** openrc
2025-01-23 205 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250123T030332Z/stage3-ppc64-openrc-20250123T030332Z.tar.xz)
[**PPC64 stage 3** systemd
2025-01-23 211 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250123T030332Z/stage3-ppc64-systemd-20250123T030332Z.tar.xz)

#### Stage archives, little-endian ppc64le

[**PPC64LE stage 3** openrc
2025-01-22 211 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/stage3-ppc64le-openrc-20250122T013331Z.tar.xz)
[**PPC64LE stage 3** systemd
2025-01-22 218 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/stage3-ppc64le-systemd-20250122T013331Z.tar.xz)
[**PPC64LE stage 3** power9 | openrc
2025-01-22 210 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/stage3-power9le-openrc-20250122T013331Z.tar.xz)
[**PPC64LE stage 3** power9 | desktop profile | openrc
2025-01-22 641 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/stage3-power9le-desktop-openrc-20250122T013331Z.tar.xz)
[**PPC64LE stage 3** power9 | systemd
2025-01-22 216 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/stage3-power9le-systemd-20250122T013331Z.tar.xz)
[**PPC64LE stage 3** power9 | desktop profile | systemd
 0 B](https://distfiles.gentoo.org/releases/ppc/autobuilds/)
#### Hardened / musl stage archives

[**PPC stage 3** musl | openrc
2025-01-23 179 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250123T030332Z/stage3-ppc-musl-hardened-openrc-20250123T030332Z.tar.xz)
[**PPC64 stage 3** musl | openrc
2025-01-23 177 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250123T030332Z/stage3-ppc64-musl-hardened-openrc-20250123T030332Z.tar.xz)
[**PPC64LE stage 3** musl | openrc
2025-01-22 183 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/stage3-ppc64le-musl-hardened-openrc-20250122T013331Z.tar.xz)
[**PPC64LE stage 3** musl | openrc | power9
2025-01-22 182 MiB](https://distfiles.gentoo.org/releases/ppc/autobuilds/20250122T013331Z/stage3-power9le-musl-hardened-openrc-20250122T013331Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Details (contents, hashes, and signatures)

* [All files](https://distfiles.gentoo.org/releases/ppc/autobuilds/)

### [riscv](#riscv)

#### Processor compatibility

 **Processor compatibility**

The *lp64d* stages can be used on all 64-bit RISC-V processors supporting the **double-precision floating point** instruction set.
The *lp64* stages can be used on all 64-bit RISC-V processors; they require no hardware support for floating point arithmetics.
Multilib stages include toolchain support for all 64-bit and 32-bit ABI and are based on lp64d. They are mostly useful for development and testing purposes.

The *ilp32d* stages can be used on all 32-bit RISC-V processors supporting the **double-precision floating point** instruction set.
The *ilp32* stages can be used on all 32-bit RISC-V processors; they require no hardware support for floating point arithmetics.

#### Stage archives (RV64)

[**Stage 3** rv64gc | lp64d | openrc
2025-01-24 254 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250124T163402Z/stage3-rv64_lp64d-openrc-20250124T163402Z.tar.xz)
[**Stage 3** rv64gc | lp64d | systemd
2025-01-24 260 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250124T163402Z/stage3-rv64_lp64d-systemd-20250124T163402Z.tar.xz)
[**Stage 3** rv64gc | lp64 | openrc
2025-01-16 254 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv64_lp64-openrc-20250116T141832Z.tar.xz)
[**Stage 3** rv64gc | lp64 | systemd
2025-01-16 260 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv64_lp64-systemd-20250116T141832Z.tar.xz)
[**Stage 3** rv64gc | multilib | openrc
2025-01-16 300 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv64_multilib-openrc-20250116T141832Z.tar.xz)
[**Stage 3** rv64gc | multilib | systemd
2025-01-16 305 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv64_multilib-systemd-20250116T141832Z.tar.xz)

#### Stage archives (RV32)

[**Stage 3** rv32gc | ilp32d | openrc
2025-01-16 250 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv32_ilp32d-openrc-20250116T141832Z.tar.xz)
[**Stage 3** rv32gc | ilp32d | systemd
2025-01-16 256 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv32_ilp32d-systemd-20250116T141832Z.tar.xz)
[**Stage 3** rv32gc | ilp32 | openrc
2025-01-16 251 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv32_ilp32-openrc-20250116T141832Z.tar.xz)
[**Stage 3** rv32gc | ilp32 | systemd
2025-01-16 256 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv32_ilp32-systemd-20250116T141832Z.tar.xz)
#### Musl stage archives

[**Stage 3** rv64gc | lp64d | musl | openrc
2025-01-24 227 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250124T163402Z/stage3-rv64_lp64d_musl-20250124T163402Z.tar.xz)
[**Stage 3** rv64gc | lp64 | musl | openrc
2025-01-16 227 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv64_lp64_musl-20250116T141832Z.tar.xz)
[**Stage 3** rv32gc | ilp32d | musl | openrc
2025-01-16 223 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv32_ilp32d_musl-20250116T141832Z.tar.xz)
[**Stage 3** rv32gc | ilp32 | musl | openrc
2025-01-16 223 MiB](https://distfiles.gentoo.org/releases/riscv/autobuilds/20250116T141832Z/stage3-rv32_ilp32_musl-20250116T141832Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Details (contents, hashes, and signatures)

[All files](https://distfiles.gentoo.org/releases/riscv/autobuilds/)

### [s390](#s390)

#### Boot media

[**Netboot initramfs** s390
2025-01-25 9 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250125T083403Z/netboot-s390-initramfs-20250125T083403Z)
[**Netboot kernel** s390
2025-01-21 3 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250121T214829Z/netboot-s390-kernel-20250121T214829Z)
[**Netboot initramfs** s390x
2025-01-25 9 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250125T083403Z/netboot-s390x-initramfs-20250125T083403Z)
[**Netboot kernel** s390x
2025-01-25 3 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250125T083403Z/netboot-s390x-kernel-20250125T083403Z)
#### Stage archives

[**Stage 3** s390 | openrc
2025-01-25 240 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250125T083403Z/stage3-s390-openrc-20250125T083403Z.tar.xz)
[**Stage 3** s390 | systemd
2025-01-25 246 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250125T083403Z/stage3-s390-systemd-20250125T083403Z.tar.xz)
[**Stage 3** s390x | openrc
2025-01-25 243 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250125T083403Z/stage3-s390x-openrc-20250125T083403Z.tar.xz)
[**Stage 3** s390x | systemd
2025-01-25 249 MiB](https://distfiles.gentoo.org/releases/s390/autobuilds/20250125T083403Z/stage3-s390x-systemd-20250125T083403Z.tar.xz)

#### Details (contents, hashes, and signatures)

* [All files](https://distfiles.gentoo.org/releases/s390/autobuilds/)

### [sparc](#sparc)

#### Boot media

[**Minimal Installation CD**
2025-01-20 414 MiB](https://distfiles.gentoo.org/releases/sparc/autobuilds/20250120T103338Z/install-sparc64-minimal-20250120T103338Z.iso)
#### Stage archives

[**Stage 3 (64-bit userland)** openrc
2025-01-20 199 MiB](https://distfiles.gentoo.org/releases/sparc/autobuilds/20250120T103338Z/stage3-sparc64-openrc-20250120T103338Z.tar.xz)
[**Stage 3 (64-bit userland)** systemd
2025-01-20 204 MiB](https://distfiles.gentoo.org/releases/sparc/autobuilds/20250120T103338Z/stage3-sparc64-systemd-20250120T103338Z.tar.xz)
[**Stage 3 (32-bit userland)** openrc
2025-01-20 194 MiB](https://distfiles.gentoo.org/releases/sparc/autobuilds/20250120T103338Z/stage3-sparc-openrc-20250120T103338Z.tar.xz)
[**Stage 3 (32-bit userland)** systemd
2025-01-20 198 MiB](https://distfiles.gentoo.org/releases/sparc/autobuilds/20250120T103338Z/stage3-sparc-systemd-20250120T103338Z.tar.xz)

#### Details (contents, hashes, and signatures)

* [Minimal Installation CD](https://distfiles.gentoo.org/releases/sparc/autobuilds/current-install-sparc64-minimal/)
* [All files](https://distfiles.gentoo.org/releases/sparc/autobuilds/)

### [x86](#x86)

#### Processor compatibility

 **Processor compatibility**

There are two builds of the *x86* architecture: *i486* and *i686*.

#### Boot media

[**Minimal Installation CD**
2025-01-13 536 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20250113T163325Z/install-x86-minimal-20250113T163325Z.iso)
[**Admin CD**
2024-12-09 676 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20241209T170323Z/admincd-x86-20241209T170323Z.iso)
#### Stage archives

[**Stage 3** i686 | openrc
2025-01-20 219 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20250120T170329Z/stage3-i686-openrc-20250120T170329Z.tar.xz)
[**Stage 3** i686 | systemd
2025-01-20 224 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20250120T170329Z/stage3-i686-systemd-20250120T170329Z.tar.xz)
[**Stage 3** i486 | openrc
2025-01-20 220 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20250120T170329Z/stage3-i486-openrc-20250120T170329Z.tar.xz)
[**Stage 3** i486 | systemd
2025-01-20 226 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20250120T170329Z/stage3-i486-systemd-20250120T170329Z.tar.xz)

#### Hardened stage archives

[**Hardened stage 3** i686 | openrc
2025-01-20 219 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20250120T170329Z/stage3-i686-hardened-openrc-20250120T170329Z.tar.xz)
#### Musl stage archives

[**Stage 3** i686 | openrc | musl
2025-01-20 191 MiB](https://distfiles.gentoo.org/releases/x86/autobuilds/20250120T170329Z/stage3-i686-musl-20250120T170329Z.tar.xz)

 **Musl stages**

For additional information on using musl based Gentoo systems please see the [Musl usage guide](https://wiki.gentoo.org/wiki/Musl_usage_guide).

#### Details (contents, hashes, and signatures)

* [Minimal Installation CD](https://distfiles.gentoo.org/releases/x86/autobuilds/current-install-x86-minimal/)
* [All files](https://distfiles.gentoo.org/releases/x86/autobuilds/)

## Experimental downloads

For additional highly experimental downloads across all architectures
please refer to the [complete
experimental downloads archive](https://distfiles.gentoo.org/experimental/). Hic sunt dracones.[#](https://en.wikipedia.org/wiki/Here_be_dragons)

### Questions or comments?

Please feel free to [contact us](/inside-gentoo/contact/).

### [Home](/)

* [News](/news/)

### [Get Started](/get-started/)

* [About Gentoo](/get-started/about/)
* [Philosophy](/get-started/philosophy/)
* [Screenshots](/get-started/screenshots/)
* [FAQ](https://wiki.gentoo.org/wiki/FAQ)

### [Downloads](/downloads/)

* [Mirrors](/downloads/mirrors/)
* [Signatures](/downloads/signatures/)

### [Inside Gentoo](/inside-gentoo/)

* [Developers](/inside-gentoo/developers/)
* [Projects](https://wiki.gentoo.org/wiki/Project%3AGentoo)
* [GLEPs](/glep/)
* [Artwork](/inside-gentoo/artwork/)
* [Gentoo Foundation](/inside-gentoo/foundation/)
* [Sponsors](/inside-gentoo/sponsors/)
* [Stores](/inside-gentoo/stores/)
* [Contact](/inside-gentoo/contact/)

### [Support](/support/)

* [Consulting](/support/consulting/)
* [Documentation](/support/documentation/)
* [Package database](https://packages.gentoo.org/)
* [Repository news items](/support/news-items/)
* [Security](/support/security/)
* [USE flags](/support/use-flags/)
* [rsync mirrors](/support/rsync-mirrors/)

### [Get Involved](/get-involved/)

* [IRC channels](/get-involved/irc-channels/)
* [Forums](https://forums.gentoo.org/)
* [Mailing lists](/get-involved/mailing-lists/)
* [Contribute](/get-involved/contribute/)
* [Become a developer](/get-involved/become-developer/)
* [Get the code](/get-involved/get-code/)

[Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)

**© 2001-2025 Gentoo Authors**

Gentoo is a trademark of the Gentoo Foundation, Inc. and of FÃ¶rderverein Gentoo e.V.
The contents of this document, unless otherwise expressly stated, are licensed under the
[CC-BY-SA-4.0](https://creativecommons.org/licenses/by-sa/4.0/) license.
The [Gentoo Name and Logo Usage Guidelines](/inside-gentoo/foundation/name-logo-guidelines.html) apply.

**Version**



=== Content from raw.github.com_9017a7c2_20250125_073925.html ===

\_\_ \_ \_ \_\_\_ \_
/ \_|\_\_ \_(\_) |\_ ) |\_\_ \_\_ \_ \_ \_
| \_/ \_` | | |/ /| '\_ \/ \_` | ' \
|\_| \\_\_,\_|\_|\_/\_\_\_|\_.\_\_/\\_\_,\_|\_||\_|
Fail2Ban: Changelog
===================
ver. 1.1.1-dev-1 (20??/??/??) - development nightly edition
-----------
### Fixes
\* `jail.conf`:
- default banactions need to be specified in `paths-\*.conf` (maintainer level) now
- since stock fail2ban includes `paths-debian.conf` by default, banactions are `nftables`
(can be overwritten in `jail.local` by user)
\* `paths-debian.conf`:
- default banactions are `nftables`
- sshd backend switched to `systemd` (gh-3292)
\* `action.d/firewallcmd-ipset.conf`:
- rename `ipsettype` to `ipsetbackend` (gh-2620), parameter `ipsettype` will be used now to the real set type (gh-3760)
\* `filter.d/apache-overflows.conf` - consider AH10244: invalid URI path (gh-3778)
\* `filter.d/freeswitch.conf` - bypass some new info in prefix before [WARNING] (changed default `\_pref\_line`),
FreeSWITCH log line prefix has changed in newer versions (gh-3143)
\* `filter.d/postfix.conf` - consider CONNECT and other rejected commands as a valid `\_pref` (gh-3800)
\* `filter.d/dropbear.conf`:
- recognizes extra pid/timestamp if logged into stdout/journal, added `journalmatch` (gh-3597)
- failregex extended to match different format of "Exit before auth" message (gh-3791)
\* `filter.d/recidive.conf` - restore possibility to set jail name in the filter, \_jailname is positive now (gh-3769)
\* `filter.d/roundcube-auth.conf` - improved RE better matching log format of roundcube version 1.4+ (gh-3816)
\* `filter.d/sshd.conf`:
- adapted to conform possible new daemon name sshd-session, since OpenSSH 9.8
several log messages will be tagged with as originating from a process named "sshd-session" rather than "sshd" (gh-3782)
- `ddos` and `aggressive` modes: regex extended for timeout before authentication (optional connection from part, gh-3907)
### New Features and Enhancements
\* new jail option `skip\_if\_nologs` to ignore jail if no `logpath` matches found, fail2ban continue to start with warnings/errors,
thus other jails become running (gh-2756)
\* `action.d/\*-ipset.conf`:
- parameter `ipsettype` to set type of ipset, e. g. hash:ip, hash:net, etc (gh-3760)
\* `action.d/firewallcmd-rich-\*.conf` - fixed incorrect quoting, disabling port variable expansion
by substitution of rich rule (gh-3815)
\* `filter.d/proxmox.conf` - add support to Proxmox Web GUI (gh-2966)
ver. 1.1.0 (2024/04/25) - object-found--norad-59479-cospar-2024-069a--altitude-36267km
-----------
### Compatibility
\* the minimum supported python version is now 3.5, if you have previous python version
you can use the 0.11 or 1.0 version of fail2ban or upgrade python (or even build it from source).
### Fixes
\* circumvent SEGFAULT in a python's socket module by getaddrinfo with disabled IPv6 (gh-3438)
\* avoid sporadic error in pyinotify backend if pending file deleted in other thread, e. g. by flushing logs (gh-3635)
\* `action.d/cloudflare-token.conf` - fixes gh-3479, url-encode args by unban
\* `action.d/\*ipset\*`: make `maxelem` ipset option configurable through banaction arguments (gh-3564)
\* `filter.d/apache-common.conf` - accepts remote besides client (gh-3622)
\* `filter.d/mysqld-auth.conf` - matches also if no suffix in message (mariadb 10.3 log format, gh-3603)
\* `filter.d/nginx-\*.conf` - nginx error-log filters extended with support of journal format (gh-3646)
\* `filter.d/postfix.conf`:
- "rejected" rule extended to match "Access denied" too (gh-3474)
- avoid double counting ('lost connection after AUTH' together with message 'disconnect ...', gh-3505)
- add Sender address rejected: Malformed DNS server reply (gh-3590)
- add to postfix syslog daemon format (gh-3690)
- change journalmatch postfix, allow sub-units with postfix@-.service (gh-3692)
\* `filter.d/recidive.conf`: support for systemd-journal, conditional RE depending on logtype (for file or journal, gh-3693)
\* `filter.d/slapd.conf` - filter rewritten for single-line processing, matches errored result without `text=...` (gh-3604)
### New Features and Enhancements
\* supports python 3.12 and 3.13 (gh-3487)
\* bundling async modules removed in python 3.12+ (fallback to local libraries pyasyncore/pyasynchat if import would miss them, gh-3487)
\* `fail2ban-client` extended (gh-2975):
- `fail2ban-client status --all [flavor]` - returns status of fail2ban and all jails in usual form
- `fail2ban-client stats` - returns statistic in form of table (jail, backend, found and banned counts)
- `fail2ban-client statistic` or `fail2ban-client statistics` - same as `fail2ban-client stats` (aliases for stats)
- `fail2ban-client status --all stats` - (undocumented, flavor "stats") returns statistic of all jails in form of python dict
\* `fail2ban-regex` extended to load settings from jail (by simple name it'd prefer jail to the filter now, gh-2655);
to load the settings from filter one could use:
```diff
- fail2ban-regex ... sshd ; # jail
+ fail2ban-regex ... sshd.conf ; # filter
# or:
+ fail2ban-regex ... filter.d/sshd ; # filter
```
\* better auto-detection for IPv6 support (`allowipv6 = auto` by default), trying to check sysctl net.ipv6.conf.all.disable\_ipv6
(value read from `/proc/sys/net/ipv6/conf/all/disable\_ipv6`) if available, otherwise seeks over local IPv6 from network interfaces
if available for platform and uses DNS to find local IPv6 as a fallback only
\* improve `ignoreself` by considering all local addresses from network interfaces additionally to IPs from hostnames (gh-3132)
\* `action.d/mikrotik.conf` - new action for mikrotik routerOS, adds and removes entries from address lists on the router (gh-2860)
\* `action.d/pf.conf` - pf action extended with support of `protocol=all` (gh-3503)
\* `action.d/smtp.py` - added optional support for TLS connections via the `ssl` arg.
\* `filter.d/dante.conf` - new filter for Dante SOCKS server (gh-2112)
\* `filter.d/exim.conf`, `filter.d/exim-spam.conf`:
- messages are prefiltered by `prefregex` now
- filter can bypass additional timestamp or pid that may be logged via systemd-journal or syslog-ng (gh-3060)
- rewrite host line regex for all varied exim's log\_selector states (gh-3263, gh-3701, gh-3702)
- fixed "dropped: too many ..." regex, also matching unrecognized commands now (gh-3502)
\* `filter.d/named-refused.conf` - denied allows any reason in parenthesis as suffix (gh-3697)
\* `filter.d/nginx-forbidden.conf` - new filter to ban forbidden locations, e. g. using `deny` directive (gh-2226)
\* `filter.d/routeros-auth.conf` - new filter detecting failed login attempts in the log produced by MikroTik RouterOS
\* `filter.d/sshd.conf`:
- avoid double counting for "maximum authentication attempts exceeded" (gh-3502)
- message "Disconnecting ... Too many authentication failures" is not a failure anymore
- mode `ddos`/`aggressive` extended to match new messages caused by port scanner, wrong payload on ssh port (gh-3486):
\* message authentication code incorrect [preauth]
\* connection corrupted [preauth]
\* timeout before authentication
ver. 1.0.2 (2022/11/09) - finally-war-game-test-tape-not-a-nuclear-alarm
-----------
### Fixes
\* backend `systemd`: code review and several fixes:
- wait only if it is necessary, e. g. in operational mode and if no more entries retrieved (end of journal);
- ensure we give enough time after possible rotation, vacuuming or adding/removing journal files,
and move cursor back and forth to avoid entering dead space
\* `filter.d/named-refused.conf`:
- support BIND named log categories, gh-3388
- allow `info:` as possible error prefix too ("query (cache) denied" may occur as info)
\* `filter.d/dovecot.conf`:
- fixes regression introduced in gh-3210: resolve extremely long search by repeated apply of non-greedy RE-part
with following branches (it may be extremely slow up to infinite search depending on message), gh-3370
- fixes regression and matches new format in aggressive mode too (amend to gh-3210)
### New Features and Enhancements
ver. 1.0.1 (2022/09/27) - energy-equals-mass-times-the-speed-of-light-squared
-----------
### Compatibility
\* the minimum supported python version is now 2.7, if you have previous python version
you can use the 0.11 version of fail2ban or upgrade python (or even build it from source).
\* potential incompatibility by parsing of options of `backend`, `filter` and `action` parameters (if they
are partially incorrect), because fail2ban could throw an error now (doesn't silently bypass it anymore).
\* due to fix for CVE-2021-32749 (GHSA-m985-3f3v-cwmm) the mailing action using mailutils may require extra configuration,
if it is not compatible or doesn't support `-E 'set escape'` (e. g. with `mailcmd` parameter), see gh-3059
\* automatic invocation of 2to3 is removed in setup now (gh-3098), there is also no option `--disable-2to3` anymore,
`./fail2ban-2to3` should be called outside before setup
\* to v.0.11:
- due to change of `actioncheck` behavior (gh-488), some actions can be incompatible as regards
the invariant check, if `actionban` or `actionunban` would not throw an error (exit code
different from 0) in case of unsane environment.
- actions that have used tag `` (instead of `` or ``) to get failure-ID may become
incompatible, if filter uses IP-related tags (like `` or ``) additionally to ``
and the values are different (gh-3217)
### Fixes
\* theoretical RCE vulnerability in mailing action using mailutils (mail-whois), CVE-2021-32749, GHSA-m985-3f3v-cwmm
\* readline fixed to consider interim new-line character as part of code point in multi-byte logs
(e. g. unicode encoding like utf-16be, utf-16le);
\* [stability] solves race condition with uncontrolled growth of failure list (jail with too many matches,
that did not cause ban), behavior changed to ban ASAP, gh-2945
\* fixes search for the best datepattern - e. g. if line is too short, boundaries check for previously known
imprecise pattern may fail on incomplete lines (logging break-off, no flush, etc), gh-3020
\* [stability, performance] backend `systemd`:
- fixes error "local variable 'line' referenced before assignment", introduced in 55d7d9e2, gh-3097
- don't update database too often (every 10 ticks or ~ 10 seconds in production)
- fixes wrong time point of "in operation" mode, gh-2882
- better avoidance of landing in dead space by seeks over journals (improved seek to time)
- fixes missing space in message (tag ``) between timestamp and host if the message read from systemd journal, gh-3293
\* [stability] backend `pyinotify`: fixes sporadic runtime error "dictionary changed size during iteration"
\* several backends optimizations (in file and journal filters):
- don't need to wait if we still had log-entries from last iteration (which got interrupted for servicing)
- rewritten update log/journal position, it is more stable and faster now (fewer DB access and surely up-to-date at end)
\* `paths-debian.conf`:
- add debian path to roundcube error logs
\* `action.d/firewallcmd-\*.conf` (multiport only): fixed port range selector, replacing `:` with `-`;"
reverted the incompatibility gh-3047 introduced in a038fd5, gh-2821, because this depends now on firewalld backend
(e. g. `-` vs. `:` related to `iptables` vs. `nftables`)
\* `action.d/nginx-block-map.conf`: reload nginx only if it is running (also avoid error in nginx-errorlog, gh-2949)
\* `action.d/ufw.conf`:
- fixed handling on IPv6 (using prepend, gh-2331, gh-3018)
- application names containing spaces can be used now (gh-656, gh-1532, gh-3018)
\* `filter.d/apache-fakegooglebot.conf`:
- better, more precise regex and datepattern (closes possible weakness like gh-3013)
- `filter.d/ignorecommands/apache-fakegooglebot` - added timeout parameter (default 55 seconds), avoid fail with timeout
(default 1 minute) by reverse lookup on some slow DNS services (googlebots must be resolved fast), gh-2951
\* `filter.d/apache-overflows.conf` - extended to match AH00126 error (Invalid URI ...), gh-2908
\* `filter.d/asterisk.conf` - add transport to asterisk RE: call rejection messages can have the transport prefixed to the IP address, gh-2913
\* `filter.d/courier-auth.conf`:
- consider optional port after IP, gh-3211
- regex is rewritten without catch-all's and right anchor, so it is more stable against further modifications now
\* `filter.d/dovecot.conf`:
- adjusted for updated dovecot log format with `read(size=...)` in message (gh-3210)
- parse everything in parenthesis by auth-worker info, e. g. can match (pid=...,uid=...) too (amend to gh-2553)
- extended to match prefix like `conn unix:auth-worker (uid=143): auth-worker<13247>:`
(authenticate from external service like exim), gh-2553
- fixed "Authentication failure" regex, matches "Password mismatch" in title case (gh-2880)
\* `filter.d/drupal-auth.conf` - more strict regex, extended to match "Login attempt failed from" (gh-2742)
\* `filter.d/exim-common.conf` - pid-prefix extended to match `mx1 exim[...]:` (gh-2553)
\* `filter.d/lighttpd-auth.conf` - adjusted to the current source code + avoiding catch-all's, etc (gh-3116)
\* `filter.d/named-refused.conf`:
- added support for alternate names (suffix), FreeIPA renames the BIND9 named daemon to named-pkcs11, gh-2636
- fixes prefix for messages from systemd journal (no mandatory space ahead, because don't have timestamp), gh-2899
\* `filter.d/nginx-\*.conf` - added journalmatch to nginx filters, gh-2935
\* `filter.d/nsd.conf` - support for current log format, gh-2965
\* `filter.d/postfix.conf`: fixes and new vectors, review and combining several regex to single RE:
- mode `ddos` (and `aggressive`) extended:
\* to consider abusive handling of clients hitting command limit, gh-3040
\* to handle postscreen's PREGREET and HANGUP messages, gh-2898
- matches rejects with "undeliverable address" (sender/recipient verification) additionally to "Unknown user", gh-3039
both are configurable now via extended parameter and can be disabled using `exre-user=` supplied in filter parameters
- reject: BDAT/DATA from, gh-2927
- (since regex is more precise now) token selector changed to `[A-Z]{4}`, e. g. no matter what a command is supplied now
(RCPT, EHLO, VRFY, DATA, BDAT or something else)
- matches "Command rejected" and "Data command rejected" now
- matches RCPT from unknown, 504 5.5.2, need fully-qualified hostname, gh-2995
- matches 550 5.7.25 Client host rejected, gh-2996
\* `filter.d/sendmail-auth.conf`:
- detect several "authentication failure" messages, sendmail 8.16.1, gh-2757
- detect user not found, gh-3030
- detect failures without user part, gh-3324
\* `filter.d/sendmail-reject.conf`:
- fix reverse DNS for ... (gh-3012)
- fixed regex to consider "Connection rate limit exceeded" with different combination of arguments
\* `filter.d/sshd.conf`:
- mode `ddos` extended - recognizes messages "kex\_exchange\_identification: Connection closed / reset by pear", gh-3086
(fixed possible regression of f77398c)
- mode `ddos` extended - recognizes new message "banner exchange: invalid format" generated by port scanner
(https payload on ssh port), gh-3169
\* `filter.d/zoneminder.conf` - support new log format (ERR instead of WAR), add detection of non-existent user login attempts, gh-2984
\* amend to gh-980 fixing several actions (correctly supporting new enhancements now)
\* fixed typo by `--dump-pretty` option which did never work (only `--dp` was working)
\* fixes start of fail2ban-client in docker: speedup daemonization process by huge open files limit, gh-3334
\* provides details of failed regex compilation in the error message we throw in Regex-constructor
(it's good to know what exactly is wrong)
\* fixed failed update of database didn't signal with an error, gh-3352:
- client and server exit with error code by failure during start process (in foreground mode)
- added fallback to repair if database cannot be upgraded
### New Features and Enhancements
\* python 3.10 and 3.11 compatibility (and GHA-CI support)
\* `actioncheck` behavior is changed now (gh-488), so invariant check as well as restore or repair
of sane environment (in case of recognized unsane state) would only occur on action errors (e. g.
if ban or unban operations are exiting with other code as 0)
\* better recognition of log rotation, better performance by reopen: avoid unnecessary seek to begin of file
(and hash calculation)
\* file filter reads only complete lines (ended with new-line) now, so waits for end of line (for its completion)
\* datedetector:
- token `%Z` must recognize zone abbreviation `Z` (GMT/UTC) also (similar to `%z`)
- token `%Z` recognizes all known zone abbreviation besides Z, GMT, UTC correctly, if it is matching
(`%z` remains unchanged for backwards-compatibility, see comment in code)
- date patterns `%ExY` and `%Exy` accept every year from 19xx up to current century (+3 years) in `fail2ban-regex`
- better grouping algorithm for resulting century RE for `%ExY` and `%Exy`
\* actions differentiate tags `` and `` (``), if IP-address deviates from ID then the value
of `` is not equal `` anymore (gh-3217)
\* action info extended with new members for jail info (usable as tags in command actions), gh-10:
- ``, `` - current and total found failures
- ``, `` - current and total bans
\* `filter.d/monitorix.conf` - added new filter and jail for Monitorix, gh-2679
\* `filter.d/mssql-auth.conf` - new filter and jail for Microsoft SQL Server, gh-2642
\* `filter.d/nginx-bad-request.conf` - added filter to find bad requests (400), gh-2750
\* `filter.d/nginx-http-auth.conf` - extended with parameter mode, so additionally to `auth` (or `normal`)
mode `fallback` (or combined as `aggressive`) can find SSL errors while SSL handshaking, gh-2881
\* `filter.d/scanlogd.conf` - new filter and jail, add support for filtering out detected port scans via scanlogd, gh-2950
\* `action.d/apprise.conf` - added Apprise support (50+ Notifications), gh-2565
\* `action.d/badips.\*` - removed actions, badips.com is no longer active, gh-2889
\* `action.d/cloudflare.conf` - better IPv6 capability, gh-2891
\* `action.d/cloudflare-token.conf` - added support for Cloudflare Token APIs. This method is more restrictive and therefore safter than using API Keys.
\* `action.d/ipthreat.conf` - new action for IPThreat integration, gh-3349
\* `action.d/ufw.conf` (gh-3018):
- new option `add` (default `prepend`), can be supplied as `insert 1` for ufw versions before v.0.36 (gh-2331, gh-3018)
- new options `kill-mode` and `kill` to drop established connections of intruder (see action for details, gh-3018)
\* `iptables` and `iptables-ipset` actions extended to support multiple protocols with single action
for multiport or oneport type (back-ported from nftables action);
\* `iptables` actions are more breakdown-safe: start wouldn't fail if chain or rule already exists
(e. g. created by previous instance and doesn't get purged properly); ultimately closes gh-980
\* `ipset` actions are more breakdown-safe: start wouldn't fail if set with this name already exists
(e. g. created by previous instance and don't deleted properly)
\* replace internals of several `iptables` and `iptables-ipset` actions using internals of iptables include:
- better check mechanism (using `-C`, option `--check` is available long time);
- additionally iptables-ipset is a common action for `iptables-ipset-proto6-\*` now (which become obsolete now);
- many features of different iptables actions are combinable as single chain/rule (can be supplied to action as parameters);
- iptables is a replacement for iptables-common now, several actions using this as include now become obsolete;
\* new logtarget SYSTEMD-JOURNAL, gh-1403
\* fail2ban.conf: new fail2ban configuration option `allowipv6` (default `auto`), can be used to allow or disallow IPv6
interface in fail2ban immediately by start (e. g. if fail2ban starts before network interfaces), gh-2804
\* invalidate IP/DNS caches by reload, so inter alia would allow to recognize IPv6IsAllowed immediately, previously
retarded up to cache max-time (5m), gh-2804
\* OpenRC (Gentoo, mainly) service script improvements, gh-2182
\* suppress unneeded info "Jail is not a JournalFilter instance" (moved to debug level), gh-3186
\* implements new interpolation variable `%(fail2ban\_confpath)s` (automatically substituted from config-reader path,
default `/etc/fail2ban` or `/usr/local/etc/fail2ban` depending on distribution); `ignorecommands\_dir` is unneeded anymore,
thus removed from `paths-common.conf`, fixes gh-3005
\* `fail2ban-regex`: accepts filter parameters containing new-line
ver. 0.11.2 (2020/11/23) - heal-the-world-with-security-tools
-----------
### Compatibility
\* to v.0.10:
- 0.11 is totally compatible to 0.10 (configuration- and API-related stuff), but the database
got some new tables and fields (auto-converted during the first start), so once updated to 0.11, you
have to remove the database /var/lib/fail2ban/fail2ban.sqlite3 (or its different to 0.10 schema)
if you would need to downgrade to 0.10 for some reason.
\* to v.0.9:
- Filter (or `failregex`) internal capture-groups:
\* If you've your own `failregex` or custom filters using conditional match `(?P=host)`, you should
rewrite the regex like in example below resp. using `(?:(?P=ip4)|(?P=ip6)` instead of `(?P=host)`
(or `(?:(?P=ip4)|(?P=ip6)|(?P=dns))` corresponding your `usedns` and `raw` settings).
Of course you can always define your own capture-group (like below `\_cond\_ip\_`) to do this.
```
testln="1500000000 failure from 192.0.2.1: bad host 192.0.2.1"
fail2ban-regex "$testln" "^\s\*failure from (?P<\_cond\_ip\_>): bad host (?P=\_cond\_ip\_)$"
```
\* New internal groups (currently reserved for internal usage):
`ip4`, `ip6`, `dns`, `fid`, `fport`, additionally `user` and another captures in lower case if
mapping from tag `` used in failregex (e. g. `user` by ``).
- v.0.10 and 0.11 use more precise date template handling, that can be theoretically incompatible to some
user configurations resp. `datepattern`.
- Since v0.10 fail2ban supports the matching of IPv6 addresses, but not all ban actions are
IPv6-capable now.
### Fixes
\* [stability] prevent race condition - no ban if filter (backend) is continuously busy if
too many messages will be found in log, e. g. initial scan of large log-file or journal (gh-2660)
\* pyinotify-backend sporadically avoided initial scanning of log-file by start
\* python 3.9 compatibility (and Travis CI support)
\* restoring a large number (500+ depending on files ulimit) of current bans when using PyPy fixed
\* manual ban is written to database, so can be restored by restart (gh-2647)
\* `jail.conf`: don't specify `action` directly in jails (use `action\_` or `banaction` instead)
\* no mails-action added per default anymore (e. g. to allow that `action = %(action\_mw)s` should be specified
per jail or in default section in jail.local), closes gh-2357
\* ensure we've unique action name per jail (also if parameter `actname` is not set but name deviates from standard name, gh-2686)
\* don't use `%(banaction)s` interpolation because it can be complex value (containing `[...]` and/or quotes),
so would bother the action interpolation
\* fixed type conversion in config readers (take place after all interpolations get ready), that allows to
specify typed parameters variable (as substitutions) as well as to supply it in other sections or as init parameters.
\* `action.d/\*-ipset\*.conf`: several ipset actions fixed (no timeout per default anymore), so no discrepancy
between ipset and fail2ban (removal from ipset will be managed by fail2ban only, gh-2703)
\* `action.d/cloudflare.conf`: fixed `actionunban` (considering new-line chars and optionally real json-parsing
with `jq`, gh-2140, gh-2656)
\* `action.d/nftables.conf` (type=multiport only): fixed port range selector, replacing `:` with `-` (gh-2763)
\* `action.d/firewallcmd-\*.conf` (multiport only): fixed port range selector, replacing `:` with `-` (gh-2821)
\* `action.d/bsd-ipfw.conf`: fixed selection of rule-no by large list or initial `lowest\_rule\_num` (gh-2836)
\* `filter.d/common.conf`: avoid substitute of default values in related `lt\_\*` section, `\_\_prefix\_line`
should be interpolated in definition section (inside the filter-config, gh-2650)
\* `filter.d/dovecot.conf`:
- add managesieve and submission support (gh-2795);
- accept messages with more verbose logging (gh-2573);
\* `filter.d/courier-smtp.conf`: prefregex extended to consider port in log-message (gh-2697)
\* `filter.d/traefik-auth.conf`: filter extended with parameter mode (`normal`, `ddos`, `aggressive`) to handle
the match of username differently (gh-2693):
- `normal`: matches 401 with supplied username only
- `ddos`: matches 401 without supplied username only
- `aggressive`: matches 401 and any variant (with and without username)
\* `filter.d/sshd.conf`: normalizing of user pattern in all RE's, allowing empty user (gh-2749)
### New Features and Enhancements
\* fail2ban-regex:
- speedup formatted output (bypass unneeded stats creation)
- extended with prefregex statistic
- more informative output for `datepattern` (e. g. set from filter) - pattern : description
\* parsing of action in jail-configs considers space between action-names as separator also
(previously only new-line was allowed), for example `action = a b` would specify 2 actions `a` and `b`
\* new filter and jail for GitLab recognizing failed application logins (gh-2689)
\* new filter and jail for Grafana recognizing failed application logins (gh-2855)
\* new filter and jail for SoftEtherVPN recognizing failed application logins (gh-2723)
\* `filter.d/guacamole.conf` extended with `logging` parameter to follow webapp-logging if it's configured (gh-2631)
\* `filter.d/bitwarden.conf` enhanced to support syslog (gh-2778)
\* introduced new prefix `{UNB}` for `datepattern` to disable word boundaries in regex;
\* datetemplate: improved anchor detection for capturing groups `(^...)`;
\* datepattern: improved handling with wrong recognized timestamps (timezones, no datepattern, etc)
as well as some warnings signaling user about invalid pattern or zone (gh-2814):
- filter gets mode in-operation, which gets activated if filter starts processing of new messages;
in this mode a timestamp read from log-line that appeared recently (not an old line), deviating too much
from now (up too 24h), will be considered as now (assuming a timezone issue), so could avoid unexpected
bypass of failure (previously exceeding `findtime`);
- better interaction with non-matching optional datepattern or invalid timestamps;
- implements special datepattern `{NONE}` - allow to find failures totally without date-time in log messages,
whereas filter will use now as timestamp (gh-2802)
\* performance optimization of `datepattern` (better search algorithm in datedetector, especially for single template);
\* fail2ban-client: extended to unban IP range(s) by subnet (CIDR/mask) or hostname (DNS), gh-2791;
\* extended capturing of alternate tags in filter, allowing combine of multiple groups to single tuple token with new tag
prefix `` with all value of `` tags (gh-2755)
ver. 0.11.1 (2020/01/11) - this-is-the-way
-----------
### Fixes
\* purge database will be executed now (within observer).
\* restoring currently banned ip after service restart fixed
(now < timeofban + bantime), ignore old log failures (already banned)
\* upgrade database: update new created table `bips` with entries from table `bans` (allows restore
current bans after upgrade from version <= 0.10)
### New Features
\* Increment ban time (+ observer) functionality introduced.
\* Database functionality extended with bad ips.
\* New tags (usable in actions):
- `` - ban count of this offender if known as bad (started by 1 for unknown)
- `` - current ban-time of the ticket (prolongation can be retarded up to 10 sec.)
\* Introduced new action command `actionprolong` to prolong ban-time (e. g. set new timeout if expected);
Several actions (like ipset, etc.) rewritten using net logic with `actionprolong`.
Note: because ban-time is dynamic, it was removed from jail.conf as timeout argument (check jail.local).
### Enhancements
\* algorithm of restore current bans after restart changed: update the restored ban-time (and therefore
end of ban) of the ticket with ban-time of jail (as maximum), for all tickets with ban-time greater
(or persistent); not affected if ban-time of the jail is unchanged between stop/start.
\* added new setup-option `--without-tests` to skip building and installing of tests files (gh-2287).
\* added new command `fail2ban-client get  banip ?sep-char|--with-time?` to get the banned ip addresses (gh-1916).
ver. 0.10.5 (2020/01/10) - deserve-more-respect-a-jedis-weapon-must
-----------
Yes, Hrrrm...
### Fixes
\* [compatibility] systemd backend: default flags changed to SYSTEM\_ONLY(4), fixed in gh-2444 in order to ignore
user session files per default, so could prevent "Too many open files" errors on a lot of user sessions (see gh-2392)
\* [grave] fixed parsing of multi-line filters (`maxlines` > 1) together with systemd backend,
now systemd-filter replaces newlines in message from systemd journal with `\n` (otherwise
multi-line parsing may be broken, because removal of matched string from multi-line buffer window
is confused by such extra new-lines, so they are retained and got matched on every followed
message, see gh-2431)
\* [stability] prevent race condition - no unban if the bans occur continuously (gh-2410);
now an unban-check will happen not later than 10 tickets get banned regardless there are
still active bans available (precedence of ban over unban-check is 10 now)
\* fixed read of included config-files (`.local` overwrites options of `.conf` for config-files
included with before/after)
\* `action.d/abuseipdb.conf`: switched to use AbuseIPDB API v2 (gh-2302)
\* `action.d/badips.py`: fixed start of banaction on demand (which may be IP-family related), gh-2390
\* `action.d/helpers-common.conf`: rewritten grep arguments, now options `-wF` used to match only
whole words and fixed string (not as pattern), gh-2298
\* `filter.d/apache-auth.conf`:
- ignore errors from mod\_evasive in `normal` mode (mode-controlled now) (gh-2548);
- extended with option `mode` - `normal` (default) and `aggressive`
\* `filter.d/sshd.conf`:
- matches `Bad protocol version identification` in `ddos` and `aggressive` modes (gh-2404).
- captures `Disconnecting ...: Change of username or service not allowed` (gh-2239, gh-2279)
- captures `Disconnected from ... [preauth]`, preauth phase only, different handling by `extra`
(with supplied user only) and `ddos`/`aggressive` mode (gh-2115, gh-2239, gh-2279)
\* `filter.d/mysqld-auth.conf`:
- MYSQL 8.0.13 compatibility (log-error-verbosity = 3), log-format contains few additional words
enclosed in brackets after "[Note]" (gh-2314)
\* `filter.d/sendmail-reject.conf`:
- `mode=extra` now captures port IDs of `TLSMTA` and `MSA` (defaults for ports 465 and 587 on some distros)
\* `files/fail2ban.service.in`: fixed systemd-unit template - missing nftables dependency (gh-2313)
\* several `action.d/mail\*`: fixed usage with multiple log files (ultimate fix for gh-976, gh-2341)
\* `filter.d/sendmail-reject.conf`: fixed journal usage for some systems (e. g. CentOS): if only identifier
set to `sm-mta` (no unit `sendmail`) for some messages (gh-2385)
\* `filter.d/asterisk.conf`: asterisk can log additional timestamp if logs into systemd-journal
(regex extended with optional part matching this, gh-2383)
\* `filter.d/postfix.conf`:
- regexp's accept variable suffix code in status of postfix for precise messages (gh-2442)
- extended with new postfix filter mode `errors` to match "too many errors" (gh-2439),
also included within modes `normal`, `more` (`extra` and `aggressive`), since postfix
parameter `smtpd\_hard\_error\_limit` is default 20 (additionally consider `maxretry`)
\* `filter.d/named-refused.conf`:
- support BIND 9.11.0 log format (includes an additional field @0xXXX..., gh-2406);
- `prefregex` extended, more selective now (denied/NOTAUTH suffix moved from failregex, so no catch-all there anymore)
\* `filter.d/sendmail-auth.conf`, `filter.d/sendmail-reject.conf` :
- ID in prefix can be longer as 14 characters (gh-2563);
\* all filters would accept square brackets around IPv4 addresses also (e. g. monit-filter, gh-2494)
\* avoids unhandled exception during flush (gh-2588)
\* fixes pass2allow-ftp jail - due to inverted handling, action should prohibit access per default for any IP,
therefore reset start on demand parameter for this action (it will be started immediately by repair);
\* auto-detection of IPv6 subsystem availability (important for not on-demand actions or jails, like pass2allow);
### New Features
\* new replacement tags for failregex to match subnets in form of IP-addresses with CIDR mask (gh-2559):
- `` - helper regex to match CIDR (simple integer form of net-mask);
- `` - regex to match sub-net addresses (in form of IP/CIDR, also single IP is matched, so part /CIDR is optional);
\* grouped tags (``, ``, ``) recognize IP addresses enclosed in square brackets
\* new failregex-flag tag `` for failregex, signaled that the access to service was gained
(ATM used similar to tag ``, but it does not add the log-line to matches, gh-2279)
\* filters: introduced new configuration parameter `logtype` (default `file` for file-backends, and
`journal` for journal-backends, gh-2387); can be also set to `rfc5424` to force filters (which include common.conf)
to use RFC 5424 conform prefix-line per default (gh-2467);
\* for better performance and safety the option `logtype` can be also used to
select short prefix-line for file-backends too for all filters using `\_\_prefix\_line` (`common.conf`),
if message logged only with `hostname svc[nnnn]` prefix (often the case on several systems):
```ini
[jail]
backend = auto
filter = flt[logtype=short]
```
\* `filter.d/common.conf`: differentiate `\_\_prefix\_line` for file/journal logtype's (speedup and fix parsing
of systemd-journal);
\* `filter.d/traefik-auth.conf`: used to ban hosts, that were failed through traefik
\* `filter.d/znc-adminlog.conf`: new filter for ZNC (IRC bouncer); requires the adminlog module to be loaded
### Enhancements
\* introduced new options: `dbmaxmatches` (fail2ban.conf) and `maxmatches` (jail.conf) to control
how many matches per ticket fail2ban can hold in memory and store in database (gh-2402, gh-2118);
\* fail2ban.conf: introduced new section `[Thread]` and option `stacksize` to configure default size
of the stack for threads running in fail2ban (gh-2356), it could be set in `fail2ban.local` to
avoid runtime error "can't start new thread" (see gh-969);
\* jail-reader extended (amend to gh-1622): actions support multi-line options now (interpolations
containing new-line);
\* fail2ban-client: extended to ban/unban multiple tickets (see gh-2351, gh-2349);
Syntax:
- `fail2ban-client set  banip  ... `
- `fail2ban-client set  unbanip [--report-absent]  ... `
\* fail2ban-client: extended with new feature which allows to inform fail2ban about single or multiple
attempts (failure) for IP (resp. failure-ID), see gh-2351;
Syntax:
- `fail2ban-client set  attempt  [ ... ]`
\* `action.d/nftables.conf`:
- isolate fail2ban rules into a dedicated table and chain (gh-2254)
- `nftables-allports` supports multiple protocols in single rule now
- combined nftables actions to single action `nftables`:
\* `nftables-common` is removed (replaced with single action `nftables` now)
\* `nftables-allports` is obsolete, superseded by `nftables[type=allports]`
\* `nftables-multiport` is obsolete, superseded by `nftables[type=multiport]`
- allowed multiple protocols in `nftables[type=multiport]` action (single set with multiple rules
in chain), following configuration in jail would replace 3 separate actions, see
https://github.com/fail2ban/fail2ban/pull/2254#issuecomment-534684675
\* `action.d/badips.py`: option `loglevel` extended with level of summary message,
following example configuration logging summary with NOTICE and rest with DEBUG log-levels:
`action = badips.py[loglevel="debug, notice"]`
\* samplestestcase.py (testSampleRegexsFactory) extended:
- allow coverage of journal logtype;
- new option `fileOptions` to set common filter/test options for whole test-file;
\* large enhancement: auto-reban, improved invariant check and conditional operations (gh-2588):
- improves invariant check and repair (avoid unhandled exception, consider family on conditional operations, etc),
prepared for bulk re-ban in repair case (if bulk-ban becomes implemented);
- automatic reban (repeat banning action) after repair/restore sane environment, if already logged ticket causes
new failures (via new action operation `actionreban` or `actionban` if still not defined in action);
\* introduces banning epoch for actions and tickets (to distinguish or recognize removed set of the tickets);
\* invariant check avoids repair by unban/stop (unless parameter `actionrepair\_on\_unban` set to `true`);
\* better handling for all conditional operations (distinguish families for certain operations like
repair/flush/stop, prepared for other families, e. g. if different handling for subnets expected, etc);
\* partially implements gh-980 (more breakdown safe handling);
\* closes gh-1680 (better as large-scale banning implementation with on-demand reban by failure,
at least unless a bulk-ban gets implemented);
\* fail2ban-regex - several enhancements and fixes:
- improved usage output (don't put a long help if an error occurs);
- new option `--no-check-all` to avoid check of all regex's (first matched only);
- new option `-o`, `--out` to set token only provided in output (disables check-all and outputs only expected data).
ver. 0.10.4 (2018/10/04) - ten-four-on-due-date-ten-four
-----------
### Fixes
\* `filter.d/dovecot.conf`:
- failregex enhancement to catch sql password mismatch errors (gh-2153);
- disconnected with "proxy dest auth failed" (gh-2184);
\* `filter.d/freeswitch.conf`:
- provide compatibility for log-format from gh-2193:
\* extended with new default date-pattern `^(?:%%Y-)?%%m-%%d[ T]%%H:%%M:%%S(?:\.%%f)?` to cover
`YYYY-mm-dd HH:MM::SS.ms` as well as `mm-dd HH:MM::SS.ms` (so year is optional);
\* more optional arguments in log-line (so accept [WARN] as well as [WARNING] and optional [SOFIA] hereafter);
- extended with mode parameter, allows to avoid matching of messages like `auth challenge (REGISTER)`
(see gh-2163) (currently `extra` as default to be backwards-compatible), see comments in filter
how to set it to mode `normal`.
\* `filter.d/domino-smtp.conf`:
- recognizes failures logged using another format (something like session-id, IP enclosed in square brackets);
- failregex extended to catch connections rejected for policy reasons (gh-2228);
\* `action.d/hostsdeny.conf`: fix parameter in config (dynamic parameters stating with '\_' are protected
and don't allowed in command-actions), see gh-2114;
\* decoding stability fix by wrong encoded characters like utf-8 surrogate pairs, etc (gh-2171):
- fail2ban running in the preferred encoding now (as default encoding also within python 2.x), mostly
`UTF-8` in opposite to `ascii` previously, so minimizes influence of implicit conversions errors;
- actions: avoid possible conversion errors on wrong-chars by replace tags;
- database: improve adapter/converter handlers working on invalid characters in sense of json and/or sqlite-database;
additionally both are exception-safe now, so avoid possible locking of database (closes gh-2137);
- logging in fail2ban is process-wide exception-safe now.
\* repaired start-time of initial seek to time (as well as other log-parsing related data),
if parameter `logpath` specified before `findtime`, `backend`, `datepattern`, etc (gh-2173)
\* systemd: fixed type error on option `journalflags`: an integer is required (gh-2125);
### New Features
\* new option `ignorecache` to improve performance of ignore failure check (using caching of `ignoreip`,
`ignoreself` and `ignorecommand`), see `man jail.conf` for syntax-example;
\* `ignorecommand` extended to use actions-similar replacement (capable to interpolate
all possible tags like ``, ``, ``, `F-USER` etc.)
### Enhancements
\* `filter.d/dovecot.conf`: extended with tags F-USER (and alternatives) to collect user-logins (gh-2168)
\* since v.0.10.4, fail2ban-client, fail2ban-server and fail2ban-regex will return version without logo info,
additionally option `-V` can be used to get version in normalized machine-readable short format.
ver. 0.10.3 (2018/04/04) - the-time-is-always-right-to-do-what-is-right
-----------
### ver. 0.10.3.1:
\* fixed JSON serialization for the set-object within dump into database (gh-2103).
### Fixes
\* `filter.d/asterisk.conf`: fixed failregex prefix by log over remote syslog server (gh-2060);
\* `filter.d/exim.conf`: failregex extended - SMTP call dropped: too many syntax or protocol errors (gh-2048);
\* `filter.d/recidive.conf`: fixed if logging into systemd-journal (SYSLOG) with daemon name in prefix, gh-2069;
\* `filter.d/sendmail-auth.conf`, `filter.d/sendmail-reject.conf` :
- fixed failregex, sendmail uses prefix 'IPv6:' logging of IPv6 addresses (gh-2064);
\* `filter.d/sshd.conf`:
- failregex got an optional space in order to match new log-format (see gh-2061);
- fixed ddos-mode regex to match refactored message (some versions can contain port now, see gh-2062);
- fixed root login refused regex (optional port before preauth, gh-2080);
- avoid banning of legitimate users when pam\_unix used in combination with other password method, so
bypass pam\_unix failures if accepted available for this user gh-2070;
- amend to gh-1263 with better handling of multiple attempts (failures for different user-names recognized immediately);
- mode `ddos` (and `aggressive`) extended to catch `Connection closed by ... [preauth]`, so in DDOS mode
it counts failure on closing connection within preauth-stage (gh-2085);
\* `action.d/abuseipdb.conf`: fixed curl cypher errors and comment quote-issue (gh-2044, gh-2101);
\* `action.d/badips.py`: implicit convert IPAddr to str, solves an issue "expected string, IPAddr found" (gh-2059);
\* `action.d/hostsdeny.conf`: fixed IPv6 syntax (enclosed in square brackets, gh-2066);
\* (Free)BSD ipfw actionban fixed to allow same rule added several times (gh-2054);
### New Features
\* several stability and performance optimizations, more effective filter parsing, etc;
\* stable runnable within python versions 3.6 (as well as within 3.7-dev);
### Enhancements
\* `filter.d/apache-auth.conf`: detection of Apache SNI errors resp. misredirect attempts (gh-2017, gh-2097);
\* `filter.d/apache-noscript.conf`: extend failregex to match "Primary script unknown", e. g. from php-fpm (gh-2073);
\* date-detector extended with long epoch (`LEPOCH`) to parse milliseconds/microseconds posix-dates (gh-2029);
\* possibility to specify own regex-pattern to match epoch date-time, e. g. `^\[{EPOCH}\]` or `^\[{LEPOCH}\]` (gh-2038);
the epoch-pattern similar to `{DATE}` patterns does the capture and cuts out the match of whole pattern from the log-line,
e. g. date-pattern `^\[{LEPOCH}\]\s+:` will match and cut out `[1516469849551000] :` from begin of the log-line.
\* badips.py now uses https instead of plain http when requesting badips.com (gh-2057);
\* add support for "any" badips.py bancategory, to be able to retrieve IPs from all categories with a desired score (gh-2056);
\* Introduced new parameter `padding` for logging within fail2ban-server (default on, excepting SYSLOG):
Usage `logtarget = target[padding=on|off]`
ver. 0.10.2 (2018/01/18) - nothing-burns-like-the-cold
-----------
### Incompatibility list:
\* The configuration for jails using banaction `pf` can be incompatible after upgrade, because pf-action uses
anchors now (see `action.d/pf.conf` for more information). If you want use obsolete handling without anchors,
just rewrite it in the `jail.local` by overwrite of `pfctl` parameter, e. g. like `banaction = pf[pfctl="pfctl"]`.
### Fixes
\* Fixed logging to systemd-journal: new logtarget value SYSOUT can be used instead of STDOUT, to avoid
write of the time-stamp, if logging to systemd-journal from foreground mode (gh-1876)
\* Fixed recognition of the new date-format on mysqld-auth filter (gh-1639)
\* jail.conf: port `imap3` replaced with `imap` everywhere, since imap3 is not a standard port and old rarely
(if ever) used and can missing on some systems (e. g. debian stretch), see gh-1942.
\* config/paths-common.conf: added missing initial values (and small normalization in config/paths-\*.conf)
in order to avoid errors while interpolating (e. g. starting with systemd-backend), see gh-1955.
\* `action.d/pf.conf`:
- fixed syntax error in achnor definition (documentation, see gh-1919);
- enclose ports in braces for multiport jails (see gh-1925);
\* `action.d/firewallcmd-ipset.conf`: fixed create of set for ipv6 (missing `family inet6`, gh-1990)
\* `filter.d/sshd.conf`:
- extended failregex for modes "extra"/"aggressive": now finds all possible (also future)
forms of "no matching (cipher|mac|MAC|compression method|key exchange method|host key type) found",
see "ssherr.c" for all possible SSH\_ERR\_...\_ALG\_MATCH errors (gh-1943, gh-1944);
- fixed failregex in order to avoid banning of legitimate users with multiple public keys (gh-2014, gh-1263);
### New Features
\* datedetector: extended default date-patterns (allows extra space between the date and time stamps);
introduces 2 new format directives (with corresponding %Ex prefix for more precise parsing):
- %k - one- or two-digit number giving the hour of the day (0-23) on a 24-hour clock,
(corresponds %H, but allows space if not zero-padded).
- %l - one- or two-digit number giving the hour of the day (12-11) on a 12-hour clock,
(corresponds %I, but allows space if not zero-padded).
\* `filter.d/exim.conf`: added mode `aggressive` to ban flood resp. DDOS-similar failures (gh-1983);
\* New Actions:
- `action.d/nginx-block-map.conf` - in order to ban not IP-related tickets via nginx (session blacklisting in
nginx-location with map-file);
### Enhancements
\* jail.conf: extended with new parameter `mode` for the filters supporting it (gh-1988);
\* action.d/pf.conf: extended with bulk-unban, command `actionflush` in order to flush all bans at once.
\* Introduced new parameters for logging within fail2ban-server (gh-1980).
Usage `logtarget = target[facility=..., datetime=on|off, format="..."]`:
- `facility` - specify syslog facility (default `daemon`, see https://docs.python.org/2/library/logging.handlers.html#sysloghandler
for the list of facilities);
- `datetime` - add date-time to the message (default on, ignored if `format` specified);
- `format` - specify own format how it will be logged, for example for short-log into STDOUT:
`fail2ban-server -f --logtarget 'stdout[format="%(relativeCreated)5d | %(message)s"]' start`;
\* Automatically recover or recreate corrupt persistent database (e. g. if failed to open with
'database disk image is malformed'). Fail2ban will create a backup, try to repair the database,
if repair fails - recreate new database (gh-1465, gh-2004).
ver. 0.10.1 (2017/10/12) - succeeded-before-friday-the-13th
-----------
### Fixes
\* fix Gentoo init script's shebang to use openrc-run instead of runscript (gh-1891)
\* jail "pass2allow-ftp" supply blocktype and returntype parameters to the action (gh-1884)
\* avoid using "ANSI\_X3.4-1968" as preferred encoding (if missing environment variables
'LANGUAGE', 'LC\_ALL', 'LC\_CTYPE', and 'LANG', see gh-1587).
\* action.d/pf.conf: several fixes for pf-action like anchoring, etc. (see gh-1866, gh-1867);
\* fixed ignoreself issue "Retrieving own IPs of localhost failed: inet\_pton() argument 2 must be string, not int" (see gh-1865);
\* fixed tags `` and ``, could be used without ticket (a. g. in `actionstart` etc., gh-1859).
\* setup.py: fixed several setup facilities (gh-1874):
- don't check return code by dry-run: returns 256 on some python/setuptool versions;
- `files/fail2ban.service` renamed as template to `files/fail2ban.service.in`;
- setup process generates `build/fail2ban.service` from `files/fail2ban.service.in` using distribution related bin-path;
- bug-fixing by running setup with option `--dry-run`;
### New Features
\* introduced new command-line options `--dp`, `--dump-pretty` to dump the configuration using more
human readable representation (opposite to `-d`);
### Enhancements
\* nftables actions are IPv6-capable now (gh-1893)
\* filter.d/dovecot.conf: introduced mode `aggressive` for cases like "disconnected before auth was ready" (gh-1880)
ver. 0.10.0 (2017/08/09) - long-awaited 0.10th version
-----------
TODO: implementing of options resp. other tasks from PR #1346
documentation should be extended (new options, etc)
### Fixes
\* `filter.d/apache-auth.conf`:
- better failure recognition using short form of regex (url/referer are foreign inputs, see gh-1645)
\* `filter.d/apache-common.conf` (`filter.d/apache-\*.conf`):
- support of apache log-format if logging into syslog/systemd (gh-1695), using parameter `logging`,
parameter usage for jail:
filter = apache-auth[logging=syslog]
parameter usage for `apache-common.local`:
logging = syslog
\* `filter.d/pam-generic.conf`:
- [grave] injection on user name to host fixed
\* `filter.d/sshd.conf`:
- rewritten using `prefregex` and used MLFID-related multi-line parsing
(by using tag `` instead of buffering with `maxlines`);
- optional parameter `mode` rewritten: normal (default), ddos, extra or aggressive (combines all),
see sshd for regex details)
\* `filter.d/sendmail-reject.conf`:
- rewritten using `prefregex` and used MLFID-related multi-line parsing;
- optional parameter `mode` introduced: normal (default), extra or aggressive
\* `filter.d/haproxy-http-auth`: do not mistake client port for part of an IPv6 address (gh-1745)
\* `filter.d/postfix.conf`:
- updated to latest postfix formats
- joined several postfix filter together (normalized and optimized version, gh-1825)
- introduced new parameter `mode` (see gh-1825): more (default, combines normal and rbl), auth, normal,
rbl, ddos, extra or aggressive (combines all)
- postfix postscreen (resp. other RBL's compatibility fix, gh-1764, gh-1825)
\* `filter.d/postfix-rbl.conf`: removed (replaced with `postfix[mode=rbl]`)
\* `filter.d/postfix-sasl.conf`: removed (replaced with `postfix[mode=auth]`)
\* `filter.d/roundcube-auth.conf`:
- fixed regex when `X-Real-IP` or/and `X-Forwarded-For` are present after host (gh-1303);
- fixed regex when logging authentication errors to journal instead to a local file (gh-1159);
- additionally fixed more complex injections on username (e. g. using dot after fake host).
\* `filter.d/ejabberd-auth.conf`: fixed failregex - accept new log-format (gh-993)
\* `action.d/complain.conf`
- fixed using new tag `` (sh/dash compliant now)
\* `action.d/sendmail-geoip-lines.conf`
- fixed using new tag `` (without external command execution)
\* fail2ban-regex: fixed matched output by multi-line (buffered) parsing
\* fail2ban-regex: support for multi-line debuggex URL implemented (gh-422)
\* fixed ipv6-action errors on systems not supporting ipv6 and vice versa (gh-1741)
\* fixed directory-based log-rotate for pyinotify-backend (gh-1778)
### New Features
\* New Actions:
\* New Filters:
### Enhancements
\* Introduced new filter option `prefregex` for pre-filtering using single regular expression (gh-1698);
\* Many times faster and fewer CPU-hungry because of parsing with `maxlines=1`, so without
line buffering (scrolling of the buffer-window).
Combination of tags `` and `` can be used now to process multi-line logs
using single-line expressions:
- tag ``: used to identify resp. store failure info for groups of log-lines with the same
identifier (e. g. combined failure-info for the same conn-id by `(?:conn-id)`,
see sshd.conf for example);
- tag ``: can be used as mark to forget current multi-line MLFID (e. g. by connection
closed, reset or disconnect etc);
- tag ``: used as mark for no-failure (helper to accumulate common failure-info,
e. g. from lines that contain IP-address);
Opposite to obsolete multi-line parsing (using buffering with `maxlines`) it is more precise and
can recognize multiple failure attempts within the same connection (MLFID).
\* Several filters optimized with pre-filtering using new option `prefregex`, and multiline filter
using `` + `` combination;
\* Exposes filter group captures in actions (non-recursive interpolation of tags ``,
see gh-1698, gh-1110)
\* Some filters extended with user name (can be used in gh-1243 to distinguish IP and user,
resp. to remove after success login the user-related failures only);
\* Safer, more stable and faster replaceTag interpolation (switched from cycle over all tags
to re.sub with callable)
\* substituteRecursiveTags optimization + moved in helpers facilities (because currently used
commonly in server and in client)
\* New tags (usable in actions):
- `` - failure identifier (if raw resp. failures without IP address)
- `` - PTR reversed representation of IP address
- `` - host name of the IP address
- `` - ban count of this offender if known as bad (started by 1 for unknown)
- `` - current ban-time of the ticket (prolongation can be retarded up to 10 sec.)
- `` - interpolates to the corresponding filter group capture `...`
- `` - fully-qualified name of host (the same as `$(hostname -f)`)
- `` - short hostname (the same as `$(uname -n)`)
\* Introduced new action command `actionprolong` to prolong ban-time (e. g. set new timeout if expected);
Several actions (like ipset, etc.) rewritten using net logic with `actionprolong`.
Note: because ban-time is dynamic, it was removed from jail.conf as timeout argument (check jail.local).
\* Allow to use filter options by `fail2ban-regex`, example:
fail2ban-regex text.log "sshd[mode=aggressive]"
\* Samples test case factory extended with filter options - dict in JSON to control
filter options (e. g. mode, etc.):
# filterOptions: {"mode": "aggressive"}
\* Introduced new jail option "ignoreself", specifies whether the local resp. own IP addresses
should be ignored (default is true). Fail2ban will not ban a host which matches such addresses.
Option "ignoreip" affects additionally to "ignoreself" and don't need to include the DNS
resp. IPs of the host self.
\* Regex will be compiled as MULTILINE only if needed (buffering with `maxlines` > 1), that enables:
- to improve performance by the single line parsing (see gh-1733);
- make regex more precise (because distinguish between anchors `^`/`$` for the begin/end of string
and the new-line character '\n', e. g. if coming from filters (like systemd journal) that allow
the parsing of log-entries contain new-line chars (as single entry);
- if multiline regex however expected (by single-line parsing without buffering) - prefix `(?m)`
could be used in regex to enable it;
\* Implemented execution of `actionstart` on demand (conditional), if action depends on `family` (gh-1742):
- new action parameter `actionstart\_on\_demand` (bool) can be set to prevent/allow starting action
on demand (default retrieved automatically, if some conditional parameter `param?family=...`
presents in action properties), see `action.d/pf.conf` for example;
- additionally `actionstop` will be executed only for families previously executing `actionstart`
(starting on demand only)
\* Introduced new command `actionflush`: executed in order to flush all bans at once
e. g. by unban all, reload with removing action, stop, shutdown the system (gh-1743),
the actions having `actionflush` do not execute `actionunban` for each single ticket
\* Add new command `actionflush` default for several iptables/iptables-ipset actions (and common include);
\* Add new jail option `logtimezone` to force the timezone on log lines that don't have an explicit one (gh-1773)
\* Implemented zone abbreviations (like CET, CEST, etc.) and abbr+-offset functionality (accept zones
like 'CET+0100'), for the list of abbreviations see strptime.TZ\_STR;
\* Introduced new option `--timezone` (resp. `--TZ`) for `fail2ban-regex`.
\* Tokens `%z` and `%Z` are changed (more precise now);
\* Introduced new tokens `%Exz` and `%ExZ` that fully support zone abbreviations and/or offset-based
zones (implemented as enhancement using custom `datepattern`, because may be too dangerous for default
patterns and tokens like `%z`);
Note: the extended tokens supported zone abbreviations, but it can parse 1 or 3-5 char(s) in lowercase.
Don't use them in default date-patterns (if not anchored, few precise resp. optional).
Because python currently does not support mixing of case-sensitive with case-insensitive matching,
the TZ (in uppercase) cannot be combined with `%a`/`%b` etc (that are currently case-insensitive),
to avoid invalid date-time recognition in strings like '11-Aug-2013 03:36:11.372 error ...' with
wrong TZ "error".
Hence `%z` currently match literal Z|UTC|GMT only (and offset-based), and `%Exz` - all zone
abbreviations.
\* `filter.d/courier-auth.conf`: support failed logins with method only
\* Config reader's: introduced new syntax `%(section/option)s`, in opposite to extended interpolation of
python 3 `${section:option}` work with all supported python version in fail2ban and this syntax is
like our another features like `%(known/option)s`, etc. (gh-1750)
\* Variable `default\_backend` switched to `%(default/backend)s`, so totally backwards compatible now,
but now the setting of parameter `backend` in default section of `jail.local` can overwrite default
backend also (see gh-1750). In the future versions parameter `default\_backend` can be removed (incompatibility,
possibly some distributions affected).
ver. 0.10.0-alpha-1 (2016/07/14) - ipv6-support-etc
-----------
### Fixes
\* [Grave] memory leak's fixed (gh-1277, gh-1234)
\* [Grave] Misleading date patterns defined more precisely (using extended syntax
`%Ex[mdHMS]` for exact two-digit match or e. g. `%ExY` as more precise year
pattern, within same century of last year and the next 3 years)
\* [Grave] extends date detector template with distance (position of match in
log-line), to prevent grave collision using (re)ordered template list (e.g.
find-spot of wrong date-match inside foreign input, misleading date patterns
by ambiguous formats, etc.)
\* Distance collision check always prefers template with shortest distance
(left for right) if date pattern is not anchored
\* Tricky bug fix: last position of log file will be never retrieved (gh-795),
because of CASCADE all log entries will be deleted from logs table together with jail,
if used "INSERT OR REPLACE" statement
\* Asyncserver (asyncore) code fixed and test cases repaired (again gh-161)
\* testSocket: sporadical bug repaired - wait for server thread starts a socket (listener)
\* testExecuteTimeoutWithNastyChildren: sporadical bug repaired - wait for pid file inside bash,
kill tree in any case (gh-1155)
\* purge database will be executed now (within observer).
\* restoring currently banned ip after service restart fixed
(now < timeofban + bantime), ignore old log failures (already banned)
\* Fixed high-load of pyinotify-backend,
see https://github.com/fail2ban/fail2ban/issues/885#issuecomment-248964591
\* Database: stability fix - repack cursor iterator as long as locked
\* File filter backends: stability fix for sporadically errors - always close file
handle, otherwise may be locked (prevent log-rotate, etc.)
\* Pyinotify-backend: stability fix for sporadically errors in multi-threaded
environment (without lock)
\* Fixed sporadically error in testCymruInfoNxdomain, because of unsorted values
\* Misleading errors logged from ignorecommand in success case on retcode 1 (gh-1194)
\* fail2ban.service - systemd service updated (gh-1618):
- starting service in normal mode (without forking)
- does not restart if service exited normally (exit-code 0, e.g. stopped via fail2ban-client)
- does not restart if service can not start (exit-code 255, e.g. wrong configuration, etc.)
- service can be additionally started/stopped with commands (fail2ban-client, fail2ban-server)
- automatically creates `/var/run/fail2ban` directory before start fail2ban
(systems with virtual resp. memory-based FS for `/var/run`), see gh-1531
- if fail2ban running as systemd-service, for logging to the systemd-journal,
the `logtarget` could be set to STDOUT
- value `logtarget` for system targets allowed also in lowercase (stdout, stderr, syslog, etc.)
\* Fixed UTC/GMT named time zone, using `%Z` and `%z` patterns
(special case with 0 zone offset, see gh-1575)
\* `filter.d/freeswitch.conf`
- Optional prefixes (server, daemon, dual time) if systemd daemon logs used (gh-1548)
- User part rewritten to accept IPv6 resp. domain after "@" (gh-1548)
### New Features
\* IPv6 support:
- IP addresses are now handled as objects rather than strings capable for
handling both address types IPv4 and IPv6
- iptables related actions have been amended to support IPv6 specific actions
additionally
- hostsdeny and route actions have been tested to be aware of v4 and v6 already
- pf action for \*BSD systems has been improved and supports now also v4 and v6
- name resolution is now working for either address type
- new conditional section functionality used in config resp. includes:
- [Init?family=inet4] - IPv4 qualified hosts only
- [Init?family=inet6] - IPv6 qualified hosts only
\* Increment ban time (+ observer) functionality introduced.
Thanks Serg G. Brester (sebres)
\* Database functionality extended with bad ips.
\* New reload functionality (now totally without restart, unbanning/rebanning, etc.),
see gh-1557
\* Several commands extended and new commands introduced:
- `restart [--unban] [--if-exists] ` - restarts the jail \
(alias for `reload --restart ... `)
- `reload [--restart] [--unban] [--all]` - reloads the configuration without restarting
of the server, the option `--restart` activates completely restarting of affected jails,
thereby can unban IP addresses (if option `--unban` specified)
- `reload [--restart] [--unban] [--if-exists] ` - reloads the jail \,
or restarts it (if option `--restart` specified), at the same time unbans all IP addresses
banned in this jail, if option `--unban` specified
- `unban --all` - unbans all IP addresses (in all jails and database)
- `unban  ... ` - unbans \ (in all jails and database) (see gh-1388)
- introduced new option `-t` or `--test` to test configuration resp. start server only
if configuration is clean (fails by wrong configured jails if option `-t` specified)
\* New command action parameter `actionrepair` - command executed in order to restore
sane environment in error case of `actioncheck`.
\* Reporting via abuseipdb.com:
- Bans can now be reported to abuseipdb
- Categories must be set in the config
- Relevant log lines included in report
### Enhancements
\* Huge increasing of fail2ban performance and especially test-cases performance (see gh-1109)
\* Datedetector: in-place reordering using hits and last used time:
matchTime, template list etc. rewritten because of performance degradation
\* Prevent out of memory situation if many IP's makes extremely many failures (maxEntries)
\* Introduced string to seconds (str2seconds) for configuration entries with time,
use `1h` instead of `3600`, `1d` instead of `86400`, etc
\* seekToTime - prevent completely read of big files first time (after start of service),
initial seek to start time using half-interval search algorithm (see issue gh-795)
\* Ticket and some other modules prepared to easy merge with newest version of 'ban-time-incr'
\* Cache dnsToIp, ipToName to prevent long wait during retrieving of ip/name,
especially for wrong dns or lazy dns-system
\* FailManager memory-optimization: increases performance,
prevents memory leakage, because don't copy failures list on some operations
\* fail2ban-testcases - new options introduced:
- `-f`, `--fast` to decrease wait intervals, avoid passive waiting, and skip
few very slow test cases (implied memory database, see `-m` and no gamin tests `-g`)
- `-g`, `--no-gamin` to prevent running of tests that require the gamin (slow)
- `-m`, `--memory-db` - run database tests using memory instead of file
- `-i`, `--ignore` - negate [regexps] filter to ignore tests matched specified regexps
\* Background servicing: prevents memory leak on some platforms/python versions, using forced GC
in periodic intervals (latency and threshold)
\* executeCmd partially moved from action to new module utils
\* Several functionality of class `DNSUtils` moved to new class `IPAddr`,
both classes moved to new module `ipdns`
\* Pseudo-conditional section introduced, for conditional substitution resp.
evaluation of parameters for different family qualified hosts,
syntax `[Section?family=inet6]` (currently use for IPv6-support only).
\* All the backends were rewritten to get reload-possibility, performance increased,
so fewer greedy regarding cpu- resp. system-load now
\* Numeric log-level allowed now in server (resp. fail2ban.conf);
\* Implemented better error handling in some multi-threaded routines; shutdown of jails
rewritten (faster and safer, does not breaks shutdown process if some error occurred)
\* Possibility for overwriting some configuration options (read with config-readers)
with command line option, e. g.:
```bash
## start server with DEBUG log-level (ignore level read from fail2ban.conf):
fail2ban-client --loglevel DEBUG start
## or
fail2ban-server -c /cfg/path --loglevel DEBUG start
## keep server log-level by reload (without restart it)
fail2ban-client --loglevel DEBUG reload
## switch log-level back to INFO:
fail2ban-client set loglevel INFO
```
\* Optimized BanManager: increase performance, fewer system load, try to prevent
memory leakage:
- better ban/unban handling within actions (e.g. used dict instead of list)
- don't copy bans resp. its list on some operations;
- added new unbantime handling to relieve unBanList (prevent permanent
searching for tickets to unban)
- prefer failure-ID as identifier of the ticket to its IP (most of the time
the same, but it can be something else e.g. user name in some complex jails,
as introduced in 0.10)
\* Regexp enhancements:
- build replacement of `` substitution corresponding parameter
`usedns` - dns-part will be added only if `usedns` is not `no`,
also using fail2ban-regex
- new replacement for `` in opposition to ``, for separate
usage of 2 address groups only (regardless of `usedns`), `ip4` and `ip6`
together, without host (dns)
\* Misconfigured jails don't prevent fail2ban from starting, server starts
nevertheless, as long as one jail was successful configured (gh-1619)
Message about wrong jail configuration logged in client log (stdout, systemd
journal etc.) and in server log with error level
\* More precise date template handling (WARNING: theoretically possible incompatibilities):
- datedetector rewritten more strict as earlier;
- default templates can be specified exacter using prefix/suffix syntax (via `datepattern`);
- more as one date pattern can be specified using option `datepattern` now
(new-line separated);
- some default options like `datepattern` can be specified directly in
section `[Definition]`, that avoids contrary usage of unnecessarily `[Init]`
section, because of performance (each extra section costs time);
- option `datepattern` can be specified in jail also (e. g. jails without filters
or custom log-format, new-line separated for multiple patterns);
- if first unnamed group specified in pattern, only this will be cut out from
search log-line (e. g.: `^date:[({DATE})]` will cut out only datetime match
pattern, and leaves `date:[] ...` for searching in filter);
- faster match and fewer searching of appropriate templates
(DateDetector.matchTime calls rarer DateTemplate.matchDate now);
- several standard filters extended with exact prefixed or anchored date templates;
\* Added possibility to recognize restored state of the tickets (see gh-1669).
New option `norestored` introduced, to ignore restored tickets (after restart).
To avoid execution of ban/unban for the restored tickets, `norestored = true`
could be added in definition section of action.
For conditional usage in the shell-based actions an interpolation ``
could be used also. E. g. it is enough to add following script-piece at begin
of `actionban` (or `actionunban`) to prevent execution:
`if [ '' = '1' ]; then exit 0; fi;`
Several actions extended now using `norestored` option:
- complain.conf
- dshield.conf
- mail-buffered.conf
- mail-whois-lines.conf
- mail-whois.conf
- mail.conf
- sendmail-buffered.conf
- sendmail-geoip-lines.conf
- sendmail-whois-ipjailmatches.conf
- sendmail-whois-ipmatches.conf
- sendmail-whois-lines.conf
- sendmail-whois-matches.conf
- sendmail-whois.conf
- sendmail.conf
- smtp.py
- xarf-login-attack.conf
\* fail2ban-testcases:
- `assertLogged` extended with parameter wait (to wait up to specified timeout,
before we throw assert exception) + test cases rewritten using that
- added `assertDictEqual` for compatibility to early python versions (< 2.7);
- new `with\_foreground\_server\_thread` decorator to test several client/server commands
ver. 0.9.8 (2016/XX/XXX) - wanna-be-released
-----------
0.9.x line is no longer heavily developed. If you are interested in
new features (e.g. IPv6 support), please consider 0.10 branch and its
releases.
### Fixes
\* Fix for systemd-backend: fail2ban hits the ulimit (out of file descriptors), see gh-991.
Partially back-ported from v.0.10.
\* action.d/bsd-ipfw.conf
- Make the rule number, the action starts looking for a free slot to insert
the new rule, configurable (gh-1689)
- Replace not posix-compliant grep option: fgrep with `-q` option can cause
141 exit code in some cases (gh-1389)
\* filter.d/apache-overflows.conf:
- Fixes resources greedy expression (see gh-1790);
- Rewritten without end-anchor ($), because of potential vulnerability on very long URLs.
\* filter.d/apache-badbots.conf - extended to recognize Jorgee Vulnerability Scanner (gh-1882)
\* filter.d/asterisk.conf
- fixed failregex AMI Asterisk authentication failed (see gh-1302)
- removed invalid (vulnerable) regex blocking IPs using forign data (from header "from")
thus not the IP-address that really originates the request (see gh-1927)
- fixed failregex for the SQL-injection attempts with single-quotes in connect-string (see gh-2011)
\* filter.d/dovecot.conf:
- fixed failregex, see gh-1879 (partially cherry-picked from gh-1880)
- extended to match pam\_authenticate failures with "Permission denied" (gh-1897)
\* filter.d/exim.conf
- fixed failregex for case of flood attempts with `D=0s` (gh-1887)
- fixed failregex of "AUTH command used when not advertised" to better handle the foreign
input SMTP command (lower/mixed case auth command, prevent injection) (gh-1979)
\* filter.d/postfix-\*.conf - added optional port regex (gh-1902)
\* filter.d/sendmail-auth.conf - extended daemon for Fedora 24/RHEL - the daemon name is "sendmail" (gh-1632)
\* filter.d/nginx-http-auth.conf - match usernames with spaces (gh-2015)
### New Features
### Enhancements
\* action.d/cloudflare.conf - Cloudflare API v4 implementation (gh-1651)
\* action.d/firewallcmd-ipset.conf - new parameter `actiontype`, provides `allports` capability (gh-1167)
\* filter.d/kerio.conf - filter extended with new rules (see gh-1455)
\* filter.d/phpmyadmin-syslog.conf - new filter for phpMyAdmin using syslog for auth logging
\* filter.d/zoneminder.conf - new filter for ZoneMinder (gh-1376)
ver. 0.9.7 (2017/05/11) - awaiting-victory
-----------
### Fixes
\* Fixed a systemd-journal handling in fail2ban-regex (gh-1657)
\* filter.d/sshd.conf
- Fixed non-anchored part of failregex (misleading match of colon inside
IPv6 address instead of `: ` in the reason-part by missing space, gh-1658)
(0.10th resp. IPv6 relevant only, amend for gh-1479)
\* config/pathes-freebsd.conf
- Fixed filenames for apache and nginx log files (gh-1667)
\* filter.d/exim.conf
- optional part `(...)` after host-name before `[IP]` (gh-1751)
- new reason "Unrouteable address" for "rejected RCPT" regex (gh-1762)
- match of complex time like `D=2m42s` in regex "no MAIL in SMTP connection" (gh-1766)
\* filter.d/sshd.conf
- new aggressive rules (gh-864):
- Connection reset by peer (multi-line rule during authorization process)
- No supported authentication methods available
- single line and multi-line expression optimized, added optional prefixes
and suffix (logged from several ssh versions), according to gh-1206;
- fixed expression received disconnect auth fail (optional space after port
part, gh-1652)
and suffix (logged from several ssh versions), according to gh-1206;
\* filter.d/suhosin.conf
- greedy catch-all before `` fixed (potential vulnerability)
\* filter.d/cyrus-imap.conf
- accept entries without login-info resp. hostname before IP address (gh-1707)
\* Filter tests extended with check of all config-regexp, that contains greedy catch-all
before ``, that is hard-anchored at end or precise sub expression after ``
### New Features
\* New Actions:
- action.d/netscaler: Block IPs on a Citrix Netscaler ADC (gh-1663)
\* New Filters:
- filter.d/domino-smtp: IBM Domino SMTP task (gh-1603)
### Enhancements
\* Introduced new log-level `MSG` (as INFO-2, equivalent to 18)
ver. 0.9.6 (2016/12/10) - stretch-is-coming
-----------
### Fixes
\* Misleading add resp. enable of (already available) jail in database, that
induced a subsequent error: last position of log file will be never retrieved (gh-795)
\* Fixed a distribution related bug within testReadStockJailConfForceEnabled
(e.g. test-cases faults on Fedora, see gh-1353)
\* Fixed pythonic filters and test scripts (running via wrong python version,
uses "fail2ban-python" now);
\* Fixed test case "testSetupInstallRoot" for not default python version (also
using direct call, out of virtualenv);
\* Fixed ambiguous wrong recognized date pattern resp. its optional parts (see gh-1512);
\* FIPS compliant, use sha1 instead of md5 if it not allowed (see gh-1540)
\* Monit config: scripting is not supported in path (gh-1556)
\* `filter.d/apache-modsecurity.conf`
- Fixed for newer version (one space, gh-1626), optimized: non-greedy catch-all
replaced for safer match, unneeded catch-all anchoring removed, non-capturing
\* `filter.d/asterisk.conf`
- Fixed to match different asterisk log prefix (source file: method:)
\* `filter.d/dovecot.conf`
- Fixed failregex ignores failures through some not relevant info (gh-1623)
\* `filter.d/ignorecommands/apache-fakegooglebot`
- Fixed error within apache-fakegooglebot, that will be called
with wrong python version (gh-1506)
\* `filter.d/assp.conf`
- Extended failregex and test cases to handle ASSP V1 and V2 (gh-1494)
\* `filter.d/postfix-sasl.conf`
- Allow for having no trailing space after 'failed:' (gh-1497)
\* `filter.d/vsftpd.conf`
- Optional reason part in message after FAIL LOGIN (gh-1543)
\* `filter.d/sendmail-reject.conf`
- removed mandatory double space (if dns-host available, gh-1579)
\* filter.d/sshd.conf
- recognized "Failed publickey for" (gh-1477);
- optimized failregex to match all of "Failed any-method for ... from " (gh-1479)
- eliminated possible complex injections (on user-name resp. auth-info, see gh-1479)
- optional port part after host (see gh-1533, gh-1581)
### New Features
\* New Actions:
- `action.d/npf.conf` for NPF, the latest packet filter for NetBSD
\* New Filters:
- `filter.d/mongodb-auth.conf` for MongoDB (document-oriented NoSQL database engine)
(gh-1586, gh-1606 and gh-1607)
### Enhancements
\* DateTemplate regexp extended with the word-end boundary, additionally to
word-start boundary
\* Introduces new command "fail2ban-python", as automatically created symlink to
python executable, where fail2ban currently installed (resp. its modules are located):
- allows to use the same version, fail2ban currently running, e.g. in
external scripts just via replace python with fail2ban-python:
```diff
-#!/usr/bin/env python
+#!/usr/bin/env fail2ban-python
```
- always the same pickle protocol
- the same (and also guaranteed available) fail2ban modules
- simplified stand-alone install, resp. stand-alone installation possibility
via setup (like gh-1487) is getting closer
\* Several test cases rewritten using new methods assertIn, assertNotIn
\* New forward compatibility method assertRaisesRegexp (normally python >= 2.7).
Methods assertIn, assertNotIn, assertRaisesRegexp, assertLogged, assertNotLogged
are test covered now
\* Jail configuration extended with new syntax to pass options to the backend (see gh-1408),
examples:
- `backend = systemd[journalpath=/run/log/journal/machine-1]`
- `backend = systemd[journalfiles="/run/log/journal/machine-1/system.journal, /run/log/journal/machine-1/user.journal"]`
- `backend = systemd[journalflags=2]`
ver. 0.9.5 (2016/07/15) - old-not-obsolete
-----------
### Fixes
\* `filter.d/monit.conf`
- Extended failregex with new monit "access denied" version (gh-1355)
- failregex of previous monit version merged as single expression
\* `filter.d/postfix.conf`, `filter.d/postfix-sasl.conf`
- Extended failregex daemon part, matching also `postfix/smtps/smtpd`
now (gh-1391)
\* Fixed a grave bug within tags substitutions because of incorrect
detection of recursion in case of multiple inline substitutions
of the same tag (affected actions: `bsd-ipfw`, etc). Now tracks
the actual list of the already substituted tags (per tag instead
of single list)
\* `filter.d/common.conf`
- Unexpected extra regex-space in generic `\_\_prefix\_line` (gh-1405)
- All optional spaces normalized in `common.conf`, test covered now
- Generic `\_\_prefix\_line` extended with optional brackets for the
date ambit (gh-1421), added new parameter `\_\_date\_ambit`
\* `gentoo-initd` fixed `--pidfile` bug: `--pidfile` is option of
`start-stop-daemon`, not argument of fail2ban (see gh-1434)
\* `filter.d/asterisk.conf`
- Fixed security log support for PJSIP and Asterisk 13+ (gh-1456)
- Improved log support for PJSIP and Asterisk 13+ with different
callID (gh-1458)
### New Features
\* New Actions:
- `action.d/firewallcmd-rich-rules` and `action.d/firewallcmd-rich-logging`
(gh-1367)
\* New filters:
- slapd - ban hosts, that were failed to connect with invalid
credentials: error code 49 (gh-1478)
### Enhancements
\* Extreme speedup of all sqlite database operations (gh-1436),
by using of following sqlite options:
- (synchronous = OFF) write data through OS without syncing
- (journal\_mode = MEMORY) use memory for the transaction logging
- (temp\_store = MEMORY) temporary tables and indices are kept in memory
\* journald journalmatch for pure-ftpd (gh-1362)
\* Added additional regex filter for dovecot ldap authentication failures (gh-1370)
\* `filter.d/exim\*conf`
- Added additional regexes (gh-1371)
- Made port entry optional
ver. 0.9.4 (2016/03/08) - for-you-ladies
-----------
### Fixes
\* `roundcube-auth` jail typo for logpath
\* Fix dnsToIp resolver for fqdn with large list of IPs (gh-1164)
\* `filter.d/apache-badbots.conf`
- Updated useragent string regex adding escape for `+`
\* `filter.d/mysqld-auth.conf`
- Updated "Access denied ..." regex for MySQL 5.6 and later (gh-1211, gh-1332)
\* `filter.d/sshd.conf`
- Updated "Auth fail" regex for OpenSSH 5.9 and later
\* Treat failed and killed execution of commands identically (only
different log messages), which addresses different behavior on different
exit codes of dash and bash (gh-1155)
\* Fix jail.conf.5 man's section (gh-1226)
\* Fixed default banaction for allports jails like pam-generic, recidive, etc
with new default variable `banaction\_allports` (gh-1216)
\* Fixed `fail2ban-regex` stops working on invalid (wrong encoded) character
for python version < 3.x (gh-1248)
\* Use postfix\_log logpath for postfix-rbl jail
\* `filters.d/postfix.conf` - add 'Sender address rejected: Domain not found' failregex
\* use `fail2ban\_agent` as user-agent in actions badips, blocklist\_de, etc (gh-1271)
\* Fix ignoring the sender option by action\_mw, action\_mwl and action\_c\_mwl
\* Changed `filter.d/asterisk` regex for "Call from ..." (few vulnerable now)
\* Removed compression and rotation count from logrotate (inherit them from
the global logrotate config)
### New Features
\* New interpolation feature for definition config readers - ``
(means last known init definition of filters or actions with name `parameter`).
This interpolation makes possible to extend a parameters of stock filter or
action directly in jail inside jail.local file, without creating a separately
`filter.d/\*.local` file.
As extension to interpolation `%(known/parameter)s`, that does not works for
filter and action init parameters
\* New actions:
- `nftables-multiport` and `nftables-allports` - filtering using nftables
framework. Note: it requires a pre-existing chain for the filtering rule.
\* New filters:
- `openhab` - domotic software authentication failure with the
rest api and web interface (gh-1223)
- `nginx-limit-req` - ban hosts, that were failed through nginx by limit
request processing rate (ngx\_http\_limit\_req\_module)
- `murmur` - ban hosts that repeatedly attempt to connect to
murmur/mumble-server with an invalid server password or certificate.
- `haproxy-http-auth` - filter to match failed HTTP Authentications against a
HAProxy server
\* New jails:
- `murmur` - bans TCP and UDP from the bad host on the default murmur port.
\* `sshd` filter got new failregex to match "maximum authentication
attempts exceeded" (introduced in openssh 6.8)
\* Added filter for Mac OS screen sharing (VNC) daemon
### Enhancements
\* Do not rotate empty log files
\* Added new date pattern with year after day (e.g. `Sun Jan 23 2005 21:59:59`)
http://bugs.debian.org/798923
\* Added openSUSE path configuration (Thanks Johannes Weberhofer)
\* Allow to split ignoreip entries by ',' as well as by ' ' (gh-1197)
\* Added a timeout (3 sec) to urlopen within badips.py action
(Thanks M. Maraun)
\* Added check against atacker's Googlebot PTR fake records
(Thanks Pablo Rodriguez Fernandez)
\* Enhance filter against atacker's Googlebot PTR fake records
(gh-1226)
\* Nginx log paths extended (prefixed with "\*" wildcard) (gh-1237)
\* Added filter for openhab domotic software authentication failure with the
rest api and web interface (gh-1223)
\* Add `\*\_backend` options for services to allow distros to set the default
backend per service, set default to systemd for Fedora as appropriate
\* Performance improvements while monitoring large number of files (gh-1265).
Use associative array (dict) for monitored log files to speed up lookup
operations. Thanks @kshetragia
\* Specified that fail2ban is PartOf iptables.service `firewalld.service` in
`.service` file -- would reload fail2ban if those services are restarted
\* Provides new default `fail2ban\_version` and interpolation variable
`fail2ban\_agent` in jail.conf
\* Enhance filter 'postfix' to ban incoming SMTP client with no fqdn hostname,
and to support multiple instances of postfix having varying suffix (gh-1331)
(Thanks Tom Hendrikx)
\* `files/gentoo-initd` to use `start-stop-daemon` to robustify restarting the service
ver. 0.9.3 (2015/08/01) - lets-all-stay-friends
----------
### IMPORTANT incompatible changes
\* `filter.d/roundcube-auth.conf`
- Changed logpath to 'errors' log (was 'userlogins')
\* `action.d/iptables-common.conf`
- All calls to iptables command now use -w switch introduced in
iptables 1.4.20 (some distribution could have patched their
earlier base version as well) to provide this locking mechanism
useful under heavy load to avoid contesting on iptables calls.
If you need to disable, define `action.d/iptables-common.local`
with empty value for 'lockingopt' in `[Init]` section.
\* `mail-whois-lines`, `sendmail-geoip-lines` and `sendmail-whois-lines`
actions now include by default only the first 1000 log lines in
the emails. Adjust `` to augment the behavior.
### Fixes
\* reload in interactive mode appends all the jails twice (gh-825)
\* reload server/jail failed if database used (but was not changed) and
some jail active (gh-1072)
\* `filter.d/dovecot.conf` - also match unknown user in passwd-file.
Thanks Anton Shestakov
\* Fix fail2ban-regex not parsing journalmatch correctly from filter config
\* `filter.d/asterisk.conf` - fix security log support for Asterisk 12+
\* `filter.d/roundcube-auth.conf`
- Updated regex to work with 'errors' log (1.0.5 and 1.1.1)
- Added regex to work with 'userlogins' log
\* `action.d/sendmail\*.conf` - use LC\_ALL (superseding LC\_TIME) to override
locale on systems with customized LC\_ALL
\* performance fix: minimizes connection overhead, close socket only at
communication end (gh-1099)
\* unbanip always deletes ip from database (independent of bantime, also if
currently not banned or persistent)
\* guarantee order of dbfile to be before dbpurgeage (gh-1048)
\* always set 'dbfile' before other database options (gh-1050)
\* kill the entire process group of the child process upon timeout (gh-1129).
Otherwise could lead to resource exhaustion due to hanging whois
processes.
\* resolve `/var/run/fail2ban` path in setup.py to help installation
on platforms with `/var/run` -> /run symlink (gh-1142)
### New Features
\* RETURN iptables target is now a variable: ``
\* New type of operation: pass2allow, use fail2ban for "knocking",
opening a closed port by swapping blocktype and returntype
\* New filters:
- froxlor-auth - Thanks Joern Muehlencord
- apache-pass - filter Apache access log for successful authentication
\* New actions:
- shorewall-ipset-proto6 - using proto feature of the Shorewall. Still requires
manual pre-configuration of the shorewall. See the action file for detail.
\* New jails:
- pass2allow-ftp - allows FTP traffic after successful HTTP authentication
### Enhancements
\* `action.d/cloudflare.conf` - improved documentation on how to allow
multiple CF accounts, and jail.conf got new compound action
definition action\_cf\_mwl to submit cloudflare report.
\* Check access to socket for more detailed logging on error (gh-595)
\* fail2ban-testcases man page
\* `filter.d/apache-badbots.conf`, `filter.d/nginx-botsearch.conf` - add
HEAD method verb
\* Revamp of Travis and coverage automated testing
\* Added a space between IP address and the following colon
in notification emails for easier text selection
\* Character detection heuristics for whois output via optional setting
in mail-whois\*.conf. Thanks Thomas Mayer.
Not enabled by default, if \_whois\_command is set to be
%(\_whois\_convert\_charset)s (e.g. in `action.d/mail-whois-common.local`),
it
- detects character set of whois output (which is undefined by
RFC 3912) via heuristics of the file command
- converts whois data to UTF-8 character set with iconv
- sends the whois output in UTF-8 character set to mail program
- avoids that heirloom mailx creates binary attachment for input with
unknown character set
ver. 0.9.2 (2015/04/29) - better-quick-now-than-later
----------
### Fixes
\* Fix ufw action commands
\* infinite busy loop on \_escapedTags match in substituteRecursiveTags gh-907.
Thanks TonyThompson
\* port[s] typo in jail.conf/nginx-http-auth gh-913. Thanks Frederik Wagner
(fnerdwq)
\* $ typo in jail.conf. Thanks Skibbi. Debian bug #767255
\* grep'ing for IP in \*mail-whois-lines.conf should now match also
at the beginning and EOL. Thanks Dean Lee
\* `jail.conf`
- `php-url-fopen`: separate logpath entries by newline
\* failregex declared direct in jail was joined to single line (specifying of
multiple expressions was not possible).
\* `filters.d/exim.conf` - cover different settings of exim logs
details. Thanks bes.internal
\* `filter.d/postfix-sasl.conf` - failregex is now case insensitive
\* `filters.d/postfix.conf` - add 'Client host rejected error message' failregex
\* `fail2ban/\_\_init\_\_.py` - add strptime thread safety hack-around
\* recidive uses `iptables-allports` banaction by default now.
Avoids problems with iptables versions not understanding 'all' for
protocols and ports
\* `filter.d/dovecot.conf`
- match pam\_authenticate line from EL7
- match unknown user line from EL7
\* Use `use\_poll=True` for Python 2.7 and >=3.4 to overcome "Bad file
descriptor" msgs issue (gh-161)
\* `filter.d/postfix-sasl.conf` - tweak failregex and add ignoreregex to ignore
system authentication issues
\* fail2ban-regex reads filter file(s) completely, incl. '.local' file etc.
(gh-954)
\* firewallcmd-\* actions: split output into separate lines for grepping (gh-908)
\* Guard unicode encode/decode issues while storing records in the database.
Fixes "binding parameter error (unsupported type)" (gh-973), thanks to kot
for reporting
\* `filter.d/sshd` added regex for matching openSUSE ssh authentication failure
\* `filter.d/asterisk.conf`:
- Dropped "Sending fake auth rejection" failregex since it incorrectly
targets the asterisk server itself
- match "hacking attempt detected" logs
### New Features
\* New filters:
- postfix-rbl Thanks Lee Clemens
- apache-fakegooglebot.conf Thanks Lee Clemens
- nginx-botsearch Thanks Frantisek Sumsal
- drupal-auth Thanks Lee Clemens
\* New recursive embedded substitution feature added:
- `<HOST>` becomes `` for PREF=`IPV4`;
- `<HOST>` becomes `1.2.3.4` for PREF=`IPV4` and IPV4HOST=`1.2.3.4`;
\* New interpolation feature for config readers - `%(known/parameter)s`.
(means last known option with name `parameter`). This interpolation makes
possible to extend a stock filter or jail regexp in .local file
(opposite to simply set failregex/ignoreregex that overwrites it),
see gh-867.
\* Monit config for fail2ban in `files/monit/`
\* New actions:
- `action.d/firewallcmd-multiport` and `action.d/firewallcmd-allports` Thanks Donald Yandt
- `action.d/sendmail-geoip-lines.conf`
- `action.d/nsupdate` to update DNSBL. Thanks Andrew St. Jean
\* New status argument for fail2ban-client -- flavor:
`fail2ban-client status  [flavor]`
- empty or "basic" works as-is
- "cymru" additionally prints (ASN, Country RIR) per banned IP
(requires dnspython or dnspython3)
\* Flush log at USR1 signal
### Enhancements
\* Enable multiport for firewallcmd-new action. Closes gh-834
\* files/debian-initd migrated from the debian branch and should be
suitable for manual installations now (thanks Juan Karlo de Guzman)
\* Define empty ignoreregex in filters which didn't have it to avoid
warnings (gh-934)
\* `action.d/{sendmail-\*,xarf-login-attack}.conf` - report local
timezone not UTC time/zone. Closes gh-911
\* Conditionally log Ignore IP with reason (dns, ip, command). Closes gh-916
\* Absorbed DNSUtils.cidr into addr2bin in filter.py, added unittests
\* Added syslogsocket configuration to fail2ban.conf
\* Note in the `jail.conf` for the recidive jail to increase dbpurgeage (gh-964)
ver. 0.9.1 (2014/10/29) - better, faster, stronger
----------
### Refactoring (IMPORTANT -- Please review your setup and configuration)
\* `iptables-common.conf` replaced `iptables-blocktype.conf`
(`iptables-blocktype.local` should still be read) and now also
provides defaults for the chain, port, protocol and name tags
### Fixes
\* start of file2ban aborted (on slow hosts, systemd considers the server has
been timed out and kills him), see gh-824
\* UTF-8 fixes in pure-ftp thanks to Johannes Weberhofer. Closes gh-806.
\* systemd backend error on bad utf-8 in python3
\* badips.py action error when logging HTTP error raised with badips request
\* fail2ban-regex failed to work in python3 due to space/tab mix
\* recidive regex samples incorrect log level
\* journalmatch for recidive incorrect PRIORITY
\* loglevel couldn't be changed in fail2ban.conf
\* Handle case when no sqlite library is available for persistent database
\* Only reban once per IP from database on fail2ban restart
\* Nginx filter to support missing server\_name. Closes gh-676
\* fail2ban-regex assertion error caused by miscount missed lines with
multiline regex
\* Fix actions failing to execute for Python 3.4.0. Workaround for
http://bugs.python.org/issue21207
\* Database now returns persistent bans on restart (bantime < 0)
\* Recursive action tags now fully processed. Fixes issue with bsd-ipfw
action
\* Fixed TypeError with "ipfailures" and "ipjailfailures" action tags.
Thanks Serg G. Brester
\* Correct times for non-timezone date times formats during DST
\* Pass a copy of, not original, aInfo into actions to avoid side-effects
\* Per-distribution paths to the exim's main log
\* Ignored IPs are no longer banned when being restored from persistent
database
\* Manually unbanned IPs are now removed from persistent database, such they
won't be banned again when Fail2Ban is restarted
\* Pass "bantime" parameter to the actions in default jail's action
definition(s)
\* `filters.d/sieve.conf` - fixed typo in \_daemon. Thanks Jisoo Park
\* cyrus-imap -- also catch also failed logins via secured (imaps/pop3s).
Regression was introduced while strengthening failregex in 0.8.11 (bd175f)
Debian bug #755173
\* postfix-sasl - added journalmatch. Thanks Luc Maisonobe
\* postfix\* - match with a new daemon string (postfix/submission/smtpd).
Closes gh-804 . Thanks Paul Traina
\* apache - added filter for AH01630 client denied by server configuration.
### New Features
\* New filters:
- monit Thanks Jason H Martin
- directadmin Thanks niorg
- apache-shellshock Thanks Eugene Hopkinson (SlowRiot)
\* New actions:
- symbiosis-blacklist-allports for Bytemark symbiosis firewall
- fail2ban-client can fetch the running server version
- Added Cloudflare API action
### Enhancements
\* Start performance of fail2ban-client (and tests) increased, start time
and cpu usage rapidly reduced. Introduced a shared storage logic, to
bypass reading lots of config files (see gh-824).
Thanks to Joost Molenaar for good catch (reported gh-820).
\* Fail2ban-regex - add print-all-matched option. Closes gh-652
\* Suppress fail2ban-client warnings for non-critical config options
\* Match non "Bye Bye" disconnect messages for sshd locked account regex
\* courier-smtp filter:
- match lines with user names
- match lines containing "535 Authentication failed" attempts
\* Add `` tag to iptables-ipsets
\* Realign fail2ban log output with white space to improve readability. Does
not affect SYSLOG output
\* Log unhandled exceptions
\* cyrus-imap: catch "user not found" attempts
\* Add support for Portsentry
ver. 0.9.0 (2014/03/14) - beta
----------
Carries all fixes, features and enhancements from 0.8.13 (unreleased) with
major changes.
The minimum supported python version is now 2.6. If you have python-2.4 or 2.5
you can use the 0.8.12 version of fail2ban.
Please take note of release notes:
https://github.com/fail2ban/fail2ban/releases/tag/0.9.0
Please test your configuration before relying on it.
Nearly all development is thanks to Steven Hiscocks (THANKS!), merging,
testcases and timezone support from Daniel Black, and code-review and minor
additions from Yaroslav Halchenko.
### Refactoring (IMPORTANT -- Please review your setup and configuration):
\* [..bddbf1e] jail.conf was heavily refactored and now is similar
to how it looked on Debian systems:
- default action could be configured once for all jails
- jails definitions only provide customizations (port, logpath)
- no need to specify 'filter' if name matches jail name
\* [..5aef036] Core functionality moved into fail2ban/ module.
Closes gh-26
- tests included in module to aid testing and debugging
\* Added fail2ban persistent database
- default location at `/var/lib/fail2ban/fail2ban.sqlite3`
- allows active bans to be reinstated on restart
- log files read from last position after restart
\* Added systemd journal backend
- Dependency on python-systemd
- New "journalmatch" option added to filter configs files
- New "systemd-journal" option added to fail2ban-regex
\* Added python3 support
\* Support %z (Timezone offset) and %f (sub-seconds) support for
datedetector. Enhanced existing date/time have been updated patterns to
support these. ISO8601 now defaults to localtime unless specified otherwise.
Some filters have been change as required to capture these elements in the
right timezone correctly.
\* Log levels are now set by Syslog style strings e.g. DEBUG, ERROR.
- Log level INFO is now more verbose
\* Optionally can read log files starting from "head" or "tail".
- See "logpath" option in jail.conf(5) man page.
\* Can now set log encoding for files per jail.
- Default uses systemd locale.
### New Features
\* [..c7ae460] Multiline failregex. Close gh-54
\* [8af32ed] Guacamole filter and support for Apache Tomcat date
format
\* [..b6059f4] 'timeout' option for actions Close gh-60 and Debian
bug #410077. Also it would now capture and include stdout and stderr
into logging messages in case of error or at DEBUG loglevel.
\* Added action xarf-login-attack to report formatted attack messages
according to the XARF standard (v0.2). Close gh-105
\* Support PyPy
\* Add filter for apache-botsearch
\* Add filter for kerio. Thanks Tony Lawrence for blog of regexs and
providing samples. Close gh-120
\* Filter for stunnel
\* Filter for Counter Strike 1.6. Thanks to onorua for logs.
Close gh-347
\* Filter for squirrelmail. Close gh-261
\* Filter for tine20. Close gh-583
\* Custom date formats (strptime) can now be set in filters and jail.conf
\* Python based actions can now be created.
- SMTP action for sending emails on jail start, stop and ban.
\* Added action to use badips.com reporting and blacklist
- Requires Python 2.7+
### Enhancements
\* Fail2ban-regex - don't accumulate lines if not printing them.
add options to suppress output of missed/ignored lines. Close gh-644
\* Asterisk now supports syslog format
\* Jail names increased to 26 characters and iptables prefix reduced
from fail2ban- to f2b- as suggested by buanzo in gh-462.
\* Multiline filter for sendmail-spam. Close gh-418
\* Multiline regex for Disconnecting: Too many authentication failures for
root [preauth]\nConnection closed by 6X.XXX.XXX.XXX [preauth]
\* Multiline regex for Disconnecting: Connection from 61.XX.XX.XX port
51353\nToo many authentication failures for root [preauth]. Thanks
Helmut Grohne. Close gh-457
\* Replacing use of deprecated API (.warning, .assertEqual, etc)
\* [..a648cc2] Filters can have options now too which are substituted into
failregex / ignoreregex
\* [..e019ab7] Multiple instances of the same action are allowed in the
same jail -- use actname option to disambiguate.
\* Add honeypot email address to exim-spam filter as argument
\* Properties and methods of actions accessible from fail2ban-client
- Use of properties replaces command actions "cinfo" interface
ver. 0.8.13 (2014/03/15) - maintenance-only-from-now-on
-----------
### Fixes
- action firewallcmd-ipset had non-working actioncheck. Removed.
redhat bug #1046816.
- filter pureftpd - added \_daemon which got removed. Added
### New Features
- filter nagios - detects unauthorized access to the nrpe daemon (Ivo Truxa)
- filter sendmail-{auth,reject} (jserrachinha and cepheid666 and fab23).
### Enhancements
- filter asterisk now supports syslog format
- filter pureftpd - added all translations of "Authentication failed for
user"
- filter dovecot - lip= was optional and extended TLS errors can occur.
Thanks Noel Butler.
ver. 0.8.12 (2014/01/22) - things-can-only-get-better
----------
- IMPORTANT incompatible changes:
- Rename firewall-cmd-direct-new to firewallcmd-new to fit within jail name
name length. As per gh-395
- mysqld-syslog-iptables jailname was too long. Renamed to mysqld-syslog.
Part of gh-447.
### Fixes
- allow for ",milliseconds" in the custom date format of proftpd.log
- allow for ", referer ..." in apache-\* filter for apache error logs.
- allow for spaces at the beginning of kernel messages. Closes gh-448
- recidive jail to block all protocols. Closes gh-440. Thanks Ioan Indreias
- smtps not a IANA standard and has been removed from Arch. Replaced with
465. Thanks Stefan. Closes gh-447
- add 'flushlogs' command to allow logrotation without clobbering logtarget
settings. Closes gh-458, Debian bug #697333, Redhat bug #891798.
- complain action - ensure where not matching other IPs in log sample.
Closes gh-467
- Fix firewall-cmd actioncheck - patch from Adam Tkac. Redhat Bug #979622
- Fix apache-common for apache-2.4 log file format. Thanks Mark White.
Closes gh-516
- Asynchat changed to use push method which verifys whether all data was
send. This ensures that all data is sent before closing the connection.
- Removed unnecessary reference to as yet undeclared $jail\_name when checking
a specific jail in nagios script.
- Filter dovecot reordered session and TLS items in regex with wider scope
for session characters. Thanks Ivo Truxa. Closes gh-586
- A single bad failregex or command syntax in configuration files won't stop
fail2ban from starting. Thanks Tomasz Ciolek. Closes gh-585.
### Enhancements
- long names on jails documented based on iptables limit of 30 less
len("fail2ban-").
- remove indentation of name and loglevel while logging to SYSLOG to
resolve syslog(-ng) parsing problems. Closes Debian bug #730202.
- updated check\_fail2ban to return performance data for all jails.
- filter apache-noscript now includes php cgi scripts.
Thanks dani. Closes gh-503
- exim-spam filter to match spamassassin log entry for option SAdevnull.
Thanks Ivo Truxa. Closes gh-533
- `filter.d/nsd.conf` -- also amended Unix date template to match nsd format
- Added to sshd filter expression for `Received disconnect from : 3:
...: Auth fail`. Thanks Marcel Dopita. Closes gh-289
- loglines now also report "[PID]" after the name portion
- Added `filter.d/ejabberd-auth`
- Improved ACL-handling for Asterisk
- loglines now also report "[PID]" after the name portion
- Added improper command pipelining to postfix filter.
### New Features
- `filter.d/solid-pop3d` -- added thanks to Jacques Lav!gnotte on mailinglist.
- Add filter for apache-modsecurity.
- `filter.d/nsd.conf` -- also amended Unix date template to match nsd format
- Added openwebmail filter thanks Ivo Truxa. Closes gh-543
- Added filter for freeswitch. Thanks Jim and editors and authors of
http://wiki.freeswitch.org/wiki/Fail2ban
- Added groupoffice filter thanks to logs from Merijn Schering.
Closes gh-566
- Added filter for horde
- Added filter for squid. Thanks Roman Gelfand.
- Added filter for ejabberd-auth.
- Added `filter.d/openwebmail` filter thanks Ivo Truxa. Closes gh-543
- Added `filter.d/groupoffice` filter thanks to logs from Merijn Schering.
Closes gh-566
- Added `action.d/badips`. Thanks to Amy for making a nice API.
- Added firewallcmd-ipset action.
- Added ufw action. Thanks Guilhem Lettron. lp-#701522
- Added blocklist\_de action.
ver. 0.8.11 (2013/11/13) - loves-unittests-and-tight-DoS-free-filter-regexes
----------
In light of CVE-2013-2178 that triggered our last release we have put
a significant effort into tightening all of the regexs of our filters
to avoid another similar vulnerability. All filters have been updated
and some to catch more login/authentication failures and to support
for newer application versions. There are test cases for most log
cases of failures now.
As usual, if you have other examples that demonstrate that a filter is
insufficient, or if we have inadvertently introduced a regression,
please provide us with example log lines on the github issue tracker
http://github.com/fail2ban/fail2ban/issues and NOT on a random blog in
some obscure corner of the Internet.
Many thanks to our contributors for this release Daniel Black, Yaroslav
Halchenko, Steven Hiscocks, Mark McKinstry, Andy Fragen, Orion Poplawski,
Alexander Dietrich, JP Espinosa, Jamyn Shanley, Beau Raines, François
Boulogne and others who have helped on IRC and mailing list, logged issues
and bug requests.
### IMPORTANT incompatible changes
Filter name changes:
\* 'lighttpd-fastcgi' filter has been renamed to 'suhosin'
\* 'sasl' has been renamed to 'postfix-sasl'
\* 'exim' spam catching failregexes was split out into 'exim-spam'
These changes will require changing jail.{conf,local} if any of
those filters were used.
### Fixes
- Jonathan Lanning
\* `filter.d/asterisk` -- identified another regex for blocking. Also channel
ID is hex not decimal as noted in sample logs provided.
- Daniel Black & Marcel Dopita
\* `filter.d/apache-auth` -- fixed and apache auth samples provide. Closes gh-286
- Yaroslav Halchenko
\* `filter.d/common.conf` -- make colon after [daemon] optional. Closes gh-267
\* `filter.d/apache-common.conf` -- support apache 2.4 more detailed error
log format. Closes gh-268
\* Backends changes detection and parsing. Close gh-223 and gh-103:
- Polling backend: detect changes in the files not only based on
mtime, but also on the size and inode. It should allow for
better detection of changes and log rotations on busy servers,
older python 2.4, and file systems with precision of mtime only
up to a second (e.g. ext3).
- All backends, possible race condition: do not read from a file
initially reported empty. Originally could have lead to
accounting for detected log lines multiple times.
- Do not crash if executing a command in fail2ban-client interactive
mode has failed (e.g. due to incorrect syntax). Closes gh-353
- Daniel Black & Мернов Георгий
\* `filter.d/dovecot.conf` -- Fix when no TLS enabled - line doesn't end in ,
- Daniel Black & Georgiy Mernov & ftoppi & Мернов Георгий
\* `filter.d/exim.conf` -- regex hardening and extra failure examples in
sample logs
\* `filter.d/named-refused.conf` - BIND 9.9.3 regex changes
- Daniel Black & Sebastian Arcus
\* `filter.d/asterisk` -- more regexes
- Daniel Black
\* `action.d/hostsdeny` -- NOTE: new dependency 'ed'. Switched to use 'ed' across
all platforms to ensure permissions are the same before and after a ban.
Closes gh-266. hostsdeny supports daemon\_list now too.
\* `action.d/bsd-ipfw` - action option unused. Change blocktype to port unreach
instead of deny for consistency.
\* `filter.d/dovecot` - added to support different dovecot failure
"..disallowed plaintext auth". Closes Debian bug #709324
\* `filter.d/roundcube-auth` - timezone offset can be positive or negative
\* `action.d/bsd-ipfw` - action option unused. Fixed to blocktype for
consistency. default to port unreach instead of deny
\* `filter.d/dropbear` - fix regexs to match standard dropbear and the patched
http://www.unchartedbackwaters.co.uk/files/dropbear/dropbear-0.52.patch
and add PAM is it in dropbear-2013.60 source code.
\* `filter.d/{asterisk,assp,dovecot,proftpd}.conf` -- regex hardening
and extra failure examples in sample logs
\* `filter.d/apache-auth` - added expressions for mod\_authz, mod\_auth and
mod\_auth\_digest failures.
\* `filter.d/recidive` -- support f2b syslog target and anchor regex at start
\* `filter.d/mysqld-auth.conf` - mysql can use syslog
\* `filter.d/sshd` - regex enhancements to support openssh-6.3. Closes Debian
bug #722970. Thanks Colin Watson for the regex analysis.
\* `filter.d/wuftpd` - regex enhancements to support pam and wuftpd. Closes
Debian bug #665925
- Rolf Fokkens
\* `action.d/dshield.conf` and complain.conf -- reorder mailx arguments.
https://bugzilla.redhat.com/show\_bug.cgi?id=998020
- John Doe (ache)
\* `action.d/bsd-ipfw.conf` - invert actionstop logic to make exist status 0.
Closes gh-343.
- JP Espinosa (Reviewed by O.Poplawski)
\* files/redhat-initd - rewritten to use stock init.d functions thus
avoiding problems with getpid. Also $network and iptables moved
to Should- rc init fields
- Rick Mellor
\* `filter.d/vsftp` - fix capture with tty=ftp
### New Features
- Edgar Hoch
\* `action.d/firewall-cmd-direct-new.conf` - action for firewalld
from https://bugzilla.redhat.com/show\_bug.cgi?id=979622
NOTE: requires firewalld-0.3.8+
- Andy Fragen and Daniel Black
\* `filter.d/osx-ipfw.conf` - ipfw action for OSX based on random rule
numbers.
- Anonymous:
\* `action.d/osx-afctl` - an action based on afctl for osx
- Daniel Black & ykimon
\* `filter.d/3proxy.conf` -- filter added
\* fail2ban-regex - now generates http://www.debuggex.com urls for debugging
regular expressions with the -D parameter.
- Daniel Black
\* `filter.d/exim-spam.conf` -- a splitout of exim's spam regexes
with additions for greater control over filtering spam.
\* add date expression for apache-2.4 - milliseconds
\* `filter.d/nginx-http-auth` -- filter added for http basic authentication
failures in nginx. Partially fulfills gh-405.
- Christophe Carles & Daniel Black
\* `filter.d/perdition.conf` -- filter added
- Mark McKinstry
\* `action.d/apf.conf` - add action for Advanced Policy Firewall (apf)
- Amir Caspi and kjohnsonecl
\* `filter.d/uwimap-auth` - filter for uwimap-auth IMAP/POP server
- Steven Hiscocks and Daniel Black
\* `filter.d/selinux-{common,ssh`} -- add SELinux date and ssh filter
### Enhancements
- François Boulogne and Frédéric
\* `filter.d/lighttpd` - auth regexs for lighttpd-1.4.31
- Daniel Black
\* reorder parsing of jail.conf, `jail.d/\*.conf`, `jail.local`, `jail.d/\*.local`
and likewise for `fail2ban.{conf|local|d/\*.conf|d/\*.local`}. Closes gh-392
\* jail.conf now has asterisk jail - no need for asterisk-tcp and
asterisk-udp. Users should replace existing jails with asterisk to
reduce duplicate parsing of the asterisk log file.
\* `filter.d/{suhosin,pam-generic,gssftpd,sogo-auth,webmin`}- regex anchor at
start
\* `filter.d/vsftpd` - anchored regex at start. disable old pam format regex
\* `filter.d/pam-generic` - added syslog prefix. Disabled support for
linux-pam before version 0.99.2.0 (2005)
\* `filter.d/postfix-sasl` - renamed from sasl, anchor at start and base on
syslog
\* `filter.d/qmail` - rewrote regex to anchor at start. Added regex for
another "in the wild" patch to rblsmtp.
- Yaroslav Halchenko
\* fail2ban-regex -- refactored to provide more details (missing and
ignored lines, control over logging, etc) while maintaining look&feel
\* fail2ban-client -- log to standard error. Closes gh-264
\* Fail to configure if not a single log file was found for an
enabled jail. Closes gh-63
\* `` is now enforced to end with an alphanumeric
\* `filter.d/roundcube-auth.conf` -- anchored version
\* date matching - for standard asctime formats prefer more detailed
first (thus use year if available)
\* files/gen\_badbots was added and `filter.d/apache-badbots.conf` was
regenerated to get updated (although now still an old) list of
"bad" bots
- Alexander Dietrich
\* `action.d/sendmail-common.conf` -- added common sendmail settings file
and made the sender display name configurable
- Steven Hiscocks
\* `filter.d/dovecot` - Addition of session, time values and possible blank
user
- Zurd and Daniel Black
\* `filter.d/named-refused` - added refused on zone transfer
\* `filter.d/{courier{login,smtp},proftpd,sieve,wuftpd,xinetd`} - General
regex improvements
- Zurd
\* `filter.d/postfix` - add filter for VRFY failures. Closes gh-322.
- Orion Poplawski
\* `fail2ban.d/` and `jail.d/` directories are added to `etc/fail2ban` to facilitate
their use
ver. 0.8.10 (2013/06/12) - wanna-be-secure
-----------
Primarily bugfix and enhancements release, triggered by "bugs" in
apache- filters. If you are relying on listed below apache- filters,
upgrade asap and seek your distributions to patch their fail2ban
distribution with [6ccd5781].
### Fixes
- Yaroslav Halchenko
\* [6ccd5781] `filter.d/apache-{auth,nohome,noscript,overflows`} - anchor
failregex at the beginning (and where applicable at the end).
Addresses a possible DoS. Closes gh-248
\* `action.d/{route,shorewall}.conf` - blocktype must be defined
within [Init]. Closes gh-232
### Enhancements
- Yaroslav Halchenko
\* jail.conf -- assure all jails have actions and remove unused
ports specifications
- Terence Namusonge
\* `filter.d/roundcube-auth.conf` -- support roundcube 0.9+
- Daniel Black
\* `files/suse-initd` -- update to the copy from stock SUSE
silviogarbes & Daniel Black
\* Updates to asterisk filter. Closes gh-227/gh-230.
- Carlos Alberto Lopez Perez
\* Updates to asterisk to include AUTH\_UNKNOWN\_DOMAIN. Closes gh-244.
ver. 0.8.9 (2013/05/13) - wanna-be-stable
----------
Originally targeted as a bugfix release, it incorporated many new
enhancements, few new features, and more importantly -- quite extended
tests battery with current 94% coverage (from 56% of 0.8.8).
This release introduces over 200 of non-merge commits from 16
contributors (sorted by number of commits): Yaroslav Halchenko, Daniel
Black, Steven Hiscocks, James Stout, Orion Poplawski, Enrico Labedzki,
ArndRa, hamilton5, pigsyn, Erwan Ben Souiden, Michael Gebetsroither,
Artur Penttinen, blotus, sebres, Nicolas Collignon, Pascal Borreli.
Special Kudos also go to Fabian Wenk, Arturo 'Buanzo' Busleiman, Tom
Hendrikx, Yehuda Katz and other TBN heroes supporting users on
fail2ban-users mailing list and IRC.
### Fixes
- Yaroslav Halchenko
\* [6f4dad46] python-2.4 is the minimal version.
\* [1eb23cf8] do not rely on scripts being under /usr -- might differ e.g.
on Fedora. Closes gh-112. Thanks to Camusensei for the bug report.
\* [bf4d4af1] Changes for atomic writes. Thanks to Steven Hiscocks for
insight. Closes gh-103.
\* [ab044b75] delay check for the existence of config directory until read.
\* [3b4084d4] fixing up for handling of TAI64N timestamps.
\* [154aa38e] do not shutdown logging until all jails stop.
\* [f2156604] pyinotify -- monitor IN\_MOVED\_TO events. Closes gh-184.
Thanks to Jon Foster for report and troubleshooting.
- Orion Poplawski
\* [e4aedfdc00] pyinotify - use bitwise op on masks and do not try tracking
newly created directories.
- Nicolas Collignon
\* [39667ff6] Avoid leaking file descriptors. Closes gh-167.
- Sergey Brester
\* [b6bb2f88 and d17b4153] invalid date recognition, irregular because of
sorting template list.
- Steven Hiscocks
\* [7a442f07] When changing log target with python2.{4,5} handle KeyError.
Closes gh-147, gh-148.
\* [b6a68f51] Fix delaction on server side. Closes gh-124.
- Daniel Black
\* [f0610c01] Allow more that a one word command when changing and Action via
the fail2ban-client. Closes gh-134.
\* [945ad3d9] Fix dates on email actions to work in different locals. Closes
gh-70. Thanks to iGeorgeX for the idea.
- blotus
\* [96eb8986] ' and " should also be escaped in action tags Closes gh-109
- Christoph Theis, Nick Hilliard, Daniel Black
\* [b3bd877d,cde71080] Make `syslog -v` and `syslog -vv` formats work on FreeBSD
### New Features
- Yaroslav Halchenko
\* [9ba27353] Add support for `jail.d/{confilefile}` and `fail2ban.d/{configfile}`
to provide additional flexibility to system administrators. Thanks to
beilber for the idea. Closes gh-114.
\* [3ce53e87] Add exim filter.
- Erwan Ben Souiden
\* [d7d5228] add nagios integration documentation and script to ensure
fail2ban is running. Closes gh-166.
- Artur Penttinen
\* [29d0df5] Add mysqld filter. Closes gh-152.
- ArndRaphael Brandes
\* [bba3fd8] Add Sogo filter. Closes gh-117.
- Michael Gebetsriother
\* [f9b78ba] Add action route to block at routing level.
- Teodor Micu & Yaroslav Halchenko
\* [5f2d383] Add roundcube auth filter. Closes Debian bug #699442.
- Daniel Black
\* [be06b1b] Add action for iptables-ipsets. Closes gh-102.
- Nick Munger, Ken Menzel, Daniel Black, Christoph Theis & Fabian Wenk
\* [b6d0e8a] Add and enhance the bsd-ipfw action from
FreeBSD ports.
- Soulard Morgan
\* [f336d9f] Add filter for webmin. Closes gh-99.
- Steven Hiscocks
\* [..746c7d9] bash interactive shell completions for fail2ban-\*'s
- Nick Hilliard
\* [0c5a9c5] Add pf action.
### Enhancements
- Enrico Labedzki
\* [24a8d07] Added new date format for ASSP SMTP Proxy.
- Steven Hiscocks
\* [3d6791f] Ensure restart of Actions after a check fails occurs
consistently. Closes gh-172.
\* [MANY] Improvements to test cases, travis, and code coverage (coveralls).
\* [b36835f] Add get cinfo to fail2ban-client. Closes gh-124.
\* [ce3ab34] Added ability to specify PID file.
- Orion Poplawski
\* [ddebcab] Enhance fail2ban.service definition dependencies and Pidfile.
Closes gh-142.
- Yaroslav Halchenko
\* [MANY] Lots of improvements to log messages, man pages and test cases.
\* [91d5736] Postfix filter improvements - empty helo, from and rcpt to.
Closes gh-126. Bug report by Michael Heuberger.
\* [40c5a2d] adding more of diagnostic messages into -client while starting
the daemon.
\* [8e63d4c] Compare against None with 'is' instead of '=='.
\* [6fef85f] Strip CR and LF while analyzing the log line
- Daniel Black
\* [3aeb1a9] Add jail.conf manual page. Closes gh-143.
\* [MANY] man page edits.
\* [7cd6dab] Added help command to fail2ban-client.
\* [c8c7b0b,23bbc60] Better logging of log file read errors.
\* [3665e6d] Added code coverage to development process.
\* [41b9f7b,32d10e9,39750b8] More complete ssh filter rules to match openssh
source. Also include BSD changes.
\* [1d9abd1] Action files can have tags in definition that refer to other
tags.
\* [10886e7,cec5da2,adb991a] Change actions to response with ICMP port
unreachable rather than just a drop of the packet.
- Pascal Borreli
\* [a2b29b4] Fixed lots of typos in config files and documentation.
- hamilton5
\* [7ede1e8] Update dovecot filter config.
- Romain Riviere
\* [0ac8746] Enhance named-refused filter for views.
- James Stout
\* [..2143cdf] Solaris support enhancements:
- `README.Solaris`
- failregex'es tune ups (`sshd.conf`)
- hostsdeny: do not rely on support of '-i' in sed
ver. 0.8.8 (2012/12/06) - stable
----------
### Fixes
- Alan Jenkins
\* [8c38907] Removed 'POSSIBLE BREAK-IN ATTEMPT' from sshd filter to avoid
banning due to misconfigured DNS. Closes gh-64
- Yaroslav Halchenko
\* [83109bc] IMPORTANT: escape the content of  (if used in
custom action files) since its value could contain arbitrary
symbols. Thanks for discovery go to the NBS System security
team
\* [0935566,5becaf8] Various python 2.4 and 2.5 compatibility fixes. Closes gh-83
\* [b159eab] do not enable pyinotify backend if pyinotify < 0.8.3
\* [37a2e59] store IP as a base, non-unicode str to avoid spurious messages
in the console. Closes gh-91
### New Features
- David Engeset
\* [2d672d1,6288ec2] 'unbanip' command for the client + avoidance of touching
the log file to take 'banip' or 'unbanip' in effect. Closes gh-81, gh-86
### Enhancements
\* [2d66f31] replaced uninformative "Invalid command" message with warning log
exception why command actually failed
\* [958a1b0] improved failregex to "support" auth.backend = "htdigest"
\* [9e7a3b7] until we make it proper module -- adjusted sys.path only if
system-wide run
\* [f52ba99] downgraded "already banned" from WARN to INFO level. Closes gh-79
\* [f105379] added hints into the log on some failure return codes (e.g. 0x7f00
for this gh-87)
\* Various others: travis-ci integration, script to run tests
against all available Python versions, etc
ver. 0.8.7.1 (2012/07/31) - stable
----------
### Fixes
\* [e9762f3] Removed sneaked in comment on sys.path.insert
ver. 0.8.7 (2012/07/31) - stable
----------
### Fixes
- Tom Hendrikx & Jeremy Olexa
\* [0eaa4c2,444e4ac] Fix Gentoo init script: $opts variable is deprecated.
See http://forums.gentoo.org/viewtopic-t-899018.html
- Chris Reffett
\* [a018a26] Fixed addBannedIP to add enough failures to trigger a ban,
rather than just one failure.
- Yaroslav Halchenko
\* [4c76fb3] allow trailing white-spaces in lighttpd-auth.conf
\* [25f1e8d] allow trailing whitespace in few missing it regexes for sshd.conf
\* [ed16ecc] enforce "ip" field returned as str, not unicode so that log
message stays non-unicode. Close gh-32
\* [b257be4] added %m-%d-%Y pattern + do not add %Y for Feb 29 fix if
already present in the pattern
\* [47e956b] replace "|" with "\_" in ipmasq-ZZZzzz|fail2ban.rul to be
friend to developers stuck with Windows (Closes gh-66)
\* [80b191c] anchor grep regexp in actioncheck to not match partial names
of the jails (Closes: #672228) (Thanks Szépe Viktor for the report)
### New Features
- François Boulogne
\* [a7cb20e..] add lighttpd-auth filter/jail
- Lee Clemens & Yaroslav Halchenko
\* [e442503] pyinotify backend (default if backend='auto' and pyinotify
is available)
\* [d73a71f,3989d24] usedns parameter for the jails to allow disabling
use of DNS
- Tom Hendrikx
\* [f94a121..] 'recidive' filter/jail to monitor fail2ban.conf to ban
repeated offenders. Close gh-19
- Xavier Devlamynck
\* [7d465f9..] Add asterisk support
- Zbigniew Jędrzejewski-Szmek
\* [de502cf..] allow running fail2ban as non-root user (disabled by
default) via xt\_recent. See doc/run-rootless.txt
### Enhancements
- Lee Clemens
\* [47c03a2] files/nagios - spelling/grammar fixes
\* [b083038] updated Free Software Foundation's address
\* [9092a63] changed TLDs to invalid domains, in accordance with RFC 2606
\* [642d9af,3282f86] reformatted printing of jail's name to be consistent
with init's info messages
\* [3282f86] uniform use of capitalized Jail in the messages
- Leonardo Chiquitto
\* [4502adf] Fix comments in dshield.conf and mynetwatchman.conf
to reflect code
\* [a7d47e8] Update Free Software Foundation's address
- Petr Voralek
\* [4007751] catch failed ssh logins due to being listed in DenyUsers.
Close gh-47 (Closes: #669063)
- Yaroslav Halchenko
\* [MANY] extended and robustified unittests: test different backends
\* [d9248a6] refactored Filter's to avoid duplicate functionality
\* [7821174] direct users to issues on github
\* [d2ffee0..] re-factored fail2ban-regex -- more condensed output by
default with -v to control verbosity
\* [b4099da] adjusted header for config/\*.conf to mention .local and way
to comment (Thanks Stefano Forli for the note)
\* [6ad55f6] added failregex for wu-ftpd to match against syslog instead
of DoS-prone auth.log's rhost (Closes: #514239)
\* [2082fee] match possibly present "pam\_unix(sshd:auth):" portion for
sshd filter (Closes: #648020)
- Yehuda Katz & Yaroslav Halchenko
\* [322f53e,bd40cc7] ./DEVELOP -- documentation for developers
ver. 0.8.6 (2011/11/28) - stable
----------
### Fixes
- Markos Chandras & Yaroslav Halchenko
\* [492d8e5,bd658fc] Use hashlib (instead of deprecated md5) where available
- Robert Trace & Michael Lorant
\* [c48c2b1] gentoo-initd cleanup and fixes: assure `/var/run` + remove stale
sock file
- Michael Saavedra
\* [3a58d0e] Lock server's executeCmd to prevent racing among iptables calls:
see http://bugs.debian.org/554162
- Yaroslav Halchenko
\* [3eb5e3b] Allow for trailing spaces in sasl logs
\* [1632244] Stop server-side communication before stopping the
jails (prevents lockup if actions use fail2ban-client upon
unban): see https://github.com/fail2ban/fail2ban/issues/7
\* [5a2d518] Various changes to reincarnate unittests
- Yehuda Katz
\* Wiki was cleaned from SPAM
### Enhancements
- Adam Spiers
\* [3152afb] Recognise time-stamped kernel messages
- Guido Bozzetto
\* [713fea6] Added ipmasq rule file to restart fail2ban when iptables are
wiped out: see http://bugs.debian.org/461417
- Łukasz
\* [5f23542] Matching of month names in Polish (thanks michaelberg79
for QA)
- Tom Hendrikx
\* [9fa54cf] Added Date: header for sendmail\*.conf actions
- Yaroslav Halchenko & Tom Hendrikx
\* [b52d420..22b7007]  in action files now can be used
to provide matched loglines which triggered action
- Yaroslav Halchenko
\* [ed0bf3a] Removed duplicate entry for DataCha0s/2\.0 in badbots:
see http://bugs.debian.org/519557
\* [dad91f7] sshd.conf: allow user names to have spaces and
trailing spaces in the line
\* [a9be451] removed expansions for few Date and Revision SVN keywords
\* [a33135c] set/getFile for ticket.py -- found in source distribution
of 0.8.4
\* [fbce415] additional logging while stopping the jails
ver. 0.8.5 (2011/07/28) - stable
----------
- Fix: use addfailregex instead of failregex while processing per-jail
"failregex" parameter (Fixed Debian bug #635830, LP: #635036). Thanks to
Marat Khayrullin for the patch and Daniel T Chen for forwarding to
Debian.
- Fix: use os.path.join to generate full path - fixes includes in configs
given local filename (5 weeks ago) [yarikoptic]
- Fix: allowed for trailing spaces in proftpd logs
- Fix: escaped () in pure-ftpd filter. Thanks to Teodor
- Fix: allowed space in the trailing of failregex for sasl.conf:
see http://bugs.debian.org/573314
- Fix: use `/var/run/fail2ban` instead of `/tmp` for temp files in actions:
see http://bugs.debian.org/544232
- Fix: Tai64N stores time in GMT, needed to convert to local time before
returning
- Fix: disabled named-refused-udp jail entirely with a big fat warning
- Fix: added time module. Bug reported in buanzo's blog:
see http://blogs.buanzo.com.ar/2009/04/fail2ban-patch-ban-ip-address-manually.html
- Fix: Patch to make log file descriptors cloexec to stop leaking file
descriptors on fork/exec. Thanks to Jonathan Underwood:
see https://bugzilla.redhat.com/show\_bug.cgi?id=230191#c24
- Enhancement: added author for dovecot filter and pruned unneeded space
in the regexp
- Enhancement: proftpd filter -- if login failed -- count regardless of the
reason for failure
- Enhancement: added  to `action.d/iptables\*`. Thanks to Matthijs Kooijman:
see http://bugs.debian.org/515599
- Enhancement: added `filter.d/dovecot.conf` from Martin Waschbuesch
- Enhancement: made `filter.d/apache-overflows.conf` catch more:
see http://bugs.debian.org/574182
- Enhancement: added dropbear filter from Francis Russell and Zak B. Elep:
see http://bugs.debian.org/546913
- Enhancement: changed default ignoreip to ignore entire loopback zone (/8):
see http://bugs.debian.org/598200
- Minor: spell-checked jail.conf. Thanks to Christoph Anton Mitterer
- Few minor cosmetic changes
ver. 0.8.4 (2009/09/07) - stable
----------
- Check the inode number for rotation in addition to checking the first line of
the file. Thanks to Jonathan Kamens. Red Hat #503852. Tracker #2800279.
- Moved the shutdown of the logging subsystem out of Server.quit() to
the end of Server.start(). Fixes the 'cannot release un-acquired lock'
error.
- Added "Ban IP" command. Thanks to Arturo 'Buanzo' Busleiman.
- Added two new filters: lighttpd-fastcgi and php-url-fopen.
- Fixed the 'unexpected communication error' problem by means of
use\_poll=False in Python >= 2.6.
- Merged patches from Debian package. Thanks to Yaroslav Halchenko.
- Use current day and month instead of Jan 1st if both are not available in the
log. Thanks to Andreas Itzchak Rehberg.
- Try to match the regex even if the line does not contain a valid date/time.
Described in Debian #491253. Thanks to Yaroslav Halchenko.
- Added/improved filters and date formats.
- Added actions to report abuse to ISP, DShield and myNetWatchman. Thanks to
Russell Odom.
- Suse init script. Remove socket file on startup is fail2ban crashed. Thanks to
Detlef Reichelt.
- Removed begin-line anchor for "standard" timestamp. Fixed Debian bug #500824.
- Added nagios script. Thanks to Sebastian Mueller.
- Added CPanel date format. Thanks to David Collins. Tracker #1967610.
- Improved SASL filter. Thanks to Loic Pefferkorn. Tracker #2310410.
- Added NetBSD ipfilter (ipf command) action. Thanks to Ed Ravin. Tracker #2484115.
- Added cyrus-imap and sieve filters. Thanks to Jan Wagner. Debian bug #513953.
- Changed `` template to be more restrictive. Debian bug #514163.
- Use timetuple instead of utctimetuple for ISO 8601. Maybe not a 100% correct
fix but seems to work. Tracker #2500276.
- Made the named-refused regex a bit less restrictive in order to match logs
with "view". Thanks to Stephen Gildea.
- Fixed maxretry/findtime rate. Many thanks to Christos Psonis. Tracker #2019714
ver. 0.8.3 (2008/07/17) - stable
----------
- Process failtickets as long as failmanager is not empty.
- Added "pam-generic" filter and more configuration fixes. Thanks to Yaroslav
Halchenko.
- Fixed socket path in redhat and suse init script. Thanks to Jim Wight.
- Fixed PID file while started in daemon mode. Thanks to Christian Jobic who
submitted a similar patch.
- Fixed `fail2ban-client get  logpath`. Bug #1916986.
- Added gssftpd filter. Thanks to Kevin Zembower.
- Added "Day/Month/Year Hour:Minute:Second" date template. Thanks to Dennis
Winter.
- Fixed ignoreregex processing in fail2ban-client. Thanks to René Berber.
- Added ISO 8601 date/time format.
- Added and changed some logging level and messages.
- Added missing ignoreregex to filters. Thanks to Klaus Lehmann.
- Use poll instead of select in asyncore.loop. This should solve the "Unknown
error 514". Thanks to Michael Geiger and Klaus Lehmann.
ver. 0.8.2 (2008/03/06) - stable
----------
- Fixed named filter. Thanks to Yaroslav Halchenko
- Fixed wrong path for apache-auth in jail.conf. Thanks to Vincent Deffontaines
- Fixed timezone bug with epoch date template. Thanks to Michael Hanselmann
- Added "full line failregex" patch. Thanks to Yaroslav Halchenko. It will be
possible to create stronger failregex against log injection
- Fixed ipfw action script. Thanks to Nick Munger
- Removed date from logging message when using SYSLOG. Thanks to Iain Lea
- Fixed "ignore IPs". Only the first value was taken into account. Thanks to
Adrien Clerc
- Moved socket to `/var/run/fail2ban`.
- Rewrote the communication server.
- Refactoring. Reduced number of files.
- Removed Python 2.4. Minimum required version is now Python 2.3.
- New log rotation detection algorithm.
- Print monitored files in status.
- Create a PID file in `/var/run/fail2ban/`. Thanks to Julien Perez.
- Fixed "Feb 29" bug. Thanks to James Andrewartha who pointed this out. Thanks
to Yaroslav Halchenko for the fix.
- `reload ` reloads a single jail and the parameters in fail2ban.conf.
- Added Mac OS/X startup script. Thanks to Bill Heaton.
- Absorbed some Debian patches. Thanks to Yaroslav Halchenko.
- Replaced "echo" with "printf" in actions. Fix #1839673
- Replaced "reject" with "drop" in shorwall action. Fix #1854875
- Fixed Debian bug #456567, #468477, #462060, #461426
- readline is now optional in fail2ban-client (not needed in fail2ban-server).
ver. 0.8.1 (2007/08/14) - stable
----------
- Fixed vulnerability in sshd.conf. Thanks to Daniel B. Cid
- Expand  in ignoreregex. Thanks to Yaroslav Halchenko
- Improved regular expressions. Thanks to Yaroslav Halchenko and others
- Added sendmail actions. The action started with "mail" are now deprecated.
Thanks to Raphaël Marichez
- Added "ignoreregex" support to fail2ban-regex
- Updated suse-initd and added it to MANIFEST. Thanks to Christian Rauch
- Tightening up the pid check in redhat-initd. Thanks to David Nutter
- Added webmin authentication filter. Thanks to Guillaume Delvit
- Removed textToDns() which is not required anymore. Thanks to Yaroslav
Halchenko
- Added new action iptables-allports. Thanks to Yaroslav Halchenko
- Added "named" date format to date detector. Thanks to Yaroslav Halchenko
- Added filter file for named (bind9). Thanks to Yaroslav Halchenko
- Fixed vsftpd filter. Thanks to Yaroslav Halchenko
ver. 0.8.0 (2007/05/03) - stable
----------
- Fixed RedHat init script. Thanks to Jonathan Underwood
- Added Solaris 10 files. Thanks to Hanno 'Rince' Wagner
ver. 0.7.9 (2007/04/19) - release candidate
----------
- Close opened handlers. Thanks to Yaroslav Halchenko
- Fixed "reload" bug. Many many thanks to Yaroslav Halchenko
- Added date format for asctime without year
- Modified filters config. Thanks to Michael C. Haller
- Fixed a small bug in mail-buffered.conf
ver. 0.7.8 (2007/03/21) - release candidate
----------
- Fixed asctime pattern in datedetector.py
- Added new filters/actions. Thanks to Yaroslav Halchenko
- Added Suse init script and modified gentoo-initd. Thanks to Christian Rauch
- Moved every locking statements in a try..finally block
ver. 0.7.7 (2007/02/08) - release candidate
----------
- Added signal handling in fail2ban-client
- Added a wonderful visual effect when waiting on the server
- fail2ban-client returns an error code if configuration is not valid
- Added new filters/actions. Thanks to Yaroslav Halchenko
- Call Python interpreter directly (instead of using "env")
- Added file support to fail2ban-regex. Benchmark feature has been removed
- Added cacti script and template.
- Added IP list in "status ". Thanks to Eric Gerbier
ver. 0.7.6 (2007/01/04) - beta
----------
- Added a "sleep 1" in redhat-initd. Thanks to Jim Wight
- Use `/dev/log` for SYSLOG output. Thanks to Joerg Sommrey
- Use numeric output for iptables in "actioncheck"
- Fixed removal of host in hosts.deny. Thanks to René Berber
- Added new date format (2006-12-21 06:43:20) and Exim4 filter. Thanks to mEDI
- Several "failregex" and "ignoreregex" are now accepted. Creation of rules
should be easier now.
- Added license in COPYING. Thanks to Axel Thimm
- Allow comma in action options. The value of the option must be escaped with "
or '. Thanks to Yaroslav Halchenko
- Now Fail2ban goes in `/usr/share/fail2ban` instead of `/usr/lib/fail2ban`. This is
more compliant with FHS. Thanks to Axel Thimm and Yaroslav Halchenko
ver. 0.7.5 (2006/12/07) - beta
----------
- Do not ban a host that is currently banned. Thanks to Yaroslav Halchenko
- The supported tags in "action(un)ban" are ``, `` and ``
- Fixed refactoring bug (getLastcommand -> getLastAction)
- Added option "ignoreregex" in filter scripts and `jail.conf`.
Feature Request #1283304
- Fixed a bug in user defined time regex/pattern
- Improved documentation
- Moved `version.py` and `protocol.py` to `common/`
- Merged "maxtime" option with "findtime"
- Added `` tag support in failregex which matches default IP
address/hostname. `(?P\S)` is still valid and supported
- Fixed exception when calling fail2ban-server with unknown option
- Fixed Debian bug 400162. The "socket" option is now handled correctly by
`fail2ban-client`
- Fixed RedHat init script. Thanks to Justin Shore
- Changed timeout to 30 secondes before assuming the server cannot be started.
Thanks to Joël Bertrand
ver. 0.7.4 (2006/11/01) - beta
----------
- Improved configuration files. Thanks to Yaroslav Halchenko
- Added man page for "fail2ban-regex"
- Moved ban/unban messages from "info" level to "warn"
- Added "-s" option to specify the socket path and "socket" option in
"fail2ban.conf"
- Added "backend" option in "jail.conf"
- Added more filters/actions and jail samples. Thanks to Nick Munger, Christoph
Haas
- Improved testing framework
- Fixed a bug in the return code handling of the executed commands. Thanks to
Yaroslav Halchenko
- Signal handling. There is a bug with join() and signal in Python
- Better debugging output for "fail2ban-regex"
- Added support for more date format
- cPickle does not work with Python 2.5. Use pickle instead (performance is not
a problem in our case)
ver. 0.7.3 (2006/09/28) - beta
----------
- Added man pages. Thanks to Yaroslav Halchenko
- Added wildcard support for "logpath"
- Added Gamin (file and directory monitoring system) support
- (Re)added "ignoreip" option
- Added more concurrency protection
- First attempt at solving bug #1457620 (locale issue)
- Performance improvements
- (Re)added permanent banning with banTime < 0
- Added DNS support to "ignoreip". Feature Request #1285859
ver. 0.7.2 (2006/09/10) - beta
----------
- Refactoring and code cleanup
- Improved client output
- Added more get/set commands
- Added more configuration templates
- Removed "logpath" and "maxretry" from filter templates. They must be defined
in jail.conf now
- Added interactive mode. Use "-i"
- Added a date detector. "timeregex" and "timepattern" are no more needed
- Added "fail2ban-regex". This is a tool to help finding "failregex"
- Improved server communication. Start a new thread for each incoming request.
Fail2ban is not really thread-safe yet
ver. 0.7.1 (2006/08/23) - alpha
----------
- Fixed daemon mode bug
- Added Gentoo init.d script
- Fixed path bug when trying to start "fail2ban-server"
- Fixed reload command
ver. 0.7.0 (2006/08/23) - alpha
----------
- Almost a complete rewrite :) Fail2ban design is really better (IMHO). There is
a lot of new features
- Client/Server architecture
- Multithreading. Each jail has its own threads: one for the log reading and
another for the actions
- Execute several actions
- Split configuration files. They are more readable and easy to use
- failregex uses group () now. This feature was already present in the
Debian package
- lots of things...
ver. 0.6.1 (2006/03/16) - stable
----------
- Added permanent banning. Set banTime to a negative value to enable this
feature (-1 is perfect). Thanks to Mannone
- Fixed locale bug. Thanks to Fernando José
- Fixed crash when time format does not match data
- Propagated patch from Debian to fix fail2ban search path addition to the path
search list: now it is added first. Thanks to Nick Craig-Wood
- Added SMTP authentication for mail notification. Thanks to Markus Hoffmann
- Removed debug mode as it is confusing for people
- Added parsing of timestamp in TAI64N format (#1275325). Thanks to Mark
Edgington
- Added patch #1382936 (Default formatted syslog logging). Thanks to Patrick
Börjesson
- Removed 192.168.0.0/16 from ignoreip. Attacks could also come from the local
network.
- Robust startup: if iptables module does not get fully initialized after
startup of fail2ban, fail2ban will do "maxreinit" attempts to initialize its
own firewall. It will sleep between attempts for "polltime" number of seconds
(closes Debian: #334272). Thanks to Yaroslav Halchenko
- Added "interpolations" in fail2ban.conf. This is provided by the ConfigParser
module. Old configuration files still work. Thanks to Yaroslav Halchenko
- Added initial support for hosts.deny and shorewall. Need more testing. Please
test. Thanks to kojiro from Gentoo forum for hosts.deny support
- Added support for vsftpd. Thanks to zugeschmiert
ver. 0.6.0 (2005/11/20) - stable
----------
- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko):
\* Added an option to report local time (including timezone) or GMT in mail
notification.
ver. 0.5.5 (2005/10/26) - beta
----------
- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko):
\* Introduced fwcheck option to verify consistency of the chains. Implemented
automatic restart of fail2ban main function in case check of fwban or
fwunban command failed (closes: #329163, #331695). (Introduced patch was
further adjusted by upstream author).
\* Added -f command line parameter for [findtime].
\* Added a cleanup of firewall rules on emergency shutdown when unknown
exception is caught.
\* Fail2ban should not crash now if a wrong file name is specified in config.
\* reordered code a bit so that log targets are setup right after background
and then only loglevel (verbose, debug) is processed, so the warning could
be seen in the logs
\* Added a keyword `` in parsing of the subject and the body of an email
sent out by fail2ban (closes: #330311)
ver. 0.5.4 (2005/09/13) - beta
----------
- Fixed bug #1286222.
- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko):
\* Fixed handling of SYSLOG logging target. Now it can log to any SYSLOG target
and facility as directed by the config
\* Format of SYSLOG entries fixed to look closer to standard
\* Fixed errata in config/gentoo-confd
\* Introduced findtime configuration variable to control the lifetime of caught
"failed" log entries
ver. 0.5.3 (2005/09/08) - beta
----------
- Fixed a bug when overriding "maxfailures" or "bantime". Thanks to Yaroslav
Halchenko
- Added more debug output if an error occurs when sending mail. Thanks to
Stephen Gildea
- Renamed "maxretry" to "maxfailures" and changed default value to 5. Thanks to
Stephen Gildea
- Hopefully fixed bug #1256075
- Fixed bug #1262345
- Fixed exception handling in PIDLock
- Removed warning when using "-V" or "-h" with no config file. Thanks to
Yaroslav Halchenko
- Removed "-i eth0" from config file. Thanks to Yaroslav Halchenko
ver. 0.5.2 (2005/08/06) - beta
----------
- Better PID lock file handling. Should close #1239562
- Added man pages
- Removed log4py dependency. Use logging module instead
- "maxretry" and "bantime" can be overridden in each section
- Fixed bug #1246278 (excessive memory usage)
- Fixed crash on wrong option value in configuration file
- Changed custom chains to lowercase
ver. 0.5.1 (2005/07/23) - beta
----------
- Fixed bugs #1241756, #1239557
- Added log targets in configuration file. Removed -l option
- Changed iptables rules in order to create a separated chain for each section
- Fixed static banList in firewall.py
- Added an initd script for Debian. Thanks to Yaroslav Halchenko
- Check for obsolete files after install
ver. 0.5.0 (2005/07/12) - beta
----------
- Added support for CIDR mask in ignoreip
- Added mail notification support
- Fixed bug #1234699
- Added tags replacement in rules definition. Should allow a clean solution for
Feature Request #1229479
- Removed "interface" and "firewall" options
- Added start and end commands in the configuration file. Thanks to Yaroslav
Halchenko
- Added firewall rules definition in the configuration file
- Cleaned fail2ban.py
- Added an initd script for RedHat/Fedora. Thanks to Andrey G. Grozin
ver. 0.4.1 (2005/06/30) - stable
----------
- Fixed textToDNS method which generated wrong matches for "rhost=12-xyz...".
Thanks to Tom Pike
- `fail2ban.conf` modified for readability. Thanks to Iain Lea
- Added an initd script for Gentoo
- Changed default PID lock file location from `/tmp` to `/var/run`
ver. 0.4.0 (2005/04/24) - stable
----------
- Fixed textToDNS which did not recognize strings like
"12-345-67-890.abcd.mnopqr.xyz"
ver. 0.3.1 (2005/03/31) - beta
----------
- Corrected level of messages
- Added DNS lookup support
- Improved parsing speed. Only parse the new log messages
- Added a second verbose level (-vv)
ver. 0.3.0 (2005/02/24) - beta
----------
- Re-writing of parts of the code in order to handle several log files with
different rules
- Removed `sshd.py` because it is no more needed
- Fixed a bug when exiting with IP in the ban list
- Added PID lock file
- Improved some parts of the code
- Added `ipfw-start-rule` option (thanks to Robert Edeker)
- Added -k option which kills a currently running Fail2Ban
ver. 0.1.2 (2004/11/21) - beta
----------
- Add ipfw and ipfwadm support. The rules are taken from BlockIt. Thanks to
Robert Edeker
- Add -e option which allows to set the interface. Thanks to Robert Edeker who
reminded me this
- Small code cleaning
ver. 0.1.1 (2004/10/23) - beta
----------
- Add SIGTERM handler in order to exit nicely when in daemon mode
- Add -r option which allows to set the maximum number of login failures
- Remove the Metalog class as the log file are not so syslog daemon specific
- Rewrite log reader to be service centered. Sshd support added. Match "Failed
password" and "Illegal user"
- Add `/etc/fail2ban.conf` configuration support
- Code documentation
ver. 0.1.0 (2004/10/12) - alpha
----------
- Initial release

