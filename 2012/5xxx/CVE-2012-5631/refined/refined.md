Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2012-5631:

**Root Cause of Vulnerability:**
- The vulnerability stems from a flaw in the IPA (Identity, Policy, and Audit) command-line client (`/usr/bin/ipa`). Specifically, it does not properly validate the server's identity before sending session cookies. These cookies contain user credentials. This was introduced in IPA version 3.0.

**Weaknesses/Vulnerabilities Present:**
- **Lack of Server Identity Verification:** The IPA client fails to verify if it's sending the session cookie to the same URL it originally received the session ID from, especially over a secure (SSL) transport connection. This makes the client vulnerable to man-in-the-middle attacks
- **Insecure Cookie Handling:** The command line client doesn't enforce the same security constraints for cookies as web browsers do.

**Impact of Exploitation:**
- **Credential Leakage:** If an attacker tricks the IPA command-line client into connecting to a rogue server, the client will send the session cookie (containing credentials) to that server.
- **Impersonation:** The attacker can use these leaked session credentials to impersonate the compromised user on the IPA server. This includes impersonating administrators and potentially gaining full control of the system.

**Attack Vectors:**
- **Configuration Modification:**
    - Gaining root privileges and modifying the default IPA configuration in `/etc/ipa`.
    - Modifying the per-user IPA configuration under `~/.ipa`.
- **DNS Poisoning:**
    - DNS poisoning of the SRV records in DNS, causing the client to connect to a malicious server.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to manipulate the network or filesystem to redirect the IPA client's connection to a malicious server.
- The attacker needs some knowledge of the userâ€™s environment to exploit local configuration files.
- While not required, the attacker also must have the ability to trick the system into using a rogue server with a valid IPA-signed certificate.

**Additional Notes:**
- The attack surface is limited because the IPA client will refuse to connect to a server whose certificate is not signed by the IPA Certificate Authority.
- The session cookies are stored in the user's kernel keyring, which has some protections, making stealing the cookies outside of a rogue server situation less likely.

The vulnerability was fixed in FreeIPA versions 3.0.2 and 3.1.0. The versions of ipa-client and ipa shipped with Red Hat Enterprise Linux 5 and 6 were not affected by the vulnerability.