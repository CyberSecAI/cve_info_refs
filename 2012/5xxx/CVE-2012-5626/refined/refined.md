The provided content relates to CVE-2012-5626.

**Root cause of vulnerability:**
The vulnerability lies in how the `EJBJACCPolicyModuleDelegate` class determines roles during authorization. When the `checkWithPolicy` method is called, it always uses the caller principal to determine the current roles, even if a `@RunAs` annotation is present.

**Weaknesses/vulnerabilities present:**
The vulnerability is caused by the `checkWithPolicy` method ignoring roles specified in the `@RunAs` annotation when determining the current roles for authorization. This leads to the intended roles specified by `@RunAs` to be skipped during the authorization process.

**Impact of exploitation:**
The impact of this vulnerability is that the roles specified by the `@RunAs` annotation are ignored. As a result, a user or process might be able to access resources or perform actions they shouldn't be able to based on the roles assigned with the annotation. This could lead to unauthorized access or privilege escalation.

**Attack vectors:**
An attacker could exploit this by invoking EJB methods that use the `@RunAs` annotation. If the role specified by `@RunAs` is meant to restrict access, the vulnerability would allow bypassing it.

**Required attacker capabilities/position:**
An attacker needs to be able to invoke EJB methods on the vulnerable application that use the `@RunAs` annotation. They do not need any special privileges to trigger this vulnerability. The attacker can exploit it by simply interacting with the application as a normal user, as long as the application logic relies on the `@RunAs` annotation for authorization.