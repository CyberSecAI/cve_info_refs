=== Content from bugs.webkit.org_1ed9dbca_20250124_152138.html ===

 [WebKit Bugzilla](./)

* [New](enter_bug.cgi)
* [Browse](describecomponents.cgi)
* Log In
  ×

  Sign in with GitHub

  or

   Remember my login
  [Create Account](/createaccount.cgi)
  ·
  [Forgot Password](show_bug.cgi?id=92692&GoAheadAndLogIn=1#forgot)

  ## Forgotten password account recovery

RESOLVED
WONTFIX
[92692](show_bug.cgi?id=92692)

WebKit XSS Auditor bypass
```
https://bugs.webkit.org/show_bug.cgi?id=92692
```

[Summary](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
WebKit XSS Auditor bypass

research

[Reported](show_bug.cgi?id=92692#c0)
2012-07-30 16:43:01 PDT

Foundstone Security Advisory
----------------------------------------------
Advisory Title: Webkit XSS Auditor bypass
Author: Tushar Dalvi
Release Date: 19-07-2012
Application: All versions of Google Chrome (4 and above), Safari (5.1.7, lower versions not tested yet)
Platform: All supported platforms
Severity: High
Vendor status:
Overview:
Since Google Chrome 4, a feature was added to help mitigate reflective XSS. The XSS filter is similar to those found in Internet Explorer 8 and NoScript. The XSS filter checks whether a script that's about to run on a web page is also present in the request that fetched that web page. If the script is present in the request, that's a strong indication that the web server might have been tricked into reflecting the script.
Instead of being layered on top of the browser like IE8 XSS Filter and NoScript, this XSS filter is integrated into WebKit. Google Chrome and Safari both rely on Webkit to render the pages.
An attack vector exists which bypasses the XSS auditor filter, and execute arbitrary javascript in the context of the loaded page.
Details:
There is currently no check in the XSS Auditor to determine the context where the data is reflected in the response. Following are the 5 output contexts:
1. HTML entity
2. HTML Attribute
3. JavaScript
4. CSS
5. URL
The issue arises when the data is reflected back into the Javascript context. Following is an example of a test file used to demonstrate the weakness:
Filename: test.jsp
<html><head><title>Test Page</title></head>
<body>
<script>
var foo = "<%= request.getParameter("foo") %>";
document.write("<text>Welcome "+ foo + "</text>");
</script>
</body>
</html>
Sample URL : www.domain.com/test.jsp?foo=2"; alert(document.cookie); var a="1
The same URL was tested against different browsers which implement similar filters to block XSS attacks.
Internet Explorer 8.0 with XSS filter enabled, detected and blocked the attack.
Mozilla Firefox 14.0.1 with Noscript 2.4.8, detected and blocked the attack.
Safari 5.1.7, failed to detect the attack and executed the script. (This is because Safari implements the same webkit XSS auditor as Google Chrome)
Vendor Response:
Recommendation:
The XSS Auditor could possibly be modified to understand the context where the reflected data is being dumped, and apply a different logic to determine the intent of the data relative to that context, to better prevent reflected XSS attacks.
For questions and comments please send an email to:
research@foundstone.com

| Attachments | | |
| --- | --- | --- |
| [Add attachment](attachment.cgi?bugid=92692&action=enter) *proposed patch, testcase, etc.* | | |

Adam Barth

[Comment 1](show_bug.cgi?id=92692#c1)
2012-07-30 16:52:33 PDT

Yeah, we'd like to handle injection into string contexts in JavaScript, but we don't currently handle that injection vector. Thanks for the report.
I'm inclined to make this bug public in case any contributors who don't have security access want to work on this issue.

Radar WebKit Bug Importer

[Comment 2](show_bug.cgi?id=92692#c2)
2012-08-02 13:18:42 PDT

<rdar://problem/12019108>

Eric Seidel (no email)

[Comment 3](show_bug.cgi?id=92692#c3)
2012-08-02 13:39:46 PDT

Making public, per Adam's comment. Thank you very much for the report!

nagarjuna.a

[Comment 4](show_bug.cgi?id=92692#c4)
2014-01-16 22:33:57 PST

Seems to be this is fixed in latest Chrome versions.
Please provide the patch for understanding the logic.

Daniel Bates

[Comment 5](show_bug.cgi?id=92692#c5)
2016-12-19 13:07:39 PST

(In reply to [comment #4](show_bug.cgi?id=92692#c4))
> Seems to be this is fixed in latest Chrome versions.
> Please provide the patch for understanding the logic.
Can you elaborated on how you tested? I am able to reproduce this issue by following the instructions in [comment 0](show_bug.cgi?id=92692#c0) in Chrome Canary for Mac version 57.0.2956.0 canary (64-bit).

Brent Fulgham

[Comment 6](show_bug.cgi?id=92692#c6)
2021-09-21 14:33:45 PDT

The XSS Auditor is removed in [Bug 230499](show_bug.cgi?id=230499 "RESOLVED FIXED - Remove XSS Auditor: Part 2 (Remove engine support)").

Note
You need to
[log in](show_bug.cgi?id=92692&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

 [Status](page.cgi?id=fields.html#bug_status "A bug may be in any of a number of states.") |RESOLVED

resolved as
 [Resolution](page.cgi?id=fields.html#resolution "If a bug is in a resolved state, then one of these reasons will be given for its resolution.") |WONTFIX

 [Priority](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") |P3

 [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement.") |Major

 [Classification](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") |Unclassified

 [Version](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 528+ (Nightly build) |
 [Hardware](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") |All

 [OS](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") |All

 [Product](describecomponents.cgi "Bugs are categorised into Products and Components.") |WebKit

 [Component](describecomponents.cgi?product=WebKit "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") |New Bugs

 [Assignee](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") |Nobody

Reported

2012-07-30 16:43 PDT

Modified

2021-09-21 14:33 PDT
[History](show_activity.cgi?id=92692)

CC List

7
users
Show

abarth
bfulgham
dbates
eric
nagarjuna.atluri
tsepez
webkit-bug-importer

 [URL](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |
 [http://www.foundstone.com |](http://www.foundstone.com)

 [Keywords](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |InRadar

 [Depends on](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |

 [Blocks](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |

 [See Also](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |

 [Alias](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") |
None

---

* Top of Page
* [Format For Printing](show_bug.cgi?format=multiple&id=92692)
* [XML](show_bug.cgi?ctype=xml&id=92692)
* [Clone This Bug](enter_bug.cgi?cloned_bug_id=92692)

* + [New](enter_bug.cgi)
  + [Browse](describecomponents.cgi)
  + [Reports](report.cgi)
  + [Requests](request.cgi)


