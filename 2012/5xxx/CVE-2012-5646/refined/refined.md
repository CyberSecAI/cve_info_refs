```
{
  "vulnerability_details": {
    "root_cause": "The `restorer.php` script in OpenShift Origin's node utilities does not properly sanitize user-supplied data within the `$_SERVER['PATH_INFO']` variable, leading to command injection and arbitrary URL redirection vulnerabilities.",
    "weaknesses": [
      "Command Injection: The script passes unsanitized input from `$_SERVER['PATH_INFO']` to `shell_exec()` within a `preg_match` conditional check, allowing an attacker to inject arbitrary shell commands.",
       "Unvalidated Redirect: The script constructs the redirection URL using `$_SERVER['PATH_INFO']` without proper validation, allowing an attacker to redirect victims to arbitrary URLs via the `Location` header."
    ],
    "impact": "An attacker can execute arbitrary shell commands with the privileges of an arbitrary application and redirect victims to arbitrary web pages, which can be exploited for further attacks like phishing.",
    "attack_vectors": [
      "The attacker sends a crafted HTTP request to `restorer.php` with malicious content embedded in the `PATH_INFO` part of the URL. For command injection, a valid UUID format is required by the regex conditional, then arbitrary shell commands can be injected using backticks or other command injection techniques. For URL redirection, an attacker needs to craft a URL that includes a malicious URL in the path info."
    ],
    "attacker_capabilities": "The attacker can be remote and unauthenticated. They need the ability to send crafted HTTP requests to the affected `restorer.php` endpoint.",
     "additional_details": "The `restorer.php` script is used to restore an application after being idle. The script uses the `$_SERVER['PATH_INFO']` to determine what should be done. Before the fix, it used `split` on `/`, which returned the values in an array, and then called `shell_exec` with the second index, the uuid. It is determined that this call can be used to perform shell injection. The fix implemented a regex check via `preg_match` to determine if the passed in string is a valid UUID, and also uses this value in the `shell_exec` call. This prevents shell injection if the passed in value is not a valid UUID. The script also uses a flawed redirect, where the url is replaced with an empty string, and then a redirect is done to that empty string. This was updated to correctly create the full url and then use it in the redirect."
  }
}
```