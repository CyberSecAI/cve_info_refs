=== Content from www.madirish.net_0ebc8c59_20250125_213646.html ===


# [Mad Irish . net](https://www.madirish.net)

* [about](https://www.madirish.net/about "About me")
* contact
* [rss](https://www.madirish.net/rss.php "RSS feed")
* [github](https://github.com/madirish "Work")
* [LAMPSecurity](https://sourceforge.net/projects/lampsecurity/ "CTF")

# Drupal Hotblocks Module XSS and DoS Vulnerabilities

[disclosure](/tag/disclosure) [drupal](/tag/drupal) [exploit](/tag/exploit) [vuln](/tag/vuln) [xss](/tag/xss)
15 August 2012

Vulnerability Report

Author: Justin C. Klein Keane <justin@madirish.net>

Reported: August 6, 2012

CVE: [CVE-2012-5705](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-5705) and [CVE-2012-5704](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-5704)

OSVDB: [84750](http://osvdb.org/show/osvdb/84750)
#### Description of Vulnerability:

The Drupal HotBlocks module (<https://drupal.org/project/hotblocks>) contains a persistent cross site scripting (XSS), or arbitrary script injection, vulnerability due to the fact that it fails to sanitize user supplied data before display. The HotBlocks module also suffers from a denial of service vulnerability due a user triggered infinite recursion. The HotBlocks module provides a host of functions that allow users to manipulate nodes or blocks inline.

#### Systems affected:

Drupal 6.26 with HotBlocks 6.x-1.7 was tested and shown to be vulnerable.

#### Impact

Users can inject arbitrary HTML (including JavaScript) in order to attack site users, including administrative users. This could lead to account compromise, which could in turn lead to web server compromise, or expose administrative users to client side malware attacks.

Malicious users could crash a Drupal site exploiting the Denial of Service vulnerability.

#### Mitigating factors:

In order to inject arbitrary script malicious users must have the ability "administer hotblocks".

#### XSS Exploit:

1. Install and enable the HotBlocks module
2. Navigate the Hotblocks setting page at ?q=admin/settings/hotblocks
3. Change Block #1 Name to "<script>alert('xss');</script>"
4. View the rendered Javascript at ?q=admin/content/hotblocks

#### Denial of Service Exploit:

1. Install and enable the HotBlocks module
2. Navigate the Hotblocks setting page at ?q=admin/settings/hotblocks
3. Change Block #1 Name to "<script>alert('xss');</script>"
4. Change "Term for hotblocks item:" to "hotblock item <script>alert('hotblock term');</script>"
5. Change "Term for hotblocks items:" to "hotblock item <script>alert('hotblock terms');</script>"
6. Save configuration
7. Go to Block admin at ?q=admin/build/block
8. Drag the Block #1 to the left sidebar and 'Save'
9. Return to the home page.
10. Click the 'Put a hotblock here' icon in the left sidebar and click the malicious name. This points to a link such as hotblocks/assign/11/1?destination=node&path=node&systemtype=block&token=343d600c37a2ed557df7cd22a0010352
11. Refresh the page - WSOD, error logs indicate something like:

[Mon Aug 06 15:42:37 2012] [notice] child pid 4559 exit signal Segmentation fault (11)

or

[Mon Aug 06 15:22:29 2012] [error] [client 10.10.0.1] PHP Fatal error: Maximum execution time of 30 seconds exceeded in /var/www/html/drupal-6.26/includes/bootstrap.inc on line 860, referer: http://10.10.0.101/drupal/

#### Vendor Response

Vendor released [SA-CONTRIB-2012-126](https://drupal.org/node/1732946) on 15 August, 2012 which recommends upgrade to the latest version of Hotblocks >= 6.x-1.8

### Tags

* [apple](/tag/apple)
* [arbitrary\_code\_execution](/tag/arbitrary_code_execution)
* [blue\_team](/tag/blue_team)
* [disclosure](/tag/disclosure)
* [drupal](/tag/drupal)
* [editorial](/tag/editorial)
* [encryption](/tag/encryption)
* [exploit](/tag/exploit)
* [feature](/tag/feature)
* [how\_to](/tag/how_to)
* [html5](/tag/html5)
* [ios](/tag/ios)
* [iot](/tag/iot)
* [javascript](/tag/javascript)
* [linux](/tag/linux)
* [malware](/tag/malware)
* [mysql](/tag/mysql)
* [network](/tag/network)
* [osx](/tag/osx)
* [pen\_test](/tag/pen_test)
* [php](/tag/php)
* [privacy](/tag/privacy)
* [purple\_team](/tag/purple_team)
* [random](/tag/random)
* [raspberry\_pi](/tag/raspberry_pi)
* [research](/tag/research)
* [review](/tag/review)
* [sql](/tag/sql)
* [sql\_injection](/tag/sql_injection)
* [threat\_intel](/tag/threat_intel)
* [tools](/tag/tools)
* [tutorial](/tag/tutorial)
* [vuln](/tag/vuln)
* [web\_application](/tag/web_application)
* [windows](/tag/windows)
* [xss](/tag/xss)

[Copyright](http://www.madirish.net/copyright "My copyright statement") © Justin C. Klein Keane. Unauthorized reproduction is a violation of US and international law.



=== Content from www.openwall.com_5a82ea42_20250125_213647.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2012/10/06/4) [[next>]](2) [[<thread-prev]](../../../2012/10/04/6) [[thread-next>]](../../../2012/11/01/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <50711E17.7060502@redhat.com>
Date: Sun, 07 Oct 2012 00:15:51 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Joshua Brauer <joshua@...uerranch.com>
Subject: Re: CVE Request for Drupal Contributed Modules

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 10/04/2012 12:15 PM, Joshua Brauer wrote:
>
> This is a batch CVE request for several already published/resolved
> issues with contributed modules for the Drupal project.

Assigned most, need clarification on several issues. Top posting for
ease of use. Please see below for questions.

+CVE-2012-4482 Drupal SA-CONTRIB-2012-112 - Ubercart SecureTrading -
Failure to follow guideline/specification
+CVE-2012-4483 Drupal SA-CONTRIB-2012-113 - Drupal Commons - Access Bypass
+CVE-2012-4484 Drupal SA-CONTRIB-2012-114 - Campaign Monitor - Cross
Site Scripting (XSS)
+CVE-2012-4485 Drupal SA-CONTRIB-2012-115 - Gallery formatter - Cross
Site Scripting (XSS)
+CVE-2012-4486 Drupal SA-CONTRIB-2012-116 - Subuser - Cross Site
Request Forgery (CSRF)
+CVE-2012-4487 Drupal SA-CONTRIB-2012-116 - Subuser - Access Bypass
+CVE-2012-4488 Drupal SA-CONTRIB-2012-117 - Location - Access Bypass
+CVE-2012-4489 Drupal SA-CONTRIB-2012-118 - Secure Login - Open Redirect
+CVE-2012-4490 Drupal SA-CONTRIB-2012-119 - Excluded Users - Cross
Site Scripting (XSS)
+CVE-2012-4491 Drupal SA-CONTRIB-2012-120 - Monthly Archive by Node
Type - Access Bypass
+CVE-2012-4492 Drupal SA-CONTRIB-2012-121 - Shorten URLs - Cross Site
Scripting (XSS)
+CVE-2012-4493 Drupal SA-CONTRIB-2012-122 - Better Revisions - Cross
Site Scripting (XSS)
+CVE-2012-4494 Drupal SA-CONTRIB-2012-123 - Shibboleth authentication
- - Access Bypass
+CVE-2012-4495 Drupal SA-CONTRIB-2012-124 - Mime Mail - Access Bypass
+CVE-2012-4496 Drupal SA-CONTRIB-2012-127 - Custom Publishing Options
- - Cross Site Scripting (XSS) Vulnerability
+CVE-2012-4497 Drupal SA-CONTRIB-2012-128 - Elegant Theme - Cross Site
Scripting (XSS)
+CVE-2012-4498 Drupal SA-CONTRIB-2012-129 - Activism - Access Bypass
+CVE-2012-4499 Drupal SA-CONTRIB-2012-131 - Email Field - Access Bypass
+CVE-2012-4500 Drupal SA-CONTRIB-2012-132 - Announcements - Access Bypass

> <http://drupal.org/node/1679820> | SA-CONTRIB-2012-112 - Ubercart
> SecureTrading - Failure to follow guideline/specification
> <http://drupal.org/node/1679888> | SA-CONTRIB-2012-113 - Drupal
> Commons - Access Bypass <http://drupal.org/node/1691446> |
> SA-CONTRIB-2012-114 - Campaign Monitor - Cross Site Scripting
> (XSS) <http://drupal.org/node/1700578> | SA-CONTRIB-2012-115 -
> Gallery formatter - Cross Site Scripting (XSS)
>
>
> Multiple Vulnerabilities: <http://drupal.org/node/1700584> |
> SA-CONTRIB-2012-116 - Subuser - Cross Site Request Forgery (CSRF)
> <http://drupal.org/node/1700584> | SA-CONTRIB-2012-116 - Subuser -
> Access Bypass
>
> <http://drupal.org/node/1700588> | SA-CONTRIB-2012-117 - Location -
> Access Bypass <http://drupal.org/node/1700594> | SA-CONTRIB-2012-118
> - Secure Login - Open Redirect <http://drupal.org/node/1708058> |
> SA-CONTRIB-2012-119 - Excluded Users - Cross Site Scripting (XSS)
> <http://drupal.org/node/1708198> | SA-CONTRIB-2012-120 - Monthly
> Archive by Node Type - Access Bypass <http://drupal.org/node/1719392>
> | SA-CONTRIB-2012-121 - Shorten URLs - Cross Site Scripting (XSS)
> <http://drupal.org/node/1719402> | SA-CONTRIB-2012-122 - Better
> Revisions - Cross Site Scripting (XSS)
> <http://drupal.org/node/1719462> | SA-CONTRIB-2012-123 - Shibboleth
> authentication - Access Bypass <http://drupal.org/node/1719482> |
> SA-CONTRIB-2012-124 - Mime Mail - Access Bypass
>
>
>
> Multiple Vulnerabilities: <http://drupal.org/node/1719548> |
> SA-CONTRIB-2012-125 - Chaos tool suite (ctools) - Local File
> Inclusion <http://drupal.org/node/1719548> | SA-CONTRIB-2012-125 -
> Chaos tool suite (ctools) - Cross Site Scripting (XSS)

This sounds like a single issue with two possible outcomes?

The module doesn't sufficiently validate css import statements to
confirm they only include css content appropriate to show to end
users. This could allow a malicious user to add sensitive content from
the site (e.g. settings.php) exposing that sensitive content to
visitors of the page. It could also be used to execute a Cross Site
Scripting attack.

Links to the code commits fixing this would be helpful.

> <http://drupal.org/node/1732946> | SA-CONTRIB-2012-126 - Hotblocks -
> Cross Site Scripting (XSS) and Denial of Service (DoS)

This is a multiple CVE issue?

> <http://drupal.org/node/1732980> | SA-CONTRIB-2012-127 - Custom
> Publishing Options - Cross Site Scripting (XSS) Vulnerability
> <http://drupal.org/node/1733056> | SA-CONTRIB-2012-128 - Elegant
> Theme - Cross Site Scripting (XSS) <http://drupal.org/node/1762160> |
> SA-CONTRIB-2012-129 - Activism - Access Bypass
>
>
>
> Multiple Vulnerabilities: <http://drupal.org/node/1762220> |
> SA-CONTRIB-2012-130 - Jstool - Access Bypass
> <http://drupal.org/node/1762220> | SA-CONTRIB-2012-130 - Jstool -
> Arbitrary code inclusion

The description/vulns don't seem to match up on this one. Can you clarify?

The module does not protect its menu paths, which contain sensitive
information about all javascript files on the site and their contents.
The module does not validate filenames which can lead to potential
read/write access to arbitrary files on the server.

Links to the code commits fixing this would be helpful.

> <http://drupal.org/node/1762470> | SA-CONTRIB-2012-131 - Email Field
> - Access Bypass <http://drupal.org/node/1762480> |
> SA-CONTRIB-2012-132 - Announcements - Access Bypass

> <http://drupal.org/node/1762482> | SA-CONTRIB-2012-133 - Taxonomy
> Image - Cross Site Scripting (XSS) & Arbitrary PHP code execution
So this is the same root issue, not filtering file uploads allowing an
attacker to upload arbitrary stuff (including PHP code), the outcome
of which could be PHP code execution, or XSS (or other things I
suppose like DoS, CSRF, etc.)?

> Thanks, Josh - on behalf of the Drupal security team.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://www.enigmail.net/>

iQIcBAEBAgAGBQJQcR4XAAoJEBYNRVNeJnmTDe0P/iCLTgHkCF0Q5fg+6CW8c/uz
6PJBxD36OEitOC2wHMGEE7t3E95Nl/DfcKteUgByLUp7SJSAttGsVTLkeSIjFt3L
nk0XFEbdGmrsBRs7WnmyiCQKMXL2TEOOXDoXpyB1VNshLIt02KIPOPgtx6/2iobI
bmy51ycb0nn7+ENYYJ8VPG/QWq7vbXEzjVi/4gsZKmyu5zLyRnF0qwi90IIoh1zO
o3NH3lLLkVU+TMRLd7oSvaoNjIgg9mcSaOon0H7bwdUmdT1PyJXL1aDq3teDI9+5
DhBoFyAy4m26FaxURryl4tbEbN1yKbC88MNxt/JTvrnvxNLAjAX+az1/CDnb02US
luDNG30vuolI6zYqfOl1FZRIOtgZEBgJ41oTB6v/WQs0dKgiiZeSyxNMVWhlAmTc
0enbfC3rtzHU7N6HNdmuRhzrS9nInpNAJJr2Da0yPbDrP5WdCpSrmmi5zckpciAo
OsqXefGKZqMOqvYEXAkbssAS/ACkv8WB++9jySPRc+ktK85t+mrwziuYIv9qGFTH
u+CmX8y208Tlk3g8ptFY6DB2YFaAsiq7kRQaTf56VwhJvTpUZHYfR4DxMHVqToCi
yX+55GRnIOngQwvOSbu6zIQ8Bpqd6iJHvKkUq4WM5r2XSPjRn5Uj3QyfKV/eHx4A
SLMDKmKG4YtdCRTrFpob
=gXGG
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_be898dad_20250125_213647.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](../../../2012/10/05/1) [[thread-next>]](../../../2012/10/07/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <572D94E3-8897-4EB6-B7D5-F017BC5C755A@brauerranch.com>
Date: Thu, 4 Oct 2012 12:15:51 -0600
From: Joshua Brauer <joshua@...uerranch.com>
To: kseifried@...hat.com,
 oss-security@...ts.openwall.com
Subject: CVE Request for Drupal Contributed Modules

This is a batch CVE request for several already published/resolved issues with contributed modules for the Drupal project.

<http://drupal.org/node/1679820> | SA-CONTRIB-2012-112 - Ubercart SecureTrading - Failure to follow guideline/specification
<http://drupal.org/node/1679888> | SA-CONTRIB-2012-113 - Drupal Commons - Access Bypass
<http://drupal.org/node/1691446> | SA-CONTRIB-2012-114 - Campaign Monitor - Cross Site Scripting (XSS)
<http://drupal.org/node/1700578> | SA-CONTRIB-2012-115 - Gallery formatter - Cross Site Scripting (XSS)

Multiple Vulnerabilities:
<http://drupal.org/node/1700584> | SA-CONTRIB-2012-116 - Subuser - Cross Site Request Forgery (CSRF)
<http://drupal.org/node/1700584> | SA-CONTRIB-2012-116 - Subuser - Access Bypass

<http://drupal.org/node/1700588> | SA-CONTRIB-2012-117 - Location - Access Bypass
<http://drupal.org/node/1700594> | SA-CONTRIB-2012-118 - Secure Login - Open Redirect
<http://drupal.org/node/1708058> | SA-CONTRIB-2012-119 - Excluded Users - Cross Site Scripting (XSS)
<http://drupal.org/node/1708198> | SA-CONTRIB-2012-120 - Monthly Archive by Node Type - Access Bypass
<http://drupal.org/node/1719392> | SA-CONTRIB-2012-121 - Shorten URLs - Cross Site Scripting (XSS)
<http://drupal.org/node/1719402> | SA-CONTRIB-2012-122 - Better Revisions - Cross Site Scripting (XSS)
<http://drupal.org/node/1719462> | SA-CONTRIB-2012-123 - Shibboleth authentication - Access Bypass
<http://drupal.org/node/1719482> | SA-CONTRIB-2012-124 - Mime Mail - Access Bypass

Multiple Vulnerabilities:
<http://drupal.org/node/1719548> | SA-CONTRIB-2012-125 - Chaos tool suite (ctools) - Local File Inclusion
<http://drupal.org/node/1719548> | SA-CONTRIB-2012-125 - Chaos tool suite (ctools) - Cross Site Scripting (XSS)

<http://drupal.org/node/1732946> | SA-CONTRIB-2012-126 - Hotblocks - Cross Site Scripting (XSS) and Denial of Service (DoS)
<http://drupal.org/node/1732980> | SA-CONTRIB-2012-127 - Custom Publishing Options - Cross Site Scripting (XSS) Vulnerability
<http://drupal.org/node/1733056> | SA-CONTRIB-2012-128 - Elegant Theme - Cross Site Scripting (XSS)
<http://drupal.org/node/1762160> | SA-CONTRIB-2012-129 - Activism - Access Bypass

Multiple Vulnerabilities:
<http://drupal.org/node/1762220> | SA-CONTRIB-2012-130 - Jstool - Access Bypass
<http://drupal.org/node/1762220> | SA-CONTRIB-2012-130 - Jstool - Arbitrary code inclusion

<http://drupal.org/node/1762470> | SA-CONTRIB-2012-131 - Email Field - Access Bypass
<http://drupal.org/node/1762480> | SA-CONTRIB-2012-132 - Announcements - Access Bypass
<http://drupal.org/node/1762482> | SA-CONTRIB-2012-133 - Taxonomy Image - Cross Site Scripting (XSS) & Arbitrary PHP code execution

Thanks,
Josh - on behalf of the Drupal security team.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


