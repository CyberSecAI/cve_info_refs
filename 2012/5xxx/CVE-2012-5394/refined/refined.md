```
{
  "vulnerability": {
    "root_cause": "The CentralAuth extension's image auto-login mechanism was vulnerable to CSRF attacks.",
    "weaknesses": [
      "CSRF vulnerability in the auto-login mechanism",
	  "Lack of CSRF protection for image auto-login"
    ],
    "impact": "An attacker could potentially log in third parties using the attacker's account by executing malicious JavaScript. Users already logged in could also be relogged into the attacker's account.",
    "attack_vector": "An attacker could inject a malicious image tag into a web page. When a victim's browser loads the page, it attempts to load the image. The image URL includes a token related to the attacker account, leading to unintended login.",
    "required_capabilities": "An attacker needs to be able to inject a crafted image tag into a web page viewed by the victim."
  },
  "affected_component": "MediaWiki CentralAuth Extension",
  "fixed_version": "MediaWiki 1.21.3, 1.20.8 and 1.19.9",
    "details": "The vulnerability stemmed from the way the CentralAuth extension handled automatic logins via image loading. The image loading was not protected by a session cookie, and it was possible for an attacker to generate a token and log in victims under their account.  The fix involved implementing a three-stage session setup that included a callback to the originating server to verify the user's identity, and removing Special:AutoLogin.  A javascript version was also considered."
}
```