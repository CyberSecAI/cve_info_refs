=== Content from git.kernel.org_abf02b4f_20250125_075706.html ===


| [cgit logo](/) | [index](/) : [kernel/git/rt/linux-stable-rt.git](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y master stable-rt/v3.14-rt stable-rt/v3.14-rt-rebase stable-rt/v3.2-rt stable-rt/v3.2-rt-rebase stable-rt/v5.10-rt v3.0-rt v3.0-rt-rebase v3.10-rt v3.10-rt-rebase v3.12-rt v3.12-rt-rebase v3.14-rt v3.14-rt-rebase v3.18-rt v3.18-rt-next v3.18-rt-rebase v3.2-rt v3.2-rt-features v3.2-rt-rebase v3.4-rt v3.4-rt-features v3.4-rt-rebase v3.6-rt v3.6-rt-rebase v3.6-stable v3.8-rt v3.8-rt-rebase v4.1-rt v4.1-rt-rebase v4.14-rt v4.14-rt-next v4.14-rt-rebase v4.19-rt v4.19-rt-next v4.19-rt-rebase v4.4-rt v4.4-rt-next v4.4-rt-rebase v4.9-rt v4.9-rt-next v4.9-rt-rebase v5.10-rt v5.10-rt-next v5.10-rt-rebase v5.15-rt v5.15-rt-next v5.15-rt-rebase v5.4-rt v5.4-rt-rebase v6.1-rt v6.1-rt-next v6.1-rt-rebase v6.6-rt v6.6-rt-next v6.6-rt-rebase |
| --- | --- | --- |
| Unnamed repository; edit this file 'description' to name the repository. | RT group |

| [about](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/about/)[summary](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/)[refs](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/refs/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0)[log](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/log/)[tree](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0)[commit](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/commit/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0)[diff](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0)[stats](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Steven Rostedt <rostedt@goodmis.org> | 2012-02-08 15:56:11 -0500 |
| --- | --- | --- |
| committer | Steven Rostedt <rostedt@goodmis.org> | 2012-02-08 15:56:11 -0500 |
| commit | [e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/commit/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0) ([patch](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/patch/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0)) | |
| tree | [912feb3b367ed1b8716c74be2f15819d2234b92d](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0) | |
| parent | [bcf6b1d78c0bde228929c388978ed3af9a623463](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/commit/?id=bcf6b1d78c0bde228929c388978ed3af9a623463) ([diff](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0&id2=bcf6b1d78c0bde228929c388978ed3af9a623463)) | |
| download | [linux-stable-rt-e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0.tar.gz](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/snapshot/linux-stable-rt-e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0.tar.gz) | |

x86: Do not disable preemption in int3 on 32bitPreemption must be disabled before enabling interrupts in do\_trap
on x86\_64 because the stack in use for int3 and debug is a per CPU
stack set by th IST. But 32bit does not have an IST and the stack
still belongs to the current task and there is no problem in scheduling
out the task.
Keep preemption enabled on X86\_32 when enabling interrupts for
do\_trap().
The name of the function is changed from preempt\_conditional\_sti/cli()
to conditional\_sti/cli\_ist(), to annotate that this function is used
when the stack is on the IST.
Cc: stable-rt@vger.kernel.org
Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
[Diffstat](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0)

| -rw-r--r-- | [arch/x86/kernel/traps.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/arch/x86/kernel/traps.c?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0) | 32 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 23 insertions, 9 deletions

| diff --git a/arch/x86/kernel/traps.c b/arch/x86/kernel/traps.cindex b9b67166f9ded1..5d47242746596a 100644--- a/[arch/x86/kernel/traps.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/arch/x86/kernel/traps.c?id=bcf6b1d78c0bde228929c388978ed3af9a623463)+++ b/[arch/x86/kernel/traps.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/arch/x86/kernel/traps.c?id=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0)@@ -96,9 +96,21 @@ static inline void conditional\_sti(struct pt\_regs \*regs) local\_irq\_enable(); } -static inline void preempt\_conditional\_sti(struct pt\_regs \*regs)+static inline void conditional\_sti\_ist(struct pt\_regs \*regs) {+#ifdef CONFIG\_X86\_64+ /\*+ \* X86\_64 uses a per CPU stack on the IST for certain traps+ \* like int3. The task can not be preempted when using one+ \* of these stacks, thus preemption must be disabled, otherwise+ \* the stack can be corrupted if the task is scheduled out,+ \* and another task comes in and uses this stack.+ \*+ \* On x86\_32 the task keeps its own stack and it is OK if the+ \* task schedules out.+ \*/ inc\_preempt\_count();+#endif if (regs->flags & X86\_EFLAGS\_IF) local\_irq\_enable(); }@@ -109,11 +121,13 @@ static inline void conditional\_cli(struct pt\_regs \*regs) local\_irq\_disable(); } -static inline void preempt\_conditional\_cli(struct pt\_regs \*regs)+static inline void conditional\_cli\_ist(struct pt\_regs \*regs) { if (regs->flags & X86\_EFLAGS\_IF) local\_irq\_disable();+#ifdef CONFIG\_X86\_64 dec\_preempt\_count();+#endif }  static void \_\_kprobes@@ -231,9 +245,9 @@ dotraplinkage void do\_stack\_segment(struct pt\_regs \*regs, long error\_code) if (notify\_die(DIE\_TRAP, "stack segment", regs, error\_code, 12, SIGBUS) == NOTIFY\_STOP) return;- preempt\_conditional\_sti(regs);+ conditional\_sti\_ist(regs); do\_trap(12, SIGBUS, "stack segment", regs, error\_code, NULL);- preempt\_conditional\_cli(regs);+ conditional\_cli\_ist(regs); }  dotraplinkage void do\_double\_fault(struct pt\_regs \*regs, long error\_code)@@ -471,9 +485,9 @@ dotraplinkage void \_\_kprobes do\_int3(struct pt\_regs \*regs, long error\_code) return; #endif - preempt\_conditional\_sti(regs);+ conditional\_sti\_ist(regs); do\_trap(3, SIGTRAP, "int3", regs, error\_code, NULL);- preempt\_conditional\_cli(regs);+ conditional\_cli\_ist(regs); }  #ifdef CONFIG\_X86\_64@@ -567,12 +581,12 @@ dotraplinkage void \_\_kprobes do\_debug(struct pt\_regs \*regs, long error\_code) return;  /\* It's safe to allow irq's after DR6 has been saved \*/- preempt\_conditional\_sti(regs);+ conditional\_sti\_ist(regs);  if (regs->flags & X86\_VM\_MASK) { handle\_vm86\_trap((struct kernel\_vm86\_regs \*) regs, error\_code, 1);- preempt\_conditional\_cli(regs);+ conditional\_cli\_ist(regs); return; } @@ -591,7 +605,7 @@ dotraplinkage void \_\_kprobes do\_debug(struct pt\_regs \*regs, long error\_code) si\_code = get\_si\_code(tsk->thread.debugreg6); if (tsk->thread.debugreg6 & (DR\_STEP | DR\_TRAP\_BITS) || user\_icebp) send\_sigtrap(tsk, regs, error\_code, si\_code);- preempt\_conditional\_cli(regs);+ conditional\_cli\_ist(regs);  return; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-25 07:55:43 +0000



=== Content from git.kernel.org_6ac41c3c_20250125_075701.html ===


| [cgit logo](/) | [index](/) : [kernel/git/rt/linux-stable-rt.git](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y master stable-rt/v3.14-rt stable-rt/v3.14-rt-rebase stable-rt/v3.2-rt stable-rt/v3.2-rt-rebase stable-rt/v5.10-rt v3.0-rt v3.0-rt-rebase v3.10-rt v3.10-rt-rebase v3.12-rt v3.12-rt-rebase v3.14-rt v3.14-rt-rebase v3.18-rt v3.18-rt-next v3.18-rt-rebase v3.2-rt v3.2-rt-features v3.2-rt-rebase v3.4-rt v3.4-rt-features v3.4-rt-rebase v3.6-rt v3.6-rt-rebase v3.6-stable v3.8-rt v3.8-rt-rebase v4.1-rt v4.1-rt-rebase v4.14-rt v4.14-rt-next v4.14-rt-rebase v4.19-rt v4.19-rt-next v4.19-rt-rebase v4.4-rt v4.4-rt-next v4.4-rt-rebase v4.9-rt v4.9-rt-next v4.9-rt-rebase v5.10-rt v5.10-rt-next v5.10-rt-rebase v5.15-rt v5.15-rt-next v5.15-rt-rebase v5.4-rt v5.4-rt-rebase v6.1-rt v6.1-rt-next v6.1-rt-rebase v6.6-rt v6.6-rt-next v6.6-rt-rebase |
| --- | --- | --- |
| Unnamed repository; edit this file 'description' to name the repository. | RT group |

| [about](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/about/)[summary](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/)[refs](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/refs/?id=bcf6b1d78c0bde228929c388978ed3af9a623463)[log](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/log/)[tree](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/?id=bcf6b1d78c0bde228929c388978ed3af9a623463)[commit](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/commit/?id=bcf6b1d78c0bde228929c388978ed3af9a623463)[diff](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/?id=bcf6b1d78c0bde228929c388978ed3af9a623463)[stats](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Oleg Nesterov <oleg@redhat.com> | 2012-02-08 15:56:11 -0500 |
| --- | --- | --- |
| committer | Steven Rostedt <rostedt@goodmis.org> | 2012-02-08 15:56:11 -0500 |
| commit | [bcf6b1d78c0bde228929c388978ed3af9a623463](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/commit/?id=bcf6b1d78c0bde228929c388978ed3af9a623463) ([patch](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/patch/?id=bcf6b1d78c0bde228929c388978ed3af9a623463)) | |
| tree | [c7a86eba533212801e73602d71a4593f223880a5](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/?id=bcf6b1d78c0bde228929c388978ed3af9a623463) | |
| parent | [9cd225a5ce229e86c92b84cb3ebeaf27e7ce9324](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/commit/?id=9cd225a5ce229e86c92b84cb3ebeaf27e7ce9324) ([diff](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/?id=bcf6b1d78c0bde228929c388978ed3af9a623463&id2=9cd225a5ce229e86c92b84cb3ebeaf27e7ce9324)) | |
| download | [linux-stable-rt-bcf6b1d78c0bde228929c388978ed3af9a623463.tar.gz](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/snapshot/linux-stable-rt-bcf6b1d78c0bde228929c388978ed3af9a623463.tar.gz) | |

signal/x86: Delay calling signals in atomicOn x86\_64 we must disable preemption before we enable interrupts
for stack faults, int3 and debugging, because the current task is using
a per CPU debug stack defined by the IST. If we schedule out, another task
can come in and use the same stack and cause the stack to be corrupted
and crash the kernel on return.
When CONFIG\_PREEMPT\_RT\_FULL is enabled, spin\_locks become mutexes, and
one of these is the spin lock used in signal handling.
Some of the debug code (int3) causes do\_trap() to send a signal.
This function calls a spin lock that has been converted to a mutex
and has the possibility to sleep. If this happens, the above issues with
the corrupted stack is possible.
Instead of calling the signal right away, for PREEMPT\_RT and x86\_64,
the signal information is stored on the stacks task\_struct and
TIF\_NOTIFY\_RESUME is set. Then on exit of the trap, the signal resume
code will send the signal when preemption is enabled.
[ rostedt: Switched from #ifdef CONFIG\_PREEMPT\_RT\_FULL to
ARCH\_RT\_DELAYS\_SIGNAL\_SEND and added comments to the code. ]
Cc: stable-rt@vger.kernel.org
Signed-off-by: Oleg Nesterov <oleg@redhat.com>
Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
[Diffstat](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/?id=bcf6b1d78c0bde228929c388978ed3af9a623463)

| -rw-r--r-- | [arch/x86/include/asm/signal.h](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/arch/x86/include/asm/signal.h?id=bcf6b1d78c0bde228929c388978ed3af9a623463) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/x86/kernel/signal.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/arch/x86/kernel/signal.c?id=bcf6b1d78c0bde228929c388978ed3af9a623463) | 9 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [include/linux/sched.h](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/include/linux/sched.h?id=bcf6b1d78c0bde228929c388978ed3af9a623463) | 4 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [kernel/signal.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/diff/kernel/signal.c?id=bcf6b1d78c0bde228929c388978ed3af9a623463) | 37 | |  |  |  | | --- | --- | --- | |

4 files changed, 61 insertions, 2 deletions

| diff --git a/arch/x86/include/asm/signal.h b/arch/x86/include/asm/signal.hindex 598457cbd0f80c..1213ebd7bee774 100644--- a/[arch/x86/include/asm/signal.h](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/arch/x86/include/asm/signal.h?id=9cd225a5ce229e86c92b84cb3ebeaf27e7ce9324)+++ b/[arch/x86/include/asm/signal.h](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/arch/x86/include/asm/signal.h?id=bcf6b1d78c0bde228929c388978ed3af9a623463)@@ -31,6 +31,19 @@ typedef struct { unsigned long sig[\_NSIG\_WORDS]; } sigset\_t; +/\*+ \* Because some traps use the IST stack, we must keep+ \* preemption disabled while calling do\_trap(), but do\_trap()+ \* may call force\_sig\_info() which will grab the signal spin\_locks+ \* for the task, which in PREEMPT\_RT\_FULL are mutexes.+ \* By defining ARCH\_RT\_DELAYS\_SIGNAL\_SEND the force\_sig\_info() will+ \* set TIF\_NOTIFY\_RESUME and set up the signal to be sent on exit+ \* of the trap.+ \*/+#if defined(CONFIG\_PREEMPT\_RT\_FULL) && defined(CONFIG\_X86\_64)+#define ARCH\_RT\_DELAYS\_SIGNAL\_SEND+#endif+ #else /\* Here we must cater to libcs that poke about in kernel headers. \*/ diff --git a/arch/x86/kernel/signal.c b/arch/x86/kernel/signal.cindex 40a24932a8a152..7d88255d362895 100644--- a/[arch/x86/kernel/signal.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/arch/x86/kernel/signal.c?id=9cd225a5ce229e86c92b84cb3ebeaf27e7ce9324)+++ b/[arch/x86/kernel/signal.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/arch/x86/kernel/signal.c?id=bcf6b1d78c0bde228929c388978ed3af9a623463)@@ -840,6 +840,15 @@ do\_notify\_resume(struct pt\_regs \*regs, void \*unused, \_\_u32 thread\_info\_flags) mce\_notify\_process(); #endif /\* CONFIG\_X86\_64 && CONFIG\_X86\_MCE \*/ +#ifdef ARCH\_RT\_DELAYS\_SIGNAL\_SEND+ if (unlikely(current->forced\_info.si\_signo)) {+ struct task\_struct \*t = current;+ force\_sig\_info(t->forced\_info.si\_signo,+ &t->forced\_info, t);+ t->forced\_info.si\_signo = 0;+ }+#endif+ /\* deal with pending signal delivery \*/ if (thread\_info\_flags & \_TIF\_SIGPENDING) do\_signal(regs);diff --git a/include/linux/sched.h b/include/linux/sched.hindex 4cd327889249cb..77e132f4991e73 100644--- a/[include/linux/sched.h](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/include/linux/sched.h?id=9cd225a5ce229e86c92b84cb3ebeaf27e7ce9324)+++ b/[include/linux/sched.h](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/include/linux/sched.h?id=bcf6b1d78c0bde228929c388978ed3af9a623463)@@ -1405,6 +1405,10 @@ struct task\_struct { sigset\_t blocked, real\_blocked; sigset\_t saved\_sigmask; /\* restored if set\_restore\_sigmask() was used \*/ struct sigpending pending;+#ifdef CONFIG\_PREEMPT\_RT\_FULL+ /\* TODO: move me into ->restart\_block ? \*/+ struct siginfo forced\_info;+#endif  unsigned long sas\_ss\_sp; size\_t sas\_ss\_size;diff --git a/kernel/signal.c b/kernel/signal.cindex 3f159145ebfbd0..6650b2cda0507d 100644--- a/[kernel/signal.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/kernel/signal.c?id=9cd225a5ce229e86c92b84cb3ebeaf27e7ce9324)+++ b/[kernel/signal.c](/pub/scm/linux/kernel/git/rt/linux-stable-rt.git/tree/kernel/signal.c?id=bcf6b1d78c0bde228929c388978ed3af9a623463)@@ -1200,8 +1200,8 @@ int do\_send\_sig\_info(int sig, struct siginfo \*info, struct task\_struct \*p, \* We don't want to have recursive SIGSEGV's etc, for example, \* that is why we also clear SIGNAL\_UNKILLABLE. \*/-int-force\_sig\_info(int sig, struct siginfo \*info, struct task\_struct \*t)+static int+do\_force\_sig\_info(int sig, struct siginfo \*info, struct task\_struct \*t) { unsigned long int flags; int ret, blocked, ignored;@@ -1226,6 +1226,39 @@ force\_sig\_info(int sig, struct siginfo \*info, struct task\_struct \*t) return ret; } +int force\_sig\_info(int sig, struct siginfo \*info, struct task\_struct \*t)+{+/\*+ \* On some archs, PREEMPT\_RT has to delay sending a signal from a trap+ \* since it can not enable preemption, and the signal code's spin\_locks+ \* turn into mutexes. Instead, it must set TIF\_NOTIFY\_RESUME which will+ \* send the signal on exit of the trap.+ \*/+#ifdef ARCH\_RT\_DELAYS\_SIGNAL\_SEND+ if (in\_atomic()) {+ if (WARN\_ON\_ONCE(t != current))+ return 0;+ if (WARN\_ON\_ONCE(t->forced\_info.si\_signo))+ return 0;++ if (is\_si\_special(info)) {+ WARN\_ON\_ONCE(info != SEND\_SIG\_PRIV);+ t->forced\_info.si\_signo = sig;+ t->forced\_info.si\_errno = 0;+ t->forced\_info.si\_code = SI\_KERNEL;+ t->forced\_info.si\_pid = 0;+ t->forced\_info.si\_uid = 0;+ } else {+ t->forced\_info = \*info;+ }++ set\_tsk\_thread\_flag(t, TIF\_NOTIFY\_RESUME);+ return 0;+ }+#endif+ return do\_force\_sig\_info(sig, info, t);+}+ /\* \* Nuke all other threads in the group. \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-25 07:55:39 +0000



=== Content from bugzilla.redhat.com_7da6d385_20250125_075657.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D794557)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D794557)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D794557)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 794557

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 794557**](show_bug.cgi?id=794557)
(CVE-2012-0810)
- [CVE-2012-0810](https://access.redhat.com/security/cve/CVE-2012-0810) kernel-rt: stack corruption when task gets scheduled out using the debug stack

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-0810 kernel-rt: stack corruption when task gets scheduled out using ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-0810 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | Duplicates (1): | [784673](show_bug.cgi?id=784673)  ([view as bug list](buglist.cgi?bug_id=784673)) | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [784358](show_bug.cgi?id=784358) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [784680](show_bug.cgi?id=784680) | | TreeView+ | [depends on](buglist.cgi?bug_id=794557&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=794557&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-02-17 05:16 UTC by Eugene Teo (Security Response) | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-24 13:06 UTC ([History](show_activity.cgi?id=794557)) | | [CC List:](page.cgi?id=fields.html#cclist) | 20 users (show)  agordeev anton arozansk bhu davids dhoward fhrbata jkacur kernel-mgr L.Bonnaud lgoncalv lwang plougher pmatouse rt-maint security-response-team sforsber srostedt vgoyal williams | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-05-10 15:23:40 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2012:0333](https://access.redhat.com/errata/RHSA-2012%3A0333) | 0 | normal | SHIPPED\_LIVE | Important: kernel-rt security and bug fix update | 2012-02-24 01:21:35 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=794557#c0)  Eugene Teo (Security Response)    2012-02-17 05:16:55 UTC  ``` The issue is that the int3 handler uses a per CPU debug stack, and calls do_traps() with interrupts enabled but preemption disabled. Then a signal is sent to the current process, and the code that handles the signal grabs a spinlock. This spinlock becomes a mutex (sleeping lock) when CONFIG_PREEMPT_RT_FULL is enabled.  If there is contention on this lock then the task may schedule out. As the task is using a per CPU stack, and another task may come in and use the same stack, the stack can become corrupted and cause the kernel to panic.   ```  [Comment 4](show_bug.cgi?id=794557#c4)  Eugene Teo (Security Response)    2012-02-20 16:51:07 UTC  ``` <https://lkml.org/lkml/2012/1/25/157> <https://lkml.org/lkml/2012/2/1/638> <https://lkml.org/lkml/2012/2/3/309> <https://lkml.org/lkml/2012/2/7/469>   ```  [Comment 5](show_bug.cgi?id=794557#c5)  errata-xmlrpc    2012-02-23 20:24:42 UTC  ``` This issue has been addressed in following products:    MRG for RHEL-6 v.2  Via RHSA-2012:0333 <https://rhn.redhat.com/errata/RHSA-2012-0333.html>   ```  [Comment 6](show_bug.cgi?id=794557#c6)  Eugene Teo (Security Response)    2012-02-24 14:31:30 UTC  ``` Upstream patches: <http://git.kernel.org/linus/968544b96be6801bee3e5974fd1dc29e5ab454ff> <http://git.kernel.org/linus/1bb57b5ea265a1fe2974b6b84fe819489a37e6b3>   ```  [Comment 7](show_bug.cgi?id=794557#c7)  Laurent Bonnaud    2012-03-23 17:14:47 UTC  ``` > <http://git.kernel.org/linus/968544b96be6801bee3e5974fd1dc29e5ab454ff> > <http://git.kernel.org/linus/1bb57b5ea265a1fe2974b6b84fe819489a37e6b3>  Those links display a page with this error message:  404 - Unknown commit object   ```  [Comment 8](show_bug.cgi?id=794557#c8)  Eugene Teo (Security Response)    2012-03-26 07:11:26 UTC  ``` (In reply to [comment #7](show_bug.cgi?id=794557#c7)) > > <http://git.kernel.org/linus/968544b96be6801bee3e5974fd1dc29e5ab454ff> > > <http://git.kernel.org/linus/1bb57b5ea265a1fe2974b6b84fe819489a37e6b3> >  > Those links display a page with this error message: >  > 404 - Unknown commit object  I might have mixed it up with an internal repo. I will get back to you on this. Thanks.   ```  [Comment 9](show_bug.cgi?id=794557#c9)  Eugene Teo (Security Response)    2012-03-27 08:05:27 UTC  ``` (Ignore [comment #6](show_bug.cgi?id=794557#c6)-8)  Upstream patches: <http://git.kernel.org/?p=linux/kernel/git/rt/linux-stable-rt.git;a=commit;h=bcf6b1d78c0bde228929c388978ed3af9a623463> <http://git.kernel.org/?p=linux/kernel/git/rt/linux-stable-rt.git;a=commit;h=e5d4e1c3ccee18c68f23d62ba77bda26e893d4f0>   ```  [Comment 10](show_bug.cgi?id=794557#c10)  Eugene Teo (Security Response)    2012-03-27 08:06:26 UTC  ``` Statement:  This issue did not affect the Linux kernel as shipped with Red Hat Enterprise Linux 4, 5, and 6. This has been addressed in Red Hat Enterprise MRG via <https://rhn.redhat.com/errata/RHSA-2012-0333.html>.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=794557&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_d2bd743a_20250126_072345.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


